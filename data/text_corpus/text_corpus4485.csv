index,text
22425,the contribution of this paper is to propose a two stage optimal framework to solve the optimal design problem of a hybrid renewable energy system hres for seaports firstly models of wind energy sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the optimal installed capacity of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints due to a lack of data concerning energy demands in seaports this paper applies a simulation based method to output the energy demands considering various stochastic environments in seaports finally taking a container seaport in southern china as an example this paper obtains the optimal results by the proposed algorithm and analyzes the sensitivity of emission limitations and wind speeds on the optimal operation of the hres the results obtained and proposed method can be used to provide references for power department policy making and green container port construction keywords hybrid renewable energy system green container ports on shore power system two stage optimization method wind energy 1 introduction given the heightened concerns on energy crisis environment pollution and climate change many green energy technologies have been implemented among seaports worldwide to realize the transition from fossil fuels to clean and sustainable energy peng et al 2019 li et al 2018 davarzani et al 2016 on shore power supply also known as cold ironing is one of the energy transition strategies by applying electricity power supplied from the shore to satisfy the energy demands of ships at berth vaishnav et al 2016 zis et al 2014 the uptake of alternative fuels such as liquefied natural gas is another adopted transition measure for ships when transporting among seaports styhre et al 2017 in addition the handling facilities of seaports have gradually achieved the replacement of diesel equipment with electric handling equipment such as electric rubber tired gantries e rtg and electric quay cranes peng et al 2018a yang and chang 2013 besides on shore power supply alternative fuels and energy transition from diesel to electricity wind energy is usually welcomed to feed the electricity loads of seaports to realize the significant emission abatement kotrikla et al 2017 kim and park 2010 acciaro et al 2014 thus the energy demands in seaports can be satisfied by a hybrid renewable energy system hres which consists of wind energy on shore power supply energy storage and conventional power ahamad et al 2018a optimal design of such a hres can be a challenging task though due to the multiple design objectives highly constraints and uncertainties of wind energy and energy demands however in order to take full advantage of renewable energy and save the system cost it is worthy to study the optimal design of the hres for seaport applications faced with above challenges therefore this paper proposes a two stage optimal framework to solve the design problem of a hres for seaports at first models of wind generation sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the capacity allocation of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints finally the optimal results and the effects of various emission constraints on the optimal operation of the hres have also been analyzed in the case study the rest of this paper is organized as follows in section 2 the related literature is reviewed on hress applied in seaports and the optimal design of hress problem formulation consisting of end use energy analysis and models of wind generation sub systems energy storage sub systems and on shore power supply sub systems are presented in section 3 in section 4 the proposed two stage optimal framework is discussed and each stage is explained in detail solution methodology for the problem is described in section 5 and comparative case studies under various emission constraints are implemented in section 6 finally the paper is concluded in section 7 2 literature review in recent years due to the fossil energy depletion and environmental issues developing renewable energy systems become urgent for sustainable goals as an energy intensive industry ports account for 3 of global greenhouse gas emissions misra et al 2017 sustainable initiatives and green port constructions are driving the use of renewable energy sources to develop hress for supplying the electricity to the load of seaports efiport 2008 heras saizarbitoria et al 2013 ramos et al 2014 hentschel et al 2018 for hress applied in port applications ahamad et al presented the optimal sizing of battery wind photovoltaic grid converter hres at the seaport in copenhagen denmark which was optimized by homer software ahamad et al 2018b mertikas et al summarized the main results of the european project introducing cold ironing as an appealing alternative towards greener ports and discussed the opportunities of turning the ports as smart energy hubs where renewable energy sources are deployed mertikas et al 2018 ahamad et al studied the integration of microgrid technologies in conventional seaports and optimized the photovoltaic wind energy storage system to the use of shore side power ahamad et al 2018a kumar et al proposed an innovative design concept of the harbor area smart grid and validated the performance to supply the ships for cold ironing purpose but also support the hybrid ships of future technology kumar et al 2017 misra et al discussed and detailed the benefits of implementing microgrids containing renewable energy resources and suitable energy storage technologies to achieve sustainable port energy management and concluded that the energy storage systems are able to provide 60 of the port s total daily electricity requirements misra et al 2017 for hress applied in ships at berth photovoltaic system energy storage system on shore power supply and on board diesel generators are always contained to satisfy the energy demands many researchers have been devoted to identifying the optimal design of a hres for ships lan et al proposed an optimal sizing method for a hybrid photovoltaic diesel storage ship power system which minimized the investment cost fuel cost and co2 emissions lan et al 2015 tang et al proposed an optimal energy management model and control methodology to obtain operational safety and efficiency of a hres for large green ships while at berth which minimized the total cost of ships tang et al 2018a yuan et al proposed a design for the solar diesel hybrid powered ship and analyzed the corresponding environmental benefits compared to fuel consumptions yuan et al 2018 as for the use of on shore power supply kumar et al provided a review of technical aspects and existing standards in designing and modelling of a harbor grid for on shore power supply kumar et al 2019 tang et al developed an optimal model of photovoltaic battery diesel cold ironing hybrid energy system for ships at berth and discussed the promising electricity cost savings brought by the optimal operation of the hres tang et al 2018b for microgrid applied in handling facilities of seaports most studies mainly focused on optimal management strategy for e rtg with energy storage system alasali et al presented and verified an optimal energy control strategy for an energy storage system connected to a network of e rtgs based on a stochastic model predictive control algorithm which aimed at reducing electrical energy costs alasali et al 2019 paris et al presented an advanced drive system for the port cranes to optimize the energy absorption and save the energy costs parise and honorati 2014 papaioannou et al designed an electric system of an e rtg with the addition of an energy storage system and estimated the potential emission reduction papaioannou et al 2017 alasali et al presented an artificial neural network prediction model and optimal solution for a single crane system to minimize the electric energy costs and maximize the peak demand reduction alasali habenv becerraet al 2017 as renewable resources such as wind and solar energy can be employed for green port application optimal design method is required for optimally installing and operating such a hybrid energy system as for the optimal design of hress eriksson and gray developed a multi objective optimization model of designing a hres to realize technical economic environmental and socio political objectives which is solved by particle swarm optimization method eriksson and gray 2019 feroldi and zumoffen proposed a sizing methodology for hybrid systems taking into considerations various renewable energy resources incorporated into the energy management strategy feroldi and zumoffen 2014 gonzález et al developed a sizing approach of hybrid grid connected photovoltaic wind power systems based on real wind and solar irradiation data and electricity demand aiming at reducing installation costs gonzález et al 2015 ghorbani et al developed a hybrid genetic algorithm with particle swarm optimization for the optimal sizing of an off grid house applied by a photovoltaic wind battery system which aimed at reducing cost and increasing reliability ghorbani et al 2018 sawle et al proposed an optimal design method of a hres with consideration of various criteria about economic technical and social effect and used different optimization techniques such as teaching learning based optimization to solved the model sawle et al 2018 in the optimal design of hress one issue that must to be considered is the coordination of energy supply and demand for example dahmane et al proposed an intelligent algorithm for optimal power management of a hres containing a photovoltaic wind diesel generator and battery energy storage to achieve the matching between electricity supply and load demand dahmane et al 2013 shaahid and elhadidy evaluated the techno economic utilities by using hybrid photovoltaic diesel battery power systems to supply the load demand of a typical commercial building shaahidma 2007 however the energy demands in seaports is highly dynamic and stochastic which is influenced by many uncertain factors such as weather condition daily schedule and status of handling facilities to overcome the above challenges in the condition of no real energy data it is a useful method to formulate and evaluate such a complex system in seaports by discrete event simulation to obtain the energy demands at every time step for example grundmeier et al presented a simulation based method to provide a load curve forecast of short term energy demands in a container seaport grundmeier et al 2014 as mentioned above optimizing hres design for ships at berth has attracted wide attention in the existing literature however the configuration and operation of a hres for the whole seaport are quite particular and complicated compared to the ship application due to long term dynamic and stochastic operation processes in seaports besides few studies optimize the hybrid renewable energy system for seaports simultaneously considering environmental and economic benefits as a result the configuration sizing methodology and operation strategy of a hres for port application are still unresolved issues that are worthy to be studied therefore this paper develops a simulation based method to obtain the energy demands in seaports at every time step at first then considering the coordination of energy supply and demand a two stage framework for optimal design of a hres for seaports are proposed to minimize the system cost finally the optimal design model of the problem is resolved by the proposed solution methodology and the optimal results are obtained 3 problem formulation in this section the problem is described which consists of uncertainty analysis of energy demands in seaports and the hybrid renewable energy system for port application 3 1 uncertainty analysis of energy demands in seaports a container port generally contains three components berth yard and gate where ships and handling facilities i e quay cranes trucks and yard cranes are taken as the main energy consumers as shown in fig 1 during the operation processes in seaports electricity supplied from on shore power to ships mainly satisfies the hoteling load demands of ships such as lighting heating ventilation and air conditioning electricity used by quay cranes mainly meets the load demand of picking containers up from ships moving containers horizontally and dropping containers on trucks electricity utilized by yard cranes mainly fulfills the load demand of the horizontal movement of the trolley the upwards and downwards movement of the spreader and the gantry movement along the container stack however a container port operation system is very complicated and stochastic including many sub systems such as ships arriving leaving through waterway subsystem ships berthing at berth and being handled subsystem containers assignment and being handled transported subsystem which are queuing systems that are interconnected peng et al 2018a furthermore the energy demands in seaports are highly dynamic and stochastic which are influenced by many uncertain factors grundmeier et al 2014 to overcome the above challenges in the condition of no real energy data this paper develops a useful method to formulate and model the energy demands in seaports by discrete event simulation at each time step the structure of the simulation based method is presented in fig 2 and consists of three steps in step i the simulation model is developed to simulate the whole operation processes in seaports including ship arriving and berthing sub model handling operation sub model and ship departing sub model in step ii the deterministic and uncertain parameters such as weather conditions daily schedule and status of handling facilities are assigned appropriate values and are given to the model after conducting the simulation model the energy demands at each time step can be obtained in step iii 3 2 hybrid renewable energy system for port application when the load demands are supplied by renewable resources individually problems of low reliability and security due to intermittent and variability will influence the performance of energy supply system which can be solved effectively with hress erdinc and uzunoglu 2012 bahramara et al 2016 the adopted hres in this paper comprises wind energy sub system energy storage sub system on shore power sub system and conventional energy sub system which fulfills the load demands of ships electric quay cranes and electric yard cranes as represented in fig 3 the power electronic interfaces and transformers can perform frequency and voltage conversion respectively to match energy supply and demand systems and on shore power can provide required electricity to ships while at berth in the adopted hres wind energy is considered as the priority energy source and conventional energy is taken as a backup source besides to ensure a continued and stable electricity supply energy storage sub system is needed to store excess electricity from wind energy and discharge electricity when the production is deficit the following mainly focus on the wind power modeling energy storage modeling and on shore power modeling 3 2 1 wind power modeling the power curve of a wind turbine describes the electrical power output of wind energy generation as a function of wind speed zare and niknam 2013 as shown in fig 4 electricity is generated once wind speed exceeds the cut in wind speed v i n of the wind turbine and the rated power p r is reached at the rated speed v r since then the power output maintains the constant at the rated power p r till the cut off wind speed v o u t in related studies a typical liner mathematical model for power outputs of wind energy generation is adopted to approximate the nonlinear power curve of wind turbines zare and niknam 2013 shin et al 2017 which is formulated as follows 1 p w v 0 0 v v i n p r v v i n v r v i n v i n v v r p r v r v v o u t 0 v v o u t where p w v is the power output of wind energy at wind speed v and p r is the rated power besides v r is the rated wind speed v i n and v o u t are the cut in wind speed and cut out wind speed respectively however due to the variation of weather conditions such as temperature wind speed and wind directions the power outputs of wind turbines from theoretical analysis always represent significant deviations from the measured power curve ciulla et al 2019 with the consideration of the higher reliability of measured power curves compared to theoretical analysis in the real project this paper takes an available commercial wind turbine as an example in the case study 3 2 2 energy storage modeling as shown in fig 3 the energy storage sub system can be charged by excess wind power and the output power of the energy storage sub system can be used to feed the load demands the stored electricity of the energy storage sub system dynamically changes in the charging and discharging processes which can be formulated by the following equation 2 e t e t 1 1 σ b η c h q t c h 1 η d i s c q t d i s c where e t is the state of energy storage sub system at time step t kwh σ b is the self discharge rate η c h and η d i s c are the coefficients of charging and discharging efficiency which are within the interval 0 1 q t c h is the charging energy at time step t kwh and q t d i s c is the discharging energy at time step t kwh besides essential technical constraints should be satisfied to ensure safety of the system during the charging and discharging processes zhang et al 2018 shown as follows 3 e min e t e max 4 p t c h 0 2 e t δ t 5 p t d i s c 0 2 e t δ t where e min is the minimum energy storage kwh e max is the maximum energy storage kwh δ t is the charging or discharging duration at each time step 3 2 3 on shore power modeling on shore power supply is the process of a ship receiving power from the shore and the general requirements for connecting ships and shore supply are illustrated in iec iso ieee80005 1 iec iso ieee 80005 1 2012 on the shoreside the frequency converter can convert the electrical frequency provided by utility supply to satisfy the frequency demands of ships besides shore transformers can provide galvanic isolation and voltage step up down to match the voltage of shore and ships also required in on shore power sub system are berth side switchboard and shore connection switchboard which provide protection to the connecting cables and other sub system of ships respectively due to the complicated characteristics of on shore power system it is time consuming and costly to construct such a system besides different arriving patterns of ships will lead to different impacts on the size of on shore power installations winkel et al 2016 peng et al 2018b therefore this paper takes the investment and operation of on shore power sub system into the objective function to find a most economical construction solution with consideration of appropriate capacity for different arriving ships 4 mathematical model in this paper minimizing the system cost consisting of investment cost and operation cost is formulated and considered as the objective function and a lot of constraints are taken into account in the optimal model of hres design in mathematical terms the optimal design problem can be formulated as the following optimization model 6 m i n f x x n w n s n o s q j 1 c h q j t c h q j 1 d i s c q j t d i s c e 1 e n s q 1 q t s t g i x 0 i 1 2 a e q h j x 0 j 1 2 a i n e q where f x represents the objective function which is the system cost consisting of investment cost and operation cost a e q and a i n e q are the number of equality and inequality constraints respectively x is a set of decision variables including the quantity of wind energy installations energy storage installations and on shore power installations the charging discharging energy to from storage sub systems the state of energy stored at time step t and the scheduled energy from conventional energy at time step t the nomenclature used in this mathematical model is shown in table 1 4 1 the first stage the optimal capacity allocation of different sub systems is implemented in this stage meaning the selection and sizing of the components that should be installed in the hres objective function the objective of this stage is to minimize the investment cost of all the sub systems including fixed investment cost and linear investment cost as shown below 7 min c i c i w c i s c i o s i 1 i c f w i p w i c l w i x i c r f i j 1 j c f s j q s j c l s j y j c r f j b 1 b k 1 k y b k c f o s k p o s k c l o s k z k c r f k where c i is the investment cost of all the sub systems c i w c i s and c i o s represent respectively the annual investment cost of wind energy sub system energy storage sub system and on shore power sub system the capital recovery factor of the wind energy installation i c r f i is defined in eq 8 used to annualize the investment cost the capital recovery factors of the energy storage installation j and the on shore power installation k is defined in a similar manner as eq 9 eq 10 8 c r f i r r 1 m w i r 1 m w i 1 9 c r f j r r 1 m s j r 1 m s j 1 10 c r f k r r 1 m o s k r 1 m o s k 1 constraints to guarantee the stable operation of the hres some equality and inequality constraints should be met 11 i 1 i x i n w 12 j 1 j y j n s 13 k 1 k z k n o s 14 k 1 k z k y b k 1 b 1 2 b 15 y b k 0 1 16 k 1 k p o s k δ t z k y b k max t π q b t r s b 1 2 b 17 p w i p w q s j q s p o s k p o s i θ j ξ k ω constraint 11 constraint 13 represent the quantity limitations of the wind energy installations the energy storage installations and the on shore power installations due to the land restriction constraint 14 constraint 15 represent that only one on shore power sub system is installed at each berth constraint 16 represents that the installed capacity of on shore power sub system at each berth is higher than the energy demands of ships at each time step t constraint 17 represents that the capacity selection of the on shore power installations wind energy installations and energy storage installations 4 2 the second stage the second stage aims to optimizing the operation patterns of the installed sub systems which takes power balances capacity limitations and emission regulations as constraints objective function once the installations of all the sub systems the objective of this stage is to optimize the operation cost through the operation optimization of the installed sub systems as shown below 18 c o p c o p w c o p s c o p o s c o p g i 1 i x i p w i μ w c r f i j 1 j y j q s j μ s c r f j k 1 k z k p o s k μ o s c r f k t 1 t q t μ g where c o p w c o p s c o p o s and c o p g represent the operation cost of installed wind energy sub system installed energy storage sub system and installed on shore power sub system and the annual cost of scheduled electricity from conventional energy constraints at each time step t some equality and inequality constraints such as power balances capacity limitations and emission regulations should be met for the stable operation of a hres 19 t 1 t q t c e i 1 i t 1 t c w x i q i t w c lim 20 q t i 1 i x i q i t w j 1 j y j q j t c h j 1 j y j q j t d i s c q r t 21 q i t w p w i δ t 22 e j t e j t 1 1 σ b j η c h j q j t c h 1 η d i s c j q j t d i s c 23 e min j e j t e max j 24 q j t c h 0 2 e j t 25 q j t d i s c 0 2 e j t 26 q k t o s δ t p o s k constraint 19 represents the emission constraint which is used to ensure the optimal cost under a specific emission threshold constraint 20 represents the constraint of energy supply and demand balance at each time step t constraint 21 represents the technical constraint of the installed wind energy sub system which ensures the wind power at each time step t is smaller than the installed capacity constraint 22 represents the technical constraint of energy storage sub system which describes the relationship between the state of energy stored at time steps t and time step t 1 constraint 23 constraint 25 represent the constraints of state of stored energy charging and discharging energy at time step t to ensure the safety of energy storage sub system 5 solution methodology for solving the above optimization model the step by step solution procedure is shown in fig 5 which includes two stages respectively optimal installed capacity and hourly optimal operation firstly energy demands in seaports at each berth and at each time step are obtained by using the proposed simulation based method as shown in section 3 1 then the energy demands along with the cost and set of optional sub systems are taken as input parameters which are fed into the solution algorithm finally the procedure is pushed forward by the installed capacity optimization in the first stage followed by the hourly operation optimization in the second stage as described in fig 5 input parameters such as cost set of optional sub systems and energy demands at each berth are fed into the first stage then the feasible settings of decision variables are generated which in conjunction with input parameters are used to optimize the investment cost under the condition of model constraints when all the feasible settings are enumerated the sets of the optimal installed capacity of all the sub systems can be obtained for the first stage in the second stage input data such as the optimal results from the first stage wind power at each time step according to wind power modelling the energy demands at each time step obtained from simulation model is fed into the procedure to optimize the operation strategy of the hres at each time step during the process of hourly operation optimization the constraints such as emission constraints energy supply and demand balances energy storage constraints and on shore power constraints should be satisfied when the optimal results of hourly operations do not meet the constraints the sets of the optimal installed capacity of all the sub systems should be reselected in the first stage in the optimization process wind energy is considered as the priority energy source and conventional energy is taken as a backup source when wind power output is larger than the energy demands at a time step the excess electricity is stored in the energy storage sub system when wind power output is lower than the energy demands the required electricity is firstly supplied by wind power considering the emission constraints then by the electricity stored in the energy storage sub system and finally by the scheduled electricity from conventional energy generation until the hourly operations at each time step are optimized the optimal cost consisting of the investment cost and operation cost can be calculated and the proposed procedure is terminated 6 case study 6 1 parameter settings the proposed approach is tested on a container port in southern china with five container berths a collection of hourly mean wind speed in one year around the container port has been carried out and the distribution characteristics of the hourly mean wind speed are shown in fig 6 the quantity limitations of the wind energy installations and energy storage installations are 10 and 5 respectively and the detailed parameters of the adopted wind energy sub system and energy storage sub system in this paper are listed in table 2 table 3 and fig 7 besides according to the recommended values of on shore power supply in the technical code of shore on ship power supply system the optional power capacity of the on shore power sub system is set as 630 kw 800 kw 1000 kw 1600 kw 2000 kw and 3000 kw and the lifetime of the on shore power system is 20 years the fixed cost linear capacity dependent cost and operation cost for the on shore power installation are 800 thousand 3 5 thousand kw and 0 24 kw respectively according to the industrial electricity price in china the price of scheduled electricity from conventional energy generation is 0 0927 kwh and the emission coefficient of wind power system and conventional energy generation is set as 0 0165kg kwh and 0 9515kg kwh respectively in addition the emission limitations are set as 60 thousand tons year in this paper due to a lack of data concerning energy demands in the seaport this paper applies a simulation based method to obtain the energy demands it is essential to give a detailed description on the input data used in the simulation model the seaport used in the simulation experiments is 1644 m long and the tonnage of berths and the number of quay cranes assigned to each berth are presented in table 4 besides the working efficiency of each quay crane for handling operation is 35 teu h additional input parameters such as weather conditions are provided by the port company the following is focusing on parameters of ships and handling facilities parameters of ships according to the frequency curve fitting of the real operation data ships arrive at the container port with inter arrival time obeying negative exponential distribution and the average value of ship s inter arrival is 4 6 h the type combinations of ships such as tonnage proportion average handled quantity and berth number for ship mooring are listed in table 5 and the auxiliary working time for ships is set as 3 0 h parameters of handling facilities in order to obtain the energy demands of handling facilities electricity consumed for handling one container is necessary which is set as 5 23 kwh teu and 3 03 kwh teu in this paper respectively 6 2 simulation results and analysis in this section the energy demands in the container port at each time step are output by conducting the simulation experiments using arena software besides the power outputs of wind energy sub systems are calculated by means of wind power modeling in section 3 2 1 with real wind data after feeding the input data into the procedure the optimal installed capacity the optimal hourly operation strategy and the optimal system cost of the hres can be obtained under the constraints by the two stage algorithm 6 2 1 optimal results of the hres after running the optimization model the optimal system cost of the hres are obtained which is 1178 28 ten thousand year the optimal quantity of the wind energy installations and energy storage installations is 7 and 2 respectively which means the installed capacity of the wind energy sub system and energy storage sub system is 5 95 mw and 6 mwh the optimal capacity of on shore power sub system at each berth is shown in table 6 meanwhile fig 8 shows the optimal hourly operation strategy of the hres in a typical day as illustrated in fig 8 energy demands in the seaport and electricity outputs of wind energy sub systems represent highly dynamic nature in one day which creates difficulties in energy supply and demand balances the difficulties above can be solved by the application of energy storage sub system for example electricity outputs of wind energy are not enough to meet energy demands in the seaport in time step 1 step 13 therefore the shortage of energy demands is supplemented by discharged energy from energy storage sub systems and scheduled electricity from conventional energy generations conversely in time step 14 step 17 the electricity outputs of wind energy are greater than the energy demands and the excess energy is charged to the energy storage sub system 6 2 2 analysis of the emission limitations on optimal results considering the emission regulations in different regions this paper thereby focuses on the sensitivity of the emission limitations on the optimal results taking the emission limitations as 60 thousand tons year 62 5 thousand tons year 65 thousand tons year 67 5 thousand tons year and 70 thousand tons year this paper analyzes the optimal system cost and the optimal installed capacity of wind energy sub systems and energy storage sub systems as shown in fig 9 as illustrated in fig 9 when the emission limitations increase step by step the quantity of wind energy installations decreases respectively and the quantity of energy storage installations reduces correspondingly owing to the variations of wind power output lessening therefore the optimal system cost reduces with the emission limitation increasing when the emission limitations are 70 thousand tons year there is no need to install the wind energy sub systems and the energy storage sub systems because the energy demands in the seaport are satisfied by the scheduled energy from the conventional energy generations 6 2 3 analysis of the wind speed on optimal results from the perspective of natural condition variations the port operators are more attentive to how to determine the optimal design of the hres under different natural conditions therefore this paper analyzes the optimal results under different wind speeds when emission limitations change from 60 thousand tons year to 70 thousand tons year as shown in fig 10 fig 14 as illustrated in figs 10 11 when the wind speed increases the quantity of wind energy installations and the optimal system cost of the hres reduces correspondingly while as illustrated in fig 12 when emission limitations are 65 thousand tons year the system cost decreases by 4 7 with the wind speed increasing besides when emission limitations are 67 5 thousand tons year as shown in fig 13 there is a need to allocation only one wind turbine for the container terminal with wind speed increasing furthermore as shown in fig 14 when emission limitations are 70 thousand tons year there is no need of wind energy systems in that the energy demands in the container terminal can be supplied only by the scheduled electricity from conventional energy system due to the satisfaction of emission limitation therefore the optimal system cost the quantity of wind energy installations and the quantity of the energy storage installations do not change with wind speed increasing however the optimal installed capacity of on shore power sub systems at each berth is the same under different emission limitations and wind speeds because the installed capacity is affected by the maximum energy demands at each berth which is influenced by the arrival patterns of ships and berth allocation 6 2 4 analysis of the arrival interval of ships on optimal results with consideration of stochastic characteristics of arriving ships this paper thereby studies the impact of arrival interval of ships on the optimal results by consulting with the port operators this paper analyzes the optimal allocation for the hres under the arrival interval of ships set as 5 0 h and the results are shown in fig 15 as illustrated in fig 15 when the emission limitations increase step by step the quantity of wind energy installations decreases respectively and the quantity of energy storage installations keep at zero besides the system cost under corresponding emission limitations in fig 15 is lower than the cost in fig 9 due to energy demands in the container terminal decreasing 7 conclusions the contribution of this paper is to propose a two stage optimal framework to solve the optimal design problem of a hres for seaports firstly models of wind energy sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the optimal installed capacity of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints due to a lack of data concerning energy demands in seaports this paper applies a simulation based method to output the energy demands considering various stochastic environments in seaports finally the optimal results and the sensitivity of the optimal operation of the hres to emission limitations and wind speeds have also been analyzed in the case study 1 energy demands in seaports and power outputs of wind energy sub systems represent highly dynamic nature in a typical day and the difficulties in balancing energy supply and demand can be resolved by the application of energy storage systems 2 when the emission limitations increase step by step the quantity of wind energy installations and energy storage installations decreases correspondingly which results in the optimal system cost reduction when the emission limitations are 70 thousand tons year energy demands in the seaport can be met only by the scheduled energy from the conventional energy generations 3 when the emission limitations are higher than 65 thousand tons year the optimal system cost and the quantity of wind energy installations and energy storage installations do not change with the wind speed increasing 4 the optimal installed capacity of on shore power sub systems at each berth is the same under different emission limitations and wind speeds the results and proposed method can be applied to determine the optimal installation capacity and operation strategy of wind storage on shore power hybrid energy system for a container seaport under different emission limitations and wind speeds however this paper focuses on the system optimization regardless of the influence factors on the optimal results of on shore power sub systems such as berth allocation future study should improve the optimization performance for the hres optimization considering future hybrid and electric ships and the arrival patterns acknowledgments this research was funded by the national natural science foundation of china grant number no 51709037 and 51779037 we would also like to thank the fundamental research funds for the central universities no dut18rc 4 053 and doctoral start up foundation of liaoning province no 20170520165 for supporting this research 
22425,the contribution of this paper is to propose a two stage optimal framework to solve the optimal design problem of a hybrid renewable energy system hres for seaports firstly models of wind energy sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the optimal installed capacity of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints due to a lack of data concerning energy demands in seaports this paper applies a simulation based method to output the energy demands considering various stochastic environments in seaports finally taking a container seaport in southern china as an example this paper obtains the optimal results by the proposed algorithm and analyzes the sensitivity of emission limitations and wind speeds on the optimal operation of the hres the results obtained and proposed method can be used to provide references for power department policy making and green container port construction keywords hybrid renewable energy system green container ports on shore power system two stage optimization method wind energy 1 introduction given the heightened concerns on energy crisis environment pollution and climate change many green energy technologies have been implemented among seaports worldwide to realize the transition from fossil fuels to clean and sustainable energy peng et al 2019 li et al 2018 davarzani et al 2016 on shore power supply also known as cold ironing is one of the energy transition strategies by applying electricity power supplied from the shore to satisfy the energy demands of ships at berth vaishnav et al 2016 zis et al 2014 the uptake of alternative fuels such as liquefied natural gas is another adopted transition measure for ships when transporting among seaports styhre et al 2017 in addition the handling facilities of seaports have gradually achieved the replacement of diesel equipment with electric handling equipment such as electric rubber tired gantries e rtg and electric quay cranes peng et al 2018a yang and chang 2013 besides on shore power supply alternative fuels and energy transition from diesel to electricity wind energy is usually welcomed to feed the electricity loads of seaports to realize the significant emission abatement kotrikla et al 2017 kim and park 2010 acciaro et al 2014 thus the energy demands in seaports can be satisfied by a hybrid renewable energy system hres which consists of wind energy on shore power supply energy storage and conventional power ahamad et al 2018a optimal design of such a hres can be a challenging task though due to the multiple design objectives highly constraints and uncertainties of wind energy and energy demands however in order to take full advantage of renewable energy and save the system cost it is worthy to study the optimal design of the hres for seaport applications faced with above challenges therefore this paper proposes a two stage optimal framework to solve the design problem of a hres for seaports at first models of wind generation sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the capacity allocation of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints finally the optimal results and the effects of various emission constraints on the optimal operation of the hres have also been analyzed in the case study the rest of this paper is organized as follows in section 2 the related literature is reviewed on hress applied in seaports and the optimal design of hress problem formulation consisting of end use energy analysis and models of wind generation sub systems energy storage sub systems and on shore power supply sub systems are presented in section 3 in section 4 the proposed two stage optimal framework is discussed and each stage is explained in detail solution methodology for the problem is described in section 5 and comparative case studies under various emission constraints are implemented in section 6 finally the paper is concluded in section 7 2 literature review in recent years due to the fossil energy depletion and environmental issues developing renewable energy systems become urgent for sustainable goals as an energy intensive industry ports account for 3 of global greenhouse gas emissions misra et al 2017 sustainable initiatives and green port constructions are driving the use of renewable energy sources to develop hress for supplying the electricity to the load of seaports efiport 2008 heras saizarbitoria et al 2013 ramos et al 2014 hentschel et al 2018 for hress applied in port applications ahamad et al presented the optimal sizing of battery wind photovoltaic grid converter hres at the seaport in copenhagen denmark which was optimized by homer software ahamad et al 2018b mertikas et al summarized the main results of the european project introducing cold ironing as an appealing alternative towards greener ports and discussed the opportunities of turning the ports as smart energy hubs where renewable energy sources are deployed mertikas et al 2018 ahamad et al studied the integration of microgrid technologies in conventional seaports and optimized the photovoltaic wind energy storage system to the use of shore side power ahamad et al 2018a kumar et al proposed an innovative design concept of the harbor area smart grid and validated the performance to supply the ships for cold ironing purpose but also support the hybrid ships of future technology kumar et al 2017 misra et al discussed and detailed the benefits of implementing microgrids containing renewable energy resources and suitable energy storage technologies to achieve sustainable port energy management and concluded that the energy storage systems are able to provide 60 of the port s total daily electricity requirements misra et al 2017 for hress applied in ships at berth photovoltaic system energy storage system on shore power supply and on board diesel generators are always contained to satisfy the energy demands many researchers have been devoted to identifying the optimal design of a hres for ships lan et al proposed an optimal sizing method for a hybrid photovoltaic diesel storage ship power system which minimized the investment cost fuel cost and co2 emissions lan et al 2015 tang et al proposed an optimal energy management model and control methodology to obtain operational safety and efficiency of a hres for large green ships while at berth which minimized the total cost of ships tang et al 2018a yuan et al proposed a design for the solar diesel hybrid powered ship and analyzed the corresponding environmental benefits compared to fuel consumptions yuan et al 2018 as for the use of on shore power supply kumar et al provided a review of technical aspects and existing standards in designing and modelling of a harbor grid for on shore power supply kumar et al 2019 tang et al developed an optimal model of photovoltaic battery diesel cold ironing hybrid energy system for ships at berth and discussed the promising electricity cost savings brought by the optimal operation of the hres tang et al 2018b for microgrid applied in handling facilities of seaports most studies mainly focused on optimal management strategy for e rtg with energy storage system alasali et al presented and verified an optimal energy control strategy for an energy storage system connected to a network of e rtgs based on a stochastic model predictive control algorithm which aimed at reducing electrical energy costs alasali et al 2019 paris et al presented an advanced drive system for the port cranes to optimize the energy absorption and save the energy costs parise and honorati 2014 papaioannou et al designed an electric system of an e rtg with the addition of an energy storage system and estimated the potential emission reduction papaioannou et al 2017 alasali et al presented an artificial neural network prediction model and optimal solution for a single crane system to minimize the electric energy costs and maximize the peak demand reduction alasali habenv becerraet al 2017 as renewable resources such as wind and solar energy can be employed for green port application optimal design method is required for optimally installing and operating such a hybrid energy system as for the optimal design of hress eriksson and gray developed a multi objective optimization model of designing a hres to realize technical economic environmental and socio political objectives which is solved by particle swarm optimization method eriksson and gray 2019 feroldi and zumoffen proposed a sizing methodology for hybrid systems taking into considerations various renewable energy resources incorporated into the energy management strategy feroldi and zumoffen 2014 gonzález et al developed a sizing approach of hybrid grid connected photovoltaic wind power systems based on real wind and solar irradiation data and electricity demand aiming at reducing installation costs gonzález et al 2015 ghorbani et al developed a hybrid genetic algorithm with particle swarm optimization for the optimal sizing of an off grid house applied by a photovoltaic wind battery system which aimed at reducing cost and increasing reliability ghorbani et al 2018 sawle et al proposed an optimal design method of a hres with consideration of various criteria about economic technical and social effect and used different optimization techniques such as teaching learning based optimization to solved the model sawle et al 2018 in the optimal design of hress one issue that must to be considered is the coordination of energy supply and demand for example dahmane et al proposed an intelligent algorithm for optimal power management of a hres containing a photovoltaic wind diesel generator and battery energy storage to achieve the matching between electricity supply and load demand dahmane et al 2013 shaahid and elhadidy evaluated the techno economic utilities by using hybrid photovoltaic diesel battery power systems to supply the load demand of a typical commercial building shaahidma 2007 however the energy demands in seaports is highly dynamic and stochastic which is influenced by many uncertain factors such as weather condition daily schedule and status of handling facilities to overcome the above challenges in the condition of no real energy data it is a useful method to formulate and evaluate such a complex system in seaports by discrete event simulation to obtain the energy demands at every time step for example grundmeier et al presented a simulation based method to provide a load curve forecast of short term energy demands in a container seaport grundmeier et al 2014 as mentioned above optimizing hres design for ships at berth has attracted wide attention in the existing literature however the configuration and operation of a hres for the whole seaport are quite particular and complicated compared to the ship application due to long term dynamic and stochastic operation processes in seaports besides few studies optimize the hybrid renewable energy system for seaports simultaneously considering environmental and economic benefits as a result the configuration sizing methodology and operation strategy of a hres for port application are still unresolved issues that are worthy to be studied therefore this paper develops a simulation based method to obtain the energy demands in seaports at every time step at first then considering the coordination of energy supply and demand a two stage framework for optimal design of a hres for seaports are proposed to minimize the system cost finally the optimal design model of the problem is resolved by the proposed solution methodology and the optimal results are obtained 3 problem formulation in this section the problem is described which consists of uncertainty analysis of energy demands in seaports and the hybrid renewable energy system for port application 3 1 uncertainty analysis of energy demands in seaports a container port generally contains three components berth yard and gate where ships and handling facilities i e quay cranes trucks and yard cranes are taken as the main energy consumers as shown in fig 1 during the operation processes in seaports electricity supplied from on shore power to ships mainly satisfies the hoteling load demands of ships such as lighting heating ventilation and air conditioning electricity used by quay cranes mainly meets the load demand of picking containers up from ships moving containers horizontally and dropping containers on trucks electricity utilized by yard cranes mainly fulfills the load demand of the horizontal movement of the trolley the upwards and downwards movement of the spreader and the gantry movement along the container stack however a container port operation system is very complicated and stochastic including many sub systems such as ships arriving leaving through waterway subsystem ships berthing at berth and being handled subsystem containers assignment and being handled transported subsystem which are queuing systems that are interconnected peng et al 2018a furthermore the energy demands in seaports are highly dynamic and stochastic which are influenced by many uncertain factors grundmeier et al 2014 to overcome the above challenges in the condition of no real energy data this paper develops a useful method to formulate and model the energy demands in seaports by discrete event simulation at each time step the structure of the simulation based method is presented in fig 2 and consists of three steps in step i the simulation model is developed to simulate the whole operation processes in seaports including ship arriving and berthing sub model handling operation sub model and ship departing sub model in step ii the deterministic and uncertain parameters such as weather conditions daily schedule and status of handling facilities are assigned appropriate values and are given to the model after conducting the simulation model the energy demands at each time step can be obtained in step iii 3 2 hybrid renewable energy system for port application when the load demands are supplied by renewable resources individually problems of low reliability and security due to intermittent and variability will influence the performance of energy supply system which can be solved effectively with hress erdinc and uzunoglu 2012 bahramara et al 2016 the adopted hres in this paper comprises wind energy sub system energy storage sub system on shore power sub system and conventional energy sub system which fulfills the load demands of ships electric quay cranes and electric yard cranes as represented in fig 3 the power electronic interfaces and transformers can perform frequency and voltage conversion respectively to match energy supply and demand systems and on shore power can provide required electricity to ships while at berth in the adopted hres wind energy is considered as the priority energy source and conventional energy is taken as a backup source besides to ensure a continued and stable electricity supply energy storage sub system is needed to store excess electricity from wind energy and discharge electricity when the production is deficit the following mainly focus on the wind power modeling energy storage modeling and on shore power modeling 3 2 1 wind power modeling the power curve of a wind turbine describes the electrical power output of wind energy generation as a function of wind speed zare and niknam 2013 as shown in fig 4 electricity is generated once wind speed exceeds the cut in wind speed v i n of the wind turbine and the rated power p r is reached at the rated speed v r since then the power output maintains the constant at the rated power p r till the cut off wind speed v o u t in related studies a typical liner mathematical model for power outputs of wind energy generation is adopted to approximate the nonlinear power curve of wind turbines zare and niknam 2013 shin et al 2017 which is formulated as follows 1 p w v 0 0 v v i n p r v v i n v r v i n v i n v v r p r v r v v o u t 0 v v o u t where p w v is the power output of wind energy at wind speed v and p r is the rated power besides v r is the rated wind speed v i n and v o u t are the cut in wind speed and cut out wind speed respectively however due to the variation of weather conditions such as temperature wind speed and wind directions the power outputs of wind turbines from theoretical analysis always represent significant deviations from the measured power curve ciulla et al 2019 with the consideration of the higher reliability of measured power curves compared to theoretical analysis in the real project this paper takes an available commercial wind turbine as an example in the case study 3 2 2 energy storage modeling as shown in fig 3 the energy storage sub system can be charged by excess wind power and the output power of the energy storage sub system can be used to feed the load demands the stored electricity of the energy storage sub system dynamically changes in the charging and discharging processes which can be formulated by the following equation 2 e t e t 1 1 σ b η c h q t c h 1 η d i s c q t d i s c where e t is the state of energy storage sub system at time step t kwh σ b is the self discharge rate η c h and η d i s c are the coefficients of charging and discharging efficiency which are within the interval 0 1 q t c h is the charging energy at time step t kwh and q t d i s c is the discharging energy at time step t kwh besides essential technical constraints should be satisfied to ensure safety of the system during the charging and discharging processes zhang et al 2018 shown as follows 3 e min e t e max 4 p t c h 0 2 e t δ t 5 p t d i s c 0 2 e t δ t where e min is the minimum energy storage kwh e max is the maximum energy storage kwh δ t is the charging or discharging duration at each time step 3 2 3 on shore power modeling on shore power supply is the process of a ship receiving power from the shore and the general requirements for connecting ships and shore supply are illustrated in iec iso ieee80005 1 iec iso ieee 80005 1 2012 on the shoreside the frequency converter can convert the electrical frequency provided by utility supply to satisfy the frequency demands of ships besides shore transformers can provide galvanic isolation and voltage step up down to match the voltage of shore and ships also required in on shore power sub system are berth side switchboard and shore connection switchboard which provide protection to the connecting cables and other sub system of ships respectively due to the complicated characteristics of on shore power system it is time consuming and costly to construct such a system besides different arriving patterns of ships will lead to different impacts on the size of on shore power installations winkel et al 2016 peng et al 2018b therefore this paper takes the investment and operation of on shore power sub system into the objective function to find a most economical construction solution with consideration of appropriate capacity for different arriving ships 4 mathematical model in this paper minimizing the system cost consisting of investment cost and operation cost is formulated and considered as the objective function and a lot of constraints are taken into account in the optimal model of hres design in mathematical terms the optimal design problem can be formulated as the following optimization model 6 m i n f x x n w n s n o s q j 1 c h q j t c h q j 1 d i s c q j t d i s c e 1 e n s q 1 q t s t g i x 0 i 1 2 a e q h j x 0 j 1 2 a i n e q where f x represents the objective function which is the system cost consisting of investment cost and operation cost a e q and a i n e q are the number of equality and inequality constraints respectively x is a set of decision variables including the quantity of wind energy installations energy storage installations and on shore power installations the charging discharging energy to from storage sub systems the state of energy stored at time step t and the scheduled energy from conventional energy at time step t the nomenclature used in this mathematical model is shown in table 1 4 1 the first stage the optimal capacity allocation of different sub systems is implemented in this stage meaning the selection and sizing of the components that should be installed in the hres objective function the objective of this stage is to minimize the investment cost of all the sub systems including fixed investment cost and linear investment cost as shown below 7 min c i c i w c i s c i o s i 1 i c f w i p w i c l w i x i c r f i j 1 j c f s j q s j c l s j y j c r f j b 1 b k 1 k y b k c f o s k p o s k c l o s k z k c r f k where c i is the investment cost of all the sub systems c i w c i s and c i o s represent respectively the annual investment cost of wind energy sub system energy storage sub system and on shore power sub system the capital recovery factor of the wind energy installation i c r f i is defined in eq 8 used to annualize the investment cost the capital recovery factors of the energy storage installation j and the on shore power installation k is defined in a similar manner as eq 9 eq 10 8 c r f i r r 1 m w i r 1 m w i 1 9 c r f j r r 1 m s j r 1 m s j 1 10 c r f k r r 1 m o s k r 1 m o s k 1 constraints to guarantee the stable operation of the hres some equality and inequality constraints should be met 11 i 1 i x i n w 12 j 1 j y j n s 13 k 1 k z k n o s 14 k 1 k z k y b k 1 b 1 2 b 15 y b k 0 1 16 k 1 k p o s k δ t z k y b k max t π q b t r s b 1 2 b 17 p w i p w q s j q s p o s k p o s i θ j ξ k ω constraint 11 constraint 13 represent the quantity limitations of the wind energy installations the energy storage installations and the on shore power installations due to the land restriction constraint 14 constraint 15 represent that only one on shore power sub system is installed at each berth constraint 16 represents that the installed capacity of on shore power sub system at each berth is higher than the energy demands of ships at each time step t constraint 17 represents that the capacity selection of the on shore power installations wind energy installations and energy storage installations 4 2 the second stage the second stage aims to optimizing the operation patterns of the installed sub systems which takes power balances capacity limitations and emission regulations as constraints objective function once the installations of all the sub systems the objective of this stage is to optimize the operation cost through the operation optimization of the installed sub systems as shown below 18 c o p c o p w c o p s c o p o s c o p g i 1 i x i p w i μ w c r f i j 1 j y j q s j μ s c r f j k 1 k z k p o s k μ o s c r f k t 1 t q t μ g where c o p w c o p s c o p o s and c o p g represent the operation cost of installed wind energy sub system installed energy storage sub system and installed on shore power sub system and the annual cost of scheduled electricity from conventional energy constraints at each time step t some equality and inequality constraints such as power balances capacity limitations and emission regulations should be met for the stable operation of a hres 19 t 1 t q t c e i 1 i t 1 t c w x i q i t w c lim 20 q t i 1 i x i q i t w j 1 j y j q j t c h j 1 j y j q j t d i s c q r t 21 q i t w p w i δ t 22 e j t e j t 1 1 σ b j η c h j q j t c h 1 η d i s c j q j t d i s c 23 e min j e j t e max j 24 q j t c h 0 2 e j t 25 q j t d i s c 0 2 e j t 26 q k t o s δ t p o s k constraint 19 represents the emission constraint which is used to ensure the optimal cost under a specific emission threshold constraint 20 represents the constraint of energy supply and demand balance at each time step t constraint 21 represents the technical constraint of the installed wind energy sub system which ensures the wind power at each time step t is smaller than the installed capacity constraint 22 represents the technical constraint of energy storage sub system which describes the relationship between the state of energy stored at time steps t and time step t 1 constraint 23 constraint 25 represent the constraints of state of stored energy charging and discharging energy at time step t to ensure the safety of energy storage sub system 5 solution methodology for solving the above optimization model the step by step solution procedure is shown in fig 5 which includes two stages respectively optimal installed capacity and hourly optimal operation firstly energy demands in seaports at each berth and at each time step are obtained by using the proposed simulation based method as shown in section 3 1 then the energy demands along with the cost and set of optional sub systems are taken as input parameters which are fed into the solution algorithm finally the procedure is pushed forward by the installed capacity optimization in the first stage followed by the hourly operation optimization in the second stage as described in fig 5 input parameters such as cost set of optional sub systems and energy demands at each berth are fed into the first stage then the feasible settings of decision variables are generated which in conjunction with input parameters are used to optimize the investment cost under the condition of model constraints when all the feasible settings are enumerated the sets of the optimal installed capacity of all the sub systems can be obtained for the first stage in the second stage input data such as the optimal results from the first stage wind power at each time step according to wind power modelling the energy demands at each time step obtained from simulation model is fed into the procedure to optimize the operation strategy of the hres at each time step during the process of hourly operation optimization the constraints such as emission constraints energy supply and demand balances energy storage constraints and on shore power constraints should be satisfied when the optimal results of hourly operations do not meet the constraints the sets of the optimal installed capacity of all the sub systems should be reselected in the first stage in the optimization process wind energy is considered as the priority energy source and conventional energy is taken as a backup source when wind power output is larger than the energy demands at a time step the excess electricity is stored in the energy storage sub system when wind power output is lower than the energy demands the required electricity is firstly supplied by wind power considering the emission constraints then by the electricity stored in the energy storage sub system and finally by the scheduled electricity from conventional energy generation until the hourly operations at each time step are optimized the optimal cost consisting of the investment cost and operation cost can be calculated and the proposed procedure is terminated 6 case study 6 1 parameter settings the proposed approach is tested on a container port in southern china with five container berths a collection of hourly mean wind speed in one year around the container port has been carried out and the distribution characteristics of the hourly mean wind speed are shown in fig 6 the quantity limitations of the wind energy installations and energy storage installations are 10 and 5 respectively and the detailed parameters of the adopted wind energy sub system and energy storage sub system in this paper are listed in table 2 table 3 and fig 7 besides according to the recommended values of on shore power supply in the technical code of shore on ship power supply system the optional power capacity of the on shore power sub system is set as 630 kw 800 kw 1000 kw 1600 kw 2000 kw and 3000 kw and the lifetime of the on shore power system is 20 years the fixed cost linear capacity dependent cost and operation cost for the on shore power installation are 800 thousand 3 5 thousand kw and 0 24 kw respectively according to the industrial electricity price in china the price of scheduled electricity from conventional energy generation is 0 0927 kwh and the emission coefficient of wind power system and conventional energy generation is set as 0 0165kg kwh and 0 9515kg kwh respectively in addition the emission limitations are set as 60 thousand tons year in this paper due to a lack of data concerning energy demands in the seaport this paper applies a simulation based method to obtain the energy demands it is essential to give a detailed description on the input data used in the simulation model the seaport used in the simulation experiments is 1644 m long and the tonnage of berths and the number of quay cranes assigned to each berth are presented in table 4 besides the working efficiency of each quay crane for handling operation is 35 teu h additional input parameters such as weather conditions are provided by the port company the following is focusing on parameters of ships and handling facilities parameters of ships according to the frequency curve fitting of the real operation data ships arrive at the container port with inter arrival time obeying negative exponential distribution and the average value of ship s inter arrival is 4 6 h the type combinations of ships such as tonnage proportion average handled quantity and berth number for ship mooring are listed in table 5 and the auxiliary working time for ships is set as 3 0 h parameters of handling facilities in order to obtain the energy demands of handling facilities electricity consumed for handling one container is necessary which is set as 5 23 kwh teu and 3 03 kwh teu in this paper respectively 6 2 simulation results and analysis in this section the energy demands in the container port at each time step are output by conducting the simulation experiments using arena software besides the power outputs of wind energy sub systems are calculated by means of wind power modeling in section 3 2 1 with real wind data after feeding the input data into the procedure the optimal installed capacity the optimal hourly operation strategy and the optimal system cost of the hres can be obtained under the constraints by the two stage algorithm 6 2 1 optimal results of the hres after running the optimization model the optimal system cost of the hres are obtained which is 1178 28 ten thousand year the optimal quantity of the wind energy installations and energy storage installations is 7 and 2 respectively which means the installed capacity of the wind energy sub system and energy storage sub system is 5 95 mw and 6 mwh the optimal capacity of on shore power sub system at each berth is shown in table 6 meanwhile fig 8 shows the optimal hourly operation strategy of the hres in a typical day as illustrated in fig 8 energy demands in the seaport and electricity outputs of wind energy sub systems represent highly dynamic nature in one day which creates difficulties in energy supply and demand balances the difficulties above can be solved by the application of energy storage sub system for example electricity outputs of wind energy are not enough to meet energy demands in the seaport in time step 1 step 13 therefore the shortage of energy demands is supplemented by discharged energy from energy storage sub systems and scheduled electricity from conventional energy generations conversely in time step 14 step 17 the electricity outputs of wind energy are greater than the energy demands and the excess energy is charged to the energy storage sub system 6 2 2 analysis of the emission limitations on optimal results considering the emission regulations in different regions this paper thereby focuses on the sensitivity of the emission limitations on the optimal results taking the emission limitations as 60 thousand tons year 62 5 thousand tons year 65 thousand tons year 67 5 thousand tons year and 70 thousand tons year this paper analyzes the optimal system cost and the optimal installed capacity of wind energy sub systems and energy storage sub systems as shown in fig 9 as illustrated in fig 9 when the emission limitations increase step by step the quantity of wind energy installations decreases respectively and the quantity of energy storage installations reduces correspondingly owing to the variations of wind power output lessening therefore the optimal system cost reduces with the emission limitation increasing when the emission limitations are 70 thousand tons year there is no need to install the wind energy sub systems and the energy storage sub systems because the energy demands in the seaport are satisfied by the scheduled energy from the conventional energy generations 6 2 3 analysis of the wind speed on optimal results from the perspective of natural condition variations the port operators are more attentive to how to determine the optimal design of the hres under different natural conditions therefore this paper analyzes the optimal results under different wind speeds when emission limitations change from 60 thousand tons year to 70 thousand tons year as shown in fig 10 fig 14 as illustrated in figs 10 11 when the wind speed increases the quantity of wind energy installations and the optimal system cost of the hres reduces correspondingly while as illustrated in fig 12 when emission limitations are 65 thousand tons year the system cost decreases by 4 7 with the wind speed increasing besides when emission limitations are 67 5 thousand tons year as shown in fig 13 there is a need to allocation only one wind turbine for the container terminal with wind speed increasing furthermore as shown in fig 14 when emission limitations are 70 thousand tons year there is no need of wind energy systems in that the energy demands in the container terminal can be supplied only by the scheduled electricity from conventional energy system due to the satisfaction of emission limitation therefore the optimal system cost the quantity of wind energy installations and the quantity of the energy storage installations do not change with wind speed increasing however the optimal installed capacity of on shore power sub systems at each berth is the same under different emission limitations and wind speeds because the installed capacity is affected by the maximum energy demands at each berth which is influenced by the arrival patterns of ships and berth allocation 6 2 4 analysis of the arrival interval of ships on optimal results with consideration of stochastic characteristics of arriving ships this paper thereby studies the impact of arrival interval of ships on the optimal results by consulting with the port operators this paper analyzes the optimal allocation for the hres under the arrival interval of ships set as 5 0 h and the results are shown in fig 15 as illustrated in fig 15 when the emission limitations increase step by step the quantity of wind energy installations decreases respectively and the quantity of energy storage installations keep at zero besides the system cost under corresponding emission limitations in fig 15 is lower than the cost in fig 9 due to energy demands in the container terminal decreasing 7 conclusions the contribution of this paper is to propose a two stage optimal framework to solve the optimal design problem of a hres for seaports firstly models of wind energy sub systems energy storage sub systems and on shore power supply sub systems are established then the proposed framework determines the optimal installed capacity of different sub systems in the first stage to minimize the investment cost including fixed investment cost and linear investment cost the second stage performs the stochastic characteristics of wind energy generation and energy demands in seaports to minimize the operation cost which takes power balances capacity limitations and emission regulations as constraints due to a lack of data concerning energy demands in seaports this paper applies a simulation based method to output the energy demands considering various stochastic environments in seaports finally the optimal results and the sensitivity of the optimal operation of the hres to emission limitations and wind speeds have also been analyzed in the case study 1 energy demands in seaports and power outputs of wind energy sub systems represent highly dynamic nature in a typical day and the difficulties in balancing energy supply and demand can be resolved by the application of energy storage systems 2 when the emission limitations increase step by step the quantity of wind energy installations and energy storage installations decreases correspondingly which results in the optimal system cost reduction when the emission limitations are 70 thousand tons year energy demands in the seaport can be met only by the scheduled energy from the conventional energy generations 3 when the emission limitations are higher than 65 thousand tons year the optimal system cost and the quantity of wind energy installations and energy storage installations do not change with the wind speed increasing 4 the optimal installed capacity of on shore power sub systems at each berth is the same under different emission limitations and wind speeds the results and proposed method can be applied to determine the optimal installation capacity and operation strategy of wind storage on shore power hybrid energy system for a container seaport under different emission limitations and wind speeds however this paper focuses on the system optimization regardless of the influence factors on the optimal results of on shore power sub systems such as berth allocation future study should improve the optimization performance for the hres optimization considering future hybrid and electric ships and the arrival patterns acknowledgments this research was funded by the national natural science foundation of china grant number no 51709037 and 51779037 we would also like to thank the fundamental research funds for the central universities no dut18rc 4 053 and doctoral start up foundation of liaoning province no 20170520165 for supporting this research 
22426,the paper proposes a mathematical model to integrate the optimization of the offshore production system the proposed mixed integer linear programming model can be implemented as a tool to support the decision makers in the conceptual design phase of the oilfield development to determine the most feasible production system architecture the model defines the number capacity and location of platforms and manifolds as well as the optimal assignment of wells to these facilities while searching for the minimum global investment costs the mathematical tool trades off the minimization of the pipeline length the expansion of the platform capacity as well as the number of installed manifolds and platforms one of the main benefits of the model is do not be closed into one subsea production layout defined into the literature being able to design the optimal layout for each instance moreover the establishment of a properly floating structures of each oilfield during the development plan allows the early coupled dynamics analysis of the platform mooring risers concepts other than the model verification a case study scenario is performed and discussed to evidence the relevance and the computational performance of the solution provided by the model keywords mixed integer linear programming optimization offshore oilfield floating production system subsea production system nomenclature list optimization model milp sets p set of possible platforms m set of possible manifolds w set of wells s set of platform capacity r the set of reservoirs subscripts p platform index m manifold index w well index s platform capacity index r reservoir index binary variables yps assumes the value 1 if the platform p of size s is installed xpw assumes the value 1 if the well w is assigned directly to the touch down point of the platform p xmw assumes the value 1 if the well w is assigned to the manifold m xpm assumes the value 1 if the manifold m is assigned to the touch down point of the platform p ym assumes the value 1 if the manifold m is installed continuous variables qm total flowrate received at the manifold m qp total platform receives the flowrate zpm auxiliary variable used to the linearization of the flowrate from the manifold m to the platform p if the manifold m is assigned to the platform p parameters platformcostps cost of platform p of size s distpw distance between the touch down point of platform p and well w distmw distance between manifold m and well w distpm distance between the touch down point of the platform p and manifold m riserlength length of risers pipelinecost cost of pipelines manifoldcostm cost of manifold m according to the slot capacity maxwells maximum number of wells ooip volume of oil in place qw single well flowrate qmax maximum flowrate that manifolds can receive from the wells slotm manifold slot size capacityps maximum platform capacity size formulae 24 and 25 sets w finite set of wells subscripts w well index x x axis of coordinate point y y axis of coordinate point variables c x centroid x coordinate point c y centroid y coordinate point parameter x w x coordinate point of the well w y w y coordinate point of the well w k cardinality of the finite set of wells formulae 26 subscripts min minimum max maximum variable l min minimum riser length parameter h water depth w riser weight t max maximum riser tension formulae 27 sets i set of end points j set of initial points variable dist x y euclidian distance between the cartesian coordinates x y plane parameters x i x coordinate point of the end point i y i y coordinate point of the initial point j 1 introduction the design of an offshore floating and subsea production systems are a result of precedent activities to best fits the oilfield characteristics and economics the most cost effective solution to the production system are directly related to the offshore oilfield development which arises at the level of the strategic decisions to be taken sahebi et al 2014 presented three categories of strategic decisions for the problem of the oilfield development investment planning facility location allocation and production planning according to sahebi et al 2014 the investment planning problem relates to the development of the oilfield itself the capacity expansion and the technology selection moreover they describe that the facility s location allocation problem looks for the optimal location of the facilities e g platforms and wells and their optimal allocation simultaneously furthermore sahebi et al 2014 characterized the oilfield production planning problem as the optimization of hydrocarbon recovery extensive research works address one of the above three categories or a hybrid combination of them the first significant studies in this direction are devine and lesso 1972 frair and devine 1975 iyer and grossmann 1998 an integration of the investment planning facility allocation and production planning within a single model is proposed by iyer and grossmann 1998 the oilfield development model also incorporates the drilling scheduling including the oil rig resource and surface pressure constraints associated with the reservoir performance equations the objective of the model is the maximization of the net present value npv that is dependent on the discounted investment costs and revenues moreover to accomplish the nonlinearity of the reservoir performance curve the model uses the piecewise linear interpolation a model for the optimization of the platform location problem is provided by devine and lesso 1972 the model corresponds to a similar warehouse location problem assuming the platforms as warehouses the well targets as facilities and the drilling costs as transportation costs the allocation problem is presented as a sub problem being part of the solution procedures an important extension of the model provided by devine and lesso 1972 is addressed by frair and devine 1975 the extension of the production system problem consists of four components platform location well allocation platform schedule and well drilling schedule the location allocation and the investment planning problems are examined by the approach provided by devine and lesso 1972 and the work presented by frair and devine 1975 focuses on the analysis of the scheduling problem considering the reservoir performance as linear however these research works devine and lesso 1972 frair and devine 1975 iyer and grossmann 1998 assume the production system as being decisions about production facility drilling and hydrocarbon production optimization the development of the offshore production system involves also the decisions related to the subsea production system aiming at the optimization of the wells locations pipeline network and subsea layout design following chang et al 2015 and ebadat and karimaghaee 2012 the wells location problem can be defined as the search for the optimal placement of the wells to maximize the net present value npv subject to the geological and economic factors the main functions of the subsea pipelines are to collect dispose and transport the produced hydrocarbons zhang et al 2017 therefore the pipeline network is considered as a production optimization problem and covers a number of applications lucena et al 2014 silva and camponogara 2014 zhang et al 2017 the subsea layout design optimization is a recent research topic aiming at the optimization of the clustered satellite wells layout design a mathematical programming model as well as an algorithm were developed by wang et al 2012 to determine the optimal number of cluster manifolds and subsea wells connected to each manifold the optimization approach presented by wang et al 2016 extended the pipeline straight line connection between the wells and manifolds provided by wang et al 2012 to properly accomplish subsea connection types using jumpers pipeline end terminations plet and flowlines the optimization of the clustered satellite wells was also proposed by wang et al 2014a however the authors applied the pipeline end manifold plem subsea structure to join the cluster manifolds the research work developed a mathematical model and respective dedicated algorithm to find the optimal layout scenario taking into account the number and the location of the plems the optimal interconnection among the cluster manifolds plems and fpsos the research work presented by hong et al 2018 explores the optimal layout arrangement design of a well cluster manifold fpso taking into consideration the seabed topography and the obstacles the proposed mathematical model is coupled with the simulated annealing and dijkstra algorithms to determine the optimal number of manifolds the positions of manifolds and riser bases the pipe network accomplishing the pipe routes that minimize the total pipeline length the subsea layout of the daisy chain wells system analysed by wang et al 2014b arranges two or more subsea satellite wells joined in series by pipelines normally there are dual pipelines connecting the wells to ensure the continuous production and to allow the round trip pigging loop that provide other advantages the proposed approach optimizes the partition of the subsea production loops and also provide an algorithm to solve the mathematical model the main advantages of the algorithm are the techniques for avoiding crossing points and dealing with obstacles the optimization approaches hong et al 2018 wang et al 2016 2014a 2014b 2012 do not allow the mathematical tools to choose the optimal layout design to be developed to contribute to the lack of the subsea layout design literature rosa et al 2018 proposed a robust mathematical programming model that searches for the optimal layout configuration and recovers the maximum cumulative production during the field lifetime the optimal configuration regards the decisions about the pipeline diameters subsea trajectories and connections well platform or well manifold platform that maximize the net present value npv the net present value calculation includes the key aspects of the reservoir dynamics such as the reservoir pressure water cut gas oil ratio secondary recovery mechanisms and multiphase pressure drop in pipelines from the research works presented above it can be argued that most of the papers treat the problem of the optimization of the production system as separated decisions production facility decisions and subsea production system decisions a simple pure integer programming pip approach is proposed by rodrigues et al 2016 to interconnect in a single model all of the main decisions of the production system to minimize the overall development costs the decisions are related to the platforms wells manifolds and the type of drilling nevertheless no specific constraints exist in the model related to the subsea layout design the present paper extended the model idea addressed in rodrigues et al 2016 to provide a mathematical decision tool that integrates the optimization of the production system architecture the main goal of the mixed integer linear programming milp model is the search for the optimal system level performance of the production system minimizing the capital expenditure of the main components the model aims to define the requirements of the floating production facility and subsea production system in a single and practical approach section 2 describes the problem and section 3 presents the model assumptions section 4 provides the optimization model while section 5 addresses the steps of the solution construction and the verification of the solution found sections 6 and 7 discusses the solution results and the main conclusions of the paper respectively 2 materials and methods 2 1 problem description according to capanoglu 2005 the development plan of the reservoir management comprises of eight main activities depletion strategies environment considerations data gathering and analysis geologic model production forecast facilities requirements economic optimization and management approval this paper focuses on to integrate the facilities requirements and economic optimization of the production system within a single model however the problem can be separately into three sub problems oilfield development floating production system and subsea production system 2 2 oilfield development during the conceptual design of an oilfield the exploration phase acquires the necessary data of the reservoir rock properties and the fluid characteristics to estimate the reservoir performance a simulation model of the reservoir indicates the number type and location of wells according to the drainage area of each well so as to maximize the hydrocarbon recovery factor these parameters allow the setting up of the production system requirements and guide the development of the oilfield following bai and bai 2010 the oilfield development may assign a few wells to a nearby existing platform the tie back development or may build a new platform to receive the total production of the high number of wells the stand alone development the field development architecture is also described by lin et al 2013 as depending on the combination of the number of reservoirs and production facilities they categorize four types of field development architectures single reservoir and single facility the development strategy is to build a single production facility dedicated to the moderate size reservoir and the main decision are the capacity of the platform and the platform location multiple reservoirs and single facility normally applied to small reservoirs with not enough volume of oil in place to justify the economics of building a facility for each reservoir so the main decisions are the capacity size of the platform and the exact location of the facility according to the number of tieback fields single reservoir and multiple facilities corresponding to a giant reservoir that exceeds the maximum allowed capacity of one facility with the main decisions including the number of necessary platforms the location and the capacity of each platform to explore the reservoir multiple reservoirs and multiple facilities this strategy appears when there are multiple reservoirs closely located and the main decisions comprise the number the locations and the capacity of each platform to incorporate the recent concepts of the field development the present authors extend the proposed field architectures presented in lin et al 2013 to encompass the concepts single reservoir and no offshore facility and multiple reservoirs and no offshore facility these strategies offer significant benefits over the platform concepts tie backing all the wells production to an onshore facility the main decisions include the proper assignment of the wells production to an onshore facility and the production flow assurance the subsea technology challenges and technical requirements are highlighted in witting and gray 2006 to increase the feasibility of the subsea to shore field development fig 1 shows all the types of the field development architectures adapted from lin et al 2013 2 3 floating production system the reservoir production estimation fluid characteristics and well locations are the most important parameters to define the floating production system which is composed by the floating platform riser and mooring systems the estimation of the recoverable reserve and the analysis of the fluids properties guide the functional requirements of the floating platform which is defined mainly in terms of system capacity for pre processing and storage the fluids e g oil gas water the semi submersible floating platforms are often restricted about the storage size due to the small topside area generally this type of floating structures requires near existing infrastructures or additional floating storage tankers nevertheless the hull of the ship shaped floating structures is designed to support a greater oil storage the storage capacity is also related to the tactical and strategic logistic of the production offloading by export pipelines or shuttle tankers in addition another important requirement for the floating platform is to stay on station during its life time according to travanca and hao 2017 the largest environmental force acting on the floating platform is the ocean wave due to a significant excitation effect on riser and mooring lines the dynamics of the riser and mooring systems are coupled with the motions of the floating platforms therefore the riser system is the interface connection between the reservoir production and floating platform which differ in relation with the locations of the wells the wet tree riser system rise the production from the well located on the seabed while the dry tree riser system rise the production from the reservoir to the well located on the topside of the floating platform the selection of the riser has a significant impact on type of the floating structure the semi submersible platform for example is designed to allows both riser systems however according to jiang et al 2016 the application of dry tree system has strict restrictions in heave responses that are related to the wave frequency excitations moreover the design of the ship shaped floating platform only allows the wet tree riser system being the free hanging catenary the most simple riser configuration therefore due to the challenges when increasing the water depth many efforts have been made to improve the riser performance in terms of pipelines loads responses santillan and virgin 2011 suggested a common practice of incorporating a buoyant portion on an intermediate section of the riser to change the riser standard configuration aiming at to achieve the right buoyance of the line and resulting in alternatives configurations such as the lazy wave steep wave lazy s and steep s the main purpose of the mooring system of the floating platform is to anchor the structure on the seabed and to achieve the station keeping according to xu et al 2018 2019 the taut and catenary are two types of mooring configurations xu et al 2018 consider that the weight of the suspended segment of the catenary mooring line provides the restoring force to the top of the floating platform while the restoring force of the taut mooring line is provided through the axial stretching the authors discuss that the catenary mooring have been widely used in shallow and deepwater and the taut mooring system should be used in deep and ultra deepwater there are two types of mooring systems adopted by the ship shaped units spread mooring and single point mooring the spread mooring is a multiple point mooring system that enables the floating structure to have the azimuthal angles equally distributed pina et al 2016 this requirement allows the structure to keep the position at all the weather conditions and support a high number of risers connected furthermore the single point mooring commonly called the turret mooring system consist of a turret assembly located on the hull of the vessel that is anchored to the seabed allowing the vessel to rotate around supporting the environmental loads the assembly is also designed house the production risers although a high number of risers results in a large turret diameter which is one of the major factors that impacts on the dynamic behaviour of a ship shaped floating structure sanchez mondragon et al 2017 the analysis of the coupled dynamics motion responses for the floating platform riser mooring system is recommended by several authors ji et al 2016 lopez et al 2017 tahar and kim 2003 xu et al 2018 2019 fig 2 shows one possible configuration of the floating system which adopts the riser and mooring as catenary configuration 2 4 subsea production system a subsea production system consist of an arrangement of subsea equipment and components aiming at to safety recover and deliver the production to an offshore platform or onshore facilities moreover the subsea component called jumper is the pipe connector used to transport the production between two subsea equipment and components such as wet tree manifold pipeline end manifold plem pipeline end termination plet generally jumpers are made with a specific shape metric for the corresponding subsea metrology between the two subsea connections following wang et al 2016 the rigid jumper has a standardized length for lengths higher than 55m it is necessary to include subsea connections as well as plets and infield flowlines however there is no standardized length for the flexible jumper which do not need more subsea connection components fig 3 shows the rigid and flexible subsea connections the arrangement of subsea equipment and components can vary in complexity the primary issues are the number the location and the assignment of wells these issues determine whether or not the wells are spread out into the reservoir or connected close to each other likewise it establishes the proper connection of the wells directly to the platform or connected to the platform by the manifold plem or other subsea component fig 4 shows the subsea layout design concepts established by bai and bai 2010 which are classified as follows satellite wells system the wells are spread out into the reservoir and the production flow is sent directly to the platform clustered satellite wells system the clustering of satellite wells are made by manifolds that collect the produced hydrocarbons from wells and sent the joint production to the platform daisy chain wells system the production flow of two or more satellite wells are joint together in series by the same flowline to the platform template wells system the wells are located close by in a template manifolds which are designed to support and house the wells and the joint production of the wells is sent to the platform 3 model assumptions to support the long term decision planning the oil industry frequently applies optimization tools to achieve the optimal system level performance of the production system the present milp model is in the most generalized form to integrate all the main decisions described above aiming at to improve the degree of certainty the minimization of the investment costs can bring more consistent results than the maximization of the economic value of the project rodrigues et al 2016 the preliminary cost estimate are useful to provide the necessary cost information at the initial stages of the oilfield development before modelling a real world problem it is necessary to make some assumptions the system assumptions summarise the purpose statements and represent the knowledge of the system in the present model the explicit assumptions are 1 the number and location of wells and also the well flow rate are given by the reservoir simulation the present model works with a predefined reservoir performance metric as assumed by hong et al 2018 rodrigues et al 2016 wang et al 2016 2014a 2014b 2012 2 the wells are treated as coordinate points in the x y axis the wells are considered geographically separated which means that the model initially assumes the satellite wells system as the standard subsea layout however as the model main decisions each well can be assigned directly to platform or connected to platform by a manifold this assumption allows to admit more than one reservoir in the model encompassing the general case of the oilfield development it means that the model is designed with some degree of flexibility to enhance the value of tieback fields the importance of a systematic approach to guide the search for flexibility in the early stages of a field development is suggested by lin et al 2013 3 the platform capacity is standardized and aim to store the maximum oil production during a limited period of time 4 there are a maximum number of wells that can be connected to the manifolds or in other words the size of manifolds are standardized according to the number of manifolds slots 5 the pipeline routes are considered as straight lines this assumption implies that the pipelines are flexible lines jumpers 6 the seabed topography is suitable for pipelines and manifolds laying where there is no topographic limitations 7 to avoid the pipeline crossing effect it is assumed that the pipeline supports should be previously installed on the seafloor to raise and support the crossing pipe over the crossed pipe according to reda et al 2017 2016 the pipeline or umbilical or cable crossing problem appears with the offshore field development density as suggest by the authors to avoid the possible cost of pipeline or umbilical or cable crossing however the authors also highlight that the expense of increasing the pipeline length also increase potential hazards along the pipeline route pressure losses and pipeline length cost the importance of the analysis of the on bottom stability of the crossing effect is also considered by reda et al 2017 2016 the problems associated with risk quantification in the various configurations is discussed by silva et al 2019 and will not be explicitly considered here 3 1 facility location allocation problem assumptions section 2 2 describes that the most important decisions of the integrated optimization of the production system are where to locate the maritime unit and manifolds what are the capacity of platforms and manifolds number of slots and also what are the most convenient assignments for the wells and manifolds following devine and lesso 1972 the optimization of the production system can be correlated with the facility warehouse location allocation problem the main purpose of the facility location allocation problem is to determine the optimal placement for one or more facilities as it occurs in the present problem in general the facility location allocation problem has a set of possible locations where warehouses can be open to serve the customers around searching the minimum warehouse opening costs the minimum transportation cost to serve all the customers and to satisfy the general constraints is of essence so every customer is allocated to one warehouse only customers shall only be served by an open warehouse whose capacity cannot exceeded extending the facility location allocation problem to integrate the optimization of the production system the wells are seen as customers to be served by manifolds or platforms the manifolds are seen as warehouses to serve the wells and also as customers to be served by the platforms and the platforms are seen as warehouses that can serve the wells and or manifolds fig 5 illustrates the facility location allocation problem as a result of the extending facility location allocation assumptions the optimal subsea layout for each oilfield can be arranged as satellite well system all the wells connected directly to platform clustered satellite well system all the wells connected to manifolds and each manifold that is installed need to be connected to one platform or mixed well system some wells are connected directly to platform and other wells are connected to platform by a manifold 3 2 mixed integer linear programming milp model in mathematical programming the linear non linear and integer programming are types of optimization models strictly speaking the linear programming lp models use continuous variables and linear expressions equations and or inequalities to represent a certain problem when non linear terms have to be incorporated in an lp model it is obtained a non linear programming nlp model moreover the integer programming ip allows the model to use discrete decision variables the mixed integer linear programming milp model is a special type of ip models that can mix the continuous and discrete variables commonly the milp models allows the discrete decision variables to assume two values 0 or 1 such 0 1 variables are called as binary variables and are applied to represent yes or no decisions as described above the milp model are a useful mathematical programming tool to model the yes or no decisions related with for example the assignment of wells to manifold or platform in addition the milp model can handling with the continuous flowrate decision variables the present milp model can be structured following the main decision variables as 1 number type and capacity size of platforms installed 2 number of manifolds installed and the respective assignment 3 assignment of wells to platform or to manifold 4 total flowrate received at the manifold 5 total flowrate received at the platform the auxiliary variable 1 the flowrate linearization from the manifold to platform the constraints groups 1 well assignment constraints 2 manifold installation and assignment constraints 3 flowrate conservation constraints 4 platform installation assignment and received flowrate constraints the milp model searches for the optimal number capacity and location of the production facility and manifold as well as the optimal assignment of the wells aiming at the minimization of the capital expenditure of the production system the optimal global solution of the proposed mathematical model trades off the minimization of the pipeline length the expansion of the platform capacity as well as the number of installed manifolds and platforms 3 3 mathematical model the objective function following eqs 1 5 1 minimize z c o s t o f p l a t f o r m c o s t o f p i p e l i n e s c o s t o f r i s e r s c o s t o f m a n i f o l d s being 2 c o s t o f p l a t f o r m p ε p s ε s y p s p l a t f o r m c o s t p s 3 c o s t o f p i p e l i n e s p ε p w ε w d i s t m w x p w p i p e l i n e c o s t m ε m w ε w d i s t m w x m w p ε p m ε m d i s t p m x p m p i p e l i n e c o s t 4 c o s t o f r i s e r s p ε p w ε w r i s e r l e n g t h x p w p i p e l i n e c o s t p ε p m ε m r i s e r l e n g t h x p m p i p e l i n e c o s t 5 c o s t o f m a n i f o l d s p ε p m ε m y m m a n i f o l d c o s t m the wells assignment constraints guarantee that each well can only be assigned to one facility to the platform p or to the manifold m eqs 6 8 and the total wells assigned cannot exceed the maximum number of wells maxwells eq 9 the summation of the wells flowrates qw cannot exceed the summation of the volume of oil in place ooip of each reservoir r eq 10 6 p p x p w 1 w w 7 m m x m w 1 w w 8 p p x p w m m x m w 1 w w 9 p p w w x p w m m w w x m w m a x w e l l s 10 p p w w x p w q w m m w w x m w q w r r o o i p r a manifold m if installed must be assigned to only one platform p eqs 11 13 and the number of wells assigned to one manifold cannot exceed the number of each manifold slot size slotm eq 14 11 m m y m 1 12 p p x p m 1 m m 13 y m p p x p m m m 14 w w x m w s l o t m y m m m to allow future tieback wells the eq 14 can be modified to eq 15 that obligate the standardized even number of manifold slots be an odd number which implies that there is at least one slot spared for future tieback wells 15 w w x m w s l o t m 1 y m m m the decision variable qm ε r that represents the total flowrate received at the manifold m is calculated by the summation of the flowrates of wells qw that are assigned to the manifold m eq 16 moreover the total flowrate from the manifold m to the platform p is represented by eqs 17 19 16 q m w w x m w q w m m 17 q m z p m 0 m m p p 18 x p m q m a x z p m 0 m m p p 19 q m x p m q m a x z p m q m a x m m p p a platform if installed cannot exceed the maximum number of assignments eqs 20 and 21 as described in the nomenclature list p is the set of platforms types the model allows as for example p 1 to be the fpso p 2 be the ss p 3 be the tlp and p 4 be the spar being s is the set of platform capacity the model accept for example the s 1 be the standardized size that equals to 50 000 bbl d s 2 equals to 110 000 bbl d and s 3 equals to 150 000 bbl d the installed platform receives the flowrate qp ε r from the wells that is directly assigned in addition with the flowrate zpm ε r from the assigned manifolds and the total flowrate at the platform p cannot exceed the size s capacityps eq 22 and 23 20 s s y p s 1 p p 21 w w x p w m m x p m m a x w e l l s s s y p s p p 22 q p w w x p w q w p p 23 m m z p m q p s c a p a c i t y p s p p 4 theory and calculation in this section the theory and calculation steps of the solution are presented in order to confirm that the solution provided by the model has built the system right while satisfying the specific constraints 4 1 model solution the optimal solution of the model is constructed following two phases the first phase involves the parameters to be determined and the second phase consists of the model implementation the production facility location manifold location and infrastructures distances calculation are the main parameters to be determined according to the production facility location it is common practice in the oil industry to determine the production facility position allowing for a safety distance margin of the subsea layout to avoid any failure event on the subsea equipment related to dropped objects according to lu et al 2018 the dropped objects is the hazardous accident that impact the risk most due to it can cause structural damage on equipment and components the possible manifold location depends on the wells clustering division which is a result of the centroid point calculation for the x axis and y axis the centroid equation relates the position and number of wells to the cluster according to the number of manifold slots following wang et al 2012 the optimal location coordinates of cluster manifold is the arithmetic mean of the coordinates of wells into a finite set of wells the calculation of the centroid point follows the eqs 24 and 25 24 c x x w 1 x w 2 x w n k 25 c y y w 1 y w 2 y w n k additionally the platform point on the seabed is represented by the touch down point tdp that is the first point where the riser touches the seabed the length of the riser depends on the production facility location and the riser configuration previously adopted in the case of the free hang catenary configuration the calculation of the minimum riser length can be done following the eq 26 as presented by faltinsen 1990 26 l m i n h 2 t m a x w h 1 1 2 the distance between two points on the seabed is calculated from the euclidian distance between the cartesian coordinates x y plane according to the eq 27 fig 6 shows the infrastructures distances calculation on the seabed and riser configuration 27 d i s t x y x i x j 2 y i y j 2 the model implementation is the second step after all the necessary input data is obtained the ibm ilog cplex optimization studio is the environment used to implement the model given in eqs 1 23 4 2 model verification aiming at the verification of the solution provided by the model a small example of the development of a production system is described in this section four wells are planned for production and the estimated flowrate of each well is extrapolated to 36 000 barrels per day bbl d to test the real model constraints therefore the only available manifold slot size is 4 slots the type of platforms considered are the ship shaped unit as platform one and platform two the available standardized platform capacity sizes are 150 000 bbl d size one and 110 000bbl d size two it is assumed that the costs of the platform capacity decrease approximately 1 3 times from capacity one to two for the first step of the model verification one possible location is assumed to install the platform p1 and two possible manifold locations m1 and m2 the calculated euclidian distances between the main components of the production system wells manifolds and touch down point of the platform are shown in table 1 fig 7 illustrates in a simple form the model solutions for all the verification steps from the solution 1 presented in fig 7 it is possible to verify that the model assigned all the wells to one manifold m1 and the manifold m1 to the only available platform location p1 the platform p1 receives a flowrate of 144 000bbl d which represents the summation of the wells flowrates at the manifold m1 also the received flowrate at the platform p1 did not exceed the chosen platform capacity of 150 000 bbl d s1 it is important to note that the solution guarantees the minimum distance thus reducing the pipeline cost there is an 88 km pipeline length from the wells to the touch down point of the platform using the manifold m1 to make the subsea layout instead of 92 km pipeline length in case the model assigned all the wells to manifold m2 now as a second step of the model verification one more possible location to install the platform is given as input data of the model the same standardized platform capacities 150 000 bbl d and 110 000bbl d are also available the distances between the components including the second possible location of the touch down point of platform p2 is shown in table 2 the new solution 2 fig 7 shows that the platform p2 is installed with the capacity of 150 000 bbl d s1 and it is also possible to verify that the chosen capacity did not exceed the total received flowrate at the platform 144 000 bbl d which accounting the summation of the total manifold m1 received a higher flowrate of 108 000 bbl d more the direct flowrate of well w4 36 000 bbl d from this solution it is also possible to verify that the clustering of all wells is not anymore the optimal global solution the small distance between the well w4 and the platform p2 enforce the directly assignment of the well to the platform it implies that the model still search for the minimum pipeline length which now equals 81 km the third step of the verification of the model assumes that the model has in terms of input data two possible locations to install the platform p1 and p2 two possible locations to install the manifold m1 and m2 and the same distances as presented in the second step of the model verification table 2 however the flowrate of each well changes to 38 000 bbl d the solution 3 in fig 7 shows that the two available platform capacity sizes 150 000 bbl d and 110 000 bbl d for one platform cannot store the new total production of the wells 1520 000 bbl d so to fulfil the capacity constraints of the platform the model installs two platforms and each with the smallest capacity of 110 000 bbl d s2 platform p1 receives a total flowrate of 76 000 bbl d from the wells w2 and w3 through manifold m1 and platform p2 receive the total flowrate of 76 000 bbl d from the wells w1 and w4 which are directly assigned the choice of the smallest capacity confirms that the model searches for the minimum global investment cost if the model looked only for the minimization of the pipeline cost the assignment of the wells w1 w2 and w3 to the manifold m1 the assignment of the respective manifold to the platform p1 with the capacity of 150 000 bbl d s1 more the assignment of the well w4 directly to the platform p2 with the capacity of 110 000 bbl d s2 is the optimal solution the platform capacities did not exceed the total flowrate of 114 000 bbl d and 38 000 bbl d respectively however the cost of increasing the platform capacity size is higher than the cost of the pipeline length through this verification process it is possible to recognize the effect of uncertainty when the flowrate of each well increases 2000 bbl d the available platform capacities are not able to store all the production at one platform and the model is forced to install two platforms following lin et al 2013 flexibility is a method of recognizing the effect of uncertainty the authors also suggest that flexibility during the oilfield development can enhance the value of the project and one form of taking flexibility into account is allowing for the expansion of the production facility so for the next step of the model verification another platform capacity 180 000 bbl d was given thus increasing the platform capacity of size of platform three to approximately 1 3 times from size one the model has now three available platform capacities 180 000 150 000 110 000 bbl d two possible platform locations p1 and p2 two possible manifold locations m1 and m2 and the same distances presented in table 2 the solution 4 in fig 7 demonstrates that the platform capacity of 180 000 bbl d s3 is now the optimal choice for this verification step the higher capacity allows the clustering of wells w1 w2 and w3 to manifold m1 and the assignment of the respective manifold to the platform p2 moreover the directly assignment of well w4 to the platform p2 this optimal solution confirm that the model searches for the minimum global investment cost the solution presents the minimum pipeline length 81 km and also guarantees that the cost of improving the platform capacity is better than the cost of installing two platforms 5 results and discussion the proposed milp model was applied to a realistic scenario to assess the relevance of the production system solution and the computational performance of the results this section presents a case study and the respective discussions of the results 5 1 case study assuming a case scenario of an offshore oilfield with the size of the reservoir considered as medium with the volume of oil in place evaluated in 2 880 000 bbl the mean water depth of the oilfield location equals 1 400m the predicted number of wells to be developed are 30 and the estimates of each well production flowrate is 6000 bbl d moreover the common standardized capacities of platforms are 180 000 150 000 and 110 000 bbl d table 3 shows the gross cost estimates used to develop the production system the riser configuration adopted is the free hanging catenary considering the flexible risers of an internal diameter of 8in and design pressure of 300 psi the dynamic loaded riser had its length estimated as 1860 m 1 2 times the value of the mean water depth was used for safety of all risers the wells clustering division is calculated to 4 and 6 manifold slot sizes furthermore 12 possible locations for the 4 slots manifolds were considered 8 possible locations for the 6 slots manifolds the 2 possible platform locations were designed considering the subsea wells positions and the possible manifolds locations to allow for a safe operation to simplify the case study the only type of platform considered is the ship shaped unit fig 8 shows the respective wells positions all possible locations of platforms and manifolds 5 2 production system solution results two similar instances are evaluated the only difference between the instances is the available capacity size of the platform for the first instance the available capacity sizes are 150 000 and 110 000 bbl d and for the second instance the three capacity sizes are available adding the 180 000 bbl d size fig 9 shows the optimal production system designs for each instance table 4 summarizes the main features of the optimal solutions provided by the model including the cost results combinatorial size of the model and computational time the ibm ilog cplex studio optimization ran in a workstation with 4 gb ram and pentium dual core of 3 ghz the optimal production system for solution one has two platforms with the capacity size of 110 000 bbl d and installed five manifolds of 6 slots to cluster all the wells the optimal solution for the second instance installed one platform with a higher capacity size of 180 000 bbl d and five manifold of 6 slots for this instance however the model choose manifold m8 instead of manifold m7 as presented in the fig 9 both production systems are the most economic and technically feasible solutions of each evaluated instance however only one of the solutions can be chosen as the best production system to develop the proposed offshore oilfield the total cost of the first production system equals us 1 37 10 09 being the cost of platforms the bigger portion of the total cost the total cost of the second solution is us 3 52 10 08 less than the solution of the first instance due to the difference between the installations of one bigger platform instead of two smaller platforms table 4 moreover the production system of the first solution provides more flexibility as it allows the connection of future tie back wells at the platforms instead of the platform capacity of the second production system that works at the maximum capacity the production system solutions meet all requirements in a reasonable timeframe the computer performance takes 1 97 and 3 18 s to achieve the optimal solutions one and two respectively 6 discussion the present milp model provides an improvement of the system level performance of the production system when compared with the solution established by the model presented in rodrigues et al 2016 the authors did not mention any detailed constraints of the subsea layout design it is only assumed that all the wells are assigned to one node however the model treats the manifold and the platform as the same corresponding node being the manifold the node on the seabed and the platform on the sea surface the described above research works related to the subsea layout design hong et al 2018 rosa et al 2018 wang et al 2016 2012 highlighted that the cluster manifold has standardized sizes according to the number of slots from the engineering point of view wang et al 2016 addresses a directional correlation between the number of slots size and weight of the manifold a greater number of manifold slots may result in a much bigger and heavier manifold it may also lead to greater challenges in the manifold installation the 4 slots and 6 slots are established by wang et al 2012 as the most common types of cluster manifolds furthermore the model addressed by rodrigues et al 2016 considered the wells location problem similar to the well assignment problem affirming that the assignment of the well is only possible if the well is located the proper well location to achieve a high probability of success the well drilling type to maximize the drainage area and the estimated well flowrate are part of a complex and uncertain problem depending on the reservoir characteristics and modelling chang et al 2015 for those reasons this problem falls outside the scope of this paper the production system results provided by the present milp model confirm that the optimization tool searches for the optimal system level performance and satisfy all the constraints of the model according to the solutions all of the predicted wells of the oilfield are connected to only one facility which in this case study the facility is the manifold and the respective manifolds are connected to a single platform only the subsea layout designed is equivalent to the clustered satellite wells system the clustering of wells minimize the total pipeline length and the respective pipeline costs these are the two main advantages of the clustered satellite wells layout system it helps confirm the reasons why some scholars hong et al 2018 wang et al 2016 2014a 2012 studied the main aspects of the clustered satellite wells system more frequently than other layout options as for example the daisy chain layout design studied by wang et al 2014b moreover the reduction on the number of flowlines reduces also the number of risers as described above the riser lines reduction is a requirement to allow the application of turret mooring concept and can improve the spread mooring performance in terms the restoring force of the dynamic loads the flowrate balance constraints are also satisfied in terms of volume conservation the flowrate that goes out of the manifold equals the total incoming well flowrates in parallel the production received at each platform represents the summation of each flowrate that goes out of the manifolds connected to the platform the production facility designed did not exceed each platform capacity and the number of wells connected to each manifold did not exceed the manifold slot size therefore the model chooses the optimal subsea layout design and floating production system for each instance tested furthermore the chosen platform capacity can defines the best concept of the floating platform the properly floating structures allows the early coupled dynamics analysis of the platform mooring risers concepts the computer performance takes approximately 4 s to achieve the optimal solutions the ibm ilog cplex studio optimization ran in a workstation with 4 gb ram and pentium dual core of 3 ghz 7 conclusions the developed mathematical approach attempts to integrate the investment planning and facility location allocation problems advancing the state of the art solutions which did not address this integration the mathematical programming model serves as a quantified tool to screening the initial possible capital expenditures pointing out the facilities and equipment costs additional cost of facilities expansion technology selection location number and capacity of the floating unit and or manifold and the properly assignment of wells all of these possible systems layouts and respective initial costs are important decisions that can help the decision makers and be addressed in the front end engineering feed the feed is applied as the initial stage of the detailed engineering to discover what resources will be need to developed the project and cost estimation of them only few reservoir parameters are necessary to input in the model number and location of wells and the estimated maximum well flowrates according to these simple and static approach of the reservoir behavouir the decision makers can investigate how the field production at the production plateau will impact on the floating unit design and which subsea arrangement satellite clustered or a mix of them best fits the oilfield characteristics from a robust reservoir simulation the decision makers can change these simple metrics and run different what if scenarios in terms of floating and subsea systems without spending a huge computational effort and time to develop all possible system architectures afterwards the decision makers can choose the solution that best fits the oilfield characteristics and economics to explore in detail all the field behavior during the field life cycle a more detailed reservoir dynamic metrics are important parameters to consider if the model attempt to assist engineers at the strategic level of production planning optimization where the hydrocarbon recovery or npv need to be coupled with a more detailed production system however when an extensive reservoir engineering analysis is made and the reservoir model is available it reduces the high uncertainties associated to the prediction of production variables besides the model verification a case study scenario is performed and discussed to present the relevance and computational performance of the solution provided by the model the main benefits of the model are do not be closed into one subsea production layout defined into the literature and the system solutions meet all the model requirements in a reasonable time and solution gap acknowledgements this is a follow up of the work financed by embrapii coppe unit subsea technology which was performed within the project submarine systems conducted in cooperation with coppe ufrj the first author holds a phd scholarship financed partially by the university of lisbon and partially by the centre for marine technology and ocean engineering centec the last author has held a visiting position at coppe ufrj which was supported by conselho nacional de desenvolvimento cientifico e tecnologico cnpq 
22426,the paper proposes a mathematical model to integrate the optimization of the offshore production system the proposed mixed integer linear programming model can be implemented as a tool to support the decision makers in the conceptual design phase of the oilfield development to determine the most feasible production system architecture the model defines the number capacity and location of platforms and manifolds as well as the optimal assignment of wells to these facilities while searching for the minimum global investment costs the mathematical tool trades off the minimization of the pipeline length the expansion of the platform capacity as well as the number of installed manifolds and platforms one of the main benefits of the model is do not be closed into one subsea production layout defined into the literature being able to design the optimal layout for each instance moreover the establishment of a properly floating structures of each oilfield during the development plan allows the early coupled dynamics analysis of the platform mooring risers concepts other than the model verification a case study scenario is performed and discussed to evidence the relevance and the computational performance of the solution provided by the model keywords mixed integer linear programming optimization offshore oilfield floating production system subsea production system nomenclature list optimization model milp sets p set of possible platforms m set of possible manifolds w set of wells s set of platform capacity r the set of reservoirs subscripts p platform index m manifold index w well index s platform capacity index r reservoir index binary variables yps assumes the value 1 if the platform p of size s is installed xpw assumes the value 1 if the well w is assigned directly to the touch down point of the platform p xmw assumes the value 1 if the well w is assigned to the manifold m xpm assumes the value 1 if the manifold m is assigned to the touch down point of the platform p ym assumes the value 1 if the manifold m is installed continuous variables qm total flowrate received at the manifold m qp total platform receives the flowrate zpm auxiliary variable used to the linearization of the flowrate from the manifold m to the platform p if the manifold m is assigned to the platform p parameters platformcostps cost of platform p of size s distpw distance between the touch down point of platform p and well w distmw distance between manifold m and well w distpm distance between the touch down point of the platform p and manifold m riserlength length of risers pipelinecost cost of pipelines manifoldcostm cost of manifold m according to the slot capacity maxwells maximum number of wells ooip volume of oil in place qw single well flowrate qmax maximum flowrate that manifolds can receive from the wells slotm manifold slot size capacityps maximum platform capacity size formulae 24 and 25 sets w finite set of wells subscripts w well index x x axis of coordinate point y y axis of coordinate point variables c x centroid x coordinate point c y centroid y coordinate point parameter x w x coordinate point of the well w y w y coordinate point of the well w k cardinality of the finite set of wells formulae 26 subscripts min minimum max maximum variable l min minimum riser length parameter h water depth w riser weight t max maximum riser tension formulae 27 sets i set of end points j set of initial points variable dist x y euclidian distance between the cartesian coordinates x y plane parameters x i x coordinate point of the end point i y i y coordinate point of the initial point j 1 introduction the design of an offshore floating and subsea production systems are a result of precedent activities to best fits the oilfield characteristics and economics the most cost effective solution to the production system are directly related to the offshore oilfield development which arises at the level of the strategic decisions to be taken sahebi et al 2014 presented three categories of strategic decisions for the problem of the oilfield development investment planning facility location allocation and production planning according to sahebi et al 2014 the investment planning problem relates to the development of the oilfield itself the capacity expansion and the technology selection moreover they describe that the facility s location allocation problem looks for the optimal location of the facilities e g platforms and wells and their optimal allocation simultaneously furthermore sahebi et al 2014 characterized the oilfield production planning problem as the optimization of hydrocarbon recovery extensive research works address one of the above three categories or a hybrid combination of them the first significant studies in this direction are devine and lesso 1972 frair and devine 1975 iyer and grossmann 1998 an integration of the investment planning facility allocation and production planning within a single model is proposed by iyer and grossmann 1998 the oilfield development model also incorporates the drilling scheduling including the oil rig resource and surface pressure constraints associated with the reservoir performance equations the objective of the model is the maximization of the net present value npv that is dependent on the discounted investment costs and revenues moreover to accomplish the nonlinearity of the reservoir performance curve the model uses the piecewise linear interpolation a model for the optimization of the platform location problem is provided by devine and lesso 1972 the model corresponds to a similar warehouse location problem assuming the platforms as warehouses the well targets as facilities and the drilling costs as transportation costs the allocation problem is presented as a sub problem being part of the solution procedures an important extension of the model provided by devine and lesso 1972 is addressed by frair and devine 1975 the extension of the production system problem consists of four components platform location well allocation platform schedule and well drilling schedule the location allocation and the investment planning problems are examined by the approach provided by devine and lesso 1972 and the work presented by frair and devine 1975 focuses on the analysis of the scheduling problem considering the reservoir performance as linear however these research works devine and lesso 1972 frair and devine 1975 iyer and grossmann 1998 assume the production system as being decisions about production facility drilling and hydrocarbon production optimization the development of the offshore production system involves also the decisions related to the subsea production system aiming at the optimization of the wells locations pipeline network and subsea layout design following chang et al 2015 and ebadat and karimaghaee 2012 the wells location problem can be defined as the search for the optimal placement of the wells to maximize the net present value npv subject to the geological and economic factors the main functions of the subsea pipelines are to collect dispose and transport the produced hydrocarbons zhang et al 2017 therefore the pipeline network is considered as a production optimization problem and covers a number of applications lucena et al 2014 silva and camponogara 2014 zhang et al 2017 the subsea layout design optimization is a recent research topic aiming at the optimization of the clustered satellite wells layout design a mathematical programming model as well as an algorithm were developed by wang et al 2012 to determine the optimal number of cluster manifolds and subsea wells connected to each manifold the optimization approach presented by wang et al 2016 extended the pipeline straight line connection between the wells and manifolds provided by wang et al 2012 to properly accomplish subsea connection types using jumpers pipeline end terminations plet and flowlines the optimization of the clustered satellite wells was also proposed by wang et al 2014a however the authors applied the pipeline end manifold plem subsea structure to join the cluster manifolds the research work developed a mathematical model and respective dedicated algorithm to find the optimal layout scenario taking into account the number and the location of the plems the optimal interconnection among the cluster manifolds plems and fpsos the research work presented by hong et al 2018 explores the optimal layout arrangement design of a well cluster manifold fpso taking into consideration the seabed topography and the obstacles the proposed mathematical model is coupled with the simulated annealing and dijkstra algorithms to determine the optimal number of manifolds the positions of manifolds and riser bases the pipe network accomplishing the pipe routes that minimize the total pipeline length the subsea layout of the daisy chain wells system analysed by wang et al 2014b arranges two or more subsea satellite wells joined in series by pipelines normally there are dual pipelines connecting the wells to ensure the continuous production and to allow the round trip pigging loop that provide other advantages the proposed approach optimizes the partition of the subsea production loops and also provide an algorithm to solve the mathematical model the main advantages of the algorithm are the techniques for avoiding crossing points and dealing with obstacles the optimization approaches hong et al 2018 wang et al 2016 2014a 2014b 2012 do not allow the mathematical tools to choose the optimal layout design to be developed to contribute to the lack of the subsea layout design literature rosa et al 2018 proposed a robust mathematical programming model that searches for the optimal layout configuration and recovers the maximum cumulative production during the field lifetime the optimal configuration regards the decisions about the pipeline diameters subsea trajectories and connections well platform or well manifold platform that maximize the net present value npv the net present value calculation includes the key aspects of the reservoir dynamics such as the reservoir pressure water cut gas oil ratio secondary recovery mechanisms and multiphase pressure drop in pipelines from the research works presented above it can be argued that most of the papers treat the problem of the optimization of the production system as separated decisions production facility decisions and subsea production system decisions a simple pure integer programming pip approach is proposed by rodrigues et al 2016 to interconnect in a single model all of the main decisions of the production system to minimize the overall development costs the decisions are related to the platforms wells manifolds and the type of drilling nevertheless no specific constraints exist in the model related to the subsea layout design the present paper extended the model idea addressed in rodrigues et al 2016 to provide a mathematical decision tool that integrates the optimization of the production system architecture the main goal of the mixed integer linear programming milp model is the search for the optimal system level performance of the production system minimizing the capital expenditure of the main components the model aims to define the requirements of the floating production facility and subsea production system in a single and practical approach section 2 describes the problem and section 3 presents the model assumptions section 4 provides the optimization model while section 5 addresses the steps of the solution construction and the verification of the solution found sections 6 and 7 discusses the solution results and the main conclusions of the paper respectively 2 materials and methods 2 1 problem description according to capanoglu 2005 the development plan of the reservoir management comprises of eight main activities depletion strategies environment considerations data gathering and analysis geologic model production forecast facilities requirements economic optimization and management approval this paper focuses on to integrate the facilities requirements and economic optimization of the production system within a single model however the problem can be separately into three sub problems oilfield development floating production system and subsea production system 2 2 oilfield development during the conceptual design of an oilfield the exploration phase acquires the necessary data of the reservoir rock properties and the fluid characteristics to estimate the reservoir performance a simulation model of the reservoir indicates the number type and location of wells according to the drainage area of each well so as to maximize the hydrocarbon recovery factor these parameters allow the setting up of the production system requirements and guide the development of the oilfield following bai and bai 2010 the oilfield development may assign a few wells to a nearby existing platform the tie back development or may build a new platform to receive the total production of the high number of wells the stand alone development the field development architecture is also described by lin et al 2013 as depending on the combination of the number of reservoirs and production facilities they categorize four types of field development architectures single reservoir and single facility the development strategy is to build a single production facility dedicated to the moderate size reservoir and the main decision are the capacity of the platform and the platform location multiple reservoirs and single facility normally applied to small reservoirs with not enough volume of oil in place to justify the economics of building a facility for each reservoir so the main decisions are the capacity size of the platform and the exact location of the facility according to the number of tieback fields single reservoir and multiple facilities corresponding to a giant reservoir that exceeds the maximum allowed capacity of one facility with the main decisions including the number of necessary platforms the location and the capacity of each platform to explore the reservoir multiple reservoirs and multiple facilities this strategy appears when there are multiple reservoirs closely located and the main decisions comprise the number the locations and the capacity of each platform to incorporate the recent concepts of the field development the present authors extend the proposed field architectures presented in lin et al 2013 to encompass the concepts single reservoir and no offshore facility and multiple reservoirs and no offshore facility these strategies offer significant benefits over the platform concepts tie backing all the wells production to an onshore facility the main decisions include the proper assignment of the wells production to an onshore facility and the production flow assurance the subsea technology challenges and technical requirements are highlighted in witting and gray 2006 to increase the feasibility of the subsea to shore field development fig 1 shows all the types of the field development architectures adapted from lin et al 2013 2 3 floating production system the reservoir production estimation fluid characteristics and well locations are the most important parameters to define the floating production system which is composed by the floating platform riser and mooring systems the estimation of the recoverable reserve and the analysis of the fluids properties guide the functional requirements of the floating platform which is defined mainly in terms of system capacity for pre processing and storage the fluids e g oil gas water the semi submersible floating platforms are often restricted about the storage size due to the small topside area generally this type of floating structures requires near existing infrastructures or additional floating storage tankers nevertheless the hull of the ship shaped floating structures is designed to support a greater oil storage the storage capacity is also related to the tactical and strategic logistic of the production offloading by export pipelines or shuttle tankers in addition another important requirement for the floating platform is to stay on station during its life time according to travanca and hao 2017 the largest environmental force acting on the floating platform is the ocean wave due to a significant excitation effect on riser and mooring lines the dynamics of the riser and mooring systems are coupled with the motions of the floating platforms therefore the riser system is the interface connection between the reservoir production and floating platform which differ in relation with the locations of the wells the wet tree riser system rise the production from the well located on the seabed while the dry tree riser system rise the production from the reservoir to the well located on the topside of the floating platform the selection of the riser has a significant impact on type of the floating structure the semi submersible platform for example is designed to allows both riser systems however according to jiang et al 2016 the application of dry tree system has strict restrictions in heave responses that are related to the wave frequency excitations moreover the design of the ship shaped floating platform only allows the wet tree riser system being the free hanging catenary the most simple riser configuration therefore due to the challenges when increasing the water depth many efforts have been made to improve the riser performance in terms of pipelines loads responses santillan and virgin 2011 suggested a common practice of incorporating a buoyant portion on an intermediate section of the riser to change the riser standard configuration aiming at to achieve the right buoyance of the line and resulting in alternatives configurations such as the lazy wave steep wave lazy s and steep s the main purpose of the mooring system of the floating platform is to anchor the structure on the seabed and to achieve the station keeping according to xu et al 2018 2019 the taut and catenary are two types of mooring configurations xu et al 2018 consider that the weight of the suspended segment of the catenary mooring line provides the restoring force to the top of the floating platform while the restoring force of the taut mooring line is provided through the axial stretching the authors discuss that the catenary mooring have been widely used in shallow and deepwater and the taut mooring system should be used in deep and ultra deepwater there are two types of mooring systems adopted by the ship shaped units spread mooring and single point mooring the spread mooring is a multiple point mooring system that enables the floating structure to have the azimuthal angles equally distributed pina et al 2016 this requirement allows the structure to keep the position at all the weather conditions and support a high number of risers connected furthermore the single point mooring commonly called the turret mooring system consist of a turret assembly located on the hull of the vessel that is anchored to the seabed allowing the vessel to rotate around supporting the environmental loads the assembly is also designed house the production risers although a high number of risers results in a large turret diameter which is one of the major factors that impacts on the dynamic behaviour of a ship shaped floating structure sanchez mondragon et al 2017 the analysis of the coupled dynamics motion responses for the floating platform riser mooring system is recommended by several authors ji et al 2016 lopez et al 2017 tahar and kim 2003 xu et al 2018 2019 fig 2 shows one possible configuration of the floating system which adopts the riser and mooring as catenary configuration 2 4 subsea production system a subsea production system consist of an arrangement of subsea equipment and components aiming at to safety recover and deliver the production to an offshore platform or onshore facilities moreover the subsea component called jumper is the pipe connector used to transport the production between two subsea equipment and components such as wet tree manifold pipeline end manifold plem pipeline end termination plet generally jumpers are made with a specific shape metric for the corresponding subsea metrology between the two subsea connections following wang et al 2016 the rigid jumper has a standardized length for lengths higher than 55m it is necessary to include subsea connections as well as plets and infield flowlines however there is no standardized length for the flexible jumper which do not need more subsea connection components fig 3 shows the rigid and flexible subsea connections the arrangement of subsea equipment and components can vary in complexity the primary issues are the number the location and the assignment of wells these issues determine whether or not the wells are spread out into the reservoir or connected close to each other likewise it establishes the proper connection of the wells directly to the platform or connected to the platform by the manifold plem or other subsea component fig 4 shows the subsea layout design concepts established by bai and bai 2010 which are classified as follows satellite wells system the wells are spread out into the reservoir and the production flow is sent directly to the platform clustered satellite wells system the clustering of satellite wells are made by manifolds that collect the produced hydrocarbons from wells and sent the joint production to the platform daisy chain wells system the production flow of two or more satellite wells are joint together in series by the same flowline to the platform template wells system the wells are located close by in a template manifolds which are designed to support and house the wells and the joint production of the wells is sent to the platform 3 model assumptions to support the long term decision planning the oil industry frequently applies optimization tools to achieve the optimal system level performance of the production system the present milp model is in the most generalized form to integrate all the main decisions described above aiming at to improve the degree of certainty the minimization of the investment costs can bring more consistent results than the maximization of the economic value of the project rodrigues et al 2016 the preliminary cost estimate are useful to provide the necessary cost information at the initial stages of the oilfield development before modelling a real world problem it is necessary to make some assumptions the system assumptions summarise the purpose statements and represent the knowledge of the system in the present model the explicit assumptions are 1 the number and location of wells and also the well flow rate are given by the reservoir simulation the present model works with a predefined reservoir performance metric as assumed by hong et al 2018 rodrigues et al 2016 wang et al 2016 2014a 2014b 2012 2 the wells are treated as coordinate points in the x y axis the wells are considered geographically separated which means that the model initially assumes the satellite wells system as the standard subsea layout however as the model main decisions each well can be assigned directly to platform or connected to platform by a manifold this assumption allows to admit more than one reservoir in the model encompassing the general case of the oilfield development it means that the model is designed with some degree of flexibility to enhance the value of tieback fields the importance of a systematic approach to guide the search for flexibility in the early stages of a field development is suggested by lin et al 2013 3 the platform capacity is standardized and aim to store the maximum oil production during a limited period of time 4 there are a maximum number of wells that can be connected to the manifolds or in other words the size of manifolds are standardized according to the number of manifolds slots 5 the pipeline routes are considered as straight lines this assumption implies that the pipelines are flexible lines jumpers 6 the seabed topography is suitable for pipelines and manifolds laying where there is no topographic limitations 7 to avoid the pipeline crossing effect it is assumed that the pipeline supports should be previously installed on the seafloor to raise and support the crossing pipe over the crossed pipe according to reda et al 2017 2016 the pipeline or umbilical or cable crossing problem appears with the offshore field development density as suggest by the authors to avoid the possible cost of pipeline or umbilical or cable crossing however the authors also highlight that the expense of increasing the pipeline length also increase potential hazards along the pipeline route pressure losses and pipeline length cost the importance of the analysis of the on bottom stability of the crossing effect is also considered by reda et al 2017 2016 the problems associated with risk quantification in the various configurations is discussed by silva et al 2019 and will not be explicitly considered here 3 1 facility location allocation problem assumptions section 2 2 describes that the most important decisions of the integrated optimization of the production system are where to locate the maritime unit and manifolds what are the capacity of platforms and manifolds number of slots and also what are the most convenient assignments for the wells and manifolds following devine and lesso 1972 the optimization of the production system can be correlated with the facility warehouse location allocation problem the main purpose of the facility location allocation problem is to determine the optimal placement for one or more facilities as it occurs in the present problem in general the facility location allocation problem has a set of possible locations where warehouses can be open to serve the customers around searching the minimum warehouse opening costs the minimum transportation cost to serve all the customers and to satisfy the general constraints is of essence so every customer is allocated to one warehouse only customers shall only be served by an open warehouse whose capacity cannot exceeded extending the facility location allocation problem to integrate the optimization of the production system the wells are seen as customers to be served by manifolds or platforms the manifolds are seen as warehouses to serve the wells and also as customers to be served by the platforms and the platforms are seen as warehouses that can serve the wells and or manifolds fig 5 illustrates the facility location allocation problem as a result of the extending facility location allocation assumptions the optimal subsea layout for each oilfield can be arranged as satellite well system all the wells connected directly to platform clustered satellite well system all the wells connected to manifolds and each manifold that is installed need to be connected to one platform or mixed well system some wells are connected directly to platform and other wells are connected to platform by a manifold 3 2 mixed integer linear programming milp model in mathematical programming the linear non linear and integer programming are types of optimization models strictly speaking the linear programming lp models use continuous variables and linear expressions equations and or inequalities to represent a certain problem when non linear terms have to be incorporated in an lp model it is obtained a non linear programming nlp model moreover the integer programming ip allows the model to use discrete decision variables the mixed integer linear programming milp model is a special type of ip models that can mix the continuous and discrete variables commonly the milp models allows the discrete decision variables to assume two values 0 or 1 such 0 1 variables are called as binary variables and are applied to represent yes or no decisions as described above the milp model are a useful mathematical programming tool to model the yes or no decisions related with for example the assignment of wells to manifold or platform in addition the milp model can handling with the continuous flowrate decision variables the present milp model can be structured following the main decision variables as 1 number type and capacity size of platforms installed 2 number of manifolds installed and the respective assignment 3 assignment of wells to platform or to manifold 4 total flowrate received at the manifold 5 total flowrate received at the platform the auxiliary variable 1 the flowrate linearization from the manifold to platform the constraints groups 1 well assignment constraints 2 manifold installation and assignment constraints 3 flowrate conservation constraints 4 platform installation assignment and received flowrate constraints the milp model searches for the optimal number capacity and location of the production facility and manifold as well as the optimal assignment of the wells aiming at the minimization of the capital expenditure of the production system the optimal global solution of the proposed mathematical model trades off the minimization of the pipeline length the expansion of the platform capacity as well as the number of installed manifolds and platforms 3 3 mathematical model the objective function following eqs 1 5 1 minimize z c o s t o f p l a t f o r m c o s t o f p i p e l i n e s c o s t o f r i s e r s c o s t o f m a n i f o l d s being 2 c o s t o f p l a t f o r m p ε p s ε s y p s p l a t f o r m c o s t p s 3 c o s t o f p i p e l i n e s p ε p w ε w d i s t m w x p w p i p e l i n e c o s t m ε m w ε w d i s t m w x m w p ε p m ε m d i s t p m x p m p i p e l i n e c o s t 4 c o s t o f r i s e r s p ε p w ε w r i s e r l e n g t h x p w p i p e l i n e c o s t p ε p m ε m r i s e r l e n g t h x p m p i p e l i n e c o s t 5 c o s t o f m a n i f o l d s p ε p m ε m y m m a n i f o l d c o s t m the wells assignment constraints guarantee that each well can only be assigned to one facility to the platform p or to the manifold m eqs 6 8 and the total wells assigned cannot exceed the maximum number of wells maxwells eq 9 the summation of the wells flowrates qw cannot exceed the summation of the volume of oil in place ooip of each reservoir r eq 10 6 p p x p w 1 w w 7 m m x m w 1 w w 8 p p x p w m m x m w 1 w w 9 p p w w x p w m m w w x m w m a x w e l l s 10 p p w w x p w q w m m w w x m w q w r r o o i p r a manifold m if installed must be assigned to only one platform p eqs 11 13 and the number of wells assigned to one manifold cannot exceed the number of each manifold slot size slotm eq 14 11 m m y m 1 12 p p x p m 1 m m 13 y m p p x p m m m 14 w w x m w s l o t m y m m m to allow future tieback wells the eq 14 can be modified to eq 15 that obligate the standardized even number of manifold slots be an odd number which implies that there is at least one slot spared for future tieback wells 15 w w x m w s l o t m 1 y m m m the decision variable qm ε r that represents the total flowrate received at the manifold m is calculated by the summation of the flowrates of wells qw that are assigned to the manifold m eq 16 moreover the total flowrate from the manifold m to the platform p is represented by eqs 17 19 16 q m w w x m w q w m m 17 q m z p m 0 m m p p 18 x p m q m a x z p m 0 m m p p 19 q m x p m q m a x z p m q m a x m m p p a platform if installed cannot exceed the maximum number of assignments eqs 20 and 21 as described in the nomenclature list p is the set of platforms types the model allows as for example p 1 to be the fpso p 2 be the ss p 3 be the tlp and p 4 be the spar being s is the set of platform capacity the model accept for example the s 1 be the standardized size that equals to 50 000 bbl d s 2 equals to 110 000 bbl d and s 3 equals to 150 000 bbl d the installed platform receives the flowrate qp ε r from the wells that is directly assigned in addition with the flowrate zpm ε r from the assigned manifolds and the total flowrate at the platform p cannot exceed the size s capacityps eq 22 and 23 20 s s y p s 1 p p 21 w w x p w m m x p m m a x w e l l s s s y p s p p 22 q p w w x p w q w p p 23 m m z p m q p s c a p a c i t y p s p p 4 theory and calculation in this section the theory and calculation steps of the solution are presented in order to confirm that the solution provided by the model has built the system right while satisfying the specific constraints 4 1 model solution the optimal solution of the model is constructed following two phases the first phase involves the parameters to be determined and the second phase consists of the model implementation the production facility location manifold location and infrastructures distances calculation are the main parameters to be determined according to the production facility location it is common practice in the oil industry to determine the production facility position allowing for a safety distance margin of the subsea layout to avoid any failure event on the subsea equipment related to dropped objects according to lu et al 2018 the dropped objects is the hazardous accident that impact the risk most due to it can cause structural damage on equipment and components the possible manifold location depends on the wells clustering division which is a result of the centroid point calculation for the x axis and y axis the centroid equation relates the position and number of wells to the cluster according to the number of manifold slots following wang et al 2012 the optimal location coordinates of cluster manifold is the arithmetic mean of the coordinates of wells into a finite set of wells the calculation of the centroid point follows the eqs 24 and 25 24 c x x w 1 x w 2 x w n k 25 c y y w 1 y w 2 y w n k additionally the platform point on the seabed is represented by the touch down point tdp that is the first point where the riser touches the seabed the length of the riser depends on the production facility location and the riser configuration previously adopted in the case of the free hang catenary configuration the calculation of the minimum riser length can be done following the eq 26 as presented by faltinsen 1990 26 l m i n h 2 t m a x w h 1 1 2 the distance between two points on the seabed is calculated from the euclidian distance between the cartesian coordinates x y plane according to the eq 27 fig 6 shows the infrastructures distances calculation on the seabed and riser configuration 27 d i s t x y x i x j 2 y i y j 2 the model implementation is the second step after all the necessary input data is obtained the ibm ilog cplex optimization studio is the environment used to implement the model given in eqs 1 23 4 2 model verification aiming at the verification of the solution provided by the model a small example of the development of a production system is described in this section four wells are planned for production and the estimated flowrate of each well is extrapolated to 36 000 barrels per day bbl d to test the real model constraints therefore the only available manifold slot size is 4 slots the type of platforms considered are the ship shaped unit as platform one and platform two the available standardized platform capacity sizes are 150 000 bbl d size one and 110 000bbl d size two it is assumed that the costs of the platform capacity decrease approximately 1 3 times from capacity one to two for the first step of the model verification one possible location is assumed to install the platform p1 and two possible manifold locations m1 and m2 the calculated euclidian distances between the main components of the production system wells manifolds and touch down point of the platform are shown in table 1 fig 7 illustrates in a simple form the model solutions for all the verification steps from the solution 1 presented in fig 7 it is possible to verify that the model assigned all the wells to one manifold m1 and the manifold m1 to the only available platform location p1 the platform p1 receives a flowrate of 144 000bbl d which represents the summation of the wells flowrates at the manifold m1 also the received flowrate at the platform p1 did not exceed the chosen platform capacity of 150 000 bbl d s1 it is important to note that the solution guarantees the minimum distance thus reducing the pipeline cost there is an 88 km pipeline length from the wells to the touch down point of the platform using the manifold m1 to make the subsea layout instead of 92 km pipeline length in case the model assigned all the wells to manifold m2 now as a second step of the model verification one more possible location to install the platform is given as input data of the model the same standardized platform capacities 150 000 bbl d and 110 000bbl d are also available the distances between the components including the second possible location of the touch down point of platform p2 is shown in table 2 the new solution 2 fig 7 shows that the platform p2 is installed with the capacity of 150 000 bbl d s1 and it is also possible to verify that the chosen capacity did not exceed the total received flowrate at the platform 144 000 bbl d which accounting the summation of the total manifold m1 received a higher flowrate of 108 000 bbl d more the direct flowrate of well w4 36 000 bbl d from this solution it is also possible to verify that the clustering of all wells is not anymore the optimal global solution the small distance between the well w4 and the platform p2 enforce the directly assignment of the well to the platform it implies that the model still search for the minimum pipeline length which now equals 81 km the third step of the verification of the model assumes that the model has in terms of input data two possible locations to install the platform p1 and p2 two possible locations to install the manifold m1 and m2 and the same distances as presented in the second step of the model verification table 2 however the flowrate of each well changes to 38 000 bbl d the solution 3 in fig 7 shows that the two available platform capacity sizes 150 000 bbl d and 110 000 bbl d for one platform cannot store the new total production of the wells 1520 000 bbl d so to fulfil the capacity constraints of the platform the model installs two platforms and each with the smallest capacity of 110 000 bbl d s2 platform p1 receives a total flowrate of 76 000 bbl d from the wells w2 and w3 through manifold m1 and platform p2 receive the total flowrate of 76 000 bbl d from the wells w1 and w4 which are directly assigned the choice of the smallest capacity confirms that the model searches for the minimum global investment cost if the model looked only for the minimization of the pipeline cost the assignment of the wells w1 w2 and w3 to the manifold m1 the assignment of the respective manifold to the platform p1 with the capacity of 150 000 bbl d s1 more the assignment of the well w4 directly to the platform p2 with the capacity of 110 000 bbl d s2 is the optimal solution the platform capacities did not exceed the total flowrate of 114 000 bbl d and 38 000 bbl d respectively however the cost of increasing the platform capacity size is higher than the cost of the pipeline length through this verification process it is possible to recognize the effect of uncertainty when the flowrate of each well increases 2000 bbl d the available platform capacities are not able to store all the production at one platform and the model is forced to install two platforms following lin et al 2013 flexibility is a method of recognizing the effect of uncertainty the authors also suggest that flexibility during the oilfield development can enhance the value of the project and one form of taking flexibility into account is allowing for the expansion of the production facility so for the next step of the model verification another platform capacity 180 000 bbl d was given thus increasing the platform capacity of size of platform three to approximately 1 3 times from size one the model has now three available platform capacities 180 000 150 000 110 000 bbl d two possible platform locations p1 and p2 two possible manifold locations m1 and m2 and the same distances presented in table 2 the solution 4 in fig 7 demonstrates that the platform capacity of 180 000 bbl d s3 is now the optimal choice for this verification step the higher capacity allows the clustering of wells w1 w2 and w3 to manifold m1 and the assignment of the respective manifold to the platform p2 moreover the directly assignment of well w4 to the platform p2 this optimal solution confirm that the model searches for the minimum global investment cost the solution presents the minimum pipeline length 81 km and also guarantees that the cost of improving the platform capacity is better than the cost of installing two platforms 5 results and discussion the proposed milp model was applied to a realistic scenario to assess the relevance of the production system solution and the computational performance of the results this section presents a case study and the respective discussions of the results 5 1 case study assuming a case scenario of an offshore oilfield with the size of the reservoir considered as medium with the volume of oil in place evaluated in 2 880 000 bbl the mean water depth of the oilfield location equals 1 400m the predicted number of wells to be developed are 30 and the estimates of each well production flowrate is 6000 bbl d moreover the common standardized capacities of platforms are 180 000 150 000 and 110 000 bbl d table 3 shows the gross cost estimates used to develop the production system the riser configuration adopted is the free hanging catenary considering the flexible risers of an internal diameter of 8in and design pressure of 300 psi the dynamic loaded riser had its length estimated as 1860 m 1 2 times the value of the mean water depth was used for safety of all risers the wells clustering division is calculated to 4 and 6 manifold slot sizes furthermore 12 possible locations for the 4 slots manifolds were considered 8 possible locations for the 6 slots manifolds the 2 possible platform locations were designed considering the subsea wells positions and the possible manifolds locations to allow for a safe operation to simplify the case study the only type of platform considered is the ship shaped unit fig 8 shows the respective wells positions all possible locations of platforms and manifolds 5 2 production system solution results two similar instances are evaluated the only difference between the instances is the available capacity size of the platform for the first instance the available capacity sizes are 150 000 and 110 000 bbl d and for the second instance the three capacity sizes are available adding the 180 000 bbl d size fig 9 shows the optimal production system designs for each instance table 4 summarizes the main features of the optimal solutions provided by the model including the cost results combinatorial size of the model and computational time the ibm ilog cplex studio optimization ran in a workstation with 4 gb ram and pentium dual core of 3 ghz the optimal production system for solution one has two platforms with the capacity size of 110 000 bbl d and installed five manifolds of 6 slots to cluster all the wells the optimal solution for the second instance installed one platform with a higher capacity size of 180 000 bbl d and five manifold of 6 slots for this instance however the model choose manifold m8 instead of manifold m7 as presented in the fig 9 both production systems are the most economic and technically feasible solutions of each evaluated instance however only one of the solutions can be chosen as the best production system to develop the proposed offshore oilfield the total cost of the first production system equals us 1 37 10 09 being the cost of platforms the bigger portion of the total cost the total cost of the second solution is us 3 52 10 08 less than the solution of the first instance due to the difference between the installations of one bigger platform instead of two smaller platforms table 4 moreover the production system of the first solution provides more flexibility as it allows the connection of future tie back wells at the platforms instead of the platform capacity of the second production system that works at the maximum capacity the production system solutions meet all requirements in a reasonable timeframe the computer performance takes 1 97 and 3 18 s to achieve the optimal solutions one and two respectively 6 discussion the present milp model provides an improvement of the system level performance of the production system when compared with the solution established by the model presented in rodrigues et al 2016 the authors did not mention any detailed constraints of the subsea layout design it is only assumed that all the wells are assigned to one node however the model treats the manifold and the platform as the same corresponding node being the manifold the node on the seabed and the platform on the sea surface the described above research works related to the subsea layout design hong et al 2018 rosa et al 2018 wang et al 2016 2012 highlighted that the cluster manifold has standardized sizes according to the number of slots from the engineering point of view wang et al 2016 addresses a directional correlation between the number of slots size and weight of the manifold a greater number of manifold slots may result in a much bigger and heavier manifold it may also lead to greater challenges in the manifold installation the 4 slots and 6 slots are established by wang et al 2012 as the most common types of cluster manifolds furthermore the model addressed by rodrigues et al 2016 considered the wells location problem similar to the well assignment problem affirming that the assignment of the well is only possible if the well is located the proper well location to achieve a high probability of success the well drilling type to maximize the drainage area and the estimated well flowrate are part of a complex and uncertain problem depending on the reservoir characteristics and modelling chang et al 2015 for those reasons this problem falls outside the scope of this paper the production system results provided by the present milp model confirm that the optimization tool searches for the optimal system level performance and satisfy all the constraints of the model according to the solutions all of the predicted wells of the oilfield are connected to only one facility which in this case study the facility is the manifold and the respective manifolds are connected to a single platform only the subsea layout designed is equivalent to the clustered satellite wells system the clustering of wells minimize the total pipeline length and the respective pipeline costs these are the two main advantages of the clustered satellite wells layout system it helps confirm the reasons why some scholars hong et al 2018 wang et al 2016 2014a 2012 studied the main aspects of the clustered satellite wells system more frequently than other layout options as for example the daisy chain layout design studied by wang et al 2014b moreover the reduction on the number of flowlines reduces also the number of risers as described above the riser lines reduction is a requirement to allow the application of turret mooring concept and can improve the spread mooring performance in terms the restoring force of the dynamic loads the flowrate balance constraints are also satisfied in terms of volume conservation the flowrate that goes out of the manifold equals the total incoming well flowrates in parallel the production received at each platform represents the summation of each flowrate that goes out of the manifolds connected to the platform the production facility designed did not exceed each platform capacity and the number of wells connected to each manifold did not exceed the manifold slot size therefore the model chooses the optimal subsea layout design and floating production system for each instance tested furthermore the chosen platform capacity can defines the best concept of the floating platform the properly floating structures allows the early coupled dynamics analysis of the platform mooring risers concepts the computer performance takes approximately 4 s to achieve the optimal solutions the ibm ilog cplex studio optimization ran in a workstation with 4 gb ram and pentium dual core of 3 ghz 7 conclusions the developed mathematical approach attempts to integrate the investment planning and facility location allocation problems advancing the state of the art solutions which did not address this integration the mathematical programming model serves as a quantified tool to screening the initial possible capital expenditures pointing out the facilities and equipment costs additional cost of facilities expansion technology selection location number and capacity of the floating unit and or manifold and the properly assignment of wells all of these possible systems layouts and respective initial costs are important decisions that can help the decision makers and be addressed in the front end engineering feed the feed is applied as the initial stage of the detailed engineering to discover what resources will be need to developed the project and cost estimation of them only few reservoir parameters are necessary to input in the model number and location of wells and the estimated maximum well flowrates according to these simple and static approach of the reservoir behavouir the decision makers can investigate how the field production at the production plateau will impact on the floating unit design and which subsea arrangement satellite clustered or a mix of them best fits the oilfield characteristics from a robust reservoir simulation the decision makers can change these simple metrics and run different what if scenarios in terms of floating and subsea systems without spending a huge computational effort and time to develop all possible system architectures afterwards the decision makers can choose the solution that best fits the oilfield characteristics and economics to explore in detail all the field behavior during the field life cycle a more detailed reservoir dynamic metrics are important parameters to consider if the model attempt to assist engineers at the strategic level of production planning optimization where the hydrocarbon recovery or npv need to be coupled with a more detailed production system however when an extensive reservoir engineering analysis is made and the reservoir model is available it reduces the high uncertainties associated to the prediction of production variables besides the model verification a case study scenario is performed and discussed to present the relevance and computational performance of the solution provided by the model the main benefits of the model are do not be closed into one subsea production layout defined into the literature and the system solutions meet all the model requirements in a reasonable time and solution gap acknowledgements this is a follow up of the work financed by embrapii coppe unit subsea technology which was performed within the project submarine systems conducted in cooperation with coppe ufrj the first author holds a phd scholarship financed partially by the university of lisbon and partially by the centre for marine technology and ocean engineering centec the last author has held a visiting position at coppe ufrj which was supported by conselho nacional de desenvolvimento cientifico e tecnologico cnpq 
22427,subsea christmas trees are critical pieces of equipment in subsea production systems and the main components of subsea christmas trees are all electric valves and actuators a pressure compensated valve actuator was proposed in this paper which substantially reduced the high pressure hydraulic resistance during valve closure according to the dynamic characteristics of this valve actuator under certain volume constraints a performance optimization method was further proposed to minimize the fail close time of the valve actuator and minimize the resultant vibrations five design parameters of the valve actuator were optimized relation curves of the geometrical parameters of the actuator with respect to the fail close time and gate terminal speed were acquired with matlab simulink software according to the optimization results the valve and its actuator were fabricated the horizontal and vertical accelerations under valve fail close event were obtained through vibration experiments the experimental results indicated that the fail close time of the valve was basically identical to the theoretically calculated value and that the end vibrations were within the allowable range these results verify the correctness of the optimization method proposed in this paper and show that the designed pressure compensated valve actuator has sufficient safety and can be applied to subsea christmas trees keywords subsea christmas tree subsea production system pressure compensation valve dynamic characteristics vibration experiment nomenclature a 1 cross sectional area of large cylinder a 2 cross sectional area of small cylinder a 3 cross sectional area of gate a 4 drift diameter of the valve α o p e n initial opening acceleration d 1 diameter of large cylinder d 2 diameter of small cylinder d f p diameter of floating piston d o r i f i c e diameter of compensation orifice d o r 1 diameters of seal rings 1 d o r 2 diameters of seal rings 2 d s t e m drift diameter of the valve stem d v s cross sectional area of the valve e elasticity modulus e pre compression ratio f s p r i n g spring force f c o p pressures acting on areas a 1 f e x p pressures acting on areas a 2 f 1 frictional force between large cylindrical surface and cover f 2 frictional force between small cylindrical surface and cover f g v frictional forces between valve stem and cover f s e a l frictional forces between gate and cover g gravitational acceleration k stiffness coefficient of spring l o r i f i c e length of compensation orifice m the total mass of gate valve stem and compensation piston p 0 standard atmospheric pressure p c o p air pressure value in chamber a p e x p air pressure value in chamber b p i n t l e t inlet pressure of compensation orifice p x pressure of sealed oil fluid q f p flow quantity t o p e n opening time t c l o s e fail close time μ poisson s ratio v 1 the velocity of m v 1 initial volume of chamber a v 2 initial volume of chamber b v c o p current volume of chamber a v e x p current volume of chamber b 1 introduction subsea production system has gradually developed towards deepwater bhattacharyya and cheliyan 2019 so the traditional hydraulic system huang et al 2018 can t satisfy demands and then all electric system shows its prominent advantages giant oil companies like fmc cameron and aker have competed with each other to research and develop all electric christmas trees and the first generation of all electric christmas tree completed sea trial in 2008 all electric valve and actuator are the most critical components of an all electric christmas tree requiring working conditions which can resist against high pressure high temperature and extreme water depth in order to prevent safety accident induced by any christmas tree fault it s especially important to design its failure protection mechanism valve failure protection mechanisms include mechanical energy storage failure protection mechanism and uninterrupted power system ups failure protection mechanism stropnik et al 2018 tareen and mekhilef 2016 as service life of christmas tree usually can reach 20 years long time continuous power supply makes the ups failure protection mechanism unpractical mechanical energy storage failure protection mechanism is most commonly used in the application of an energy storage device for a subsea tree valve actuator spring type energy storage structure is most widely used however starting of the spring energy storage device will give rise to too large valve opening force and too large vibration shock which further cause valve seal failure dev et al 2016 liu and callies 2019 therefore performance analysis and structural optimization of valve and valve actuator of all electric christmas trees are essential links in the design process excellent all electric valves and actuators performance specifications require smaller opening force shorter fail close time and lower vibration shock an effective way to achieve the above three objectives is to design a pressure compensation mechanism that fully utilizes the high pressure fluid inside the valve body to counteract the resistance of the energy storage mechanism lisowski et al 2015 studied the flow characteristics of the multi section proportional directional control valve based on the cfd optimization method and the geometry of the valve core were redesigned to achieve the effect of fluid pressure compensation which effectively relieved the pressure shock xie et al 2018 proposed a method to optimize a structure that could compensate the steady axial flow force acting on the spool in a converged flow cartridge proportional valve however such valves were not suitable for using in a subsea all electric tree system the subsea tree valves use a gate type gate to quickly open and close the oil circuit and the flow rate of the oil circuit is not required to be adjusted the design using complicated flow channel increases the size of the valve body and control complexity so it is not necessary other researchers also effectively provided pressure compensation through the design of an external accumulator in order to improve the stability reliability and reduce pulsation and vibration of the subsea piston pump a new crankshaft seawater piston pump with accumulator pressure compensation was designed by zhang et al zuti et al 2019 latas and stojek 2018 presented a model and a simulation study of a new type of hydrokinetic accumulator with increased energy storage density which had the ability to control the pressure in the hydraulic lift system van de ven 2013 presented a novel hydraulic accumulator that used a piston with an area that varied with stroke to maintain a constant hydraulic system pressure while the gas pressure changed although these designs can be pressure compensated to reduce pressure shock however conventional hydraulic accumulators suffer from two major limitations i e the hydraulic system pressure varies with the quantity of energy stored and the energy density is significantly lower than other energy domain more importantly the subsea all electric tree has replaced the hydraulic system with an all electric system as a major innovation avoiding the shortcomings of the leakage risk the delay of the pressure signal and the high cost of the hydraulic system therefore the external accumulator design can be well applied to the full hydraulic tree system but does not solve the pressure compensation of the all electric tree valve actuator the analysis of valve dynamic parameters is the key to valve design and optimization cao et al 2016 a large number of scholars have conducted related research on various types of valves ma et al 2018 studied the influence of the valve s lag on pressure pulsation and analyzed the fluid performance using cfd method the study provided a theoretical basis for the design of high efficiency multiphase pump and valve asim et al 2019 carried out to analyse the complex flow behavior within valve flow paths using cfd to investigate the effects of the geometrical features of flow paths on the flow capacity of the trim at various valve opening positions lisowski and filo 2016 analyzed the flow characteristics of a proportional flow control valve and to improve its characteristics by means of geometrical modifications of the valve spool dynamic characteristic optimization based method is widely used in the valve design process the dynamic characteristics include displacement velocity and acceleration of the research object cai et al 2013 xu et al 2014 presented a directional control valve with fast response and high flow capacity according to the dynamic characteristics analysis qian et al 2014 established the mathematical model of pilot control globe valve and employed the cfd method to numerically simulate valve dynamic characteristics and the best design point was obtained by studying the characteristic curves of the valve core s displacement tian et al 2019 developed a structural optimization design method for jacket platform structure based on dynamic characteristics optimization theory these related researches mainly aim at valves applicable to the hydraulic production system but in the design process of valves used in the subsea all electric production system these analyses can be important theoretical and methodological references at present fmc aker and cameron have developed all electric valve actuators using spring type energy storage devices these actuators need to oppose the resistance of the high pressure fluid in the valve body when a fail close occurs thus the force of the spring needs to be very large to meet this requirement when the valve is opened the power system needs to resist the very large spring forces which ultimately increases the size of the entire actuator and consumes more energy a new pressure compensation all electric control valve and actuator integrated structure is proposed in this paper which effectively overcomes the defects of current valve actuators in the subsea energy production system herein the actuator structure is optimized based on dynamic characteristics moreover the high pressure fluid inside the valve body is balanced by designing a pressure compensation system when a fail close occurs the actuator does not need to oppose the high pressure fluid resistance which greatly reduces the force of the spring thereby making the structure of the actuator more compact and consuming less energy according to the optimization results an all electric actuator is manufactured and the performance of this device is investigated experimentally to verify the proposed optimization procedure 2 mathematical model 2 1 pressure compensation system design the basic structure of an existing christmas tree valve and actuator is shown in fig 1 winther larssen 2007 wherein the structure mainly includes the power system transmission system and valve assembly during the valve opening process the power system drives the forward rotation of the lead screw which converts rotational motion into rectilinear motion of the screw nut the screw nut is connected to the valve stem through the linkage gear to overcome the frictional force between the gate and the seal ring the frictional force between the valve stem and the filler the resistance of the high pressure medium and the reactive force of the spring driven and dives a rightward shift of the valve stem and gate the valve completes the opening motion when the position sensor gives the feedback that the gate through hole is overlapping the production pipeline when well repair and well flushing are needed the valve should be closed at such times the ground master control station mcs manages the power loss of the electromagnet while the motor of the actuating mechanism is electrified the motor induces reverse rotation and under the effect of restoring the force of the compression spring the screw nut drives a leftward shift of the valve stem and gate to realize valve closing when any emergency occurs such as faults in the power supply or communications system both the motor and electromagnet will lose power under the effect of compression spring force the valve realizes an emergency fail close because the peak pressure of the internal high pressure fluid can reach 69 mpa when such great pressure acts upon the cross section of the gate the spring force must overcome the large resistance from the fluid which can usually reach a 1000 n therefore the compression force of the spring must be sufficiently large to overcome this resistance and the power system needs to provide sufficient power to compress the spring to open the valve which will not only enlarge the overall dimensions of the actuator part but also consume more energy to overcome the above disadvantages a built in pressure compensation system was proposed in this paper as shown in fig 2 wherein this system mainly includes a cover a transmission mechanism a valve steam a floating piston a spring and a compensation piston under the initial conditions the compensation chamber is filled with oil fluid blue marked as shown in fig 3 when the valve is opened high pressure crude oil yellow marked inside the pipeline transmits pressure rightward through the compensation orifice and extrudes the floating piston which is under a floating state to separate high pressure crude oil from oil fluid in the compensation chamber and keep the oil fluid in the compensation chamber clean under steady state conditions the yellow marked high pressure crude oil and the blue marked liquid are theoretically under an isobaric state thus the blue marked liquid is a high pressure liquid the compensation piston consists of a small cylinder and a large cylinder as shown in fig 4 the cross sectional area of the large cylinder is a 1 whereas the cross sectional area of the small cylinder is a2 thus the difference in area of these two cylinders is δ a a 1 a 2 the high pressure liquid in the compensation chamber acts on the surface with an area difference which generates a left force that offsets the force applied by the yellow marked high pressure crude oil on the gate section when a valve fail close occurs the spring does not need to overcome the abovementioned large resistance thereby providing a substantial reduction in the spring force the overall valve dimensions and the energy consumption however valve opening and closing is a continuous dynamic process and fluid characteristics are also under dynamic changes which is different from the ideal steady state to a certain degree different degrees of shock exist in the valve opening and closing process in particular when a fail close occurs the valve will generate a large acceleration under the effect of the spring force because the valve is free of the influence of high pressure resistance and at the end of gate travel high speed shock and vibrations can occur which can potentially cause seal failure empirically the vibration acceleration of the valve gate should be less than 1 10 3 m s 2 cai et al 2013 therefore the dynamic characteristics of the valve action process is a critical problem existing in valve design and optimization and the dynamic characteristics are directly related to structural parameters 2 2 dynamic characteristic parameters two working conditions of the valve are analyzed the opening process and the fail close process to simplify the analysis process and calculation assume that the valve is in a uniform linear state of motion during the opening process according to design specifications drift diameter initial opening speed acceleration and opening time of the valve are 32 mm 8 mm s α o p e n 0 and t o p e n 4 s respectively according to the subsea christmas tree design requirements dept 1989 spec n d valve to close automatically when power is lost or released however the design requirements for the fail close time are not clearly stated currently related technologies of all electric valve actuators are mainly monopolized by companies such as fmc aker and cameron they have their own independent corporate design standards and have not yet formed a unified international standard when the system fails a shorter fail close time is better and an appropriate time can reduce economic losses however a shorter fail close time means a faster closing speed a higher speed shock and a greater vibration thus a tradeoff exists when determining the closing speed therefore based on engineering experience and the application environment the fail close time is t c l o s e 8 s herein the emphasis is placed on studying the fail close process of the valve the main design parameters of the proposed pressure compensation valve and actuator are shown in fig 4 the diameter and cross sectional area of the large cylindrical surface of the compensation piston are d 1 and a 1 respectively the diameter and cross sectional area of the small cylindrical surface are d 2 and a 2 respectively the cross sectional area of the gate is a 3 the drift diameter and cross sectional area of the valve are d v s and a 4 respectively in order to ensure balanced pressure compensation a 3 a 1 a 2 the diameter and length of the compensation orifice are d o r i f i c e and l o r i f i c e respectively the drift diameter of the valve stem is d s t e m the diameter of the floating piston is d f p the total mass of the gate valve stem and compensation piston is m 2 3 mechanical model the valve and actuator are assembled on land under the initial state chamber a and chamber b are filled with air and their pressure values are both 1 standard atmospheric pressure p 0 the valve is balanced during the opening process because the valve opens at a constant speed this process will not be discussed herein when the valve exhibits fail close the gate valve valve stem and pressure compensation piston move downward under the thrust of varying spring force f s p r i n g and the velocity is recorded as v 1 as shown in fig 5 in this process the air in chamber a is expanded and the resultant pressure value is p c o p moreover the air in chamber b is compressed for which the pressure value is p e x p a large cylindrical surface and a small cylindrical surface of a pressure compensation piston realize a sliding seal with a cover through the seal ring the frictional force between the large cylindrical surface and the cover is f 1 similarly the frictional force between the small cylindrical surface and the cover is f 2 the change in the pressure of the sealed oil fluid will affect the radial pretightening force of the sealing rings increasing this pressure will increase the axial extrusion force of the seal ring which will induce radial expansion of the seal ring subsequently increasing the frictional force between the seal ring and the cover therefore f 1 and f 2 are both dynamic functions of the pressure of the sealed oil fluid p x the frictional force between the valve stem and the cover and the frictional force between the small cylindrical surface and the cover are f s e a l and f g v respectively as high pressure crude oil and oil fluid in the cylinder are balanced and isolated through the floating piston the floating piston and compensation piston are sealed using a seal ring and the frictional force between the floating piston and compensation piston is recorded as f 3 the inlet pressure of the compensation orifice is p i n t l e t as a certain pressure loss exists in liquid flow in long and thin holes aguirre et al 2019 a functional relation exists between t c l o s e and p i n t l e t under any state the air in chamber a and chamber b follows the clapeyron formula yang and jiang 2004 to simplify the calculation the temperature influence is not considered as shown in formulas 1 2 1 p 0 v 1 p e x p v e x p 2 p 0 v 2 p c o p v c o p where v 1 v c o p v 2 and v e x p are the initial volume and current volume of chamber a and chamber b respectively formulas 3 and 4 show the relations of the current volumes of chamber a and chamber b with the valve opening displacement x t respectively 3 v e x p v 1 d n a 1 a 1 x t 4 v c o p v 2 d n a 2 a 2 x t according to formulas 1 4 the pressures f e x p and f c o p acting on areas a 1 and a 2 due to air compression or expansion can be derived 5 f e x p p 0 v 1 v 1 d n a 1 a 1 x t a 1 6 f c o p p 0 v 2 v 2 d n a 2 a 2 x t a 2 high pressure crude oil flows from point 1 to point 2 along the compensation orifice the pressure at point 1 is p i n t l e t and the pressure at point 2 is p x as shown in fig 5 each fluid has a certain viscosity so in the corresponding flow process flow resistance will be generated with pressure loss δ p lisowski and rajda 2013 hence 7 p x p i n t l e t δ p according to the equation of linear pressure loss 8 δ p 128 x t l o r i f i c q f p π g d o r i f i c e 4 where x t is the fluid velocity l o r i f i c is the length of the compensation orifice d o r i f i c e is the diameter of the compensation orifice q f p is the flow volume and g is gravitational acceleration according to the geometrical relation 9 q f p π d f p 2 4 x t according to formulas 7 9 10 p x p i n t l e t 32 x t 2 l o r i f i c e d f p 2 g d o r i f i c e 4 differences in valve opening will cause changes in the inlet pressure so p i n t l e t is subjected to dynamic changes and has a functional relation with the valve opening displacement x t this relation is obtained according to a computational fluid mechanics simulation which will be given hereinafter according to the calculation formula of the frictional force of the seal ring under sliding seal conditions 11 f 1 0 2 ε π 2 d o r 1 e e d 1 1 μ 2 ε π d 1 d o r 1 p x 12 f 2 0 2 ε π 2 d o r 2 e e d 2 1 μ 2 ε π d 2 d o r 2 p x where e μ and e are the precompression ratio poisson s ratio and elastic modulus of the seal ring with values of 15 0 49 and 6 1 n mm 2 respectively ε is the friction coefficient between the seal ring and the cover which is 0 04 and d o r 1 and d o r 2 are the diameters of the seal rings at corresponding positions which are both 5 mm according to hooke s law the relation between the spring force and valve opening displacement is 13 f s p r i n g k x t where k is the stiffness coefficient of the spring note that 50crva steel is selected as the spring material which has an elastic modulus of 7900 n mm 2 tang et al 2017 in a specific design space the median diameter wire diameter and number of coils of the spring are 54 mm 5 5 mm and 16 respectively and the spring constant k 3 59 n mm force analysis of the valve during the closing process follows newton s second law 14 m x t f s p r i n g f 1 f 2 f 3 f s e a l f c o p f e x p to simplify the calculation process the frictional force f s e a l between the valve stem and the cover is set as a constant the frictional force f 3 between the floating piston and the compensation piston is considered negligible and m is the total mass of gate valve stem and compensation piston substituting formulas 5 6 and 10 13 into formula 14 yields 15 m x k x 0 2 ε π 2 d o r 1 e e d 1 0 2 ε π 2 d o r 2 e e d 2 1 μ 2 p i n t l e t 32 x t l o r i f i c e d f p 2 x t d o r i f i c e 4 ε π d 1 d o r 1 ε π d 2 d o r 2 p 0 v 2 v 2 d n a 2 a 2 x t π d 2 2 4 p 0 v 1 v 1 d n a 1 a 1 x t π d 1 2 4 f s e a l to clearly indicate the dynamic design parameters of the optimization analysis formula 15 is rewritten into a form of function mapping which is expressed as 16 m x f d 1 d 2 l o r i f i c e d o r i f i c e d f p 3 dynamic characteristic analysis and performance optimization there are three types of gates applied to subsea christmas tree valves parallel straight panels hollow gates and wedge shaped gates according to prior research wedge shaped gates have better mechanical and hydrodynamic properties than the other gate types liu et al 2019 this paper studies a 5 wedge shaped gate as shown in fig 4 α 5 valve opening displacement x t and inlet pressure p i n t l e t data were obtained based on the computational mechanics method in ansys in this simulation analysis inconel 718 is selected as the solid material and the fluid material is crude oil with a density of 810 kg m3 and a kinematic viscosity of 10 cp turbulence computing models are used at the velocity inlet and pressure outlet this part is not the emphasis of the study in this paper so it will not be described in detail the curves are fitted using a third order function as shown in fig 6 the drift diameter of the gate in this paper is 32 mm so the maximum value of x t is x t max 32 mm the valve actuator is restricted within a specific small volume with a constant length and diameter the objective is to optimize the design of individual components to achieve the minimum response time when the actuator is closed cai et al 2013 the five optimized characteristic parameters were d 1 d 2 l o r i f i c e d o r i f i c e and d f p the geometric optimization of the valve actuator was performed with matlab simulink software wu et al 2019 the simulink model which is shown in fig 7 consists of three main parts the input parameters subsystem the force subsystem and the dynamic characteristics subsystem these three subsystems are expanded as shown in figs 8 10 the input parameters subsystem acquires five dynamic parameters as the initial quantity input system the force subsystem calculates f 1 f 2 f s e a l f c o p f e x p and f s p r i n g according to formulas 5 6 10 11 12 and 13 respectively the dynamic characteristics subsystem calculates the displacement x velocity v and acceleration a of the combined mass m according to formula 14 a prototype of the valve actuator was developed based on design indicators combined with the basic knowledge of mechanical design mechanical analysis and strength verification the basic dimensions of the prototype were obtained as the initial conditions for the valve actuator the initial state is a complete valve open state and the initial conditions are p i n t l e t 1 0 mpa x t max 32 mm m 0 32 kg d 1 70 mm d 2 65 mm l o r i f i c e 185 mm d o r i f i c e 5 mm and d f p 35 mm the relation curves of displacement velocity and acceleration with respect to time are finally obtained as shown in fig 11 when the valve is under the initial conditions fig 11 shows that the fail close time is 4 37 s and the acceleration of the gate to reach the travel end is basically 0 so it belongs to a uniform motion state when the valve is closed the velocity decreases from 3 5 mm s to zero creating a shock with a certain speed an experimental method must be used to determine whether the axial and radial vibrational accelerations of the valve and actuator are within the stipulated range otherwise performance failure may be caused within the first 2 5 s t 1 the spring force plays a dominant role the acceleration of m is always greater than 0 and remains consistent with the velocity direction and this process occurs in an accelerated motion state wherein the acceleration gradually declines after 2 5 s t 2 p x increases due to the increasing fluid velocity at orifice and the increasing inlet pressure when the valve is closed finally the frictional force between the compensation piston and the cover increases at that time the resistance of m plays a leading role and the direction of acceleration becomes opposite to the direction of velocity therefore the velocity of m is reduced the sizes of d 1 and d 2 are changed to acquire relation curves of the two with respect to the valve fail close time and the terminal speed as shown in fig 12 according to fig 12 a and b when d 1 or d 2 increases the valve close time increases increasing the sizes of d 1 and d 2 will increase the large cylindrical surfaces and small cylindrical surfaces of the pressure compensation pistons and subsequently increase the frictional area between the seal ring and the cover as a result the motion resistance of m is elevated which obviously reduces the acceleration of m and increases the valve close time however as d 1 and d 2 increase the terminal speed of the gate which indicates the instantaneous speed before the valve is closed exhibits a declining trend as shown in fig 12 b the lower the terminal speed is the smaller the speed of the shock from the gate on the valve body pressure compensation principles require that a 3 a 1 a 2 if a 3 is too small d s t e m is too small which influences the structural strength of the valve stem thus the size of a 3 is tightly restricted for the above reasons and in full consideration of the requirements for the shock speed at the gate travel end and the structural strength the sizes of d 1 and d 2 are set to 70 mm and 63 mm respectively when the sizes of d 1 and d 2 are set to 70 mm and 63 mm respectively and d f p 35 mm l o r i f i c e and d o r i f i c e are changed to acquire change curves of the valve fail close time and terminal speed as shown in fig 13 according to fig 13 a the valve close time first decreases and then abruptly increases as l o r i f i c e increases when l o r i f i c e 185 mm the valve close time reaches minimum value however there is no significant correlation between the change in d o r i f i c e and the valve close time fig 13 b shows that no matter how the l o r i f i c e and d o r i f i c e values change the shock speed at the gate travel end changes slightly this terminal speed is between 4 2 mm s and 4 9 mm s without obvious laws based on the above results the values of l o r i f i c e and d o r i f i c e are 185 mm and 4 5 mm respectively furthermore the d o r i f i c e value is set to 4 5 mm to acquire the relation curves of l o r i f i c e and d f p with respect to the valve fail close time and terminal speed as shown in fig 14 as d f p increases the valve close time first increases and then suddenly decreases whereas the terminal speed first decreases and then increases when d f p 34 mm the valve close time is the longest approaching 4 7 s note that d f p cannot continuously increase due to size restrictions increasing d f p will decrease the wall thickness of the pressure compensation piston moreover fig 14 b shows that when d f p 35 mm the valve terminal speed is the lowest when d f p 36 mm the valve terminal speed increases sharply based on the above considerations the d f p value is set to 36 mm through the final analysis the optimized dynamic characteristic parameters of the pressure compensation valve and actuator are determined as follows d 1 70 mm d 2 63 mm l o r i f i c e 185 mm d o r i f i c e 4 5 mm and d f p 36 mm 4 experiments and discussion the valve and actuator were manufactured according to the optimization results as shown in fig 15 a schematic diagram of the experimental system is shown in fig 16 and a dynamic experiment of the system was also performed as shown in fig 17 the hydraulic station model hs 10 rated flow rate of 12 m3 h and rated power of 0 75 kw provided a constant speed high pressure fluid for the system the valve was connected in series in the oil circuit the pressure compensation actuator controlled the switch of the valve and the control signal was provided by the control system pressure transducers pt1 and pt2 model pcm300 range of 0 4 mpa precision of 0 5 full scale fs were installed at the inlet and outlet of the valve and the pressure values of the two points were collected to acquire accurate vibration acceleration signals of the actuator during the valve closing process two acceleration transducers vt1 and vt2 model lc0152 range of 100g were fixed on the bottom cover and the cylinder cover of the actuator respectively the data from the two pressure transducers and the two acceleration transducers were acquired and transmitted to the pc through an ni usb 231 data acquisition module eight single ended or four differential 16 bit analog inputs and 50 ks s maximum sampling rate and an ni 9234 data acquisition module four differential 24 bit analog inputs and 51 2 ks s maximum sampling rate the vibration experiments of the valve with actuator fail close were performed to investigate the performance of the actuators optimized under different internal pressure conditions the experiments were divided into four groups corresponding to the different inlet pressure values the four inlet pressures were set to 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa by adjusting the output of the hydraulic station which could be monitored in real time via pt1 in particular when the inlet pressure was 0 mpa a no load experiment was performed in the no load experiment there was no high pressure oil input into the valve body and there was no high pressure fluid resistance when the valve was closed these experimental results were used as a reference group to explore the effect of pressure compensation in the vibration experiment the valve was completely opened by the control system and then the power supply of the control system was suddenly cut off to simulate the failure of the actuator the valve was automatically closed by the internal fail close system of the actuator and the vibration data for this process were acquired with vt1 and vt2 when the inlet pressure was 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa the vertical and horizontal vibration accelerations were obtained when the fail close occurred these results are shown in figs 18 21 the figures show that at the moment of starting and closing of the valve there was a large vibration in both the horizontal and vertical directions after the intervention of the middle pressure compensation system the vibration was greatly reduced and the middle time was recorded as t c o m p e n s a t i o n when the inlet pressures were 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa the valve close time was t c l o s e 2 48 s t c l o s e 4 75 s t c l o s e 5 26 s and t c l o s e 6 57 s respectively indicating that the valve close time increased as the inlet pressure increased the friction between the pressure compensation piston and the cover increased as the internal fluid pressure increased therefore the average acceleration of m was reduced further increasing the closing time more importantly t c l o s e 4 75 s was in agreement with the simulation results as shown in fig 11 and the fail close time conformed to the design requirements i e the fail close time must be less than 8 s fig 18 shows that in the no load experiment the absolute value of the acceleration was greater than the acceleration values in figs 19 21 regardless that the acceleration was vertical or horizontal these results show that the design of the pressure compensation system contributes to reducing the vibration of the actuator a comparison of figs 19 a 20 a and 21 a shows that when the valve was started the absolute values of the vertical vibration acceleration peak values at the three inlet pressures were 0 12 10 3 m s 0 10 10 3 m s and 0 09 10 3 m s respectively similarly when the valve was closed the absolute values of the vertical vibration acceleration peaks at the three inlet pressures were 0 52 10 3 m s 0 34 10 3 m s and 0 29 10 3 m s respectively at the moment of valve starting and closing the absolute value of the vertical vibration acceleration peak value decreased with increasing inlet pressure indicating that the increase in the internal fluid contributed to the reduction in the system vibration and that the vibration value was within a reasonable range i e the vibration acceleration was less than 1 10 3 m s which shows good agreement with the optimization results a comparison of figs 19 b 20 b and 21 b shows that when the valve was started the absolute values of the horizontal vibration acceleration peak values at the three inlet pressures were 0 27 10 3 m s 0 11 10 3 m s and 0 08 10 3 m s respectively when the valve was closed the absolute values of the vertical vibration acceleration peaks at the three inlet pressures were 0 17 10 3 m s 0 52 10 3 m s and 0 38 10 3 m s respectively there was no obvious change in the variation in the horizontal vibration acceleration and inlet pressure but the vibration values were within a reasonable range these results show that the optimal design performance index of the valve with actuator met the design requirements 5 conclusions a new pressure compensation all electric control valve and actuator was developed in this paper the pressure compensation system which mainly includes cover transmission mechanism valve steam floating piston spring and compensation piston was proposed and used for the actuator the high pressure hydraulic resistance is overcome by using the pressure compensation system when the valve was closed this paper proposed a pressure compensated valve actuator that significantly reduced high pressure hydraulic resistance during valve closure through a pressure compensation system furthermore an optimization method was proposed based on the dynamic parameters of the actuator the objective was to optimize the designs of the individual components to achieve the minimum vibration value within the allowable fail close time range first a parametric model of the valve and actuator was established and theoretically analyzed then five dynamic parameters were optimized with matlab simulink while holding the other dimensions constant finally vibration experiments were carried out to verify that the optimized design of the pressure compensated valve actuator had a fail close time of 4 75 s and the absolute values of the vertical and horizontal vibration acceleration peaks were 0 29 10 3 m s and 0 38 10 3 m s respectively which were within the design range indicating that the system exhibited good performance declaration of competing interestcoi we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled performance analysis and optimal design based on dynamic characteristics for pressure compensated subsea all electric valve actuator acknowledgement the authors wish to acknowledge the financial support of national natural science foundation of china no 51779267 open fund of key pre research foundation of military equipment of china no 6140923030702 doctoral innovation engineering project no ycx2019056 
22427,subsea christmas trees are critical pieces of equipment in subsea production systems and the main components of subsea christmas trees are all electric valves and actuators a pressure compensated valve actuator was proposed in this paper which substantially reduced the high pressure hydraulic resistance during valve closure according to the dynamic characteristics of this valve actuator under certain volume constraints a performance optimization method was further proposed to minimize the fail close time of the valve actuator and minimize the resultant vibrations five design parameters of the valve actuator were optimized relation curves of the geometrical parameters of the actuator with respect to the fail close time and gate terminal speed were acquired with matlab simulink software according to the optimization results the valve and its actuator were fabricated the horizontal and vertical accelerations under valve fail close event were obtained through vibration experiments the experimental results indicated that the fail close time of the valve was basically identical to the theoretically calculated value and that the end vibrations were within the allowable range these results verify the correctness of the optimization method proposed in this paper and show that the designed pressure compensated valve actuator has sufficient safety and can be applied to subsea christmas trees keywords subsea christmas tree subsea production system pressure compensation valve dynamic characteristics vibration experiment nomenclature a 1 cross sectional area of large cylinder a 2 cross sectional area of small cylinder a 3 cross sectional area of gate a 4 drift diameter of the valve α o p e n initial opening acceleration d 1 diameter of large cylinder d 2 diameter of small cylinder d f p diameter of floating piston d o r i f i c e diameter of compensation orifice d o r 1 diameters of seal rings 1 d o r 2 diameters of seal rings 2 d s t e m drift diameter of the valve stem d v s cross sectional area of the valve e elasticity modulus e pre compression ratio f s p r i n g spring force f c o p pressures acting on areas a 1 f e x p pressures acting on areas a 2 f 1 frictional force between large cylindrical surface and cover f 2 frictional force between small cylindrical surface and cover f g v frictional forces between valve stem and cover f s e a l frictional forces between gate and cover g gravitational acceleration k stiffness coefficient of spring l o r i f i c e length of compensation orifice m the total mass of gate valve stem and compensation piston p 0 standard atmospheric pressure p c o p air pressure value in chamber a p e x p air pressure value in chamber b p i n t l e t inlet pressure of compensation orifice p x pressure of sealed oil fluid q f p flow quantity t o p e n opening time t c l o s e fail close time μ poisson s ratio v 1 the velocity of m v 1 initial volume of chamber a v 2 initial volume of chamber b v c o p current volume of chamber a v e x p current volume of chamber b 1 introduction subsea production system has gradually developed towards deepwater bhattacharyya and cheliyan 2019 so the traditional hydraulic system huang et al 2018 can t satisfy demands and then all electric system shows its prominent advantages giant oil companies like fmc cameron and aker have competed with each other to research and develop all electric christmas trees and the first generation of all electric christmas tree completed sea trial in 2008 all electric valve and actuator are the most critical components of an all electric christmas tree requiring working conditions which can resist against high pressure high temperature and extreme water depth in order to prevent safety accident induced by any christmas tree fault it s especially important to design its failure protection mechanism valve failure protection mechanisms include mechanical energy storage failure protection mechanism and uninterrupted power system ups failure protection mechanism stropnik et al 2018 tareen and mekhilef 2016 as service life of christmas tree usually can reach 20 years long time continuous power supply makes the ups failure protection mechanism unpractical mechanical energy storage failure protection mechanism is most commonly used in the application of an energy storage device for a subsea tree valve actuator spring type energy storage structure is most widely used however starting of the spring energy storage device will give rise to too large valve opening force and too large vibration shock which further cause valve seal failure dev et al 2016 liu and callies 2019 therefore performance analysis and structural optimization of valve and valve actuator of all electric christmas trees are essential links in the design process excellent all electric valves and actuators performance specifications require smaller opening force shorter fail close time and lower vibration shock an effective way to achieve the above three objectives is to design a pressure compensation mechanism that fully utilizes the high pressure fluid inside the valve body to counteract the resistance of the energy storage mechanism lisowski et al 2015 studied the flow characteristics of the multi section proportional directional control valve based on the cfd optimization method and the geometry of the valve core were redesigned to achieve the effect of fluid pressure compensation which effectively relieved the pressure shock xie et al 2018 proposed a method to optimize a structure that could compensate the steady axial flow force acting on the spool in a converged flow cartridge proportional valve however such valves were not suitable for using in a subsea all electric tree system the subsea tree valves use a gate type gate to quickly open and close the oil circuit and the flow rate of the oil circuit is not required to be adjusted the design using complicated flow channel increases the size of the valve body and control complexity so it is not necessary other researchers also effectively provided pressure compensation through the design of an external accumulator in order to improve the stability reliability and reduce pulsation and vibration of the subsea piston pump a new crankshaft seawater piston pump with accumulator pressure compensation was designed by zhang et al zuti et al 2019 latas and stojek 2018 presented a model and a simulation study of a new type of hydrokinetic accumulator with increased energy storage density which had the ability to control the pressure in the hydraulic lift system van de ven 2013 presented a novel hydraulic accumulator that used a piston with an area that varied with stroke to maintain a constant hydraulic system pressure while the gas pressure changed although these designs can be pressure compensated to reduce pressure shock however conventional hydraulic accumulators suffer from two major limitations i e the hydraulic system pressure varies with the quantity of energy stored and the energy density is significantly lower than other energy domain more importantly the subsea all electric tree has replaced the hydraulic system with an all electric system as a major innovation avoiding the shortcomings of the leakage risk the delay of the pressure signal and the high cost of the hydraulic system therefore the external accumulator design can be well applied to the full hydraulic tree system but does not solve the pressure compensation of the all electric tree valve actuator the analysis of valve dynamic parameters is the key to valve design and optimization cao et al 2016 a large number of scholars have conducted related research on various types of valves ma et al 2018 studied the influence of the valve s lag on pressure pulsation and analyzed the fluid performance using cfd method the study provided a theoretical basis for the design of high efficiency multiphase pump and valve asim et al 2019 carried out to analyse the complex flow behavior within valve flow paths using cfd to investigate the effects of the geometrical features of flow paths on the flow capacity of the trim at various valve opening positions lisowski and filo 2016 analyzed the flow characteristics of a proportional flow control valve and to improve its characteristics by means of geometrical modifications of the valve spool dynamic characteristic optimization based method is widely used in the valve design process the dynamic characteristics include displacement velocity and acceleration of the research object cai et al 2013 xu et al 2014 presented a directional control valve with fast response and high flow capacity according to the dynamic characteristics analysis qian et al 2014 established the mathematical model of pilot control globe valve and employed the cfd method to numerically simulate valve dynamic characteristics and the best design point was obtained by studying the characteristic curves of the valve core s displacement tian et al 2019 developed a structural optimization design method for jacket platform structure based on dynamic characteristics optimization theory these related researches mainly aim at valves applicable to the hydraulic production system but in the design process of valves used in the subsea all electric production system these analyses can be important theoretical and methodological references at present fmc aker and cameron have developed all electric valve actuators using spring type energy storage devices these actuators need to oppose the resistance of the high pressure fluid in the valve body when a fail close occurs thus the force of the spring needs to be very large to meet this requirement when the valve is opened the power system needs to resist the very large spring forces which ultimately increases the size of the entire actuator and consumes more energy a new pressure compensation all electric control valve and actuator integrated structure is proposed in this paper which effectively overcomes the defects of current valve actuators in the subsea energy production system herein the actuator structure is optimized based on dynamic characteristics moreover the high pressure fluid inside the valve body is balanced by designing a pressure compensation system when a fail close occurs the actuator does not need to oppose the high pressure fluid resistance which greatly reduces the force of the spring thereby making the structure of the actuator more compact and consuming less energy according to the optimization results an all electric actuator is manufactured and the performance of this device is investigated experimentally to verify the proposed optimization procedure 2 mathematical model 2 1 pressure compensation system design the basic structure of an existing christmas tree valve and actuator is shown in fig 1 winther larssen 2007 wherein the structure mainly includes the power system transmission system and valve assembly during the valve opening process the power system drives the forward rotation of the lead screw which converts rotational motion into rectilinear motion of the screw nut the screw nut is connected to the valve stem through the linkage gear to overcome the frictional force between the gate and the seal ring the frictional force between the valve stem and the filler the resistance of the high pressure medium and the reactive force of the spring driven and dives a rightward shift of the valve stem and gate the valve completes the opening motion when the position sensor gives the feedback that the gate through hole is overlapping the production pipeline when well repair and well flushing are needed the valve should be closed at such times the ground master control station mcs manages the power loss of the electromagnet while the motor of the actuating mechanism is electrified the motor induces reverse rotation and under the effect of restoring the force of the compression spring the screw nut drives a leftward shift of the valve stem and gate to realize valve closing when any emergency occurs such as faults in the power supply or communications system both the motor and electromagnet will lose power under the effect of compression spring force the valve realizes an emergency fail close because the peak pressure of the internal high pressure fluid can reach 69 mpa when such great pressure acts upon the cross section of the gate the spring force must overcome the large resistance from the fluid which can usually reach a 1000 n therefore the compression force of the spring must be sufficiently large to overcome this resistance and the power system needs to provide sufficient power to compress the spring to open the valve which will not only enlarge the overall dimensions of the actuator part but also consume more energy to overcome the above disadvantages a built in pressure compensation system was proposed in this paper as shown in fig 2 wherein this system mainly includes a cover a transmission mechanism a valve steam a floating piston a spring and a compensation piston under the initial conditions the compensation chamber is filled with oil fluid blue marked as shown in fig 3 when the valve is opened high pressure crude oil yellow marked inside the pipeline transmits pressure rightward through the compensation orifice and extrudes the floating piston which is under a floating state to separate high pressure crude oil from oil fluid in the compensation chamber and keep the oil fluid in the compensation chamber clean under steady state conditions the yellow marked high pressure crude oil and the blue marked liquid are theoretically under an isobaric state thus the blue marked liquid is a high pressure liquid the compensation piston consists of a small cylinder and a large cylinder as shown in fig 4 the cross sectional area of the large cylinder is a 1 whereas the cross sectional area of the small cylinder is a2 thus the difference in area of these two cylinders is δ a a 1 a 2 the high pressure liquid in the compensation chamber acts on the surface with an area difference which generates a left force that offsets the force applied by the yellow marked high pressure crude oil on the gate section when a valve fail close occurs the spring does not need to overcome the abovementioned large resistance thereby providing a substantial reduction in the spring force the overall valve dimensions and the energy consumption however valve opening and closing is a continuous dynamic process and fluid characteristics are also under dynamic changes which is different from the ideal steady state to a certain degree different degrees of shock exist in the valve opening and closing process in particular when a fail close occurs the valve will generate a large acceleration under the effect of the spring force because the valve is free of the influence of high pressure resistance and at the end of gate travel high speed shock and vibrations can occur which can potentially cause seal failure empirically the vibration acceleration of the valve gate should be less than 1 10 3 m s 2 cai et al 2013 therefore the dynamic characteristics of the valve action process is a critical problem existing in valve design and optimization and the dynamic characteristics are directly related to structural parameters 2 2 dynamic characteristic parameters two working conditions of the valve are analyzed the opening process and the fail close process to simplify the analysis process and calculation assume that the valve is in a uniform linear state of motion during the opening process according to design specifications drift diameter initial opening speed acceleration and opening time of the valve are 32 mm 8 mm s α o p e n 0 and t o p e n 4 s respectively according to the subsea christmas tree design requirements dept 1989 spec n d valve to close automatically when power is lost or released however the design requirements for the fail close time are not clearly stated currently related technologies of all electric valve actuators are mainly monopolized by companies such as fmc aker and cameron they have their own independent corporate design standards and have not yet formed a unified international standard when the system fails a shorter fail close time is better and an appropriate time can reduce economic losses however a shorter fail close time means a faster closing speed a higher speed shock and a greater vibration thus a tradeoff exists when determining the closing speed therefore based on engineering experience and the application environment the fail close time is t c l o s e 8 s herein the emphasis is placed on studying the fail close process of the valve the main design parameters of the proposed pressure compensation valve and actuator are shown in fig 4 the diameter and cross sectional area of the large cylindrical surface of the compensation piston are d 1 and a 1 respectively the diameter and cross sectional area of the small cylindrical surface are d 2 and a 2 respectively the cross sectional area of the gate is a 3 the drift diameter and cross sectional area of the valve are d v s and a 4 respectively in order to ensure balanced pressure compensation a 3 a 1 a 2 the diameter and length of the compensation orifice are d o r i f i c e and l o r i f i c e respectively the drift diameter of the valve stem is d s t e m the diameter of the floating piston is d f p the total mass of the gate valve stem and compensation piston is m 2 3 mechanical model the valve and actuator are assembled on land under the initial state chamber a and chamber b are filled with air and their pressure values are both 1 standard atmospheric pressure p 0 the valve is balanced during the opening process because the valve opens at a constant speed this process will not be discussed herein when the valve exhibits fail close the gate valve valve stem and pressure compensation piston move downward under the thrust of varying spring force f s p r i n g and the velocity is recorded as v 1 as shown in fig 5 in this process the air in chamber a is expanded and the resultant pressure value is p c o p moreover the air in chamber b is compressed for which the pressure value is p e x p a large cylindrical surface and a small cylindrical surface of a pressure compensation piston realize a sliding seal with a cover through the seal ring the frictional force between the large cylindrical surface and the cover is f 1 similarly the frictional force between the small cylindrical surface and the cover is f 2 the change in the pressure of the sealed oil fluid will affect the radial pretightening force of the sealing rings increasing this pressure will increase the axial extrusion force of the seal ring which will induce radial expansion of the seal ring subsequently increasing the frictional force between the seal ring and the cover therefore f 1 and f 2 are both dynamic functions of the pressure of the sealed oil fluid p x the frictional force between the valve stem and the cover and the frictional force between the small cylindrical surface and the cover are f s e a l and f g v respectively as high pressure crude oil and oil fluid in the cylinder are balanced and isolated through the floating piston the floating piston and compensation piston are sealed using a seal ring and the frictional force between the floating piston and compensation piston is recorded as f 3 the inlet pressure of the compensation orifice is p i n t l e t as a certain pressure loss exists in liquid flow in long and thin holes aguirre et al 2019 a functional relation exists between t c l o s e and p i n t l e t under any state the air in chamber a and chamber b follows the clapeyron formula yang and jiang 2004 to simplify the calculation the temperature influence is not considered as shown in formulas 1 2 1 p 0 v 1 p e x p v e x p 2 p 0 v 2 p c o p v c o p where v 1 v c o p v 2 and v e x p are the initial volume and current volume of chamber a and chamber b respectively formulas 3 and 4 show the relations of the current volumes of chamber a and chamber b with the valve opening displacement x t respectively 3 v e x p v 1 d n a 1 a 1 x t 4 v c o p v 2 d n a 2 a 2 x t according to formulas 1 4 the pressures f e x p and f c o p acting on areas a 1 and a 2 due to air compression or expansion can be derived 5 f e x p p 0 v 1 v 1 d n a 1 a 1 x t a 1 6 f c o p p 0 v 2 v 2 d n a 2 a 2 x t a 2 high pressure crude oil flows from point 1 to point 2 along the compensation orifice the pressure at point 1 is p i n t l e t and the pressure at point 2 is p x as shown in fig 5 each fluid has a certain viscosity so in the corresponding flow process flow resistance will be generated with pressure loss δ p lisowski and rajda 2013 hence 7 p x p i n t l e t δ p according to the equation of linear pressure loss 8 δ p 128 x t l o r i f i c q f p π g d o r i f i c e 4 where x t is the fluid velocity l o r i f i c is the length of the compensation orifice d o r i f i c e is the diameter of the compensation orifice q f p is the flow volume and g is gravitational acceleration according to the geometrical relation 9 q f p π d f p 2 4 x t according to formulas 7 9 10 p x p i n t l e t 32 x t 2 l o r i f i c e d f p 2 g d o r i f i c e 4 differences in valve opening will cause changes in the inlet pressure so p i n t l e t is subjected to dynamic changes and has a functional relation with the valve opening displacement x t this relation is obtained according to a computational fluid mechanics simulation which will be given hereinafter according to the calculation formula of the frictional force of the seal ring under sliding seal conditions 11 f 1 0 2 ε π 2 d o r 1 e e d 1 1 μ 2 ε π d 1 d o r 1 p x 12 f 2 0 2 ε π 2 d o r 2 e e d 2 1 μ 2 ε π d 2 d o r 2 p x where e μ and e are the precompression ratio poisson s ratio and elastic modulus of the seal ring with values of 15 0 49 and 6 1 n mm 2 respectively ε is the friction coefficient between the seal ring and the cover which is 0 04 and d o r 1 and d o r 2 are the diameters of the seal rings at corresponding positions which are both 5 mm according to hooke s law the relation between the spring force and valve opening displacement is 13 f s p r i n g k x t where k is the stiffness coefficient of the spring note that 50crva steel is selected as the spring material which has an elastic modulus of 7900 n mm 2 tang et al 2017 in a specific design space the median diameter wire diameter and number of coils of the spring are 54 mm 5 5 mm and 16 respectively and the spring constant k 3 59 n mm force analysis of the valve during the closing process follows newton s second law 14 m x t f s p r i n g f 1 f 2 f 3 f s e a l f c o p f e x p to simplify the calculation process the frictional force f s e a l between the valve stem and the cover is set as a constant the frictional force f 3 between the floating piston and the compensation piston is considered negligible and m is the total mass of gate valve stem and compensation piston substituting formulas 5 6 and 10 13 into formula 14 yields 15 m x k x 0 2 ε π 2 d o r 1 e e d 1 0 2 ε π 2 d o r 2 e e d 2 1 μ 2 p i n t l e t 32 x t l o r i f i c e d f p 2 x t d o r i f i c e 4 ε π d 1 d o r 1 ε π d 2 d o r 2 p 0 v 2 v 2 d n a 2 a 2 x t π d 2 2 4 p 0 v 1 v 1 d n a 1 a 1 x t π d 1 2 4 f s e a l to clearly indicate the dynamic design parameters of the optimization analysis formula 15 is rewritten into a form of function mapping which is expressed as 16 m x f d 1 d 2 l o r i f i c e d o r i f i c e d f p 3 dynamic characteristic analysis and performance optimization there are three types of gates applied to subsea christmas tree valves parallel straight panels hollow gates and wedge shaped gates according to prior research wedge shaped gates have better mechanical and hydrodynamic properties than the other gate types liu et al 2019 this paper studies a 5 wedge shaped gate as shown in fig 4 α 5 valve opening displacement x t and inlet pressure p i n t l e t data were obtained based on the computational mechanics method in ansys in this simulation analysis inconel 718 is selected as the solid material and the fluid material is crude oil with a density of 810 kg m3 and a kinematic viscosity of 10 cp turbulence computing models are used at the velocity inlet and pressure outlet this part is not the emphasis of the study in this paper so it will not be described in detail the curves are fitted using a third order function as shown in fig 6 the drift diameter of the gate in this paper is 32 mm so the maximum value of x t is x t max 32 mm the valve actuator is restricted within a specific small volume with a constant length and diameter the objective is to optimize the design of individual components to achieve the minimum response time when the actuator is closed cai et al 2013 the five optimized characteristic parameters were d 1 d 2 l o r i f i c e d o r i f i c e and d f p the geometric optimization of the valve actuator was performed with matlab simulink software wu et al 2019 the simulink model which is shown in fig 7 consists of three main parts the input parameters subsystem the force subsystem and the dynamic characteristics subsystem these three subsystems are expanded as shown in figs 8 10 the input parameters subsystem acquires five dynamic parameters as the initial quantity input system the force subsystem calculates f 1 f 2 f s e a l f c o p f e x p and f s p r i n g according to formulas 5 6 10 11 12 and 13 respectively the dynamic characteristics subsystem calculates the displacement x velocity v and acceleration a of the combined mass m according to formula 14 a prototype of the valve actuator was developed based on design indicators combined with the basic knowledge of mechanical design mechanical analysis and strength verification the basic dimensions of the prototype were obtained as the initial conditions for the valve actuator the initial state is a complete valve open state and the initial conditions are p i n t l e t 1 0 mpa x t max 32 mm m 0 32 kg d 1 70 mm d 2 65 mm l o r i f i c e 185 mm d o r i f i c e 5 mm and d f p 35 mm the relation curves of displacement velocity and acceleration with respect to time are finally obtained as shown in fig 11 when the valve is under the initial conditions fig 11 shows that the fail close time is 4 37 s and the acceleration of the gate to reach the travel end is basically 0 so it belongs to a uniform motion state when the valve is closed the velocity decreases from 3 5 mm s to zero creating a shock with a certain speed an experimental method must be used to determine whether the axial and radial vibrational accelerations of the valve and actuator are within the stipulated range otherwise performance failure may be caused within the first 2 5 s t 1 the spring force plays a dominant role the acceleration of m is always greater than 0 and remains consistent with the velocity direction and this process occurs in an accelerated motion state wherein the acceleration gradually declines after 2 5 s t 2 p x increases due to the increasing fluid velocity at orifice and the increasing inlet pressure when the valve is closed finally the frictional force between the compensation piston and the cover increases at that time the resistance of m plays a leading role and the direction of acceleration becomes opposite to the direction of velocity therefore the velocity of m is reduced the sizes of d 1 and d 2 are changed to acquire relation curves of the two with respect to the valve fail close time and the terminal speed as shown in fig 12 according to fig 12 a and b when d 1 or d 2 increases the valve close time increases increasing the sizes of d 1 and d 2 will increase the large cylindrical surfaces and small cylindrical surfaces of the pressure compensation pistons and subsequently increase the frictional area between the seal ring and the cover as a result the motion resistance of m is elevated which obviously reduces the acceleration of m and increases the valve close time however as d 1 and d 2 increase the terminal speed of the gate which indicates the instantaneous speed before the valve is closed exhibits a declining trend as shown in fig 12 b the lower the terminal speed is the smaller the speed of the shock from the gate on the valve body pressure compensation principles require that a 3 a 1 a 2 if a 3 is too small d s t e m is too small which influences the structural strength of the valve stem thus the size of a 3 is tightly restricted for the above reasons and in full consideration of the requirements for the shock speed at the gate travel end and the structural strength the sizes of d 1 and d 2 are set to 70 mm and 63 mm respectively when the sizes of d 1 and d 2 are set to 70 mm and 63 mm respectively and d f p 35 mm l o r i f i c e and d o r i f i c e are changed to acquire change curves of the valve fail close time and terminal speed as shown in fig 13 according to fig 13 a the valve close time first decreases and then abruptly increases as l o r i f i c e increases when l o r i f i c e 185 mm the valve close time reaches minimum value however there is no significant correlation between the change in d o r i f i c e and the valve close time fig 13 b shows that no matter how the l o r i f i c e and d o r i f i c e values change the shock speed at the gate travel end changes slightly this terminal speed is between 4 2 mm s and 4 9 mm s without obvious laws based on the above results the values of l o r i f i c e and d o r i f i c e are 185 mm and 4 5 mm respectively furthermore the d o r i f i c e value is set to 4 5 mm to acquire the relation curves of l o r i f i c e and d f p with respect to the valve fail close time and terminal speed as shown in fig 14 as d f p increases the valve close time first increases and then suddenly decreases whereas the terminal speed first decreases and then increases when d f p 34 mm the valve close time is the longest approaching 4 7 s note that d f p cannot continuously increase due to size restrictions increasing d f p will decrease the wall thickness of the pressure compensation piston moreover fig 14 b shows that when d f p 35 mm the valve terminal speed is the lowest when d f p 36 mm the valve terminal speed increases sharply based on the above considerations the d f p value is set to 36 mm through the final analysis the optimized dynamic characteristic parameters of the pressure compensation valve and actuator are determined as follows d 1 70 mm d 2 63 mm l o r i f i c e 185 mm d o r i f i c e 4 5 mm and d f p 36 mm 4 experiments and discussion the valve and actuator were manufactured according to the optimization results as shown in fig 15 a schematic diagram of the experimental system is shown in fig 16 and a dynamic experiment of the system was also performed as shown in fig 17 the hydraulic station model hs 10 rated flow rate of 12 m3 h and rated power of 0 75 kw provided a constant speed high pressure fluid for the system the valve was connected in series in the oil circuit the pressure compensation actuator controlled the switch of the valve and the control signal was provided by the control system pressure transducers pt1 and pt2 model pcm300 range of 0 4 mpa precision of 0 5 full scale fs were installed at the inlet and outlet of the valve and the pressure values of the two points were collected to acquire accurate vibration acceleration signals of the actuator during the valve closing process two acceleration transducers vt1 and vt2 model lc0152 range of 100g were fixed on the bottom cover and the cylinder cover of the actuator respectively the data from the two pressure transducers and the two acceleration transducers were acquired and transmitted to the pc through an ni usb 231 data acquisition module eight single ended or four differential 16 bit analog inputs and 50 ks s maximum sampling rate and an ni 9234 data acquisition module four differential 24 bit analog inputs and 51 2 ks s maximum sampling rate the vibration experiments of the valve with actuator fail close were performed to investigate the performance of the actuators optimized under different internal pressure conditions the experiments were divided into four groups corresponding to the different inlet pressure values the four inlet pressures were set to 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa by adjusting the output of the hydraulic station which could be monitored in real time via pt1 in particular when the inlet pressure was 0 mpa a no load experiment was performed in the no load experiment there was no high pressure oil input into the valve body and there was no high pressure fluid resistance when the valve was closed these experimental results were used as a reference group to explore the effect of pressure compensation in the vibration experiment the valve was completely opened by the control system and then the power supply of the control system was suddenly cut off to simulate the failure of the actuator the valve was automatically closed by the internal fail close system of the actuator and the vibration data for this process were acquired with vt1 and vt2 when the inlet pressure was 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa the vertical and horizontal vibration accelerations were obtained when the fail close occurred these results are shown in figs 18 21 the figures show that at the moment of starting and closing of the valve there was a large vibration in both the horizontal and vertical directions after the intervention of the middle pressure compensation system the vibration was greatly reduced and the middle time was recorded as t c o m p e n s a t i o n when the inlet pressures were 0 mpa 1 0 mpa 1 5 mpa and 2 0 mpa the valve close time was t c l o s e 2 48 s t c l o s e 4 75 s t c l o s e 5 26 s and t c l o s e 6 57 s respectively indicating that the valve close time increased as the inlet pressure increased the friction between the pressure compensation piston and the cover increased as the internal fluid pressure increased therefore the average acceleration of m was reduced further increasing the closing time more importantly t c l o s e 4 75 s was in agreement with the simulation results as shown in fig 11 and the fail close time conformed to the design requirements i e the fail close time must be less than 8 s fig 18 shows that in the no load experiment the absolute value of the acceleration was greater than the acceleration values in figs 19 21 regardless that the acceleration was vertical or horizontal these results show that the design of the pressure compensation system contributes to reducing the vibration of the actuator a comparison of figs 19 a 20 a and 21 a shows that when the valve was started the absolute values of the vertical vibration acceleration peak values at the three inlet pressures were 0 12 10 3 m s 0 10 10 3 m s and 0 09 10 3 m s respectively similarly when the valve was closed the absolute values of the vertical vibration acceleration peaks at the three inlet pressures were 0 52 10 3 m s 0 34 10 3 m s and 0 29 10 3 m s respectively at the moment of valve starting and closing the absolute value of the vertical vibration acceleration peak value decreased with increasing inlet pressure indicating that the increase in the internal fluid contributed to the reduction in the system vibration and that the vibration value was within a reasonable range i e the vibration acceleration was less than 1 10 3 m s which shows good agreement with the optimization results a comparison of figs 19 b 20 b and 21 b shows that when the valve was started the absolute values of the horizontal vibration acceleration peak values at the three inlet pressures were 0 27 10 3 m s 0 11 10 3 m s and 0 08 10 3 m s respectively when the valve was closed the absolute values of the vertical vibration acceleration peaks at the three inlet pressures were 0 17 10 3 m s 0 52 10 3 m s and 0 38 10 3 m s respectively there was no obvious change in the variation in the horizontal vibration acceleration and inlet pressure but the vibration values were within a reasonable range these results show that the optimal design performance index of the valve with actuator met the design requirements 5 conclusions a new pressure compensation all electric control valve and actuator was developed in this paper the pressure compensation system which mainly includes cover transmission mechanism valve steam floating piston spring and compensation piston was proposed and used for the actuator the high pressure hydraulic resistance is overcome by using the pressure compensation system when the valve was closed this paper proposed a pressure compensated valve actuator that significantly reduced high pressure hydraulic resistance during valve closure through a pressure compensation system furthermore an optimization method was proposed based on the dynamic parameters of the actuator the objective was to optimize the designs of the individual components to achieve the minimum vibration value within the allowable fail close time range first a parametric model of the valve and actuator was established and theoretically analyzed then five dynamic parameters were optimized with matlab simulink while holding the other dimensions constant finally vibration experiments were carried out to verify that the optimized design of the pressure compensated valve actuator had a fail close time of 4 75 s and the absolute values of the vertical and horizontal vibration acceleration peaks were 0 29 10 3 m s and 0 38 10 3 m s respectively which were within the design range indicating that the system exhibited good performance declaration of competing interestcoi we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled performance analysis and optimal design based on dynamic characteristics for pressure compensated subsea all electric valve actuator acknowledgement the authors wish to acknowledge the financial support of national natural science foundation of china no 51779267 open fund of key pre research foundation of military equipment of china no 6140923030702 doctoral innovation engineering project no ycx2019056 
22428,an optimal truncated least square support vector machine ls svm is proposed for the parameter estimation of a nonlinear manoeuvring model in shallow water a nonlinear manoeuvring model in shallow water is briefly introduced and the hydrodynamic coefficients are normalized a series of planar motion mechanism tests of the dtc ship model carried out in a towing tank with shallow water are used in the study for the estimation of the parameters of the manoeuvring model the contribution of this paper is to propose the use of the optimal truncated ls svm which is a robust method for parameter estimation that diminishes the uncertainty successfully and has a low computational cost by reducing the dimensionality of the kernel matrix the classical least square method is also employed to estimate the parameters and the results are compared with the optimal truncated ls svm the parameter uncertainty is discussed and the performance of the obtained nonlinear manoeuvring models is tested against a validation set that was left completely untouched during the training the r 2 goodness of fit criterion is used to demonstrate the accuracy of the obtained models keywords optimal truncated ls svm parameter estimation dimensionality reduction parameter uncertainty nonlinear manoeuvring model nomenclature b bias term h water depth m m mass of the ship kg u v r velocities of surge sway and yaw rate m s rad s u v r acceleration of the surge sway and yaw motions m s2 rad s2 x g gravity centre of the ship in x direction m y measured data a kernel matrix c regularization factor i z z yaw moment of inertia with z axis kg m2 k x x kernel function n 0 n u v n u r nondimensionalized hydrodynamic coefficients of yaw motion r 2 the goodness of fit criterion s training set t draft of the ship m l pp length between perpendiculars m u speed over ground m s u left singular matrix v right singular matrix u r truncated left singular matrix v r truncated right singular matrix v y diagonal matrix of variances of y v θ ˆ error propagation matrix x matrix containing measured data x y n dimensioned external surge and sway force yaw moment n n m x 0 x u u x u u u nondimensionalized hydrodynamic coefficients of surge motion y output matrix y 0 y u v y u r nondimensionalized hydrodynamic coefficients of sway motion y ˆ x θ ˆ estimation values β drift angle rad θ hydrodynamic coefficients matrix θ ˆ estimated hydrodynamic coefficients matrix w weight matrix ρ density of water kg m3 ℒ w b e i α i lagrange function μ 11 μ 22 μ 66 added mass and moment of inertia kg kg m2 μ 26 cross inertial due to sway and yaw motion kg m2 i 1 n e i 2 empirical error σ singular values matrix σ r truncated singular values matrix φ x mapping function χ 2 θ chi squared errors 1 introduction a marine vessel spends most part of its lifetime navigating in deep waters however the manoeuvrability in shallow water tello ruiz et al 2015 is critically important as ships normally have to access harbours in shallow and confined waters lataire et al 2012 maimun et al 2011 vantorre et al 2017 yoshimura 1986 zhou et al 2012 2016a the development of numerical models makes it possible to simulate the ship trajectory in deep water sutulo et al 2002 rong et al 2019 or ship response travelling in a confined waterway du et al 2017 and shallow water kaidi et al 2018 the models can also be incorporated in vessel simulators varela and guedes soares 2015a b which can be used to train ship pilots mathematical models are widely used to describe the dynamics of ships in deep and shallow water maimun et al 2011 many mathematical models have been proposed to meet different applications considering the trade off between the complexity and fidelity such as the nomoto model nomoto et al 1956 abkowitz model abkowitz 1980 mmg model yoshimura 2005 vectorial model fossen 2011 and a generic nonlinear manoeuvring model sutulo and guedes soares 2015 a more comprehensive review of the ship manoeuvring models can be found in sutulo and guedes soares 2011 the effect of shallow water for manoeuvring was also discussed by vantorre et al 2017 norrbin 1971 discussed consequences of finite water depth for mathematical manoeuvring the wing theory was used to calculate the derivative of ship manoeuvring in shallow water inoue and murayama 1969 an evaluation of semi empirical formulae for manoeuvring in shallow water was discussed by vantorre 2001 eloot et al 2015 reported on efforts of validation of shallow water manoeuvring simulation through free running tests benchmark data for manoeuvring in shallow water of dtc ship model have been addressed by van zwijnsvoorde et al 2019 for the study on manoeuvring in the confined waterways computational fluid dynamics cfd is a very useful tool it has also been used to study the ship manoeuvring in shallow water jin et al 2016 wang et al 2009 bank effect xu et al 2017 ship ship interaction zhou et al 2016a b numerical pmm test islam and guedes soares 2018 just to name a few as described in the report by the manoeuvring committee of 24th international towing tank conference ittc 2005 the hydrodynamic coefficients can be obtained using captive model test cfd calculation and system identification system identification is one of the mature techniques for building mathematical models from measured data as described by sutulo and guedes soares 2006 captive model test is a reliable and effective method to measure the hydrodynamic forces and moments from which the hydrodynamic coefficients in a manoeuvring model can be identified least square ls method is one of the most widely used identification technology because it can provide the theoretical solution if the data is ideal and rich enough to activate the dynamic of the system golding et al 2006 used the least square method to estimate the nonlinear viscous damping matrix of a marine surface vessel ross et al 2015 estimated the hydrodynamic coefficients of a nonlinear manoeuvring model based on planar motion mechanism pmm tests using the nonlinear least square method the obtained manoeuvring model was then validated in full scale hassani et al 2015 sutulo and guedes soares 2014 developed an optimal offline system identification method combined the least square with genetic algorithm for the parameter estimation of a nonlinear manoeuvring mathematical model a similar study can also be found in xu et al 2018b where a loss function considering both the bias and variance of the errors between the reference outputs and the mathematical model outputs was proposed for the estimation of the hydrodynamic coefficients based on free running manoeuvring tests perera et al 2015 2016 applied the extended kalman filter to estimate the dynamic parameters of a modified nomoto model for vessel steering an online least square support vector machine was applied to modelling the nonlinear ship steering motion in real time in xu et al 2019b however the drawbacks such as sensitivity to outliers overfitting and non consistent estimations golub and reinsch 1970 limit the application of the least square method in order to have a robust estimation truncated singular value decomposition tsvd chan and hansen 1990 has solved the ill conditioned problem of the least square method hansen 1998 tsvd can diminish the parameter uncertainty by neglecting the smaller singular values bell et al 1978 the matrix corresponding to smaller singular values usually imposes more uncertainty in the process of parameter estimation söderström 2013 used a regularized least square method to estimate the parameters using large datasets tikhonov regularization golub et al 1999 was also used for solving the ill posed problems it can significantly improve the condition number by modifying the normal equations in the least square method while leaving the estimated parameter relatively unchanged the effect of tikhonov regularization is to estimate the parameters while also keeping them near the reference values hansen and o leary 1993 ma et al 2017 recently a kernel based machine learning method support vector machine svm proposed by vapnik 1995 have been used for regression suykens et al 2002 vapnik 1998 it can also be considered a special case of tikhonov regularization golub et al 1999 as it solves the optimization problem by searching the maximum margin hyperplane which separates the data points least square support vector machine ls svm is a modified version of svm proposed by suykens and vandewalle 1999 by including the regularized square error term in the svm the solutions can be obtained by solving a set of linear equations instead of a convex quadratic programming qp problem for classical svms but the drawback is that the ls svm loses the sparseness feature chen and zhou 2018 svm has been used to identify the hydrodynamic coefficients for marine vessels in luo and zou 2009 a least square support vector machine lssvm was used to estimate the hydrodynamic coefficients of an abkowitz model further work on this topic can be found in luo et al 2016 in which particle swarm optimization was employed to choose the regularization factor xu and guedes soares 2016 used a least square support vector machine ls svm to identify a nonlinear steering model for ship autopilot design and further studies can be found in xu and guedes soares 2018 hydrodynamic parameters of a catamaran were estimated using svm by luo et al 2014 the revised version of support vector regression was also employed to describe the motion of floating structures such as ε support vector regression hou and zou 2016 nu support vector machine wang et al 2019 among thers zhu et al 2017 used an optimal ls svm combined with artificial bee colony algorithm to estimate a dynamic model of a large container ship parameter uncertainty is always an interesting topic for system identification the identified parameter with a large uncertainty is sensitive to the noise and the corresponding model usually has a poor generalization performance for ship manoeuvring modelling this phenomenon called parameter drift is discussed in hwang 1980 luo et al 2016 luo and li 2017 where the parameter drifts from the true values when estimating the hydrodynamic coefficients so that the obtained manoeuvring model fails to predict the manoeuvrability of the ship hwang 1980 found the dynamic cancellation and the linear hydrodynamic coefficients drift simultaneously using slender body theory several methods were proposed to reduce the parameter drift such as model simplification parallel processing and additional excitation luo and li 2017 it needs to be pointed out that the main purpose of these methods is to reconstruct the samples and reduce the multicollinearity as the multicollinearity was considered the main reason for the parameter drift luo and li 2017 multicollinearity is commonplace in regression analysis and it is mostly due to the redundancy of the structure of the model sutulo and guedes soares 2011 it is also called the ill posed problem bell et al 1978 hansen 1998 xu et al 2018a 2019a used the singular value decomposition to give an explanation of the parameter uncertainty the least square methods combined with truncated singular value decomposition was used to reduce the parameter uncertainty and provide good results the main contribution of this paper is to propose an optimal truncated least square support vector machine ls svm and then use it to estimate the nondimensionalized coefficients of nonlinear manoeuvring models based on captive model tests a series of pmm tests such as pure drift pure sway pure yaw and mixed yaw and drift were carried out by flanders hydraulics research frh in their towing tank using the dtc ship model moctar et al 2012 and they are used here the optimal truncated ls svm is implemented by calculating the singular value decomposition svd of the kernel matrix and neglecting the small singular values as well as the corresponded matrix due to their negligible contribution to the solutions the dimensionality reduction of the kernel matrix is achieved which reduce the computation cost it is different from the method in wei et al 2006 zheng et al 2014 where singular value decomposition svd was employed for signal pre processing and the filtered data was then used for training the classical ls svm the optimal constant is estimated using l curve which plays the trade off between the size of a regularized solution and its fit to the given data in order to verify the results of the optimal truncated ls svm classical least square method was also employed to estimate the parameters the parameter uncertainty is discussed and the generalization performance of the resulted numerical models are further tested against the validation set the structure of this article is as follow section 2 describes a generic nonlinear manoeuvring model for the marine surface vessel in the shallow water in section 3 planar motion mechanism pmm test in shallow water carried out using dtc ship model are discussed the classical least square method and optimal truncated ls svm are proposed in section 4 in section 5 the nondimensionalized hydrodynamic coefficients for nonlinear manoeuvring model are estimated using the classical least square method and optimal truncated ls svm the parameter uncertainty analysis and validation are also carried out in this section the final section is the conclusion 2 generic nonlinear manoeuvring model for marine surface vessel usually the motions of a marine surface vessel can be described in six degrees of freedoms dofs as illustrated in fig 1 they are the surge sway heave roll pitch and yaw for ship manoeuvring the motions in 3 dofs surge sway and yaw are considered because they typically occur with a much lower frequency than the wave encounter frequencies sutulo and guedes soares 2011 so it is reasonable to neglect the fluid memory effects fossen 2011 assuming a ship moving in a horizontal plane as presented in fig 2 two different coordinate systems north east down ned and body fixed frame are defined the ned frame describes the horizontal coordinate plane and consists of three coordinates one represents the position along the northern axis one along the local eastern axis and one represents the vertical position the body frame is a moving coordinate frame that is fixed to the craft the manoeuvring mathematical model is usually defined in the body fixed frame here it was assumed that the shallow water will affect the manoeuvrability of a ship by changing the manoeuvring coefficients so a generic nonlinear manoeuvring model for the marine surface vessel is given first without loss of generality any marine ships can be treated as a free rigid body moving under the action of the external forces and moments the euler equations of arbitrary motion in the horizontal plane are given 1 m μ 11 u m v r m x g r 2 x m μ 22 v m x g μ 26 r m u r y m x g μ 26 v i z z μ 66 r m x g u r n where m and i z z are the mass and the moment of inertia respectively x g is the position of centre of mass in x direction μ 11 μ 22 and μ 26 are the added masses and moments respectively x y and n are the hydrodynamic forces and moment of the ship hull here the quasi polynomials are employed to approximate the hydrodynamic forces and moments because the quasi polynomials can be slightly more economical from the viewpoint of the number of terms and computation speed even if the corresponding response surface is not smooth everywhere sutulo and guedes soares 2011 the mathematical model for surge sway and yaw motion are given 2 x v r x 0 x v v v v x v r v r x r r r r 3 y v r y 0 y v v y r r y v v v v y v r v r 4 n v r n 0 n v v n r r n r v r v n v r v r n r r r r in order to compare the coefficients of different ships and to estimate the dynamics of a full size ship the hydrodynamic parameters need to be converted to dimensionless ones the prime system recommended by sname 1950 will be used to normalize the hydrodynamic coefficients the water density ρ the ship length l and the ship speed u are employed as the characteristic dimensional parameter the forces are normalized with 0 5 ρ u 2 l t and the moment with 0 5 ρ u 2 l 2 t where t is the draft at the midship the nondimensionalized velocities and yaw rate are u u u v v u r r l u the list of the nondimensionalization factors and corresponding coefficients in eqs 2 4 is shown in table 1 3 planar motion mechanism pmm tests in shallow water this section will give an overview of the planar motion mechanism pmm tests that have been performed by flanders hydraulics research fhr delefortrie and vantorre 2007 in the framework of the shopera project papanikolaou et al 2016 test the duisburg test case dtc is a scaled ship model of a modern container carrier that is used for benchmarking and validation of numerical methods eloot et al 2016 moctar et al 2012 in total 102 pmm tests pure drift pure sway and pure yaw have been performed with different water depths velocities amplitudes and sample period in table 2 the ranges of the main kinematic parameters such as forward speed drift angle rate of turn etc are given the main particulars are given in table 3 captive model tests are nowadays commonly used for modelling the ship motions delefortrie et al 2016a b sutulo and guedes soares 2004 vantorre and eloot 1998 they can provide a rich information for system identification method and get a reasonable estimation of the hydrodynamic coefficients however perform such tests is costly here a brief summary of different pmm tests is presented fig 3 such as pure drift pure sway pure yaw and mixed sway and yaw which were performed at flanders hydraulics research fhr the towing tank at fhr has a total length of 87 5 m a width of 7 m and a maximum water depth of 0 5 m eloot et al 2016 more detailed information can be found in van kerkhove et al 2009 and delefortrie et al 2016 the ship and tank fixed coordinate system is presented in fig 4 in the pure drift test the ship mode was towing forward at a constant speed with a fixed drift angle β as presented in fig 5 a so the surge and sway velocity are a non zero constant while the yaw rate is zero u u cos β v u sin β r 0 with the results of pure drift the hydrodynamic coefficients related to the yaw motion can be neglected during the parameter estimation process pure sway test can provide a rich information for the dynamic of the sway motion meanwhile it can be used to isolate the sway dynamics from the yaw motion during the test the ship will move forward with a constant velocity and with a sinusoidal oscillation in sway where u u c v v max cos ω t and ψ 0 as presented in fig 5b the hydrodynamic coefficients related to the yaw motion can be neglected during the identification process because the yaw rate is zero pure yaw test is used to get a full response of sway motion during the test the ship moves forward with a constant velocity and with a sinusoidal oscillation in sway motion where u u c v 0 and ψ ψ max sin ω t as presented in fig 5c a combined test pure yaw and drift was carried out using a ship model with a sinusoidal oscillation in sway motion as well as a sinusoidal oscillation of yaw motion around a constant drift angle the pathline is presented in fig 5d this test can provide the dynamics information of surge sway and yaw motion so it can be used to estimate the coupled coefficients which corresponded to the surge sway and yaw motion during the test the ground speed and drift angle are kept as constant and yaw rate is set as a sinusoidal oscillation u u c β β c and ψ ψ max sin ω t 4 parameter estimation methods and parameter uncertainty analysis in this section two parameter estimation methods classical least square ls and least square support vector machine ls svm are introduced briefly then a robust version truncated ls svm is proposed by including singular value decomposition technology the truncated ls svm trains the model by calculating the singular values decomposition of the kernel matrix and neglect the smaller singular values and corresponding columns of the left singular matrix u and right singular matrix v it can reduce the computation cost due to the dimensionality reduction of the kernel matrix meanwhile providing a robust estimation 4 1 classical least square method in order to estimate the nondimensionalized hydrodynamic coefficients the above equations 2 4 need to be reordered in a vector format given by 5 x θ y where the matrix x contains the measured data θ is the parameter matrix described in equation 6 and y is the matrix of the hydrodynamic forces and moments obviously this parameter estimation problem is over determined because the length of the training data n is bigger than the number of the parameters n m the vectors of parameters are given 6 θ s u r g e u 11 x 0 x v v x v r x r r θ s w a y μ 22 μ 26 y 0 y v y r y v v y v r θ y a w μ 26 μ 66 n 0 n v n r y r v n v r n r r here several assumptions need to be made the first assumption is that the sample of measurements y i are uncorrelated it is reasonable because each measurement is independent each measurement y i has a particular variance σ y 2 due to the environmental disturbance and sensors obviously from eq 5 the estimation problem is to find the optimal parameter matrix θ which can approach the measured data y or in other words minimise the difference between the estimated values y ˆ x a and the measured data y the error needs to be dominated by the high accuracy data small variance and less affected by the low accuracy data large variance so the weighted sum of the squared residuals also called chi squared is defined in terms of the vectors 7 χ 2 θ x θ y t v y 1 x θ y where v y is the diagonal matrix of variances of y usually it can be assumed to be the identity matrix if the variances of y is unknown in advance the optimal parameters θ corresponds to the minimum value of the χ 2 error function which means the derivative of χ 2 respect to the θ equals to zero 8 χ 2 θ θ θ ˆ 0 x t v y 1 x θ ˆ x t v y 1 y 0 then the optimal values of the parameters can be obtained as 9 θ ˆ x t v y 1 x 1 x t v y 1 y the χ 2 error function can be minimized with respect to the parameters θ the estimated values which have the best agreement with the measured data can be computed using y ˆ x i θ ˆ x θ ˆ 4 2 optimal truncated ls svm and uncertainty analysis given the training set which contains n pairs of data s s i s i x i y i x i ℜ n y i ℜ i 1 n where x i is the input and y i is the output as presented in suykens et al 2002 the general approximation function of svm is given 10 y x w t φ x b where x is the training samples y x are the target values b is the bias term w is a weight matrix φ x is mapping function that maps the training data x i to a higher dimensional feature space suykens et al 2002 for function estimation or regression purpose the following optimization problem is formulated 11 min w b e i j w e 1 2 w t w 1 2 c i 1 n e i 2 subject to the equality constraints 12 y i w t φ x i b e i i 1 n where e i i 1 n is the error and c is the regularization factor it balances the well known structural risk which is the trade off between the model accuracy and the model complexity suykens et al 2002 the lagrange function is introduced to solve the optimization problem given as 13 ℒ w b e i α i 1 2 w t w 1 2 c i 1 n e i 2 i 1 n α i w t φ x i b e i y i where α i are the lagrange multipliers according to the karush kuhn tucker conditions kkt suykens et al 2002 the derivatives of the lagrange function are given by 14 ℒ w 0 w i 1 n α i φ x i ℒ b 0 i 1 n α i 0 ℒ e i 0 α i c e i i 1 n ℒ α i 0 w t φ x i b e i y i 0 i 1 n eliminating the variable w and e i one gets the following solution 15 0 1 1 k c 1 i a b α θ 0 y y where i is an n n identity matrix α α 1 α n t y y 1 y n t k x k x i ϕ x k t ϕ x i i 1 n is the kernel function which represents an inner product between its operands it is positive definite and satisfies the mercer condition suykens and vandewalle 1999 vapnik 1995 here the linear kernel function is chosen for parameter estimation so the resulted ls svm model for the regression is given 16 y x i 1 n α i k x x i b as presented in eq 15 the dimension of the kernel matrix a is n 1 n 1 it is proportional to the length of the training set so if there is large data in the training set the classical ls svm fails to inverse the matrix due to the heavy computation meanwhile the obtained parameter matrix is usually dominated by the noise and drift from the true values the obtained parameters do not comply with common sense the corresponded numerical model fits well with the training data and fails to reproduce the training set this also is well known as overfitting in the following phase an optimal truncated ls svm is proposed to solve the parameter estimation for a large scale problem parameter uncertainty or parameter drift of the hydrodynamic coefficients was found in hwang 1980 luo and li 2017 luo and zou 2009 the obtained parameters are usually dominated by the noise and have large uncertainty in hwang 1980 luo and li 2017 multicollinearity happens during the parameter estimation and several methods such as additional excitation parallel processing exaggerated over and underestimation mong others were used to diminish the parameter uncertainty the main purpose of these methods is to reconstruct the sample and reduce the multicollinearity of variables in this phase parameter uncertainty is discussed using singular value decomposition then a truncated least square support vector machine is proposed to diminish the parameter drift firstly using the singular value decomposition the kernel matrix a can be rewritten as 17 a i 1 n u i σ i v i t u σ v t then the eq 15 can be rewritten as 18 θ u σ v t 1 y v σ 1 u t y i 1 n v i u i t σ i y where the matrix u and v are orthonormal u t u i and v t v i ʃ is the diagonal matrix of the singular values of the matrix x assume that there is an additive perturbation δ y then it will propagate to a perturbation in the solution 19 δ θ v σ 1 u t δ y i 1 n v i u i t σ i δ y as presented in eq 19 when the singular value σ i is very small or close to the numerical precision of the computation then the perturbation in the y is magnified and potentially dominates the solutions θ i the corresponding columns of u and v contribute negligibly to the matrix a their contribution to the solution can be easily dominated by the noise and round off error in y so the obtained parameters are dominated by the noise as discussed in the preceding section the number of the singular σ i equals to the length of the training data the obtained parameters are inevitably dominated by the smaller singular values and are easily affected by the noise in the data and drift from the true values with a large probability in order to diminish such uncertainty and obtain a robust estimation it is necessary to neglect the effect caused by the smaller singular values truncated singular value decomposition tsvd can be used to obtain a relatively accurate representation of the matrix a by retaining the first r singular values of a and the corresponding columns of u and v the tsvd can be presented as 20 a r u r σ r v r t where the matrix σ r is obtained by retaining the first r singular values of σ similarly matrices u r and v r are found using the corresponding singular vectors the resulting a r represents the reduced data set where the data related to the omitted singular values are filtered meanwhile as it can be observed the dimensionality of the kernel matrix is reduced by using truncated singular values decomposition the optimal value of r can be estimated using the l curve hansen and o leary 1993 it is a log log plot of the norm of a regularized solution versus the norm of the corresponding residual norm it is a graphical tool for displaying the trade off between the size of a regularized solution and its fit to the given data as the r varies golub et al 1999 hansen and johnston 2001 from the l curve plot it is convenient to get the optimal parameters the whole program is given in fig 6 the uncertainty of the obtained parameters is affected by noise and quantified by the error propagation matrix the error propagation matrix or covariance matrix can be used to indicate how the random errors in y as described by v y propagate to the optimal parameter θ ˆ the error propagation matrix is given by 21 v θ ˆ θ ˆ y v y θ ˆ y t where the standard error of the parameters σ θ ˆ can get by calculation of the square root of the diagonal of the error propagation matrix then the absolute error can be calculated easily 5 nondimensionalized hydrodynamic coefficients estimation and validation in this section the parameter estimation method discussed in the preceding section will be used to identify the nondimensionalized hydrodynamic coefficients for the nonlinear manoeuvring model firstly as presented in fig 6 the pmm model test data will be divided into the training set and validation set for the training the model and test the generalization performance of the obtained numerical model respectively in order to fully activate the ship dynamics a resampling method was used to build the training set x t r a n i n g x 1 n e n d where n is a constant in order to obtain the global optimal values the large scale training set is chosen considering the computing power of the laptop so n equals to 2 the length of the training set is 6000 it includes the pure drift harmonic sway harmonic yaw and mixed yaw and drift for the validation all measured data was used the test set includes the training set and the fresh data which is completely left untouched within the training process the kinematic parameters of the pmm test are given in table 2 the classical least square method and the optimal truncated least square support vector machine are both used to estimate the parameters using the training set the uncertainty of the obtained parameters is discussed then the obtained manoeuvring model will be used to reproduce the pmm tests which are compared with the validation set as presented in eq 5 the matrix x contains the measured data if the matrix x is ill conditioned or in the other word the condition number is very large then the obtained θ ˆ usually contains a large uncertainty the condition number indicates how sensitive a function is to changes or errors in the input and how much error in the output results from an error in the input the condition number for the eqs 2 4 is given in table 4 obviously the least square support vector machine method is influenced more by the ill conditioned matrix as discussed in the preceding section the dimension of the kernel matrix increases with the length of the training set or in the other words the number of the singular value equals to the length of the data so the kernel matrix is ill conditioned with a large probability 5 1 parameter estimation using classical least squares method in this phase the classical least squares method will be employed to estimate the nondimensionalized hydrodynamic coefficients of the nonlinear manoeuvring model the models for the surge sway and yaw are given in eqs 2 4 and the parameter matrix to be identified is given in eq 6 here the training set contains the half of the whole pmm test data 5873 pairs data the training set includes all the type of pmm tests such as pure drift pure sway pure yaw and mixed yaw and drift so it contains a rich information to excite the dynamic of manoeuvring in the shallow water filtering was carried out before identification to smooth the data the training process was carried out and the numerical prediction was compared with the experimental data as presented in fig 7 obviously the models were trained successfully using the data and have a good agreement with the experiment data the obtained nondimensionalized hydrodynamic coefficients of the surge sway and yaw model are presented in tables 5 7 respectively where it can be seen that most of the parameters are estimated correctly with a small deviation except the coefficient μ 26 actually its value is very small so it has a limited effect on the accuracy of the obtained numerical model the least square method is used to minimise the sum of the squares of the residuals so when the training data is large it can usually provide an optimal estimation 5 2 parameter estimation using optimal truncated ls svm in this part the optimal truncated ls svm is used to estimate the nondimensionalized hydrodynamic coefficients as defined in eqs 2 4 as discussed in the preceding section the dimensions of the kernel matrix are n 1 n 1 where n is the length of the training set in this paper the number of the singular equals to 5874 in fact most of them usually contribute negligibly to the solutions and increase the parameter uncertainty so it is necessary to neglect the smaller singular values this operation lies in two aspects one reason is to diminish the parameter uncertainty and get a robust estimation another benefit is that it can reduce the dimensionality of the kernel matrix without loss of the accuracy the most important part for truncated ls svm finds the optimal value of r that indicates how many singular values should be kept in this paper a graphical tool l curve hansen and o leary 1993 is used to obtain the optimal value it is a log log plot of the norm of a regularized solution versus the norm of the corresponding residual norm which displays the trade off between the size of a regularized solution and its fit to the given data as the r varies more detailed introduction can be found in golub et al 1999 hansen and johnston 2001 from the l curve plot it is convenient to get the optimal parameters as presented in table 8 only a small portion of singular values and corresponded matrix u r and v r are needed to approximate the kernel matrix so dimensionality reduction of the kernel matrix is achieved which reduces the computational cost see table 9 the training process was carried out using the proposed method optimal truncated ls svm fig 8 presented the results of the trained surge fig 8a sway fig 8b and yaw motion fig 8c the resulting ls svm numerical model has a good agreement with the data in the training set the obtained nondimensionalized hydrodynamic coefficients of the surge sway and yaw model are presented in tables 5 7 as can be observed most of the parameters have similar values with the ones obtained using theclassical least square method it also indicated the proposed method optimal truncated ls svm works well with the large scale data and provide a robust estimation the deviation of the obtained parameters is very small and the uncertainty is diminished successfully the obtained values are near the true values 5 3 validation of the obtained nonlinear manoeuvring models once the manoeuvring models are obtained the next most important thing is to validate whether the models are good enough to represent the dynamic of the manoeuvring the generalization of the performance of the obtained models is usually needed to be checked using the validation data the generalization performance or error is a measure of how accurately a model is able to predict outcome values for previously unseen data in this paper the validation set includes the whole pmm test data both the training set and the new data which was left completely untouched during the training process fig 9 presents the surge sway forces and yaw moment which are reproduced based on the obtained nonlinear manoeuvring model using the classical least square method according to the figure the nonlinear manoeuvring model can reproduce the forces and moments during the pmm test with a good accuracy the r 2 goodness of fit criterion is used to measure the fitness given in table 8 fig 10 shows the validation process of the nonlinear manoeuvring model which was identified using optimal truncated ls svm the forces of surge fig 10a and sway fig 10b and yaw moment fig 10c were compared with the experimental results during the pmm test and they are in good agreement the r 2 values of the surge sway and yaw model are given in table 8 where it can be seen that the optimal truncated ls svm is a good option to estimate the hydrodynamic coefficients of the nonlinear manoeuvring model the obtained model has a good generalization performance and can reproduce the pmm model test successfully 6 conclusions an optimal truncated least square support vector machine was proposed to estimate the nondimensionalized coefficients of nonlinear manoeuvring models in shallow water firstly a nonlinear manoeuvring model in 3 dofs surge sway and yaw was introduced and the hydrodynamic coefficients have been converted to the dimensionless ones using the prime system of sname 1950 pmm model tests such pure drift pure sway pure yaw were carried out in fhr s towing tank delefortrie et al 2016a b using the dtc ship model in shallow water during the eu project shopera papanikolaou et al 2016 optimal truncated ls svm was proposed to obtain a robust parameter estimation it reduces the dimensionality of the kernel matrix and avoids the costly matrix inversion operation by using the singular values decomposition the smaller singular values and corresponded matrix are neglected considering their contribution to the solutions is negligible the classical least square method was employed to estimate the parameters and the results were compared with the optimal truncated ls svm the parameter uncertainty was also discussed and the generalization performance of the obtained nonlinear manoeuvring models was further tested against the validation set which was completely left untouched during the training the results show that the optimal truncated ls svm is a robust method for parameter estimation the identified parameters are with a small uncertainty and can reproduce the pmm test successfully the r 2 goodness of fit criterion was used to demonstrate the accuracy of the obtained models acknowledgements this work was performed within the stratc research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the pmm data was collected in the experiments performed during the project shopera energy efficient safe ship operation papanikolaou et al 2016 which was partially funded by the eu under contract 605221 the first author is grateful to prof serge sutulo for valuable discussions on manoeuvring models 
22428,an optimal truncated least square support vector machine ls svm is proposed for the parameter estimation of a nonlinear manoeuvring model in shallow water a nonlinear manoeuvring model in shallow water is briefly introduced and the hydrodynamic coefficients are normalized a series of planar motion mechanism tests of the dtc ship model carried out in a towing tank with shallow water are used in the study for the estimation of the parameters of the manoeuvring model the contribution of this paper is to propose the use of the optimal truncated ls svm which is a robust method for parameter estimation that diminishes the uncertainty successfully and has a low computational cost by reducing the dimensionality of the kernel matrix the classical least square method is also employed to estimate the parameters and the results are compared with the optimal truncated ls svm the parameter uncertainty is discussed and the performance of the obtained nonlinear manoeuvring models is tested against a validation set that was left completely untouched during the training the r 2 goodness of fit criterion is used to demonstrate the accuracy of the obtained models keywords optimal truncated ls svm parameter estimation dimensionality reduction parameter uncertainty nonlinear manoeuvring model nomenclature b bias term h water depth m m mass of the ship kg u v r velocities of surge sway and yaw rate m s rad s u v r acceleration of the surge sway and yaw motions m s2 rad s2 x g gravity centre of the ship in x direction m y measured data a kernel matrix c regularization factor i z z yaw moment of inertia with z axis kg m2 k x x kernel function n 0 n u v n u r nondimensionalized hydrodynamic coefficients of yaw motion r 2 the goodness of fit criterion s training set t draft of the ship m l pp length between perpendiculars m u speed over ground m s u left singular matrix v right singular matrix u r truncated left singular matrix v r truncated right singular matrix v y diagonal matrix of variances of y v θ ˆ error propagation matrix x matrix containing measured data x y n dimensioned external surge and sway force yaw moment n n m x 0 x u u x u u u nondimensionalized hydrodynamic coefficients of surge motion y output matrix y 0 y u v y u r nondimensionalized hydrodynamic coefficients of sway motion y ˆ x θ ˆ estimation values β drift angle rad θ hydrodynamic coefficients matrix θ ˆ estimated hydrodynamic coefficients matrix w weight matrix ρ density of water kg m3 ℒ w b e i α i lagrange function μ 11 μ 22 μ 66 added mass and moment of inertia kg kg m2 μ 26 cross inertial due to sway and yaw motion kg m2 i 1 n e i 2 empirical error σ singular values matrix σ r truncated singular values matrix φ x mapping function χ 2 θ chi squared errors 1 introduction a marine vessel spends most part of its lifetime navigating in deep waters however the manoeuvrability in shallow water tello ruiz et al 2015 is critically important as ships normally have to access harbours in shallow and confined waters lataire et al 2012 maimun et al 2011 vantorre et al 2017 yoshimura 1986 zhou et al 2012 2016a the development of numerical models makes it possible to simulate the ship trajectory in deep water sutulo et al 2002 rong et al 2019 or ship response travelling in a confined waterway du et al 2017 and shallow water kaidi et al 2018 the models can also be incorporated in vessel simulators varela and guedes soares 2015a b which can be used to train ship pilots mathematical models are widely used to describe the dynamics of ships in deep and shallow water maimun et al 2011 many mathematical models have been proposed to meet different applications considering the trade off between the complexity and fidelity such as the nomoto model nomoto et al 1956 abkowitz model abkowitz 1980 mmg model yoshimura 2005 vectorial model fossen 2011 and a generic nonlinear manoeuvring model sutulo and guedes soares 2015 a more comprehensive review of the ship manoeuvring models can be found in sutulo and guedes soares 2011 the effect of shallow water for manoeuvring was also discussed by vantorre et al 2017 norrbin 1971 discussed consequences of finite water depth for mathematical manoeuvring the wing theory was used to calculate the derivative of ship manoeuvring in shallow water inoue and murayama 1969 an evaluation of semi empirical formulae for manoeuvring in shallow water was discussed by vantorre 2001 eloot et al 2015 reported on efforts of validation of shallow water manoeuvring simulation through free running tests benchmark data for manoeuvring in shallow water of dtc ship model have been addressed by van zwijnsvoorde et al 2019 for the study on manoeuvring in the confined waterways computational fluid dynamics cfd is a very useful tool it has also been used to study the ship manoeuvring in shallow water jin et al 2016 wang et al 2009 bank effect xu et al 2017 ship ship interaction zhou et al 2016a b numerical pmm test islam and guedes soares 2018 just to name a few as described in the report by the manoeuvring committee of 24th international towing tank conference ittc 2005 the hydrodynamic coefficients can be obtained using captive model test cfd calculation and system identification system identification is one of the mature techniques for building mathematical models from measured data as described by sutulo and guedes soares 2006 captive model test is a reliable and effective method to measure the hydrodynamic forces and moments from which the hydrodynamic coefficients in a manoeuvring model can be identified least square ls method is one of the most widely used identification technology because it can provide the theoretical solution if the data is ideal and rich enough to activate the dynamic of the system golding et al 2006 used the least square method to estimate the nonlinear viscous damping matrix of a marine surface vessel ross et al 2015 estimated the hydrodynamic coefficients of a nonlinear manoeuvring model based on planar motion mechanism pmm tests using the nonlinear least square method the obtained manoeuvring model was then validated in full scale hassani et al 2015 sutulo and guedes soares 2014 developed an optimal offline system identification method combined the least square with genetic algorithm for the parameter estimation of a nonlinear manoeuvring mathematical model a similar study can also be found in xu et al 2018b where a loss function considering both the bias and variance of the errors between the reference outputs and the mathematical model outputs was proposed for the estimation of the hydrodynamic coefficients based on free running manoeuvring tests perera et al 2015 2016 applied the extended kalman filter to estimate the dynamic parameters of a modified nomoto model for vessel steering an online least square support vector machine was applied to modelling the nonlinear ship steering motion in real time in xu et al 2019b however the drawbacks such as sensitivity to outliers overfitting and non consistent estimations golub and reinsch 1970 limit the application of the least square method in order to have a robust estimation truncated singular value decomposition tsvd chan and hansen 1990 has solved the ill conditioned problem of the least square method hansen 1998 tsvd can diminish the parameter uncertainty by neglecting the smaller singular values bell et al 1978 the matrix corresponding to smaller singular values usually imposes more uncertainty in the process of parameter estimation söderström 2013 used a regularized least square method to estimate the parameters using large datasets tikhonov regularization golub et al 1999 was also used for solving the ill posed problems it can significantly improve the condition number by modifying the normal equations in the least square method while leaving the estimated parameter relatively unchanged the effect of tikhonov regularization is to estimate the parameters while also keeping them near the reference values hansen and o leary 1993 ma et al 2017 recently a kernel based machine learning method support vector machine svm proposed by vapnik 1995 have been used for regression suykens et al 2002 vapnik 1998 it can also be considered a special case of tikhonov regularization golub et al 1999 as it solves the optimization problem by searching the maximum margin hyperplane which separates the data points least square support vector machine ls svm is a modified version of svm proposed by suykens and vandewalle 1999 by including the regularized square error term in the svm the solutions can be obtained by solving a set of linear equations instead of a convex quadratic programming qp problem for classical svms but the drawback is that the ls svm loses the sparseness feature chen and zhou 2018 svm has been used to identify the hydrodynamic coefficients for marine vessels in luo and zou 2009 a least square support vector machine lssvm was used to estimate the hydrodynamic coefficients of an abkowitz model further work on this topic can be found in luo et al 2016 in which particle swarm optimization was employed to choose the regularization factor xu and guedes soares 2016 used a least square support vector machine ls svm to identify a nonlinear steering model for ship autopilot design and further studies can be found in xu and guedes soares 2018 hydrodynamic parameters of a catamaran were estimated using svm by luo et al 2014 the revised version of support vector regression was also employed to describe the motion of floating structures such as ε support vector regression hou and zou 2016 nu support vector machine wang et al 2019 among thers zhu et al 2017 used an optimal ls svm combined with artificial bee colony algorithm to estimate a dynamic model of a large container ship parameter uncertainty is always an interesting topic for system identification the identified parameter with a large uncertainty is sensitive to the noise and the corresponding model usually has a poor generalization performance for ship manoeuvring modelling this phenomenon called parameter drift is discussed in hwang 1980 luo et al 2016 luo and li 2017 where the parameter drifts from the true values when estimating the hydrodynamic coefficients so that the obtained manoeuvring model fails to predict the manoeuvrability of the ship hwang 1980 found the dynamic cancellation and the linear hydrodynamic coefficients drift simultaneously using slender body theory several methods were proposed to reduce the parameter drift such as model simplification parallel processing and additional excitation luo and li 2017 it needs to be pointed out that the main purpose of these methods is to reconstruct the samples and reduce the multicollinearity as the multicollinearity was considered the main reason for the parameter drift luo and li 2017 multicollinearity is commonplace in regression analysis and it is mostly due to the redundancy of the structure of the model sutulo and guedes soares 2011 it is also called the ill posed problem bell et al 1978 hansen 1998 xu et al 2018a 2019a used the singular value decomposition to give an explanation of the parameter uncertainty the least square methods combined with truncated singular value decomposition was used to reduce the parameter uncertainty and provide good results the main contribution of this paper is to propose an optimal truncated least square support vector machine ls svm and then use it to estimate the nondimensionalized coefficients of nonlinear manoeuvring models based on captive model tests a series of pmm tests such as pure drift pure sway pure yaw and mixed yaw and drift were carried out by flanders hydraulics research frh in their towing tank using the dtc ship model moctar et al 2012 and they are used here the optimal truncated ls svm is implemented by calculating the singular value decomposition svd of the kernel matrix and neglecting the small singular values as well as the corresponded matrix due to their negligible contribution to the solutions the dimensionality reduction of the kernel matrix is achieved which reduce the computation cost it is different from the method in wei et al 2006 zheng et al 2014 where singular value decomposition svd was employed for signal pre processing and the filtered data was then used for training the classical ls svm the optimal constant is estimated using l curve which plays the trade off between the size of a regularized solution and its fit to the given data in order to verify the results of the optimal truncated ls svm classical least square method was also employed to estimate the parameters the parameter uncertainty is discussed and the generalization performance of the resulted numerical models are further tested against the validation set the structure of this article is as follow section 2 describes a generic nonlinear manoeuvring model for the marine surface vessel in the shallow water in section 3 planar motion mechanism pmm test in shallow water carried out using dtc ship model are discussed the classical least square method and optimal truncated ls svm are proposed in section 4 in section 5 the nondimensionalized hydrodynamic coefficients for nonlinear manoeuvring model are estimated using the classical least square method and optimal truncated ls svm the parameter uncertainty analysis and validation are also carried out in this section the final section is the conclusion 2 generic nonlinear manoeuvring model for marine surface vessel usually the motions of a marine surface vessel can be described in six degrees of freedoms dofs as illustrated in fig 1 they are the surge sway heave roll pitch and yaw for ship manoeuvring the motions in 3 dofs surge sway and yaw are considered because they typically occur with a much lower frequency than the wave encounter frequencies sutulo and guedes soares 2011 so it is reasonable to neglect the fluid memory effects fossen 2011 assuming a ship moving in a horizontal plane as presented in fig 2 two different coordinate systems north east down ned and body fixed frame are defined the ned frame describes the horizontal coordinate plane and consists of three coordinates one represents the position along the northern axis one along the local eastern axis and one represents the vertical position the body frame is a moving coordinate frame that is fixed to the craft the manoeuvring mathematical model is usually defined in the body fixed frame here it was assumed that the shallow water will affect the manoeuvrability of a ship by changing the manoeuvring coefficients so a generic nonlinear manoeuvring model for the marine surface vessel is given first without loss of generality any marine ships can be treated as a free rigid body moving under the action of the external forces and moments the euler equations of arbitrary motion in the horizontal plane are given 1 m μ 11 u m v r m x g r 2 x m μ 22 v m x g μ 26 r m u r y m x g μ 26 v i z z μ 66 r m x g u r n where m and i z z are the mass and the moment of inertia respectively x g is the position of centre of mass in x direction μ 11 μ 22 and μ 26 are the added masses and moments respectively x y and n are the hydrodynamic forces and moment of the ship hull here the quasi polynomials are employed to approximate the hydrodynamic forces and moments because the quasi polynomials can be slightly more economical from the viewpoint of the number of terms and computation speed even if the corresponding response surface is not smooth everywhere sutulo and guedes soares 2011 the mathematical model for surge sway and yaw motion are given 2 x v r x 0 x v v v v x v r v r x r r r r 3 y v r y 0 y v v y r r y v v v v y v r v r 4 n v r n 0 n v v n r r n r v r v n v r v r n r r r r in order to compare the coefficients of different ships and to estimate the dynamics of a full size ship the hydrodynamic parameters need to be converted to dimensionless ones the prime system recommended by sname 1950 will be used to normalize the hydrodynamic coefficients the water density ρ the ship length l and the ship speed u are employed as the characteristic dimensional parameter the forces are normalized with 0 5 ρ u 2 l t and the moment with 0 5 ρ u 2 l 2 t where t is the draft at the midship the nondimensionalized velocities and yaw rate are u u u v v u r r l u the list of the nondimensionalization factors and corresponding coefficients in eqs 2 4 is shown in table 1 3 planar motion mechanism pmm tests in shallow water this section will give an overview of the planar motion mechanism pmm tests that have been performed by flanders hydraulics research fhr delefortrie and vantorre 2007 in the framework of the shopera project papanikolaou et al 2016 test the duisburg test case dtc is a scaled ship model of a modern container carrier that is used for benchmarking and validation of numerical methods eloot et al 2016 moctar et al 2012 in total 102 pmm tests pure drift pure sway and pure yaw have been performed with different water depths velocities amplitudes and sample period in table 2 the ranges of the main kinematic parameters such as forward speed drift angle rate of turn etc are given the main particulars are given in table 3 captive model tests are nowadays commonly used for modelling the ship motions delefortrie et al 2016a b sutulo and guedes soares 2004 vantorre and eloot 1998 they can provide a rich information for system identification method and get a reasonable estimation of the hydrodynamic coefficients however perform such tests is costly here a brief summary of different pmm tests is presented fig 3 such as pure drift pure sway pure yaw and mixed sway and yaw which were performed at flanders hydraulics research fhr the towing tank at fhr has a total length of 87 5 m a width of 7 m and a maximum water depth of 0 5 m eloot et al 2016 more detailed information can be found in van kerkhove et al 2009 and delefortrie et al 2016 the ship and tank fixed coordinate system is presented in fig 4 in the pure drift test the ship mode was towing forward at a constant speed with a fixed drift angle β as presented in fig 5 a so the surge and sway velocity are a non zero constant while the yaw rate is zero u u cos β v u sin β r 0 with the results of pure drift the hydrodynamic coefficients related to the yaw motion can be neglected during the parameter estimation process pure sway test can provide a rich information for the dynamic of the sway motion meanwhile it can be used to isolate the sway dynamics from the yaw motion during the test the ship will move forward with a constant velocity and with a sinusoidal oscillation in sway where u u c v v max cos ω t and ψ 0 as presented in fig 5b the hydrodynamic coefficients related to the yaw motion can be neglected during the identification process because the yaw rate is zero pure yaw test is used to get a full response of sway motion during the test the ship moves forward with a constant velocity and with a sinusoidal oscillation in sway motion where u u c v 0 and ψ ψ max sin ω t as presented in fig 5c a combined test pure yaw and drift was carried out using a ship model with a sinusoidal oscillation in sway motion as well as a sinusoidal oscillation of yaw motion around a constant drift angle the pathline is presented in fig 5d this test can provide the dynamics information of surge sway and yaw motion so it can be used to estimate the coupled coefficients which corresponded to the surge sway and yaw motion during the test the ground speed and drift angle are kept as constant and yaw rate is set as a sinusoidal oscillation u u c β β c and ψ ψ max sin ω t 4 parameter estimation methods and parameter uncertainty analysis in this section two parameter estimation methods classical least square ls and least square support vector machine ls svm are introduced briefly then a robust version truncated ls svm is proposed by including singular value decomposition technology the truncated ls svm trains the model by calculating the singular values decomposition of the kernel matrix and neglect the smaller singular values and corresponding columns of the left singular matrix u and right singular matrix v it can reduce the computation cost due to the dimensionality reduction of the kernel matrix meanwhile providing a robust estimation 4 1 classical least square method in order to estimate the nondimensionalized hydrodynamic coefficients the above equations 2 4 need to be reordered in a vector format given by 5 x θ y where the matrix x contains the measured data θ is the parameter matrix described in equation 6 and y is the matrix of the hydrodynamic forces and moments obviously this parameter estimation problem is over determined because the length of the training data n is bigger than the number of the parameters n m the vectors of parameters are given 6 θ s u r g e u 11 x 0 x v v x v r x r r θ s w a y μ 22 μ 26 y 0 y v y r y v v y v r θ y a w μ 26 μ 66 n 0 n v n r y r v n v r n r r here several assumptions need to be made the first assumption is that the sample of measurements y i are uncorrelated it is reasonable because each measurement is independent each measurement y i has a particular variance σ y 2 due to the environmental disturbance and sensors obviously from eq 5 the estimation problem is to find the optimal parameter matrix θ which can approach the measured data y or in other words minimise the difference between the estimated values y ˆ x a and the measured data y the error needs to be dominated by the high accuracy data small variance and less affected by the low accuracy data large variance so the weighted sum of the squared residuals also called chi squared is defined in terms of the vectors 7 χ 2 θ x θ y t v y 1 x θ y where v y is the diagonal matrix of variances of y usually it can be assumed to be the identity matrix if the variances of y is unknown in advance the optimal parameters θ corresponds to the minimum value of the χ 2 error function which means the derivative of χ 2 respect to the θ equals to zero 8 χ 2 θ θ θ ˆ 0 x t v y 1 x θ ˆ x t v y 1 y 0 then the optimal values of the parameters can be obtained as 9 θ ˆ x t v y 1 x 1 x t v y 1 y the χ 2 error function can be minimized with respect to the parameters θ the estimated values which have the best agreement with the measured data can be computed using y ˆ x i θ ˆ x θ ˆ 4 2 optimal truncated ls svm and uncertainty analysis given the training set which contains n pairs of data s s i s i x i y i x i ℜ n y i ℜ i 1 n where x i is the input and y i is the output as presented in suykens et al 2002 the general approximation function of svm is given 10 y x w t φ x b where x is the training samples y x are the target values b is the bias term w is a weight matrix φ x is mapping function that maps the training data x i to a higher dimensional feature space suykens et al 2002 for function estimation or regression purpose the following optimization problem is formulated 11 min w b e i j w e 1 2 w t w 1 2 c i 1 n e i 2 subject to the equality constraints 12 y i w t φ x i b e i i 1 n where e i i 1 n is the error and c is the regularization factor it balances the well known structural risk which is the trade off between the model accuracy and the model complexity suykens et al 2002 the lagrange function is introduced to solve the optimization problem given as 13 ℒ w b e i α i 1 2 w t w 1 2 c i 1 n e i 2 i 1 n α i w t φ x i b e i y i where α i are the lagrange multipliers according to the karush kuhn tucker conditions kkt suykens et al 2002 the derivatives of the lagrange function are given by 14 ℒ w 0 w i 1 n α i φ x i ℒ b 0 i 1 n α i 0 ℒ e i 0 α i c e i i 1 n ℒ α i 0 w t φ x i b e i y i 0 i 1 n eliminating the variable w and e i one gets the following solution 15 0 1 1 k c 1 i a b α θ 0 y y where i is an n n identity matrix α α 1 α n t y y 1 y n t k x k x i ϕ x k t ϕ x i i 1 n is the kernel function which represents an inner product between its operands it is positive definite and satisfies the mercer condition suykens and vandewalle 1999 vapnik 1995 here the linear kernel function is chosen for parameter estimation so the resulted ls svm model for the regression is given 16 y x i 1 n α i k x x i b as presented in eq 15 the dimension of the kernel matrix a is n 1 n 1 it is proportional to the length of the training set so if there is large data in the training set the classical ls svm fails to inverse the matrix due to the heavy computation meanwhile the obtained parameter matrix is usually dominated by the noise and drift from the true values the obtained parameters do not comply with common sense the corresponded numerical model fits well with the training data and fails to reproduce the training set this also is well known as overfitting in the following phase an optimal truncated ls svm is proposed to solve the parameter estimation for a large scale problem parameter uncertainty or parameter drift of the hydrodynamic coefficients was found in hwang 1980 luo and li 2017 luo and zou 2009 the obtained parameters are usually dominated by the noise and have large uncertainty in hwang 1980 luo and li 2017 multicollinearity happens during the parameter estimation and several methods such as additional excitation parallel processing exaggerated over and underestimation mong others were used to diminish the parameter uncertainty the main purpose of these methods is to reconstruct the sample and reduce the multicollinearity of variables in this phase parameter uncertainty is discussed using singular value decomposition then a truncated least square support vector machine is proposed to diminish the parameter drift firstly using the singular value decomposition the kernel matrix a can be rewritten as 17 a i 1 n u i σ i v i t u σ v t then the eq 15 can be rewritten as 18 θ u σ v t 1 y v σ 1 u t y i 1 n v i u i t σ i y where the matrix u and v are orthonormal u t u i and v t v i ʃ is the diagonal matrix of the singular values of the matrix x assume that there is an additive perturbation δ y then it will propagate to a perturbation in the solution 19 δ θ v σ 1 u t δ y i 1 n v i u i t σ i δ y as presented in eq 19 when the singular value σ i is very small or close to the numerical precision of the computation then the perturbation in the y is magnified and potentially dominates the solutions θ i the corresponding columns of u and v contribute negligibly to the matrix a their contribution to the solution can be easily dominated by the noise and round off error in y so the obtained parameters are dominated by the noise as discussed in the preceding section the number of the singular σ i equals to the length of the training data the obtained parameters are inevitably dominated by the smaller singular values and are easily affected by the noise in the data and drift from the true values with a large probability in order to diminish such uncertainty and obtain a robust estimation it is necessary to neglect the effect caused by the smaller singular values truncated singular value decomposition tsvd can be used to obtain a relatively accurate representation of the matrix a by retaining the first r singular values of a and the corresponding columns of u and v the tsvd can be presented as 20 a r u r σ r v r t where the matrix σ r is obtained by retaining the first r singular values of σ similarly matrices u r and v r are found using the corresponding singular vectors the resulting a r represents the reduced data set where the data related to the omitted singular values are filtered meanwhile as it can be observed the dimensionality of the kernel matrix is reduced by using truncated singular values decomposition the optimal value of r can be estimated using the l curve hansen and o leary 1993 it is a log log plot of the norm of a regularized solution versus the norm of the corresponding residual norm it is a graphical tool for displaying the trade off between the size of a regularized solution and its fit to the given data as the r varies golub et al 1999 hansen and johnston 2001 from the l curve plot it is convenient to get the optimal parameters the whole program is given in fig 6 the uncertainty of the obtained parameters is affected by noise and quantified by the error propagation matrix the error propagation matrix or covariance matrix can be used to indicate how the random errors in y as described by v y propagate to the optimal parameter θ ˆ the error propagation matrix is given by 21 v θ ˆ θ ˆ y v y θ ˆ y t where the standard error of the parameters σ θ ˆ can get by calculation of the square root of the diagonal of the error propagation matrix then the absolute error can be calculated easily 5 nondimensionalized hydrodynamic coefficients estimation and validation in this section the parameter estimation method discussed in the preceding section will be used to identify the nondimensionalized hydrodynamic coefficients for the nonlinear manoeuvring model firstly as presented in fig 6 the pmm model test data will be divided into the training set and validation set for the training the model and test the generalization performance of the obtained numerical model respectively in order to fully activate the ship dynamics a resampling method was used to build the training set x t r a n i n g x 1 n e n d where n is a constant in order to obtain the global optimal values the large scale training set is chosen considering the computing power of the laptop so n equals to 2 the length of the training set is 6000 it includes the pure drift harmonic sway harmonic yaw and mixed yaw and drift for the validation all measured data was used the test set includes the training set and the fresh data which is completely left untouched within the training process the kinematic parameters of the pmm test are given in table 2 the classical least square method and the optimal truncated least square support vector machine are both used to estimate the parameters using the training set the uncertainty of the obtained parameters is discussed then the obtained manoeuvring model will be used to reproduce the pmm tests which are compared with the validation set as presented in eq 5 the matrix x contains the measured data if the matrix x is ill conditioned or in the other word the condition number is very large then the obtained θ ˆ usually contains a large uncertainty the condition number indicates how sensitive a function is to changes or errors in the input and how much error in the output results from an error in the input the condition number for the eqs 2 4 is given in table 4 obviously the least square support vector machine method is influenced more by the ill conditioned matrix as discussed in the preceding section the dimension of the kernel matrix increases with the length of the training set or in the other words the number of the singular value equals to the length of the data so the kernel matrix is ill conditioned with a large probability 5 1 parameter estimation using classical least squares method in this phase the classical least squares method will be employed to estimate the nondimensionalized hydrodynamic coefficients of the nonlinear manoeuvring model the models for the surge sway and yaw are given in eqs 2 4 and the parameter matrix to be identified is given in eq 6 here the training set contains the half of the whole pmm test data 5873 pairs data the training set includes all the type of pmm tests such as pure drift pure sway pure yaw and mixed yaw and drift so it contains a rich information to excite the dynamic of manoeuvring in the shallow water filtering was carried out before identification to smooth the data the training process was carried out and the numerical prediction was compared with the experimental data as presented in fig 7 obviously the models were trained successfully using the data and have a good agreement with the experiment data the obtained nondimensionalized hydrodynamic coefficients of the surge sway and yaw model are presented in tables 5 7 respectively where it can be seen that most of the parameters are estimated correctly with a small deviation except the coefficient μ 26 actually its value is very small so it has a limited effect on the accuracy of the obtained numerical model the least square method is used to minimise the sum of the squares of the residuals so when the training data is large it can usually provide an optimal estimation 5 2 parameter estimation using optimal truncated ls svm in this part the optimal truncated ls svm is used to estimate the nondimensionalized hydrodynamic coefficients as defined in eqs 2 4 as discussed in the preceding section the dimensions of the kernel matrix are n 1 n 1 where n is the length of the training set in this paper the number of the singular equals to 5874 in fact most of them usually contribute negligibly to the solutions and increase the parameter uncertainty so it is necessary to neglect the smaller singular values this operation lies in two aspects one reason is to diminish the parameter uncertainty and get a robust estimation another benefit is that it can reduce the dimensionality of the kernel matrix without loss of the accuracy the most important part for truncated ls svm finds the optimal value of r that indicates how many singular values should be kept in this paper a graphical tool l curve hansen and o leary 1993 is used to obtain the optimal value it is a log log plot of the norm of a regularized solution versus the norm of the corresponding residual norm which displays the trade off between the size of a regularized solution and its fit to the given data as the r varies more detailed introduction can be found in golub et al 1999 hansen and johnston 2001 from the l curve plot it is convenient to get the optimal parameters as presented in table 8 only a small portion of singular values and corresponded matrix u r and v r are needed to approximate the kernel matrix so dimensionality reduction of the kernel matrix is achieved which reduces the computational cost see table 9 the training process was carried out using the proposed method optimal truncated ls svm fig 8 presented the results of the trained surge fig 8a sway fig 8b and yaw motion fig 8c the resulting ls svm numerical model has a good agreement with the data in the training set the obtained nondimensionalized hydrodynamic coefficients of the surge sway and yaw model are presented in tables 5 7 as can be observed most of the parameters have similar values with the ones obtained using theclassical least square method it also indicated the proposed method optimal truncated ls svm works well with the large scale data and provide a robust estimation the deviation of the obtained parameters is very small and the uncertainty is diminished successfully the obtained values are near the true values 5 3 validation of the obtained nonlinear manoeuvring models once the manoeuvring models are obtained the next most important thing is to validate whether the models are good enough to represent the dynamic of the manoeuvring the generalization of the performance of the obtained models is usually needed to be checked using the validation data the generalization performance or error is a measure of how accurately a model is able to predict outcome values for previously unseen data in this paper the validation set includes the whole pmm test data both the training set and the new data which was left completely untouched during the training process fig 9 presents the surge sway forces and yaw moment which are reproduced based on the obtained nonlinear manoeuvring model using the classical least square method according to the figure the nonlinear manoeuvring model can reproduce the forces and moments during the pmm test with a good accuracy the r 2 goodness of fit criterion is used to measure the fitness given in table 8 fig 10 shows the validation process of the nonlinear manoeuvring model which was identified using optimal truncated ls svm the forces of surge fig 10a and sway fig 10b and yaw moment fig 10c were compared with the experimental results during the pmm test and they are in good agreement the r 2 values of the surge sway and yaw model are given in table 8 where it can be seen that the optimal truncated ls svm is a good option to estimate the hydrodynamic coefficients of the nonlinear manoeuvring model the obtained model has a good generalization performance and can reproduce the pmm model test successfully 6 conclusions an optimal truncated least square support vector machine was proposed to estimate the nondimensionalized coefficients of nonlinear manoeuvring models in shallow water firstly a nonlinear manoeuvring model in 3 dofs surge sway and yaw was introduced and the hydrodynamic coefficients have been converted to the dimensionless ones using the prime system of sname 1950 pmm model tests such pure drift pure sway pure yaw were carried out in fhr s towing tank delefortrie et al 2016a b using the dtc ship model in shallow water during the eu project shopera papanikolaou et al 2016 optimal truncated ls svm was proposed to obtain a robust parameter estimation it reduces the dimensionality of the kernel matrix and avoids the costly matrix inversion operation by using the singular values decomposition the smaller singular values and corresponded matrix are neglected considering their contribution to the solutions is negligible the classical least square method was employed to estimate the parameters and the results were compared with the optimal truncated ls svm the parameter uncertainty was also discussed and the generalization performance of the obtained nonlinear manoeuvring models was further tested against the validation set which was completely left untouched during the training the results show that the optimal truncated ls svm is a robust method for parameter estimation the identified parameters are with a small uncertainty and can reproduce the pmm test successfully the r 2 goodness of fit criterion was used to demonstrate the accuracy of the obtained models acknowledgements this work was performed within the stratc research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the pmm data was collected in the experiments performed during the project shopera energy efficient safe ship operation papanikolaou et al 2016 which was partially funded by the eu under contract 605221 the first author is grateful to prof serge sutulo for valuable discussions on manoeuvring models 
22429,an analytical approach is proposed to predict the fracture parameters of coral aggregate concrete cac both the size independent tensile strength and fracture toughness are related to the maximum fracture load linearly based on the boundary effect model by incorporating the average aggregate size moreover an explicit expression is derived to correlate the maximum fracture load with the local fracture energy at the crack tip region the local fracture energy distribution and size independent fracture energy are then determined by virtue of the maximum fracture load four groups of three point bending notched cac beams are tested by considering two ages and two environmental conditions immersion in seawater or not and the initial crack length to beam depth ratios are set from 0 1 to 0 7 in each group results show that the failure modes of all the specimens are coral coarse aggregate fracture without interfacial debonding between the aggregate and surrounding mortar the average values of tensile strength fracture toughness and fracture energy can be obtained in each group by using the experimentally measured maximum fracture loads and the experimental scatters were analyzed based on normal distribution analysis all the fracture parameters increase with the age and become larger if the specimens were immersed in seawater keywords coral aggregate concrete fracture parameters average aggregate size maximum fracture load immersion in seawater 1 introduction island constructions have been carried out recently with the rapid development of marine exploitation if all the raw materials for mixing concrete such as cement river sands crushed stones freshwater and so on have to be obtained from the mainland however many uncertainties may be encountered due to the long distance ship transportation and the construction cost and period would be increased consequently therefore it is better to seek locally available raw materials there are abundant coral reefs in the islands of south china sea which are formed by the dead anthozoans after thousands of years the coral reefs can be crushed into particles and replace the conventional fine and coarse aggregates in the light of particle sizes the seawater can be adopted locally instead of freshwater in concrete mixing if so more than 70 of the raw materials could be given locally without long distance ship transportation and the construction cost and period would be reduced significantly thus it is necessary to analyze the mechanical properties of cac systematically the main mineral components of coral aggregates are different from those in natural aggregates and more than 96 are calcium carbonate chen et al 2008 coral aggregates are generally porous and should be presoaked before concrete mixing due to their high water absorption arumugam and ramamurthy 1996 early strength of coral aggregate concrete cac develops faster due to the chloride effects from the corals compared to ordinary concrete oc wang and fan 2015 zhao et al 2011 the ratios of 7 day strength to 28 day strength even exceed 80 yang et al 2018 besides the values of uniaxial compressive strength are closer to those of cubic compressive strength in cac compared to oc yang et al 2018 the splitting tensile strength and elastic modulus are larger than those of oc with the same strength grade because of the better bond performance between the porous coral aggregate and surrounding mortar wang and fan 2015 tan et al 2018 evaluated the compressive strength of cac by using non destructive techniques and presented the correlation between the compressive strength and ultrasonic pulse velocity cac shows a more significant rate dependence in compressive strength than oc when it is subjected to dynamic compression ma et al 2019 moreover it is found that cac has remarkable brittle properties especially when it is used as columns under compressive action da et al 2016a 2018 therefore the cac columns should be enveloped by frp fiber reinforced polymer tubes to prevent spalling failure wang et al 2017 zhang et al 2019 since cac is especially used in ocean engineering the durability is so important in structural application cheng et al 2017 2018 proposed a proper mix proportion of cac by adding blast furnace slag and metakaolin instead of part of portland cement the chloride diffusion coefficient capillary water absorption and carbon depth are then reduced and the microstructure is improved cheng et al 2018 da et al 2016b found that the use of magnesium sulfate cement instead of ordinary portland cement in cac mixing can improve the resistance to chloride diffusion alkali activated geopolymer cement can be also adopted to improve the stability of cement hydration products wang et al 2018 lower water to binder ratio is suggested to increase the compressive strength and reduce the surface free cl concentration and apparent cl diffusion coefficient yu et al 2017 moreover it is well acceptable that frp bars have good resistance to chloride corrosion and can be adopted as reinforcements in cac structures however frp materials may be damaged by hydroxide ions from concrete pore solution transmitted by externally permeating water robert and benmokrane 2013 cracks in the concrete would provide channels for the harmful ions and water penetration and then much affect the durability of concrete structures therefore it is necessary to study the fracture properties of cac under ocean environment to our best knowledge there is no literature aimed at the fracture behavior of cac so far the intention of this paper is to determine the fracture parameters of cac immersed in seawater tensile strength fracture toughness and fracture energy are three fundamental parameters in describing the fracture behavior of concrete however the parameters are found to be size dependent and analyzed based on size effect law by bažant et al 1984 1990 hu et al 1992 2000 2002 2004 2007 2008 developed boundary effect model bem to reveal the mechanism of size effect which is induced by the interaction between the fracture process zone fpz ahead of crack tip and boundaries of specimens a nominal strength σ n by considering the crack length is presented and related analytically to an equivalent crack length a e indicating the distance from the crack tip to the nearest boundary hu et al 2000 2002 2007 2008 the bem was recently improved to obtain the size independent uniaxial tensile strength f t and fracture toughness k ic based on the linear regression method by virtue of the experimentally measured maximum fracture load f max hu et al 2017 wang et al 2016 2017 a simplified linear equation between f max and f t is derived by considering the effect of average grain size g guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 the values of f t and k ic for each specimen can be given analytically by using the tested f max and the experimental scatters were evaluated based on normal distribution analysis moreover hu and wittmann 1992 pointed out that size effect in fracture energy of cementitious materials is mainly due to non uniform local fracture energy g f distribution along the ligament of specimen the g f distribution can be simulated by a bi linear model indicating the size independent or maximum fracture energy g f and back boundary effect abdalla and karihaloo 2003 duan et al 2003 yang et al 2011 2014 proposed a maximum fracture load model mflm to correlate the f max with the g f at the crack tip region i e g f tip the variation of g f tip with the initial crack length a 0 is obtained by comparing the analytically predicted f max with the experimentally measured f max and then a tri linear relationship is deduced for the g f distribution indicating both the front and back boundary effects the mflm is further improved by combing with the bem to obtain the size independent f t k ic and g f for alkali activated slag cac xu et al 2019 although the mflm attempts to establish the correlation between the f max and g f tip no explicit analytical expression is derived which results in difficulties in the application of mflm thus the first intention of this study is to determine an explicit analytical relationship between the f max and g f tip to improve the mflm further three point bending tests are then performed on cac immersed in seawater for two different ages cac beams cured under normal drying environment are also prepared as control specimens the f t k ic and g f determined by the experimental f max of cac in different conditions are analyzed and discussed 2 analytical modeling 2 1 determination of ft and kic when the maximum fracture load f max is reached the stress distribution indicating nominal strength σ n in the cracked section of a standard three point bending notched beam can be assumed as shown in fig 1 guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 herein b h and l represent the width height and span of beam respectively and l 4h moreover when the applied load f is increased from the initial cracking load f ini to the f max the crack propagation process should not be continuous but discrete related to the maximum aggregate size d max in other words the critical crack propagation length δa c should be integer or semi integer multiples of d max δa c 1 0d max can gives the best estimation according to hu et al 2017 and d max 1 5g based on the assumption of linear strain distribution along the un cracked part of critical section the equilibrium condition of forces in fig 1 gives 1 f max 1 2 w 2 b h a 0 h a 0 3 g 3 l σ n in eq 1 w is the self weight of beam according to the bem hu et al 2000 2002 2007 2008 the nominal strength σ n can be expressed as follows guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 2 σ n f t 1 a e a 3 a e 1 α 2 y α 1 12 2 a 0 4 α a 0 h 5 y α 1 99 α 1 α 2 15 3 93 α 2 7 α 2 π 1 2 α 1 α 3 2 6 a 0 25 k i c f t 2 3 g substituting eqs 2 and 6 into eq 1 we have 7a f max 1 2 w f t a g h α g 7b a b h 7c g h a 0 g 2 h 1 α 1 α 3 g h 3 l 1 a e 3 g then 8 f t f max 1 2 w a g h α g 9 k i c 2 f t 3 g therefore once the maximum fracture load f max is obtained for each specimen from the test the size independent tensile strength f t and fracture toughness k ic can be determined by using eqs 8 and 9 conveniently 2 2 determination of gf tip by improving the mflm yang et al 2011 2014 when the applied load f attains the f max the stress distribution along the beam depth is shown in fig 2 according to the mflm yang et al 2011 2014 the critical crack propagation length δa c is still assumed to be 1 5g the stress in the fictitious crack here is not constant as the σ n but distributes linearly with the f t at the fictitious crack tip the relationship between the cohesive stress σ w and crack width w is simulated by a bi linear model as indicated by abdalla and karihaloo 2004 which reads 10a σ w f t 1 28 f t 25 g f t i p w 0 w 5 g f t i p 7 f t 10b σ w 9 40 f t 1 7 f t 45 g f t i p w 5 g f t i p 7 f t w 45 g f t i p 7 f t moreover the area under the adopted bi linear curve is defined as the local fracture energy g f and it is assumed constant as the one at the crack tip region i e g f tip since the critical crack propagation length is only 1 5g or 1 0d max yang et al 2011 the crack surface is assumed to be plane i e the crack opening width w distributes linearly along the beam depth moreover the assumption of linear distribution of strains in the un cracked part of critical section is still introduced the height h c 1 5g of tensile region is about half of the depth h a 0 i e 11 h c h a 0 2 1 5 g according to the equilibrium conditions of forces in fig 2 as indicated in the mflm yang et al 2011 2014 the maximum bending moment m max can be given as follows 12 m max f t b h a 0 3 g h a 0 1 5 g 2 6 h a 0 3 g 1 g f t i p 21 f t g w t c h a 0 g 50 herein w tc is the critical crack tip opening displacement it should also be the average grain size g multiplied by a discrete number similar to the δa c the w tc can be then expressed with a discrete number β w as follows 13 w t c β w 1 5 g 1000 inserting eq 13 into eq 12 gives 14 m max f t b h a 0 3 g h a 0 1 5 g 2 6 h a 0 3 g 1 g f t i p β w 63 f t g 2 h a 0 g 100000 moreover the maximum fracture load f max can be given by 15 f max 4 m max l w 2 by combing eq 14 with eq 15 the g f tip is obtained analytically as follows 16a g f t i p f t g 1 g 2 f max w 2 f t a g 2 where 16b g 1 2 h 1 α 3 g h 1 α 1 5 g h 2 3 l 1 α 3 g h 16c g 2 β w 63 g 2 1 α g h 25000 l it can be seen from eq 16a that the g f tip can be given directly once the maximum fracture load is measured from the test and the f t is determined based on the improved bem guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 for all of the specimens with different initial crack lengths the improved model in this paper avoids the estimation of g f tip based on the comparison between the analytical and experimental f max and is more simple and useful in application according to the above analysis the f t k ic and g f tip can be derived by virtue of the proposed analytical approach the values need to be determined subsequently in combination with the test of three point bending notched beams where the f max has to be given 3 experimental programme 3 1 materials cement used in the test is p o 42 5 ordinary portland cement chinese standard gb 175 2007 all the water used for mixing concrete and immersing specimens is artificial seawater according to the water in south china sea with detailed chemical components as shown in table 1 fig 3 a shows the used coral sand with apparent density and bulk density of 2517 kg m3 and 1415 kg m3 respectively coarse aggregates used in the test are columnar coral particles with the maximum diameter of 10 mm and porous properties as shown in fig 3 b the apparent and bulk densities are 1899 kg m3 and 918 kg m3 respectively the water absorption of coral stones used in this test is 15 1 moreover polycarboxylate based high range water reducer hrwr was used in mixing concrete 3 2 mix proportion all the coarse aggregates were immersed in seawater for 23 h and exposed to drying environment for 1 h before concrete mixing the detailed mix proportion of cac is seen in table 2 the mass of either coral sands or coral stones is the net mass of dry corals moreover the slump values of fresh concrete from different batches are kept between 110 mm and 125 mm by adding the hrwr 3 3 three point bending test four groups of beams with sizes of 100 100 515 mm3 were prepared in the test in each group the initial crack length to beam depth ratios a 0 h are set from 0 1 to 0 7 three samples are prepared for each ratio therefore there are totally 84 beams to be tested all the specimens were first cured in standard environment with temperature of 20 c and relative humidity of 95 for 28 days then the beams in two groups denoted by z28 and z90 were exposed to normal drying environment for 28 and 90 days respectively the specimens in two groups denoted by j28 and j90 were immersed in 20 c seawater for 28 and 90 days respectively until the test begun moreover six cubic specimens and six prisms are made to determine the cubic compressive strength f cu and elastic modulus e c of cac in the same condition with the beams in each group the fracture test set up is shown in fig 4 the test machine has a maximum range of 2000 kn in each beam two strain gauges are set horizontally at the same height with the crack tip to monitor the initial cracking state a load cell with a maximum range of 70 kn is adopted to detect the applied load f and a clip gauge having a maximum range of 4 mm is used to measure the crack mouth opening displacement cmod all the readings from the above cells were collected by a data acquisition system the application of load is controlled by the vertical displacement of loading head and the rate is kept as 0 2 mm min 4 results and discussions 4 1 cubic compressive strength and elastic modulus the average values of f cu and e c of cac in all the four groups are summarized in table 3 the derivations are attached in the brackets apparently both the f cu and e c increase with the period in different environments the strengths of cac after seawater immersion are slightly higher than those exposed in drying condition it has been mentioned that all the coral coarse aggregates are presoaked in seawater before mixing concrete as the age increases the absorbed water in the coral particles is gradually released it then results in further hydration reaction of surrounding paste the interface between the coral particles and cement mortar becomes denser therefore the strengths of cac increase as the time is longer moreover the subsequent hydration reaction would be more sufficient under seawater immersion conditions thus the strengths of cacs after immersion in seawater would be higher 4 2 analysis of crack propagation process the crack propagation process of cac is very similar to that of oc even after immersion in seawater it still includes the initial cracking state stable crack propagation stage and unstable crack propagation process the typical variations of the applied load f with cmod in all the four groups are shown in fig 5 fig 5 gives the typical f cmod curves in the four groups with a 0 h 0 3 the maximum fracture load f max increases significantly with the age the f max in the beams after seawater immersion are higher than those in the specimens exposed to drying environment it is also due to the subsequent hydration reaction of cement paste in cac and more sufficient reaction under seawater immersion condition moreover the failure modes of all the beams are fracturing of columnar coral aggregates in the cracked section as shown in fig 6 it is mainly because cement mortar in cac has good bond performance with coral particles due to the porous properties of the latter the failure mode tends to be aggregate fracture rather than interfacial debonding as the age increases and the condition is changed from drying environment to seawater immersion the interfacial transition zones become denser 4 3 determination of ft and kic with fmax from the test both the f t and k ic can be determined from eqs 8 and 9 for each specimen once the f max is measured from the fracture test however the average grain size g has to be estimated before the application of eqs 8 and 9 it is approximately d max 1 5 according to han et al 2019 thus g 7 mm is adopted since the d max is 10 mm for the cac in the present study the effect of g will be discussed later the results of all the beams are then listed in table 4 as follows in each group the values of either f t or k ic from the measured f max have certain experimental scatters they should follow normal distribution thus the scatters can be analyzed by virtue of the normal distribution functions as follows the mean μ f and standard deviation σ f of the f t and the corresponding ones μ k and σ k of the k ic are obtained based on the normal distribution analysis moreover figs 7 and 8 show the normal distributions of f t and k ic the means and the upper and lower bounds with 95 reliability are predicted directly moreover the relative errors are 29 6 34 3 31 6 and 28 3 for z28 j28 z90 and j90 respectively 17a f f t i 1 2 π σ f e f t i μ f 2 2 σ f 2 i 1 21 17b f k i c i 1 2 π σ k e k i c i μ k 2 2 σ k 2 i 1 21 it can be seen from figs 7 and 8 that both the ft and kic are improved by 20 as the period is increased from 28 day to 90 day when the ages are the same the increases of ft and kic are 10 if the cac is immersed in seawater compared to that in drying environment the reasons are explained as follows as the period is longer the hydration reaction is more sufficient accompanied by subsequent hydration reaction due to the water release from the porous coral aggregates moreover the reaction would develop more sufficiently when the cac is immersed in seawater the f t is much dependent on the bridging action of coral aggregates and tensile resistance of cement paste according to the failure modes therefore the tensile resistance t r related to f t can be given as follows 18 t r t r m t r a herein t r m and t r a are the tensile resistance attributed to the cement mortar and columnar coral aggregates in the cac respectively since the types and amounts of coral aggregates are the same for the four groups of cac the increase of f t is mainly induced by the higher tensile resistance t r m of mortar according to eq 9 the increase of f t also results in larger values of k ic by virtue of the means upper and lower bounds of f t the variations of σ n with a e are shown in fig 9 for all of the four cacs the transition regions from strength controlled failure to fracture toughness controlled failure can be clearly identified in fig 9 it can be seen that all the test results just fall in the transition regions besides the values of a e are significantly smaller than those of a therefore it is inclined to strength controlled failure although the cac shows quasi brittle fracture irrespective of the period and environment 4 4 determination of gf with fmax from the test for each group the g f tip corresponding to different initial crack length a 0 can be directly obtained from eq 16a once the f max is measured from the test and the f t is determined by eq 8 moreover the discrete number β w related to the w tc is assumed to be 2 0 here the rationality of the adopted value will be discussed later thus the variations of g f tip with a 0 are shown in fig 10 for all of the four groups from fig 10 it can be seen that the varying tendencies of the g f tip with the a 0 are similar in the four groups when the a 0 does not exceed 30 mm the g f tip shows an apparent increase after that the values of g f tip almost keep constant until the a 0 is longer than 60 mm then the g f tip begins to decrease continuously in fact the value of a 0 directly reflects the distance between the crack tip and front boundary of specimen and also indicates the distance towards the back boundary when the a 0 is shorter than 30 mm the g f tip is much affected by the front boundary effect the value is increased as the crack tip is far away from the front boundary when the a 0 is longer than 60 mm the crack tip is gradually approaching the back boundary the g f tip shows a decrease due to the back boundary effect therefore the local fracture energy g f follows a tri linear distribution as indicated by yang et al 2011 2014 based on the new model fig 11 shows a tri linear g f distribution for cacs in different conditions the transition lengths due to the front and back boundary effects are 30 40 mm and about 5 5 times of the average aggregate size g 5 5g moreover the maximum value of g f or g f tip is actually the size independent fracture energy g f hu and wittmann 1992 similar to the f t and k ic the values of g f from all the beams in each group also follow the normal distribution the mean μ g and standard deviation σ g of g f can be derived from eq 19 as follows the normal distributions of g f in the four groups are shown in fig 12 the upper and lower bounds are given with reliability of 95 the relative errors are 22 4 28 8 24 5 and 22 8 for z28 j28 z90 and j90 respectively 19 f g f i 1 2 π σ g e g f i μ g 2 2 σ g 2 i 1 21 as the period is longer the g f is increased by 16 18 when the condition is changed from dying environment to seawater immersion the g f also shows an increase which is 15 17 the varying tendencies are similar to those of f t and k ic 4 5 further discussions table 5 summarizes the average values of f t k ic and g f from all of the four groups it can be seen that all the parameters increase with the period if the cacs are immersed in seawater both the strength and fracture toughness are improved further compared to those in drying environment it demonstrates that the environment of seawater immersion would not deteriorate the mechanical performance of cac according to the results from the present study it has been mentioned that the g is adopted as 7 mm in the above calculations in fact it is too difficult to be estimated accurately the size distributions of aggregates may be varied in different batches to analyze the sensitivity of the results to the variations of g g 6 mm and g 8 mm are also introduced here the fracture parameters with different values of g are then given in table 6 as follows see table 7 as the g increases the concrete is more coarse structured since the sizes of specimens are invariable the f t is then reduced but the fracture toughness is increased however the relative errors relative to the results with g 7 mm are smaller than 7 for the f t and 2 for the k ic the maximum relative error occurs in the g f of j90 cac between g 6 mm and g 7 mm and attains 12 others are all below 10 therefore g 7 mm is accurate enough moreover the β w is adopted as 2 0 in the above calculation it is a discrete number and may be between 1 0 and 2 0 herein the fracture parameters based on β w 1 0 are given and compared to the results based on β w 2 0 as follows according to eqs 1 8 9 16a and 16c the value of β w has no effect on the f t and k ic but much affects the g f when the β w decreases from 2 0 to 1 0 the value of g f is reduced by 50 besides it is found that the maximum value of g f is around 50 n m with β w 1 0 and 100 n m with β w 2 0 previous work by the xu et al 2019 concluded that the g f is 100 n m for alkali activated slag seawater coral aggregate concrete thus β w 2 0 is more rational in the present study 5 conclusions an analytical approach is proposed to determine the size independent tensile strength f t fracture toughness k ic and fracture energy g f of cac the f t and k ic are directly determined using the maximum fracture load f max based on the improved bem guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 by incorporating the average aggregate size g besides the f max is first correlated with the crack tip local fracture energy g f tip in the form of an explicit analytical solution by improving the mflm yang et al 2011 2014 the local fracture energy g f distribution and g f can be then obtained directly moreover three point bending tests were carried out on cac beams with different a 0 h four different conditions are designed i e drying environment for 28 days drying environment for 90 days immersion in seawater for 28 days and immersion in seawater for 90 days the values of fracture parameters from all the specimens in each condition were obtained and evaluated based on normal distribution analysis the main conclusions are drawn as follows 1 both the compressive strength f cu and elastic modulus e c increase with the period the strengths of cac immersed in seawater are higher compared to those exposed to drying environment 2 the failure modes of all the beams are fracturing of columnar coral aggregates which have good bond performance with the surrounding mortar due to their porous properties 3 based on the proposed approach the means and upper and lower bounds with reliability of 95 can be obtained analytically for all of the fracture parameters 4 the g f distributions of cacs under different conditions still follow tri linear variations indicating both the front and back boundary effects the transition lengths due to the boundary effects are about 5 5g 5 both the tensile strength and fracture toughness are improved as the period is longer due to the subsequent hydration reaction in the paste when the cac is immersed in seawater the hydration reaction may be more sufficient and all the parameters show an increase compared to the cac in drying environment in summary analytical solutions of fracture parameters can be explicitly given only using the maximum fracture load which is very easy to be determined in test thus the approach proposed in this paper is simple and applicable moreover seawater immersion is merely one of the simulated marine environments the present study is a pilot work only aimed at one common marine environment and could provide some reference for the application of cac in ocean engineering at least no deterioration is found in the mechanical properties of cac immersed in seawater according to the results in this paper further studies such as long term properties in other marine environments will be performed in the future acknowledgements the authors gratefully acknowledge funding from the national natural science foundation of china grant 51778591 and educational innovation and research foundation of graduate student in shandong province of china grant hdjg17006 
22429,an analytical approach is proposed to predict the fracture parameters of coral aggregate concrete cac both the size independent tensile strength and fracture toughness are related to the maximum fracture load linearly based on the boundary effect model by incorporating the average aggregate size moreover an explicit expression is derived to correlate the maximum fracture load with the local fracture energy at the crack tip region the local fracture energy distribution and size independent fracture energy are then determined by virtue of the maximum fracture load four groups of three point bending notched cac beams are tested by considering two ages and two environmental conditions immersion in seawater or not and the initial crack length to beam depth ratios are set from 0 1 to 0 7 in each group results show that the failure modes of all the specimens are coral coarse aggregate fracture without interfacial debonding between the aggregate and surrounding mortar the average values of tensile strength fracture toughness and fracture energy can be obtained in each group by using the experimentally measured maximum fracture loads and the experimental scatters were analyzed based on normal distribution analysis all the fracture parameters increase with the age and become larger if the specimens were immersed in seawater keywords coral aggregate concrete fracture parameters average aggregate size maximum fracture load immersion in seawater 1 introduction island constructions have been carried out recently with the rapid development of marine exploitation if all the raw materials for mixing concrete such as cement river sands crushed stones freshwater and so on have to be obtained from the mainland however many uncertainties may be encountered due to the long distance ship transportation and the construction cost and period would be increased consequently therefore it is better to seek locally available raw materials there are abundant coral reefs in the islands of south china sea which are formed by the dead anthozoans after thousands of years the coral reefs can be crushed into particles and replace the conventional fine and coarse aggregates in the light of particle sizes the seawater can be adopted locally instead of freshwater in concrete mixing if so more than 70 of the raw materials could be given locally without long distance ship transportation and the construction cost and period would be reduced significantly thus it is necessary to analyze the mechanical properties of cac systematically the main mineral components of coral aggregates are different from those in natural aggregates and more than 96 are calcium carbonate chen et al 2008 coral aggregates are generally porous and should be presoaked before concrete mixing due to their high water absorption arumugam and ramamurthy 1996 early strength of coral aggregate concrete cac develops faster due to the chloride effects from the corals compared to ordinary concrete oc wang and fan 2015 zhao et al 2011 the ratios of 7 day strength to 28 day strength even exceed 80 yang et al 2018 besides the values of uniaxial compressive strength are closer to those of cubic compressive strength in cac compared to oc yang et al 2018 the splitting tensile strength and elastic modulus are larger than those of oc with the same strength grade because of the better bond performance between the porous coral aggregate and surrounding mortar wang and fan 2015 tan et al 2018 evaluated the compressive strength of cac by using non destructive techniques and presented the correlation between the compressive strength and ultrasonic pulse velocity cac shows a more significant rate dependence in compressive strength than oc when it is subjected to dynamic compression ma et al 2019 moreover it is found that cac has remarkable brittle properties especially when it is used as columns under compressive action da et al 2016a 2018 therefore the cac columns should be enveloped by frp fiber reinforced polymer tubes to prevent spalling failure wang et al 2017 zhang et al 2019 since cac is especially used in ocean engineering the durability is so important in structural application cheng et al 2017 2018 proposed a proper mix proportion of cac by adding blast furnace slag and metakaolin instead of part of portland cement the chloride diffusion coefficient capillary water absorption and carbon depth are then reduced and the microstructure is improved cheng et al 2018 da et al 2016b found that the use of magnesium sulfate cement instead of ordinary portland cement in cac mixing can improve the resistance to chloride diffusion alkali activated geopolymer cement can be also adopted to improve the stability of cement hydration products wang et al 2018 lower water to binder ratio is suggested to increase the compressive strength and reduce the surface free cl concentration and apparent cl diffusion coefficient yu et al 2017 moreover it is well acceptable that frp bars have good resistance to chloride corrosion and can be adopted as reinforcements in cac structures however frp materials may be damaged by hydroxide ions from concrete pore solution transmitted by externally permeating water robert and benmokrane 2013 cracks in the concrete would provide channels for the harmful ions and water penetration and then much affect the durability of concrete structures therefore it is necessary to study the fracture properties of cac under ocean environment to our best knowledge there is no literature aimed at the fracture behavior of cac so far the intention of this paper is to determine the fracture parameters of cac immersed in seawater tensile strength fracture toughness and fracture energy are three fundamental parameters in describing the fracture behavior of concrete however the parameters are found to be size dependent and analyzed based on size effect law by bažant et al 1984 1990 hu et al 1992 2000 2002 2004 2007 2008 developed boundary effect model bem to reveal the mechanism of size effect which is induced by the interaction between the fracture process zone fpz ahead of crack tip and boundaries of specimens a nominal strength σ n by considering the crack length is presented and related analytically to an equivalent crack length a e indicating the distance from the crack tip to the nearest boundary hu et al 2000 2002 2007 2008 the bem was recently improved to obtain the size independent uniaxial tensile strength f t and fracture toughness k ic based on the linear regression method by virtue of the experimentally measured maximum fracture load f max hu et al 2017 wang et al 2016 2017 a simplified linear equation between f max and f t is derived by considering the effect of average grain size g guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 the values of f t and k ic for each specimen can be given analytically by using the tested f max and the experimental scatters were evaluated based on normal distribution analysis moreover hu and wittmann 1992 pointed out that size effect in fracture energy of cementitious materials is mainly due to non uniform local fracture energy g f distribution along the ligament of specimen the g f distribution can be simulated by a bi linear model indicating the size independent or maximum fracture energy g f and back boundary effect abdalla and karihaloo 2003 duan et al 2003 yang et al 2011 2014 proposed a maximum fracture load model mflm to correlate the f max with the g f at the crack tip region i e g f tip the variation of g f tip with the initial crack length a 0 is obtained by comparing the analytically predicted f max with the experimentally measured f max and then a tri linear relationship is deduced for the g f distribution indicating both the front and back boundary effects the mflm is further improved by combing with the bem to obtain the size independent f t k ic and g f for alkali activated slag cac xu et al 2019 although the mflm attempts to establish the correlation between the f max and g f tip no explicit analytical expression is derived which results in difficulties in the application of mflm thus the first intention of this study is to determine an explicit analytical relationship between the f max and g f tip to improve the mflm further three point bending tests are then performed on cac immersed in seawater for two different ages cac beams cured under normal drying environment are also prepared as control specimens the f t k ic and g f determined by the experimental f max of cac in different conditions are analyzed and discussed 2 analytical modeling 2 1 determination of ft and kic when the maximum fracture load f max is reached the stress distribution indicating nominal strength σ n in the cracked section of a standard three point bending notched beam can be assumed as shown in fig 1 guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 herein b h and l represent the width height and span of beam respectively and l 4h moreover when the applied load f is increased from the initial cracking load f ini to the f max the crack propagation process should not be continuous but discrete related to the maximum aggregate size d max in other words the critical crack propagation length δa c should be integer or semi integer multiples of d max δa c 1 0d max can gives the best estimation according to hu et al 2017 and d max 1 5g based on the assumption of linear strain distribution along the un cracked part of critical section the equilibrium condition of forces in fig 1 gives 1 f max 1 2 w 2 b h a 0 h a 0 3 g 3 l σ n in eq 1 w is the self weight of beam according to the bem hu et al 2000 2002 2007 2008 the nominal strength σ n can be expressed as follows guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 2 σ n f t 1 a e a 3 a e 1 α 2 y α 1 12 2 a 0 4 α a 0 h 5 y α 1 99 α 1 α 2 15 3 93 α 2 7 α 2 π 1 2 α 1 α 3 2 6 a 0 25 k i c f t 2 3 g substituting eqs 2 and 6 into eq 1 we have 7a f max 1 2 w f t a g h α g 7b a b h 7c g h a 0 g 2 h 1 α 1 α 3 g h 3 l 1 a e 3 g then 8 f t f max 1 2 w a g h α g 9 k i c 2 f t 3 g therefore once the maximum fracture load f max is obtained for each specimen from the test the size independent tensile strength f t and fracture toughness k ic can be determined by using eqs 8 and 9 conveniently 2 2 determination of gf tip by improving the mflm yang et al 2011 2014 when the applied load f attains the f max the stress distribution along the beam depth is shown in fig 2 according to the mflm yang et al 2011 2014 the critical crack propagation length δa c is still assumed to be 1 5g the stress in the fictitious crack here is not constant as the σ n but distributes linearly with the f t at the fictitious crack tip the relationship between the cohesive stress σ w and crack width w is simulated by a bi linear model as indicated by abdalla and karihaloo 2004 which reads 10a σ w f t 1 28 f t 25 g f t i p w 0 w 5 g f t i p 7 f t 10b σ w 9 40 f t 1 7 f t 45 g f t i p w 5 g f t i p 7 f t w 45 g f t i p 7 f t moreover the area under the adopted bi linear curve is defined as the local fracture energy g f and it is assumed constant as the one at the crack tip region i e g f tip since the critical crack propagation length is only 1 5g or 1 0d max yang et al 2011 the crack surface is assumed to be plane i e the crack opening width w distributes linearly along the beam depth moreover the assumption of linear distribution of strains in the un cracked part of critical section is still introduced the height h c 1 5g of tensile region is about half of the depth h a 0 i e 11 h c h a 0 2 1 5 g according to the equilibrium conditions of forces in fig 2 as indicated in the mflm yang et al 2011 2014 the maximum bending moment m max can be given as follows 12 m max f t b h a 0 3 g h a 0 1 5 g 2 6 h a 0 3 g 1 g f t i p 21 f t g w t c h a 0 g 50 herein w tc is the critical crack tip opening displacement it should also be the average grain size g multiplied by a discrete number similar to the δa c the w tc can be then expressed with a discrete number β w as follows 13 w t c β w 1 5 g 1000 inserting eq 13 into eq 12 gives 14 m max f t b h a 0 3 g h a 0 1 5 g 2 6 h a 0 3 g 1 g f t i p β w 63 f t g 2 h a 0 g 100000 moreover the maximum fracture load f max can be given by 15 f max 4 m max l w 2 by combing eq 14 with eq 15 the g f tip is obtained analytically as follows 16a g f t i p f t g 1 g 2 f max w 2 f t a g 2 where 16b g 1 2 h 1 α 3 g h 1 α 1 5 g h 2 3 l 1 α 3 g h 16c g 2 β w 63 g 2 1 α g h 25000 l it can be seen from eq 16a that the g f tip can be given directly once the maximum fracture load is measured from the test and the f t is determined based on the improved bem guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 for all of the specimens with different initial crack lengths the improved model in this paper avoids the estimation of g f tip based on the comparison between the analytical and experimental f max and is more simple and useful in application according to the above analysis the f t k ic and g f tip can be derived by virtue of the proposed analytical approach the values need to be determined subsequently in combination with the test of three point bending notched beams where the f max has to be given 3 experimental programme 3 1 materials cement used in the test is p o 42 5 ordinary portland cement chinese standard gb 175 2007 all the water used for mixing concrete and immersing specimens is artificial seawater according to the water in south china sea with detailed chemical components as shown in table 1 fig 3 a shows the used coral sand with apparent density and bulk density of 2517 kg m3 and 1415 kg m3 respectively coarse aggregates used in the test are columnar coral particles with the maximum diameter of 10 mm and porous properties as shown in fig 3 b the apparent and bulk densities are 1899 kg m3 and 918 kg m3 respectively the water absorption of coral stones used in this test is 15 1 moreover polycarboxylate based high range water reducer hrwr was used in mixing concrete 3 2 mix proportion all the coarse aggregates were immersed in seawater for 23 h and exposed to drying environment for 1 h before concrete mixing the detailed mix proportion of cac is seen in table 2 the mass of either coral sands or coral stones is the net mass of dry corals moreover the slump values of fresh concrete from different batches are kept between 110 mm and 125 mm by adding the hrwr 3 3 three point bending test four groups of beams with sizes of 100 100 515 mm3 were prepared in the test in each group the initial crack length to beam depth ratios a 0 h are set from 0 1 to 0 7 three samples are prepared for each ratio therefore there are totally 84 beams to be tested all the specimens were first cured in standard environment with temperature of 20 c and relative humidity of 95 for 28 days then the beams in two groups denoted by z28 and z90 were exposed to normal drying environment for 28 and 90 days respectively the specimens in two groups denoted by j28 and j90 were immersed in 20 c seawater for 28 and 90 days respectively until the test begun moreover six cubic specimens and six prisms are made to determine the cubic compressive strength f cu and elastic modulus e c of cac in the same condition with the beams in each group the fracture test set up is shown in fig 4 the test machine has a maximum range of 2000 kn in each beam two strain gauges are set horizontally at the same height with the crack tip to monitor the initial cracking state a load cell with a maximum range of 70 kn is adopted to detect the applied load f and a clip gauge having a maximum range of 4 mm is used to measure the crack mouth opening displacement cmod all the readings from the above cells were collected by a data acquisition system the application of load is controlled by the vertical displacement of loading head and the rate is kept as 0 2 mm min 4 results and discussions 4 1 cubic compressive strength and elastic modulus the average values of f cu and e c of cac in all the four groups are summarized in table 3 the derivations are attached in the brackets apparently both the f cu and e c increase with the period in different environments the strengths of cac after seawater immersion are slightly higher than those exposed in drying condition it has been mentioned that all the coral coarse aggregates are presoaked in seawater before mixing concrete as the age increases the absorbed water in the coral particles is gradually released it then results in further hydration reaction of surrounding paste the interface between the coral particles and cement mortar becomes denser therefore the strengths of cac increase as the time is longer moreover the subsequent hydration reaction would be more sufficient under seawater immersion conditions thus the strengths of cacs after immersion in seawater would be higher 4 2 analysis of crack propagation process the crack propagation process of cac is very similar to that of oc even after immersion in seawater it still includes the initial cracking state stable crack propagation stage and unstable crack propagation process the typical variations of the applied load f with cmod in all the four groups are shown in fig 5 fig 5 gives the typical f cmod curves in the four groups with a 0 h 0 3 the maximum fracture load f max increases significantly with the age the f max in the beams after seawater immersion are higher than those in the specimens exposed to drying environment it is also due to the subsequent hydration reaction of cement paste in cac and more sufficient reaction under seawater immersion condition moreover the failure modes of all the beams are fracturing of columnar coral aggregates in the cracked section as shown in fig 6 it is mainly because cement mortar in cac has good bond performance with coral particles due to the porous properties of the latter the failure mode tends to be aggregate fracture rather than interfacial debonding as the age increases and the condition is changed from drying environment to seawater immersion the interfacial transition zones become denser 4 3 determination of ft and kic with fmax from the test both the f t and k ic can be determined from eqs 8 and 9 for each specimen once the f max is measured from the fracture test however the average grain size g has to be estimated before the application of eqs 8 and 9 it is approximately d max 1 5 according to han et al 2019 thus g 7 mm is adopted since the d max is 10 mm for the cac in the present study the effect of g will be discussed later the results of all the beams are then listed in table 4 as follows in each group the values of either f t or k ic from the measured f max have certain experimental scatters they should follow normal distribution thus the scatters can be analyzed by virtue of the normal distribution functions as follows the mean μ f and standard deviation σ f of the f t and the corresponding ones μ k and σ k of the k ic are obtained based on the normal distribution analysis moreover figs 7 and 8 show the normal distributions of f t and k ic the means and the upper and lower bounds with 95 reliability are predicted directly moreover the relative errors are 29 6 34 3 31 6 and 28 3 for z28 j28 z90 and j90 respectively 17a f f t i 1 2 π σ f e f t i μ f 2 2 σ f 2 i 1 21 17b f k i c i 1 2 π σ k e k i c i μ k 2 2 σ k 2 i 1 21 it can be seen from figs 7 and 8 that both the ft and kic are improved by 20 as the period is increased from 28 day to 90 day when the ages are the same the increases of ft and kic are 10 if the cac is immersed in seawater compared to that in drying environment the reasons are explained as follows as the period is longer the hydration reaction is more sufficient accompanied by subsequent hydration reaction due to the water release from the porous coral aggregates moreover the reaction would develop more sufficiently when the cac is immersed in seawater the f t is much dependent on the bridging action of coral aggregates and tensile resistance of cement paste according to the failure modes therefore the tensile resistance t r related to f t can be given as follows 18 t r t r m t r a herein t r m and t r a are the tensile resistance attributed to the cement mortar and columnar coral aggregates in the cac respectively since the types and amounts of coral aggregates are the same for the four groups of cac the increase of f t is mainly induced by the higher tensile resistance t r m of mortar according to eq 9 the increase of f t also results in larger values of k ic by virtue of the means upper and lower bounds of f t the variations of σ n with a e are shown in fig 9 for all of the four cacs the transition regions from strength controlled failure to fracture toughness controlled failure can be clearly identified in fig 9 it can be seen that all the test results just fall in the transition regions besides the values of a e are significantly smaller than those of a therefore it is inclined to strength controlled failure although the cac shows quasi brittle fracture irrespective of the period and environment 4 4 determination of gf with fmax from the test for each group the g f tip corresponding to different initial crack length a 0 can be directly obtained from eq 16a once the f max is measured from the test and the f t is determined by eq 8 moreover the discrete number β w related to the w tc is assumed to be 2 0 here the rationality of the adopted value will be discussed later thus the variations of g f tip with a 0 are shown in fig 10 for all of the four groups from fig 10 it can be seen that the varying tendencies of the g f tip with the a 0 are similar in the four groups when the a 0 does not exceed 30 mm the g f tip shows an apparent increase after that the values of g f tip almost keep constant until the a 0 is longer than 60 mm then the g f tip begins to decrease continuously in fact the value of a 0 directly reflects the distance between the crack tip and front boundary of specimen and also indicates the distance towards the back boundary when the a 0 is shorter than 30 mm the g f tip is much affected by the front boundary effect the value is increased as the crack tip is far away from the front boundary when the a 0 is longer than 60 mm the crack tip is gradually approaching the back boundary the g f tip shows a decrease due to the back boundary effect therefore the local fracture energy g f follows a tri linear distribution as indicated by yang et al 2011 2014 based on the new model fig 11 shows a tri linear g f distribution for cacs in different conditions the transition lengths due to the front and back boundary effects are 30 40 mm and about 5 5 times of the average aggregate size g 5 5g moreover the maximum value of g f or g f tip is actually the size independent fracture energy g f hu and wittmann 1992 similar to the f t and k ic the values of g f from all the beams in each group also follow the normal distribution the mean μ g and standard deviation σ g of g f can be derived from eq 19 as follows the normal distributions of g f in the four groups are shown in fig 12 the upper and lower bounds are given with reliability of 95 the relative errors are 22 4 28 8 24 5 and 22 8 for z28 j28 z90 and j90 respectively 19 f g f i 1 2 π σ g e g f i μ g 2 2 σ g 2 i 1 21 as the period is longer the g f is increased by 16 18 when the condition is changed from dying environment to seawater immersion the g f also shows an increase which is 15 17 the varying tendencies are similar to those of f t and k ic 4 5 further discussions table 5 summarizes the average values of f t k ic and g f from all of the four groups it can be seen that all the parameters increase with the period if the cacs are immersed in seawater both the strength and fracture toughness are improved further compared to those in drying environment it demonstrates that the environment of seawater immersion would not deteriorate the mechanical performance of cac according to the results from the present study it has been mentioned that the g is adopted as 7 mm in the above calculations in fact it is too difficult to be estimated accurately the size distributions of aggregates may be varied in different batches to analyze the sensitivity of the results to the variations of g g 6 mm and g 8 mm are also introduced here the fracture parameters with different values of g are then given in table 6 as follows see table 7 as the g increases the concrete is more coarse structured since the sizes of specimens are invariable the f t is then reduced but the fracture toughness is increased however the relative errors relative to the results with g 7 mm are smaller than 7 for the f t and 2 for the k ic the maximum relative error occurs in the g f of j90 cac between g 6 mm and g 7 mm and attains 12 others are all below 10 therefore g 7 mm is accurate enough moreover the β w is adopted as 2 0 in the above calculation it is a discrete number and may be between 1 0 and 2 0 herein the fracture parameters based on β w 1 0 are given and compared to the results based on β w 2 0 as follows according to eqs 1 8 9 16a and 16c the value of β w has no effect on the f t and k ic but much affects the g f when the β w decreases from 2 0 to 1 0 the value of g f is reduced by 50 besides it is found that the maximum value of g f is around 50 n m with β w 1 0 and 100 n m with β w 2 0 previous work by the xu et al 2019 concluded that the g f is 100 n m for alkali activated slag seawater coral aggregate concrete thus β w 2 0 is more rational in the present study 5 conclusions an analytical approach is proposed to determine the size independent tensile strength f t fracture toughness k ic and fracture energy g f of cac the f t and k ic are directly determined using the maximum fracture load f max based on the improved bem guan et al 2018 2019a 2019b han et al 2019 zhang et al 2018 by incorporating the average aggregate size g besides the f max is first correlated with the crack tip local fracture energy g f tip in the form of an explicit analytical solution by improving the mflm yang et al 2011 2014 the local fracture energy g f distribution and g f can be then obtained directly moreover three point bending tests were carried out on cac beams with different a 0 h four different conditions are designed i e drying environment for 28 days drying environment for 90 days immersion in seawater for 28 days and immersion in seawater for 90 days the values of fracture parameters from all the specimens in each condition were obtained and evaluated based on normal distribution analysis the main conclusions are drawn as follows 1 both the compressive strength f cu and elastic modulus e c increase with the period the strengths of cac immersed in seawater are higher compared to those exposed to drying environment 2 the failure modes of all the beams are fracturing of columnar coral aggregates which have good bond performance with the surrounding mortar due to their porous properties 3 based on the proposed approach the means and upper and lower bounds with reliability of 95 can be obtained analytically for all of the fracture parameters 4 the g f distributions of cacs under different conditions still follow tri linear variations indicating both the front and back boundary effects the transition lengths due to the boundary effects are about 5 5g 5 both the tensile strength and fracture toughness are improved as the period is longer due to the subsequent hydration reaction in the paste when the cac is immersed in seawater the hydration reaction may be more sufficient and all the parameters show an increase compared to the cac in drying environment in summary analytical solutions of fracture parameters can be explicitly given only using the maximum fracture load which is very easy to be determined in test thus the approach proposed in this paper is simple and applicable moreover seawater immersion is merely one of the simulated marine environments the present study is a pilot work only aimed at one common marine environment and could provide some reference for the application of cac in ocean engineering at least no deterioration is found in the mechanical properties of cac immersed in seawater according to the results in this paper further studies such as long term properties in other marine environments will be performed in the future acknowledgements the authors gratefully acknowledge funding from the national natural science foundation of china grant 51778591 and educational innovation and research foundation of graduate student in shandong province of china grant hdjg17006 
