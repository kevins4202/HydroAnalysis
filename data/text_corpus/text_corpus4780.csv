index,text
23900,the deep eastern boundary current debc in the southeast atlantic ocean plays an important role in the global meridional overturning circulation by carrying a comparable fraction of the north atlantic deep water transport toward the southern ocean to that of the deep western boundary current at the same time the southeast atlantic ocean is constantly influenced by energetic agulhas rings that are shedded by the agulhas current it has been pointed out that the eddy thickness transport by these agulhas rings is important in enabling the deep water mass that flows southeastward within the interior of the south atlantic ocean to cross isolines of large scale potential vorticity toward the eastern boundary where it feeds the debc in this work we focus on the dynamics of debc itself which carries this water mass into the southern ocean we use idealized general circulation model configurations to study the relationship between the agulhas rings bathymetry and the southward debc in southeast atlantic ocean we find that a debc comparable to that in observations and state estimate products is obtained only with combined forcing by agulhas rings and a sloping bathymetry the debc is then characterized by a mid depth core at a 2 2 km again similar to observations we analyze the momentum and vorticity budgets of the debc and show that it is driven by vortex stretching that is sensitive to both eddy temperature transport and the bottom slope keywords deep eastern boundary currents north atlantic deep water outflow vorticity budget eddy stretching transport 1 introduction the southward spreading of the north atlantic deep water nadw is an important branch of the global meridional overturning circulation that connects the north atlantic ocean and the southern ocean lumpkin and speer 2007 the nadw flows southward mainly as the deep western boundary current dwbc in the atlantic ocean stommel and arons 1959 however the dwbc has been found to bifurcate twice near the equator and near 22 s in the south atlantic ocean and form eastward zonal flows weiss et al 1985 böning and schott 1993 speer et al 1995 stramma and england 1999 hogg and thurnherr 2005 tracer distributions such as salinity oxygen and nutrients at about 2 km depth are found to form tongue like structures near the eastern boundary of the southeast atlantic ocean implying a southward flow of a water mass with characteristics of nadw warren and speer 1991 saunders and king 1995 speer et al 1996 arhan et al 2003 non negligible southward transports near the eastern boundary in the nadw layer of about 6 sv at 11 s speer et al 1996 and about 10 sv near the southern tip of the african continent saunders and king 1995 arhan et al 2003 have been found these transports are carried mainly by a concentrated deep eastern boundary current debc between 1 and 4 km depth with a core magnitude of about 3 cm s yang et al 2020a the zonal pathway of the nadw across the south atlantic ocean was found by sebille et al 2012 to be driven by eddy thickness flux due to energetic agulhas rings that propagate into the south atlantic ocean from its southern boundary these eddies allow the water mass to cross isolines of large scale potential vorticity and flow southeastward creating a broad flow toward the southeast boundary of the south atlantic however sebille et al 2012 did not consider the dynamics of the concentrated debc near the eastern boundary itself that is fed by this broad flow in a recent regional simulation of the southeast atlantic flow field the debc was found to be balanced by linear vortex stretching β v f z w mainly driven by eddy temperature mixing and by the bathymetry yang et al 2020a however in a study using an idealized gcm configuration yang et al 2021 the debc forced by a time mean inflow outflow boundary conditions with a slope bathymetry but no eddies has a bottom intensified vertical structure which is different from the mid depth current core simulated in the southern ocean state estimate sose 15 and by the realistic regional simulation of yang et al 2020a this suggests the importance of eddies in the dynamics of the debc in the southeast atlantic ocean similar to their important role in driving the interior flows toward the eastern boundary motivating the present work which complements and extends the findings of yang et al 2021 in this work we use a simplified configuration of the southeast atlantic ocean which includes a representation of agulhas rings on the southern boundary and focus on the effect of these agulhas rings and bathymetry on the formation of a deep southward current near the eastern boundary we find that the configuration including both the idealized agulhas rings and a sloping bottom simulates a realistic looking debc with a mid depth core as opposed to a bottom intensified structure found without explicit forcing by agulhas rings the structure of the debc is sensitive to both the agulhas rings and bathymetry this paper is organized as follows we discuss the model configuration and experiment designs in section 2 results are presented in section 3 which includes a comparison between different experiments 3 1 a discussion of time variability of the debc 3 2 and its vorticity dynamics 3 3 we conclude in section 4 2 methods we use idealized configurations representing the southeast atlantic ocean of the massachusetts institute of technology general circulation model mitgcm 14 the horizontal resolution is 0 1 in the zonal direction and 0 1 cos θ in the meridional direction θ is latitude making the grid cells nearly square there are 57 vertical levels whose thickness ranges from 5 m near the surface to 125 m near the bottom the model domain is 26 3 wide in the zonal direction and the latitudinal range is from 38 s to 25 s two bathymetry profiles of the eastern boundary are used in the experiments the first is a polynomial fit to the realistic eastern boundary topography of the southeast atlantic ocean at 30 s supplementary fig 1a gray shading to isolate the effects of the bathymetric slope a flat bottom case is also used supplementary fig 1b gray shading the eastern continental boundary in all scenarios is tilted northwestward in the meridional direction similar to the realistic western coastline of the south african continent open boundaries are used at the north south and west where boundary conditions are specified time mean southward outflow against the eastern boundary between one and four kilometers depth has been indicated by tracer observations warren and speer 1991 arhan et al 2003 and found on the southern boundary of this specific domain in sose yang et al 2020a as an idealization a core of southward flow is specified on the southern boundary that has gaussian structures in both the zonal and the vertical directions with the core depth at 2 5 km and a core speed of 5 cm s supplementary fig 1a b and its core longitude is 3 degrees westward of the solid boundary at the core depth comparable to the averaged outflow core speed in the southeast atlantic ocean in both sose and the regional atlantic simulations of yang et al 2020a similar outflow boundary conditions have been used by yang et al 2021 to simulate non eddying debcs the time mean meridional velocity on the southern boundary away from the eastern boundary is set to zero for simplicity we compensate for the total transport out of the southern boundary both the mean flow and time dependent agulhas rings described below with a weak inflow from the western boundary uniform in depth and latitude motivated by the sose results that show such an eastward inflow toward the debc area the monthly v velocity field at 2 2 km depth 38 s from sose over a period of six years shows eddy signal with a timescale of about four months supplementary fig 2 colored lines therefore idealized agulhas rings iar in abbreviation are specified on the southern boundary at monthly intervals the temporal and zonal structure of the idealized agulhas rings is simplified as a westward decaying and propagating signal v x z n v 0 exp z d cos x x e l 1 n 1 π 2 exp x x e l 2 in which x e is the position of the eastern boundary l 1 35 km is the wavelength of the propagating rings l 2 22 km is the decay scale and n is the month number n 1 2 12 supplementary fig 1c these simplified structures capture the magnitude and the most important large scale features of the sose flow field reasonably well supplementary fig 2 the vertical structure of these agulhas like rings is an exponential decay with a vertical scale of d 2 km supplementary fig 1d the magnitude of the eddy flow at the surface is 1 m s the same order of magnitude of agulhas ring velocities in sose later we will show that these boundary conditions produce agulhas like rings of surface magnitude and propagation paths in the interior of the model domain comparable to those in sose in these experiments we use a linear equation of state where the density is a function of temperature only ρ ρ 0 1 α t t 0 ρ 0 1025 kg m 3 t 0 10 c α 1 668 1 0 4 c 1 for the boundary conditions the temperature field is perturbed from a reference temperature profile that is the zonal average at the northern boundary of the corresponding domain in sose such that the density is always in thermal wind balance with the specified flow field since our focus is the effect of the rings forced at the southern boundary we simplify the surface forcing such that there is no wind forcing and the sst is restored to a uniform constant of 18 c on a timescale of 10 days we use horizontal harmonic viscosity a h 10 m 2 s horizontal bi harmonic viscosity a 4 1 0 10 m 4 s and vertical viscosity a v 1 0 4 m 2 s the gent mcwilliams scheme gent and mcwilliams 1990 is used with κ g m 20 m 2 s a bi harmonic diffusivity is specified κ 4 1 0 10 m 4 s and the vertical diffusivity is κ v 1 0 5 m 2 s we also use a linear bottom drag r 1 0 3 s 1 and no slip condition on the horizontal boundary we choose these parameters to be similar to those used in sose integrations which are also eddy resolving although at a twice coarser horizontal resolution than used here using free slip boundary condition was found not to make a significant difference to the result supplementary fig 4 finally we use the 33 advection scheme of mitgcm 3rd order dst flux limiter to compare the roles of eddies and bathymetry in the dynamics of the deep southward outflow near the eastern boundary four experiments are used the slope rings case uses the slope bathymetry and prescribes a mean flow plus idealized agulhas rings as southern boundary conditions this is the most realistic configuration the slope case uses the slope bathymetry but has only a mean flow forced on the southern boundary the flat bottom rings and the flat bottom experiments complete the set when we do not impose iars on the southern boundary the simulated interior flow is weak and does not generate strong eddies one might argue for making the viscosity and diffusivity parameters larger in these experiments to account for the missing role played by the resolved eddies but we choose to use the same parameters for the direct comparison between cases to be more meaningful to further verify that it is the agulhas rings rather than other eddy motions that are important for driving and determining the vertical structures of the debc we carried out additional experiments in which we allow eddies to develop by adding to our control slope rings case 1 a meridionally dependent sst forcing 2 horizontally dependent zonal and meridional wind stresses 3 both horizontally dependent sst and wind forcings supplementary fig 5 the forcing terms used in these idealized experiments are based on time mean of the comprehensive ocean atmosphere data set woodruff et al 1987 coads which was also used to study the debcs in realistic model configurations yang et al 2020a the sst forcing is taken to be the zonal average of the time mean sst in the corresponding domain from coads supplementary fig 5d the zonal and meridional wind stresses are taken from coads for the southeast atlantic supplementary figs 5e f furthermore we also carried out an experiment in which we added the surface forcing of both sst and wind stresses to the slope case which does not include the iars slope surf frc case to also separate the role played by the imposed weak mean flow in the southern boundary conditions another version of slope rings without such a mean flow was also carried out no mean flow table 1 summarizes the configurations of these experiments each experiment is integrated to a statistical steady state averaged temperatures over different depth ranges converge for the analysis presented in the following all the time mean fields are averaged over 20 years of integration past the point of statistical steady state and all the nonlinear terms are calculated using bi daily data over the same 20 years the figures analyzing the results do not include the 20 grid points closest to the southern northern western boundaries where artifacts of the boundary conditions exist such as concentrated meridional flow near the western boundary where a zonal inflow is prescribed 3 results in this section we compare the four cases 1 4 in table 1 to demonstrate the importance of both the idealized agulhas rings and a sloping bathymetry in the dynamics of the south atlantic debc section 3 1 in the following two subsections we focus on the slope rings case which is the simplest configuration that can still lead to a realistic debc first in order to verify that our results are relevant to the actual south atlantic debc we analyze the time variability of the debc in section 3 2 and demonstrate that the idealized debc shows similarity to the debc in more realistic configurations in terms of its statistic characteristics and momentum budget then in section 3 3 we discuss the vorticity dynamics of this debc and show that the debc simulated in the slope rings is forced by vortex stretching driven by eddy temperature transport section 3 3 we find that there are two branches of the debc similar to those simulated in realistic configurations and sose one near the eastern boundary at mid depth 1 3 km and another that is bottom intensified below 3 km and further to the west near the western edge of the slope we further discuss the different vertical structures of the two branches and the mechanisms responsible for these structures in supplementary material 3 1 time averaged flow field fig 1 shows the time mean flow field at the steady state of cases1 4 in the slope rings case which is the most realistic like of these first four runs there is a southward debc between one and four kilometers depth eastward of 10 e fig 1a e the core depth is at 2 2 km depth and a core speed of 2 cm s comparable to the speed of the debcs in sose and in a realistic regional simulation using the mitgcm 29 hereafter yts the core width is comparable to the width of the slope the isopycnals tilt upward above the current core and downward below the current core which implies that this flow is a local minimum of large scale potential vorticity f z σ again consistent with the results of sose and yts at its core depth there is northward flow west of the southward debc which is a combination of a surface intensified signal and a bottom intensified signal red in fig 1e and this northward flow does not show a core at mid depth as does the southward debc there is another branch of southward flow below 3 km depth which is bottom intensified fig 1e at longitude 10 below 3 km depth such bottom intensified debcs have also been observed in sose and yts where the slope connects with the relatively flat ocean floor there are no concentrated flows near the eastern boundary when idealized agulhas rings are removed from the southern boundary condition as seen for example in the slope case furthermore the interior flows are generally weak in this case fig 1b f even though the mean flow boundary condition is still imposed and the slope bathymetry still used a weak concentrated southward flow is found only very close to the specified outflow condition fig 1b f the debc in the flat bottom rings case is of magnitude1 5 cm s almost as strong as that in the more realistic slope rings case but is confined to a very small latitudinal range of the domain southward of 34 s fig 1c g and it is clearly fed by an eastward interior zonal flow between 34 s and 36 s the southward flows near the eastern boundary are composed of two parts fig 1g near 15 e there is a core of southward flow that is detached from the bottom while very close to the eastern boundary eastward of 15 e there is a very weak mid depth core at 2 km depth and a strong bottom intensified southward flow none of these branches is similar to the more realistic debc seen in the slope rings case in fig 1e when both idealized agulhas rings and slope bathymetry are removed from the configuration flat bottom case there is again no concentrated flow near the eastern boundary except very close to the southern boundary due to the direct influence of the mean flow boundary condition fig 1d h in summary a combination of a sloping bathymetry and idealized agulhas rings is required to produce a coherent southward debc between one and four kilometers depth with a vertical structure detached from the bottom and a width comparable to the sloping bathymetry as seen in realistic simulations and sose these results can explain the deficiencies in the idealized debc simulations in yang et al 2021 in which debcs were forced using strong steady southward inflow outflow near the eastern boundary in yang et al 2021 the debc above the same slope used here only shows the bottom intensified branch with no mid depth current core we can now interpret this as being due to the lack of agulhas ring forcing from the southern boundary in that study interestingly the idealized simulations in yang et al 2021 of the south pacific and indian ocean debcs were more successful suggesting that eddy driving is important mostly for the south atlantic debc below we show that the eddy fluxes of vorticity and temperature by such rings are important for maintaining the mid depth branch of southward flows observed in the slope rings case this seems to complement the results of sebille et al 2012 who found these rings to be important for driving southeastward interior flows toward the eastern boundary we have so far demonstrated the importance of the agulhas rings in driving the debcs yet we need to verify that it is indeed these rings rather than other eddy motions that drive and determine the vertical structure of the debc the presence and importance of eddies for the upper ocean eastern boundary currents which are driven by the surface meridional temperature gradient and surface wind stresses has long been studied peliz et al 2003 cessi and wolfe 2009 colas et al 2011 kurian et al 2011 bire and wolfe 2018 to allow local eddy activity to develop we add meridional sst gradients and surface wind section 2 to several model configurations first when these are added to a configuration without the idealized agulhas rings slope surf frc the eddy kinetic energy is much smaller than that due to the agulhas rings compare fig 3a f k and e j o the eddy kinetic energy of the idealized agulhas rings within the model domain away from the southern boundary is comparable to that observed in sose in the southeast atlantic ocean both near the surface and at depth compare fig 3a f and supplementary fig 9 the weaker eddy kinetic energy forced by surface forcings alone is also comparable to that observed in sose in the southeastern indian and pacific oceans which are not influenced by the energetic agulhas rings compare fig 3e and supplementary figs 10 and 11 this suggests that the local eddy generation in our model with such surface forcings is realistic no debc is observed in the case with surface forcings and without agulhas rings fig 2d h due to the weakness of the locally forced eddies near the eastern boundary which do not penetrate into the deep ocean fig 3e j o when we add in experiment 5 in table 1 the wind and sst gradients to the control run slope rings that also contains the agulhas rings the change to the eddy activity is not large yet shows a secondary peak in the zonal sections very close to the eastern boundary in addition to the main peak along the pathway of the idealized agulhas rings fig 3c h m the addition of such surface forcings does not lead to any significant changes to the debcs that we are primarily interested in here fig 2b f another experiment case 7 in table 1 was also carried out to test the role played by the weak mean flow imposed on the southern boundary in addition to the time varying idealized rings when such a mean flow is removed but the bathymetric slope and idealized ring forcing are still used we observe that the debc weakens fairly dramatically along its entire length it still has the right mid depth vertical structure fig 2c g this verifies the importance of both the weak mean flow boundary forcing and eddy forcing in setting the amplitude and vertical structure of the debc 3 2 time variability of the slope rings case we found that agulhas like rings forced by the southern boundary condition are a critical part of the southeast atlantic debc dynamics we now would like to show that the variability of the debc which is induced by the ring forcing is similar to that found in realistic simulation we conclude that the rings are critical not only to the time mean debc characteristics but also to its variability we focus for this purpose on the slope rings case fig 4c f compares the magnitude of the eddy velocity v e d d y u 2 v 2 shading and the mean meridional flow contours the patch of high value of v e d d y shows the propagation path of the agulhas like rings which coincides with the position of the northward mean flow see also supplementary fig 6a the northwestward propagation speed of the agulhas like rings is well explained by the advection by this northward current not shown the core of the southward debc exists eastward of the patch of high v e d d y the magnitude of the eddy velocity is larger compared to both the northward and southward mean flows so that the signal of these currents may not be detectable in instantaneous observations supplementary fig 6b shows the pdf of the v velocity at longitude 10 e latitude 33 s and at a 2 2 km depth within the core of the time mean southward debc both northward and southward velocities are likely to be observable at this position instantaneously even though the time mean southward flow is as strong as 2 cm s that the idealized current core is eastward of the local maximum of eddy activity and that the signal of the mean flows is masked by passing eddies are consistent with the southeast atlantic debc in sose and yts we conclude that this transient nature of this debc is forced by the agulhas rings we notice that the maxima of eddy activities in the slope rings case both near the surface and at depth fig 3a f k are detached from the solid eastern boundary due to the propagation of the energetic agulhas rings even though the maximum of the specified eddy forcing on the southern boundary is right at the eastern boundary this detachment of the core of high eddy activity from the eastern boundary is due to the northwestward propagation of the agulhas rings at some angle to the eastern boundary this feature is also consistent with sose supplementary fig 9 and the findings of yts the peak eddy kinetic energy occurs over a relatively flat bottom in this case and that means that conceptual models for near surface eastern boundary currents e g 7 9 would need to take that into account in their solution above the flat bottom when applied to the southeast atlantic ocean analysis of the v momentum equation shows that the two dominant terms in the debc region are the coriolis term and the pressure gradient term geostrophy whose residual is balanced by the eddy momentum flux divergence v v fig 4a b d e in the debc region the eddy momentum flux divergence tendency is northward which means that the eddies are slowing the southward mean current down instead of forcing such a current this is also consistent with the findings of yts the analysis of the time variability of the debc in the slope rings case which is the most realistic configuration of those without surface forcings considered here shows three features consistent with sose and yts first the core of the idealized debc is eastward of the local eddy activity maxima second the eddy variability is still sufficiently large to mask the presence of the time mean current instantaneously third the eddy momentum transport acts as a drag on the southward time mean debc this consistency suggests that our explanation of the dynamics of this idealized debc and in particular the role of agulhas rings in driving it is also relevant for the observed south atlantic debc that was not the case for the idealized study of yang et al 2021 because it did not include agulhas rings and was therefore not able to simulate a debc with a vertical structure consistent with sose 3 3 vorticity dynamics of the debc we found so far that the both the agulhas rings and continental slope are critical for driving the debc in order to find the driving mechanism we follow yts and consider the relative vorticity equation derived by taking the curl of the momentum equations 1 β v f w z v ζ v ζ k ˆ f in this equation ζ x v y u is the vertical component of the relative vorticity w is vertical velocity and β 2 ω cos θ r is the meridional gradient of the coriolis parameter f the last term k ˆ f stands for the vertical component of the curl of the parameterized horizontal friction for the control slope rings case the dominant vorticity balance for the debc is between advection of planetary vorticity β v vertical stretching f z w and the eddy vorticity transport v ζ all shown in fig 5 this is a similar dominant balance to that found in the realistic southeast atlantic simulation of yang et al 2020a which also included agulhas ring signals at its southern boundary as was explained in yang et al 2020a the eddies act as a drag on the southward debc in the momentum budget and at the same time induce a southward debc in the vorticity budget through the beta term yts found that the stretching w z that drives the debc is a result of eddy temperature fluxes and we would like to verify that these eddy fluxes are indeed dominated by the rings forced at the southern boundary as opposed to other eddy effects included in the realistic simulation of yts we use the temperature equation 2 t t w n 2 α g v t v t diff where t is the temperature n 2 g z ρ ρ 0 is the buoyancy frequency α is the thermal expansion coefficient and diff is the parameterized mixing fig 6 shows the vertical divergence of the vertical velocity z w reconstructed from the different terms in eq 2 we find that in the core of the debc shown by the contours the dominant term driving z w and therefore driving vortex stretching is the eddy temperature transport which shows a local maximum in the core of the current shading in panels b and g this again is consistent with the findings of yts and because the only eddy effects included here are due to the rings we can conclude that the vortex stretching driving the debc is forced by these rings in the flat bottom rings case without the slope the propagation of the agulhas like rings is more zonal compared to the slope rings case and therefore the contribution of eddy fluxes is concentrated southward of 34 s rather than along the entire eastern boundary as a result the flow is also concentrated only near the southern boundary demonstrating the importance of the slope to the direction of propagation of the rings and thus to the debc as a side comment we note that the combined analysis of the vorticity and temperature budgets used here is used also in the derivation of quasi geostrophic potential vorticity qgpv q ζ β y f z ρ z ρ equation the dominance of the vortex stretching term in our vorticity budget and that of the eddy advection in the temperature budget are together equivalent to a dominance of eddy advection of the qg stretching term f z ρ z ρ in the qgpv budget this eddy qgpv advection would take the form v s where s f z ρ z ρ we can now use ρ z ρ η where η is the isopycnal height anomaly and z η h h where h is the deviation of an isopycnal layer thickness from its long term mean h the qg stretching term is therefore approximately equal to f h v h h and the entire term is referred to as eddy thickness advection sebille et al 2012 supplementary fig 8 shows that indeed both the eddy vorticity transport and the eddy thickness advection are important in balancing the β v term in the qgpv budget panels b f d h consistent with sebille et al 2012 to summarize our goals and findings from the vorticity budget first by selectively adding idealized agulhas rings to the southern boundary condition as well as a slope topography we are able to show here that both are important for the vortex stretching signal driving the time mean debc second previous idealized configurations of the atlantic debc found an unrealistic bottom intensified flow structure yang et al 2020b 2021 we find here that the reason for the wrong vertical structure is the lack of the agulhas rings propagating from the southern boundary we find that the agulhas rings lead to a stretching signal with a mid depth maximum which give our slope rings case its realistic mid depth centered structure similar to the observed one finally we are able to decipher the role played by the slope topography it sets the direction of propagation of the rings allowing them to induce the near boundary effects that drive the debc this new insight helps explain the results of the realistic simulations of the southeast atlantic debc by yang et al 2020a this is also different from the scenario in the idealized simulations in yang et al 2021 where the topography itself is the source of stretching by interaction with bottom flows 4 conclusions deep eastern boundary currents are observed in multiple southern hemisphere ocean basins and they are important branches of the global meridional overturning circulation robbins and toole 1997 sloyan and rintoul 2001 wijffels et al 2001 arhan et al 2003 in particular the southward nadw transport in the southeast atlantic ocean carries significant fluxes of mass tracers and potential vorticity toward the southern ocean saunders and king 1995 speer et al 1996 arhan et al 2003 yang et al 2020a this debc is fed by a broad southeastward interior flow toward the eastern boundary that was found to be driven by eddy thickness fluxes due to the energetic agulhas rings sebille et al 2012 our focus in this work was the continuation of this flow the debc that is found closer to the eastern boundary of the south atlantic ocean previous work yang et al 2021 2020a b used both realistic and idealized model configurations prescribed the inflow and outflow of the southern hemisphere debcs and examined the dynamical balances of these currents away from the inflow and outflow our objectives here were to understand 1 what controls the vertical structure of the south atlantic debc that was not possible to simulate correctly in the previously used idealized configurations which did not include the agulhas rings 2 what is the role of topography in the presence of the rings we used an idealized configuration general circulation model of the south atlantic debc driven by agulhas ring like signal on the southern boundary we find that only when a sloping bathymetry and the agulhas like ring signals are included does a concentrated southward flow develop along the entire eastern boundary between one and four kilometers depth similar to that in the southern ocean state estimate solution when we use a flat bottom bathymetry a strong debc is observed only in a small latitudinal range southward of 34 s when no idealized agulhas rings are forced no debc can develop other experiment with added surface forcing showed that it is indeed the idealized agulhas rings rather than eddies forced at surface that drive the debc we find that the mid depth south atlantic debc is mainly forced by vortex stretching that is driven by eddy temperature transport the vortex stretching driving of the debc is found to be due to eddy thickness fluxes which are dominated by the agulhas rings whose path is set by the topography this complements the conclusion of sebille et al 2012 who found that eddy thickness fluxes drive the broad flow which feeds the debc studied here we also find another bottom intensified branch of the southward flows similar to one that exists in the sose solution and discuss its dynamics in the supplementary material there are several caveats to note first the broad inflow from the western boundary and the no flow condition imposed on the northern boundary are overly simplified although motivated by the general structure of the sose solution second the representation of the agulhas like rings is highly idealized and in particular ignores higher frequency and smaller spatial scales and any irregularities this idealization is intended because we wanted to find out if a realistic debc still develops without the boundary forcing of small scales the fact that a debc still develops fig 1a e suggests that the essential boundary forcing is captured by the idealized rings and that smaller boundary scales may not be critical to the driving of the south atlantic debc as a final caveat we mention that our resolution of about 10 km is insufficient for resolving submesoscale variability that is known to dominate near surface eastern boundary regions peliz et al 2003 capet et al 2008 cessi and wolfe 2009 colas et al 2011 kurian et al 2011 bire and wolfe 2018 although this variability may not be expected to play a role at a depth of 2 5 km which is the focus here in summary it seems that the regional and idealized model configurations used here make a strong case for the driving of the southeast atlantic debc by the agulhas rings with an important role played by the slope topography to determine the path of such rings credit authorship contribution statement xiaoting yang designed cases 1 4 in this manuscript and did the budget analysis that revealed the most important message conveyed by this paper the cases added after the first round of review were designed numerical experiments and calculations writing and revision of this manuscript eli tziperman the cases added after the first round of review were designed funding and computational resources writing and revision of this manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science foundation usa physical oceanography program grant oce 1535800 we would like to acknowledge high performance computing support from cheyenne provided by ncar usa s computational and information systems laboratory sponsored by the national science foundation usa et thanks the weizmann institute for its hospitality during parts of this work the mitgcm 3d ocean model used for this work is a community developed model available for download from http mitgcm org public source code html all data mitgcm modifications vorticity model codes and analysis scripts used in this work are archived in the open science framework which is a public community supported repository at https osf io agtmq these codes are publicly available with no restrictions southern ocean state estimate data set used in this paper can be found at http sose ucsd edu appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2021 101817 appendix a supplementary data the following is the supplementary material related to this article mmc s1 this file contains comments on the manuscript and supplementary figures 
23900,the deep eastern boundary current debc in the southeast atlantic ocean plays an important role in the global meridional overturning circulation by carrying a comparable fraction of the north atlantic deep water transport toward the southern ocean to that of the deep western boundary current at the same time the southeast atlantic ocean is constantly influenced by energetic agulhas rings that are shedded by the agulhas current it has been pointed out that the eddy thickness transport by these agulhas rings is important in enabling the deep water mass that flows southeastward within the interior of the south atlantic ocean to cross isolines of large scale potential vorticity toward the eastern boundary where it feeds the debc in this work we focus on the dynamics of debc itself which carries this water mass into the southern ocean we use idealized general circulation model configurations to study the relationship between the agulhas rings bathymetry and the southward debc in southeast atlantic ocean we find that a debc comparable to that in observations and state estimate products is obtained only with combined forcing by agulhas rings and a sloping bathymetry the debc is then characterized by a mid depth core at a 2 2 km again similar to observations we analyze the momentum and vorticity budgets of the debc and show that it is driven by vortex stretching that is sensitive to both eddy temperature transport and the bottom slope keywords deep eastern boundary currents north atlantic deep water outflow vorticity budget eddy stretching transport 1 introduction the southward spreading of the north atlantic deep water nadw is an important branch of the global meridional overturning circulation that connects the north atlantic ocean and the southern ocean lumpkin and speer 2007 the nadw flows southward mainly as the deep western boundary current dwbc in the atlantic ocean stommel and arons 1959 however the dwbc has been found to bifurcate twice near the equator and near 22 s in the south atlantic ocean and form eastward zonal flows weiss et al 1985 böning and schott 1993 speer et al 1995 stramma and england 1999 hogg and thurnherr 2005 tracer distributions such as salinity oxygen and nutrients at about 2 km depth are found to form tongue like structures near the eastern boundary of the southeast atlantic ocean implying a southward flow of a water mass with characteristics of nadw warren and speer 1991 saunders and king 1995 speer et al 1996 arhan et al 2003 non negligible southward transports near the eastern boundary in the nadw layer of about 6 sv at 11 s speer et al 1996 and about 10 sv near the southern tip of the african continent saunders and king 1995 arhan et al 2003 have been found these transports are carried mainly by a concentrated deep eastern boundary current debc between 1 and 4 km depth with a core magnitude of about 3 cm s yang et al 2020a the zonal pathway of the nadw across the south atlantic ocean was found by sebille et al 2012 to be driven by eddy thickness flux due to energetic agulhas rings that propagate into the south atlantic ocean from its southern boundary these eddies allow the water mass to cross isolines of large scale potential vorticity and flow southeastward creating a broad flow toward the southeast boundary of the south atlantic however sebille et al 2012 did not consider the dynamics of the concentrated debc near the eastern boundary itself that is fed by this broad flow in a recent regional simulation of the southeast atlantic flow field the debc was found to be balanced by linear vortex stretching β v f z w mainly driven by eddy temperature mixing and by the bathymetry yang et al 2020a however in a study using an idealized gcm configuration yang et al 2021 the debc forced by a time mean inflow outflow boundary conditions with a slope bathymetry but no eddies has a bottom intensified vertical structure which is different from the mid depth current core simulated in the southern ocean state estimate sose 15 and by the realistic regional simulation of yang et al 2020a this suggests the importance of eddies in the dynamics of the debc in the southeast atlantic ocean similar to their important role in driving the interior flows toward the eastern boundary motivating the present work which complements and extends the findings of yang et al 2021 in this work we use a simplified configuration of the southeast atlantic ocean which includes a representation of agulhas rings on the southern boundary and focus on the effect of these agulhas rings and bathymetry on the formation of a deep southward current near the eastern boundary we find that the configuration including both the idealized agulhas rings and a sloping bottom simulates a realistic looking debc with a mid depth core as opposed to a bottom intensified structure found without explicit forcing by agulhas rings the structure of the debc is sensitive to both the agulhas rings and bathymetry this paper is organized as follows we discuss the model configuration and experiment designs in section 2 results are presented in section 3 which includes a comparison between different experiments 3 1 a discussion of time variability of the debc 3 2 and its vorticity dynamics 3 3 we conclude in section 4 2 methods we use idealized configurations representing the southeast atlantic ocean of the massachusetts institute of technology general circulation model mitgcm 14 the horizontal resolution is 0 1 in the zonal direction and 0 1 cos θ in the meridional direction θ is latitude making the grid cells nearly square there are 57 vertical levels whose thickness ranges from 5 m near the surface to 125 m near the bottom the model domain is 26 3 wide in the zonal direction and the latitudinal range is from 38 s to 25 s two bathymetry profiles of the eastern boundary are used in the experiments the first is a polynomial fit to the realistic eastern boundary topography of the southeast atlantic ocean at 30 s supplementary fig 1a gray shading to isolate the effects of the bathymetric slope a flat bottom case is also used supplementary fig 1b gray shading the eastern continental boundary in all scenarios is tilted northwestward in the meridional direction similar to the realistic western coastline of the south african continent open boundaries are used at the north south and west where boundary conditions are specified time mean southward outflow against the eastern boundary between one and four kilometers depth has been indicated by tracer observations warren and speer 1991 arhan et al 2003 and found on the southern boundary of this specific domain in sose yang et al 2020a as an idealization a core of southward flow is specified on the southern boundary that has gaussian structures in both the zonal and the vertical directions with the core depth at 2 5 km and a core speed of 5 cm s supplementary fig 1a b and its core longitude is 3 degrees westward of the solid boundary at the core depth comparable to the averaged outflow core speed in the southeast atlantic ocean in both sose and the regional atlantic simulations of yang et al 2020a similar outflow boundary conditions have been used by yang et al 2021 to simulate non eddying debcs the time mean meridional velocity on the southern boundary away from the eastern boundary is set to zero for simplicity we compensate for the total transport out of the southern boundary both the mean flow and time dependent agulhas rings described below with a weak inflow from the western boundary uniform in depth and latitude motivated by the sose results that show such an eastward inflow toward the debc area the monthly v velocity field at 2 2 km depth 38 s from sose over a period of six years shows eddy signal with a timescale of about four months supplementary fig 2 colored lines therefore idealized agulhas rings iar in abbreviation are specified on the southern boundary at monthly intervals the temporal and zonal structure of the idealized agulhas rings is simplified as a westward decaying and propagating signal v x z n v 0 exp z d cos x x e l 1 n 1 π 2 exp x x e l 2 in which x e is the position of the eastern boundary l 1 35 km is the wavelength of the propagating rings l 2 22 km is the decay scale and n is the month number n 1 2 12 supplementary fig 1c these simplified structures capture the magnitude and the most important large scale features of the sose flow field reasonably well supplementary fig 2 the vertical structure of these agulhas like rings is an exponential decay with a vertical scale of d 2 km supplementary fig 1d the magnitude of the eddy flow at the surface is 1 m s the same order of magnitude of agulhas ring velocities in sose later we will show that these boundary conditions produce agulhas like rings of surface magnitude and propagation paths in the interior of the model domain comparable to those in sose in these experiments we use a linear equation of state where the density is a function of temperature only ρ ρ 0 1 α t t 0 ρ 0 1025 kg m 3 t 0 10 c α 1 668 1 0 4 c 1 for the boundary conditions the temperature field is perturbed from a reference temperature profile that is the zonal average at the northern boundary of the corresponding domain in sose such that the density is always in thermal wind balance with the specified flow field since our focus is the effect of the rings forced at the southern boundary we simplify the surface forcing such that there is no wind forcing and the sst is restored to a uniform constant of 18 c on a timescale of 10 days we use horizontal harmonic viscosity a h 10 m 2 s horizontal bi harmonic viscosity a 4 1 0 10 m 4 s and vertical viscosity a v 1 0 4 m 2 s the gent mcwilliams scheme gent and mcwilliams 1990 is used with κ g m 20 m 2 s a bi harmonic diffusivity is specified κ 4 1 0 10 m 4 s and the vertical diffusivity is κ v 1 0 5 m 2 s we also use a linear bottom drag r 1 0 3 s 1 and no slip condition on the horizontal boundary we choose these parameters to be similar to those used in sose integrations which are also eddy resolving although at a twice coarser horizontal resolution than used here using free slip boundary condition was found not to make a significant difference to the result supplementary fig 4 finally we use the 33 advection scheme of mitgcm 3rd order dst flux limiter to compare the roles of eddies and bathymetry in the dynamics of the deep southward outflow near the eastern boundary four experiments are used the slope rings case uses the slope bathymetry and prescribes a mean flow plus idealized agulhas rings as southern boundary conditions this is the most realistic configuration the slope case uses the slope bathymetry but has only a mean flow forced on the southern boundary the flat bottom rings and the flat bottom experiments complete the set when we do not impose iars on the southern boundary the simulated interior flow is weak and does not generate strong eddies one might argue for making the viscosity and diffusivity parameters larger in these experiments to account for the missing role played by the resolved eddies but we choose to use the same parameters for the direct comparison between cases to be more meaningful to further verify that it is the agulhas rings rather than other eddy motions that are important for driving and determining the vertical structures of the debc we carried out additional experiments in which we allow eddies to develop by adding to our control slope rings case 1 a meridionally dependent sst forcing 2 horizontally dependent zonal and meridional wind stresses 3 both horizontally dependent sst and wind forcings supplementary fig 5 the forcing terms used in these idealized experiments are based on time mean of the comprehensive ocean atmosphere data set woodruff et al 1987 coads which was also used to study the debcs in realistic model configurations yang et al 2020a the sst forcing is taken to be the zonal average of the time mean sst in the corresponding domain from coads supplementary fig 5d the zonal and meridional wind stresses are taken from coads for the southeast atlantic supplementary figs 5e f furthermore we also carried out an experiment in which we added the surface forcing of both sst and wind stresses to the slope case which does not include the iars slope surf frc case to also separate the role played by the imposed weak mean flow in the southern boundary conditions another version of slope rings without such a mean flow was also carried out no mean flow table 1 summarizes the configurations of these experiments each experiment is integrated to a statistical steady state averaged temperatures over different depth ranges converge for the analysis presented in the following all the time mean fields are averaged over 20 years of integration past the point of statistical steady state and all the nonlinear terms are calculated using bi daily data over the same 20 years the figures analyzing the results do not include the 20 grid points closest to the southern northern western boundaries where artifacts of the boundary conditions exist such as concentrated meridional flow near the western boundary where a zonal inflow is prescribed 3 results in this section we compare the four cases 1 4 in table 1 to demonstrate the importance of both the idealized agulhas rings and a sloping bathymetry in the dynamics of the south atlantic debc section 3 1 in the following two subsections we focus on the slope rings case which is the simplest configuration that can still lead to a realistic debc first in order to verify that our results are relevant to the actual south atlantic debc we analyze the time variability of the debc in section 3 2 and demonstrate that the idealized debc shows similarity to the debc in more realistic configurations in terms of its statistic characteristics and momentum budget then in section 3 3 we discuss the vorticity dynamics of this debc and show that the debc simulated in the slope rings is forced by vortex stretching driven by eddy temperature transport section 3 3 we find that there are two branches of the debc similar to those simulated in realistic configurations and sose one near the eastern boundary at mid depth 1 3 km and another that is bottom intensified below 3 km and further to the west near the western edge of the slope we further discuss the different vertical structures of the two branches and the mechanisms responsible for these structures in supplementary material 3 1 time averaged flow field fig 1 shows the time mean flow field at the steady state of cases1 4 in the slope rings case which is the most realistic like of these first four runs there is a southward debc between one and four kilometers depth eastward of 10 e fig 1a e the core depth is at 2 2 km depth and a core speed of 2 cm s comparable to the speed of the debcs in sose and in a realistic regional simulation using the mitgcm 29 hereafter yts the core width is comparable to the width of the slope the isopycnals tilt upward above the current core and downward below the current core which implies that this flow is a local minimum of large scale potential vorticity f z σ again consistent with the results of sose and yts at its core depth there is northward flow west of the southward debc which is a combination of a surface intensified signal and a bottom intensified signal red in fig 1e and this northward flow does not show a core at mid depth as does the southward debc there is another branch of southward flow below 3 km depth which is bottom intensified fig 1e at longitude 10 below 3 km depth such bottom intensified debcs have also been observed in sose and yts where the slope connects with the relatively flat ocean floor there are no concentrated flows near the eastern boundary when idealized agulhas rings are removed from the southern boundary condition as seen for example in the slope case furthermore the interior flows are generally weak in this case fig 1b f even though the mean flow boundary condition is still imposed and the slope bathymetry still used a weak concentrated southward flow is found only very close to the specified outflow condition fig 1b f the debc in the flat bottom rings case is of magnitude1 5 cm s almost as strong as that in the more realistic slope rings case but is confined to a very small latitudinal range of the domain southward of 34 s fig 1c g and it is clearly fed by an eastward interior zonal flow between 34 s and 36 s the southward flows near the eastern boundary are composed of two parts fig 1g near 15 e there is a core of southward flow that is detached from the bottom while very close to the eastern boundary eastward of 15 e there is a very weak mid depth core at 2 km depth and a strong bottom intensified southward flow none of these branches is similar to the more realistic debc seen in the slope rings case in fig 1e when both idealized agulhas rings and slope bathymetry are removed from the configuration flat bottom case there is again no concentrated flow near the eastern boundary except very close to the southern boundary due to the direct influence of the mean flow boundary condition fig 1d h in summary a combination of a sloping bathymetry and idealized agulhas rings is required to produce a coherent southward debc between one and four kilometers depth with a vertical structure detached from the bottom and a width comparable to the sloping bathymetry as seen in realistic simulations and sose these results can explain the deficiencies in the idealized debc simulations in yang et al 2021 in which debcs were forced using strong steady southward inflow outflow near the eastern boundary in yang et al 2021 the debc above the same slope used here only shows the bottom intensified branch with no mid depth current core we can now interpret this as being due to the lack of agulhas ring forcing from the southern boundary in that study interestingly the idealized simulations in yang et al 2021 of the south pacific and indian ocean debcs were more successful suggesting that eddy driving is important mostly for the south atlantic debc below we show that the eddy fluxes of vorticity and temperature by such rings are important for maintaining the mid depth branch of southward flows observed in the slope rings case this seems to complement the results of sebille et al 2012 who found these rings to be important for driving southeastward interior flows toward the eastern boundary we have so far demonstrated the importance of the agulhas rings in driving the debcs yet we need to verify that it is indeed these rings rather than other eddy motions that drive and determine the vertical structure of the debc the presence and importance of eddies for the upper ocean eastern boundary currents which are driven by the surface meridional temperature gradient and surface wind stresses has long been studied peliz et al 2003 cessi and wolfe 2009 colas et al 2011 kurian et al 2011 bire and wolfe 2018 to allow local eddy activity to develop we add meridional sst gradients and surface wind section 2 to several model configurations first when these are added to a configuration without the idealized agulhas rings slope surf frc the eddy kinetic energy is much smaller than that due to the agulhas rings compare fig 3a f k and e j o the eddy kinetic energy of the idealized agulhas rings within the model domain away from the southern boundary is comparable to that observed in sose in the southeast atlantic ocean both near the surface and at depth compare fig 3a f and supplementary fig 9 the weaker eddy kinetic energy forced by surface forcings alone is also comparable to that observed in sose in the southeastern indian and pacific oceans which are not influenced by the energetic agulhas rings compare fig 3e and supplementary figs 10 and 11 this suggests that the local eddy generation in our model with such surface forcings is realistic no debc is observed in the case with surface forcings and without agulhas rings fig 2d h due to the weakness of the locally forced eddies near the eastern boundary which do not penetrate into the deep ocean fig 3e j o when we add in experiment 5 in table 1 the wind and sst gradients to the control run slope rings that also contains the agulhas rings the change to the eddy activity is not large yet shows a secondary peak in the zonal sections very close to the eastern boundary in addition to the main peak along the pathway of the idealized agulhas rings fig 3c h m the addition of such surface forcings does not lead to any significant changes to the debcs that we are primarily interested in here fig 2b f another experiment case 7 in table 1 was also carried out to test the role played by the weak mean flow imposed on the southern boundary in addition to the time varying idealized rings when such a mean flow is removed but the bathymetric slope and idealized ring forcing are still used we observe that the debc weakens fairly dramatically along its entire length it still has the right mid depth vertical structure fig 2c g this verifies the importance of both the weak mean flow boundary forcing and eddy forcing in setting the amplitude and vertical structure of the debc 3 2 time variability of the slope rings case we found that agulhas like rings forced by the southern boundary condition are a critical part of the southeast atlantic debc dynamics we now would like to show that the variability of the debc which is induced by the ring forcing is similar to that found in realistic simulation we conclude that the rings are critical not only to the time mean debc characteristics but also to its variability we focus for this purpose on the slope rings case fig 4c f compares the magnitude of the eddy velocity v e d d y u 2 v 2 shading and the mean meridional flow contours the patch of high value of v e d d y shows the propagation path of the agulhas like rings which coincides with the position of the northward mean flow see also supplementary fig 6a the northwestward propagation speed of the agulhas like rings is well explained by the advection by this northward current not shown the core of the southward debc exists eastward of the patch of high v e d d y the magnitude of the eddy velocity is larger compared to both the northward and southward mean flows so that the signal of these currents may not be detectable in instantaneous observations supplementary fig 6b shows the pdf of the v velocity at longitude 10 e latitude 33 s and at a 2 2 km depth within the core of the time mean southward debc both northward and southward velocities are likely to be observable at this position instantaneously even though the time mean southward flow is as strong as 2 cm s that the idealized current core is eastward of the local maximum of eddy activity and that the signal of the mean flows is masked by passing eddies are consistent with the southeast atlantic debc in sose and yts we conclude that this transient nature of this debc is forced by the agulhas rings we notice that the maxima of eddy activities in the slope rings case both near the surface and at depth fig 3a f k are detached from the solid eastern boundary due to the propagation of the energetic agulhas rings even though the maximum of the specified eddy forcing on the southern boundary is right at the eastern boundary this detachment of the core of high eddy activity from the eastern boundary is due to the northwestward propagation of the agulhas rings at some angle to the eastern boundary this feature is also consistent with sose supplementary fig 9 and the findings of yts the peak eddy kinetic energy occurs over a relatively flat bottom in this case and that means that conceptual models for near surface eastern boundary currents e g 7 9 would need to take that into account in their solution above the flat bottom when applied to the southeast atlantic ocean analysis of the v momentum equation shows that the two dominant terms in the debc region are the coriolis term and the pressure gradient term geostrophy whose residual is balanced by the eddy momentum flux divergence v v fig 4a b d e in the debc region the eddy momentum flux divergence tendency is northward which means that the eddies are slowing the southward mean current down instead of forcing such a current this is also consistent with the findings of yts the analysis of the time variability of the debc in the slope rings case which is the most realistic configuration of those without surface forcings considered here shows three features consistent with sose and yts first the core of the idealized debc is eastward of the local eddy activity maxima second the eddy variability is still sufficiently large to mask the presence of the time mean current instantaneously third the eddy momentum transport acts as a drag on the southward time mean debc this consistency suggests that our explanation of the dynamics of this idealized debc and in particular the role of agulhas rings in driving it is also relevant for the observed south atlantic debc that was not the case for the idealized study of yang et al 2021 because it did not include agulhas rings and was therefore not able to simulate a debc with a vertical structure consistent with sose 3 3 vorticity dynamics of the debc we found so far that the both the agulhas rings and continental slope are critical for driving the debc in order to find the driving mechanism we follow yts and consider the relative vorticity equation derived by taking the curl of the momentum equations 1 β v f w z v ζ v ζ k ˆ f in this equation ζ x v y u is the vertical component of the relative vorticity w is vertical velocity and β 2 ω cos θ r is the meridional gradient of the coriolis parameter f the last term k ˆ f stands for the vertical component of the curl of the parameterized horizontal friction for the control slope rings case the dominant vorticity balance for the debc is between advection of planetary vorticity β v vertical stretching f z w and the eddy vorticity transport v ζ all shown in fig 5 this is a similar dominant balance to that found in the realistic southeast atlantic simulation of yang et al 2020a which also included agulhas ring signals at its southern boundary as was explained in yang et al 2020a the eddies act as a drag on the southward debc in the momentum budget and at the same time induce a southward debc in the vorticity budget through the beta term yts found that the stretching w z that drives the debc is a result of eddy temperature fluxes and we would like to verify that these eddy fluxes are indeed dominated by the rings forced at the southern boundary as opposed to other eddy effects included in the realistic simulation of yts we use the temperature equation 2 t t w n 2 α g v t v t diff where t is the temperature n 2 g z ρ ρ 0 is the buoyancy frequency α is the thermal expansion coefficient and diff is the parameterized mixing fig 6 shows the vertical divergence of the vertical velocity z w reconstructed from the different terms in eq 2 we find that in the core of the debc shown by the contours the dominant term driving z w and therefore driving vortex stretching is the eddy temperature transport which shows a local maximum in the core of the current shading in panels b and g this again is consistent with the findings of yts and because the only eddy effects included here are due to the rings we can conclude that the vortex stretching driving the debc is forced by these rings in the flat bottom rings case without the slope the propagation of the agulhas like rings is more zonal compared to the slope rings case and therefore the contribution of eddy fluxes is concentrated southward of 34 s rather than along the entire eastern boundary as a result the flow is also concentrated only near the southern boundary demonstrating the importance of the slope to the direction of propagation of the rings and thus to the debc as a side comment we note that the combined analysis of the vorticity and temperature budgets used here is used also in the derivation of quasi geostrophic potential vorticity qgpv q ζ β y f z ρ z ρ equation the dominance of the vortex stretching term in our vorticity budget and that of the eddy advection in the temperature budget are together equivalent to a dominance of eddy advection of the qg stretching term f z ρ z ρ in the qgpv budget this eddy qgpv advection would take the form v s where s f z ρ z ρ we can now use ρ z ρ η where η is the isopycnal height anomaly and z η h h where h is the deviation of an isopycnal layer thickness from its long term mean h the qg stretching term is therefore approximately equal to f h v h h and the entire term is referred to as eddy thickness advection sebille et al 2012 supplementary fig 8 shows that indeed both the eddy vorticity transport and the eddy thickness advection are important in balancing the β v term in the qgpv budget panels b f d h consistent with sebille et al 2012 to summarize our goals and findings from the vorticity budget first by selectively adding idealized agulhas rings to the southern boundary condition as well as a slope topography we are able to show here that both are important for the vortex stretching signal driving the time mean debc second previous idealized configurations of the atlantic debc found an unrealistic bottom intensified flow structure yang et al 2020b 2021 we find here that the reason for the wrong vertical structure is the lack of the agulhas rings propagating from the southern boundary we find that the agulhas rings lead to a stretching signal with a mid depth maximum which give our slope rings case its realistic mid depth centered structure similar to the observed one finally we are able to decipher the role played by the slope topography it sets the direction of propagation of the rings allowing them to induce the near boundary effects that drive the debc this new insight helps explain the results of the realistic simulations of the southeast atlantic debc by yang et al 2020a this is also different from the scenario in the idealized simulations in yang et al 2021 where the topography itself is the source of stretching by interaction with bottom flows 4 conclusions deep eastern boundary currents are observed in multiple southern hemisphere ocean basins and they are important branches of the global meridional overturning circulation robbins and toole 1997 sloyan and rintoul 2001 wijffels et al 2001 arhan et al 2003 in particular the southward nadw transport in the southeast atlantic ocean carries significant fluxes of mass tracers and potential vorticity toward the southern ocean saunders and king 1995 speer et al 1996 arhan et al 2003 yang et al 2020a this debc is fed by a broad southeastward interior flow toward the eastern boundary that was found to be driven by eddy thickness fluxes due to the energetic agulhas rings sebille et al 2012 our focus in this work was the continuation of this flow the debc that is found closer to the eastern boundary of the south atlantic ocean previous work yang et al 2021 2020a b used both realistic and idealized model configurations prescribed the inflow and outflow of the southern hemisphere debcs and examined the dynamical balances of these currents away from the inflow and outflow our objectives here were to understand 1 what controls the vertical structure of the south atlantic debc that was not possible to simulate correctly in the previously used idealized configurations which did not include the agulhas rings 2 what is the role of topography in the presence of the rings we used an idealized configuration general circulation model of the south atlantic debc driven by agulhas ring like signal on the southern boundary we find that only when a sloping bathymetry and the agulhas like ring signals are included does a concentrated southward flow develop along the entire eastern boundary between one and four kilometers depth similar to that in the southern ocean state estimate solution when we use a flat bottom bathymetry a strong debc is observed only in a small latitudinal range southward of 34 s when no idealized agulhas rings are forced no debc can develop other experiment with added surface forcing showed that it is indeed the idealized agulhas rings rather than eddies forced at surface that drive the debc we find that the mid depth south atlantic debc is mainly forced by vortex stretching that is driven by eddy temperature transport the vortex stretching driving of the debc is found to be due to eddy thickness fluxes which are dominated by the agulhas rings whose path is set by the topography this complements the conclusion of sebille et al 2012 who found that eddy thickness fluxes drive the broad flow which feeds the debc studied here we also find another bottom intensified branch of the southward flows similar to one that exists in the sose solution and discuss its dynamics in the supplementary material there are several caveats to note first the broad inflow from the western boundary and the no flow condition imposed on the northern boundary are overly simplified although motivated by the general structure of the sose solution second the representation of the agulhas like rings is highly idealized and in particular ignores higher frequency and smaller spatial scales and any irregularities this idealization is intended because we wanted to find out if a realistic debc still develops without the boundary forcing of small scales the fact that a debc still develops fig 1a e suggests that the essential boundary forcing is captured by the idealized rings and that smaller boundary scales may not be critical to the driving of the south atlantic debc as a final caveat we mention that our resolution of about 10 km is insufficient for resolving submesoscale variability that is known to dominate near surface eastern boundary regions peliz et al 2003 capet et al 2008 cessi and wolfe 2009 colas et al 2011 kurian et al 2011 bire and wolfe 2018 although this variability may not be expected to play a role at a depth of 2 5 km which is the focus here in summary it seems that the regional and idealized model configurations used here make a strong case for the driving of the southeast atlantic debc by the agulhas rings with an important role played by the slope topography to determine the path of such rings credit authorship contribution statement xiaoting yang designed cases 1 4 in this manuscript and did the budget analysis that revealed the most important message conveyed by this paper the cases added after the first round of review were designed numerical experiments and calculations writing and revision of this manuscript eli tziperman the cases added after the first round of review were designed funding and computational resources writing and revision of this manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science foundation usa physical oceanography program grant oce 1535800 we would like to acknowledge high performance computing support from cheyenne provided by ncar usa s computational and information systems laboratory sponsored by the national science foundation usa et thanks the weizmann institute for its hospitality during parts of this work the mitgcm 3d ocean model used for this work is a community developed model available for download from http mitgcm org public source code html all data mitgcm modifications vorticity model codes and analysis scripts used in this work are archived in the open science framework which is a public community supported repository at https osf io agtmq these codes are publicly available with no restrictions southern ocean state estimate data set used in this paper can be found at http sose ucsd edu appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2021 101817 appendix a supplementary data the following is the supplementary material related to this article mmc s1 this file contains comments on the manuscript and supplementary figures 
23901,this paper analyses a methodology to identify sub series of waves parameters and wind speed able to explain the overall variability of the input dataset to this end the k means clustering technique is applied to a 40 year long time series of hindcast data off the genoa coastline nw italy k means aims to group the data in a reduced number of clusters represented by as many modes of variability or model scenarios this work reviews and discusses a methodology to select time varying model scenarios and assess the performances of k means according to two indexes and increasing number of clusters these indexes are used to compute the number of clusters best suited for the application at hand testing different conditions as concerns the variables involved in the analysis and their temporal resolution results show that the indexes may not be consistent with each other and that the number of scenarios to be reasonably employed strongly depends on how data are initially assembled finally some of the model scenarios selected in front of genoa are analysed and discussed in the framework of the local wind wave climatology keywords k means met ocean modelling ligurian coastline 1 introduction there are several environmental processes taking place in the nearshore zone that are of foremost interest from both scientific and technical points of view such as storm surges coastal circulation beach evolution and pollutant dispersion among many others a few recent examples can be found e g in wu et al 2018 briganti et al 2018 enrile et al 2019 de ruggiero et al 2020 a detailed characterization of the local climatology of the sea is therefore crucial to plan the human activities in coastal areas zheng et al 2020 losada et al 2019 venancio et al 2020 khelil et al 2019 and to handle hazards and emergency situations cheung et al 2003 samaras et al 2016 kerguillec et al 2019 mahendra et al 2011 silva et al 2017 in this respect the use of numerical models for the simulation and forecasting of marine and coastal hydrodynamics has dramatically increased over the last decades especially thanks to the exponential growth in the power of modern supercomputers a wide range of numerical models has been developed for the analysis simulation and resolution of geophysical fluid dynamics problems allowing to efficiently describe the processes driven by the upper sea physics for example beach morphodynamics larson et al 1987 reeve 2006 castelle et al 2015 vousdoukas et al 2012 coco et al 2014 roelvink et al 2009 littoral currents watanabe 1982 kaliraj et al 2014 lee et al 2014 and ocean waves growth and propagation tolman et al 2016 booij et al 1997 lópez et al 2015 browne et al 2007 wornom et al 2001 the characterization of these phenomena is generally based on huge amount of information the processing of which requires high computational powers and times especially if the data at hand come from a climate reanalysis service characterized by fine resolutions in time and space nevertheless top computational performances are not always available thus it may be advisable to reduce the number of environmental conditions to be retained for further numerical simulations and analysis the detection of the most significant modes of variability of a time series can help to pursue this goal indeed the use of techniques for the reduction of data dimensionality and in particular clustering algorithms hastie et al 2009 wilks 2011 anderberg 2014 allows to focus on a limited number of subsets to capture most of the variability of a time series reducing in turn the computational load required to run a modelling chain cluster analysis partitions input data into modes or clusters based on the selected distance measure e g euclidean minkowski etc each cluster representing a group of elements that are similar to each other and are dissimilar from the elements of another cluster more specifically this methodology aims to simultaneously minimize the distance between members of a given cluster and maximize the distance between the centres or centroids of the clusters michelangeli et al 1995 jain et al 1999 coggins et al 2014 fučkar et al 2016 the result of a clustering analysis is a subset of elements that summarizes the initial dataset while maintaining its main properties note that in the previous literature the clusters centroids have been also referred to as model scenarios hereinafter they will be referred to simply as scenarios for the sake of brevity scenarios can highlight the main characteristics of the dataset under investigation which may be difficult to appreciate if only looking at its overall distribution especially in case of huge multi variate datasets there exist several clustering methods and the previous literature present different applications for the identification of environmental conditions with different specific objectives that concern not only the analysis of geophysical processes but also their numerical simulation a thorough review of the available techniques can be found in barbakh et al 2009 which outlines how in general the clustering method should be selected according to the analysis that is meant to be carried out as far as met ocean variables are concerned hadzimejlic et al 2012 introduced a general workflow to clustering atmospheric states through the use of hierarchical methods such methods were also used by euán and sun 2019 to develop a method for the clustering of time series of directional spectra camus et al 2011a used clustering techniques for the propagation of sea waves in the coastal zone and enríquez et al 2020 applied clustering techniques to characterize the spatial patterns of storm surges off the global coastline mclaughlin et al 2003 and bárcena et al 2015 performed clustering analysis for the simulation of three dimensional hydrodynamics of estuaries and núñez et al 2019 employed clustering analysis to assess the probability of marine litter accumulation in estuaries the latter studies are based on the k means algorithm which is one of the most popular unsupervised clustering techniques and allows to group the initial database in k classes and as many centroids scenarios each representing the respective class i e cluster the term unsupervised means that the data do not need to be labelled prior to performing the clustering macqueen et al 1967 friedman et al 2001 the use of this particular method allows to select scenarios that on average catch the properties of the data belonging to the respective clusters as the k means aims precisely at minimizing the intra cluster variance however different methods could be employed if different data selection were meant to be carried out for instance the maximum dissimilarity algorithm may be more appropriate than k means to describe extreme conditions of the input variables camus et al 2011b k means has the advantage that it is relatively easy to implement and guarantees convergence on the other hand one of the drawbacks is that the number of clusters must be manually chosen the aforementioned works defined the number of clusters to be used according to indexes that allow to assess the goodness of the clustering with respect to the total data herein the number of clusters best suited for the application at hand will be referred to as optimal however the use of particular indexes to establish the optimal number of scenarios may sometimes be misleading and the indexes employed be not always consistent among each other in this respect the present work resumes a methodology for the selection of time varying scenarios of met ocean variables in this work meant as wind and wave data k means analysis is here applied to select groups of climatological scenarios from hindcast data in front of genoa ligurian coastline nw of italy comparing the optimal number of scenarios according to two different indexes the model efficiency ce and the total variance w 2 proposed by nash and sutcliffe 1970 and wilks 2011 respectively in particular the analysis is conducted for varying initial conditions of the problem such as time resolutions of the data and the number of variables employed then some of the clusters selected according to a specific initial set of the hindcast time series are analysed and evaluated in the context of the local climatology of the area the paper is structured as follows section 2 presents the hindcast data and the methodology used in the study section 3 presents and discusses the results while the conclusions are drawn in section 4 2 data methods 2 1 hindcast data this work took advantage of wave and wind data hindcasted off the genoa coastline in the north tyrrhenian sea north west of italy an overview of the area is shown in panel a of fig 1 while in panel b a close up on the hindcast node used is shown in this study the node 230 i e point 000230 was considered among all the grid nodes in the mediterranean sea provided by the hindcast service of the department of civil chemical and environmental engineering of the university of genoa dicca www3 dicca unige it meteocean hindcast the wgs84 lon lat coordinates of point 000230 are 8 8707 44 3100 respectively at each hindcast node wind speed and direction and wave parameters data were reconstructed and validated over the 1979 2019 period at a hourly resolution the historical wind and wave data were computed using the weather research and forecasting skamarock et al 2008 and wavewatchiii models tolman et al 2009 respectively details on the development and validation of the hindcast data can be found in mentaschi et al 2013 2015 in particular this study used the 1979 2018 series of significant wave height h s mean period and direction t m and θ m respectively and zonal meridional wind velocity components u w and v w respectively the time series of the hindcast parameters considered in the present work are shown in fig s1 in the supplement note that at the time of the analysis the 2019 data were not available thus they were not taken into account the following sections present the methodology developed to group the time varying sea states at the investigated location first the general formulation of k means is briefly explained then it is shown how to set up the initial dataset to account for the time dependence of the variables considered and subsequently how to assess the performance of the clustering according to ce and w 2 finally a simple shortcut for the clustering of circular variables is discussed 2 2 k means algorithm the clustering of met ocean parameters is performed through the so called k means technique this is aimed at partitioning a n dimensional population into k sets clusters in order to minimize the overall intra cluster variance based on the euclidean distances between the elements of different sets macqueen et al 1967 to explain the work flow of k means reference is made to a data matrix x n v v denotes the number of variables of the problem while n is the total number of data available for each variable and may correspond to the number of observations or sampling intervals of a process the number of trials of an experiment etc given v arrays populated by n data x n v is built up as follows 1 x n v x 1 1 x 1 v x n 1 x n v first x n v has to be normalized column wise in a given space e g in the range 0 1 to be able to group variables characterized by different orders of magnitude after the scaling of the variables a target number of clusters is selected henceforth referred to as m at the first iteration the centroids say x m v 1 are randomly selected among the rows of x n v then each data i e each i th row of x i v i 1 n is assigned to its closest centroid 2 m i m min d i x i x m v 1 i 1 n m where m i denotes the centroid the i th data belongs to once the m groups are defined the new centroids x m v 2 are computed as the element by element means among the data belonging to each cluster 3 x m v 2 x i m j x i n j where n j is the number of elements assigned to the j th cluster and spans the 1 n m interval the algorithm ends when the clusters assignment do not change between two successive iterations as the centroids are updated after each iteration according to eq 3 the convergence criteria imply that the centroids are not changing between two successive iterations 2 3 set up of the initial dataset in the example of eq 1 the overall data sample to be fed into the k means algorithm is defined by stacking column wise the original arrays of the investigated parameters then the clustering of the dataset obtained allows to select m significant subsets defined by as many rows of x n v note that in this case the selected subsets i e the scenarios are computed as the means of single instants among the initial time series of data if time varying scenarios need to be selected the input data have to be first reorganized in order to take into account their evolution in time according to the approach proposed in bárcena et al 2015 and núñez et al 2019 it is first required to fix the reference time frame of the problem which should be selected according to the problem under investigation for example in case of sea states modelling one day may suffice if the goal of the clustering is to describe severe storms at least in the mediterranean sea whereas model of pollutants dispersion would require longer windows e g one week or even more secondly the long term series of the variables under investigation can be arranged in sub series of given length for a single variable x defined n t the number of time steps of the reference time frame the array of x can be expressed as 4 x j t x i δ t 1 n t i δ t i 0 n n t δ t j i 1 where δ t is the shift between two successive time frames i e the number of elapsed time steps between the initial points of the x t rows the colon in the subscript of the left hand side of the equation denotes the whole length of the array i e from the first to its nt t h element eq 4 results in a number of matrices equal to v and the overall matrix say x n v t is constructed by adding at a time the matrices related to the single variables of the problem 5 x n v t x j t 1 x j t v 2 4 clustering of time series and selection of time varying scenarios in the present work the cluster analysis is performed through the k means applied on matrices built up as x n v t variables are centred and scaled in a space to mean 0 and standard deviation 1 and the centroids are first initialized through the maximum dissimilarity algorithm for reproducibility note that in this case the rows of the matrix in eq 5 do no longer refer to single instants but to n t long time slices hence the centroids are made in turn of the means computed column wise over the n t v elements of the arrays belonging to each cluster in the case test presented further on the text the arrays closest to the centroids will be considered as the time varying scenarios of the respective clusters according to the above mentioned example the number of columns of the initial dataset is therefore equal to n t v while the number of rows is equal to n n t the selection of the scenarios requires to set the number of clusters the initial data will be grouped into this can be chosen subjectively as an instance if the data are known to occur in particular modes or they need to be assigned to a given number of classes however if m is not known a priori a sensitivity analysis should be performed either by looking at the clustering outcomes de leo et al 2020 or relying on specific indexes that allow to select the optimal number of clusters bárcena et al 2015 employed a statistical index proposed by nash and sutcliffe 1970 referred to as ce which reads 6 c e 1 i 1 n r i s i 2 r i r 2 where r i and s i denote the i t h real and synthetic series respectively this index requires to split the initial data into a training dataset used to select the scenarios and a validation dataset left out from the clustering analysis and used at a second time to assess the reliability of the scenarios identified s is constructed by replacing the original time series of the validation set with the scenarios that best approximate them in other words given the validation dataset containing the real time series of data each reference time frame is replaced by the centroid of the cluster it would belong to according to eq 2 the ce index expresses the difference between the variance computed with the synthetic centroids and the measured data variance and spans the 1 range the former and the latter limits indicating the worst and best performances of the clustering model respectively in particular if ce is lower than 0 5 the clustering method is considered unacceptable meaning that the reduced number of states does not efficiently describe the overall variance of the system on the other hand the clustering starts to be convenient when ce attains values between 0 5 and 0 6 while it provides good and excellent performances for values of ce between 0 6 and 0 8 and higher than 0 8 respectively bárcena et al 2015 as such different number of clusters may be deemed appropriate according to the desired performance of the method i e convenient good excellent previous research took also advantage of the total variance of the system resulting from the clustering of the data solari and alonso 2017 this is expressed as wilks 2011 7 w 2 1 n i 1 m j 1 m j x j x i 2 n being the total number of states and m j the number of elements belonging to the j th cluster x j denotes a single state among the m j belonging to the j th cluster whereas x i is the respective i th centroid the number of clusters is said to be optimal when to increase m does not lead to significant reductions of w 2 in this work ce is used to assess the clustering performance on time series of met ocean variables at point 000230 for different sets of the initial conditions of the data in particular we vary at a time the number of years of the training and validation periods of the k means the length of the reference time frame i e n t the time shift between successive time frames i e δ t the resolution in time of the initial datasets and the number of variables employed for each combination of these factors we test different number of clusters computing ce to identify for each case the minimum number of clusters required for the scenarios to exhaustively represent the initial dataset according to ce then w 2 is computed for the same sets and tested number of clusters and the optimal number of clusters is assessed through the so called elbow rule details are provided in section 3 1 subsequently the number of clusters computed with the different indexes is compared and discussed finally with respect to a particular set up of the initial dataset we assess whether the optimal scenarios computed are able to describe the climate variability of wave and wind fields for the investigated area 2 5 clustering of circular variables whenever the dataset to be modelled includes circular variables the discontinuities in the variable space have to be accounted for as an instance two waves moving south might be characterized either by θ m equal to 0 or 360 according to the nautical convention if only the raw directions were considered the former wave would be closer to a target wave west oriented while the latter would be closer to a target wave east oriented θ m being equal to 90 and 270 respectively though the input data refer to the same direction to overcome this issue a correction is usually applied directly on the difference computed between circular features so that the distance between single elements spans the π π range at most camus et al 2011b mentaschi et al 2015 however if built in functions of given programming languages not accounting for such correction are meant to be used an equivalent approach can be employed instead of modifying the computation of the distance between two circular variables the latter can be expressed in cartesian coordinates secondly applying the cluster analysis directly on the projected components still resorting to the instance of wave directions θ m can be projected along the east north axis as follows 8 θ m x cos θ m 90 θ m y sin θ m 90 the correction on the arguments of the sinusoidal functions is needed for the zonal meridional components to be consistent with the nautical convention indeed both the components are positives negatives in the third first quadrant whereas they are discordant in the second and the fourth quadrants the clustering can be then performed directly on the cartesian components of θ m which are now continuously defined in the real space a practical example on the clustering of circular variables is introduced and discussed in the supplement 3 results discussion 3 1 optimal number of clusters due to the selection of the initial dataset the examples presented in this section allow to evaluate how the selection of the starting dataset may affect the number of required scenarios defined according to ce as explained in section 2 4 this index quantifies to what extent the scenarios selected from a training dataset are able to reproduce a dataset used to validate the clustering model an analysis on a simplified case was first carried out to test the reliability of the algorithms developed to this end one year of h s data were clustered setting a number of clusters m equal to the number of input data n and using the input time series both for training and validating the k means under such conditions ce and w 2 attained values equal to 1 and 0 respectively thus proving the corrected implementation of the algorithms results not shown for the sake of brevity the results hereon introduced refer instead to different sets of the clustering initial conditions and varying number of clusters from 2 to 300 in all the cases presented excepted the last three the clustering is performed considering a single variable h s each set is identified through a number recalled in table 1 the optimal number of clusters is referred to as m o first it is investigated how ce varies depending on the periods defined to train the k means analysis and for the subsequent validation of the model sets 1 2 and 3 to this end a time frame of one week is fixed resulting in n t 168 being data hourly defined δ t is equal to one day leading to 24 time steps the training dataset is developed according to eq 4 on the h s series defined over 10 20 and 30 years at a time accordingly the validation of the model through the ce index is performed over 30 20 and 10 years respectively since the data span the 1979 2018 period 40 years precisely results are presented in fig 2 first looking at the curves of ce a slight noise can be seen for values of m between 45 and 175 this is due to the increasingly wider increments between successive number of clusters tested indeed during the iteration process m was increased at a time by 2 5 25 and 50 for values of m up to 10 50 200 and 300 clusters respectively similar oscillations can be spotted also in the curves related to different sets and presented further on the text however these oscillations are negligible and do not affect the resulting quality of the clustering according to ce it can be noticed how the curves almost overlap for low number of clusters starting to slightly diverge when m is approximately equal to 30 even though the curves lie close to each other good performances of the model are detected for number of clusters significantly different in the three cases indeed the clustering of the data starts to be convenient for m equal to 158 116 88 in case of training validation performed over 10 30 20 20 and 30 10 years respectively ce never provides excellent results looking at these results one may conclude that to split the initial dataset over different periods for the selection of scenarios may strongly affect the outcomes of the clustering however a closer inspection on the ce vs m profiles reveals how these are characterized by very similar shapes and upper limits that is to vary the periods of training validation of k means technique does not really play a key role in the cluster analysis this is most likely due to the high resolution in time that characterizes the dataset at hand with long time series continuously defined and no dramatic variations in the data taking place from one year to another therefore the differences in the resulting m o are to be explained because of the slight variations in the slopes of the ce curves which tend gently to their respective asymptotic values in the following cases the clustering of the data is trained over the 1979 2008 period and validated over the 2009 2018 decade first a series of analysis concerning the time settings of the initial database is carried out results are reported in fig 3 initially it is evaluated the influence of δ t on the estimates of ce sets 3 4 5 6 in table 1 this analysis still relies on a one week long time frame and hourly defined h s data while the shift between the referring series is varied among 6 12 24 72 h results are shown in panel a of fig 3 also in this case the model does not reach the best allowable performance and no relevant differences arise between the curves related to δ t equal to 6 12 and 24 h in fact ce attains g o o d values for 70 74 and 88 clusters respectively nevertheless when δ t is equal to 72 h 128 clusters are needed to comply with the ce requirements i e to get g o o d performances of the clustering apparently in this case a shift of three days between two frames implies a relevant loss of information as significant sea states in the thyrranean sea typically arise and expire in less than a day budillon et al 2006 second the sensitivity analysis on ce is performed against the resolution in time of the h s data as shown in panel b of fig 3 the reference window and δ t are one week and 24 h long respectively and the sampling resolution referred to as d t is varied among 1 3 6 and 12 h no remarkable differences arise in the ce estimates related to d t in between 1 3 and 6 h with 88 80 and 78 clusters needed to attain good performances sets 3 7 and 8 respectively however results prove that a coarser time resolution of the initial data leads to a significant improvement of the clustering analysis since only 44 clusters would be taken into account for d t equals 12 h set 9 as a matter of fact when d t is equal to 1 h and the reference time frame is fixed to one week the number of resulting columns for r and s is 168 an increase of d t lowers in turn the number of columns of these matrices in the aforementioned examples d t equal 3 6 and 12 h lead to dataset made up of 56 28 and 14 columns respectively therefore the scenarios are populated by a lower number of elements and are more representative of the elements belonging to the relative cluster i e the sum of the differences between r i and s i in eq 6 is on average reduced the aforementioned consideration is further confirmed by the results related to varying lengths of the reference time frame this can be noticed by looking at panel c of fig 3 showing the dependence of ce with respect to n t for initial data hourly defined and δ t equal to 12 h in this case a significant improvement for the clustering analysis can be appreciated with excellent performances attained for n t equal to 24 and 72 sets 10 and 11 respectively in the former case 10 clusters are enough to observe the best ce condition while in the latter case 164 clusters would be needed when n t is equal to 168 the model reaches good performances at most set 5 the results so far introduced show that the dimension of the matrix used for the cluster analysis deeply affects the computation of m 0 according to ce indeed the value of n t affects the number of columns of the matrix see eqs 4 and 5 this can be also appreciated when the number of variables v of the problem is varied set 10 and sets from 12 to 14 as shown in fig 4 here the curves of ce are computed by adding at a time the time series of t m θ m and wind speed to the time series of h s this analysis refers to a time frame of 24 h with a hourly time resolution i e n t 24 and d t 1 and δ t 12 h in this case excellent conditions are attained when h s 10 clusters and h s t m 42 clusters are taken into account when further variables are considered the clustering model shows good performances at most with an optimal number of clusters equal to 26 and 144 if θ m set 13 and u w set 14 are added to the analysis respectively note that when the direction of waves is considered the k means takes advantage of the algorithm introduced in section 2 5 it should mentioned that in the examples previously introduced there was no need to scale h s indeed the clustering was performed on a single variable which is by definition scaled in its own range on the contrary in the last three sets several parameters with different magnitudes were combined into the starting dataset in these cases x n v was therefore normalized column wise by centring and scaling all the variables employed results for all the tested sets are summarized in table 1 by looking at the outcomes of m o it is clear that the dimension of the dataset to be modelled dramatically affects the number of clusters needed to comply with the ce requirements this is due to the fact that the differences in eq 6 are pairwise computed between two sets of data i e the real series of a validation matrix and the synthetic series made of the scenarios resulting from the k means analysis to increase the number of elements of r i and s i that is the number of columns of x n v t increases in turn the dispersion of the single states around their respective centroids resulting in lower values of ce this can be particularly appreciated by comparing m o for increasing n t and fixed δ t and d t as shown for sets 10 11 and 5 similarly sets 10 12 13 and 14 show how increasing numbers of variables reflect on decreasing performances of the clustering method even though a lower value of m o characterizes set 13 with respect to set 12 in the former case the best performance is good while in the latter is excellent on the other hand when the sensitivity of m o with respect to other parameters is evaluated the number of columns of x n v t is not varying as much as for varying numbers of n t and tested variables thus the differences in the clustering outcomes are less relevant the index proposed by nash and sutcliffe 1970 has the undoubted advantage of possibly providing a unique result for m o given that the required performances of the clustering method are fixed on the contrary other methods may leave more room for subjective evaluations of the analyst as an instance if w 2 is taken into account the optimal number of clusters should be selected in correspondence of a significant change of slope in the w 2 curve i e on the intersection of the straight lines best fitting the two branches of the hyperbole the so called elbow rule however in many cases it is not easy to define exactly where this condition takes place and it might be necessary to couple w 2 with other metrics in this respect the following figures combine the information related to ce and w 2 for all the sets previously introduced note that the values of w 2 are scaled in the 0 1 range as the original dimension is not relevant the statistic is computed on time series of several variables centred and scaled needless to say this does not affect the assessment of the elbow location in the former case values of m o related to good performances of ce are highlighted with circles first results related to varying periods of training validation of the clustering algorithm are shown in fig 5 in this case it can be noticed how ce provides more conservative results with respect to w 2 even though no excellent conditions are reached according to ce m o values fall beyond the change of slope in the respective w 2 curve for all the sets considered the same condition occurs with respect to varying δ t panel a of fig 6 and d t except when this is equal to 12 h set 9 in this latter case the two metrics seem to provide consistent results panel b of fig 6 as for n t in case of a week long time frame the values of m o driven by ce would still be higher than that following the w 2 analysis on the contrary for short time windows sets 10 and 11 when good performances are taken into account ce leads to values of m o considerably lower than those resulting from w 2 as shown in panel c of fig 6 as for the number of variables employed if good performances of the clustering according to ce are considered m o results to be more conservative in case all the variables are fed into the clustering analysis set 14 while to rely on w 2 would yield higher number of clusters if either both h s and t m set 12 or just h s set 10 were considered ce and w 2 provide instead similar results when three variables are taken into account see fig 7 finally when e x c e l l e n t conditions of ce are considered ce estimates of m o result to be either higher consistent or lower than the ones resulting from the w 2 curves in case of set 11 set 12 and set 10 respectively reference is made to fig 8 highlighting m o s related to ce with a star from the results so far introduced it is clear that the selection of the number of clusters to be retained neither comes with ease nor it should be treated lightly as different statistical indicators may provide in turn different estimates of m 0 moreover the initialization of the starting dataset should be performed according to the physics of the problem under investigation for example both a coarse time resolution of the initial data or a short reference time frame may allow ce to attain excellent values or a well defined break point for the w 2 curve nevertheless as far as met ocean variables are concerned such conditions may not be suitable if wave induced processes occurring over short time scales or beach profile variations induced by long shore sediment transport occurring over long time scales were meant to be characterized 3 2 case study this section shows the results of k means data selection on the hindcast data defined at point 000230 see fig 1 the scope of the analysis is to identify a reduced number of significant wind and sea states able to properly detect the variations of the met ocean climate in front of the genoa coastline from the analysis of fig 9 it can be appreciated how the waves in front of genoa propagate from three main directions n nw sw s s se it is worth recalling that the wave direction is defined according to the nautical convention thus θ m refers to the direction the wave is coming from as accordingly do the bins of the polar plot as regards the wind this is found to be remarkably correlated with the waves parameters the correlation between wind speed and h s t m is computed through the spearman s ρ coefficient which yields some advantages with respect to other common indexes de michele et al 2007 as for the directions the correlation is computed through the index proposed by jammalamadaka and sengupta 2001 which reads 9 r i sin θ m i θ m sin θ w n d i θ w n d i sin 2 θ m i θ m sin 2 θ w n d i θ w n d where θ w n d denotes the wind incoming direction and the top bar denote the circular mean in this case the correlation is computed on the exceedances of increasing h s thresholds referred to as h t h and 1 year long time slices to evaluate if the sought correlation depends on to the energy content of the sea states results are shown in table 2 and fig 10 and highlight how the directions of waves and wind referred to as θ w n d are generally expected to be consistent especially in case of severe sea states the characterization of the local wave climate takes advantage of h s t m θ m and u w stacked together and clustered for the 1979 2008 period thus leaving ten years for the validation of the results in this case first n t is selected according to the auto correlation function acf of h s taken as the lead parameter acf is computed shifting the initial step of one lag at a time and considering a total number of 168 lags i e one week for data hourly outputted like the hindcast ones at a second time given the series of acf values for a week long window over the whole 1979 2018 period the values for each lag are averaged results are reported in fig 11 showing that acf attains negligible values on the 26th lag i e the 25th hour as indicated by the green line the analysis of the acf of h s reveals that a typical sea state pattern at point 000230 lasts for about a day thus the time scale of the problem is set equal precisely to one day 24 h as a first attempt the time resolution d t is set equal to 6 hours while this choice allows to have a matrix easier to handle i e with reduced dimensions it is reasonable to assume that such resolution does not yield loss of relevant information between successive instants of the time series given the slow inertia of the wind sea system finally δ t is fixed to 12 h that is the duration characterizing the majority of the most energetic sea states occurring in the investigated area for all the prevailing wave directions this can be appreciated looking at the frequency plots of fig 12 showing the peaks and duration of the sea storms at point 000230 computed through the peak over threshold pot approach and three directional sectors n se and sw in this case storms were declustered starting from the exceedances of h s above the 98th percentile of their initial distribution and considering an inter event duration of 12 h details on the pot data selection can be found in lang et al 1999 given the initial set of the problem a sensitivity analysis on varying number of clusters is performed according to the methodology introduced in section 2 4 results are presented in figs 13 and 14 first of all it is worth pointing out how for a given number of tested clusters several values of ce can be computed indeed according to the notation so far introduced the validation is performed over s and r which are two matrices with n t columns in case of r the first element of each column is shifted of d t from the previous element and each column spans the whole length of the validation period but a time frame that depends on the initial step n t and δ t thanks to this method summarized by eq 5 the clustering of the data does not depend on the choice of the initial time step within the time series since all the possible ones within the initial frame made of n t data are spanned therefore each column leads to a value of ce and the series obtained can be following averaged among the n t values in case the windows do not overlap with each other a unique value of ce follows the k mean validation an example of such a case can be found in bárcena et al 2015 panel b of fig 13 shows how the mean turns out to be more significant for high number of clusters since the uncertainty on the ce estimates is lowered the analysis of ce and w 2 panel a of figs 13 and 14 respectively reveals that in this case a number of 55 clusters ad as many scenarios would be reasonable according to both the indexes in this case 53 iterations were needed for the k means to converge the analysis of the clusters size reveals that each cluster contains on average 400 time series with a standard deviation equal to approximately 210 elements the cluster more populated counts 1183 data while the smallest one only has 88 clusters this variability is due to the different met ocean states represented by the clusters with those related to the most intense states being less populated on the other hand the centroids of the bigger clusters account for mild wind and sea states which being far more frequent can be assimilated to the vast majority of the time series analysed fig 15 shows the profiles of h s and θ m for some of the scenarios that best represent the three prevailing fetches in front of genoa with waves moving northeast θ m 180 n panels a and b waves moving northwest θ m 180 n panels c and d and waves moving south θ m 0 360 n panels e and f the panels show both the scenarios selected over time series coarser in time than the total data the black curves and the correspondent time slices related to the original data hourly defined colour scaled scatters for each of the three fetches considered profiles indicating both mild and severe wave conditions are shown from the analysis of the h s profiles it can be noticed how a 24 h long time frame is able to describe scenarios belonging to each of the aforementioned fetches with no significant changes in the average incoming direction of waves other scenarios are representative instead of more varying conditions data not shown for the sake of brevity moreover retaining one data every six hours does not affect the reliability of the resulting scenarios as the hourly defined data are not significantly scattered around their profiles this consideration particularly applies in case of low h s but holds as well when more energetic states are taken into account finally fig 16 shows the wind profiles corresponding to the scenarios reported in fig 15 in this case the initial data are more dispersed with respect to the mean synthetic profiles because the wind speeds of the hindcast refer to single instants and are therefore more irregular comparing to the wave parameters that are computed from directional spectra of sea states of given length details on the computation of the hindcast parameters and the computational time steps of the models employed can be found in tolman et al 2016 mentaschi et al 2013 respectively in conclusion as far as θ w n d is concerned it can be noticed how in case of severe sea states wind and waves are similarly oriented consistent with the results reported in fig 10 in such a case the wind inflates energy into the sea surface and directly contributes to increase h s while this effect is lowered in case of mild sea states panels b d and f of fig 16 respectively the correlation pointed out between wind and wave data is to be related to the exposure of the ligurian coastline characterized by short fetches with the exception of the sw direction therefore the generation of long swell waves is limited independently from the occurrence of any wind generated waves 4 final remarks the selection of significant scenarios of geo physical variables can be helpful for a plethora of applications as far as met ocean forcing is concerned the hydrodynamic modelling of sea states might not be feasible if long term series of data are meant to be investigated mainly due to the computational cost requirements to overcome such difficulties it might be convenient to identify a reduced number of representative scenarios through clustering techniques in this respect this paper reviews and discusses a methodology to select time varying scenarios from 40 years of hindcast data through the k means technique in particular it is shown how the selection of an optimal number of scenarios referred to as m o according to k means is not straightforward by comparing the values of m o according to ce and w 2 two indexes commonly employed within the clustering analysis framework first it is shown how the values of ce and w 2 strongly depend on the initial conditions of the investigated dataset indeed the values of m o increase according to the dimension of the arrays to be clustered which depend on the length of the reference time frame the number of variables employed and their time resolution also the time shift between successive time frames δ t is proved to be relevant thus it should be selected according to the time scales of the processes investigated second it is shown how the values of m o following the two methods are not always consistent and in particular w 2 provides more conservative results with respect to ce i e it leads on average to a higher number of required clusters besides it must be mentioned that other methods to validate the clustering of the data may be employed e g the so called silhouette method kaufman and rousseeuw 2009 the dunn index dunn 1973 or the davies bouldin index davies and bouldin 1979 as such care should be given when selecting the number of clusters for the application at hand and the clustering method adopted finally a practical application for a hindcast node in front of the ligurian coastline is presented here it is shown that when the initial setting of the data is performed by taking into account the timescales of the investigated processes the computation of m o might be facilitated and the resulting scenarios are able to efficiently describe the wind and waves climate variability with respect to the input data even though the hindcast data have been thoroughly validated it would be interesting to see how the classification of the sea states would change if observed i e real time series were employed and this opens the way for future researches declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was developed in the framework of the interreg italia francia marittimo projects splash 1 1 http interreg maritime eu web splash stop alle plastiche in h20 grant number d31i18000620007 geremia 2 2 http interreg maritime eu web geremia gestione dei reflui per il miglioramento delle acque portuali grant number d41i18000600005 and sinapsi 3 3 http interreg maritime eu web sinapsi assistenza alla navigazione per l accesso ai porti in sicurezza grant number d64i18000160007 authors would like to deeply acknowledge prof alessandro verri and prof carlo ciliberto for their invaluable suggestions during the development of the research the computational codes have been developed in matlab environment and are available upon request taking advantage of the statistics and machine learning toolbox note that the maximum number of iterations was bumped up to 1000 to ensure that the code was always able to converge all the codes developed are available upon request please contact giulia cremonini at giulia cremonini edu unige it the results for ce and w2 are available for download at genoa research data management repository doi https doi org 10 5281 zenodo 4117656 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2021 101819 appendix a supplementary data the following is the supplementary material related to this article mmc s1 the supplementary material reports the additional results that for the sake of brevity could not been included in the main manuscript 
23901,this paper analyses a methodology to identify sub series of waves parameters and wind speed able to explain the overall variability of the input dataset to this end the k means clustering technique is applied to a 40 year long time series of hindcast data off the genoa coastline nw italy k means aims to group the data in a reduced number of clusters represented by as many modes of variability or model scenarios this work reviews and discusses a methodology to select time varying model scenarios and assess the performances of k means according to two indexes and increasing number of clusters these indexes are used to compute the number of clusters best suited for the application at hand testing different conditions as concerns the variables involved in the analysis and their temporal resolution results show that the indexes may not be consistent with each other and that the number of scenarios to be reasonably employed strongly depends on how data are initially assembled finally some of the model scenarios selected in front of genoa are analysed and discussed in the framework of the local wind wave climatology keywords k means met ocean modelling ligurian coastline 1 introduction there are several environmental processes taking place in the nearshore zone that are of foremost interest from both scientific and technical points of view such as storm surges coastal circulation beach evolution and pollutant dispersion among many others a few recent examples can be found e g in wu et al 2018 briganti et al 2018 enrile et al 2019 de ruggiero et al 2020 a detailed characterization of the local climatology of the sea is therefore crucial to plan the human activities in coastal areas zheng et al 2020 losada et al 2019 venancio et al 2020 khelil et al 2019 and to handle hazards and emergency situations cheung et al 2003 samaras et al 2016 kerguillec et al 2019 mahendra et al 2011 silva et al 2017 in this respect the use of numerical models for the simulation and forecasting of marine and coastal hydrodynamics has dramatically increased over the last decades especially thanks to the exponential growth in the power of modern supercomputers a wide range of numerical models has been developed for the analysis simulation and resolution of geophysical fluid dynamics problems allowing to efficiently describe the processes driven by the upper sea physics for example beach morphodynamics larson et al 1987 reeve 2006 castelle et al 2015 vousdoukas et al 2012 coco et al 2014 roelvink et al 2009 littoral currents watanabe 1982 kaliraj et al 2014 lee et al 2014 and ocean waves growth and propagation tolman et al 2016 booij et al 1997 lópez et al 2015 browne et al 2007 wornom et al 2001 the characterization of these phenomena is generally based on huge amount of information the processing of which requires high computational powers and times especially if the data at hand come from a climate reanalysis service characterized by fine resolutions in time and space nevertheless top computational performances are not always available thus it may be advisable to reduce the number of environmental conditions to be retained for further numerical simulations and analysis the detection of the most significant modes of variability of a time series can help to pursue this goal indeed the use of techniques for the reduction of data dimensionality and in particular clustering algorithms hastie et al 2009 wilks 2011 anderberg 2014 allows to focus on a limited number of subsets to capture most of the variability of a time series reducing in turn the computational load required to run a modelling chain cluster analysis partitions input data into modes or clusters based on the selected distance measure e g euclidean minkowski etc each cluster representing a group of elements that are similar to each other and are dissimilar from the elements of another cluster more specifically this methodology aims to simultaneously minimize the distance between members of a given cluster and maximize the distance between the centres or centroids of the clusters michelangeli et al 1995 jain et al 1999 coggins et al 2014 fučkar et al 2016 the result of a clustering analysis is a subset of elements that summarizes the initial dataset while maintaining its main properties note that in the previous literature the clusters centroids have been also referred to as model scenarios hereinafter they will be referred to simply as scenarios for the sake of brevity scenarios can highlight the main characteristics of the dataset under investigation which may be difficult to appreciate if only looking at its overall distribution especially in case of huge multi variate datasets there exist several clustering methods and the previous literature present different applications for the identification of environmental conditions with different specific objectives that concern not only the analysis of geophysical processes but also their numerical simulation a thorough review of the available techniques can be found in barbakh et al 2009 which outlines how in general the clustering method should be selected according to the analysis that is meant to be carried out as far as met ocean variables are concerned hadzimejlic et al 2012 introduced a general workflow to clustering atmospheric states through the use of hierarchical methods such methods were also used by euán and sun 2019 to develop a method for the clustering of time series of directional spectra camus et al 2011a used clustering techniques for the propagation of sea waves in the coastal zone and enríquez et al 2020 applied clustering techniques to characterize the spatial patterns of storm surges off the global coastline mclaughlin et al 2003 and bárcena et al 2015 performed clustering analysis for the simulation of three dimensional hydrodynamics of estuaries and núñez et al 2019 employed clustering analysis to assess the probability of marine litter accumulation in estuaries the latter studies are based on the k means algorithm which is one of the most popular unsupervised clustering techniques and allows to group the initial database in k classes and as many centroids scenarios each representing the respective class i e cluster the term unsupervised means that the data do not need to be labelled prior to performing the clustering macqueen et al 1967 friedman et al 2001 the use of this particular method allows to select scenarios that on average catch the properties of the data belonging to the respective clusters as the k means aims precisely at minimizing the intra cluster variance however different methods could be employed if different data selection were meant to be carried out for instance the maximum dissimilarity algorithm may be more appropriate than k means to describe extreme conditions of the input variables camus et al 2011b k means has the advantage that it is relatively easy to implement and guarantees convergence on the other hand one of the drawbacks is that the number of clusters must be manually chosen the aforementioned works defined the number of clusters to be used according to indexes that allow to assess the goodness of the clustering with respect to the total data herein the number of clusters best suited for the application at hand will be referred to as optimal however the use of particular indexes to establish the optimal number of scenarios may sometimes be misleading and the indexes employed be not always consistent among each other in this respect the present work resumes a methodology for the selection of time varying scenarios of met ocean variables in this work meant as wind and wave data k means analysis is here applied to select groups of climatological scenarios from hindcast data in front of genoa ligurian coastline nw of italy comparing the optimal number of scenarios according to two different indexes the model efficiency ce and the total variance w 2 proposed by nash and sutcliffe 1970 and wilks 2011 respectively in particular the analysis is conducted for varying initial conditions of the problem such as time resolutions of the data and the number of variables employed then some of the clusters selected according to a specific initial set of the hindcast time series are analysed and evaluated in the context of the local climatology of the area the paper is structured as follows section 2 presents the hindcast data and the methodology used in the study section 3 presents and discusses the results while the conclusions are drawn in section 4 2 data methods 2 1 hindcast data this work took advantage of wave and wind data hindcasted off the genoa coastline in the north tyrrhenian sea north west of italy an overview of the area is shown in panel a of fig 1 while in panel b a close up on the hindcast node used is shown in this study the node 230 i e point 000230 was considered among all the grid nodes in the mediterranean sea provided by the hindcast service of the department of civil chemical and environmental engineering of the university of genoa dicca www3 dicca unige it meteocean hindcast the wgs84 lon lat coordinates of point 000230 are 8 8707 44 3100 respectively at each hindcast node wind speed and direction and wave parameters data were reconstructed and validated over the 1979 2019 period at a hourly resolution the historical wind and wave data were computed using the weather research and forecasting skamarock et al 2008 and wavewatchiii models tolman et al 2009 respectively details on the development and validation of the hindcast data can be found in mentaschi et al 2013 2015 in particular this study used the 1979 2018 series of significant wave height h s mean period and direction t m and θ m respectively and zonal meridional wind velocity components u w and v w respectively the time series of the hindcast parameters considered in the present work are shown in fig s1 in the supplement note that at the time of the analysis the 2019 data were not available thus they were not taken into account the following sections present the methodology developed to group the time varying sea states at the investigated location first the general formulation of k means is briefly explained then it is shown how to set up the initial dataset to account for the time dependence of the variables considered and subsequently how to assess the performance of the clustering according to ce and w 2 finally a simple shortcut for the clustering of circular variables is discussed 2 2 k means algorithm the clustering of met ocean parameters is performed through the so called k means technique this is aimed at partitioning a n dimensional population into k sets clusters in order to minimize the overall intra cluster variance based on the euclidean distances between the elements of different sets macqueen et al 1967 to explain the work flow of k means reference is made to a data matrix x n v v denotes the number of variables of the problem while n is the total number of data available for each variable and may correspond to the number of observations or sampling intervals of a process the number of trials of an experiment etc given v arrays populated by n data x n v is built up as follows 1 x n v x 1 1 x 1 v x n 1 x n v first x n v has to be normalized column wise in a given space e g in the range 0 1 to be able to group variables characterized by different orders of magnitude after the scaling of the variables a target number of clusters is selected henceforth referred to as m at the first iteration the centroids say x m v 1 are randomly selected among the rows of x n v then each data i e each i th row of x i v i 1 n is assigned to its closest centroid 2 m i m min d i x i x m v 1 i 1 n m where m i denotes the centroid the i th data belongs to once the m groups are defined the new centroids x m v 2 are computed as the element by element means among the data belonging to each cluster 3 x m v 2 x i m j x i n j where n j is the number of elements assigned to the j th cluster and spans the 1 n m interval the algorithm ends when the clusters assignment do not change between two successive iterations as the centroids are updated after each iteration according to eq 3 the convergence criteria imply that the centroids are not changing between two successive iterations 2 3 set up of the initial dataset in the example of eq 1 the overall data sample to be fed into the k means algorithm is defined by stacking column wise the original arrays of the investigated parameters then the clustering of the dataset obtained allows to select m significant subsets defined by as many rows of x n v note that in this case the selected subsets i e the scenarios are computed as the means of single instants among the initial time series of data if time varying scenarios need to be selected the input data have to be first reorganized in order to take into account their evolution in time according to the approach proposed in bárcena et al 2015 and núñez et al 2019 it is first required to fix the reference time frame of the problem which should be selected according to the problem under investigation for example in case of sea states modelling one day may suffice if the goal of the clustering is to describe severe storms at least in the mediterranean sea whereas model of pollutants dispersion would require longer windows e g one week or even more secondly the long term series of the variables under investigation can be arranged in sub series of given length for a single variable x defined n t the number of time steps of the reference time frame the array of x can be expressed as 4 x j t x i δ t 1 n t i δ t i 0 n n t δ t j i 1 where δ t is the shift between two successive time frames i e the number of elapsed time steps between the initial points of the x t rows the colon in the subscript of the left hand side of the equation denotes the whole length of the array i e from the first to its nt t h element eq 4 results in a number of matrices equal to v and the overall matrix say x n v t is constructed by adding at a time the matrices related to the single variables of the problem 5 x n v t x j t 1 x j t v 2 4 clustering of time series and selection of time varying scenarios in the present work the cluster analysis is performed through the k means applied on matrices built up as x n v t variables are centred and scaled in a space to mean 0 and standard deviation 1 and the centroids are first initialized through the maximum dissimilarity algorithm for reproducibility note that in this case the rows of the matrix in eq 5 do no longer refer to single instants but to n t long time slices hence the centroids are made in turn of the means computed column wise over the n t v elements of the arrays belonging to each cluster in the case test presented further on the text the arrays closest to the centroids will be considered as the time varying scenarios of the respective clusters according to the above mentioned example the number of columns of the initial dataset is therefore equal to n t v while the number of rows is equal to n n t the selection of the scenarios requires to set the number of clusters the initial data will be grouped into this can be chosen subjectively as an instance if the data are known to occur in particular modes or they need to be assigned to a given number of classes however if m is not known a priori a sensitivity analysis should be performed either by looking at the clustering outcomes de leo et al 2020 or relying on specific indexes that allow to select the optimal number of clusters bárcena et al 2015 employed a statistical index proposed by nash and sutcliffe 1970 referred to as ce which reads 6 c e 1 i 1 n r i s i 2 r i r 2 where r i and s i denote the i t h real and synthetic series respectively this index requires to split the initial data into a training dataset used to select the scenarios and a validation dataset left out from the clustering analysis and used at a second time to assess the reliability of the scenarios identified s is constructed by replacing the original time series of the validation set with the scenarios that best approximate them in other words given the validation dataset containing the real time series of data each reference time frame is replaced by the centroid of the cluster it would belong to according to eq 2 the ce index expresses the difference between the variance computed with the synthetic centroids and the measured data variance and spans the 1 range the former and the latter limits indicating the worst and best performances of the clustering model respectively in particular if ce is lower than 0 5 the clustering method is considered unacceptable meaning that the reduced number of states does not efficiently describe the overall variance of the system on the other hand the clustering starts to be convenient when ce attains values between 0 5 and 0 6 while it provides good and excellent performances for values of ce between 0 6 and 0 8 and higher than 0 8 respectively bárcena et al 2015 as such different number of clusters may be deemed appropriate according to the desired performance of the method i e convenient good excellent previous research took also advantage of the total variance of the system resulting from the clustering of the data solari and alonso 2017 this is expressed as wilks 2011 7 w 2 1 n i 1 m j 1 m j x j x i 2 n being the total number of states and m j the number of elements belonging to the j th cluster x j denotes a single state among the m j belonging to the j th cluster whereas x i is the respective i th centroid the number of clusters is said to be optimal when to increase m does not lead to significant reductions of w 2 in this work ce is used to assess the clustering performance on time series of met ocean variables at point 000230 for different sets of the initial conditions of the data in particular we vary at a time the number of years of the training and validation periods of the k means the length of the reference time frame i e n t the time shift between successive time frames i e δ t the resolution in time of the initial datasets and the number of variables employed for each combination of these factors we test different number of clusters computing ce to identify for each case the minimum number of clusters required for the scenarios to exhaustively represent the initial dataset according to ce then w 2 is computed for the same sets and tested number of clusters and the optimal number of clusters is assessed through the so called elbow rule details are provided in section 3 1 subsequently the number of clusters computed with the different indexes is compared and discussed finally with respect to a particular set up of the initial dataset we assess whether the optimal scenarios computed are able to describe the climate variability of wave and wind fields for the investigated area 2 5 clustering of circular variables whenever the dataset to be modelled includes circular variables the discontinuities in the variable space have to be accounted for as an instance two waves moving south might be characterized either by θ m equal to 0 or 360 according to the nautical convention if only the raw directions were considered the former wave would be closer to a target wave west oriented while the latter would be closer to a target wave east oriented θ m being equal to 90 and 270 respectively though the input data refer to the same direction to overcome this issue a correction is usually applied directly on the difference computed between circular features so that the distance between single elements spans the π π range at most camus et al 2011b mentaschi et al 2015 however if built in functions of given programming languages not accounting for such correction are meant to be used an equivalent approach can be employed instead of modifying the computation of the distance between two circular variables the latter can be expressed in cartesian coordinates secondly applying the cluster analysis directly on the projected components still resorting to the instance of wave directions θ m can be projected along the east north axis as follows 8 θ m x cos θ m 90 θ m y sin θ m 90 the correction on the arguments of the sinusoidal functions is needed for the zonal meridional components to be consistent with the nautical convention indeed both the components are positives negatives in the third first quadrant whereas they are discordant in the second and the fourth quadrants the clustering can be then performed directly on the cartesian components of θ m which are now continuously defined in the real space a practical example on the clustering of circular variables is introduced and discussed in the supplement 3 results discussion 3 1 optimal number of clusters due to the selection of the initial dataset the examples presented in this section allow to evaluate how the selection of the starting dataset may affect the number of required scenarios defined according to ce as explained in section 2 4 this index quantifies to what extent the scenarios selected from a training dataset are able to reproduce a dataset used to validate the clustering model an analysis on a simplified case was first carried out to test the reliability of the algorithms developed to this end one year of h s data were clustered setting a number of clusters m equal to the number of input data n and using the input time series both for training and validating the k means under such conditions ce and w 2 attained values equal to 1 and 0 respectively thus proving the corrected implementation of the algorithms results not shown for the sake of brevity the results hereon introduced refer instead to different sets of the clustering initial conditions and varying number of clusters from 2 to 300 in all the cases presented excepted the last three the clustering is performed considering a single variable h s each set is identified through a number recalled in table 1 the optimal number of clusters is referred to as m o first it is investigated how ce varies depending on the periods defined to train the k means analysis and for the subsequent validation of the model sets 1 2 and 3 to this end a time frame of one week is fixed resulting in n t 168 being data hourly defined δ t is equal to one day leading to 24 time steps the training dataset is developed according to eq 4 on the h s series defined over 10 20 and 30 years at a time accordingly the validation of the model through the ce index is performed over 30 20 and 10 years respectively since the data span the 1979 2018 period 40 years precisely results are presented in fig 2 first looking at the curves of ce a slight noise can be seen for values of m between 45 and 175 this is due to the increasingly wider increments between successive number of clusters tested indeed during the iteration process m was increased at a time by 2 5 25 and 50 for values of m up to 10 50 200 and 300 clusters respectively similar oscillations can be spotted also in the curves related to different sets and presented further on the text however these oscillations are negligible and do not affect the resulting quality of the clustering according to ce it can be noticed how the curves almost overlap for low number of clusters starting to slightly diverge when m is approximately equal to 30 even though the curves lie close to each other good performances of the model are detected for number of clusters significantly different in the three cases indeed the clustering of the data starts to be convenient for m equal to 158 116 88 in case of training validation performed over 10 30 20 20 and 30 10 years respectively ce never provides excellent results looking at these results one may conclude that to split the initial dataset over different periods for the selection of scenarios may strongly affect the outcomes of the clustering however a closer inspection on the ce vs m profiles reveals how these are characterized by very similar shapes and upper limits that is to vary the periods of training validation of k means technique does not really play a key role in the cluster analysis this is most likely due to the high resolution in time that characterizes the dataset at hand with long time series continuously defined and no dramatic variations in the data taking place from one year to another therefore the differences in the resulting m o are to be explained because of the slight variations in the slopes of the ce curves which tend gently to their respective asymptotic values in the following cases the clustering of the data is trained over the 1979 2008 period and validated over the 2009 2018 decade first a series of analysis concerning the time settings of the initial database is carried out results are reported in fig 3 initially it is evaluated the influence of δ t on the estimates of ce sets 3 4 5 6 in table 1 this analysis still relies on a one week long time frame and hourly defined h s data while the shift between the referring series is varied among 6 12 24 72 h results are shown in panel a of fig 3 also in this case the model does not reach the best allowable performance and no relevant differences arise between the curves related to δ t equal to 6 12 and 24 h in fact ce attains g o o d values for 70 74 and 88 clusters respectively nevertheless when δ t is equal to 72 h 128 clusters are needed to comply with the ce requirements i e to get g o o d performances of the clustering apparently in this case a shift of three days between two frames implies a relevant loss of information as significant sea states in the thyrranean sea typically arise and expire in less than a day budillon et al 2006 second the sensitivity analysis on ce is performed against the resolution in time of the h s data as shown in panel b of fig 3 the reference window and δ t are one week and 24 h long respectively and the sampling resolution referred to as d t is varied among 1 3 6 and 12 h no remarkable differences arise in the ce estimates related to d t in between 1 3 and 6 h with 88 80 and 78 clusters needed to attain good performances sets 3 7 and 8 respectively however results prove that a coarser time resolution of the initial data leads to a significant improvement of the clustering analysis since only 44 clusters would be taken into account for d t equals 12 h set 9 as a matter of fact when d t is equal to 1 h and the reference time frame is fixed to one week the number of resulting columns for r and s is 168 an increase of d t lowers in turn the number of columns of these matrices in the aforementioned examples d t equal 3 6 and 12 h lead to dataset made up of 56 28 and 14 columns respectively therefore the scenarios are populated by a lower number of elements and are more representative of the elements belonging to the relative cluster i e the sum of the differences between r i and s i in eq 6 is on average reduced the aforementioned consideration is further confirmed by the results related to varying lengths of the reference time frame this can be noticed by looking at panel c of fig 3 showing the dependence of ce with respect to n t for initial data hourly defined and δ t equal to 12 h in this case a significant improvement for the clustering analysis can be appreciated with excellent performances attained for n t equal to 24 and 72 sets 10 and 11 respectively in the former case 10 clusters are enough to observe the best ce condition while in the latter case 164 clusters would be needed when n t is equal to 168 the model reaches good performances at most set 5 the results so far introduced show that the dimension of the matrix used for the cluster analysis deeply affects the computation of m 0 according to ce indeed the value of n t affects the number of columns of the matrix see eqs 4 and 5 this can be also appreciated when the number of variables v of the problem is varied set 10 and sets from 12 to 14 as shown in fig 4 here the curves of ce are computed by adding at a time the time series of t m θ m and wind speed to the time series of h s this analysis refers to a time frame of 24 h with a hourly time resolution i e n t 24 and d t 1 and δ t 12 h in this case excellent conditions are attained when h s 10 clusters and h s t m 42 clusters are taken into account when further variables are considered the clustering model shows good performances at most with an optimal number of clusters equal to 26 and 144 if θ m set 13 and u w set 14 are added to the analysis respectively note that when the direction of waves is considered the k means takes advantage of the algorithm introduced in section 2 5 it should mentioned that in the examples previously introduced there was no need to scale h s indeed the clustering was performed on a single variable which is by definition scaled in its own range on the contrary in the last three sets several parameters with different magnitudes were combined into the starting dataset in these cases x n v was therefore normalized column wise by centring and scaling all the variables employed results for all the tested sets are summarized in table 1 by looking at the outcomes of m o it is clear that the dimension of the dataset to be modelled dramatically affects the number of clusters needed to comply with the ce requirements this is due to the fact that the differences in eq 6 are pairwise computed between two sets of data i e the real series of a validation matrix and the synthetic series made of the scenarios resulting from the k means analysis to increase the number of elements of r i and s i that is the number of columns of x n v t increases in turn the dispersion of the single states around their respective centroids resulting in lower values of ce this can be particularly appreciated by comparing m o for increasing n t and fixed δ t and d t as shown for sets 10 11 and 5 similarly sets 10 12 13 and 14 show how increasing numbers of variables reflect on decreasing performances of the clustering method even though a lower value of m o characterizes set 13 with respect to set 12 in the former case the best performance is good while in the latter is excellent on the other hand when the sensitivity of m o with respect to other parameters is evaluated the number of columns of x n v t is not varying as much as for varying numbers of n t and tested variables thus the differences in the clustering outcomes are less relevant the index proposed by nash and sutcliffe 1970 has the undoubted advantage of possibly providing a unique result for m o given that the required performances of the clustering method are fixed on the contrary other methods may leave more room for subjective evaluations of the analyst as an instance if w 2 is taken into account the optimal number of clusters should be selected in correspondence of a significant change of slope in the w 2 curve i e on the intersection of the straight lines best fitting the two branches of the hyperbole the so called elbow rule however in many cases it is not easy to define exactly where this condition takes place and it might be necessary to couple w 2 with other metrics in this respect the following figures combine the information related to ce and w 2 for all the sets previously introduced note that the values of w 2 are scaled in the 0 1 range as the original dimension is not relevant the statistic is computed on time series of several variables centred and scaled needless to say this does not affect the assessment of the elbow location in the former case values of m o related to good performances of ce are highlighted with circles first results related to varying periods of training validation of the clustering algorithm are shown in fig 5 in this case it can be noticed how ce provides more conservative results with respect to w 2 even though no excellent conditions are reached according to ce m o values fall beyond the change of slope in the respective w 2 curve for all the sets considered the same condition occurs with respect to varying δ t panel a of fig 6 and d t except when this is equal to 12 h set 9 in this latter case the two metrics seem to provide consistent results panel b of fig 6 as for n t in case of a week long time frame the values of m o driven by ce would still be higher than that following the w 2 analysis on the contrary for short time windows sets 10 and 11 when good performances are taken into account ce leads to values of m o considerably lower than those resulting from w 2 as shown in panel c of fig 6 as for the number of variables employed if good performances of the clustering according to ce are considered m o results to be more conservative in case all the variables are fed into the clustering analysis set 14 while to rely on w 2 would yield higher number of clusters if either both h s and t m set 12 or just h s set 10 were considered ce and w 2 provide instead similar results when three variables are taken into account see fig 7 finally when e x c e l l e n t conditions of ce are considered ce estimates of m o result to be either higher consistent or lower than the ones resulting from the w 2 curves in case of set 11 set 12 and set 10 respectively reference is made to fig 8 highlighting m o s related to ce with a star from the results so far introduced it is clear that the selection of the number of clusters to be retained neither comes with ease nor it should be treated lightly as different statistical indicators may provide in turn different estimates of m 0 moreover the initialization of the starting dataset should be performed according to the physics of the problem under investigation for example both a coarse time resolution of the initial data or a short reference time frame may allow ce to attain excellent values or a well defined break point for the w 2 curve nevertheless as far as met ocean variables are concerned such conditions may not be suitable if wave induced processes occurring over short time scales or beach profile variations induced by long shore sediment transport occurring over long time scales were meant to be characterized 3 2 case study this section shows the results of k means data selection on the hindcast data defined at point 000230 see fig 1 the scope of the analysis is to identify a reduced number of significant wind and sea states able to properly detect the variations of the met ocean climate in front of the genoa coastline from the analysis of fig 9 it can be appreciated how the waves in front of genoa propagate from three main directions n nw sw s s se it is worth recalling that the wave direction is defined according to the nautical convention thus θ m refers to the direction the wave is coming from as accordingly do the bins of the polar plot as regards the wind this is found to be remarkably correlated with the waves parameters the correlation between wind speed and h s t m is computed through the spearman s ρ coefficient which yields some advantages with respect to other common indexes de michele et al 2007 as for the directions the correlation is computed through the index proposed by jammalamadaka and sengupta 2001 which reads 9 r i sin θ m i θ m sin θ w n d i θ w n d i sin 2 θ m i θ m sin 2 θ w n d i θ w n d where θ w n d denotes the wind incoming direction and the top bar denote the circular mean in this case the correlation is computed on the exceedances of increasing h s thresholds referred to as h t h and 1 year long time slices to evaluate if the sought correlation depends on to the energy content of the sea states results are shown in table 2 and fig 10 and highlight how the directions of waves and wind referred to as θ w n d are generally expected to be consistent especially in case of severe sea states the characterization of the local wave climate takes advantage of h s t m θ m and u w stacked together and clustered for the 1979 2008 period thus leaving ten years for the validation of the results in this case first n t is selected according to the auto correlation function acf of h s taken as the lead parameter acf is computed shifting the initial step of one lag at a time and considering a total number of 168 lags i e one week for data hourly outputted like the hindcast ones at a second time given the series of acf values for a week long window over the whole 1979 2018 period the values for each lag are averaged results are reported in fig 11 showing that acf attains negligible values on the 26th lag i e the 25th hour as indicated by the green line the analysis of the acf of h s reveals that a typical sea state pattern at point 000230 lasts for about a day thus the time scale of the problem is set equal precisely to one day 24 h as a first attempt the time resolution d t is set equal to 6 hours while this choice allows to have a matrix easier to handle i e with reduced dimensions it is reasonable to assume that such resolution does not yield loss of relevant information between successive instants of the time series given the slow inertia of the wind sea system finally δ t is fixed to 12 h that is the duration characterizing the majority of the most energetic sea states occurring in the investigated area for all the prevailing wave directions this can be appreciated looking at the frequency plots of fig 12 showing the peaks and duration of the sea storms at point 000230 computed through the peak over threshold pot approach and three directional sectors n se and sw in this case storms were declustered starting from the exceedances of h s above the 98th percentile of their initial distribution and considering an inter event duration of 12 h details on the pot data selection can be found in lang et al 1999 given the initial set of the problem a sensitivity analysis on varying number of clusters is performed according to the methodology introduced in section 2 4 results are presented in figs 13 and 14 first of all it is worth pointing out how for a given number of tested clusters several values of ce can be computed indeed according to the notation so far introduced the validation is performed over s and r which are two matrices with n t columns in case of r the first element of each column is shifted of d t from the previous element and each column spans the whole length of the validation period but a time frame that depends on the initial step n t and δ t thanks to this method summarized by eq 5 the clustering of the data does not depend on the choice of the initial time step within the time series since all the possible ones within the initial frame made of n t data are spanned therefore each column leads to a value of ce and the series obtained can be following averaged among the n t values in case the windows do not overlap with each other a unique value of ce follows the k mean validation an example of such a case can be found in bárcena et al 2015 panel b of fig 13 shows how the mean turns out to be more significant for high number of clusters since the uncertainty on the ce estimates is lowered the analysis of ce and w 2 panel a of figs 13 and 14 respectively reveals that in this case a number of 55 clusters ad as many scenarios would be reasonable according to both the indexes in this case 53 iterations were needed for the k means to converge the analysis of the clusters size reveals that each cluster contains on average 400 time series with a standard deviation equal to approximately 210 elements the cluster more populated counts 1183 data while the smallest one only has 88 clusters this variability is due to the different met ocean states represented by the clusters with those related to the most intense states being less populated on the other hand the centroids of the bigger clusters account for mild wind and sea states which being far more frequent can be assimilated to the vast majority of the time series analysed fig 15 shows the profiles of h s and θ m for some of the scenarios that best represent the three prevailing fetches in front of genoa with waves moving northeast θ m 180 n panels a and b waves moving northwest θ m 180 n panels c and d and waves moving south θ m 0 360 n panels e and f the panels show both the scenarios selected over time series coarser in time than the total data the black curves and the correspondent time slices related to the original data hourly defined colour scaled scatters for each of the three fetches considered profiles indicating both mild and severe wave conditions are shown from the analysis of the h s profiles it can be noticed how a 24 h long time frame is able to describe scenarios belonging to each of the aforementioned fetches with no significant changes in the average incoming direction of waves other scenarios are representative instead of more varying conditions data not shown for the sake of brevity moreover retaining one data every six hours does not affect the reliability of the resulting scenarios as the hourly defined data are not significantly scattered around their profiles this consideration particularly applies in case of low h s but holds as well when more energetic states are taken into account finally fig 16 shows the wind profiles corresponding to the scenarios reported in fig 15 in this case the initial data are more dispersed with respect to the mean synthetic profiles because the wind speeds of the hindcast refer to single instants and are therefore more irregular comparing to the wave parameters that are computed from directional spectra of sea states of given length details on the computation of the hindcast parameters and the computational time steps of the models employed can be found in tolman et al 2016 mentaschi et al 2013 respectively in conclusion as far as θ w n d is concerned it can be noticed how in case of severe sea states wind and waves are similarly oriented consistent with the results reported in fig 10 in such a case the wind inflates energy into the sea surface and directly contributes to increase h s while this effect is lowered in case of mild sea states panels b d and f of fig 16 respectively the correlation pointed out between wind and wave data is to be related to the exposure of the ligurian coastline characterized by short fetches with the exception of the sw direction therefore the generation of long swell waves is limited independently from the occurrence of any wind generated waves 4 final remarks the selection of significant scenarios of geo physical variables can be helpful for a plethora of applications as far as met ocean forcing is concerned the hydrodynamic modelling of sea states might not be feasible if long term series of data are meant to be investigated mainly due to the computational cost requirements to overcome such difficulties it might be convenient to identify a reduced number of representative scenarios through clustering techniques in this respect this paper reviews and discusses a methodology to select time varying scenarios from 40 years of hindcast data through the k means technique in particular it is shown how the selection of an optimal number of scenarios referred to as m o according to k means is not straightforward by comparing the values of m o according to ce and w 2 two indexes commonly employed within the clustering analysis framework first it is shown how the values of ce and w 2 strongly depend on the initial conditions of the investigated dataset indeed the values of m o increase according to the dimension of the arrays to be clustered which depend on the length of the reference time frame the number of variables employed and their time resolution also the time shift between successive time frames δ t is proved to be relevant thus it should be selected according to the time scales of the processes investigated second it is shown how the values of m o following the two methods are not always consistent and in particular w 2 provides more conservative results with respect to ce i e it leads on average to a higher number of required clusters besides it must be mentioned that other methods to validate the clustering of the data may be employed e g the so called silhouette method kaufman and rousseeuw 2009 the dunn index dunn 1973 or the davies bouldin index davies and bouldin 1979 as such care should be given when selecting the number of clusters for the application at hand and the clustering method adopted finally a practical application for a hindcast node in front of the ligurian coastline is presented here it is shown that when the initial setting of the data is performed by taking into account the timescales of the investigated processes the computation of m o might be facilitated and the resulting scenarios are able to efficiently describe the wind and waves climate variability with respect to the input data even though the hindcast data have been thoroughly validated it would be interesting to see how the classification of the sea states would change if observed i e real time series were employed and this opens the way for future researches declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was developed in the framework of the interreg italia francia marittimo projects splash 1 1 http interreg maritime eu web splash stop alle plastiche in h20 grant number d31i18000620007 geremia 2 2 http interreg maritime eu web geremia gestione dei reflui per il miglioramento delle acque portuali grant number d41i18000600005 and sinapsi 3 3 http interreg maritime eu web sinapsi assistenza alla navigazione per l accesso ai porti in sicurezza grant number d64i18000160007 authors would like to deeply acknowledge prof alessandro verri and prof carlo ciliberto for their invaluable suggestions during the development of the research the computational codes have been developed in matlab environment and are available upon request taking advantage of the statistics and machine learning toolbox note that the maximum number of iterations was bumped up to 1000 to ensure that the code was always able to converge all the codes developed are available upon request please contact giulia cremonini at giulia cremonini edu unige it the results for ce and w2 are available for download at genoa research data management repository doi https doi org 10 5281 zenodo 4117656 appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2021 101819 appendix a supplementary data the following is the supplementary material related to this article mmc s1 the supplementary material reports the additional results that for the sake of brevity could not been included in the main manuscript 
23902,wave bottom reflection induced by a changing bathymetry has a major impact on the near shore environment where harbors and other infrastructure are based however this reflection is only partially accounted for in large scale numerical wave prediction models the present work implements the analytical bottom reflection source term derived in yevnin and toledo 2018 to wavewatch iii a numerical prediction model based on the wave action equation the new source terms reflection coefficient magnitude reflection direction and directional spread are shown to produce good results with respect to analytical and numerical solutions and are tested in a real world example the new term allows to better simulate the near shore environment especially near islands reefs semi enclosed basins or natural beaches with long mild slopes where the directional changes can cause previously unaccounted for effects keywords bottom reflection wind waves wave action equation wavewatch wave directional scheme 1 introduction wave reflection from the sea bottom coastline or submerged obstacles can have a profound impact on wave behavior in coastal waters and even in deep water see for example o reilly et al 1999 in the near shore area it can for example cause harbor agitation as waves reflect from nearby bathymetry in different directions penetrating bays and harbors which may cause serious damage to ships and infrastructure see mei et al 2005 tobias and stiassnie 2011 for harbor agitation and shelf edge respectively it can also cause unaccounted for wavefields around islands as waves could be reflected and even trapped by changing bathymetry liu et al 2004 in deep water it can cause nonlinear triad interactions leading to infragravity waves and secondary peaks which are not yet accounted for in numerical forecasting models for forward propagating waves see vrećica and toledo 2016 vrećica et al 2019 wave reflection and refraction is caused when waves propagate over a changing bathymetry where part of the wave energy is transmitted forward and some of the energy is reflected off the sea bottom meyer 1979 the magnitude of reflection is affected by the bottom depth and slope and by the wave period height and direction all of which can change locally investigations of such reflection have shown it could have up to 40 wave action reflected at steep cliffs o reilly et al 1999 but more commonly around 5 10 reflection over natural beaches tatavarti et al 1988 elgar et al 1994 few studies have been done on the directional effect of such reflections due to the difficulty of measuring wave reflection and separating it from general wave propagation in the chaotic coastal environment the effects of these reflections can be sensed mostly by examining directional spread kuik et al 1988 differences of models and measurement devices as suggested in ardhuin and roland 2012 two wave reflection source terms were introduced into wave forecasting models such as wavewatch iii tolman 1991 and swan booij et al 1999 the first presented in ardhuin and magne 2007 and based on ardhuin and herbers 2002 and magne et al 2005 was designed for sub grid topography undulations the second aims to recover the reflected wave action of shoaling waves this source term was presented in ardhuin and roland 2012 where wave action reflection is calculated at the coastline this approach is somewhat limited for example in cases where submerged obstacles are present or when the topography is close to the water surface but does not reach land another limiting factor is the reflection coefficient that has to be calibrated to achieve good results this is very difficult since as stated above measuring wave reflection directly is complicated the source term for coastal reflection used in wavewatch iii ww3 was derived in ardhuin and roland 2012 here referred to as ref1 as 1 n r e f u n s t f θ 0 2 π r 2 f θ θ n f θ d θ where n r e f u n s t is the source term for unstructured grid r 2 is the energy reflection coefficient n is the wave action directional spectrum f is the wave frequency θ is the incident direction and θ is the reflection direction the reflection coefficient has been based on the miche number empirically related to the bottom slope the deep water wave height and the wave frequency miche 1951 this source term is currently used by several wave forecasting models as an optional term to account for wave reflection the reflection can be locally calculated automatically through the miche number although it was suggested that this could be sensitive to bathymetric grid coarseness and the resolution of the shoreface slope for this reason it was suggested by the original authors that a manually set model wide constant reflection coefficient be used if the shoreface slope cannot be otherwise simulated furthermore this source term relies only on land based reflection and the coastline shape and direction straight oblique or sharp angle this means shallow water without adjacent land in the model does not produce any reflected waves in yevnin and toledo 2018 a steady state analytical term for bottom reflection was introduced as 2 ξ k ξ k c g n r e f i k ξ ξ 2 k ξ 2 c g n i n k e 4 i k ξ d ξ where n r e f is the reflected wave action directional spectrum i is the imaginary unit ξ is the bottom gradient direction k and k ξ are the wavenumber and wavenumber in the ξ direction respectively c g is the group velocity and n i n is the incident wave action directional spectrum it was based on a perturbation analysis and a wkb approximation of the mild slope equation see berkhoff 1972 booij 1983 and assumed no changes in time steady state it accounts for varying bottom slopes wave periods and oblique incident angles the source term was compared with the ref1 source term and showed more accurate results reaching even into the infragravity wave range under mild slope assumptions for further details see yevnin and toledo 2018 in this paper an implementation of the analytical source term to ww3 is presented followed by testing and verification the paper is structured as follows in section 2 the source term is extended to account for the time derivative of the wave action thus more accurate and better fitting for implementation in section 3 a new directional scheme for the local coordinate system used in the source term is formulated and explained the reflection source term implementation in ww3 is tested in section 4 finally in section 5 the work is summarized and discussed 2 reflection source term derivation eq 2 is the bottom reflection expression derived in yevnin and toledo 2018 it was derived assuming steady state conditions and is derived here for time dependent conditions in order to implement it as a robust source term to this end the mild slope equation was taken similar to kirby 1984 neglecting the current and keeping the time derivative 3 2 ϕ t 2 c c g ϕ σ 2 k 2 c c g ϕ 0 where ϕ is the velocity potential t is time is the horizontal gradient operator c is the phase velocity c g is the group velocity and k is the wave number which can be derived through the dispersion relation with a relation to σ and h x y the frequency and bottom profile accordingly the derivation ahead follows that of yevnin and toledo 2018 closely the oblique parabolic approximation can be shown to be 4 ϕ ξ i k ξ 1 2 k ξ k ξ ξ ϕ 1 2 k ξ k ξ ξ ϕ ˆ i 2 k ξ c c g 1 2 2 c c g 1 2 ϕ ϕ t 2 i c c g 1 2 k ξ σ 2 ϕ ϕ where ξ is assumed to be oriented in the direction of the bottom gradient with the corresponding wavenumber k ξ and i being the imaginary unit the velocity potential was transformed to ϕ c c g 1 2 ϕ x e i k 2 y assuming a quasi 2 dimensional model and the superscript relates to the transmitted and reflected components of the field using the relation of the mean water surface level η to the velocity potential ϕ x t c c g 1 2 g i σ η x t and assuming a small reflection a similar wkb perturbation process results with 5 ξ c c g η 0 i k ξ 1 2 k ξ k ξ ξ c c g η 0 i 2 k ξ c c g 1 2 2 η 0 t 2 i 2 k ξ σ 2 c c g 1 2 η 0 0 6 ξ c c g η 1 i k ξ 1 2 k ξ k ξ ξ c c g η 1 i 2 k ξ c c g 1 2 2 η 1 t 2 i 2 k ξ σ 2 c c g 1 2 η 1 1 2 k ξ k ξ ξ c c g η 0 i 2 k ξ c c g 1 2 2 η 0 t 2 i 2 k ξ σ 2 c c g 1 2 η 0 where the subscript 0 1 are the zero and first order approximations see yevnin and toledo 2018 section 3 for further details it is noted this result is similar to that of yevnin and toledo 2018 with two additional terms on each side accounting for the time derivatives at this point η can be assumed to be composite of a slowly varying component η and a fast oscillating function see mei et al 2005 chapter 3 1 7 η 0 1 η 0 1 ϵ ξ ϵ t e i ψ ψ ξ k ξ d ξ σ t using the definition of wave action n e ω 1 2 ρ g η 2 σ and applying eqs 7 to 5 the o ϵ yields the quasi 2d wave action equation 8 ξ k ξ k c g n 0 n 0 t 0 where n 0 is the zero order wave action the reflection source term can be derived by applying the same procedure to eq 6 taking again the o ϵ resulting with 9 2 k ξ ξ c c g η 1 k ξ ξ c c g η 1 2 σ c c g 1 2 η 1 t k ξ ξ c c g η 0 e 2 i k 1 d x 2 σ c c g 1 2 η 0 t e 2 i k ξ d ξ multiplying by c c g η 1 it can be transformed to 10 ξ k ξ c c g η 1 2 σ η 1 2 t k ξ ξ c c g η 0 η 1 e 2 i k ξ d ξ 2 σ η 1 η 0 t e 2 i k ξ d ξ eq 10 can be expressed in the form of wave action 11 ξ k ξ k c g n 1 n 1 t k ξ ξ c g k n 0 n 0 t κ r e 2 i k ξ d ξ where κ r η 1 η 0 is the reflection coefficient note that a change of κ r in time without a change in space is by definition zero as reflection is zero for a flat bathymetry thus κ r in the leading order can be defined by steady state solution to this end eq 11 is compared to previously derived steady state solution in eq 2 12 ξ k ξ k c g n 1 k ξ ξ c g k n 0 κ r e 2 i k ξ d ξ i k ξ ξ 2 k ξ 2 c g n 0 k e 4 i k ξ d ξ yielding the solution κ r i 4 k ξ 2 k ξ ξ e 2 i k ξ d ξ finally the solution is 13 ξ k ξ k c g n 1 n 1 t i k ξ ξ c g k n 0 n 0 t k ξ ξ 1 4 k ξ 2 e 4 i k 1 d x this is the first main finding of this paper as it extends the derivation given in yevnin and toledo 2018 to the cases of growing or decaying seas note that the left hand side has a minus sign as it stands for reflected waves for implantation in phase averaged numerical forecasting models komen et al 1996 the spatial phase of eq 13 is averaged out then the commonly used splitting method see tolman and booij 1998 tolman 1991 to separate the spatial intra spectral and source term integration is applied practically resulting with neglecting the spatial derivative on the left hand side the resulting bottom reflection source term s b r e f takes the form 14 n r e f t s b r e f k ξ ξ c g k n i n n i n t k ξ ξ 1 4 k ξ 2 it provides the reflection source term in formulation fitting for implementation in a wave action based model the source term is the first order correction to the incident wave action providing the magnitude of the added action as a result of bottom reflection 3 directional scheme for local slope gradient oriented coordinate system wave reflection due to bathymetric changes is axisymmetric with regards to the slope bottom depth gradient h direction ξ see fig 1a this means an incident wave induces a reflected wave with the same projection on the ζ axis perpendicular to the slope and a projection with the same magnitude and a reversed direction on the ξ axis for locally linear sloping bottom numerical models are using a finite number of bins to represent the spectral direction an example of incident and reflected directions in bin format can be seen in fig 1b for 24 directional bins with a slope in the direction of bin 19 south this example can be generalized to be used with any number of bins and any bottom gradient direction a pseudo algorithm can produce such directional scheme as follows 1 the bin in the direction of ζ induces reflection to the same bin number as there is no reflection in the ζ direction bin 13 in the given example 2 the rest of the reflection bin numbers will rise in a clockwise manner from the first bin bins 14 24 and 1 12 in the given example this remains the same for all frequency bins mathematically this takes the form 15 b r e f b r e f 0 b c o r b r e f 0 2 b ξ b m a x 2 b i n where b r e f is the bin of the reflected wave 5 in the given example b ξ is the bin of the bottom gradient e g 19 b m a x is the number of directions e g 24 b i n is the bin of the incident wave e g 21 and b c o r is a correction factor accounting for the directional periodicity and is equal to 16 b c o r 2 b m a x b r e f 0 b m a x b m a x b m a x b r e f 0 1 b m a x b r e f 0 b m a x 0 e l s e in the numerical model this gradient oriented coordinate system has to be locally calculated for each grid node during the model definition phase as the slope direction can change even in relatively short distances most numerical models use a north east coordinate system and model derivatives are calculated in this coordinate system changing the coordinate to a local direction requires calculating the wavenumbers vector k ξ k ζ and derivatives in the new local system the wavenumbers vector components can be written as 17 k ξ k cos θ ξ k ζ k sin θ ξ where θ ξ is the angle between the bottom gradient direction and the wave direction the wavenumbers ξ derivative can be simplified by using the chain rule to yield 18 k ξ ξ k ξ x x ξ k ξ y y ξ the coordinate system change dictates that 19 x ξ cos θ s l p y ξ sin θ s l p where θ s l p is the angle between the x axis and the bottom gradient direction applying eqs 17 and 19 to eq 18 results in 20 k ξ ξ k x cos θ s l p k y sin θ s l p cos θ ξ finally the north east wavenumber gradient can be solved by using the depth gradient making it more computationally efficient this is done again through the chain rule 21 k x k h h x k y k h h y where h is the bottom depth and the derivative of the dispersion relation is 22 k h 2 k 2 2 k h sinh 2 k h 2 k 2 sinh 2 k h c c g here c g is the group velocity and c is the phase velocity this new directional scheme is the second main product of this work it lays the groundwork for the bottom reflection source term as well as for other source terms which can take advantage of a slope oriented coordinate system such as those presented in vrećica and toledo 2016 and vrećica et al 2019 4 numerical simulations in this section numerical simulations using the new source term are compared to several test cases the derived source term in eq 14 and the directional scheme were implemented to wavewatch iii v5 16 ww3 for unstructured grids these grids provide versatility in element size allowing for deep and shallow water elements of different sizes leading to more accurate bathymetry representation and more efficient resource allocation 4 1 monochromatic wave shoaling over a piecewise linear bathymetry the first test case chosen was a simple piecewise linear bathymetry shown in the top part of fig 2a it consisted of two plateaus one in deep water k h 3 and the other in shallow water k h 0 2 connected by a uniform unidirectional slope the slope was defined as 23 β f h ξ and the values tested were β f 0 1 and β f 0 2 for the numerical model a 5000 m by 2000 m grid was designed where the slope was in the x direction and the y direction was uniform with no changes it was compared to the magnitude of the solution of berkhoff s mild slope equation solved by wolfram mathematica v11 0 ndsolve function a boundary condition of a known incident wave at x 0 was set in both models to allow reflection transparent wavemaker the mild slope model mse was also set with a no reflection boundary condition at the other end transmission only the reflection coefficient is defined as 24 κ r a r e f a i n e r e f e i n where a r e f and e r e f are the reflected wave amplitude and energy respectively and a i n and e i n are the incident wave amplitude and energy respectively the reflection coefficient was extracted from ww3 as energy spectra at the center of the y axis y 1000 m for x in intervals of 50 m the resulting reflection coefficient was linearly interpolated into a continuous function the numerical model was run with 24 directions which is a common directional resolution although less could have been used and 3 frequencies the required minimal number of frequencies as only monochromatic waves were used and the time step was set to δ t 1 s a comparison of the models reflection coefficients is shown in fig 2a for a wave of period t 10 s shoaling straight towards the shore additional periods were tested with consistent results and are thus not shown here during implementation a tuneable magnitude coefficient was added to the source term and was found to yield best results with a factor of b r s f a c 0 5 which was used in all following tests as well it can be seen that for both slopes tested the mse solution and ww3 model are in good general agreement for the β f 0 1 slope the ww3 reflection solution is somewhat stronger though both are of a similar scale of course the magnitude coefficient can be tuned to adjust the reflection to fit the local conditions and bathymetry to improve accuracy as necessary in the numerical solution some wave reflection can be seen beyond the end of the slope where no reflection should be present this numerical artifact happens as for the most part there are no nodes exactly where the slope should end as the reflection only ends where two adjacent nodes are at the same depth this causes the effect to be smeared reaching a little further than in the dense phase resolving mse model this effect can be easily minimized by using a finer grid tested not shown but it does raise the issue of grid coarseness it is recommended that areas of interest especially in shallow water be modeled with a resolution fine enough to match the local slope change rates the sensitivity to temporal resolution was evaluated using the β f 0 2 model the model was run with time steps δ t 1 5 10 20 30 60 s correlating to spatial advection cfl of c f x 0 3 1 5 3 6 9 18 in order to stress test the model even when the numerical propagation scheme has adversity c f x 1 fig 2b shows that changing the time step has a minimal impact on the reflection coefficient this is attributed the wave action time derivative extension in eq 14 the robustness of the source term holds even at the very large time step δ t 60 s c f x 18 and still performs in a similar manner and magnitude 4 2 monochromatic wave propagating over a submerged mound the second test case chosen was a long incident wave over a submerged mound based on the work of zhu and harun 2009 and niu and yu 2011 a flat bottom with a central hump was modeled using the depth function 25 h r h 0 r r 0 h 1 β m r α r r 0 where h r is the water depth h 0 is the maximal water depth h 1 is the minimal water depth r 0 is the radius of the mound and α and β m h 0 h 1 r 0 α are parameters which define the mound shape in niu and yu 2011 such a problem was solved analytically with the parameters h 0 4 8 m h 1 3 2 m r 0 90 3 m α 2 β m 1 9 k 0 h 0 0 167 t 0 26 4 s this bathymetry is not quasi 2 dimensional as was assumed during the source term derivation however within each grid element this assumption holds locally allowing to simulate the reflection through the complete solution the ww3 model used 48 directional bins and 3 frequencies and a time step of δ t 0 5 s the reflection coefficient κ r for a given wave elevation η as shown in dean and dalrymple 2000 sec 4 6 26 κ r η m a x η m i n η m a x η m i n was used to analyze the wave elevation shown in fig 3 of niu and yu 2011 the result was compared to the numerical solution produced by ww3 and shown in fig 3a on top of the hump there are very rapid bathymetry changes in range order smaller than a single wavelength this causes the wave action model to be incapable of making an accurate estimation over the hump itself regardless of reflection even with this limitation a very good agreement between the results is evident around the hump as previously stated wave reflection can cause directional changes in the wavefield this can be seen in fig 3b where the additional directional spread induced by the new bottom reflection is shown this change is the most noticeable statistical impact of the new source term allowing operational numerical forecasting models to correct the directional spread due to submerged obstacles this means that energy is propagating in a much wider directional spread and can thus enter otherwise sheltered near shore areas e g o reilly et al 1999 a change in directional spread is seen as expected at x l 0 where the incident wave is reflected back by the bottom slope with several beam like patterns due to the refraction effect at x l 0 a negligible change is seen directly downstream of the mound while a stronger change occurs in narrow beams at approximately 45 and 60 degree angles to the incident direction induced by the somewhat less intuitive phenomenon of reflection due to the downward slope deshoaling 4 3 local hawaii bathymetry for real world case a local grid of the hawaii archipelago was used the model implementation of ardhuin and roland 2012 was used without wind and wave input only through boundary conditions a map of the local slopes is shown in fig 4a the model was tested with four reflection source terms configurations without reflection ref0 with the shoreface reflection ref1 with the new bottom reflection brs1 and with both the ref1 and brs1 reflection source terms all tests were done over the period of two months between march april 2008 with 24 directional bins and 32 frequencies 0 0373 0 7159 hz ref1 tests performed with the constant reflection coefficient of 0 1 which is the default in the original paper to allow testing of more robust settings where there are no available measurements to calibrate the local slope β the most consistent difference between the configurations is the directional spread naturally the directional spread of the model without reflection and with ref1 were very similar to those of the original paper fig 4b is showing the maximal directional spread differences between the model with both terms and with ref1 only throughout the test period for the observed period the strongest effects of the new source term are between the south eastern islands with some on the northern part unfortunately no buoy measurements marked as black squares are available at these areas to verify the validity of these differences two prominent points of interest were chosen in order to examine the source term s effect one on the southern part p4117 and the other on the northern p5930 marked in red circles the significant wave height mean wave direction and directional spread of both points are shown in fig 5 focusing on p4117 first it is noted that the change of significant wave height and mean direction is negligible it can also be seen that the directional spread with the new st is slightly higher for most of the duration this suggests that indeed the new source term accounts for the multi directional bottom reflection around the complex and shallower island bathymetry it is clear that the effect of the new source term is much stronger at p5930 this is partly due to p5930 being a much shallower land adjacent point with depth of 88 m and slope of 0 182 while p4117 is further offshore at depth of 530 m with a slope of 0 162 however this should also be examined alongside the unique bathymetry of the area the island of nihoa shelters this point from most swells as they approach from north northwest moreover the bathymetry of the area consists of several steep mostly submerged peaks this causes the wave regime in the area to be largely affected by both refraction and reflection the submerged 2 d bathymetry changes and steep slopes along with shallow water conditions around the island can cause strong reflections with a large variability in directions within short distances the main effect here is wave penetration due to the new reflection where some of the wave action that was sheltered by the island now reaches this point a secondary effect is related to the deshoaling over three submerged mounds around p5930 as discussed in section 4 2 5 summary and discussion this paper presents the implementation of a bottom reflection source term to wavewatch iii numerical wave model this unique source term allows large scale models based on the wave action equation to account for wave reflection from the sea bottom itself as opposed to reflection from the shoreline this is intended to give a more accurate wavefield modeling in shallow and coastal waters and extends the ability to predict waves penetrating harbors and other semi enclosed basins as well as more accurate behavior in the vicinity submerged obstacles the implemented source term was compared to numerical and analytical solutions showing a good agreement in the resulting reflection coefficients significant benefits are expected in areas in which shallow water with complex bathymetry is typical which has been investigated in the hawaiian archipelago test case the newly derived and implemented source term can be activated standalone or alongside the shoreline reflection source term of ardhuin and roland 2012 the two source terms complement each other as the new source term accounts for reflection off the sea bottom but does not account for the energy reflected at the edge of the water the edge reflection can be accounted for by the shoreline reflection source term with a proper adjustment of its empirical coefficients as currently it is calibrated to fit both phenomena using both source terms also helps with cases of steep slopes where the new source term is challenged by the mild slope assumption and the perturbation approximation used in its derivation additional calibration can be applied to the new term for cases of steep bathymetry especially if paired with the existing shoreline reflection source term for this end the new source term could benefit from more testing in an operational environment and verification with real ocean measurements another possible contribution of this source term is the ability to model reflection of infragravity ig waves in wave action based models see ardhuin et al 2014 these waves are very long and of small steepness resulting in very little breaking while having importance for various phenomena and applications such as harbor agitation altimetry measurement corrections and sediment transport modeling ig wave reflection using the new source term should be done carefully and be compared to measurements as the bottom profile which reflects these waves may change significantly on spans much shorter than the ig wave length this limits the accuracy of the wkb approximation used while deriving the source term even with this limitation it is currently the only source term which is capable of making any prediction of the bottom reflection for such waves in conclusion the new source term provides the ability to include bottom reflection in wae models it is based on an analytical derivation under mild slope assumptions and is applicable for diverse bathymetric and wave conditions it is intended to enable large scale models to have improved wave forecasting in nearshore and other shallow environments credit authorship contribution statement yuval yevnin conceptualization methodology software investigation writing original draft writing review editing visualization yaron toledo conceptualization methodology writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the israel science foundation grant no 1601 20 we would like to thank the naomi foundation through the tel aviv university grtf program supporting a visit to noaa and to arun chawla henrique alves and roberto padilla hernandez of the marine modeling and analysis branch at noaa we would also like to thank fabrice ardhuin for helpful discussion and sharing his code of the hawaiian model and to an anonymous reviewer for very insightful comments 
23902,wave bottom reflection induced by a changing bathymetry has a major impact on the near shore environment where harbors and other infrastructure are based however this reflection is only partially accounted for in large scale numerical wave prediction models the present work implements the analytical bottom reflection source term derived in yevnin and toledo 2018 to wavewatch iii a numerical prediction model based on the wave action equation the new source terms reflection coefficient magnitude reflection direction and directional spread are shown to produce good results with respect to analytical and numerical solutions and are tested in a real world example the new term allows to better simulate the near shore environment especially near islands reefs semi enclosed basins or natural beaches with long mild slopes where the directional changes can cause previously unaccounted for effects keywords bottom reflection wind waves wave action equation wavewatch wave directional scheme 1 introduction wave reflection from the sea bottom coastline or submerged obstacles can have a profound impact on wave behavior in coastal waters and even in deep water see for example o reilly et al 1999 in the near shore area it can for example cause harbor agitation as waves reflect from nearby bathymetry in different directions penetrating bays and harbors which may cause serious damage to ships and infrastructure see mei et al 2005 tobias and stiassnie 2011 for harbor agitation and shelf edge respectively it can also cause unaccounted for wavefields around islands as waves could be reflected and even trapped by changing bathymetry liu et al 2004 in deep water it can cause nonlinear triad interactions leading to infragravity waves and secondary peaks which are not yet accounted for in numerical forecasting models for forward propagating waves see vrećica and toledo 2016 vrećica et al 2019 wave reflection and refraction is caused when waves propagate over a changing bathymetry where part of the wave energy is transmitted forward and some of the energy is reflected off the sea bottom meyer 1979 the magnitude of reflection is affected by the bottom depth and slope and by the wave period height and direction all of which can change locally investigations of such reflection have shown it could have up to 40 wave action reflected at steep cliffs o reilly et al 1999 but more commonly around 5 10 reflection over natural beaches tatavarti et al 1988 elgar et al 1994 few studies have been done on the directional effect of such reflections due to the difficulty of measuring wave reflection and separating it from general wave propagation in the chaotic coastal environment the effects of these reflections can be sensed mostly by examining directional spread kuik et al 1988 differences of models and measurement devices as suggested in ardhuin and roland 2012 two wave reflection source terms were introduced into wave forecasting models such as wavewatch iii tolman 1991 and swan booij et al 1999 the first presented in ardhuin and magne 2007 and based on ardhuin and herbers 2002 and magne et al 2005 was designed for sub grid topography undulations the second aims to recover the reflected wave action of shoaling waves this source term was presented in ardhuin and roland 2012 where wave action reflection is calculated at the coastline this approach is somewhat limited for example in cases where submerged obstacles are present or when the topography is close to the water surface but does not reach land another limiting factor is the reflection coefficient that has to be calibrated to achieve good results this is very difficult since as stated above measuring wave reflection directly is complicated the source term for coastal reflection used in wavewatch iii ww3 was derived in ardhuin and roland 2012 here referred to as ref1 as 1 n r e f u n s t f θ 0 2 π r 2 f θ θ n f θ d θ where n r e f u n s t is the source term for unstructured grid r 2 is the energy reflection coefficient n is the wave action directional spectrum f is the wave frequency θ is the incident direction and θ is the reflection direction the reflection coefficient has been based on the miche number empirically related to the bottom slope the deep water wave height and the wave frequency miche 1951 this source term is currently used by several wave forecasting models as an optional term to account for wave reflection the reflection can be locally calculated automatically through the miche number although it was suggested that this could be sensitive to bathymetric grid coarseness and the resolution of the shoreface slope for this reason it was suggested by the original authors that a manually set model wide constant reflection coefficient be used if the shoreface slope cannot be otherwise simulated furthermore this source term relies only on land based reflection and the coastline shape and direction straight oblique or sharp angle this means shallow water without adjacent land in the model does not produce any reflected waves in yevnin and toledo 2018 a steady state analytical term for bottom reflection was introduced as 2 ξ k ξ k c g n r e f i k ξ ξ 2 k ξ 2 c g n i n k e 4 i k ξ d ξ where n r e f is the reflected wave action directional spectrum i is the imaginary unit ξ is the bottom gradient direction k and k ξ are the wavenumber and wavenumber in the ξ direction respectively c g is the group velocity and n i n is the incident wave action directional spectrum it was based on a perturbation analysis and a wkb approximation of the mild slope equation see berkhoff 1972 booij 1983 and assumed no changes in time steady state it accounts for varying bottom slopes wave periods and oblique incident angles the source term was compared with the ref1 source term and showed more accurate results reaching even into the infragravity wave range under mild slope assumptions for further details see yevnin and toledo 2018 in this paper an implementation of the analytical source term to ww3 is presented followed by testing and verification the paper is structured as follows in section 2 the source term is extended to account for the time derivative of the wave action thus more accurate and better fitting for implementation in section 3 a new directional scheme for the local coordinate system used in the source term is formulated and explained the reflection source term implementation in ww3 is tested in section 4 finally in section 5 the work is summarized and discussed 2 reflection source term derivation eq 2 is the bottom reflection expression derived in yevnin and toledo 2018 it was derived assuming steady state conditions and is derived here for time dependent conditions in order to implement it as a robust source term to this end the mild slope equation was taken similar to kirby 1984 neglecting the current and keeping the time derivative 3 2 ϕ t 2 c c g ϕ σ 2 k 2 c c g ϕ 0 where ϕ is the velocity potential t is time is the horizontal gradient operator c is the phase velocity c g is the group velocity and k is the wave number which can be derived through the dispersion relation with a relation to σ and h x y the frequency and bottom profile accordingly the derivation ahead follows that of yevnin and toledo 2018 closely the oblique parabolic approximation can be shown to be 4 ϕ ξ i k ξ 1 2 k ξ k ξ ξ ϕ 1 2 k ξ k ξ ξ ϕ ˆ i 2 k ξ c c g 1 2 2 c c g 1 2 ϕ ϕ t 2 i c c g 1 2 k ξ σ 2 ϕ ϕ where ξ is assumed to be oriented in the direction of the bottom gradient with the corresponding wavenumber k ξ and i being the imaginary unit the velocity potential was transformed to ϕ c c g 1 2 ϕ x e i k 2 y assuming a quasi 2 dimensional model and the superscript relates to the transmitted and reflected components of the field using the relation of the mean water surface level η to the velocity potential ϕ x t c c g 1 2 g i σ η x t and assuming a small reflection a similar wkb perturbation process results with 5 ξ c c g η 0 i k ξ 1 2 k ξ k ξ ξ c c g η 0 i 2 k ξ c c g 1 2 2 η 0 t 2 i 2 k ξ σ 2 c c g 1 2 η 0 0 6 ξ c c g η 1 i k ξ 1 2 k ξ k ξ ξ c c g η 1 i 2 k ξ c c g 1 2 2 η 1 t 2 i 2 k ξ σ 2 c c g 1 2 η 1 1 2 k ξ k ξ ξ c c g η 0 i 2 k ξ c c g 1 2 2 η 0 t 2 i 2 k ξ σ 2 c c g 1 2 η 0 where the subscript 0 1 are the zero and first order approximations see yevnin and toledo 2018 section 3 for further details it is noted this result is similar to that of yevnin and toledo 2018 with two additional terms on each side accounting for the time derivatives at this point η can be assumed to be composite of a slowly varying component η and a fast oscillating function see mei et al 2005 chapter 3 1 7 η 0 1 η 0 1 ϵ ξ ϵ t e i ψ ψ ξ k ξ d ξ σ t using the definition of wave action n e ω 1 2 ρ g η 2 σ and applying eqs 7 to 5 the o ϵ yields the quasi 2d wave action equation 8 ξ k ξ k c g n 0 n 0 t 0 where n 0 is the zero order wave action the reflection source term can be derived by applying the same procedure to eq 6 taking again the o ϵ resulting with 9 2 k ξ ξ c c g η 1 k ξ ξ c c g η 1 2 σ c c g 1 2 η 1 t k ξ ξ c c g η 0 e 2 i k 1 d x 2 σ c c g 1 2 η 0 t e 2 i k ξ d ξ multiplying by c c g η 1 it can be transformed to 10 ξ k ξ c c g η 1 2 σ η 1 2 t k ξ ξ c c g η 0 η 1 e 2 i k ξ d ξ 2 σ η 1 η 0 t e 2 i k ξ d ξ eq 10 can be expressed in the form of wave action 11 ξ k ξ k c g n 1 n 1 t k ξ ξ c g k n 0 n 0 t κ r e 2 i k ξ d ξ where κ r η 1 η 0 is the reflection coefficient note that a change of κ r in time without a change in space is by definition zero as reflection is zero for a flat bathymetry thus κ r in the leading order can be defined by steady state solution to this end eq 11 is compared to previously derived steady state solution in eq 2 12 ξ k ξ k c g n 1 k ξ ξ c g k n 0 κ r e 2 i k ξ d ξ i k ξ ξ 2 k ξ 2 c g n 0 k e 4 i k ξ d ξ yielding the solution κ r i 4 k ξ 2 k ξ ξ e 2 i k ξ d ξ finally the solution is 13 ξ k ξ k c g n 1 n 1 t i k ξ ξ c g k n 0 n 0 t k ξ ξ 1 4 k ξ 2 e 4 i k 1 d x this is the first main finding of this paper as it extends the derivation given in yevnin and toledo 2018 to the cases of growing or decaying seas note that the left hand side has a minus sign as it stands for reflected waves for implantation in phase averaged numerical forecasting models komen et al 1996 the spatial phase of eq 13 is averaged out then the commonly used splitting method see tolman and booij 1998 tolman 1991 to separate the spatial intra spectral and source term integration is applied practically resulting with neglecting the spatial derivative on the left hand side the resulting bottom reflection source term s b r e f takes the form 14 n r e f t s b r e f k ξ ξ c g k n i n n i n t k ξ ξ 1 4 k ξ 2 it provides the reflection source term in formulation fitting for implementation in a wave action based model the source term is the first order correction to the incident wave action providing the magnitude of the added action as a result of bottom reflection 3 directional scheme for local slope gradient oriented coordinate system wave reflection due to bathymetric changes is axisymmetric with regards to the slope bottom depth gradient h direction ξ see fig 1a this means an incident wave induces a reflected wave with the same projection on the ζ axis perpendicular to the slope and a projection with the same magnitude and a reversed direction on the ξ axis for locally linear sloping bottom numerical models are using a finite number of bins to represent the spectral direction an example of incident and reflected directions in bin format can be seen in fig 1b for 24 directional bins with a slope in the direction of bin 19 south this example can be generalized to be used with any number of bins and any bottom gradient direction a pseudo algorithm can produce such directional scheme as follows 1 the bin in the direction of ζ induces reflection to the same bin number as there is no reflection in the ζ direction bin 13 in the given example 2 the rest of the reflection bin numbers will rise in a clockwise manner from the first bin bins 14 24 and 1 12 in the given example this remains the same for all frequency bins mathematically this takes the form 15 b r e f b r e f 0 b c o r b r e f 0 2 b ξ b m a x 2 b i n where b r e f is the bin of the reflected wave 5 in the given example b ξ is the bin of the bottom gradient e g 19 b m a x is the number of directions e g 24 b i n is the bin of the incident wave e g 21 and b c o r is a correction factor accounting for the directional periodicity and is equal to 16 b c o r 2 b m a x b r e f 0 b m a x b m a x b m a x b r e f 0 1 b m a x b r e f 0 b m a x 0 e l s e in the numerical model this gradient oriented coordinate system has to be locally calculated for each grid node during the model definition phase as the slope direction can change even in relatively short distances most numerical models use a north east coordinate system and model derivatives are calculated in this coordinate system changing the coordinate to a local direction requires calculating the wavenumbers vector k ξ k ζ and derivatives in the new local system the wavenumbers vector components can be written as 17 k ξ k cos θ ξ k ζ k sin θ ξ where θ ξ is the angle between the bottom gradient direction and the wave direction the wavenumbers ξ derivative can be simplified by using the chain rule to yield 18 k ξ ξ k ξ x x ξ k ξ y y ξ the coordinate system change dictates that 19 x ξ cos θ s l p y ξ sin θ s l p where θ s l p is the angle between the x axis and the bottom gradient direction applying eqs 17 and 19 to eq 18 results in 20 k ξ ξ k x cos θ s l p k y sin θ s l p cos θ ξ finally the north east wavenumber gradient can be solved by using the depth gradient making it more computationally efficient this is done again through the chain rule 21 k x k h h x k y k h h y where h is the bottom depth and the derivative of the dispersion relation is 22 k h 2 k 2 2 k h sinh 2 k h 2 k 2 sinh 2 k h c c g here c g is the group velocity and c is the phase velocity this new directional scheme is the second main product of this work it lays the groundwork for the bottom reflection source term as well as for other source terms which can take advantage of a slope oriented coordinate system such as those presented in vrećica and toledo 2016 and vrećica et al 2019 4 numerical simulations in this section numerical simulations using the new source term are compared to several test cases the derived source term in eq 14 and the directional scheme were implemented to wavewatch iii v5 16 ww3 for unstructured grids these grids provide versatility in element size allowing for deep and shallow water elements of different sizes leading to more accurate bathymetry representation and more efficient resource allocation 4 1 monochromatic wave shoaling over a piecewise linear bathymetry the first test case chosen was a simple piecewise linear bathymetry shown in the top part of fig 2a it consisted of two plateaus one in deep water k h 3 and the other in shallow water k h 0 2 connected by a uniform unidirectional slope the slope was defined as 23 β f h ξ and the values tested were β f 0 1 and β f 0 2 for the numerical model a 5000 m by 2000 m grid was designed where the slope was in the x direction and the y direction was uniform with no changes it was compared to the magnitude of the solution of berkhoff s mild slope equation solved by wolfram mathematica v11 0 ndsolve function a boundary condition of a known incident wave at x 0 was set in both models to allow reflection transparent wavemaker the mild slope model mse was also set with a no reflection boundary condition at the other end transmission only the reflection coefficient is defined as 24 κ r a r e f a i n e r e f e i n where a r e f and e r e f are the reflected wave amplitude and energy respectively and a i n and e i n are the incident wave amplitude and energy respectively the reflection coefficient was extracted from ww3 as energy spectra at the center of the y axis y 1000 m for x in intervals of 50 m the resulting reflection coefficient was linearly interpolated into a continuous function the numerical model was run with 24 directions which is a common directional resolution although less could have been used and 3 frequencies the required minimal number of frequencies as only monochromatic waves were used and the time step was set to δ t 1 s a comparison of the models reflection coefficients is shown in fig 2a for a wave of period t 10 s shoaling straight towards the shore additional periods were tested with consistent results and are thus not shown here during implementation a tuneable magnitude coefficient was added to the source term and was found to yield best results with a factor of b r s f a c 0 5 which was used in all following tests as well it can be seen that for both slopes tested the mse solution and ww3 model are in good general agreement for the β f 0 1 slope the ww3 reflection solution is somewhat stronger though both are of a similar scale of course the magnitude coefficient can be tuned to adjust the reflection to fit the local conditions and bathymetry to improve accuracy as necessary in the numerical solution some wave reflection can be seen beyond the end of the slope where no reflection should be present this numerical artifact happens as for the most part there are no nodes exactly where the slope should end as the reflection only ends where two adjacent nodes are at the same depth this causes the effect to be smeared reaching a little further than in the dense phase resolving mse model this effect can be easily minimized by using a finer grid tested not shown but it does raise the issue of grid coarseness it is recommended that areas of interest especially in shallow water be modeled with a resolution fine enough to match the local slope change rates the sensitivity to temporal resolution was evaluated using the β f 0 2 model the model was run with time steps δ t 1 5 10 20 30 60 s correlating to spatial advection cfl of c f x 0 3 1 5 3 6 9 18 in order to stress test the model even when the numerical propagation scheme has adversity c f x 1 fig 2b shows that changing the time step has a minimal impact on the reflection coefficient this is attributed the wave action time derivative extension in eq 14 the robustness of the source term holds even at the very large time step δ t 60 s c f x 18 and still performs in a similar manner and magnitude 4 2 monochromatic wave propagating over a submerged mound the second test case chosen was a long incident wave over a submerged mound based on the work of zhu and harun 2009 and niu and yu 2011 a flat bottom with a central hump was modeled using the depth function 25 h r h 0 r r 0 h 1 β m r α r r 0 where h r is the water depth h 0 is the maximal water depth h 1 is the minimal water depth r 0 is the radius of the mound and α and β m h 0 h 1 r 0 α are parameters which define the mound shape in niu and yu 2011 such a problem was solved analytically with the parameters h 0 4 8 m h 1 3 2 m r 0 90 3 m α 2 β m 1 9 k 0 h 0 0 167 t 0 26 4 s this bathymetry is not quasi 2 dimensional as was assumed during the source term derivation however within each grid element this assumption holds locally allowing to simulate the reflection through the complete solution the ww3 model used 48 directional bins and 3 frequencies and a time step of δ t 0 5 s the reflection coefficient κ r for a given wave elevation η as shown in dean and dalrymple 2000 sec 4 6 26 κ r η m a x η m i n η m a x η m i n was used to analyze the wave elevation shown in fig 3 of niu and yu 2011 the result was compared to the numerical solution produced by ww3 and shown in fig 3a on top of the hump there are very rapid bathymetry changes in range order smaller than a single wavelength this causes the wave action model to be incapable of making an accurate estimation over the hump itself regardless of reflection even with this limitation a very good agreement between the results is evident around the hump as previously stated wave reflection can cause directional changes in the wavefield this can be seen in fig 3b where the additional directional spread induced by the new bottom reflection is shown this change is the most noticeable statistical impact of the new source term allowing operational numerical forecasting models to correct the directional spread due to submerged obstacles this means that energy is propagating in a much wider directional spread and can thus enter otherwise sheltered near shore areas e g o reilly et al 1999 a change in directional spread is seen as expected at x l 0 where the incident wave is reflected back by the bottom slope with several beam like patterns due to the refraction effect at x l 0 a negligible change is seen directly downstream of the mound while a stronger change occurs in narrow beams at approximately 45 and 60 degree angles to the incident direction induced by the somewhat less intuitive phenomenon of reflection due to the downward slope deshoaling 4 3 local hawaii bathymetry for real world case a local grid of the hawaii archipelago was used the model implementation of ardhuin and roland 2012 was used without wind and wave input only through boundary conditions a map of the local slopes is shown in fig 4a the model was tested with four reflection source terms configurations without reflection ref0 with the shoreface reflection ref1 with the new bottom reflection brs1 and with both the ref1 and brs1 reflection source terms all tests were done over the period of two months between march april 2008 with 24 directional bins and 32 frequencies 0 0373 0 7159 hz ref1 tests performed with the constant reflection coefficient of 0 1 which is the default in the original paper to allow testing of more robust settings where there are no available measurements to calibrate the local slope β the most consistent difference between the configurations is the directional spread naturally the directional spread of the model without reflection and with ref1 were very similar to those of the original paper fig 4b is showing the maximal directional spread differences between the model with both terms and with ref1 only throughout the test period for the observed period the strongest effects of the new source term are between the south eastern islands with some on the northern part unfortunately no buoy measurements marked as black squares are available at these areas to verify the validity of these differences two prominent points of interest were chosen in order to examine the source term s effect one on the southern part p4117 and the other on the northern p5930 marked in red circles the significant wave height mean wave direction and directional spread of both points are shown in fig 5 focusing on p4117 first it is noted that the change of significant wave height and mean direction is negligible it can also be seen that the directional spread with the new st is slightly higher for most of the duration this suggests that indeed the new source term accounts for the multi directional bottom reflection around the complex and shallower island bathymetry it is clear that the effect of the new source term is much stronger at p5930 this is partly due to p5930 being a much shallower land adjacent point with depth of 88 m and slope of 0 182 while p4117 is further offshore at depth of 530 m with a slope of 0 162 however this should also be examined alongside the unique bathymetry of the area the island of nihoa shelters this point from most swells as they approach from north northwest moreover the bathymetry of the area consists of several steep mostly submerged peaks this causes the wave regime in the area to be largely affected by both refraction and reflection the submerged 2 d bathymetry changes and steep slopes along with shallow water conditions around the island can cause strong reflections with a large variability in directions within short distances the main effect here is wave penetration due to the new reflection where some of the wave action that was sheltered by the island now reaches this point a secondary effect is related to the deshoaling over three submerged mounds around p5930 as discussed in section 4 2 5 summary and discussion this paper presents the implementation of a bottom reflection source term to wavewatch iii numerical wave model this unique source term allows large scale models based on the wave action equation to account for wave reflection from the sea bottom itself as opposed to reflection from the shoreline this is intended to give a more accurate wavefield modeling in shallow and coastal waters and extends the ability to predict waves penetrating harbors and other semi enclosed basins as well as more accurate behavior in the vicinity submerged obstacles the implemented source term was compared to numerical and analytical solutions showing a good agreement in the resulting reflection coefficients significant benefits are expected in areas in which shallow water with complex bathymetry is typical which has been investigated in the hawaiian archipelago test case the newly derived and implemented source term can be activated standalone or alongside the shoreline reflection source term of ardhuin and roland 2012 the two source terms complement each other as the new source term accounts for reflection off the sea bottom but does not account for the energy reflected at the edge of the water the edge reflection can be accounted for by the shoreline reflection source term with a proper adjustment of its empirical coefficients as currently it is calibrated to fit both phenomena using both source terms also helps with cases of steep slopes where the new source term is challenged by the mild slope assumption and the perturbation approximation used in its derivation additional calibration can be applied to the new term for cases of steep bathymetry especially if paired with the existing shoreline reflection source term for this end the new source term could benefit from more testing in an operational environment and verification with real ocean measurements another possible contribution of this source term is the ability to model reflection of infragravity ig waves in wave action based models see ardhuin et al 2014 these waves are very long and of small steepness resulting in very little breaking while having importance for various phenomena and applications such as harbor agitation altimetry measurement corrections and sediment transport modeling ig wave reflection using the new source term should be done carefully and be compared to measurements as the bottom profile which reflects these waves may change significantly on spans much shorter than the ig wave length this limits the accuracy of the wkb approximation used while deriving the source term even with this limitation it is currently the only source term which is capable of making any prediction of the bottom reflection for such waves in conclusion the new source term provides the ability to include bottom reflection in wae models it is based on an analytical derivation under mild slope assumptions and is applicable for diverse bathymetric and wave conditions it is intended to enable large scale models to have improved wave forecasting in nearshore and other shallow environments credit authorship contribution statement yuval yevnin conceptualization methodology software investigation writing original draft writing review editing visualization yaron toledo conceptualization methodology writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the israel science foundation grant no 1601 20 we would like to thank the naomi foundation through the tel aviv university grtf program supporting a visit to noaa and to arun chawla henrique alves and roberto padilla hernandez of the marine modeling and analysis branch at noaa we would also like to thank fabrice ardhuin for helpful discussion and sharing his code of the hawaiian model and to an anonymous reviewer for very insightful comments 
23903,detailed flow and turbulence characteristics of a long wave induced shallow water monopolar vortex are investigated using a 3d large eddy simulation the numerical model is validated with measured data where nearly 2d shallow turbulent coherent structures were generated by sending a single asymmetric wave through a harbour channel in a large 3d wave basin model results demonstrate that the vortex centre trajectory is sensitive to small perturbations applied via a surface tension coefficient instantaneous model results are averaged over three numerical runs with slightly different surface tension coefficients so that a sufficient number of realisations are obtained for ensemble averaging because of shallow water depth flow fields are dominated by a horizontally rotating current and vertically suppressed velocities resembling quasi 2d flow conditions bed shear stress calculated using the decay of peak azimuthal velocity is qualitatively similar to that obtained using a near wall modelling method although 2d turbulent coherent structures evolve into monopolar vortices at later stages flow is not completely axisymmetric due to secondary turbulent coherent sub structures located in the middle of the water column and away from the core turbulence production and turbulence dissipation rate demonstrate a local imbalance where turbulence is mainly produced by flow shear correlated with recirculation patterns while turbulent kinetic energy is predominantly dissipated near the no slip bottom boundary while the free surface elevation at the vortex core indicates an upwelling pattern consistent with laboratory experiments model results show evidence that the recirculation pattern is influenced by a low frequency resonant mode of the wave basin graphical abstract keywords monopolar vortex large eddy simulation quasi 2d flow turbulence recirculation 1 introduction bays and harbours are vital to coastal communities providing recreational economic and coastal protection benefits however various essential coastal infrastructures in bays and harbours e g breakwater and quay wall are vulnerable to episodic wave events e g tsunamis for instance large horizontal eddies frequently called whirlpools have been observed and recorded after tsunamis e g choi et al 2008 wilson et al 2012 admire et al 2014 5 argued that strong currents driven by large offshore eddies can bring a considerable impact and damage to harbour areas these tsunami effects can persist for several hours which may be accompanied with coastal inundation thus the characteristics and evolution of these long wave induced vorticial currents interacting with surrounding boundaries require comprehensive investigation significant damage from eddies was observed in many ports and harbours after the 2004 indian ocean tsunami e g okal et al 2006a b c most importantly a ship moored in the port of salalah oman spun and drifted for a significant distance in the vicinity of the port the trajectory of the ship followed the eddies which were generated inside the harbour after the arrival of the 2004 indian ocean tsunami and migrated offshore okal et al 2006a this event clearly shows that the eddies induced by long waves can cause the uncontrolled drift of ships which in turn can cause critical damage to infrastructure or ships lynett et al 2012 2014 suggested that a tsunami induced horizontally sheared rotating current generated by the interaction between vertical coastal structures and topographical fluid jets was the main cause that the ship broke its mooring in port salalah instead of free surface fluctuations recently large scale laboratory experiments were carried out to investigate the dynamics of a long wave induced shallow monopolar vortex generated at the edges of hard boundaries such as a breakwater kalligeris 2017 in the experiment the passage of a long wave through a narrow port entrance generated horizontal shear and vertical vorticity that drives two dimensional 2d turbulent coherent structures tcss that contain 3d sub structures the extensive data set collected during the experiment allows to study the generation growth and decay of long wave induced shallow tcss this study further showed that kinetic energy decay and spatial growth of long wave induced shallow tcss followed the first order vortex model of seol and jirka 2010 the primary rotating current of the long wave induced shallow tcss matches well with the theoretical α profile for a monopolar vortex van heijst and clercx 2009 tcss represent turbulent eddies that are instantaneously coherent in space and they can be expressed using velocity or vorticity fluctuations hussain 1983 in general tcss are 3d and evolve into sub structures through energy cascade in sufficiently shallow water however flow and turbulence fields are vertically confined e g batchelor 1969 sou et al 2010 kim et al 2017 tcss can be dominated by 2d features in nearshore environments when the water depth h is relatively small compared to the wave length l 2 π k i e k h 1 jirka 2001 in such conditions they are often called shallow tcss e g negretti and socolofsky 2005 dolzhanskii et al 1992 argued that the two dimensionality of shallow flows mainly depends on the reynolds number r e and bottom friction turbulence in quasi 2d flows can be characterised by the 3 power law in the turbulent kinetic energy spectrum denoted as the enstrophy integral of vorticity squared transfer regime lindborg and alvelius 2000 uijttewaal and booij 2000 uijttewaal and jirka 2003 in this regime enstrophy is transferred from large to small scales while the vortex stretching is confined the 3 slope is distinct from the typical 5 3 spectrum slope for isotropic turbulence based on the kolmogorov hypothesis pope 2000 this 3 slope has been found in wavenumber spectra in the swash zone during uprush in both measured data sou et al 2010 and large eddy simulation les results kim et al 2017 depth integrated and depth resolving numerical models have been adopted to study shallow tcss kim and lynett 2011 son et al 2011 williams and fuhrman 2016 larsen et al 2017 a fully nonlinear boussinesq type model for weakly dispersive and rotational flow using a long wave perturbation approach was derived kim and lynett 2011 and revealed that the dispersive stress plays an important role for energy transfer in a shallow mixing layer the nonlinear boussinesq type model was coupled the with the shallow water solver for tsunami generation and propagation in the open ocean son et al 2011 that is capable of reproducing the local dynamics experienced in the port of salalah oman induced by the 2004 indian ocean tsunami okal et al 2006a to resolve a vertical flow structure a reynolds averaged navier stokes so called rans model with a transitional two equation k ω turbulence model was also proposed williams and fuhrman 2016 with additional bedload and suspended load descriptions larsen et al 2017 demonstrated that the tsunami induced scour processes can be limited by finite wave boundary layer thickness compared to the aforementioned numerical models the main advantage of an les model is that unsteady motions larger than a pre determined grid scale is directly resolved in the entire water column thus a more complete understanding of turbulent characteristics such as the evolution of a tcs cascade of turbulent kinetic energy and dissipation and the vertical flow structure can be obtained for instance many les studies have successfully revealed the tcss induced by wave breaking processes in the surf zone e g christensen and deigaard 2001 watanabe et al 2005 lubin et al 2006 derakhti and kirby 2014 for tsunami like long waves les has also been adopted to provide more detailed information for the instantaneous turbulent flow feature where large scale unsteadiness is significant wu and liu 2008 introduced a numerical model that can be applied to landslide generated tsunamis under the solitary wave zhou et al 2014 showed the evolution of rollers into 3 d hairpin vortices due to wave breaking and their touch down onto the bed when the solitary wave interacts with a cuboid structure it was also revealed that primary vortex tubes generated at the leading and trailing edges of structures were stretched in the wave propagation direction accompanied with the formation of the secondary vortices arabi et al 2019 yao et al 2019 showed that wave run up is sensitive to reef morphology affecting vortex and current evolution the purpose of this study is to unravel the complexities involved in the dynamics of the long wave induced shallow monopolar vortex using les in particular since only surface velocities were measured in the physical experiment kalligeris 2017 les can provide the comprehensive 3d flow structure and turbulence characteristics in full depth at different stages of the vortex evolution albeit being computationally expensive the large scale laboratory experiments of this study are described in section 2 the mathematical formulations of the model and numerical implementations are presented in section 3 we devote section 4 to discuss model setup main flow characteristics and comprehensive model validation with the data collected from the physical experiment kalligeris 2017 a discussion on unique flow and turbulence characteristics of long wave induced tcss obtained from les is presented in section 5 lastly section 6 provides the main conclusions of this study 2 physical experiment an overview of the laboratory experiments of long wave induced shallow monopolar vortex is provided more details can be found in kalligeris 2017 the physical experiments were carried out in the 3d wave basin at the o h hinsdale wave research laboratory in oregon state university the 3d wave basin is 44 m long 26 5 m wide and the still water depth h 0 was set at 0 55 m a vertically walled breakwater was installed with a 27 angle to establish a gap of 3 1 m between the tip of the breakwater and the top side wall fig 1a which was optimised to generate a vertical vortex in the physical experiments side walls and bottom were made of polished concrete and the breakwater was covered with acrylic plexiglass sheets thus they are considered as impermeable and smooth boundaries the vertical scale in the physical experiment was set to be about 1 27 of the typical depth around 15 m at a port entrance channel a single asymmetric pulse resembling a leading elevation n wave tadepalli and synolakis 1994 was generated using a piston type wave maker with a single stroke and the resulting wave had a height h w of 4 6 cm period t w of 42 s and wave length l w of 97 6 m free surface elevation η was measured using twin wire capacitance wave gauges mounted on the instrumentation bridge of the wave basin with 27 repeated trials the free surface elevations at 432 different locations in total were measured to cover the entire wave basin grey circles in fig 1a three acoustic doppler velocimeters advs were deployed at mid depth of the water column z 0 275 m to collect time series of all three components of velocity adv1 was located near the wave maker adv2 behind the breakwater and adv3 at the harbour channel see fig 1a 2d particle tracking velocimetry ptv techniques using overhead high definition cameras were adopted to extract surface velocities during the experiments 3 numerical model 3 1 governing equations 3d large eddy simulations were carried out to model the physical experiments in les the filter operation decomposes the velocity field into the resolved and the unresolved components using a prescribed cutoff filter length the flow fields with length scales larger than the filter length are solved directly in which the filter length denotes the characteristic length of the grid size as 1 δ δ x δ y δ z 1 3 where each component δ x δ y δ z denotes the grid size in x y z directions respectively to resolve large scale energy containing eddies filtered navier stokes equations are numerically solved 2 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i ρ τ i j s g s x j ρ g δ i 3 σ γ ϕ w x i where i j 1 2 3 for 3d flow ρ is the fluid density u i is the filtered flow velocity p is the filtered fluid pressure μ is the dynamic viscosity of the fluid g is gravitational acceleration and δ i 3 is the kronecker delta flow fields smaller than the filter length are modelled as sub grid turbulent stress tensor τ i j s g s which requires a sub grid scale sgs closure model in the present study to simulate rather large scale flow field in general a dynamic procedure is known to be more physical based for complex geometries since the smagorinsky coefficient c s can be dynamically adjusted from the resolved flow fields e g meneveau and katz 2000 however estimating c s from the second test filter filter length of 2 δ becomes more difficult with the limited resolution thus the most commonly used standard smagorinsky type closure smagorinsky 1963 is utilised for the unresolved sgs fluctuations 3 τ i j s g s 1 3 δ i j τ k k s g s 2 c s δ 2 s s i j where k 1 2 3 s i j 1 2 u i x j u j x i is the strain rate tensor of filtered velocity and s 2 s i j s i j 1 2 is the strain rate magnitude the commonly used smagorinsky coefficient c s 0 167 patel et al 2019 wang et al 2019 zahiri and roohi 2019 is applied in this study known to be appropriate for the turbulent mix layer and boundary layer far from the no slip boundaries strictly speaking the value of c s should decrease to zero near the wall boundaries in this study however the numerical resolution is not fine enough to resolve the viscous sublayer and buffer layer due to the limited computational power thus near wall modelling is used instead see section 3 2 sub grid turbulent viscosity is defined as ν s g s c s δ 2 s the last term in eq 2 represents surface tension at the free surface where σ is the surface tension coefficient ϕ w is the volume fraction of water and γ is the free surface curvature calculated as 4 γ x i ϕ w x i ϕ w x i b where b 1 0 8 δ prevents division by zero for coastal flows the surface tension force is relatively minor however as shown in section 4 2 small perturbations in surface tension can trigger significant nonlinear effects in turbulent flows that result in different realisations of the same experiment in this study two immiscible fluids exist i e air and water and they are treated as a single air water mixture phase the interface between these two phases is tracked by the volume of fluid vof method where the air water mixture fluid density is written as hirt and nichols 1981 5 ρ ρ w ϕ w ρ a 1 ϕ w where the superscripts w and a represent water and air phases respectively hence ρ w 1000 kg m 3 is the density of water and ρ a 1 kg m 3 is the density of air likewise the dynamic viscosity of air water mixture phase in eq 2 is written as 6 μ ρ w ν w ϕ w ρ a ν a 1 ϕ w where ν w 1 0 6 m 2 s and ν a 1 48 1 0 5 m 2 s are the kinematic viscosity of water and air phases respectively the filtered mass conservation equations for the air and water phases can be written as drew 1983 7 1 ϕ w t 1 ϕ w u i a x i 0 8 ϕ w t ϕ w u i w x i 0 respectively where u i w u i a is the water air phase velocity notably the summation of eqs 7 and 8 leads to the divergence free filtered global mass conservation equation u i x i 0 where u i ϕ w u i w 1 ϕ w u i a in the numerical model diffusion at the free surface is minimised using the interface compression method berberović et al 2009 klostermann et al 2012 and the filtered mass conservation equation for the water phase can be re written as 9 ϕ w t ϕ w u i x i ϕ w 1 ϕ w u i r x i 0 where the relative velocity between two phases u i r u i w u i a is solved by iteration 3 2 near wall modelling in general it is not trivial to achieve sufficient numerical resolution to completely resolve all boundary layer processes for the laboratory wave basin length scales considered in this study o 1 0 1 m and o 1 0 0 m in horizontal and vertical directions respectively hence boundary conditions for velocities need to be specified via a near wall model for side walls and solid bottom in order to account for the boundary layer processes while maintaining a manageable computational cost for the smooth boundary considered in this study a semi empirical formula for the velocity parallel to the wall bed is utilised as spalding 1961 10 z h u h 1 e exp κ u h 1 κ u h 1 2 κ u h 2 1 6 κ u h 3 with e 9 8 κ 0 41 z h z h u τ ν and u h u h u τ where z h is the distance from the boundary normal to the nearest cell centre and u h is the wall bed parallel velocity on the centre of a cell in contact with the wall bed the friction velocity u τ is locally solved in eq 10 via iteration the proposed formula is applicable for multiple boundary layer regimes and is asymptotic to u h 0 at z h 0 u h z h for small z h in the viscous sublayer and u h 2 5 ln z h 5 5 at large z h in the log law layer in the buffer layer u h in eq 10 represents a smooth transition between the viscous sublayer and log law layer it should be noted that the spalding wall function was originally proposed for fully developed boundary layer flows thus near wall modelling applied to the present transient flow is one source of inaccuracy however the temporal evolution is relatively slow and the spatial variation is mild for the present long wave problem the performance of near wall modelling approach in transitional oscillatory flows was demonstrated by radhakrishnan and piomelli 2008 zhou et al 2014 and kim et al 2017 3 3 numerical implementations to solve the governing equations section 3 1 with the boundary conditions presented in section 3 2 interdymfoam jasak and tuković 2010 which is a solver based on the open source openfoam cfd toolbox is utilised with a minor modification interdymfoam solves the same set of governing equations as the interfoam solver berberović et al 2009 klostermann et al 2012 but includes all necessary features of dynamic meshes such as automatic mesh motion and data mapping jasak and tuković 2010 in this experiment the wave maker sent the single asymmetric wave into the domain for the first 42 s of the experiment the resulting wave length is about twice larger than the length of the 3d wave basin and the reflected wave from the breakwater reached back to the wave maker while the incident wave was still being generated with dynamic mesh capabilities interdymfoam is able to directly simulate wave maker motions by specifying the temporal displacement of the moving wall x w m used in the physical experiments fig 2 meshes were re constructed following the deformed domain at each time step and the resulting flow fields on the newly re constructed mesh were interpolated gauss theorem is applied to convert the advection terms of eq 2 into surface integrals for each cell then the fluxes of mixture fluid are calculated using a second order upwind scheme warming and beam 1976 for the diffusion terms second order central difference scheme and non orthogonal correction jasak 1996 are applied to discretise and adjust the resulting fluxes for time integration an implicit second order backward scheme is applied each time step of the model is controlled by the courant friedrichs lewy condition defined as 11 c 0 u i δ t δ c m a x where c 0 is the courant number and δ t is an automatically adjusted time step to satisfy the numerical stability and optimise computational cost c m a x 0 4 is used where preliminary tests produced nearly identical results for 0 2 c m a x 0 5 not shown here the numerical model is fully parallelised with message passing interface with the wall clock time approximately being about 300 h using 100 processors 2 8 ghz ivy bridge ep e5 2680 xeon for each 500 s run see also section 4 1 more details on the numerical solver can be found in rusche 2002 and klostermann et al 2012 4 model application 4 1 model setup the 3d numerical model domain was identical to the physical model described in kalligeris 2017 in a preliminary numerical experiment we found that orthogonality of the mesh is critical in minimising spurious free surface fluctuations due to numerical errors which will be discussed in section 4 3 hence a rectangular mesh was constructed with a uniform grid size of 2 75 cm in the vertical bed normal direction z and of 8 23 cm in the two horizontal directions x y where the x y direction is defined to be perpendicular parallel to the wave maker the grid size ratio between δ x δ y and δ z is controlled to be less than 3 to minimise the numerical instability the grid nodes near the breakwater were removed and replaced with a boundary fitted unstructured triangular mesh see fig 1b and c using a tool called snappyhexmesh jackson 2012 as a result a total number of 4 8 million grid points was used in the simulation the corresponding z units applied to eq 10 have the order of o 1 0 2 where z h 1 375 cm for the bottom wall and z h 4 115 cm for the side walls the quality of the present numerical resolution in resolving turbulent energy cascade is further discussed in section 5 4 no flux boundary condition was specified for fluid pressure and the wall normal velocity component and wall parallel velocity components were set to no slip boundary conditions to generate more turbulent realisations and carry out appropriate ensemble averaging three numerical simulations were carried out using slightly different surface tension coefficients σ which may represent small variabilities in water properties the selected σ values were 0 070 kg s 2 35 c for run 1 0 071 kg s 2 30 c for run 2 and 0 072 kg s 2 25 c for run 3 see eq 2 the weber w e ρ w u 2 d σ and bond b o ρ w g d 2 σ numbers for the selected σ are on the orders of o 10 2 and o 10 3 assuming the characteristic length d as the horizontal grid size i e d δ x and u 0 2 m s see also section 4 4 thus the inertial and gravitational forces are dominant compared to the surface tension forces and the perturbations in σ to trigger the nonlinear response of the navier stokes system in turbulent flow are considered to be adequate in this study it is worthwhile mentioning that a small perturbation such as a 0 004 of initial water volume change for a dam break flow was found to also trigger the nonlinear response of shallow turbulent flows in swash zone simulations kim et al 2017 4 2 main flow characteristics the entire simulation consists of several long wave induced vortex evolution stages consistent with kalligeris 2017 in which the vortex strength is illustrated using horizontal velocity u v vectors and the vertical component of vorticity ω z v x u y at the free surface fig 3 the model results within a distance of 0 5 m from the side walls and breakwater were excluded to better track the main vortices without the complication of the wall boundary layers it should be reiterated here that the offshore basin is assumed to be the area between the wave maker and breakwater and the rest of the area is defined as the inshore basin when the wave crest penetrated through the harbour channel between the breakwater and the side wall a clockwise vortex negative vorticity was generated at the inshore side of the wave basin fig 3a this inshore vortex that formed just downstream of the breakwater remained stationary until the flow direction in the harbour channel started to reverse stage 1 represents the inshore clockwise vortex generation stage t 40 s following the wave maker retreat an offshore directed vortex was generated with counter clockwise positive vorticity fig 3b stage 2 represents the offshore vortex generation stage 40 s t 78 s at the end of stage 2 t 78 s the offshore vortex detached from the trailing jet fig 3c and the vortex flow started to be more or less statistically identical in the azimuthal direction in the reference frame of the vortex centre the inshore vortex was flushed offshore and its opposite signed vorticity was integrated into the offshore vortex ring stage 3 is defined as the offshore monopolar vortex stage t 78 s the offshore vortex propagated away from the breakwater fig 3d as kinetic energy dissipation due to bottom friction became dominant the size of the offshore vortex increased through the diffusion model of vortex growth and it fully evolved into a monopolar vortex at later stage 3 fig 3e and f in the present study we will mainly focus on the evolution decay of the offshore eddy corresponding to 78 s t 500 s in the physical experiment the centre of offshore vortex x c y c was determined using two different methods kalligeris 2017 for the modelled results the method using the 70 contour of max ω z was adopted throughout the simulation the vortex paths from the physical experiment in each trial grey curves in fig 4 also see fig 5 in kalligeris et al 2021 and the model results in each numerical run using different σ blue red green curves in fig 4 show qualitatively similar features however the trajectory was not identical more careful examination suggests that the differences can be attributed to turbulent phenomena namely small perturbations trigger significantly different vortex paths due to the nonlinear navier stokes system it is widely known that the instantaneous turbulent flow shows acute sensitivity to small perturbations pope 2000 in this experiment r e was on the order of o 10 4 1 0 5 and the flow was fully turbulent with this large r e the nonlinear convection term in eq 2 becomes dominant and instantaneous flow fields were not completely identical nor repeatable due to the acute sensitivity to small but unavoidable perturbation in each trial run thus the model validation was conducted only at the earlier stage with stationary data section 4 3 for the later stage turbulence averaged flow quantities were utilised for the model validation section 4 4 and further analysis section 5 4 3 model validation with stationary data the wave energy spectra e η η f corresponding to the numerical and laboratory free surface elevation data are analysed and compared to find out whether the numerical model captures both intermediate and low frequency flow motions fig 5 using the fourier transform of the free surface elevation η auto correlation function r η η ς e η η f is calculated as 12 e η η f 2 r η η ς exp i 2 π f ς d ς where r η η ς 0 t ς η t η t ς d t in which t was set to be equal to the simulation duration i e t 500 s the inverse of eq 12 can be also written as 13 r η η ς 1 2 e η η f exp i 2 π f ς d f in the numerical simulation results the instantaneous water depth h was calculated using the vertically integrated volumetric concentration of water phase h x y t ϕ w x y z t δ z post processed and the free surface elevation is then calculated as η h h 0 the major oscillation modes at each resonant frequency can be identified through the wave energy spectrum to find common resonant frequencies of the wave basin between the wave maker and the breakwater e η η is averaged over selected wave gauges and combining the three simulation results as 14 e η η 1 n j 1 n e η η j r u n 1 f e η η j r u n 2 f e η η j r u n 3 f 3 in which n 14 is the number of selected wave gauges for averaging in each run blue circles in fig 1a the model was able to capture the low frequency resonant mode at about t 74 87 s f 0 013 hz with almost identical wave energy compared with the measured data fig 5 this low frequency mode represents the fundamental sloshing mode and is significantly lower than that of the wave generation interval t w 42 s f 0 024 hz as we will discuss in section 5 1 the resonant modes may affect the 3d recirculation patterns of the offshore tcs the model also captured the second peak at t 23 04 s f 0 043 hz which is nearly half of the wave generation interval however the model results over predict the wave energy at this frequency by 123 when compared with the measured data a closer examination revealed that the wave motion in the present 3d wave basin is very sensitive to the wall and bottom boundary conditions used in order to resolve the wall and bottom boundary layers the criteria generally require the grid size normalised as wall unit z to be smaller than the viscous sublayer z 5 which is of sub millimetre scale in the present flow conditions due to limited numerical resolution in the present les study δ z 2 75 cm a near wall modelling approach was adopted which introduces additional model assumptions and affects the model accuracy applying near wall modelling with the current numerical resolution of z o 1 0 2 may induce less energy dissipation at the boundaries due to friction the agreement between model results and measured data in intermediate frequency bands 0 043 hz f 0 1 hz is good i a 0 701 however model results also show several peaks in the high frequency band f 0 1 hz which are stronger than the measured data fig 5 this may be a limitation of the interface compression scheme used the interface compression scheme applied here is computationally efficient and has been proven to be accurate in resolving nonlinear wave motion in the depth limited breaking waves e g kim et al 2017 zhou et al 2014 2017 however this approach seems to be limited for low energy wave motion relatively small amplitude wave motions after t 100 s in which numerically induced surface fluctuations start to become significant in addition dynamic mesh induced discretisation errors may also play a role e g dunbar et al 2015 bruinsma et al 2018 as briefly discussed in section 4 1 a preliminary test case which adopted a non orthogonal mesh a maximum angle of 27 between the structure and the grid under similar numerical resolution showed even stronger high frequency oscillations see red dashed curve in fig 5 nevertheless it should be noted that the energy contained in the high frequency range f 0 1 hz was one to two orders of magnitude smaller than that in the low frequency range f 0 1 hz therefore the main flow characteristics should not be affected by the limited ability of the interface compression scheme that may enhance higher frequency motions the temporal evolution of η is used for the model validation where 12 wave gauges are selected among the 432 different locations red circles in fig 1a in order to rule out the small scale turbulent fluctuations in the comparison both the measured and modelled free surface elevation time series were low pass filtered using a butterworth filter with a cutoff frequency of 0 1 hz fig 6 it should be pointed out that the recorded free surface elevation time series at each location were not ensemble averaged over the repeated trials as the wave gauges were moved to a new position for each trial hence the simulation results from three runs were not ensemble averaged for a fair comparison the time series of η for run 1 3 had similar trends thus only run 2 results are shown here for brevity to quantify the agreement between model results and measured data normalised root mean square error nrmse and index of agreement i a willmott and wicks 1980 and willmott 1981 are used to demonstrate the mean of squared errors with respect to the range of measured data and similarity of trend bounded between 0 disagreement and 1 agreement respectively overall η was well captured by the numerical model with 0 929 fig 6a and c i a 0 975 fig 6e and 5 9 fig 6e nrmse 11 2 fig 6c throughout the entire wave basin although high frequency fluctuations of η were filtered out the model results still show slightly larger oscillations compared to the measured data fig 6 this is consistent with the wave energy spectrum observations fig 5 and it may be due to the relatively coarse numerical resolution used near the walls in conjunction with the near wall modelling applied which caused an overall underestimation of friction along the side walls breakwater and bottom two horizontal components of low pass filtered velocity u v using a cutoff frequency of 0 1 hz are compared at three adv locations in fig 7 again the experimental adv data were obtained from a single trial hence they are compared only with the model results from run 2 the overall agreement of u is good based on i a nrmse values of 0 899 10 0 0 870 12 8 and 0 953 7 3 for advs 1 3 respectively fig 7a c the agreement of v at adv3 is less satisfactory fig 7f since i a 0 406 and nrmse 27 4 adv3 is located very close to the side wall 6 8 cm away from the side wall where the model does not have sufficient numerical resolution to resolve the side wall turbulent boundary layer model results for v match the measured values well for adv1 adv2 with i a 0 927 0 945 and nrmse 13 2 10 2 fig 7d and e in general vertical velocity w has a much smaller magnitude than the two horizontal velocity components two orders of magnitude and is dominated by turbulent fluctuations thus the w velocity component was not considered in the model validation it should be noted here that both measured data and model results have diverged vortex trajectories in each trial run due to the chaotic nature of fully turbulent flows thus discrepancies may arise in the comparison between measurements and model results due to random nature of turbulent flow at fixed locations a more detailed model data comparison on the turbulence averaged velocity field of the offshore monopolar vortex is presented in the following section 4 4 model validation for tcs centred free surface velocity around the detached offshore vortex core the flow field for t 78 s is assumed to be statistically homogeneous in the azimuthal direction it allows to compare modelled azimuthal averaged or ensemble azimuthal averaged flow quantities to available theories for monopolar vortices e g satijn et al 2001 van heijst and clercx 2009 seol and jirka 2010 first the horizontal velocity fields u v were converted from cartesian coordinates to cylindrical coordinates u θ u sin θ v cos θ u r u cos θ v cos θ where u θ and u r are the azimuthal and radial velocity components θ arctan y y c x x c and x c and y c are the vortex centre coordinates in each time step the vortex centre velocity u c f v c f on the free surface of order o 1 0 1 m s was subtracted to obtain the stationary velocity components in cylindrical coordinates 15 u θ c r θ z t u r θ z t u c f t sin θ v r θ z t v c f t cos θ 16 u r c r θ z t u r θ z t u c f t cos θ v r θ z t v c f t sin θ where r is the radius from the vortex centre to increase the number of realisation for calculating averaged flow quantities we further propose an ensemble azimuthal average denoted as a in which a and represent ensemble average and azimuthal average respectively 17 u i c 1 n j 1 n u i j c r d r r r d r θ z t where i r θ z and n is the total number of data points combining run 1 3 inside annuli with width d r of 0 25 m consistent with kalligeris 2017 to find out whether sufficient realisations were available via ensemble azimuthal averaging u θ c and u r c at r 1 m on the free surface z η at three different instants t 100 s 300 s and 500 s are shown in fig 8 with an increase in number of data points in ensemble azimuthal averaging u θ c and u r c were converged to a fixed value particularly at the later stage of the vortex evolution fig 8b c e f it was found that u θ c and u r c had larger variabilities at earlier stages t 100 s due to the fact that the tcs had not fully evolved into a monopolar vortex shape yet fig 8a and d most importantly the numerical results suggest that flow characteristics based on the centre of the vortex have statistically converged regardless of the slightly different vortex centre trajectories at later times see fig 4 in summary it is deemed appropriate to use ensemble azimuthal averaging for examining the tcs dynamics for t 78 s the capability of the model to reproduce the measured ensemble azimuthal averaged flow field of the offshore tcs is illustrated in fig 9 through the comparison of u θ c r η t profiles eqs 15 and 17 at nine instants throughout the simulation overall the predicted u θ c profiles agree well with measured data with 0 827 fig 9a i a 0 953 fig 9b and 5 9 fig 9b and c nrmse 12 5 fig 9i the model is able to predict the radius corresponding to maximum u θ c r r v m a x 0 97 m however the magnitude of maximum u θ c is over predicted by about 20 for t 150 s this discrepancy can be attributed to the adopted near wall model as mentioned earlier the high frequency wave energy predicted by the model is larger than that observed in the wave basin due to insufficient friction at the boundaries likewise the bottom boundary layer numerical implementation resulted in the underprediction of the kinetic energy decay of the offshore vortex profiles of the vertical component of vorticity calculated from cartesian grid points are ensemble azimuthal averaged ω z r t and compared with measured data in fig 10 the model is able to capture the exponential decay of ω z moving away from the core with respect to r axis also note the vertical axes in fig 10 are in logarithmic scale however the maximum ω z at the vortex core r 0 was underpredicted and the maximum nrmse was calculated as added 27 9 at t 100 s fig 10a at later times the discrepancies at the vortex core decrease and nrmses tend to be lower as the vortex kinetic energy gets dissipated 5 discussion 5 1 secondary flow characteristics besides the main flow field characterised by the azimuthal velocity component the offshore vortex flow field also consists of radial and vertical velocity components these secondary flow components which are relatively minor compared to the azimuthal velocity generate 3d recirculation patterns in the tcs flow field fig 11 shows the temporal evolution of free surface elevation at the vortex core η c for run 2 it should be noted that the vortex core location in each ensemble also varies in the physical experiment see fig 4 hence the symbols in fig 11 represent the minimum η c near the ensemble averaged vortex core location in general both measured data and modelled results illustrate gradually recovering η c as the main vortex flow field slows down thus an upwelling feature is expected at the core according to the free surface boundary condition i e w η t dean and dalrymple 1991 in a longer temporal scale of the monopolar vortex decay however we can clearly observe higher frequency free surface fluctuations in the modelled results which suggest the existence of shorter temporal scale o 10 s recirculation patterns which will be discussed next the recirculation patterns along the r z plane are related to the main tcs flow structure and the superposition of secondary tcss fig 12 shows the r z plane snapshots of ω θ overlaid with u r w velocity vectors for run 2 at different instants positive ω θ u r z w r denotes clockwise rotation an upwelling at the vortex core r 0 m is clearly illustrated at the early stage of the monopolar vortex fig 12a consistent with the expectation from the free surface recovery at the core fig 11 near the bottom a persistent inward radial flux towards the vortex core exists which appears to be causing upwelling motions near the core r 1 m however the direction of w at the core frequently switched between upwelling fig 12a and d and downwelling fig 12b and c at later time we found that the frequency of upwelling and downwelling motions at the core coincided with the low frequency resonant modes shown in fig 5 exhibiting peaks at t 23 04 s and 74 87 s sloshing inside the 3d wave basin was observed in both the physical experiments and numerical simulations see fig 5 sloshing and 3d flow recirculation around the tcs centre creates nonlinear interactions that may result in turbulence production due to flow shear in the water column also see section 5 4 even though the amplitudes of the resonant modes were almost identical compared to the physical experiments and among the three numerical runs smalls perturbations can cause the divergence of the vortex centre trajectory for each run and also affect the radial velocity component of the vortex flow field as a result there was no clear trend observed in the radial component of azimuthal averaged velocity u r c profiles results from each of the three numerical runs were different fig 13 unlike the primary velocity component u θ c in general on the free surface the ensemble azimuthal averaged measured data showed inward velocity i e u r c 0 within r 2 m while modelled u r c were mostly outward curves in fig 13 in the physical experiment the imbalance between the centrifugal and the gravitational acceleration may have resulted in an inward motion that led to the accumulation of tracers at the tcs centre kalligeris 2017 the discrepancy between modelled and experimental u r c profiles can be attributed to the fact that the true radial velocity of the fluid could not be extracted accurately from the experimental data without the additional information from the z coordinate of the surface tracers 5 2 quasi 2d flow shallow environmental flows exhibit quasi 2d flow characteristics due the vertical confinement although small vertical dependence may still exist in nearshore flows due to bottom friction flow shear in the water column and free surface fluctuations as shown in fig 12 in such conditions depth integrated hydrodynamic models such as boussinesq type models e g wei et al 1995 kaihatu and kirby 1998 watts et al 2003 lynett 2006 can adequately describe the dynamics of nearshore flows furthermore the majority of simple parameterisations and analyses for monopolar vortices are based on quasi 2d flow conditions e g satijn et al 2001 van heijst and clercx 2009 seol and jirka 2010 since only 3d models are able to accurately describe the effect of 3d sub structures on the 2d underlying flow it is important to examine the complete 3d velocity statistics of the long wave induced tcs to quantify the two dimensionality of the flow field around a monopolar vortex the ratio of kinetic energy between the secondary and primary flow components can be used satijn et al 2001 suggested that flows are under quasi 2d conditions if e k z t e k θ t and e k r t e k θ t are below o 1 0 2 where the kinetic energy of the monopolar vortex for each velocity component is defined as 18 e k i t 2 π 0 h 0 r 1 2 ρ u i c 2 r d r d z where i r θ z for the integration of eq 18 on r axis the horizontal extent of the vortex r 4 r v m a x was kept as a constant i e r 4 m to exclude the influence from the side boundaries where r v m a x was found to be a more or less constant up to 500 s see also kalligeris 2017 in the model results using the ensemble azimuthal averaged velocity profiles e k r e k θ is predicted to be about o 1 0 1 further analysis suggests that even without vertical integration e k r e k θ is also about o 1 0 1 at any given elevation therefore the kinetic energy in the radial component is about one order of magnitude smaller than the corresponding azimuthal component fig 14a on the other hand e k z e k θ is below o 1 0 2 fig 14b indicating that the vertical motions are sufficiently constrained to represent quasi 2d flow conditions in the physical experiment horizontal velocity fields were only obtained at the free surface without the vertical velocity field hence the depth integration of the complete velocity fields could not be performed without the vertical integration it was demonstrated that measured e k r e k θ was below o 1 0 2 at all times which is one order of magnitude smaller than the model results the discrepancy could be due to the aforementioned force balance causing inward directed tracer motions cancelling outward directed flows at the free surface we can further demonstrate the shallow tcs features in the resulting flow field using a velocity spectrum the one dimensional 1d velocity spectra e u i c u i c are defined using the fourier transform of the demeaned velocity auto correlation r u i c u i c pope 2000 19 e u i c u i c κ r 1 π r u i c u i c ξ exp i κ r ξ d ξ where i r θ z κ r 2 π r r u i c u i c ξ u i c r u i c r ξ in which u i c u i c u i c likewise the inverse of eq 19 can be also written as 20 r u i c u i c ξ 1 2 e u i c u i c κ r exp i κ r ξ d κ r in order to obtain the spectra following eqs 19 and 20 the velocity fields are interpolated along straight lines parallel to the r direction penetrating the centre of vortex at 5 angle intervals it should be noted that the most homogeneous flow characteristics are in the azimuthal direction and hence the coherent motions can be estimated on the κ r axis to obtain a smooth profile e u i c u i c was averaged over individual lines combining three runs as 21 e u i c u i c κ r 1 n j 1 n e u i c u i c r u n 1 κ r j d θ e u i c u i c r u n 2 κ r j d θ e u i c u i c r u n 3 κ r j d θ 3 where d θ 5 n 36 the mid depth z h 0 53 1d velocity spectra at selected time steps are shown in fig 15 here we estimated the characteristic size of eddies l 0 by calculating the first zero crossing point of r u i c u i c on the r axis by further carrying out time average with data from three runs we obtained l 0 0 63 m which is approximately one order of magnitude larger than the grid size used in the simulations the 3 slope is apparent in the transverse spectra e w w at later stages t 300 s see fig 15b c d for large wave numbers κ r 2 π l 0 which represent vertically confined turbulent motions uijttewaal and booij 2000 uijttewaal and jirka 2003 sou et al 2010 kim et al 2017 on the other hand the azimuthal velocity spectra e u θ c u θ c remain isotropic and follow a 5 3 slope the resolved velocity fields demonstrate the quasi 2d turbulence characteristics of wavenumber spectra particularly at later times as shown in fig 15 the adopted numerical resolution was able to resolve the small scale turbulent kinetic energy tke cascade as well as the large scale flow motions within a wavenumber range of three to four orders of magnitudes thus main characteristics of turbulent energy spectra were reproduced using the resolved velocity fields however it should be pointed out that the range of the relatively constant slope in the cascade is less than two orders of magnitude due to the limited horizontal grid resolution in the present large wave flume experiment 5 3 bed shear stress the bed shear stress τ b accompanying long wave generated tcss is a key factor to explain the considerable seafloor scouring documented to occur during tsunami events wilson et al 2012 admire et al 2014 sakakiyama et al 2011 reported significant bed morphological evolution induced by a vertical vortex in a laboratory experiment with similar setup to the present study highly intermittent local scour occurred due to a strong rotating current with the location of scour following the vortex position for monopolar vortices in quasi 2d flow conditions depth averaged horizontal velocity u h can be used to parameterise τ b using the quadratic law 22 τ b x y t 1 2 c f u h 2 x y t where c f is an empirical bed friction coefficient and u h u r 2 u θ 2 in which u i is the depth averaged velocity i e u i 0 η u i d z where i r θ without subtracting the vortex centre velocity to include the effect of vortex propagation since u θ u r and kinetic energy decay is dominated by τ b the decay of peak depth averaged azimuthal velocity u θ t m a x follows seol and jirka 2010 23 u θ t m a x 1 1 u θ t r m a x c f 2 h 0 t in which t r is a reference time in order to find the best fitting c f in eq 23 the decay of modelled u θ t m a x was used between 100 s t 500 s with t r 100 s the best fitting c f is 0 0062 with i a 0 992 and nrmse 2 7 for run 1 not shown here and 0 0066 with i a 0 998 and nrmse 1 4 for run 2 fig 16a and 0 0063 with i a 0 978 and nrmse 1 7 for run 3 not shown here while for the measured data the optimal c f is 0 01 using velocity information on the free surface kalligeris 2017 this discrepancy was due to a slightly over predicted u h in the numerical simulation on the other hand a direct estimation of the bottom shear stress can be obtained from the numerical simulation results as 24 τ b x y t ρ u τ 2 x y t where u τ was calculated using the near wall modelling eq 10 at the closest grid point adjacent to bed for the numerical resolution adopted in this study the bottom cells were often in the log law layer z o 1 0 2 similar to fig 16a the decay of azimuthal averaged maximum bed shear stress τ b t m a x is illustrated in fig 16b in general the directly modelled τ b t m a x based on eq 24 was about 50 smaller compared to the parameterised results eq 22 however the decay trends are more or less similar and they are on a same order of magnitude fig 16b the x y plane snapshots of parameterised τ b eq 22 and modelled τ b eq 24 for run 2 are compared at different instants in fig 17 in general τ b obtained using the quadratic law fig 17a c e and using the near wall modelling fig 17b d f are very similar large τ b of o 1 0 0 pa was observed near the vortex centre at early stages t 100 s see fig 17a and b while the overall magnitudes decreased following the decay of u θ t m a x in time see fig 16 results shown here further confirm that the bulk features of u h are more or less equivalent to those of bed parallel velocity at the bottom cells u h and namely the 2d nature of the monopolar vortex flow field however it should be noted that the spatial distribution of τ b relative to the centre of vortex was not purely axisymmetric due to irregular and intermittent patterns of turbulent flow processes as well as the presence of vertical boundaries propagating vortex centre and basin sloshing 5 4 turbulence characteristics the temporal and spatial evolutions of tcss are vital information to better understand the characteristics of turbulent flows for instance the evolution of 2d rollers into obliquely descending eddies under breaking waves in the surf zone nadaoka et al 1989 ting 2008 2013 are shown to often approach the seabed and increase the near bed tke level e g zhou et al 2014 2017 to identify offshore monopolar tcss the λ 2 visualisation method jeong and hussain 1995 was adopted to represent tcss for the selected eigenvalues of s i j s i j ω i j ω i j where s i j and ω i j ω i j are symmetric and asymmetric velocity gradient tensors respectively fig 18 shows x c y c plane snapshots of λ 2 for run 2 at different elevations each row in fig 18 presents λ 2 at the free surface first row at mid water column second row and at the bottom most cells just above the bed third row the main flow structure represented by λ 2 was the axisymmetric 2d vertical vortex which was apparent particularly at the free surface at the free surface the swirling strength simply represents the vortex core fig 18a c however in the middle of the water column secondary tcss around the core can be clearly seen fig 18d f most of these secondary tcss also extend close to the bed represented in fig 18g i by spots of large magnitude of λ 2 the absence of secondary tcss on the free surface implies three dimensionality of secondary tcss which may be generated by flow recirculation see discussion below it is important to point out that the bottom patterns of tcss are not directly correlated with τ b patterns fig 17 for two main reasons first λ 2 shows the contour of vortices where the peak vorticity occurred at the core while the peak u θ was observed approximately 1 m away from the core secondly the modelled u τ was calculated only based on the log law of the wall correlated with near bed velocity without considering the direct effect from tcss approaching the bed this limitation may lead to the underestimation of τ b for sediment transport applications the comprehensive incorporation of the influence of tcss on τ b for sediment transport applications requires future investigation it is essential to examine tke turbulence production and turbulence dissipation rate to fully understand the evolution and impact of tcss it is well known that in the log law region of a boundary layer turbulence production is in balance with turbulence dissipation however it has been found that a local balance between turbulence production and turbulence dissipation rate is not valid for more complex and transient flows such as swash flows sou et al 2010 kim et al 2017 hence it is of interest here to investigate this issue for long wave induced tcss using the simulation results the resolved tke per unit mass k for each run is computed by averaging the resolved velocity fluctuation fields u θ u r w over the azimuthal direction as 25 k r z t 1 2 u i u i where u i u i u i with i r θ z the total turbulence production p consisting of resolved turbulence production p r e s and sub grid turbulence production p t s is computed as pham and sarkar 2014 kim et al 2017 26 p r z t p r e s r z t p t s r z t u i u j s i j 2 ν s g s s i j s i j where i j r θ z and s i j is the fluctuating strain rate tensor the numerical resolution used in the present study resolved about two orders of magnitude of energy cascade and hence the resolved turbulence production accounts for more than 95 of the total turbulent production i e p r e s p t s for all three runs likewise the turbulence dissipation rate is calculated pham and sarkar 2014 kim et al 2017 as 27 ε r z t ε r e s r z t ε t s r z t 2 ν s i j s i j 2 ν s g s s i j s i j in which ε r e s and ε t s are resolved and sub grid turbulence dissipation rates respectively for the turbulence dissipation rate ε t s was the dominant term since turbulence dissipation occurs at very small scales i e kolmogorov scale i e ε r e s ε t s was found for all three runs the structure of turbulence in the water column for run 2 is illustrated in fig 19 using the r z plane snapshots of k p and ε to indicate the variability of free surface azimuthal averaged water depth h and maximum h m a x and minimum h m i n water depth in azimuthal direction are also shown it should be noted that high ε and p observed between h m a x and h m i n is fictitious since it is induced by averaging the flow quantities along with the fluctuating free surface in the azimuthal direction the vertical distribution of tke is relatively uniform fig 19a b c compared to p and ε in general some variabilities of k is observed in the r direction where the overall magnitude of tke gradually decreases at very early stages fig 19a at later stages fig 19b and c the magnitude of k remains constant and its distribution becomes more uniform on the other hand the spatial distribution of turbulence production is spatially inhomogeneous due to the secondary tcs motions fig 19d e f several hot spots of p were caused by high local flow shear associated with the recirculation patterns see fig 12 high values of ε are mostly located near the bottom hence the turbulence is predominantly dissipated by the bottom friction fig 19g h i simulation results provided here suggest that a high vertical variability of higher order turbulence statistics exists even in shallow 2d turbulent flows moreover we can qualitatively observe that p is significantly larger than ε throughout the 500 s of simulation this is expected as in the physical experiment the entire vortex evolution lasted until t 3000 s the vertical distribution of p and ε and the imbalance between these two quantities can be examined via the radial averaged turbulence production p r z t 1 r 0 r p r z t d r and dissipation rate ε r z t 1 r 0 r ε r z t d r where r was kept as a constant r 4 m consistent with section 5 1 fig 20 shows p r and ε r of run 1 3 at four different instants i e t 100 300 400 and 500 s similar to fig 19 the vertical profiles of p r fluctuated significantly particularly p r of run 1 3 were quite different at some instants fig 20c and d because of different vortex trajectories which results in distinct recirculation patterns in general p r was observed to be more uniformly distributed along the water column with a magnitude of o 1 0 3 m 2 s 3 at early stages and it drops to about o 1 0 4 m 2 s 3 at the end of the 500 s simulation on the contrary the vertical profiles of ε r are more similar for run 1 3 throughout the simulation unlike turbulent production ε r is largest near the bed and its magnitude decays by one or two orders of magnitude moving away from the bed it implies that bottom friction is a constant sink of tke also see fig 19 throughout the 500 s of simulation p r was about one or two order of magnitude larger than ε r higher up in the water column but the difference becomes much smaller approaching the bed thus p r and ε r are more likely balanced near the bed if sufficient numerical resolution is used to resolve the near bed bottom boundary layer however recirculation induced p r remains the dominant turbulence generation mechanism up to 500 s it indicates that turbulence dissipation for shallow monopolar vortices is a slow process it is expected that the excessive tke will eventually dissipate when the stage of ε r p r is reached therefore we can conclude that the structures of k p and ε are dissimilar and the simple balance p ε is not satisfied in space and time these issues need to be taken into account if the goal is to model turbulent mixing and sediment transport associated with shallow tcs the maximum and minimum ε r are about o 1 0 6 m 2 s 3 and o 1 0 4 m 2 s 3 and the kolmogorov length scale ζ ν 3 ε 1 4 is between 0 3 mm and 0 1 mm the eddies are assumed to enter the inertia subrange at l 0 6 l e i l 0 and dissipation range at l d i 60 ζ pope 2000 where 106 mm l e i 630 mm and 19 mm l d i 60 mm hence the grid size adopted in this study 27 5 82 3 mm is close to the inertia subrange 6 conclusions a numerical investigation of long wave induced tcss was carried out using a 3d les approach on a dynamic mesh standard smagorinsky sgs closure was used in the present study the numerical model was validated with experimental data kalligeris 2017 for free surface elevation mid depth velocities azimuthal velocity at the free surface and vertical vorticity at the free surface model results showed good agreements for the velocity fields i a 0 7 the ensemble azimuthal averaging throughout the water column was proposed as a turbulence average operator for the monopolar vortex flows and verified with the measured data model results were further used to reveal turbulence characteristic of long wave induced tcss it was found that the long wave induced tcss are vertically suppressed identified by kinetic energy ratio and wavenumber spectrum analysis the vertical component of kinetic energy was found to be below 1 of the azimuthal component however the radial component is not negligible having about 10 of azimuthal kinetic energy using the resolved turbulent flow fields a 3 slope in the transverse power spectra was observed at later stages at a high wavenumber range which is distinctly different from the well known 5 3 slope for isotropic turbulence thus model results indicate that the long wave induced tcss are under quasi 2d flow conditions the bed shear stress was parameterised using the decay of depth averaged peak azimuthal velocity using the depth averaged momentum equation the quadratic law was applied to find the best fitting bed friction coefficient the resulting parameterised bed shear stress was consistent with the modelled bed shear stress obtained from the near wall modelling this suggests that the bed shear stress dominantly dissipates the kinetic energy of the offshore monopolar vortex however slight underprediction of bed shear stress in the model results could be due to ignoring a complex interaction of secondary tcss with the bed and lateral boundaries it was found that the spatial distribution of bed shear stress was not simply axisymmetric partially due to seemingly random velocity fluctuations tke turbulence production and turbulence dissipation rate were directly calculated from the resolved flow fields tke was spatially well distributed compared to the other quantities high turbulence dissipation was observed near the bed throughout the simulation also indicating that the bottom wall friction is the main sink of momentum for tcss the turbulence dissipation rate decayed exponentially from o 1 0 4 m 2 s 3 to o 1 0 6 m 2 s 3 however turbulence production was overall one order larger than the turbulence dissipation rate up to 500 s and had a unique spatial distribution hence a local equilibrium of turbulence was not valid for long wave induced tcss in this simulation the turbulence production was locally generated via shear instability and was often concurrent with the recirculation patterns the recirculation patterns were correlated with upwelling and downwelling motions highly affected by the low frequency resonant modes of the wave basin declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is supported by nsf usa oce 1635151 oce 1756714 cmmi 1135026 and office of naval research usa n00014 17 1 2796 numerical simulations presented in this study were carried out using the mills cluster at university of delaware and the supermic cluster at louisiana state university via xsede tg oce100015 the case setup to reproduce the same results is publicly available via community surface dynamics modeling system csdms model repository maintained by github https github com sedwavefoam wave induced shallow water monopolar vortex 
23903,detailed flow and turbulence characteristics of a long wave induced shallow water monopolar vortex are investigated using a 3d large eddy simulation the numerical model is validated with measured data where nearly 2d shallow turbulent coherent structures were generated by sending a single asymmetric wave through a harbour channel in a large 3d wave basin model results demonstrate that the vortex centre trajectory is sensitive to small perturbations applied via a surface tension coefficient instantaneous model results are averaged over three numerical runs with slightly different surface tension coefficients so that a sufficient number of realisations are obtained for ensemble averaging because of shallow water depth flow fields are dominated by a horizontally rotating current and vertically suppressed velocities resembling quasi 2d flow conditions bed shear stress calculated using the decay of peak azimuthal velocity is qualitatively similar to that obtained using a near wall modelling method although 2d turbulent coherent structures evolve into monopolar vortices at later stages flow is not completely axisymmetric due to secondary turbulent coherent sub structures located in the middle of the water column and away from the core turbulence production and turbulence dissipation rate demonstrate a local imbalance where turbulence is mainly produced by flow shear correlated with recirculation patterns while turbulent kinetic energy is predominantly dissipated near the no slip bottom boundary while the free surface elevation at the vortex core indicates an upwelling pattern consistent with laboratory experiments model results show evidence that the recirculation pattern is influenced by a low frequency resonant mode of the wave basin graphical abstract keywords monopolar vortex large eddy simulation quasi 2d flow turbulence recirculation 1 introduction bays and harbours are vital to coastal communities providing recreational economic and coastal protection benefits however various essential coastal infrastructures in bays and harbours e g breakwater and quay wall are vulnerable to episodic wave events e g tsunamis for instance large horizontal eddies frequently called whirlpools have been observed and recorded after tsunamis e g choi et al 2008 wilson et al 2012 admire et al 2014 5 argued that strong currents driven by large offshore eddies can bring a considerable impact and damage to harbour areas these tsunami effects can persist for several hours which may be accompanied with coastal inundation thus the characteristics and evolution of these long wave induced vorticial currents interacting with surrounding boundaries require comprehensive investigation significant damage from eddies was observed in many ports and harbours after the 2004 indian ocean tsunami e g okal et al 2006a b c most importantly a ship moored in the port of salalah oman spun and drifted for a significant distance in the vicinity of the port the trajectory of the ship followed the eddies which were generated inside the harbour after the arrival of the 2004 indian ocean tsunami and migrated offshore okal et al 2006a this event clearly shows that the eddies induced by long waves can cause the uncontrolled drift of ships which in turn can cause critical damage to infrastructure or ships lynett et al 2012 2014 suggested that a tsunami induced horizontally sheared rotating current generated by the interaction between vertical coastal structures and topographical fluid jets was the main cause that the ship broke its mooring in port salalah instead of free surface fluctuations recently large scale laboratory experiments were carried out to investigate the dynamics of a long wave induced shallow monopolar vortex generated at the edges of hard boundaries such as a breakwater kalligeris 2017 in the experiment the passage of a long wave through a narrow port entrance generated horizontal shear and vertical vorticity that drives two dimensional 2d turbulent coherent structures tcss that contain 3d sub structures the extensive data set collected during the experiment allows to study the generation growth and decay of long wave induced shallow tcss this study further showed that kinetic energy decay and spatial growth of long wave induced shallow tcss followed the first order vortex model of seol and jirka 2010 the primary rotating current of the long wave induced shallow tcss matches well with the theoretical α profile for a monopolar vortex van heijst and clercx 2009 tcss represent turbulent eddies that are instantaneously coherent in space and they can be expressed using velocity or vorticity fluctuations hussain 1983 in general tcss are 3d and evolve into sub structures through energy cascade in sufficiently shallow water however flow and turbulence fields are vertically confined e g batchelor 1969 sou et al 2010 kim et al 2017 tcss can be dominated by 2d features in nearshore environments when the water depth h is relatively small compared to the wave length l 2 π k i e k h 1 jirka 2001 in such conditions they are often called shallow tcss e g negretti and socolofsky 2005 dolzhanskii et al 1992 argued that the two dimensionality of shallow flows mainly depends on the reynolds number r e and bottom friction turbulence in quasi 2d flows can be characterised by the 3 power law in the turbulent kinetic energy spectrum denoted as the enstrophy integral of vorticity squared transfer regime lindborg and alvelius 2000 uijttewaal and booij 2000 uijttewaal and jirka 2003 in this regime enstrophy is transferred from large to small scales while the vortex stretching is confined the 3 slope is distinct from the typical 5 3 spectrum slope for isotropic turbulence based on the kolmogorov hypothesis pope 2000 this 3 slope has been found in wavenumber spectra in the swash zone during uprush in both measured data sou et al 2010 and large eddy simulation les results kim et al 2017 depth integrated and depth resolving numerical models have been adopted to study shallow tcss kim and lynett 2011 son et al 2011 williams and fuhrman 2016 larsen et al 2017 a fully nonlinear boussinesq type model for weakly dispersive and rotational flow using a long wave perturbation approach was derived kim and lynett 2011 and revealed that the dispersive stress plays an important role for energy transfer in a shallow mixing layer the nonlinear boussinesq type model was coupled the with the shallow water solver for tsunami generation and propagation in the open ocean son et al 2011 that is capable of reproducing the local dynamics experienced in the port of salalah oman induced by the 2004 indian ocean tsunami okal et al 2006a to resolve a vertical flow structure a reynolds averaged navier stokes so called rans model with a transitional two equation k ω turbulence model was also proposed williams and fuhrman 2016 with additional bedload and suspended load descriptions larsen et al 2017 demonstrated that the tsunami induced scour processes can be limited by finite wave boundary layer thickness compared to the aforementioned numerical models the main advantage of an les model is that unsteady motions larger than a pre determined grid scale is directly resolved in the entire water column thus a more complete understanding of turbulent characteristics such as the evolution of a tcs cascade of turbulent kinetic energy and dissipation and the vertical flow structure can be obtained for instance many les studies have successfully revealed the tcss induced by wave breaking processes in the surf zone e g christensen and deigaard 2001 watanabe et al 2005 lubin et al 2006 derakhti and kirby 2014 for tsunami like long waves les has also been adopted to provide more detailed information for the instantaneous turbulent flow feature where large scale unsteadiness is significant wu and liu 2008 introduced a numerical model that can be applied to landslide generated tsunamis under the solitary wave zhou et al 2014 showed the evolution of rollers into 3 d hairpin vortices due to wave breaking and their touch down onto the bed when the solitary wave interacts with a cuboid structure it was also revealed that primary vortex tubes generated at the leading and trailing edges of structures were stretched in the wave propagation direction accompanied with the formation of the secondary vortices arabi et al 2019 yao et al 2019 showed that wave run up is sensitive to reef morphology affecting vortex and current evolution the purpose of this study is to unravel the complexities involved in the dynamics of the long wave induced shallow monopolar vortex using les in particular since only surface velocities were measured in the physical experiment kalligeris 2017 les can provide the comprehensive 3d flow structure and turbulence characteristics in full depth at different stages of the vortex evolution albeit being computationally expensive the large scale laboratory experiments of this study are described in section 2 the mathematical formulations of the model and numerical implementations are presented in section 3 we devote section 4 to discuss model setup main flow characteristics and comprehensive model validation with the data collected from the physical experiment kalligeris 2017 a discussion on unique flow and turbulence characteristics of long wave induced tcss obtained from les is presented in section 5 lastly section 6 provides the main conclusions of this study 2 physical experiment an overview of the laboratory experiments of long wave induced shallow monopolar vortex is provided more details can be found in kalligeris 2017 the physical experiments were carried out in the 3d wave basin at the o h hinsdale wave research laboratory in oregon state university the 3d wave basin is 44 m long 26 5 m wide and the still water depth h 0 was set at 0 55 m a vertically walled breakwater was installed with a 27 angle to establish a gap of 3 1 m between the tip of the breakwater and the top side wall fig 1a which was optimised to generate a vertical vortex in the physical experiments side walls and bottom were made of polished concrete and the breakwater was covered with acrylic plexiglass sheets thus they are considered as impermeable and smooth boundaries the vertical scale in the physical experiment was set to be about 1 27 of the typical depth around 15 m at a port entrance channel a single asymmetric pulse resembling a leading elevation n wave tadepalli and synolakis 1994 was generated using a piston type wave maker with a single stroke and the resulting wave had a height h w of 4 6 cm period t w of 42 s and wave length l w of 97 6 m free surface elevation η was measured using twin wire capacitance wave gauges mounted on the instrumentation bridge of the wave basin with 27 repeated trials the free surface elevations at 432 different locations in total were measured to cover the entire wave basin grey circles in fig 1a three acoustic doppler velocimeters advs were deployed at mid depth of the water column z 0 275 m to collect time series of all three components of velocity adv1 was located near the wave maker adv2 behind the breakwater and adv3 at the harbour channel see fig 1a 2d particle tracking velocimetry ptv techniques using overhead high definition cameras were adopted to extract surface velocities during the experiments 3 numerical model 3 1 governing equations 3d large eddy simulations were carried out to model the physical experiments in les the filter operation decomposes the velocity field into the resolved and the unresolved components using a prescribed cutoff filter length the flow fields with length scales larger than the filter length are solved directly in which the filter length denotes the characteristic length of the grid size as 1 δ δ x δ y δ z 1 3 where each component δ x δ y δ z denotes the grid size in x y z directions respectively to resolve large scale energy containing eddies filtered navier stokes equations are numerically solved 2 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i ρ τ i j s g s x j ρ g δ i 3 σ γ ϕ w x i where i j 1 2 3 for 3d flow ρ is the fluid density u i is the filtered flow velocity p is the filtered fluid pressure μ is the dynamic viscosity of the fluid g is gravitational acceleration and δ i 3 is the kronecker delta flow fields smaller than the filter length are modelled as sub grid turbulent stress tensor τ i j s g s which requires a sub grid scale sgs closure model in the present study to simulate rather large scale flow field in general a dynamic procedure is known to be more physical based for complex geometries since the smagorinsky coefficient c s can be dynamically adjusted from the resolved flow fields e g meneveau and katz 2000 however estimating c s from the second test filter filter length of 2 δ becomes more difficult with the limited resolution thus the most commonly used standard smagorinsky type closure smagorinsky 1963 is utilised for the unresolved sgs fluctuations 3 τ i j s g s 1 3 δ i j τ k k s g s 2 c s δ 2 s s i j where k 1 2 3 s i j 1 2 u i x j u j x i is the strain rate tensor of filtered velocity and s 2 s i j s i j 1 2 is the strain rate magnitude the commonly used smagorinsky coefficient c s 0 167 patel et al 2019 wang et al 2019 zahiri and roohi 2019 is applied in this study known to be appropriate for the turbulent mix layer and boundary layer far from the no slip boundaries strictly speaking the value of c s should decrease to zero near the wall boundaries in this study however the numerical resolution is not fine enough to resolve the viscous sublayer and buffer layer due to the limited computational power thus near wall modelling is used instead see section 3 2 sub grid turbulent viscosity is defined as ν s g s c s δ 2 s the last term in eq 2 represents surface tension at the free surface where σ is the surface tension coefficient ϕ w is the volume fraction of water and γ is the free surface curvature calculated as 4 γ x i ϕ w x i ϕ w x i b where b 1 0 8 δ prevents division by zero for coastal flows the surface tension force is relatively minor however as shown in section 4 2 small perturbations in surface tension can trigger significant nonlinear effects in turbulent flows that result in different realisations of the same experiment in this study two immiscible fluids exist i e air and water and they are treated as a single air water mixture phase the interface between these two phases is tracked by the volume of fluid vof method where the air water mixture fluid density is written as hirt and nichols 1981 5 ρ ρ w ϕ w ρ a 1 ϕ w where the superscripts w and a represent water and air phases respectively hence ρ w 1000 kg m 3 is the density of water and ρ a 1 kg m 3 is the density of air likewise the dynamic viscosity of air water mixture phase in eq 2 is written as 6 μ ρ w ν w ϕ w ρ a ν a 1 ϕ w where ν w 1 0 6 m 2 s and ν a 1 48 1 0 5 m 2 s are the kinematic viscosity of water and air phases respectively the filtered mass conservation equations for the air and water phases can be written as drew 1983 7 1 ϕ w t 1 ϕ w u i a x i 0 8 ϕ w t ϕ w u i w x i 0 respectively where u i w u i a is the water air phase velocity notably the summation of eqs 7 and 8 leads to the divergence free filtered global mass conservation equation u i x i 0 where u i ϕ w u i w 1 ϕ w u i a in the numerical model diffusion at the free surface is minimised using the interface compression method berberović et al 2009 klostermann et al 2012 and the filtered mass conservation equation for the water phase can be re written as 9 ϕ w t ϕ w u i x i ϕ w 1 ϕ w u i r x i 0 where the relative velocity between two phases u i r u i w u i a is solved by iteration 3 2 near wall modelling in general it is not trivial to achieve sufficient numerical resolution to completely resolve all boundary layer processes for the laboratory wave basin length scales considered in this study o 1 0 1 m and o 1 0 0 m in horizontal and vertical directions respectively hence boundary conditions for velocities need to be specified via a near wall model for side walls and solid bottom in order to account for the boundary layer processes while maintaining a manageable computational cost for the smooth boundary considered in this study a semi empirical formula for the velocity parallel to the wall bed is utilised as spalding 1961 10 z h u h 1 e exp κ u h 1 κ u h 1 2 κ u h 2 1 6 κ u h 3 with e 9 8 κ 0 41 z h z h u τ ν and u h u h u τ where z h is the distance from the boundary normal to the nearest cell centre and u h is the wall bed parallel velocity on the centre of a cell in contact with the wall bed the friction velocity u τ is locally solved in eq 10 via iteration the proposed formula is applicable for multiple boundary layer regimes and is asymptotic to u h 0 at z h 0 u h z h for small z h in the viscous sublayer and u h 2 5 ln z h 5 5 at large z h in the log law layer in the buffer layer u h in eq 10 represents a smooth transition between the viscous sublayer and log law layer it should be noted that the spalding wall function was originally proposed for fully developed boundary layer flows thus near wall modelling applied to the present transient flow is one source of inaccuracy however the temporal evolution is relatively slow and the spatial variation is mild for the present long wave problem the performance of near wall modelling approach in transitional oscillatory flows was demonstrated by radhakrishnan and piomelli 2008 zhou et al 2014 and kim et al 2017 3 3 numerical implementations to solve the governing equations section 3 1 with the boundary conditions presented in section 3 2 interdymfoam jasak and tuković 2010 which is a solver based on the open source openfoam cfd toolbox is utilised with a minor modification interdymfoam solves the same set of governing equations as the interfoam solver berberović et al 2009 klostermann et al 2012 but includes all necessary features of dynamic meshes such as automatic mesh motion and data mapping jasak and tuković 2010 in this experiment the wave maker sent the single asymmetric wave into the domain for the first 42 s of the experiment the resulting wave length is about twice larger than the length of the 3d wave basin and the reflected wave from the breakwater reached back to the wave maker while the incident wave was still being generated with dynamic mesh capabilities interdymfoam is able to directly simulate wave maker motions by specifying the temporal displacement of the moving wall x w m used in the physical experiments fig 2 meshes were re constructed following the deformed domain at each time step and the resulting flow fields on the newly re constructed mesh were interpolated gauss theorem is applied to convert the advection terms of eq 2 into surface integrals for each cell then the fluxes of mixture fluid are calculated using a second order upwind scheme warming and beam 1976 for the diffusion terms second order central difference scheme and non orthogonal correction jasak 1996 are applied to discretise and adjust the resulting fluxes for time integration an implicit second order backward scheme is applied each time step of the model is controlled by the courant friedrichs lewy condition defined as 11 c 0 u i δ t δ c m a x where c 0 is the courant number and δ t is an automatically adjusted time step to satisfy the numerical stability and optimise computational cost c m a x 0 4 is used where preliminary tests produced nearly identical results for 0 2 c m a x 0 5 not shown here the numerical model is fully parallelised with message passing interface with the wall clock time approximately being about 300 h using 100 processors 2 8 ghz ivy bridge ep e5 2680 xeon for each 500 s run see also section 4 1 more details on the numerical solver can be found in rusche 2002 and klostermann et al 2012 4 model application 4 1 model setup the 3d numerical model domain was identical to the physical model described in kalligeris 2017 in a preliminary numerical experiment we found that orthogonality of the mesh is critical in minimising spurious free surface fluctuations due to numerical errors which will be discussed in section 4 3 hence a rectangular mesh was constructed with a uniform grid size of 2 75 cm in the vertical bed normal direction z and of 8 23 cm in the two horizontal directions x y where the x y direction is defined to be perpendicular parallel to the wave maker the grid size ratio between δ x δ y and δ z is controlled to be less than 3 to minimise the numerical instability the grid nodes near the breakwater were removed and replaced with a boundary fitted unstructured triangular mesh see fig 1b and c using a tool called snappyhexmesh jackson 2012 as a result a total number of 4 8 million grid points was used in the simulation the corresponding z units applied to eq 10 have the order of o 1 0 2 where z h 1 375 cm for the bottom wall and z h 4 115 cm for the side walls the quality of the present numerical resolution in resolving turbulent energy cascade is further discussed in section 5 4 no flux boundary condition was specified for fluid pressure and the wall normal velocity component and wall parallel velocity components were set to no slip boundary conditions to generate more turbulent realisations and carry out appropriate ensemble averaging three numerical simulations were carried out using slightly different surface tension coefficients σ which may represent small variabilities in water properties the selected σ values were 0 070 kg s 2 35 c for run 1 0 071 kg s 2 30 c for run 2 and 0 072 kg s 2 25 c for run 3 see eq 2 the weber w e ρ w u 2 d σ and bond b o ρ w g d 2 σ numbers for the selected σ are on the orders of o 10 2 and o 10 3 assuming the characteristic length d as the horizontal grid size i e d δ x and u 0 2 m s see also section 4 4 thus the inertial and gravitational forces are dominant compared to the surface tension forces and the perturbations in σ to trigger the nonlinear response of the navier stokes system in turbulent flow are considered to be adequate in this study it is worthwhile mentioning that a small perturbation such as a 0 004 of initial water volume change for a dam break flow was found to also trigger the nonlinear response of shallow turbulent flows in swash zone simulations kim et al 2017 4 2 main flow characteristics the entire simulation consists of several long wave induced vortex evolution stages consistent with kalligeris 2017 in which the vortex strength is illustrated using horizontal velocity u v vectors and the vertical component of vorticity ω z v x u y at the free surface fig 3 the model results within a distance of 0 5 m from the side walls and breakwater were excluded to better track the main vortices without the complication of the wall boundary layers it should be reiterated here that the offshore basin is assumed to be the area between the wave maker and breakwater and the rest of the area is defined as the inshore basin when the wave crest penetrated through the harbour channel between the breakwater and the side wall a clockwise vortex negative vorticity was generated at the inshore side of the wave basin fig 3a this inshore vortex that formed just downstream of the breakwater remained stationary until the flow direction in the harbour channel started to reverse stage 1 represents the inshore clockwise vortex generation stage t 40 s following the wave maker retreat an offshore directed vortex was generated with counter clockwise positive vorticity fig 3b stage 2 represents the offshore vortex generation stage 40 s t 78 s at the end of stage 2 t 78 s the offshore vortex detached from the trailing jet fig 3c and the vortex flow started to be more or less statistically identical in the azimuthal direction in the reference frame of the vortex centre the inshore vortex was flushed offshore and its opposite signed vorticity was integrated into the offshore vortex ring stage 3 is defined as the offshore monopolar vortex stage t 78 s the offshore vortex propagated away from the breakwater fig 3d as kinetic energy dissipation due to bottom friction became dominant the size of the offshore vortex increased through the diffusion model of vortex growth and it fully evolved into a monopolar vortex at later stage 3 fig 3e and f in the present study we will mainly focus on the evolution decay of the offshore eddy corresponding to 78 s t 500 s in the physical experiment the centre of offshore vortex x c y c was determined using two different methods kalligeris 2017 for the modelled results the method using the 70 contour of max ω z was adopted throughout the simulation the vortex paths from the physical experiment in each trial grey curves in fig 4 also see fig 5 in kalligeris et al 2021 and the model results in each numerical run using different σ blue red green curves in fig 4 show qualitatively similar features however the trajectory was not identical more careful examination suggests that the differences can be attributed to turbulent phenomena namely small perturbations trigger significantly different vortex paths due to the nonlinear navier stokes system it is widely known that the instantaneous turbulent flow shows acute sensitivity to small perturbations pope 2000 in this experiment r e was on the order of o 10 4 1 0 5 and the flow was fully turbulent with this large r e the nonlinear convection term in eq 2 becomes dominant and instantaneous flow fields were not completely identical nor repeatable due to the acute sensitivity to small but unavoidable perturbation in each trial run thus the model validation was conducted only at the earlier stage with stationary data section 4 3 for the later stage turbulence averaged flow quantities were utilised for the model validation section 4 4 and further analysis section 5 4 3 model validation with stationary data the wave energy spectra e η η f corresponding to the numerical and laboratory free surface elevation data are analysed and compared to find out whether the numerical model captures both intermediate and low frequency flow motions fig 5 using the fourier transform of the free surface elevation η auto correlation function r η η ς e η η f is calculated as 12 e η η f 2 r η η ς exp i 2 π f ς d ς where r η η ς 0 t ς η t η t ς d t in which t was set to be equal to the simulation duration i e t 500 s the inverse of eq 12 can be also written as 13 r η η ς 1 2 e η η f exp i 2 π f ς d f in the numerical simulation results the instantaneous water depth h was calculated using the vertically integrated volumetric concentration of water phase h x y t ϕ w x y z t δ z post processed and the free surface elevation is then calculated as η h h 0 the major oscillation modes at each resonant frequency can be identified through the wave energy spectrum to find common resonant frequencies of the wave basin between the wave maker and the breakwater e η η is averaged over selected wave gauges and combining the three simulation results as 14 e η η 1 n j 1 n e η η j r u n 1 f e η η j r u n 2 f e η η j r u n 3 f 3 in which n 14 is the number of selected wave gauges for averaging in each run blue circles in fig 1a the model was able to capture the low frequency resonant mode at about t 74 87 s f 0 013 hz with almost identical wave energy compared with the measured data fig 5 this low frequency mode represents the fundamental sloshing mode and is significantly lower than that of the wave generation interval t w 42 s f 0 024 hz as we will discuss in section 5 1 the resonant modes may affect the 3d recirculation patterns of the offshore tcs the model also captured the second peak at t 23 04 s f 0 043 hz which is nearly half of the wave generation interval however the model results over predict the wave energy at this frequency by 123 when compared with the measured data a closer examination revealed that the wave motion in the present 3d wave basin is very sensitive to the wall and bottom boundary conditions used in order to resolve the wall and bottom boundary layers the criteria generally require the grid size normalised as wall unit z to be smaller than the viscous sublayer z 5 which is of sub millimetre scale in the present flow conditions due to limited numerical resolution in the present les study δ z 2 75 cm a near wall modelling approach was adopted which introduces additional model assumptions and affects the model accuracy applying near wall modelling with the current numerical resolution of z o 1 0 2 may induce less energy dissipation at the boundaries due to friction the agreement between model results and measured data in intermediate frequency bands 0 043 hz f 0 1 hz is good i a 0 701 however model results also show several peaks in the high frequency band f 0 1 hz which are stronger than the measured data fig 5 this may be a limitation of the interface compression scheme used the interface compression scheme applied here is computationally efficient and has been proven to be accurate in resolving nonlinear wave motion in the depth limited breaking waves e g kim et al 2017 zhou et al 2014 2017 however this approach seems to be limited for low energy wave motion relatively small amplitude wave motions after t 100 s in which numerically induced surface fluctuations start to become significant in addition dynamic mesh induced discretisation errors may also play a role e g dunbar et al 2015 bruinsma et al 2018 as briefly discussed in section 4 1 a preliminary test case which adopted a non orthogonal mesh a maximum angle of 27 between the structure and the grid under similar numerical resolution showed even stronger high frequency oscillations see red dashed curve in fig 5 nevertheless it should be noted that the energy contained in the high frequency range f 0 1 hz was one to two orders of magnitude smaller than that in the low frequency range f 0 1 hz therefore the main flow characteristics should not be affected by the limited ability of the interface compression scheme that may enhance higher frequency motions the temporal evolution of η is used for the model validation where 12 wave gauges are selected among the 432 different locations red circles in fig 1a in order to rule out the small scale turbulent fluctuations in the comparison both the measured and modelled free surface elevation time series were low pass filtered using a butterworth filter with a cutoff frequency of 0 1 hz fig 6 it should be pointed out that the recorded free surface elevation time series at each location were not ensemble averaged over the repeated trials as the wave gauges were moved to a new position for each trial hence the simulation results from three runs were not ensemble averaged for a fair comparison the time series of η for run 1 3 had similar trends thus only run 2 results are shown here for brevity to quantify the agreement between model results and measured data normalised root mean square error nrmse and index of agreement i a willmott and wicks 1980 and willmott 1981 are used to demonstrate the mean of squared errors with respect to the range of measured data and similarity of trend bounded between 0 disagreement and 1 agreement respectively overall η was well captured by the numerical model with 0 929 fig 6a and c i a 0 975 fig 6e and 5 9 fig 6e nrmse 11 2 fig 6c throughout the entire wave basin although high frequency fluctuations of η were filtered out the model results still show slightly larger oscillations compared to the measured data fig 6 this is consistent with the wave energy spectrum observations fig 5 and it may be due to the relatively coarse numerical resolution used near the walls in conjunction with the near wall modelling applied which caused an overall underestimation of friction along the side walls breakwater and bottom two horizontal components of low pass filtered velocity u v using a cutoff frequency of 0 1 hz are compared at three adv locations in fig 7 again the experimental adv data were obtained from a single trial hence they are compared only with the model results from run 2 the overall agreement of u is good based on i a nrmse values of 0 899 10 0 0 870 12 8 and 0 953 7 3 for advs 1 3 respectively fig 7a c the agreement of v at adv3 is less satisfactory fig 7f since i a 0 406 and nrmse 27 4 adv3 is located very close to the side wall 6 8 cm away from the side wall where the model does not have sufficient numerical resolution to resolve the side wall turbulent boundary layer model results for v match the measured values well for adv1 adv2 with i a 0 927 0 945 and nrmse 13 2 10 2 fig 7d and e in general vertical velocity w has a much smaller magnitude than the two horizontal velocity components two orders of magnitude and is dominated by turbulent fluctuations thus the w velocity component was not considered in the model validation it should be noted here that both measured data and model results have diverged vortex trajectories in each trial run due to the chaotic nature of fully turbulent flows thus discrepancies may arise in the comparison between measurements and model results due to random nature of turbulent flow at fixed locations a more detailed model data comparison on the turbulence averaged velocity field of the offshore monopolar vortex is presented in the following section 4 4 model validation for tcs centred free surface velocity around the detached offshore vortex core the flow field for t 78 s is assumed to be statistically homogeneous in the azimuthal direction it allows to compare modelled azimuthal averaged or ensemble azimuthal averaged flow quantities to available theories for monopolar vortices e g satijn et al 2001 van heijst and clercx 2009 seol and jirka 2010 first the horizontal velocity fields u v were converted from cartesian coordinates to cylindrical coordinates u θ u sin θ v cos θ u r u cos θ v cos θ where u θ and u r are the azimuthal and radial velocity components θ arctan y y c x x c and x c and y c are the vortex centre coordinates in each time step the vortex centre velocity u c f v c f on the free surface of order o 1 0 1 m s was subtracted to obtain the stationary velocity components in cylindrical coordinates 15 u θ c r θ z t u r θ z t u c f t sin θ v r θ z t v c f t cos θ 16 u r c r θ z t u r θ z t u c f t cos θ v r θ z t v c f t sin θ where r is the radius from the vortex centre to increase the number of realisation for calculating averaged flow quantities we further propose an ensemble azimuthal average denoted as a in which a and represent ensemble average and azimuthal average respectively 17 u i c 1 n j 1 n u i j c r d r r r d r θ z t where i r θ z and n is the total number of data points combining run 1 3 inside annuli with width d r of 0 25 m consistent with kalligeris 2017 to find out whether sufficient realisations were available via ensemble azimuthal averaging u θ c and u r c at r 1 m on the free surface z η at three different instants t 100 s 300 s and 500 s are shown in fig 8 with an increase in number of data points in ensemble azimuthal averaging u θ c and u r c were converged to a fixed value particularly at the later stage of the vortex evolution fig 8b c e f it was found that u θ c and u r c had larger variabilities at earlier stages t 100 s due to the fact that the tcs had not fully evolved into a monopolar vortex shape yet fig 8a and d most importantly the numerical results suggest that flow characteristics based on the centre of the vortex have statistically converged regardless of the slightly different vortex centre trajectories at later times see fig 4 in summary it is deemed appropriate to use ensemble azimuthal averaging for examining the tcs dynamics for t 78 s the capability of the model to reproduce the measured ensemble azimuthal averaged flow field of the offshore tcs is illustrated in fig 9 through the comparison of u θ c r η t profiles eqs 15 and 17 at nine instants throughout the simulation overall the predicted u θ c profiles agree well with measured data with 0 827 fig 9a i a 0 953 fig 9b and 5 9 fig 9b and c nrmse 12 5 fig 9i the model is able to predict the radius corresponding to maximum u θ c r r v m a x 0 97 m however the magnitude of maximum u θ c is over predicted by about 20 for t 150 s this discrepancy can be attributed to the adopted near wall model as mentioned earlier the high frequency wave energy predicted by the model is larger than that observed in the wave basin due to insufficient friction at the boundaries likewise the bottom boundary layer numerical implementation resulted in the underprediction of the kinetic energy decay of the offshore vortex profiles of the vertical component of vorticity calculated from cartesian grid points are ensemble azimuthal averaged ω z r t and compared with measured data in fig 10 the model is able to capture the exponential decay of ω z moving away from the core with respect to r axis also note the vertical axes in fig 10 are in logarithmic scale however the maximum ω z at the vortex core r 0 was underpredicted and the maximum nrmse was calculated as added 27 9 at t 100 s fig 10a at later times the discrepancies at the vortex core decrease and nrmses tend to be lower as the vortex kinetic energy gets dissipated 5 discussion 5 1 secondary flow characteristics besides the main flow field characterised by the azimuthal velocity component the offshore vortex flow field also consists of radial and vertical velocity components these secondary flow components which are relatively minor compared to the azimuthal velocity generate 3d recirculation patterns in the tcs flow field fig 11 shows the temporal evolution of free surface elevation at the vortex core η c for run 2 it should be noted that the vortex core location in each ensemble also varies in the physical experiment see fig 4 hence the symbols in fig 11 represent the minimum η c near the ensemble averaged vortex core location in general both measured data and modelled results illustrate gradually recovering η c as the main vortex flow field slows down thus an upwelling feature is expected at the core according to the free surface boundary condition i e w η t dean and dalrymple 1991 in a longer temporal scale of the monopolar vortex decay however we can clearly observe higher frequency free surface fluctuations in the modelled results which suggest the existence of shorter temporal scale o 10 s recirculation patterns which will be discussed next the recirculation patterns along the r z plane are related to the main tcs flow structure and the superposition of secondary tcss fig 12 shows the r z plane snapshots of ω θ overlaid with u r w velocity vectors for run 2 at different instants positive ω θ u r z w r denotes clockwise rotation an upwelling at the vortex core r 0 m is clearly illustrated at the early stage of the monopolar vortex fig 12a consistent with the expectation from the free surface recovery at the core fig 11 near the bottom a persistent inward radial flux towards the vortex core exists which appears to be causing upwelling motions near the core r 1 m however the direction of w at the core frequently switched between upwelling fig 12a and d and downwelling fig 12b and c at later time we found that the frequency of upwelling and downwelling motions at the core coincided with the low frequency resonant modes shown in fig 5 exhibiting peaks at t 23 04 s and 74 87 s sloshing inside the 3d wave basin was observed in both the physical experiments and numerical simulations see fig 5 sloshing and 3d flow recirculation around the tcs centre creates nonlinear interactions that may result in turbulence production due to flow shear in the water column also see section 5 4 even though the amplitudes of the resonant modes were almost identical compared to the physical experiments and among the three numerical runs smalls perturbations can cause the divergence of the vortex centre trajectory for each run and also affect the radial velocity component of the vortex flow field as a result there was no clear trend observed in the radial component of azimuthal averaged velocity u r c profiles results from each of the three numerical runs were different fig 13 unlike the primary velocity component u θ c in general on the free surface the ensemble azimuthal averaged measured data showed inward velocity i e u r c 0 within r 2 m while modelled u r c were mostly outward curves in fig 13 in the physical experiment the imbalance between the centrifugal and the gravitational acceleration may have resulted in an inward motion that led to the accumulation of tracers at the tcs centre kalligeris 2017 the discrepancy between modelled and experimental u r c profiles can be attributed to the fact that the true radial velocity of the fluid could not be extracted accurately from the experimental data without the additional information from the z coordinate of the surface tracers 5 2 quasi 2d flow shallow environmental flows exhibit quasi 2d flow characteristics due the vertical confinement although small vertical dependence may still exist in nearshore flows due to bottom friction flow shear in the water column and free surface fluctuations as shown in fig 12 in such conditions depth integrated hydrodynamic models such as boussinesq type models e g wei et al 1995 kaihatu and kirby 1998 watts et al 2003 lynett 2006 can adequately describe the dynamics of nearshore flows furthermore the majority of simple parameterisations and analyses for monopolar vortices are based on quasi 2d flow conditions e g satijn et al 2001 van heijst and clercx 2009 seol and jirka 2010 since only 3d models are able to accurately describe the effect of 3d sub structures on the 2d underlying flow it is important to examine the complete 3d velocity statistics of the long wave induced tcs to quantify the two dimensionality of the flow field around a monopolar vortex the ratio of kinetic energy between the secondary and primary flow components can be used satijn et al 2001 suggested that flows are under quasi 2d conditions if e k z t e k θ t and e k r t e k θ t are below o 1 0 2 where the kinetic energy of the monopolar vortex for each velocity component is defined as 18 e k i t 2 π 0 h 0 r 1 2 ρ u i c 2 r d r d z where i r θ z for the integration of eq 18 on r axis the horizontal extent of the vortex r 4 r v m a x was kept as a constant i e r 4 m to exclude the influence from the side boundaries where r v m a x was found to be a more or less constant up to 500 s see also kalligeris 2017 in the model results using the ensemble azimuthal averaged velocity profiles e k r e k θ is predicted to be about o 1 0 1 further analysis suggests that even without vertical integration e k r e k θ is also about o 1 0 1 at any given elevation therefore the kinetic energy in the radial component is about one order of magnitude smaller than the corresponding azimuthal component fig 14a on the other hand e k z e k θ is below o 1 0 2 fig 14b indicating that the vertical motions are sufficiently constrained to represent quasi 2d flow conditions in the physical experiment horizontal velocity fields were only obtained at the free surface without the vertical velocity field hence the depth integration of the complete velocity fields could not be performed without the vertical integration it was demonstrated that measured e k r e k θ was below o 1 0 2 at all times which is one order of magnitude smaller than the model results the discrepancy could be due to the aforementioned force balance causing inward directed tracer motions cancelling outward directed flows at the free surface we can further demonstrate the shallow tcs features in the resulting flow field using a velocity spectrum the one dimensional 1d velocity spectra e u i c u i c are defined using the fourier transform of the demeaned velocity auto correlation r u i c u i c pope 2000 19 e u i c u i c κ r 1 π r u i c u i c ξ exp i κ r ξ d ξ where i r θ z κ r 2 π r r u i c u i c ξ u i c r u i c r ξ in which u i c u i c u i c likewise the inverse of eq 19 can be also written as 20 r u i c u i c ξ 1 2 e u i c u i c κ r exp i κ r ξ d κ r in order to obtain the spectra following eqs 19 and 20 the velocity fields are interpolated along straight lines parallel to the r direction penetrating the centre of vortex at 5 angle intervals it should be noted that the most homogeneous flow characteristics are in the azimuthal direction and hence the coherent motions can be estimated on the κ r axis to obtain a smooth profile e u i c u i c was averaged over individual lines combining three runs as 21 e u i c u i c κ r 1 n j 1 n e u i c u i c r u n 1 κ r j d θ e u i c u i c r u n 2 κ r j d θ e u i c u i c r u n 3 κ r j d θ 3 where d θ 5 n 36 the mid depth z h 0 53 1d velocity spectra at selected time steps are shown in fig 15 here we estimated the characteristic size of eddies l 0 by calculating the first zero crossing point of r u i c u i c on the r axis by further carrying out time average with data from three runs we obtained l 0 0 63 m which is approximately one order of magnitude larger than the grid size used in the simulations the 3 slope is apparent in the transverse spectra e w w at later stages t 300 s see fig 15b c d for large wave numbers κ r 2 π l 0 which represent vertically confined turbulent motions uijttewaal and booij 2000 uijttewaal and jirka 2003 sou et al 2010 kim et al 2017 on the other hand the azimuthal velocity spectra e u θ c u θ c remain isotropic and follow a 5 3 slope the resolved velocity fields demonstrate the quasi 2d turbulence characteristics of wavenumber spectra particularly at later times as shown in fig 15 the adopted numerical resolution was able to resolve the small scale turbulent kinetic energy tke cascade as well as the large scale flow motions within a wavenumber range of three to four orders of magnitudes thus main characteristics of turbulent energy spectra were reproduced using the resolved velocity fields however it should be pointed out that the range of the relatively constant slope in the cascade is less than two orders of magnitude due to the limited horizontal grid resolution in the present large wave flume experiment 5 3 bed shear stress the bed shear stress τ b accompanying long wave generated tcss is a key factor to explain the considerable seafloor scouring documented to occur during tsunami events wilson et al 2012 admire et al 2014 sakakiyama et al 2011 reported significant bed morphological evolution induced by a vertical vortex in a laboratory experiment with similar setup to the present study highly intermittent local scour occurred due to a strong rotating current with the location of scour following the vortex position for monopolar vortices in quasi 2d flow conditions depth averaged horizontal velocity u h can be used to parameterise τ b using the quadratic law 22 τ b x y t 1 2 c f u h 2 x y t where c f is an empirical bed friction coefficient and u h u r 2 u θ 2 in which u i is the depth averaged velocity i e u i 0 η u i d z where i r θ without subtracting the vortex centre velocity to include the effect of vortex propagation since u θ u r and kinetic energy decay is dominated by τ b the decay of peak depth averaged azimuthal velocity u θ t m a x follows seol and jirka 2010 23 u θ t m a x 1 1 u θ t r m a x c f 2 h 0 t in which t r is a reference time in order to find the best fitting c f in eq 23 the decay of modelled u θ t m a x was used between 100 s t 500 s with t r 100 s the best fitting c f is 0 0062 with i a 0 992 and nrmse 2 7 for run 1 not shown here and 0 0066 with i a 0 998 and nrmse 1 4 for run 2 fig 16a and 0 0063 with i a 0 978 and nrmse 1 7 for run 3 not shown here while for the measured data the optimal c f is 0 01 using velocity information on the free surface kalligeris 2017 this discrepancy was due to a slightly over predicted u h in the numerical simulation on the other hand a direct estimation of the bottom shear stress can be obtained from the numerical simulation results as 24 τ b x y t ρ u τ 2 x y t where u τ was calculated using the near wall modelling eq 10 at the closest grid point adjacent to bed for the numerical resolution adopted in this study the bottom cells were often in the log law layer z o 1 0 2 similar to fig 16a the decay of azimuthal averaged maximum bed shear stress τ b t m a x is illustrated in fig 16b in general the directly modelled τ b t m a x based on eq 24 was about 50 smaller compared to the parameterised results eq 22 however the decay trends are more or less similar and they are on a same order of magnitude fig 16b the x y plane snapshots of parameterised τ b eq 22 and modelled τ b eq 24 for run 2 are compared at different instants in fig 17 in general τ b obtained using the quadratic law fig 17a c e and using the near wall modelling fig 17b d f are very similar large τ b of o 1 0 0 pa was observed near the vortex centre at early stages t 100 s see fig 17a and b while the overall magnitudes decreased following the decay of u θ t m a x in time see fig 16 results shown here further confirm that the bulk features of u h are more or less equivalent to those of bed parallel velocity at the bottom cells u h and namely the 2d nature of the monopolar vortex flow field however it should be noted that the spatial distribution of τ b relative to the centre of vortex was not purely axisymmetric due to irregular and intermittent patterns of turbulent flow processes as well as the presence of vertical boundaries propagating vortex centre and basin sloshing 5 4 turbulence characteristics the temporal and spatial evolutions of tcss are vital information to better understand the characteristics of turbulent flows for instance the evolution of 2d rollers into obliquely descending eddies under breaking waves in the surf zone nadaoka et al 1989 ting 2008 2013 are shown to often approach the seabed and increase the near bed tke level e g zhou et al 2014 2017 to identify offshore monopolar tcss the λ 2 visualisation method jeong and hussain 1995 was adopted to represent tcss for the selected eigenvalues of s i j s i j ω i j ω i j where s i j and ω i j ω i j are symmetric and asymmetric velocity gradient tensors respectively fig 18 shows x c y c plane snapshots of λ 2 for run 2 at different elevations each row in fig 18 presents λ 2 at the free surface first row at mid water column second row and at the bottom most cells just above the bed third row the main flow structure represented by λ 2 was the axisymmetric 2d vertical vortex which was apparent particularly at the free surface at the free surface the swirling strength simply represents the vortex core fig 18a c however in the middle of the water column secondary tcss around the core can be clearly seen fig 18d f most of these secondary tcss also extend close to the bed represented in fig 18g i by spots of large magnitude of λ 2 the absence of secondary tcss on the free surface implies three dimensionality of secondary tcss which may be generated by flow recirculation see discussion below it is important to point out that the bottom patterns of tcss are not directly correlated with τ b patterns fig 17 for two main reasons first λ 2 shows the contour of vortices where the peak vorticity occurred at the core while the peak u θ was observed approximately 1 m away from the core secondly the modelled u τ was calculated only based on the log law of the wall correlated with near bed velocity without considering the direct effect from tcss approaching the bed this limitation may lead to the underestimation of τ b for sediment transport applications the comprehensive incorporation of the influence of tcss on τ b for sediment transport applications requires future investigation it is essential to examine tke turbulence production and turbulence dissipation rate to fully understand the evolution and impact of tcss it is well known that in the log law region of a boundary layer turbulence production is in balance with turbulence dissipation however it has been found that a local balance between turbulence production and turbulence dissipation rate is not valid for more complex and transient flows such as swash flows sou et al 2010 kim et al 2017 hence it is of interest here to investigate this issue for long wave induced tcss using the simulation results the resolved tke per unit mass k for each run is computed by averaging the resolved velocity fluctuation fields u θ u r w over the azimuthal direction as 25 k r z t 1 2 u i u i where u i u i u i with i r θ z the total turbulence production p consisting of resolved turbulence production p r e s and sub grid turbulence production p t s is computed as pham and sarkar 2014 kim et al 2017 26 p r z t p r e s r z t p t s r z t u i u j s i j 2 ν s g s s i j s i j where i j r θ z and s i j is the fluctuating strain rate tensor the numerical resolution used in the present study resolved about two orders of magnitude of energy cascade and hence the resolved turbulence production accounts for more than 95 of the total turbulent production i e p r e s p t s for all three runs likewise the turbulence dissipation rate is calculated pham and sarkar 2014 kim et al 2017 as 27 ε r z t ε r e s r z t ε t s r z t 2 ν s i j s i j 2 ν s g s s i j s i j in which ε r e s and ε t s are resolved and sub grid turbulence dissipation rates respectively for the turbulence dissipation rate ε t s was the dominant term since turbulence dissipation occurs at very small scales i e kolmogorov scale i e ε r e s ε t s was found for all three runs the structure of turbulence in the water column for run 2 is illustrated in fig 19 using the r z plane snapshots of k p and ε to indicate the variability of free surface azimuthal averaged water depth h and maximum h m a x and minimum h m i n water depth in azimuthal direction are also shown it should be noted that high ε and p observed between h m a x and h m i n is fictitious since it is induced by averaging the flow quantities along with the fluctuating free surface in the azimuthal direction the vertical distribution of tke is relatively uniform fig 19a b c compared to p and ε in general some variabilities of k is observed in the r direction where the overall magnitude of tke gradually decreases at very early stages fig 19a at later stages fig 19b and c the magnitude of k remains constant and its distribution becomes more uniform on the other hand the spatial distribution of turbulence production is spatially inhomogeneous due to the secondary tcs motions fig 19d e f several hot spots of p were caused by high local flow shear associated with the recirculation patterns see fig 12 high values of ε are mostly located near the bottom hence the turbulence is predominantly dissipated by the bottom friction fig 19g h i simulation results provided here suggest that a high vertical variability of higher order turbulence statistics exists even in shallow 2d turbulent flows moreover we can qualitatively observe that p is significantly larger than ε throughout the 500 s of simulation this is expected as in the physical experiment the entire vortex evolution lasted until t 3000 s the vertical distribution of p and ε and the imbalance between these two quantities can be examined via the radial averaged turbulence production p r z t 1 r 0 r p r z t d r and dissipation rate ε r z t 1 r 0 r ε r z t d r where r was kept as a constant r 4 m consistent with section 5 1 fig 20 shows p r and ε r of run 1 3 at four different instants i e t 100 300 400 and 500 s similar to fig 19 the vertical profiles of p r fluctuated significantly particularly p r of run 1 3 were quite different at some instants fig 20c and d because of different vortex trajectories which results in distinct recirculation patterns in general p r was observed to be more uniformly distributed along the water column with a magnitude of o 1 0 3 m 2 s 3 at early stages and it drops to about o 1 0 4 m 2 s 3 at the end of the 500 s simulation on the contrary the vertical profiles of ε r are more similar for run 1 3 throughout the simulation unlike turbulent production ε r is largest near the bed and its magnitude decays by one or two orders of magnitude moving away from the bed it implies that bottom friction is a constant sink of tke also see fig 19 throughout the 500 s of simulation p r was about one or two order of magnitude larger than ε r higher up in the water column but the difference becomes much smaller approaching the bed thus p r and ε r are more likely balanced near the bed if sufficient numerical resolution is used to resolve the near bed bottom boundary layer however recirculation induced p r remains the dominant turbulence generation mechanism up to 500 s it indicates that turbulence dissipation for shallow monopolar vortices is a slow process it is expected that the excessive tke will eventually dissipate when the stage of ε r p r is reached therefore we can conclude that the structures of k p and ε are dissimilar and the simple balance p ε is not satisfied in space and time these issues need to be taken into account if the goal is to model turbulent mixing and sediment transport associated with shallow tcs the maximum and minimum ε r are about o 1 0 6 m 2 s 3 and o 1 0 4 m 2 s 3 and the kolmogorov length scale ζ ν 3 ε 1 4 is between 0 3 mm and 0 1 mm the eddies are assumed to enter the inertia subrange at l 0 6 l e i l 0 and dissipation range at l d i 60 ζ pope 2000 where 106 mm l e i 630 mm and 19 mm l d i 60 mm hence the grid size adopted in this study 27 5 82 3 mm is close to the inertia subrange 6 conclusions a numerical investigation of long wave induced tcss was carried out using a 3d les approach on a dynamic mesh standard smagorinsky sgs closure was used in the present study the numerical model was validated with experimental data kalligeris 2017 for free surface elevation mid depth velocities azimuthal velocity at the free surface and vertical vorticity at the free surface model results showed good agreements for the velocity fields i a 0 7 the ensemble azimuthal averaging throughout the water column was proposed as a turbulence average operator for the monopolar vortex flows and verified with the measured data model results were further used to reveal turbulence characteristic of long wave induced tcss it was found that the long wave induced tcss are vertically suppressed identified by kinetic energy ratio and wavenumber spectrum analysis the vertical component of kinetic energy was found to be below 1 of the azimuthal component however the radial component is not negligible having about 10 of azimuthal kinetic energy using the resolved turbulent flow fields a 3 slope in the transverse power spectra was observed at later stages at a high wavenumber range which is distinctly different from the well known 5 3 slope for isotropic turbulence thus model results indicate that the long wave induced tcss are under quasi 2d flow conditions the bed shear stress was parameterised using the decay of depth averaged peak azimuthal velocity using the depth averaged momentum equation the quadratic law was applied to find the best fitting bed friction coefficient the resulting parameterised bed shear stress was consistent with the modelled bed shear stress obtained from the near wall modelling this suggests that the bed shear stress dominantly dissipates the kinetic energy of the offshore monopolar vortex however slight underprediction of bed shear stress in the model results could be due to ignoring a complex interaction of secondary tcss with the bed and lateral boundaries it was found that the spatial distribution of bed shear stress was not simply axisymmetric partially due to seemingly random velocity fluctuations tke turbulence production and turbulence dissipation rate were directly calculated from the resolved flow fields tke was spatially well distributed compared to the other quantities high turbulence dissipation was observed near the bed throughout the simulation also indicating that the bottom wall friction is the main sink of momentum for tcss the turbulence dissipation rate decayed exponentially from o 1 0 4 m 2 s 3 to o 1 0 6 m 2 s 3 however turbulence production was overall one order larger than the turbulence dissipation rate up to 500 s and had a unique spatial distribution hence a local equilibrium of turbulence was not valid for long wave induced tcss in this simulation the turbulence production was locally generated via shear instability and was often concurrent with the recirculation patterns the recirculation patterns were correlated with upwelling and downwelling motions highly affected by the low frequency resonant modes of the wave basin declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is supported by nsf usa oce 1635151 oce 1756714 cmmi 1135026 and office of naval research usa n00014 17 1 2796 numerical simulations presented in this study were carried out using the mills cluster at university of delaware and the supermic cluster at louisiana state university via xsede tg oce100015 the case setup to reproduce the same results is publicly available via community surface dynamics modeling system csdms model repository maintained by github https github com sedwavefoam wave induced shallow water monopolar vortex 
23904,climate change and increased coastal urbanization are causing low lying coastlines to become increasingly susceptible to the threat of extreme water levels and coastal flooding robust decision making on adaptation in the coastal zone based on reliable ocean modelling tools is therefore crucially contingent on accurate assessments of current and future storm surge hazards this accuracy relies considerably on the quality of the wind forcing used in the ocean models in this paper we use a high resolution regional 3d ocean model hbm covering the north sea and baltic sea to simulate extreme water levels during three extreme storm surge events with different dynamics and patterns in order to assess their impacts along denmark s coastlines which are of varying levels of complexity we demonstrate that the model is able to reproduce the observed extreme high water levels accurately indicating that the system is well suited for producing simulations of present and future projections of extreme storm surges with high resulting impacts and damage potentials additionally we quantify the level at which acknowledged deficiencies in the otherwise most suitable atmospheric forcing data set influence the results of the storm surge simulations we found that reducing the temporal resolution of the forcing data that is replacing two out of every six time stamps with linearly interpolated values is preferable to using the original forcing data set when recurring noise is present in these time stamps as a result for given storm surge events and depending on the stage reached in the storm s evolution mean absolute errors can be reduced by 4 5cm this emphasizes the importance of considering such model fluctuations when coupling high resolution atmosphere and ocean models graphical abstract keywords storm surges modelling atmospheric forcing climate change north sea baltic sea 1 introduction storm surges and extreme water levels can cause devastating damage to low lying coastlines global estimates suggest that currently up to 310 million people are directly or indirectly exposed to the adverse effects of coastal flooding reoccurring statistically every hundred years hinkel et al 2014 according to the intergovernmental panel on climate change ipcc the frequency of high water level events is expected to increase for example due to climate change induced rises in sea level as are areas and people exposed to coastal hazards worldwide oppenheimer et al 2019 vousdoukas et al 2016 however even assuming a stationary climate coastal communities are growing increasingly vulnerable to extreme water levels as a result of the current high rates of population growth caused in part by increased urbanization in coastal regions neumann et al 2015 vousdoukas et al 2020 2018 brown et al 2018 without investments in coastal adaptation the expected annual damage from extreme water levels is likely to increase by several orders of magnitude globally vousdoukas et al 2020 2018 hallegatte et al 2013 with both the current and future climate hence according to hinkel et al 2014 the globally projected annual damage costs may amount to as much as 10 of global gdp by the end of the 21st century the recurrence periods of specific storm surge events are estimated from the statistics of observed and or modelled extreme water levels reliable estimates of recurrence periods are important tools for a range of applications related to impact adaptation and risk analyses including adaptation decision support and infrastructural planning parry et al 2009 hinkel et al 2014 wahl et al 2017 thorarinsdottir et al 2017 to estimate the recurrence period for the very low probability high impact events that are of critical interest to risk managers generally requires the use of statistical extrapolation and extreme value theory to estimate higher level extremes such as 100 1000 or 10 000 year events wahl et al 2017 various statistical methods may be employed to estimate the recurrence period of extreme water levels from observed or modelled water level statistics arns et al 2015 although major drawbacks arise from the fact that water level gauges are not uniformly distributed in space and they cover short periods of time with regard to return period statistics conversely model data are ideally both spatially and temporally consistent haigh et al 2014 muis et al 2016 in principle allowing variability to be resolved for different time scales and spatial extents in order to assert the quality of the model and to gain a better understanding of the physical mechanisms that generate extreme water levels past events can be numerically simulated and compared to observations on different coastal stretches however observations and model output are both associated with uncertainties which will influence estimates of in particular rare or unobserved extremes using extreme value analysis haigh et al 2014 on top of that climate change adds a further dimension of uncertainty milly et al 2008 the accuracy of extreme water level simulations thereby greatly affects the results of any statistical extrapolation based on it possibly leading to both over and underestimation of rare extremes in water levels one example of an area exposed to coastal hazards from rising sea levels is denmark located where the north sea meets the baltic sea in northern europe as in coastal areas around the world mean sea level rises are dictating changes to extreme sea levels but studies of the north sea indicate that climate change may also lead to local changes in storminess which in turn will compound the associated storm surge and wave characteristics weisse et al 2012 vousdoukas et al 2018 suggest that rises in sea levels are the principal driver of increased damage costs in europe except in the baltic sea region where this effect is less pronounced due to land uplift and where climate change induced alterations to the storm surge and wave regimes therefore are relatively more important for this reason currently danish coastal municipalities urgently need detailed information on storm surge for purposes of both climate adaptation and emergency preparedness this includes high quality storm surge warnings and future projections of extreme water levels and wave heights based on detailed modelling of past storm surges and future changes madsen et al 2019 the danish climate atlas of which the present study forms a part aims to provide such climate information nationwide at scales relevant to coastal planners and decision makers thejll et al 2020 the north sea baltic sea transition zone hereafter simply transition zone is characterized by its very complex bathymetry hence within this area detailed spatio temporal modelling efforts are critically needed to understand the physical processes leading to storm surges and high water levels which will inform coastal adaptation to climate change parry et al 2009 hinkel et al 2014 wahl et al 2017 thorarinsdottir et al 2017 existing hindcast studies and climate simulations within this area were carried out at moderate spatio temporal resolutions compared to current state of the art and are therefore only partly able to deal with the complexity the region presents as a result the accuracy of simulated water levels especially for extreme events madsen 2009 tian et al 2016 fernández montblanc et al 2020 muis et al 2020 has proved to be relatively low in the following we evaluate the performance of the regional two way nested 3d ocean model hbm kleine 1994 berg and poulsen 2012 she et al 2007 in simulating three recent major storm surge events in the north sea and baltic sea including the model s sensitivity to atmospheric forcing major storm surge events are by definition rare making it crucial to understand the model s ability to reproduce such signature events in order to ensure confidence in the representation of even more severe extremes such as those found in multidecadal transient regional climate projections bevacqua et al 2019 or atmospheric regional reanalysis simulations i e continuous and spatially consistent descriptions of past states of the atmosphere dee et al 2014 the danish meteorological institute dmi uses hbm operationally typically forcing it by means of atmospheric fields from a high resolution numerical weather prediction nwp model the spatio temporal resolution used for long regional climate and reanalysis simulations is generally comparable but often still coarser than what is used for nwp against this background we analyse detailed model simulations of three recent storm surge events in the seas around denmark when forced by varying input from a regional reanalysis for this purpose we found the uerra uncertainties in ensembles of regional re analyses harmonie v1 data set ridal et al 2017 covering the european region for the period of 1961 2019 to be the most relevant owing to the long time period covered the high spatial resolution approximately 11km similar to euro cordex jacob et al 2014 and the high temporal resolution hourly re forecasts meteorological discontinuities hereafter denoted spikes are present in the first and second hourly outputs of the uerra analysis cycle which causes fluctuations in the wind speed and wind direction to appear every six hours in particular during turbulent wind conditions schimanke et al 2020 a recent study by büchmann 2019 investigated the response of an ocean model to the meteorological discontinuities that arise between two consecutive forecasts they found that instantaneous changes to atmospheric pressure sometimes occur between two consecutive forecasts locally this can amount to 5hpa or more e g when the speed or location of a low pressure system has changed slightly between the forecasts in their ocean modelling such discontinuities in the atmospheric forcing resulted in high frequency spurious waves of a few centimetres in magnitude other sources of atmospheric forcing such as regional climate projections might have analogous problems which emphasizes the need to analyse their influence on predictions of water levels the remainder of this study proceeds as follows initially we assess how well an atmospheric regional reanalysis product represents historical wind speeds and directions for three recent storm surge events along danish coastline secondly we evaluate the performance of the hbm extreme water level simulations driven by the uerra reanalysis as already mentioned for operational storm surge modelling dmi uses the hbm ocean model which during its time in use has already been extensively evaluated calibrated and improved we use the operational products as our gridded reference data and compare our hindcast results with existing operational simulations where the same storm surge model was driven by forecasts generated by an nwp model we evaluate both our new model system and the operational system by comparison to observations of wind and water levels thirdly we investigate the response of the ocean model to the erroneous fluctuations in the atmospheric forcing 2 methods and data we conducted hydrodynamic ocean model simulations for the north sea and baltic sea on the western european shelf fig 1 to perform the comparison and approach the questions set out in section 1 in the following sections we portray the study area and the meteorological conditions for each of three study cases and describe the models and data sets used to conduct and evaluate the simulations 2 1 study area the north sea is a semi enclosed marginal mid latitude shelf sea of the north atlantic it is bounded to the west by the uk and to the south and east by the northern and central european mainland the narrow english channel connects the north sea to the atlantic in the southwest while to the north the connection opens wide to the north atlantic and the norwegian sea the average depth of the north sea is 90m the southern part has a maximum depth of 50m while in the northeastern part the norwegian trench which runs along the norwegian coast reaches depths of up to 700m quante and colijn 2016 the north sea is dominated by tidal motion which keeps a vertically mixed water column in being throughout the year in the western and southern parts pugh 1987 the tides propagate in a cyclonic direction around the north sea along the danish west coast the tidal range decreases with northward distance from the wadden sea hbm gb domain see fig 1 otto and zimmerman 1990 to the east the north sea is connected to the baltic sea via the skagerrak and kattegat fig 1 the connections through the danish straits consist of narrow straits and shallow sills the widest and deepest of which has an average depth of 13m and a width of 8km at its narrowest trenches of depths of up to 50m with widths of a few hundred metres are key passageways for deep water inflows into the baltic sea making this a complex region to model she et al 2007 the straits restrict the exchange of water between the north sea and the baltic sea and strongly dampen high frequency sea level variability when entering the baltic samuelsson and stigebrandt 1996 atmospheric pressure and winds are the main drivers behind the difference in sea level between the waters north and south of the straits which predominantly governs the exchange of water through the straits the net freshwater supply to the baltic sea and the limited inflow of saline water cause the baltic s salinity to decrease with distance from the transition zone leppäranta and myrberg 2009 2 2 storm surge events we investigate the implications of the atmospheric forcing on the representation of extreme water level events by hbm for three major and recent storm surge events these three events occurred in 1999 2005 and 2013 and caused severe flooding and extensive damage e g along the danish coast the storms had different strengths spatial distributions and trajectories and therefore affected the complex danish coast with varying degrees of severity 2 2 1 case i the 1999 storm on 3 december 1999 a low pressure system called anatol passed over denmark the system quickly intensified west of ireland and tracked east northeast over the uk and the north sea after a rapid deepening of the low pressure anatol reached a mature stage as a category 1 strength hurricane over denmark making it the country s most severe recorded hurricane when it reached the west coast of the jutland peninsula on the danish mainland the maximum 10min wind speed at 10m height was about 38ms 1 at the wadden sea coast with gusts reaching 51ms 1 nielsen and sass 2003 which resulted in high water levels especially in southwest denmark in the wadden sea the wind driven contribution to the water levels culminated near low tide but still resulted in record water levels if the storm surge had hit during high tide the results would have been devastating in esbjerg station 1 the observed water level of 381cm was estimated as an approximately one in thirty years event kystdirektoratet 2018 while 10km further south the record breaking water level caused the water level gauge to stop functioning at hvide sande station 2 the storm surge was less severe while thyborøn and hornbæk stations 3 and 4 were not affected kystdirektoratet 2018 2 2 2 case ii storm gudrun erwin in 2005 on 7 january 2005 a perturbation to the polar front west of ireland developed into a major windstorm known as gudrun or erwin gudrun traversed northern ireland and scotland on a southwesterly trajectory passing over southern norway and finland between 7 and 9 january it was judged to be one of the worst storms in forty years in this region suursaar et al 2006 and caused massive damage to forests social disruption and at least seventeen fatalities smhi 2005 valinger and fridman 2011 carpenter 2005 the west coast of denmark experienced westerly winds of hurricane strength bf 12 which resulted in high water levels along the entire length of the west jutland peninsula record breaking water levels occurred in the limfjord fig 1 east of station 3 where persistent westerly winds had already generated higher than normal water levels prior to the passage of the storm stations 2 and 3 each recorded their second highest water levels in their observational records while water levels at station 1 ranked within the top fifteen events kystdirektoratet 2018 station 4 did not experience extreme water levels during this event 2 2 3 case iii storm bodil xaver of 2013 on 5 december 2013 a low pressure system detected off the coast of greenland very rapidly developed into a powerful cyclone passing north of scotland and tracking east and southeast over the north sea towards southern norway spencer et al 2015 known as xaver or bodil sven it passed over skagerrak towards southern sweden on the danish west coast the wind turned northwesterly with the 10 min wind speed reaching 36 6ms 1 in thorsminde fig 1 between stations 2 and 3 extreme water levels were recorded on both sides of the north sea spencer et al 2015 wadey et al 2015 dangendorf et al 2016 as xaver slowly tracked towards the baltic sea the kattegat experienced persistent northwesterly winds which reached hurricane strength along the southern kattegat coasts cappelen 2013 resulting in extreme water levels especially in north facing fjords stormrådet 2013 water levels at station 4 during this event were the most severe ever recorded in a data series spanning 126 years stations 2 and 3 had water levels ranking among the top eight out of 85 and 82 years of data respectively from the 143 years of data from station 1 this event ranked as number fifteen 2 3 data sources 2 3 1 oceanographic data the north sea baltic sea area is characterized by a dense network of coastal tide gauges quante and colijn 2016 the bacc ii author team 2015 in this study the focus is on the four water level gauges esbjerg 55 47n 8 42e in the danish wadden sea hvide sande 56 00n 8 11e and thyborøn 56 71n 8 21e in the eastern north sea and hornbæk 56 09n 12 46e in the southern kattegat fig 1 table 2 the stations were meticulously selected because they represent distinct characteristic parts of our study area are all owned and operated by the dmi and the danish coastal authority with known high measuring quality have century long data records stations 1 and 4 and have high water statistics based on this coles et al 2001 kystdirektoratet 2018 hansen 2018 for the period from 1 january 2007 to 1 january 2018 tide gauge data that has undergone extensive and systematic manual quality control are available to the authors we consider the quality of these data sets to be consistent over time and therefore use this time slice as a validation period when assessing the performance of the ocean hindcast 2 3 2 atmospheric data we use observed wind speeds and wind directions to evaluate the atmospheric forcing product near to the selected sites within our study area section 2 3 1 all the wind observation sites are fixed stations vilic 2012 located close to the coast fig 1 for comparison we include the then operational forecast suite dmi hirlam of the danish meteorological institute dmi sass et al 2002 to obtain a relative assessment of the agreement of our atmospheric forcing data with observations the hirlam forecast system the high resolution limited area model is a numerical weather prediction nwp system developed by the international hirlam consortia undén et al 2002 the dmi hirlam model system produced the atmospheric forcing used for operational storm surge modelling at dmi during the study period dmi hirlam has undergone continuous development cycles during the study period yang et al 2005 woetmann nielsen et al 2010 resulting for example in a higher spatial resolution for the more recent events table 2 we use the hirlam data sets for comparison of surface wind speeds and directions for the storms in 2005 and 2013 5 and 3km grids respectively for the 1999 storm we judge that the resolution of the operational nwp was too coarse 15km grids to render it useful for validation 2 4 hbm regional ocean model we employed the regional full 3d hiromb boos model hbm to simulate the spatial and temporal development of water levels during past storm surge events hbm is a hydrostatic free surface baroclinic ocean circulation and sea ice model designed for efficient two way nesting in complex bathymetry kleine 1994 she et al 2007 berg and poulsen 2012 the model allows for both multi decadal hindcast simulations madsen et al 2015 tian et al 2016 and operational forecasting huess and woge nielsen 2019 different versions of the model code are currently in use for operational water level and storm surge forecasting in several countries surrounding the baltic sea capet et al 2020 the model code and set up used in the present study are the dkss2013 operational version launched at dmi in october 2013 with seventeen tidal constituents and sea level heights at the north sea open boundary provided by a 2d model covering the northeastern north atlantic noamod she et al 2007 the dkss2013 version has two finer nests with three and six times higher resolution in the german bight and inner danish waters respectively fig 1 table 1 summarizes the details of the model set up the model is well validated for both extreme sea levels and lower frequency variability madsen 2009 fu et al 2012 tian et al 2016 our analysis is based on a 58 year hindcast experiment spanning the years 1961 2018 the spin up of the ocean for the hindcast experiment was conducted by repeating the meteorological forcing of year 1961 for a total of 2 5 years the spin up run is initialized at 1 july 1961 by utilizing the initial field from the operational simulation at 1 july 2014 hourly 2d fields and daily average 3d fields are archived on their native grid river run off data were provided by the hydrological predictions for the environment model for europe e hype donnelly et al 2016 the simulation was run on dmi s high performance computing system in a parallel mode with eight nodes 32 cpus per node the integration wall clock time for a year is about 24h excluding queue waiting time 2 4 1 hbm meteorological forcing data the hbm ocean model is driven by meteorological forcing fields of 10m winds 2m air temperature mean sea level pressure surface humidity and cloud cover table 2 summarizes the meteorological data sets used as forcing in this study for information regarding the hirlam model see section 2 3 2 the atmospheric forcing data for the hindcast simulation were obtained from an atmospheric modelling system the hirlam aladin research on mesoscale operational nwp in euromed harmonie system bengtsson et al 2017 operated by the swedish hydrological and meteorological institute smhi dahlgren et al 2016 uerra uncertainties in ensembles of regional re analyses harmonie v1 is a regional reanalysis data set for europe covering the period from january 1961 to july 2019 schimanke et al 2020 the model is driven by lateral boundary conditions from the global reanalysis era 40 uppala et al 2005 1961 to 1979 and era interim dee et al 2011 1979 onwards the data set consists of six hourly analysis fields 00 utc 06 utc 12 utc 18 utc and hourly re forecasts until the start of the next analysis cycle thereafter data is stored at a lower temporal resolution with a maximum re forecast length of 30h the spatial resolution of the uerra data set is 11km a three dimensional variational 3d var data assimilation scheme treats observations as occurring at the time of analysis rather than as distributed over time intervals see e g courtier et al 1998 gustafsson et al 2001 lindskog et al 2001 assimilates the upper air observations and an optimal interpolation algorithm assimilates the surface observations the background state is the best guess at the time of analysis i e the previous re forecast at 6h the re forecast initialized at the time of analysis provides the best guess for the subsequent analysis the data are available for download from the climate data store at https cds climate copernicus eu since the analysis fields are adjusted towards observations they do not necessarily obey the physical laws that govern the re forecasts at re forecasts initialization some spin up time may therefore be required before the system is once again physically consistent in the uerra data set the spin up manifests itself as rapid fluctuations spikes which appear with a six hour period especially during stronger wind conditions schimanke et al 2020 fig 2 shows an example of how rapid fluctuations in wind speed appear in the first and second hourly outputs in an analysis cycle during the 2005 storm see section 3 1 in this figure we subtract the preceding time stamp from each t x a large part of the domain has a positive anomaly at t 1 1h since analysis and a negative anomaly at t 2 2h since analysis for the rest of the time stamps i e t 3 to t 6 these anomalies are less pronounced to assess the effect of these spikes in the forcing data on simulated water levels simulations were conducted using both the original uerra data set uerra 1 6 and a manipulated data set we call uerra 3 6 in this manipulated data set we eliminate the first and second hourly outputs of each re forecast cycle by employing linear interpolation this means that each day we only use sixteen of the available 24h of original meteorological data as forcing data for the ocean model while the remaining time stamps are interpolated values based on a preliminary case study that assessed the accuracy of simulated water levels when forced by uerra 3 6 and uerra 1 6 respectively the decision was made to employ uerra 3 6 as forcing for the 58 year hindcast which we call hbm 3 6 the simulations driven by uerra 1 6 called hbm 1 6 are conducted for shorter time slices that span our selected storm surge events see section 2 2 we initialize these simulations from monthly archived initial fields from the hindcast simulation based on uerra 3 6 on the first day of the month in the month prior to each storm therefore the hbm 1 6 simulations utilize the uerra 1 6 forcing for a little over a month before the time when the storm occurs an alternative approach to excluding the t 1 and t 2 outputs of each atmospheric analysis cycle would be to replace these time stamps with t 7 and t 8 from the previous analysis cycle however this could not be tested since re forecasts are stored at lower temporal resolutions at that distance into the analysis cycle 2 5 data analysis to evaluate the atmospheric data we compare the model data to point observations by nearest neighbour remapping to the location of the observation station to evaluate the ocean model s performance we measure the correlation between observed and simulated water levels in 10min resolution using pearson s correlation coefficient r as 1 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where x and y denote observed and modelled water level anomalies and n is the sample size to assess the similarity between the modelled and observed data sets we also calculate the root mean square error rmse as 2 r m s e 1 n i 1 n y i x i 2 with x y and n as above the mean absolute error mae is calculated as 3 m a e 1 n i 1 n y i x i with x y and n as above the difference in mae is obtained by subtracting the mae of hbm 3 6 from those of hbm 1 6 the peak error is calculated as the difference between the maximum observed water level and the maximum simulated water level within a time window of 6h centred on the time of the observed peak value the mean peak error is the average of the 33 highest observed water levels at each location corresponding to an average of three events per year where each sampled event was separated in time from other peak events by at least three days to ensure sampling of independent events water level anomalies are obtained by subtracting the mean water level for the entire eleven year analysed time slice see section 2 3 1 from the observed and modelled water levels respectively finally to obtain a measure of how well the model system reproduces the shape of the observed water level curve we resample the model simulations and observations from 10 minute bins to hourly resolution and then accumulate the hourly absolute deviation δ a c c between the simulated and observed water levels over a six hour time window centred around the hour when the peak occurs t 0 as 4 δ a c c t t 0 3 t 0 2 y t x t where x and y denote observed and modelled hourly water level anomalies respectively and t t 0 3 to t t 0 2 indicate the time window 3 results 3 1 evaluation of atmospheric forcing to assess the quality of the atmospheric forcing data the uerra 1 6 data set was evaluated against observations by employing nearest neighbour remapping of the model data to the observational locations for comparison we also extracted data from the higher resolution operational nwp dmi hirlam the wind speeds and wind directions for selected stations fig 1 prior to during and after the passage of the 2005 and 2013 storms are shown in figs 3 and 4 there is in general good agreement between each of the two different model products and the observations for both wind speed and wind direction the largest differences between the modelled and observed wind speeds are found at station 4 nakkehoved fyr southern kattegat for both cases however the uerra 1 6 data set has regular and recurring episodes of rapid changes in wind speed and direction this is especially evident in fig 3 where recurring spikes are seen for uerra 1 6 with a six hourly period see section 2 4 1 which are not present in the observations or hirlam the spatial patterns of these shifts are neither homogeneous nor consistent in time e g more pronounced at stations 1 and 2 compare with fig 2 in order to assess how the variability in the uerra 1 6 data depends on when in the analysis cycle the data were produced we sampled the data based on the number of hours into the analysis cycle fig 5 shows temporally averaged standard deviations of the surface wind speed in the uerra 1 6 data set the different panels show data sampled based on the number of hours since analysis where t 1 denotes the first hour 1h after analysis t 2 the second hour 2h and so on analyses are performed at 00 00 utc 06 00 utc 12 00 utc and 18 00 utc so that e g panel t 1 shows data for 01 00 07 00 13 00 and 19 00 utc despite the fact that t 6 are several hours into the analysis cycle the highest spatially averaged standard deviations σ occur in panels t 1 averaged over the entire domain the standard deviation for uerra 1 6 over time also indicates increased variability in the first two hours t 1 and t 2 after the analysis time this can be seen by the recurring peaks in fig 5 bottom panel coinciding with t 1 and t 2 which are indicated by red shading the patterns shown in fig 5 highest standard deviation in t 1 peaks coinciding with t 1 and t 2 are also clear for the two other cases in this study not shown although the locations of the areas with high standard deviations are different between the cases to investigate the effect of spikes in the forcing data we replace the time stamps that are affected the most t 1 and t 2 with the linear interpolation between t 6 of the previous analysis cycle and t 3 of the current analysis cycle this manipulated data set therefore differs from the original uerra 1 6 for eight out of 24 hours every day for the cases in the present study this interpolation results in a smoother wind field and lower maximum wind speeds for uerra 3 6 than uerra 1 6 fig 6 shows the wind forcing based on uerra 1 6 upper panels and the manipulated uerra 3 6 data set middle panels for two time stamps during the passage of the 2005 storm the lowest panels show the difference between the uerra 1 6 and uerra 3 6 as can be seen in these plots uerra 1 6 has a stronger northerly component in the central north sea and a stronger southerly component along the west coast of denmark the difference in wind speed is largest over the eastern north sea with differences as large as 9ms 1 20 30 reduction off the northwestern coast of denmark in the following steps in the analysis we employ both the uerra 3 6 and uerra 1 6 data sets to drive the storm surge model to test for the influence of inconsistencies in the uerra forcing data 3 2 evaluation of simulated water levels 3 2 1 characteristics of ocean hindcast to assess the long term accuracy of the model system we compared results from the ocean hindcast originally spanning the time period 1961 2018 to manually quality controlled observations available between 1 january 2007 and 1 january 2018 the ocean hindcast is denoted hbm 3 6 and was forced by the uerra 3 6 data set see section 2 4 1 for this eleven year time slice we calculated the correlation coefficient r the root mean square error rmse and the mean peak error section 2 5 of the water level anomalies by comparing the correlation and rmse of our simulations with the ones reported by meier et al 2004 fernández montblanc et al 2020 we find that the model system reproduces sea level variability with a greater accuracy than what has previously been achieved for coarser resolution state of the art hindcast modelling in the specific region at all the stations there was a strong significant and positive correlation between the simulated and observed water levels table 3 the correlation was larger and the relative mean peak error smaller on the north sea coast than in the micro tidal southern kattegat station 4 except at station 2 which has the highest mean peak error of the selected stations in magnitude the west coast has larger rmses however since the variability is much greater along the west coast than at station 4 e g 67cm observed standard deviation at station 1 compared to 23cm at station 4 the rmse relative to the variability is smaller than at station 4 3 2 2 event based case studies in addition to the long term analyses we use three well known and recent storms as case studies for assessing the accuracy of our modelling system at extreme sea level situations specifically we investigate the impact on the quality of the storm surge simulation when using either an original atmospheric forcing product or a manipulated data set where time stamps that are known to be disproportionately affected by noise are replaced by linear interpolation section 2 4 1 in doing so we compare the temporal development of the simulated water levels during the passage of each storm to tide gauge observations at specific locations which were selected due to their wide distribution across denmark section 2 3 1 a statistical comparison of the ocean simulations driven by uerra 1 6 and uerra 3 6 denoted as hbm 1 6 and hbm 3 6 is presented in table 4 a visual comparison is summarized in figs 7 to 9 where simulated water levels for each of the ocean simulations hbm 1 6 and hbm 3 6 are shown together with the observations to put the accuracy of our modelling system into context we also included water levels simulated by the then operational modelling system at dmi consisting of hbm forced by the nwp dmi hirlam for the two cases available 2005 and 2013 the observations are manually quality controlled by expert judgement through visual inspection where data judged to be erroneous such as implausible values or protracted periods of constant values have been removed this procedure results in some data gaps as at station 1 in fig 7 the measurement frequency is also lower for the 1999 storm the shaded areas indicate the deviation of hbm 1 6 and hbm 3 6 from the observed values at any given time to arrive at a measure of how well the shape of the observed water level curve is represented by the model system the bottom panels for each station in figs 7 9 show the accumulated hourly absolute deviation for each of the hbm 1 6 and hbm 3 6 simulations from the observed water levels δ a c c see eq 4 the agreement between each of the ocean simulations hbm 1 6 and hbm 3 6 and the observations varies both between stations and between storms figs 7 9 hbm 1 6 generally produces higher water levels with larger deviations from the observations than hbm 3 6 in several cases this upward shift of the water level curve results in a smaller peak error for hbm 1 6 however both model products fail to fully capture the observed shape of the peaks for the 2005 case it is especially noticeable how hbm 1 6 produces peaks that are too broad shouldered fig 8 which causes the accumulated deviation δ a c c to increase in summary the hbm 1 6 simulations generally display poorer agreement with observations than hbm 3 6 the largest differences between hbm 1 6 and hbm 3 6 occur during the 2005 storm where δ a c c for hbm 1 6 is either consistently higher or very similar to δ a c c for hbm 3 6 for the 1999 storm the δ a c c for hbm 1 6 is again consistently larger or very similar except for the second observed peak at station 4 where hbm 3 6 simulates too small a reduction in the water level subsequent to the first peak geographically and for all three cases in the present study the largest discrepancies between the hbm 1 6 and hbm 3 6 simulations are seen on the west coast of denmark this pattern is clear in fig 10 where snapshots of the distributed differences between hbm 1 6 and hbm 3 6 are seen for all three cases during the passage of each storm the time stamps are selected based on displays of large and extensive differences close to the time of the highest observed values on the west coast for the 2005 event see also fig 6 which indicates a significantly higher shoreward momentum transfer for uerra 1 6 at this time the large differences appear because the strongest impact of the storm in this region coincides with the interpolated time stamps fig 11 shows a zooming in of the pattern of relative differences like fig 10 but divided by hbm 3 6 values on almost the entire west coast hbm 1 6 simulates 10 20 higher water levels than hbm 3 6 for the 1999 case panel a in the southeastern wadden sea the difference approaches 25 during the 2005 storm panel b the water level is consistently around 15 higher along most of the coastline although slightly higher values are seen south of station 3 and towards station 1 panel c has a pattern with smaller differences on the west coast mainly confined to the wadden sea the time stamp shown for the 2013 case is many hours before the storm surge impacted the inner danish waters compare station 4 fig 9 the prominent patterns seen in the transition zone are not related to high water but are instead because the water level anomalies in this region were much smaller 4 discussion in this study we initially compare the era interim based uerra harmonie v1 regional atmospheric reanalysis ridal et al 2017 against observations to assess its suitability for driving a storm surge model we then compare observed and simulated water levels using the dmi hbm ocean model driven by the reanalysis during three recent storm surge events along danish coastlines two different configurations are considered one using an unmodified version of the uerra data hbm 1 6 and one where erroneous spikes hbm 3 6 see section 2 4 1 were replaced 4 1 evaluation of atmospheric forcing the six hourly analysis fields from which the re forecasts are initialized have a higher correlation and exhibit the lowest standard deviation with respect to observations when compared to the re forecasts uerra 1 6 see section 2 4 1 and operational forecasts hirlam see section 2 3 2 not shown however the lower temporal resolution of the analysis fields makes them less suitable as forcing for extreme storm surge modelling see e g dullaart et al 2020 muis et al 2016 as the wind field becomes substantially smoothed which results in underestimates of extreme water levels the atmospheric uerra 1 6 reanalysis data set generally has good agreement with observations figs 3 4 although spurious spikes in for example the wind speed in the first and second time stamps after each analysis cycle are present this indicates a significant departure of the assimilated observations from the background state t 6 of the previous analysis cycle such fluctuations in the wind field periodically amplify or in some cases reduce the wind speed and changes the direction of the wind over affected regions fig 3 the characteristics of the spikes seem to be storm specific the location and severity of the fluctuations differ between the different storms considered in this study with the 2005 storm showing the most pronounced patterns figs 2 6 5 4 2 evaluation of simulated water levels the ocean hindcast hbm 3 6 forced by uerra 3 6 shows good agreement between the simulated and observed water levels table 3 the spatio temporal resolution of the hbm model yields a higher accuracy in the complex transition zone between the north sea and the baltic sea than model systems that simulate storm surges on global or pan european scales at lower resolutions muis et al 2020 fernández montblanc et al 2020 for the three storm surge events considered here the superior resolution results in high quality simulations of extreme sea levels that are adequate for adaptation planning madsen et al 2019 several improvements smaller peak errors better phase of the peaks are observed when comparing to the lower resolution operational product operational cmod v2 dmi that was standard in 2005 fig 8 for example hbm 3 6 has a better phase of the peak for the 2005 case when the operational simulation displays a negative phase shift for the 2013 case the operational modelling system consists of the same ocean model and a higher resolution atmospheric forecast system 3km grids see section 2 3 2 the lower spatial resolution of the atmospheric forcing for hbm 1 6 and hbm 3 6 does not appear to reduce the quality of the simulations since they are very similar to the operational simulations fig 9 4 3 irregularities in the atmospheric forcing in this study we investigate two different configurations of the atmospheric forcing one where the unmodified noisy data set is used and another where we have effectively reduced the temporal resolution by linearly interpolating over two out of every six time stamps in order to reduce the inherent noise detected in these time stamps table 4 compares the rmse and mae for the storm surge simulations driven by the unmodified and interpolated forcing data sets respectively with one exception station 2 1999 case the rmse is found to be smaller for the modified data set than for the unmodified one for all stations that experienced extreme water levels station 4 also had a higher rmse for this case however this exception is of minor importance since the 1999 storm did not generate high water levels at this particular station the greatest improvements are seen for the 2005 case see also section 4 1 rmse and mae are 5 5cm and 4 5cm lower respectively when averaged over the four stations during this event despite this major improvement rmses for this particular event remain relatively large the effect of the erroneous fluctuations in the forcing data mainly manifested as higher peak water levels in the ocean model simulations when uerra 1 6 was used as forcing for the storm surge model the simulated peak water levels exceeded the observed water levels at the study locations for hbm 3 6 the simulated water levels were occasionally too low but they had a higher general agreement lower rmse with observations than hbm 1 6 figs 7 9 table 4 accumulation of the hourly absolute error around the time of the peak water levels δ a c c figs 7 9 bottom panels shows that hbm 3 6 is either better or equally skillful in reproducing the temporal development of the peak the interpolation of the original forcing data results in a smoother and weaker wind field the reduction of the wind speed amounts to 9ms 1 20 30 on denmark s northwest coast for the 2005 storm fig 6 this results in a significantly lower shoreward momentum transfer for the interpolated data sets the reduction is greatest for the 2005 storm in terms of both the magnitude and spatial extent affecting the entire danish west coast the obvious reason is that the two replaced time stamps during this 2005 storm occurred simultaneously with the storm reaching the coasts which was not the case for the other two storms fig 10 the effect is more evident in fig 8 where the reduced wind stress results in 30 40cm lower water levels along much of the western coastline for the 2013 storm the area of reduced shoreward wind corresponds well with the region of lower water levels in fig 10 panel c the largest discrepancies between hbm 1 6 and hbm 3 6 around denmark are found on the west coast fig 10 which saw some of the most extreme water levels during these case events due to the strong westerly wind components and this coast s exposure to the north sea additionally the tidal range is one order of magnitude larger than in denmark s more sheltered and micro tidal inshore waters i e with an amplitude of approximately 2m vs 0 3m non linear interaction between the atmospheric and tidal forced water level contributions therefore has a much stronger potential to affect the total water level in this region horsburgh and wilson 2007 compared to denmark s inshore waters the timing of when during the analysis cycle a storm has its largest impact affects how much the peak water levels differ between hbm 1 6 and hbm 3 6 during the 1999 storm the maximum water level and shape of the peak at station 1 are nearly identical between the two simulations for this storm the timing of the storm passage is such that the largest effect of the wind stress occurs later in the analysis cycle this means that the peak water levels are reached at a time when the forcing has been identical for several hours before the water level reaches its maximum instead the largest difference between the two simulations in this case is seen earlier in the same analysis cycle analysis at 12 00 utc 3 december where a larger deviation at stations 1 3 of hbm 1 6 from the observed water levels is present there is a higher degree of similarity for the hbm 1 6 and hbm 3 6 simulations for the 1999 and 2013 storms respectively than during the 2005 storm this can be expected due to the smaller variability in each analysis cycle for these events not shown in cases where the spikes are less prominent typically calmer wind conditions schimanke et al 2020 the hbm 1 6 and hbm 3 6 simulations are very similar despite the reduced temporal resolution of hbm 3 6 the information lost does not seem to have a significant impact on the quality of the hbm 3 6 for the cases studied here furthermore the good agreement with the observations table 3 confirms that the method also performs well over longer time periods we argue that more sophisticated methods of filtering the deficiencies in the forcing data might be able to improve the results further but this was outside the scope of the present study the use of uerra as forcing for regional ocean models will however be evaluated further in a multi model framework by different institutes in the baltic sea modelling community leibniz institute for baltic sea research warnemünde 2019 placke et al 2018 the present study demonstrates that the hbm ocean model is able to satisfactorily reproduce observed water levels for extreme historical storms while at the same time being robust against the systematic errors that are present in the forcing data table 4 that said in most cases a slight improvement is seen when using the corrected forcing data this suggests that the model is also capable of producing reasonable results when used for future regional climate projections where systematic errors in the forcing data are common jacob et al 2007 haas et al 2014 future work by the author team will employ the hbm modelling system on future projections e g to assess future extreme water levels and the associated potentially harmful impacts of storm surges on danish coastlines 5 conclusions in this paper we employ a regional ocean model to study three extreme storm surge events along the complex danish coastlines we evaluate the simulated water levels as well as the atmospheric regional reanalysis that forces the ocean model against observations in general we show that the modelling system reproduces extreme water levels with a high level of skill in terms of both the timing and magnitude of these events we investigate the effect of erroneous fluctuations in the forcing data associated with two out of six time stamps in each analysis cycle by replacing the effected time stamps with linearly interpolated values this interpolation resulted in a reduction of the wind speed by e g 9ms 1 20 30 off the northwest coast of denmark for the 2005 storm by replacing the first two time stamps from each analysis cycle with linearly interpolated values the accuracy of the simulated water levels was improved compared to using the original data set as forcing generally the simulations driven by the interpolated data set are either better than or equally good at reproducing the temporal development of the extreme high water levels with lower rmses 5 5cm than average for the 2005 storm and lower mean absolute errors an average reduction of 4 5cm for the 2005 storm the effect of the interpolation of forcing data largely depends on the location and magnitude of the spikes and at which stage in the storm s evolution these two replaced time stamps occur our model results therefore demonstrate that removing time stamps that are disproportionately affected by noise and thus effectively reducing the temporal resolution of the forcing data was preferable to using the original forcing data set more sophisticated methods of filtering out the erroneous fluctuations while retaining more of the original data set might have an even larger benefit than the method used in this study our study has large implications for future climate simulations of storm surges in the context of developing estimates of exceedance probabilities and recurrence periods based on the model output another implication of this is that reconstructions of historical storm surges that are lacking in observational records can become more accurate when employing climate reanalysis abbreviations uerra 1 6 original regional reanalysis data set that includes all time stamps uerra 3 6 manipulated regional reanalysis data set from which the first and second time stamps in each analysis cycle are excluded hbm 1 6 ocean simulation driven by uerra 1 6 hbm 3 6 ocean simulation driven by uerra 3 6 δ a c c accumulated hourly absolute deviation in a six hour time window credit authorship contribution statement elin andrée conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jian su conceptualization methodology software investigation writing review editing morten andreas dahl larsen conceptualization methodology writing review editing kristine skovgaard madsen resources conceptualization funding acquisition writing review editing martin drews funding acquisition conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work reported in this paper is part of a greater shared effort between the technical university of denmark dtu and the danish meteorological institute dmi with the aim of investigating the processes that lead to extreme storm surges through meticulous numerical atmospheric oceanic modelling part of the funding is provided by the danish state through the danish climate atlas 
23904,climate change and increased coastal urbanization are causing low lying coastlines to become increasingly susceptible to the threat of extreme water levels and coastal flooding robust decision making on adaptation in the coastal zone based on reliable ocean modelling tools is therefore crucially contingent on accurate assessments of current and future storm surge hazards this accuracy relies considerably on the quality of the wind forcing used in the ocean models in this paper we use a high resolution regional 3d ocean model hbm covering the north sea and baltic sea to simulate extreme water levels during three extreme storm surge events with different dynamics and patterns in order to assess their impacts along denmark s coastlines which are of varying levels of complexity we demonstrate that the model is able to reproduce the observed extreme high water levels accurately indicating that the system is well suited for producing simulations of present and future projections of extreme storm surges with high resulting impacts and damage potentials additionally we quantify the level at which acknowledged deficiencies in the otherwise most suitable atmospheric forcing data set influence the results of the storm surge simulations we found that reducing the temporal resolution of the forcing data that is replacing two out of every six time stamps with linearly interpolated values is preferable to using the original forcing data set when recurring noise is present in these time stamps as a result for given storm surge events and depending on the stage reached in the storm s evolution mean absolute errors can be reduced by 4 5cm this emphasizes the importance of considering such model fluctuations when coupling high resolution atmosphere and ocean models graphical abstract keywords storm surges modelling atmospheric forcing climate change north sea baltic sea 1 introduction storm surges and extreme water levels can cause devastating damage to low lying coastlines global estimates suggest that currently up to 310 million people are directly or indirectly exposed to the adverse effects of coastal flooding reoccurring statistically every hundred years hinkel et al 2014 according to the intergovernmental panel on climate change ipcc the frequency of high water level events is expected to increase for example due to climate change induced rises in sea level as are areas and people exposed to coastal hazards worldwide oppenheimer et al 2019 vousdoukas et al 2016 however even assuming a stationary climate coastal communities are growing increasingly vulnerable to extreme water levels as a result of the current high rates of population growth caused in part by increased urbanization in coastal regions neumann et al 2015 vousdoukas et al 2020 2018 brown et al 2018 without investments in coastal adaptation the expected annual damage from extreme water levels is likely to increase by several orders of magnitude globally vousdoukas et al 2020 2018 hallegatte et al 2013 with both the current and future climate hence according to hinkel et al 2014 the globally projected annual damage costs may amount to as much as 10 of global gdp by the end of the 21st century the recurrence periods of specific storm surge events are estimated from the statistics of observed and or modelled extreme water levels reliable estimates of recurrence periods are important tools for a range of applications related to impact adaptation and risk analyses including adaptation decision support and infrastructural planning parry et al 2009 hinkel et al 2014 wahl et al 2017 thorarinsdottir et al 2017 to estimate the recurrence period for the very low probability high impact events that are of critical interest to risk managers generally requires the use of statistical extrapolation and extreme value theory to estimate higher level extremes such as 100 1000 or 10 000 year events wahl et al 2017 various statistical methods may be employed to estimate the recurrence period of extreme water levels from observed or modelled water level statistics arns et al 2015 although major drawbacks arise from the fact that water level gauges are not uniformly distributed in space and they cover short periods of time with regard to return period statistics conversely model data are ideally both spatially and temporally consistent haigh et al 2014 muis et al 2016 in principle allowing variability to be resolved for different time scales and spatial extents in order to assert the quality of the model and to gain a better understanding of the physical mechanisms that generate extreme water levels past events can be numerically simulated and compared to observations on different coastal stretches however observations and model output are both associated with uncertainties which will influence estimates of in particular rare or unobserved extremes using extreme value analysis haigh et al 2014 on top of that climate change adds a further dimension of uncertainty milly et al 2008 the accuracy of extreme water level simulations thereby greatly affects the results of any statistical extrapolation based on it possibly leading to both over and underestimation of rare extremes in water levels one example of an area exposed to coastal hazards from rising sea levels is denmark located where the north sea meets the baltic sea in northern europe as in coastal areas around the world mean sea level rises are dictating changes to extreme sea levels but studies of the north sea indicate that climate change may also lead to local changes in storminess which in turn will compound the associated storm surge and wave characteristics weisse et al 2012 vousdoukas et al 2018 suggest that rises in sea levels are the principal driver of increased damage costs in europe except in the baltic sea region where this effect is less pronounced due to land uplift and where climate change induced alterations to the storm surge and wave regimes therefore are relatively more important for this reason currently danish coastal municipalities urgently need detailed information on storm surge for purposes of both climate adaptation and emergency preparedness this includes high quality storm surge warnings and future projections of extreme water levels and wave heights based on detailed modelling of past storm surges and future changes madsen et al 2019 the danish climate atlas of which the present study forms a part aims to provide such climate information nationwide at scales relevant to coastal planners and decision makers thejll et al 2020 the north sea baltic sea transition zone hereafter simply transition zone is characterized by its very complex bathymetry hence within this area detailed spatio temporal modelling efforts are critically needed to understand the physical processes leading to storm surges and high water levels which will inform coastal adaptation to climate change parry et al 2009 hinkel et al 2014 wahl et al 2017 thorarinsdottir et al 2017 existing hindcast studies and climate simulations within this area were carried out at moderate spatio temporal resolutions compared to current state of the art and are therefore only partly able to deal with the complexity the region presents as a result the accuracy of simulated water levels especially for extreme events madsen 2009 tian et al 2016 fernández montblanc et al 2020 muis et al 2020 has proved to be relatively low in the following we evaluate the performance of the regional two way nested 3d ocean model hbm kleine 1994 berg and poulsen 2012 she et al 2007 in simulating three recent major storm surge events in the north sea and baltic sea including the model s sensitivity to atmospheric forcing major storm surge events are by definition rare making it crucial to understand the model s ability to reproduce such signature events in order to ensure confidence in the representation of even more severe extremes such as those found in multidecadal transient regional climate projections bevacqua et al 2019 or atmospheric regional reanalysis simulations i e continuous and spatially consistent descriptions of past states of the atmosphere dee et al 2014 the danish meteorological institute dmi uses hbm operationally typically forcing it by means of atmospheric fields from a high resolution numerical weather prediction nwp model the spatio temporal resolution used for long regional climate and reanalysis simulations is generally comparable but often still coarser than what is used for nwp against this background we analyse detailed model simulations of three recent storm surge events in the seas around denmark when forced by varying input from a regional reanalysis for this purpose we found the uerra uncertainties in ensembles of regional re analyses harmonie v1 data set ridal et al 2017 covering the european region for the period of 1961 2019 to be the most relevant owing to the long time period covered the high spatial resolution approximately 11km similar to euro cordex jacob et al 2014 and the high temporal resolution hourly re forecasts meteorological discontinuities hereafter denoted spikes are present in the first and second hourly outputs of the uerra analysis cycle which causes fluctuations in the wind speed and wind direction to appear every six hours in particular during turbulent wind conditions schimanke et al 2020 a recent study by büchmann 2019 investigated the response of an ocean model to the meteorological discontinuities that arise between two consecutive forecasts they found that instantaneous changes to atmospheric pressure sometimes occur between two consecutive forecasts locally this can amount to 5hpa or more e g when the speed or location of a low pressure system has changed slightly between the forecasts in their ocean modelling such discontinuities in the atmospheric forcing resulted in high frequency spurious waves of a few centimetres in magnitude other sources of atmospheric forcing such as regional climate projections might have analogous problems which emphasizes the need to analyse their influence on predictions of water levels the remainder of this study proceeds as follows initially we assess how well an atmospheric regional reanalysis product represents historical wind speeds and directions for three recent storm surge events along danish coastline secondly we evaluate the performance of the hbm extreme water level simulations driven by the uerra reanalysis as already mentioned for operational storm surge modelling dmi uses the hbm ocean model which during its time in use has already been extensively evaluated calibrated and improved we use the operational products as our gridded reference data and compare our hindcast results with existing operational simulations where the same storm surge model was driven by forecasts generated by an nwp model we evaluate both our new model system and the operational system by comparison to observations of wind and water levels thirdly we investigate the response of the ocean model to the erroneous fluctuations in the atmospheric forcing 2 methods and data we conducted hydrodynamic ocean model simulations for the north sea and baltic sea on the western european shelf fig 1 to perform the comparison and approach the questions set out in section 1 in the following sections we portray the study area and the meteorological conditions for each of three study cases and describe the models and data sets used to conduct and evaluate the simulations 2 1 study area the north sea is a semi enclosed marginal mid latitude shelf sea of the north atlantic it is bounded to the west by the uk and to the south and east by the northern and central european mainland the narrow english channel connects the north sea to the atlantic in the southwest while to the north the connection opens wide to the north atlantic and the norwegian sea the average depth of the north sea is 90m the southern part has a maximum depth of 50m while in the northeastern part the norwegian trench which runs along the norwegian coast reaches depths of up to 700m quante and colijn 2016 the north sea is dominated by tidal motion which keeps a vertically mixed water column in being throughout the year in the western and southern parts pugh 1987 the tides propagate in a cyclonic direction around the north sea along the danish west coast the tidal range decreases with northward distance from the wadden sea hbm gb domain see fig 1 otto and zimmerman 1990 to the east the north sea is connected to the baltic sea via the skagerrak and kattegat fig 1 the connections through the danish straits consist of narrow straits and shallow sills the widest and deepest of which has an average depth of 13m and a width of 8km at its narrowest trenches of depths of up to 50m with widths of a few hundred metres are key passageways for deep water inflows into the baltic sea making this a complex region to model she et al 2007 the straits restrict the exchange of water between the north sea and the baltic sea and strongly dampen high frequency sea level variability when entering the baltic samuelsson and stigebrandt 1996 atmospheric pressure and winds are the main drivers behind the difference in sea level between the waters north and south of the straits which predominantly governs the exchange of water through the straits the net freshwater supply to the baltic sea and the limited inflow of saline water cause the baltic s salinity to decrease with distance from the transition zone leppäranta and myrberg 2009 2 2 storm surge events we investigate the implications of the atmospheric forcing on the representation of extreme water level events by hbm for three major and recent storm surge events these three events occurred in 1999 2005 and 2013 and caused severe flooding and extensive damage e g along the danish coast the storms had different strengths spatial distributions and trajectories and therefore affected the complex danish coast with varying degrees of severity 2 2 1 case i the 1999 storm on 3 december 1999 a low pressure system called anatol passed over denmark the system quickly intensified west of ireland and tracked east northeast over the uk and the north sea after a rapid deepening of the low pressure anatol reached a mature stage as a category 1 strength hurricane over denmark making it the country s most severe recorded hurricane when it reached the west coast of the jutland peninsula on the danish mainland the maximum 10min wind speed at 10m height was about 38ms 1 at the wadden sea coast with gusts reaching 51ms 1 nielsen and sass 2003 which resulted in high water levels especially in southwest denmark in the wadden sea the wind driven contribution to the water levels culminated near low tide but still resulted in record water levels if the storm surge had hit during high tide the results would have been devastating in esbjerg station 1 the observed water level of 381cm was estimated as an approximately one in thirty years event kystdirektoratet 2018 while 10km further south the record breaking water level caused the water level gauge to stop functioning at hvide sande station 2 the storm surge was less severe while thyborøn and hornbæk stations 3 and 4 were not affected kystdirektoratet 2018 2 2 2 case ii storm gudrun erwin in 2005 on 7 january 2005 a perturbation to the polar front west of ireland developed into a major windstorm known as gudrun or erwin gudrun traversed northern ireland and scotland on a southwesterly trajectory passing over southern norway and finland between 7 and 9 january it was judged to be one of the worst storms in forty years in this region suursaar et al 2006 and caused massive damage to forests social disruption and at least seventeen fatalities smhi 2005 valinger and fridman 2011 carpenter 2005 the west coast of denmark experienced westerly winds of hurricane strength bf 12 which resulted in high water levels along the entire length of the west jutland peninsula record breaking water levels occurred in the limfjord fig 1 east of station 3 where persistent westerly winds had already generated higher than normal water levels prior to the passage of the storm stations 2 and 3 each recorded their second highest water levels in their observational records while water levels at station 1 ranked within the top fifteen events kystdirektoratet 2018 station 4 did not experience extreme water levels during this event 2 2 3 case iii storm bodil xaver of 2013 on 5 december 2013 a low pressure system detected off the coast of greenland very rapidly developed into a powerful cyclone passing north of scotland and tracking east and southeast over the north sea towards southern norway spencer et al 2015 known as xaver or bodil sven it passed over skagerrak towards southern sweden on the danish west coast the wind turned northwesterly with the 10 min wind speed reaching 36 6ms 1 in thorsminde fig 1 between stations 2 and 3 extreme water levels were recorded on both sides of the north sea spencer et al 2015 wadey et al 2015 dangendorf et al 2016 as xaver slowly tracked towards the baltic sea the kattegat experienced persistent northwesterly winds which reached hurricane strength along the southern kattegat coasts cappelen 2013 resulting in extreme water levels especially in north facing fjords stormrådet 2013 water levels at station 4 during this event were the most severe ever recorded in a data series spanning 126 years stations 2 and 3 had water levels ranking among the top eight out of 85 and 82 years of data respectively from the 143 years of data from station 1 this event ranked as number fifteen 2 3 data sources 2 3 1 oceanographic data the north sea baltic sea area is characterized by a dense network of coastal tide gauges quante and colijn 2016 the bacc ii author team 2015 in this study the focus is on the four water level gauges esbjerg 55 47n 8 42e in the danish wadden sea hvide sande 56 00n 8 11e and thyborøn 56 71n 8 21e in the eastern north sea and hornbæk 56 09n 12 46e in the southern kattegat fig 1 table 2 the stations were meticulously selected because they represent distinct characteristic parts of our study area are all owned and operated by the dmi and the danish coastal authority with known high measuring quality have century long data records stations 1 and 4 and have high water statistics based on this coles et al 2001 kystdirektoratet 2018 hansen 2018 for the period from 1 january 2007 to 1 january 2018 tide gauge data that has undergone extensive and systematic manual quality control are available to the authors we consider the quality of these data sets to be consistent over time and therefore use this time slice as a validation period when assessing the performance of the ocean hindcast 2 3 2 atmospheric data we use observed wind speeds and wind directions to evaluate the atmospheric forcing product near to the selected sites within our study area section 2 3 1 all the wind observation sites are fixed stations vilic 2012 located close to the coast fig 1 for comparison we include the then operational forecast suite dmi hirlam of the danish meteorological institute dmi sass et al 2002 to obtain a relative assessment of the agreement of our atmospheric forcing data with observations the hirlam forecast system the high resolution limited area model is a numerical weather prediction nwp system developed by the international hirlam consortia undén et al 2002 the dmi hirlam model system produced the atmospheric forcing used for operational storm surge modelling at dmi during the study period dmi hirlam has undergone continuous development cycles during the study period yang et al 2005 woetmann nielsen et al 2010 resulting for example in a higher spatial resolution for the more recent events table 2 we use the hirlam data sets for comparison of surface wind speeds and directions for the storms in 2005 and 2013 5 and 3km grids respectively for the 1999 storm we judge that the resolution of the operational nwp was too coarse 15km grids to render it useful for validation 2 4 hbm regional ocean model we employed the regional full 3d hiromb boos model hbm to simulate the spatial and temporal development of water levels during past storm surge events hbm is a hydrostatic free surface baroclinic ocean circulation and sea ice model designed for efficient two way nesting in complex bathymetry kleine 1994 she et al 2007 berg and poulsen 2012 the model allows for both multi decadal hindcast simulations madsen et al 2015 tian et al 2016 and operational forecasting huess and woge nielsen 2019 different versions of the model code are currently in use for operational water level and storm surge forecasting in several countries surrounding the baltic sea capet et al 2020 the model code and set up used in the present study are the dkss2013 operational version launched at dmi in october 2013 with seventeen tidal constituents and sea level heights at the north sea open boundary provided by a 2d model covering the northeastern north atlantic noamod she et al 2007 the dkss2013 version has two finer nests with three and six times higher resolution in the german bight and inner danish waters respectively fig 1 table 1 summarizes the details of the model set up the model is well validated for both extreme sea levels and lower frequency variability madsen 2009 fu et al 2012 tian et al 2016 our analysis is based on a 58 year hindcast experiment spanning the years 1961 2018 the spin up of the ocean for the hindcast experiment was conducted by repeating the meteorological forcing of year 1961 for a total of 2 5 years the spin up run is initialized at 1 july 1961 by utilizing the initial field from the operational simulation at 1 july 2014 hourly 2d fields and daily average 3d fields are archived on their native grid river run off data were provided by the hydrological predictions for the environment model for europe e hype donnelly et al 2016 the simulation was run on dmi s high performance computing system in a parallel mode with eight nodes 32 cpus per node the integration wall clock time for a year is about 24h excluding queue waiting time 2 4 1 hbm meteorological forcing data the hbm ocean model is driven by meteorological forcing fields of 10m winds 2m air temperature mean sea level pressure surface humidity and cloud cover table 2 summarizes the meteorological data sets used as forcing in this study for information regarding the hirlam model see section 2 3 2 the atmospheric forcing data for the hindcast simulation were obtained from an atmospheric modelling system the hirlam aladin research on mesoscale operational nwp in euromed harmonie system bengtsson et al 2017 operated by the swedish hydrological and meteorological institute smhi dahlgren et al 2016 uerra uncertainties in ensembles of regional re analyses harmonie v1 is a regional reanalysis data set for europe covering the period from january 1961 to july 2019 schimanke et al 2020 the model is driven by lateral boundary conditions from the global reanalysis era 40 uppala et al 2005 1961 to 1979 and era interim dee et al 2011 1979 onwards the data set consists of six hourly analysis fields 00 utc 06 utc 12 utc 18 utc and hourly re forecasts until the start of the next analysis cycle thereafter data is stored at a lower temporal resolution with a maximum re forecast length of 30h the spatial resolution of the uerra data set is 11km a three dimensional variational 3d var data assimilation scheme treats observations as occurring at the time of analysis rather than as distributed over time intervals see e g courtier et al 1998 gustafsson et al 2001 lindskog et al 2001 assimilates the upper air observations and an optimal interpolation algorithm assimilates the surface observations the background state is the best guess at the time of analysis i e the previous re forecast at 6h the re forecast initialized at the time of analysis provides the best guess for the subsequent analysis the data are available for download from the climate data store at https cds climate copernicus eu since the analysis fields are adjusted towards observations they do not necessarily obey the physical laws that govern the re forecasts at re forecasts initialization some spin up time may therefore be required before the system is once again physically consistent in the uerra data set the spin up manifests itself as rapid fluctuations spikes which appear with a six hour period especially during stronger wind conditions schimanke et al 2020 fig 2 shows an example of how rapid fluctuations in wind speed appear in the first and second hourly outputs in an analysis cycle during the 2005 storm see section 3 1 in this figure we subtract the preceding time stamp from each t x a large part of the domain has a positive anomaly at t 1 1h since analysis and a negative anomaly at t 2 2h since analysis for the rest of the time stamps i e t 3 to t 6 these anomalies are less pronounced to assess the effect of these spikes in the forcing data on simulated water levels simulations were conducted using both the original uerra data set uerra 1 6 and a manipulated data set we call uerra 3 6 in this manipulated data set we eliminate the first and second hourly outputs of each re forecast cycle by employing linear interpolation this means that each day we only use sixteen of the available 24h of original meteorological data as forcing data for the ocean model while the remaining time stamps are interpolated values based on a preliminary case study that assessed the accuracy of simulated water levels when forced by uerra 3 6 and uerra 1 6 respectively the decision was made to employ uerra 3 6 as forcing for the 58 year hindcast which we call hbm 3 6 the simulations driven by uerra 1 6 called hbm 1 6 are conducted for shorter time slices that span our selected storm surge events see section 2 2 we initialize these simulations from monthly archived initial fields from the hindcast simulation based on uerra 3 6 on the first day of the month in the month prior to each storm therefore the hbm 1 6 simulations utilize the uerra 1 6 forcing for a little over a month before the time when the storm occurs an alternative approach to excluding the t 1 and t 2 outputs of each atmospheric analysis cycle would be to replace these time stamps with t 7 and t 8 from the previous analysis cycle however this could not be tested since re forecasts are stored at lower temporal resolutions at that distance into the analysis cycle 2 5 data analysis to evaluate the atmospheric data we compare the model data to point observations by nearest neighbour remapping to the location of the observation station to evaluate the ocean model s performance we measure the correlation between observed and simulated water levels in 10min resolution using pearson s correlation coefficient r as 1 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where x and y denote observed and modelled water level anomalies and n is the sample size to assess the similarity between the modelled and observed data sets we also calculate the root mean square error rmse as 2 r m s e 1 n i 1 n y i x i 2 with x y and n as above the mean absolute error mae is calculated as 3 m a e 1 n i 1 n y i x i with x y and n as above the difference in mae is obtained by subtracting the mae of hbm 3 6 from those of hbm 1 6 the peak error is calculated as the difference between the maximum observed water level and the maximum simulated water level within a time window of 6h centred on the time of the observed peak value the mean peak error is the average of the 33 highest observed water levels at each location corresponding to an average of three events per year where each sampled event was separated in time from other peak events by at least three days to ensure sampling of independent events water level anomalies are obtained by subtracting the mean water level for the entire eleven year analysed time slice see section 2 3 1 from the observed and modelled water levels respectively finally to obtain a measure of how well the model system reproduces the shape of the observed water level curve we resample the model simulations and observations from 10 minute bins to hourly resolution and then accumulate the hourly absolute deviation δ a c c between the simulated and observed water levels over a six hour time window centred around the hour when the peak occurs t 0 as 4 δ a c c t t 0 3 t 0 2 y t x t where x and y denote observed and modelled hourly water level anomalies respectively and t t 0 3 to t t 0 2 indicate the time window 3 results 3 1 evaluation of atmospheric forcing to assess the quality of the atmospheric forcing data the uerra 1 6 data set was evaluated against observations by employing nearest neighbour remapping of the model data to the observational locations for comparison we also extracted data from the higher resolution operational nwp dmi hirlam the wind speeds and wind directions for selected stations fig 1 prior to during and after the passage of the 2005 and 2013 storms are shown in figs 3 and 4 there is in general good agreement between each of the two different model products and the observations for both wind speed and wind direction the largest differences between the modelled and observed wind speeds are found at station 4 nakkehoved fyr southern kattegat for both cases however the uerra 1 6 data set has regular and recurring episodes of rapid changes in wind speed and direction this is especially evident in fig 3 where recurring spikes are seen for uerra 1 6 with a six hourly period see section 2 4 1 which are not present in the observations or hirlam the spatial patterns of these shifts are neither homogeneous nor consistent in time e g more pronounced at stations 1 and 2 compare with fig 2 in order to assess how the variability in the uerra 1 6 data depends on when in the analysis cycle the data were produced we sampled the data based on the number of hours into the analysis cycle fig 5 shows temporally averaged standard deviations of the surface wind speed in the uerra 1 6 data set the different panels show data sampled based on the number of hours since analysis where t 1 denotes the first hour 1h after analysis t 2 the second hour 2h and so on analyses are performed at 00 00 utc 06 00 utc 12 00 utc and 18 00 utc so that e g panel t 1 shows data for 01 00 07 00 13 00 and 19 00 utc despite the fact that t 6 are several hours into the analysis cycle the highest spatially averaged standard deviations σ occur in panels t 1 averaged over the entire domain the standard deviation for uerra 1 6 over time also indicates increased variability in the first two hours t 1 and t 2 after the analysis time this can be seen by the recurring peaks in fig 5 bottom panel coinciding with t 1 and t 2 which are indicated by red shading the patterns shown in fig 5 highest standard deviation in t 1 peaks coinciding with t 1 and t 2 are also clear for the two other cases in this study not shown although the locations of the areas with high standard deviations are different between the cases to investigate the effect of spikes in the forcing data we replace the time stamps that are affected the most t 1 and t 2 with the linear interpolation between t 6 of the previous analysis cycle and t 3 of the current analysis cycle this manipulated data set therefore differs from the original uerra 1 6 for eight out of 24 hours every day for the cases in the present study this interpolation results in a smoother wind field and lower maximum wind speeds for uerra 3 6 than uerra 1 6 fig 6 shows the wind forcing based on uerra 1 6 upper panels and the manipulated uerra 3 6 data set middle panels for two time stamps during the passage of the 2005 storm the lowest panels show the difference between the uerra 1 6 and uerra 3 6 as can be seen in these plots uerra 1 6 has a stronger northerly component in the central north sea and a stronger southerly component along the west coast of denmark the difference in wind speed is largest over the eastern north sea with differences as large as 9ms 1 20 30 reduction off the northwestern coast of denmark in the following steps in the analysis we employ both the uerra 3 6 and uerra 1 6 data sets to drive the storm surge model to test for the influence of inconsistencies in the uerra forcing data 3 2 evaluation of simulated water levels 3 2 1 characteristics of ocean hindcast to assess the long term accuracy of the model system we compared results from the ocean hindcast originally spanning the time period 1961 2018 to manually quality controlled observations available between 1 january 2007 and 1 january 2018 the ocean hindcast is denoted hbm 3 6 and was forced by the uerra 3 6 data set see section 2 4 1 for this eleven year time slice we calculated the correlation coefficient r the root mean square error rmse and the mean peak error section 2 5 of the water level anomalies by comparing the correlation and rmse of our simulations with the ones reported by meier et al 2004 fernández montblanc et al 2020 we find that the model system reproduces sea level variability with a greater accuracy than what has previously been achieved for coarser resolution state of the art hindcast modelling in the specific region at all the stations there was a strong significant and positive correlation between the simulated and observed water levels table 3 the correlation was larger and the relative mean peak error smaller on the north sea coast than in the micro tidal southern kattegat station 4 except at station 2 which has the highest mean peak error of the selected stations in magnitude the west coast has larger rmses however since the variability is much greater along the west coast than at station 4 e g 67cm observed standard deviation at station 1 compared to 23cm at station 4 the rmse relative to the variability is smaller than at station 4 3 2 2 event based case studies in addition to the long term analyses we use three well known and recent storms as case studies for assessing the accuracy of our modelling system at extreme sea level situations specifically we investigate the impact on the quality of the storm surge simulation when using either an original atmospheric forcing product or a manipulated data set where time stamps that are known to be disproportionately affected by noise are replaced by linear interpolation section 2 4 1 in doing so we compare the temporal development of the simulated water levels during the passage of each storm to tide gauge observations at specific locations which were selected due to their wide distribution across denmark section 2 3 1 a statistical comparison of the ocean simulations driven by uerra 1 6 and uerra 3 6 denoted as hbm 1 6 and hbm 3 6 is presented in table 4 a visual comparison is summarized in figs 7 to 9 where simulated water levels for each of the ocean simulations hbm 1 6 and hbm 3 6 are shown together with the observations to put the accuracy of our modelling system into context we also included water levels simulated by the then operational modelling system at dmi consisting of hbm forced by the nwp dmi hirlam for the two cases available 2005 and 2013 the observations are manually quality controlled by expert judgement through visual inspection where data judged to be erroneous such as implausible values or protracted periods of constant values have been removed this procedure results in some data gaps as at station 1 in fig 7 the measurement frequency is also lower for the 1999 storm the shaded areas indicate the deviation of hbm 1 6 and hbm 3 6 from the observed values at any given time to arrive at a measure of how well the shape of the observed water level curve is represented by the model system the bottom panels for each station in figs 7 9 show the accumulated hourly absolute deviation for each of the hbm 1 6 and hbm 3 6 simulations from the observed water levels δ a c c see eq 4 the agreement between each of the ocean simulations hbm 1 6 and hbm 3 6 and the observations varies both between stations and between storms figs 7 9 hbm 1 6 generally produces higher water levels with larger deviations from the observations than hbm 3 6 in several cases this upward shift of the water level curve results in a smaller peak error for hbm 1 6 however both model products fail to fully capture the observed shape of the peaks for the 2005 case it is especially noticeable how hbm 1 6 produces peaks that are too broad shouldered fig 8 which causes the accumulated deviation δ a c c to increase in summary the hbm 1 6 simulations generally display poorer agreement with observations than hbm 3 6 the largest differences between hbm 1 6 and hbm 3 6 occur during the 2005 storm where δ a c c for hbm 1 6 is either consistently higher or very similar to δ a c c for hbm 3 6 for the 1999 storm the δ a c c for hbm 1 6 is again consistently larger or very similar except for the second observed peak at station 4 where hbm 3 6 simulates too small a reduction in the water level subsequent to the first peak geographically and for all three cases in the present study the largest discrepancies between the hbm 1 6 and hbm 3 6 simulations are seen on the west coast of denmark this pattern is clear in fig 10 where snapshots of the distributed differences between hbm 1 6 and hbm 3 6 are seen for all three cases during the passage of each storm the time stamps are selected based on displays of large and extensive differences close to the time of the highest observed values on the west coast for the 2005 event see also fig 6 which indicates a significantly higher shoreward momentum transfer for uerra 1 6 at this time the large differences appear because the strongest impact of the storm in this region coincides with the interpolated time stamps fig 11 shows a zooming in of the pattern of relative differences like fig 10 but divided by hbm 3 6 values on almost the entire west coast hbm 1 6 simulates 10 20 higher water levels than hbm 3 6 for the 1999 case panel a in the southeastern wadden sea the difference approaches 25 during the 2005 storm panel b the water level is consistently around 15 higher along most of the coastline although slightly higher values are seen south of station 3 and towards station 1 panel c has a pattern with smaller differences on the west coast mainly confined to the wadden sea the time stamp shown for the 2013 case is many hours before the storm surge impacted the inner danish waters compare station 4 fig 9 the prominent patterns seen in the transition zone are not related to high water but are instead because the water level anomalies in this region were much smaller 4 discussion in this study we initially compare the era interim based uerra harmonie v1 regional atmospheric reanalysis ridal et al 2017 against observations to assess its suitability for driving a storm surge model we then compare observed and simulated water levels using the dmi hbm ocean model driven by the reanalysis during three recent storm surge events along danish coastlines two different configurations are considered one using an unmodified version of the uerra data hbm 1 6 and one where erroneous spikes hbm 3 6 see section 2 4 1 were replaced 4 1 evaluation of atmospheric forcing the six hourly analysis fields from which the re forecasts are initialized have a higher correlation and exhibit the lowest standard deviation with respect to observations when compared to the re forecasts uerra 1 6 see section 2 4 1 and operational forecasts hirlam see section 2 3 2 not shown however the lower temporal resolution of the analysis fields makes them less suitable as forcing for extreme storm surge modelling see e g dullaart et al 2020 muis et al 2016 as the wind field becomes substantially smoothed which results in underestimates of extreme water levels the atmospheric uerra 1 6 reanalysis data set generally has good agreement with observations figs 3 4 although spurious spikes in for example the wind speed in the first and second time stamps after each analysis cycle are present this indicates a significant departure of the assimilated observations from the background state t 6 of the previous analysis cycle such fluctuations in the wind field periodically amplify or in some cases reduce the wind speed and changes the direction of the wind over affected regions fig 3 the characteristics of the spikes seem to be storm specific the location and severity of the fluctuations differ between the different storms considered in this study with the 2005 storm showing the most pronounced patterns figs 2 6 5 4 2 evaluation of simulated water levels the ocean hindcast hbm 3 6 forced by uerra 3 6 shows good agreement between the simulated and observed water levels table 3 the spatio temporal resolution of the hbm model yields a higher accuracy in the complex transition zone between the north sea and the baltic sea than model systems that simulate storm surges on global or pan european scales at lower resolutions muis et al 2020 fernández montblanc et al 2020 for the three storm surge events considered here the superior resolution results in high quality simulations of extreme sea levels that are adequate for adaptation planning madsen et al 2019 several improvements smaller peak errors better phase of the peaks are observed when comparing to the lower resolution operational product operational cmod v2 dmi that was standard in 2005 fig 8 for example hbm 3 6 has a better phase of the peak for the 2005 case when the operational simulation displays a negative phase shift for the 2013 case the operational modelling system consists of the same ocean model and a higher resolution atmospheric forecast system 3km grids see section 2 3 2 the lower spatial resolution of the atmospheric forcing for hbm 1 6 and hbm 3 6 does not appear to reduce the quality of the simulations since they are very similar to the operational simulations fig 9 4 3 irregularities in the atmospheric forcing in this study we investigate two different configurations of the atmospheric forcing one where the unmodified noisy data set is used and another where we have effectively reduced the temporal resolution by linearly interpolating over two out of every six time stamps in order to reduce the inherent noise detected in these time stamps table 4 compares the rmse and mae for the storm surge simulations driven by the unmodified and interpolated forcing data sets respectively with one exception station 2 1999 case the rmse is found to be smaller for the modified data set than for the unmodified one for all stations that experienced extreme water levels station 4 also had a higher rmse for this case however this exception is of minor importance since the 1999 storm did not generate high water levels at this particular station the greatest improvements are seen for the 2005 case see also section 4 1 rmse and mae are 5 5cm and 4 5cm lower respectively when averaged over the four stations during this event despite this major improvement rmses for this particular event remain relatively large the effect of the erroneous fluctuations in the forcing data mainly manifested as higher peak water levels in the ocean model simulations when uerra 1 6 was used as forcing for the storm surge model the simulated peak water levels exceeded the observed water levels at the study locations for hbm 3 6 the simulated water levels were occasionally too low but they had a higher general agreement lower rmse with observations than hbm 1 6 figs 7 9 table 4 accumulation of the hourly absolute error around the time of the peak water levels δ a c c figs 7 9 bottom panels shows that hbm 3 6 is either better or equally skillful in reproducing the temporal development of the peak the interpolation of the original forcing data results in a smoother and weaker wind field the reduction of the wind speed amounts to 9ms 1 20 30 on denmark s northwest coast for the 2005 storm fig 6 this results in a significantly lower shoreward momentum transfer for the interpolated data sets the reduction is greatest for the 2005 storm in terms of both the magnitude and spatial extent affecting the entire danish west coast the obvious reason is that the two replaced time stamps during this 2005 storm occurred simultaneously with the storm reaching the coasts which was not the case for the other two storms fig 10 the effect is more evident in fig 8 where the reduced wind stress results in 30 40cm lower water levels along much of the western coastline for the 2013 storm the area of reduced shoreward wind corresponds well with the region of lower water levels in fig 10 panel c the largest discrepancies between hbm 1 6 and hbm 3 6 around denmark are found on the west coast fig 10 which saw some of the most extreme water levels during these case events due to the strong westerly wind components and this coast s exposure to the north sea additionally the tidal range is one order of magnitude larger than in denmark s more sheltered and micro tidal inshore waters i e with an amplitude of approximately 2m vs 0 3m non linear interaction between the atmospheric and tidal forced water level contributions therefore has a much stronger potential to affect the total water level in this region horsburgh and wilson 2007 compared to denmark s inshore waters the timing of when during the analysis cycle a storm has its largest impact affects how much the peak water levels differ between hbm 1 6 and hbm 3 6 during the 1999 storm the maximum water level and shape of the peak at station 1 are nearly identical between the two simulations for this storm the timing of the storm passage is such that the largest effect of the wind stress occurs later in the analysis cycle this means that the peak water levels are reached at a time when the forcing has been identical for several hours before the water level reaches its maximum instead the largest difference between the two simulations in this case is seen earlier in the same analysis cycle analysis at 12 00 utc 3 december where a larger deviation at stations 1 3 of hbm 1 6 from the observed water levels is present there is a higher degree of similarity for the hbm 1 6 and hbm 3 6 simulations for the 1999 and 2013 storms respectively than during the 2005 storm this can be expected due to the smaller variability in each analysis cycle for these events not shown in cases where the spikes are less prominent typically calmer wind conditions schimanke et al 2020 the hbm 1 6 and hbm 3 6 simulations are very similar despite the reduced temporal resolution of hbm 3 6 the information lost does not seem to have a significant impact on the quality of the hbm 3 6 for the cases studied here furthermore the good agreement with the observations table 3 confirms that the method also performs well over longer time periods we argue that more sophisticated methods of filtering the deficiencies in the forcing data might be able to improve the results further but this was outside the scope of the present study the use of uerra as forcing for regional ocean models will however be evaluated further in a multi model framework by different institutes in the baltic sea modelling community leibniz institute for baltic sea research warnemünde 2019 placke et al 2018 the present study demonstrates that the hbm ocean model is able to satisfactorily reproduce observed water levels for extreme historical storms while at the same time being robust against the systematic errors that are present in the forcing data table 4 that said in most cases a slight improvement is seen when using the corrected forcing data this suggests that the model is also capable of producing reasonable results when used for future regional climate projections where systematic errors in the forcing data are common jacob et al 2007 haas et al 2014 future work by the author team will employ the hbm modelling system on future projections e g to assess future extreme water levels and the associated potentially harmful impacts of storm surges on danish coastlines 5 conclusions in this paper we employ a regional ocean model to study three extreme storm surge events along the complex danish coastlines we evaluate the simulated water levels as well as the atmospheric regional reanalysis that forces the ocean model against observations in general we show that the modelling system reproduces extreme water levels with a high level of skill in terms of both the timing and magnitude of these events we investigate the effect of erroneous fluctuations in the forcing data associated with two out of six time stamps in each analysis cycle by replacing the effected time stamps with linearly interpolated values this interpolation resulted in a reduction of the wind speed by e g 9ms 1 20 30 off the northwest coast of denmark for the 2005 storm by replacing the first two time stamps from each analysis cycle with linearly interpolated values the accuracy of the simulated water levels was improved compared to using the original data set as forcing generally the simulations driven by the interpolated data set are either better than or equally good at reproducing the temporal development of the extreme high water levels with lower rmses 5 5cm than average for the 2005 storm and lower mean absolute errors an average reduction of 4 5cm for the 2005 storm the effect of the interpolation of forcing data largely depends on the location and magnitude of the spikes and at which stage in the storm s evolution these two replaced time stamps occur our model results therefore demonstrate that removing time stamps that are disproportionately affected by noise and thus effectively reducing the temporal resolution of the forcing data was preferable to using the original forcing data set more sophisticated methods of filtering out the erroneous fluctuations while retaining more of the original data set might have an even larger benefit than the method used in this study our study has large implications for future climate simulations of storm surges in the context of developing estimates of exceedance probabilities and recurrence periods based on the model output another implication of this is that reconstructions of historical storm surges that are lacking in observational records can become more accurate when employing climate reanalysis abbreviations uerra 1 6 original regional reanalysis data set that includes all time stamps uerra 3 6 manipulated regional reanalysis data set from which the first and second time stamps in each analysis cycle are excluded hbm 1 6 ocean simulation driven by uerra 1 6 hbm 3 6 ocean simulation driven by uerra 3 6 δ a c c accumulated hourly absolute deviation in a six hour time window credit authorship contribution statement elin andrée conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jian su conceptualization methodology software investigation writing review editing morten andreas dahl larsen conceptualization methodology writing review editing kristine skovgaard madsen resources conceptualization funding acquisition writing review editing martin drews funding acquisition conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work reported in this paper is part of a greater shared effort between the technical university of denmark dtu and the danish meteorological institute dmi with the aim of investigating the processes that lead to extreme storm surges through meticulous numerical atmospheric oceanic modelling part of the funding is provided by the danish state through the danish climate atlas 
