index,text
3915,deep learning methods have recently shown a broad application prospect in rainfall runoff modeling however the lack of physical mechanism becomes a major limitation in using machine learning methods that rely on the available labeled observations to address this issue the study proposes that synthetic samples are added to train the deep learning network by using three previously undiscussed physical mechanisms as follows 1 extreme heavy rainfalls when the soil water is saturated 2 long duration rainless events when soil water is exhausted and 3 the monotonic relationship between rainfall and runoff a physics guided long short term memory lstm network shortly named phy lstm is then formulated phy lstm network is trained on 531 basins of the catchment attributes and meteorology for large sample studies camels dataset indicating that the performance is significantly improved compared to conventional lstm specifically the mean nash sutcliffe efficiency nse improves from 0 52 to 0 61 from the daily simulations during the testing period in local models it is demonstrated that synthetic samples can effectively improve the simulation of flood peaks and reduce the number of negative streamflow and strong monotonicity is still maintained even if a slight disturbance is involved in the training dataset the proposed phy lstm shows that physical mechanisms are very useful to improve efficiencies of the data driven rainfall runoff model keywords deep learning lstm model rainfall runoff model physical consistency synthetic samples 1 introduction the rainfall runoff model has always been one of key researches in hydrology which provides an important support for water resources guo et al 2018 li et al 2020 tajiki et al 2020 xie et al 2020a especially the prediction of flood gao et al 2019 hostache et al 2018 zhang et al 2018 and drought disasters kang and sridhar 2017 pan et al 2020 the conventional rainfall runoff model estimates streamflow based on hydrophysical processes chorley 2019 xie et al 2020b these sub processes are driven by physical mechanisms in a nonlinear manner including evapotranspiration interception infiltration soil moisture and groundwater exchange as well as the impact of water conservancy projects and other human activities sophocleous 2002 however the physical processes are so complex in hydrological models that it is difficult to discover the information from the available inputs deep learning has successfully overcome the once intractable problems driven by the increasingly powerful performance of computers and the availability of larger datasets xu et al 2021 especially in computer vision nixon and aguado 2019 weiss et al 2020 and natural language processing chowdhary 2020 shen et al 2020 young et al 2018 for example moghaddam et al 2021 investigated the ability of diffuse structures in deep learning to infer effective hydraulic conductivity ehsani et al 2021a used radar information by machine learning and found that the advanced very high resolution radiometer avhrr product can contribute to precipitation estimates at high latitudes they further predicted dynamical spatiotemporal precipitation by using recurrent nowcasting net rnc and convolutional nowcasting net cnc architecture ehsani et al 2021b simulations based on data driven models have become a new solution for rainfall runoff models shen 2018 tikhamarine et al 2020 yang et al 2019 with the development of deep learning recent advances have been widely used in practice such as a recurrent neural network rnn and its variant long short term memory lstm network which achieved enhancements to predict runoff from meteorological observations compared to the conventional physics based models feng et al 2020 hu et al 2018 for example kratzert et al 2018 tested the lstm model in the catchments of the freely available catchment attributes and meteorology for large sample studies camels dataset compared to the existing hydrological models safari et al 2020 implemented the regression in the reproducing kernel hilbert space rrkhs which is highly flexible to provide better forecasts as compared with other alternatives researchers also focused on the improvements for the standard lstm architecture e g entity aware lstm kratzert et al 2019 and sequence to sequence modeling xiang et al 2020 kao et al 2020 proposed long short term memory based encoder decoder lstm ed model for multi step ahead flood forecasts and increased the interpretability of the model however the lack of physical mechanism becomes a major limitation of deep learning which relies on the available labeled observations since most deep learning models can only capture the correlation between variables they do not understand the causal relationships karpatne et al 2017a described that data driven and physical based models represent the two extremes of knowledge discovery physical based models are well suited to represent processes for which are conceptually well understood on the other hand conventional data driven models rely on the information contained in the data specifically a deep learning model can fit the observed data well but the prediction may not be physically consistent and then even a slight disturbance can lead to large changes liu et al 2017 reichstein et al 2019 therefore physics guided deep learning models are possible solutions to the problem at hand it would be of special interest to explore the continuum between deep learning models and physical mechanisms where both physic and data are used in a synergistic manner recently there has been an increasing interest in the achievement of physical consistency by training models about the rules of physical processes in water resources which aims to improve the performance of deep learning models in realizing theoretical discovery karpatne et al 2017a one of the methods was the output of a physically hydrological model used as another input in the neural network model along with the drivers konapala et al 2020 yang et al 2020 for example yang et al 2020 developed an improved model in data limited basins by combining artificial neural networks with synthetic runoff data in a distributed hydrological model another hybrid modeling strategy was used for correcting mismatch where physical knowledge was implanted into the deep learning model farfán et al 2020 jiang et al 2020 developed a hydrology aware deep learning model by a p rnn layer wrapped with physically meaningful parameters in the exp hydro model additionally some studies used the physical constraints as loss terms in the artificial neural network which has been successfully applied in the prediction of the lake water temperature and the subsurface flow read et al 2019 wang et al 2019 the hybrid modeling framework was used to predict the lake water temperature at different depths by integrating energy balance constraints karpatne et al 2017b read et al 2019 physical mechanisms were also used to train the deep learning model to predict groundwater wang et al 2019 where the neural network was guided by the basic theory such as control equations boundary conditions other physical constraints engineering control and expert experience consequently it has become an essential question that how to develop a quantitative understanding of the theoretical process to achieve physical consistency in a hydrological model increasingly dominated by deep learning nearing et al 2020 however to the best of our knowledge there is little attention paid to the extreme events and monotonic relationships of a deep learning network for rainfall runoff simulation three physical mechanisms are therefore considered to constrain the deep learning network from high flow low flow and monotonic properties which is the extreme events and internal relationships that are rare in historical observations but are obvious based on physical mechanisms specifically we address the following objectives 1 how to educate a deep learning network the extreme events of a heavy rainstorm 2 how to educate a deep learning network the extreme events of long duration rainless 3 how to improve the simulation by considering the monotonic relationship between rainfall and runoff the remainder of this paper is organized as follows details on the chosen catchments are described in section 2 section 3 describes the methodology for the data driven model based on physical mechanisms followed by results and discussion in section 4 lastly conclusions are drawn in section 5 2 data the basins used in this study were obtained from the camels dataset in the continental united states which was an international cooperation project for hydrologic and atmospheric models addor et al 2017 newman et al 2015 the dataset which consisted of the daily meteorological forcing inputs the catchment attributes and streamflow observations was available for the comparative study of large samples the camels contained meteorological inputs of four levels including 18 hydrologic units 671 basins more detailed hydrologic response unit hru regions and different elevation bands the camels basins range in size between 4 and 25000 km2 and they have relatively low anthropogenic impacts in this study the selection of 531 basins was selected from the camels dataset which was the same as newman et al 2017 these basins were selected out of the full set based on the following criteria 1 areas of the basins were smaller than 2000 km2 2 there was a discrepancy less than 10 between different methods of calculating basin area the models were trained with an updated version of the maurer forcing data kratzert et al 2019 maurer et al 2002 the daily meteorological input data were available including precipitation maximum temperature minimum temperature average short wave radiation and vapor pressure the streamflow at the outlet was measurements from the usgs gauging stations additionally as table 1 shows the 27 catchment attributes were concatenated as static inputs to the meteorological forcings at each time step data division was the same as previous studies kratzert et al 2019 for a fair comparison the training dataset lasted from 1 october 1999 through 30 september 2008 and the testing dataset lasted from 1 october 1989 through 30 september 1999 data normalization is generally performed during the data preprocessing step in this study min max normalization is used as the rescaling method 3 methodology fig 1 provides an overview of the proposed physics guided deep learning network which develops the methodology as follows 1 three physical mechanisms were used to increase the physical interpretability of the deep learning networks by adding synthetic samples section 3 1 2 the physical constraints were implemented into deep learning networks of local and regional scales by the exterior terms imposed on the loss function section 3 2 3 simulation accuracy and physical consistency were evaluated by using varied statistical criteria section 3 3 3 1 physical mechanisms for rainfall runoff model 3 1 1 extreme events of the long duration heavy rainstorm to establish physical mechanisms for rainfall runoff modeling the law of conservation of water is used the water balance equation controls the hydrological cycle by describing the flow into and out of the system the runoff yield from a given rainstorm during the time t can be calculated as follows 1 q t p t e t δ s t where the amount of water that a watershed receives is the precipitation pt mm and the amount of water consumption has three parts evapotranspiration et mm an increase in soil moisture content δ s t mm and the runoff q t mm the soil moisture increases from the initial soil water content s 0 to the soil water content s t at the end of rainfall therefore it can be described as follows 2 q t p t e t p t a s p t p s t s m where p are the long duration heavy rainstorm and the soil wetting reaches its maximum saturated state s m the runoff is equal to the heavy rainfall which is much greater than the ignored evapotranspiration when soil moisture has been saturated however the probability of heavy rainfall occurrence is very low in the historical data which leads to a large error in the simulation of the peak flow when using deep learning networks to solve this problem synthetic samples also called artificial samples are constructed to improve learning performance synthetic samples different from the actual samples can provide special information about the physical events and relationships the data pairs for the synthetic samples are the rainfall and the runoff determined by physical mechanisms to train the deep learning model to deal with the extreme events of the long duration heavy rainstorm the made up year of the synthetic samples is added into the actual observation series combinations of synthetic samples are considered with varied rainfall intensities and varied durations the labels are its streamflow when all rainfall yields runoff therefore the function for heavy storms is used by the following equations 3 q t f x t τ f x t τ x t τ 1 x t 1 x t 4 f p t i τ p t i 0 t t f 5 mse 1 nt u n t 1 nt u i 1 n f p t i τ p t i 2 where q t donates the simulated streamflow f is the simulation function of the deep learning method x t is the normalized inputs τ is the input sequence length and models are run in the sequence to one mode so that to simulate a daily discharge required meteorological forcings from τ preceding days p t i is the rainstorm events of different intensity t f is the time when soil water is saturated mse is the mean square error mse for heavy rainstorm events nt u is the duration of heavy rainstorm samples and n is the number of varied rainstorm intensities 3 1 2 extreme events of the long duration rainless the streamflow during long duration rainless events determines the lower boundary condition for rainfall runoff modeling there is a relatively rapid hydrograph rise to a peak which usually occurs at or soon after the input ceases followed by a hydrograph recession a recession period lasts until streamflow begins to increase again due to subsequent rainfall if the rainless continues long enough streamflow only includes baseflow cheng et al 2020 therefore the lower boundary condition of the rainfall runoff model is that the base flow will be exhausted and the basin will not yield runoff after the extreme long duration rainless events the flow is never negative in the physical world there are often negative values when using deep learning networks which usually can be solved by setting the linear activation function of the output layer to rectified linear unit relu this physics guided lstm model attempts to track the water balance of the baseflow in the recession period however the magnitude of baseflow varies in each different watershed and it is difficult to be determined as a constant therefore when an extreme hypothetical case of prolonged absence of rainfall is considered the baseflow is completely depleted to zero therefore to train the physics guided deep learning model to prevent negative values synthetic samples of long duration rainless events are added to the training dataset the soil moisture is exhausted and the corresponding runoff is equal to zero when the basin experiences a long duration rainless situation the synthetic samples are long duration rainless and its streamflow when the soil moisture dries up the function for rainless events is used by the following equations 6 f p t 0 τ 0 a s p t 0 0 t 7 mse 0 1 nt l t 1 nt l f p t 0 τ 2 where p t 0 is the precipitation of long duration rainless events i e 0 mm mse 0 is the mean square error in response to the rainless events and nt l is the sample length of long duration rainless events 3 1 3 monotonic relationship between rainfall and runoff the internal relationship between rainfall and runoff is considered to ensure that the physical laws are upheld in the runoff simulation of a deep learning model the rainfall runoff relationship for any rainstorm depends on the dynamic interaction between rain intensity evapotranspiration infiltration and storage the relationship between rainfall and runoff should be presented monotonously i e the runoff should be larger if there was a small increase in the rainfall at the current time step however the simulation cannot guarantee the monotonicity of simulation by conventional deep learning models which is physically inconsistent with the water balance equation prediction errors can be very large even if a slight disturbance to the training dataset in terms of the model without physical consistency essentially this is because the deep learning model ignores the complex physical processes and underlying surface conditions when it is trained as a black box for fitting the highly nonlinear system it can only capture the correlation between variables without physical mechanisms therefore it cannot understand the cause and effect furthermore the function of the monotonic relationship between rainfall and runoff is as follows 8 f p t i δ p i τ f p t i τ 0 9 mse mcp 1 nt mcp n mcp t 1 nt mcp i 1 n mcp r e l u f p t i τ f p t i δ p i τ 2 where δ p i is a small increase in rainfall mse mcp is the mean square error for the monotonic relationship nt mcp is the sample length of the disturbed rainfall n mcp is the number of different levels of the increase from small to large and relu is the response function excluding the monotonic term and retaining the nonmonotonic term besides the relationship between evapotranspiration and runoff is also monotonic as follows 10 f e t i δ p i τ f e t i τ 0 11 mse mce 1 nt mce n mce t 1 nt mce i 1 n mce r e l u f e t i δ e i τ f e t i τ 2 where δ e i is a small increase of evapotranspiration mse mce is the mean square error for the monotonic relationship of the evapotranspiration nt mce is the sample length of the disturbed evapotranspiration and n mce is the number of different levels of the increase 3 2 deep learning network based on physical consistency sufficient sample sizes are very important to construct effective deep learning models but heavy rainstorms and long duration rainless samples are rare in the historical data to overcome this challenge synthetic samples that follow three physical mechanisms are used as the additional input to train the model in this study physical consistency is considered to the deep learning model by using domain oriented constraints inspired by three physical understandings all model configurations are trained using the following mse as loss function the exterior loss function of the hydrological physical process is added to the conventional objective of the model by the following equations 12 loss λ data m s e data λ mse λ 0 mse 0 λ mcp mse mcp λ mce mse mce 13 mse data 1 nt t 1 nt q t q t 2 where loss is the loss function λ data is the weight coefficient for simulated runoff mse data is the mean square error of simulated runoff by deep learning method λ is the weight coefficient for heavy rainstorm events λ 0 is the weight coefficient in response to long duration rainless events mse mcp and mse mce are the loss functions for the monotonicity including rainfall and evapotranspiration λ mcp and λ mce are the corresponding weight coefficients for the monotonicity and nt is the length of time series the final configuration is chosen by taking the weights that resulted in the highest mean nse as shown in table 2 the initial proportion of physical mechanisms have the same value i e the four constraints are treated equally the final weights are set to 0 6 0 1 0 1 0 1 0 1 for the five mses in this study it should be noted that the final weights are the result of the optimal nse by assessing the relative importance of different weights lstm networks are designed to avoid the weakness of the conventional rnn to learn long duration dependencies cheng et al 2016 hochreiter and schmidhuber 1997 the deep learning networks are developed based on open source software the programming language of choice is python 3 7 pytorch framework and nvidia tesla v100 16 gb gpus are used for training 3 2 1 experimental 1 local models lstm networks are applied independently to each watershed in local models hyperparameters and sample parameters are needed to be determined in establishing the proposed physics guided lstm networks the hyperparameters will influence the structure and training of lstm networks for all local lstms and phy lstms the same architecture is used different settings and models are trained and tested where the optimal hyperparameter is found in local models the number of hidden layers is set to 2 the hidden size is set to 40 and the number of the batch is 1 10 of the number of samples the dropout rate is set at 0 4 and the training epochs are 200 the input sequence length τ is set to 20 preceding days besides the parameter of samples will influence the implementation of physical mechanisms five different intensity settings and 10 different duration settings are added for a total of 50 different synthetic samples where the total mse is the mean of the 50 scenarios the long duration heavy rainstorm events p have different rainstorm intensities of 50 mm 75 mm 100 mm 125 mm and 150 mm respectively the duration of the made up period of the synthetic samples is 10 100 days in each batch of training samples which are equally divided every 10 days 3 2 2 experimental 2 a regional model the regional model extends the simulation ability across the similarity behaving catchments in large regions hestness et al 2017 kratzert et al 2018 huge training data of 531 basins in the camels are used to learn more general rainfall runoff relationships only in an lstm network which is the potential for predictions in the ungauged basins the same architecture is used for all regional lstms and phy lstms the structure of the regional model is different from that of the local model since the scale of the input data to the model differs significantly the hyperparameters optimization can refer to the previous research in kratzert et al 2019 in the regional model the number of hidden layers is set to 1 the number of the batch is 1 12 of the number of samples and the training epochs are 30 the lstms had 256 memory cells and a single fully connected layer with a dropout rate of 0 4 the lstms were run in sequence to value mode with the input sequence length τ is set to 270 preceding days 3 3 model evaluations 3 3 1 simulation accuracy four widely used statistical criteria are used to quantify the performance of the model simulations in this study 1 nash sutcliffe efficiency nse nash and sutcliffe 1970 14 n s e 1 t 1 nt q obs t q sim t 2 t 1 nt q obs t q obs 2 where q obs t is the observed variable q sim t is the computed variable nt is the total number of observations and q obs is the overall mean daily observed variable 2 pearson correlation coefficient r 15 r t 1 nt q obs t q obs q sim t q sim t 1 nt q obs t q obs 2 t 1 nt q sim t q sim 2 3 bias gupta et al 1999 16 b i a s t 1 nt q obs t q sim t t 1 nt q obs t 100 4 the kling gupta efficiency kge gupta et al 2009 is a model evaluation criterion that can be decomposed into the contribution of mean variance and correlation on model performance kge is calculated as follows 17 k g e 1 r 1 2 μ sim μ obs 1 2 σ sim σ obs 1 2 where μ and σ are the mean and standard deviation of the variables kge value ranges from to 1 with a value closer to 1 indicating a better simulation performance 3 3 2 physical consistency three criteria are selected to pay attention to the model performance of high discharge and low discharge according to the flow duration curve fdc yilmaz et al 2008 5 bias in fdc high segment volume f h v 18 f h v h 1 h q sim ξ q obs ξ h 1 h q obs ξ 100 ξ 1 2 h where h is the number of flood events with a frequency of less than 0 02 and q ξ is the discharge of flood frequency ξ 6 bias in fdc midsegment slope f m s 19 f m s l o g q sim 0 2 l o g q sim 0 7 l o g q obs 0 2 l o g q obs 0 7 l o g q obs 0 2 l o g q obs 0 7 100 7 bias in fdc low segment volume f l v 20 f l v 1 l 1 l l o g q sim l l o g q sim l l 1 l l o g q obs l l o g q obs l l 1 l l o g q obs l l o g q obs l 100 l 1 2 l 21 q l m i n q t where l is the number of low flows with a frequency higher than 0 7 the physical consistency becomes better with the value of three evaluation approaches 0 4 results and discussion the proposed network considering physical mechanisms was implemented into the deep learning model in local and the regional scales respectively first we explained why the input of synthetic samples was used to solve the problem of physical consistency in local models section 4 1 second we further explained how extreme events of the long duration heavy rainstorm improved the simulation of high flow section 4 2 after that the prevention of the negative values by extreme events of the long duration rainless was clarified section 4 3 and then the monotonicity of the simulation was verified section 4 4 finally we analyzed the reasons for the model performance in the regional model section 4 5 4 1 comparison of model performance of physics guided deep learning networks in local models a set of existing lstm models and some hydrological models by several previous studies are collected over the camels which were calibrated in individual basins or the continental united states table 3 shows the results of the models in this study compared with the results of the other models used by the researchers in the camels the local lstm models were trained as the base model for comparison from all 531 basins using inputs of the meteorological data and static catchment attributes the results of the base model were the same as the one in kratzert et al 2019 which reported a mean nse of 0 52 in local models furthermore the phy lstm network had a higher simulation accuracy in the testing set the average nse was 0 61 the median was 0 66 which was 0 08 and 0 09 higher than the conventional local lstm models the improvement of the phy lstm network lies in the input samples as a novel input augment method the synthetic sample are added to improve the phy lstm network considering the physical mechanisms the results indicated that the input of synthetic samples can be helpful to provide more information on the definite boundaries rarely considered by the actual observations as shown in fig 2 the conventional lstm and the phy lstm network were compared with the nse distribution in the camels during the testing period the nse of the conventional model in 26 basins was higher than 80 112 basins higher than 70 and 237 basins higher than 60 the results of the phy lstm network simulation indicated that the nse of 52 basins was higher than 80 that of 190 basins was higher than 70 and that of 343 basins was higher than 60 to evaluate the effectiveness of the proposed approaches the simulation results of the conventional data driven lstm model and the physics based xinanjiang model are compared in the same basins fig 3 shows the cumulative probability distribution of the six metrics of phy lstm networks in all studied basins there was a significant difference between lstms trained with vs without physical mechanisms the mean r improved from 0 78 to 0 89 while simultaneously reducing the bias then three criteria are compared according to the flood frequency curve flv and fhv improved but there was no statistically significant difference for fms overall the results showed that the proposed phy lstm network can simulate the hydrological processes effectively 4 2 high flow simulation by deep learning about extreme events of the long duration heavy rainstorm to overcome the problem of inadequate mechanisms for extreme events synthetic rainstorm samples assisted in training physics guided deep learning models as shown in fig 4 a the mse of the heavy rainstorm was reduced using the deep learning model based on a physical mechanism compared with the conventional model the mse of the heavy rainstorm constraints decreased from a mean of 0 47 to a mean of 0 15 the performance of the conventional lstm model in high flow simulation was poor because of the rarity of rainstorm samples or the absence of heavy rainstorm events in the training period the simulated peak flow was often unsatisfactory especially in the case of heavy rainstorm events with low frequency therefore the rainstorm samples were added to the historical observations for a long time a typical basin i e pitman river ca basin number 11237500 is selected as an example as shown in fig 5 the flood peak flow simulated by the model was greatly improved compared with the conventional lstm simulation when adding a 50 mm long duration rainstorm and 100 mm long duration rainstorm respectively in the selected basin at this moment all the rainfall should generate runoff when the soil moisture was saturated after a long period of the rainstorm the results demonstrated that the synthetic samples of a heavy rainstorm can effectively improve flood peak simulation however it was related to the intensity of the rainstorm the rainstorm of 100 mm was the better intensity of the rainstorm flood in the selected basin the results confirmed that the intensity of the samples was associated with the improvement 4 3 low flow simulation by deep learning about extreme events of the long duration rainless to improve the ability of deep learning networks to simulate low flows synthetic samples of long duration rainless events were used as shown in fig 4b the mse of the long duration rainless constraint decreased from mean 0 50 to mean 0 04 if there was no rain for a long time the soil moisture would be exhausted and runoff would not happen again however as shown in fig 6 a the conventional simulation often appeared negative flow which indicated that the existing samples cannot train the model in the part of low flow the usual experience was to change the negative value to 0 directly by the relu method in this study the conditions of synthetic rainless samples can be simulated confidently to constrain the conventional model in fig 6 b the occurrence of negative flow was greatly prevented with the support of constraints of long duration rainless events the addition of synthetic samples was helpful to improve physical consistency which provided proof for the establishment of the data driven model using theoretical constraints 4 4 extending the ability of the monotonic rainfall runoff relationship the monotonic relationship between rain or evaporation and runoff was used to train the phy lstm network the monotonicity rule says that hydrological simulation should have monotonically output with monotonical inputs that is the runoff would increase even if a small increase in the rainfall as shown in fig 7 a a small disturbance is increased in the rainfall to the testing set of the lstm model and the results showed that there was a huge nonmonotonicity in most basins the results of most basins showed that the conventional lstm model has high mse the mean and median mse mcp of the 531 basins showed that the monotonic performance of the conventional deep learning network was gradually getting worse during the learning epochs the conventional data driven model mainly depended on the information contained in the data which was applicable in areas equipped with a large supply of representative data samples as shown in fig 4c the mse of the monotonicity decreased from mean 0 36 to mean 0 11 for a small increase in the historical rainfall samples the new simulation results should increase monotonously compared with the previous simulations fig 7b illustrated the decreased mse by the phy lstm network where the monotonic relationship educated the deep learning models it provided the largest set of significant clusters of the approach and the possibility of a deep learning model to extend the ability of monotonicity phy lstm models can be well suited to represent understandable processes using known scientific principles 4 5 model performance of physics guided deep learning networks in the regional model as shown in table 3 in the regional model the phy lstm model improved the simulation accuracy without catchment attributes added to the input data when the mean nse value increased from 0 39 to 0 49 however another important finding was that the phy lstm was not improved with catchment attributes in the regional model table 4 shows all evaluations for the local and regional models to find out why physical constraints were effective for local models but had little improvement in the regional model a set of experiments were performed to compare the simulation accuracy of lstm and phy lstm with the increasing number of basins as shown in fig 8 the deep learning network was less effective when the number of basins was small or even in local models and samples of hydro physical processes were used as effective information to improve the simulation accuracy the accuracy of the deep learning network improved as the increasing number of basins when more basins can provide more information to each other the diminishing role played by physical constraints suggested that the regional deep learning model was not entirely non physical a possible explanation for these results may be extreme weather events that did not occur frequently in one basin but other basins of the region the model can mine the rainfall runoff relationship among basins with similar characteristics through the deep learning of the regional lstm model sufficient data not only improved the accuracy of the model but also contributed to the physical consistency of the model the further comparison indicates better fhv and flv for the regional model however fig 9 shows the monotonic performance of the change of the discharge with an increase of 0 1 mm rainfall disturbance and the results demonstrated that the nonmonotonic rainfall runoff response still existed even in the regional model together these results provide important insights into the monotonic relationship which should be considered by physics guided deep learning network although in the regional model 5 conclusions in this paper a deep learning model based on physical mechanisms was constructed to simulate the rainfall runoff process over the camels in the united states the main objective of the current study was to investigate the effects of extreme events and the monotonic relationship of a deep learning network for rainfall runoff simulation considering the physical mechanisms synthetic samples were used as extra inputs for deep learning and the exterior loss functions of the hydrological physical process were added to the conventional optimization objective of the model conclusions derived are as follows 1 it was indicated that synthetic samples provided more information on the hydrological theory that is not embedded in the actual observations the mean nse increased from 0 52 for models without physical consistency to 0 61 for local models based on physical mechanisms during the testing period 2 extreme events were effective for establishing deep learning models with physical consistency adding synthetic samples can improve the simulation of flood peaks with the mse of the heavy rainstorm constraints decreased from mean 0 47 to mean 0 15 besides synthetic samples can reduce the occurrence of negative streamflow with the mse of long duration rainless constraints decreased from mean 0 50 to mean 0 04 this approach is useful for hydrological simulation especially for the prediction of flood peaks and the prevention of negative values in the simulation 3 the relationship between rainfall and runoff in this study can train deep learning networks both in local and regional models which can significantly extend the ability of the monotonicity the deep learning network based on constraints of physical consistency enables the system to train the model about available physical knowledge further research should focus on validating the effects of more constraints of physical consistency and expanding the use of the physics guided deep learning model in the field of water resources credit authorship contribution statement kang xie conceptualization methodology writing original draft pan liu conceptualization supervision writing review editing jianyun zhang supervision writing review editing dongyang han guoqing wang writing review editing chaopeng shen methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china 51861125102 the joint funds of the national natural science foundation of china u1865201 and innovation team in key field of the ministry of science and technology 2018ra4014 the authors appreciate the help from the supercomputing center of wuhan university for providing the necessary guides to perform the numerical calculations of this study on the supercomputing system 
3915,deep learning methods have recently shown a broad application prospect in rainfall runoff modeling however the lack of physical mechanism becomes a major limitation in using machine learning methods that rely on the available labeled observations to address this issue the study proposes that synthetic samples are added to train the deep learning network by using three previously undiscussed physical mechanisms as follows 1 extreme heavy rainfalls when the soil water is saturated 2 long duration rainless events when soil water is exhausted and 3 the monotonic relationship between rainfall and runoff a physics guided long short term memory lstm network shortly named phy lstm is then formulated phy lstm network is trained on 531 basins of the catchment attributes and meteorology for large sample studies camels dataset indicating that the performance is significantly improved compared to conventional lstm specifically the mean nash sutcliffe efficiency nse improves from 0 52 to 0 61 from the daily simulations during the testing period in local models it is demonstrated that synthetic samples can effectively improve the simulation of flood peaks and reduce the number of negative streamflow and strong monotonicity is still maintained even if a slight disturbance is involved in the training dataset the proposed phy lstm shows that physical mechanisms are very useful to improve efficiencies of the data driven rainfall runoff model keywords deep learning lstm model rainfall runoff model physical consistency synthetic samples 1 introduction the rainfall runoff model has always been one of key researches in hydrology which provides an important support for water resources guo et al 2018 li et al 2020 tajiki et al 2020 xie et al 2020a especially the prediction of flood gao et al 2019 hostache et al 2018 zhang et al 2018 and drought disasters kang and sridhar 2017 pan et al 2020 the conventional rainfall runoff model estimates streamflow based on hydrophysical processes chorley 2019 xie et al 2020b these sub processes are driven by physical mechanisms in a nonlinear manner including evapotranspiration interception infiltration soil moisture and groundwater exchange as well as the impact of water conservancy projects and other human activities sophocleous 2002 however the physical processes are so complex in hydrological models that it is difficult to discover the information from the available inputs deep learning has successfully overcome the once intractable problems driven by the increasingly powerful performance of computers and the availability of larger datasets xu et al 2021 especially in computer vision nixon and aguado 2019 weiss et al 2020 and natural language processing chowdhary 2020 shen et al 2020 young et al 2018 for example moghaddam et al 2021 investigated the ability of diffuse structures in deep learning to infer effective hydraulic conductivity ehsani et al 2021a used radar information by machine learning and found that the advanced very high resolution radiometer avhrr product can contribute to precipitation estimates at high latitudes they further predicted dynamical spatiotemporal precipitation by using recurrent nowcasting net rnc and convolutional nowcasting net cnc architecture ehsani et al 2021b simulations based on data driven models have become a new solution for rainfall runoff models shen 2018 tikhamarine et al 2020 yang et al 2019 with the development of deep learning recent advances have been widely used in practice such as a recurrent neural network rnn and its variant long short term memory lstm network which achieved enhancements to predict runoff from meteorological observations compared to the conventional physics based models feng et al 2020 hu et al 2018 for example kratzert et al 2018 tested the lstm model in the catchments of the freely available catchment attributes and meteorology for large sample studies camels dataset compared to the existing hydrological models safari et al 2020 implemented the regression in the reproducing kernel hilbert space rrkhs which is highly flexible to provide better forecasts as compared with other alternatives researchers also focused on the improvements for the standard lstm architecture e g entity aware lstm kratzert et al 2019 and sequence to sequence modeling xiang et al 2020 kao et al 2020 proposed long short term memory based encoder decoder lstm ed model for multi step ahead flood forecasts and increased the interpretability of the model however the lack of physical mechanism becomes a major limitation of deep learning which relies on the available labeled observations since most deep learning models can only capture the correlation between variables they do not understand the causal relationships karpatne et al 2017a described that data driven and physical based models represent the two extremes of knowledge discovery physical based models are well suited to represent processes for which are conceptually well understood on the other hand conventional data driven models rely on the information contained in the data specifically a deep learning model can fit the observed data well but the prediction may not be physically consistent and then even a slight disturbance can lead to large changes liu et al 2017 reichstein et al 2019 therefore physics guided deep learning models are possible solutions to the problem at hand it would be of special interest to explore the continuum between deep learning models and physical mechanisms where both physic and data are used in a synergistic manner recently there has been an increasing interest in the achievement of physical consistency by training models about the rules of physical processes in water resources which aims to improve the performance of deep learning models in realizing theoretical discovery karpatne et al 2017a one of the methods was the output of a physically hydrological model used as another input in the neural network model along with the drivers konapala et al 2020 yang et al 2020 for example yang et al 2020 developed an improved model in data limited basins by combining artificial neural networks with synthetic runoff data in a distributed hydrological model another hybrid modeling strategy was used for correcting mismatch where physical knowledge was implanted into the deep learning model farfán et al 2020 jiang et al 2020 developed a hydrology aware deep learning model by a p rnn layer wrapped with physically meaningful parameters in the exp hydro model additionally some studies used the physical constraints as loss terms in the artificial neural network which has been successfully applied in the prediction of the lake water temperature and the subsurface flow read et al 2019 wang et al 2019 the hybrid modeling framework was used to predict the lake water temperature at different depths by integrating energy balance constraints karpatne et al 2017b read et al 2019 physical mechanisms were also used to train the deep learning model to predict groundwater wang et al 2019 where the neural network was guided by the basic theory such as control equations boundary conditions other physical constraints engineering control and expert experience consequently it has become an essential question that how to develop a quantitative understanding of the theoretical process to achieve physical consistency in a hydrological model increasingly dominated by deep learning nearing et al 2020 however to the best of our knowledge there is little attention paid to the extreme events and monotonic relationships of a deep learning network for rainfall runoff simulation three physical mechanisms are therefore considered to constrain the deep learning network from high flow low flow and monotonic properties which is the extreme events and internal relationships that are rare in historical observations but are obvious based on physical mechanisms specifically we address the following objectives 1 how to educate a deep learning network the extreme events of a heavy rainstorm 2 how to educate a deep learning network the extreme events of long duration rainless 3 how to improve the simulation by considering the monotonic relationship between rainfall and runoff the remainder of this paper is organized as follows details on the chosen catchments are described in section 2 section 3 describes the methodology for the data driven model based on physical mechanisms followed by results and discussion in section 4 lastly conclusions are drawn in section 5 2 data the basins used in this study were obtained from the camels dataset in the continental united states which was an international cooperation project for hydrologic and atmospheric models addor et al 2017 newman et al 2015 the dataset which consisted of the daily meteorological forcing inputs the catchment attributes and streamflow observations was available for the comparative study of large samples the camels contained meteorological inputs of four levels including 18 hydrologic units 671 basins more detailed hydrologic response unit hru regions and different elevation bands the camels basins range in size between 4 and 25000 km2 and they have relatively low anthropogenic impacts in this study the selection of 531 basins was selected from the camels dataset which was the same as newman et al 2017 these basins were selected out of the full set based on the following criteria 1 areas of the basins were smaller than 2000 km2 2 there was a discrepancy less than 10 between different methods of calculating basin area the models were trained with an updated version of the maurer forcing data kratzert et al 2019 maurer et al 2002 the daily meteorological input data were available including precipitation maximum temperature minimum temperature average short wave radiation and vapor pressure the streamflow at the outlet was measurements from the usgs gauging stations additionally as table 1 shows the 27 catchment attributes were concatenated as static inputs to the meteorological forcings at each time step data division was the same as previous studies kratzert et al 2019 for a fair comparison the training dataset lasted from 1 october 1999 through 30 september 2008 and the testing dataset lasted from 1 october 1989 through 30 september 1999 data normalization is generally performed during the data preprocessing step in this study min max normalization is used as the rescaling method 3 methodology fig 1 provides an overview of the proposed physics guided deep learning network which develops the methodology as follows 1 three physical mechanisms were used to increase the physical interpretability of the deep learning networks by adding synthetic samples section 3 1 2 the physical constraints were implemented into deep learning networks of local and regional scales by the exterior terms imposed on the loss function section 3 2 3 simulation accuracy and physical consistency were evaluated by using varied statistical criteria section 3 3 3 1 physical mechanisms for rainfall runoff model 3 1 1 extreme events of the long duration heavy rainstorm to establish physical mechanisms for rainfall runoff modeling the law of conservation of water is used the water balance equation controls the hydrological cycle by describing the flow into and out of the system the runoff yield from a given rainstorm during the time t can be calculated as follows 1 q t p t e t δ s t where the amount of water that a watershed receives is the precipitation pt mm and the amount of water consumption has three parts evapotranspiration et mm an increase in soil moisture content δ s t mm and the runoff q t mm the soil moisture increases from the initial soil water content s 0 to the soil water content s t at the end of rainfall therefore it can be described as follows 2 q t p t e t p t a s p t p s t s m where p are the long duration heavy rainstorm and the soil wetting reaches its maximum saturated state s m the runoff is equal to the heavy rainfall which is much greater than the ignored evapotranspiration when soil moisture has been saturated however the probability of heavy rainfall occurrence is very low in the historical data which leads to a large error in the simulation of the peak flow when using deep learning networks to solve this problem synthetic samples also called artificial samples are constructed to improve learning performance synthetic samples different from the actual samples can provide special information about the physical events and relationships the data pairs for the synthetic samples are the rainfall and the runoff determined by physical mechanisms to train the deep learning model to deal with the extreme events of the long duration heavy rainstorm the made up year of the synthetic samples is added into the actual observation series combinations of synthetic samples are considered with varied rainfall intensities and varied durations the labels are its streamflow when all rainfall yields runoff therefore the function for heavy storms is used by the following equations 3 q t f x t τ f x t τ x t τ 1 x t 1 x t 4 f p t i τ p t i 0 t t f 5 mse 1 nt u n t 1 nt u i 1 n f p t i τ p t i 2 where q t donates the simulated streamflow f is the simulation function of the deep learning method x t is the normalized inputs τ is the input sequence length and models are run in the sequence to one mode so that to simulate a daily discharge required meteorological forcings from τ preceding days p t i is the rainstorm events of different intensity t f is the time when soil water is saturated mse is the mean square error mse for heavy rainstorm events nt u is the duration of heavy rainstorm samples and n is the number of varied rainstorm intensities 3 1 2 extreme events of the long duration rainless the streamflow during long duration rainless events determines the lower boundary condition for rainfall runoff modeling there is a relatively rapid hydrograph rise to a peak which usually occurs at or soon after the input ceases followed by a hydrograph recession a recession period lasts until streamflow begins to increase again due to subsequent rainfall if the rainless continues long enough streamflow only includes baseflow cheng et al 2020 therefore the lower boundary condition of the rainfall runoff model is that the base flow will be exhausted and the basin will not yield runoff after the extreme long duration rainless events the flow is never negative in the physical world there are often negative values when using deep learning networks which usually can be solved by setting the linear activation function of the output layer to rectified linear unit relu this physics guided lstm model attempts to track the water balance of the baseflow in the recession period however the magnitude of baseflow varies in each different watershed and it is difficult to be determined as a constant therefore when an extreme hypothetical case of prolonged absence of rainfall is considered the baseflow is completely depleted to zero therefore to train the physics guided deep learning model to prevent negative values synthetic samples of long duration rainless events are added to the training dataset the soil moisture is exhausted and the corresponding runoff is equal to zero when the basin experiences a long duration rainless situation the synthetic samples are long duration rainless and its streamflow when the soil moisture dries up the function for rainless events is used by the following equations 6 f p t 0 τ 0 a s p t 0 0 t 7 mse 0 1 nt l t 1 nt l f p t 0 τ 2 where p t 0 is the precipitation of long duration rainless events i e 0 mm mse 0 is the mean square error in response to the rainless events and nt l is the sample length of long duration rainless events 3 1 3 monotonic relationship between rainfall and runoff the internal relationship between rainfall and runoff is considered to ensure that the physical laws are upheld in the runoff simulation of a deep learning model the rainfall runoff relationship for any rainstorm depends on the dynamic interaction between rain intensity evapotranspiration infiltration and storage the relationship between rainfall and runoff should be presented monotonously i e the runoff should be larger if there was a small increase in the rainfall at the current time step however the simulation cannot guarantee the monotonicity of simulation by conventional deep learning models which is physically inconsistent with the water balance equation prediction errors can be very large even if a slight disturbance to the training dataset in terms of the model without physical consistency essentially this is because the deep learning model ignores the complex physical processes and underlying surface conditions when it is trained as a black box for fitting the highly nonlinear system it can only capture the correlation between variables without physical mechanisms therefore it cannot understand the cause and effect furthermore the function of the monotonic relationship between rainfall and runoff is as follows 8 f p t i δ p i τ f p t i τ 0 9 mse mcp 1 nt mcp n mcp t 1 nt mcp i 1 n mcp r e l u f p t i τ f p t i δ p i τ 2 where δ p i is a small increase in rainfall mse mcp is the mean square error for the monotonic relationship nt mcp is the sample length of the disturbed rainfall n mcp is the number of different levels of the increase from small to large and relu is the response function excluding the monotonic term and retaining the nonmonotonic term besides the relationship between evapotranspiration and runoff is also monotonic as follows 10 f e t i δ p i τ f e t i τ 0 11 mse mce 1 nt mce n mce t 1 nt mce i 1 n mce r e l u f e t i δ e i τ f e t i τ 2 where δ e i is a small increase of evapotranspiration mse mce is the mean square error for the monotonic relationship of the evapotranspiration nt mce is the sample length of the disturbed evapotranspiration and n mce is the number of different levels of the increase 3 2 deep learning network based on physical consistency sufficient sample sizes are very important to construct effective deep learning models but heavy rainstorms and long duration rainless samples are rare in the historical data to overcome this challenge synthetic samples that follow three physical mechanisms are used as the additional input to train the model in this study physical consistency is considered to the deep learning model by using domain oriented constraints inspired by three physical understandings all model configurations are trained using the following mse as loss function the exterior loss function of the hydrological physical process is added to the conventional objective of the model by the following equations 12 loss λ data m s e data λ mse λ 0 mse 0 λ mcp mse mcp λ mce mse mce 13 mse data 1 nt t 1 nt q t q t 2 where loss is the loss function λ data is the weight coefficient for simulated runoff mse data is the mean square error of simulated runoff by deep learning method λ is the weight coefficient for heavy rainstorm events λ 0 is the weight coefficient in response to long duration rainless events mse mcp and mse mce are the loss functions for the monotonicity including rainfall and evapotranspiration λ mcp and λ mce are the corresponding weight coefficients for the monotonicity and nt is the length of time series the final configuration is chosen by taking the weights that resulted in the highest mean nse as shown in table 2 the initial proportion of physical mechanisms have the same value i e the four constraints are treated equally the final weights are set to 0 6 0 1 0 1 0 1 0 1 for the five mses in this study it should be noted that the final weights are the result of the optimal nse by assessing the relative importance of different weights lstm networks are designed to avoid the weakness of the conventional rnn to learn long duration dependencies cheng et al 2016 hochreiter and schmidhuber 1997 the deep learning networks are developed based on open source software the programming language of choice is python 3 7 pytorch framework and nvidia tesla v100 16 gb gpus are used for training 3 2 1 experimental 1 local models lstm networks are applied independently to each watershed in local models hyperparameters and sample parameters are needed to be determined in establishing the proposed physics guided lstm networks the hyperparameters will influence the structure and training of lstm networks for all local lstms and phy lstms the same architecture is used different settings and models are trained and tested where the optimal hyperparameter is found in local models the number of hidden layers is set to 2 the hidden size is set to 40 and the number of the batch is 1 10 of the number of samples the dropout rate is set at 0 4 and the training epochs are 200 the input sequence length τ is set to 20 preceding days besides the parameter of samples will influence the implementation of physical mechanisms five different intensity settings and 10 different duration settings are added for a total of 50 different synthetic samples where the total mse is the mean of the 50 scenarios the long duration heavy rainstorm events p have different rainstorm intensities of 50 mm 75 mm 100 mm 125 mm and 150 mm respectively the duration of the made up period of the synthetic samples is 10 100 days in each batch of training samples which are equally divided every 10 days 3 2 2 experimental 2 a regional model the regional model extends the simulation ability across the similarity behaving catchments in large regions hestness et al 2017 kratzert et al 2018 huge training data of 531 basins in the camels are used to learn more general rainfall runoff relationships only in an lstm network which is the potential for predictions in the ungauged basins the same architecture is used for all regional lstms and phy lstms the structure of the regional model is different from that of the local model since the scale of the input data to the model differs significantly the hyperparameters optimization can refer to the previous research in kratzert et al 2019 in the regional model the number of hidden layers is set to 1 the number of the batch is 1 12 of the number of samples and the training epochs are 30 the lstms had 256 memory cells and a single fully connected layer with a dropout rate of 0 4 the lstms were run in sequence to value mode with the input sequence length τ is set to 270 preceding days 3 3 model evaluations 3 3 1 simulation accuracy four widely used statistical criteria are used to quantify the performance of the model simulations in this study 1 nash sutcliffe efficiency nse nash and sutcliffe 1970 14 n s e 1 t 1 nt q obs t q sim t 2 t 1 nt q obs t q obs 2 where q obs t is the observed variable q sim t is the computed variable nt is the total number of observations and q obs is the overall mean daily observed variable 2 pearson correlation coefficient r 15 r t 1 nt q obs t q obs q sim t q sim t 1 nt q obs t q obs 2 t 1 nt q sim t q sim 2 3 bias gupta et al 1999 16 b i a s t 1 nt q obs t q sim t t 1 nt q obs t 100 4 the kling gupta efficiency kge gupta et al 2009 is a model evaluation criterion that can be decomposed into the contribution of mean variance and correlation on model performance kge is calculated as follows 17 k g e 1 r 1 2 μ sim μ obs 1 2 σ sim σ obs 1 2 where μ and σ are the mean and standard deviation of the variables kge value ranges from to 1 with a value closer to 1 indicating a better simulation performance 3 3 2 physical consistency three criteria are selected to pay attention to the model performance of high discharge and low discharge according to the flow duration curve fdc yilmaz et al 2008 5 bias in fdc high segment volume f h v 18 f h v h 1 h q sim ξ q obs ξ h 1 h q obs ξ 100 ξ 1 2 h where h is the number of flood events with a frequency of less than 0 02 and q ξ is the discharge of flood frequency ξ 6 bias in fdc midsegment slope f m s 19 f m s l o g q sim 0 2 l o g q sim 0 7 l o g q obs 0 2 l o g q obs 0 7 l o g q obs 0 2 l o g q obs 0 7 100 7 bias in fdc low segment volume f l v 20 f l v 1 l 1 l l o g q sim l l o g q sim l l 1 l l o g q obs l l o g q obs l l 1 l l o g q obs l l o g q obs l 100 l 1 2 l 21 q l m i n q t where l is the number of low flows with a frequency higher than 0 7 the physical consistency becomes better with the value of three evaluation approaches 0 4 results and discussion the proposed network considering physical mechanisms was implemented into the deep learning model in local and the regional scales respectively first we explained why the input of synthetic samples was used to solve the problem of physical consistency in local models section 4 1 second we further explained how extreme events of the long duration heavy rainstorm improved the simulation of high flow section 4 2 after that the prevention of the negative values by extreme events of the long duration rainless was clarified section 4 3 and then the monotonicity of the simulation was verified section 4 4 finally we analyzed the reasons for the model performance in the regional model section 4 5 4 1 comparison of model performance of physics guided deep learning networks in local models a set of existing lstm models and some hydrological models by several previous studies are collected over the camels which were calibrated in individual basins or the continental united states table 3 shows the results of the models in this study compared with the results of the other models used by the researchers in the camels the local lstm models were trained as the base model for comparison from all 531 basins using inputs of the meteorological data and static catchment attributes the results of the base model were the same as the one in kratzert et al 2019 which reported a mean nse of 0 52 in local models furthermore the phy lstm network had a higher simulation accuracy in the testing set the average nse was 0 61 the median was 0 66 which was 0 08 and 0 09 higher than the conventional local lstm models the improvement of the phy lstm network lies in the input samples as a novel input augment method the synthetic sample are added to improve the phy lstm network considering the physical mechanisms the results indicated that the input of synthetic samples can be helpful to provide more information on the definite boundaries rarely considered by the actual observations as shown in fig 2 the conventional lstm and the phy lstm network were compared with the nse distribution in the camels during the testing period the nse of the conventional model in 26 basins was higher than 80 112 basins higher than 70 and 237 basins higher than 60 the results of the phy lstm network simulation indicated that the nse of 52 basins was higher than 80 that of 190 basins was higher than 70 and that of 343 basins was higher than 60 to evaluate the effectiveness of the proposed approaches the simulation results of the conventional data driven lstm model and the physics based xinanjiang model are compared in the same basins fig 3 shows the cumulative probability distribution of the six metrics of phy lstm networks in all studied basins there was a significant difference between lstms trained with vs without physical mechanisms the mean r improved from 0 78 to 0 89 while simultaneously reducing the bias then three criteria are compared according to the flood frequency curve flv and fhv improved but there was no statistically significant difference for fms overall the results showed that the proposed phy lstm network can simulate the hydrological processes effectively 4 2 high flow simulation by deep learning about extreme events of the long duration heavy rainstorm to overcome the problem of inadequate mechanisms for extreme events synthetic rainstorm samples assisted in training physics guided deep learning models as shown in fig 4 a the mse of the heavy rainstorm was reduced using the deep learning model based on a physical mechanism compared with the conventional model the mse of the heavy rainstorm constraints decreased from a mean of 0 47 to a mean of 0 15 the performance of the conventional lstm model in high flow simulation was poor because of the rarity of rainstorm samples or the absence of heavy rainstorm events in the training period the simulated peak flow was often unsatisfactory especially in the case of heavy rainstorm events with low frequency therefore the rainstorm samples were added to the historical observations for a long time a typical basin i e pitman river ca basin number 11237500 is selected as an example as shown in fig 5 the flood peak flow simulated by the model was greatly improved compared with the conventional lstm simulation when adding a 50 mm long duration rainstorm and 100 mm long duration rainstorm respectively in the selected basin at this moment all the rainfall should generate runoff when the soil moisture was saturated after a long period of the rainstorm the results demonstrated that the synthetic samples of a heavy rainstorm can effectively improve flood peak simulation however it was related to the intensity of the rainstorm the rainstorm of 100 mm was the better intensity of the rainstorm flood in the selected basin the results confirmed that the intensity of the samples was associated with the improvement 4 3 low flow simulation by deep learning about extreme events of the long duration rainless to improve the ability of deep learning networks to simulate low flows synthetic samples of long duration rainless events were used as shown in fig 4b the mse of the long duration rainless constraint decreased from mean 0 50 to mean 0 04 if there was no rain for a long time the soil moisture would be exhausted and runoff would not happen again however as shown in fig 6 a the conventional simulation often appeared negative flow which indicated that the existing samples cannot train the model in the part of low flow the usual experience was to change the negative value to 0 directly by the relu method in this study the conditions of synthetic rainless samples can be simulated confidently to constrain the conventional model in fig 6 b the occurrence of negative flow was greatly prevented with the support of constraints of long duration rainless events the addition of synthetic samples was helpful to improve physical consistency which provided proof for the establishment of the data driven model using theoretical constraints 4 4 extending the ability of the monotonic rainfall runoff relationship the monotonic relationship between rain or evaporation and runoff was used to train the phy lstm network the monotonicity rule says that hydrological simulation should have monotonically output with monotonical inputs that is the runoff would increase even if a small increase in the rainfall as shown in fig 7 a a small disturbance is increased in the rainfall to the testing set of the lstm model and the results showed that there was a huge nonmonotonicity in most basins the results of most basins showed that the conventional lstm model has high mse the mean and median mse mcp of the 531 basins showed that the monotonic performance of the conventional deep learning network was gradually getting worse during the learning epochs the conventional data driven model mainly depended on the information contained in the data which was applicable in areas equipped with a large supply of representative data samples as shown in fig 4c the mse of the monotonicity decreased from mean 0 36 to mean 0 11 for a small increase in the historical rainfall samples the new simulation results should increase monotonously compared with the previous simulations fig 7b illustrated the decreased mse by the phy lstm network where the monotonic relationship educated the deep learning models it provided the largest set of significant clusters of the approach and the possibility of a deep learning model to extend the ability of monotonicity phy lstm models can be well suited to represent understandable processes using known scientific principles 4 5 model performance of physics guided deep learning networks in the regional model as shown in table 3 in the regional model the phy lstm model improved the simulation accuracy without catchment attributes added to the input data when the mean nse value increased from 0 39 to 0 49 however another important finding was that the phy lstm was not improved with catchment attributes in the regional model table 4 shows all evaluations for the local and regional models to find out why physical constraints were effective for local models but had little improvement in the regional model a set of experiments were performed to compare the simulation accuracy of lstm and phy lstm with the increasing number of basins as shown in fig 8 the deep learning network was less effective when the number of basins was small or even in local models and samples of hydro physical processes were used as effective information to improve the simulation accuracy the accuracy of the deep learning network improved as the increasing number of basins when more basins can provide more information to each other the diminishing role played by physical constraints suggested that the regional deep learning model was not entirely non physical a possible explanation for these results may be extreme weather events that did not occur frequently in one basin but other basins of the region the model can mine the rainfall runoff relationship among basins with similar characteristics through the deep learning of the regional lstm model sufficient data not only improved the accuracy of the model but also contributed to the physical consistency of the model the further comparison indicates better fhv and flv for the regional model however fig 9 shows the monotonic performance of the change of the discharge with an increase of 0 1 mm rainfall disturbance and the results demonstrated that the nonmonotonic rainfall runoff response still existed even in the regional model together these results provide important insights into the monotonic relationship which should be considered by physics guided deep learning network although in the regional model 5 conclusions in this paper a deep learning model based on physical mechanisms was constructed to simulate the rainfall runoff process over the camels in the united states the main objective of the current study was to investigate the effects of extreme events and the monotonic relationship of a deep learning network for rainfall runoff simulation considering the physical mechanisms synthetic samples were used as extra inputs for deep learning and the exterior loss functions of the hydrological physical process were added to the conventional optimization objective of the model conclusions derived are as follows 1 it was indicated that synthetic samples provided more information on the hydrological theory that is not embedded in the actual observations the mean nse increased from 0 52 for models without physical consistency to 0 61 for local models based on physical mechanisms during the testing period 2 extreme events were effective for establishing deep learning models with physical consistency adding synthetic samples can improve the simulation of flood peaks with the mse of the heavy rainstorm constraints decreased from mean 0 47 to mean 0 15 besides synthetic samples can reduce the occurrence of negative streamflow with the mse of long duration rainless constraints decreased from mean 0 50 to mean 0 04 this approach is useful for hydrological simulation especially for the prediction of flood peaks and the prevention of negative values in the simulation 3 the relationship between rainfall and runoff in this study can train deep learning networks both in local and regional models which can significantly extend the ability of the monotonicity the deep learning network based on constraints of physical consistency enables the system to train the model about available physical knowledge further research should focus on validating the effects of more constraints of physical consistency and expanding the use of the physics guided deep learning model in the field of water resources credit authorship contribution statement kang xie conceptualization methodology writing original draft pan liu conceptualization supervision writing review editing jianyun zhang supervision writing review editing dongyang han guoqing wang writing review editing chaopeng shen methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china 51861125102 the joint funds of the national natural science foundation of china u1865201 and innovation team in key field of the ministry of science and technology 2018ra4014 the authors appreciate the help from the supercomputing center of wuhan university for providing the necessary guides to perform the numerical calculations of this study on the supercomputing system 
3916,hydrological processes in a watershed consist of multiple sub processes such as plant growth evapotranspiration water yield and soil water balance that have complex interactions the common practice of calibrating hydrological models against only a single variable e g streamflow can lead to parameter uncertainty also known as equifinality resulting in significant uncertainties in the representation and simulation of sub processes as multi variable calibration can be a potential solution to this issue we tested the integration of spatially and temporally gridded remotely sensed evapotranspiration rs et data with the soil and water assessment tool swat hydrological model this approach was intended to reduce equifinality by enhancing related hydrological sub processes in both space and time rather than improving the evaluation metrics at the streamflow outlet we further introduced the principle of repeated measure design in the calibration process where the swat was calibrated under two different schemes scheme1 using only streamflow data and scheme2 using both rs et and streamflow data the model s performance was evaluated using the concept of stability at multiple spatial scales basin outlet sub basins and hydrological response units and aspects different model outputs and most sensitive calibrated parameters the significance of the difference between the stabilities produced by the two schemes was estimated using the mann whitney u test testing this approach in meichuan basin china showed that scheme2 substantially reduced equifinality for calibrated parameters and model outputs compared to scheme1 in addition the model solutions and outputs for scheme2 were significantly different from scheme1 our results demonstrate the added value of using increasingly available open access rs et data for improving hydrological model calibration keywords equifinality evapotranspiration modis swat repeated measure design stability manning whitney u test 1 introduction the hydrological responses of watersheds can be represented by spatiotemporally variable vertical and horizontal fluxes using hydrological modeling with varying degrees of complexity the outcomes of such models can be applied to policy planning and decision making concerning the soil water balance in diverse environmental conditions duan et al 2019 tuo et al 2016 however hydrological models can suffer from equifinality the probability of achieving similar but not necessarily identical hydrological outcomes finality through different model schemes and particular sets of parameters i e equal pathways beven 2006 pfannerstill et al 2017 this issue can be derived from model structure and parameters observational data used for forcing and calibration initial conditions and boundaries liu and gupta 2007 wagener and gupta 2005 equifinality has previously been studied using other terms such as ambiguity identifiability empirical equivalence non uniqueness under determination or indeterminacy and system convergence oreskes et al 1994 streamflow represents the availability of actual water resources in a basin and thus simulated streamflow is often the most critical model output hydrological models have parameters that cannot be readily determined making calibration an essential step in hydrological modeling in practice this only considers streamflow and is implemented by adjusting parameter values to match simulated streamflow as closely as possible to measured streamflow immerzeel and droogers 2008 however streamflow time series information may not sufficiently capture the evolution of vertical fluxes at different spatiotemporal scales within the watershed birkel et al 2014 li et al 2018 additionally streamflow combines the contributions of different upstream hydrological components such that calibration based on streamflow alone cannot guarantee a reasonable representation of multiple hydrologic components especially those from the unsaturated zone leading to a non unique solution in inverse modeling beven 2006 hanzer et al 2016 previous studies have stressed that great caution should be used when simulating other water balance components with models calibrated solely by streamflow at the basin outlet becker et al 2019 herman et al 2018 immerzeel and droogers 2008 tobin and bennett 2017 in addition adjusting numerous parameters with measured streamflow from a limited number of stations leads to equifinality especially for parameters that are not directly related to streamflow beven and freer 2001 however no previous research has shown that observations from many gauges can lead to more accurate estimations of subsurface fluxes with reduced equifinality of related parameters wanders et al 2014 these limitations derived from streamflow only calibrations can result in unreasonable simulations of other hydrologic components ultimately reducing the model performance rajib et al 2018b therefore including additional hydrological components during calibration could allow models to reflect better all environmental processes crow et al 2003 pfannerstill et al 2017 rajib et al 2016 in addition the interdependency of various hydrological fluxes the spatiotemporal heterogeneity of hydrological processes and process based variables should all be considered during calibration to capture better the relevant interconnections among various water balance components arnold et al 2012 in particular evapotranspiration et should be considered an essential hydrological component during calibration as this is generally second only to precipitation in terms of the magnitude as a vertical flux in the hydrologic cycle et is composed of evaporation from the soil canopy interception and transpiration from vegetation neitsch et al 2011 yuan et al 2021 in addition 60 of moisture input is returned to the atmosphere via et at the expense of half the solar energy absorbed by the earth s surface trenberth et al 2007 however physical phenomena in the soil vegetationatmosphere continuum are among the most complicated hydrologic components to be modeled kim and kaluarachchi 2017 et is also characterized by large spatiotemporal variability direct or in situ measurements of et with flux towers based on eddy covariance methods are sparse and represent a limited footprint making it challenging to obtain spatially resolved et data at the basin or regional scales liou and kar 2014 alternatively remote sensing rs data can be utilized to estimate net energy and et chen and liu 2020 jiao et al 2021 smith et al 2019 open access to various sources of spatiotemporally widespread data means that remotely sensed evapotranspiration rs et data have been increasingly used for multi scale multi objective calibration of hydrologic models and prediction in ungauged basins at sub basin and hydrological response unit hru scales becker et al 2019 huang et al 2020 rajib et al 2018a zhang et al 2020 the soil and water assessment tool swat is a comprehensive time continuous semi distributed process based model supported by extensive research available at https www card iastate edu swat articles that is applicable in many areas worldwide abbaspour et al 2015 huang et al 2020 like other hydrological models most existing swat studies have used only streamflow data for model calibration parajuli et al 2013 but rs data are being increasingly applied as well for example rs data have been used to quantify total terrestrial water qiao et al 2013 yeo et al 2019 soil moisture azimi et al 2020 tobin and bennett 2020 groundwater recharge fallatah et al 2019 milewski et al 2020 snow water equivalent grusson et al 2015 tuo et al 2018 leaf area index lai ma et al 2019 strauch and volk 2013 and et rajib et al 2018b tobin and bennett 2019 although the possibility of applying rs et data to hydrological modeling especially in ungauged basins has been explored no specific methods have yet been successfully demonstrated for multi variable calibration of ungauged watersheds to improve et simulation and hydrological modeling tobin and bennett 2017 previous studies have been concerned only with the calibration of surface subsurface and river routing parameters immerzeel and droogers 2008 rientjes et al 2013 tobin and bennett 2017 and are limited in their ability to represent a combination of surface sub surface runoff and biophysical parameters yang and zhang 2016 zhu et al 2015 as a solution for reducing equifinality existing studies have measured reductions in uncertainty produced in the model using only metrics for simulated streamflow and et they have not considered model results at multiple spatial scales basin outlet subbasin or hru or multiple aspects sub processes of hydrological cycles or model solutions such evaluation methods which only consider the average of the simulated values for the period lead to equifinality as they are limited to exploring the uncertainty associated with sub processes in the hydrological cycle herman et al 2018 immerzeel and droogers 2008 parajuli et al 2018 rajib et al 2018b tobin and bennett 2017 in this study we aimed to address the aforementioned limitations and evaluate the advantages of using rs et in the multi variable calibration of swat models for the reduction of equifinality we hypothesized that the uncertainty problem associated with swat could be improved by enhancing sub processes embedded in the swat hydrological cycle such as plant growth et water yield and soil water balance by applying rs et we demonstrated the significance of this approach using a repeated measure design experiment in which calibration was performed under both single variable streamflow data only and multi variable both rs et and streamflow data schemes the reduced uncertainties in the model and its outputs produced by the experiment were difficult to quantify owing to the complex nature of hydrological processes and a lack of ground truth observations we therefore introduced the concept of stability to examine reduced potential uncertainties for each sub process and related parameters and outputs comparing two successive simulations in each scheme across spatial units e g hrus or sub basins we focused on improving these sub processes for specific time series and spatial units instead of merely improving a comprehensive evaluation of statistical coefficients at basin outlets 2 theoretical background et calculation in swat et is defined as water removal by a plant s transpiration mechanism and evaporation from the canopy and soil and surpasses runoff in most river basins neitsch et al 2011 its primary role in the hydrological cycle can be determined through accurate estimation of et and integration of et into the calibration process to characterize better the hydrological cycle arnold et al 2012 herman et al 2018 swat determines the actual evapotranspiration aet from potential evapotranspiration pet by one of three built in calculation methods neitsch et al 2011 penman monteith allen et al 1989 monteith 1965 priestley taylor priestley and taylor 1972 and hargreaves hargreaves and samani 1985 we chose the penman monteith method to estimate pet which is distributed spatially across hrus and temporally on daily time steps because the study area has a humid subtropical climate with a forest as the dominant land cover and this method has been successfully applied in such regions arakaki et al 2014 jung et al 2016 furthermore it is compatible with the modis et calculation algorithm which also uses this method he et al 2019 avoiding the problem that differing et calculation methods can result in discrepancies between simulated and observed et becker et al 2019 this method is the only standard suggested by the food and agriculture organization of the united nations it has been globally validated as the most rigorous and physically realistic approach to quantifying et r g allen et al 1998 the penman monteith equation is written as 1 λ e δ h net g ρ air c p e z o e z r a δ γ 1 r c r a where λe is the latent heat flux density mj m 2 d 1 e is the depth rate evaporation mm d 1 δ is the slope of the saturation vapor pressure temperature curve de dt kpa c 1 g is the heat flux density to the ground mj m 2 d 1 ρair is the air density kg m 3 cp is the specific heat at constant pressure mj kg 1 c 1 ez o is saturation vapor pressure kpa ez is actual vapor pressure kpa γ is the psychrometric constant kpa c 1 and ra is aerodynamic resistance the important terms in eq 1 which are related to the plant and soil water balance are described as follows a net radiation hnet can be calculated as 2 h net 1 α h day h b where hday is the short wave solar radiation reaching the ground hb is the net incoming long wave radiation and α is the albedo when no plants grow in an hru the value of α α soil otherwise the value of α is given by 3 α α plant 1 c o v sol α soil c o v sol where αplant is the plant albedo default value of 0 23 and covsol is the soil cover index calculated as 4 co v sol exp 5 0 10 5 c v where cv is the aboveground biomass and residue b canopy resistance rc jensen et al 1990 can be calculated as 5 r c r l 0 5 l a i for non clipped grass and alfalfa 3 cm in height lai can be calculated as 6 lai 1 5 ln h c 1 4 where rl is the minimum effective stomatal resistance of a single leaf hc is the canopy height cm and lai is the leaf area index of the canopy the swat uses alfalfa at the height of 40 cm with a minimum leaf resistance of 100 s m 1 when solving the penman monteith equation for the reference crop once the pet is estimated using eq 1 swat calculates the actual evaporation from the intercept storage rainwater trapped in the plant canopy c evaporation of intercepted rainfall swat considers the removal of the readily available amount of free water from canopy storage when calculating actual evaporation it estimates the maximum amount of water in canopy storage by defining it as a function of lai neitsch et al 2011 7 ca n day c a n mx lai la i mx where canday is the maximum amount of water that can be trapped in the canopy on a given day canmx is the maximum amount of water that can be trapped in the canopy when it is fully developed lai is the leaf area index for a given day and laimx is the maximum leaf area index for the plant d sublimation and soil evaporation are impacted by the degree of shading and are calculated as follows neitsch et al 2011 8 e s e o c o v sol where es is the maximum sublimation soil evaporation on a given day mm h2o e o is the pet adjusted for the evaporation of free water in the canopy mm h2o and covsol is the soil cover index swat computes the maximum amount of transpiration sublimation and soil evaporation following the approach given in ritchie 1972 aet is calculated as the sum of interception actual soil evaporation and actual plant transpiration neitsch et al 2011 the estimation of et in swat sums up spatially distributed statistics for sub processes such as precipitation plant growth and energy exchange and soil water balance thus rs et can act as spatially distributed ground truth data to some degree in addition to gauging streamflow data the inclusion of rs et in swat calibration can thus reduce uncertainty in surface subsurface runoff parameters and bio physical parameters for physical processes within the hydrological cycle of spatial units rajib et al 2018b 3 materials and methods 3 1 study area the meichuan basin 26 00 27 09 n and 116 36 116 39 e in jiangxi province southeastern china comprises a drainage area of 6384 km2 including an upstream tributary of the gan river which feeds into poyang lake and the yangtze river fig 1 the basin s elevation ranges from 137 to 1425 m average 358 m and it has a wet subtropical climate during the study period 2001 2014 the annual mean temperature was 17 c and the annual mean precipitation was 1628 mm forest dominates as the most common land use 40 63 followed by cropland 27 19 farming is prevalent for two seasonal crops in a year in which paddy cultivation dominates red ferralic cambisol and paddy soils cover most of the area 64 3 and 28 2 respectively 3 2 datasets and swat settings table 1 presents an overview of the data used in this study three hydrological gauges ningdu shicheng and fenkeng fig 1 provided observed streamflow data for the entire study period 2001 2014 daily observed streamflow and precipitation data were obtained from the chinese hydrological data yearbook we used a 30 m global digital elevation model gdem to execute automatic watershed delineation and extract topographic characteristics for the swat model land use data were obtained from the finer resolution observation and monitoring of global land cover from glc climate data daily maximum and minimum air temperature daily average solar radiation wind speed and relative humidity were obtained from the chinese meteorological data service center cmdc for six climate stations by integrating soil landscape relationships with geographic information systems gis using fuzzy logic we produced detailed soil data at 30 m spatial resolution from the original 1 500 000 scale soil maps using the soil land inference model zhu et al 2001 modis et mod16a2 level 4 version 6 data were used as an rs et for the study period at 500 m spatial resolution and 8 d temporal resolution this rs et product which has satisfactory r2 0 67 with flux et measured by qianyanzhou flux site nearby this area liu et al 2015 was scalable to a sub basin level with good accuracy and has been widely verified and used at regional and global scales cheng et al 2021 sriwongsitanon et al 2020 sun et al 2017 swat2016 revision 664 was used to model streamflow and et for the meichuan basin which was delineated into 17 sub basins and 453 hrus the latter is defined as the smallest spatial unit when modeling sub basins and are generated by a unique combination of land use soil type and slope this combination approach allowed for a high discretization of the entire basin thus the size of an hru depended on the homogeneity of the underlying soil and land use characteristics 2001 2002 was used as a warm up period to moderate the initial conditions and was omitted from further analysis 3 3 modeling experiment design to discover how the integration of rs et into a calibration process could alleviate the equifinality problem of the swat model in space we defined two calibration procedures that maintained the same sensitive parameters but differed in calibration data used fig 2 scheme1 single variable used only observed streamflow data and scheme2 multi variable used both streamflow and rs et data for each scheme model calibration produced various simulations or parameter solutions representing different scenarios for representing hydrological processes with individual evaluation metrics values the simulation with the highest evaluation score is usually chosen as the best model solution but in general it may only minorly surpass the succeeding simulations for a stable and acceptable calibration scheme it is no coincidence that a high degree of similarity in output variables among these top model solutions may be achieved because the scheme results in the robust representation of hydrological sub processes i e et surface runoff water yield and lai and vice versa the above model calibration procedure is the most common type of repeated measures design based around ensuring that two subjects schemes receive the same treatments to examine whether scheme2 can alleviate equifinality rather than scheme1 the performance of the simulations by two schemes were not only compared at three outlet points but also in seventeen sub basins in this study the term stability represents an adequate consistency of a data result relative to a reasonable alteration of the model design yu 2013 so we used stability to measure the similarity or difference between top performing simulations generated by a scheme the magnitude of the similarity or difference in the values of both outputs and related parameters for calibrated swat models in the scheme was calculated in spatial units here it was done based on the time series of model outputs in sub basin level in monthly step the lower the difference the higher is the stability of the scheme and vice versa the high stability of the scheme indicates that the possibility of inherent non uniqueness or equifinality in inverse modeling is reduced during the calibration procedure this can be illustrated through three criteria probability histograms box plots and mean and standard deviation std meanwhile the non parametric mann whitney u test was adopted to examine whether there is statistically significant difference in the stability by scheme1 as compared to scheme2 because the similarity presented a non normal population distribution even with a thick tail the significance of the difference indicates the role that was played by the input of rs et in the calibration procedure 3 4 transformation of gridded modis et data into irregular sub basins in swat the modis rs et mod16a2 level 4 version 6 an 8 day 500 m gridded dataset was used as observation data in the calibration procedure it has been made available since 2000 with good spatiotemporal resolution and quality assessment documentation records and has been suggested for eco hydrological studies mu et al 2013 tobin and bennett 2017 however the spatial and temporal scales of the modis grid 500 m and 8 day are different from the ones in swat cup calibration process irregular sub basin polygons and monthly time scale thus the area and time weighed aggregation method was adopted to convert modis et grid data to the monthly et for each sub basin variable for further model calibration the rs et was integrated into swat in two steps first the 8 day dataset was aggregated to a monthly et by time weighting cammalleri et al 2019 based on the number of days of each month and the julian date in the original metadata second a gridded monthly et was overlaid with the subbasin boundaries irregular polygon shapes fig 1 and the area weighted averaging method huang et al 2020 liu et al 2012 was applied to transform the regular gridded rs et into irregularly shaped sub basin polygons for hydrologic modeling 3 5 configuration of swat calibration after setting up the swat model and defining the experimental design the model was calibrated using the sequential uncertainty fitting algorithm sufi version 2 for two defined schemes in the swat cup platform abbaspour et al 2015 sufi 2 is an auto calibration and uncertainty analysis module that uses latin hypercube sampling to set the potential parameter combinations based on the given initial range by ensuring realistic physical coverage abbaspour et al 2004 for both schemes the calibration steps were chosen at monthly time steps our primary objective was to incorporate rs et data to enhance the consistency of the swat outputs spatially while the disaggregation of the available 8 day rs et to daily data would introduce extra uncertainty the number of years to skip was set from the warm up period 2001 2002 to adjust the initial conditions followed by a calibration period 2003 2010 and validation period 2011 2014 scheme1 used streamflow data observed at the three gauging stations shicheng ningdu and fenkeng while scheme2 used 17 time series from the modis rs et one for each sub basin and the three time series of streamflow data from the three gauging stations the choice of parameters was based on possible representations of the sub processes as described in section 2 previous research and sensitivity analyses becker et al 2019 rajib et al 2016 rajib et al 2018a tobin and bennett 2017 zhang et al 2020 we performed a global sensitivity analysis abbaspour et al 2015 and identified fifteen parameters related to surface sub surface runoff and biophysical processes as highly sensitive table 2 the initial range of parameters was defined following the swat documentation a total of five iterations in both schemes were run with 500 simulations in each iteration thus a total of 2500 simulations during the calibration during model calibration the range of each parameter was changed normally narrowed down after each iteration based on both the new parameters estimated by swat cup abbaspour et al 2004 and their realistic physical ranges duan et al 2019 further details regarding calibration procedures are provided in previous studies abbaspour et al 2015 tuo et al 2016 duan et al 2019 3 6 evaluation of swat model performance the widely used nash sutcliffe efficiency ens was chosen as the primary objective function for both schemes ens is commonly used with extensive information on reported values and is comparatively better than the available objective functions in the sufi 2 calibration procedure moriasi et al 2007 sao et al 2020 ens is a normalized statistic that computes the relative magnitude of the residual variance compared with the observed data variance a value of one indicates the optimal value as the estimation error variance is equal to zero under this condition and a value less than zero indicates that the observed mean is the better predictor than the model nash and sutcliffe 1970 furthermore the coefficient of determination r2 expresses the consistency of the trend between simulated and observed values van liew et al 2003 the value of r2 ranges from 0 to 1 with a higher value indicating less error variance and better model performance ens and r2 were calculated as follows 9 e ns 1 i 1 n o i p i 2 i 1 n o i o 2 10 r 2 i 1 n o i o p i p 2 i 1 n o i o 2 i 1 n p i p 2 where n is the number of observations oi and pi are the observed and predicted values at the time i and o and p are the means of the observed and predicted values respectively as scheme2 had two variables a weighted objective function was used following ahmadi et al 2014 calculated as 11 g j w j e ns j where wj is the weight of the jth variable in the objective function and the weight for each variable was determined as 12 w j 1 n 13 w k w j n v where w j is the weight for each variable n is the total number of variables wk is the weight assigned to each measurement station observation value that is streamflow at the gauge outlet or sub basin level rs et and nv is the total number of measurement stations for each type following previous studies duan et al 2019 ma et al 2019 moriasi et al 2007 we categorized the criteria for model performance evaluation as unsatisfactory ens 0 5 and r2 0 6 satisfactory 0 50 ens 0 65 and 0 60 r2 0 70 good 0 65 ens 0 75 and 0 70 r2 0 80 and very good 0 75 ens 1 00 and 0 80 r2 1 0 4 results 4 1 evaluation of model outputs 4 1 1 simulated streamflow at gauge stations table 3 presents the model s performance in simulating monthly streamflow at the three outlets for the two schemes the evaluation metrics of both schemes were within acceptable ranges moriasi et al 2007 the overall coefficient values showed that the model was successfully calibrated at the three hydrological stations and showed very good performance 0 75 ens 1 and 0 80 r2 1 however the model performance decreased slightly during the validation period particularly for ens at shicheng which had the lowest streamflow of the three which was very low in terms of root mean squared error though still returning a good performance overall 0 65 ens 0 75 and 0 70 r2 0 80 the model performances were very similar with high accuracy for scheme1 and scheme2 at all three outlets from a statistical point of view table 3 in addition streamflow simulations along a timeline also agreed well with visual interpretations fig 3 a c although it would seem difficult to conclude that one scheme was better than the other the pseudo accuracy of scheme1 was evident fig 3d given the comparative decrease in all statistical summaries for the absolute difference between simulated and observed flow for scheme2 as compared to scheme1 in the time series correspondingly both the mean and standard deviation of the above values were also reduced in scheme2 compared to scheme1 table 4 except for the standard deviation of ningdu station the mann whitney u test showed that all the probability values p values were 0 01 so the performances of the two schemes were significantly different in the three sub basin outlets overall the simulations from both schemes had very good accuracy when measured with evaluation metrics of ens but differed in terms of the internal representation of the sub processes over time if presenting in a box plots way 4 1 2 simulated evapotranspiration in sub basins a comparison of the swat model s ability to simulate et at the sub basin level in both schemes is presented in table 5 compared to rs et the swat simulated et in scheme2 during the calibration was satisfactory ens 0 55 r2 0 80 scheme2 performed slightly better than scheme1 for monthly calibration in each sub basin independent of the magnitude scale as average ens and r2 values increased from 0 53 to 0 55 and 0 79 to 0 80 respectively all sub basins were reassembled into the four evaluation categories based on ens although r2 seemed better three sub basins representing good satisfactory and unsatisfactory performance were selected to create time series graphs and box plots fig 4 despite differences in the evaluation metrics for both schemes the temporal variation trends in simulated et produced by both schemes were like the recession and falling limbs of rs et except for a very high peak discharge in july and august 2003 fig 4a c the lowest et values were recorded in winter and the highest values in summer a statistical summary of the differences between simulated et and rs et in the time series fig 4d where scheme2 had relatively lower mean values and standard deviations than scheme1 indicated the closeness of the simulated et values with rs et in every category of sub basin 4 2 model stability measured in spatial units as evaluating outputs from the various sub processes is problematic due to the lack of corresponding ground truth datasets we conducted a repeated measurement experiment section 3 3 of the hundreds of simulations in an iteration of inverse modeling we selected top runners up simulations that fulfilled two criteria for each scheme as follows 1 the ens values of all simulations in a scheme presented a normal population distribution and a 95th percentile was used to select those candidates with high ens values 2 a pair of top performing simulations were further selected if the difference in ens among them was 0 01 the stability exhibited in both schemes was measured by calculating the monthly difference in the outputs of the two corresponding simulations in space 4 2 1 reducing uncertainty in the sub processes of plant growth and soil water balance to explore the reduction in model uncertainty made possible by scheme2 over scheme1 we evaluated the outputs of the plant growth and soil water balance sub processes including surface runoff water yield et and lai all of which could be affected by the model solutions calibrated by rs et as shown in scheme2 assuming that the models calibrated by one scheme were stable two top runners up simulations selected from the final iterations of each scheme should present even smaller differences for every output in all spatial units and vice versa a comparison of the difference in values between the two corresponding et surface runoff water yield and lai estimates for the same individual spatial units in scheme1 and scheme2 is shown in fig 5 the integration of spatiotemporally distributed rs et significantly reduced uncertainty at the sub basin and hru levels both the mean and standard deviation of the relative change of the difference in output variables among the selected top performing simulations was much higher in scheme1 than scheme2 scheme1 demonstrated more heterogeneity with more variability in the range of the difference of estimated values across spatial units at the same time scheme2 had highly significant homogeneity in every examined output variable signifying consistently smaller prediction uncertainty across spatial units all the above mentioned indicates that the model calibrated under scheme2 was much more stable as the output sets of these top model solutions of scheme2 had smaller fluctuation than those in scheme1 both on the same spatial units and across the spatial units moreover the spatial distribution of the differences between the two estimates at the sub basin level of the watershed was spread over a lower range than at the hru level because of spatial aggregation however the hru map presented more spatial details of the differences between the two repetitive estimates statistically the stability gained by scheme2 over scheme1 is also shown by the probability histograms and boxplots in fig 6 in the histograms the bins from scheme2 are taller and distributed in a narrower range closer to the origin than those from scheme1 showing that the differences between the outputs of the two selected simulations of surface runoff water yield and lai for the same individual spatial units in scheme2 were remarkably lower than those in scheme1 the boxplots also show that the model outputs of scheme2 were more robust than those of scheme1 the significance of the difference in stability produced at the sub basin scale was determined by the mann whitney u test table 6 given the absolute difference or similarity in output varibles among two top performing simulations were drived by a scheme the mean and standard deviation in scheme2 were also lower than in scheme1 while the p values were 0 01 rejecting the null hypothesis that the performance of the two schemes was similar this proved a highly significant difference between the two schemes in reducing uncertainty for surface runoff water yield et and lai 4 2 2 improving spatial stability of model solutions parameters the calibration strategy of both schemes consisted of the same surface and sub surface parameters and biophysical parameters table 2 the sensitivity analysis of these parameters was based on the t stat and p value abbaspour et al 2015 those with a larger absolute t stat and smaller p value were most sensitive there was a significant change in the number of sensitive parameters t stat values and the order of sensitivity in the respective schemes parameters associated with vegetation growth and evapotranspiration sub processes were more sensitive in scheme2 than in scheme1 while soil moisture and surface flow were highly sensitive in scheme1 indicating that vertical fluxes dominate in the hydrological cycle as shown in scheme2 rather than scheme1 this was likely to be the cause for scheme1 s inability to perform well when accounting for internal sub processes compared to scheme2 surface and sub surface parameters that were sensitive in both schemes such as cn2 and sol k represent soil water balance characteristics the spatial stability of the surface and sub surface runoff parameters for scheme1 and scheme2 are shown in fig 7 the histogram bins of scheme2 are taller and are distributed in a narrow range along the x axis compared to scheme1 significantly closer to the origin moreover the boxplots which present statistical summaries of the differences between the outputs of two selected simulations also show that the average values of differences across spatial units remarkably decreased with a low standard deviation in scheme2 compared to scheme1 biophysical parameters such as blai bio e chtmx laimx1 and frgrw2 represent vegetation and energy related processes and their relationship with water at different scales in a watershed like the surface and sub surface parameters the stability of these parameters in scheme2 was also much higher than in scheme1 both histograms and boxplots fig 8 illustrated that the difference between the two selected simulations at the same spatial units was smaller for scheme2 than scheme1 the decrement in both the mean and standard deviation for scheme2 against scheme1 table 7 demonstrated the consistency of stability in the values of the model solutions the mann whitney u test shows that all sensitive parameters had probabilities p values less than the significance level 0 01 rejecting the null hypothesis and proving a significant difference between the stabilities produced in the two schemes 5 discussion 5 1 improvement in modeling of hydrological processes by evaluating the middle phase of the hydrological cycle water is stored and moved within and among sub watersheds through many sub processes and the interactions between these sub processes can be considered the hydrological cycle inglezakis et al 2016 therefore the accuracy of any model representing the hydrological cycle in a particular watershed depends on how well all sub processes are parameterized as shown in table 2 the same parameters were used in both schemes but their sensitivity orders or ranking were quite different implying that the impacts of the two schemes on model parameterization were very different this raises the question of why scheme2 produced a much more stable model than scheme1 to some degree swat can be considered a long chain of several water cycle related sub processes in both space and time as described in section 2 streamflow is the output of the main channel processes near the end of the downstream chain while vertical fluxes et are closely related to the vegetation growth module in the upstream chain and can increase internal consistency in the middle phase of the hydrological model vegetation growth inevitably coincides with important eco hydrological processes influenced by water availability and feeds back to affect the regional water balance however calibration based only on observed streamflow data in scheme1 makes it difficult to back propagate to evapotranspiration related and biophysical parameters in upstream modules compared to satellite observed et data in scheme2 therefore biophysical parameters were much more sensitive in scheme2 than in scheme1 table 2 therefore a model calibrated against only limited streamflow data often leads to the miscalibration of some components of the hydrologic system rajib et al 2016 and produces equifinality due to a nullifying mechanism where the neutralization of individual sub basin errors for the representation of internal hydrological sub processes occurs due to cross compensation beven 2006 rajib et al 2018b tobin and bennett 2019 satellite observed modis et products may be overestimated or underestimated depending on the geography but the relative changes of et in space for a snapshot area are accurate moreover the aggregation of et from hrus to sub basins may ease this issue more or less due to scale increase as immerzeel and droogers 2008 reported the difference between simulated et and et from the surface energy balance algorithm for land sebal occurred more heavily at the hru level than the sub basin level therefore multivariate calibration using streamflow plus et data is a possible solution to reducing equifinality for both surface and sub surface physical parameters and biophysical parameters by evaluating the middle phase of the hydrological cycle becker et al 2019 rientjes et al 2013 5 2 evaluation of multi variable swat performance against existing studies some notable studies have applied rs et as a variable in multi variable calibration asurza véliz and lavado casimiro 2020 herman et al 2018 immerzeel and droogers 2008 rajib et al 2016 tobin and bennett 2017 tuo et al 2018 to the best of our knowledge existing studies have used evaluation metrics such as ens and kge to measure the accuracy induced in spatial units which calculates the average of the time series values of simulated and observed values becker et al 2019 rajib et al 2018b tuo et al 2018 however evaluation based on metrics such as ens weakly represents the effects of the major processes simulated gupta et al 2009 tobin and bennett 2017 yen et al 2014 and does not reveal the real improvement in the internal process moreover studies have used remote sensing products such as modis products rajib et al 2018b to verify the results which do not provide accurate results as remote sensing datasets are associated with uncertainties themselves the novelty of our method for evaluating multi variable calibration can be expressed in two ways 1 the use of a repeated measure design experiment to include the added value of rs et at the sub basin scale in the traditional calibration approach carried out based on differences between simulations and 2 the adoption of stability to measure the efficiency of reduced uncertainty in the sub processes embedded in the hydrological cycle at spatial units and in various aspects this proposed concept is unique for measuring model robustness or stability in the absence of ground truth et observations it explores the highly significant reduction in uncertainty across spatial units for the simulation of streamflow water balance components vegetation dynamics and model parameters achieved by scheme2 over scheme1 we achieved this by constraining rs et at the sub basin level future studies could integrate more open access spatial datasets such as soil moisture biomass and lai the comparative selection of objective functions could be another possible research topic as the optimization of parameters is based on the adopted objective function finally objective functions are dependent on different aspects of targeted variables in a multi variable study and this could be further researched molina navarro et al 2017 among current evapotranspiration products modis16a2 level 4 version 6 was deployed for a multi variable calibration of swat in this study it shows a great role in reducing the equifinality of hydrological modeling in the meichuan basin china but several studies have reported poor performance both overestimation and underestimation of modis16a2 around the globe and especially in china therefore it is interesting to explore different et products in future studies 6 conclusions in this study we explored a practical multi variable approach to calibrating swat by including rs et data along with gauge measured streamflow data to enhance the model s parameterization capability and diversify the parameter sets between hrus we used a repeated measure design to illustrate the stability or robustness of the models calibrated by scheme1 only gauge measured streamflow and scheme2 both streamflow and rs et it was difficult to distinguish the schemes based only on ens and r2 at the three gauge stations considered but the repeated measure design revealed a considerable difference between the two in terms of spatial detail both statistical summaries and the mann whitney u test demonstrated significantly improved calibration in scheme2 over scheme1 demonstrating the potential for improvement in model uncertainty our results demonstrate that rs et datasets which account for vital vertical fluxes in the complex multi phase hydrological cycle can be a potential solution to precise hydrological modeling of a data scarce region furthermore the increasing availability of open access rs data has opened unprecedented prospects for incorporating multiple observation products into hydrological applications in the future credit authorship contribution statement suraj shah data curation methodology formal analysis validation writing original draft writing review editing zheng duan writing review editing supervision xianfeng song conceptualization methodology writing review editing supervision funding acquisition project administration runkui li conceptualization methodology writing review editing supervision funding acquisition huihui mao resources data curation junzhi liu resources data curation tianxiao ma resources data curation mingyu wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china nos 2020yfc1807103 and 2017yfb0503702 the 973 program no 2013cb733402 the key deployment project of center for ocean mega research of science chinese academy of sciences coms2019q15 the fundamental research funds for the central universities e0e48914x2 and the national natural science foundation of china no 41771435 and 40771167 in addition z d is grateful for the funding from the crafoord foundation no 20200595 and no 20210552 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127046 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3916,hydrological processes in a watershed consist of multiple sub processes such as plant growth evapotranspiration water yield and soil water balance that have complex interactions the common practice of calibrating hydrological models against only a single variable e g streamflow can lead to parameter uncertainty also known as equifinality resulting in significant uncertainties in the representation and simulation of sub processes as multi variable calibration can be a potential solution to this issue we tested the integration of spatially and temporally gridded remotely sensed evapotranspiration rs et data with the soil and water assessment tool swat hydrological model this approach was intended to reduce equifinality by enhancing related hydrological sub processes in both space and time rather than improving the evaluation metrics at the streamflow outlet we further introduced the principle of repeated measure design in the calibration process where the swat was calibrated under two different schemes scheme1 using only streamflow data and scheme2 using both rs et and streamflow data the model s performance was evaluated using the concept of stability at multiple spatial scales basin outlet sub basins and hydrological response units and aspects different model outputs and most sensitive calibrated parameters the significance of the difference between the stabilities produced by the two schemes was estimated using the mann whitney u test testing this approach in meichuan basin china showed that scheme2 substantially reduced equifinality for calibrated parameters and model outputs compared to scheme1 in addition the model solutions and outputs for scheme2 were significantly different from scheme1 our results demonstrate the added value of using increasingly available open access rs et data for improving hydrological model calibration keywords equifinality evapotranspiration modis swat repeated measure design stability manning whitney u test 1 introduction the hydrological responses of watersheds can be represented by spatiotemporally variable vertical and horizontal fluxes using hydrological modeling with varying degrees of complexity the outcomes of such models can be applied to policy planning and decision making concerning the soil water balance in diverse environmental conditions duan et al 2019 tuo et al 2016 however hydrological models can suffer from equifinality the probability of achieving similar but not necessarily identical hydrological outcomes finality through different model schemes and particular sets of parameters i e equal pathways beven 2006 pfannerstill et al 2017 this issue can be derived from model structure and parameters observational data used for forcing and calibration initial conditions and boundaries liu and gupta 2007 wagener and gupta 2005 equifinality has previously been studied using other terms such as ambiguity identifiability empirical equivalence non uniqueness under determination or indeterminacy and system convergence oreskes et al 1994 streamflow represents the availability of actual water resources in a basin and thus simulated streamflow is often the most critical model output hydrological models have parameters that cannot be readily determined making calibration an essential step in hydrological modeling in practice this only considers streamflow and is implemented by adjusting parameter values to match simulated streamflow as closely as possible to measured streamflow immerzeel and droogers 2008 however streamflow time series information may not sufficiently capture the evolution of vertical fluxes at different spatiotemporal scales within the watershed birkel et al 2014 li et al 2018 additionally streamflow combines the contributions of different upstream hydrological components such that calibration based on streamflow alone cannot guarantee a reasonable representation of multiple hydrologic components especially those from the unsaturated zone leading to a non unique solution in inverse modeling beven 2006 hanzer et al 2016 previous studies have stressed that great caution should be used when simulating other water balance components with models calibrated solely by streamflow at the basin outlet becker et al 2019 herman et al 2018 immerzeel and droogers 2008 tobin and bennett 2017 in addition adjusting numerous parameters with measured streamflow from a limited number of stations leads to equifinality especially for parameters that are not directly related to streamflow beven and freer 2001 however no previous research has shown that observations from many gauges can lead to more accurate estimations of subsurface fluxes with reduced equifinality of related parameters wanders et al 2014 these limitations derived from streamflow only calibrations can result in unreasonable simulations of other hydrologic components ultimately reducing the model performance rajib et al 2018b therefore including additional hydrological components during calibration could allow models to reflect better all environmental processes crow et al 2003 pfannerstill et al 2017 rajib et al 2016 in addition the interdependency of various hydrological fluxes the spatiotemporal heterogeneity of hydrological processes and process based variables should all be considered during calibration to capture better the relevant interconnections among various water balance components arnold et al 2012 in particular evapotranspiration et should be considered an essential hydrological component during calibration as this is generally second only to precipitation in terms of the magnitude as a vertical flux in the hydrologic cycle et is composed of evaporation from the soil canopy interception and transpiration from vegetation neitsch et al 2011 yuan et al 2021 in addition 60 of moisture input is returned to the atmosphere via et at the expense of half the solar energy absorbed by the earth s surface trenberth et al 2007 however physical phenomena in the soil vegetationatmosphere continuum are among the most complicated hydrologic components to be modeled kim and kaluarachchi 2017 et is also characterized by large spatiotemporal variability direct or in situ measurements of et with flux towers based on eddy covariance methods are sparse and represent a limited footprint making it challenging to obtain spatially resolved et data at the basin or regional scales liou and kar 2014 alternatively remote sensing rs data can be utilized to estimate net energy and et chen and liu 2020 jiao et al 2021 smith et al 2019 open access to various sources of spatiotemporally widespread data means that remotely sensed evapotranspiration rs et data have been increasingly used for multi scale multi objective calibration of hydrologic models and prediction in ungauged basins at sub basin and hydrological response unit hru scales becker et al 2019 huang et al 2020 rajib et al 2018a zhang et al 2020 the soil and water assessment tool swat is a comprehensive time continuous semi distributed process based model supported by extensive research available at https www card iastate edu swat articles that is applicable in many areas worldwide abbaspour et al 2015 huang et al 2020 like other hydrological models most existing swat studies have used only streamflow data for model calibration parajuli et al 2013 but rs data are being increasingly applied as well for example rs data have been used to quantify total terrestrial water qiao et al 2013 yeo et al 2019 soil moisture azimi et al 2020 tobin and bennett 2020 groundwater recharge fallatah et al 2019 milewski et al 2020 snow water equivalent grusson et al 2015 tuo et al 2018 leaf area index lai ma et al 2019 strauch and volk 2013 and et rajib et al 2018b tobin and bennett 2019 although the possibility of applying rs et data to hydrological modeling especially in ungauged basins has been explored no specific methods have yet been successfully demonstrated for multi variable calibration of ungauged watersheds to improve et simulation and hydrological modeling tobin and bennett 2017 previous studies have been concerned only with the calibration of surface subsurface and river routing parameters immerzeel and droogers 2008 rientjes et al 2013 tobin and bennett 2017 and are limited in their ability to represent a combination of surface sub surface runoff and biophysical parameters yang and zhang 2016 zhu et al 2015 as a solution for reducing equifinality existing studies have measured reductions in uncertainty produced in the model using only metrics for simulated streamflow and et they have not considered model results at multiple spatial scales basin outlet subbasin or hru or multiple aspects sub processes of hydrological cycles or model solutions such evaluation methods which only consider the average of the simulated values for the period lead to equifinality as they are limited to exploring the uncertainty associated with sub processes in the hydrological cycle herman et al 2018 immerzeel and droogers 2008 parajuli et al 2018 rajib et al 2018b tobin and bennett 2017 in this study we aimed to address the aforementioned limitations and evaluate the advantages of using rs et in the multi variable calibration of swat models for the reduction of equifinality we hypothesized that the uncertainty problem associated with swat could be improved by enhancing sub processes embedded in the swat hydrological cycle such as plant growth et water yield and soil water balance by applying rs et we demonstrated the significance of this approach using a repeated measure design experiment in which calibration was performed under both single variable streamflow data only and multi variable both rs et and streamflow data schemes the reduced uncertainties in the model and its outputs produced by the experiment were difficult to quantify owing to the complex nature of hydrological processes and a lack of ground truth observations we therefore introduced the concept of stability to examine reduced potential uncertainties for each sub process and related parameters and outputs comparing two successive simulations in each scheme across spatial units e g hrus or sub basins we focused on improving these sub processes for specific time series and spatial units instead of merely improving a comprehensive evaluation of statistical coefficients at basin outlets 2 theoretical background et calculation in swat et is defined as water removal by a plant s transpiration mechanism and evaporation from the canopy and soil and surpasses runoff in most river basins neitsch et al 2011 its primary role in the hydrological cycle can be determined through accurate estimation of et and integration of et into the calibration process to characterize better the hydrological cycle arnold et al 2012 herman et al 2018 swat determines the actual evapotranspiration aet from potential evapotranspiration pet by one of three built in calculation methods neitsch et al 2011 penman monteith allen et al 1989 monteith 1965 priestley taylor priestley and taylor 1972 and hargreaves hargreaves and samani 1985 we chose the penman monteith method to estimate pet which is distributed spatially across hrus and temporally on daily time steps because the study area has a humid subtropical climate with a forest as the dominant land cover and this method has been successfully applied in such regions arakaki et al 2014 jung et al 2016 furthermore it is compatible with the modis et calculation algorithm which also uses this method he et al 2019 avoiding the problem that differing et calculation methods can result in discrepancies between simulated and observed et becker et al 2019 this method is the only standard suggested by the food and agriculture organization of the united nations it has been globally validated as the most rigorous and physically realistic approach to quantifying et r g allen et al 1998 the penman monteith equation is written as 1 λ e δ h net g ρ air c p e z o e z r a δ γ 1 r c r a where λe is the latent heat flux density mj m 2 d 1 e is the depth rate evaporation mm d 1 δ is the slope of the saturation vapor pressure temperature curve de dt kpa c 1 g is the heat flux density to the ground mj m 2 d 1 ρair is the air density kg m 3 cp is the specific heat at constant pressure mj kg 1 c 1 ez o is saturation vapor pressure kpa ez is actual vapor pressure kpa γ is the psychrometric constant kpa c 1 and ra is aerodynamic resistance the important terms in eq 1 which are related to the plant and soil water balance are described as follows a net radiation hnet can be calculated as 2 h net 1 α h day h b where hday is the short wave solar radiation reaching the ground hb is the net incoming long wave radiation and α is the albedo when no plants grow in an hru the value of α α soil otherwise the value of α is given by 3 α α plant 1 c o v sol α soil c o v sol where αplant is the plant albedo default value of 0 23 and covsol is the soil cover index calculated as 4 co v sol exp 5 0 10 5 c v where cv is the aboveground biomass and residue b canopy resistance rc jensen et al 1990 can be calculated as 5 r c r l 0 5 l a i for non clipped grass and alfalfa 3 cm in height lai can be calculated as 6 lai 1 5 ln h c 1 4 where rl is the minimum effective stomatal resistance of a single leaf hc is the canopy height cm and lai is the leaf area index of the canopy the swat uses alfalfa at the height of 40 cm with a minimum leaf resistance of 100 s m 1 when solving the penman monteith equation for the reference crop once the pet is estimated using eq 1 swat calculates the actual evaporation from the intercept storage rainwater trapped in the plant canopy c evaporation of intercepted rainfall swat considers the removal of the readily available amount of free water from canopy storage when calculating actual evaporation it estimates the maximum amount of water in canopy storage by defining it as a function of lai neitsch et al 2011 7 ca n day c a n mx lai la i mx where canday is the maximum amount of water that can be trapped in the canopy on a given day canmx is the maximum amount of water that can be trapped in the canopy when it is fully developed lai is the leaf area index for a given day and laimx is the maximum leaf area index for the plant d sublimation and soil evaporation are impacted by the degree of shading and are calculated as follows neitsch et al 2011 8 e s e o c o v sol where es is the maximum sublimation soil evaporation on a given day mm h2o e o is the pet adjusted for the evaporation of free water in the canopy mm h2o and covsol is the soil cover index swat computes the maximum amount of transpiration sublimation and soil evaporation following the approach given in ritchie 1972 aet is calculated as the sum of interception actual soil evaporation and actual plant transpiration neitsch et al 2011 the estimation of et in swat sums up spatially distributed statistics for sub processes such as precipitation plant growth and energy exchange and soil water balance thus rs et can act as spatially distributed ground truth data to some degree in addition to gauging streamflow data the inclusion of rs et in swat calibration can thus reduce uncertainty in surface subsurface runoff parameters and bio physical parameters for physical processes within the hydrological cycle of spatial units rajib et al 2018b 3 materials and methods 3 1 study area the meichuan basin 26 00 27 09 n and 116 36 116 39 e in jiangxi province southeastern china comprises a drainage area of 6384 km2 including an upstream tributary of the gan river which feeds into poyang lake and the yangtze river fig 1 the basin s elevation ranges from 137 to 1425 m average 358 m and it has a wet subtropical climate during the study period 2001 2014 the annual mean temperature was 17 c and the annual mean precipitation was 1628 mm forest dominates as the most common land use 40 63 followed by cropland 27 19 farming is prevalent for two seasonal crops in a year in which paddy cultivation dominates red ferralic cambisol and paddy soils cover most of the area 64 3 and 28 2 respectively 3 2 datasets and swat settings table 1 presents an overview of the data used in this study three hydrological gauges ningdu shicheng and fenkeng fig 1 provided observed streamflow data for the entire study period 2001 2014 daily observed streamflow and precipitation data were obtained from the chinese hydrological data yearbook we used a 30 m global digital elevation model gdem to execute automatic watershed delineation and extract topographic characteristics for the swat model land use data were obtained from the finer resolution observation and monitoring of global land cover from glc climate data daily maximum and minimum air temperature daily average solar radiation wind speed and relative humidity were obtained from the chinese meteorological data service center cmdc for six climate stations by integrating soil landscape relationships with geographic information systems gis using fuzzy logic we produced detailed soil data at 30 m spatial resolution from the original 1 500 000 scale soil maps using the soil land inference model zhu et al 2001 modis et mod16a2 level 4 version 6 data were used as an rs et for the study period at 500 m spatial resolution and 8 d temporal resolution this rs et product which has satisfactory r2 0 67 with flux et measured by qianyanzhou flux site nearby this area liu et al 2015 was scalable to a sub basin level with good accuracy and has been widely verified and used at regional and global scales cheng et al 2021 sriwongsitanon et al 2020 sun et al 2017 swat2016 revision 664 was used to model streamflow and et for the meichuan basin which was delineated into 17 sub basins and 453 hrus the latter is defined as the smallest spatial unit when modeling sub basins and are generated by a unique combination of land use soil type and slope this combination approach allowed for a high discretization of the entire basin thus the size of an hru depended on the homogeneity of the underlying soil and land use characteristics 2001 2002 was used as a warm up period to moderate the initial conditions and was omitted from further analysis 3 3 modeling experiment design to discover how the integration of rs et into a calibration process could alleviate the equifinality problem of the swat model in space we defined two calibration procedures that maintained the same sensitive parameters but differed in calibration data used fig 2 scheme1 single variable used only observed streamflow data and scheme2 multi variable used both streamflow and rs et data for each scheme model calibration produced various simulations or parameter solutions representing different scenarios for representing hydrological processes with individual evaluation metrics values the simulation with the highest evaluation score is usually chosen as the best model solution but in general it may only minorly surpass the succeeding simulations for a stable and acceptable calibration scheme it is no coincidence that a high degree of similarity in output variables among these top model solutions may be achieved because the scheme results in the robust representation of hydrological sub processes i e et surface runoff water yield and lai and vice versa the above model calibration procedure is the most common type of repeated measures design based around ensuring that two subjects schemes receive the same treatments to examine whether scheme2 can alleviate equifinality rather than scheme1 the performance of the simulations by two schemes were not only compared at three outlet points but also in seventeen sub basins in this study the term stability represents an adequate consistency of a data result relative to a reasonable alteration of the model design yu 2013 so we used stability to measure the similarity or difference between top performing simulations generated by a scheme the magnitude of the similarity or difference in the values of both outputs and related parameters for calibrated swat models in the scheme was calculated in spatial units here it was done based on the time series of model outputs in sub basin level in monthly step the lower the difference the higher is the stability of the scheme and vice versa the high stability of the scheme indicates that the possibility of inherent non uniqueness or equifinality in inverse modeling is reduced during the calibration procedure this can be illustrated through three criteria probability histograms box plots and mean and standard deviation std meanwhile the non parametric mann whitney u test was adopted to examine whether there is statistically significant difference in the stability by scheme1 as compared to scheme2 because the similarity presented a non normal population distribution even with a thick tail the significance of the difference indicates the role that was played by the input of rs et in the calibration procedure 3 4 transformation of gridded modis et data into irregular sub basins in swat the modis rs et mod16a2 level 4 version 6 an 8 day 500 m gridded dataset was used as observation data in the calibration procedure it has been made available since 2000 with good spatiotemporal resolution and quality assessment documentation records and has been suggested for eco hydrological studies mu et al 2013 tobin and bennett 2017 however the spatial and temporal scales of the modis grid 500 m and 8 day are different from the ones in swat cup calibration process irregular sub basin polygons and monthly time scale thus the area and time weighed aggregation method was adopted to convert modis et grid data to the monthly et for each sub basin variable for further model calibration the rs et was integrated into swat in two steps first the 8 day dataset was aggregated to a monthly et by time weighting cammalleri et al 2019 based on the number of days of each month and the julian date in the original metadata second a gridded monthly et was overlaid with the subbasin boundaries irregular polygon shapes fig 1 and the area weighted averaging method huang et al 2020 liu et al 2012 was applied to transform the regular gridded rs et into irregularly shaped sub basin polygons for hydrologic modeling 3 5 configuration of swat calibration after setting up the swat model and defining the experimental design the model was calibrated using the sequential uncertainty fitting algorithm sufi version 2 for two defined schemes in the swat cup platform abbaspour et al 2015 sufi 2 is an auto calibration and uncertainty analysis module that uses latin hypercube sampling to set the potential parameter combinations based on the given initial range by ensuring realistic physical coverage abbaspour et al 2004 for both schemes the calibration steps were chosen at monthly time steps our primary objective was to incorporate rs et data to enhance the consistency of the swat outputs spatially while the disaggregation of the available 8 day rs et to daily data would introduce extra uncertainty the number of years to skip was set from the warm up period 2001 2002 to adjust the initial conditions followed by a calibration period 2003 2010 and validation period 2011 2014 scheme1 used streamflow data observed at the three gauging stations shicheng ningdu and fenkeng while scheme2 used 17 time series from the modis rs et one for each sub basin and the three time series of streamflow data from the three gauging stations the choice of parameters was based on possible representations of the sub processes as described in section 2 previous research and sensitivity analyses becker et al 2019 rajib et al 2016 rajib et al 2018a tobin and bennett 2017 zhang et al 2020 we performed a global sensitivity analysis abbaspour et al 2015 and identified fifteen parameters related to surface sub surface runoff and biophysical processes as highly sensitive table 2 the initial range of parameters was defined following the swat documentation a total of five iterations in both schemes were run with 500 simulations in each iteration thus a total of 2500 simulations during the calibration during model calibration the range of each parameter was changed normally narrowed down after each iteration based on both the new parameters estimated by swat cup abbaspour et al 2004 and their realistic physical ranges duan et al 2019 further details regarding calibration procedures are provided in previous studies abbaspour et al 2015 tuo et al 2016 duan et al 2019 3 6 evaluation of swat model performance the widely used nash sutcliffe efficiency ens was chosen as the primary objective function for both schemes ens is commonly used with extensive information on reported values and is comparatively better than the available objective functions in the sufi 2 calibration procedure moriasi et al 2007 sao et al 2020 ens is a normalized statistic that computes the relative magnitude of the residual variance compared with the observed data variance a value of one indicates the optimal value as the estimation error variance is equal to zero under this condition and a value less than zero indicates that the observed mean is the better predictor than the model nash and sutcliffe 1970 furthermore the coefficient of determination r2 expresses the consistency of the trend between simulated and observed values van liew et al 2003 the value of r2 ranges from 0 to 1 with a higher value indicating less error variance and better model performance ens and r2 were calculated as follows 9 e ns 1 i 1 n o i p i 2 i 1 n o i o 2 10 r 2 i 1 n o i o p i p 2 i 1 n o i o 2 i 1 n p i p 2 where n is the number of observations oi and pi are the observed and predicted values at the time i and o and p are the means of the observed and predicted values respectively as scheme2 had two variables a weighted objective function was used following ahmadi et al 2014 calculated as 11 g j w j e ns j where wj is the weight of the jth variable in the objective function and the weight for each variable was determined as 12 w j 1 n 13 w k w j n v where w j is the weight for each variable n is the total number of variables wk is the weight assigned to each measurement station observation value that is streamflow at the gauge outlet or sub basin level rs et and nv is the total number of measurement stations for each type following previous studies duan et al 2019 ma et al 2019 moriasi et al 2007 we categorized the criteria for model performance evaluation as unsatisfactory ens 0 5 and r2 0 6 satisfactory 0 50 ens 0 65 and 0 60 r2 0 70 good 0 65 ens 0 75 and 0 70 r2 0 80 and very good 0 75 ens 1 00 and 0 80 r2 1 0 4 results 4 1 evaluation of model outputs 4 1 1 simulated streamflow at gauge stations table 3 presents the model s performance in simulating monthly streamflow at the three outlets for the two schemes the evaluation metrics of both schemes were within acceptable ranges moriasi et al 2007 the overall coefficient values showed that the model was successfully calibrated at the three hydrological stations and showed very good performance 0 75 ens 1 and 0 80 r2 1 however the model performance decreased slightly during the validation period particularly for ens at shicheng which had the lowest streamflow of the three which was very low in terms of root mean squared error though still returning a good performance overall 0 65 ens 0 75 and 0 70 r2 0 80 the model performances were very similar with high accuracy for scheme1 and scheme2 at all three outlets from a statistical point of view table 3 in addition streamflow simulations along a timeline also agreed well with visual interpretations fig 3 a c although it would seem difficult to conclude that one scheme was better than the other the pseudo accuracy of scheme1 was evident fig 3d given the comparative decrease in all statistical summaries for the absolute difference between simulated and observed flow for scheme2 as compared to scheme1 in the time series correspondingly both the mean and standard deviation of the above values were also reduced in scheme2 compared to scheme1 table 4 except for the standard deviation of ningdu station the mann whitney u test showed that all the probability values p values were 0 01 so the performances of the two schemes were significantly different in the three sub basin outlets overall the simulations from both schemes had very good accuracy when measured with evaluation metrics of ens but differed in terms of the internal representation of the sub processes over time if presenting in a box plots way 4 1 2 simulated evapotranspiration in sub basins a comparison of the swat model s ability to simulate et at the sub basin level in both schemes is presented in table 5 compared to rs et the swat simulated et in scheme2 during the calibration was satisfactory ens 0 55 r2 0 80 scheme2 performed slightly better than scheme1 for monthly calibration in each sub basin independent of the magnitude scale as average ens and r2 values increased from 0 53 to 0 55 and 0 79 to 0 80 respectively all sub basins were reassembled into the four evaluation categories based on ens although r2 seemed better three sub basins representing good satisfactory and unsatisfactory performance were selected to create time series graphs and box plots fig 4 despite differences in the evaluation metrics for both schemes the temporal variation trends in simulated et produced by both schemes were like the recession and falling limbs of rs et except for a very high peak discharge in july and august 2003 fig 4a c the lowest et values were recorded in winter and the highest values in summer a statistical summary of the differences between simulated et and rs et in the time series fig 4d where scheme2 had relatively lower mean values and standard deviations than scheme1 indicated the closeness of the simulated et values with rs et in every category of sub basin 4 2 model stability measured in spatial units as evaluating outputs from the various sub processes is problematic due to the lack of corresponding ground truth datasets we conducted a repeated measurement experiment section 3 3 of the hundreds of simulations in an iteration of inverse modeling we selected top runners up simulations that fulfilled two criteria for each scheme as follows 1 the ens values of all simulations in a scheme presented a normal population distribution and a 95th percentile was used to select those candidates with high ens values 2 a pair of top performing simulations were further selected if the difference in ens among them was 0 01 the stability exhibited in both schemes was measured by calculating the monthly difference in the outputs of the two corresponding simulations in space 4 2 1 reducing uncertainty in the sub processes of plant growth and soil water balance to explore the reduction in model uncertainty made possible by scheme2 over scheme1 we evaluated the outputs of the plant growth and soil water balance sub processes including surface runoff water yield et and lai all of which could be affected by the model solutions calibrated by rs et as shown in scheme2 assuming that the models calibrated by one scheme were stable two top runners up simulations selected from the final iterations of each scheme should present even smaller differences for every output in all spatial units and vice versa a comparison of the difference in values between the two corresponding et surface runoff water yield and lai estimates for the same individual spatial units in scheme1 and scheme2 is shown in fig 5 the integration of spatiotemporally distributed rs et significantly reduced uncertainty at the sub basin and hru levels both the mean and standard deviation of the relative change of the difference in output variables among the selected top performing simulations was much higher in scheme1 than scheme2 scheme1 demonstrated more heterogeneity with more variability in the range of the difference of estimated values across spatial units at the same time scheme2 had highly significant homogeneity in every examined output variable signifying consistently smaller prediction uncertainty across spatial units all the above mentioned indicates that the model calibrated under scheme2 was much more stable as the output sets of these top model solutions of scheme2 had smaller fluctuation than those in scheme1 both on the same spatial units and across the spatial units moreover the spatial distribution of the differences between the two estimates at the sub basin level of the watershed was spread over a lower range than at the hru level because of spatial aggregation however the hru map presented more spatial details of the differences between the two repetitive estimates statistically the stability gained by scheme2 over scheme1 is also shown by the probability histograms and boxplots in fig 6 in the histograms the bins from scheme2 are taller and distributed in a narrower range closer to the origin than those from scheme1 showing that the differences between the outputs of the two selected simulations of surface runoff water yield and lai for the same individual spatial units in scheme2 were remarkably lower than those in scheme1 the boxplots also show that the model outputs of scheme2 were more robust than those of scheme1 the significance of the difference in stability produced at the sub basin scale was determined by the mann whitney u test table 6 given the absolute difference or similarity in output varibles among two top performing simulations were drived by a scheme the mean and standard deviation in scheme2 were also lower than in scheme1 while the p values were 0 01 rejecting the null hypothesis that the performance of the two schemes was similar this proved a highly significant difference between the two schemes in reducing uncertainty for surface runoff water yield et and lai 4 2 2 improving spatial stability of model solutions parameters the calibration strategy of both schemes consisted of the same surface and sub surface parameters and biophysical parameters table 2 the sensitivity analysis of these parameters was based on the t stat and p value abbaspour et al 2015 those with a larger absolute t stat and smaller p value were most sensitive there was a significant change in the number of sensitive parameters t stat values and the order of sensitivity in the respective schemes parameters associated with vegetation growth and evapotranspiration sub processes were more sensitive in scheme2 than in scheme1 while soil moisture and surface flow were highly sensitive in scheme1 indicating that vertical fluxes dominate in the hydrological cycle as shown in scheme2 rather than scheme1 this was likely to be the cause for scheme1 s inability to perform well when accounting for internal sub processes compared to scheme2 surface and sub surface parameters that were sensitive in both schemes such as cn2 and sol k represent soil water balance characteristics the spatial stability of the surface and sub surface runoff parameters for scheme1 and scheme2 are shown in fig 7 the histogram bins of scheme2 are taller and are distributed in a narrow range along the x axis compared to scheme1 significantly closer to the origin moreover the boxplots which present statistical summaries of the differences between the outputs of two selected simulations also show that the average values of differences across spatial units remarkably decreased with a low standard deviation in scheme2 compared to scheme1 biophysical parameters such as blai bio e chtmx laimx1 and frgrw2 represent vegetation and energy related processes and their relationship with water at different scales in a watershed like the surface and sub surface parameters the stability of these parameters in scheme2 was also much higher than in scheme1 both histograms and boxplots fig 8 illustrated that the difference between the two selected simulations at the same spatial units was smaller for scheme2 than scheme1 the decrement in both the mean and standard deviation for scheme2 against scheme1 table 7 demonstrated the consistency of stability in the values of the model solutions the mann whitney u test shows that all sensitive parameters had probabilities p values less than the significance level 0 01 rejecting the null hypothesis and proving a significant difference between the stabilities produced in the two schemes 5 discussion 5 1 improvement in modeling of hydrological processes by evaluating the middle phase of the hydrological cycle water is stored and moved within and among sub watersheds through many sub processes and the interactions between these sub processes can be considered the hydrological cycle inglezakis et al 2016 therefore the accuracy of any model representing the hydrological cycle in a particular watershed depends on how well all sub processes are parameterized as shown in table 2 the same parameters were used in both schemes but their sensitivity orders or ranking were quite different implying that the impacts of the two schemes on model parameterization were very different this raises the question of why scheme2 produced a much more stable model than scheme1 to some degree swat can be considered a long chain of several water cycle related sub processes in both space and time as described in section 2 streamflow is the output of the main channel processes near the end of the downstream chain while vertical fluxes et are closely related to the vegetation growth module in the upstream chain and can increase internal consistency in the middle phase of the hydrological model vegetation growth inevitably coincides with important eco hydrological processes influenced by water availability and feeds back to affect the regional water balance however calibration based only on observed streamflow data in scheme1 makes it difficult to back propagate to evapotranspiration related and biophysical parameters in upstream modules compared to satellite observed et data in scheme2 therefore biophysical parameters were much more sensitive in scheme2 than in scheme1 table 2 therefore a model calibrated against only limited streamflow data often leads to the miscalibration of some components of the hydrologic system rajib et al 2016 and produces equifinality due to a nullifying mechanism where the neutralization of individual sub basin errors for the representation of internal hydrological sub processes occurs due to cross compensation beven 2006 rajib et al 2018b tobin and bennett 2019 satellite observed modis et products may be overestimated or underestimated depending on the geography but the relative changes of et in space for a snapshot area are accurate moreover the aggregation of et from hrus to sub basins may ease this issue more or less due to scale increase as immerzeel and droogers 2008 reported the difference between simulated et and et from the surface energy balance algorithm for land sebal occurred more heavily at the hru level than the sub basin level therefore multivariate calibration using streamflow plus et data is a possible solution to reducing equifinality for both surface and sub surface physical parameters and biophysical parameters by evaluating the middle phase of the hydrological cycle becker et al 2019 rientjes et al 2013 5 2 evaluation of multi variable swat performance against existing studies some notable studies have applied rs et as a variable in multi variable calibration asurza véliz and lavado casimiro 2020 herman et al 2018 immerzeel and droogers 2008 rajib et al 2016 tobin and bennett 2017 tuo et al 2018 to the best of our knowledge existing studies have used evaluation metrics such as ens and kge to measure the accuracy induced in spatial units which calculates the average of the time series values of simulated and observed values becker et al 2019 rajib et al 2018b tuo et al 2018 however evaluation based on metrics such as ens weakly represents the effects of the major processes simulated gupta et al 2009 tobin and bennett 2017 yen et al 2014 and does not reveal the real improvement in the internal process moreover studies have used remote sensing products such as modis products rajib et al 2018b to verify the results which do not provide accurate results as remote sensing datasets are associated with uncertainties themselves the novelty of our method for evaluating multi variable calibration can be expressed in two ways 1 the use of a repeated measure design experiment to include the added value of rs et at the sub basin scale in the traditional calibration approach carried out based on differences between simulations and 2 the adoption of stability to measure the efficiency of reduced uncertainty in the sub processes embedded in the hydrological cycle at spatial units and in various aspects this proposed concept is unique for measuring model robustness or stability in the absence of ground truth et observations it explores the highly significant reduction in uncertainty across spatial units for the simulation of streamflow water balance components vegetation dynamics and model parameters achieved by scheme2 over scheme1 we achieved this by constraining rs et at the sub basin level future studies could integrate more open access spatial datasets such as soil moisture biomass and lai the comparative selection of objective functions could be another possible research topic as the optimization of parameters is based on the adopted objective function finally objective functions are dependent on different aspects of targeted variables in a multi variable study and this could be further researched molina navarro et al 2017 among current evapotranspiration products modis16a2 level 4 version 6 was deployed for a multi variable calibration of swat in this study it shows a great role in reducing the equifinality of hydrological modeling in the meichuan basin china but several studies have reported poor performance both overestimation and underestimation of modis16a2 around the globe and especially in china therefore it is interesting to explore different et products in future studies 6 conclusions in this study we explored a practical multi variable approach to calibrating swat by including rs et data along with gauge measured streamflow data to enhance the model s parameterization capability and diversify the parameter sets between hrus we used a repeated measure design to illustrate the stability or robustness of the models calibrated by scheme1 only gauge measured streamflow and scheme2 both streamflow and rs et it was difficult to distinguish the schemes based only on ens and r2 at the three gauge stations considered but the repeated measure design revealed a considerable difference between the two in terms of spatial detail both statistical summaries and the mann whitney u test demonstrated significantly improved calibration in scheme2 over scheme1 demonstrating the potential for improvement in model uncertainty our results demonstrate that rs et datasets which account for vital vertical fluxes in the complex multi phase hydrological cycle can be a potential solution to precise hydrological modeling of a data scarce region furthermore the increasing availability of open access rs data has opened unprecedented prospects for incorporating multiple observation products into hydrological applications in the future credit authorship contribution statement suraj shah data curation methodology formal analysis validation writing original draft writing review editing zheng duan writing review editing supervision xianfeng song conceptualization methodology writing review editing supervision funding acquisition project administration runkui li conceptualization methodology writing review editing supervision funding acquisition huihui mao resources data curation junzhi liu resources data curation tianxiao ma resources data curation mingyu wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development program of china nos 2020yfc1807103 and 2017yfb0503702 the 973 program no 2013cb733402 the key deployment project of center for ocean mega research of science chinese academy of sciences coms2019q15 the fundamental research funds for the central universities e0e48914x2 and the national natural science foundation of china no 41771435 and 40771167 in addition z d is grateful for the funding from the crafoord foundation no 20200595 and no 20210552 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127046 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3917,the scarcity of site scale actual evapotranspiration et measurements poses a challenge for modelling and verifying regional et taking the grassland ecosystem in arid and semi arid regions of northern china asnc as an example we proposed a framework for estimating et at weather stations without flux observations through a machine learning approach by combining data from modis and fifteen flux towers distributed in alpine grassland ag and temperate grassland tg across asnc first we analyzed the temporal characteristics of grassland et at site scale second we applied the machine learning approach random forest rf to develop a robust model for simulating site scale grassland et and used random and spatial cross validations cvs and three metrics to evaluate the rf models performance two strategies using pooled data from all flux towers for a general model and dividing data by grassland type to develop models specific to ag and tg and four temporal resolutions daily 8 day monthly and seasonal were used to develop the rf models third we investigated how the importance of predictor variables for estimating grassland et changed in different cvs strategies and temporal resolutions the et of ag and tg showed similar dynamic patterns but differed in magnitude the rf models showed good performance in both strategies and all four temporal resolutions r2 0 64 mae 0 53 mm d 1 rmse 0 72 mm d 1 however seasonal et simulations performed better than that of daily 8 day and monthly using pooled data from all flux towers especially in spatial cv meteorological variables temperature precipitation and radiation vegetation ndvi lai and fpar and soil soil water content and soil temperature were strong predictors of variation in grassland et changes in the importance ranking and value of predictor variables partly explained the variations of model performance the robust model performance in spatial cv proved that the framework developed in this study was reliable when applied to weather stations without flux observations thereby overcoming the scarcity of site scale actual et measurements keywords evapotranspiration weather stations without flux observations multiple temporal resolutions spatial cross validation machine learning grasslands 1 introduction evapotranspiration et is a crucial component of the terrestrial water cycle and an important energy flux at the global scale since et returns 60 of precipitation on land back to the atmosphere by consuming more than half of the total solar energy absorbed by land surfaces mu et al 2011 oki and kanae 2006 trenberth et al 2009 the arid and semi arid regions of northern china asnc characterized by low precipitation strong radiation and intense et have been facing increasingly severe water scarcity and are very sensitive to climate change and human activities yan et al 2015 grassland an important land cover type in this area is often heavily impacted by human activities such as grazing therefore precisely estimating grassland et in asnc is valuable for evaluating the impact of climate change and human activities on the water cycle flux towers produce reliable measurements of water and energy fluxes at a high temporal resolution and at an ecosystem level and have become a key tool for generating observational datasets for land surface process model validation and benchmarking in particular large scale measurement networks using the eddy covariance ec method e g fluxnet ameriflux and chinaflux have made it practicable to model et from site level to regional or global scales boden et al 2013 pastorello et al 2020 yu et al 2006 however observational constraints e g low number of flux towers discontinuous observation data limit validation of et estimation at large scales especially in arid and semi arid regions weather stations have the potential to provide richer derived et datasets to overcome site scale observational constraints limited by complicated assumptions and model parametrizations process based biogeochemical models face challenges in the accuracy of their et estimations over heterogeneous landscapes li et al 2018 sandor et al 2016 data driven machine learning techniques are a promising alternative approach for estimating land surface to atmosphere fluxes at local to global scales jung et al 2009 papale and valentini 2003 tramontana et al 2015 yang et al 2007 yang et al 2006 due to their ability to combine field measurements with satellite imagery and the possibility of future improvement with expanding field infrastructure data management networks e g fluxnet and remote sensing imagery tramontana et al 2016 zhou et al 2019 although data driven models can capture highly nonlinear relationships to explanatory variables cutler et al 2007 various sources of uncertainty exist for example model inputs including the availability of flux data and the selection of temporal resolutions fang et al 2020 jung et al 2011 tramontana et al 2015 tramontana et al 2016 grasslands in asnc are mainly split into two alpine grassland ag on the tibetan plateau and temperate grassland tg in the north grasslands in these areas play important roles in climate change mitigation and food and livestock production liu et al 2018 previous studies have analyzed the different limiting environmental factors and feedbacks to climate change for each grassland types hu et al 2008 liu et al 2018 yang et al 2019 however comparative studies of land surface atmosphere fluxes between the two grassland types have mainly focused on the carbon flux feng et al 2018 fu et al 2009 ge et al 2018 guo et al 2015 zhang et al 2019 and there is a lack of comparative studies of water fluxes particularly across multiple time scales moreover tg in previous studies often did not include grassland data in xinjiang china it also remains unclear whether et models perform better for either ag or tg and whether the modelling should integrate them previous studies have been mainly based on daily or 8 day temporal resolution datasets to simulate et fang et al 2020 granata et al 2020 guevara escobar 2021 reitz et al 2021 tramontana 2016 zhou et al 2019 but datasets with fixed temporal resolution may not be suitable for all et simulation tasks given the possible mismatch between the scale of the data and the scale of the problem being investigated choosing the appropriate temporal resolution of the input data is essential to reduce simulation bias and improve simulation accuracy from this perspective a comparative study of different temporal resolutions is necessary and can improve the model generalization ability for future data cross validation cv is recognized as an effective approach to assess the reliability of data driven models and avoid overfitting breiman 2001 random cv i e randomly allocating data to the training and test set provides the model performance in reproducing training data reflecting the ability to simulate known location information and fill discontinuous data but the resulting model is usually required to predict beyond the known locations meyer et al 2019 spatial cv i e excluding entire locations from model training and testing the model on them can reveal the spatial prediction ability of the model only the robust model performance in spatial cv can prove that the model has a strong potential to be extended to unknown weather stations to compensate for the shortage of ground observation et datasets several methods for spatial cv have been proposed brenning et al 2005 le rest et al 2014 meyer et al 2018 pohjankukka et al 2017 roberts et al 2017 valavi et al 2019 process based models and linear analysis have been used to evaluate the biophysical drivers of et and it has been found that land cover change meteorological factors soil and vegetation information affect et variation ge et al 2011 mao et al 2015 sterling et al 2013 stoy et al 2006 teuling 2009 xiao et al 2013 however it is still necessary to quantitatively assess the importance of environmental drivers of et especially in different cvs grassland types and temporal resolutions furthermore a better understanding of how and when the relative importance of predictor variables shifts is also critical for improving the accuracy of et simulations in order to develop a framework for estimating actual et at weather stations without flux observations to overcome the scarcity of site scale ground observation et datasets taking the grassland ecosystem in the asnc as example the objectives of this paper are to 1 analyze the temporal characteristics of site scale grassland et based on flux towers in terms of grassland types and time scales 2 develop a robust machine learning model for simulating site scale grassland et in asnc with two strategies using the pooled data from all flux towers to develop general models and dividing data into ag and tg groups to develop models specific for each group and four temporal resolutions daily 8 day monthly and seasonal focusing on the model performance in spatial cv and 3 investigate how the importance of predictor variables changes in different cvs strategies and temporal resolutions 2 material and methods 2 1 study sites fifteen flux towers associated with different grassland types and elevations within asnc were used in this study fig 1 the sites are split into three areas all ag sites 1 6 10 12 and 13 are located in the northeastern tibetan plateau the tibetan plateau is mainly covered by ag at an average altitude of 4000 m above the sea level with high solar radiation the climate is cold with annual temperature ranging from 15 to 5 c liu et al 2018 shen et al 2015 yang et al 2019 four tg sites 7 9 and 11 are situated in the eastern and central parts of the inner mongolia with an average elevation of approximately 1200 m sites 14 15 are located on the grasslands of xinjiang which are dominated by mountain meadows and mountain steppes 2 2 data 2 2 1 data from study sites the ground observations were obtained from the fifteen study sites the observations included maximum air temperature tmax minimum air temperature tmin mean air temperature tmean precipitation prcp relative humidity rh wind speed ws downward shortwave radiation swi net radiation rn soil water content swc topsoil temperature tsoil sensible heat flux h soil heat flux g latent heat flux le these data have been post processed and quality controlled in previous studies table 1 in this study they were further gap filled with the reddyproc package filling of gaps was conducted with three methods including look up tables lut with swi only mean diurnal course mdc with no meteorological information available or marginal distribution sampling mds with swi vpd and tair which are suitable for different meteorological information availability falge et al 2001 moffat et al 2007 reichstein et al 2005 wutzler et al 2018 then the hourly half hourly or 10 minute data were aggregated to daily values and screened according to multiple quality criteria 1 data were excluded when 20 of the data were based on gap filling with low confidence reichstein et al 2005 tramontana et al 2016 2 clearly erroneous periods were identified and deleted based on visual interpretation tramontana et al 2016 daily data products of sites 11 14 could be directly obtained so no post processing was required et was calculated by dividing latent heat flux le the energy equivalent of et by the latent heat of vaporization of water anapalli et al 2018 additionally we calculated daily energy balance closure ebc of sites 1 14 to assess their reliability of the eddy covariance measurements wilson et al 2002 and then excluded site 3 due to its low ebc level finally we averaged the daily data according to the same criteria 1 and 2 to obtain 8 day monthly and seasonal temporal resolution datasets 2 2 2 remote sensing data data collected from the moderate resolution imaging spectroradiometer modis can provide a relatively high spatial resolution justice et al 2002 and allow the use of an average of 3 3 km pixels centered on each site to reduce the effect of geolocation error xiao et al 2008 the modis products in this study included daily surface reflectance mod09ga 006 and 4 day leaf area index lai and fraction of photosynthetically active radiation fpar mcd15a3h 006 the daily surface reflectance data were processed to calculate the normalized difference vegetation index ndvi huete et al 2002 and normalized difference water index ndwi gao 1996 the extracted subsets for the study sites were quality controlled with quality flags included in the modis products to ensure that they reflect the real ground conditions the above operations were completed through the google earth engine gee platform https earthengine google com finally the daily vegetation data were created using a linear interpolation method fang et al 2020 reitz et al 2021 and were averaged to obtain 8 day monthly and seasonal temporal resolution datasets in addition the harmonized world soil database hwsd provided static soil information for the study sites including topsoil bulk density bd topsoil texture t topsoil organic carbon oc topsoil clay fraction clay topsoil sand fraction sand and topsoil silt fraction silt http www fao org soils portal soil survey soil maps and databases harmonized world soil database v12 en 2 3 random forest model the random forest rf algorithm as a classical machine learning technique is characterized by its ability to ignore noise and overfitting breiman 2001 and its ability to rank the importance of input variables leroux et al 2017 meng et al 2021 wang et al 2018 it has been extensively applied in ecological classification and regression tasks meyer et al 2018 meyer et al 2019 reitz et al 2021 rodriguez galiano et al 2012 zhou et al 2019 rf was selected to develop the stable et models and quantitatively assess the importance of their predictor variables in this study rf is an ensemble of many binary decision trees built from random samples of training data each tree is an independent model of the ensemble that generates a prediction for a new sample at each split node in the binary decision tree the training data are divided into the two most homogenous subgroups by setting a threshold of a randomly selected explanatory variable a random number of explanatory variables mtry selected at each split node is used to overcome correlation between trees kuhn and johnson 2013 the leaf nodes stop splitting the data into two subgroups and contain predictions of the target variable the prediction of a new sample is the mean of the target variable of all elements in the corresponding subgroup the final prediction is given by averaging the predictions of all trees rf was implemented with the caret package in r and simulated et using a regression approach we mainly focused on the two parameters i e the number of trees and mtry used to build rf models 500 trees were used as no performance gains were observed with a higher number of trees mtry was synchronously tuned between two and the number of predictor variables according to the optimal model performance see supplement table s1 for details we selected 21 predictor variables including tmax tmin tmean prcp rh ws swi rn ndvi ndwi lai fpar swc tsoil bd t oc clay sand silt and dem to train and test rf models in this study see table 2 for details they can provide comprehensive information about meteorology vegetation and soil to explain the site scale grassland et variation hao et al 2007 liu et al 2018 sun et al 2019 wu et al 2019 zhang et al 2018 to better fit our research objectives we involved all 21 predictors in the construction process of rf models 2 3 1 experimental design two cross validation cv methods were applied in this study a random k fold cv and a spatial k fold cv to evaluate the data reproduction and spatial prediction abilities of the et model respectively each method first splits the data into k folds and then repeatedly trains the models k times using all the data except one fold the performance of models is evaluated by testing the left out data fig 2 the major difference between random and spatial cvs is how the data points are split into folds fig 2 random cv randomly assigns each data point to one of the k folds for the spatial cv data points belonging to the same study site were assigned to the same fold so k is equal to the number of sites the model performance in spatial cv should receive more attention because it could provide inferences into how the model will perform in unsampled sites random cv was performed with the same number for k to develop a robust rf model two strategies and four temporal resolutions were adopted the two strategies are to i use pooled data from both alpine and temperate grasslands to train and test the model and ii divide data into two groups alpine and temperate grasslands and train and test models in each group the four temporal resolutions are daily 8 day monthly and seasonal 2 3 2 model evaluation the coefficient of determination r2 the mean absolute error mae and the root mean square error rmse were used as metrics to evaluate model performance they were calculated by the following equations 1 r 2 1 i 1 n y i f i i 1 n y i y 2 mae i 1 n f i y i n 3 rmse i 1 n y i f i n where n is the total number of observed data y i is the observed value for data point i y is the mean of the observed data and f i is the predicted value for data point i 2 3 3 variable importance gini importance for classification and the average impurity reduction for regression are very popular variable importance metrics for random forests grömping 2009 however impurity s bias for selecting split variables also leads to biased variable importance metrics shih and tsai 2004 strobl et al 2007 permutation importance indices have been widely adopted by various authors díaz uriarte and de andres 2006 ishwaran 2007 strobl et al 2008 due to their reliability see grömping 2009 for more detailed description on random forest permutation importance in general therefore we calculated the relative importance of predictor variables by the permutation based internal variable importance metric the relative increase of the mean squared error mse of random forest implemented in the caret package error magnitude is assumed to increase if the variable is important for the sake of comparison importance metrics of all predictor variables in this study have been normalized to sum to 1 3 results 3 1 temporal characteristics of grassland et the temporal dynamics of et in the ag and tg had similar patterns fig 3 in three ways first before 8 00 am the half hourly et was small for both types of grassland even negative due to condensation negative half hourly et mainly occurred at night 18 00 pm to 8 00 am in spring and winter after 8 00 am the half hourly et first rose reached its maximum around 14 00 pm and then gradually decreased the period of high et values in a day varied as the season changed second the daily et showed a trend of rising first and then falling reaching a peak around the 190th day third the trend of monthly and seasonal et was the same as that of daily et july and summer june to august were the month and season with the strongest et respectively the differences in the quantitative characteristics of et between the ag and tg were obvious fig 4 the mean and median values of the tg were smaller and the interquartile range of tg was narrower than of the ag the negative half hourly et values occurred more frequently at night in the tg and the fingerprint diagram of the tg had fewer layers and more blurred boundaries fig 3b the daily monthly and seasonal et values of the tg were lower than of the ag fig 3d 3e the biggest and smallest difference between the ag and tg appeared in summer and winter respectively the annual average et of the ag and tg were 533 62 mm and 341 28 mm 3 2 performance of the random forest model the performance of the rf model was stable and reliable according to both cv approaches r2 0 64 mae 0 53 mm d 1 rmse 0 72 mm d 1 the performance of spatial cv was mostly worse than that of random cv indicating that spatial prediction was more difficult than data reproduction daily temporal resolutions mostly exhibited the largest difference between the two cv methods furthermore the difference between the two cv methods of strategy 1 was mostly less than or equal to that of strategy 2 suggesting that strategy 1 had the stronger generalization ability the model performance in strategy 1 was stable and very close to the optimum in strategy 2 the tg model performed worst except in seasonal temporal resolution r2 mae and rmse coincided well with each other table 3 in spatial cv the model at the lower temporal resolution showed the higher et simulation accuracy and seasonal temporal resolution showed better model performance than daily 8 day and monthly temporal resolutions r2 0 86 mae 0 39 mm d 1 rmse 0 47 mm d 1 the averaging process of coarse temporal resolutions might reduce the spatial differences among sites and thereby improving the model performance in spatial prediction the tg model showed the greatest performance improvement in spatial cv r2 from 0 71 to 0 88 as the temporal resolution decreased the rf model s reliable spatial prediction ability was further validated fig 5 data from site 15 that is a bowen ratio tower were excluded from the model construction in order to be used as an additional test set for the model the et variations including temporal trends and numerical magnitudes were well captured at all temporal resolutions r2 range 0 58 to 0 9 mae range 0 22 to 0 5 mm d 1 rmse range 0 28 to 0 73 mm d 1 the model performance using strategy 1 was better than strategy 2 except at the monthly temporal resolution seasonal temporal resolution has not showed better model performance than daily 8 day and monthly temporal resolutions since its sample size was too small to provide an accurate diagnosis on the model performance and some relatively poor model performance was due to the inherent systematic differences between eddy covariance ec and bowen ratio energy balance breb observations rather than inaccurate predictions 3 3 variable importance according to the permutation importance measure the predictor variables with a high contribution to the rf model were tmax tmin tmean prcp swi rn ndvi lai fpar swc and tsoil while the contribution of ws ndwi and static soil properties bd t oc clay sand and silt was low with values close to 0 in all cases figs 6 7 rn was the most important driving factor for grassland et since it determines the energy available for le the energy equivalent of et zhang et al 2018 the random and spatial cvs which reflect the data reproduction and spatial prediction abilities of the model respectively did not change the composition of predictors with a high contribution to the model however the variation pattern of each predictor and the ranking of all predictors changed in different grassland types and temporal resolutions strategy 1 fig 6c 7c could capture predictors importance variations in strategy 2 fig 6a 6b fig 7a 7b since its importance variation pattern of predictors was similar to either ag or tg within strategy 2 the ag fig 6a 7a and tg fig 6b 7b within strategy 2 showed slightly different patterns of predictors importance tsoil and swc were the unique and important driving factors ranking the top 25 see supplement figure s1 s2 for details of the ag and tg respectively the difference in predictors importance between ag and tg is due to the response of water flux to distinct energy and moisture conditions the ag at high altitude is more restricted by thermal conditions while moisture is the main limiting factor for the tg with less precipitation guo et al 2015 liu et al 2018 zhang et al 2019 the predictors importance varied in different temporal resolutions resulting from the time effect of biophysical factors on grassland et for example prcp exhibited an increasing trend from daily to seasonal temporal resolution probably due to the lag time response of grassland et to it changes in the importance ranking and value of predictor variables might to some extent explain variations of the model performance in different cvs grassland types and temporal resolutions for example the dramatic changes in the magnitude and ranking of predictors importance at the monthly temporal resolution might explain the great difference of the tg model performance between random and spatial cvs fig 6b 7b table 3 r2 0 64 to 0 75 4 discussion 4 1 the influence of grassland types and temporal resolutions and its uncertainty the ag model performed better than the tg model within strategy 2 and strategy 1 provided more stable model performance than strategy 2 the ag provides a wider range of et values than the tg fig 4 which is conducive to et estimation under extreme conditions due to the inherent characteristics of the rf algorithm compared with strategy 2 strategy 1 used pooled data from all types of flux sites covering a relatively wide range of et values and is suitable for the scenario where the increasing number of flux sites across the globe participate in large scale measurement networks the et model outperformed at lower temporal resolution table 3 kazemi et al 2020 found that monthly patterns compared to the complete patterns of one growing season as test size provided higher error magnitude estimates tramontana et al 2016 showed very similar model performance when using daily or 8 day temporal resolution datasets but the two temporal resolutions were composed of different data sources our results compensated for the lack of a complete scan of different temporal resoultions and provided ideas for dertermining the appropriate temporal resolution to simulate et furthermore the time related information of the explanatory variables may have been integrated into a coarser temporal resolution but their specific lag effects are still worth noting espeically the previous precipitaion and soil moisture ferreira et al 2019 there might be interactions between cv methods strategies and temporal resolutions in this study for example most of the model performance difference between the two cv methods was smaller in strategy 1 and the coarser temporal resolution such combination as pooled data and coarser temporal resolutions was critical for constructing a robust model with both data reproduction and spatial prediction capabilities previous studies have also investigated the effects of different combinations of datasets input variables simulating methods on the model performance ferreira et al 2019 granata et al 2020 reitz et al 2021 tramontana et al 2016 zhang et al 2020 combinations based on specific research objectives are limited however a unified standard combination suitable for most research needs remains a big issue and requires more discussions and experiments in future research 4 2 limitations of the biophysical drivers used to estimate grassland et although this study did not cover all biophysical drivers of grassland et all available candidate predictors across all sites were fully considered in order to maintain the consistence across temporal resolutions and grassland types we may have introduced redundant variables into models which is disadvantageous to the further enhancement of the spatial prediction capabilities elevation often creates spatial autocorrelation and previous studies removed it through feature selection to improve the simulation accuracy at the regional scale meyer et al 2019 reitz et al 2021 however due to the important influence of elevation on the climate of the ag and the site scale simulation characteristics we included elevation as a predictor of grassland et to construct rf models in this study table 2 the absence of important drivers in the predictor sets might explain why the tg model did not perform as well as the ag model several studies have shown that lagged predictor variables and the predictor selection could improve model performance for et ferreira et al 2019 kim et al 2013 meyer et al 2018 meyer et al 2019 reitz et al 2021 which makes higher demands for continuous observational data and the availability of predictor variables at the sites the continuous observation of site data and the acquisition of multiple biophysical variables are still the basis and key for future et simulation research 4 3 the prospect of this framework taking the grassland ecosystem as an example we have developed a practical framework to estimate actual evapotranspiration at weather stations without flux observations by combining data from modis and flux towers through a machine learning approach while considering grassland types and temporal resolutions comprehensively the robust performance in spatial cv indicated that this framework can perform site scale spatial prediction the generated quasi observation data set will facilitate the development and upgrading of evapotranspiration products at all scales the gridded reanalysis data used as inputs of upscaling models often involve the huge uncertainties which affects the acquisition of the spatial pattern and dynamic variations of et fang et al 2020 jung 2011 reitz et al 2021 tramontana et al 2015 the framework proposed in this study can provide a promising solution to the above problem the site scale quasi observation data set generated by inputting only observation data from stations and remote sensing into models do not contain the uncertainties from the gridded reanalysis data and can be used to better evaluate the upscaled et products and even assimilate them to obtain more accurate spatial estimation the generalization and interpretability of the framework need to be further improved zhao et al 2019 developed a hybrid model combining physical constraints and machine learning to estimate latent heat flux le which provides us with a very promising optimization scheme incorporating physical constraints such as penman monteith and priestley taylor equations into our framework will help predict et under extreme conditions and bayesian network bn shi et al 2020 has more advantages in analyzing causal relationships between environmental variables by combining expert knowledge and flux observations it may provide us with a more reasonable mechanism explanation inside the actual evapotranspiration simulation how to consider special environmental variables and their unique coupling relationships with others in prior knowledge is the key predictor selection based on spatial cv is necessary to reduce autocorrelation though it may ignore physics of evapotranspiration meyer et al 2018 meyer et al 2019 reitz et al 2021 furthermore the impact of environmental factors from previous days and historical et time series should be fully considered ferreira et al 2019 fu et al 2021 adding more mechanism explanations while maintaining relatively high accuracy is the future development direction of the framework 5 conclusions considering grassland types and temporal resolutions comprehensively the framework developed in this study showed powerful generalization capability especially the site scale spatial prediction capability due to the robust model performance in spatial cross validation this guaranteed the feasibility of simulating grassland evapotranspiration at weather stations however spatial prediction was generally more difficult than data reproduction the evapotranspiration of the alpine and temperate grasslands had qualitatively similar temporal dynamic patterns but differed quantitatively as a result of distinct climate characteristics pooled data from both alpine and temperate grassland led to a more stable model than did creating separate models for each this is likely due to the broadening of the environmental envelope in the former strategy which led to the model being better able to grasp the general temporal dynamic pattern of grassland evapotranspiration the random forest model in the alpine grassland performed better than in the temperate grassland the coarsening of temporal resolution could provide performance gains especially in spatial prediction since the averaging process offset the spatial differences between sites seasonal et simulations performed better than that of daily 8 day and monthly using pooled data from all flux towers meteorological variables temperature precipitation and radiation vegetation ndvi lai and fpar and soil soil water content and soil temperature mainly contributed to the variation of grassland evapotranspiration moreover changes in the importance ranking and value of predictor variables partly explained the variations of model performance we provide a feasible framework to utilize promising weather stations and modis data not limited to grassland ecosystems and arid and semi arid regions to generate relatively reliable and rich ground quasi observation et datasets thereby compensating for the scarcity of ground observation datasets only based on flux towers declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the high end foreign experts project of china the national natural science foundation of china under grant grant nos u1803243 the team project of the chinese academy of sciences under grant grant no 2018 ydyltd 002 the data set is provided by national tibetan plateau data center http data tpdc ac cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127047 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3917,the scarcity of site scale actual evapotranspiration et measurements poses a challenge for modelling and verifying regional et taking the grassland ecosystem in arid and semi arid regions of northern china asnc as an example we proposed a framework for estimating et at weather stations without flux observations through a machine learning approach by combining data from modis and fifteen flux towers distributed in alpine grassland ag and temperate grassland tg across asnc first we analyzed the temporal characteristics of grassland et at site scale second we applied the machine learning approach random forest rf to develop a robust model for simulating site scale grassland et and used random and spatial cross validations cvs and three metrics to evaluate the rf models performance two strategies using pooled data from all flux towers for a general model and dividing data by grassland type to develop models specific to ag and tg and four temporal resolutions daily 8 day monthly and seasonal were used to develop the rf models third we investigated how the importance of predictor variables for estimating grassland et changed in different cvs strategies and temporal resolutions the et of ag and tg showed similar dynamic patterns but differed in magnitude the rf models showed good performance in both strategies and all four temporal resolutions r2 0 64 mae 0 53 mm d 1 rmse 0 72 mm d 1 however seasonal et simulations performed better than that of daily 8 day and monthly using pooled data from all flux towers especially in spatial cv meteorological variables temperature precipitation and radiation vegetation ndvi lai and fpar and soil soil water content and soil temperature were strong predictors of variation in grassland et changes in the importance ranking and value of predictor variables partly explained the variations of model performance the robust model performance in spatial cv proved that the framework developed in this study was reliable when applied to weather stations without flux observations thereby overcoming the scarcity of site scale actual et measurements keywords evapotranspiration weather stations without flux observations multiple temporal resolutions spatial cross validation machine learning grasslands 1 introduction evapotranspiration et is a crucial component of the terrestrial water cycle and an important energy flux at the global scale since et returns 60 of precipitation on land back to the atmosphere by consuming more than half of the total solar energy absorbed by land surfaces mu et al 2011 oki and kanae 2006 trenberth et al 2009 the arid and semi arid regions of northern china asnc characterized by low precipitation strong radiation and intense et have been facing increasingly severe water scarcity and are very sensitive to climate change and human activities yan et al 2015 grassland an important land cover type in this area is often heavily impacted by human activities such as grazing therefore precisely estimating grassland et in asnc is valuable for evaluating the impact of climate change and human activities on the water cycle flux towers produce reliable measurements of water and energy fluxes at a high temporal resolution and at an ecosystem level and have become a key tool for generating observational datasets for land surface process model validation and benchmarking in particular large scale measurement networks using the eddy covariance ec method e g fluxnet ameriflux and chinaflux have made it practicable to model et from site level to regional or global scales boden et al 2013 pastorello et al 2020 yu et al 2006 however observational constraints e g low number of flux towers discontinuous observation data limit validation of et estimation at large scales especially in arid and semi arid regions weather stations have the potential to provide richer derived et datasets to overcome site scale observational constraints limited by complicated assumptions and model parametrizations process based biogeochemical models face challenges in the accuracy of their et estimations over heterogeneous landscapes li et al 2018 sandor et al 2016 data driven machine learning techniques are a promising alternative approach for estimating land surface to atmosphere fluxes at local to global scales jung et al 2009 papale and valentini 2003 tramontana et al 2015 yang et al 2007 yang et al 2006 due to their ability to combine field measurements with satellite imagery and the possibility of future improvement with expanding field infrastructure data management networks e g fluxnet and remote sensing imagery tramontana et al 2016 zhou et al 2019 although data driven models can capture highly nonlinear relationships to explanatory variables cutler et al 2007 various sources of uncertainty exist for example model inputs including the availability of flux data and the selection of temporal resolutions fang et al 2020 jung et al 2011 tramontana et al 2015 tramontana et al 2016 grasslands in asnc are mainly split into two alpine grassland ag on the tibetan plateau and temperate grassland tg in the north grasslands in these areas play important roles in climate change mitigation and food and livestock production liu et al 2018 previous studies have analyzed the different limiting environmental factors and feedbacks to climate change for each grassland types hu et al 2008 liu et al 2018 yang et al 2019 however comparative studies of land surface atmosphere fluxes between the two grassland types have mainly focused on the carbon flux feng et al 2018 fu et al 2009 ge et al 2018 guo et al 2015 zhang et al 2019 and there is a lack of comparative studies of water fluxes particularly across multiple time scales moreover tg in previous studies often did not include grassland data in xinjiang china it also remains unclear whether et models perform better for either ag or tg and whether the modelling should integrate them previous studies have been mainly based on daily or 8 day temporal resolution datasets to simulate et fang et al 2020 granata et al 2020 guevara escobar 2021 reitz et al 2021 tramontana 2016 zhou et al 2019 but datasets with fixed temporal resolution may not be suitable for all et simulation tasks given the possible mismatch between the scale of the data and the scale of the problem being investigated choosing the appropriate temporal resolution of the input data is essential to reduce simulation bias and improve simulation accuracy from this perspective a comparative study of different temporal resolutions is necessary and can improve the model generalization ability for future data cross validation cv is recognized as an effective approach to assess the reliability of data driven models and avoid overfitting breiman 2001 random cv i e randomly allocating data to the training and test set provides the model performance in reproducing training data reflecting the ability to simulate known location information and fill discontinuous data but the resulting model is usually required to predict beyond the known locations meyer et al 2019 spatial cv i e excluding entire locations from model training and testing the model on them can reveal the spatial prediction ability of the model only the robust model performance in spatial cv can prove that the model has a strong potential to be extended to unknown weather stations to compensate for the shortage of ground observation et datasets several methods for spatial cv have been proposed brenning et al 2005 le rest et al 2014 meyer et al 2018 pohjankukka et al 2017 roberts et al 2017 valavi et al 2019 process based models and linear analysis have been used to evaluate the biophysical drivers of et and it has been found that land cover change meteorological factors soil and vegetation information affect et variation ge et al 2011 mao et al 2015 sterling et al 2013 stoy et al 2006 teuling 2009 xiao et al 2013 however it is still necessary to quantitatively assess the importance of environmental drivers of et especially in different cvs grassland types and temporal resolutions furthermore a better understanding of how and when the relative importance of predictor variables shifts is also critical for improving the accuracy of et simulations in order to develop a framework for estimating actual et at weather stations without flux observations to overcome the scarcity of site scale ground observation et datasets taking the grassland ecosystem in the asnc as example the objectives of this paper are to 1 analyze the temporal characteristics of site scale grassland et based on flux towers in terms of grassland types and time scales 2 develop a robust machine learning model for simulating site scale grassland et in asnc with two strategies using the pooled data from all flux towers to develop general models and dividing data into ag and tg groups to develop models specific for each group and four temporal resolutions daily 8 day monthly and seasonal focusing on the model performance in spatial cv and 3 investigate how the importance of predictor variables changes in different cvs strategies and temporal resolutions 2 material and methods 2 1 study sites fifteen flux towers associated with different grassland types and elevations within asnc were used in this study fig 1 the sites are split into three areas all ag sites 1 6 10 12 and 13 are located in the northeastern tibetan plateau the tibetan plateau is mainly covered by ag at an average altitude of 4000 m above the sea level with high solar radiation the climate is cold with annual temperature ranging from 15 to 5 c liu et al 2018 shen et al 2015 yang et al 2019 four tg sites 7 9 and 11 are situated in the eastern and central parts of the inner mongolia with an average elevation of approximately 1200 m sites 14 15 are located on the grasslands of xinjiang which are dominated by mountain meadows and mountain steppes 2 2 data 2 2 1 data from study sites the ground observations were obtained from the fifteen study sites the observations included maximum air temperature tmax minimum air temperature tmin mean air temperature tmean precipitation prcp relative humidity rh wind speed ws downward shortwave radiation swi net radiation rn soil water content swc topsoil temperature tsoil sensible heat flux h soil heat flux g latent heat flux le these data have been post processed and quality controlled in previous studies table 1 in this study they were further gap filled with the reddyproc package filling of gaps was conducted with three methods including look up tables lut with swi only mean diurnal course mdc with no meteorological information available or marginal distribution sampling mds with swi vpd and tair which are suitable for different meteorological information availability falge et al 2001 moffat et al 2007 reichstein et al 2005 wutzler et al 2018 then the hourly half hourly or 10 minute data were aggregated to daily values and screened according to multiple quality criteria 1 data were excluded when 20 of the data were based on gap filling with low confidence reichstein et al 2005 tramontana et al 2016 2 clearly erroneous periods were identified and deleted based on visual interpretation tramontana et al 2016 daily data products of sites 11 14 could be directly obtained so no post processing was required et was calculated by dividing latent heat flux le the energy equivalent of et by the latent heat of vaporization of water anapalli et al 2018 additionally we calculated daily energy balance closure ebc of sites 1 14 to assess their reliability of the eddy covariance measurements wilson et al 2002 and then excluded site 3 due to its low ebc level finally we averaged the daily data according to the same criteria 1 and 2 to obtain 8 day monthly and seasonal temporal resolution datasets 2 2 2 remote sensing data data collected from the moderate resolution imaging spectroradiometer modis can provide a relatively high spatial resolution justice et al 2002 and allow the use of an average of 3 3 km pixels centered on each site to reduce the effect of geolocation error xiao et al 2008 the modis products in this study included daily surface reflectance mod09ga 006 and 4 day leaf area index lai and fraction of photosynthetically active radiation fpar mcd15a3h 006 the daily surface reflectance data were processed to calculate the normalized difference vegetation index ndvi huete et al 2002 and normalized difference water index ndwi gao 1996 the extracted subsets for the study sites were quality controlled with quality flags included in the modis products to ensure that they reflect the real ground conditions the above operations were completed through the google earth engine gee platform https earthengine google com finally the daily vegetation data were created using a linear interpolation method fang et al 2020 reitz et al 2021 and were averaged to obtain 8 day monthly and seasonal temporal resolution datasets in addition the harmonized world soil database hwsd provided static soil information for the study sites including topsoil bulk density bd topsoil texture t topsoil organic carbon oc topsoil clay fraction clay topsoil sand fraction sand and topsoil silt fraction silt http www fao org soils portal soil survey soil maps and databases harmonized world soil database v12 en 2 3 random forest model the random forest rf algorithm as a classical machine learning technique is characterized by its ability to ignore noise and overfitting breiman 2001 and its ability to rank the importance of input variables leroux et al 2017 meng et al 2021 wang et al 2018 it has been extensively applied in ecological classification and regression tasks meyer et al 2018 meyer et al 2019 reitz et al 2021 rodriguez galiano et al 2012 zhou et al 2019 rf was selected to develop the stable et models and quantitatively assess the importance of their predictor variables in this study rf is an ensemble of many binary decision trees built from random samples of training data each tree is an independent model of the ensemble that generates a prediction for a new sample at each split node in the binary decision tree the training data are divided into the two most homogenous subgroups by setting a threshold of a randomly selected explanatory variable a random number of explanatory variables mtry selected at each split node is used to overcome correlation between trees kuhn and johnson 2013 the leaf nodes stop splitting the data into two subgroups and contain predictions of the target variable the prediction of a new sample is the mean of the target variable of all elements in the corresponding subgroup the final prediction is given by averaging the predictions of all trees rf was implemented with the caret package in r and simulated et using a regression approach we mainly focused on the two parameters i e the number of trees and mtry used to build rf models 500 trees were used as no performance gains were observed with a higher number of trees mtry was synchronously tuned between two and the number of predictor variables according to the optimal model performance see supplement table s1 for details we selected 21 predictor variables including tmax tmin tmean prcp rh ws swi rn ndvi ndwi lai fpar swc tsoil bd t oc clay sand silt and dem to train and test rf models in this study see table 2 for details they can provide comprehensive information about meteorology vegetation and soil to explain the site scale grassland et variation hao et al 2007 liu et al 2018 sun et al 2019 wu et al 2019 zhang et al 2018 to better fit our research objectives we involved all 21 predictors in the construction process of rf models 2 3 1 experimental design two cross validation cv methods were applied in this study a random k fold cv and a spatial k fold cv to evaluate the data reproduction and spatial prediction abilities of the et model respectively each method first splits the data into k folds and then repeatedly trains the models k times using all the data except one fold the performance of models is evaluated by testing the left out data fig 2 the major difference between random and spatial cvs is how the data points are split into folds fig 2 random cv randomly assigns each data point to one of the k folds for the spatial cv data points belonging to the same study site were assigned to the same fold so k is equal to the number of sites the model performance in spatial cv should receive more attention because it could provide inferences into how the model will perform in unsampled sites random cv was performed with the same number for k to develop a robust rf model two strategies and four temporal resolutions were adopted the two strategies are to i use pooled data from both alpine and temperate grasslands to train and test the model and ii divide data into two groups alpine and temperate grasslands and train and test models in each group the four temporal resolutions are daily 8 day monthly and seasonal 2 3 2 model evaluation the coefficient of determination r2 the mean absolute error mae and the root mean square error rmse were used as metrics to evaluate model performance they were calculated by the following equations 1 r 2 1 i 1 n y i f i i 1 n y i y 2 mae i 1 n f i y i n 3 rmse i 1 n y i f i n where n is the total number of observed data y i is the observed value for data point i y is the mean of the observed data and f i is the predicted value for data point i 2 3 3 variable importance gini importance for classification and the average impurity reduction for regression are very popular variable importance metrics for random forests grömping 2009 however impurity s bias for selecting split variables also leads to biased variable importance metrics shih and tsai 2004 strobl et al 2007 permutation importance indices have been widely adopted by various authors díaz uriarte and de andres 2006 ishwaran 2007 strobl et al 2008 due to their reliability see grömping 2009 for more detailed description on random forest permutation importance in general therefore we calculated the relative importance of predictor variables by the permutation based internal variable importance metric the relative increase of the mean squared error mse of random forest implemented in the caret package error magnitude is assumed to increase if the variable is important for the sake of comparison importance metrics of all predictor variables in this study have been normalized to sum to 1 3 results 3 1 temporal characteristics of grassland et the temporal dynamics of et in the ag and tg had similar patterns fig 3 in three ways first before 8 00 am the half hourly et was small for both types of grassland even negative due to condensation negative half hourly et mainly occurred at night 18 00 pm to 8 00 am in spring and winter after 8 00 am the half hourly et first rose reached its maximum around 14 00 pm and then gradually decreased the period of high et values in a day varied as the season changed second the daily et showed a trend of rising first and then falling reaching a peak around the 190th day third the trend of monthly and seasonal et was the same as that of daily et july and summer june to august were the month and season with the strongest et respectively the differences in the quantitative characteristics of et between the ag and tg were obvious fig 4 the mean and median values of the tg were smaller and the interquartile range of tg was narrower than of the ag the negative half hourly et values occurred more frequently at night in the tg and the fingerprint diagram of the tg had fewer layers and more blurred boundaries fig 3b the daily monthly and seasonal et values of the tg were lower than of the ag fig 3d 3e the biggest and smallest difference between the ag and tg appeared in summer and winter respectively the annual average et of the ag and tg were 533 62 mm and 341 28 mm 3 2 performance of the random forest model the performance of the rf model was stable and reliable according to both cv approaches r2 0 64 mae 0 53 mm d 1 rmse 0 72 mm d 1 the performance of spatial cv was mostly worse than that of random cv indicating that spatial prediction was more difficult than data reproduction daily temporal resolutions mostly exhibited the largest difference between the two cv methods furthermore the difference between the two cv methods of strategy 1 was mostly less than or equal to that of strategy 2 suggesting that strategy 1 had the stronger generalization ability the model performance in strategy 1 was stable and very close to the optimum in strategy 2 the tg model performed worst except in seasonal temporal resolution r2 mae and rmse coincided well with each other table 3 in spatial cv the model at the lower temporal resolution showed the higher et simulation accuracy and seasonal temporal resolution showed better model performance than daily 8 day and monthly temporal resolutions r2 0 86 mae 0 39 mm d 1 rmse 0 47 mm d 1 the averaging process of coarse temporal resolutions might reduce the spatial differences among sites and thereby improving the model performance in spatial prediction the tg model showed the greatest performance improvement in spatial cv r2 from 0 71 to 0 88 as the temporal resolution decreased the rf model s reliable spatial prediction ability was further validated fig 5 data from site 15 that is a bowen ratio tower were excluded from the model construction in order to be used as an additional test set for the model the et variations including temporal trends and numerical magnitudes were well captured at all temporal resolutions r2 range 0 58 to 0 9 mae range 0 22 to 0 5 mm d 1 rmse range 0 28 to 0 73 mm d 1 the model performance using strategy 1 was better than strategy 2 except at the monthly temporal resolution seasonal temporal resolution has not showed better model performance than daily 8 day and monthly temporal resolutions since its sample size was too small to provide an accurate diagnosis on the model performance and some relatively poor model performance was due to the inherent systematic differences between eddy covariance ec and bowen ratio energy balance breb observations rather than inaccurate predictions 3 3 variable importance according to the permutation importance measure the predictor variables with a high contribution to the rf model were tmax tmin tmean prcp swi rn ndvi lai fpar swc and tsoil while the contribution of ws ndwi and static soil properties bd t oc clay sand and silt was low with values close to 0 in all cases figs 6 7 rn was the most important driving factor for grassland et since it determines the energy available for le the energy equivalent of et zhang et al 2018 the random and spatial cvs which reflect the data reproduction and spatial prediction abilities of the model respectively did not change the composition of predictors with a high contribution to the model however the variation pattern of each predictor and the ranking of all predictors changed in different grassland types and temporal resolutions strategy 1 fig 6c 7c could capture predictors importance variations in strategy 2 fig 6a 6b fig 7a 7b since its importance variation pattern of predictors was similar to either ag or tg within strategy 2 the ag fig 6a 7a and tg fig 6b 7b within strategy 2 showed slightly different patterns of predictors importance tsoil and swc were the unique and important driving factors ranking the top 25 see supplement figure s1 s2 for details of the ag and tg respectively the difference in predictors importance between ag and tg is due to the response of water flux to distinct energy and moisture conditions the ag at high altitude is more restricted by thermal conditions while moisture is the main limiting factor for the tg with less precipitation guo et al 2015 liu et al 2018 zhang et al 2019 the predictors importance varied in different temporal resolutions resulting from the time effect of biophysical factors on grassland et for example prcp exhibited an increasing trend from daily to seasonal temporal resolution probably due to the lag time response of grassland et to it changes in the importance ranking and value of predictor variables might to some extent explain variations of the model performance in different cvs grassland types and temporal resolutions for example the dramatic changes in the magnitude and ranking of predictors importance at the monthly temporal resolution might explain the great difference of the tg model performance between random and spatial cvs fig 6b 7b table 3 r2 0 64 to 0 75 4 discussion 4 1 the influence of grassland types and temporal resolutions and its uncertainty the ag model performed better than the tg model within strategy 2 and strategy 1 provided more stable model performance than strategy 2 the ag provides a wider range of et values than the tg fig 4 which is conducive to et estimation under extreme conditions due to the inherent characteristics of the rf algorithm compared with strategy 2 strategy 1 used pooled data from all types of flux sites covering a relatively wide range of et values and is suitable for the scenario where the increasing number of flux sites across the globe participate in large scale measurement networks the et model outperformed at lower temporal resolution table 3 kazemi et al 2020 found that monthly patterns compared to the complete patterns of one growing season as test size provided higher error magnitude estimates tramontana et al 2016 showed very similar model performance when using daily or 8 day temporal resolution datasets but the two temporal resolutions were composed of different data sources our results compensated for the lack of a complete scan of different temporal resoultions and provided ideas for dertermining the appropriate temporal resolution to simulate et furthermore the time related information of the explanatory variables may have been integrated into a coarser temporal resolution but their specific lag effects are still worth noting espeically the previous precipitaion and soil moisture ferreira et al 2019 there might be interactions between cv methods strategies and temporal resolutions in this study for example most of the model performance difference between the two cv methods was smaller in strategy 1 and the coarser temporal resolution such combination as pooled data and coarser temporal resolutions was critical for constructing a robust model with both data reproduction and spatial prediction capabilities previous studies have also investigated the effects of different combinations of datasets input variables simulating methods on the model performance ferreira et al 2019 granata et al 2020 reitz et al 2021 tramontana et al 2016 zhang et al 2020 combinations based on specific research objectives are limited however a unified standard combination suitable for most research needs remains a big issue and requires more discussions and experiments in future research 4 2 limitations of the biophysical drivers used to estimate grassland et although this study did not cover all biophysical drivers of grassland et all available candidate predictors across all sites were fully considered in order to maintain the consistence across temporal resolutions and grassland types we may have introduced redundant variables into models which is disadvantageous to the further enhancement of the spatial prediction capabilities elevation often creates spatial autocorrelation and previous studies removed it through feature selection to improve the simulation accuracy at the regional scale meyer et al 2019 reitz et al 2021 however due to the important influence of elevation on the climate of the ag and the site scale simulation characteristics we included elevation as a predictor of grassland et to construct rf models in this study table 2 the absence of important drivers in the predictor sets might explain why the tg model did not perform as well as the ag model several studies have shown that lagged predictor variables and the predictor selection could improve model performance for et ferreira et al 2019 kim et al 2013 meyer et al 2018 meyer et al 2019 reitz et al 2021 which makes higher demands for continuous observational data and the availability of predictor variables at the sites the continuous observation of site data and the acquisition of multiple biophysical variables are still the basis and key for future et simulation research 4 3 the prospect of this framework taking the grassland ecosystem as an example we have developed a practical framework to estimate actual evapotranspiration at weather stations without flux observations by combining data from modis and flux towers through a machine learning approach while considering grassland types and temporal resolutions comprehensively the robust performance in spatial cv indicated that this framework can perform site scale spatial prediction the generated quasi observation data set will facilitate the development and upgrading of evapotranspiration products at all scales the gridded reanalysis data used as inputs of upscaling models often involve the huge uncertainties which affects the acquisition of the spatial pattern and dynamic variations of et fang et al 2020 jung 2011 reitz et al 2021 tramontana et al 2015 the framework proposed in this study can provide a promising solution to the above problem the site scale quasi observation data set generated by inputting only observation data from stations and remote sensing into models do not contain the uncertainties from the gridded reanalysis data and can be used to better evaluate the upscaled et products and even assimilate them to obtain more accurate spatial estimation the generalization and interpretability of the framework need to be further improved zhao et al 2019 developed a hybrid model combining physical constraints and machine learning to estimate latent heat flux le which provides us with a very promising optimization scheme incorporating physical constraints such as penman monteith and priestley taylor equations into our framework will help predict et under extreme conditions and bayesian network bn shi et al 2020 has more advantages in analyzing causal relationships between environmental variables by combining expert knowledge and flux observations it may provide us with a more reasonable mechanism explanation inside the actual evapotranspiration simulation how to consider special environmental variables and their unique coupling relationships with others in prior knowledge is the key predictor selection based on spatial cv is necessary to reduce autocorrelation though it may ignore physics of evapotranspiration meyer et al 2018 meyer et al 2019 reitz et al 2021 furthermore the impact of environmental factors from previous days and historical et time series should be fully considered ferreira et al 2019 fu et al 2021 adding more mechanism explanations while maintaining relatively high accuracy is the future development direction of the framework 5 conclusions considering grassland types and temporal resolutions comprehensively the framework developed in this study showed powerful generalization capability especially the site scale spatial prediction capability due to the robust model performance in spatial cross validation this guaranteed the feasibility of simulating grassland evapotranspiration at weather stations however spatial prediction was generally more difficult than data reproduction the evapotranspiration of the alpine and temperate grasslands had qualitatively similar temporal dynamic patterns but differed quantitatively as a result of distinct climate characteristics pooled data from both alpine and temperate grassland led to a more stable model than did creating separate models for each this is likely due to the broadening of the environmental envelope in the former strategy which led to the model being better able to grasp the general temporal dynamic pattern of grassland evapotranspiration the random forest model in the alpine grassland performed better than in the temperate grassland the coarsening of temporal resolution could provide performance gains especially in spatial prediction since the averaging process offset the spatial differences between sites seasonal et simulations performed better than that of daily 8 day and monthly using pooled data from all flux towers meteorological variables temperature precipitation and radiation vegetation ndvi lai and fpar and soil soil water content and soil temperature mainly contributed to the variation of grassland evapotranspiration moreover changes in the importance ranking and value of predictor variables partly explained the variations of model performance we provide a feasible framework to utilize promising weather stations and modis data not limited to grassland ecosystems and arid and semi arid regions to generate relatively reliable and rich ground quasi observation et datasets thereby compensating for the scarcity of ground observation datasets only based on flux towers declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the high end foreign experts project of china the national natural science foundation of china under grant grant nos u1803243 the team project of the chinese academy of sciences under grant grant no 2018 ydyltd 002 the data set is provided by national tibetan plateau data center http data tpdc ac cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127047 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3918,classification is a first line tool for understanding the main characteristics of a natural system s response we propose a new classification of karst systems hydrological functioning that is based on spring discharge time series and takes profit of spring discharge databases to encompass the high diversity of karst hydrological functioning it discriminates six different classes based on three relevant indicators of karst hydrological functioning a core dataset made of 10 karst systems was first considered for the set up of the classification the spring discharge time series were investigated according to recession curves statistical and signal analyses to identify relevant indicators of hydrological functioning the selection of the most relevant indicators and the proposal of the classification were based on multivariate analyses the classification was then tested on spring discharge time series of 78 karst systems located worldwide all the systems homogeneously spread among the six proposed classes which highlights the relevance of the approach and the representativeness of the various classes of hydrological functioning results from the proposed methodology were finally discussed to explore its limitations and define guidelines for its application abbreviations sno karst service national d observation du karst pnrgc parc naturel régional des grands causses dreal direction régionale de l environnement de l agriculture et du logement wokas world karst spring hydrograph cv coefficient of variation svc spring variability coefficient qs specific discharge mrc master recession curve me memory effect rt regulation time sbb spectral band breadth nse nash sutcliffe efficiency pca principal component analysis pc1 pc3 first to third principal component kmax maximum k value over all the recession analysed αmean mean α value over all the recession analysed ir i range corresponding to imax imin c1 c6 class 1 to 6 fl full length y1 y6 year 1 to 6 keywords karst hydrological functioning classification typology time series analysis multivariate analyses 1 introduction 10 of the world s population is dependent on karst water resources for drinking water stevanović 2018 karst systems are underground entities that drain recharge water over a catchment towards a main outlet the water is drained through conduits fractures and matrix which originate from the dissolution of the calcite deposits by acidic water from the surface understanding the functioning of these complex and heterogeneous systems is therefore a major challenge for long term water resource management over the past century different methods have been developed to analyse hydrological time series and subsequently characterize the functioning of karst systems these methods can be considered as a preliminary step in the development and design of hydrological models of karst functioning for sustainable water resource management classification has been widely used in surface hydrology to characterize hydrosystems although the three dimensional properties of aquifers generate an additional complexity some authors proposed different methodologies to classify them based on geological morphological and hydrological functioning analyses heath 1982 dahl et al 2007 heudorfer et al 2019 in many cases however these classifications fail to address the complexity of karst systems which are strongly heterogeneous and correspond to a wide diversity of hydrological functioning for these reasons many authors worked on classifications specific to karst systems either based on geological and morphological analyses mylroie 1984 waltham and fookes 2003 jouves et al 2017 veress 2020 hydrological response analyses mangin 1975 mangin 1984 soulios 1991 bonacci 1993 kullman 2000 flora 2004 springer et al 2008 rashed 2012 malík and vojtková 2012 or even karst groundwater microbiological analyses sinreich et al 2013 the spring discharge of a karst system is considered as a base information in karst hydrogeology it results from the combination of flows from the different compartments of the hydrosystem soil epikarst unsaturated and saturated zones the widely increased development of karst spring discharge monitoring offers the opportunity to study the relations between discharge and hydrological functioning in depth some authors proposed classifications of karst systems based on the analysis of spring discharge time series either with visual interpretations soulios 1991 bonacci 1993 by calculating indicators of functioning mangin 1975 mangin 1984 flora 2004 springer et al 2008 rashed 2012 or by interpreting the parameters of recession models mangin 1975 kullman 2000 malík and vojtková 2012 however the aforementioned classifications have been developed by analysing only few karst systems or without considering the high diversity of karst hydrological functioning therefore diversity in karst systems physical properties and hydrological functioning is not fully considered which impairs the relevance of these classifications and raises the need for a more generic approach this work aims to provide a new classification of karst systems hydrological functioning with the following key features i a clear methodological basis ii the analysis of a wide diversity of karst systems representative of contrasted hydrodynamics behaviours iii an approach being relevant worldwide and in a scarce data context i e sites where there is little knowledge of the system or only discharge monitoring for a few years in this paper we took advantage of the recent release of spring discharge time series in databases such as the french sno karst jourde et al 2018 or the wokas database olarinoye et al 2020 to propose a new classification of karst systems hydrological functioning the typology describes a system where one single hydrodynamic response to precipitation impulse is expected the aim of the classification is to characterize the hydrological functioning of a system but not to decorrelate the factors that influence the functioning the paper is organized as follows in section 2 we define the general characteristics of the karst systems considered in this study section 3 presents the various tools and analyses considered for the characterization of karst systems hydrological functioning the most relevant indicators of karst hydrodynamics are identified and presented in section 4 using the discharge time series of 10 well known karst systems that cover a wide range of hydrological functioning section 5 is devoted to multivariate analyses that are considered for the proposal of the new classification described in section 6 the discussion in section 7 aims to evaluate the relevance of the proposed approach applied to 78 karst systems and to highlight some of its limitations section 8 gives the conclusions 2 general characteristics of the karst systems considered in this study this section presents the data we used to develop and test the classification which involve in two different datasets i a core dataset for the assessment of the most relevant indicators of functioning and the design of the classification and ii a complementary dataset for assessing the most efficient recession model testing the classification and identifying its strength and limitations 2 1 core dataset to ensure the quality of the study and its relevance to the problem we performed spring selection on the basis of three criteria i quality of the hydrodynamic monitoring which is function of time step instrumentation measurement uncertainty and length of the time series ii diversity of the hydrological functioning among the karst systems meaning that the final dataset should cover a wide range of hydrological functioning e g related to dimensions of the catchment rainfall degree of karstification hydrological functioning etc and iii existing knowledge from prior studies to ensure that the classification is consistent with the actual knowledge on system functioning we selected 10 karst systems table 1 located in france we retrieved data from several organizations the french karst national observatory service sno karst the parc naturel régional des grands causses pnrgc suez and the dreal of bourgogne franche comté selected systems have been the subject of several comprehensive studies based of methods such as geology cartography field observations tracing geochemistry time series analysis and modelling 2 2 complementary dataset in order to check the relevance of the method and its capacity to differentiate karst systems functioning the classification resulting from the analysis of the aforementioned well known karst systems was tested on a complementary dataset of 68 karst systems with different characteristics e g dimensions of the catchment meteorological regime climate and karstification degree we worked with springs discharge time series of 23 french karst systems coming from a database provided by the french state banque hydro and took the other 45 from the wokas world karst spring hydrograph database which provides details of over 400 karst systems worldwide olarinoye et al 2020 the quality of these 68 springs discharge time series is appreciated according to low c2 to very good a quality discharge data fig 1 c as proposed in olarinoye et al 2020 the dataset is fairly well distributed throughout the world with karst springs discharge from 17 countries fig 1b the considered karst systems are located in various climatic conditions according to köppen geiger classification peel et al 2007 these climatic conditions correspond to 12 different climates the temperate oceanic cfb being the most represented 63 2 fig 1a 3 presentation of the selected discharge time series analysis methods for the characterization of karst systems functioning the discharge is directly related to the recharge and the emptying of the capacitive function of a system but also depend on the system geometry and hydrodynamic properties malík 2015 this section provides details about four methods for analysing discharge time series and the indicators that can be retrieved from these methods to characterize the functioning of a karst system 3 1 statistical analyses statistical indicators of discharge time series provide basic information about the overall functioning of a system the most common are the mean minimum maximum standard deviation and the various quantiles the mean interannual discharge depends on both the dimensions of the catchment and the mean recharge it can therefore be used to assess the dimensions of a system the observed minimum and maximum discharges make it possible to understand the flow amplitude however significant uncertainty related to the extrapolation of extreme discharges at springs is associated with this indicator the comparison between various karst systems is facilitated when using nondimensionalized indicators such as the coefficient of variation cv which is the ratio between the standard deviation and the mean of the discharge time series netopil 1971 proposed the calculation of a characteristic discharge which is the ratio between the 0 9 quantile discharge value that is exceeded 10 of the time and the 0 1 quantile this characteristic discharge was referred to as spring variability coefficient svc in stevanović 2015 the svc is less affected by extreme values the specific discharge qs corresponds to the ratio between the mean interannual discharge and the catchment area it allows assessing karst hydrodynamics with an implicit consideration of the dimensions of the catchment however the area information is not always available and also depends on the quality of hydrogeological studies over the catchment of interest 3 2 recession curves analysis the hydrograph of a flood recession corresponds to the period when the discharge gradually decreases as water is not replenished toebes and strang 1964 it is possible to distinguish two regimes i the influenced quickflow regime which corresponds to the period when the discharge is influenced by the rapid infiltration of water into conduits in the unsaturated zone and ii the non influenced baseflow regime which begins when rapid infiltration ends and corresponds to the draining of the saturated zone and less transmissive compartments of the system mangin 1975 in the literature analysis of recession curves is mainly used to estimate groundwater reserves drogue 1972 forkasiewicz and paloc 1967 mangin 1975 determine the hydrodynamic parameters of the aquifer mangin 1975 and provide information on flows drainage and karstification degree drogue 1972 mangin 1975 kullman 2000 malik 2006 krešić 2007 malík and vojtková 2012 the karstification degree is an indicator of the karst maturity of a system which is directly related to groundwater recharge storage capacity spring discharge dynamics and system connectivity numerous models for the analysis of recession curves of discharge time series have been proposed table 2 boussinesq 1877 and maillet 1905 made the first proposals horton 1933 and barnes 1939 then developed recession models based on maillet s equation coutagne 1948 proposed an equation that simulates the discharge from a reservoir padilla et al 1994 highlighted that coutagne s equation struggles to reproduce the recession curves of karst systems and thus introduced a new parameter qc this later parameter corresponds either to the discharge from poorly transmissive zones of the aquifer or to the discharge from aquitards outside the karst system it may also have no physical meaning drogue 1972 proposed to approach the whole recession curve with a hyperbolic function mangin 1975 developed a two equation recession model representative of the influenced and non influenced regimes kullman 2000 approached recession curves by fitting a model based on a linear equation kullman 1983 for influenced regime and maillet s equation for non influenced regime based on kullman work malík and vojtková 2012 proposed a classification of karst systems functioning according to the number of equations required to model the recession and the values of the parameters other authors samani and ebrahimi 1996 griffiths and clausen 1997 ladouche et al 2006 proposed models inspired by the aforementioned models we did not consider physical based models as we do not have any information on reservoir geometry further details about empirical physical based models and recession curve analysis can be found in fiorillo 2014 in this study we wanted to assess the variability of the hydrological response of the karst systems which is only possible when accounting for different recession periods for this reason we dismissed the use of a master recession curve mrc which aims to overcome the problem of recession variation by combining several recession curves into one and only the mangin s model has been widely used to characterize karst systems mainly because the author proposed a classification based on two indicators derived from the parameters of the model equation the parameter α is assumed to characterize the draining of the capacitive function of the karst system which corresponds in most cases to flow from the saturated zone in case of a low karstification degree α can be affected by flows occurring in the unsaturated zone which may induce a lag in the response in the non influenced regime mudarra and andreo 2011 the indicator k is strongly linked to the α recession coefficient of the first component of the mangin model table 2 which is applied only on the non influenced regime the indicator k is thus focused on the slow depletion of the aquifer and assumed to characterize the ability of a system to store and return recharge water it is calculated with the following equation k v dyn v an with vdyn the dynamic volume and van the interannual mean yearly volume of water discharged at the spring the dynamic volume is calculated by integrating the exponential function v dyn 0 q i e α t d t q i α with qi the discharge at the time ti ti being the time at which the flow is considered to be laminar and also the beginning of the non influenced regime and α the recession coefficient in his work mangin 1975 suggested to characterize the capacity of dynamic storage with the maximum calculated vdyn as it tends towards a stable value for a large number of analysed recession curves the indicator i is used to characterize the capacity of a system to filter and attenuate the precipitation signal it corresponds to the discharge attributed to the influenced regime second component of the mangin model table 2 two days after the flood peak this discharge is expressed in relative proportion to the influenced discharge q0 and is calculated with the following equation i 1 2 η 1 2 ε with η a constant characterizing the speed of infiltration η 1 ti with ti being the duration of the influenced stage and ε a constant characterizing the concavity of the recession curve during the influenced stage the classification initially proposed by kullman 2000 and updated by malík and vojtková 2012 differentiate systems by their karstification degree the methodology consists to reproduce a recession curve by fitting one to several equations either exponential or linear and calibrate the α and β parameters of each formula the karstification degree is then deduced from a table based on the presence of different flow sub regimes i e the number and nature of the equations and the value of the α and β parameters it ranges from 0 5 to 10 and is associated with a description of assumed structure of the system and karst groundwater circulation 3 3 correlational and spectral analyses correlational and spectral analyses are time series analyses that are used to study the frequency content of a signal referred to as simple analysis and relations between signals referred to as cross analyses massei et al 2006 the simple analysis consists of calculating the autocorrelation function of a signal and the corresponding spectrum obtained using a fourier transformation the calculations are detailed in appendix a the principle is to compare the signal with itself over an increasing time interval or shift jeannin and sauter 1998 the cross analyses examine the transformation of the input signal into an output signal padilla and pulido bosch 1995 signal analyses mainly developed by jenkins and watts 1968 hannan 2008 brillinger 1975 and box and jenkins 1976 were first applied to karst hydrology by mangin 1984 according to mangin 1984 a karst system can be characterized by its response time to a unitary impulse precipitation and its inertia which depends on both the volume of groundwater reserves and karstification degree of the karst system simple correlational and spectral analyses allow determining three indicators of karst hydrological functioning i the memory effect me which is the shift k for an autocorrelation coefficient rk of 0 2 it translates variation in discharge over time and is directly related to the inertia of the karst system marsaud 1997 ii the regulation time rt which is the inverse of the bandwidth i e the maximum ordinate of the spectrum divided by 2 value of the integral of the function between 0 and it provides information on the duration of the influence of a unitary impulse larocque et al 1998 kovács 2003 on the volume of groundwater reserves marsaud 1997 and makes it possible to assess the overall organization of flows in the system e g conduits fractures and cracks jeannin and sauter 1998 iii the cut off frequency or spectral band breadth sbb which corresponds to the frequency f at which the value of the spectrum sf becomes negligible beyond this frequency the spectrum is equal to zero and can be assimilated to noise jeannin and sauter 1998 the cut off frequency provides information on the ability of the system to filter unitary pulses marsaud 1997 the results provide a general idea of how a karst system works with an emphasis on the inertia of the system and its capacity to attenuate the recharge signal 3 4 analysis of classified discharges the analysis of classified discharges provides information on flow regimes within a system based on discharge monitoring at the outlet of a karst system marsaud 1997 based on empirical observations mangin 1971 suggested that the distribution of discharges or logarithm of discharges from karst springs can be approximated by a half normal gaussian distribution the calculations are detailed in appendix b he concluded that the comparison between quantiles of measured discharges and quantiles given by the half normal distribution should follow a straight line according to this theory any discontinuities of the line corresponding to an inflexion point indicate inhomogeneity in the functioning of the system below or above a certain range of discharge such changes can occur at low or high discharges and may be positive or negative the interpretation proposed by mangin is based on an extremely strong hypothesis which is that the statistical half normal gaussian distribution properly describes the distribution of discharges from karst springs under a homogeneous functioning the method allows identifying particular events inherent in karst hydrology e g overflow at outlet leakage to another system storage and emptying phenomena time varying extent of the recharge catchment it also allows assessing the quality of the gauging station grasso and jeannin 1994 marsaud 1997 dörfliger 2010 4 analysis and selection of indicators of karst dynamics analysis of discharge time series were performed for the 10 karst systems aforementioned core dataset based on methods detailed in section 3 with the goal to select the most relevant indicators of karst systems hydrodynamics 4 1 statistical indicators the results of the statistical analyses highlight the diversity of hydrological functioning of the core systems table 3 the mean discharge allows to distinguish systems with a low discharge aliou baget fontaine de nîmes mouline and toulon with a medium discharge durzon esperelle lods and mouthe and with a large discharge fontaine de vaucluse although the mean discharge is highly correlated with the dimensions of the catchment it is also dependent of the precipitation and the hydrological functioning of the system cv and svc are highly correlated with a correlation coefficient r 0 925 p value 0 00012 both can be related to the inertia of the system and allow to differentiate reactive systems aliou baget esperelle fontaine de nîmes lods and mouthe from inertial systems durzon fontaine de vaucluse mouline and toulon there is no evident relation between qs and the characteristics of the system as the dimensions of the catchment are bypassed we suppose that qs may be related to the karstification degree or the specific recharge volume of water that goes to the aquifer by unit area as qs requires the knowledge about the area of the recharge catchment which is either unknown or with high uncertainty it is not retained as a relevant indicator for the classification 4 2 recession indicators the dynamics of a karst system can be either i at infra day time scale meaning that the system is reactive with fast variations in discharge of the order of an hour or ii at daily time scale meaning that the system has high inertia and changes in discharge can be assessed on a daily basis a comparison of results issued from recession curves analysis performed on hourly and daily time series showed that even for reactive karst systems the daily time scale provides sufficient accuracy we selected a total of 93 recession curves fig 2 from the overall time series of each system of the core dataset with no distinction between seasonal or event scale recessions on the basis of the following conditions i the peak flood discharge must be significantly high regarding the overall dynamics of the system we suggest at least one tenth of the maximum discharge of the discharge time series or greater than the interannual mean discharge however we do not exclude the eventuality of site specific thresholds ii there should be little or no disruption during the recession e g precipitation leading to untimely peaks in cases where the disruption was of short duration data could be removed and replaced with a blank and iii the recession must be complete meaning it should include both the influenced regime and the entire non influenced regime with some tolerance for high inertia systems in the specific case when karst spring behaviour is influenced by a particular hydrological functioning e g the activation of an overflow outlet that appears on the recession curve as a bending point our selection concerned only the last unaffected part of the curve including the end of the recession limb this approach ensured that the models which are not mean to fit curves with bending points other than the one between the influenced and non influenced regime were correctly calibrated information loss was relatively minor as discharges that were excluded from the analysis only represented a tiny part of the overall flow the bending point required for mangin s model mangin 1975 was defined manually and corresponds to the time t when the non influenced regime begins when flow is considered as part of the non influenced regime out of the 9 recession models presented in section 3 1 2 4 models suit the study s requirements we identified them as relevant for karst hydrodynamics analysis but also easy to automate they correspond to the models from drogue 1972 coutagne 1948 padilla et al 1994 and mangin 1975 and will be further referred as hyperbolic coutagne padilla and mangin models respectively we tested the 4 models by examining their performance in fitting all 390 observed recession curves of both core dataset and complementary dataset fig 3 and by performing a sensitivity analysis we found hyperbolic padilla and mangin models to be relatively successful in fitting the observed recession curves although padilla and hyperbolic model significantly failed nse lower than 0 on 31 and 3 recession curves respectively this illustrates that padilla and hyperbolic models are not suitable for all the karst systems the median relative error of hyperbolic padilla and mangin models are of 7 7 6 7 and 5 6 respectively with median nse of 0 986 0 989 and 0 995 coutagne model showed a poor performance with a median relative error of 38 and a median nse of 0 730 the sensitivity analyses revealed that coutagne and padilla models have equifinality issues for the parameters α and n with only qc having an optimum on the other hand the parameters of hyperbolic and mangin models have systematically an optimum we selected mangin model for the analysis of recession curves as it provides a consistent and very good fit for all the recession curves lowest nse of 0 91 with a limited equifinality moreover this model has been widely used for years and its indicators are well known by the community results show that these indicators clearly differentiate among systems of the core dataset fig 4 the analysis of i values which allow assessing the capacity of a system to filter and attenuate the precipitation signal revealed a relationship between the value of this indicator and the saturation state of the system fig 5 which corresponds to the volume of water stored in both the saturated and unsaturated zones variability in i can be a consequence of either i the volume of water already stored in the karst system when the recharge occurs i e the influence of the saturation state on the system connectivity but also ii the variability of the overall organization of flow and groundwater storage between matrix fracture and conduits in the different compartments of the system we therefore decided to take account of variability in i values or lack thereof as an additional information of karst system hydrological functioning by including a new indicator based on the variance of i as some systems have a small recession curves sample size e g toulon with only 2 fig 2 a new indicator based on the standard deviation of i may be irrelevant therefore we propose a new indicator ir based on the maximum and minimum i values observed on the recession curves sample ir i max i min with imax and imin the maximum and minimum i values observed on the recession curves sample 4 3 signal indicators the correlational and spectral analyses were performed with a sampling step of 1 day and a maximum offset m of 125 days according to the suggestions of mangin 1984 on short term and long term analyses the short term analysis can be performed on systems that have at least one continuous year of daily discharge recording as the 10 core systems are all in the same climatic context according to the köppen geiger climate classification the starting date for the discharge time series was set as the beginning of the hydrological cycle 1 september to consider the seasonality the results highlight the diversity of hydrological functioning of the core systems table 4 aliou and mouthe are very reactive systems that rapidly transfer a response proportional to the intensity and duration of unitary pulses precipitation with almost no dampening of the recharge signal because they exhibit a fast response to recharge events but are less reactive than the former baget fontaine de nîmes and lods are referred as low inertia systems durzon esperelle and mouline correspond to the category of medium inertia systems which are able to filter a greater or lesser proportion of unitary pulses and dampen the recharge signal this category encompasses a wide variety of hydrological functioning as the medium rt value may translate either i a medium inertia or ii a high variability of hydrological functioning with both high inertia and low inertia responses resulting in an average rt fontaine de vaucluse and toulon are considered as high inertia systems as they have a high filtration capacity and noticeably dampen the recharge signal 4 4 indicators issued from the analysis of classified discharge within the core dataset table 4 this analysis hints that there is no change in the hydrological functioning of 5 systems aliou baget durzon esperelle and mouline but that there might be hydraulic or flow properties changes beyond a certain discharge for 4 systems fontaine de nîmes fontaine de vaucluse lods and toulon for 4 other systems fontaine de nîmes lods mouthe and toulon there might be an overflow outlet discharge to another system or a temporary storage of water within the karst system when the discharge reaches a certain value these interpretations are confirmed in the literature for fontaine de nîmes maréchal et al 2006 fontaine de vaucluse mangin 1975 lods mouthe cholet 2017 and toulon lorette et al 2018 this analysis whose interpretation requires prior knowledge of the system or field observations to be fully relevant does not seem appropriate for the classification of karst systems the method is based on a strong hypothesis that may not be suitable for all systems although some relevant indicators of functioning can be retrieved from this analysis e g activation of an overflow outlet flow to another system the interpretation is overly influenced by i the quality of the discharge water height relationship and ii the subjective vision of the operator who is performing the analysis moreover when there is poor or no prior knowledge of the functioning of a system it is very difficult to identify the specific functioning behind a bending point on the curve e g the difference between a bending point due to the activation of an overflow outlet or due to uncertainties on ungauged discharges thus we choose to not include the indicators of functioning retrieved from this analysis in the proposed methodology for the classification of karst system hydrological functioning 5 multivariate analyses the aim of this section is to gain insights into the dataset and the relations between indicators we applied two unsupervised techniques on a dataset consisting of 9 variables and 10 observations the observations correspond to the 10 core karst systems and the variables are relevant quantitative indicators of functioning resulting from the application of the different methods of discharge time series analysis excluding the indicators resulting from the analysis of classified discharge the selected indicators are kmax imean ir αmean me rt sbb cv and svc terms max and mean correspond to respectively maximum and average values of the indicator over all the recession analysed 5 1 principal component analysis 5 1 1 principle principal component analysis pca is a multivariate method that aims to reduce the dimensions of an observation space by producing principal components which are linear combinations of initial variables of a dataset that retains the most possible variation principal components are uncorrelated with each other i e orthogonal to the previous one and are ordered according to the amount of variance explained by the combination everitt and hothorn 2011 the results of a pca can be seen as a small number of new variables that contains most of the information of a large number of initial variables the interpretation of a principal component is realized by looking at the correlation between initial variables and the component i e assessing the contribution of each variable this analysis provides information on trends in the dataset and allows identifying eventual complementarity between initial variables 5 1 2 results the results of the pca are presented as a biplot of the first factorial plane fig 6 which explains 87 9 of the total variance of the dataset the first principal component pc1 is strongly correlated with all indicators except ir i kmax informs about the capacity of dynamic storage ii imean me rt and sbb are related to the capacity to attenuate the precipitation signal iii αmean characterizes the draining dynamic of the capacitive function and iv cv and svc are about flow dynamics together these indicators can be seen as characterizing the inertia of a system which would correspond to the first principal component pc1 73 4 of variance explained the second principal component pc2 14 5 of variance explained is mainly correlated with ir and thus would reflect the variability of the hydrological response of a system the third principal component pc3 5 8 of variance explained is most correlated with αmean which characterizes the draining dynamic of the capacitive function of a system it is worth mentioning that the high correlation between several input parameters e g cv and svc may have a substantial effect on the pca results particularly on the variance explained by the principal components i e pc2 and pc3 could have had a higher variance by overemphasizing the contribution of redundant indicators systems from the core dataset are mostly scattered along pc1 with rather inertial systems on the positive part e g fontaine de vaucluse toulon and reactive systems on the negative part e g aliou mouthe and to a lesser extent along pc2 with highly variable hydrological response systems on the positive part e g esperelle durzon mouline and more regular steady hydrological response systems on the negative part e g fontaine de vaucluse toulon 5 2 clustering 5 2 1 principle the purpose of data clustering is to identify clusters that contain observations or objects with similar characteristics jain et al 1999 govender and sivakumar 2020 clustering analysis can be used to identify archetypes and offer a better understanding of the structure within a dataset halkidi et al 2001 this technique is considered unsupervised because it is not based on predefined classes or examples that would give an idea of the structure of the dataset berry and linoff 1997 we selected a ward hierarchical clustering method for performing the analysis which consists of a succession of binary fusions that minimize between cluster variance until one cluster remains murtagh and legendre 2014 the ward distance is equal to tufféry and riesco 2011 d a b d a b 2 n a 1 n b 1 with d the ward distance between two clusters a and b that have centers of gravity a and b and frequencies na and nb the analysis was realized with standardized data and euclidean distance as measure of dissimilarity which is calculated with the following equation d euc x y j 1 d x j y j 2 1 2 with d the distance between two points x and y of a d dimensional dataset and xi and yi the values of the jth attribute of x and y respectively gan et al 2007 this method is suitable for clusters of different sizes and shapes and provides a graphical representation dendrogram which helps for understanding the clusters structure and how they are connected the main advantages over a non hierarchical method are i that it is not necessary to know the number of clusters prior to the analysis and ii that the results do not depend on the choice of initial clusters tufféry and riesco 2011 a way to assess whether a variable is relevant to characterize a cluster is to realize a value test or v test lebart et al 1984 for a given quantitative variable it involves in comparing the mean x k for this variable of a particular cluster k to the overall mean x with the formula v x k x s 2 n k n n k n 1 with v the result of the test s2 the overall standard deviation n the total number of observations and nk the number of observations in the cluster k a value of v greater than 1 96 corresponds to a p value 0 05 which rejects the following hypothesis the mean of the particular cluster is equal to the overall mean lebart et al 1984 in this case the variable is relevant to describe the group of observations in the cluster 5 2 2 results results are presented as a dendrogram four relevant clusters corresponding to two majors clusters have been identified fig 7 there is a great similarity between clusters and pca results fig 6 a v test was performed to assess the indicators that best characterize each cluster appendix c table c1 the major clusters a and b are differentiated on the basis of the following indicators kmax me cv rt imean sbb svc and αmean in order of importance which are related to the capacity of dynamic storage and inertia of a system according to the sign of the v test results cluster a includes reactive systems with low to medium capacity of dynamic storage and cluster b includes inertial systems with higher capacity of dynamic storage the systems from cluster 1 are characterized by a high αmean value corresponding to a fast draining of the capacitive function none of the indicators clearly characterize the systems in cluster 2 the systems in cluster 3 are characterized by a high ir value corresponding to a high variability of the hydrological response the systems in cluster 4 are characterized by very high rt me and imean and a very low sbb corresponding to a high attenuation capacity of the precipitation signal 5 3 confrontation of the results with the actual knowledge of the functioning of the systems pca and clustering gave similar insight into the functioning of the 10 core karst systems two major clusters were identified a and b fig 7 i cluster a is characterized by systems with a highly reactive functioning which can be divided into two sub clusters 1 and 2 by looking at the draining dynamic of the capacitive function ii cluster b is characterized by systems with inertial functioning and can be divided into two sub clusters 3 and 4 by looking at the variability of the hydrological functioning fig 6 fig 7 the hydrological response of aliou and baget corresponds to well karstified systems mangin 1984 which is consistent with their position in the major cluster a the karst conduits network induces floods of short duration that can have a high amplitude mangin 1975 with a response time estimated to 7 h after a precipitation event for aliou and 14 h for baget sivelle et al 2019 sivelle et al 2019 also found lower transfer coefficients for baget in their reservoir modelling study these results on the two systems support the difference between both clusters 1 for aliou and 2 for baget as aliou is characterized by a faster draining dynamic cross correlational analyses between precipitation and discharge performed by cholet 2017 on lods and mouthe systems showed low response times 17 h and 10 h respectively and high peak values 0 3 and 0 41 respectively which are characteristics of a very reactive functioning on mouthe system the higher draining dynamic of the capacitive function cluster 1 is consistent with both the lower response time and higher peak value of the cross correlation function than the ones obtained on lods system cluster 2 fontaine de nîmes is a reactive karst system with a moderate degree of karstification maréchal et al 2006 the hydrological response is fast due to a high infiltration rate and a fast water transfer in a well developed conduits network maréchal et al 2008 which corresponds to the characteristics of cluster a fleury et al 2013 found that the draining of the saturated zone was slow which is consistent with the position of the system in cluster 2 esperelle karst system is described as significantly fractured moussu 2011 and characterized by both a high impulse response height and dampened recession pinault et al 2001 this description is consistent with the one of cluster 2 which consists of reactive systems with moderate draining of the capacitive function durzon mouline fontaine de vaucluse and toulon systems are included in the cluster b mouline is considered as a complex karst system with long response times despite presence of flush flow effect that induces a quick transfer during winter pinault et al 2001 although there is no explanation for quick transfer in durzon system we can suppose that its functioning is similar to mouline as it is located in the same area the existence of both slow and fast dynamics on these systems depending on recharge event and or geometrical structure highlights a high variability of hydrological functioning which is characteristic of cluster 3 fontaine de vaucluse and toulon are differentiated in another cluster cluster 4 due to the low variability of their hydrological functioning the high inertia and homogeneous response of the fontaine vaucluse system can be explained by the thickness of the non saturated zone 800 m in average and the large area of its catchment estimated to be about 1160 km2 ollivier et al 2019 the toulon system defined as a complex karst system by lorette et al 2018 is a multi layer system with the discharge of an unconfined fractured and karstified aquifer that is permanently fed by another confined aquifer this continuous alimentation can explain the mostly homogeneous response of the system 6 proposal of a classification of karst systems hydrological functioning in this section we first present the classification based on the results of multivariate analyses the classification is then applied on both core and complementary datasets to assess the relevance of the approach regarding i the coherence with the well known hydrological functioning of the karst systems in the core dataset and ii the distribution of karst systems among the different classes from a worldwide perspective 6 1 classification of karst systems according to various types of hydrological functioning the exploration realized with pca and clustering confirmed the expected relations between the functioning of karst systems and indicator values in both methods karst systems are first differentiated from two main aspects their capacity of dynamic storage and their capacity to attenuate the precipitation signal the former is expressed through kmax and the latter through imean rt me and sbb n b the absolute values of the pearson correlation coefficients of each pair are greater than 0 85 suggesting strong correlations we chose the indicator rt to characterize the capacity to attenuate the precipitation signal further referred as global inertia as it considers the overall organization of flows in the system the shape and the dimensions of the catchment and the saturation state of the system indeed this indicator is more relevant than i imean which is biased by the number of available recession curves and ii me and sbb because their assessments are somehow questionable as they rely on an arbitrary threshold and a subjective evaluation respectively a second element of differentiation between karst systems is the draining dynamic of the capacitive function of a system with the αmean indicator in this case the mean of α values seems relevant due to the relatively low amplitude of the values for a given system fig 4c a third element of differentiation between systems is the variability of the hydrological response by quantifying the variability of i with the ir indicator the proposed classification thus relies on the following three main characteristics of the hydrological functioning i the capacity of dynamic storage ii the draining dynamic of the capacitive function and iii the variability of the hydrological response these characteristics are assessed using i kmax ii αmean and iii ir indicators respectively based on these 3 distinct characteristics of hydrodynamic behaviour six classes are proposed to discriminate the hydrological functioning of karst systems table 5 fig 8 i c1 poor capacity of dynamic storage with fast draining of the capacitive function and substantial variability of hydrological functioning ii c2 poor capacity of dynamic storage with fast draining of the capacitive function and low variability of hydrological functioning iii c3 poor capacity of dynamic storage with moderate draining of the capacitive function and substantial variability of hydrological functioning iv c4 poor capacity of dynamic storage with moderate draining of the capacitive function and low variability of hydrological functioning v c5 noticeable capacity of dynamic storage with slow draining of the capacitive function and substantial variability of hydrological functioning and vi c6 noticeable capacity of dynamic storage with slow draining of the capacitive function and low variability of hydrological functioning we chose to not include the indicator rt in the classification methodology as it seems that the global inertia of a karst system is relatively independent of its main characteristics of functioning especially for systems in c3 c4 c5 and c6 fig 9 b the proposed classification is based on recession parameters derived from mangin s model for recession simulation this model gave good simulations results over the 78 catchments considered in this study however the good performance of this model should be checked before any use of the classification over other systems to gain insights into the functioning of such systems we recommend the operators to make use of correlational and spectral analyses or analysis of classified discharges which can already give relevant information about global inertia and functioning of a system 6 2 application of the proposed methodology to 78 karst systems the classification was applied on the complementary dataset presented in 2 2 and composed of 68 karst systems plus the 10 core systems for a total of 78 karst systems fig 9a the most represented class is c3 which represents systems with a very low to medium capacity of dynamic storage a moderate to slow draining of the capacitive function and a medium to high variability of the hydrological response about 74 of the systems are characterized with a very low to medium capacity of dynamic storage c1 c2 c3 and c4 26 have a fast draining of their capacitive function c1 and c2 and 67 have a medium to high variability of the hydrological response c1 c3 and c5 rt was calculated for each system except for 1 system in c3 and 4 systems in c2 with too much gaps in the time series with means of 19 5 13 9 31 8 41 4 43 8 and 46 3 days for respectively c1 c2 c3 c4 c5 and c6 fig 9b the small increase of rt throughout the classes is consistent given the functioning description of each class c1 being the most reactive and c6 the most inertial the smaller mean in c2 is related to the structure of the classification a high ir in c3 and c5 means that the hydrological response can be more reactive than expected whereas in c1 it means that the hydrological response can be more inertial than expected it results in a higher rt mean in c1 over c2 as it includes systems with potential inertial responses finally we observed that rt is biased for systems with long dry periods saint pierre or lez systems the latter being under anthropic influence thus it is suggested to not calculate this indicator for these systems the systems are spread across all classes and types of hydrological functioning it means that even applied on a wider dataset there is a relative representativeness of all classes and types of hydrological functioning the spread of the 10 core systems between the six classes somehow confirms the respect of the second criteria for spring selection diversity of the hydrological functioning among the karst systems see section 2 1 and the relevance of the proposed classification 7 discussion the aim of this section is to take a step back on the methodology by questioning some of its limitations and assessing their impact on the relevance of the classification 7 1 influence of the length of the time series on the classification we performed a sensitivity analysis in order to assess the reliability of the classification regarding discharge time series of short length for 9 systems of the 10 core systems toulon was not considered as there is only 5 years of monitoring we defined 7 scenarios that range from 1 year y1 to 7 years y7 length of the discharge time series the classification methodology was then applied on each scenario in order to compare the results to those obtained with the full length fl discharge time series table 6 the accuracy of each indicator increases with the length of the time series fig 10 kmax is the most consistent with a steady decrease throughout the years in the deviation to the kmax value obtained for the full length time series fl indicator αmean becomes more stable and probably more reliable from y5 even though it does not show any significant increase in precision for y6 and y7 ir is highly uncertain for the shorter time series y4 but stabilizes from y5 and become relevant for y6 and y7 aliou baget durzon and mouline were correctly classified from y2 table 6 esperelle and mouthe from y5 and y6 respectively while fontaine de nîmes fontaine de vaucluse and lods were not consistently classified at all the results emphasize the benefits of long term monitoring as there are more chances of observing multiple flood events as well as different meteorological conditions but also highlight several limitations the classification is not reliable if only one recession curve is considered as ir would be 0 when the indicator is close to the threshold it can mislead the classification e g esperelle and fontaine de nîmes for which the variability in αmean can be explained by either a highly variable or a complex hydrological functioning respectively as the maximum observed discharge qmax can change over time this can affect the recession curves selection since only recessions with a peak flood discharge of at least one tenth of the maximum observed discharge are considered for the analysis e g fontaine de nîmes with qmax that went from 8 2 to 16 5 m3 s 1 from y1 to y3 as the mean interannual discharge qmean may vary over years this can induce an evolution of kmax value and thus modify the class of the karst system when the value is close to the threshold e g fontaine de vaucluse for which kmax oscillate around the 0 4 threshold with changes in qmean during the years despite being issued from the same recession curve based on these results we suggest working with at least 3 years length discharge time series for the classification these 3 years should be taken as a guideline and may differ notably depending on the system s dynamics indeed very reactive systems may require only a few years for a definitive classification thanks to their high hydrodynamic variability while the minimum length of the discharge time series required to reach satisfying classification may increase for very inertial systems however it remains appropriate to work with shorter time series when there is no alternative our analysis shows that 7 out of 9 systems are correctly or almost correctly classified at y2 if we include those that are close to the threshold table 6 7 2 evaluation of the distance between a system and other classes the uncertainties related to either i the length of the discharge time series or ii the indicators that are close to the threshold can be addressed by estimating the distance to the other classes the distance ds c of a system s to an adjacent class c is measured with the following equation d s c i th i calc i th where icalc corresponds to the calculated value of a given indicator and ith corresponds to its threshold value the indicator to consider in the calculation is the one that is critical for the class definition i e corresponding to the junction in the flowchart a distance d lower or equal to 0 1 10 can be considered as close to the threshold as the distance increase the system is not likely to be related with the involved class in relation to the structure of the classification there is no need to calculate the distance between classes 1 5 and classes 2 6 as it is highly uncertain that a system has both a kmax higher than 0 4 and a αmean greater or equal than 0 03 hatched area fig 11 a the formula allows for calculating the distance between i classes 1 2 3 4 and 5 6 with ir ii classes 1 3 and 2 4 with αmean and iii classes 3 5 and 4 6 with kmax the distance between diagonal classes can be calculated by applying the pythagorean theorem d s c d s c x 2 d s c y 2 where x and y correspond to two different classes the formula allows for calculating distance between i classes 1 4 and 2 3 with αmean and ir fig 11c and ii classes 3 6 and 4 5 with kmax and ir fig 11b these notions of distances can be more easily appreciated on the fig 12 which shows the 3 dimensional distribution of the karst systems in the kmax αmean and ir space to complement the discussion in section 7 1 related to the close to the threshold systems we calculated the distance to other classes for the 10 core karst systems table 7 the results highlight that i baget is close to c3 ii fontaine de nîmes is close to c4 and iii fontaine de vaucluse is close to c4 regarding the 78 systems only 12 systems are close to a threshold with a distance to another class lower or equal than 0 1 this distance measure allows reflecting on the classification results by highlighting potential threshold issues thus we can tell if a system is clearly into a said class or is close to one or two classes 7 3 beyond the classification correlational spectral and classified discharges analyses can be performed post classification to really exploit the maximum of information that can be obtained by analysing the discharge time series in order to get a deeper knowledge of the functioning of a system we propose to use rt as an additional indicator to complement the above described classification and to gain further insights into the global inertia of a karst system we defined four ranges i lower or equal than 15 days ii greater than 15 days and lower or equal than 30 days iii greater than 30 days and lower or equal than 45 days and iv greater than 45 days which are referred as i low ii medium iii high and iv very high global inertia respectively in a similar manner we propose to perform the visual interpretation of the curve of classified discharges after the classification to have additional information about the presence or absence of major specific functioning for example hr 0020 system has a kmax of 0 07 an αmean of 0 021 day 1 and an ir of 0 34 corresponding to c3 appendix d hr 0020 is thus described as a system with a very low to low capacity of dynamic storage a fast draining of the capacitive function and a medium to high variability of the hydrological response the regulation time of 15 5 days indicates that the system has a medium capacity to attenuate the precipitation signal or medium global inertia the bending point on the curve of classified discharges at 1 8 m3 s 1 may be due to the activation of an overflow outlet a discharge to another system or a temporary storage of water the one at 30 m3 s 1 may translate the same processes but it is not excluded that it can be related to uncertainties on ungauged discharges 8 conclusion our objective was to propose a new classification of karst systems hydrological functioning based on the analysis of spring discharge time series that is representative of a wide diversity of karst systems several methods were considered to identify indicators of functioning multivariate analyses allowed the identification of relevant indicators that allow distinguishing the analysed karst systems three indicators were identified as the most relevant indicators and thus retained to characterize karst systems and propose a classification into six different types of hydrological functioning the hydrological functioning of karst systems was distinguished according to their capacity of dynamic storage the draining dynamic of their capacitive function and the variability of their hydrological functioning the classification can be completed with two additional analyses to characterize the global inertia and highlight the presence or absence of major specific functioning the challenge of developing a relevant classification was addressed i by considering a core dataset of karst systems with a high diversity of hydrological functioning ii by selecting the most relevant indicators of hydrological functioning and proposing a classification based on multivariate analyses and iii by testing the relevance of the classification on spring discharge time series of 78 karst systems located worldwide as the methodology requires only spring discharge time series which is the most common monitored data and gives relevant results with only few years of monitoring the classification can be used in scarce data contexts it can thus be seen as a modern tool for the classification of karst systems hydrological functioning which provides researchers and stakeholders with a first insight into karst system functioning based on accessible and straightforward analyses we emphasize that the proposed typology first aims to describe the hydrological functioning of a system where one single hydrodynamic response to precipitation impulse is expected but remains useful even when two or more responses are observed one perspective of this work would be to provide a database that allows both comparing the hydrological functioning of several karst systems and then proposing a link between the developed classification and the design of lumped parameter models research perspectives include the study of the relation between classification and the relevant structures and parameters of models for rainfall discharge simulation credit authorship contribution statement guillaume cinkus conceptualization methodology software validation formal analysis writing original draft visualization naomi mazzilli conceptualization methodology investigation writing review editing supervision hervé jourde conceptualization methodology investigation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank the french ministry of higher education and research for the thesis scholarship of g cinkus as well as the european commission for its support through the partnership for research and innovation in the mediterranean area prima programme under horizon 2020 karma project grant agreement number 01dh19022a for the data provided the french karst national observatory service sno karst and especially d labat and a probst for the data gathered by a mangin at the baget and aliou springs the parc naturel régional des grands causses pnrgc g lorette for data monitored by suez the dreal provence alpes côtes d azur and the dreal bourgogne franche comté are also acknowledged appendix a calculation details for the correlational and spectral analyses the autocorrelation function rk is calculated with the following equation r k c k c 0 with the autocovariance function ck c k 1 n 1 n k x i x x i k x with k the shift 0 1 2 m n the length of the series m the maximum shift possible generally m n 3 xi the ith element of the series xi t the i t th element of the series and x the mean of the series the correlogram correspond to the plot of rk versus k the spectrum sf is calculated with the following equation s f 2 1 2 k 1 m d k r k c o s 2 π f k with f the frequency f j 2m for daily timestep rk the autocorrelation function and dk a weighting function tukey hanning window to ensure that the estimated sf is not biaised mangin 1984 d k 1 c o s π k m 2 the spectrum is represented on a plot of sf versus f b calculation details for the analysis of classified discharges the procedure to obtain the curve of classified discharges involves in i the quantiles calculation of the empirical distribution function ii the calculation of the corresponding variable from the reference distribution function iii the graphical representation of the relation between the quantiles of the empirical and reference distribution functions and iv the choice of the x axis scale either arithmetic or logarithmic corresponding to a normal or log normal adaptation of the reference distribution respectively the repartition function corresponding to the cumulative probability density regarding the standard normal distribution is p x z 1 2 1 e r f z 2 for a half gaussian distribution p x z e r f z 2 the observed discharges are plotted on the x axis of the quantile quantile plot c results of the v test applied on clusters a b 1 2 3 and 4 d graphical summary of the typology of hr 0020 karst system wokas database olarinoye et al 2020 
3918,classification is a first line tool for understanding the main characteristics of a natural system s response we propose a new classification of karst systems hydrological functioning that is based on spring discharge time series and takes profit of spring discharge databases to encompass the high diversity of karst hydrological functioning it discriminates six different classes based on three relevant indicators of karst hydrological functioning a core dataset made of 10 karst systems was first considered for the set up of the classification the spring discharge time series were investigated according to recession curves statistical and signal analyses to identify relevant indicators of hydrological functioning the selection of the most relevant indicators and the proposal of the classification were based on multivariate analyses the classification was then tested on spring discharge time series of 78 karst systems located worldwide all the systems homogeneously spread among the six proposed classes which highlights the relevance of the approach and the representativeness of the various classes of hydrological functioning results from the proposed methodology were finally discussed to explore its limitations and define guidelines for its application abbreviations sno karst service national d observation du karst pnrgc parc naturel régional des grands causses dreal direction régionale de l environnement de l agriculture et du logement wokas world karst spring hydrograph cv coefficient of variation svc spring variability coefficient qs specific discharge mrc master recession curve me memory effect rt regulation time sbb spectral band breadth nse nash sutcliffe efficiency pca principal component analysis pc1 pc3 first to third principal component kmax maximum k value over all the recession analysed αmean mean α value over all the recession analysed ir i range corresponding to imax imin c1 c6 class 1 to 6 fl full length y1 y6 year 1 to 6 keywords karst hydrological functioning classification typology time series analysis multivariate analyses 1 introduction 10 of the world s population is dependent on karst water resources for drinking water stevanović 2018 karst systems are underground entities that drain recharge water over a catchment towards a main outlet the water is drained through conduits fractures and matrix which originate from the dissolution of the calcite deposits by acidic water from the surface understanding the functioning of these complex and heterogeneous systems is therefore a major challenge for long term water resource management over the past century different methods have been developed to analyse hydrological time series and subsequently characterize the functioning of karst systems these methods can be considered as a preliminary step in the development and design of hydrological models of karst functioning for sustainable water resource management classification has been widely used in surface hydrology to characterize hydrosystems although the three dimensional properties of aquifers generate an additional complexity some authors proposed different methodologies to classify them based on geological morphological and hydrological functioning analyses heath 1982 dahl et al 2007 heudorfer et al 2019 in many cases however these classifications fail to address the complexity of karst systems which are strongly heterogeneous and correspond to a wide diversity of hydrological functioning for these reasons many authors worked on classifications specific to karst systems either based on geological and morphological analyses mylroie 1984 waltham and fookes 2003 jouves et al 2017 veress 2020 hydrological response analyses mangin 1975 mangin 1984 soulios 1991 bonacci 1993 kullman 2000 flora 2004 springer et al 2008 rashed 2012 malík and vojtková 2012 or even karst groundwater microbiological analyses sinreich et al 2013 the spring discharge of a karst system is considered as a base information in karst hydrogeology it results from the combination of flows from the different compartments of the hydrosystem soil epikarst unsaturated and saturated zones the widely increased development of karst spring discharge monitoring offers the opportunity to study the relations between discharge and hydrological functioning in depth some authors proposed classifications of karst systems based on the analysis of spring discharge time series either with visual interpretations soulios 1991 bonacci 1993 by calculating indicators of functioning mangin 1975 mangin 1984 flora 2004 springer et al 2008 rashed 2012 or by interpreting the parameters of recession models mangin 1975 kullman 2000 malík and vojtková 2012 however the aforementioned classifications have been developed by analysing only few karst systems or without considering the high diversity of karst hydrological functioning therefore diversity in karst systems physical properties and hydrological functioning is not fully considered which impairs the relevance of these classifications and raises the need for a more generic approach this work aims to provide a new classification of karst systems hydrological functioning with the following key features i a clear methodological basis ii the analysis of a wide diversity of karst systems representative of contrasted hydrodynamics behaviours iii an approach being relevant worldwide and in a scarce data context i e sites where there is little knowledge of the system or only discharge monitoring for a few years in this paper we took advantage of the recent release of spring discharge time series in databases such as the french sno karst jourde et al 2018 or the wokas database olarinoye et al 2020 to propose a new classification of karst systems hydrological functioning the typology describes a system where one single hydrodynamic response to precipitation impulse is expected the aim of the classification is to characterize the hydrological functioning of a system but not to decorrelate the factors that influence the functioning the paper is organized as follows in section 2 we define the general characteristics of the karst systems considered in this study section 3 presents the various tools and analyses considered for the characterization of karst systems hydrological functioning the most relevant indicators of karst hydrodynamics are identified and presented in section 4 using the discharge time series of 10 well known karst systems that cover a wide range of hydrological functioning section 5 is devoted to multivariate analyses that are considered for the proposal of the new classification described in section 6 the discussion in section 7 aims to evaluate the relevance of the proposed approach applied to 78 karst systems and to highlight some of its limitations section 8 gives the conclusions 2 general characteristics of the karst systems considered in this study this section presents the data we used to develop and test the classification which involve in two different datasets i a core dataset for the assessment of the most relevant indicators of functioning and the design of the classification and ii a complementary dataset for assessing the most efficient recession model testing the classification and identifying its strength and limitations 2 1 core dataset to ensure the quality of the study and its relevance to the problem we performed spring selection on the basis of three criteria i quality of the hydrodynamic monitoring which is function of time step instrumentation measurement uncertainty and length of the time series ii diversity of the hydrological functioning among the karst systems meaning that the final dataset should cover a wide range of hydrological functioning e g related to dimensions of the catchment rainfall degree of karstification hydrological functioning etc and iii existing knowledge from prior studies to ensure that the classification is consistent with the actual knowledge on system functioning we selected 10 karst systems table 1 located in france we retrieved data from several organizations the french karst national observatory service sno karst the parc naturel régional des grands causses pnrgc suez and the dreal of bourgogne franche comté selected systems have been the subject of several comprehensive studies based of methods such as geology cartography field observations tracing geochemistry time series analysis and modelling 2 2 complementary dataset in order to check the relevance of the method and its capacity to differentiate karst systems functioning the classification resulting from the analysis of the aforementioned well known karst systems was tested on a complementary dataset of 68 karst systems with different characteristics e g dimensions of the catchment meteorological regime climate and karstification degree we worked with springs discharge time series of 23 french karst systems coming from a database provided by the french state banque hydro and took the other 45 from the wokas world karst spring hydrograph database which provides details of over 400 karst systems worldwide olarinoye et al 2020 the quality of these 68 springs discharge time series is appreciated according to low c2 to very good a quality discharge data fig 1 c as proposed in olarinoye et al 2020 the dataset is fairly well distributed throughout the world with karst springs discharge from 17 countries fig 1b the considered karst systems are located in various climatic conditions according to köppen geiger classification peel et al 2007 these climatic conditions correspond to 12 different climates the temperate oceanic cfb being the most represented 63 2 fig 1a 3 presentation of the selected discharge time series analysis methods for the characterization of karst systems functioning the discharge is directly related to the recharge and the emptying of the capacitive function of a system but also depend on the system geometry and hydrodynamic properties malík 2015 this section provides details about four methods for analysing discharge time series and the indicators that can be retrieved from these methods to characterize the functioning of a karst system 3 1 statistical analyses statistical indicators of discharge time series provide basic information about the overall functioning of a system the most common are the mean minimum maximum standard deviation and the various quantiles the mean interannual discharge depends on both the dimensions of the catchment and the mean recharge it can therefore be used to assess the dimensions of a system the observed minimum and maximum discharges make it possible to understand the flow amplitude however significant uncertainty related to the extrapolation of extreme discharges at springs is associated with this indicator the comparison between various karst systems is facilitated when using nondimensionalized indicators such as the coefficient of variation cv which is the ratio between the standard deviation and the mean of the discharge time series netopil 1971 proposed the calculation of a characteristic discharge which is the ratio between the 0 9 quantile discharge value that is exceeded 10 of the time and the 0 1 quantile this characteristic discharge was referred to as spring variability coefficient svc in stevanović 2015 the svc is less affected by extreme values the specific discharge qs corresponds to the ratio between the mean interannual discharge and the catchment area it allows assessing karst hydrodynamics with an implicit consideration of the dimensions of the catchment however the area information is not always available and also depends on the quality of hydrogeological studies over the catchment of interest 3 2 recession curves analysis the hydrograph of a flood recession corresponds to the period when the discharge gradually decreases as water is not replenished toebes and strang 1964 it is possible to distinguish two regimes i the influenced quickflow regime which corresponds to the period when the discharge is influenced by the rapid infiltration of water into conduits in the unsaturated zone and ii the non influenced baseflow regime which begins when rapid infiltration ends and corresponds to the draining of the saturated zone and less transmissive compartments of the system mangin 1975 in the literature analysis of recession curves is mainly used to estimate groundwater reserves drogue 1972 forkasiewicz and paloc 1967 mangin 1975 determine the hydrodynamic parameters of the aquifer mangin 1975 and provide information on flows drainage and karstification degree drogue 1972 mangin 1975 kullman 2000 malik 2006 krešić 2007 malík and vojtková 2012 the karstification degree is an indicator of the karst maturity of a system which is directly related to groundwater recharge storage capacity spring discharge dynamics and system connectivity numerous models for the analysis of recession curves of discharge time series have been proposed table 2 boussinesq 1877 and maillet 1905 made the first proposals horton 1933 and barnes 1939 then developed recession models based on maillet s equation coutagne 1948 proposed an equation that simulates the discharge from a reservoir padilla et al 1994 highlighted that coutagne s equation struggles to reproduce the recession curves of karst systems and thus introduced a new parameter qc this later parameter corresponds either to the discharge from poorly transmissive zones of the aquifer or to the discharge from aquitards outside the karst system it may also have no physical meaning drogue 1972 proposed to approach the whole recession curve with a hyperbolic function mangin 1975 developed a two equation recession model representative of the influenced and non influenced regimes kullman 2000 approached recession curves by fitting a model based on a linear equation kullman 1983 for influenced regime and maillet s equation for non influenced regime based on kullman work malík and vojtková 2012 proposed a classification of karst systems functioning according to the number of equations required to model the recession and the values of the parameters other authors samani and ebrahimi 1996 griffiths and clausen 1997 ladouche et al 2006 proposed models inspired by the aforementioned models we did not consider physical based models as we do not have any information on reservoir geometry further details about empirical physical based models and recession curve analysis can be found in fiorillo 2014 in this study we wanted to assess the variability of the hydrological response of the karst systems which is only possible when accounting for different recession periods for this reason we dismissed the use of a master recession curve mrc which aims to overcome the problem of recession variation by combining several recession curves into one and only the mangin s model has been widely used to characterize karst systems mainly because the author proposed a classification based on two indicators derived from the parameters of the model equation the parameter α is assumed to characterize the draining of the capacitive function of the karst system which corresponds in most cases to flow from the saturated zone in case of a low karstification degree α can be affected by flows occurring in the unsaturated zone which may induce a lag in the response in the non influenced regime mudarra and andreo 2011 the indicator k is strongly linked to the α recession coefficient of the first component of the mangin model table 2 which is applied only on the non influenced regime the indicator k is thus focused on the slow depletion of the aquifer and assumed to characterize the ability of a system to store and return recharge water it is calculated with the following equation k v dyn v an with vdyn the dynamic volume and van the interannual mean yearly volume of water discharged at the spring the dynamic volume is calculated by integrating the exponential function v dyn 0 q i e α t d t q i α with qi the discharge at the time ti ti being the time at which the flow is considered to be laminar and also the beginning of the non influenced regime and α the recession coefficient in his work mangin 1975 suggested to characterize the capacity of dynamic storage with the maximum calculated vdyn as it tends towards a stable value for a large number of analysed recession curves the indicator i is used to characterize the capacity of a system to filter and attenuate the precipitation signal it corresponds to the discharge attributed to the influenced regime second component of the mangin model table 2 two days after the flood peak this discharge is expressed in relative proportion to the influenced discharge q0 and is calculated with the following equation i 1 2 η 1 2 ε with η a constant characterizing the speed of infiltration η 1 ti with ti being the duration of the influenced stage and ε a constant characterizing the concavity of the recession curve during the influenced stage the classification initially proposed by kullman 2000 and updated by malík and vojtková 2012 differentiate systems by their karstification degree the methodology consists to reproduce a recession curve by fitting one to several equations either exponential or linear and calibrate the α and β parameters of each formula the karstification degree is then deduced from a table based on the presence of different flow sub regimes i e the number and nature of the equations and the value of the α and β parameters it ranges from 0 5 to 10 and is associated with a description of assumed structure of the system and karst groundwater circulation 3 3 correlational and spectral analyses correlational and spectral analyses are time series analyses that are used to study the frequency content of a signal referred to as simple analysis and relations between signals referred to as cross analyses massei et al 2006 the simple analysis consists of calculating the autocorrelation function of a signal and the corresponding spectrum obtained using a fourier transformation the calculations are detailed in appendix a the principle is to compare the signal with itself over an increasing time interval or shift jeannin and sauter 1998 the cross analyses examine the transformation of the input signal into an output signal padilla and pulido bosch 1995 signal analyses mainly developed by jenkins and watts 1968 hannan 2008 brillinger 1975 and box and jenkins 1976 were first applied to karst hydrology by mangin 1984 according to mangin 1984 a karst system can be characterized by its response time to a unitary impulse precipitation and its inertia which depends on both the volume of groundwater reserves and karstification degree of the karst system simple correlational and spectral analyses allow determining three indicators of karst hydrological functioning i the memory effect me which is the shift k for an autocorrelation coefficient rk of 0 2 it translates variation in discharge over time and is directly related to the inertia of the karst system marsaud 1997 ii the regulation time rt which is the inverse of the bandwidth i e the maximum ordinate of the spectrum divided by 2 value of the integral of the function between 0 and it provides information on the duration of the influence of a unitary impulse larocque et al 1998 kovács 2003 on the volume of groundwater reserves marsaud 1997 and makes it possible to assess the overall organization of flows in the system e g conduits fractures and cracks jeannin and sauter 1998 iii the cut off frequency or spectral band breadth sbb which corresponds to the frequency f at which the value of the spectrum sf becomes negligible beyond this frequency the spectrum is equal to zero and can be assimilated to noise jeannin and sauter 1998 the cut off frequency provides information on the ability of the system to filter unitary pulses marsaud 1997 the results provide a general idea of how a karst system works with an emphasis on the inertia of the system and its capacity to attenuate the recharge signal 3 4 analysis of classified discharges the analysis of classified discharges provides information on flow regimes within a system based on discharge monitoring at the outlet of a karst system marsaud 1997 based on empirical observations mangin 1971 suggested that the distribution of discharges or logarithm of discharges from karst springs can be approximated by a half normal gaussian distribution the calculations are detailed in appendix b he concluded that the comparison between quantiles of measured discharges and quantiles given by the half normal distribution should follow a straight line according to this theory any discontinuities of the line corresponding to an inflexion point indicate inhomogeneity in the functioning of the system below or above a certain range of discharge such changes can occur at low or high discharges and may be positive or negative the interpretation proposed by mangin is based on an extremely strong hypothesis which is that the statistical half normal gaussian distribution properly describes the distribution of discharges from karst springs under a homogeneous functioning the method allows identifying particular events inherent in karst hydrology e g overflow at outlet leakage to another system storage and emptying phenomena time varying extent of the recharge catchment it also allows assessing the quality of the gauging station grasso and jeannin 1994 marsaud 1997 dörfliger 2010 4 analysis and selection of indicators of karst dynamics analysis of discharge time series were performed for the 10 karst systems aforementioned core dataset based on methods detailed in section 3 with the goal to select the most relevant indicators of karst systems hydrodynamics 4 1 statistical indicators the results of the statistical analyses highlight the diversity of hydrological functioning of the core systems table 3 the mean discharge allows to distinguish systems with a low discharge aliou baget fontaine de nîmes mouline and toulon with a medium discharge durzon esperelle lods and mouthe and with a large discharge fontaine de vaucluse although the mean discharge is highly correlated with the dimensions of the catchment it is also dependent of the precipitation and the hydrological functioning of the system cv and svc are highly correlated with a correlation coefficient r 0 925 p value 0 00012 both can be related to the inertia of the system and allow to differentiate reactive systems aliou baget esperelle fontaine de nîmes lods and mouthe from inertial systems durzon fontaine de vaucluse mouline and toulon there is no evident relation between qs and the characteristics of the system as the dimensions of the catchment are bypassed we suppose that qs may be related to the karstification degree or the specific recharge volume of water that goes to the aquifer by unit area as qs requires the knowledge about the area of the recharge catchment which is either unknown or with high uncertainty it is not retained as a relevant indicator for the classification 4 2 recession indicators the dynamics of a karst system can be either i at infra day time scale meaning that the system is reactive with fast variations in discharge of the order of an hour or ii at daily time scale meaning that the system has high inertia and changes in discharge can be assessed on a daily basis a comparison of results issued from recession curves analysis performed on hourly and daily time series showed that even for reactive karst systems the daily time scale provides sufficient accuracy we selected a total of 93 recession curves fig 2 from the overall time series of each system of the core dataset with no distinction between seasonal or event scale recessions on the basis of the following conditions i the peak flood discharge must be significantly high regarding the overall dynamics of the system we suggest at least one tenth of the maximum discharge of the discharge time series or greater than the interannual mean discharge however we do not exclude the eventuality of site specific thresholds ii there should be little or no disruption during the recession e g precipitation leading to untimely peaks in cases where the disruption was of short duration data could be removed and replaced with a blank and iii the recession must be complete meaning it should include both the influenced regime and the entire non influenced regime with some tolerance for high inertia systems in the specific case when karst spring behaviour is influenced by a particular hydrological functioning e g the activation of an overflow outlet that appears on the recession curve as a bending point our selection concerned only the last unaffected part of the curve including the end of the recession limb this approach ensured that the models which are not mean to fit curves with bending points other than the one between the influenced and non influenced regime were correctly calibrated information loss was relatively minor as discharges that were excluded from the analysis only represented a tiny part of the overall flow the bending point required for mangin s model mangin 1975 was defined manually and corresponds to the time t when the non influenced regime begins when flow is considered as part of the non influenced regime out of the 9 recession models presented in section 3 1 2 4 models suit the study s requirements we identified them as relevant for karst hydrodynamics analysis but also easy to automate they correspond to the models from drogue 1972 coutagne 1948 padilla et al 1994 and mangin 1975 and will be further referred as hyperbolic coutagne padilla and mangin models respectively we tested the 4 models by examining their performance in fitting all 390 observed recession curves of both core dataset and complementary dataset fig 3 and by performing a sensitivity analysis we found hyperbolic padilla and mangin models to be relatively successful in fitting the observed recession curves although padilla and hyperbolic model significantly failed nse lower than 0 on 31 and 3 recession curves respectively this illustrates that padilla and hyperbolic models are not suitable for all the karst systems the median relative error of hyperbolic padilla and mangin models are of 7 7 6 7 and 5 6 respectively with median nse of 0 986 0 989 and 0 995 coutagne model showed a poor performance with a median relative error of 38 and a median nse of 0 730 the sensitivity analyses revealed that coutagne and padilla models have equifinality issues for the parameters α and n with only qc having an optimum on the other hand the parameters of hyperbolic and mangin models have systematically an optimum we selected mangin model for the analysis of recession curves as it provides a consistent and very good fit for all the recession curves lowest nse of 0 91 with a limited equifinality moreover this model has been widely used for years and its indicators are well known by the community results show that these indicators clearly differentiate among systems of the core dataset fig 4 the analysis of i values which allow assessing the capacity of a system to filter and attenuate the precipitation signal revealed a relationship between the value of this indicator and the saturation state of the system fig 5 which corresponds to the volume of water stored in both the saturated and unsaturated zones variability in i can be a consequence of either i the volume of water already stored in the karst system when the recharge occurs i e the influence of the saturation state on the system connectivity but also ii the variability of the overall organization of flow and groundwater storage between matrix fracture and conduits in the different compartments of the system we therefore decided to take account of variability in i values or lack thereof as an additional information of karst system hydrological functioning by including a new indicator based on the variance of i as some systems have a small recession curves sample size e g toulon with only 2 fig 2 a new indicator based on the standard deviation of i may be irrelevant therefore we propose a new indicator ir based on the maximum and minimum i values observed on the recession curves sample ir i max i min with imax and imin the maximum and minimum i values observed on the recession curves sample 4 3 signal indicators the correlational and spectral analyses were performed with a sampling step of 1 day and a maximum offset m of 125 days according to the suggestions of mangin 1984 on short term and long term analyses the short term analysis can be performed on systems that have at least one continuous year of daily discharge recording as the 10 core systems are all in the same climatic context according to the köppen geiger climate classification the starting date for the discharge time series was set as the beginning of the hydrological cycle 1 september to consider the seasonality the results highlight the diversity of hydrological functioning of the core systems table 4 aliou and mouthe are very reactive systems that rapidly transfer a response proportional to the intensity and duration of unitary pulses precipitation with almost no dampening of the recharge signal because they exhibit a fast response to recharge events but are less reactive than the former baget fontaine de nîmes and lods are referred as low inertia systems durzon esperelle and mouline correspond to the category of medium inertia systems which are able to filter a greater or lesser proportion of unitary pulses and dampen the recharge signal this category encompasses a wide variety of hydrological functioning as the medium rt value may translate either i a medium inertia or ii a high variability of hydrological functioning with both high inertia and low inertia responses resulting in an average rt fontaine de vaucluse and toulon are considered as high inertia systems as they have a high filtration capacity and noticeably dampen the recharge signal 4 4 indicators issued from the analysis of classified discharge within the core dataset table 4 this analysis hints that there is no change in the hydrological functioning of 5 systems aliou baget durzon esperelle and mouline but that there might be hydraulic or flow properties changes beyond a certain discharge for 4 systems fontaine de nîmes fontaine de vaucluse lods and toulon for 4 other systems fontaine de nîmes lods mouthe and toulon there might be an overflow outlet discharge to another system or a temporary storage of water within the karst system when the discharge reaches a certain value these interpretations are confirmed in the literature for fontaine de nîmes maréchal et al 2006 fontaine de vaucluse mangin 1975 lods mouthe cholet 2017 and toulon lorette et al 2018 this analysis whose interpretation requires prior knowledge of the system or field observations to be fully relevant does not seem appropriate for the classification of karst systems the method is based on a strong hypothesis that may not be suitable for all systems although some relevant indicators of functioning can be retrieved from this analysis e g activation of an overflow outlet flow to another system the interpretation is overly influenced by i the quality of the discharge water height relationship and ii the subjective vision of the operator who is performing the analysis moreover when there is poor or no prior knowledge of the functioning of a system it is very difficult to identify the specific functioning behind a bending point on the curve e g the difference between a bending point due to the activation of an overflow outlet or due to uncertainties on ungauged discharges thus we choose to not include the indicators of functioning retrieved from this analysis in the proposed methodology for the classification of karst system hydrological functioning 5 multivariate analyses the aim of this section is to gain insights into the dataset and the relations between indicators we applied two unsupervised techniques on a dataset consisting of 9 variables and 10 observations the observations correspond to the 10 core karst systems and the variables are relevant quantitative indicators of functioning resulting from the application of the different methods of discharge time series analysis excluding the indicators resulting from the analysis of classified discharge the selected indicators are kmax imean ir αmean me rt sbb cv and svc terms max and mean correspond to respectively maximum and average values of the indicator over all the recession analysed 5 1 principal component analysis 5 1 1 principle principal component analysis pca is a multivariate method that aims to reduce the dimensions of an observation space by producing principal components which are linear combinations of initial variables of a dataset that retains the most possible variation principal components are uncorrelated with each other i e orthogonal to the previous one and are ordered according to the amount of variance explained by the combination everitt and hothorn 2011 the results of a pca can be seen as a small number of new variables that contains most of the information of a large number of initial variables the interpretation of a principal component is realized by looking at the correlation between initial variables and the component i e assessing the contribution of each variable this analysis provides information on trends in the dataset and allows identifying eventual complementarity between initial variables 5 1 2 results the results of the pca are presented as a biplot of the first factorial plane fig 6 which explains 87 9 of the total variance of the dataset the first principal component pc1 is strongly correlated with all indicators except ir i kmax informs about the capacity of dynamic storage ii imean me rt and sbb are related to the capacity to attenuate the precipitation signal iii αmean characterizes the draining dynamic of the capacitive function and iv cv and svc are about flow dynamics together these indicators can be seen as characterizing the inertia of a system which would correspond to the first principal component pc1 73 4 of variance explained the second principal component pc2 14 5 of variance explained is mainly correlated with ir and thus would reflect the variability of the hydrological response of a system the third principal component pc3 5 8 of variance explained is most correlated with αmean which characterizes the draining dynamic of the capacitive function of a system it is worth mentioning that the high correlation between several input parameters e g cv and svc may have a substantial effect on the pca results particularly on the variance explained by the principal components i e pc2 and pc3 could have had a higher variance by overemphasizing the contribution of redundant indicators systems from the core dataset are mostly scattered along pc1 with rather inertial systems on the positive part e g fontaine de vaucluse toulon and reactive systems on the negative part e g aliou mouthe and to a lesser extent along pc2 with highly variable hydrological response systems on the positive part e g esperelle durzon mouline and more regular steady hydrological response systems on the negative part e g fontaine de vaucluse toulon 5 2 clustering 5 2 1 principle the purpose of data clustering is to identify clusters that contain observations or objects with similar characteristics jain et al 1999 govender and sivakumar 2020 clustering analysis can be used to identify archetypes and offer a better understanding of the structure within a dataset halkidi et al 2001 this technique is considered unsupervised because it is not based on predefined classes or examples that would give an idea of the structure of the dataset berry and linoff 1997 we selected a ward hierarchical clustering method for performing the analysis which consists of a succession of binary fusions that minimize between cluster variance until one cluster remains murtagh and legendre 2014 the ward distance is equal to tufféry and riesco 2011 d a b d a b 2 n a 1 n b 1 with d the ward distance between two clusters a and b that have centers of gravity a and b and frequencies na and nb the analysis was realized with standardized data and euclidean distance as measure of dissimilarity which is calculated with the following equation d euc x y j 1 d x j y j 2 1 2 with d the distance between two points x and y of a d dimensional dataset and xi and yi the values of the jth attribute of x and y respectively gan et al 2007 this method is suitable for clusters of different sizes and shapes and provides a graphical representation dendrogram which helps for understanding the clusters structure and how they are connected the main advantages over a non hierarchical method are i that it is not necessary to know the number of clusters prior to the analysis and ii that the results do not depend on the choice of initial clusters tufféry and riesco 2011 a way to assess whether a variable is relevant to characterize a cluster is to realize a value test or v test lebart et al 1984 for a given quantitative variable it involves in comparing the mean x k for this variable of a particular cluster k to the overall mean x with the formula v x k x s 2 n k n n k n 1 with v the result of the test s2 the overall standard deviation n the total number of observations and nk the number of observations in the cluster k a value of v greater than 1 96 corresponds to a p value 0 05 which rejects the following hypothesis the mean of the particular cluster is equal to the overall mean lebart et al 1984 in this case the variable is relevant to describe the group of observations in the cluster 5 2 2 results results are presented as a dendrogram four relevant clusters corresponding to two majors clusters have been identified fig 7 there is a great similarity between clusters and pca results fig 6 a v test was performed to assess the indicators that best characterize each cluster appendix c table c1 the major clusters a and b are differentiated on the basis of the following indicators kmax me cv rt imean sbb svc and αmean in order of importance which are related to the capacity of dynamic storage and inertia of a system according to the sign of the v test results cluster a includes reactive systems with low to medium capacity of dynamic storage and cluster b includes inertial systems with higher capacity of dynamic storage the systems from cluster 1 are characterized by a high αmean value corresponding to a fast draining of the capacitive function none of the indicators clearly characterize the systems in cluster 2 the systems in cluster 3 are characterized by a high ir value corresponding to a high variability of the hydrological response the systems in cluster 4 are characterized by very high rt me and imean and a very low sbb corresponding to a high attenuation capacity of the precipitation signal 5 3 confrontation of the results with the actual knowledge of the functioning of the systems pca and clustering gave similar insight into the functioning of the 10 core karst systems two major clusters were identified a and b fig 7 i cluster a is characterized by systems with a highly reactive functioning which can be divided into two sub clusters 1 and 2 by looking at the draining dynamic of the capacitive function ii cluster b is characterized by systems with inertial functioning and can be divided into two sub clusters 3 and 4 by looking at the variability of the hydrological functioning fig 6 fig 7 the hydrological response of aliou and baget corresponds to well karstified systems mangin 1984 which is consistent with their position in the major cluster a the karst conduits network induces floods of short duration that can have a high amplitude mangin 1975 with a response time estimated to 7 h after a precipitation event for aliou and 14 h for baget sivelle et al 2019 sivelle et al 2019 also found lower transfer coefficients for baget in their reservoir modelling study these results on the two systems support the difference between both clusters 1 for aliou and 2 for baget as aliou is characterized by a faster draining dynamic cross correlational analyses between precipitation and discharge performed by cholet 2017 on lods and mouthe systems showed low response times 17 h and 10 h respectively and high peak values 0 3 and 0 41 respectively which are characteristics of a very reactive functioning on mouthe system the higher draining dynamic of the capacitive function cluster 1 is consistent with both the lower response time and higher peak value of the cross correlation function than the ones obtained on lods system cluster 2 fontaine de nîmes is a reactive karst system with a moderate degree of karstification maréchal et al 2006 the hydrological response is fast due to a high infiltration rate and a fast water transfer in a well developed conduits network maréchal et al 2008 which corresponds to the characteristics of cluster a fleury et al 2013 found that the draining of the saturated zone was slow which is consistent with the position of the system in cluster 2 esperelle karst system is described as significantly fractured moussu 2011 and characterized by both a high impulse response height and dampened recession pinault et al 2001 this description is consistent with the one of cluster 2 which consists of reactive systems with moderate draining of the capacitive function durzon mouline fontaine de vaucluse and toulon systems are included in the cluster b mouline is considered as a complex karst system with long response times despite presence of flush flow effect that induces a quick transfer during winter pinault et al 2001 although there is no explanation for quick transfer in durzon system we can suppose that its functioning is similar to mouline as it is located in the same area the existence of both slow and fast dynamics on these systems depending on recharge event and or geometrical structure highlights a high variability of hydrological functioning which is characteristic of cluster 3 fontaine de vaucluse and toulon are differentiated in another cluster cluster 4 due to the low variability of their hydrological functioning the high inertia and homogeneous response of the fontaine vaucluse system can be explained by the thickness of the non saturated zone 800 m in average and the large area of its catchment estimated to be about 1160 km2 ollivier et al 2019 the toulon system defined as a complex karst system by lorette et al 2018 is a multi layer system with the discharge of an unconfined fractured and karstified aquifer that is permanently fed by another confined aquifer this continuous alimentation can explain the mostly homogeneous response of the system 6 proposal of a classification of karst systems hydrological functioning in this section we first present the classification based on the results of multivariate analyses the classification is then applied on both core and complementary datasets to assess the relevance of the approach regarding i the coherence with the well known hydrological functioning of the karst systems in the core dataset and ii the distribution of karst systems among the different classes from a worldwide perspective 6 1 classification of karst systems according to various types of hydrological functioning the exploration realized with pca and clustering confirmed the expected relations between the functioning of karst systems and indicator values in both methods karst systems are first differentiated from two main aspects their capacity of dynamic storage and their capacity to attenuate the precipitation signal the former is expressed through kmax and the latter through imean rt me and sbb n b the absolute values of the pearson correlation coefficients of each pair are greater than 0 85 suggesting strong correlations we chose the indicator rt to characterize the capacity to attenuate the precipitation signal further referred as global inertia as it considers the overall organization of flows in the system the shape and the dimensions of the catchment and the saturation state of the system indeed this indicator is more relevant than i imean which is biased by the number of available recession curves and ii me and sbb because their assessments are somehow questionable as they rely on an arbitrary threshold and a subjective evaluation respectively a second element of differentiation between karst systems is the draining dynamic of the capacitive function of a system with the αmean indicator in this case the mean of α values seems relevant due to the relatively low amplitude of the values for a given system fig 4c a third element of differentiation between systems is the variability of the hydrological response by quantifying the variability of i with the ir indicator the proposed classification thus relies on the following three main characteristics of the hydrological functioning i the capacity of dynamic storage ii the draining dynamic of the capacitive function and iii the variability of the hydrological response these characteristics are assessed using i kmax ii αmean and iii ir indicators respectively based on these 3 distinct characteristics of hydrodynamic behaviour six classes are proposed to discriminate the hydrological functioning of karst systems table 5 fig 8 i c1 poor capacity of dynamic storage with fast draining of the capacitive function and substantial variability of hydrological functioning ii c2 poor capacity of dynamic storage with fast draining of the capacitive function and low variability of hydrological functioning iii c3 poor capacity of dynamic storage with moderate draining of the capacitive function and substantial variability of hydrological functioning iv c4 poor capacity of dynamic storage with moderate draining of the capacitive function and low variability of hydrological functioning v c5 noticeable capacity of dynamic storage with slow draining of the capacitive function and substantial variability of hydrological functioning and vi c6 noticeable capacity of dynamic storage with slow draining of the capacitive function and low variability of hydrological functioning we chose to not include the indicator rt in the classification methodology as it seems that the global inertia of a karst system is relatively independent of its main characteristics of functioning especially for systems in c3 c4 c5 and c6 fig 9 b the proposed classification is based on recession parameters derived from mangin s model for recession simulation this model gave good simulations results over the 78 catchments considered in this study however the good performance of this model should be checked before any use of the classification over other systems to gain insights into the functioning of such systems we recommend the operators to make use of correlational and spectral analyses or analysis of classified discharges which can already give relevant information about global inertia and functioning of a system 6 2 application of the proposed methodology to 78 karst systems the classification was applied on the complementary dataset presented in 2 2 and composed of 68 karst systems plus the 10 core systems for a total of 78 karst systems fig 9a the most represented class is c3 which represents systems with a very low to medium capacity of dynamic storage a moderate to slow draining of the capacitive function and a medium to high variability of the hydrological response about 74 of the systems are characterized with a very low to medium capacity of dynamic storage c1 c2 c3 and c4 26 have a fast draining of their capacitive function c1 and c2 and 67 have a medium to high variability of the hydrological response c1 c3 and c5 rt was calculated for each system except for 1 system in c3 and 4 systems in c2 with too much gaps in the time series with means of 19 5 13 9 31 8 41 4 43 8 and 46 3 days for respectively c1 c2 c3 c4 c5 and c6 fig 9b the small increase of rt throughout the classes is consistent given the functioning description of each class c1 being the most reactive and c6 the most inertial the smaller mean in c2 is related to the structure of the classification a high ir in c3 and c5 means that the hydrological response can be more reactive than expected whereas in c1 it means that the hydrological response can be more inertial than expected it results in a higher rt mean in c1 over c2 as it includes systems with potential inertial responses finally we observed that rt is biased for systems with long dry periods saint pierre or lez systems the latter being under anthropic influence thus it is suggested to not calculate this indicator for these systems the systems are spread across all classes and types of hydrological functioning it means that even applied on a wider dataset there is a relative representativeness of all classes and types of hydrological functioning the spread of the 10 core systems between the six classes somehow confirms the respect of the second criteria for spring selection diversity of the hydrological functioning among the karst systems see section 2 1 and the relevance of the proposed classification 7 discussion the aim of this section is to take a step back on the methodology by questioning some of its limitations and assessing their impact on the relevance of the classification 7 1 influence of the length of the time series on the classification we performed a sensitivity analysis in order to assess the reliability of the classification regarding discharge time series of short length for 9 systems of the 10 core systems toulon was not considered as there is only 5 years of monitoring we defined 7 scenarios that range from 1 year y1 to 7 years y7 length of the discharge time series the classification methodology was then applied on each scenario in order to compare the results to those obtained with the full length fl discharge time series table 6 the accuracy of each indicator increases with the length of the time series fig 10 kmax is the most consistent with a steady decrease throughout the years in the deviation to the kmax value obtained for the full length time series fl indicator αmean becomes more stable and probably more reliable from y5 even though it does not show any significant increase in precision for y6 and y7 ir is highly uncertain for the shorter time series y4 but stabilizes from y5 and become relevant for y6 and y7 aliou baget durzon and mouline were correctly classified from y2 table 6 esperelle and mouthe from y5 and y6 respectively while fontaine de nîmes fontaine de vaucluse and lods were not consistently classified at all the results emphasize the benefits of long term monitoring as there are more chances of observing multiple flood events as well as different meteorological conditions but also highlight several limitations the classification is not reliable if only one recession curve is considered as ir would be 0 when the indicator is close to the threshold it can mislead the classification e g esperelle and fontaine de nîmes for which the variability in αmean can be explained by either a highly variable or a complex hydrological functioning respectively as the maximum observed discharge qmax can change over time this can affect the recession curves selection since only recessions with a peak flood discharge of at least one tenth of the maximum observed discharge are considered for the analysis e g fontaine de nîmes with qmax that went from 8 2 to 16 5 m3 s 1 from y1 to y3 as the mean interannual discharge qmean may vary over years this can induce an evolution of kmax value and thus modify the class of the karst system when the value is close to the threshold e g fontaine de vaucluse for which kmax oscillate around the 0 4 threshold with changes in qmean during the years despite being issued from the same recession curve based on these results we suggest working with at least 3 years length discharge time series for the classification these 3 years should be taken as a guideline and may differ notably depending on the system s dynamics indeed very reactive systems may require only a few years for a definitive classification thanks to their high hydrodynamic variability while the minimum length of the discharge time series required to reach satisfying classification may increase for very inertial systems however it remains appropriate to work with shorter time series when there is no alternative our analysis shows that 7 out of 9 systems are correctly or almost correctly classified at y2 if we include those that are close to the threshold table 6 7 2 evaluation of the distance between a system and other classes the uncertainties related to either i the length of the discharge time series or ii the indicators that are close to the threshold can be addressed by estimating the distance to the other classes the distance ds c of a system s to an adjacent class c is measured with the following equation d s c i th i calc i th where icalc corresponds to the calculated value of a given indicator and ith corresponds to its threshold value the indicator to consider in the calculation is the one that is critical for the class definition i e corresponding to the junction in the flowchart a distance d lower or equal to 0 1 10 can be considered as close to the threshold as the distance increase the system is not likely to be related with the involved class in relation to the structure of the classification there is no need to calculate the distance between classes 1 5 and classes 2 6 as it is highly uncertain that a system has both a kmax higher than 0 4 and a αmean greater or equal than 0 03 hatched area fig 11 a the formula allows for calculating the distance between i classes 1 2 3 4 and 5 6 with ir ii classes 1 3 and 2 4 with αmean and iii classes 3 5 and 4 6 with kmax the distance between diagonal classes can be calculated by applying the pythagorean theorem d s c d s c x 2 d s c y 2 where x and y correspond to two different classes the formula allows for calculating distance between i classes 1 4 and 2 3 with αmean and ir fig 11c and ii classes 3 6 and 4 5 with kmax and ir fig 11b these notions of distances can be more easily appreciated on the fig 12 which shows the 3 dimensional distribution of the karst systems in the kmax αmean and ir space to complement the discussion in section 7 1 related to the close to the threshold systems we calculated the distance to other classes for the 10 core karst systems table 7 the results highlight that i baget is close to c3 ii fontaine de nîmes is close to c4 and iii fontaine de vaucluse is close to c4 regarding the 78 systems only 12 systems are close to a threshold with a distance to another class lower or equal than 0 1 this distance measure allows reflecting on the classification results by highlighting potential threshold issues thus we can tell if a system is clearly into a said class or is close to one or two classes 7 3 beyond the classification correlational spectral and classified discharges analyses can be performed post classification to really exploit the maximum of information that can be obtained by analysing the discharge time series in order to get a deeper knowledge of the functioning of a system we propose to use rt as an additional indicator to complement the above described classification and to gain further insights into the global inertia of a karst system we defined four ranges i lower or equal than 15 days ii greater than 15 days and lower or equal than 30 days iii greater than 30 days and lower or equal than 45 days and iv greater than 45 days which are referred as i low ii medium iii high and iv very high global inertia respectively in a similar manner we propose to perform the visual interpretation of the curve of classified discharges after the classification to have additional information about the presence or absence of major specific functioning for example hr 0020 system has a kmax of 0 07 an αmean of 0 021 day 1 and an ir of 0 34 corresponding to c3 appendix d hr 0020 is thus described as a system with a very low to low capacity of dynamic storage a fast draining of the capacitive function and a medium to high variability of the hydrological response the regulation time of 15 5 days indicates that the system has a medium capacity to attenuate the precipitation signal or medium global inertia the bending point on the curve of classified discharges at 1 8 m3 s 1 may be due to the activation of an overflow outlet a discharge to another system or a temporary storage of water the one at 30 m3 s 1 may translate the same processes but it is not excluded that it can be related to uncertainties on ungauged discharges 8 conclusion our objective was to propose a new classification of karst systems hydrological functioning based on the analysis of spring discharge time series that is representative of a wide diversity of karst systems several methods were considered to identify indicators of functioning multivariate analyses allowed the identification of relevant indicators that allow distinguishing the analysed karst systems three indicators were identified as the most relevant indicators and thus retained to characterize karst systems and propose a classification into six different types of hydrological functioning the hydrological functioning of karst systems was distinguished according to their capacity of dynamic storage the draining dynamic of their capacitive function and the variability of their hydrological functioning the classification can be completed with two additional analyses to characterize the global inertia and highlight the presence or absence of major specific functioning the challenge of developing a relevant classification was addressed i by considering a core dataset of karst systems with a high diversity of hydrological functioning ii by selecting the most relevant indicators of hydrological functioning and proposing a classification based on multivariate analyses and iii by testing the relevance of the classification on spring discharge time series of 78 karst systems located worldwide as the methodology requires only spring discharge time series which is the most common monitored data and gives relevant results with only few years of monitoring the classification can be used in scarce data contexts it can thus be seen as a modern tool for the classification of karst systems hydrological functioning which provides researchers and stakeholders with a first insight into karst system functioning based on accessible and straightforward analyses we emphasize that the proposed typology first aims to describe the hydrological functioning of a system where one single hydrodynamic response to precipitation impulse is expected but remains useful even when two or more responses are observed one perspective of this work would be to provide a database that allows both comparing the hydrological functioning of several karst systems and then proposing a link between the developed classification and the design of lumped parameter models research perspectives include the study of the relation between classification and the relevant structures and parameters of models for rainfall discharge simulation credit authorship contribution statement guillaume cinkus conceptualization methodology software validation formal analysis writing original draft visualization naomi mazzilli conceptualization methodology investigation writing review editing supervision hervé jourde conceptualization methodology investigation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank the french ministry of higher education and research for the thesis scholarship of g cinkus as well as the european commission for its support through the partnership for research and innovation in the mediterranean area prima programme under horizon 2020 karma project grant agreement number 01dh19022a for the data provided the french karst national observatory service sno karst and especially d labat and a probst for the data gathered by a mangin at the baget and aliou springs the parc naturel régional des grands causses pnrgc g lorette for data monitored by suez the dreal provence alpes côtes d azur and the dreal bourgogne franche comté are also acknowledged appendix a calculation details for the correlational and spectral analyses the autocorrelation function rk is calculated with the following equation r k c k c 0 with the autocovariance function ck c k 1 n 1 n k x i x x i k x with k the shift 0 1 2 m n the length of the series m the maximum shift possible generally m n 3 xi the ith element of the series xi t the i t th element of the series and x the mean of the series the correlogram correspond to the plot of rk versus k the spectrum sf is calculated with the following equation s f 2 1 2 k 1 m d k r k c o s 2 π f k with f the frequency f j 2m for daily timestep rk the autocorrelation function and dk a weighting function tukey hanning window to ensure that the estimated sf is not biaised mangin 1984 d k 1 c o s π k m 2 the spectrum is represented on a plot of sf versus f b calculation details for the analysis of classified discharges the procedure to obtain the curve of classified discharges involves in i the quantiles calculation of the empirical distribution function ii the calculation of the corresponding variable from the reference distribution function iii the graphical representation of the relation between the quantiles of the empirical and reference distribution functions and iv the choice of the x axis scale either arithmetic or logarithmic corresponding to a normal or log normal adaptation of the reference distribution respectively the repartition function corresponding to the cumulative probability density regarding the standard normal distribution is p x z 1 2 1 e r f z 2 for a half gaussian distribution p x z e r f z 2 the observed discharges are plotted on the x axis of the quantile quantile plot c results of the v test applied on clusters a b 1 2 3 and 4 d graphical summary of the typology of hr 0020 karst system wokas database olarinoye et al 2020 
3919,in this paper we propose two parameter probability models referred to as modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions for modeling hydro environmental data in the unit interval the mk distribution presents increasing decreasing increasing density shapes while the rmk distribution presents decreasing increasing decreasing shapes which are not obtained in classical distributions for modeling double bounded data such as the beta and kumaraswamy some statistical properties are derived such as moments and quantile function we also consider the maximum likelihood approach for parameter estimation and perform a monte carlo simulation study to evaluate the performance of the estimators on synthetic hydro environmental data finally an empirical application to the percentage of useful volume of 37 brazilian water reservoirs is presented and discussed the modeled densities and goodness of fit measures evidence that the proposed distributions outperform the beta and kumaraswamy models being suitable alternatives for modeling hydro environmental data keywords hydro environmental data kumaraswamy distribution unit distributions percentage of useful volume 1 introduction water resources are essential for the proper functioning of society and perceived in various activities such as human and animal consumption irrigation in agriculture fishing industry operations leisure food production transport and energy generation accurate modeling of hydro environmental random variables is important for good management of water resources and decision making among a multitude of possible hydro environmental data those bounded both at lower and upper ends such as rates proportions and percentages are pivotal in some water resources areas this is the case of the relative humidity which is widely discussed in the literature we can refer the reader to bayer et al 2017 fritz et al 2021 and rodrigues et al 2021 for some case studies that illustrate the relevance of this variable in hydro environmental studies another important indicator is the percentage of useful volume uv of a hydroelectric plant s water reservoir the uv is defined as the volume of water between the maximum and minimum normal operating levels operador nacional do sistema elétrico 2021a assuming values in the unit interval for this type of data the beta distribution see gupta and nadarajah 2004 for more details provides the premier family of continuous distributions on bounded support jones 2009 being useful in a wide range of applications however the beta distribution may not satisfactorily fit hydro environmental processes nadarajah 2008 jones 2009 lemonte et al 2013 bayer et al 2017 in this case the kumaraswamy k distribution stands out being largely perceived in hydro environmental literature jones 2009 as in fletcher and ponnambalam 1996 wang et al 2016 lima filho and bayer 2019 bayer et al 2017 and pumi et al 2020 nevertheless the traditional beta and k densities do not present increasing decreasing increasing or decreasing increasing decreasing shapes which can compromise their use for modeling hydro environmental data with these characteristics in section 6 we provide some real data examples showing that the uv variable may present such behavior modeling uv is important to satisfactory water management grabbing the attention of several researchers ferreira et al 2021 nozari et al 2021 in this context new probability distributions can be introduced to take those features into account and contribute as alternatives when the beta and k distributions are not suitable the objective of this article is twofold first we introduce a two parameter distribution and its reflected version for modeling hydro environmental data and derive some of their mathematical properties named as modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions they are obtained by transforming the k distribution the proposed distributions present density shapes not assumed by the beta and k distributions and semi closed form for the maximum likelihood estimators mles of their parameters they also have a closed form expression for the quantile function which is useful for generating pseudo random numbers the second goal of this paper is to provide a case study to model hydro environmental data using the proposed models this is illustrated by the uv of the main water reservoirs in brazil hydropower is the primary source of electric energy in brazil with an estimated installed hydroelectric capacity representing 64 of the national interconnected system sin in 2021 for 2025 even with the increase in the potential participation of other types of energy e g wind solar and biomass its participation will still be over 60 operador nacional do sistema elétrico 2021b this shows the importance of water resource management for the generation of electricity in the country the mk and rmk distributions have the potential to assist in this management by modeling the uv in brazilian water reservoirs in section 6 we evidence the superiority of mk and rmk in uv fit by considering several goodness of fit gof measures the rest of the paper is structured as follows in section 2 we introduce the mk and rmk models and discuss some density shapes section 3 covers some statistical properties of the proposed distributions the maximum likelihood estimation of the model parameters is addressed in section 4 monte carlo simulation studies are performed in section 5 in section 6 we use uv actual data to compare the performance of the proposed models with classical unit distributions in a case study finally the conclusion of this article is presented in section 7 2 the modified and reflected modified kumaraswamy distributions the number of unit distributions available in the literature is relatively small compared to those supported by real positive values besides the classic beta and k distributions we can cite some advances in the recent literature these new distributions are usually obtained through variable transformations such as the log lindley gómez déniz et al 2014 unit birnbaum saunders mazucheli et al 2018 unit gompertz mazucheli et al 2019 unit weibull mazucheli et al 2019 and unit inverse gaussian ghitany et al 2019 distributions and the unit extended weibull family of distributions guerra et al 2020 however they are not explored in hydro environmental studies and do not assume some shapes of the uv data considered in this study see fig 2 for instance in the following we introduce two probability models with continuous and unitary support 0 1 by transforming a random variable with k distribution useful for modeling double bounded hydro environmental data the random variable x follows a k distribution if its probability density function pdf and cumulative distribution function cdf are given by g x x α β α β x α 1 1 x α β 1 and g x x α β 1 1 x α β respectively where x 0 1 and α β 0 are shape parameters kumaraswamy 1980 we denote x k α β we derive the mk distribution by making the transformation y 1 log x 1 under this approach the transformed random variable y takes values in the unit interval and has pdf and cdf given respectively by 1 f y y θ α β e α α y 1 e α α y β 1 y 2 0 y 1 and 2 f y y θ 1 1 e α α y β where θ α β α 0 and β 0 are shape parameters hereafter a random variable y with pdf in eq 1 is denoted by y mk α β the rmk distribution is obtained from the reflection relation of y around one thus the random variable z 1 y has rmk distribution and its pdf possesses the following representation 3 f z z θ α β e z α z 1 1 e z α z 1 β 1 z 1 2 0 z 1 where θ α β the corresponding cdf is 4 f z z θ 1 e z α z 1 β hereafter let z be a random variable having a rmk pdf in eq 3 say z rmk α β we notice that like the beta and k distributions the mk and rmk models are still useful for situations where the variable of interest is restricted to any double bounded interval a b where a and b are known scalars with a b in such cases we can model y a b a and z a b a respectively instead of modeling y and z directly the proposed distributions also present some relations with other well known probability models we derive some of these relations in appendix a fig 1 presents some shapes of the pdf in eq 1 the mk distribution can be useful for modeling both left and right skewed data heavy or non heavy tails and increasing decreasing increasing shapes as illustrated in section 6 these features are useful for modeling hydro environmental data making the mk distribution quite competitive with other classical unit models especially because the increasing decreasing increasing shape is not assumed by the beta and k distributions given the relationship between the mk and rmk distributions the rmk density shapes reflect those of the mk distribution note that the rmk pdf in eq 3 assumes the decreasing increasing decreasing format while the mk pdf in eq 1 presents the increasing decreasing increasing shape to illustrate such a relationship we developed a shiny application that allows the reader to access dynamic plots with other parameter value combinations and density shapes it is available in sagrillo et al 2021 furthermore the following proposition presents the critical points and exact behavior of the mk pdf for some parameter sets proposition 2 1 let y be a random variable following the mk distribution with pdf in 1 then a its density has critical point s obtained from the roots of the following equation α y α β 1 e α α y y 1 e α α y 2 0 which can be solved numerically b if β 1 and α 2 then the pdf of y is monotonic increasing c if β 1 and α 2 then the pdf of y is unimodal with mode at y α 2 d if β 1 and α 2 then the pdf of y is monotonic increasing proof 2 1 a the result follows by computing the first derivative of the logarithm of 1 with respect to y which is given by 5 d log f y y θ d y 1 y α y α β 1 e α α y y 1 e α α y 2 b it holds by noting that eq 5 is positive for β 1 α 2 and y 0 1 c if β 1 then eq 5 reduces to 6 d log f y y θ d y 1 y α y 2 and the second order derivative of log f y y θ with respect to y is d 2 log f y y θ d y 2 2 y 1 y α y 2 thus the critical point of the mk density is the root of 6 which is in the unit interval if α 2 then this root is given by y α 2 and it is a maximum point since d 2 log f y y θ d y 2 y y 8 α 2 0 d if α 2 then y 0 1 and eq 6 is positive y 0 1 which completes the proof 3 statistical properties in this section some statistical properties of the mk and rmk distributions are presented such as quantile measures and ordinary moments these measures are potentially useful for the description and interpretation of hydro environmental data because they provide important data features such as tendency variability skewness and kurtosis 3 1 moments statistical moments and related measures are important to define uncertainty characteristics of the random variable tung 1990 the hth moment of y is defined as e y h 0 1 y h f y y d y then using binomial expansion in 1 e α α y β 1 and after some algebraic manipulation we have 7 e y h α β e α i 0 1 i β 1 i e α i α α i h 1 γ 1 h i 1 α where γ a w w t a 1 e t d t is the upper incomplete gamma function the mean μ and variance σ 2 of y important measures of central tendency and dispersion can be easily derived from eq 7 as μ e y α β e α i 0 1 i β 1 i e α i γ 0 i 1 α σ 2 e y 2 e y 2 α 2 β e α i 0 1 i β 1 i e α i i 1 γ 1 i 1 α μ 2 respectively which are easily computed in any programming language note that the hth moment of z can be written as e z e 1 y h therefore using 1 y h and the binomial theorem we have 8 e z h j 0 h 1 j h j e y j eqs 7 and 8 are the main results of this subsection see subsection 3 3 for illustrative examples on these measures 3 2 quantile measures and pseudo random number sampling by inverting eqs 2 and 4 we obtain the quantile function of y and z which are given by 9 q y u θ α α log 1 1 u 1 β and 10 q z u θ 1 q y 1 u θ log 1 u 1 β log 1 u 1 β α respectively we note that the quantile functions present very simple closed forms and can be used to calculate return levels of extreme double bounded hydro environmental variables the rth return level is given by the 1 r 1 th quantile of each distribution if u is an observation from a uniform random variable on the unit interval by replacing u in eqs 9 and 10 we obtain a pseudo random number from the respective distributions by the probability integral transform furthermore we obtain the quantiles of the distribution with appropriate substitutions of u in eqs 9 and 10 by taking u 1 2 for example we obtain the median md an important measure of central tendency for asymmetric distributions some other quantiles are also important in hydro environmental data for example lins and slack 1999 showed how streamflow regimes change over time by using their percentiles 3 3 skewness and kurtosis skewness and kurtosis coefficients are useful measures for physical interpretations of extreme events rice et al 2015 it is reasonable to assume the concepts defined by rice et al 2015 for hydro environmental variables in general the skewness coefficient allows us to measure the disparity between extremely large or small and typical values in comparison the kurtosis coefficient illustrates the propensity for the occurrence of these extreme values note that such measures are convenient for comparing different hydro environmental data types such as geographic regions periods or in our case water reservoirs these coefficients can be computed based on the quantile function the bowley s skewness kenney and keeping 1962 and moors kurtosis moors 1988 measures of a random variable t y z are given by s b q t 3 4 θ q t 1 4 θ 2 q t 1 2 θ q t 3 4 θ q t 1 4 θ and k m q t 7 8 θ q t 1 8 θ q t 5 8 θ q t 3 8 θ q t 6 8 θ q t 2 8 θ respectively where q t u θ is the quantile function of t to corroborate with the qualitative analysis in fig 1 table 1 provides the first two moments σ 2 percentage coefficient of variation given by cv σ μ 100 md s b and k m of some scenarios obtained using the analytical results presented in this section the expansion in eq 7 was truncated when the difference between the i 1 and i elements of the sum was lower than 1 e 9 and e y and e y 2 were computed using numerical integration in order to compare with the obtained expansions note that the higher the value of α and the lower the value of β the greater the moment values and median the σ 2 presents the highest values for low α and β values also the lower the α value and the higher the β value the higher the cv and s b values finally note that the e y and e y 2 results obtained through expansion and numerical integration are approximately equal showing that the analytical expression in eq 7 is suitable for obtaining them the previous interpretations can be useful to describe and compare the behavior of a variable in different datasets as we shall discuss in section 6 4 maximum likelihood estimation this section covers the estimation of unknown parameters of the mk distribution using the maximum likelihood method pawitan 2001 let y 1 y n be a sample of size n from the mk α β model the log likelihood function of θ can be expressed as 11 ℓ θ n α n log α n log β α i 1 n 1 y i 2 i 1 n log y i β 1 i 1 n log 1 e α α y i the components of the score vector u θ ℓ θ α ℓ θ β are given by ℓ θ α n n α β 1 e α i 1 n y i 1 y i e α e α y i i 1 n 1 y i and ℓ θ β n β i 1 n log 1 e α α y i the mles of θ denoted by θ α β are obtained as the simultaneous solution of u θ 0 where 0 is a two dimensional null vector this solution cannot be expressed in closed form however for a fixed α we can obtain a semi closed mle for β from u β θ 0 the mle of β is given by β α n i 1 n log 1 e α α y i where α is obtained numerically using the broyden fletcher goldfarb shanno bfgs optimization algorithm nocedal and wright 1999 the point estimation of the rmk distribution can be derived through similar computations note that the log likelihood of z is obtained by taking y i 1 z i in eq 11 under standard regularity conditions for more details see pawitan 2001 θ is asymptotically n normally distributed as n θ k θ where k θ h θ 1 θ θ is the asymptotic variance covariance matrix of θ h θ is the observed information matrix and h θ is the hessian matrix given by h θ 2 ℓ θ θ θ 2 ℓ θ α 2 2 ℓ θ α β 2 ℓ θ β α 2 ℓ θ β 2 where 2 ℓ θ α 2 n α 2 β 1 2 i 1 n y i 1 2 y i 2 cosh α α y i 1 2 ℓ θ β 2 n β 2 2 ℓ θ α β 2 ℓ θ β α e α i 1 n y i 1 y i e α e α y i and cosh w 1 2 e w e 2 w 1 is the hyperbolic cosine function the asymptotic distribution of θ can be used to construct approximate confidence intervals for θ asymptotic 1 λ confidence intervals are given by θ q 1 λ 2 ep θ θ q 1 λ 2 ep θ where ep θ diag k θ 1 2 is the standard error estimate of θ q is the standard gaussian quantile function and λ is the probability of type i error typically λ is set at 0 1 0 05 or 0 01 5 computational simulation study monte carlo simulations are performed in the r statistical computing environment r core team 2019 to evaluate the performance of the mles of the mk distribution parameters on synthetic hydro environmental data the simulation scenarios considered reflect real datasets on the uv of water reservoirs we simulate 10 000 occurrences of the mk distribution with sizes n equal to 10 20 30 50 100 and 150 the percentage relative bias rb and mean square error mse measures are adopted in the numerical evaluation of the point estimators to evaluate the interval estimation we consider a coverage rate cr of 0 95 with λ 0 05 for each parameter the results are summarized in table 2 as expected the rb and mse measures tend to zero as the sample size increases being numerical evidence of the consistency of the mles also the cr values are close to the nominal level of 0 95 in all scenarios even in small sample sizes note that rb has similar behavior among the scenarios with the same value of β when analyzing mse it tends to be higher for larger values of α and β thus the mle s present better performance for lower α and β values in the analyzed scenarios also the bias for β tends to be smaller for lower values of β and consequently more accurate overall the numerical results show that the considered likelihood inference method performs well in all sample sizes r language implementations to fit the mk and rmk models are available in sagrillo et al 2021 in addition to the functions to fit the proposed models we also provide the pdf cdf quantile function and implementations for generating pseudo random numbers of each distribution 6 case study an analysis of useful volume of water reservoirs in this section we present a case study of 37 reservoirs from different brazilian hydropower plants the datasets refer to the monthly uv percentage of useful volume of the main hydroelectric plant s water reservoirs of the sin brazil each reservoir is classified in one of the four sin subsystems named south southeast midwest northeast and north however two of these reservoirs três marias and serra da mesa are part of two subsystems in this study we consider them in the subsystems whose participation is greater therefore the number of reservoirs in each subsystem is 12 18 4 and 3 for the south southeast midwest northeast and north subsystem respectively operador nacional do sistema elétrico 2021b the data are available at operador nacional do sistema elétrico 2020a we compared the proposed probabilistic models with some classic unit distributions most of the datasets range from january 2011 to december 2019 the exceptions are the maua batalha and balbina reservoirs the starting period of the maua reservoir was october 2012 while for the batalha and balbina reservoirs it was january 2013 months with missing values were discarded from the sample for each reservoir we fitted the mk rmk beta and k models and computed the following gof statistics akaike information criterion aic akaike 1974 corrected statistics of cramér von mises w chen and balakrishnan 1995 anderson darling a statistic chen and balakrishnan 1995 and kolmogorov smirnov ks test statistic the aic would be more suitable for nested models which is not the case in our study the w and a statistics are often used to compare non nested models marinho et al 2019 the ks is a well known nonparametric test moccia et al 2021 used to decide if a sample comes from a population with a specific distribution for fitting the beta and k distributions the goodness fit function from the adequacymodel package marinho et al 2019 in r was used the lower the gof measure the better is the model fit for the data parameter estimates and gof measures for all datasets are presented in appendix b because there is no consensus in literature about the best quantitative measure for comparing different distributions the best fitted model for each reservoir was selected based on the smallest values in most gof measures finally we counted the number of times each distribution yielded the best fit in each subsystem these quantitative results can be found in table 3 table 3 highlights the superiority of the proposed distributions over the classical beta and k distributions for modeling the uv of water reservoirs since they provided the highest number of best fits in all subsystems concerning the south subsystem 100 of the datasets are best fitted by the mk and rmk distributions the overall performance shows that about 83 8 of the datasets 70 3 for mk and 13 5 for rmk are best fitted by the proposed models each classical distribution presented the best fit only 8 1 of the times i e only 3 out of 37 datasets in order to explore a qualitative analysis fig 2 provides some graphical representations composed of the histogram of the observed data boxplot and fitted densities and fig 3 presents some quantile quantile qq plots for brevity we selected six reservoirs where the mk presented the best fit the mk distribution overcomes limitations on beta and k models for dealing with increasing decreasing increasing density shapes which are observed in uv data see figs 2 a 2 b and 2 c for instance in appendix c we present several fitted densities of all four distributions for other reservoirs the graphical results in general show the flexibility and superiority of the new distributions for fitting hydro environmental data under different degrees of variability skewness and kurtosis hence the mk and rmk distributions can be effective alternatives to the well known beta and k distributions for modeling double bounded hydro environmental data based on the best model for each dataset we computed several useful statistical quantities for hydro environmental analysis we considered the following measures number of observations n minimum min maximum max mean md σ 2 cv s b and k m the mean md σ 2 s b and k m are computed as in section 3 replacing the parameters by their mles for the beta and k distributions the measures were computed analogously table 4 shows the results for instance we note that the ernestina reservoir never had a uv below 0 230 in this reservoir the uv presents homogeneously high values with the following estimated measures σ 2 0 047 cv 25 748 μ 0 842 and md 0 961 according to s b 0 698 and k m 1 459 it has a left skewed tail and the mass of observations are close to the upper limit of the unit interval also to show the ability of the proposed distributions to describe datasets with various characteristics table 5 presents some sample statistics notice that the estimated quantities based on the mles table 4 are close to the sample measures corroborating the previous sentence the largest percentage differences between some values in table 4 and the sample measurements were in the mean of três irmãos reservoir 11 in the median of balbina reservoir 19 in the variance and coefficient of variation of i solteira reservoir 25 and 20 respectively overall the variabilities of the datasets are not very low and this may be because the data are related to time and the observed variables are under the influence of some climate conditions throughout the year de freitas and da silva soito 2008 fig 4 allows for a comparative analysis of the median and cv among different subsystems different location and dispersion measures are expected given the different climate types water availability soil types territorial dimension etc in each region in fact it is known about water availability restrictions in the northeast due to droughts and in the southeast by the soils and rivers degradation de freitas and da silva soito 2008 the most favorable situation is found in the south subsystem where 50 of the reservoirs present median uv between 0 63 and 0 80 it is also the subsystem with lower cv which does not exceed 48 2 indicating that the south subsystem has the greatest homogeneity indeed the southern region of brazil is one of the best watered regions and is also characterized by uniform precipitations nimer 1971 gonçalves and back 2018 such features may result in some distribution shapes of the reservoirs in the southern region that justify the superiority of the mk and rmk distributions for fitting these datasets finally note that with accurately fitted distributions we can estimate the probabilities associated with each dataset which can be useful for decision making for example we can use the cdf at any percentage of volume y evaluated at the mles α β to obtain the probability that the reservoir will operate with monthly uv below or above y i e we compute p y y table 6 shows several of these probabilities for each reservoir it can be useful for issues related to reservoir operation flood control and environmental monitoring for instance the operation of the paraibuna reservoir can only operate with uv greater than 0 1 operador nacional do sistema elétrico 2016 so the probability of the reservoir stop operating due to insufficient uv is p y 0 1 0 119 such an event may require the participation of other types of plants e g thermoelectric to supply the demand of the stopped reservoir increasing the costs of production in the salto santiago reservoir the uv must be greater than 0 7 operador nacional do sistema elétrico 2020b if it is lower there is an intensification in the formation of temporary ponds on its margin where fish are trapped this is an important environmental problem to be avoided because not all fish can be saved according to table 6 the occurrence probability of uv values below 0 7 in this reservoir is 0 477 the itaparica reservoir goes into a flood alert situation for uv approximately greater than 0 70 operador nacional do sistema elétrico 2003 then using table 6 there is a probability of p y 0 7 1 p y 0 7 0 108 that the reservoir goes into a flood alert situation this situation characterizes floods and indicates among other things that there may be hydraulic restrictions on the reservoir being violated operador nacional do sistema elétrico 2003 7 conclusions in this paper we proposed two probability models based on a transformation of the kumaraswamy distribution for modeling hydro environmental data named modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions our monte carlo simulation evidence showed an adequate performance of the maximum likelihood estimators of the mk model parameters through applications in several percentages of useful volume uv datasets from the main water reservoirs of hydroelectric plants in brazil we showed that the proposed models presented the best fits for this type of data we also introduced important statistical properties and measures of these models that can be useful for describing and interpreting hydro environmental data in addition within the scope of hydraulic operation the proposed models can assist in the decision making process risk management and environmental monitoring for future works we envisage to explore the introduced mk and rmk models for modeling extreme maximum or minimum bounded variables and investigate robust estimation methods such as weighted maximum likelihood and l moments estimators these methods are suitable for hydro environmental analysis when outliers are observed credit authorship contribution statement murilo sagrillo conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization renata rojas guerra conceptualization methodology software validation investigation writing original draft writing review editing visualization supervision project administration fábio m bayer conceptualization methodology software validation investigation writing original draft writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we gratefully acknowledge partial financial support from capes and cnpq brazil we thank an associate editor and two anonymous referees for comments and suggestions that led to a much improved manuscript appendix a in this appendix we present the relations of the proposed distributions with some well known probability models proposition 7 1 about the relation of mk and rmk distributions with well known distributions we have that a if y mk α β then exp 1 1 y k α β b if y mk α β then 1 y 1 exponentiated exponential ee distribution gupta and kundu 1999 c if y mk 1 β then exp 1 1 y beta 1 β d if y mk α 1 then exp 1 1 y beta α 1 e if y mk α 1 then 1 y 1 exponential distribution f if z rmk α β then exp z z 1 k α β g if z rmk α β then z 1 z ee distribution h if z rmk 1 β then exp z z 1 beta 1 β i if z rmk α 1 then exp z z 1 beta α 1 j if z rmk α 1 then z 1 z exponential distribution proof 7 1 a let w exp 1 1 y then f w w α β p exp 1 1 y w p y 1 log w 1 f y 1 log w 1 α β by replacing 1 log w 1 in eq 2 we have that f w w α β 1 1 w α β which is the pdf of the k distribution b let w 1 y 1 then f w w α β p 1 y 1 w 1 p y 1 w 1 1 f y 1 w 1 α β by replacing 1 w 1 in eq 2 we have that f w w α β 1 exp w α β which is the pdf of the ee distribution c let w exp 1 1 y then using the proof in a and the relation beta 1 β k 1 β we have f w w β 1 1 w β which is the pdf of the beta distribution with α 1 d let w exp 1 1 y then using the proof in a and the relation beta α 1 k α 1 we have f w w α w α which is the pdf of the beta distribution with β 1 e let w 1 y 1 then using the proof in b and the relation ee α 1 exponential distribution we have f w w α 1 exp w α which is the pdf of the exponential distribution f let w exp z z 1 then f w w α β p exp z z 1 w 1 p z log w log w 1 1 f z log w log w 1 α β by replacing log w log w 1 in eq 4 we have that f w w α β 1 1 w α β which is the pdf of the k distribution g let w z 1 z then f w w α β p z 1 z w p z w 1 w f z w 1 w α β by replacing w 1 w in eq 4 we obtain f w w α β 1 exp w α β which is the pdf of the ee distribution h let w exp z z 1 then using the proof in f and the relation beta 1 β k 1 β we have f w w β 1 1 w β which is the pdf of the beta distribution with α 1 i let w exp z z 1 then using the proof in f and the relation beta α 1 k α 1 it follows that f w w α w α which is the pdf of the beta distribution with β 1 j let w z 1 z then using the proof in g and the relation ee α 1 exponential distribution we have f w w α 1 exp w α which is the pdf of the exponential distribution appendix b here we present the gof statistics for the models adjusted to the uv data related to the reservoirs of all subsystems of the sin results for the south southeast midwest northeast and north subsystems are summarized in tables 7 10 respectively the best results are in boldface appendix c in this appendix in fig 5 we present some graphical representations composed of histrograms and boxplots of the observed data and fitted densities of the mk rmk beta and k distributions 
3919,in this paper we propose two parameter probability models referred to as modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions for modeling hydro environmental data in the unit interval the mk distribution presents increasing decreasing increasing density shapes while the rmk distribution presents decreasing increasing decreasing shapes which are not obtained in classical distributions for modeling double bounded data such as the beta and kumaraswamy some statistical properties are derived such as moments and quantile function we also consider the maximum likelihood approach for parameter estimation and perform a monte carlo simulation study to evaluate the performance of the estimators on synthetic hydro environmental data finally an empirical application to the percentage of useful volume of 37 brazilian water reservoirs is presented and discussed the modeled densities and goodness of fit measures evidence that the proposed distributions outperform the beta and kumaraswamy models being suitable alternatives for modeling hydro environmental data keywords hydro environmental data kumaraswamy distribution unit distributions percentage of useful volume 1 introduction water resources are essential for the proper functioning of society and perceived in various activities such as human and animal consumption irrigation in agriculture fishing industry operations leisure food production transport and energy generation accurate modeling of hydro environmental random variables is important for good management of water resources and decision making among a multitude of possible hydro environmental data those bounded both at lower and upper ends such as rates proportions and percentages are pivotal in some water resources areas this is the case of the relative humidity which is widely discussed in the literature we can refer the reader to bayer et al 2017 fritz et al 2021 and rodrigues et al 2021 for some case studies that illustrate the relevance of this variable in hydro environmental studies another important indicator is the percentage of useful volume uv of a hydroelectric plant s water reservoir the uv is defined as the volume of water between the maximum and minimum normal operating levels operador nacional do sistema elétrico 2021a assuming values in the unit interval for this type of data the beta distribution see gupta and nadarajah 2004 for more details provides the premier family of continuous distributions on bounded support jones 2009 being useful in a wide range of applications however the beta distribution may not satisfactorily fit hydro environmental processes nadarajah 2008 jones 2009 lemonte et al 2013 bayer et al 2017 in this case the kumaraswamy k distribution stands out being largely perceived in hydro environmental literature jones 2009 as in fletcher and ponnambalam 1996 wang et al 2016 lima filho and bayer 2019 bayer et al 2017 and pumi et al 2020 nevertheless the traditional beta and k densities do not present increasing decreasing increasing or decreasing increasing decreasing shapes which can compromise their use for modeling hydro environmental data with these characteristics in section 6 we provide some real data examples showing that the uv variable may present such behavior modeling uv is important to satisfactory water management grabbing the attention of several researchers ferreira et al 2021 nozari et al 2021 in this context new probability distributions can be introduced to take those features into account and contribute as alternatives when the beta and k distributions are not suitable the objective of this article is twofold first we introduce a two parameter distribution and its reflected version for modeling hydro environmental data and derive some of their mathematical properties named as modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions they are obtained by transforming the k distribution the proposed distributions present density shapes not assumed by the beta and k distributions and semi closed form for the maximum likelihood estimators mles of their parameters they also have a closed form expression for the quantile function which is useful for generating pseudo random numbers the second goal of this paper is to provide a case study to model hydro environmental data using the proposed models this is illustrated by the uv of the main water reservoirs in brazil hydropower is the primary source of electric energy in brazil with an estimated installed hydroelectric capacity representing 64 of the national interconnected system sin in 2021 for 2025 even with the increase in the potential participation of other types of energy e g wind solar and biomass its participation will still be over 60 operador nacional do sistema elétrico 2021b this shows the importance of water resource management for the generation of electricity in the country the mk and rmk distributions have the potential to assist in this management by modeling the uv in brazilian water reservoirs in section 6 we evidence the superiority of mk and rmk in uv fit by considering several goodness of fit gof measures the rest of the paper is structured as follows in section 2 we introduce the mk and rmk models and discuss some density shapes section 3 covers some statistical properties of the proposed distributions the maximum likelihood estimation of the model parameters is addressed in section 4 monte carlo simulation studies are performed in section 5 in section 6 we use uv actual data to compare the performance of the proposed models with classical unit distributions in a case study finally the conclusion of this article is presented in section 7 2 the modified and reflected modified kumaraswamy distributions the number of unit distributions available in the literature is relatively small compared to those supported by real positive values besides the classic beta and k distributions we can cite some advances in the recent literature these new distributions are usually obtained through variable transformations such as the log lindley gómez déniz et al 2014 unit birnbaum saunders mazucheli et al 2018 unit gompertz mazucheli et al 2019 unit weibull mazucheli et al 2019 and unit inverse gaussian ghitany et al 2019 distributions and the unit extended weibull family of distributions guerra et al 2020 however they are not explored in hydro environmental studies and do not assume some shapes of the uv data considered in this study see fig 2 for instance in the following we introduce two probability models with continuous and unitary support 0 1 by transforming a random variable with k distribution useful for modeling double bounded hydro environmental data the random variable x follows a k distribution if its probability density function pdf and cumulative distribution function cdf are given by g x x α β α β x α 1 1 x α β 1 and g x x α β 1 1 x α β respectively where x 0 1 and α β 0 are shape parameters kumaraswamy 1980 we denote x k α β we derive the mk distribution by making the transformation y 1 log x 1 under this approach the transformed random variable y takes values in the unit interval and has pdf and cdf given respectively by 1 f y y θ α β e α α y 1 e α α y β 1 y 2 0 y 1 and 2 f y y θ 1 1 e α α y β where θ α β α 0 and β 0 are shape parameters hereafter a random variable y with pdf in eq 1 is denoted by y mk α β the rmk distribution is obtained from the reflection relation of y around one thus the random variable z 1 y has rmk distribution and its pdf possesses the following representation 3 f z z θ α β e z α z 1 1 e z α z 1 β 1 z 1 2 0 z 1 where θ α β the corresponding cdf is 4 f z z θ 1 e z α z 1 β hereafter let z be a random variable having a rmk pdf in eq 3 say z rmk α β we notice that like the beta and k distributions the mk and rmk models are still useful for situations where the variable of interest is restricted to any double bounded interval a b where a and b are known scalars with a b in such cases we can model y a b a and z a b a respectively instead of modeling y and z directly the proposed distributions also present some relations with other well known probability models we derive some of these relations in appendix a fig 1 presents some shapes of the pdf in eq 1 the mk distribution can be useful for modeling both left and right skewed data heavy or non heavy tails and increasing decreasing increasing shapes as illustrated in section 6 these features are useful for modeling hydro environmental data making the mk distribution quite competitive with other classical unit models especially because the increasing decreasing increasing shape is not assumed by the beta and k distributions given the relationship between the mk and rmk distributions the rmk density shapes reflect those of the mk distribution note that the rmk pdf in eq 3 assumes the decreasing increasing decreasing format while the mk pdf in eq 1 presents the increasing decreasing increasing shape to illustrate such a relationship we developed a shiny application that allows the reader to access dynamic plots with other parameter value combinations and density shapes it is available in sagrillo et al 2021 furthermore the following proposition presents the critical points and exact behavior of the mk pdf for some parameter sets proposition 2 1 let y be a random variable following the mk distribution with pdf in 1 then a its density has critical point s obtained from the roots of the following equation α y α β 1 e α α y y 1 e α α y 2 0 which can be solved numerically b if β 1 and α 2 then the pdf of y is monotonic increasing c if β 1 and α 2 then the pdf of y is unimodal with mode at y α 2 d if β 1 and α 2 then the pdf of y is monotonic increasing proof 2 1 a the result follows by computing the first derivative of the logarithm of 1 with respect to y which is given by 5 d log f y y θ d y 1 y α y α β 1 e α α y y 1 e α α y 2 b it holds by noting that eq 5 is positive for β 1 α 2 and y 0 1 c if β 1 then eq 5 reduces to 6 d log f y y θ d y 1 y α y 2 and the second order derivative of log f y y θ with respect to y is d 2 log f y y θ d y 2 2 y 1 y α y 2 thus the critical point of the mk density is the root of 6 which is in the unit interval if α 2 then this root is given by y α 2 and it is a maximum point since d 2 log f y y θ d y 2 y y 8 α 2 0 d if α 2 then y 0 1 and eq 6 is positive y 0 1 which completes the proof 3 statistical properties in this section some statistical properties of the mk and rmk distributions are presented such as quantile measures and ordinary moments these measures are potentially useful for the description and interpretation of hydro environmental data because they provide important data features such as tendency variability skewness and kurtosis 3 1 moments statistical moments and related measures are important to define uncertainty characteristics of the random variable tung 1990 the hth moment of y is defined as e y h 0 1 y h f y y d y then using binomial expansion in 1 e α α y β 1 and after some algebraic manipulation we have 7 e y h α β e α i 0 1 i β 1 i e α i α α i h 1 γ 1 h i 1 α where γ a w w t a 1 e t d t is the upper incomplete gamma function the mean μ and variance σ 2 of y important measures of central tendency and dispersion can be easily derived from eq 7 as μ e y α β e α i 0 1 i β 1 i e α i γ 0 i 1 α σ 2 e y 2 e y 2 α 2 β e α i 0 1 i β 1 i e α i i 1 γ 1 i 1 α μ 2 respectively which are easily computed in any programming language note that the hth moment of z can be written as e z e 1 y h therefore using 1 y h and the binomial theorem we have 8 e z h j 0 h 1 j h j e y j eqs 7 and 8 are the main results of this subsection see subsection 3 3 for illustrative examples on these measures 3 2 quantile measures and pseudo random number sampling by inverting eqs 2 and 4 we obtain the quantile function of y and z which are given by 9 q y u θ α α log 1 1 u 1 β and 10 q z u θ 1 q y 1 u θ log 1 u 1 β log 1 u 1 β α respectively we note that the quantile functions present very simple closed forms and can be used to calculate return levels of extreme double bounded hydro environmental variables the rth return level is given by the 1 r 1 th quantile of each distribution if u is an observation from a uniform random variable on the unit interval by replacing u in eqs 9 and 10 we obtain a pseudo random number from the respective distributions by the probability integral transform furthermore we obtain the quantiles of the distribution with appropriate substitutions of u in eqs 9 and 10 by taking u 1 2 for example we obtain the median md an important measure of central tendency for asymmetric distributions some other quantiles are also important in hydro environmental data for example lins and slack 1999 showed how streamflow regimes change over time by using their percentiles 3 3 skewness and kurtosis skewness and kurtosis coefficients are useful measures for physical interpretations of extreme events rice et al 2015 it is reasonable to assume the concepts defined by rice et al 2015 for hydro environmental variables in general the skewness coefficient allows us to measure the disparity between extremely large or small and typical values in comparison the kurtosis coefficient illustrates the propensity for the occurrence of these extreme values note that such measures are convenient for comparing different hydro environmental data types such as geographic regions periods or in our case water reservoirs these coefficients can be computed based on the quantile function the bowley s skewness kenney and keeping 1962 and moors kurtosis moors 1988 measures of a random variable t y z are given by s b q t 3 4 θ q t 1 4 θ 2 q t 1 2 θ q t 3 4 θ q t 1 4 θ and k m q t 7 8 θ q t 1 8 θ q t 5 8 θ q t 3 8 θ q t 6 8 θ q t 2 8 θ respectively where q t u θ is the quantile function of t to corroborate with the qualitative analysis in fig 1 table 1 provides the first two moments σ 2 percentage coefficient of variation given by cv σ μ 100 md s b and k m of some scenarios obtained using the analytical results presented in this section the expansion in eq 7 was truncated when the difference between the i 1 and i elements of the sum was lower than 1 e 9 and e y and e y 2 were computed using numerical integration in order to compare with the obtained expansions note that the higher the value of α and the lower the value of β the greater the moment values and median the σ 2 presents the highest values for low α and β values also the lower the α value and the higher the β value the higher the cv and s b values finally note that the e y and e y 2 results obtained through expansion and numerical integration are approximately equal showing that the analytical expression in eq 7 is suitable for obtaining them the previous interpretations can be useful to describe and compare the behavior of a variable in different datasets as we shall discuss in section 6 4 maximum likelihood estimation this section covers the estimation of unknown parameters of the mk distribution using the maximum likelihood method pawitan 2001 let y 1 y n be a sample of size n from the mk α β model the log likelihood function of θ can be expressed as 11 ℓ θ n α n log α n log β α i 1 n 1 y i 2 i 1 n log y i β 1 i 1 n log 1 e α α y i the components of the score vector u θ ℓ θ α ℓ θ β are given by ℓ θ α n n α β 1 e α i 1 n y i 1 y i e α e α y i i 1 n 1 y i and ℓ θ β n β i 1 n log 1 e α α y i the mles of θ denoted by θ α β are obtained as the simultaneous solution of u θ 0 where 0 is a two dimensional null vector this solution cannot be expressed in closed form however for a fixed α we can obtain a semi closed mle for β from u β θ 0 the mle of β is given by β α n i 1 n log 1 e α α y i where α is obtained numerically using the broyden fletcher goldfarb shanno bfgs optimization algorithm nocedal and wright 1999 the point estimation of the rmk distribution can be derived through similar computations note that the log likelihood of z is obtained by taking y i 1 z i in eq 11 under standard regularity conditions for more details see pawitan 2001 θ is asymptotically n normally distributed as n θ k θ where k θ h θ 1 θ θ is the asymptotic variance covariance matrix of θ h θ is the observed information matrix and h θ is the hessian matrix given by h θ 2 ℓ θ θ θ 2 ℓ θ α 2 2 ℓ θ α β 2 ℓ θ β α 2 ℓ θ β 2 where 2 ℓ θ α 2 n α 2 β 1 2 i 1 n y i 1 2 y i 2 cosh α α y i 1 2 ℓ θ β 2 n β 2 2 ℓ θ α β 2 ℓ θ β α e α i 1 n y i 1 y i e α e α y i and cosh w 1 2 e w e 2 w 1 is the hyperbolic cosine function the asymptotic distribution of θ can be used to construct approximate confidence intervals for θ asymptotic 1 λ confidence intervals are given by θ q 1 λ 2 ep θ θ q 1 λ 2 ep θ where ep θ diag k θ 1 2 is the standard error estimate of θ q is the standard gaussian quantile function and λ is the probability of type i error typically λ is set at 0 1 0 05 or 0 01 5 computational simulation study monte carlo simulations are performed in the r statistical computing environment r core team 2019 to evaluate the performance of the mles of the mk distribution parameters on synthetic hydro environmental data the simulation scenarios considered reflect real datasets on the uv of water reservoirs we simulate 10 000 occurrences of the mk distribution with sizes n equal to 10 20 30 50 100 and 150 the percentage relative bias rb and mean square error mse measures are adopted in the numerical evaluation of the point estimators to evaluate the interval estimation we consider a coverage rate cr of 0 95 with λ 0 05 for each parameter the results are summarized in table 2 as expected the rb and mse measures tend to zero as the sample size increases being numerical evidence of the consistency of the mles also the cr values are close to the nominal level of 0 95 in all scenarios even in small sample sizes note that rb has similar behavior among the scenarios with the same value of β when analyzing mse it tends to be higher for larger values of α and β thus the mle s present better performance for lower α and β values in the analyzed scenarios also the bias for β tends to be smaller for lower values of β and consequently more accurate overall the numerical results show that the considered likelihood inference method performs well in all sample sizes r language implementations to fit the mk and rmk models are available in sagrillo et al 2021 in addition to the functions to fit the proposed models we also provide the pdf cdf quantile function and implementations for generating pseudo random numbers of each distribution 6 case study an analysis of useful volume of water reservoirs in this section we present a case study of 37 reservoirs from different brazilian hydropower plants the datasets refer to the monthly uv percentage of useful volume of the main hydroelectric plant s water reservoirs of the sin brazil each reservoir is classified in one of the four sin subsystems named south southeast midwest northeast and north however two of these reservoirs três marias and serra da mesa are part of two subsystems in this study we consider them in the subsystems whose participation is greater therefore the number of reservoirs in each subsystem is 12 18 4 and 3 for the south southeast midwest northeast and north subsystem respectively operador nacional do sistema elétrico 2021b the data are available at operador nacional do sistema elétrico 2020a we compared the proposed probabilistic models with some classic unit distributions most of the datasets range from january 2011 to december 2019 the exceptions are the maua batalha and balbina reservoirs the starting period of the maua reservoir was october 2012 while for the batalha and balbina reservoirs it was january 2013 months with missing values were discarded from the sample for each reservoir we fitted the mk rmk beta and k models and computed the following gof statistics akaike information criterion aic akaike 1974 corrected statistics of cramér von mises w chen and balakrishnan 1995 anderson darling a statistic chen and balakrishnan 1995 and kolmogorov smirnov ks test statistic the aic would be more suitable for nested models which is not the case in our study the w and a statistics are often used to compare non nested models marinho et al 2019 the ks is a well known nonparametric test moccia et al 2021 used to decide if a sample comes from a population with a specific distribution for fitting the beta and k distributions the goodness fit function from the adequacymodel package marinho et al 2019 in r was used the lower the gof measure the better is the model fit for the data parameter estimates and gof measures for all datasets are presented in appendix b because there is no consensus in literature about the best quantitative measure for comparing different distributions the best fitted model for each reservoir was selected based on the smallest values in most gof measures finally we counted the number of times each distribution yielded the best fit in each subsystem these quantitative results can be found in table 3 table 3 highlights the superiority of the proposed distributions over the classical beta and k distributions for modeling the uv of water reservoirs since they provided the highest number of best fits in all subsystems concerning the south subsystem 100 of the datasets are best fitted by the mk and rmk distributions the overall performance shows that about 83 8 of the datasets 70 3 for mk and 13 5 for rmk are best fitted by the proposed models each classical distribution presented the best fit only 8 1 of the times i e only 3 out of 37 datasets in order to explore a qualitative analysis fig 2 provides some graphical representations composed of the histogram of the observed data boxplot and fitted densities and fig 3 presents some quantile quantile qq plots for brevity we selected six reservoirs where the mk presented the best fit the mk distribution overcomes limitations on beta and k models for dealing with increasing decreasing increasing density shapes which are observed in uv data see figs 2 a 2 b and 2 c for instance in appendix c we present several fitted densities of all four distributions for other reservoirs the graphical results in general show the flexibility and superiority of the new distributions for fitting hydro environmental data under different degrees of variability skewness and kurtosis hence the mk and rmk distributions can be effective alternatives to the well known beta and k distributions for modeling double bounded hydro environmental data based on the best model for each dataset we computed several useful statistical quantities for hydro environmental analysis we considered the following measures number of observations n minimum min maximum max mean md σ 2 cv s b and k m the mean md σ 2 s b and k m are computed as in section 3 replacing the parameters by their mles for the beta and k distributions the measures were computed analogously table 4 shows the results for instance we note that the ernestina reservoir never had a uv below 0 230 in this reservoir the uv presents homogeneously high values with the following estimated measures σ 2 0 047 cv 25 748 μ 0 842 and md 0 961 according to s b 0 698 and k m 1 459 it has a left skewed tail and the mass of observations are close to the upper limit of the unit interval also to show the ability of the proposed distributions to describe datasets with various characteristics table 5 presents some sample statistics notice that the estimated quantities based on the mles table 4 are close to the sample measures corroborating the previous sentence the largest percentage differences between some values in table 4 and the sample measurements were in the mean of três irmãos reservoir 11 in the median of balbina reservoir 19 in the variance and coefficient of variation of i solteira reservoir 25 and 20 respectively overall the variabilities of the datasets are not very low and this may be because the data are related to time and the observed variables are under the influence of some climate conditions throughout the year de freitas and da silva soito 2008 fig 4 allows for a comparative analysis of the median and cv among different subsystems different location and dispersion measures are expected given the different climate types water availability soil types territorial dimension etc in each region in fact it is known about water availability restrictions in the northeast due to droughts and in the southeast by the soils and rivers degradation de freitas and da silva soito 2008 the most favorable situation is found in the south subsystem where 50 of the reservoirs present median uv between 0 63 and 0 80 it is also the subsystem with lower cv which does not exceed 48 2 indicating that the south subsystem has the greatest homogeneity indeed the southern region of brazil is one of the best watered regions and is also characterized by uniform precipitations nimer 1971 gonçalves and back 2018 such features may result in some distribution shapes of the reservoirs in the southern region that justify the superiority of the mk and rmk distributions for fitting these datasets finally note that with accurately fitted distributions we can estimate the probabilities associated with each dataset which can be useful for decision making for example we can use the cdf at any percentage of volume y evaluated at the mles α β to obtain the probability that the reservoir will operate with monthly uv below or above y i e we compute p y y table 6 shows several of these probabilities for each reservoir it can be useful for issues related to reservoir operation flood control and environmental monitoring for instance the operation of the paraibuna reservoir can only operate with uv greater than 0 1 operador nacional do sistema elétrico 2016 so the probability of the reservoir stop operating due to insufficient uv is p y 0 1 0 119 such an event may require the participation of other types of plants e g thermoelectric to supply the demand of the stopped reservoir increasing the costs of production in the salto santiago reservoir the uv must be greater than 0 7 operador nacional do sistema elétrico 2020b if it is lower there is an intensification in the formation of temporary ponds on its margin where fish are trapped this is an important environmental problem to be avoided because not all fish can be saved according to table 6 the occurrence probability of uv values below 0 7 in this reservoir is 0 477 the itaparica reservoir goes into a flood alert situation for uv approximately greater than 0 70 operador nacional do sistema elétrico 2003 then using table 6 there is a probability of p y 0 7 1 p y 0 7 0 108 that the reservoir goes into a flood alert situation this situation characterizes floods and indicates among other things that there may be hydraulic restrictions on the reservoir being violated operador nacional do sistema elétrico 2003 7 conclusions in this paper we proposed two probability models based on a transformation of the kumaraswamy distribution for modeling hydro environmental data named modified kumaraswamy mk and reflected modified kumaraswamy rmk distributions our monte carlo simulation evidence showed an adequate performance of the maximum likelihood estimators of the mk model parameters through applications in several percentages of useful volume uv datasets from the main water reservoirs of hydroelectric plants in brazil we showed that the proposed models presented the best fits for this type of data we also introduced important statistical properties and measures of these models that can be useful for describing and interpreting hydro environmental data in addition within the scope of hydraulic operation the proposed models can assist in the decision making process risk management and environmental monitoring for future works we envisage to explore the introduced mk and rmk models for modeling extreme maximum or minimum bounded variables and investigate robust estimation methods such as weighted maximum likelihood and l moments estimators these methods are suitable for hydro environmental analysis when outliers are observed credit authorship contribution statement murilo sagrillo conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization renata rojas guerra conceptualization methodology software validation investigation writing original draft writing review editing visualization supervision project administration fábio m bayer conceptualization methodology software validation investigation writing original draft writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we gratefully acknowledge partial financial support from capes and cnpq brazil we thank an associate editor and two anonymous referees for comments and suggestions that led to a much improved manuscript appendix a in this appendix we present the relations of the proposed distributions with some well known probability models proposition 7 1 about the relation of mk and rmk distributions with well known distributions we have that a if y mk α β then exp 1 1 y k α β b if y mk α β then 1 y 1 exponentiated exponential ee distribution gupta and kundu 1999 c if y mk 1 β then exp 1 1 y beta 1 β d if y mk α 1 then exp 1 1 y beta α 1 e if y mk α 1 then 1 y 1 exponential distribution f if z rmk α β then exp z z 1 k α β g if z rmk α β then z 1 z ee distribution h if z rmk 1 β then exp z z 1 beta 1 β i if z rmk α 1 then exp z z 1 beta α 1 j if z rmk α 1 then z 1 z exponential distribution proof 7 1 a let w exp 1 1 y then f w w α β p exp 1 1 y w p y 1 log w 1 f y 1 log w 1 α β by replacing 1 log w 1 in eq 2 we have that f w w α β 1 1 w α β which is the pdf of the k distribution b let w 1 y 1 then f w w α β p 1 y 1 w 1 p y 1 w 1 1 f y 1 w 1 α β by replacing 1 w 1 in eq 2 we have that f w w α β 1 exp w α β which is the pdf of the ee distribution c let w exp 1 1 y then using the proof in a and the relation beta 1 β k 1 β we have f w w β 1 1 w β which is the pdf of the beta distribution with α 1 d let w exp 1 1 y then using the proof in a and the relation beta α 1 k α 1 we have f w w α w α which is the pdf of the beta distribution with β 1 e let w 1 y 1 then using the proof in b and the relation ee α 1 exponential distribution we have f w w α 1 exp w α which is the pdf of the exponential distribution f let w exp z z 1 then f w w α β p exp z z 1 w 1 p z log w log w 1 1 f z log w log w 1 α β by replacing log w log w 1 in eq 4 we have that f w w α β 1 1 w α β which is the pdf of the k distribution g let w z 1 z then f w w α β p z 1 z w p z w 1 w f z w 1 w α β by replacing w 1 w in eq 4 we obtain f w w α β 1 exp w α β which is the pdf of the ee distribution h let w exp z z 1 then using the proof in f and the relation beta 1 β k 1 β we have f w w β 1 1 w β which is the pdf of the beta distribution with α 1 i let w exp z z 1 then using the proof in f and the relation beta α 1 k α 1 it follows that f w w α w α which is the pdf of the beta distribution with β 1 j let w z 1 z then using the proof in g and the relation ee α 1 exponential distribution we have f w w α 1 exp w α which is the pdf of the exponential distribution appendix b here we present the gof statistics for the models adjusted to the uv data related to the reservoirs of all subsystems of the sin results for the south southeast midwest northeast and north subsystems are summarized in tables 7 10 respectively the best results are in boldface appendix c in this appendix in fig 5 we present some graphical representations composed of histrograms and boxplots of the observed data and fitted densities of the mk rmk beta and k distributions 
