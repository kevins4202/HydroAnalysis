index,text
6220,a reservoir operation chart is effective in guiding the actual operation of reservoirs with the development and construction of large scale mixed reservoirs operating reservoirs using multiple objective operations has become a hot issue this study therefore improved and expanded the traditional energy storage operation chart esoc model for pure cascade reservoirs based to the special relationships between hydraulics and water volume of the upstream and downstream reservoirs in a mixed reservoir system considering the objectives of flood control energy generation including power generation guaranteed output and assurance rate and ecological flow a multi objective esoc optimization model for large scale mixed reservoirs is established and the corresponding solving method for this model is proposed taking the pearl river basin of china as an example the multi objective pareto fronts of different minimum discharges of upstream reservoirs are obtained according to the actual operation demands and constraints the optimal multi objective schemes under different assurance rates and different ecological flow satisfaction rates are extracted based on the obtained pareto fronts for example if the assurance rate of power generation is required to be equal to or greater than 90 and the ecological flow the satisfaction rate of downstream control sections is required to be equal to or greater than 0 97 the scheme is the best when the minimum discharge of upstream reservoirs is 300 m3 s and the corresponding power generation and guaranteed output are 58 989 108 kwh and 439 gw respectively on the whole the proposed models and related results have significance for the actual operation of large scale mixed reservoirs keywords multi objectives operation chart ecological flow pareto front mixed reservoirs pearl river 1 introduction the nature of a reservoir operation method i e whether it is scientific or not directly affects reservoir operation presently commonly used reservoir operation methods can be divided into two categories optimal operation methods and conventional operation methods ming et al 2018 hojjati et al 2018 the optimal operation methods include classical mathematical methods and intelligent clustering algorithms yuan et al 2015 guo et al 2010 huang et al 2011 li et al 2018a such as linear programming jabr et al 2000 li et al 2013 dynamic programming vincenzo et al 2012 zhao and zhao 2004 jiang et al 2017 feng et al 2018a genetic algorithms baskar et al 2003 momtahen and dariane 2007 chen et al 2014 and particle swarm optimization cai et al 2001 zhang et al 2014 conventional operation methods include operation functions operation rules and operation charts ding et al 2018 wu et al 2019 tayebiyan et al 2019 a reservoir operation chart is usually drawn by an inverse calculation using hydrological data from typical years the drawing and operation processes are simple and convenient and the latter can reflect the reliability of a hydropower station to operate normally and the rationality of water resources utilization the reservoir chart has been widely studied and applied all over the world however current studies focus more on single reservoir operation charts and there is little work on joint operation charts for reservoir groups in joint reservoir operations the energy of the same volume of water used in single reservoir operation is different when it is applied to different reservoirs therefore the total output of the reservoir system cannot be determined only by the reservoir water level using a joint operation chart instead the current total energy state of the reservoir system needs to be considered to determine total output therefore it is particularly necessary to study the energy storage operation chart esoc of large scale reservoirs reservoir operation research began with the single reservoir operation li et al 2010 fu et al 2015 villa et al 2018 jiang et al 2018a srinivasan and kumar 2018 with the rapid development of hydropower in large basins in recent decades its related research and application has developed from a single reservoir to cascade reservoirs wang et al 2017 jiang et al 2018b liu et al 2019a b and parallel reservoirs chang and chang 2009 and then to cascade parallel coupled mixed reservoirs zhou et al 2014 munar et al 2018 the characteristics and schematic diagrams of different types of reservoir groups are shown in table 1 different from a single reservoir system with few variables and a single objective a mixed reservoir system composed of multiple reservoirs needs unified operation and management and often has a large dimension and multiple objectives at present some achievements have been made in the study of multi objective operation of reservoirs for example liu et al 2018a proposed a new algorithm named the multi objective cultured evolutionary algorithm based on decomposition for optimizing the hierarchical flood operation rules with four objectives upstream flood control downstream flood control power generation and navigation feng et al 2018b introduced the parallel multi objective genetic algorithm to effectively resolve the multi objective constrained optimization problem with two competing objectives energy production and ecological protection and numerous physical constraints however there are still some shortcomings in the existing studies for example most of the studies usually use the optimization algorithms to perform deterministic optimization calculations to verify the effectiveness of multi objective optimization method and focus more on the optimization model or algorithm efficiency ignoring the practicability of the optimization results therefore it is challenging to effectively apply the findings of these studies in practice some studies have proposed operation schemes or rules that have certain practical application effects for example uen et al 2018 proposed a holistic three fold scheme that synergistically optimized the benefits of the water food energy wfe nexus by integrating the short long term joint operation of a multi objective reservoir with irrigation ponds in response to urbanization the proposed methodology could be a viable approach to promoting the synergistic benefits of the wfe nexus lei et al 2018 derived the optimal operating rules for the flood control of large scale mixed reservoirs using a new algorithm known as the weighted non dominated sorting genetic algorithm ii which could efficiently locate the pareto front in the non dominated region owing to directed searching with the weighted crowding distance however little attention has been paid in existing studies to coupling the multi objective problem and esoc therefore it is of great practical significance to combine the multi objective operation problem with esoc to study the multi objective esoc of large scale mixed reservoirs this can not only allow for effective solving of existing multi objective optimization problems but also effective application of the results of the multi objective optimization to actual operation we therefore combined the esoc with the multi objective operation optimization problem and proposed a new multi objective esoc model for large scale mixed reservoirs considering flood control energy generation and ecological flow taking the pearl river basin of china as an example the multi objective pareto fronts under different minimum discharge scenarios were obtained based on this optimal multi objective operation schemes under different assurance rates and different ecological flow satisfaction rates were extracted furthermore the relationship between the ecological flow satisfaction rate of downstream and the minimum discharge of upstream reservoirs was analyzed and discussed in addition the optimal order of water storage and water supply of each reservoir with a regulating role was summarized using the long series simulation results overall the results discussed in this paper are of significance to the actual multi objective operation of large scale mixed reservoirs the following parts of this paper are organized as follows section 2 presents the methodology describing the drawing and simulation of the esoc for large scale mixed reservoirs and the multi objective esoc optimization model and solution obtained section 3 presents a case study of the xijiang river mixed reservoirs in the pearl river basin china and presents and analyzes the results finally in section 4 the conclusions of this study are presented 2 methodology 2 1 drawing and simulation method of the esoc for mixed reservoirs the operation method described by the esoc is a practical and conventional method in joint operation of reservoirs the esoc can be obtained by an inverse calculation using typical runoff processes liu et al 2018b meng et al 2019 however unlike for the single reservoir operation chart the output distribution of the total output among the power stations is involved in the inverse calculation of the esoc for large scale reservoir groups at this time the discriminant coefficient is generally used to distribute the total output among the power stations jiang et al 2016 2019 the discriminant coefficient method is used to determine the best order of reservoirs in storing water or supplying water and to maximize power generation and minimize energy losses as far as possible in a pure cascade reservoir system as shown in table 1 the discriminant coefficients can be simply derived as follows suppose the total output calculated by natural inflow only in the tth stage is tlt inflow and the total output required from the cascade system to the power grid is tlt grid in this stage then there are three situations i e 1 tlt inflow tlt grid in which the system will supply water 2 tlt inflow tlt grid in which the system will store water and 3 tlt inflow tlt grid in which the system will not store or supply water in situation 1 the amount of supplied water can be calculated by the output difference lsupply tlt grid tlt inflow in situation 2 the amount of stored water can be calculated by the output difference lstore tlt inflow tlt grid taking situation 1 as an example if ei t supply is the hydropower produced by the water supplied of the ith reservoir in the tth stage it can be expressed as 1 e t sup ply i k η a t i d h t sup ply i j i n h t j where k is the conversion factor of unit η is the efficiency coefficient of the generator at i is the average water surface area of the ith reservoir in the tth stage dhi t supply is the water head decrement of the ith reservoir in the tth stage hi t is the average water level of the ith reservoir in the tth stage and n is the total number of reservoirs in the system moreover for the produced hydropower ei t supply there are two extra energy losses removed by dhi t supply the first energy loss is ei t w supply which is lost from the natural inflow water wt i of the ith reservoir during hydropower production in the ith stage and can be expressed as follows 2 e t w sup ply i k η w t i d h t supply i 2 the second energy loss is ei t v supply which is lost from the available water vj avai t of the upstream reservoirs it can be expressed as 3 e t v sup ply i k η j 0 i 1 v avai t j d h t supply i therefore the extra energy losses per unit of hydropower generation of the ith hydropower station in supplying water can be expressed as 4 k t sup ply i e t w sup ply i e t v sup ply i e t sup ply i 0 5 w t i j 0 i 1 v avai t j a t i j i n h t j similarly in situation 2 the system will store water and extra energy can be obtained through a similar analysis and derivation the extra energy obtained per unit of stored energy of the ith hydropower station in storing water can be expressed as 5 k t s t o r e i e t w s t o r e i e t v s t o r e i e t s t o r e i 0 5 w t i j 0 i 1 v avai t j a t i j i n h t j in formulas 4 and 5 ki t supply represents the discriminant coefficient of each reservoir when the system supplies water and the reservoir that supplies water first in each stage has the smallest ki t supply ki t store represents the discriminant coefficient of each reservoir when the system stores the water and the reservoir that stores water first in each stage has the largest ki t store ei t store is the energy stored through the water storage of the ith reservoir in the tth stage ei t w store is the energy increment of the natural inflow water wt i of the ith reservoir in storing water ei t v store is the energy increment of the available water vj avai t of the upstream reservoirs however in mixed reservoirs as shown in table 1 considering the special water head and water volume relationships between the upstream and downstream reservoirs there are some differences in the two formulas of the discriminant coefficient 6 k t sup ply i e t w sup ply i e t v sup ply i e t sup ply i 0 5 w t i j j up re s i v avai t j a t i j j downres i h t j 7 k t s t o r e i e t w s t o r e i e t v s t o r e i e t s t o r e i 0 5 w t i j j upres i v avai t j a t i j j downres i h t j where downres represents a set of reservoir serial numbers of reservoir i and downstream reservoirs that have water head connections with reservoir i upres represents a set of reservoir serial numbers of upstream reservoirs that have water volume connections with reservoir i taking the typical mixed reservoirs given in table 1 as an example the upres of reservoir 1 is the upres of reservoir 2 is 1 the upres of reservoir 3 is the upres of reservoir 4 is and the upres of reservoir 5 is 1 2 3 4 however in pure cascade reservoirs the upres of reservoir i is 0 1 2 i 1 for downres and taking the typical mixed reservoirs given in table 1 as an example the downres of reservoir 1 is 1 2 5 the downres of reservoir 2 is 2 5 the downres of reservoir 3 is 3 5 the downres of reservoir 4 is 4 5 and the downres of reservoir 5 is 5 however in pure cascade reservoirs the downres of reservoir i is i i 1 n similar to the conventional single reservoir operation chart the esoc contains three types of output curves the basic curves the increased output curves and the reduced output curves in calculating each operation curve through the inverse calculation using the typical runoff processes the following main constraints should be considered 1 water balance constraint 8 q t i v t 1 i v t i 3600 δ t i t i l t i ev t i where qt i is the water flow used for power generation of the ith reservoir in the tth stage lt i is the abandoned water flow of the ith reservoir in the tth stage evt i is the evaporation capacity of the ith reservoir in the tth stage vi t 1 is the volume of the reservoir at the beginning of the t stage vi t is the volume of the reservoir at the end of the t stage δt is the length of an operation stage ii t is the inflow of the ith reservoir in the tth stage ii t includes the interval inflow and the total outflow of the upstream reservoirs and has a direct water connection with the ith reservoir i e 9 i t i intq t i j j s q t j where int i t i qt i is the interval inflow of the ith reservoir in the tth stage qt j represents the outflow of the jth upstream reservoir that has a direct water volume relation with reservoir i s represents a set of reservoir serial numbers of upstream reservoirs that has a direct water volume relation with reservoir i taking the typical mixed reservoirs given in table 1 as an example the s of reservoir 1 is the s of reservoir 2 is 1 the s of reservoir 3 is the s of reservoir 4 is and the s of reservoir 5 is 2 3 4 however in a pure cascade reservoir system except for the first reservoir upstream of the river the s of the other reservoirs is i 1 2 reservoir volume constraints these are the upper and lower limit constraints of water volume in each operation stage and they are hard constraints their formulae can be expressed as follows 10 v t min i v t i v t max i where vi t min is the lower limit of vi t which usually corresponds to the dead level vi t max is the upper limit of vi t which usually corresponds to the flood control level in the flood season and the normal level in the dry season 3 discharge flow constraints these are the interval constraint and non negative constraint the former is a soft constraint which can be overcome when the water level constraints break through the boundary and the latter is a hard constraint which cannot be reached at any time 11 q t min i q t i q t max i and q t i 0 where qi t min is the lower limit of qi t and is usually determined by the minimum downstream ecological flow qi t max is the upper limit of qi t and is usually determined by the downstream river channel capacity 4 output constraint in the process of drawing and simulating the esoc the output should be equal to the guaranteed output increased output or reduced output it is a soft constraint and it can be overcome in some stages such as when the water level or discharge constraints break through the boundary 12 i 1 n n t i t n g or i 1 n n t i t n inc or i 1 n n t i t n red at the same time the output should be within the feasible range 13 n t min i n t i n t max i where ni t is the output of the ith reservoir in the tth stage tng is the total guaranteed output of the mixed reservoirs tninc is the total increased output of the mixed reservoirs tnred is the total reduced output of the mixed reservoirs ni t min is the lower limit of ni t which is usually determined by the allowed minimum output ni t max is the upper limit of ni t which is usually determined by the installed capacity and expected output the inverse calculation process of the esoc can be summarized in fig 1 in fig 1 the left part is used for drawing the upper and lower basic curves the middle part is used for deriving the typical runoff processes that correspond to the upper and lower basic curves and the right part is used for drawing the increased and reduced output curves based on the derived typical runoff processes more detailed information can be found in jiang et al 2016 2019 after drawing the esoc following fig 1 evaluating the performance of the obtained esoc requires running a simulation using a long series of runoff data then a statistical analysis is also needed on indexes such as the power generation and assurance rate the simulation operation process can be summarized as follows after the esoc is obtained step 1 at the beginning of the tth stage the total energy storage est of the system can be calculated according to the available water volume vi avai t and its head connected downstream water head hi t as shown in formula 14 in this formula esi t is the energy storage of the ith reservoir in the tth stage and γ is the specific gravity of water 14 es t i 1 n es t i γ i 1 n v avai t i j i downres h t j step 2 obtain a total output named tlt chart from the esoc by est and calculate the total output of the system by natural inflow in this stage i e tlt inflow step 3 if tlt inflow is greater than tlt chart the system will store water then the reservoir that has a maximum ki t store begins to store water first until the total output calculated through the updated inflow is equal to tlt chart if the water level of the reservoir reaches the upper limit of this stage and the output has not yet reached tlt chart then the reservoir that has the second largest ki t store begins to store water step 4 if tlt chart is greater than tlt inflow the system will supply water then the reservoir that has a minimum ki t supply begins to supply water first until the total output calculated through the updated inflow is equal to tlt chart if the water level of the reservoir reaches the lower limit of this stage and the output has not yet reach to tlt chart then the reservoir that has the second smallest ki t supply begins to supply water step 5 if tlt chart is equal to tlt inflow the system will not store or supply water the system will produce hydropower by natural inflow only for the sake of simplicity of operation the input of runoff forecasting is not considered in the above process in fact to achieve forecasting of the inflow and the esoc we need to take the predicted inflow into account when calculating the total energy storage of the system when drawing the esoc and performing the simulation calculation in other words the energy value of the predicted inflow of the current stage needs to be added to the total energy storage value of the system to determine the total output of the system in the current stage 2 2 modeling and solving of multi objective esoc optimization 2 2 1 model of multi objective esoc optimization the esoc obtained in section 2 1 is only a single result under specific constraints and boundaries such as a definite initial guaranteed output and a definite minimum discharge combination from the upstream reservoirs if the guaranteed output of the system is changed or the minimum discharge combination of the upstream reservoirs is changed what will the result be this involves the multi objective optimization problem in the multi objective joint operation of the reservoirs the objectives generally involved are the flood control objective energy generation objective including three sub objectives i e power generation guaranteed output and assurance rate and ecological objective such as minimum ecological flow 1 for the flood control objective it is generally converted to water level constraints specifically in the flood season the operating water level is required to be lower than the flood control limit water level and in the non flood season the operating water level is required to be lower than the normal water level liu et al 2019a b as a compulsory target it is generally converted to a compulsory constraint its objective function can be simply expressed as follows zhao et al 2017 uysal et al 2018 15 flood season z t z floodcontrollevel non flood season z t z normallevel where zt is the operation level of the reservoir in the tth stage and zfloodcontrollevel is the highest operation level of the reservoir in the flood season that is the flood control limited level znormalevel is the highest operation level of the reservoir in the non flood season that is the normal storage level 2 ecological objectives refer mainly to the ecological flow requirements of downstream control sections e g the minimum ecological flow li et al 2018a b c however the river flow of the downstream section can only be controlled by the discharge of upstream reservoirs that have a regulating role therefore the ecological flow requirement can be converted into the minimum discharge requirement of the upstream reservoirs if there is more than one reservoir that has a regulating role above the control section in a mixed reservoir system the minimum possible discharge interval of the upstream reservoirs can be discretized and arranged then a long series of simulation calculations can be carried out for each combination and the channel flow situation of the downstream control sections under each combination can be counted finally the ecological flow satisfaction rate of the control sections can be obtained for the ecological objective several methods can be used to describe the ecological flow demand of rivers comprehensively at present because of the complexity of the river ecosystem itself fang et al 2019a therefore there is no unified understanding of the establishment of the ecological objective huang et al 2014 this study uses several commonly used ecological objectives are introduced ① minimize the ecological overflow and water shortage according to this theory suitable ecological flow should have upper and lower bounds and the discharged flow after reservoir operation should fall within the bounds as far as possible lu et al 2011 lu et al 2018 it can be expressed as follows 16 f 1 min v eco min v ecoover v ecolack min k 1 m t 1 t d q ecohigh k t d q ecolow k t δ t where v eco is the ecological overflow and water shortage including the overflow v ecoover and the water shortage v ecolack the cumulative value v ecoover indicates that the actual flow process is larger than the upper limit of the suitable interval of ecological flow and the cumulative value v ecolack indicates that the actual flow process is smaller than the lower limit of the suitable interval of ecological flow dqecohigh k t represents the difference between actual flow and the upper limit of the suitable interval of ecological flow of the kth ecological control section in the tth stage when the actual flow process is greater than the upper limit of the suitable interval of ecological flow dqecolow k t represents the difference between the lower limit of the suitable interval of ecological flow and the actual flow of the kth ecological control section in the t stage when the actual flow process is less than the lower limit of the suitable interval of ecological flow m is the total number of ecological control sections t is the number of stages over the entire operation period ② minimize the coefficient of ecological change according to this theory natural flow is the optimal ecological flow yu et al 2017 yang et al 2019 the closer the dispatched flow is to natural flow the better the ecological objective is its expression can be described as follows 17 f 1 min k 1 m 1 t t 1 t q k t o q k t e q k t e 100 2 where qk t o is the monthly average flow of the ecological control section after reservoir operation qk t e is the monthly average flow of the ecological control section under natural conditions this formula reflects the fluctuation in monthly ecological flow in the form of the root mean square change which is the relative change degree of the monthly average dispatched flow to natural flow the smaller the value of f 1 is the closer the monthly average dispatched flow is to the natural flow and the smaller the degree of hydrological variability is ③ maximum satisfaction rate of the minimum ecological flow the minimum ecological flow of a river is the minimum water needed to maintain the survival of the river eco environment and it is the basic discharge to be firstly considered in reservoir operation in some cases for example when the data are incomplete and limited the lower limit of the suitable interval of ecological flow can be considered only that is to say the probability of a minimum discharge greater than or equal to the lower limit of the suitable interval of ecological flow should be as large as possible or not be less than a given threshold value its functional expression can be simply described as follows 18 f 1 max e c o r a t e k max t totalstages time s k t totalstages 100 where ecoratek represents the ecological flow satisfaction rate of the kth section and totalstages represents the number of stages in the operation period of the entire simulation timesk t is the statistical function of the kth ecological flow control section if qt k qt k eco then timesk t 1 if qt k qt k eco then timesk t 0 qt k eco represents the minimum ecological flow of the control section in the tth stage qt k represents the instream flow of the kth control section in the t stage if the interval inflow is not considered qt k is equal to the sum of qi t of upstream reservoirs which are directly related to the kth control section the maximum ecological flow satisfaction rate is the simplest objective among the above three objectives which only considered the minimum ecological flow demand in this study due to data limitations we choose this objective as the ecological objective in the case study 3 for the objective of energy generation it generally includes three sub objectives i e power generation assurance rate and guaranteed output and there is a certain synergy and competition relationship among these three objectives generally the assurance rate and guaranteed output have a competitive relation that is the assurance rate decreases with an increase in guaranteed output and the assurance rate increases with a decrease in guaranteed output the relationship between the guaranteed output and power generation may be competitive jiang et al 2016 or synergistic jiang et al 2018c depending on the specific watershed in the study the objective functions of power generation guaranteed output and assurance rate can be expressed as follows georgakakos et al 1997 fu et al 2019 ① maximum power generation 19 f 2 max e max δ t i 1 n t 1 t n t i where e is the total power generation of the system and δt is the length of an operation stage ② maximum guaranteed output 20 f 3 max t n g where tng is the total guaranteed output of the system ③ maximum assurance rate 21 f 4 max p max ϕ tn t a c t u a l tn g t 100 t 1 2 t p p min where ϕ is the statistical function that represents the times that the actual total output of system is greater than or equal to the guaranteed output tnt actual is the actual total output of system in the tth stage in the simulation calculation p is the statistical assurance rate of system in each simulation operation p min is the lower limit of assurance rate 2 2 2 solving of multi objective esoc optimization model in solving the above multi objective esoc model the guaranteed output is a key variable that determines the final esoc and it has the greatest impact on the final results therefore the total guaranteed output of the system can be discretized within a feasible range and then coupled with the minimum discharge combination of upstream reservoirs at this time for a discretized guaranteed output and a minimum discharge combination the corresponding esoc for the large scale mixed reservoirs can be obtained by the drawing method described in section 2 1 then according to the simulation steps of the esoc in section 2 1 the total power generation assurance rate and ecological flow satisfaction rate of the mixed reservoirs system under the given guaranteed output and minimum discharge combination can be obtained through a long series of simulation calculation and analyses so far the five dimensional objective space minimum discharge combination power generation guaranteed output assurance rate ecological flow satisfaction rate can be constructed the steps can be summarized as follows step 1 within a feasible range such as 30 or 40 of the initial total guaranteed output a series of discretized guaranteed output values can be obtained by discretization with a certain step length step 2 referring to the actual minimum discharge data of upstream reservoirs that have the regulating role a series of minimum discharge combinations can be obtained by discretizing the minimum discharge of the upstream reservoirs in a feasible range with a certain step length step 3 the esoc of the mixed reservoirs can be determined using the inverse calculation for each discretized guaranteed output and minimum discharge combination then the corresponding total power generation assurance rate of power generation and ecological flow satisfaction rate of the control sections can be obtained by carrying out simulated calculations with a long series of runoff data step 4 based on the simulation results of different guaranteed outputs and different minimum discharge combinations the five dimensional objective space of minimum discharge combination power generation guaranteed output assurance rate ecological flow satisfaction rate can be constructed taking three reservoirs that have the regulating performance as an example the idea of constructing the above five dimensional objective space using pseudo code can be expressed as follows construction of the multidimensional objective space 1 for q 1 q 1 min δq 1 q 1 max 2 for q 2 q 2 min δq 2 q 2 max 3 for q 3 q 3 min δq 3 q 3 max 4 for tn tn min δtn tn max 5 drawingenergystorageoperationchart 6 e rate ecorate longseriessimulation 7 end for 8 end for 9 end for 10 end for where δq 1 δq 2 and δq 3 are the discrete steps of minimum discharge of the three upstream reservoirs respectively δtn is the discrete step of the total guaranteed output e is the total power generation of the system rate is the assurance rate ecorate is the ecological flow satisfaction rate of downstream control sections the drawingenergystorageoperationchart represents the drawing function of the esoc and the longseriessimulation represents the calculation function of the simulation using the esoc and a long series of runoff data according to the above steps after obtaining the multi objective feasible solution space the related multi objective decision making theory needs to be used to further optimize the schemes and make decisions the pareto theory is currently the most widely used method for dealing with multi objective problems the pareto solution is also called the non dominated solution that is one solution is the best for one objective and the worst for the other because of the conflict and incomparability among objectives while improving any objective the solution that results in least one other objective being inevitably weakened is called the non dominant solution or pareto solution another related concept is pareto improvement which refers to a change that makes at least one objective better without making any other objective worse pareto optimality refers to the state in which there is no space for pareto improvement the surface formed by the optimal set in the solution space is called the pareto front relevant definitions and interpretations can be expressed as follows fonseca et al 2016 luo et al 2018 if x 1 and x 2 belong to any two individuals in the feasible solution the relationship between them satisfies formula 22 then x 1 is pareto dominant compared with x 2 or x 1 dominates x 2 22 i 1 2 m f i x 1 f i x 2 and j 1 2 m f j x 1 f j x 2 this is usually referred to as x 1 x 2 when and only when x x x x x x is called the pareto optimal solution and the pareto optimal solution set is the set of all pareto optimal solutions defined as follows 23 p x x x x x furthermore the surface consisting of the objective vectors corresponding to all pareto optimal solutions is called pareto front i e 24 pf f x f 1 x f m x x p in this paper under each minimum discharge combination there are four objectives i e the ecological flow satisfaction rate f 1 power generation f 2 guaranteed output f 3 and assurance rate f 4 after the feasible solutions of the problem are obtained by a discrete combination and simulation calculation the pareto optimal solution set can be obtained by the above definitions after obtaining the pareto optimal solution the relevant decision making methods li et al 2018b the scheme optimization criterion or the actual operation criterion can be used for scheme optimization and decision making 3 case study 3 1 basin introduction and basic data the pearl river is the third longest river in china with a total length of 2320 km its watershed area is about 440 000 square kilometers its annual runoff is more than 349 2 billion cubic meters ranking second in china s river systems the pearl river flows through yunnan guizhou guangxi guangdong hunan jiangxi and the northeastern part of the socialist republic of vietnam it includes three major tributaries i e xijiang beijiang and dongjiang among them the xijiang is the longest and is usually called the mainstream of the pearl river presently hydropower development in the xijiang basin has been basically completed there are thirteen reservoirs in total upstream and downstream of the river which constitute a large scale mixed reservoir system with both a cascade reservoir system and parallel reservoir system as shown in fig 2 five reservoirs in this mixed system i e tianyi guangzhao yantan longtan and baise have the regulating role we chose this mixed reservoir system to study the multi objective operation problem and the reservoirs are numbered by 1 2 3 and 13 with the numbering process starting upstream of the river the topological structure of the mixed reservoirs system is shown in fig 3 the basic parameters of each power station are shown in table 2 the upper limits of the operating water levels of each reservoir are shown in table 3 and the lower limit is the dead water level according to the above topological structure of the mixed reservoirs the s set downres set and upres set of each reservoir can be obtained as shown in table 4 in the joint operation of the xijiang basin there are two ecological flow control sections i e dahuangjiang and wuzhou section as shown in fig 2 the ecological flow requirement is considered the main ecological objective in the joint operation the range of variability approach rva method bradford et al 2007 yu et al 2016 is used to calculate the lower limit of the ecological flow which is the most widely used multivariable approach for the assessment of flow regime alteration fang et al 2019b furthermore the flow process corresponding to 90 of the monthly frequency is taken as the lower limit of the suitable ecological flow interval based on this the minimum ecological flow requirement of the dahuangjiang and wuzhou sections can be obtained as shown in table 5 because the datengxia hydropower station is close to the dahuangjiang section and the changzhou hydropower station is close to the wuzhou section the discharge of the datengxia hydropower station is used to represent the river flow of the dahuangjiang section and the discharge of the changzhou hydropower station is used to represent the river flow of the wuzhou section in this study in addition because the dahuangjiang and wuzhou sections are both located downstream of the basin and there are no reservoirs that have a regulating role or tributaries between them their ecological flow satisfaction rates are basically the same therefore this study uses one index to express the comprehensive satisfaction rate of these two sections the calculation formula is as follows 25 ecorate t totalstages k 1 2 time s k t 2 t o t a l s t a g e s 100 3 2 results and analysis in this paper the discrete interval of the total guaranteed output is established using the initial guaranteed output which is the sum of the guaranteed output of each hydropower station i e 3588 mw and get the feasible interval that is 0 6 3588 mw 1 4 3588 mw the discrete space of the total guaranteed output is obtained by taking 10 mw as step length in addition in view of the combination of the minimum discharges of the upstream reservoirs the calculation will be time intensive if the minimum discharge combinations among these reservoirs are considered therefore we assume that the minimum discharge of these five reservoirs changes synchronously and discretizes the discharge interval 0 m3 s 500 m3 s at 50 m3 s intervals to obtain the discrete space of the minimum discharge this comprises a total of 11 kinds of minimum discharges 0 m3 s 50 m3 s 100 m3 s 150 m3 s 200 m3 s 250 m3 s 300 m3 s 350 m3 s 400 m3 s 450 m3 s and 500 m3 s the esoc is drawn and simulated under different guaranteed outputs and minimum discharge combinations using statistics it is found that under different guaranteed outputs the ecological flow satisfaction rate of the downstream control sections basically remains unchanged as long as the minimum discharge combination of the upstream reservoirs remains unchanged in other words the ecological flow satisfaction rate of the downstream control sections is related mainly to the minimum discharge of the upstream reservoirs not to other factors taking the minimum discharges 100 m3 s 200 m3 s 300 m3 s and 400 m3 s as examples the variations in the ecological flow satisfaction rate with changes in the guaranteed output are shown in fig 4 therefore we can conclude that when the multi objective schemes are optimized according to a five dimensional solution space a series of schemes corresponding to the minimum discharge or ecological flow satisfaction rate can be obtained by selecting the optimal one from the three dimensional multi objective space of the power generation guaranteed output assurance rate in addition the relationship between the ecological flow satisfaction rate of downstream sections and the minimum discharge of upstream reservoirs was obtained as shown in fig 5 via statistical analysis of the long series simulation calculation results show it can be seen that the ecological flow satisfaction rate of downstream control sections is the largest when the minimum discharge of upstream reservoirs is 350 m3 s which is about 97 3 the ecological flow satisfaction rate of downstream control sections is larger than 97 when the minimum discharge of upstream reservoirs is in the interval 290 m3 s 450 m3 s furthermore from fig 5 it can be seen that with an increase in the minimum discharge of upstream reservoirs the ecological flow satisfaction rate of downstream control sections increases first and then decreases in other words the ecological flow satisfaction rate will decrease when the minimum discharge of upstream reservoirs increased to a certain extent this is because with an increase in the minimum discharge the ecological flow increases when the minimum discharge of upstream reservoirs is small especially in the dry season so the ecological flow satisfaction rate increases gradually in this time period however when the minimum discharge of the upstream reservoirs is too large although the requirement of ecological flow can be met in some early stages the reservoir is often not full or insufficient at the end of the wet season therefore the water supply of the reservoir in the later stages will be greatly compromised which leads to a low ecological flow satisfaction rate over the entire operation period in addition fig 5 shows that the ecological flow satisfaction rate of the downstream sections is the largest when the minimum discharge of the upstream reservoirs is 350 m3 s which means that the reservoir can take the minimum discharge requirement into account both in the wet season and dry season under this minimum discharge so as to maximize the total ecological flow satisfaction rate over the entire operation period taking the minimum discharge of 0 m3 s 100 m3 s 200 m3 s 300 m3 s 400 m3 s and 500 m3 s as the examples the three dimensional feasible solution space of the power generation guaranteed output assurance rate and the corresponding pareto front under different minimum discharge combinations are shown in fig 6 choosing the best scheme from the three dimensional power generation guaranteed output assurance rate can be based on the criterion of maximizing the power generation under a certain assurance rate requirement the guaranteed output under a certain assurance rate requirement or on other relevant multi objective decision making methods here the former is used to choose the schemes table 6 shows the criterion of maximizing the power generation and assurance rate so that they are not less than 90 given the optimal scheme results under each minimum discharge combination from table 6 it can be seen that the guaranteed output of the optimal schemes increased first and then decreased under different minimum discharges while the corresponding variation in power generation has no obvious regularity increases first then decreases and then increase and then decreases if the ecological flow satisfaction rate of the downstream section is required to be greater than 97 the schemes can be selected from the minimum discharges of 300 m3 s 350 m3 s 400 m3 s and 450 m3 s comparatively the power generation and guaranteed output which are 58 989 108 kwh and 4 39e 06 kw respectively are both larger than others when the minimum discharge is 300 m3 s the corresponding esoc of the mixed reservoirs system at this time is shown in fig 7 correspondingly the multi year average water level obtained by long series simulation of each reservoir is shown in fig 8 it can be seen that the full storage rates of the reservoirs are low owing to the large requirement of minimum discharge in addition through an analysis of the long series simulation results it is found that there are only 10 combinations 120 combinations in theory for the order of water storage and water supply of reservoirs k value order therefore the monthly analyses were carried out using the long series simulation results when the assurance rate was 90 and minimum discharge was 300 m3 s the number of water storage and water supply orders in each month are obtained and used to determine the most possible combinations of water storage and water supply in each month as shown in table 7 from table 7 it can be seen that in march june and july the order of the k value in combination 4 3 11 1 2 or 4 3 11 2 1 is the best for the operation of water storage and water supply in may and august the order of the k value in combination 4 3 11 1 2 or 4 11 3 1 2 is the best in september october december january february and april the order of the k value in combination 4 3 11 1 2 is the best furthermore in terms of long series reservoir 4 has the largest k value followed by those of reservoir 3 and reservoir 11 the k values of reservoir 1 and reservoir 2 are the smallest in addition the case study shows that the power generation and guaranteed output in this basin changes synchronously i e they have a cooperative relationship rather than a competitive relationship taking the minimum discharges of 100 m3 s 200 m3 s 300 m3 s and 400 m3 s as examples as shown in fig 9 it can be seen that the power generation increases with an increase in the guaranteed output from this result it can be concluded that the above mentioned scheme selection criterion of maximizing the power generation under a certain assurance rate requirement is the same as that for maximizing the guaranteed output under a certain assurance rate requirement therefore different schemes can be obtained by setting different assurance rate requirements e g 90 95 or 98 for example the optimal scheme results under each minimum discharge combination based on the criterion of maximizing the power generation and requiring the assurance rate to be greater than or equal to 95 were obtained and are shown in table 8 from table 8 it can be seen that the guaranteed output of the optimal scheme increases first and then decreases under different minimum discharge combinations and the maximum value is achieved close to the minimum discharge of 100 m3 s which is 4 08e 06 kw the corresponding power generation also increases first and then decreases and the maximum value is also achieved close to the minimum discharge of 100 m3 s which is 596 43 108 kwh however at this time the ecological flow satisfaction rate is only about 0 95 and does not reach 0 97 therefore if 0 95 can meet the actual requirement of the ecological flow satisfaction rate at this time then the scheme with the minimum discharge of 100 m3 s is the best one if the ecological flow satisfaction rate must be above 0 97 then the scheme with the minimum discharge of 300 m3 s is the best one and the power generation and guaranteed output are is 588 93 108 kwh and 3 43e 06 kw the esocs for these two cases are shown in figs 10 and 11 respectively taking the scheme with the minimum discharge of 100 m3 s as an example the multi year average water level variations in the five reservoirs that have regulating performance are shown in fig 12 it can be seen that compared with the scheme with the minimum discharge of 300 m3 s all the reservoirs are basically full at the end of the wet season in fig 12 from the water level variations it can be seen that the upstream reservoirs reservoirs 1 and 2 store the water later than the other reservoirs in the wet season and supply the water first in dry season the downstream reservoirs reservoirs 3 and 4 store water first in the wet season and supply water later than the other reservoirs in the dry season this law corresponds to the order of the discriminant coefficient k obtained previously i e the k value of reservoir 4 is the largest followed by that of reservoir 3 and those of reservoir 1 and reservoir 2 are the smallest in addition this law of water storage and water supply causes the downstream reservoirs operate at high water levels in most cases which is conducive to improving the water head efficiency and power generation of the entire system generally speaking the multi objective model provided in this case study can reasonably and effectively solve the corresponding multi objective operation problem however it should also be noted that in the process of solving the model some simplified treatments need to be made according to the actual situation for example considering the one to one correspondence between the ecological satisfaction rate and the discharge of upstream reservoirs we transformed the five dimensional space into a number of discretized three dimensional spaces through the different discharges to simplify the problem in addition when selecting the optimal schemes from the three dimensional space we further converted the three dimensional space into a two dimensional space according to the synergistic relationship between power generation and assurance rate which further simplified the problem finally when selecting the scheme in two dimensional space we further limited the search range for the schemes according to the actual requirement of the assurance rate and finally obtained a set of satisfactory schemes in other words in this case study we transformed the multi objective problem into a single objective problem step by step through the discrete combination and related constraints finally we obtained results however although it seems that a considerable amount of simplification has been done in the case study each simplification or restriction step is reasonable and justified although some preconditions for the simplified treatment may not be appropriate when applying this method to other watersheds we can still refer to the above methods to deal with the points that can be simplified to make the problem easier at this moment the amount of calculation will be greatly reduced when the commonly used multi objective solution method is used to solve the problem therefore the multi objective modeling and solving method proposed in this paper still has great significance and application value 4 conclusions aiming to address the multi objective operation problem of large scale mixed reservoirs this study improved and expanded the traditional esoc model of a pure cascade reservoir system by synthetically considering flood control energy generation and ecological flow objectives an optimization model of the multi objective esoc of large scale mixed reservoirs is established through application in the xijiang basin mixed reservoirs the following conclusions can be drawn 1 the results of case study show that the ecological flow satisfaction rate of the downstream control section is mainly related to the minimum discharge of the upstream reservoirs but not to other factors in addition statistics show that the power generation and guaranteed output change synchronously that is they have a cooperative relationship rather than a competitive relationship 2 when the minimum discharge of the upstream reservoirs is 350 m3 s the ecological flow satisfaction rate of the downstream control section which is 97 3 is the highest when the minimum discharge of the upstream reservoirs is in the interval 290 m3 s 450 m3 s the ecological flow satisfaction rate of the downstream control section is higher than 97 3 the results of long series simulations show that the k value of reservoir 4 is the largest followed by those of reservoir 3 and reservoir 11 and those of reservoir 1 and reservoir 2 are the smallest therefore reservoir 4 is the first to store water reservoir 3 and reservoir 11 are the second ones reservoir 1 and reservoir 2 are the last ones and the order is the opposite in supplying water 4 when the assurance rate of power generation is required to be greater than or equal to 90 the scheme with the minimum discharge of 300 m3 s is the best for this scheme the power generation and the guaranteed output are 589 89 108 kwh and 4 39e 06 kw respectively and the ecological flow satisfaction rate of the downstream control sections is 0 971 when the assurance rate of power generation is required to be greater than or equal to 95 and the ecological flow satisfaction rate of the control sections is required to be greater than or equal to 0 95 the scheme with the minimum discharge of 100 m3 s is the best and the power generation is 596 43 108 kwh and the guaranteed output is 4 08e 06 kw at this time when the assurance rate of power generation is required not to be less than 95 and the ecological flow satisfaction rate of control sections is required not to be less than 0 97 the scheme with the minimum discharge of 300 m3 s is the best for this scheme the power generation is 588 93 108 kwh and the guaranteed output is 3 43e 06 kw in conclusion the multi objectives esoc model proposed in this paper can effectively couple the esoc model with the multi objectives optimization problem to solve the actual multi objective operation problem of large scale mixed reservoirs it can provide a good reference for the operation of other basins however if the feasible schemes are not optimized and are chosen according to the practical specific criterions in this study the multi objective decision making method is used for scheme selection in this case it is necessary to determine the weights for the guaranteed output power generation and assurance rate and then to calculate the normalized three objective values to obtain a comprehensive evaluation value so as to select the optimal scheme the difficulty here lies in determining the weights of each objective and how to calculate the comprehensive evaluation index this is an unsolved problem in this paper but it will be explored in the near future declaration of competing interest none acknowledgements this study was financially supported by the natural science foundation of china 51809098 91647114 and 91547208 the national key r d program of china 2017yfc0405900 and the fundamental research fund for the central universities hust 2017kfyxjj 198 and hust 2016yxzd047 the authors are grateful to the anonymous reviewers for their comments and valuable suggestions 
6220,a reservoir operation chart is effective in guiding the actual operation of reservoirs with the development and construction of large scale mixed reservoirs operating reservoirs using multiple objective operations has become a hot issue this study therefore improved and expanded the traditional energy storage operation chart esoc model for pure cascade reservoirs based to the special relationships between hydraulics and water volume of the upstream and downstream reservoirs in a mixed reservoir system considering the objectives of flood control energy generation including power generation guaranteed output and assurance rate and ecological flow a multi objective esoc optimization model for large scale mixed reservoirs is established and the corresponding solving method for this model is proposed taking the pearl river basin of china as an example the multi objective pareto fronts of different minimum discharges of upstream reservoirs are obtained according to the actual operation demands and constraints the optimal multi objective schemes under different assurance rates and different ecological flow satisfaction rates are extracted based on the obtained pareto fronts for example if the assurance rate of power generation is required to be equal to or greater than 90 and the ecological flow the satisfaction rate of downstream control sections is required to be equal to or greater than 0 97 the scheme is the best when the minimum discharge of upstream reservoirs is 300 m3 s and the corresponding power generation and guaranteed output are 58 989 108 kwh and 439 gw respectively on the whole the proposed models and related results have significance for the actual operation of large scale mixed reservoirs keywords multi objectives operation chart ecological flow pareto front mixed reservoirs pearl river 1 introduction the nature of a reservoir operation method i e whether it is scientific or not directly affects reservoir operation presently commonly used reservoir operation methods can be divided into two categories optimal operation methods and conventional operation methods ming et al 2018 hojjati et al 2018 the optimal operation methods include classical mathematical methods and intelligent clustering algorithms yuan et al 2015 guo et al 2010 huang et al 2011 li et al 2018a such as linear programming jabr et al 2000 li et al 2013 dynamic programming vincenzo et al 2012 zhao and zhao 2004 jiang et al 2017 feng et al 2018a genetic algorithms baskar et al 2003 momtahen and dariane 2007 chen et al 2014 and particle swarm optimization cai et al 2001 zhang et al 2014 conventional operation methods include operation functions operation rules and operation charts ding et al 2018 wu et al 2019 tayebiyan et al 2019 a reservoir operation chart is usually drawn by an inverse calculation using hydrological data from typical years the drawing and operation processes are simple and convenient and the latter can reflect the reliability of a hydropower station to operate normally and the rationality of water resources utilization the reservoir chart has been widely studied and applied all over the world however current studies focus more on single reservoir operation charts and there is little work on joint operation charts for reservoir groups in joint reservoir operations the energy of the same volume of water used in single reservoir operation is different when it is applied to different reservoirs therefore the total output of the reservoir system cannot be determined only by the reservoir water level using a joint operation chart instead the current total energy state of the reservoir system needs to be considered to determine total output therefore it is particularly necessary to study the energy storage operation chart esoc of large scale reservoirs reservoir operation research began with the single reservoir operation li et al 2010 fu et al 2015 villa et al 2018 jiang et al 2018a srinivasan and kumar 2018 with the rapid development of hydropower in large basins in recent decades its related research and application has developed from a single reservoir to cascade reservoirs wang et al 2017 jiang et al 2018b liu et al 2019a b and parallel reservoirs chang and chang 2009 and then to cascade parallel coupled mixed reservoirs zhou et al 2014 munar et al 2018 the characteristics and schematic diagrams of different types of reservoir groups are shown in table 1 different from a single reservoir system with few variables and a single objective a mixed reservoir system composed of multiple reservoirs needs unified operation and management and often has a large dimension and multiple objectives at present some achievements have been made in the study of multi objective operation of reservoirs for example liu et al 2018a proposed a new algorithm named the multi objective cultured evolutionary algorithm based on decomposition for optimizing the hierarchical flood operation rules with four objectives upstream flood control downstream flood control power generation and navigation feng et al 2018b introduced the parallel multi objective genetic algorithm to effectively resolve the multi objective constrained optimization problem with two competing objectives energy production and ecological protection and numerous physical constraints however there are still some shortcomings in the existing studies for example most of the studies usually use the optimization algorithms to perform deterministic optimization calculations to verify the effectiveness of multi objective optimization method and focus more on the optimization model or algorithm efficiency ignoring the practicability of the optimization results therefore it is challenging to effectively apply the findings of these studies in practice some studies have proposed operation schemes or rules that have certain practical application effects for example uen et al 2018 proposed a holistic three fold scheme that synergistically optimized the benefits of the water food energy wfe nexus by integrating the short long term joint operation of a multi objective reservoir with irrigation ponds in response to urbanization the proposed methodology could be a viable approach to promoting the synergistic benefits of the wfe nexus lei et al 2018 derived the optimal operating rules for the flood control of large scale mixed reservoirs using a new algorithm known as the weighted non dominated sorting genetic algorithm ii which could efficiently locate the pareto front in the non dominated region owing to directed searching with the weighted crowding distance however little attention has been paid in existing studies to coupling the multi objective problem and esoc therefore it is of great practical significance to combine the multi objective operation problem with esoc to study the multi objective esoc of large scale mixed reservoirs this can not only allow for effective solving of existing multi objective optimization problems but also effective application of the results of the multi objective optimization to actual operation we therefore combined the esoc with the multi objective operation optimization problem and proposed a new multi objective esoc model for large scale mixed reservoirs considering flood control energy generation and ecological flow taking the pearl river basin of china as an example the multi objective pareto fronts under different minimum discharge scenarios were obtained based on this optimal multi objective operation schemes under different assurance rates and different ecological flow satisfaction rates were extracted furthermore the relationship between the ecological flow satisfaction rate of downstream and the minimum discharge of upstream reservoirs was analyzed and discussed in addition the optimal order of water storage and water supply of each reservoir with a regulating role was summarized using the long series simulation results overall the results discussed in this paper are of significance to the actual multi objective operation of large scale mixed reservoirs the following parts of this paper are organized as follows section 2 presents the methodology describing the drawing and simulation of the esoc for large scale mixed reservoirs and the multi objective esoc optimization model and solution obtained section 3 presents a case study of the xijiang river mixed reservoirs in the pearl river basin china and presents and analyzes the results finally in section 4 the conclusions of this study are presented 2 methodology 2 1 drawing and simulation method of the esoc for mixed reservoirs the operation method described by the esoc is a practical and conventional method in joint operation of reservoirs the esoc can be obtained by an inverse calculation using typical runoff processes liu et al 2018b meng et al 2019 however unlike for the single reservoir operation chart the output distribution of the total output among the power stations is involved in the inverse calculation of the esoc for large scale reservoir groups at this time the discriminant coefficient is generally used to distribute the total output among the power stations jiang et al 2016 2019 the discriminant coefficient method is used to determine the best order of reservoirs in storing water or supplying water and to maximize power generation and minimize energy losses as far as possible in a pure cascade reservoir system as shown in table 1 the discriminant coefficients can be simply derived as follows suppose the total output calculated by natural inflow only in the tth stage is tlt inflow and the total output required from the cascade system to the power grid is tlt grid in this stage then there are three situations i e 1 tlt inflow tlt grid in which the system will supply water 2 tlt inflow tlt grid in which the system will store water and 3 tlt inflow tlt grid in which the system will not store or supply water in situation 1 the amount of supplied water can be calculated by the output difference lsupply tlt grid tlt inflow in situation 2 the amount of stored water can be calculated by the output difference lstore tlt inflow tlt grid taking situation 1 as an example if ei t supply is the hydropower produced by the water supplied of the ith reservoir in the tth stage it can be expressed as 1 e t sup ply i k η a t i d h t sup ply i j i n h t j where k is the conversion factor of unit η is the efficiency coefficient of the generator at i is the average water surface area of the ith reservoir in the tth stage dhi t supply is the water head decrement of the ith reservoir in the tth stage hi t is the average water level of the ith reservoir in the tth stage and n is the total number of reservoirs in the system moreover for the produced hydropower ei t supply there are two extra energy losses removed by dhi t supply the first energy loss is ei t w supply which is lost from the natural inflow water wt i of the ith reservoir during hydropower production in the ith stage and can be expressed as follows 2 e t w sup ply i k η w t i d h t supply i 2 the second energy loss is ei t v supply which is lost from the available water vj avai t of the upstream reservoirs it can be expressed as 3 e t v sup ply i k η j 0 i 1 v avai t j d h t supply i therefore the extra energy losses per unit of hydropower generation of the ith hydropower station in supplying water can be expressed as 4 k t sup ply i e t w sup ply i e t v sup ply i e t sup ply i 0 5 w t i j 0 i 1 v avai t j a t i j i n h t j similarly in situation 2 the system will store water and extra energy can be obtained through a similar analysis and derivation the extra energy obtained per unit of stored energy of the ith hydropower station in storing water can be expressed as 5 k t s t o r e i e t w s t o r e i e t v s t o r e i e t s t o r e i 0 5 w t i j 0 i 1 v avai t j a t i j i n h t j in formulas 4 and 5 ki t supply represents the discriminant coefficient of each reservoir when the system supplies water and the reservoir that supplies water first in each stage has the smallest ki t supply ki t store represents the discriminant coefficient of each reservoir when the system stores the water and the reservoir that stores water first in each stage has the largest ki t store ei t store is the energy stored through the water storage of the ith reservoir in the tth stage ei t w store is the energy increment of the natural inflow water wt i of the ith reservoir in storing water ei t v store is the energy increment of the available water vj avai t of the upstream reservoirs however in mixed reservoirs as shown in table 1 considering the special water head and water volume relationships between the upstream and downstream reservoirs there are some differences in the two formulas of the discriminant coefficient 6 k t sup ply i e t w sup ply i e t v sup ply i e t sup ply i 0 5 w t i j j up re s i v avai t j a t i j j downres i h t j 7 k t s t o r e i e t w s t o r e i e t v s t o r e i e t s t o r e i 0 5 w t i j j upres i v avai t j a t i j j downres i h t j where downres represents a set of reservoir serial numbers of reservoir i and downstream reservoirs that have water head connections with reservoir i upres represents a set of reservoir serial numbers of upstream reservoirs that have water volume connections with reservoir i taking the typical mixed reservoirs given in table 1 as an example the upres of reservoir 1 is the upres of reservoir 2 is 1 the upres of reservoir 3 is the upres of reservoir 4 is and the upres of reservoir 5 is 1 2 3 4 however in pure cascade reservoirs the upres of reservoir i is 0 1 2 i 1 for downres and taking the typical mixed reservoirs given in table 1 as an example the downres of reservoir 1 is 1 2 5 the downres of reservoir 2 is 2 5 the downres of reservoir 3 is 3 5 the downres of reservoir 4 is 4 5 and the downres of reservoir 5 is 5 however in pure cascade reservoirs the downres of reservoir i is i i 1 n similar to the conventional single reservoir operation chart the esoc contains three types of output curves the basic curves the increased output curves and the reduced output curves in calculating each operation curve through the inverse calculation using the typical runoff processes the following main constraints should be considered 1 water balance constraint 8 q t i v t 1 i v t i 3600 δ t i t i l t i ev t i where qt i is the water flow used for power generation of the ith reservoir in the tth stage lt i is the abandoned water flow of the ith reservoir in the tth stage evt i is the evaporation capacity of the ith reservoir in the tth stage vi t 1 is the volume of the reservoir at the beginning of the t stage vi t is the volume of the reservoir at the end of the t stage δt is the length of an operation stage ii t is the inflow of the ith reservoir in the tth stage ii t includes the interval inflow and the total outflow of the upstream reservoirs and has a direct water connection with the ith reservoir i e 9 i t i intq t i j j s q t j where int i t i qt i is the interval inflow of the ith reservoir in the tth stage qt j represents the outflow of the jth upstream reservoir that has a direct water volume relation with reservoir i s represents a set of reservoir serial numbers of upstream reservoirs that has a direct water volume relation with reservoir i taking the typical mixed reservoirs given in table 1 as an example the s of reservoir 1 is the s of reservoir 2 is 1 the s of reservoir 3 is the s of reservoir 4 is and the s of reservoir 5 is 2 3 4 however in a pure cascade reservoir system except for the first reservoir upstream of the river the s of the other reservoirs is i 1 2 reservoir volume constraints these are the upper and lower limit constraints of water volume in each operation stage and they are hard constraints their formulae can be expressed as follows 10 v t min i v t i v t max i where vi t min is the lower limit of vi t which usually corresponds to the dead level vi t max is the upper limit of vi t which usually corresponds to the flood control level in the flood season and the normal level in the dry season 3 discharge flow constraints these are the interval constraint and non negative constraint the former is a soft constraint which can be overcome when the water level constraints break through the boundary and the latter is a hard constraint which cannot be reached at any time 11 q t min i q t i q t max i and q t i 0 where qi t min is the lower limit of qi t and is usually determined by the minimum downstream ecological flow qi t max is the upper limit of qi t and is usually determined by the downstream river channel capacity 4 output constraint in the process of drawing and simulating the esoc the output should be equal to the guaranteed output increased output or reduced output it is a soft constraint and it can be overcome in some stages such as when the water level or discharge constraints break through the boundary 12 i 1 n n t i t n g or i 1 n n t i t n inc or i 1 n n t i t n red at the same time the output should be within the feasible range 13 n t min i n t i n t max i where ni t is the output of the ith reservoir in the tth stage tng is the total guaranteed output of the mixed reservoirs tninc is the total increased output of the mixed reservoirs tnred is the total reduced output of the mixed reservoirs ni t min is the lower limit of ni t which is usually determined by the allowed minimum output ni t max is the upper limit of ni t which is usually determined by the installed capacity and expected output the inverse calculation process of the esoc can be summarized in fig 1 in fig 1 the left part is used for drawing the upper and lower basic curves the middle part is used for deriving the typical runoff processes that correspond to the upper and lower basic curves and the right part is used for drawing the increased and reduced output curves based on the derived typical runoff processes more detailed information can be found in jiang et al 2016 2019 after drawing the esoc following fig 1 evaluating the performance of the obtained esoc requires running a simulation using a long series of runoff data then a statistical analysis is also needed on indexes such as the power generation and assurance rate the simulation operation process can be summarized as follows after the esoc is obtained step 1 at the beginning of the tth stage the total energy storage est of the system can be calculated according to the available water volume vi avai t and its head connected downstream water head hi t as shown in formula 14 in this formula esi t is the energy storage of the ith reservoir in the tth stage and γ is the specific gravity of water 14 es t i 1 n es t i γ i 1 n v avai t i j i downres h t j step 2 obtain a total output named tlt chart from the esoc by est and calculate the total output of the system by natural inflow in this stage i e tlt inflow step 3 if tlt inflow is greater than tlt chart the system will store water then the reservoir that has a maximum ki t store begins to store water first until the total output calculated through the updated inflow is equal to tlt chart if the water level of the reservoir reaches the upper limit of this stage and the output has not yet reached tlt chart then the reservoir that has the second largest ki t store begins to store water step 4 if tlt chart is greater than tlt inflow the system will supply water then the reservoir that has a minimum ki t supply begins to supply water first until the total output calculated through the updated inflow is equal to tlt chart if the water level of the reservoir reaches the lower limit of this stage and the output has not yet reach to tlt chart then the reservoir that has the second smallest ki t supply begins to supply water step 5 if tlt chart is equal to tlt inflow the system will not store or supply water the system will produce hydropower by natural inflow only for the sake of simplicity of operation the input of runoff forecasting is not considered in the above process in fact to achieve forecasting of the inflow and the esoc we need to take the predicted inflow into account when calculating the total energy storage of the system when drawing the esoc and performing the simulation calculation in other words the energy value of the predicted inflow of the current stage needs to be added to the total energy storage value of the system to determine the total output of the system in the current stage 2 2 modeling and solving of multi objective esoc optimization 2 2 1 model of multi objective esoc optimization the esoc obtained in section 2 1 is only a single result under specific constraints and boundaries such as a definite initial guaranteed output and a definite minimum discharge combination from the upstream reservoirs if the guaranteed output of the system is changed or the minimum discharge combination of the upstream reservoirs is changed what will the result be this involves the multi objective optimization problem in the multi objective joint operation of the reservoirs the objectives generally involved are the flood control objective energy generation objective including three sub objectives i e power generation guaranteed output and assurance rate and ecological objective such as minimum ecological flow 1 for the flood control objective it is generally converted to water level constraints specifically in the flood season the operating water level is required to be lower than the flood control limit water level and in the non flood season the operating water level is required to be lower than the normal water level liu et al 2019a b as a compulsory target it is generally converted to a compulsory constraint its objective function can be simply expressed as follows zhao et al 2017 uysal et al 2018 15 flood season z t z floodcontrollevel non flood season z t z normallevel where zt is the operation level of the reservoir in the tth stage and zfloodcontrollevel is the highest operation level of the reservoir in the flood season that is the flood control limited level znormalevel is the highest operation level of the reservoir in the non flood season that is the normal storage level 2 ecological objectives refer mainly to the ecological flow requirements of downstream control sections e g the minimum ecological flow li et al 2018a b c however the river flow of the downstream section can only be controlled by the discharge of upstream reservoirs that have a regulating role therefore the ecological flow requirement can be converted into the minimum discharge requirement of the upstream reservoirs if there is more than one reservoir that has a regulating role above the control section in a mixed reservoir system the minimum possible discharge interval of the upstream reservoirs can be discretized and arranged then a long series of simulation calculations can be carried out for each combination and the channel flow situation of the downstream control sections under each combination can be counted finally the ecological flow satisfaction rate of the control sections can be obtained for the ecological objective several methods can be used to describe the ecological flow demand of rivers comprehensively at present because of the complexity of the river ecosystem itself fang et al 2019a therefore there is no unified understanding of the establishment of the ecological objective huang et al 2014 this study uses several commonly used ecological objectives are introduced ① minimize the ecological overflow and water shortage according to this theory suitable ecological flow should have upper and lower bounds and the discharged flow after reservoir operation should fall within the bounds as far as possible lu et al 2011 lu et al 2018 it can be expressed as follows 16 f 1 min v eco min v ecoover v ecolack min k 1 m t 1 t d q ecohigh k t d q ecolow k t δ t where v eco is the ecological overflow and water shortage including the overflow v ecoover and the water shortage v ecolack the cumulative value v ecoover indicates that the actual flow process is larger than the upper limit of the suitable interval of ecological flow and the cumulative value v ecolack indicates that the actual flow process is smaller than the lower limit of the suitable interval of ecological flow dqecohigh k t represents the difference between actual flow and the upper limit of the suitable interval of ecological flow of the kth ecological control section in the tth stage when the actual flow process is greater than the upper limit of the suitable interval of ecological flow dqecolow k t represents the difference between the lower limit of the suitable interval of ecological flow and the actual flow of the kth ecological control section in the t stage when the actual flow process is less than the lower limit of the suitable interval of ecological flow m is the total number of ecological control sections t is the number of stages over the entire operation period ② minimize the coefficient of ecological change according to this theory natural flow is the optimal ecological flow yu et al 2017 yang et al 2019 the closer the dispatched flow is to natural flow the better the ecological objective is its expression can be described as follows 17 f 1 min k 1 m 1 t t 1 t q k t o q k t e q k t e 100 2 where qk t o is the monthly average flow of the ecological control section after reservoir operation qk t e is the monthly average flow of the ecological control section under natural conditions this formula reflects the fluctuation in monthly ecological flow in the form of the root mean square change which is the relative change degree of the monthly average dispatched flow to natural flow the smaller the value of f 1 is the closer the monthly average dispatched flow is to the natural flow and the smaller the degree of hydrological variability is ③ maximum satisfaction rate of the minimum ecological flow the minimum ecological flow of a river is the minimum water needed to maintain the survival of the river eco environment and it is the basic discharge to be firstly considered in reservoir operation in some cases for example when the data are incomplete and limited the lower limit of the suitable interval of ecological flow can be considered only that is to say the probability of a minimum discharge greater than or equal to the lower limit of the suitable interval of ecological flow should be as large as possible or not be less than a given threshold value its functional expression can be simply described as follows 18 f 1 max e c o r a t e k max t totalstages time s k t totalstages 100 where ecoratek represents the ecological flow satisfaction rate of the kth section and totalstages represents the number of stages in the operation period of the entire simulation timesk t is the statistical function of the kth ecological flow control section if qt k qt k eco then timesk t 1 if qt k qt k eco then timesk t 0 qt k eco represents the minimum ecological flow of the control section in the tth stage qt k represents the instream flow of the kth control section in the t stage if the interval inflow is not considered qt k is equal to the sum of qi t of upstream reservoirs which are directly related to the kth control section the maximum ecological flow satisfaction rate is the simplest objective among the above three objectives which only considered the minimum ecological flow demand in this study due to data limitations we choose this objective as the ecological objective in the case study 3 for the objective of energy generation it generally includes three sub objectives i e power generation assurance rate and guaranteed output and there is a certain synergy and competition relationship among these three objectives generally the assurance rate and guaranteed output have a competitive relation that is the assurance rate decreases with an increase in guaranteed output and the assurance rate increases with a decrease in guaranteed output the relationship between the guaranteed output and power generation may be competitive jiang et al 2016 or synergistic jiang et al 2018c depending on the specific watershed in the study the objective functions of power generation guaranteed output and assurance rate can be expressed as follows georgakakos et al 1997 fu et al 2019 ① maximum power generation 19 f 2 max e max δ t i 1 n t 1 t n t i where e is the total power generation of the system and δt is the length of an operation stage ② maximum guaranteed output 20 f 3 max t n g where tng is the total guaranteed output of the system ③ maximum assurance rate 21 f 4 max p max ϕ tn t a c t u a l tn g t 100 t 1 2 t p p min where ϕ is the statistical function that represents the times that the actual total output of system is greater than or equal to the guaranteed output tnt actual is the actual total output of system in the tth stage in the simulation calculation p is the statistical assurance rate of system in each simulation operation p min is the lower limit of assurance rate 2 2 2 solving of multi objective esoc optimization model in solving the above multi objective esoc model the guaranteed output is a key variable that determines the final esoc and it has the greatest impact on the final results therefore the total guaranteed output of the system can be discretized within a feasible range and then coupled with the minimum discharge combination of upstream reservoirs at this time for a discretized guaranteed output and a minimum discharge combination the corresponding esoc for the large scale mixed reservoirs can be obtained by the drawing method described in section 2 1 then according to the simulation steps of the esoc in section 2 1 the total power generation assurance rate and ecological flow satisfaction rate of the mixed reservoirs system under the given guaranteed output and minimum discharge combination can be obtained through a long series of simulation calculation and analyses so far the five dimensional objective space minimum discharge combination power generation guaranteed output assurance rate ecological flow satisfaction rate can be constructed the steps can be summarized as follows step 1 within a feasible range such as 30 or 40 of the initial total guaranteed output a series of discretized guaranteed output values can be obtained by discretization with a certain step length step 2 referring to the actual minimum discharge data of upstream reservoirs that have the regulating role a series of minimum discharge combinations can be obtained by discretizing the minimum discharge of the upstream reservoirs in a feasible range with a certain step length step 3 the esoc of the mixed reservoirs can be determined using the inverse calculation for each discretized guaranteed output and minimum discharge combination then the corresponding total power generation assurance rate of power generation and ecological flow satisfaction rate of the control sections can be obtained by carrying out simulated calculations with a long series of runoff data step 4 based on the simulation results of different guaranteed outputs and different minimum discharge combinations the five dimensional objective space of minimum discharge combination power generation guaranteed output assurance rate ecological flow satisfaction rate can be constructed taking three reservoirs that have the regulating performance as an example the idea of constructing the above five dimensional objective space using pseudo code can be expressed as follows construction of the multidimensional objective space 1 for q 1 q 1 min δq 1 q 1 max 2 for q 2 q 2 min δq 2 q 2 max 3 for q 3 q 3 min δq 3 q 3 max 4 for tn tn min δtn tn max 5 drawingenergystorageoperationchart 6 e rate ecorate longseriessimulation 7 end for 8 end for 9 end for 10 end for where δq 1 δq 2 and δq 3 are the discrete steps of minimum discharge of the three upstream reservoirs respectively δtn is the discrete step of the total guaranteed output e is the total power generation of the system rate is the assurance rate ecorate is the ecological flow satisfaction rate of downstream control sections the drawingenergystorageoperationchart represents the drawing function of the esoc and the longseriessimulation represents the calculation function of the simulation using the esoc and a long series of runoff data according to the above steps after obtaining the multi objective feasible solution space the related multi objective decision making theory needs to be used to further optimize the schemes and make decisions the pareto theory is currently the most widely used method for dealing with multi objective problems the pareto solution is also called the non dominated solution that is one solution is the best for one objective and the worst for the other because of the conflict and incomparability among objectives while improving any objective the solution that results in least one other objective being inevitably weakened is called the non dominant solution or pareto solution another related concept is pareto improvement which refers to a change that makes at least one objective better without making any other objective worse pareto optimality refers to the state in which there is no space for pareto improvement the surface formed by the optimal set in the solution space is called the pareto front relevant definitions and interpretations can be expressed as follows fonseca et al 2016 luo et al 2018 if x 1 and x 2 belong to any two individuals in the feasible solution the relationship between them satisfies formula 22 then x 1 is pareto dominant compared with x 2 or x 1 dominates x 2 22 i 1 2 m f i x 1 f i x 2 and j 1 2 m f j x 1 f j x 2 this is usually referred to as x 1 x 2 when and only when x x x x x x is called the pareto optimal solution and the pareto optimal solution set is the set of all pareto optimal solutions defined as follows 23 p x x x x x furthermore the surface consisting of the objective vectors corresponding to all pareto optimal solutions is called pareto front i e 24 pf f x f 1 x f m x x p in this paper under each minimum discharge combination there are four objectives i e the ecological flow satisfaction rate f 1 power generation f 2 guaranteed output f 3 and assurance rate f 4 after the feasible solutions of the problem are obtained by a discrete combination and simulation calculation the pareto optimal solution set can be obtained by the above definitions after obtaining the pareto optimal solution the relevant decision making methods li et al 2018b the scheme optimization criterion or the actual operation criterion can be used for scheme optimization and decision making 3 case study 3 1 basin introduction and basic data the pearl river is the third longest river in china with a total length of 2320 km its watershed area is about 440 000 square kilometers its annual runoff is more than 349 2 billion cubic meters ranking second in china s river systems the pearl river flows through yunnan guizhou guangxi guangdong hunan jiangxi and the northeastern part of the socialist republic of vietnam it includes three major tributaries i e xijiang beijiang and dongjiang among them the xijiang is the longest and is usually called the mainstream of the pearl river presently hydropower development in the xijiang basin has been basically completed there are thirteen reservoirs in total upstream and downstream of the river which constitute a large scale mixed reservoir system with both a cascade reservoir system and parallel reservoir system as shown in fig 2 five reservoirs in this mixed system i e tianyi guangzhao yantan longtan and baise have the regulating role we chose this mixed reservoir system to study the multi objective operation problem and the reservoirs are numbered by 1 2 3 and 13 with the numbering process starting upstream of the river the topological structure of the mixed reservoirs system is shown in fig 3 the basic parameters of each power station are shown in table 2 the upper limits of the operating water levels of each reservoir are shown in table 3 and the lower limit is the dead water level according to the above topological structure of the mixed reservoirs the s set downres set and upres set of each reservoir can be obtained as shown in table 4 in the joint operation of the xijiang basin there are two ecological flow control sections i e dahuangjiang and wuzhou section as shown in fig 2 the ecological flow requirement is considered the main ecological objective in the joint operation the range of variability approach rva method bradford et al 2007 yu et al 2016 is used to calculate the lower limit of the ecological flow which is the most widely used multivariable approach for the assessment of flow regime alteration fang et al 2019b furthermore the flow process corresponding to 90 of the monthly frequency is taken as the lower limit of the suitable ecological flow interval based on this the minimum ecological flow requirement of the dahuangjiang and wuzhou sections can be obtained as shown in table 5 because the datengxia hydropower station is close to the dahuangjiang section and the changzhou hydropower station is close to the wuzhou section the discharge of the datengxia hydropower station is used to represent the river flow of the dahuangjiang section and the discharge of the changzhou hydropower station is used to represent the river flow of the wuzhou section in this study in addition because the dahuangjiang and wuzhou sections are both located downstream of the basin and there are no reservoirs that have a regulating role or tributaries between them their ecological flow satisfaction rates are basically the same therefore this study uses one index to express the comprehensive satisfaction rate of these two sections the calculation formula is as follows 25 ecorate t totalstages k 1 2 time s k t 2 t o t a l s t a g e s 100 3 2 results and analysis in this paper the discrete interval of the total guaranteed output is established using the initial guaranteed output which is the sum of the guaranteed output of each hydropower station i e 3588 mw and get the feasible interval that is 0 6 3588 mw 1 4 3588 mw the discrete space of the total guaranteed output is obtained by taking 10 mw as step length in addition in view of the combination of the minimum discharges of the upstream reservoirs the calculation will be time intensive if the minimum discharge combinations among these reservoirs are considered therefore we assume that the minimum discharge of these five reservoirs changes synchronously and discretizes the discharge interval 0 m3 s 500 m3 s at 50 m3 s intervals to obtain the discrete space of the minimum discharge this comprises a total of 11 kinds of minimum discharges 0 m3 s 50 m3 s 100 m3 s 150 m3 s 200 m3 s 250 m3 s 300 m3 s 350 m3 s 400 m3 s 450 m3 s and 500 m3 s the esoc is drawn and simulated under different guaranteed outputs and minimum discharge combinations using statistics it is found that under different guaranteed outputs the ecological flow satisfaction rate of the downstream control sections basically remains unchanged as long as the minimum discharge combination of the upstream reservoirs remains unchanged in other words the ecological flow satisfaction rate of the downstream control sections is related mainly to the minimum discharge of the upstream reservoirs not to other factors taking the minimum discharges 100 m3 s 200 m3 s 300 m3 s and 400 m3 s as examples the variations in the ecological flow satisfaction rate with changes in the guaranteed output are shown in fig 4 therefore we can conclude that when the multi objective schemes are optimized according to a five dimensional solution space a series of schemes corresponding to the minimum discharge or ecological flow satisfaction rate can be obtained by selecting the optimal one from the three dimensional multi objective space of the power generation guaranteed output assurance rate in addition the relationship between the ecological flow satisfaction rate of downstream sections and the minimum discharge of upstream reservoirs was obtained as shown in fig 5 via statistical analysis of the long series simulation calculation results show it can be seen that the ecological flow satisfaction rate of downstream control sections is the largest when the minimum discharge of upstream reservoirs is 350 m3 s which is about 97 3 the ecological flow satisfaction rate of downstream control sections is larger than 97 when the minimum discharge of upstream reservoirs is in the interval 290 m3 s 450 m3 s furthermore from fig 5 it can be seen that with an increase in the minimum discharge of upstream reservoirs the ecological flow satisfaction rate of downstream control sections increases first and then decreases in other words the ecological flow satisfaction rate will decrease when the minimum discharge of upstream reservoirs increased to a certain extent this is because with an increase in the minimum discharge the ecological flow increases when the minimum discharge of upstream reservoirs is small especially in the dry season so the ecological flow satisfaction rate increases gradually in this time period however when the minimum discharge of the upstream reservoirs is too large although the requirement of ecological flow can be met in some early stages the reservoir is often not full or insufficient at the end of the wet season therefore the water supply of the reservoir in the later stages will be greatly compromised which leads to a low ecological flow satisfaction rate over the entire operation period in addition fig 5 shows that the ecological flow satisfaction rate of the downstream sections is the largest when the minimum discharge of the upstream reservoirs is 350 m3 s which means that the reservoir can take the minimum discharge requirement into account both in the wet season and dry season under this minimum discharge so as to maximize the total ecological flow satisfaction rate over the entire operation period taking the minimum discharge of 0 m3 s 100 m3 s 200 m3 s 300 m3 s 400 m3 s and 500 m3 s as the examples the three dimensional feasible solution space of the power generation guaranteed output assurance rate and the corresponding pareto front under different minimum discharge combinations are shown in fig 6 choosing the best scheme from the three dimensional power generation guaranteed output assurance rate can be based on the criterion of maximizing the power generation under a certain assurance rate requirement the guaranteed output under a certain assurance rate requirement or on other relevant multi objective decision making methods here the former is used to choose the schemes table 6 shows the criterion of maximizing the power generation and assurance rate so that they are not less than 90 given the optimal scheme results under each minimum discharge combination from table 6 it can be seen that the guaranteed output of the optimal schemes increased first and then decreased under different minimum discharges while the corresponding variation in power generation has no obvious regularity increases first then decreases and then increase and then decreases if the ecological flow satisfaction rate of the downstream section is required to be greater than 97 the schemes can be selected from the minimum discharges of 300 m3 s 350 m3 s 400 m3 s and 450 m3 s comparatively the power generation and guaranteed output which are 58 989 108 kwh and 4 39e 06 kw respectively are both larger than others when the minimum discharge is 300 m3 s the corresponding esoc of the mixed reservoirs system at this time is shown in fig 7 correspondingly the multi year average water level obtained by long series simulation of each reservoir is shown in fig 8 it can be seen that the full storage rates of the reservoirs are low owing to the large requirement of minimum discharge in addition through an analysis of the long series simulation results it is found that there are only 10 combinations 120 combinations in theory for the order of water storage and water supply of reservoirs k value order therefore the monthly analyses were carried out using the long series simulation results when the assurance rate was 90 and minimum discharge was 300 m3 s the number of water storage and water supply orders in each month are obtained and used to determine the most possible combinations of water storage and water supply in each month as shown in table 7 from table 7 it can be seen that in march june and july the order of the k value in combination 4 3 11 1 2 or 4 3 11 2 1 is the best for the operation of water storage and water supply in may and august the order of the k value in combination 4 3 11 1 2 or 4 11 3 1 2 is the best in september october december january february and april the order of the k value in combination 4 3 11 1 2 is the best furthermore in terms of long series reservoir 4 has the largest k value followed by those of reservoir 3 and reservoir 11 the k values of reservoir 1 and reservoir 2 are the smallest in addition the case study shows that the power generation and guaranteed output in this basin changes synchronously i e they have a cooperative relationship rather than a competitive relationship taking the minimum discharges of 100 m3 s 200 m3 s 300 m3 s and 400 m3 s as examples as shown in fig 9 it can be seen that the power generation increases with an increase in the guaranteed output from this result it can be concluded that the above mentioned scheme selection criterion of maximizing the power generation under a certain assurance rate requirement is the same as that for maximizing the guaranteed output under a certain assurance rate requirement therefore different schemes can be obtained by setting different assurance rate requirements e g 90 95 or 98 for example the optimal scheme results under each minimum discharge combination based on the criterion of maximizing the power generation and requiring the assurance rate to be greater than or equal to 95 were obtained and are shown in table 8 from table 8 it can be seen that the guaranteed output of the optimal scheme increases first and then decreases under different minimum discharge combinations and the maximum value is achieved close to the minimum discharge of 100 m3 s which is 4 08e 06 kw the corresponding power generation also increases first and then decreases and the maximum value is also achieved close to the minimum discharge of 100 m3 s which is 596 43 108 kwh however at this time the ecological flow satisfaction rate is only about 0 95 and does not reach 0 97 therefore if 0 95 can meet the actual requirement of the ecological flow satisfaction rate at this time then the scheme with the minimum discharge of 100 m3 s is the best one if the ecological flow satisfaction rate must be above 0 97 then the scheme with the minimum discharge of 300 m3 s is the best one and the power generation and guaranteed output are is 588 93 108 kwh and 3 43e 06 kw the esocs for these two cases are shown in figs 10 and 11 respectively taking the scheme with the minimum discharge of 100 m3 s as an example the multi year average water level variations in the five reservoirs that have regulating performance are shown in fig 12 it can be seen that compared with the scheme with the minimum discharge of 300 m3 s all the reservoirs are basically full at the end of the wet season in fig 12 from the water level variations it can be seen that the upstream reservoirs reservoirs 1 and 2 store the water later than the other reservoirs in the wet season and supply the water first in dry season the downstream reservoirs reservoirs 3 and 4 store water first in the wet season and supply water later than the other reservoirs in the dry season this law corresponds to the order of the discriminant coefficient k obtained previously i e the k value of reservoir 4 is the largest followed by that of reservoir 3 and those of reservoir 1 and reservoir 2 are the smallest in addition this law of water storage and water supply causes the downstream reservoirs operate at high water levels in most cases which is conducive to improving the water head efficiency and power generation of the entire system generally speaking the multi objective model provided in this case study can reasonably and effectively solve the corresponding multi objective operation problem however it should also be noted that in the process of solving the model some simplified treatments need to be made according to the actual situation for example considering the one to one correspondence between the ecological satisfaction rate and the discharge of upstream reservoirs we transformed the five dimensional space into a number of discretized three dimensional spaces through the different discharges to simplify the problem in addition when selecting the optimal schemes from the three dimensional space we further converted the three dimensional space into a two dimensional space according to the synergistic relationship between power generation and assurance rate which further simplified the problem finally when selecting the scheme in two dimensional space we further limited the search range for the schemes according to the actual requirement of the assurance rate and finally obtained a set of satisfactory schemes in other words in this case study we transformed the multi objective problem into a single objective problem step by step through the discrete combination and related constraints finally we obtained results however although it seems that a considerable amount of simplification has been done in the case study each simplification or restriction step is reasonable and justified although some preconditions for the simplified treatment may not be appropriate when applying this method to other watersheds we can still refer to the above methods to deal with the points that can be simplified to make the problem easier at this moment the amount of calculation will be greatly reduced when the commonly used multi objective solution method is used to solve the problem therefore the multi objective modeling and solving method proposed in this paper still has great significance and application value 4 conclusions aiming to address the multi objective operation problem of large scale mixed reservoirs this study improved and expanded the traditional esoc model of a pure cascade reservoir system by synthetically considering flood control energy generation and ecological flow objectives an optimization model of the multi objective esoc of large scale mixed reservoirs is established through application in the xijiang basin mixed reservoirs the following conclusions can be drawn 1 the results of case study show that the ecological flow satisfaction rate of the downstream control section is mainly related to the minimum discharge of the upstream reservoirs but not to other factors in addition statistics show that the power generation and guaranteed output change synchronously that is they have a cooperative relationship rather than a competitive relationship 2 when the minimum discharge of the upstream reservoirs is 350 m3 s the ecological flow satisfaction rate of the downstream control section which is 97 3 is the highest when the minimum discharge of the upstream reservoirs is in the interval 290 m3 s 450 m3 s the ecological flow satisfaction rate of the downstream control section is higher than 97 3 the results of long series simulations show that the k value of reservoir 4 is the largest followed by those of reservoir 3 and reservoir 11 and those of reservoir 1 and reservoir 2 are the smallest therefore reservoir 4 is the first to store water reservoir 3 and reservoir 11 are the second ones reservoir 1 and reservoir 2 are the last ones and the order is the opposite in supplying water 4 when the assurance rate of power generation is required to be greater than or equal to 90 the scheme with the minimum discharge of 300 m3 s is the best for this scheme the power generation and the guaranteed output are 589 89 108 kwh and 4 39e 06 kw respectively and the ecological flow satisfaction rate of the downstream control sections is 0 971 when the assurance rate of power generation is required to be greater than or equal to 95 and the ecological flow satisfaction rate of the control sections is required to be greater than or equal to 0 95 the scheme with the minimum discharge of 100 m3 s is the best and the power generation is 596 43 108 kwh and the guaranteed output is 4 08e 06 kw at this time when the assurance rate of power generation is required not to be less than 95 and the ecological flow satisfaction rate of control sections is required not to be less than 0 97 the scheme with the minimum discharge of 300 m3 s is the best for this scheme the power generation is 588 93 108 kwh and the guaranteed output is 3 43e 06 kw in conclusion the multi objectives esoc model proposed in this paper can effectively couple the esoc model with the multi objectives optimization problem to solve the actual multi objective operation problem of large scale mixed reservoirs it can provide a good reference for the operation of other basins however if the feasible schemes are not optimized and are chosen according to the practical specific criterions in this study the multi objective decision making method is used for scheme selection in this case it is necessary to determine the weights for the guaranteed output power generation and assurance rate and then to calculate the normalized three objective values to obtain a comprehensive evaluation value so as to select the optimal scheme the difficulty here lies in determining the weights of each objective and how to calculate the comprehensive evaluation index this is an unsolved problem in this paper but it will be explored in the near future declaration of competing interest none acknowledgements this study was financially supported by the natural science foundation of china 51809098 91647114 and 91547208 the national key r d program of china 2017yfc0405900 and the fundamental research fund for the central universities hust 2017kfyxjj 198 and hust 2016yxzd047 the authors are grateful to the anonymous reviewers for their comments and valuable suggestions 
6221,reliable and accurate prediction of reference evapotranspiration eto is a precondition for the efficient management and planning of agricultural water resources as well as the optimal design of irrigation scheduling this study evaluated the performances of four bio inspired algorithm optimized extreme learning machine elm models i e elm with genetic algorithm elm ga elm with ant colony optimization elm aco elm with cuckoo search algorithm csa and elm with flower pollination algorithm elm fpa for predicting daily eto across china by using a five fold cross validation approach these models were further compared with the classical elm model parameterized by the grid search method to demonstrate their capability and efficiency daily maximum and minimum ambient temperatures wind speed relative humidity and global solar radiation data during 2001 2015 collected from eight meteorological stations in contrasting climates of china were utilized to train validate and test the models the results showed that eto values predicted by all elm models agreed well with the corresponding fao 56 penman monteith values with r2 rmse nrmse and mae ranging 0 9766 0 9967 0 0896 0 2883 mm day 1 3 2910 11 7653 and 0 0708 0 1998 mm day 1 respectively the elm fpa model r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 slightly outperformed the elm csa model r2 0 9922 rmse 0 1619 mm day 1 nrmse 5 6864 and mae 0 1200 mm day 1 during testing both of which were superior to the elm aco r2 0 9912 rmse 0 1730 mm day 1 nrmse 6 0816 and mae 0 1254 mm day 1 and elm ga r2 0 9889 rmse 0 1895 mm day 1 nrmse 6 7197 and mae 0 1310 mm day 1 models followed by the standalone elm model r2 0 9856 rmse 0 2104 mm day 1 nrmse 7 1693 and mae 0 1408 mm day 1 the four hybrid elm models exhibited higher improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon climates with average decrease in rmse of 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates with average decrease in rmse of 5 2 9 8 12 9 and 14 1 respectively the results advocated the capability of bio inspired optimization algorithms especially the fpa and csa algorithms for improving the performance of the conventional elm model in daily eto prediction in contrasting climates of china keywords reference evapotranspiration extreme learning machine genetic algorithm ant colony optimization cuckoo search algorithm flower pollination algorithm 1 introduction reference evapotranspiration eto is an imperative hydrological component which is a prerequisite for the efficient management and planning of agricultural water resources as well as the optimal design of irrigation scheduling feng et al 2016 karimi et al 2017 wang et al 2017a yan et al 2019 many mathematical equations have been established to predict eto with climatic variables among which the fao 56 penman monteith fao 56 pm equation has been widely accepted as a reference model in diverse areas and climates allen et al 1998 because it considerers both the thermodynamic and aerodynamic items however the fao 56 pm equation needs a variety of climatic parameters as model inputs for calculation e g maximum and minimum ambient temperatures wind speed relative humidity and net radiation shiri et al 2014 fan et al 2016 which significantly limits the application of the fao 56 pm model worldwide thus simplified empirical models with fewer climatic variables are becoming increasingly popular in regions in the absence of complete meteorological data such as temperature based mass transfer based and radiation based models wen et al 2015 feng et al 2017a 2018 however evapotranspiration is a complex and highly nonlinear phenomenon dependent on several climatic parameters therefore it is difficult to establish empirical models considering all those complicated processes over the past two decades due to the excellent performance in tackling nonlinear relationships between the model inputs and output xiao et al 2019 machine learning models have been widely used to reveal the complex hydrological phenomena yaseen et al 2018a b c ghorbani et al 2018a sanikhani et al 2018 hou et al 2018 fan et al 2018a b ma et al 2019a b feng et al 2019 wu et al 2019 including eto prediction kisi and sanikhani 2015 wang et al 2017b jovic et al 2018 such as artificial neural networks ann trajkovic et al 2003 landeras et al 2008 antonopoulos and antonopoulos 2017 support vector machines svm shiri et al 2014 adaptive neuro fuzzy inference system anfis dogan 2009 baba et al 2013 petković et al 2015 sanikhani et al 2019 multivariate adaptive regression splines mars mehdizadeh et al 2017 and deep learning dl saggi and jain 2019 recently a relatively new machine learning model named extreme learning machine elm has been established for eto prediction with high prediction accuracy and computational efficiency abdullah et al 2015 patil and deka 2016 gocic et al 2016 feng et al 2016 2017b yin et al 2017a fan et al 2018c for instance abdullah et al 2015 firstly proposed a elm model to predict daily eto in iraq and revealed its superiority over the feedforward backpropagation ffbp model with high computational speed and good generalization performance patil and deka 2016 compared the capabilities of the elm ann least squares svm and hargreaves models for predicting weekly eto with extrinsic inputs at two weather stations in india they found that the elm and ls svm models showed similar performance both of which were superior to the ann and hargreaves models gocic et al 2016 predicted monthly eto at two weather stations in serbia using the elm hargreaves priestley taylor and turc models with meteorological data during 1980 2010 the results indicated that the elm model was superior to the empirical models for monthly eto prediction feng et al 2016 compared the elm genetic algorithm based backpropagation neural networks gann wavelet neural networks wnn and empirical models for daily eto prediction in southwest china they revealed that the elm and gann models performed better than the wnn and empirical models feng et al 2017b predicted daily eto with the elm and generalized regression neural network grnn based on maximum and minimum temperature data in the sichuan basin of southwest china and found that the elm model gave more accurate eto estimates than the grnn model hargreaves and calibrated hargreaves models yin et al 2017a projected future eto variability using the elm model along with support vector regression svr in the yingluoxia watershed of northwest china it was found that the elm and svr models displayed very good performances for eto prediction with slight better performance by the svr model fan et al 2018c recently evaluated the performances of the kernel based svm elm models as well as four tree based machine learning models in daily eto modeling across china it was concluded that the elm model was slightly superior to the svm model both of which performed better than the tree based models regarding accuracy and stability the accuracy and efficiency of machine learning models largely depend on the internal model parameters nevertheless these parameters have to be tuned during model training for the efficient application of machine learning models the grid search and gradient decent based algorithms are mostly used for model parameter selection however the obtained results are always ineffective as a result of the complex nature of the hyper parameters olatomiwa et al 2015 these algorithms often have high computational complexity and are usually prone to local minima on the contrasts bio inspired algorithms seem to be more efficient and accurate because they can provide global solutions to the optimization problems the combination of bio inspired optimization algorithms with machine learning models may improve the performances of the models because it is capable of deducting the optimal solutions for the optimization problem and improving the computational speed therefore machine learning models have been recently coupled with bio inspired optimization algorithms such as genetic algorithm ga yin et al 2017b particle swarm optimization pso petković et al 2016 artificial bee colony abc ozkan et al 2011 and firefly algorithm ffa tao et al 2018 to optimize the training processes and further enhance the prediction accuracy of machine learning models in forecasting of hydrological components fahimi et al 2017 yaseen et al 2016 for instance yaseen et al 2017 developed a hybrid model based on the anfis model and ffa algorithm for river streamflow forecasting they found that the new hybrid anfis ffa model performed better than the standalone anfis model ghorbani et al 2018b developed a hybrid mlp ffa model for prediction of daily pan evaporation and found the hybrid mlp ffa model was superior to the classical mlp model in terms of eto ozkan et al 2011 coupled ann with abc for daily eto prediction at two meteorological stations in los angeles of usa they revealed that the ann abc model exhibited better performance in eto prediction than the levenberg marquardt lm and standard back propagation sbp optimized ann models eslamian et al 2012 predicted monthly eto in the esfahan province of iran by coupling ann and ga the results indicated that the ann ga model gave more accurate monthly eto estimates than the classical ann model and ga was a strong tool to reach the global optimal solution shamshirband et al 2015 predicted monthly eto in serbia using the ann and anfis models coupled with the cuckoo search algorithm csa it was found that the csa algorithm improved the prediction accuracy of the anfis model but not the ann model gocić et al 2015 predicted monthly eto in serbia using the svm model optimized by ffa and found that svm ffa was superior to ann and gp petković et al 2016 integrated the radial basis function rbf neural network with pso and back propagation bp for prediction of monthly eto in serbia the results indicated that rbf pso slightly outperformed rbf bp in eto modeling while both of them performed much better than ann and svm yin et al 2017b integrated svm and ga for daily eto prediction in yingluoxia watershed of northwest china and proved the superiority of svm ga for predicting eto compared with conventional svm and ann tao et al 2018 recently predicted eto in a semi arid environment of burkina faso using hybridized anfis with ffa the results indicated that the hybrid anfis ffa model outperformed the standalone anfis model apparently the relatively new elm model has drawn researchers attention as an efficient machine learning model for accurate prediction of eto however the kernel based elm model still has certain internal limitations in the tuning of model parameters especially the parameters of the introduced kernel functions huang 2014a b coupling the elm model with bio inspired algorithms can provide a better way to overcome the limitations in model parameter optimization although some bio inspired algorithms have been used to optimize machine learning models for eto prediction they are largely limited to classical bio inspired algorithms e g ga pso and ffa rather than newly developed optimization algorithms such as ant colony optimization aco cuckoo search algorithm csa and flower pollination algorithm fpa therefore the main purpose of the present study was to assess the prediction accuracy of elm models optimized by four bio inspired algorithms proposed during 1970s 2010s ga aco csa and fpa algorithms for predicting daily eto in contrasting climates of china furthermore the conventional grid search based elm model was also investigated for comparison to the best of the authors knowledge this is the first implementation of hybrid elm models with various bio inspired optimization algorithms for more reliable and accurate prediction of daily eto 2 case study daily maximum and minimum ambient temperatures wind speed relative humidity and global solar radiation data for the period of 2001 2015 were collected from eight representative meteorological stations across various climates in china fig 1 i e the temperate continental region tc the temperate monsoon region tm the mountain plateau region mp and the sub tropical monsoon region sm fan et al 2016 for the modeling 53 3 eight year dataset and 13 3 two year dataset during 2001 2010 were used for model training and validation respectively while the remaining 33 4 five year dataset for the period 2010 2010 were used for testing the annual mean values standard deviation of these climatic parameters during training validation and testing for the eight studied stations are presented in table 1 which were provided and quality controlled by the national meteorological information center nmic it is apparent that the annual mean tmax varied from 27 3 c at guangzhou to 10 4 c at harbin the mean tmin ranged from 19 7 c at guangzhou to 0 1 c at harbin the annual mean u2 changed from 1 9 m s 1 at urumqi to 1 0 m s 1 at wuhan annual mean hr was between 79 1 at guangzhou and 30 8 at geermu and the annual mean rs was between 20 5 mj m 2 d 1 at lasa and 11 7 at guangzhou mj m 2 d 1 the lowest annual mean daily eto 2 2 mm d 1 was observed at harbin while the highest value 3 5 mm d 1 appeared at lasa it is noted from table 1 that the differences between the meteorological values during training validation and testing did not vary substantially except for the subtropical monsoon zone where greater increases in wind speed and relative humidity were observed 3 methodology 3 1 fao 56 penman monteith equation the fao 56 penman monteith fao 56 pm model suggested by allen et al 1998 was utilized to calculate daily eto mm day 1 and provide the reference data for the training validation and testing of elm models in this paper li et al 2012 kisi 2015 fan et al 2016 1 e t o 0 408 δ r n g γ 900 t mean 273 u 2 e s e a δ γ 1 0 34 u 2 where rn net radiation mj m 2 day 1 g soil heat flux mj m 2 day 1 tmean average ambient temperature c u2 wind speed at 2 m height m s 1 es saturation vapor pressure kpa ea actual vapor pressure kpa δ slope of the vapor pressure curve kpa c 1 γ psychrometric constant kpa c 1 detailed calculation procedures can be found in allen et al 1998 3 2 extreme learning machine elm the elm model was initially developed by huang et al 2006 which is a single hidden layer feedforward neural networks slfns with faster learning efficiency and greater generalization capability than the traditional feedforward neural network ffnn model different from the traditional back propagation neural networks or support vector machine the hidden layer parameters of the elm model are randomly selected which do not require any subsequent adjustments therefore the hidden layer nodes can be generated before acquiring the training samples the elm model is generally composed of an input layer meteorological variables a hidden layer neurons and an output layer eto as shown in fig 2 to further improve the generalization capability and model stability an improved elm algorithm was further proposed by combining the conventional elm with kernel functions huang 2014a b where a regularization coefficient was introduced the kernel based elm model maps the input samples from the input space into the high dimensional hidden layer feature space different from the conventional elm the random mapping is replaced by the kernel mapping in the kernel based elm the number of hidden layer nodes in kernel based elm does not need to be set since the kernel function directly adopts the form of inner product supposing that there is a dataset z i t i z i r d t i r m i 1 n where n is the number of instances d is the dimension of input and m is the dimension of output the elm function can be written as 2 f z i 1 l β i h i z w i b i h z β where l is the number of the hidden nodes β β 1 β 2 β l is the weight vector that connects the hidden layer and the output layer w and b are parameters and h i z w i b i is the output of the i th hidden node with respect to the input node z the aim of the elm model is to keep the error on the training cycle as small as possible while minimizing the output weight the mathematical expression can be written as huang et al 2019 3 min β 1 2 β 2 c 2 i 1 n ε i 2 s t h i z i β t i ε i i 1 2 n where c is the regularization parameter which is used to weigh between the output weight and training error according to the kkt theorem training elm is equivalent to solving dual optimization problem 4 l dlem 1 2 β 2 c 2 i 1 n ε i 2 i 1 n j 1 m α i j h i z i β j t i j ε i j when the training sample is not particularly large the collation can be obtained 5 f z h z h t i c h h t 1 t if h is unknown namely implicit function according to the mercer condition it can be applied to elm to define a kernel matrix for elm as follows 6 k elm h h t k elmi j h z i h z j κ z i z j then substituting 5 and 6 into 2 the kernel form of the output function can be obtained as follows 7 f x κ z z 1 κ z z n t i c h h t 1 t similar to other kernel based models pelckmans et al 2002 ma 2019 κ is unknown which is usually calculated based on the radial basis function 8 κ z z j exp γ z z j 2 2 σ 2 c and γ are the final two parameters of the elm model which usually have no physical significance and can only be found through trial and error in this study four bio inspired optimization algorithms were used to find the best parameters of the elm model further details regarding the elm model are given by huang et al 2006 3 3 bio inspired optimization algorithms 3 3 1 genetic algorithm ga the ga algorithm developed by holland 1975 is a machine learning model simulating the natural evolution of darwin s biological evolution and the evolutionary process of genetics which searches the optimized solutions through simulation of the natural evolutionary processes a genetic algorithm begins with a population representing a potential solution to an optimization problem while a population is composed of many individuals encoded by genes every individual is indeed a characteristic entity with chromosome mapping from phenotype to genotype has to be conducted from the beginning after the initial generation of the population according to the principle of survival of the fittest and the principle of survival of the fittest the evolution of generations produces better and better approximate solutions making the solutions close to the objective function in each generation the individual is selected based on the fitness of the individuals the crossover and mutation are further taken from genetic operators of natural genetics to create a new population representative of a new solution fig 3 this process will ensure that the offspring population is more adaptable to the environments compared to the previous generations like a population after natural evolution the best individual in the last generation population is decoded which can be regarded as the approximate optimal solution to the optimization problems further details regarding the ga algorithm can be found in holland 1975 3 3 2 ant colony optimization aco the aco algorithm is an optimization algorithm proposed by dorigo et al 1996 which is inspired by the ants behavior for identifying the shortest path from their nests to a food source using pheromone trails in aco multiple ants are first set up to travel and search in parallel after each ant finishes a path the pheromone is deposited on the way and the concentration of pheromone is proportional to the solution quality the choice of the ant path is based on the pheromone concentration the initial pheromone concentration is set equal taking into account the distance between the two points using a random local search strategy this makes more pheromone is deposited on the path with shorter distance which is more likely to be selected by other ants in the future each ant can only take the legal route passing once per city and only once and a taboo table is set to control this an iteration is generated after all ants search once and the pheromone is updated for all the paths after each iteration a new round of searching is performed after the original ants die the pheromone updating includes the evaporation of the original pheromone and the increase in pheromone on the traversed paths when the predetermined number of iteration is reached or stagnation occurs all ants choose the same path and the solution no longer changes the algorithm ends and the current optimal solution is considered as the optimal solution to the problem fig 3 specially the aco algorithm can be divided into three parts parameter initialization path transfer and pheromone update 3 3 2 1 parameter initialization the initial position of the ant colony is determined randomly the initial pheromone concentration of the i th ant is calculated based on the parameter range the pheromone concentration is similar to the fitness function 9 τ i e f x i 3 3 2 2 path transfer p g ants were randomly selected from the ant colony p g population size in this study p g population size it means only one group in the population and the one with the largest pheromone the smallest target function is selected from the p ants as the head whose position is x best while other ants clusters to the head ant position based on the pheromone attraction according to eq 10 10 x i 1 λ x i λ x best in addition the head ant xbest generated in the last iteration conducts local search in its adjacent region 11 x best x best f x i f x best x best f x i f x best 3 3 2 3 pheromone update after each search the pheromone concentration of the i th ant needs to be updated 12 τ i 1 ρ τ i δ τ i more details about the aco algorithm are given in dorigo et al 1996 in this study p g 50 λ 0 05 and ρ 0 8 3 3 3 cuckoo search algorithm csa the csa algorithm was proposed by yang and deb 2009 which is an evolutionary optimization algorithm on the basis of cuckoos breeding behavior combined with levy flights the csa algorithm simulates the egg laying and breeding characteristics of cuckoos some cuckoos are brood parasites that is to say they lay their eggs in other birds nest when the host birds observe these eggs they would remove the eggs or nest a new one they mimic this behavior for maximizing the eggs survival rate specifically every egg in the nest stands for a solution and a cuckoo egg shows a new solution the cuckoo tends to take over the bad eggs in the nest with better ones this breeding behavior is used in this algorithm to remove the worst solution and produce a new one every cuckoo bird can just lay one egg each time and puts it in a randomly selected nest fig 3 the number of nests including high quality eggs is then transferred to the next generation the number of available host nests can be fixed and a host cuckoo discovers an exotic egg with a probability when this occurs the alien egg will be dumped or a new nest is built specifically the cuckoos breeding behavior process can be described as the lévy flights 13 l λ λ γ λ sin π λ 2 π 1 s 1 λ s 0 where x i t is the location of the i th pollen at the iteration t g is the current best solution among all the solutions at the t th generation α is a parameter to control the step size s is the step size γ λ is the gamma function the cuckoo bird seeks the path and location of the nest updated by the formula 14 x i t 1 x i t α l λ where α is the step size control quantity after the position update randomly generate a 0 1 number r and when r pa pa is a number between 0 1 set by author the location is updated otherwise the location is not updated in the csa algorithm step size generation has randomness and lacks adaptability so it cannot guarantee fast convergence in order to solve the relationship between the global optimization ability and accuracy adaptive dynamic adjustment is carried out for the step size according to the search results at different stages and the adaptive step size adjustment strategy from the optimal nest location is expressed as follows 15 ste p i s t e p min s t e p max s t e p min n i n best d max where ste p max and ste p min represent the maximum and minimum step sizes respectively n best represents the best solution of the current nest position n i represents the i th nest position d max represents the maximum distance between the optimal location and other nests in this study pa 0 75 ste p max 0 2 ste p min 0 05 more details about the csa algorithm can be found in yang and deb 2009 3 3 4 flower pollination algorithm fpa the fpa algorithm developed by yang 2012 is a new population based optimization algorithm on the basis of flower pollination process it is a stochastic global optimization approach that simulates the biological characteristics of self pollination and cross pollination of flowering plants in nature according to the pollination objects of plants they can be divided into two types self pollination and cross pollination cross pollination refers to the pollination from the pollen of one flower to the pollen of other plants while self pollination refers to the process in which the mature pollen grains of the plant are transmitted to the stigma of the same flower and can be properly fertilized and sturdy such as peach blossom self pollination often occurs when no reliable pollinator exists the fpa algorithm has few parameters which is thus easy to adjust and implement the global search and the local search processes are dynamically controlled in the algorithm which better solves the balance between global search and local search fig 3 the levy flight algorithm is also incorporated in the algorithm which ensures its good global optimization ability for cross pollination the pollens update themselves by 16 x i t 1 x i t α l λ g x i t on the other hand for local pollination they update themselves by the follow equation 17 x i t 1 x i t ζ x k t x i t in addition a switching probability p is used to mimic the local and the global flower pollination in this study the parameters were set as follows p 0 8 population 50 λ 1 α 0 2 ζ 0 2 β 2 and iteration 500 potnuru et al 2019 more details about the fpa algorithm can be found in yang 2012 3 4 k fold cross validation to enhance the performances of elm models four bio inspired optimization algorithms have been proposed to reform the model in optimum mode by iteratively adjusting the elm model parameters in this study the five fold cross validation approach was applied to train and validate the elm models the training and validation meteorological dataset during 2001 2010 were equally divided into five folds four folds were used to train the elm models while the remaining one for model validation table 2 the performance of the parameters c γ of the elm model was assessed by the root mean square error rmse between the fao 56 pm eto and the predicted values by elm models this process was implemented five times to ensure that each fold was utilized at least once for model validation the rmse values of the five trials were finally averaged as the expected generalization error when the minimum rmse value was obtained the optimization stopped and returned the best parameters c and γ 3 5 comparison statistics the accuracies of the developed elm models for predicting daily eto were assessed with four commonly used statistical indices feng et al 2017b fan et al 2019a b sanikhani et al 2019 i e coefficient of determination r2 root mean square error rmse normalized root mean square error nrmse and mean absolute error mae which can be expressed as follows 18 r 2 i 1 n y i m y i m y i e y i e 2 i 1 n y i m y i m 2 i 1 n y i e y i e 2 19 rmse 1 n i 1 n y i m y i e 2 20 nrmse 1 n i 1 n y i m y i e 2 y i m 100 21 mae 1 n i 1 n y i m y i e where yi m yi e y i m and n are the fao 56 pm eto the predicted eto the mean of fao 56 pm eto and the number of observation data respectively higher r2 values indicate high prediction accuracy whereas the lower values of rmse nrmse and mae suggest better model performance the model was considered to be excellent for rrmse 10 good for 10 rrmse 20 fair for 20 rrmse 30 and poor for rrmse greater than 30 mohammadi et al 2015 considering the needs of elm models the original climatic data were normalized between 0 and 1 as follows 22 z n z i z min z max z min where zn and zi are the normalized and raw meteorological data zmax and zmin are the minimum and maximum raw meteorological data 4 results and discussion the statistical results of the five elm models elm elm ga elm aco elm csa and elm fpa for predicting daily eto at the eight meteorological stations during the training validation and testing stages are presented in table 3 as seen in the table all the developed elm elm ga elm aco elm csa and elm fpa models produced accurate daily eto estimates during training validation and testing with r2 rmse nrmse and mae ranging 0 9766 0 9967 0 0896 0 2883 mm day 1 3 2910 11 7653 and 0 0708 0 1998 mm day 1 respectively which was largely attributed to the input of complete meteorological data required by the fao 56 pm model it was found that the r2 values of all these elm models were greater than 0 97 indicating a strong relationship between the eto values from the fao 56 pm equation and those predicted by the elm models the nrmse values of all elm models were 10 showing excellent performance for the prediction of daily eto the rmse and mae values were lower than 0 29 and 0 20 mm day 1 respectively which indicated good prediction accuracy at all weather stations except for urumqi compared with those in the training and testing periods the increases in prediction errors obtained at urumqi station during validation were the largest taking rmse as an example the increase was as high as 70 this is largely due to the difference in the distribution of meteorological variables between the two periods previous studies have shown that the surface wind speed in many parts of the world has exhibited a downward trend over the past 50 years which is about 0 014 m y 1 assuming a uniform decline mcvicar et al 2012 although only 15 year data were used in this study the wind speed during 2011 2015 decreased by 18 at urumqi station compared with that during 2001 2010 in addition the predicted daily eto values differed among the five elm models in terms of r2 rmse nrmse and mae values averaged over the eight weather stations across china the elm fpa model on average r2 0 9938 rmse 0 1402 mm day 1 nrmse 4 9208 and mae 0 1082 mm day 1 and elm csa model on average r2 0 9934 rmse 0 1425 mm day 1 nrmse 5 0042 and mae 0 1091 mm day 1 generally gave better accuracy in predicting daily eto than the other three elm models at the eight stations during all the training validation and testing stages the standalone elm model on average r2 0 9898 rmse 0 1701 mm day 1 nrmse 6 0282 and mae 0 1232 mm day 1 produced the worst performance followed by the elm ga model on average r2 0 9916 rmse 0 1574 mm day 1 nrmse 5 5559 and mae 0 1164 mm day 1 and elm aco model on average r2 0 9928 rmse 0 1488 mm day 1 nrmse 5 2166 and mae 0 1127 mm day 1 overall the rmse values attained by these elm models were smaller than or close to those attained by machine learning models in the corresponding areas by previous studies when using similar meteorological data e g by the elm 0 222 0 234 mm day 1 gann 0 212 0 226 mm day 1 and wnn 0 291 0 463 mm day 1 models in the humid region of southwest china feng et al 2016 by svm 0 112 0 195 mm day 1 and elm 0 106 0 193 mm day 1 models in different climatic zones of china fan et al 2018c specifically the standalone elm model r2 0 9856 rmse 0 2104 mm day 1 nrmse 7 1693 and mae 0 1408 mm day 1 was inferior to the hybrid elm ga model r2 0 9889 rmse 0 1895 mm day 1 nrmse 6 7197 and mae 0 1310 mm day 1 elm aco model r2 0 9912 rmse 0 1730 mm day 1 nrmse 6 0816 and mae 0 1254 mm day 1 elm csa model r2 0 9922 rmse 0 1619 mm day 1 nrmse 5 6864 and mae 0 1200 mm day 1 and elm fpa model r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 in daily eto modeling across various climatic zones of china during testing table 3 it can be seen that the differences in statistical values during validation and testing were larger at wuhan r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 and guangzhou r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 compared to those at the other stations this difference was caused as a result of the discrepancy between the validation and testing datasets e g the temporal variations in meteorological data patterns during validation and testing that is to say when the testing dataset show an abnormal trend with data points lying outside the range of the training dataset the developed models would give less accurate daily eto prediction however the proposed elm csa and elm fpa models still provided much higher prediction accuracy than the classical elm model during testing at the two stations which further confirms the capability for improving model performance even under noisy data conditions it can be obtained from table 3 that compared with the original elm model the elm ga elm aco elm csa and elm fpa models improved the prediction accuracy of daily eto during the testing stage with average relative decreases in rmse of 9 4 17 0 22 0 and 23 4 across the eight meteorological stations specifically the corresponding values were 2 7 3 2 5 1 and 5 5 at urumqi 2 6 4 7 10 9 and 12 1 at yinchuan 3 6 7 9 8 5 and 9 1 at geermu 12 1 23 3 27 2 and 29 5 at lasa 20 5 39 1 39 7 and 41 1 at harbin 8 6 16 0 16 4 and 16 7 at beijing 14 8 21 9 42 2 and 45 0 at wuhan 10 3 19 9 26 0 and 28 3 at guangzhou respectively obviously the elm fpa model had slightly better prediction accuracy than the elm csa model while both of them outperformed the other three elm models with the worse performance by the original elm however the performances of the elm modes were subject to the local climatic features it can be seen that the four optimized elm models exhibited more improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon zones with average decreases in rmse of 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates with average decreases in rmse of 5 2 9 8 12 9 and 14 1 respectively the scatter plots of predicted eto values by the five elm models compared with the fao56 pm values during testing 2011 2015 at the eight meteorological stations are presented in fig 4 as seen from the figure the plotted data points generally correlated close towards the 1 1 line however the original elm model yielded more scattered eto points relative to the four hybrid elm models the daily eto values predicted from the hybrid elm fpa and elm csa models were more close to those obtained with the fao 56 pm model at all the eight stations this suggested that the two models showed much higher prediction accuracy in daily eto modeling fig 4 fig 5 demonstrates the bar plots of daily fao56 pm eto values and those predicted by the five elm models during testing 2011 2015 at the eight weather stations the figures clearly showed that the distributions of eto values predicted by the proposed hybrid elm were close to those of fao 56 pm eto values further highlighting the better prediction accuracy of daily eto especially the elm fpa and elm csa models showed comparable better performance for daily eto prediction than the elm aco and elm ga which further confirmed the high capability of the elm fpa and elm csa models for accurately predicting daily eto the two new hybrid elm models presented comparable good model accuracy which are highly suggested for accurately predicting daily eto across contrasting climatic zones of china in this study the taylor diagram was also introduced to visualize the elm models accuracy fig 6 presents the taylor diagram visualizing the prediction accuracy of the five elm models in daily eto modeling at the eight weather stations it is clear that the four hybrid elm models particularly the elm fpa and elm csa models were located closer to the reference point indicating better performance compared to the conventional elm model tao et al 2018 evaluated the hybrid fuzzy model with ffa algorithm for predicting daily eto at three stations in burkina faso they found that the hybrid model was superior to the original anfis model with rmse values ranging 0 24 0 40 mm d 1 and r2 value ranging 0 95 0 97 under the complete input combination petković et al 2016 found that the particle swarm optimization optimized radial basis function network was suitable for eto prediction in serbia with rmse and r2 values of 0 05 mm d 1 and 0 97 respectively yin et al 2017b developed the hybrid svm ga model for eto prediction in the arid region of china the results showed that the new model yielded satisfactory rmse and r2 values of 0 138 mm d 1 and 0 995 with complete meteorological variables respectively whose accuracy was about 10 higher than the original svm model gocic et al 2015 assessed the performance of svm ffa model for forecasting eto in serbia they argued that the svm ffa model outperformed the gp and ann models with rmse and r2 values of 0 296 mm d 1 and 0 965 however another study showed that the optimization algorithm did not improve the accuracy compared with the traditional method shamshirband et al 2015 the reason for this phenomenon can be as follows for one thing some bio inspired optimization algorithms may fall into the local optimal solution when they are coupled with machine learning models resulting in unsatisfactory accuracy compared with the original algorithm for another the prediction accuracy of the original model is highly related to the experience from the user of the model the tuning of parameters by different users is subjective and experienced users can attain the results closer to those obtained by the optimization algorithm from the results of this study the fpa algorithm has a better ability in optimizing parameters of the elm model and the accuracy of elm fpa models is closer to that of previous studies in terms of rmse and r2 in recent years it has become increasingly popular to use weather data from adjacent sites or composite data from multiple weather sites to predict eto of a target site martí and gasque 2010 martí et al 2011 shiri et al 2015 2013 this approach has been shown to work well in different climatic zones around the world including southwest china feng et al 2017b the proposed hybrid elm model are supposed to give satisfactory daily eto estimates within a climatic zone as a result of the similarity in meteorological data however china covers a number of climatic zones and whether the proposed models established in this paper can perform satisfactorily across the whole country remains to be studied in addition the efficiency of the proposed hybrid elm models in eto prediction under lesser data availability scenarios or in satellite based et retrievals should be further explored 5 conclusions to identify the optimal elm parameters and achieve further accuracy and reliability of the elm model for predicting daily eto across china four hybrid extreme learning machines elm models with bio inspired algorithms i e elm with genetic algorithm elm ga elm with ant colony optimization elm aco elm with cuckoo search algorithm csa and elm with flower pollination algorithm elm fpa were proposed in this study daily maximum and minimum ambient temperature wind speed relative humidity and global solar radiation data during 2001 2015 from eight meteorological stations across china were collected to train validate and test the elm models the results indicated that the elm fpa model slightly outperformed the elm csa model during testing both of which were superior to the elm aco and elm ga models followed by the conventional grid search based elm model the four optimized elm models exhibited more improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon climates average decreases in rmse 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates average decreases in rmse 5 2 9 8 12 9 and 14 1 respectively the results advocated the possibility of hybridizing the extreme learning machine model and the four bio inspired algorithms for attaining more preciseness and reliability in predicting daily eto in contrasting climates acknowledgements this study was jointly supported by the national natural science foundation of china no 51879226 51709143 and natural science foundation of jiangxi province china no 20181bab206045 20171bab216051 thanks to the national meteorological information center of china meteorological administration for offering the meteorological data 
6221,reliable and accurate prediction of reference evapotranspiration eto is a precondition for the efficient management and planning of agricultural water resources as well as the optimal design of irrigation scheduling this study evaluated the performances of four bio inspired algorithm optimized extreme learning machine elm models i e elm with genetic algorithm elm ga elm with ant colony optimization elm aco elm with cuckoo search algorithm csa and elm with flower pollination algorithm elm fpa for predicting daily eto across china by using a five fold cross validation approach these models were further compared with the classical elm model parameterized by the grid search method to demonstrate their capability and efficiency daily maximum and minimum ambient temperatures wind speed relative humidity and global solar radiation data during 2001 2015 collected from eight meteorological stations in contrasting climates of china were utilized to train validate and test the models the results showed that eto values predicted by all elm models agreed well with the corresponding fao 56 penman monteith values with r2 rmse nrmse and mae ranging 0 9766 0 9967 0 0896 0 2883 mm day 1 3 2910 11 7653 and 0 0708 0 1998 mm day 1 respectively the elm fpa model r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 slightly outperformed the elm csa model r2 0 9922 rmse 0 1619 mm day 1 nrmse 5 6864 and mae 0 1200 mm day 1 during testing both of which were superior to the elm aco r2 0 9912 rmse 0 1730 mm day 1 nrmse 6 0816 and mae 0 1254 mm day 1 and elm ga r2 0 9889 rmse 0 1895 mm day 1 nrmse 6 7197 and mae 0 1310 mm day 1 models followed by the standalone elm model r2 0 9856 rmse 0 2104 mm day 1 nrmse 7 1693 and mae 0 1408 mm day 1 the four hybrid elm models exhibited higher improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon climates with average decrease in rmse of 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates with average decrease in rmse of 5 2 9 8 12 9 and 14 1 respectively the results advocated the capability of bio inspired optimization algorithms especially the fpa and csa algorithms for improving the performance of the conventional elm model in daily eto prediction in contrasting climates of china keywords reference evapotranspiration extreme learning machine genetic algorithm ant colony optimization cuckoo search algorithm flower pollination algorithm 1 introduction reference evapotranspiration eto is an imperative hydrological component which is a prerequisite for the efficient management and planning of agricultural water resources as well as the optimal design of irrigation scheduling feng et al 2016 karimi et al 2017 wang et al 2017a yan et al 2019 many mathematical equations have been established to predict eto with climatic variables among which the fao 56 penman monteith fao 56 pm equation has been widely accepted as a reference model in diverse areas and climates allen et al 1998 because it considerers both the thermodynamic and aerodynamic items however the fao 56 pm equation needs a variety of climatic parameters as model inputs for calculation e g maximum and minimum ambient temperatures wind speed relative humidity and net radiation shiri et al 2014 fan et al 2016 which significantly limits the application of the fao 56 pm model worldwide thus simplified empirical models with fewer climatic variables are becoming increasingly popular in regions in the absence of complete meteorological data such as temperature based mass transfer based and radiation based models wen et al 2015 feng et al 2017a 2018 however evapotranspiration is a complex and highly nonlinear phenomenon dependent on several climatic parameters therefore it is difficult to establish empirical models considering all those complicated processes over the past two decades due to the excellent performance in tackling nonlinear relationships between the model inputs and output xiao et al 2019 machine learning models have been widely used to reveal the complex hydrological phenomena yaseen et al 2018a b c ghorbani et al 2018a sanikhani et al 2018 hou et al 2018 fan et al 2018a b ma et al 2019a b feng et al 2019 wu et al 2019 including eto prediction kisi and sanikhani 2015 wang et al 2017b jovic et al 2018 such as artificial neural networks ann trajkovic et al 2003 landeras et al 2008 antonopoulos and antonopoulos 2017 support vector machines svm shiri et al 2014 adaptive neuro fuzzy inference system anfis dogan 2009 baba et al 2013 petković et al 2015 sanikhani et al 2019 multivariate adaptive regression splines mars mehdizadeh et al 2017 and deep learning dl saggi and jain 2019 recently a relatively new machine learning model named extreme learning machine elm has been established for eto prediction with high prediction accuracy and computational efficiency abdullah et al 2015 patil and deka 2016 gocic et al 2016 feng et al 2016 2017b yin et al 2017a fan et al 2018c for instance abdullah et al 2015 firstly proposed a elm model to predict daily eto in iraq and revealed its superiority over the feedforward backpropagation ffbp model with high computational speed and good generalization performance patil and deka 2016 compared the capabilities of the elm ann least squares svm and hargreaves models for predicting weekly eto with extrinsic inputs at two weather stations in india they found that the elm and ls svm models showed similar performance both of which were superior to the ann and hargreaves models gocic et al 2016 predicted monthly eto at two weather stations in serbia using the elm hargreaves priestley taylor and turc models with meteorological data during 1980 2010 the results indicated that the elm model was superior to the empirical models for monthly eto prediction feng et al 2016 compared the elm genetic algorithm based backpropagation neural networks gann wavelet neural networks wnn and empirical models for daily eto prediction in southwest china they revealed that the elm and gann models performed better than the wnn and empirical models feng et al 2017b predicted daily eto with the elm and generalized regression neural network grnn based on maximum and minimum temperature data in the sichuan basin of southwest china and found that the elm model gave more accurate eto estimates than the grnn model hargreaves and calibrated hargreaves models yin et al 2017a projected future eto variability using the elm model along with support vector regression svr in the yingluoxia watershed of northwest china it was found that the elm and svr models displayed very good performances for eto prediction with slight better performance by the svr model fan et al 2018c recently evaluated the performances of the kernel based svm elm models as well as four tree based machine learning models in daily eto modeling across china it was concluded that the elm model was slightly superior to the svm model both of which performed better than the tree based models regarding accuracy and stability the accuracy and efficiency of machine learning models largely depend on the internal model parameters nevertheless these parameters have to be tuned during model training for the efficient application of machine learning models the grid search and gradient decent based algorithms are mostly used for model parameter selection however the obtained results are always ineffective as a result of the complex nature of the hyper parameters olatomiwa et al 2015 these algorithms often have high computational complexity and are usually prone to local minima on the contrasts bio inspired algorithms seem to be more efficient and accurate because they can provide global solutions to the optimization problems the combination of bio inspired optimization algorithms with machine learning models may improve the performances of the models because it is capable of deducting the optimal solutions for the optimization problem and improving the computational speed therefore machine learning models have been recently coupled with bio inspired optimization algorithms such as genetic algorithm ga yin et al 2017b particle swarm optimization pso petković et al 2016 artificial bee colony abc ozkan et al 2011 and firefly algorithm ffa tao et al 2018 to optimize the training processes and further enhance the prediction accuracy of machine learning models in forecasting of hydrological components fahimi et al 2017 yaseen et al 2016 for instance yaseen et al 2017 developed a hybrid model based on the anfis model and ffa algorithm for river streamflow forecasting they found that the new hybrid anfis ffa model performed better than the standalone anfis model ghorbani et al 2018b developed a hybrid mlp ffa model for prediction of daily pan evaporation and found the hybrid mlp ffa model was superior to the classical mlp model in terms of eto ozkan et al 2011 coupled ann with abc for daily eto prediction at two meteorological stations in los angeles of usa they revealed that the ann abc model exhibited better performance in eto prediction than the levenberg marquardt lm and standard back propagation sbp optimized ann models eslamian et al 2012 predicted monthly eto in the esfahan province of iran by coupling ann and ga the results indicated that the ann ga model gave more accurate monthly eto estimates than the classical ann model and ga was a strong tool to reach the global optimal solution shamshirband et al 2015 predicted monthly eto in serbia using the ann and anfis models coupled with the cuckoo search algorithm csa it was found that the csa algorithm improved the prediction accuracy of the anfis model but not the ann model gocić et al 2015 predicted monthly eto in serbia using the svm model optimized by ffa and found that svm ffa was superior to ann and gp petković et al 2016 integrated the radial basis function rbf neural network with pso and back propagation bp for prediction of monthly eto in serbia the results indicated that rbf pso slightly outperformed rbf bp in eto modeling while both of them performed much better than ann and svm yin et al 2017b integrated svm and ga for daily eto prediction in yingluoxia watershed of northwest china and proved the superiority of svm ga for predicting eto compared with conventional svm and ann tao et al 2018 recently predicted eto in a semi arid environment of burkina faso using hybridized anfis with ffa the results indicated that the hybrid anfis ffa model outperformed the standalone anfis model apparently the relatively new elm model has drawn researchers attention as an efficient machine learning model for accurate prediction of eto however the kernel based elm model still has certain internal limitations in the tuning of model parameters especially the parameters of the introduced kernel functions huang 2014a b coupling the elm model with bio inspired algorithms can provide a better way to overcome the limitations in model parameter optimization although some bio inspired algorithms have been used to optimize machine learning models for eto prediction they are largely limited to classical bio inspired algorithms e g ga pso and ffa rather than newly developed optimization algorithms such as ant colony optimization aco cuckoo search algorithm csa and flower pollination algorithm fpa therefore the main purpose of the present study was to assess the prediction accuracy of elm models optimized by four bio inspired algorithms proposed during 1970s 2010s ga aco csa and fpa algorithms for predicting daily eto in contrasting climates of china furthermore the conventional grid search based elm model was also investigated for comparison to the best of the authors knowledge this is the first implementation of hybrid elm models with various bio inspired optimization algorithms for more reliable and accurate prediction of daily eto 2 case study daily maximum and minimum ambient temperatures wind speed relative humidity and global solar radiation data for the period of 2001 2015 were collected from eight representative meteorological stations across various climates in china fig 1 i e the temperate continental region tc the temperate monsoon region tm the mountain plateau region mp and the sub tropical monsoon region sm fan et al 2016 for the modeling 53 3 eight year dataset and 13 3 two year dataset during 2001 2010 were used for model training and validation respectively while the remaining 33 4 five year dataset for the period 2010 2010 were used for testing the annual mean values standard deviation of these climatic parameters during training validation and testing for the eight studied stations are presented in table 1 which were provided and quality controlled by the national meteorological information center nmic it is apparent that the annual mean tmax varied from 27 3 c at guangzhou to 10 4 c at harbin the mean tmin ranged from 19 7 c at guangzhou to 0 1 c at harbin the annual mean u2 changed from 1 9 m s 1 at urumqi to 1 0 m s 1 at wuhan annual mean hr was between 79 1 at guangzhou and 30 8 at geermu and the annual mean rs was between 20 5 mj m 2 d 1 at lasa and 11 7 at guangzhou mj m 2 d 1 the lowest annual mean daily eto 2 2 mm d 1 was observed at harbin while the highest value 3 5 mm d 1 appeared at lasa it is noted from table 1 that the differences between the meteorological values during training validation and testing did not vary substantially except for the subtropical monsoon zone where greater increases in wind speed and relative humidity were observed 3 methodology 3 1 fao 56 penman monteith equation the fao 56 penman monteith fao 56 pm model suggested by allen et al 1998 was utilized to calculate daily eto mm day 1 and provide the reference data for the training validation and testing of elm models in this paper li et al 2012 kisi 2015 fan et al 2016 1 e t o 0 408 δ r n g γ 900 t mean 273 u 2 e s e a δ γ 1 0 34 u 2 where rn net radiation mj m 2 day 1 g soil heat flux mj m 2 day 1 tmean average ambient temperature c u2 wind speed at 2 m height m s 1 es saturation vapor pressure kpa ea actual vapor pressure kpa δ slope of the vapor pressure curve kpa c 1 γ psychrometric constant kpa c 1 detailed calculation procedures can be found in allen et al 1998 3 2 extreme learning machine elm the elm model was initially developed by huang et al 2006 which is a single hidden layer feedforward neural networks slfns with faster learning efficiency and greater generalization capability than the traditional feedforward neural network ffnn model different from the traditional back propagation neural networks or support vector machine the hidden layer parameters of the elm model are randomly selected which do not require any subsequent adjustments therefore the hidden layer nodes can be generated before acquiring the training samples the elm model is generally composed of an input layer meteorological variables a hidden layer neurons and an output layer eto as shown in fig 2 to further improve the generalization capability and model stability an improved elm algorithm was further proposed by combining the conventional elm with kernel functions huang 2014a b where a regularization coefficient was introduced the kernel based elm model maps the input samples from the input space into the high dimensional hidden layer feature space different from the conventional elm the random mapping is replaced by the kernel mapping in the kernel based elm the number of hidden layer nodes in kernel based elm does not need to be set since the kernel function directly adopts the form of inner product supposing that there is a dataset z i t i z i r d t i r m i 1 n where n is the number of instances d is the dimension of input and m is the dimension of output the elm function can be written as 2 f z i 1 l β i h i z w i b i h z β where l is the number of the hidden nodes β β 1 β 2 β l is the weight vector that connects the hidden layer and the output layer w and b are parameters and h i z w i b i is the output of the i th hidden node with respect to the input node z the aim of the elm model is to keep the error on the training cycle as small as possible while minimizing the output weight the mathematical expression can be written as huang et al 2019 3 min β 1 2 β 2 c 2 i 1 n ε i 2 s t h i z i β t i ε i i 1 2 n where c is the regularization parameter which is used to weigh between the output weight and training error according to the kkt theorem training elm is equivalent to solving dual optimization problem 4 l dlem 1 2 β 2 c 2 i 1 n ε i 2 i 1 n j 1 m α i j h i z i β j t i j ε i j when the training sample is not particularly large the collation can be obtained 5 f z h z h t i c h h t 1 t if h is unknown namely implicit function according to the mercer condition it can be applied to elm to define a kernel matrix for elm as follows 6 k elm h h t k elmi j h z i h z j κ z i z j then substituting 5 and 6 into 2 the kernel form of the output function can be obtained as follows 7 f x κ z z 1 κ z z n t i c h h t 1 t similar to other kernel based models pelckmans et al 2002 ma 2019 κ is unknown which is usually calculated based on the radial basis function 8 κ z z j exp γ z z j 2 2 σ 2 c and γ are the final two parameters of the elm model which usually have no physical significance and can only be found through trial and error in this study four bio inspired optimization algorithms were used to find the best parameters of the elm model further details regarding the elm model are given by huang et al 2006 3 3 bio inspired optimization algorithms 3 3 1 genetic algorithm ga the ga algorithm developed by holland 1975 is a machine learning model simulating the natural evolution of darwin s biological evolution and the evolutionary process of genetics which searches the optimized solutions through simulation of the natural evolutionary processes a genetic algorithm begins with a population representing a potential solution to an optimization problem while a population is composed of many individuals encoded by genes every individual is indeed a characteristic entity with chromosome mapping from phenotype to genotype has to be conducted from the beginning after the initial generation of the population according to the principle of survival of the fittest and the principle of survival of the fittest the evolution of generations produces better and better approximate solutions making the solutions close to the objective function in each generation the individual is selected based on the fitness of the individuals the crossover and mutation are further taken from genetic operators of natural genetics to create a new population representative of a new solution fig 3 this process will ensure that the offspring population is more adaptable to the environments compared to the previous generations like a population after natural evolution the best individual in the last generation population is decoded which can be regarded as the approximate optimal solution to the optimization problems further details regarding the ga algorithm can be found in holland 1975 3 3 2 ant colony optimization aco the aco algorithm is an optimization algorithm proposed by dorigo et al 1996 which is inspired by the ants behavior for identifying the shortest path from their nests to a food source using pheromone trails in aco multiple ants are first set up to travel and search in parallel after each ant finishes a path the pheromone is deposited on the way and the concentration of pheromone is proportional to the solution quality the choice of the ant path is based on the pheromone concentration the initial pheromone concentration is set equal taking into account the distance between the two points using a random local search strategy this makes more pheromone is deposited on the path with shorter distance which is more likely to be selected by other ants in the future each ant can only take the legal route passing once per city and only once and a taboo table is set to control this an iteration is generated after all ants search once and the pheromone is updated for all the paths after each iteration a new round of searching is performed after the original ants die the pheromone updating includes the evaporation of the original pheromone and the increase in pheromone on the traversed paths when the predetermined number of iteration is reached or stagnation occurs all ants choose the same path and the solution no longer changes the algorithm ends and the current optimal solution is considered as the optimal solution to the problem fig 3 specially the aco algorithm can be divided into three parts parameter initialization path transfer and pheromone update 3 3 2 1 parameter initialization the initial position of the ant colony is determined randomly the initial pheromone concentration of the i th ant is calculated based on the parameter range the pheromone concentration is similar to the fitness function 9 τ i e f x i 3 3 2 2 path transfer p g ants were randomly selected from the ant colony p g population size in this study p g population size it means only one group in the population and the one with the largest pheromone the smallest target function is selected from the p ants as the head whose position is x best while other ants clusters to the head ant position based on the pheromone attraction according to eq 10 10 x i 1 λ x i λ x best in addition the head ant xbest generated in the last iteration conducts local search in its adjacent region 11 x best x best f x i f x best x best f x i f x best 3 3 2 3 pheromone update after each search the pheromone concentration of the i th ant needs to be updated 12 τ i 1 ρ τ i δ τ i more details about the aco algorithm are given in dorigo et al 1996 in this study p g 50 λ 0 05 and ρ 0 8 3 3 3 cuckoo search algorithm csa the csa algorithm was proposed by yang and deb 2009 which is an evolutionary optimization algorithm on the basis of cuckoos breeding behavior combined with levy flights the csa algorithm simulates the egg laying and breeding characteristics of cuckoos some cuckoos are brood parasites that is to say they lay their eggs in other birds nest when the host birds observe these eggs they would remove the eggs or nest a new one they mimic this behavior for maximizing the eggs survival rate specifically every egg in the nest stands for a solution and a cuckoo egg shows a new solution the cuckoo tends to take over the bad eggs in the nest with better ones this breeding behavior is used in this algorithm to remove the worst solution and produce a new one every cuckoo bird can just lay one egg each time and puts it in a randomly selected nest fig 3 the number of nests including high quality eggs is then transferred to the next generation the number of available host nests can be fixed and a host cuckoo discovers an exotic egg with a probability when this occurs the alien egg will be dumped or a new nest is built specifically the cuckoos breeding behavior process can be described as the lévy flights 13 l λ λ γ λ sin π λ 2 π 1 s 1 λ s 0 where x i t is the location of the i th pollen at the iteration t g is the current best solution among all the solutions at the t th generation α is a parameter to control the step size s is the step size γ λ is the gamma function the cuckoo bird seeks the path and location of the nest updated by the formula 14 x i t 1 x i t α l λ where α is the step size control quantity after the position update randomly generate a 0 1 number r and when r pa pa is a number between 0 1 set by author the location is updated otherwise the location is not updated in the csa algorithm step size generation has randomness and lacks adaptability so it cannot guarantee fast convergence in order to solve the relationship between the global optimization ability and accuracy adaptive dynamic adjustment is carried out for the step size according to the search results at different stages and the adaptive step size adjustment strategy from the optimal nest location is expressed as follows 15 ste p i s t e p min s t e p max s t e p min n i n best d max where ste p max and ste p min represent the maximum and minimum step sizes respectively n best represents the best solution of the current nest position n i represents the i th nest position d max represents the maximum distance between the optimal location and other nests in this study pa 0 75 ste p max 0 2 ste p min 0 05 more details about the csa algorithm can be found in yang and deb 2009 3 3 4 flower pollination algorithm fpa the fpa algorithm developed by yang 2012 is a new population based optimization algorithm on the basis of flower pollination process it is a stochastic global optimization approach that simulates the biological characteristics of self pollination and cross pollination of flowering plants in nature according to the pollination objects of plants they can be divided into two types self pollination and cross pollination cross pollination refers to the pollination from the pollen of one flower to the pollen of other plants while self pollination refers to the process in which the mature pollen grains of the plant are transmitted to the stigma of the same flower and can be properly fertilized and sturdy such as peach blossom self pollination often occurs when no reliable pollinator exists the fpa algorithm has few parameters which is thus easy to adjust and implement the global search and the local search processes are dynamically controlled in the algorithm which better solves the balance between global search and local search fig 3 the levy flight algorithm is also incorporated in the algorithm which ensures its good global optimization ability for cross pollination the pollens update themselves by 16 x i t 1 x i t α l λ g x i t on the other hand for local pollination they update themselves by the follow equation 17 x i t 1 x i t ζ x k t x i t in addition a switching probability p is used to mimic the local and the global flower pollination in this study the parameters were set as follows p 0 8 population 50 λ 1 α 0 2 ζ 0 2 β 2 and iteration 500 potnuru et al 2019 more details about the fpa algorithm can be found in yang 2012 3 4 k fold cross validation to enhance the performances of elm models four bio inspired optimization algorithms have been proposed to reform the model in optimum mode by iteratively adjusting the elm model parameters in this study the five fold cross validation approach was applied to train and validate the elm models the training and validation meteorological dataset during 2001 2010 were equally divided into five folds four folds were used to train the elm models while the remaining one for model validation table 2 the performance of the parameters c γ of the elm model was assessed by the root mean square error rmse between the fao 56 pm eto and the predicted values by elm models this process was implemented five times to ensure that each fold was utilized at least once for model validation the rmse values of the five trials were finally averaged as the expected generalization error when the minimum rmse value was obtained the optimization stopped and returned the best parameters c and γ 3 5 comparison statistics the accuracies of the developed elm models for predicting daily eto were assessed with four commonly used statistical indices feng et al 2017b fan et al 2019a b sanikhani et al 2019 i e coefficient of determination r2 root mean square error rmse normalized root mean square error nrmse and mean absolute error mae which can be expressed as follows 18 r 2 i 1 n y i m y i m y i e y i e 2 i 1 n y i m y i m 2 i 1 n y i e y i e 2 19 rmse 1 n i 1 n y i m y i e 2 20 nrmse 1 n i 1 n y i m y i e 2 y i m 100 21 mae 1 n i 1 n y i m y i e where yi m yi e y i m and n are the fao 56 pm eto the predicted eto the mean of fao 56 pm eto and the number of observation data respectively higher r2 values indicate high prediction accuracy whereas the lower values of rmse nrmse and mae suggest better model performance the model was considered to be excellent for rrmse 10 good for 10 rrmse 20 fair for 20 rrmse 30 and poor for rrmse greater than 30 mohammadi et al 2015 considering the needs of elm models the original climatic data were normalized between 0 and 1 as follows 22 z n z i z min z max z min where zn and zi are the normalized and raw meteorological data zmax and zmin are the minimum and maximum raw meteorological data 4 results and discussion the statistical results of the five elm models elm elm ga elm aco elm csa and elm fpa for predicting daily eto at the eight meteorological stations during the training validation and testing stages are presented in table 3 as seen in the table all the developed elm elm ga elm aco elm csa and elm fpa models produced accurate daily eto estimates during training validation and testing with r2 rmse nrmse and mae ranging 0 9766 0 9967 0 0896 0 2883 mm day 1 3 2910 11 7653 and 0 0708 0 1998 mm day 1 respectively which was largely attributed to the input of complete meteorological data required by the fao 56 pm model it was found that the r2 values of all these elm models were greater than 0 97 indicating a strong relationship between the eto values from the fao 56 pm equation and those predicted by the elm models the nrmse values of all elm models were 10 showing excellent performance for the prediction of daily eto the rmse and mae values were lower than 0 29 and 0 20 mm day 1 respectively which indicated good prediction accuracy at all weather stations except for urumqi compared with those in the training and testing periods the increases in prediction errors obtained at urumqi station during validation were the largest taking rmse as an example the increase was as high as 70 this is largely due to the difference in the distribution of meteorological variables between the two periods previous studies have shown that the surface wind speed in many parts of the world has exhibited a downward trend over the past 50 years which is about 0 014 m y 1 assuming a uniform decline mcvicar et al 2012 although only 15 year data were used in this study the wind speed during 2011 2015 decreased by 18 at urumqi station compared with that during 2001 2010 in addition the predicted daily eto values differed among the five elm models in terms of r2 rmse nrmse and mae values averaged over the eight weather stations across china the elm fpa model on average r2 0 9938 rmse 0 1402 mm day 1 nrmse 4 9208 and mae 0 1082 mm day 1 and elm csa model on average r2 0 9934 rmse 0 1425 mm day 1 nrmse 5 0042 and mae 0 1091 mm day 1 generally gave better accuracy in predicting daily eto than the other three elm models at the eight stations during all the training validation and testing stages the standalone elm model on average r2 0 9898 rmse 0 1701 mm day 1 nrmse 6 0282 and mae 0 1232 mm day 1 produced the worst performance followed by the elm ga model on average r2 0 9916 rmse 0 1574 mm day 1 nrmse 5 5559 and mae 0 1164 mm day 1 and elm aco model on average r2 0 9928 rmse 0 1488 mm day 1 nrmse 5 2166 and mae 0 1127 mm day 1 overall the rmse values attained by these elm models were smaller than or close to those attained by machine learning models in the corresponding areas by previous studies when using similar meteorological data e g by the elm 0 222 0 234 mm day 1 gann 0 212 0 226 mm day 1 and wnn 0 291 0 463 mm day 1 models in the humid region of southwest china feng et al 2016 by svm 0 112 0 195 mm day 1 and elm 0 106 0 193 mm day 1 models in different climatic zones of china fan et al 2018c specifically the standalone elm model r2 0 9856 rmse 0 2104 mm day 1 nrmse 7 1693 and mae 0 1408 mm day 1 was inferior to the hybrid elm ga model r2 0 9889 rmse 0 1895 mm day 1 nrmse 6 7197 and mae 0 1310 mm day 1 elm aco model r2 0 9912 rmse 0 1730 mm day 1 nrmse 6 0816 and mae 0 1254 mm day 1 elm csa model r2 0 9922 rmse 0 1619 mm day 1 nrmse 5 6864 and mae 0 1200 mm day 1 and elm fpa model r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 in daily eto modeling across various climatic zones of china during testing table 3 it can be seen that the differences in statistical values during validation and testing were larger at wuhan r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 and guangzhou r2 0 9930 rmse 0 1589 mm day 1 nrmse 5 5406 and mae 0 1188 mm day 1 compared to those at the other stations this difference was caused as a result of the discrepancy between the validation and testing datasets e g the temporal variations in meteorological data patterns during validation and testing that is to say when the testing dataset show an abnormal trend with data points lying outside the range of the training dataset the developed models would give less accurate daily eto prediction however the proposed elm csa and elm fpa models still provided much higher prediction accuracy than the classical elm model during testing at the two stations which further confirms the capability for improving model performance even under noisy data conditions it can be obtained from table 3 that compared with the original elm model the elm ga elm aco elm csa and elm fpa models improved the prediction accuracy of daily eto during the testing stage with average relative decreases in rmse of 9 4 17 0 22 0 and 23 4 across the eight meteorological stations specifically the corresponding values were 2 7 3 2 5 1 and 5 5 at urumqi 2 6 4 7 10 9 and 12 1 at yinchuan 3 6 7 9 8 5 and 9 1 at geermu 12 1 23 3 27 2 and 29 5 at lasa 20 5 39 1 39 7 and 41 1 at harbin 8 6 16 0 16 4 and 16 7 at beijing 14 8 21 9 42 2 and 45 0 at wuhan 10 3 19 9 26 0 and 28 3 at guangzhou respectively obviously the elm fpa model had slightly better prediction accuracy than the elm csa model while both of them outperformed the other three elm models with the worse performance by the original elm however the performances of the elm modes were subject to the local climatic features it can be seen that the four optimized elm models exhibited more improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon zones with average decreases in rmse of 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates with average decreases in rmse of 5 2 9 8 12 9 and 14 1 respectively the scatter plots of predicted eto values by the five elm models compared with the fao56 pm values during testing 2011 2015 at the eight meteorological stations are presented in fig 4 as seen from the figure the plotted data points generally correlated close towards the 1 1 line however the original elm model yielded more scattered eto points relative to the four hybrid elm models the daily eto values predicted from the hybrid elm fpa and elm csa models were more close to those obtained with the fao 56 pm model at all the eight stations this suggested that the two models showed much higher prediction accuracy in daily eto modeling fig 4 fig 5 demonstrates the bar plots of daily fao56 pm eto values and those predicted by the five elm models during testing 2011 2015 at the eight weather stations the figures clearly showed that the distributions of eto values predicted by the proposed hybrid elm were close to those of fao 56 pm eto values further highlighting the better prediction accuracy of daily eto especially the elm fpa and elm csa models showed comparable better performance for daily eto prediction than the elm aco and elm ga which further confirmed the high capability of the elm fpa and elm csa models for accurately predicting daily eto the two new hybrid elm models presented comparable good model accuracy which are highly suggested for accurately predicting daily eto across contrasting climatic zones of china in this study the taylor diagram was also introduced to visualize the elm models accuracy fig 6 presents the taylor diagram visualizing the prediction accuracy of the five elm models in daily eto modeling at the eight weather stations it is clear that the four hybrid elm models particularly the elm fpa and elm csa models were located closer to the reference point indicating better performance compared to the conventional elm model tao et al 2018 evaluated the hybrid fuzzy model with ffa algorithm for predicting daily eto at three stations in burkina faso they found that the hybrid model was superior to the original anfis model with rmse values ranging 0 24 0 40 mm d 1 and r2 value ranging 0 95 0 97 under the complete input combination petković et al 2016 found that the particle swarm optimization optimized radial basis function network was suitable for eto prediction in serbia with rmse and r2 values of 0 05 mm d 1 and 0 97 respectively yin et al 2017b developed the hybrid svm ga model for eto prediction in the arid region of china the results showed that the new model yielded satisfactory rmse and r2 values of 0 138 mm d 1 and 0 995 with complete meteorological variables respectively whose accuracy was about 10 higher than the original svm model gocic et al 2015 assessed the performance of svm ffa model for forecasting eto in serbia they argued that the svm ffa model outperformed the gp and ann models with rmse and r2 values of 0 296 mm d 1 and 0 965 however another study showed that the optimization algorithm did not improve the accuracy compared with the traditional method shamshirband et al 2015 the reason for this phenomenon can be as follows for one thing some bio inspired optimization algorithms may fall into the local optimal solution when they are coupled with machine learning models resulting in unsatisfactory accuracy compared with the original algorithm for another the prediction accuracy of the original model is highly related to the experience from the user of the model the tuning of parameters by different users is subjective and experienced users can attain the results closer to those obtained by the optimization algorithm from the results of this study the fpa algorithm has a better ability in optimizing parameters of the elm model and the accuracy of elm fpa models is closer to that of previous studies in terms of rmse and r2 in recent years it has become increasingly popular to use weather data from adjacent sites or composite data from multiple weather sites to predict eto of a target site martí and gasque 2010 martí et al 2011 shiri et al 2015 2013 this approach has been shown to work well in different climatic zones around the world including southwest china feng et al 2017b the proposed hybrid elm model are supposed to give satisfactory daily eto estimates within a climatic zone as a result of the similarity in meteorological data however china covers a number of climatic zones and whether the proposed models established in this paper can perform satisfactorily across the whole country remains to be studied in addition the efficiency of the proposed hybrid elm models in eto prediction under lesser data availability scenarios or in satellite based et retrievals should be further explored 5 conclusions to identify the optimal elm parameters and achieve further accuracy and reliability of the elm model for predicting daily eto across china four hybrid extreme learning machines elm models with bio inspired algorithms i e elm with genetic algorithm elm ga elm with ant colony optimization elm aco elm with cuckoo search algorithm csa and elm with flower pollination algorithm elm fpa were proposed in this study daily maximum and minimum ambient temperature wind speed relative humidity and global solar radiation data during 2001 2015 from eight meteorological stations across china were collected to train validate and test the elm models the results indicated that the elm fpa model slightly outperformed the elm csa model during testing both of which were superior to the elm aco and elm ga models followed by the conventional grid search based elm model the four optimized elm models exhibited more improvements in daily eto prediction in the temperate monsoon and sub tropical monsoon climates average decreases in rmse 14 0 25 1 31 4 and 33 1 respectively compared with those in the temperate continental and mountain plateau climates average decreases in rmse 5 2 9 8 12 9 and 14 1 respectively the results advocated the possibility of hybridizing the extreme learning machine model and the four bio inspired algorithms for attaining more preciseness and reliability in predicting daily eto in contrasting climates acknowledgements this study was jointly supported by the national natural science foundation of china no 51879226 51709143 and natural science foundation of jiangxi province china no 20181bab206045 20171bab216051 thanks to the national meteorological information center of china meteorological administration for offering the meteorological data 
6222,climate and land use change are the two primary factors that affect different components of hydrological cycle as well as sediment transport in the watershed quantifying potential impact of these two stressors enables decision makers to formulate better water resource management strategies to adapt to the changing environment to that end we have developed an integrated modeling framework employing an agent based approach to simulate land use conversion that then serves as input to the soil and water assessment tool swat in a loosely coupled fashion the modeling framework was tested on the neshanic river watershed nrw 142 km2 area in central new jersey that contains mix of urban agricultural and forested lands an ensemble of 10 different global climate models gcms for two different greenhouse gas emission scenarios including representative concentration pathways 4 5 and 8 5 rcp 4 5 and 8 5 were employed to model future climate from 2020 to 2045 land use conversion for 2040 was developed based on six driving factors including distance to residential lands agricultural lands roads streams train stations and forest using three land use transition potential models and further the best transition potential model accompanied with some local land use restrictions the study evaluated various components of hydrological cycle and sediment transport for the three different scenarios one at a time including climate change alone land use change alone and combined climate and land use change results indicate that the changing climate will have a larger effect on the hydrologic cycle than intensifying urban land uses in the study watershed the climate change scenarios either alone or in composite with land use change predict higher streamflow 32 and 36 increase over baseline respectively overriding the effect of land use change which predicts a decline of 5 in streamflow the increase in streamflow results in an increase in sediment loading presumably due to an increase stream downcutting conversely the effect of land use change in this case the conversion of agricultural land to low density residential uses is predicted to decrease sediment load when modelled in composite the effect of changing land use in this case the conversion of erodible agricultural fields to suburban development appears to override the adverse effect of climate change enhancing watershed resiliency by reducing sediment load and thereby improving health of the downstream aquatic ecosystems keywords climate change land use change loosely coupled systems soil and water assessment tool transition potential model agent based model representative concentration pathways hydrologic cycle sediment load climate resiliency 1 introduction climate and land use change are the two primary stressors that humanity is facing in the 21st century pervez and henebry 2015 teshager et al 2016 zhang et al 2018 and both of them have larger implications on hydrological cycle as well as sediment transport in the watershed wagena et al 2016 panagopoulos et al 2015 luo et al 2013 boe et al 2009 due to increase in average global mean temperature different components of hydrological cycle including precipitation evaporation transpiration infiltration groundwater surface runoff and snowmelt are going to affect seriously at both spatial and temporal scales immerzeel 2008 labat et al 2004 additionally a warmer atmosphere will have greater water holding capacity leading to intensification of hydrological cycle which will pose the risk of flooding and droughts at locale to regional scale praskievicz and bartlein 2014 wu et al 2012a increased surface runoff due to climate change poses a threat of excessive land degradation in the upland areas in the watershed and significantly affects the sediment transport in the river reach systems similarly changing land use will alter the energy balance within the hydrological cycle ma et al 2009 affecting evapotranspiration mao and cherkauer 2009 interception babamaaji 2013 infiltration zierl and bugmann 2005 surface runoff giri et al 2018 yan et al 2013 and sediment transport shrestha and wang 2018 bussi et al 2016 resulting a profound impact on water quality and water supply giri et al 2018 cho et al 2009 kundzewicz et al 2007 elevating the level of sediment in the river reach systems has a negative impact towards environmental sustainability including global biodiversity and ecosystems function ipcc 2014 future climate and land use change has profound implications for the state of new jersey as it faces severe flooding due to extreme events usepa 2016 that is further exacerbated by the highest percentage of urban land cover in the u s lathrop et al 2016 the average annual temperature in the state has increased by 2 f since 1900 whereas the average winter temperature has increased by 4 f since 1970 frumhoff et al 2007 usepa 1997 the average annual precipitation in the state has increased by 5 to 10 percent while the major extreme precipitation events have increased 70 percent in the northeast u s usepa 2016 ncsl 2008 additionally new jersey being the most densely populated state provides an excellent case study of the multiple effects of intensifying urban land uses considering different stressors including climate and land use change on different components of hydrological cycle and sediment transport on watershed scale requires a holistic and multidisciplinary approach to better understand the underlying cause and effect as well as sustainable adaptation strategies to mitigate the undesirable effects resiliency is known as capacity to adjust or develop adaptation strategies of a system to address external undesirable environmental changes nelson et al 2007 folke 2006 better understanding of how the changes in land use and climate will impact the hydrological cycle and especially sediment transport will enable more informed watershed adaptation strategies to help make communities more resilient to climate change to that end model simulation is proven to be an effective tool woznicki et al 2016 giri et al 2015 a variety of models have been developed to assess the impact of climate and land use change on watershed scale however soil and water assessment tool swat has seen widespread application due to its process based structure ability to model hydrology plant growth related process incorporate different urban and agricultural management practices representation of land use and meteorological parameters essential from water balance prospective zhang et al 2018 giri et al 2016a ficklin and barnhart 2014 giri et al 2014 mutenyo et al 2013 swat model has not only been used to assess the effect of climate change on watershed hydrology and water quality shrestha and wang 2018 yang et al 2018 reshmidevi et al 2017 woznicki et al 2016 cousino et al 2015 ficklin and barnhart 2014 chien et al 2013 wu et al 2012a but also employed to evaluate the combined effect of land use and climate change on hydrology and water quality ahiablame et al 2017 bussi et al 2016 chen et al 2017 gabriel et al 2016 ma et al 2009 mehdi et al 2015 molina navarro et al 2018 neupane and kumar 2015 paul et al 2017 pervez and henebry 2015 setyorini et al 2017 teshager et al 2016 zhang et al 2018 on watershed scale throughout the globe in evaluating the implications of the combined effect of future land use and climate change authors have generally projected future land use based on either hypothetical scenarios molina navarro et al 2018 zhang et al 2018 chen et al 2017 neupane and kumar 2015 teshager et al 2016 mehdi et al 2015 or using global national scale models ahiablame et al 2017 gabriel et al 2016 pervez and henebry 2015 hypothetical land use projection does not match with the real land use change in the ground while global national scale models lack a nuanced consideration of local regulations or future land development plans in a region most of the prior research on modeling the combined effect of land use and climate change on hydrology has focused on land development scenarios related to agricultural land conversion i e conversion of other land uses to agricultural land or between various agricultural land practices however there is a great need to evaluate the combined effects in urbanizing regions as well to formulate water resource management strategies adapted to a changing environment to that end we have developed an integrated modeling framework in a coupled natural and human system where the natural system is modelled using swat and the urban land use conversion to overcome the aforementioned drawbacks for land use projection we have been exploring land use change models driven by socio economical regulatory as well as neighboring land use factors using both agent based and transition potential modeling the specific objectives of this study were to i evaluate the potential impact of climate change in the near future on different components of hydrological cycle as well as sediment load on a field and watershed scale and ii estimate the effect of land use change only as well as combined climate and land use change on different water fluxes and sediment load in a central new jersey watershed 2 materials and methods 2 1 study area the study area neshanic river watershed or nrw is located in central new jersey between u s s largest and 6th largest cities new york and philadelphia respectively experiencing the effect of both climate and land use change fig 1 it is a headwater to raritan basin the nrw has been declared as impaired for aquatic life due to non point source pollution such as total suspended solids and other pollutants njdep 2011 apart from degraded water quality issues nrw has been influenced by water quantity fluctuation especially during the low flow condition the 142 km2 watershed is evenly divided between agricultural urban and forest land 32 versus 30 versus 29 respectively with smaller component of wetlands 8 barren lands and water the land use map of the nrw can be found in the supplementary material fig s1 the elevation in the watershed ranges from 20 m to 208 m above the mean sea level fig 1 a recent study conducted by giri et al 2016b indicates an increase in urbanized land use is expected in the watershed in the coming years the watershed is located in the piedmont physiographic region and it is underlain by slightly folded and faulted sedimentary and igneous rocks a humid climate is observed in the watershed having hot and humid during summer average temperature of 27 to 30 c while cold in winter average low temperature of 7 to 5 c the mean annual precipitation is 1 292 mm according to national climatic data center with precipitation occurring 120 days per year during the summer thunderstorms are responsible for a majority of the precipitation in the watershed the average annual winter snowfall in the watershed ranges from 120 to 770 mm well drained silty soils are found in the watershed where major crops including hay soybean pasture winter wheat and corn are grown minor crops include oat barely sunflower sorghum and rye 2 2 conceptual framework of loosely coupled systems this climate and land use change study was conducted in a loosely coupled system lcs fig 2 the lcs had two intra systems and one inter system interaction the land use prediction modeling component focusses on the ongoing land management and land use conversion process i e conversion of agricultural and forest into residential land the hydrologic modeling component focused on the different components of hydrologic cycle including surface runoff streamflow water yield groundwater recharge lateral flow evapotranspiration soil water and percolation as well as sedimentation these hydrologic processes are dependent on the properties of topography soil land use land cover and management urbanization and the resulting increase in impervious surface affects different water balance components as well as sediment transport potentially acerbating flooding drought and decreased downstream water quality climate change potentially magnifies the coupling between these two systems leading to higher storm runoff increased watershed flashiness rise and fall of streamflow quickly during storm events and sediment erosion and transport 2 3 loosely coupled modeling framework the loosely coupled modeling framework consisted of three strands 1 hydrologic modeling framework 2 land use prediction framework and 3 data analysis framework fig 3 2 3 1 hydrologic modeling framework 2 3 1 1 model description the swat model was used to predict the different components of the hydrological cycle as well as sediment transport in the nrw swat is a semi distributed physically based watershed scale model developed by u s department of agriculture usda arnold et al 1998 gassman et al 2007 neitsch et al 2011 different primary components of the swat model are hydrology soil plant growth weather nutrients pesticides and land management practices the hydrologic component of swat is divided into two parts i land phase hydrologic cycle and ii routing phase hydrologic cycle the hydrologic modeling framework consisted of three different spatial scales including hydrologic response units hrus subbasin and watershed scale hrus are the unique combinations of soil land use slope and management within each subbasin arbab et al 2019 a combination of different hrus forms subbasins and the summation of subbasins forms a watershed all the required inner algorithms of swat for this study are provided in the model description section of the supplementary material 2 3 1 2 model input data the required inputs for swat model are physiographic data streamflow sediment concentration and management operations the topography of the watershed was presented by fine scale digital elevation model 3 m 3 m njdep 2018 the land use was represented by 2012 njdep land use 30 m 30 m data njdep 2012 the njdep land use was classified into six broader categories including urban agricultural land forest wetlands water and barren lands in order to represent different crop lands within the agricultural lands in the watershed 2017 crop data layer 30 m 30 m from u s department of agriculture national agricultural statistics service was combined with 2012 njdep land use data in arcgis environment nass 2017 the soil survey geographic database ssurgo soil data from usda natural resources conservation services nrcs was obtained to represent the soil characteristic in the watershed the meteorological data such as daily precipitation minimum and maximum daily temperature were obtained from three national climatic data center stations fig 1 from 1990 to 2015 the remaining meteorological data including solar radiation relative humidity and wind speed was generated from swat weather generator program to accurately evaluate the fate and transport of the streamflow and sediment different management operations including date and types of tillage amount of fertilization planting and harvesting date of hay winter wheat pasture corn soybean oats and rye were prepared by interviewing local farmers and nrcs personnel urban lands were represented in swat model based on the percent impervious cover the pervious part of the urban land was modelled as lawn and the management operations for the lawn such as mowing and fertilization were prepared after interviewing landscape professionals and local residents in the watershed in this study swat 2012 10 3 18 was used for the modeling purpose and the swat model divided the study area into 115 subbasins and 9117 hrus the hrus within subbasin were created using the threshold of 1 10 10 for land use soil and slope respectively using these thresholds land use area less than 1 within the subbasin were eliminated while soil class less than 10 within each land use were eliminated and slope class that did not have at least 10 within soil were removed during formation of hrus 2 3 1 3 climate change scenarios policymakers generally focus on events occurring in the near term compared to the events in the distant future as they look at the distant future events in more abstract terms weber 2006 consequently we selected the climate change data in the near term 2020 to 2045 rather than for the end of the century two greenhouse gas emission scenarios known as representative concentration pathways rcp 4 5 and rcp 8 5 were selected rcp 4 5 represents the mid range emission moderate reduction scenario while rcp 8 5 depicts high emission scenario business as usual ipcc 2014 the climate change scenarios under rcp 4 5 and 8 5 were projected based on the swat simulation period 2021 to 2045 while for the base period was from 1991 to 2015 ten different global circulation models gcms from coupled model intercomparison projects cmip5 including bcc csm1 1 canesm2 ccsm4 csiro mk3 6 0 gfdl esm2g inmcm4 ipsl cm5a lr miroc esm mpi esm lr and noresm1 m were selected for this study as these gcms are appropriate for north america sunde et al 2018 shrestha and wang 2018 cousino et al 2015 culbertson et al 2016 the detail about the models such as modeling center can be found in the table s1 of the supplementary material the daily precipitation and minimum and maximum temperature based on each gcm were downloaded for historical 1990 2015 as well as future 2020 2045 for the study area from the united states bureau of reclamation usbr the total number of scenarios with combination of two types of rcp 10 gcms and two time periods was 40 2 10 2 this climate data used a statistical downscaling method known as daily bias correction and constructed analogs bcca to correct the systematic errors in gcms and were downscaled to a spatial resolution of 1 8 more information regarding climate data and downscaling method used in this study can be found from brekke et al 2013 the remaining meteorological data including solar radiation relative humidity and wind speed were estimated using swat weather generator elevated co2 level increases plant productivity and decreases plant water requirement due to partial stomatal closing which might reduce the evapotranspiration cho et al 2009 barton et al 2012 however the response of evapotranspiration to elevated co2 under high end scenario is questioned and it is still under debate in the scientific community molina navarro et al 2018 karlsson et al 2015 peng et al 2014 in this study we have not changed the co2 concentration of the various rcp scenarios due to the uncertainty involved all climate data were incorporated in the calibrated swat model one at a time and ran separately on a monthly time scale for two different time periods i 1990 2015 historical and ii 2020 2045 future first the streamflow generated by each gcm for 1990 2015 time period at usgs gauging station 01 398 000 fig 1 was compared on a monthly basis to the observed streamflow using both visually and paired two sample t test additionally monthly streamflow from 10 gcms were averaged to estimate the ensemble mean and the ensemble mean of monthly streamflow was compared with the observed streamflow by both visually and paired two sample t test the ensemble mean approach was adopted to reduce individual biasness of gcm which would ultimately reduce the uncertainty in the climate change study sunde et al 2018 culbertson et al 2016 wagena et al 2016 2 3 1 4 sensitivity analysis and calibration sensitivity analysis is performed to determine the most influential parameters in watershed modeling where modeler uses most sensitive parameters during model calibration process the most sensitive parameters for streamflow and sediment were conducted by past studies in the same watershed including giri et al 2018 giri et al 2016a and qiu and wang 2014 a total of 16 streamflow and five sediment sensitive parameters were collected from the previous studies furthermore these parameters were used in the swat cup abbaspour 2012 abbaspour et al 2007 along with the sequential uncertainty fitting sufi 2 algorithm abbaspour et al 2004 for calibration and validation the streamflow and sediment were calibrated and validated using the objective function of nash sutcliffe efficiency nse in swat cup further swat model performance was evaluated using three model evaluation parameters including nse percent bias pbias and root mean square error rmse observations standard ratio rsr the detail about these model evaluation parameters can be found in the supplementary material two years 2002 2003 of warm up period was used to initialize model parameters for ideal simulation the swat model was calibrated using a monthly time step between 2004 and 2009 while it was validated for 2010 2014 the monthly streamflow data used for calibration and validation were collected from u s geological survey usgs for the usgs gaging station 01 398 000 fig 1 the daily sediment concentration was collected from usgs for the same usgs gauging station 01398000 in order to convert the daily sediment concentration to monthly loads the usgs load estimator loadest was used wagena and easton 2018 giri et al 2012 love and nejadhashemi 2011 loadest is developed based on fortran program by usgs to help researchers and scientists to fill up the sparse water quality data for different analysis by estimating the water quality load for the user specified time period runkel et al 2004 the usgs gauging station 01 398 000 is capturing streamflow from half of the watershed area therefore the optimized parameters developed during calibration and validation process can be applied to the downstream watershed area due to having similar physiographic characteristics tables s2 and s3 supplementary material furthermore this approach was successfully tested by qiu and wang 2014 in the same watershed using the same usgs gaging station for watershed restoration study using swat model other studies around the globe sunde et al 2018 molina navarro et al 2018 luo et al 2013 jha et al 2007 also used similar techniques in calibrating the swat model for climate change study where they optimized calibration parameters using gaging stations located at center to three fourth of the watershed area depending on the availability of observed streamflow 2 3 2 land use prediction framework the human system was formulated in a land use prediction modeling framework which consists of steps for i specifying the driving factors of land use change ii simulating the sub models of land use change predictions iii calibrating the model with best receiver operator characteristic roc value in agent based model abm with respect to the drivers from the land use system and finally iv simulating the abm fig 3 the spatial land use output from the abm is linked loosely coupled to watershed system to estimate the impact of land use change due to human decision making on water systems 2 3 2 1 model description a transition potential map shows the relative likelihood of transition of a particular pixel of particular land use land cover lulc class which simulated based on the transition of lulc in the calibration period camacho olmedo et al 2013 mas et al 2014 mozumder et al 2016 the choice of the land use transition lulc models is dependent upon the tradeoffs of each model and the peculiarities of the study area this study compares three land use change modeling techniques multi layer perceptron mlp spatial logistic regression slr and similarity weighted instance based learning simweight to estimate the future land use transitions the mlp neural network technique is a machine learning approach in simulating complex linear and non linear relationship between the various driving variables and the land use changes bhatti et al 2015 oñate valdivieso and bosque 2010 pijanowski et al 2002 thapa and murayama 2012 the simweight is another machine learning approach and requires less computationally intensive simulation than the mlp sangermano et al 2010a b spatial logistic regression analysis is a commonly used approach to estimate the influence of driving factors on spatial land use trends logistic regression incorporates binary dependent variables as a presence or absence of occurrence and suitability for discrete categorical or continuous explanatory variables atkinson and massari 1998 lee 2005 all these models were implemented in terrset software developed by clark labs 2018 driver variables used in all three models were proximity to roads streams and train stations and proximity to agriculture urban and forested areas after each model was calibrated for nrw study area for an initial period 1986 2012 the model was used to predict land use change for 2040 the transitions of one land cover state to another was identified through previously mentioned three modeling techniques we compared each model s relative roc statistics the roc is suggested as a reliable approach for model validation by several studies pontius and schneider 2001 dendoncker et al 2007 arsanjani et al 2013 the roc assess the validity of model that predicts the location of conversion by comparing the actual change between 1986 and 2012 in a boolean map and the suitability fitted change between 1986 and 2012 swets 1986 pontius and schneider 2000 verburg et al 2002 pijanowski et al 2009 tayyebi et al 2010 clark labs 2018 the roc varies between 0 and 1 within the roc range 1 shows a perfect fit and 0 5 shows a random fit the larger roc values show the better association between explanatory variables and dependent variable clark labs 2018 2 3 2 1 1 similarity weighted instance based learning simweight is an instant based machine learning land use transition potential model that is derived from the logic of the k nearest neighbor procedure fix and hodges 1951 the model was formulated by calculation of weighted distances in land use variable driving factors space to actual land use change instances based on two time period for the land use classes for each pixel in the raster map the class membership is calculated as defined by sangermano et al 2010a b 1 membershi p change i 1 c 1 0 1 1 e 1 d i v c v where v is the number of closest land pixels change persistence of a pixel c is the number of change pixels within the m nearest neighbors and d is the distance to a change instance i a large class membership for the change class would mean that a pixel has environmental conditions similar to those that have already changed and therefore it can be considered to have a high transition potential variable importance weight is determined by comparing the standard deviation of the variable inside the land use areas that have changed to the standard deviation of the variable for the study area as in defined by sangermano et al 2010a b in eq 2 2 relevance weight 1 s d in change sd in study area if the variable is influencing the change then the standard deviation sd of the variable inside the raster cells that changed would be smaller than for the study region as a whole therefore having a large weight using this method weights are calculated by simweight model for each variable table 1 then the standardized variables are multiplied by the weight thus changes the scale of variable in a way proportional to the importance of the variable to discriminate change a threshold of 0 01 was set in simweight model to remove variables that have a very low weight 2 3 2 1 2 multi layer perceptron mlp neural networks in mlp are non linear mlp use complex mathematical function that converts input data such as land use raster map to a desired output a land cover classification clark labs 2018 a typical mlp network contains one input layer one output layer and one or more hidden layers each layer contains nodes or neurons and is connected by lines indicating unequal connecting weights the hidden layer nodes are critical in use of interaction effects to the functioning of mlp research indicates that a 3 layered mlp network can approximate any polynomial function and is capable of solving very complex regression and classification problems clark labs 2018 to determine mlp s prediction accuracy the expected accuracy rate is assigned as a function of the number of transitions being modeled along with the number of persistence classes as follows clark labs 2018 3 e a 1 t p where e a expected accuracy t the number of transitions in the submodel p the number of persistence classes the number of from classes in the sub model a measure of model skill prediction accuracy is then expressed as 4 q a e a 1 e a where a measured accuracy e a expected accuracy this measure varies from 1 to 1 with a skill of 0 indicating random chance the mlp algorithm was used with natural log transformation for distance based variables and the evidence likelihood method was used to transform categorical factors selection of the distance based variables was based upon the fact that these variables are representatives of important parameters for physical biological and socio economic environments and have been found important for lulc change modeling studies guan et al 2011 sang et al 2011 arsanjani et al 2013 sakieh et al 2015 nasiri et al 2018 mlp model was developed and transition potential maps were generated by quantifying the relative importance of each variable to the land use change process transition potential maps from mlp represent the potential of a given category for transformation to another lulc type the lulc change process was predicted up to the year 2040 2 3 2 1 3 spatial logistic regression to estimate land use conversion probabilities driving factors of land use conversion were estimated to examine the probability of land use conversion during the period 1986 2012 as per suggested in arbab et al 2016 to examine the change in spatial residential land use patterns a spatial logistic regression analysis was developed to estimate the influence of driving factors on spatial land use trends logistic regression offers the functionality to incorporate binary dependent variables as a presence or absence of occurrence and suitability for discrete categorical or continuous explanatory variables atkinson and massari 1998 lee 2005 the empirically estimated relationship between the conversions of residential development and the driving factors can be expressed as the following logistic functional form 5 p y 1 x exp β x 1 exp β x where p y 1 x is the predicted probability value of the binary or dichotomous dependent variable y where y 1 means if a cell in raster map changes from a non residential land use in 1986 to residential land use in 2012 and y 0 otherwise this logistic function has linear probability in a set of parameters by having the range of probability between zero and one the following linear logit transformation on both sides of eq 5 was used to estimate the β coefficients menard 1995 6 y l o g i t p l n p k 1 p k β 0 β 1 x 1 k β 2 x 2 k β 3 x 3 k β 4 x 4 k β 5 x 5 k β 6 x 6 k y is the probability that the dependent variable y is 1 p k is the predicted probability of the kth pixel of agricultural or forest land use conversion to residential land β 0 is the intercept and β 1 β 2 β 3 β 4 β 5 a n d β 6 are coefficients for distance to the existing agriculture x1 distance to the existing forests x2 distance to the existing residential areas x3 distance to streams x4 distance to major highways x5 and distance to trains stations x6 respectively these coefficients measure the influence of each independent variable on the variations in probability of land use conversion from non residential land use to residential land use y 2 3 2 1 4 validation agent based model to examine more carefully how we did with the specific task of predicting change to land use conversion we used a three way cross tabulation between the later land cover map the prediction map and the map of reality to evaluate this we calculated the roc statistic also known as the area under the receiver operating characteristic curve or auc this measure was used to determine how well a continuous surface predicted the locations given the distribution of a boolean variable we selected the model parameters to be used for abm empirical parametrization upon roc values this model was designed to simulate land use decisions of agricultural and forest land owners to convert undeveloped land to residential land and implemented in python programming language the agents conversion decisions varied with the spatial distances from each neighboring land use over a period of 10 iterations to roughly approximate a 10 year time period where each iteration was assumed to be a conversion event possibility by modifying an approach from benenson and torrens 2004 each parcel agent s probability of conversion from developable state m to residential state r in each iteration was modeled as 7 pr o b i s m s t s n i where n i represented parcel agent i s neighbors and s represented state of parcel i the model used a monte carlo process hagerstrand 1965 wu 2002 for generating a stochastic abm model to account uncertainty a probability function was implemented to condition the residential conversions utilizing a random number generator batty 2012 arbab 2014 for undeveloped parcels the conversion decision was based upon a comparison between the random number generated and the probability value for each parcel the random number generator rand φi had a random distribution that was uniform between 0 and 1 the parcel agents adopted the following rule of land use conversion in each iteration if rand φ i p it then a it 1 r where r represented the land use class of residential development p was the probability of conversion to residential development for each parcel i a was the conversion event and t was iteration agents first assessed the parcel by comparing the probability with a random number if the value of probability was higher than the random number the agent converted the parcel into a residentially developed parcel if not then the parcel remained in its current non developed state the model with better roc values was used to calibrate projections of residential land use conversions in abm model the abm modelling landscape consisted of property parcels a decision making unit for residential developers the model assumed a market where developable properties were available for residential developers and selection and conversion of property parcels were inherently based upon the proximity based criteria of neighboring features the abm model did not allow developers to build on protected and preserved forest or agricultural lands fig 2 the parameter value of driving factors determined the emergent output of the abm model for example positive sign of a parameter showed that high value of proximity leads to high conversion and negative parameter sign showed inverse relationship between proximity and conversion 2 3 2 2 model input data 2 3 2 2 1 land use land use data was extracted from the njdep for the years 1986 and 2012 to analyze the change from 1986 to 2012 the njdep land use data was further categorized into six broader categories such as urban forest wetlands agricultural land water and barren land the raster files were created in arcgis 10 3 1 using euclidian distance tool for distance to agricultural lands distance to forest and distance to residential lands 2 3 2 2 2 distance to streams the digital hydrography stream network was derived from njdep data 2 3 2 2 3 distance to highways the data consisted of major highways including interstates u s highways state highways and major roads this dataset was obtained from the census 2000 generally road features do not change over long periods of time therefore this data was found suitable for our analysis 2 3 2 2 4 distance to train stations the data on transportation was extracted from new jersey department of transportation njdot for creating the raster file on distance to trains stations 2 3 3 data analysis framework different swat model outputs including temperature precipitation snowfall surface runoff streamflow water yield groundwater lateral flow evapotranspiration soil water percolation and sediment yield and sediment load were extracted from various scenarios base period historical rcp 4 5 historical rcp 8 5 future rcp 4 5 and future rcp 8 5 these data were processed using arcgis environment matlab r platform and microsoft excel based on the requirements for better visualization and easy understanding 3 results and discussion 3 1 swat model calibration validation and uncertainty analysis based on the previous three studies in the same watershed qiu and wang 2014 giri et al 2016a giri et al 2018 as well as using swat cup abbaspour et al 2007 and its sufi 2 algorithm abbaspour et al 2004 we found curve number soil evaporation compensation factor hydraulic conductivity in the main channel maximum canopy storage base flow alpha factor deep aquifer percolation fraction surface runoff lag coefficient groundwater delay time groundwater revap coefficient available water capacity of the soil layer manning s n for overland flow manning s n for main channel threshold depth of shallow aquifer threshold depth for revap snowmelt base temperature and snowpack temperature lag factor are the most sensitive parameters for streamflow the most sensitive parameters for sediment are exponent parameter for channel sediment routing linear parameter for channel sediment routing channel erodibility factor channel cover factor and universal soil loss equation support practice factor the final values of the calibrated parameters for streamflow and sediment are presented in the table s4 of supplementary material the model accuracy for streamflow is categorized as very good based on the guideline developed by moriasi et al 2007 due to nse 0 76 pbias 9 52 and rsr 0 49 for overall period table 2 the hydrograph between observed and simulated streamflow shows a very good agreement between the two in the watershed fig 4 however the model underestimates the peak flow slightly which may be attributed to flashiness of stormwater runoff in the watershed a similar results of flashiness was also observed among the three previous studies in the watershed by qiu and wang 2014 giri et al 2016a giri et al 2018 this flashiness may be attributed due to inability of swat model to incorporate different stormwater infrastructure including detention basins swale ditch segments detention basin inflows discharge pipe and outfalls the model evaluation parameters for sediment suggests that swat model performance is satisfactory in predicting the sediment load in the watershed table 2 the time series of observed and simulated sediment load in the watershed is presented in the supplementary material fig s2 which suggests that the overall prediction of sediment load by swat model agrees with observed sediment load with exception of few under predicted peaks this trend may be due to the swat model s inability to capture the flashiness of the streamflow the primary source of uncertainty in climate change studies comes from the projected climate data molina navarro et al 2018 trolle et al 2015 jensen and veihe 2009 therefore we undertook an uncertainty analysis by comparing the predicted monthly streamflow from 1990 to 2015 of individual gcm from rcp 4 5 and 8 5 emission scenarios against the observed streamflow data at usgs gauging station fig 1 in the watershed the average 26 years monthly streamflow shows reasonable agreement between observed versus individual gcm fig 5 in fact the streamflow between observed and ensemble mean depicts higher agreement furthermore performance statistics including nse pbias and rsr between observed and ensemble mean streamflow table s5 supplementary material shows satisfactory based on the guideline developed by moriasi et al 2007 in general a v shape trend was observed for streamflow throughout the year where one end of the vertex is represented by streamflow at the month of january while the other end of the vertex shows the streamflow during the month of december the vertex represented at streamflow during month of july additionally ncdc simulated streamflow was plotted with observed and ensemble mean which depicts closer trends of streamflow with observed compared to ensemble mean fig 5 in general individual gcms as well as the ensemble mean of streamflow over predicts the observed streamflow especially during summer and fall seasons a similar trend was observed between individual gcm as well as ensemble mean versus observed streamflow for rcp 8 5 emission scenario fig s3 supplementary material in order to determine the significant differences between average monthly streamflow from individual gcm as well as ensemble mean versus observed streamflow from 1990 to 2015 a paired two sample t test between individual gcm ensemble mean versus observed streamflow for mean was conducted in r platform monthly average streamflow under rcp 4 5 emission scenario from individual gcms except canesm2 shows an insignificant difference with observed streamflow at least 1 percent level of significance table 3 furthermore the ensemble mean streamflow also depicts insignificant difference with observed streamflow a similar result was also observed under rcp 8 5 emission scenario table s6 supplementary material due to presence of significant difference in average monthly streamflow between canesm2 versus observed streamflow under both rcp 4 5 and 8 5 scenarios the canesm2 was not included while calculating the ensemble mean during rcp 4 5 and 8 5 emission scenarios from 2020 to 2045 consequently the results of each components in the hydrological cycle as well as sediment transport in the future scenarios i e 2020 to 2045 was calculated based on ensemble mean of all the individual gcms except canesm2 the performance of individual gcms except canesm2 is more likely to perform better in the future condition compared to the canesm2 which already performed poor during current condition 1990 to 2015 teutschbein and seibert 2012 3 2 land use conversion based on agent based probabilistic and transition potential model the land use conversion model results showed that slr had a higher roc value than the other two land use prediction modeling techniques table 4 the parameter values were calibrated through spatial logistic regression and incorporated into agents land use conversion decisions the β x function representing conversion event is calculated using the following equation 9 β x 1 288 0 0015 agric dist 0 0008 forest dist 0 0013 resid dist 0 0007 s t r e a m dist 0 0002 h i g h w a y dist 0 00005 t r a i n dist the slr β x function coefficients suggest that new residential conversions were not positively associated with proximity i e the inverse of distance from to existing residential lands forests or streams conversely proximity to agricultural lands highway and train stations associated with residential conversions compared to mlp and simweight the slr based abm model resulted in a significantly larger area converted to urban land table 5 the different outcomes between machine learning methods and regression based abm is likely due to the difference in the underlying construction of the land conversion models the mlp and simweight models are based on a grid cell geometry while the slr abm is based on polygonal parcels i e the entire ownership parcel may convert at a single time step while all three models displayed a preference for the conversion of agricultural land to urban land uses the abm converts a significantly higher amount of land overall table 5 and fig 6 the abm is more similar to a build out model where all available agricultural land that isn t protected as preserved farmland and forest land that isn t protected by regulation is converted based on the higher roc value as well as the larger amount of land use area predicted to convert by 2040 the abm results were used for land use change scenario as well as combined climate and land use change analysis 3 3 potential effect of climate change on components of hydrological cycle the future temperature projection in the nrw showed an increasing trend compared to base period fig 7 a the average annual temperature increased from 9 4 c to 12 5 c and 12 7 c displaying a 33 3 and 35 7 increase compared to base period under rcp 4 5 and 8 5 scenarios respectively the annual temperature cycle showed a clear increasing trend in average monthly mean temperature compared to base period throughout the year the seasonal analysis of different components of hydrological cycle and temperature shows the of increase decrease in each parameters compared to base period table 6 the seasonal analysis of temperature depicted the highest increase in temperature compared to base period 178 8 and 201 9 for rcp 4 5 and 8 5 respectively to occur during winter while the least rise 16 8 and 17 9 for rcp 4 5 and 8 5 respectively was during summer both annual and seasonal analysis demonstrated overall warming of the watershed with higher temperature under rcp 4 5 and 8 5 scenarios compared to base period the future precipitation projection in the nrw showed a slight decreasing trend compared to base period fig 7 b overall the average annual precipitation in the nrw decreased from 107 57 mm to 102 95 mm and 103 79 mm representing a 4 3 and 3 5 decrease compared to base period under rcp 4 5 and 8 5 scenarios respectively the annual precipitation cycle remained unchanged from january to may while a shift in precipitation cycle was observed from june to december the most notable differences were a shift of precipitation peak from june to august accompanied by a sharp decline in precipitation until october the seasonal analysis of precipitation depicted the highest reduction in precipitation 7 48 and 7 73 for rcp 4 5 and 8 5 respectively during fall while the least reduction in spring season 1 22 and 0 56 for rcp 4 5 and 8 5 respectively shifting of this precipitation pattern accompanied with rising temperature may increase the risk of drought flooding and water quality degradation in the watershed mishra and liu 2014 wu et al 2012b the findings of increasing temperature and lesser precipitation in the future projected scenarios is consistent with the results of other researchers including paul et al 2017 neupane and kumar 2015 and jha et al 2007 in response to an increased temperature and reduced precipitation in the watershed the snowfall decreased throughout the year for the future climate change under both rcp 4 5 and 8 5 scenarios compared to base period fig 7c the average annual snowfall reduced from 12 70 mm to 6 40 mm and 5 96 mm which depicts a decrease in nearly 50 and 53 compared to base period under rcp 4 5 and 8 5 scenarios respectively as a result of decrease in snowfall and precipitation for future climate change scenarios under rcp 4 5 and 8 5 compared to base period a decline in surface runoff was observed during most months except for august and november fig 7 d the increased surface runoff during these two months was due to higher precipitation in both rcps compared to base period fig 7b the mean annual surface runoff decreased from 29 60 mm base period to 22 32 mm rcp 4 5 and 8 5 which represents a 24 40 reduction a similar reduction in surface runoff was observed by culbertson et al 2016 in maumee river watershed in ohio united states under rcp 4 5 and 8 5 scenarios the seasonal analysis indicates that the maximum surface runoff reduction was observed during summer while the minimum reduction was found during fall table 6 despite lower precipitation higher streamflow was observed in the watershed for both climate change rcp scenarios compared to base period fig 7 e due to higher yield fig 7 f the higher yield was contributed by higher groundwater fig 7 g and lateral flow fig 7 h in both rcps compared to base period the higher groundwater and lateral flow may be due to increase in infiltration capacity of soil due to increase in air temperature in future climate change increasing air temperature leads to frost free soil in most of the year which increases soil temperature the resultant impact increases soil pore water holding capacity leading to higher soil hydraulic conductivity which results into higher infiltration and less surface runoff pradhan et al 2019 stähli et al 1999 dunne and black 1971 a similar result was also observed in the future climate change scenario by culbertson et al 2016 in the maumee river watershed ohio additionally pervez and henebry 2015 found the increasing trend of lateral flow under climate change in the brahmaputra river basin in south asia the average annual streamflow increased from 2 21 m3 sec base line to 2 92 m3 sec and 2 93 m3 sec rcp 4 5 and rcp 8 5 respectively which represents an increase in streamflow of approximately 32 in both rcps compared to base period the streamflow was correlated with water yield from both rcps in the watershed the annual water yield was 40 65 mm for the base period while it was 53 67 mm and 53 76 mm for rcp 4 5 and rcp 8 5 respectively this indicates an approximately 32 increase in water yield in both rcps compared to base period a negligible difference in results between both rcps may be due to consideration of future climate change in the near term 2020 2045 in this study the increase in streamflow and water yield in both rcps were consistent which was evident from the result a 32 increase in streamflow due to water yield may potentially elevate the flooding risk in the watershed similar to the average annual streamflow and water yield similar seasonal trends were observed between the two where maximum increase was found during fall and the minimum increase was noticed during winter table 6 a higher groundwater was predicted throughout the year for both rcps compared to base period fig 7 g in fact an average increase in more than 200 of groundwater was predicted for climate change under both rcps compared to base period this result may be due to substantial reduction in snowfall in the watershed which resulted in reduction of surface runoff events during winter and spring while facilitating infiltration furthermore increasing projected temperature increases soil temperature leading to higher infiltration during the winter months culbertson et al 2016 this indicates the critical role of groundwater towards streamflow in the watershed especially during low flow condition summer season however a detail analysis of groundwater components in the watershed is required to assure the contribution of groundwater to streamflow a similar increasing trend of groundwater was observed due to climate change in the batsto river watershed located in the southern new jersey daraio 2017 similar to groundwater an increasing trend of lateral flow was predicted throughout the year fig 7 h approximately more than 95 increase in average annual lateral flow was predicted in both rcps compared to base period the seasonal analysis suggests that the maximum increase in lateral flow was during fall while the minimum increase was during winter table 6 daraio 2017 observed increased streamflow due to climate change in the maurice river watershed and batsto river watershed located in the southern new jersey similarly wagena and easton 2018 reported an increase of streamflow in the range of 4 5 9 in the susquehanna river basin located in chesapeake bay due to climate change additionally hayhoe et al 2013 found a positive shift in streamflow by 5 10 in the river basins located in the northeast united states as a result of climate change furthermore ahiablame et al 2017 predicted the increase in streamflow between 8 and 48 by midcentury in the james river watershed located in north and south dakota united states additionally increase in streamflow was projected by other researchers due to future climate change including shrestha and wang 2017 wagena et al 2016 and pervez and henebry 2015 in different parts of the world the evapotranspiration was projected to decrease substantially throughout the year due to climate change fig 7 i the average 12 month annual evapotranspiration was approximately 65 mm and 48 mm for base period and climate change rcps respectively this indicates that the evapotranspiration was projected to decrease by at least 25 in both rcps compared to base period the reduction in evapotranspiration was primarily be due to lower future precipitation neupane and kumar 2015 kim et al 2013 and this decreased evapotranspiration could have increased soil water and percolation fig 7 j and k in the watershed for climate change under both rcps the seasonal analysis depicts that the projected evapotranspiration was least during winter while it was highest during summer in contrast to evapotranspiration the average annual soil water and percolation were projected to increase by more than 52 and 180 respectively in both rcps compared to base period the increase in soil water will reduce irrigation for different crop production in the watershed while increase in percolation will increase the groundwater recharge and ultimately increases streamflow paul et al 2017 and neupane and kumar 2015 also found increased in soil water content and percolation and decrease in evapotranspiration in their climate change studies in different watersheds in the united states additionally the long term monthly as well as seasonal trends of precipitation streamflow and sediment transport during the base period 1991 2015 in the nrw is presented in section 3 2 of the supplementary material 3 4 consequence of climate change on sediment generation and sediment load in the watershed to assess the impact of climate change on sediment production at subbasin level syld of output sub file was used which depicts the weighted average of sediment from all hrus within each subbasin before channel routing in the base period condition greater sediment yield was observed at southeast edge of the watershed while lowersediment yield was found at north central side of the watershed fig 8 a under rcp 4 5 the majority of subbasins were predicted to have reduced sediment yield fig 8b the spatial pattern of sediment generation reduction under rcp 8 5 was similar to rcp 4 5 except slightly more sediment generation subbasins were predicted fig 8c as might be expected the spatial distribution of sediment yield among the subbasins was primarily dependent on topographic elevation of the watershed for example the higher sediment yield was predicted at the southeast as well as northwest subbasins in the watershed having steeper slopes compared to other parts figs 1 and 8 b in contrast negative sediment generation was forecasted in most of the subbasins located in the center of the watershed having lesser topographic elevation additionally most of the subbasins generating higher sediment yield also displayed increasing surface runoff under the climate change scenarios compared to base period fig s6 supplementary material shrestha and wang 2018 also found highest sediment generation in subbasins having steepest topography compared to other parts of the watershed using swat model during climate change study in canada however when sediment load was compared at the watershed outlet after considering channel routing a slight increase in sediment load more than 10 compared to base period was observed for both rcps in climate change scenario fig 9 this increase can be attributed to greater channel and stream bed erosion due to higher streamflow approximately 32 in the climate change scenarios compared to the base period our findings are corroborated by the outcomes of previous study in the same watershed by qiu and wang 2014 they found that streams are the primary sources of sediment compared to different land uses contributing nearly 60 of the sediment load in the watershed furthermore the monthly as well as seasonal trends between streamflow and sediment load during the base period 1991 2015 shows that the streamflow is the primary driver of sediment generation in the river fig s5 supplementary material when both rcps were compared rcp 8 5 produced slightly more sediment load compared to rcp 4 5 which may be due to greater numbers of sediment generation subbasins in rcp 8 5 compared to rcp 4 5 fig 8 b and c overall the climate change scenarios suggest increasing sediment load in the streams fig 9 which may adversely affect the health of aquatic ecosystems wagena and easton 2018 also found an increasing trend of annual sediment load ranging from 26 to 31 in the susquehanna river basin located in chesapeake bay due to climate change apart from sediment load primary components of hydrologic cycle due to climate change only scenario compared to base period is also found from fig 9 3 5 potential effect of land use change on components of hydrological cycles and sediment load the land use change only based on abm 2040 scenario projects an increase of 24 in urban land area leading to an increase in surface runoff 4 fig 10 despite the increased surface runoff a reduction in streamflow and water yield approximately 5 was forecastdue to reduction in both groundwater by 39 and lateral flow 18 this indicates the importance of subsurface flow in the watershed the reduction in groundwater and lateral flow in the land use change scenario compared to base period was due to increase in impervious surface as a result of increased residential areas a previous study of giri et al 2018 conducted in the same watershed where they forecasted water security based on projected land use of 2022 and found a similar result of increasing surface runoff and decreasing soil moisture pattern compared to base period due to lesser infiltration as a result of urbanization the evapotranspiration was projected to decline due to conversion of a significant area of the agricultural lands and forest into residential area even though additional lawns in the new residential areas were taken into account while estimating evapotranspiration a similar decreasing trend of evapotranspiration was observed compared to base period due to conversion of agricultural lands and forest into residential areas in the same watershed for land use projected scenario of 2022 giri et al 2018 additionally a reduction in percolation was observed in the land use change scenario compared to base period finally approximately 42 reduction in sediment load was predicted in the land use change scenario compared to base period due to conversion of 2 785 ha agricultural lands table 5 into residential areas in the land use change scenario 3 6 potential effect of combined climate and land use change on components of hydrological cycles and sediment load the trends of different components of hydrological cycles and sediment load for the combined climate and land use change scenario are similar to the trends found in the climate change only scenario when each components were compared among two emission scenarios rcp 4 5 and rcp 8 5 a negligible difference was observed between the two emission scenarios the surface runoff in the combined climate and land use change scenario was projected to decrease around 4 compared to base period fig 11 despite increased impervious surface through increased residential area lesser runoff was predicted due to lower projected precipitation in the combined climate and land use change scenario compared to base period this indicates that climate i e reduced precipitation has greater contribution on hydrologic process compared to land use despite lower surface runoff higher streamflow and water yield 36 was predicted in the combined climate and land use change scenario due to higher increase in groundwater lateral flow and percolation evapotranspiration was projected to decrease approximately 24 under combined climate and land use change scenario compared to base period this result was due to conversion of agricultural land and forest into residential area combined with lesser precipitation finally the sediment load in the watershed was predicted to decrease roughly 30 in the combined climate and land use scenario compared to base period which was due to conversion of most of the agricultural lands towards urban land plus lesser surface runoff the reduction of sediment in this scenario was lower compared to land use change alone due to offset of sediment reduction by climate change in the coupled climate and land use change scenario 3 7 summary of results across all three scenarios a composite summary of primary components of three scenarios compared to base period is presented in table 7 the ensemble gcm predicts warmer temperatures and declining snowfall and precipitation amounts leading to a projected decrease in surface runoff as modeled in swat in climate change only scenario conversely an increasing surface runoff trend was predicted for the land use change scenario due to an increase in impervious surface area when modeled in composite the increased impervious surface from new urban lands was compensated for by the reduction in surface runoff in the climate change scenario streamflow and water yield are predicted to increase in the future despite decreased precipitation and surface runoff due to an increase in percolation and lateral flow compared to base period in both climate change alone as well as combined climate and land use change scenario these results suggest the importance of sub surface flow in the watershed similar relationships of streamflow versus surface runoff and subsurface flow were observed by culbertson et al 2016 and neupane and kumar 2015 in climate change study in ohio and south dakota watersheds respectively the projected sediment load was slightly greater in climate change only scenario compared to the base period which may be attributed to channel erosion due to increase in streamflow however an opposite trend of decreasing sediment load was predicted in both land use change only as well as combined climate and land use change scenario likely due to the extensive conversion of agricultural lands into residential areas 4 conclusions understanding the standalone as well as combined effects of climate change and land use transformation are needed to formulate better water resource management and adaptation strategies in a changing environment the integrated modeling framework we have developed facilitates the assessment of the potential impact of climate and land use change either in isolation or in composite on different components of hydrological cycle and sediment loading we suggest that streamflow and sediment load serve as suitable metrics for assessing watershed resilience whether due to changing climate or land use our results predict the changing climate will have a larger effect on the hydrologic cycle than intensifying urban land uses in our study watershed the coupled hydrologic land use change modeling suggests increasing urbanization will result in lower streamflow the climate change scenarios either alone or in composite with land use change predict higher streamflow overriding the effect of land use changes in our study watershed higher levels of streamflow will likely exacerbate existing flooding issues and thereby serve to lower watershed resiliency conversely the climate and land use change scenarios predict opposite effects on sediment load with the climate change increasing sediment loading to the study watershed when modelled in composite the effect of changing land use in this case the conversion of erodible agricultural fields to suburban development overrides the adverse effect of climate change enhancing watershed resiliency by reducing sediment load and thereby improving health of the downstream aquatic ecosystems the integrated modeling framework we have developed is transferable to other watersheds providing practitioners a more effective way to examine the implications of land use and climate change either alone or in composite acknowledgements the research was supported by the johnson family chair in water resources watershed ecology and the sustainable raritan river initiative at rutgers university we gratefully acknowledge the world climate research programme s working group on coupled modeling and we also gratefully thank the climate modeling groups listed in table s1 for producing and making available their model out for cmip the u s department of energy s program for cli mate model diagnosis and intercomparison provides coordinating support and led development of software infrastructure in partnership with the global organization for earth system science portals additionally we would like to thank mr srinivas gaddam for helping in making some figures for this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123955 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6222,climate and land use change are the two primary factors that affect different components of hydrological cycle as well as sediment transport in the watershed quantifying potential impact of these two stressors enables decision makers to formulate better water resource management strategies to adapt to the changing environment to that end we have developed an integrated modeling framework employing an agent based approach to simulate land use conversion that then serves as input to the soil and water assessment tool swat in a loosely coupled fashion the modeling framework was tested on the neshanic river watershed nrw 142 km2 area in central new jersey that contains mix of urban agricultural and forested lands an ensemble of 10 different global climate models gcms for two different greenhouse gas emission scenarios including representative concentration pathways 4 5 and 8 5 rcp 4 5 and 8 5 were employed to model future climate from 2020 to 2045 land use conversion for 2040 was developed based on six driving factors including distance to residential lands agricultural lands roads streams train stations and forest using three land use transition potential models and further the best transition potential model accompanied with some local land use restrictions the study evaluated various components of hydrological cycle and sediment transport for the three different scenarios one at a time including climate change alone land use change alone and combined climate and land use change results indicate that the changing climate will have a larger effect on the hydrologic cycle than intensifying urban land uses in the study watershed the climate change scenarios either alone or in composite with land use change predict higher streamflow 32 and 36 increase over baseline respectively overriding the effect of land use change which predicts a decline of 5 in streamflow the increase in streamflow results in an increase in sediment loading presumably due to an increase stream downcutting conversely the effect of land use change in this case the conversion of agricultural land to low density residential uses is predicted to decrease sediment load when modelled in composite the effect of changing land use in this case the conversion of erodible agricultural fields to suburban development appears to override the adverse effect of climate change enhancing watershed resiliency by reducing sediment load and thereby improving health of the downstream aquatic ecosystems keywords climate change land use change loosely coupled systems soil and water assessment tool transition potential model agent based model representative concentration pathways hydrologic cycle sediment load climate resiliency 1 introduction climate and land use change are the two primary stressors that humanity is facing in the 21st century pervez and henebry 2015 teshager et al 2016 zhang et al 2018 and both of them have larger implications on hydrological cycle as well as sediment transport in the watershed wagena et al 2016 panagopoulos et al 2015 luo et al 2013 boe et al 2009 due to increase in average global mean temperature different components of hydrological cycle including precipitation evaporation transpiration infiltration groundwater surface runoff and snowmelt are going to affect seriously at both spatial and temporal scales immerzeel 2008 labat et al 2004 additionally a warmer atmosphere will have greater water holding capacity leading to intensification of hydrological cycle which will pose the risk of flooding and droughts at locale to regional scale praskievicz and bartlein 2014 wu et al 2012a increased surface runoff due to climate change poses a threat of excessive land degradation in the upland areas in the watershed and significantly affects the sediment transport in the river reach systems similarly changing land use will alter the energy balance within the hydrological cycle ma et al 2009 affecting evapotranspiration mao and cherkauer 2009 interception babamaaji 2013 infiltration zierl and bugmann 2005 surface runoff giri et al 2018 yan et al 2013 and sediment transport shrestha and wang 2018 bussi et al 2016 resulting a profound impact on water quality and water supply giri et al 2018 cho et al 2009 kundzewicz et al 2007 elevating the level of sediment in the river reach systems has a negative impact towards environmental sustainability including global biodiversity and ecosystems function ipcc 2014 future climate and land use change has profound implications for the state of new jersey as it faces severe flooding due to extreme events usepa 2016 that is further exacerbated by the highest percentage of urban land cover in the u s lathrop et al 2016 the average annual temperature in the state has increased by 2 f since 1900 whereas the average winter temperature has increased by 4 f since 1970 frumhoff et al 2007 usepa 1997 the average annual precipitation in the state has increased by 5 to 10 percent while the major extreme precipitation events have increased 70 percent in the northeast u s usepa 2016 ncsl 2008 additionally new jersey being the most densely populated state provides an excellent case study of the multiple effects of intensifying urban land uses considering different stressors including climate and land use change on different components of hydrological cycle and sediment transport on watershed scale requires a holistic and multidisciplinary approach to better understand the underlying cause and effect as well as sustainable adaptation strategies to mitigate the undesirable effects resiliency is known as capacity to adjust or develop adaptation strategies of a system to address external undesirable environmental changes nelson et al 2007 folke 2006 better understanding of how the changes in land use and climate will impact the hydrological cycle and especially sediment transport will enable more informed watershed adaptation strategies to help make communities more resilient to climate change to that end model simulation is proven to be an effective tool woznicki et al 2016 giri et al 2015 a variety of models have been developed to assess the impact of climate and land use change on watershed scale however soil and water assessment tool swat has seen widespread application due to its process based structure ability to model hydrology plant growth related process incorporate different urban and agricultural management practices representation of land use and meteorological parameters essential from water balance prospective zhang et al 2018 giri et al 2016a ficklin and barnhart 2014 giri et al 2014 mutenyo et al 2013 swat model has not only been used to assess the effect of climate change on watershed hydrology and water quality shrestha and wang 2018 yang et al 2018 reshmidevi et al 2017 woznicki et al 2016 cousino et al 2015 ficklin and barnhart 2014 chien et al 2013 wu et al 2012a but also employed to evaluate the combined effect of land use and climate change on hydrology and water quality ahiablame et al 2017 bussi et al 2016 chen et al 2017 gabriel et al 2016 ma et al 2009 mehdi et al 2015 molina navarro et al 2018 neupane and kumar 2015 paul et al 2017 pervez and henebry 2015 setyorini et al 2017 teshager et al 2016 zhang et al 2018 on watershed scale throughout the globe in evaluating the implications of the combined effect of future land use and climate change authors have generally projected future land use based on either hypothetical scenarios molina navarro et al 2018 zhang et al 2018 chen et al 2017 neupane and kumar 2015 teshager et al 2016 mehdi et al 2015 or using global national scale models ahiablame et al 2017 gabriel et al 2016 pervez and henebry 2015 hypothetical land use projection does not match with the real land use change in the ground while global national scale models lack a nuanced consideration of local regulations or future land development plans in a region most of the prior research on modeling the combined effect of land use and climate change on hydrology has focused on land development scenarios related to agricultural land conversion i e conversion of other land uses to agricultural land or between various agricultural land practices however there is a great need to evaluate the combined effects in urbanizing regions as well to formulate water resource management strategies adapted to a changing environment to that end we have developed an integrated modeling framework in a coupled natural and human system where the natural system is modelled using swat and the urban land use conversion to overcome the aforementioned drawbacks for land use projection we have been exploring land use change models driven by socio economical regulatory as well as neighboring land use factors using both agent based and transition potential modeling the specific objectives of this study were to i evaluate the potential impact of climate change in the near future on different components of hydrological cycle as well as sediment load on a field and watershed scale and ii estimate the effect of land use change only as well as combined climate and land use change on different water fluxes and sediment load in a central new jersey watershed 2 materials and methods 2 1 study area the study area neshanic river watershed or nrw is located in central new jersey between u s s largest and 6th largest cities new york and philadelphia respectively experiencing the effect of both climate and land use change fig 1 it is a headwater to raritan basin the nrw has been declared as impaired for aquatic life due to non point source pollution such as total suspended solids and other pollutants njdep 2011 apart from degraded water quality issues nrw has been influenced by water quantity fluctuation especially during the low flow condition the 142 km2 watershed is evenly divided between agricultural urban and forest land 32 versus 30 versus 29 respectively with smaller component of wetlands 8 barren lands and water the land use map of the nrw can be found in the supplementary material fig s1 the elevation in the watershed ranges from 20 m to 208 m above the mean sea level fig 1 a recent study conducted by giri et al 2016b indicates an increase in urbanized land use is expected in the watershed in the coming years the watershed is located in the piedmont physiographic region and it is underlain by slightly folded and faulted sedimentary and igneous rocks a humid climate is observed in the watershed having hot and humid during summer average temperature of 27 to 30 c while cold in winter average low temperature of 7 to 5 c the mean annual precipitation is 1 292 mm according to national climatic data center with precipitation occurring 120 days per year during the summer thunderstorms are responsible for a majority of the precipitation in the watershed the average annual winter snowfall in the watershed ranges from 120 to 770 mm well drained silty soils are found in the watershed where major crops including hay soybean pasture winter wheat and corn are grown minor crops include oat barely sunflower sorghum and rye 2 2 conceptual framework of loosely coupled systems this climate and land use change study was conducted in a loosely coupled system lcs fig 2 the lcs had two intra systems and one inter system interaction the land use prediction modeling component focusses on the ongoing land management and land use conversion process i e conversion of agricultural and forest into residential land the hydrologic modeling component focused on the different components of hydrologic cycle including surface runoff streamflow water yield groundwater recharge lateral flow evapotranspiration soil water and percolation as well as sedimentation these hydrologic processes are dependent on the properties of topography soil land use land cover and management urbanization and the resulting increase in impervious surface affects different water balance components as well as sediment transport potentially acerbating flooding drought and decreased downstream water quality climate change potentially magnifies the coupling between these two systems leading to higher storm runoff increased watershed flashiness rise and fall of streamflow quickly during storm events and sediment erosion and transport 2 3 loosely coupled modeling framework the loosely coupled modeling framework consisted of three strands 1 hydrologic modeling framework 2 land use prediction framework and 3 data analysis framework fig 3 2 3 1 hydrologic modeling framework 2 3 1 1 model description the swat model was used to predict the different components of the hydrological cycle as well as sediment transport in the nrw swat is a semi distributed physically based watershed scale model developed by u s department of agriculture usda arnold et al 1998 gassman et al 2007 neitsch et al 2011 different primary components of the swat model are hydrology soil plant growth weather nutrients pesticides and land management practices the hydrologic component of swat is divided into two parts i land phase hydrologic cycle and ii routing phase hydrologic cycle the hydrologic modeling framework consisted of three different spatial scales including hydrologic response units hrus subbasin and watershed scale hrus are the unique combinations of soil land use slope and management within each subbasin arbab et al 2019 a combination of different hrus forms subbasins and the summation of subbasins forms a watershed all the required inner algorithms of swat for this study are provided in the model description section of the supplementary material 2 3 1 2 model input data the required inputs for swat model are physiographic data streamflow sediment concentration and management operations the topography of the watershed was presented by fine scale digital elevation model 3 m 3 m njdep 2018 the land use was represented by 2012 njdep land use 30 m 30 m data njdep 2012 the njdep land use was classified into six broader categories including urban agricultural land forest wetlands water and barren lands in order to represent different crop lands within the agricultural lands in the watershed 2017 crop data layer 30 m 30 m from u s department of agriculture national agricultural statistics service was combined with 2012 njdep land use data in arcgis environment nass 2017 the soil survey geographic database ssurgo soil data from usda natural resources conservation services nrcs was obtained to represent the soil characteristic in the watershed the meteorological data such as daily precipitation minimum and maximum daily temperature were obtained from three national climatic data center stations fig 1 from 1990 to 2015 the remaining meteorological data including solar radiation relative humidity and wind speed was generated from swat weather generator program to accurately evaluate the fate and transport of the streamflow and sediment different management operations including date and types of tillage amount of fertilization planting and harvesting date of hay winter wheat pasture corn soybean oats and rye were prepared by interviewing local farmers and nrcs personnel urban lands were represented in swat model based on the percent impervious cover the pervious part of the urban land was modelled as lawn and the management operations for the lawn such as mowing and fertilization were prepared after interviewing landscape professionals and local residents in the watershed in this study swat 2012 10 3 18 was used for the modeling purpose and the swat model divided the study area into 115 subbasins and 9117 hrus the hrus within subbasin were created using the threshold of 1 10 10 for land use soil and slope respectively using these thresholds land use area less than 1 within the subbasin were eliminated while soil class less than 10 within each land use were eliminated and slope class that did not have at least 10 within soil were removed during formation of hrus 2 3 1 3 climate change scenarios policymakers generally focus on events occurring in the near term compared to the events in the distant future as they look at the distant future events in more abstract terms weber 2006 consequently we selected the climate change data in the near term 2020 to 2045 rather than for the end of the century two greenhouse gas emission scenarios known as representative concentration pathways rcp 4 5 and rcp 8 5 were selected rcp 4 5 represents the mid range emission moderate reduction scenario while rcp 8 5 depicts high emission scenario business as usual ipcc 2014 the climate change scenarios under rcp 4 5 and 8 5 were projected based on the swat simulation period 2021 to 2045 while for the base period was from 1991 to 2015 ten different global circulation models gcms from coupled model intercomparison projects cmip5 including bcc csm1 1 canesm2 ccsm4 csiro mk3 6 0 gfdl esm2g inmcm4 ipsl cm5a lr miroc esm mpi esm lr and noresm1 m were selected for this study as these gcms are appropriate for north america sunde et al 2018 shrestha and wang 2018 cousino et al 2015 culbertson et al 2016 the detail about the models such as modeling center can be found in the table s1 of the supplementary material the daily precipitation and minimum and maximum temperature based on each gcm were downloaded for historical 1990 2015 as well as future 2020 2045 for the study area from the united states bureau of reclamation usbr the total number of scenarios with combination of two types of rcp 10 gcms and two time periods was 40 2 10 2 this climate data used a statistical downscaling method known as daily bias correction and constructed analogs bcca to correct the systematic errors in gcms and were downscaled to a spatial resolution of 1 8 more information regarding climate data and downscaling method used in this study can be found from brekke et al 2013 the remaining meteorological data including solar radiation relative humidity and wind speed were estimated using swat weather generator elevated co2 level increases plant productivity and decreases plant water requirement due to partial stomatal closing which might reduce the evapotranspiration cho et al 2009 barton et al 2012 however the response of evapotranspiration to elevated co2 under high end scenario is questioned and it is still under debate in the scientific community molina navarro et al 2018 karlsson et al 2015 peng et al 2014 in this study we have not changed the co2 concentration of the various rcp scenarios due to the uncertainty involved all climate data were incorporated in the calibrated swat model one at a time and ran separately on a monthly time scale for two different time periods i 1990 2015 historical and ii 2020 2045 future first the streamflow generated by each gcm for 1990 2015 time period at usgs gauging station 01 398 000 fig 1 was compared on a monthly basis to the observed streamflow using both visually and paired two sample t test additionally monthly streamflow from 10 gcms were averaged to estimate the ensemble mean and the ensemble mean of monthly streamflow was compared with the observed streamflow by both visually and paired two sample t test the ensemble mean approach was adopted to reduce individual biasness of gcm which would ultimately reduce the uncertainty in the climate change study sunde et al 2018 culbertson et al 2016 wagena et al 2016 2 3 1 4 sensitivity analysis and calibration sensitivity analysis is performed to determine the most influential parameters in watershed modeling where modeler uses most sensitive parameters during model calibration process the most sensitive parameters for streamflow and sediment were conducted by past studies in the same watershed including giri et al 2018 giri et al 2016a and qiu and wang 2014 a total of 16 streamflow and five sediment sensitive parameters were collected from the previous studies furthermore these parameters were used in the swat cup abbaspour 2012 abbaspour et al 2007 along with the sequential uncertainty fitting sufi 2 algorithm abbaspour et al 2004 for calibration and validation the streamflow and sediment were calibrated and validated using the objective function of nash sutcliffe efficiency nse in swat cup further swat model performance was evaluated using three model evaluation parameters including nse percent bias pbias and root mean square error rmse observations standard ratio rsr the detail about these model evaluation parameters can be found in the supplementary material two years 2002 2003 of warm up period was used to initialize model parameters for ideal simulation the swat model was calibrated using a monthly time step between 2004 and 2009 while it was validated for 2010 2014 the monthly streamflow data used for calibration and validation were collected from u s geological survey usgs for the usgs gaging station 01 398 000 fig 1 the daily sediment concentration was collected from usgs for the same usgs gauging station 01398000 in order to convert the daily sediment concentration to monthly loads the usgs load estimator loadest was used wagena and easton 2018 giri et al 2012 love and nejadhashemi 2011 loadest is developed based on fortran program by usgs to help researchers and scientists to fill up the sparse water quality data for different analysis by estimating the water quality load for the user specified time period runkel et al 2004 the usgs gauging station 01 398 000 is capturing streamflow from half of the watershed area therefore the optimized parameters developed during calibration and validation process can be applied to the downstream watershed area due to having similar physiographic characteristics tables s2 and s3 supplementary material furthermore this approach was successfully tested by qiu and wang 2014 in the same watershed using the same usgs gaging station for watershed restoration study using swat model other studies around the globe sunde et al 2018 molina navarro et al 2018 luo et al 2013 jha et al 2007 also used similar techniques in calibrating the swat model for climate change study where they optimized calibration parameters using gaging stations located at center to three fourth of the watershed area depending on the availability of observed streamflow 2 3 2 land use prediction framework the human system was formulated in a land use prediction modeling framework which consists of steps for i specifying the driving factors of land use change ii simulating the sub models of land use change predictions iii calibrating the model with best receiver operator characteristic roc value in agent based model abm with respect to the drivers from the land use system and finally iv simulating the abm fig 3 the spatial land use output from the abm is linked loosely coupled to watershed system to estimate the impact of land use change due to human decision making on water systems 2 3 2 1 model description a transition potential map shows the relative likelihood of transition of a particular pixel of particular land use land cover lulc class which simulated based on the transition of lulc in the calibration period camacho olmedo et al 2013 mas et al 2014 mozumder et al 2016 the choice of the land use transition lulc models is dependent upon the tradeoffs of each model and the peculiarities of the study area this study compares three land use change modeling techniques multi layer perceptron mlp spatial logistic regression slr and similarity weighted instance based learning simweight to estimate the future land use transitions the mlp neural network technique is a machine learning approach in simulating complex linear and non linear relationship between the various driving variables and the land use changes bhatti et al 2015 oñate valdivieso and bosque 2010 pijanowski et al 2002 thapa and murayama 2012 the simweight is another machine learning approach and requires less computationally intensive simulation than the mlp sangermano et al 2010a b spatial logistic regression analysis is a commonly used approach to estimate the influence of driving factors on spatial land use trends logistic regression incorporates binary dependent variables as a presence or absence of occurrence and suitability for discrete categorical or continuous explanatory variables atkinson and massari 1998 lee 2005 all these models were implemented in terrset software developed by clark labs 2018 driver variables used in all three models were proximity to roads streams and train stations and proximity to agriculture urban and forested areas after each model was calibrated for nrw study area for an initial period 1986 2012 the model was used to predict land use change for 2040 the transitions of one land cover state to another was identified through previously mentioned three modeling techniques we compared each model s relative roc statistics the roc is suggested as a reliable approach for model validation by several studies pontius and schneider 2001 dendoncker et al 2007 arsanjani et al 2013 the roc assess the validity of model that predicts the location of conversion by comparing the actual change between 1986 and 2012 in a boolean map and the suitability fitted change between 1986 and 2012 swets 1986 pontius and schneider 2000 verburg et al 2002 pijanowski et al 2009 tayyebi et al 2010 clark labs 2018 the roc varies between 0 and 1 within the roc range 1 shows a perfect fit and 0 5 shows a random fit the larger roc values show the better association between explanatory variables and dependent variable clark labs 2018 2 3 2 1 1 similarity weighted instance based learning simweight is an instant based machine learning land use transition potential model that is derived from the logic of the k nearest neighbor procedure fix and hodges 1951 the model was formulated by calculation of weighted distances in land use variable driving factors space to actual land use change instances based on two time period for the land use classes for each pixel in the raster map the class membership is calculated as defined by sangermano et al 2010a b 1 membershi p change i 1 c 1 0 1 1 e 1 d i v c v where v is the number of closest land pixels change persistence of a pixel c is the number of change pixels within the m nearest neighbors and d is the distance to a change instance i a large class membership for the change class would mean that a pixel has environmental conditions similar to those that have already changed and therefore it can be considered to have a high transition potential variable importance weight is determined by comparing the standard deviation of the variable inside the land use areas that have changed to the standard deviation of the variable for the study area as in defined by sangermano et al 2010a b in eq 2 2 relevance weight 1 s d in change sd in study area if the variable is influencing the change then the standard deviation sd of the variable inside the raster cells that changed would be smaller than for the study region as a whole therefore having a large weight using this method weights are calculated by simweight model for each variable table 1 then the standardized variables are multiplied by the weight thus changes the scale of variable in a way proportional to the importance of the variable to discriminate change a threshold of 0 01 was set in simweight model to remove variables that have a very low weight 2 3 2 1 2 multi layer perceptron mlp neural networks in mlp are non linear mlp use complex mathematical function that converts input data such as land use raster map to a desired output a land cover classification clark labs 2018 a typical mlp network contains one input layer one output layer and one or more hidden layers each layer contains nodes or neurons and is connected by lines indicating unequal connecting weights the hidden layer nodes are critical in use of interaction effects to the functioning of mlp research indicates that a 3 layered mlp network can approximate any polynomial function and is capable of solving very complex regression and classification problems clark labs 2018 to determine mlp s prediction accuracy the expected accuracy rate is assigned as a function of the number of transitions being modeled along with the number of persistence classes as follows clark labs 2018 3 e a 1 t p where e a expected accuracy t the number of transitions in the submodel p the number of persistence classes the number of from classes in the sub model a measure of model skill prediction accuracy is then expressed as 4 q a e a 1 e a where a measured accuracy e a expected accuracy this measure varies from 1 to 1 with a skill of 0 indicating random chance the mlp algorithm was used with natural log transformation for distance based variables and the evidence likelihood method was used to transform categorical factors selection of the distance based variables was based upon the fact that these variables are representatives of important parameters for physical biological and socio economic environments and have been found important for lulc change modeling studies guan et al 2011 sang et al 2011 arsanjani et al 2013 sakieh et al 2015 nasiri et al 2018 mlp model was developed and transition potential maps were generated by quantifying the relative importance of each variable to the land use change process transition potential maps from mlp represent the potential of a given category for transformation to another lulc type the lulc change process was predicted up to the year 2040 2 3 2 1 3 spatial logistic regression to estimate land use conversion probabilities driving factors of land use conversion were estimated to examine the probability of land use conversion during the period 1986 2012 as per suggested in arbab et al 2016 to examine the change in spatial residential land use patterns a spatial logistic regression analysis was developed to estimate the influence of driving factors on spatial land use trends logistic regression offers the functionality to incorporate binary dependent variables as a presence or absence of occurrence and suitability for discrete categorical or continuous explanatory variables atkinson and massari 1998 lee 2005 the empirically estimated relationship between the conversions of residential development and the driving factors can be expressed as the following logistic functional form 5 p y 1 x exp β x 1 exp β x where p y 1 x is the predicted probability value of the binary or dichotomous dependent variable y where y 1 means if a cell in raster map changes from a non residential land use in 1986 to residential land use in 2012 and y 0 otherwise this logistic function has linear probability in a set of parameters by having the range of probability between zero and one the following linear logit transformation on both sides of eq 5 was used to estimate the β coefficients menard 1995 6 y l o g i t p l n p k 1 p k β 0 β 1 x 1 k β 2 x 2 k β 3 x 3 k β 4 x 4 k β 5 x 5 k β 6 x 6 k y is the probability that the dependent variable y is 1 p k is the predicted probability of the kth pixel of agricultural or forest land use conversion to residential land β 0 is the intercept and β 1 β 2 β 3 β 4 β 5 a n d β 6 are coefficients for distance to the existing agriculture x1 distance to the existing forests x2 distance to the existing residential areas x3 distance to streams x4 distance to major highways x5 and distance to trains stations x6 respectively these coefficients measure the influence of each independent variable on the variations in probability of land use conversion from non residential land use to residential land use y 2 3 2 1 4 validation agent based model to examine more carefully how we did with the specific task of predicting change to land use conversion we used a three way cross tabulation between the later land cover map the prediction map and the map of reality to evaluate this we calculated the roc statistic also known as the area under the receiver operating characteristic curve or auc this measure was used to determine how well a continuous surface predicted the locations given the distribution of a boolean variable we selected the model parameters to be used for abm empirical parametrization upon roc values this model was designed to simulate land use decisions of agricultural and forest land owners to convert undeveloped land to residential land and implemented in python programming language the agents conversion decisions varied with the spatial distances from each neighboring land use over a period of 10 iterations to roughly approximate a 10 year time period where each iteration was assumed to be a conversion event possibility by modifying an approach from benenson and torrens 2004 each parcel agent s probability of conversion from developable state m to residential state r in each iteration was modeled as 7 pr o b i s m s t s n i where n i represented parcel agent i s neighbors and s represented state of parcel i the model used a monte carlo process hagerstrand 1965 wu 2002 for generating a stochastic abm model to account uncertainty a probability function was implemented to condition the residential conversions utilizing a random number generator batty 2012 arbab 2014 for undeveloped parcels the conversion decision was based upon a comparison between the random number generated and the probability value for each parcel the random number generator rand φi had a random distribution that was uniform between 0 and 1 the parcel agents adopted the following rule of land use conversion in each iteration if rand φ i p it then a it 1 r where r represented the land use class of residential development p was the probability of conversion to residential development for each parcel i a was the conversion event and t was iteration agents first assessed the parcel by comparing the probability with a random number if the value of probability was higher than the random number the agent converted the parcel into a residentially developed parcel if not then the parcel remained in its current non developed state the model with better roc values was used to calibrate projections of residential land use conversions in abm model the abm modelling landscape consisted of property parcels a decision making unit for residential developers the model assumed a market where developable properties were available for residential developers and selection and conversion of property parcels were inherently based upon the proximity based criteria of neighboring features the abm model did not allow developers to build on protected and preserved forest or agricultural lands fig 2 the parameter value of driving factors determined the emergent output of the abm model for example positive sign of a parameter showed that high value of proximity leads to high conversion and negative parameter sign showed inverse relationship between proximity and conversion 2 3 2 2 model input data 2 3 2 2 1 land use land use data was extracted from the njdep for the years 1986 and 2012 to analyze the change from 1986 to 2012 the njdep land use data was further categorized into six broader categories such as urban forest wetlands agricultural land water and barren land the raster files were created in arcgis 10 3 1 using euclidian distance tool for distance to agricultural lands distance to forest and distance to residential lands 2 3 2 2 2 distance to streams the digital hydrography stream network was derived from njdep data 2 3 2 2 3 distance to highways the data consisted of major highways including interstates u s highways state highways and major roads this dataset was obtained from the census 2000 generally road features do not change over long periods of time therefore this data was found suitable for our analysis 2 3 2 2 4 distance to train stations the data on transportation was extracted from new jersey department of transportation njdot for creating the raster file on distance to trains stations 2 3 3 data analysis framework different swat model outputs including temperature precipitation snowfall surface runoff streamflow water yield groundwater lateral flow evapotranspiration soil water percolation and sediment yield and sediment load were extracted from various scenarios base period historical rcp 4 5 historical rcp 8 5 future rcp 4 5 and future rcp 8 5 these data were processed using arcgis environment matlab r platform and microsoft excel based on the requirements for better visualization and easy understanding 3 results and discussion 3 1 swat model calibration validation and uncertainty analysis based on the previous three studies in the same watershed qiu and wang 2014 giri et al 2016a giri et al 2018 as well as using swat cup abbaspour et al 2007 and its sufi 2 algorithm abbaspour et al 2004 we found curve number soil evaporation compensation factor hydraulic conductivity in the main channel maximum canopy storage base flow alpha factor deep aquifer percolation fraction surface runoff lag coefficient groundwater delay time groundwater revap coefficient available water capacity of the soil layer manning s n for overland flow manning s n for main channel threshold depth of shallow aquifer threshold depth for revap snowmelt base temperature and snowpack temperature lag factor are the most sensitive parameters for streamflow the most sensitive parameters for sediment are exponent parameter for channel sediment routing linear parameter for channel sediment routing channel erodibility factor channel cover factor and universal soil loss equation support practice factor the final values of the calibrated parameters for streamflow and sediment are presented in the table s4 of supplementary material the model accuracy for streamflow is categorized as very good based on the guideline developed by moriasi et al 2007 due to nse 0 76 pbias 9 52 and rsr 0 49 for overall period table 2 the hydrograph between observed and simulated streamflow shows a very good agreement between the two in the watershed fig 4 however the model underestimates the peak flow slightly which may be attributed to flashiness of stormwater runoff in the watershed a similar results of flashiness was also observed among the three previous studies in the watershed by qiu and wang 2014 giri et al 2016a giri et al 2018 this flashiness may be attributed due to inability of swat model to incorporate different stormwater infrastructure including detention basins swale ditch segments detention basin inflows discharge pipe and outfalls the model evaluation parameters for sediment suggests that swat model performance is satisfactory in predicting the sediment load in the watershed table 2 the time series of observed and simulated sediment load in the watershed is presented in the supplementary material fig s2 which suggests that the overall prediction of sediment load by swat model agrees with observed sediment load with exception of few under predicted peaks this trend may be due to the swat model s inability to capture the flashiness of the streamflow the primary source of uncertainty in climate change studies comes from the projected climate data molina navarro et al 2018 trolle et al 2015 jensen and veihe 2009 therefore we undertook an uncertainty analysis by comparing the predicted monthly streamflow from 1990 to 2015 of individual gcm from rcp 4 5 and 8 5 emission scenarios against the observed streamflow data at usgs gauging station fig 1 in the watershed the average 26 years monthly streamflow shows reasonable agreement between observed versus individual gcm fig 5 in fact the streamflow between observed and ensemble mean depicts higher agreement furthermore performance statistics including nse pbias and rsr between observed and ensemble mean streamflow table s5 supplementary material shows satisfactory based on the guideline developed by moriasi et al 2007 in general a v shape trend was observed for streamflow throughout the year where one end of the vertex is represented by streamflow at the month of january while the other end of the vertex shows the streamflow during the month of december the vertex represented at streamflow during month of july additionally ncdc simulated streamflow was plotted with observed and ensemble mean which depicts closer trends of streamflow with observed compared to ensemble mean fig 5 in general individual gcms as well as the ensemble mean of streamflow over predicts the observed streamflow especially during summer and fall seasons a similar trend was observed between individual gcm as well as ensemble mean versus observed streamflow for rcp 8 5 emission scenario fig s3 supplementary material in order to determine the significant differences between average monthly streamflow from individual gcm as well as ensemble mean versus observed streamflow from 1990 to 2015 a paired two sample t test between individual gcm ensemble mean versus observed streamflow for mean was conducted in r platform monthly average streamflow under rcp 4 5 emission scenario from individual gcms except canesm2 shows an insignificant difference with observed streamflow at least 1 percent level of significance table 3 furthermore the ensemble mean streamflow also depicts insignificant difference with observed streamflow a similar result was also observed under rcp 8 5 emission scenario table s6 supplementary material due to presence of significant difference in average monthly streamflow between canesm2 versus observed streamflow under both rcp 4 5 and 8 5 scenarios the canesm2 was not included while calculating the ensemble mean during rcp 4 5 and 8 5 emission scenarios from 2020 to 2045 consequently the results of each components in the hydrological cycle as well as sediment transport in the future scenarios i e 2020 to 2045 was calculated based on ensemble mean of all the individual gcms except canesm2 the performance of individual gcms except canesm2 is more likely to perform better in the future condition compared to the canesm2 which already performed poor during current condition 1990 to 2015 teutschbein and seibert 2012 3 2 land use conversion based on agent based probabilistic and transition potential model the land use conversion model results showed that slr had a higher roc value than the other two land use prediction modeling techniques table 4 the parameter values were calibrated through spatial logistic regression and incorporated into agents land use conversion decisions the β x function representing conversion event is calculated using the following equation 9 β x 1 288 0 0015 agric dist 0 0008 forest dist 0 0013 resid dist 0 0007 s t r e a m dist 0 0002 h i g h w a y dist 0 00005 t r a i n dist the slr β x function coefficients suggest that new residential conversions were not positively associated with proximity i e the inverse of distance from to existing residential lands forests or streams conversely proximity to agricultural lands highway and train stations associated with residential conversions compared to mlp and simweight the slr based abm model resulted in a significantly larger area converted to urban land table 5 the different outcomes between machine learning methods and regression based abm is likely due to the difference in the underlying construction of the land conversion models the mlp and simweight models are based on a grid cell geometry while the slr abm is based on polygonal parcels i e the entire ownership parcel may convert at a single time step while all three models displayed a preference for the conversion of agricultural land to urban land uses the abm converts a significantly higher amount of land overall table 5 and fig 6 the abm is more similar to a build out model where all available agricultural land that isn t protected as preserved farmland and forest land that isn t protected by regulation is converted based on the higher roc value as well as the larger amount of land use area predicted to convert by 2040 the abm results were used for land use change scenario as well as combined climate and land use change analysis 3 3 potential effect of climate change on components of hydrological cycle the future temperature projection in the nrw showed an increasing trend compared to base period fig 7 a the average annual temperature increased from 9 4 c to 12 5 c and 12 7 c displaying a 33 3 and 35 7 increase compared to base period under rcp 4 5 and 8 5 scenarios respectively the annual temperature cycle showed a clear increasing trend in average monthly mean temperature compared to base period throughout the year the seasonal analysis of different components of hydrological cycle and temperature shows the of increase decrease in each parameters compared to base period table 6 the seasonal analysis of temperature depicted the highest increase in temperature compared to base period 178 8 and 201 9 for rcp 4 5 and 8 5 respectively to occur during winter while the least rise 16 8 and 17 9 for rcp 4 5 and 8 5 respectively was during summer both annual and seasonal analysis demonstrated overall warming of the watershed with higher temperature under rcp 4 5 and 8 5 scenarios compared to base period the future precipitation projection in the nrw showed a slight decreasing trend compared to base period fig 7 b overall the average annual precipitation in the nrw decreased from 107 57 mm to 102 95 mm and 103 79 mm representing a 4 3 and 3 5 decrease compared to base period under rcp 4 5 and 8 5 scenarios respectively the annual precipitation cycle remained unchanged from january to may while a shift in precipitation cycle was observed from june to december the most notable differences were a shift of precipitation peak from june to august accompanied by a sharp decline in precipitation until october the seasonal analysis of precipitation depicted the highest reduction in precipitation 7 48 and 7 73 for rcp 4 5 and 8 5 respectively during fall while the least reduction in spring season 1 22 and 0 56 for rcp 4 5 and 8 5 respectively shifting of this precipitation pattern accompanied with rising temperature may increase the risk of drought flooding and water quality degradation in the watershed mishra and liu 2014 wu et al 2012b the findings of increasing temperature and lesser precipitation in the future projected scenarios is consistent with the results of other researchers including paul et al 2017 neupane and kumar 2015 and jha et al 2007 in response to an increased temperature and reduced precipitation in the watershed the snowfall decreased throughout the year for the future climate change under both rcp 4 5 and 8 5 scenarios compared to base period fig 7c the average annual snowfall reduced from 12 70 mm to 6 40 mm and 5 96 mm which depicts a decrease in nearly 50 and 53 compared to base period under rcp 4 5 and 8 5 scenarios respectively as a result of decrease in snowfall and precipitation for future climate change scenarios under rcp 4 5 and 8 5 compared to base period a decline in surface runoff was observed during most months except for august and november fig 7 d the increased surface runoff during these two months was due to higher precipitation in both rcps compared to base period fig 7b the mean annual surface runoff decreased from 29 60 mm base period to 22 32 mm rcp 4 5 and 8 5 which represents a 24 40 reduction a similar reduction in surface runoff was observed by culbertson et al 2016 in maumee river watershed in ohio united states under rcp 4 5 and 8 5 scenarios the seasonal analysis indicates that the maximum surface runoff reduction was observed during summer while the minimum reduction was found during fall table 6 despite lower precipitation higher streamflow was observed in the watershed for both climate change rcp scenarios compared to base period fig 7 e due to higher yield fig 7 f the higher yield was contributed by higher groundwater fig 7 g and lateral flow fig 7 h in both rcps compared to base period the higher groundwater and lateral flow may be due to increase in infiltration capacity of soil due to increase in air temperature in future climate change increasing air temperature leads to frost free soil in most of the year which increases soil temperature the resultant impact increases soil pore water holding capacity leading to higher soil hydraulic conductivity which results into higher infiltration and less surface runoff pradhan et al 2019 stähli et al 1999 dunne and black 1971 a similar result was also observed in the future climate change scenario by culbertson et al 2016 in the maumee river watershed ohio additionally pervez and henebry 2015 found the increasing trend of lateral flow under climate change in the brahmaputra river basin in south asia the average annual streamflow increased from 2 21 m3 sec base line to 2 92 m3 sec and 2 93 m3 sec rcp 4 5 and rcp 8 5 respectively which represents an increase in streamflow of approximately 32 in both rcps compared to base period the streamflow was correlated with water yield from both rcps in the watershed the annual water yield was 40 65 mm for the base period while it was 53 67 mm and 53 76 mm for rcp 4 5 and rcp 8 5 respectively this indicates an approximately 32 increase in water yield in both rcps compared to base period a negligible difference in results between both rcps may be due to consideration of future climate change in the near term 2020 2045 in this study the increase in streamflow and water yield in both rcps were consistent which was evident from the result a 32 increase in streamflow due to water yield may potentially elevate the flooding risk in the watershed similar to the average annual streamflow and water yield similar seasonal trends were observed between the two where maximum increase was found during fall and the minimum increase was noticed during winter table 6 a higher groundwater was predicted throughout the year for both rcps compared to base period fig 7 g in fact an average increase in more than 200 of groundwater was predicted for climate change under both rcps compared to base period this result may be due to substantial reduction in snowfall in the watershed which resulted in reduction of surface runoff events during winter and spring while facilitating infiltration furthermore increasing projected temperature increases soil temperature leading to higher infiltration during the winter months culbertson et al 2016 this indicates the critical role of groundwater towards streamflow in the watershed especially during low flow condition summer season however a detail analysis of groundwater components in the watershed is required to assure the contribution of groundwater to streamflow a similar increasing trend of groundwater was observed due to climate change in the batsto river watershed located in the southern new jersey daraio 2017 similar to groundwater an increasing trend of lateral flow was predicted throughout the year fig 7 h approximately more than 95 increase in average annual lateral flow was predicted in both rcps compared to base period the seasonal analysis suggests that the maximum increase in lateral flow was during fall while the minimum increase was during winter table 6 daraio 2017 observed increased streamflow due to climate change in the maurice river watershed and batsto river watershed located in the southern new jersey similarly wagena and easton 2018 reported an increase of streamflow in the range of 4 5 9 in the susquehanna river basin located in chesapeake bay due to climate change additionally hayhoe et al 2013 found a positive shift in streamflow by 5 10 in the river basins located in the northeast united states as a result of climate change furthermore ahiablame et al 2017 predicted the increase in streamflow between 8 and 48 by midcentury in the james river watershed located in north and south dakota united states additionally increase in streamflow was projected by other researchers due to future climate change including shrestha and wang 2017 wagena et al 2016 and pervez and henebry 2015 in different parts of the world the evapotranspiration was projected to decrease substantially throughout the year due to climate change fig 7 i the average 12 month annual evapotranspiration was approximately 65 mm and 48 mm for base period and climate change rcps respectively this indicates that the evapotranspiration was projected to decrease by at least 25 in both rcps compared to base period the reduction in evapotranspiration was primarily be due to lower future precipitation neupane and kumar 2015 kim et al 2013 and this decreased evapotranspiration could have increased soil water and percolation fig 7 j and k in the watershed for climate change under both rcps the seasonal analysis depicts that the projected evapotranspiration was least during winter while it was highest during summer in contrast to evapotranspiration the average annual soil water and percolation were projected to increase by more than 52 and 180 respectively in both rcps compared to base period the increase in soil water will reduce irrigation for different crop production in the watershed while increase in percolation will increase the groundwater recharge and ultimately increases streamflow paul et al 2017 and neupane and kumar 2015 also found increased in soil water content and percolation and decrease in evapotranspiration in their climate change studies in different watersheds in the united states additionally the long term monthly as well as seasonal trends of precipitation streamflow and sediment transport during the base period 1991 2015 in the nrw is presented in section 3 2 of the supplementary material 3 4 consequence of climate change on sediment generation and sediment load in the watershed to assess the impact of climate change on sediment production at subbasin level syld of output sub file was used which depicts the weighted average of sediment from all hrus within each subbasin before channel routing in the base period condition greater sediment yield was observed at southeast edge of the watershed while lowersediment yield was found at north central side of the watershed fig 8 a under rcp 4 5 the majority of subbasins were predicted to have reduced sediment yield fig 8b the spatial pattern of sediment generation reduction under rcp 8 5 was similar to rcp 4 5 except slightly more sediment generation subbasins were predicted fig 8c as might be expected the spatial distribution of sediment yield among the subbasins was primarily dependent on topographic elevation of the watershed for example the higher sediment yield was predicted at the southeast as well as northwest subbasins in the watershed having steeper slopes compared to other parts figs 1 and 8 b in contrast negative sediment generation was forecasted in most of the subbasins located in the center of the watershed having lesser topographic elevation additionally most of the subbasins generating higher sediment yield also displayed increasing surface runoff under the climate change scenarios compared to base period fig s6 supplementary material shrestha and wang 2018 also found highest sediment generation in subbasins having steepest topography compared to other parts of the watershed using swat model during climate change study in canada however when sediment load was compared at the watershed outlet after considering channel routing a slight increase in sediment load more than 10 compared to base period was observed for both rcps in climate change scenario fig 9 this increase can be attributed to greater channel and stream bed erosion due to higher streamflow approximately 32 in the climate change scenarios compared to the base period our findings are corroborated by the outcomes of previous study in the same watershed by qiu and wang 2014 they found that streams are the primary sources of sediment compared to different land uses contributing nearly 60 of the sediment load in the watershed furthermore the monthly as well as seasonal trends between streamflow and sediment load during the base period 1991 2015 shows that the streamflow is the primary driver of sediment generation in the river fig s5 supplementary material when both rcps were compared rcp 8 5 produced slightly more sediment load compared to rcp 4 5 which may be due to greater numbers of sediment generation subbasins in rcp 8 5 compared to rcp 4 5 fig 8 b and c overall the climate change scenarios suggest increasing sediment load in the streams fig 9 which may adversely affect the health of aquatic ecosystems wagena and easton 2018 also found an increasing trend of annual sediment load ranging from 26 to 31 in the susquehanna river basin located in chesapeake bay due to climate change apart from sediment load primary components of hydrologic cycle due to climate change only scenario compared to base period is also found from fig 9 3 5 potential effect of land use change on components of hydrological cycles and sediment load the land use change only based on abm 2040 scenario projects an increase of 24 in urban land area leading to an increase in surface runoff 4 fig 10 despite the increased surface runoff a reduction in streamflow and water yield approximately 5 was forecastdue to reduction in both groundwater by 39 and lateral flow 18 this indicates the importance of subsurface flow in the watershed the reduction in groundwater and lateral flow in the land use change scenario compared to base period was due to increase in impervious surface as a result of increased residential areas a previous study of giri et al 2018 conducted in the same watershed where they forecasted water security based on projected land use of 2022 and found a similar result of increasing surface runoff and decreasing soil moisture pattern compared to base period due to lesser infiltration as a result of urbanization the evapotranspiration was projected to decline due to conversion of a significant area of the agricultural lands and forest into residential area even though additional lawns in the new residential areas were taken into account while estimating evapotranspiration a similar decreasing trend of evapotranspiration was observed compared to base period due to conversion of agricultural lands and forest into residential areas in the same watershed for land use projected scenario of 2022 giri et al 2018 additionally a reduction in percolation was observed in the land use change scenario compared to base period finally approximately 42 reduction in sediment load was predicted in the land use change scenario compared to base period due to conversion of 2 785 ha agricultural lands table 5 into residential areas in the land use change scenario 3 6 potential effect of combined climate and land use change on components of hydrological cycles and sediment load the trends of different components of hydrological cycles and sediment load for the combined climate and land use change scenario are similar to the trends found in the climate change only scenario when each components were compared among two emission scenarios rcp 4 5 and rcp 8 5 a negligible difference was observed between the two emission scenarios the surface runoff in the combined climate and land use change scenario was projected to decrease around 4 compared to base period fig 11 despite increased impervious surface through increased residential area lesser runoff was predicted due to lower projected precipitation in the combined climate and land use change scenario compared to base period this indicates that climate i e reduced precipitation has greater contribution on hydrologic process compared to land use despite lower surface runoff higher streamflow and water yield 36 was predicted in the combined climate and land use change scenario due to higher increase in groundwater lateral flow and percolation evapotranspiration was projected to decrease approximately 24 under combined climate and land use change scenario compared to base period this result was due to conversion of agricultural land and forest into residential area combined with lesser precipitation finally the sediment load in the watershed was predicted to decrease roughly 30 in the combined climate and land use scenario compared to base period which was due to conversion of most of the agricultural lands towards urban land plus lesser surface runoff the reduction of sediment in this scenario was lower compared to land use change alone due to offset of sediment reduction by climate change in the coupled climate and land use change scenario 3 7 summary of results across all three scenarios a composite summary of primary components of three scenarios compared to base period is presented in table 7 the ensemble gcm predicts warmer temperatures and declining snowfall and precipitation amounts leading to a projected decrease in surface runoff as modeled in swat in climate change only scenario conversely an increasing surface runoff trend was predicted for the land use change scenario due to an increase in impervious surface area when modeled in composite the increased impervious surface from new urban lands was compensated for by the reduction in surface runoff in the climate change scenario streamflow and water yield are predicted to increase in the future despite decreased precipitation and surface runoff due to an increase in percolation and lateral flow compared to base period in both climate change alone as well as combined climate and land use change scenario these results suggest the importance of sub surface flow in the watershed similar relationships of streamflow versus surface runoff and subsurface flow were observed by culbertson et al 2016 and neupane and kumar 2015 in climate change study in ohio and south dakota watersheds respectively the projected sediment load was slightly greater in climate change only scenario compared to the base period which may be attributed to channel erosion due to increase in streamflow however an opposite trend of decreasing sediment load was predicted in both land use change only as well as combined climate and land use change scenario likely due to the extensive conversion of agricultural lands into residential areas 4 conclusions understanding the standalone as well as combined effects of climate change and land use transformation are needed to formulate better water resource management and adaptation strategies in a changing environment the integrated modeling framework we have developed facilitates the assessment of the potential impact of climate and land use change either in isolation or in composite on different components of hydrological cycle and sediment loading we suggest that streamflow and sediment load serve as suitable metrics for assessing watershed resilience whether due to changing climate or land use our results predict the changing climate will have a larger effect on the hydrologic cycle than intensifying urban land uses in our study watershed the coupled hydrologic land use change modeling suggests increasing urbanization will result in lower streamflow the climate change scenarios either alone or in composite with land use change predict higher streamflow overriding the effect of land use changes in our study watershed higher levels of streamflow will likely exacerbate existing flooding issues and thereby serve to lower watershed resiliency conversely the climate and land use change scenarios predict opposite effects on sediment load with the climate change increasing sediment loading to the study watershed when modelled in composite the effect of changing land use in this case the conversion of erodible agricultural fields to suburban development overrides the adverse effect of climate change enhancing watershed resiliency by reducing sediment load and thereby improving health of the downstream aquatic ecosystems the integrated modeling framework we have developed is transferable to other watersheds providing practitioners a more effective way to examine the implications of land use and climate change either alone or in composite acknowledgements the research was supported by the johnson family chair in water resources watershed ecology and the sustainable raritan river initiative at rutgers university we gratefully acknowledge the world climate research programme s working group on coupled modeling and we also gratefully thank the climate modeling groups listed in table s1 for producing and making available their model out for cmip the u s department of energy s program for cli mate model diagnosis and intercomparison provides coordinating support and led development of software infrastructure in partnership with the global organization for earth system science portals additionally we would like to thank mr srinivas gaddam for helping in making some figures for this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123955 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6223,dams and reservoirs provide decision makers and managers with appropriate control on the available water resources allowing the implementation of various strategies for the most efficient usage of the available water resources in areas where water supply exhibits significant temporal variation when compared with the demand the challenge is to bridge the gap and achieve an optimal match between the water supply and demand patterns therefore the release of water from reservoirs should be controlled to ensure that the operation rule for the available water storage in the reservoir is optimized to satisfy the future water demands this level of optimal control can only be achieved using an efficient optimization algorithm to optimally derive the operation rule for such a complex water system herein two main methods have been considered to tackle this water resource management problem first three different optimization algorithms namely particle swarm optimization differential evolution and whale optimization algorithm have been applied in addition two different optimization algorithms namely crow search algorithm and master slave algorithm have been introduced to generate an optimal rule for water release policy further the proposed optimization algorithms have been applied to one of the most critical dam and reservoir water systems namely the aswan high dam ahd which controls almost 95 of egypt s water resources the current operation of ahd using the existing optimization rules resulted in a mismatch between the water supply and water demand in other words the water availability could be higher than the water demand during a certain period whereas it could be less than the water demand during another period the results denoted that the master slave algorithm outperforms the remaining algorithms and generates an optimization rule that minimizes the mismatch between the water supply and water demand keywords dam and reservoir operation optimization algorithm aswan high dam crow search algorithm master slave algorithm 1 introduction 1 1 background the identification management and development of the optimal operation policy for dams and reservoirs have extended over the previous few decades using several types of models the dam and reservoir water system has experienced uncertainties with respect to its system variables within the environment and engineering applications for example the hydrological parameters such as the inflow of a reservoir are stochastic therefore the minimization of the gap between water supply water that can be released from a dam and water demand is uncertain in addition the future unknown events associated with reservoir s inflow should be completely realized to generate an optimal water release policy majority of the current optimization models exhibit a tendency to deal with these uncertainties via inadequate modeling to clearly distinguish the full range and horizon of the likely consequences for any uncertain variable in the system environment in this context the existing modeling ability should be improved to obtain the perfect definition of the real consequences of the required output i e the optimal water release policy however specific knowledge about the possible consequences of a release decision is lost within the translation of the full spectrum of consequences to a surrogate and summative metric the extreme of the existing models procedures can be presented when operation policies are generated from some of the existing optimization models completely based on simply switching the stochastic variables to deterministic variables totally ignoring the essential feature of the dam and reservoir water system for example the existing reservoir optimization model has been basically developed by considering that the reservoir s inflow and evaporation losses are deterministic variables rather than stochastic variables and is represented using the markov process these operation policies generated based on a completely deterministic procedure are not explicitly acknowledged by the surrogate metric definition of the optimal release policy and therefore are not recognized as a valid characteristic feature of this optimal release policy in addition the dam and reservoir water system exhibits highly nonlinear characteristics that appear in the storage surface area elevation relation which should be accurately considered while simulating the reservoir status denoting a particular water release decision therefore an optimization method and algorithm should be established for such a complex system with stochastic nature and nonlinear characteristics majority of the recent studies have presented the successful application of a metaheuristic and evolutionary algorithm for solving the reservoir operation problem evolutionary algorithms have become popular among the metaheuristic society because of their recognizable success in solving high dimensional complex problems in various fields ranging from biomedical engineering poongothai et al 2017 to heat exchanger design xie et al 2008 further the evolutionary algorithms are initialized with a random population of individuals defined in the prescribed solution boundaries and the optimal results are iterated using an algorithm specific solution scheme until the termination criterion is satisfied or the predefined maximum number of iteration is achieved some of the prevalent evolutionary optimization methods include differential evolution storn 1997 genetic algorithm reeves and rowe 2006 and evolutionary strategy beyer 1994 similar to the evolutionary algorithms the swarm based optimization methods begin with a set of randomly selected population individuals and new candidate solutions are created based on historical knowledge or some information related to the inclinations and tendencies of the population individuals particle swarm optimization kennedy and eberhart 1995 artificial bee colony algorithm karaboga 2005 ant colony algorithm dorigo and gambardella 1997 and crow search algorithm crow askarzadeh 2016 are some of the most prominent swarm intelligence optimization methods the artificial intelligence based solution strategies have been frequently nominated by hydrology researchers for performing accurate numerical modeling of reservoir inflow and evaporation prediction for the previous two decades several data driven and artificial intelligence ai methods have been developed to overcome the stochastic characteristics and dynamic nature of the collected hydrological information these intelligent models consider various types of nature inspired optimization algorithms statistical learning methods and classification methods luger 2005 however this study mainly focuses on the application of the stochastic nature inspired optimization algorithms to the optimization of reservoir operations a brief literature survey indicates that the proposed methodologies deployed for optimal reservoir operation to ensure water management are categorized into two main branches the first branch includes the applications of traditional approaches such as linear programming lp chow and cortez rivera 1974 revelle et al 1969 dynamic programming dp murray and yakowit 1979 mousavi et al 2005 and stochastic dynamic programming sdp soleimani et al 2016 however the inherent incapability of the aforementioned classical approaches in solving high dimensional stochastic design problems limits their utilization to water management systems and paves the way for searching alternative options such as metaheuristic algorithms considerable developments have emerged with respect to the advancement of metaheuristic algorithms after rapid improvements in microchip technologies maier et al 2014 introduced a comprehensive investigation about the future trends and main challenges associated with the stochastic based optimization algorithms applied to reservoir operations and provided informative insights on several design related subject fields ranging from understanding the theoretical frameworks of evolutionary algorithms to the development of accurate objective functions in reservoir operation systems genetic algorithm ga goldberg 1989 is one of the pioneers of the evolutionary metaheuristic algorithms and is inspired by the natural selection and darwinian evolution strategies this algorithm simultaneously considers genetic operators and the survival of the fittest principle to obtain the global optimum answer to the problem within the search space this algorithm has been frequently utilized by hydrology researchers with respect to the water resource planning and management problems esat and hall 1994 used ga to obtain optimum reservoir operation for hydropower applications and water irrigation ahmed and sarma 2005 presented a ga based solution strategy to optimize the operation of a multi purpose reservoir chang and chang 2001 hybridized the ga and adaptive network based fuzzy inference system to minimize the water deficit during the real time operation of the shihmen reservoir in taiwan further chang et al 2003 applied ga to estimate the optimal flushing operation rule curves at the tapu reservoir by combining the sediment flushing and reservoir simulation models li and we 2008 proposed a hybrid learning model by combining the perturbation equations of ga and simulated annealing to overcome the premature convergence drawback of ga and to eliminate the unfeasible regions in the search space the proposed method was applied to the multi reservoir system at the wujiang river to improve the hydropower generation output over a predefined operating time period chen et al 2007 proposed macro evolutionary multi objective ga to not only avoid the troublesome premature convergence drawback of classical ga but also enhance the exploration capabilities of the algorithm by diversifying the solution span as much as possible this improved algorithm was subsequently applied to predict the optimal rule curves of the multi reservoir system in taiwan chang et al 2010 developed the constrained ga to derive an efficient and robust decision making procedure for reservoir operations further the predictive performance of the algorithm was validated by optimizing the long term downstream water demands of the shih men reservoir the applications of swarm based metaheuristic algorithms on reservoir operation systems have drawn considerable attention from researchers because of their effectivity in solving multidimensional engineering design problems the particle swarm optimization pso kennedy and eberhart 1995 and artificial bee colony abc karaboga 2005 algorithms have been the most considered optimizers for the optimal reservoir operation problems among the several swarm intelligence algorithms available in the literature for instance reddy and nagesh kumar 2007 presented a multi objective pso algorithm assisted with an elitist mutation scheme for generating non dominated pareto solutions for the optimal reservoir operation problems the predictive performance of the proposed approach was subsequently benchmarked on the multi objective optimal operation of the bhadra reservoir in india pso was applied to the mixed integer multi objective capacity optimization of the hydropower generation from the bakhtiari dam operation system to satisfy the conflicting design objectives mousavi and shourian 2010 the results proved the efficacy of the multi objective pso algorithm saberchenari et al 2016 adopted the pso algorithm for the optimal multi purpose operation of the mahabad dam in iran to minimize the water volume deficit between the expected demand and required release the optimization method was then applied in different climatic scenarios and the determined amount of water released by the pso algorithm was almost in good agreement with the expected demand hossain and el shafie 2014 suggested the usage of the abc algorithm as a favorable procedure to determine the optimal operation schedule of the aswan high dam ahd in egypt the optimization outcomes of the abc algorithm were benchmarked against those found by ga for model validation chen et al 2016 proposed an innovative abc based mathematical model for optimal irrigation scheduling of multiple crops the estimation capabilities of the abc and gravitational search algorithm gsa were assessed based on the optimal operation of the timah tasoh dam reservoir to amend the deficit between the water release and demand abc outperformed gsa with respect to the solution efficacy and exhibited its superiority in providing much better performance index values ahmed et al 2016 jalali et al 2007 developed a novel multi colony ant colony optimization aco algorithm to tackle the continuous multi reservoir operation optimization problem the authors specifically developed the proposed algorithm because the performance of the standard aco algorithm is rather poor the authors have concluded that the proposed algorithm provided acceptable and favorable outcomes zhang et al 2013 proposed parallel deterministic dynamic programming pddp and a hierarchical adaptive ga haga to solve the reservoir operation optimization problem the pddp method benefits the solution by the acceleration of the determination process in contrast the haga method effectively tackles the optimization problem by tuning the algorithm parameters and keeping an elite individual from the first hierarchy to the second hierarchy the authors concluded that the parallel implementation of these two methods provided more desirable results with less computation time than that obtained using the singular application of these two methods xu and mei 2018 proposed a modified water cycle algorithm based on the diversity evaluation and chaos theory to tackle the long term multi reservoir optimization problem in addition the authors have investigated the operation optimization of the yangtze river of china as a case study the results showed that the proposed algorithm provided more desirable outcomes with better convergence rates when compared with that of the other optimizers investigated in the study many recently emerged swarm intelligence metaheuristic algorithms have been applied to the reservoir operation systems the bat algorithm bozorg haddad et al 2015 weed optimization algorithm azizipour et al 2016 firefly optimization algorithm garousi nejad et al 2016 cuckoo search hosseini moghari et al 2015 and shark optimization algorithm ehteram et al 2017 ehteram et al 2017 are some of the prominent examples of applications that generate reliable policy rules during dam operations although their performance is quite satisfactory when compared with those of the traditional algorithms the swarm based optimization approaches experienced some difficulties in finding a global optimum answer to the problem resulting from their major drawbacks including premature convergence due to the insufficient diversification of the search domain and huge computational burden because of the extensive probing of the search space therefore this study aims to explore the advantages of using multi population metaheuristics to overcome the aforementioned deficiencies of the swarm intelligence algorithms the multi population optimization algorithms concurrently utilize more than one population to efficiently search the whole solution domain and to minimize the computational load by relying on their flexibility in embedding more than one algorithm in a single optimization framework this study proposes a master slave approach based multi population ensemble algorithm to optimize the reservoir operations the algorithm comprises population members of four different metaheuristic algorithms including pso differential evolution crow and whale optimization whale these four algorithms compete with each other based on the statistical results of the 30 optimization benchmark problems comprising unimodal and multimodal test functions the master algorithm is determined according to the averaged numerical results of the test functions and the remaining three algorithms assist the master algorithm by diversifying the candidate solutions further the master algorithm fine tunes the promising solutions retained for the slave population individuals a detailed description and explicit explanation of the proposed algorithm along with the fundamental characteristics of the multi population algorithms will be discussed in the upcoming sections 1 2 problem statement the effectiveness of any optimization algorithm is usually measured using the required computational time to achieve global optima and searching ability for the detection of global optima for some engineering applications such as the one presented in this research computational time is not an important indicator because the applications are not real time however the searching ability to detect global optima is an important indicator especially in case of an application that experienced highly nonlinear constraints and stochastic nature variables in the recent past innovative approaches with respect to the improvement of the optimization performance of the nature inspired metaheuristic algorithms have been implemented one of the most promising suggestions for enhancing the solution efficiency of any optimization method is dividing the main population into multiple subpopulations not only to increase the solution efficiency but also to enhance the diversification capacity of the algorithm burke et al 2013 this strategy is efficient in solving multidimensional large scale optimization problems researchers proposed the usage of different mutation schemes in case of different subpopulations to enhance the exploration capability of the algorithm the algorithm has also been suggested to be well tailored to the organization schemes that enable the subpopulations to communicate with each other and share their inherent knowledge and information through these highly devised learning mechanisms after sharing the historical information accumulated during the course of iterations different population members interact with each other by whether merging or exchanging the current information communication between subpopulation individuals increases the probability of avoiding premature convergence and maintaining the diversity of the main population while tackling complex real world design problems that are difficult to solve ahd is constructed at the south of egypt along the nile river which is the longest river in the world it is considered as one of the biggest dams in the world and has an upstream storage capacity of approximately 160 billion cubic meters bcm in lake nasser which is the biggest man made reservoir ahd is also the major control point for almost 95 of the available water resources on a national scale in egypt however because of the variation in temporal pattern between the water resources based on the inflow pattern in the nile river along with the year and the water demand pattern based on the agricultural industrial and domestic requirements there is a relatively large gap between the water availability for supply and water demands in this context there is a need to utilize a highly effective optimization algorithm whose searching ability could reflect the nonlinearity in the water system of ahd s constraints and the stochastic nature of the ahd s reservoir inflow achieving the optimal operation rule of the ahd 1 3 objectives the main objective of this study is to implement a multi population master slave algorithm master slave by utilizing various metaheuristic optimizers to generate an optimal operation rule for the dam and reservoir water system the proposed optimization algorithms have been applied to ahd which is considered as one of the most crucial case studies for operating dam and reservoir water system the performance of the generated operation rule based on each algorithm is examined using different performance indicators including reliability resilience and vulnerability to evaluate the success of the operation rule to minimize the gap between the water release policy and water demands in section 2 the introduction of the algorithms that form master slave and the implementation of master slave are presented in section 3 multi population algorithms of crow whale pso and differential evolution are benchmarked against their conventional counterparts and the proposed master slave section 4 is introduced to provide details about the proposed case study ahd further section 5 demonstrates the achieved results and discusses the generated operation rules by emphasizing the performance indicator values finally in section 6 the conclusion of the whole study is presented by focusing on the major observations with respect to the problem objectives 2 model formulation 2 1 framework and concept herein we propose the concurrent utilization of the perturbation equations of the crow askarzadeh 2016 whale mirjalili and lewis 2016 pso kennedy and eberhart 1995 and differential evolution de storn 1997 algorithms to construct an efficient multi population master slave exhibiting dexterous probing capabilities resulting in the maintenance of a better and proper balance between the exploration and exploitation phases of the algorithm at hand the main difference between the master slave and conventional hybrid optimizers such as the improved ga simulated algorithm iga sa presented in li and wei 2008 is that master slave utilizes the hierarchical relations between the master and slave algorithms to find a balance between exploration and exploitation however the conventional hybrid optimizers employ specific algorithms for performing specific tasks for example ga is utilized for performing the exploration task whereas the simulated annealing algorithm is used for the exploitation task in iga sa it is also worth mentioning that this study considers these four metaheuristics among plenty of alternatives because of their ease of implementation and relatively better convergence capabilities and solution effectiveness when compared with those of their literature counterparts the solution efficiency and quality of each of the aforementioned algorithms will be assessed and evaluated using a set of optimization benchmark functions comprising unimodal and multimodal test problems and the best performing optimizer among these four algorithms whose optimization performance can be obtained by averaging the quality of optimal results over the total number of optimization test functions is decided and considered to be the master population whereas the remaining three population members of the algorithms are selected as slave individuals furthermore different master slave population combinations of the algorithms are tested using the aforementioned unimodal and multimodal benchmark functions and the results proved the effectivity of the considered combination in the following section the fundamental characteristics of each algorithm that form the ensemble method will be briefly explained and their intrinsic learning schemes will be explicitly formulated 2 2 model components 2 2 1 particle swarm optimization pso is one of the most popular swarm intelligence algorithms and has drawn considerable interest from the metaheuristic community pso which was originally introduced by kennedy and eberhart 1995 aims to numerically imitate the social behaviors of birds and fishes in the pso algorithm each candidate solution of the optimization problem is represented by a particle in the swarm considering the d dimensional hyperspace two different vectors are initialized for each particle i 1 2 n further we present the position x x i 1 x i 2 x i d and velocity v v i 1 v i 2 v i d vectors of each particle in the swarm the algorithm is initialized by distributing the position and velocity vectors of each particle over the search domain two perturbation equations are utilized to update the position of each particle while taking advantage of the previous best knowledge pbest and the overall best experience gbest of the swarm individuals 1 v i j iter 1 v i j iter c 1 r a n d 0 1 1 p best j iter x i j iter c 2 r a n d 0 1 2 g best j iter x i j iter 2 x i j iter 1 x i j iter v i j iter 1 where c1 and c2 are the social and cognitive coefficients respectively rand 0 1 1 and rand 0 1 2 are two different uniformly distributed random numbers defined in the range poongothai et al 2017 and j represents the dimension of the particle in the swarm using eqs 1 and 2 the pso algorithm probes around the fertile and promising sites in the search space and adjusts its historical knowledge assisted trajectory to obtain a global optimum solution to the optimization problem the basic implementation of the pso algorithm is presented in fig a1 in appendix a 2 2 2 crow search algorithm askarzadeh 2016 proposed crow which is a novel metaheuristic optimizer developed based on the pilfering characteristics of intelligent crows crows have an intrinsic pilfering behavior such that every crow has food storage in its hiding place and some precautions are required to protect its food storage from other crows otherwise its food storage may be discovered and most probably be pilfered by the foraging crows this foraging behavior of crows can be mathematically converted into an optimization algorithm by applying the expressions presented in fig a2 in appendix a the algorithm is initialized by randomly determining the position of each crow i 1 2 n and each position represents a candidate solution x x i 1 x i 2 x i 3 the crow memory m m i 1 m i 2 m i d is populated with the initial position of the crows because they have no experience or knowledge about the hiding food resources crow i chooses a victim crow j from the swarm to discover and steal the food resources of crow j and chases crow j until it arrives at its hiding place another option of crow i is to find a random location available for foraging this pilfering behavior of the crows can be mathematically expressed using the following equation 3 x i iter 1 x i iter r a n d 0 1 1 i f l i iter m j iter x j iter r a n d 0 1 2 j a p j iter a random position in the search space otherwise where rand 0 1 1 and rand 0 1 2 are the gaussian random numbers defined to be between 0 0 and 1 0 a p j iter defines the awareness probability of crow j f l i iter represents the flight length of crow i and m j iter denotes the memory of crow j at iteration iter these newly generated solutions are subsequently evaluated based on their corresponding fitness value and the memory of each crow in the swarm is updated using the following expression 4 m i iter 1 x i iter 1 f x i iter 1 f m i iter m i iter otherwise where f is the functional value of the objective function 2 2 3 differential evolution de algorithm is an evolutionary metaheuristic algorithm initially coined by storn 1997 an explanatory and comprehensive description of the de algorithm can be found in literature pishchalnikov 2018 zheng et al 2017 wu et al 2018 the algorithm comprises three different phases including mutation crossover and selection the algorithm is initialized using randomly generated d dimensional parent population individuals x x i 1 x i 2 x i d i 1 2 n where n is the population size after the initialization of the population members within the prescribed boundaries the algorithm enters the mutation phase the mutation operation generates the mutant vector v based on the parent x population individuals under the control of the responsible mutation strategy some of the mutation equations extensively used in de algorithm are expressed as follows 5 de r a n d 1 v i iter x k 1 iter f x k 2 iter x k 3 iter 6 de b e s t 1 v i iter x best iter f x k 1 iter x k 2 iter 7 de c u r r e n t t o b e s t 1 v i iter x i iter f x best iter x i iter f x k 1 iter x k 2 iter 8 de r a n d 2 v i iter x k 1 iter f x k 2 iter x k 3 iter f x k 4 iter x k 5 iter 9 de b e s t 2 v i iter x best iter f x k 2 iter x k 3 iter f x k 4 iter x k 5 iter where k 1 k 2 k 3 k 4 k 5 i are the index values of the different population individuals randomly selected between 1 and n and these entire selected index values are different from the current running index i f is one of the control parameters of the de algorithm called scale factor and is defined in the range xie et al 2008 this algorithm parameter is responsible for weighing the difference between the randomly selected vectors xbest represents the best solution obtained during the course of iterations and the superscript iter denotes the current iteration after the completion of the mutation phase the algorithm enters the crossover phase to generate trial population individuals u i iter based on the numerical comparison between a uniformly distributed random number defined in poongothai et al 2017 and the crossover rate cr this procedure is called binomial crossover and can be mathematically expressed as follows 10 u i iter v i iter i f rand 0 1 j c r o r j j rand j 1 2 d x i iter otherwise where j rand is a random integer selected from the interval between 1 and d rand 0 1 j is the gaussian random number defined in the range poongothai et al 2017 for the jth member of the population and cr is another user defined algorithm specific control parameter produced in the range poongothai et al 2017 and controls the diversity of the population by deciding the number of transferred individuals from the mutant vector to the trial vector finally the selection phase is introduced to select the best individuals for the next generation the selection procedure can be simply expressed as follows 11 x i iter 1 u i iter if f u i iter f x i iter x i iter otherwise a basic pseudocode description of the de algorithm is presented in fig a3 in appendix a 2 2 4 whale optimization algorithm inspired by the intelligent foraging behaviors of the humpback whales whale optimization algorithm is a nature inspired metaheuristic algorithm developed by mirjalili and lewis 2016 the algorithm mainly comprises two different phases namely encircling prey individuals and bubble net attacking strategy these phases are briefly described below 2 2 4 1 encircling prey individuals humpback whales encircle their prey during the commencing of the hunting process as the iterations proceed to its maximum allowable number whales update their current positions toward the optimal search agents in this context the target prey individual is considered to be the best candidate solution the below given mathematical equation represents the encircling prey mechanism 12 x iter 1 x best iter a c x best iter x iter where x is the position vector and xbest is the best position vector obtained throughout the iterations iter denotes the current iteration number and a and c are the algorithm specific vectors formed by the random numbers and calculated as follows 13 a 2 a r a n d 0 1 1 a 14 c 2 r a n d 0 1 2 in the aforementioned equations rand 0 1 1 and rand 0 1 2 are uniformly distributed random numbers different from each other and the iteration dependent variable a linearly decreases from 2 0 to 0 0 2 2 4 2 bubble net attacking strategy bubble net attacking method contains two different approaches to accomplish the exploitation phase of the algorithm these procedures include the shrinking encircling and spiral updating position mechanisms which will be briefly introduced in this section the spiral updating position mechanism redesigns the current position of the whales using the following spiral equation 15 x iter e bl cos 2 π l x best iter x iter x best iter where b is a constant algorithm parameter responsible for determining the shape of the spiral equation and l is a random number defined in the range 1 1 while attacking prey individuals whales have two simultaneous options to trap and catch their prey they can either apply the shrinking encircling mechanism or utilize the spiral updating position mechanism to locate a new position in the solution space this decision making process can be modeled using the following equation 16 x iter 1 x best iter a x best iter x iter i f p 0 5 x best iter e bl cos 2 π l x best iter x iter i f p 0 5 where p is a random number lying in the range poongothai et al 2017 that determines the probability of encircling prey individuals the varying numerical values of a defined in eq 13 plays a vital role in the activation of the exploration phase of the algorithm during the exploration phase the position update of whales is maintained by the randomly selected search agents rather than by utilizing the best position obtained along with the iterations this mentioned global search mechanism can be activated if the random value of a is greater than 1 or smaller than 1 the mathematical expression of this model can be formulated as follows 17 x iter 1 x k iter a c x k iter x iter where k is a randomly chosen whale in the population defined in the range 1 n the pseudocode of the whale optimization algorithm is presented in fig a4 in appendix a 2 3 multi population master slave algorithm this study aims to propose an innovative optimization strategy constructed by the ensemble of four different metaheuristic optimizers including the pso crow de and whale algorithms the proposed ensemble method utilizes favorable merits of the master slave model approach which is very efficient in creating a sustainable synergy between different population members relying on its effective cooperative framework this model was extensively applied under the framework of four different metaheuristic algorithms including the bat algorithm jaddi et al 2015 bee swarm algorithm akbari and ziarati 2011 and pso zhan and zhang 2009 there are several slave populations and one master population in the master slave optimization mso approach the slave populations exchange the historical knowledge and accumulated information among them and send the feasible and promising candidate solutions to the master population the master population collects the domain information processed by each slave population evaluates the exchanged data based on its own concept and determines the global optimum solution from among the possible alternatives obtained from the slave populations finally all the master population members are nullified this algorithmic procedure repeats itself until the termination criterion is satisfied this iterative competition based learning mechanism is very capable to maintain an appropriate and plausible balance between the exploration and exploitation phases of the algorithm the exploration phase is very critical to any metaheuristic algorithm because the candidate solutions are diverse and spread over the search domain in this phase intensification in the most promising area of the search space during the exploitation phase which generally takes advantage of the usage of the current best solution obtained during the iterations to probe around these fertile areas to jump over the local optimum points and reach the global optimum solution by eliminating these trap solutions as quickly as possible 2 4 master algorithm selection the master slave approach proposed in this study is more complex dexterous and crafty when compared with its conventional counterparts the algorithmic structure of the proposed method is considerably complicated than the method in traditional literature because there is a challenging and exhaustive competition among four metaheuristic optimizers with such a prestigious aim to be the commanding algorithm in the hierarchy the optimization performance of the conventional metaheuristic algorithms of crow de pso and whale are assessed based on their corresponding solution accuracy and convergence speed to properly deduce the master and slave populations thirty different optimization benchmark problems comprising unimodal and multimodal test functions are solved using these four optimizers and the master algorithm is decided based on the evaluation of the averaged statistical results of these four algorithms as previously stated different master slave population combinations of algorithms are tested with the unimodal and multimodal benchmark test functions and the results proved the effectivity of the considered master slave combination 3 model benchmarking tables 1 and 2 report the statistical outcomes of the multimodal and unimodal test functions respectively obtained using four different conventional optimizers along with their multi population counterparts mcrow mde mpso and mwhale proposed master slave and the dual slave combinations of the proposed algorithm mcrowde mpsode and mpsocrow fifty algorithm runs along with 1000 function evaluations have been conducted to obtain the numerical results presented in tables 1 and 2 the optimization performance of master slave will be discussed later and this section mainly intends to evaluate the competitiveness and robustness of the four contender algorithms the convergence speed of the algorithms presented and compared in figs 1 6 is also another decisive parameter that directly influences the selection of the master algorithm the elapsed number of function evaluations is presented on the x axis and the best objective function value on a logarithmic scale is represented on the y axis in the convergence figures in this context an algorithm showing quick convergence capabilities is nominated to be the master algorithm the statistical results of the optimization test functions presented in tables 1 and 2 denote that the optimization efficiency of whale is superior to those of the compared contestant conventional algorithms in case of multimodal test functions whale obtains the global optimum solution in 5 among 16 test functions whereas other conventional methods fail to reach the global optimum point considering the case of unimodal benchmark problems neither whale nor the remaining optimization algorithms find the optimum solution of any test function discussed in table 2 regardless the optimal results found by whale for each test function presented in tables 1 and 2 are much better when compared with those of the compared conventional algorithms in terms of not only the solution accuracy but also consistency and robustness this deduction can be approved when the standard deviation and mean results of the test functions are elaborately scrutinized because the numerical values of these mentioned terms are significantly smaller than those of the compared algorithms in majority of the cases the convergence performance of the compared algorithms is presented in figs 1 6 it can be observed from the evolution history of each algorithm for each test function that whale quickly reaches its optimum point whereas the remaining optimizers show signs of stagnation and are possibly stuck at the local optimum points based on these obtained outcomes and facts from the exhaustive comparisons between algorithms whale is selected to be the commanding master algorithm responsible for exploiting the promising candidate solutions received from pso crow and de once the master population is determined the algorithmic structure of the proposed multi population optimization algorithm can be explained and described this algorithm uses a fixed number of population members therefore the population size of each algorithm should be equal and divisible by three the population individuals of the slave and master populations are initialized within their present allowable limits after determining the problem dimension and setting the termination criterion in terms of a maximum number of iteration and the control parameters of each algorithm the candidate solutions of each subpopulation are manipulated based on their corresponding learning schemes and the best one third of the solutions obtained using each slave algorithm are sent to the master in this phase of the algorithm the solution diversity is extended as much as possible through simultaneous utilization of the manipulation schemes of the three slave algorithms the population members of the slave algorithms are capable of reaching the unexplored paths in the search space by taking advantage of the usage of perturbation equations of different optimizers there are only a few studies in literature dealing with multi population algorithms using different metaheuristic algorithms as slaves akbari and ziarati 2011 majority of the multi population algorithms in the literature apply only one manipulation scheme to the slave populations with a fixed population size to diversify the solution space therefore the algorithm may not be able to reach the global optimum point at times and entrapment may occur in the local optimum points due to insufficient exploration of the search domain the second phase of the algorithm begins with the processing of the populations received from the slave individuals the master whale algorithm manipulates these promising solutions retained from the slave populations to exploit the updated solutions one should also not forget that studies related to testing the optimization performance of whale reveal that this optimization has extensive capabilities in case of both intensification and diversification kaur and arora 2018 therefore we can conclude that whale plays an important role in complementing the exploration process that occurs during the first phase although the main duty of whale in this phase of the algorithm is to intensify the fertile areas to obtain the global optimum point after the perturbation of the master algorithm individuals is completed the quality of the population members of the master and slave algorithms will be compared and the solutions with better fitness values will be carried into the upcoming generations the boundary check mechanism subsequently takes action to repair the infeasible population members by restricting them into the predefined limits the algorithm is finalized by selecting the best solution from the updated population and sending these updated solutions to each slave algorithm to be further manipulated and processed in the upcoming iterations a step by step description of the proposed ensemble multi population optimization algorithm is presented in detail in table 3 fig 7 illustrates the basic schematic representation of master slave with respect to the evaluation of the optimization performance of the mso algorithm its effectiveness in solving high dimensional complex problems is evident the master slave method obtains the global optimum solution of griewank rastrigin schaffer inverted cosine mixture wavy and pathological functions within 1000 function evaluations in case of multimodal test problems the optimization accuracy and solution robustness of master slave are always observed to be better than those found by other candidate algorithms for solving multimodal test functions however it fails to retain the global optimal point of the unimodal test functions presented in table 2 despite this it can be observed from table 2 that the predictive capability of the proposed master slave method is more convincing such that the worst value obtained using the master slave method is much better than those acquired by the other algorithms presented in table 2 one can also observe the quick convergence characteristics of the master slave method in case of both unimodal and multimodal test functions while examining the evolution process of the compared algorithms presented in figs 1 6 4 case study 4 1 site description this section provides information about the ahd case study the physical characteristics of ahd such as the capacity and water surface area are presented in this section further the operational criteria such as the release limits and storage bounds are thoroughly discussed to calibrate the release curves the data obtained from the lake nasser reservoir such as inflow data and water losses have been considered to formulate the problem and perform the simulation the ahd is a major irrigation structure in egypt the nile river annually supplies an average of 84 109 m3 of water to the reservoir the geographical location of the dam is 23 58 14 north 23 970556 and 32 52 40 east 32 877778 the operational strategy of ahd is relatively complex when compared with the remaining dams worldwide because it has an additional storage consideration to maintain and it is physically large by capacity fig 8 shows the location map of the dam and the dam operational zone and storage water level relations the water volume is presented in bcm el shafie and el manadely 2011 mohie el din and moussa 2016 in fig 9 different water levels and correspondence storage amounts are presented the water level or elevation and the water surface area can be considered to be the functions of storage volume there are a few constraints that should be considered while operating the ahd which is necessary for achieving system stability and also for conducting maintenance procedures the maximum and minimum storage capacities are within the limits of the maximum and minimum water levels of ahd s lake at any time the water level in the lake should be between 147 and 183 m above the sea level therefore the corresponding maximum and minimum water storage capacity is 31 bcm and 160 bcm respectively at any time according to the physical characteristic of the lake nasser reservoir the dead storage is equal to 32 bcm the emergency spill zone is equal to 23 bcm flood control zone is equal to 23 bcm and flood buffer zone is 18 bcm further the summation of the conservation zone buffer zone and live storage zone is 90 bcm el shafie and el manadely 2011 mohie el din and moussa 2016 however based on the nile river the streamflow downstream the ahd is limited to a particular value to avoid degradation of the river bed morphology the release constraint in ahd is limited to not only the river nature downstream the ahd but also the operation policy to consider the minimum release owing to navigation activities in this context the water release has been limited to be between 1 0 and 10 1 bcm per month el shafie and el manadely 2011 mohie el din and moussa 2016 the actual natural inflow data are used to run the model for simulation purposes therefore there is no need to convert the monthly rainfall to inflow because rainfall rarely occurs in the area of ahd which is located in the arid zone 130 years of data of the monthly natural flow of the nile river for the period between 1871 and 2000 have been used to discretize the whole inflow pattern into three states due to the wide range of possible inflow into the ahd reservoir it becomes necessary to discretize the inflow into different classes of states to achieve a reliable operation rule using the collected data of the historical monthly basis inflow for 130 years and by analyzing the ranges for each month it can be concluded that for each month the range the difference between the maximum and minimum inflow records experienced during 130 years of inflow could be categorized into three different classes including high medium and low inflows as depicted in fig 9a in fact based on these three classes of inflows for each month the development of the optimization algorithm that requires less computational time for convergence would be appropriate achieving an optimal operation rule at each range of inflow class a simple procedure has been conducted to categorize the inflow ranges the high inflow state is any value of inflow that falls between the maximum inflow record experienced in this particular month and the difference between the maximum and minimum inflow records multiplied by 70 whereas the low inflow state is any inflow records between the minimum value of inflow that has been experienced for a particular month and the difference between the maximum and minimum inflow multiplied by 30 finally the medium inflow state is any value of the inflow records falling in the range between the minimum border of the high inflow state and the maximum border of the low inflow state the monthly water demand data in bcm for ahd are illustrated in fig 9b each inflow state and release curve generated from any optimization model control the release the model will observe the actual inflow for each month and decide the category that provides the optimal release amount these inflow states assist in selecting the appropriate release curves for a given month el shafie and el manadely 2011 mohie el din and moussa 2016 the total water losses from the reservoir have been considered from a previous study hossain and el shafie 2014 the losses include evaporation rock absorption and seepage the monthly evaporation rate for lake nasser which acts as the reservoir for ahd is presented in fig 9c during any iteration the model calculates the surface area using the initial storage condition from eq 21 as presented in section 4 subsequently the total evaporation volume can be computed by multiplying the area with the monthly evaporation rate the seepage and rock absorption losses are also added to the calculated total reservoir water losses the seepage loss is considered to be 0 08 bcm month whereas the rock absorption loss is considered to be 0 125 bcm month hossain and el shafie 2014 initially the model requires a storage condition to run the optimization procedures generally it is observed in the reservoir optimization field the total number of discrete state variables is taken from 5 to 20 therefore the range of allowable reservoir level is divided into 10 discrete values with equal intervals thus each initial storage volume has a different release rule every month further the discrete values of the initial storage conditions are considered el shafie and el manadely 2011 mohie el din and moussa 2016 the main objective of this study is considered to be the minimization of the water deficit by the adoption of an optimal reservoir release rule for a reservoir system a fixed amount of water was assumed to be supplied for satisfying the monthly demand for the ahd the irrigational demand is considered to be a matter of some concern these demands include the basic residential commercial and irrigation water needs of the community which were obtained from previously conducted studies el shafie and el manadely 2011 mohie el din and moussa 2016 4 2 model application this study proposes a multi population master slave to determine the optimal release policy of ahd in egypt the optimization objective can be formulated by minimizing the water deficit between the monthly release and downstream demand which can be computed using the following expression 18 min f x i 1 12 d i r i 2 where d and r represent the water demand and water release for time period i respectively this minimization problem is also subjected to some design constraints related to the continuity and reservoir capacity issues the design problem maintains storage continuity via the following equation 19 storage i 1 storage i inflow i release i losses i as can be observed from the above equation the water storage volume in each time period i is directly linked with the storage inflow release and loss rates of the previous time period i 1 the evaporation losses from the water surface are formulated as follows 20 evaporation losses evaporation rate surface area 21 surface area 3164 28 25 49 storage 1092 92 ln storage where storage represents the reservoir storage volume in bcm and surface area represents the surface area of the reservoir in km2 ahd can be optimally operated using the proposed multi population master slave developed in java the monthly releases and water storages are selected as the decision variables that have to be iteratively optimized each problem constraint along with the maximum and minimum values of the design variables are implemented into the objective function the static penalty function is applied to the objective function to eliminate unfeasible solutions the objective function considers the following final form with the involvement of the penalized terms 22 min f f x p e n a l t y here the penalty term is associated with the equality constraint defined in eq 19 disallowing the inequality condition in this equation further various performance indicators have been applied to the optimization models to assess their estimation capabilities 4 3 performance indicators resilience reliability and vulnerability are the three considered statistical measures that have been applied to the numerical outcomes of the proposed model to evaluate its prediction performance once the operation rules have been generated there is a need to simulate such rules during a real operation period thus water release patterns can be obtained subsequently a comprehensive analysis of the water release decisions against the actual water demand could be conducted and accomplished based on each optimization algorithm to evaluate the algorithm performance to conduct such an important step to evaluate the algorithm s performance several performance indicators should be examined in this study four different performance indicators have been selected to examine the proposed optimization algorithms namely reliability resilience vulnerability and shortage index the major reasons for the selection of these particular indicators are the importance of their measures for the water resource planning and management decision makers indeed for the reliability index it is recommended to initially evaluate the value of the model s reliability index reflecting an essential measure of the algorithm s performance the reliability index introduces the percentage of successful events to whole events during the simulation period in other words it shows how far the operation rules generated from the optimization algorithm could successfully match the demand patterns during the simulation period when compared with the whole period as presented in eq 23 23 reliability number o f t i m e p e r i o d w h i c h i s m e e t i n g d e m a n d the s i m u l a t i o n p e r i o d second to substantiate the performance achieved using a certain optimization algorithm in particular for decision makers it is essential to examine the value of the resilience index the importance of this index is that it provides a measure of how the operation rules attained from the optimization algorithm could secure ease of switching from a failure event to a successful one the resilience index for the simulation period could be computed as the percentage of the maximum number of the successive events that experienced deficit failure events to the total number of deficit failure events the higher the resilience index s value the lower will be ability of the associate operation rule to promptly switch from the failure status to successful status the expression of the resilience index is shown in eq 24 24 resilience no o f m a x i m u m c o n s e c u t i v e u n s a t i s f a c t o r y e v e n t s total n u m b e r o f u n s a t i s f a c t o r y e v e n t s in addition it is vital to examine the system s vulnerability to validate the efficiency of the generated operation rules the vulnerability index measures the manner in which the water release policy for operation rule could reduce the ratio between the mismatch of water release and water demand deficit which is equal to the difference between the required demand during a certain event and the water release based on the operation rule and the water demand in this event in this context the low percentage of the vulnerability index mirrors the high ability of the model based decision makers with respect to water resource planning the expression for obtaining the vulnerability index is presented in eq 25 25 vulnerability m a x d e f i c i t demand 100 1 n where 1 represents the time at which the mismatch starts and n shows the time at which the mismatch ends 5 results and discussions 5 1 model parameters the success of the optimization of metaheuristics is heavily dependent on the accurate definition of the algorithm control parameters there is no well defined procedure to set accurate values of these parameters apart from the trial and error method which is an extremely exhaustive and time consuming process the associated control parameters of the mso algorithm such as the population size n of each sub algorithm cognitive c1 social c2 coefficients of pso scale factor f cr of de and awareness probability ap flight length fl of crow are varied on a large span to obtain the best possible configuration for yielding the optimal value of the objective function table 4 presents the variation ranges of these algorithm specific parameters along with their optimal empirical values the tiresome trial and error numerical experiments on the designation of appropriate parameter values for each sub algorithm indicate that each parameter has its own operation range that provides improved solution qualities the optimal population size is 24 and the optimal numerical values of the remaining parameters are defined in table 4 such that the cognitive and social factors of pso are 1 7 2 3 and 1 8 2 4 respectively the scale factor and crossover rate of de are 0 5 1 5 and 0 4 0 6 respectively and the ap and flight length parameters of crow are 0 9 1 1 and 1 9 2 2 respectively in each algorithm run promising objective function values are acquired by utilizing these empirical ranges of the control parameters the traditional static penalty function is considered for eliminating the decision variables that violate the prescribed solution boundaries the multi population mso algorithm master slave and crow are applied to the reservoir operation problem to obtain the optimal values of 24 design variables including the monthly water release and water storage volume of the reservoir many metaheuristic optimization algorithms in the literature have been attempted to not only solve dam operation problems but also benchmark its corresponding results against those found by the master slave method crow is selected to be the best performing optimization algorithm among the compared metaheuristics and is used as a reference method for performance comparison 100 algorithm runs along with 50 000 function evaluations have been performed by the master slave and crow optimizers due to their characteristic stochastic nature to obtain the optimum solution of the reservoir operation problem the algorithms are run on a desktop computer quad core intel i5 4460 at 3 20 ghz with 16 0 gb ram as previously mentioned ahd in egypt has been considered as a case study to evaluate and assess the predictive performance of master slave on large multidimensional constrained optimization problems 5 2 monthly releases optimal establishment of the reservoir operation rule is one of the most crucial aspects of water resource management and engineering operating rules are the main decisive indicators of the policy makers and play a pivotal role in deciding to keep the stored water in the reservoir or release it to be used for various purposes the monthly reservoir inflow data water demands and remaining main characteristics of the ahd reservoir are applied to master slave and crow to test the model efficiencies the monthly historical inflows to the ahd reservoir along with the monthly expected water demands for 50 years of operation from 1950 to 2001 are depicted in fig 10 according to the curves constructed by the historically collected data presented in fig 10 the average annual inflow to the reservoir and the annual water demand are predicted as 7 3313 and 6 1810 bcm respectively fig 11 shows the optimal values of the objective function values after 100 consecutive runs and the optimal policies obtained by the master slave algorithm and crow accompanied by the expected water demand as observed from the 10 year timeframe of reservoir operation from 1950 to 1960 in fig 11a the highest releases always occur in may june and july it is clear that master slave acquires better numerical outcomes in terms of the minimum objective function value the minimum mean upper and lower quartiles and maximum values obtained after 100 algorithm runs for each optimizer from 1950 to 2001 are presented in fig 12 the mso method achieved minimal lower objective function values when compared with those found by crow for each case and surpassed crow with respect to both the solution efficiency and accuracy fig 11c depicts the optimal release curves obtained by the master slave algorithm and crow for the reservoir operation period between 1960 and 1970 the release curve obtained by master slave is quite well matched with the demand curve except for operation periods of 1961 1962 1964 1965 and 1967 1968 the discrepancy between these curves in the related time periods is mainly because of the relatively high inflows into the reservoir particularly occurring from august to september which is explicitly depicted in fig 11c the optimal release values based on these inclinations of inflows should be between the expected demand and inflow rates to maintain the water volume in the reservoir within the allowable storage limits fig 11e denotes the fluctuations of the numerical values of the objective functions retained after 100 algorithm runs for each compared optimizer except for the operation period of 1963 1964 the average optimal values found by master slave are considerably better than those obtained using the crow method despite having found relatively higher objective function values for 1961 1962 1964 1965 and 1967 1968 the solution consistency and accuracy of the proposed method are satisfactory and more convincing when compared with those of crow fig 11e compares the accuracy of the optimal release curves established by the proposed master slave algorithm and crow it can be observed from fig 11e that the master slave release curves show a lower deficit for a decade of the reservoir operation period however it fails to capture the variations in downstream water demand in the time period between 1975 and 1976 this again resulted from the relatively high inflow rates into the reservoir throughout the corresponding time period the optimal release policy obtained by crow is quite convincing in this case regardless it heavily fails to estimate the water demand for 1972 1973 and 1979 1980 fig 11f depicts the optimum values of the objective function obtained after consecutive algorithm runs of the ensemble and crow optimizers for the time period between 1970 and 1980 although the amount of variation in the objective function values acquired using the master slave method after 100 algorithm runs is much higher when compared with those obtained by crow for each case the master slave method finds better results in terms of the minimum objective function value for each time period of reservoir operation fig 11g illustrates the optimal release curves generated by the master slave algorithm and crow along with the expected downstream water demand for the time period between 1980 and 1990 it can be observed from fig 11g that the release policy obtained by the master slave algorithm and crow fail to fulfill the demand in some operation cases during the aforementioned timeframe this is mainly due to the low inflow rates to the reservoir when compared with those observed in other cases 10 years of a time period as depicted in fig 10 furthermore crow considerably underestimates most of the water demand and shows a noticeable discrepancy in this case regardless the master slave algorithm shows better optimization performance than crow despite failing to meet the demand in most of the time period fig 11h visualizes the optimal objective function values obtained after successive algorithm runs the numerical values of the objective function for a time period of 10 years are much higher when compared with those of the former cases this behavior can be explained by the cumulative deficit between the demand and release values over the elapsed 10 years the best predictive performance shown by the master slave algorithm and crow for 10 years time span occurred during 1981 1982 with corresponding minimum objective function values of 0 8037 and 4 5608 the reservoir releases during each time period retained through the master slave algorithm and crow along with the required downstream water demands are presented and compared in fig 11e the release policy provided by these two algorithms is more than the water demand for the particular time period of 1998 2000 however the operation rule achieved by these two optimizers could not match the water demand for most of the months along the simulation years of 1990 1991 and 1997 1998 fig 11j denotes the visual summary of the optimal objective values obtained by the master slave algorithm and crow fig 13 demonstrates the numerical values of the performance indicators obtained through the predictive performance of the master slave algorithm and crow for every decade of the reservoir operation period the operation release policy produced by the optimization results attained more than 70 0 of the reliability for each comparison case except for the operation years between 1980 and 1990 however it is clear from the numerical comparisons that the release curve generated by the master slave algorithm is more reliable than that generated by crow such that it obtains higher reliability values when compared with that of crow for each comparison case the master slave based release policies are effective in recovering the reservoir system from a failure situation because it obtains better resilience rates in four of the five comparison cases reported in fig 13 it is also noticeable that the release policies generated by the master slave algorithm are less vulnerable to the failures or damages that occurred during five different reservoir operation time periods because it achieves low vulnerability index values in all the five comparison cases generally the applicability of the master slave algorithm and crow on optimal reservoir operation problems has been tested and comparative analysis over the statistical results and various performance indexes indicates that master slave shows a satisfactory model performance when compared with crow furthermore it provides significant and reasonable release curves for the monthly demand pattern with a minimum deficit for each time period and is nominated as a promising alternative for the optimal operation of ahd 5 3 comparison to the previous model to substantiate the superior performance of the proposed master slave over the previously developed optimization algorithm in the same case study a comparative analysis with the abc model developed by hossain and el shafie 2014 has been conducted the abc model calculations are as follows 36 10 of the obtained water release decisions are more than the demand 62 of the obtained water release decisions are equal to the demand and 1 90 of the obtained water release decisions are less than the demand however the master slave model resulted in water release decisions that 22 5 of which are more than the demand 75 is equal to the demand and 2 5 is less than the demand the resiliency values of the abc and master slave models are calculated as 14 5 and 31 38 respectively furthermore the vulnerability values of the abc and master slave models are obtained as 0 06 42 3 of the demand and 1 01 20 06 of the demand respectively the abc model has been examined for 10 years of simulated operation whereas the proposed master slave model has been examined based on 50 years of operation further the proposed master slave model has been evaluated by considering more flood and drought events than the abc model in terms of reliability master slave obviously outperformed the abc model for a number of release decisions equal to the demand which is the main target of the operation rule in addition if the percentage of the number of water release decisions are more than the demand of both the examined models it is clear that the proposed master slave could reduce this percentage from 36 1 to 22 5 indicating that the proposed master slave minimize the surplus water release for future needs however the abc model outperforms the proposed master slave in terms of the percentage of water deficits however it should be noted that the period of simulation for the abc model is only 10 years whereas it is 50 years for the proposed master slave which definitely includes a higher number of drought events and hence the possibility to an experienced higher number of deficit period is higher in addition it is clear that the difference between the percentages of the water release decisions is relatively small when compared with the difference in the number of years for simulation in terms of resilience the proposed master slave could attain better resilience hence the ability of the system with this optimal operation rule could rapidly recover and switch the system from being under a deficit condition to a match condition finally while studying the vulnerability it could be noticed that the abc model could achieve slightly better performance when compared with that of the proposed master slave this is due to the fact that the simulation period used to evaluate the performance of the proposed master slave is almost five times the period used to evaluate the abc model 5 4 operational rules fig 14 denotes the operation rule for ahd for january and july based on the proposed mso algorithm the major reason for the selection of these two months is to show the model performance for two different cases of water demand pattern and two different inflow patterns the proposed model for both the months could achieve an operation rule that the water release decision is mostly equal to the water demand at a relatively big range of reservoir storage in other words the proposed model could generate an operation rule that could match the demand in quite a long span of possible reservoir conditions in terms of its initial storage however there is a possibility to decide to release water less than the demand when the initial storage is relatively low and close to the value of the minimum capacity of the reservoir further the operation rule showed a necessity to release more than the demand when the initial storage is relatively high and near to the maximum capacity of the reservoir it should be noted that the fluctuation in the water release decision along with the whole operation rule is due to the fact that the proposed master slave puts on trial the detection of the stochastic nature in the inflow pattern and reflects that on the optimal water release value 6 conclusions five optimization algorithms have been established to derive operation rules for dam and reservoir water systems these models are pso crow de whale and the proposed master slave in fact the proposed master slave is considered to be a novel optimization algorithm procedure which is the main research objective the main contribution of this study is to investigate the potential of master slave to optimize the dam and reservoir water system these proposed models have been applied and adapted for the case study of one of the most complicated dam s reservoir namely ahd in our particular ahd case study the major reason for selecting ahd is that the ahd experienced significant fluctuation with respect to the inflow of the reservoir over the year highly stochastic nature variable and highly nonlinear constraints which are the main challenges associated with any optimization algorithm that should be considered while generating the operation rules the master slave algorithm has a high ability to detect and perceive the considerable stochastic nature and nonlinearity in the system under study in ahd case study master slave achieved an effective capability to derive an optimal operation rule that can successfully bridge the gap and achieved an optimal match for water supply demand patterns therefore the proposed master slave could be considered as a highly potential alternative optimization algorithm to be applied to similar highly nonlinear and stochastic engineering applications although master slave achieved superior performance for complex applications similar to the dam and reservoir water systems it is recommended to examine its performance that has to be generalized for several case studies in the future experiencing different climatic and hydrological conditions as well as dam scales declaration of competing interest none acknowledgment this research was funded by the university of malaya research grant umrg coded rp025a 18sus university of malaya malaysia appendix pseudo codes of the algorithms pseudo codes of particle swarm optimization crow search algorithm differential evaluation and whale optimization algorithm are given in figs a 1 a 2 a 3 and a 4 respectively 
6223,dams and reservoirs provide decision makers and managers with appropriate control on the available water resources allowing the implementation of various strategies for the most efficient usage of the available water resources in areas where water supply exhibits significant temporal variation when compared with the demand the challenge is to bridge the gap and achieve an optimal match between the water supply and demand patterns therefore the release of water from reservoirs should be controlled to ensure that the operation rule for the available water storage in the reservoir is optimized to satisfy the future water demands this level of optimal control can only be achieved using an efficient optimization algorithm to optimally derive the operation rule for such a complex water system herein two main methods have been considered to tackle this water resource management problem first three different optimization algorithms namely particle swarm optimization differential evolution and whale optimization algorithm have been applied in addition two different optimization algorithms namely crow search algorithm and master slave algorithm have been introduced to generate an optimal rule for water release policy further the proposed optimization algorithms have been applied to one of the most critical dam and reservoir water systems namely the aswan high dam ahd which controls almost 95 of egypt s water resources the current operation of ahd using the existing optimization rules resulted in a mismatch between the water supply and water demand in other words the water availability could be higher than the water demand during a certain period whereas it could be less than the water demand during another period the results denoted that the master slave algorithm outperforms the remaining algorithms and generates an optimization rule that minimizes the mismatch between the water supply and water demand keywords dam and reservoir operation optimization algorithm aswan high dam crow search algorithm master slave algorithm 1 introduction 1 1 background the identification management and development of the optimal operation policy for dams and reservoirs have extended over the previous few decades using several types of models the dam and reservoir water system has experienced uncertainties with respect to its system variables within the environment and engineering applications for example the hydrological parameters such as the inflow of a reservoir are stochastic therefore the minimization of the gap between water supply water that can be released from a dam and water demand is uncertain in addition the future unknown events associated with reservoir s inflow should be completely realized to generate an optimal water release policy majority of the current optimization models exhibit a tendency to deal with these uncertainties via inadequate modeling to clearly distinguish the full range and horizon of the likely consequences for any uncertain variable in the system environment in this context the existing modeling ability should be improved to obtain the perfect definition of the real consequences of the required output i e the optimal water release policy however specific knowledge about the possible consequences of a release decision is lost within the translation of the full spectrum of consequences to a surrogate and summative metric the extreme of the existing models procedures can be presented when operation policies are generated from some of the existing optimization models completely based on simply switching the stochastic variables to deterministic variables totally ignoring the essential feature of the dam and reservoir water system for example the existing reservoir optimization model has been basically developed by considering that the reservoir s inflow and evaporation losses are deterministic variables rather than stochastic variables and is represented using the markov process these operation policies generated based on a completely deterministic procedure are not explicitly acknowledged by the surrogate metric definition of the optimal release policy and therefore are not recognized as a valid characteristic feature of this optimal release policy in addition the dam and reservoir water system exhibits highly nonlinear characteristics that appear in the storage surface area elevation relation which should be accurately considered while simulating the reservoir status denoting a particular water release decision therefore an optimization method and algorithm should be established for such a complex system with stochastic nature and nonlinear characteristics majority of the recent studies have presented the successful application of a metaheuristic and evolutionary algorithm for solving the reservoir operation problem evolutionary algorithms have become popular among the metaheuristic society because of their recognizable success in solving high dimensional complex problems in various fields ranging from biomedical engineering poongothai et al 2017 to heat exchanger design xie et al 2008 further the evolutionary algorithms are initialized with a random population of individuals defined in the prescribed solution boundaries and the optimal results are iterated using an algorithm specific solution scheme until the termination criterion is satisfied or the predefined maximum number of iteration is achieved some of the prevalent evolutionary optimization methods include differential evolution storn 1997 genetic algorithm reeves and rowe 2006 and evolutionary strategy beyer 1994 similar to the evolutionary algorithms the swarm based optimization methods begin with a set of randomly selected population individuals and new candidate solutions are created based on historical knowledge or some information related to the inclinations and tendencies of the population individuals particle swarm optimization kennedy and eberhart 1995 artificial bee colony algorithm karaboga 2005 ant colony algorithm dorigo and gambardella 1997 and crow search algorithm crow askarzadeh 2016 are some of the most prominent swarm intelligence optimization methods the artificial intelligence based solution strategies have been frequently nominated by hydrology researchers for performing accurate numerical modeling of reservoir inflow and evaporation prediction for the previous two decades several data driven and artificial intelligence ai methods have been developed to overcome the stochastic characteristics and dynamic nature of the collected hydrological information these intelligent models consider various types of nature inspired optimization algorithms statistical learning methods and classification methods luger 2005 however this study mainly focuses on the application of the stochastic nature inspired optimization algorithms to the optimization of reservoir operations a brief literature survey indicates that the proposed methodologies deployed for optimal reservoir operation to ensure water management are categorized into two main branches the first branch includes the applications of traditional approaches such as linear programming lp chow and cortez rivera 1974 revelle et al 1969 dynamic programming dp murray and yakowit 1979 mousavi et al 2005 and stochastic dynamic programming sdp soleimani et al 2016 however the inherent incapability of the aforementioned classical approaches in solving high dimensional stochastic design problems limits their utilization to water management systems and paves the way for searching alternative options such as metaheuristic algorithms considerable developments have emerged with respect to the advancement of metaheuristic algorithms after rapid improvements in microchip technologies maier et al 2014 introduced a comprehensive investigation about the future trends and main challenges associated with the stochastic based optimization algorithms applied to reservoir operations and provided informative insights on several design related subject fields ranging from understanding the theoretical frameworks of evolutionary algorithms to the development of accurate objective functions in reservoir operation systems genetic algorithm ga goldberg 1989 is one of the pioneers of the evolutionary metaheuristic algorithms and is inspired by the natural selection and darwinian evolution strategies this algorithm simultaneously considers genetic operators and the survival of the fittest principle to obtain the global optimum answer to the problem within the search space this algorithm has been frequently utilized by hydrology researchers with respect to the water resource planning and management problems esat and hall 1994 used ga to obtain optimum reservoir operation for hydropower applications and water irrigation ahmed and sarma 2005 presented a ga based solution strategy to optimize the operation of a multi purpose reservoir chang and chang 2001 hybridized the ga and adaptive network based fuzzy inference system to minimize the water deficit during the real time operation of the shihmen reservoir in taiwan further chang et al 2003 applied ga to estimate the optimal flushing operation rule curves at the tapu reservoir by combining the sediment flushing and reservoir simulation models li and we 2008 proposed a hybrid learning model by combining the perturbation equations of ga and simulated annealing to overcome the premature convergence drawback of ga and to eliminate the unfeasible regions in the search space the proposed method was applied to the multi reservoir system at the wujiang river to improve the hydropower generation output over a predefined operating time period chen et al 2007 proposed macro evolutionary multi objective ga to not only avoid the troublesome premature convergence drawback of classical ga but also enhance the exploration capabilities of the algorithm by diversifying the solution span as much as possible this improved algorithm was subsequently applied to predict the optimal rule curves of the multi reservoir system in taiwan chang et al 2010 developed the constrained ga to derive an efficient and robust decision making procedure for reservoir operations further the predictive performance of the algorithm was validated by optimizing the long term downstream water demands of the shih men reservoir the applications of swarm based metaheuristic algorithms on reservoir operation systems have drawn considerable attention from researchers because of their effectivity in solving multidimensional engineering design problems the particle swarm optimization pso kennedy and eberhart 1995 and artificial bee colony abc karaboga 2005 algorithms have been the most considered optimizers for the optimal reservoir operation problems among the several swarm intelligence algorithms available in the literature for instance reddy and nagesh kumar 2007 presented a multi objective pso algorithm assisted with an elitist mutation scheme for generating non dominated pareto solutions for the optimal reservoir operation problems the predictive performance of the proposed approach was subsequently benchmarked on the multi objective optimal operation of the bhadra reservoir in india pso was applied to the mixed integer multi objective capacity optimization of the hydropower generation from the bakhtiari dam operation system to satisfy the conflicting design objectives mousavi and shourian 2010 the results proved the efficacy of the multi objective pso algorithm saberchenari et al 2016 adopted the pso algorithm for the optimal multi purpose operation of the mahabad dam in iran to minimize the water volume deficit between the expected demand and required release the optimization method was then applied in different climatic scenarios and the determined amount of water released by the pso algorithm was almost in good agreement with the expected demand hossain and el shafie 2014 suggested the usage of the abc algorithm as a favorable procedure to determine the optimal operation schedule of the aswan high dam ahd in egypt the optimization outcomes of the abc algorithm were benchmarked against those found by ga for model validation chen et al 2016 proposed an innovative abc based mathematical model for optimal irrigation scheduling of multiple crops the estimation capabilities of the abc and gravitational search algorithm gsa were assessed based on the optimal operation of the timah tasoh dam reservoir to amend the deficit between the water release and demand abc outperformed gsa with respect to the solution efficacy and exhibited its superiority in providing much better performance index values ahmed et al 2016 jalali et al 2007 developed a novel multi colony ant colony optimization aco algorithm to tackle the continuous multi reservoir operation optimization problem the authors specifically developed the proposed algorithm because the performance of the standard aco algorithm is rather poor the authors have concluded that the proposed algorithm provided acceptable and favorable outcomes zhang et al 2013 proposed parallel deterministic dynamic programming pddp and a hierarchical adaptive ga haga to solve the reservoir operation optimization problem the pddp method benefits the solution by the acceleration of the determination process in contrast the haga method effectively tackles the optimization problem by tuning the algorithm parameters and keeping an elite individual from the first hierarchy to the second hierarchy the authors concluded that the parallel implementation of these two methods provided more desirable results with less computation time than that obtained using the singular application of these two methods xu and mei 2018 proposed a modified water cycle algorithm based on the diversity evaluation and chaos theory to tackle the long term multi reservoir optimization problem in addition the authors have investigated the operation optimization of the yangtze river of china as a case study the results showed that the proposed algorithm provided more desirable outcomes with better convergence rates when compared with that of the other optimizers investigated in the study many recently emerged swarm intelligence metaheuristic algorithms have been applied to the reservoir operation systems the bat algorithm bozorg haddad et al 2015 weed optimization algorithm azizipour et al 2016 firefly optimization algorithm garousi nejad et al 2016 cuckoo search hosseini moghari et al 2015 and shark optimization algorithm ehteram et al 2017 ehteram et al 2017 are some of the prominent examples of applications that generate reliable policy rules during dam operations although their performance is quite satisfactory when compared with those of the traditional algorithms the swarm based optimization approaches experienced some difficulties in finding a global optimum answer to the problem resulting from their major drawbacks including premature convergence due to the insufficient diversification of the search domain and huge computational burden because of the extensive probing of the search space therefore this study aims to explore the advantages of using multi population metaheuristics to overcome the aforementioned deficiencies of the swarm intelligence algorithms the multi population optimization algorithms concurrently utilize more than one population to efficiently search the whole solution domain and to minimize the computational load by relying on their flexibility in embedding more than one algorithm in a single optimization framework this study proposes a master slave approach based multi population ensemble algorithm to optimize the reservoir operations the algorithm comprises population members of four different metaheuristic algorithms including pso differential evolution crow and whale optimization whale these four algorithms compete with each other based on the statistical results of the 30 optimization benchmark problems comprising unimodal and multimodal test functions the master algorithm is determined according to the averaged numerical results of the test functions and the remaining three algorithms assist the master algorithm by diversifying the candidate solutions further the master algorithm fine tunes the promising solutions retained for the slave population individuals a detailed description and explicit explanation of the proposed algorithm along with the fundamental characteristics of the multi population algorithms will be discussed in the upcoming sections 1 2 problem statement the effectiveness of any optimization algorithm is usually measured using the required computational time to achieve global optima and searching ability for the detection of global optima for some engineering applications such as the one presented in this research computational time is not an important indicator because the applications are not real time however the searching ability to detect global optima is an important indicator especially in case of an application that experienced highly nonlinear constraints and stochastic nature variables in the recent past innovative approaches with respect to the improvement of the optimization performance of the nature inspired metaheuristic algorithms have been implemented one of the most promising suggestions for enhancing the solution efficiency of any optimization method is dividing the main population into multiple subpopulations not only to increase the solution efficiency but also to enhance the diversification capacity of the algorithm burke et al 2013 this strategy is efficient in solving multidimensional large scale optimization problems researchers proposed the usage of different mutation schemes in case of different subpopulations to enhance the exploration capability of the algorithm the algorithm has also been suggested to be well tailored to the organization schemes that enable the subpopulations to communicate with each other and share their inherent knowledge and information through these highly devised learning mechanisms after sharing the historical information accumulated during the course of iterations different population members interact with each other by whether merging or exchanging the current information communication between subpopulation individuals increases the probability of avoiding premature convergence and maintaining the diversity of the main population while tackling complex real world design problems that are difficult to solve ahd is constructed at the south of egypt along the nile river which is the longest river in the world it is considered as one of the biggest dams in the world and has an upstream storage capacity of approximately 160 billion cubic meters bcm in lake nasser which is the biggest man made reservoir ahd is also the major control point for almost 95 of the available water resources on a national scale in egypt however because of the variation in temporal pattern between the water resources based on the inflow pattern in the nile river along with the year and the water demand pattern based on the agricultural industrial and domestic requirements there is a relatively large gap between the water availability for supply and water demands in this context there is a need to utilize a highly effective optimization algorithm whose searching ability could reflect the nonlinearity in the water system of ahd s constraints and the stochastic nature of the ahd s reservoir inflow achieving the optimal operation rule of the ahd 1 3 objectives the main objective of this study is to implement a multi population master slave algorithm master slave by utilizing various metaheuristic optimizers to generate an optimal operation rule for the dam and reservoir water system the proposed optimization algorithms have been applied to ahd which is considered as one of the most crucial case studies for operating dam and reservoir water system the performance of the generated operation rule based on each algorithm is examined using different performance indicators including reliability resilience and vulnerability to evaluate the success of the operation rule to minimize the gap between the water release policy and water demands in section 2 the introduction of the algorithms that form master slave and the implementation of master slave are presented in section 3 multi population algorithms of crow whale pso and differential evolution are benchmarked against their conventional counterparts and the proposed master slave section 4 is introduced to provide details about the proposed case study ahd further section 5 demonstrates the achieved results and discusses the generated operation rules by emphasizing the performance indicator values finally in section 6 the conclusion of the whole study is presented by focusing on the major observations with respect to the problem objectives 2 model formulation 2 1 framework and concept herein we propose the concurrent utilization of the perturbation equations of the crow askarzadeh 2016 whale mirjalili and lewis 2016 pso kennedy and eberhart 1995 and differential evolution de storn 1997 algorithms to construct an efficient multi population master slave exhibiting dexterous probing capabilities resulting in the maintenance of a better and proper balance between the exploration and exploitation phases of the algorithm at hand the main difference between the master slave and conventional hybrid optimizers such as the improved ga simulated algorithm iga sa presented in li and wei 2008 is that master slave utilizes the hierarchical relations between the master and slave algorithms to find a balance between exploration and exploitation however the conventional hybrid optimizers employ specific algorithms for performing specific tasks for example ga is utilized for performing the exploration task whereas the simulated annealing algorithm is used for the exploitation task in iga sa it is also worth mentioning that this study considers these four metaheuristics among plenty of alternatives because of their ease of implementation and relatively better convergence capabilities and solution effectiveness when compared with those of their literature counterparts the solution efficiency and quality of each of the aforementioned algorithms will be assessed and evaluated using a set of optimization benchmark functions comprising unimodal and multimodal test problems and the best performing optimizer among these four algorithms whose optimization performance can be obtained by averaging the quality of optimal results over the total number of optimization test functions is decided and considered to be the master population whereas the remaining three population members of the algorithms are selected as slave individuals furthermore different master slave population combinations of the algorithms are tested using the aforementioned unimodal and multimodal benchmark functions and the results proved the effectivity of the considered combination in the following section the fundamental characteristics of each algorithm that form the ensemble method will be briefly explained and their intrinsic learning schemes will be explicitly formulated 2 2 model components 2 2 1 particle swarm optimization pso is one of the most popular swarm intelligence algorithms and has drawn considerable interest from the metaheuristic community pso which was originally introduced by kennedy and eberhart 1995 aims to numerically imitate the social behaviors of birds and fishes in the pso algorithm each candidate solution of the optimization problem is represented by a particle in the swarm considering the d dimensional hyperspace two different vectors are initialized for each particle i 1 2 n further we present the position x x i 1 x i 2 x i d and velocity v v i 1 v i 2 v i d vectors of each particle in the swarm the algorithm is initialized by distributing the position and velocity vectors of each particle over the search domain two perturbation equations are utilized to update the position of each particle while taking advantage of the previous best knowledge pbest and the overall best experience gbest of the swarm individuals 1 v i j iter 1 v i j iter c 1 r a n d 0 1 1 p best j iter x i j iter c 2 r a n d 0 1 2 g best j iter x i j iter 2 x i j iter 1 x i j iter v i j iter 1 where c1 and c2 are the social and cognitive coefficients respectively rand 0 1 1 and rand 0 1 2 are two different uniformly distributed random numbers defined in the range poongothai et al 2017 and j represents the dimension of the particle in the swarm using eqs 1 and 2 the pso algorithm probes around the fertile and promising sites in the search space and adjusts its historical knowledge assisted trajectory to obtain a global optimum solution to the optimization problem the basic implementation of the pso algorithm is presented in fig a1 in appendix a 2 2 2 crow search algorithm askarzadeh 2016 proposed crow which is a novel metaheuristic optimizer developed based on the pilfering characteristics of intelligent crows crows have an intrinsic pilfering behavior such that every crow has food storage in its hiding place and some precautions are required to protect its food storage from other crows otherwise its food storage may be discovered and most probably be pilfered by the foraging crows this foraging behavior of crows can be mathematically converted into an optimization algorithm by applying the expressions presented in fig a2 in appendix a the algorithm is initialized by randomly determining the position of each crow i 1 2 n and each position represents a candidate solution x x i 1 x i 2 x i 3 the crow memory m m i 1 m i 2 m i d is populated with the initial position of the crows because they have no experience or knowledge about the hiding food resources crow i chooses a victim crow j from the swarm to discover and steal the food resources of crow j and chases crow j until it arrives at its hiding place another option of crow i is to find a random location available for foraging this pilfering behavior of the crows can be mathematically expressed using the following equation 3 x i iter 1 x i iter r a n d 0 1 1 i f l i iter m j iter x j iter r a n d 0 1 2 j a p j iter a random position in the search space otherwise where rand 0 1 1 and rand 0 1 2 are the gaussian random numbers defined to be between 0 0 and 1 0 a p j iter defines the awareness probability of crow j f l i iter represents the flight length of crow i and m j iter denotes the memory of crow j at iteration iter these newly generated solutions are subsequently evaluated based on their corresponding fitness value and the memory of each crow in the swarm is updated using the following expression 4 m i iter 1 x i iter 1 f x i iter 1 f m i iter m i iter otherwise where f is the functional value of the objective function 2 2 3 differential evolution de algorithm is an evolutionary metaheuristic algorithm initially coined by storn 1997 an explanatory and comprehensive description of the de algorithm can be found in literature pishchalnikov 2018 zheng et al 2017 wu et al 2018 the algorithm comprises three different phases including mutation crossover and selection the algorithm is initialized using randomly generated d dimensional parent population individuals x x i 1 x i 2 x i d i 1 2 n where n is the population size after the initialization of the population members within the prescribed boundaries the algorithm enters the mutation phase the mutation operation generates the mutant vector v based on the parent x population individuals under the control of the responsible mutation strategy some of the mutation equations extensively used in de algorithm are expressed as follows 5 de r a n d 1 v i iter x k 1 iter f x k 2 iter x k 3 iter 6 de b e s t 1 v i iter x best iter f x k 1 iter x k 2 iter 7 de c u r r e n t t o b e s t 1 v i iter x i iter f x best iter x i iter f x k 1 iter x k 2 iter 8 de r a n d 2 v i iter x k 1 iter f x k 2 iter x k 3 iter f x k 4 iter x k 5 iter 9 de b e s t 2 v i iter x best iter f x k 2 iter x k 3 iter f x k 4 iter x k 5 iter where k 1 k 2 k 3 k 4 k 5 i are the index values of the different population individuals randomly selected between 1 and n and these entire selected index values are different from the current running index i f is one of the control parameters of the de algorithm called scale factor and is defined in the range xie et al 2008 this algorithm parameter is responsible for weighing the difference between the randomly selected vectors xbest represents the best solution obtained during the course of iterations and the superscript iter denotes the current iteration after the completion of the mutation phase the algorithm enters the crossover phase to generate trial population individuals u i iter based on the numerical comparison between a uniformly distributed random number defined in poongothai et al 2017 and the crossover rate cr this procedure is called binomial crossover and can be mathematically expressed as follows 10 u i iter v i iter i f rand 0 1 j c r o r j j rand j 1 2 d x i iter otherwise where j rand is a random integer selected from the interval between 1 and d rand 0 1 j is the gaussian random number defined in the range poongothai et al 2017 for the jth member of the population and cr is another user defined algorithm specific control parameter produced in the range poongothai et al 2017 and controls the diversity of the population by deciding the number of transferred individuals from the mutant vector to the trial vector finally the selection phase is introduced to select the best individuals for the next generation the selection procedure can be simply expressed as follows 11 x i iter 1 u i iter if f u i iter f x i iter x i iter otherwise a basic pseudocode description of the de algorithm is presented in fig a3 in appendix a 2 2 4 whale optimization algorithm inspired by the intelligent foraging behaviors of the humpback whales whale optimization algorithm is a nature inspired metaheuristic algorithm developed by mirjalili and lewis 2016 the algorithm mainly comprises two different phases namely encircling prey individuals and bubble net attacking strategy these phases are briefly described below 2 2 4 1 encircling prey individuals humpback whales encircle their prey during the commencing of the hunting process as the iterations proceed to its maximum allowable number whales update their current positions toward the optimal search agents in this context the target prey individual is considered to be the best candidate solution the below given mathematical equation represents the encircling prey mechanism 12 x iter 1 x best iter a c x best iter x iter where x is the position vector and xbest is the best position vector obtained throughout the iterations iter denotes the current iteration number and a and c are the algorithm specific vectors formed by the random numbers and calculated as follows 13 a 2 a r a n d 0 1 1 a 14 c 2 r a n d 0 1 2 in the aforementioned equations rand 0 1 1 and rand 0 1 2 are uniformly distributed random numbers different from each other and the iteration dependent variable a linearly decreases from 2 0 to 0 0 2 2 4 2 bubble net attacking strategy bubble net attacking method contains two different approaches to accomplish the exploitation phase of the algorithm these procedures include the shrinking encircling and spiral updating position mechanisms which will be briefly introduced in this section the spiral updating position mechanism redesigns the current position of the whales using the following spiral equation 15 x iter e bl cos 2 π l x best iter x iter x best iter where b is a constant algorithm parameter responsible for determining the shape of the spiral equation and l is a random number defined in the range 1 1 while attacking prey individuals whales have two simultaneous options to trap and catch their prey they can either apply the shrinking encircling mechanism or utilize the spiral updating position mechanism to locate a new position in the solution space this decision making process can be modeled using the following equation 16 x iter 1 x best iter a x best iter x iter i f p 0 5 x best iter e bl cos 2 π l x best iter x iter i f p 0 5 where p is a random number lying in the range poongothai et al 2017 that determines the probability of encircling prey individuals the varying numerical values of a defined in eq 13 plays a vital role in the activation of the exploration phase of the algorithm during the exploration phase the position update of whales is maintained by the randomly selected search agents rather than by utilizing the best position obtained along with the iterations this mentioned global search mechanism can be activated if the random value of a is greater than 1 or smaller than 1 the mathematical expression of this model can be formulated as follows 17 x iter 1 x k iter a c x k iter x iter where k is a randomly chosen whale in the population defined in the range 1 n the pseudocode of the whale optimization algorithm is presented in fig a4 in appendix a 2 3 multi population master slave algorithm this study aims to propose an innovative optimization strategy constructed by the ensemble of four different metaheuristic optimizers including the pso crow de and whale algorithms the proposed ensemble method utilizes favorable merits of the master slave model approach which is very efficient in creating a sustainable synergy between different population members relying on its effective cooperative framework this model was extensively applied under the framework of four different metaheuristic algorithms including the bat algorithm jaddi et al 2015 bee swarm algorithm akbari and ziarati 2011 and pso zhan and zhang 2009 there are several slave populations and one master population in the master slave optimization mso approach the slave populations exchange the historical knowledge and accumulated information among them and send the feasible and promising candidate solutions to the master population the master population collects the domain information processed by each slave population evaluates the exchanged data based on its own concept and determines the global optimum solution from among the possible alternatives obtained from the slave populations finally all the master population members are nullified this algorithmic procedure repeats itself until the termination criterion is satisfied this iterative competition based learning mechanism is very capable to maintain an appropriate and plausible balance between the exploration and exploitation phases of the algorithm the exploration phase is very critical to any metaheuristic algorithm because the candidate solutions are diverse and spread over the search domain in this phase intensification in the most promising area of the search space during the exploitation phase which generally takes advantage of the usage of the current best solution obtained during the iterations to probe around these fertile areas to jump over the local optimum points and reach the global optimum solution by eliminating these trap solutions as quickly as possible 2 4 master algorithm selection the master slave approach proposed in this study is more complex dexterous and crafty when compared with its conventional counterparts the algorithmic structure of the proposed method is considerably complicated than the method in traditional literature because there is a challenging and exhaustive competition among four metaheuristic optimizers with such a prestigious aim to be the commanding algorithm in the hierarchy the optimization performance of the conventional metaheuristic algorithms of crow de pso and whale are assessed based on their corresponding solution accuracy and convergence speed to properly deduce the master and slave populations thirty different optimization benchmark problems comprising unimodal and multimodal test functions are solved using these four optimizers and the master algorithm is decided based on the evaluation of the averaged statistical results of these four algorithms as previously stated different master slave population combinations of algorithms are tested with the unimodal and multimodal benchmark test functions and the results proved the effectivity of the considered master slave combination 3 model benchmarking tables 1 and 2 report the statistical outcomes of the multimodal and unimodal test functions respectively obtained using four different conventional optimizers along with their multi population counterparts mcrow mde mpso and mwhale proposed master slave and the dual slave combinations of the proposed algorithm mcrowde mpsode and mpsocrow fifty algorithm runs along with 1000 function evaluations have been conducted to obtain the numerical results presented in tables 1 and 2 the optimization performance of master slave will be discussed later and this section mainly intends to evaluate the competitiveness and robustness of the four contender algorithms the convergence speed of the algorithms presented and compared in figs 1 6 is also another decisive parameter that directly influences the selection of the master algorithm the elapsed number of function evaluations is presented on the x axis and the best objective function value on a logarithmic scale is represented on the y axis in the convergence figures in this context an algorithm showing quick convergence capabilities is nominated to be the master algorithm the statistical results of the optimization test functions presented in tables 1 and 2 denote that the optimization efficiency of whale is superior to those of the compared contestant conventional algorithms in case of multimodal test functions whale obtains the global optimum solution in 5 among 16 test functions whereas other conventional methods fail to reach the global optimum point considering the case of unimodal benchmark problems neither whale nor the remaining optimization algorithms find the optimum solution of any test function discussed in table 2 regardless the optimal results found by whale for each test function presented in tables 1 and 2 are much better when compared with those of the compared conventional algorithms in terms of not only the solution accuracy but also consistency and robustness this deduction can be approved when the standard deviation and mean results of the test functions are elaborately scrutinized because the numerical values of these mentioned terms are significantly smaller than those of the compared algorithms in majority of the cases the convergence performance of the compared algorithms is presented in figs 1 6 it can be observed from the evolution history of each algorithm for each test function that whale quickly reaches its optimum point whereas the remaining optimizers show signs of stagnation and are possibly stuck at the local optimum points based on these obtained outcomes and facts from the exhaustive comparisons between algorithms whale is selected to be the commanding master algorithm responsible for exploiting the promising candidate solutions received from pso crow and de once the master population is determined the algorithmic structure of the proposed multi population optimization algorithm can be explained and described this algorithm uses a fixed number of population members therefore the population size of each algorithm should be equal and divisible by three the population individuals of the slave and master populations are initialized within their present allowable limits after determining the problem dimension and setting the termination criterion in terms of a maximum number of iteration and the control parameters of each algorithm the candidate solutions of each subpopulation are manipulated based on their corresponding learning schemes and the best one third of the solutions obtained using each slave algorithm are sent to the master in this phase of the algorithm the solution diversity is extended as much as possible through simultaneous utilization of the manipulation schemes of the three slave algorithms the population members of the slave algorithms are capable of reaching the unexplored paths in the search space by taking advantage of the usage of perturbation equations of different optimizers there are only a few studies in literature dealing with multi population algorithms using different metaheuristic algorithms as slaves akbari and ziarati 2011 majority of the multi population algorithms in the literature apply only one manipulation scheme to the slave populations with a fixed population size to diversify the solution space therefore the algorithm may not be able to reach the global optimum point at times and entrapment may occur in the local optimum points due to insufficient exploration of the search domain the second phase of the algorithm begins with the processing of the populations received from the slave individuals the master whale algorithm manipulates these promising solutions retained from the slave populations to exploit the updated solutions one should also not forget that studies related to testing the optimization performance of whale reveal that this optimization has extensive capabilities in case of both intensification and diversification kaur and arora 2018 therefore we can conclude that whale plays an important role in complementing the exploration process that occurs during the first phase although the main duty of whale in this phase of the algorithm is to intensify the fertile areas to obtain the global optimum point after the perturbation of the master algorithm individuals is completed the quality of the population members of the master and slave algorithms will be compared and the solutions with better fitness values will be carried into the upcoming generations the boundary check mechanism subsequently takes action to repair the infeasible population members by restricting them into the predefined limits the algorithm is finalized by selecting the best solution from the updated population and sending these updated solutions to each slave algorithm to be further manipulated and processed in the upcoming iterations a step by step description of the proposed ensemble multi population optimization algorithm is presented in detail in table 3 fig 7 illustrates the basic schematic representation of master slave with respect to the evaluation of the optimization performance of the mso algorithm its effectiveness in solving high dimensional complex problems is evident the master slave method obtains the global optimum solution of griewank rastrigin schaffer inverted cosine mixture wavy and pathological functions within 1000 function evaluations in case of multimodal test problems the optimization accuracy and solution robustness of master slave are always observed to be better than those found by other candidate algorithms for solving multimodal test functions however it fails to retain the global optimal point of the unimodal test functions presented in table 2 despite this it can be observed from table 2 that the predictive capability of the proposed master slave method is more convincing such that the worst value obtained using the master slave method is much better than those acquired by the other algorithms presented in table 2 one can also observe the quick convergence characteristics of the master slave method in case of both unimodal and multimodal test functions while examining the evolution process of the compared algorithms presented in figs 1 6 4 case study 4 1 site description this section provides information about the ahd case study the physical characteristics of ahd such as the capacity and water surface area are presented in this section further the operational criteria such as the release limits and storage bounds are thoroughly discussed to calibrate the release curves the data obtained from the lake nasser reservoir such as inflow data and water losses have been considered to formulate the problem and perform the simulation the ahd is a major irrigation structure in egypt the nile river annually supplies an average of 84 109 m3 of water to the reservoir the geographical location of the dam is 23 58 14 north 23 970556 and 32 52 40 east 32 877778 the operational strategy of ahd is relatively complex when compared with the remaining dams worldwide because it has an additional storage consideration to maintain and it is physically large by capacity fig 8 shows the location map of the dam and the dam operational zone and storage water level relations the water volume is presented in bcm el shafie and el manadely 2011 mohie el din and moussa 2016 in fig 9 different water levels and correspondence storage amounts are presented the water level or elevation and the water surface area can be considered to be the functions of storage volume there are a few constraints that should be considered while operating the ahd which is necessary for achieving system stability and also for conducting maintenance procedures the maximum and minimum storage capacities are within the limits of the maximum and minimum water levels of ahd s lake at any time the water level in the lake should be between 147 and 183 m above the sea level therefore the corresponding maximum and minimum water storage capacity is 31 bcm and 160 bcm respectively at any time according to the physical characteristic of the lake nasser reservoir the dead storage is equal to 32 bcm the emergency spill zone is equal to 23 bcm flood control zone is equal to 23 bcm and flood buffer zone is 18 bcm further the summation of the conservation zone buffer zone and live storage zone is 90 bcm el shafie and el manadely 2011 mohie el din and moussa 2016 however based on the nile river the streamflow downstream the ahd is limited to a particular value to avoid degradation of the river bed morphology the release constraint in ahd is limited to not only the river nature downstream the ahd but also the operation policy to consider the minimum release owing to navigation activities in this context the water release has been limited to be between 1 0 and 10 1 bcm per month el shafie and el manadely 2011 mohie el din and moussa 2016 the actual natural inflow data are used to run the model for simulation purposes therefore there is no need to convert the monthly rainfall to inflow because rainfall rarely occurs in the area of ahd which is located in the arid zone 130 years of data of the monthly natural flow of the nile river for the period between 1871 and 2000 have been used to discretize the whole inflow pattern into three states due to the wide range of possible inflow into the ahd reservoir it becomes necessary to discretize the inflow into different classes of states to achieve a reliable operation rule using the collected data of the historical monthly basis inflow for 130 years and by analyzing the ranges for each month it can be concluded that for each month the range the difference between the maximum and minimum inflow records experienced during 130 years of inflow could be categorized into three different classes including high medium and low inflows as depicted in fig 9a in fact based on these three classes of inflows for each month the development of the optimization algorithm that requires less computational time for convergence would be appropriate achieving an optimal operation rule at each range of inflow class a simple procedure has been conducted to categorize the inflow ranges the high inflow state is any value of inflow that falls between the maximum inflow record experienced in this particular month and the difference between the maximum and minimum inflow records multiplied by 70 whereas the low inflow state is any inflow records between the minimum value of inflow that has been experienced for a particular month and the difference between the maximum and minimum inflow multiplied by 30 finally the medium inflow state is any value of the inflow records falling in the range between the minimum border of the high inflow state and the maximum border of the low inflow state the monthly water demand data in bcm for ahd are illustrated in fig 9b each inflow state and release curve generated from any optimization model control the release the model will observe the actual inflow for each month and decide the category that provides the optimal release amount these inflow states assist in selecting the appropriate release curves for a given month el shafie and el manadely 2011 mohie el din and moussa 2016 the total water losses from the reservoir have been considered from a previous study hossain and el shafie 2014 the losses include evaporation rock absorption and seepage the monthly evaporation rate for lake nasser which acts as the reservoir for ahd is presented in fig 9c during any iteration the model calculates the surface area using the initial storage condition from eq 21 as presented in section 4 subsequently the total evaporation volume can be computed by multiplying the area with the monthly evaporation rate the seepage and rock absorption losses are also added to the calculated total reservoir water losses the seepage loss is considered to be 0 08 bcm month whereas the rock absorption loss is considered to be 0 125 bcm month hossain and el shafie 2014 initially the model requires a storage condition to run the optimization procedures generally it is observed in the reservoir optimization field the total number of discrete state variables is taken from 5 to 20 therefore the range of allowable reservoir level is divided into 10 discrete values with equal intervals thus each initial storage volume has a different release rule every month further the discrete values of the initial storage conditions are considered el shafie and el manadely 2011 mohie el din and moussa 2016 the main objective of this study is considered to be the minimization of the water deficit by the adoption of an optimal reservoir release rule for a reservoir system a fixed amount of water was assumed to be supplied for satisfying the monthly demand for the ahd the irrigational demand is considered to be a matter of some concern these demands include the basic residential commercial and irrigation water needs of the community which were obtained from previously conducted studies el shafie and el manadely 2011 mohie el din and moussa 2016 4 2 model application this study proposes a multi population master slave to determine the optimal release policy of ahd in egypt the optimization objective can be formulated by minimizing the water deficit between the monthly release and downstream demand which can be computed using the following expression 18 min f x i 1 12 d i r i 2 where d and r represent the water demand and water release for time period i respectively this minimization problem is also subjected to some design constraints related to the continuity and reservoir capacity issues the design problem maintains storage continuity via the following equation 19 storage i 1 storage i inflow i release i losses i as can be observed from the above equation the water storage volume in each time period i is directly linked with the storage inflow release and loss rates of the previous time period i 1 the evaporation losses from the water surface are formulated as follows 20 evaporation losses evaporation rate surface area 21 surface area 3164 28 25 49 storage 1092 92 ln storage where storage represents the reservoir storage volume in bcm and surface area represents the surface area of the reservoir in km2 ahd can be optimally operated using the proposed multi population master slave developed in java the monthly releases and water storages are selected as the decision variables that have to be iteratively optimized each problem constraint along with the maximum and minimum values of the design variables are implemented into the objective function the static penalty function is applied to the objective function to eliminate unfeasible solutions the objective function considers the following final form with the involvement of the penalized terms 22 min f f x p e n a l t y here the penalty term is associated with the equality constraint defined in eq 19 disallowing the inequality condition in this equation further various performance indicators have been applied to the optimization models to assess their estimation capabilities 4 3 performance indicators resilience reliability and vulnerability are the three considered statistical measures that have been applied to the numerical outcomes of the proposed model to evaluate its prediction performance once the operation rules have been generated there is a need to simulate such rules during a real operation period thus water release patterns can be obtained subsequently a comprehensive analysis of the water release decisions against the actual water demand could be conducted and accomplished based on each optimization algorithm to evaluate the algorithm performance to conduct such an important step to evaluate the algorithm s performance several performance indicators should be examined in this study four different performance indicators have been selected to examine the proposed optimization algorithms namely reliability resilience vulnerability and shortage index the major reasons for the selection of these particular indicators are the importance of their measures for the water resource planning and management decision makers indeed for the reliability index it is recommended to initially evaluate the value of the model s reliability index reflecting an essential measure of the algorithm s performance the reliability index introduces the percentage of successful events to whole events during the simulation period in other words it shows how far the operation rules generated from the optimization algorithm could successfully match the demand patterns during the simulation period when compared with the whole period as presented in eq 23 23 reliability number o f t i m e p e r i o d w h i c h i s m e e t i n g d e m a n d the s i m u l a t i o n p e r i o d second to substantiate the performance achieved using a certain optimization algorithm in particular for decision makers it is essential to examine the value of the resilience index the importance of this index is that it provides a measure of how the operation rules attained from the optimization algorithm could secure ease of switching from a failure event to a successful one the resilience index for the simulation period could be computed as the percentage of the maximum number of the successive events that experienced deficit failure events to the total number of deficit failure events the higher the resilience index s value the lower will be ability of the associate operation rule to promptly switch from the failure status to successful status the expression of the resilience index is shown in eq 24 24 resilience no o f m a x i m u m c o n s e c u t i v e u n s a t i s f a c t o r y e v e n t s total n u m b e r o f u n s a t i s f a c t o r y e v e n t s in addition it is vital to examine the system s vulnerability to validate the efficiency of the generated operation rules the vulnerability index measures the manner in which the water release policy for operation rule could reduce the ratio between the mismatch of water release and water demand deficit which is equal to the difference between the required demand during a certain event and the water release based on the operation rule and the water demand in this event in this context the low percentage of the vulnerability index mirrors the high ability of the model based decision makers with respect to water resource planning the expression for obtaining the vulnerability index is presented in eq 25 25 vulnerability m a x d e f i c i t demand 100 1 n where 1 represents the time at which the mismatch starts and n shows the time at which the mismatch ends 5 results and discussions 5 1 model parameters the success of the optimization of metaheuristics is heavily dependent on the accurate definition of the algorithm control parameters there is no well defined procedure to set accurate values of these parameters apart from the trial and error method which is an extremely exhaustive and time consuming process the associated control parameters of the mso algorithm such as the population size n of each sub algorithm cognitive c1 social c2 coefficients of pso scale factor f cr of de and awareness probability ap flight length fl of crow are varied on a large span to obtain the best possible configuration for yielding the optimal value of the objective function table 4 presents the variation ranges of these algorithm specific parameters along with their optimal empirical values the tiresome trial and error numerical experiments on the designation of appropriate parameter values for each sub algorithm indicate that each parameter has its own operation range that provides improved solution qualities the optimal population size is 24 and the optimal numerical values of the remaining parameters are defined in table 4 such that the cognitive and social factors of pso are 1 7 2 3 and 1 8 2 4 respectively the scale factor and crossover rate of de are 0 5 1 5 and 0 4 0 6 respectively and the ap and flight length parameters of crow are 0 9 1 1 and 1 9 2 2 respectively in each algorithm run promising objective function values are acquired by utilizing these empirical ranges of the control parameters the traditional static penalty function is considered for eliminating the decision variables that violate the prescribed solution boundaries the multi population mso algorithm master slave and crow are applied to the reservoir operation problem to obtain the optimal values of 24 design variables including the monthly water release and water storage volume of the reservoir many metaheuristic optimization algorithms in the literature have been attempted to not only solve dam operation problems but also benchmark its corresponding results against those found by the master slave method crow is selected to be the best performing optimization algorithm among the compared metaheuristics and is used as a reference method for performance comparison 100 algorithm runs along with 50 000 function evaluations have been performed by the master slave and crow optimizers due to their characteristic stochastic nature to obtain the optimum solution of the reservoir operation problem the algorithms are run on a desktop computer quad core intel i5 4460 at 3 20 ghz with 16 0 gb ram as previously mentioned ahd in egypt has been considered as a case study to evaluate and assess the predictive performance of master slave on large multidimensional constrained optimization problems 5 2 monthly releases optimal establishment of the reservoir operation rule is one of the most crucial aspects of water resource management and engineering operating rules are the main decisive indicators of the policy makers and play a pivotal role in deciding to keep the stored water in the reservoir or release it to be used for various purposes the monthly reservoir inflow data water demands and remaining main characteristics of the ahd reservoir are applied to master slave and crow to test the model efficiencies the monthly historical inflows to the ahd reservoir along with the monthly expected water demands for 50 years of operation from 1950 to 2001 are depicted in fig 10 according to the curves constructed by the historically collected data presented in fig 10 the average annual inflow to the reservoir and the annual water demand are predicted as 7 3313 and 6 1810 bcm respectively fig 11 shows the optimal values of the objective function values after 100 consecutive runs and the optimal policies obtained by the master slave algorithm and crow accompanied by the expected water demand as observed from the 10 year timeframe of reservoir operation from 1950 to 1960 in fig 11a the highest releases always occur in may june and july it is clear that master slave acquires better numerical outcomes in terms of the minimum objective function value the minimum mean upper and lower quartiles and maximum values obtained after 100 algorithm runs for each optimizer from 1950 to 2001 are presented in fig 12 the mso method achieved minimal lower objective function values when compared with those found by crow for each case and surpassed crow with respect to both the solution efficiency and accuracy fig 11c depicts the optimal release curves obtained by the master slave algorithm and crow for the reservoir operation period between 1960 and 1970 the release curve obtained by master slave is quite well matched with the demand curve except for operation periods of 1961 1962 1964 1965 and 1967 1968 the discrepancy between these curves in the related time periods is mainly because of the relatively high inflows into the reservoir particularly occurring from august to september which is explicitly depicted in fig 11c the optimal release values based on these inclinations of inflows should be between the expected demand and inflow rates to maintain the water volume in the reservoir within the allowable storage limits fig 11e denotes the fluctuations of the numerical values of the objective functions retained after 100 algorithm runs for each compared optimizer except for the operation period of 1963 1964 the average optimal values found by master slave are considerably better than those obtained using the crow method despite having found relatively higher objective function values for 1961 1962 1964 1965 and 1967 1968 the solution consistency and accuracy of the proposed method are satisfactory and more convincing when compared with those of crow fig 11e compares the accuracy of the optimal release curves established by the proposed master slave algorithm and crow it can be observed from fig 11e that the master slave release curves show a lower deficit for a decade of the reservoir operation period however it fails to capture the variations in downstream water demand in the time period between 1975 and 1976 this again resulted from the relatively high inflow rates into the reservoir throughout the corresponding time period the optimal release policy obtained by crow is quite convincing in this case regardless it heavily fails to estimate the water demand for 1972 1973 and 1979 1980 fig 11f depicts the optimum values of the objective function obtained after consecutive algorithm runs of the ensemble and crow optimizers for the time period between 1970 and 1980 although the amount of variation in the objective function values acquired using the master slave method after 100 algorithm runs is much higher when compared with those obtained by crow for each case the master slave method finds better results in terms of the minimum objective function value for each time period of reservoir operation fig 11g illustrates the optimal release curves generated by the master slave algorithm and crow along with the expected downstream water demand for the time period between 1980 and 1990 it can be observed from fig 11g that the release policy obtained by the master slave algorithm and crow fail to fulfill the demand in some operation cases during the aforementioned timeframe this is mainly due to the low inflow rates to the reservoir when compared with those observed in other cases 10 years of a time period as depicted in fig 10 furthermore crow considerably underestimates most of the water demand and shows a noticeable discrepancy in this case regardless the master slave algorithm shows better optimization performance than crow despite failing to meet the demand in most of the time period fig 11h visualizes the optimal objective function values obtained after successive algorithm runs the numerical values of the objective function for a time period of 10 years are much higher when compared with those of the former cases this behavior can be explained by the cumulative deficit between the demand and release values over the elapsed 10 years the best predictive performance shown by the master slave algorithm and crow for 10 years time span occurred during 1981 1982 with corresponding minimum objective function values of 0 8037 and 4 5608 the reservoir releases during each time period retained through the master slave algorithm and crow along with the required downstream water demands are presented and compared in fig 11e the release policy provided by these two algorithms is more than the water demand for the particular time period of 1998 2000 however the operation rule achieved by these two optimizers could not match the water demand for most of the months along the simulation years of 1990 1991 and 1997 1998 fig 11j denotes the visual summary of the optimal objective values obtained by the master slave algorithm and crow fig 13 demonstrates the numerical values of the performance indicators obtained through the predictive performance of the master slave algorithm and crow for every decade of the reservoir operation period the operation release policy produced by the optimization results attained more than 70 0 of the reliability for each comparison case except for the operation years between 1980 and 1990 however it is clear from the numerical comparisons that the release curve generated by the master slave algorithm is more reliable than that generated by crow such that it obtains higher reliability values when compared with that of crow for each comparison case the master slave based release policies are effective in recovering the reservoir system from a failure situation because it obtains better resilience rates in four of the five comparison cases reported in fig 13 it is also noticeable that the release policies generated by the master slave algorithm are less vulnerable to the failures or damages that occurred during five different reservoir operation time periods because it achieves low vulnerability index values in all the five comparison cases generally the applicability of the master slave algorithm and crow on optimal reservoir operation problems has been tested and comparative analysis over the statistical results and various performance indexes indicates that master slave shows a satisfactory model performance when compared with crow furthermore it provides significant and reasonable release curves for the monthly demand pattern with a minimum deficit for each time period and is nominated as a promising alternative for the optimal operation of ahd 5 3 comparison to the previous model to substantiate the superior performance of the proposed master slave over the previously developed optimization algorithm in the same case study a comparative analysis with the abc model developed by hossain and el shafie 2014 has been conducted the abc model calculations are as follows 36 10 of the obtained water release decisions are more than the demand 62 of the obtained water release decisions are equal to the demand and 1 90 of the obtained water release decisions are less than the demand however the master slave model resulted in water release decisions that 22 5 of which are more than the demand 75 is equal to the demand and 2 5 is less than the demand the resiliency values of the abc and master slave models are calculated as 14 5 and 31 38 respectively furthermore the vulnerability values of the abc and master slave models are obtained as 0 06 42 3 of the demand and 1 01 20 06 of the demand respectively the abc model has been examined for 10 years of simulated operation whereas the proposed master slave model has been examined based on 50 years of operation further the proposed master slave model has been evaluated by considering more flood and drought events than the abc model in terms of reliability master slave obviously outperformed the abc model for a number of release decisions equal to the demand which is the main target of the operation rule in addition if the percentage of the number of water release decisions are more than the demand of both the examined models it is clear that the proposed master slave could reduce this percentage from 36 1 to 22 5 indicating that the proposed master slave minimize the surplus water release for future needs however the abc model outperforms the proposed master slave in terms of the percentage of water deficits however it should be noted that the period of simulation for the abc model is only 10 years whereas it is 50 years for the proposed master slave which definitely includes a higher number of drought events and hence the possibility to an experienced higher number of deficit period is higher in addition it is clear that the difference between the percentages of the water release decisions is relatively small when compared with the difference in the number of years for simulation in terms of resilience the proposed master slave could attain better resilience hence the ability of the system with this optimal operation rule could rapidly recover and switch the system from being under a deficit condition to a match condition finally while studying the vulnerability it could be noticed that the abc model could achieve slightly better performance when compared with that of the proposed master slave this is due to the fact that the simulation period used to evaluate the performance of the proposed master slave is almost five times the period used to evaluate the abc model 5 4 operational rules fig 14 denotes the operation rule for ahd for january and july based on the proposed mso algorithm the major reason for the selection of these two months is to show the model performance for two different cases of water demand pattern and two different inflow patterns the proposed model for both the months could achieve an operation rule that the water release decision is mostly equal to the water demand at a relatively big range of reservoir storage in other words the proposed model could generate an operation rule that could match the demand in quite a long span of possible reservoir conditions in terms of its initial storage however there is a possibility to decide to release water less than the demand when the initial storage is relatively low and close to the value of the minimum capacity of the reservoir further the operation rule showed a necessity to release more than the demand when the initial storage is relatively high and near to the maximum capacity of the reservoir it should be noted that the fluctuation in the water release decision along with the whole operation rule is due to the fact that the proposed master slave puts on trial the detection of the stochastic nature in the inflow pattern and reflects that on the optimal water release value 6 conclusions five optimization algorithms have been established to derive operation rules for dam and reservoir water systems these models are pso crow de whale and the proposed master slave in fact the proposed master slave is considered to be a novel optimization algorithm procedure which is the main research objective the main contribution of this study is to investigate the potential of master slave to optimize the dam and reservoir water system these proposed models have been applied and adapted for the case study of one of the most complicated dam s reservoir namely ahd in our particular ahd case study the major reason for selecting ahd is that the ahd experienced significant fluctuation with respect to the inflow of the reservoir over the year highly stochastic nature variable and highly nonlinear constraints which are the main challenges associated with any optimization algorithm that should be considered while generating the operation rules the master slave algorithm has a high ability to detect and perceive the considerable stochastic nature and nonlinearity in the system under study in ahd case study master slave achieved an effective capability to derive an optimal operation rule that can successfully bridge the gap and achieved an optimal match for water supply demand patterns therefore the proposed master slave could be considered as a highly potential alternative optimization algorithm to be applied to similar highly nonlinear and stochastic engineering applications although master slave achieved superior performance for complex applications similar to the dam and reservoir water systems it is recommended to examine its performance that has to be generalized for several case studies in the future experiencing different climatic and hydrological conditions as well as dam scales declaration of competing interest none acknowledgment this research was funded by the university of malaya research grant umrg coded rp025a 18sus university of malaya malaysia appendix pseudo codes of the algorithms pseudo codes of particle swarm optimization crow search algorithm differential evaluation and whale optimization algorithm are given in figs a 1 a 2 a 3 and a 4 respectively 
6224,three approaches were compared for estimating continuous soil water characteristic curves swccs from easily accessible soil properties the approaches included combining the mohammadi and vanclooster 2011 method the mv method with the van genuchten 1980 model mv vg approach the modified mv vg approach and combining the jensen et al 2015 method with the fredlund and xing 1994 model the j fx approach a total of 195 disturbed soil samples and 195 undisturbed soil cores were collected from 1 m soil profiles in an arid region of northwestern china particle size distribution psd and organic matter om content were determined the volumetric water content and matric potential data pairs of each sample during the drying process were measured using a high speed centrifuge all of the measured soil properties were used to evaluate the applicability of the approaches for continuous swcc estimation the mv method has a robust physical basis and is independent of any experimental swcc data pairs some intrinsic shortcomings affect the estimation of continuous swcc by the mv vg approach the integration of a soil structure feature improved the estimation of the modified mv vg approach the estimation of the j fx approach for swcc is robust for the five textural classes and outperformed the mv vg approach and the modified mv vg approach the good performance of the j fx approach can be attributed in part to the fact that it distinguishes the dominant forces governing water retention of dry and wet ranges and relates the psd specific surface area and om content to the pore size distribution all these factors are vital for soil water retention but have been simplified or ignored by the mv method both the modified mv vg approach and the j fx approach are promising for estimating continuous swccs at a regional scale the modified mv vg approach may be suitable for rigid soils with medium textures at potentials above wilting point the j fx approach is applicable for the whole range of water retention from saturation to oven dryness for soils with substantially varying bulk density soil texture and organic matter content at a regional scale the results of this study are fundamental for use in simulating the transfer of water and solutes in layered structured soil profiles and for estimating the vegetation carrying capacity of soil available water in arid regions keywords soil water retention pore size distribution particle size distribution predictive models pedotransfer function 1 introduction accurate determination of a soil water characteristic curve swcc is essential for understanding soil water related processes such as irrigation scheduling evaporation drainage solute transfer and water availability for plants in the vadose zone discrete data pairs of soil water content θ cm3 cm 3 and matric potential ψ cm water on the swcc can be determined by laboratory or field measurement direct measurements are primarily conducted for matric potentials above 104 2 cm water below pf 4 2 pf log 10 ψ and is sometimes impractical for application at a large and fine spatial scale due to low representativeness and long equilibrium times at small matric potential values bittelli and flury 2009 jensen et al 2015 various pedotransfer functions ptfs have acted as feasible alternatives for estimating either discrete θ ψ data pairs or parameters of the swcc by using easily accessible soil properties schaap et al 2001 gijsman et al 2003 nemes and rawls 2006 bayat et al 2013 ramos et al 2014 pachepsky et al 2015 however the applications of empirical ptfs have to be adapted to the specific situations in individual studies gijsman et al 2003 naveed et al 2012 antinoro et al 2014 pachepsky et al 2015 some point based ptfs using simple linear expressions to estimate the swcc from particle fractions usually yield discontinuous sets of θ ψ data pairs within the range of matric potentials during measurement which is usually at large or medium water contents khlosi et al 2008 bittelli and flury 2009 naveed et al 2012 karup et al 2017 several closed form parametric ptfs for the continuous swcc are successful in the wet part but ignore the dry end of the curve the dry end however is crucial for processes affected by small water contents such as discharge of soil particles by wind water vapour diffusion and film flow process microbial activity n mineralization ch4 oxidation and volatilization of organic compounds khlosi et al 2008 arthur et al 2014 karup et al 2017 some semi physical arya and paris 1981 arya et al 1999 and conceptual methods mohammadi and vanclooster 2011 meskini vishkaee et al 2014 arya and heitman 2015 have been proposed based on hypotheses and treatments between ideal and naturally structured soils the theory of these methods is based on the shape similarity between swcc and particle size distribution psd due to the close association between psd and pore size distribution the scaling parameter of α in the semi physical method of arya and paris 1981 is originally derived from measured θ ψ values and has been progressively modified to improve the swcc estimation arya et al 1999 vaz et al 2005 the application of semi physical methods reduced the dependence on measurements of water retention data however the few empirical parameters still rely on experimental θ ψ data pairs of individual studies arya et al 1999 antinoro et al 2014 arya and heitman 2015 on the contrary most conceptual methods have robust physical bases are independent of empirical or database related parameters and are promising for satisfactory estimations of swcc the semi physical and conceptual swcc methods can estimate water retention with high accuracy for example combined with the swcc model of van genuchten 1980 the mohammadi and vanclooster 2011 method mv method the combination is denoted as the mv vg approach hereafter outperformed the methods of arya et al 1999 and arya and heitman 2015 in estimating the swcc in an arid region of northwestern china li et al 2016 however these methods fail to distinguish the dominant forces governing water retention at the dry and wet ranges lebeau and konrad 2010 tokunaga 2011 and do not consider the effects of soil aggregation organic matter om and preferential pathways such as root channels cracks and wormholes on water retention arya et al 1999 mohammadi and vanclooster 2011 li et al 2016 using the concept of bundle of cylindrical capillaries to represent the pore space geometry and ignoring the surface forces will lead to the underestimation of the dry range of the swcc meskini vishkaee et al 2014 mohammadi and meskini vishkaee 2012 quantified the volume of water lens between soil particles and adsorbed water films coating soil particles to incorporate the contribution of interfacial area from water air interfaces in the corners of irregular and angular pore spaces meskini vishkaee et al 2014 integrated a soil particle packing scaling factor into the swcc estimation of the mv vg approach the modified mv vg approach efforts have been made to accurately represent the continuous swcc for ψ values over the entire range of water contents by extending the well known models of brooks and corey 1964 and van genuchten 1980 campbell and shiozawa 1992 fredlund and xing 1994 webb 2000 groenevelt and grant 2004 khlosi et al 2006 2008 however the performances of these extended methods are more or less dependent on measured data for example the fayer and simmons 1995 and webb 2000 models can extend the swcc to oven dryness using the given parameters of the van genuchten 1980 model and the performance of the fayer and simmons 1995 model would be affected by an error on one parameter estimated from the measured swcc data near the matric potential of 104 2 cm water the khlosi et al 2006 model has consistent good performances among different soils when having experimental water retention data above potentials of 501 cm water lu et al 2008 a continuous description of the swcc from saturation to oven dryness is essential which is preferably independent of the experimental θ ψ data and is able to distinguish the dominant water retention forces of the wet and dry ends jensen et al 2015 proposed a new two stage method to describe the continuous swcc from saturation to oven dryness using textural data om content saturated water content and dry bulk density this method relates the gravimetric soil fractions to adsorptive forces in the dry region and converts the volumetric particle size fractions to pore size fractions and utilizes the capillary rise equation in the wet region the entire swcc is in turn estimated by parameterizing the fredlund and xing 1994 model using the derived θ ψ data pairs in the dry and wet regions this method is hereafter denoted as the j fx approach in this study the consideration of both capillary and adsorptive contributions to water retention favors the adequate estimation of swcc from saturation to oven dryness using limited soil data in the arid inland river basins of northwestern china sandy desert coexists with cropland and meadow grassland in the middle reaches soils differ remarkably in psd structure and om content among layers in soil profiles and different landscapes li and shao 2014 the size connectivity and distribution of pores in soil greatly affected by these properties influence the transport of water and solute conductivity of heat and permeability of air in soil accurate representation of soil pores and estimation of complete soil water retention is fundamental for recognizing the exchange of water air and heat between soil and atmosphere therefore the objective of this study was to select the most suitable method for entire swcc estimation considering the complex soil and landscape patterns in the middle reaches of an inland river basin in northwestern china the parameters of the different approaches were derived from the measured psd om and bulk density values the performances of the approaches were validated by the experimental swcc data points 2 introduction of the approaches 2 1 the mv vg approach the mv method originates from the similarity between the shapes of swcc and pore size distribution the θ ψ data pairs are estimated for different particle fractions classified following arya and paris 1981 cumulative particle size distribution is divided into m m 20 fractions particles in the ith i 1 2 m fraction are assumed to assemble in a cubic closely packed structure consisting of uniform size spherical particles with solid mass wi and particle radius ri l respectively the bulk density ρb ml 3 and particle density ρs 2 65 ml 3 of naturally structured soils are assumed to be uniformly applicable to each fraction the void ratio e is given by 1 e ρ s ρ b ρ b the volumetric soil water content θi l3l 3 can be determined by dividing the progressive summation of the individual pore volumes from the first fraction to the ith fraction by the bulk volume of the sample arya et al 1999 arya and paris 1981 2 θ i θ s j 1 j i w j i 1 2 m where θs is the measured saturated soil water content l3l 3 and j is the jth particle size fraction in the assumed cubic close packed assemblage for each fraction eight spherical particles are needed to form the narrowest pore region the total volume and the solid volume of the cubic assemblage are equal to 4ri 3 and 8 4 π r i 3 3 respectively however more or less than eight particles are needed to form each assemblage in naturally structured soils a coefficient depending on the packing state ξ is introduced and the pore volume in the assemblage pvi l3 can then be calculated as mohammadi and vanclooster 2011 3 p v i 4 r i 3 8 ξ 4 π r i 3 3 the void ratio e of the assemblage can be determined by 4 e 4 r i 3 8 ξ 4 π r i 3 3 8 ξ 4 π r i 3 3 combining eqs 1 and 4 the coefficient ξ is given by 5 ξ 6 ρ b ρ s π the matric potential ψi l in a tube of general cross sectional shape of the naturally structured soil is then given by tuller et al 1999 mohammadi and vanclooster 2011 6 ψ i ξ c pi a pi γ cos θ ρ w g 12 ρ b γ ρ s 4 π ρ w g r i where cpi and api refer to the circumference 2πri and area 4 r i 2 π r i 2 of the cross section of the narrowest region of a single assembled pore respectively θ is the contact angle this method assumes perfect wettability θ 0 γ ρw and g are the surface tension at the air water interface 7 197 10 2 kg s 2 25 c density of water 997 1 kg m 3 and the acceleration due to gravity 9 81 m s 2 respectively for more details readers are referred to mohammadi and vanclooster 2011 the van genuchten swcc is widely used to describe discrete θ ψ data pairs and is given by van genuchten 1980 7 θ θ r θ s θ r 1 1 α ψ n m where θr is the residual soil water content l3l 3 α l 1 n and m are curve fitting parameters 2 2 the modified mv vg approach based on the assumption of θr 0 in the arya and paris 1981 method the integrated mv vg approach is given by meskini vishkaee et al 2014 8 j 1 j i w j 1 1 α 12 ρ b γ ρ s 4 π ρ w g r i n m by fitting eq 8 to measured psd data the parameters of α l 1 n and m can be determined mohammadi and meskini vishkaee 2013 pointed out that ignoring of θr would contribute to underestimation in the dry range of the swcc a scaling factor λ is suggested for each soil sample by 9 λ ξ ξ max ρ b 1 e min ρ s where ξmax and emin refer to the maximum value of packing parameter and the minimum value of void ratio for ideal soil which is assumed to consist of uniform size spherical particles arranged in random close packing state meskini vishkaee et al 2014 the value of emin is determined using the minimum porosity for ideal soil 0 259 hopkins and stillinger 2009 by introducing λ the parameter n in eq 8 can be scaled and eq 7 can be given by 10 θ θ s 1 1 α ψ λ n m where parameters α n and m are obtained by fitting eq 8 to experimental psd data detailed instruction of this approach was given in meskini vishkaee et al 2014 2 3 the j fx approach the dominant forces governing water retention at the wet and dry ranges of the swcc are capillary and adsorption forces respectively or and tuller 1999 tuller et al 1999 antinoro et al 2014 jensen et al 2015 accordingly separated the wet and dry ranges of the swcc at potentials of 104 2 cm water and proposed equations to determine the volumetric water contents for both matric potential ranges 2 3 1 wet range in a naturally structured soil soil particles are intermixed which reduces the pore size generated by bigger particles and increases the volume of small pores chan and govindaraju 2004 a squared summation of the relative volumetric particle size fractions is used to account for the mixing of soil particles the θ ψi l3l 3 is calculated as 11 θ ψ i θ s θ s j 1 j i v j ψ 2 where ψ is the matric potential l vj ψ is the relative volume of the j th fraction l3l 3 given by the volume of the j th fraction divided by the total volume of the soil this equation is only applicable for potentials above 1000 cm water corresponding to fractions of coarse sand 0 25 2 mm and fine sand 0 02 0 25 mm due to the lack of linearity between water content and the volume size fractions jensen et al 2015 extension of this equation for lower potentials is as follows jensen et al 2015 12 θ ψ θ s 1 v cs v fs β 1 v s β 2 α where β1 and β2 are parameters determining the pores filled partially filled or completely drained α refers to the cumulated volume fraction l3l 3 vcs vfs and vs are the relative volume fraction l3l 3 of coarse sand fine sand and silt 0 002 0 02 mm respectively general parameters of β1 β2 and α given in jensen et al 2015 are recommended for predicting the wet range swcc for any soil table 1 2 3 2 dry range water retention in the dry range is dominated by adsorption and is controlled by the specific surface area which is affected by the contents of fine particles including clay 0 002 mm silt and om wuddivira et al 2012 arthur et al 2014 jensen et al 2015 jensen et al 2015 proposed a regression model to calculate the volumetric water content at potentials of 106 cm water pf 6 θpf6 l3l 3 13 θ p f 6 0 08 c l a y 2 o m 0 15 s i l t ρ b where clay om and silt are the clay organic matter and silt contents mm 1 respectively 0 08 and 0 15 are the best fit empirical parameters jensen et al 2015 respectively and the coefficient of 2 is the weighting factor for om because its particle density is about half that of clay minerals hansen 1976 jensen et al 2015 the volumetric water contents for the dry range are calculated by adopting the linearity relationship of potential and the water content between 104 cm water and oven dryness campbell and shiozawa 1992 jensen et al 2015 14 θ ψ θ p f 6 6 9 log 10 ψ 6 9 6 where 6 9 is the pf at oven dryness arthur et al 2013 the fredlund and xing 1994 model is regarded to be applicable for the entire matric potential range and is given by 15 θ c ψ θ s ln e ψ a n m c ψ 1 ln 1 ψ ψ r ln 1 ψ max ψ r where e is the natural constant 2 718 ψr and ψmax are the residual and oven dry matric potential values l corresponding to 104 2 cm water and 106 9 cm water respectively and α n and m are fitting parameters obtained by nonlinear regression 3 materials and methods 3 1 study area and sampling soil samples were collected in a rectangular area 39 12 30 39 23 28 n 100 05 32 100 10 01 e 1372 1417 m a s l with a length of 20 km from north to south and a width of 5 km from east to west in the middle reaches of the heihe river in northwestern china fig 1 this region has a continental arid climate heterogeneous soils in both the vertical and horizontal directions and complex landscape patterns a detailed description of the study area can be found in li and shao 2013 and li et al 2016 thirty nine locations were selected representing desert 16 locations cropland 17 locations and grassland 6 locations in the rectangular area disturbed soil samples were collected using a 5 cm diameter hand auger at an interval of 20 cm down to a depth of 1 m and soil samples for each layer were taken with three duplicates randomly collected in a 5 5 m plot at each location five undisturbed soil cores were collected at the same depth intervals using stainless steel cutting rings 5 0 cm in height by 5 0 cm in diameter to a depth of 1 0 m at each location 3 2 laboratory measurements of soil properties in the laboratory air dried disturbed soil samples were divided into two sub samples and passed through a 0 25 mm sieve for determining soil organic carbon content and a 2 mm sieve for measuring the psd respectively the content of soil om contents were determined through multiplying the soil organic carbon concentration determined by dichromate oxidation nelson and sommers 1982 by 1 724 according to the instruction in the textbook of soil agro chemical analysis bao 2000 the soil psd was measured by laser diffraction using a mastersizer 2000 analyzer malvern instruments malven england to determine the water retention of various fractions using the mv method the soil psd was accordingly classified into 20 fractions with boundaries at particle diameters of 0 001 0 002 0 007 0 008 0 01 0 02 0 03 0 04 0 05 0 06 0 07 0 08 0 1 0 15 0 2 0 25 0 4 0 5 0 8 and 2 mm during the measurement measured soil textures covered five classes sand sandy loam sandy clay loam clay loam and loamy clay according to the international society of soil science table 2 the weight of each undisturbed soil core was measured after its saturation from below the θ ψ data pairs during the drying process were measured using a high speed centrifuge nimmo et al 2002 the weight of the core after decanting was measured when ψ values of 10 51 102 204 408 612 816 1020 2040 4081 6121 8161 and 10202 cm water were reached sequentially the information of the centrifuge time and angular velocity corresponding to each potential value was shown in supplementary information finally the soil core was oven dried at 105 c for 48 h and the dry weight of the solid mass was measured to determine the bulk density this steady state centrifuge method combines the advantages of simplicity and accuracy with the speed and versatility afforded by centrifugal force which permits a decrease in measurement time and or an increase in the range of ψ values to be determined for various textures this method can yield nearly uniform water content distributions and is useful in situations where compaction is not significant or where it is desired to measure hydraulic properties with oven burden pressures approximating those under field conditions this method allows the body force to be set at a desired value and to know the approximate values of both θ and ψ while a series of measurements is in progress nimmo et al 2002 3 3 evaluating the approaches the measured psd bulk density and om content values were used to calculate the θ ψ data pairs of the swcc twenty points were obtained for each sample by the mv method eleven reference points were estimated for each sample using the jensen et al 2015 method with six points in the dry region at potentials of 105 2 cm water 105 5 cm water 105 7 cm water 106 0 cm water 106 3 cm water and 106 5 cm water and five points for the wet range at potentials of 50 cm water 100 cm water 158 cm water 501 cm water and 1000 cm water respectively the best fit parameters were obtained using the retc program van genuchten et al 1991 for the mv vg approach and by employing the iterative non linear regression procedure using the matlab 7 0 software for the modified mv vg approach and the j fx approach at the thirteen experimental ψ values aforementioned the θ values estimated by different approaches were compared with the measured θ values three statistical criteria were used to evaluate the performance of the approaches including the coefficient of determination r2 the mean error me l3l 3 and the root mean square error rmse l3l 3 which are given by 16 r 2 i 1 n o i o p i p i 1 n o i o 2 0 5 i 1 n p i p 2 0 5 2 17 me 1 n i 1 n p i o i 18 rmse i 1 n p i o i 2 n where oi and pi are the measured and estimated values of the ith sample respectively o and p are the averages of the measurements and estimations respectively and n is the number of samples based on the evaluation the parameterized approaches were further assessed on the dry range by comparing the estimation of soil water contents at potentials of 104 2 cm water 105 cm water 105 5 cm water 106 cm water 106 5 cm water and 106 9 cm water 4 results and discussion 4 1 combining the mv method with the two models for each soil sample with twenty particle size fractions the mv method was used to calculate the θ ψ data pairs which were then used to parameterize the fredlund and xing 1994 model or the van genuchten 1980 model soil water contents at the thirteen experimental ψ values were accordingly determined and compared with the measured data for evaluating the performances for swcc estimation the three free parameters α n and m in the fredlund and xing 1994 model were well fit by nonlinear regression analysis with high coefficients of determination r2 0 993 although this model is modified from the van genuchten 1980 model the values of each parameter deviated greatly from the ranges of those in the van genuchten 1980 model parameter α approximated the upper limit set during the nonlinear minimization process indicating that the high r2 value is not enough for guaranteeing the meaningful definition of parameters fredlund and xing 1994 reported that parameter α decreased from 9 71 cm water for a sandy soil to 154530 cm water for a clay soil in this study we set wide value ranges for α n and m parameters during the fitting after considering the given values for various soil textural classes in fredlund and xing 1994 however the combination of the mv method with the fredlund and xing 1994 model fails to give realistic estimations of continuous swccs the slope value of 0 530 and positive value of me 0 181 suggest the overestimation at the thirteen ψ values and the low value of r2 0 291 large values of me and rmse 0 203 indicate the inaccuracy of the estimation fig 2 a the fredlund and xing 1994 model is a modification of the van genuchten 1980 model and is regarded to be applicable over the suction range of 0 107 cm water if the measured or estimated θ ψ data pairs are available the lowest ψ value calculated by the mv method corresponding to the smallest particles with mean radius of 0 002525 mm was 28 940 cm water among all of the samples this value was far above the value for zero water content of 106 cm water campbell and shiozawa 1992 106 9 cm water groenevelt and grant 2004 arthur et al 2013 or 107 cm water croney and coleman 1961 richards 1965 the absence of calculated θ ψ data pairs at high suctions may affect the parameter fit when combining the mv method with the fredlund and xing 1994 model the van genuchten 1980 model fits the estimated θ ψ data pairs well with r2 0 990 for the five textural classes table 3 the mv vg approach well estimated the θi values at the experimental ψi values fig 2b this result coincides with li et al 2016 who reported that the mv vg approach outperformed the semi physical arya and paris 1981 method and the empirical rosetta program schaap et al 2001 in estimating the soil water retention however the scatter of a majority of points above the 1 1 line and the negative me value indicate the overall underestimation of this approach for some loamy clay soils the estimated θi values were remarkably lower than the experimental values the underestimation of the dry range soil moisture content by the mv vg approach for fine textured soils has been previously reported mohammadi and vanclooster 2011 mohammadi and meskini vishkaee 2013 li et al 2016 fine textured soils have an abundant amount of clay minerals and om which are characterized with high porosity and high surface energy meskini vishkaee et al 2014 in the van genuchten 1980 model the volumetric water content is modified by referencing to zero water content and the normalized volumetric water content to account for the gradual air entry at suctions near saturation fredlund and xing 1994 the van genuchten 1980 model thus generally gives satisfactory approximations at large and medium water contents but has difficulty in representing the retention of the dry end khlosi et al 2006 2008 lu et al 2008 factors not fully involved such as non linearity between psd and pore size distribution aggregation complex pore geometry root channels structural cracks and wormholes hysteresis om content as well as volume change of clay fraction upon wetting and drying will all contribute to the disparities arya and paris 1981 rouault and assouline 1998 or and tuller 1999 hwang and powers 2003 pachepsky and rawls 2003 antinoro et al 2014 for multicomponent particle systems such as soils the relation between the sphere size and void size may be not a simple linear relationship and the pore volume may be not proportional to the particle volume rouault and assouline 1998 hwang and powers 2003 the aggregation microcracks and root channels would account for a fraction of the pore volume with radii not determined by the primary particle distribution the relative abundance of these pores would determine the extent to which the estimation would deviate from the reality arya and paris 1981 during the alternating periods of wetting and drying hysteresis for the swcc occurs and increases when texture becomes finer and the width of the hysteresis loop increases with increasing specific surface globus and neusypina 2006 significant hysteresis is reported for different soils from the intermediate moisture to the dry end globus and neusypina 2006 prunty and bell 2007 davis et al 2009 lu and khorshidi 2015 distinguished the particle surface hydration mechanism for little hydraulic hysteresis in non swelling soil kaolinite and the interlayer exchangeable cation hydration mechanism for strong hysteresis in swelling soil montmorillonite for high suction range the lack of consideration of surface forces suggests that the mv method cannot reflect the effect of hysteresis the mv method describes the pore space geometry using the concept of bundle of cylindrical tubes which ignores the porosity change caused by clay fraction during the wetting and drying the water filled corners pendular spaces and water films the incomplete desorption of residual water would lead to higher experimental θ values in the dry range or and tuller 1999 mohammadi and vanclooster 2011 antinoro et al 2014 the insufficient reflection of pore geometry by the packing parameter ξ and possible disagreement between the theoretical porosity and experimental maximum volumetric water content may also contribute to the estimation error many studies pointed out the importance of incorporating the contribution of interfacial area from water air interfaces in the corners of irregular and angular pore spaces dillard and blunt 2000 helland and skjæveland 2007 shahraeeni and or 2010 gras et al 2011 this study calculated the volume of water lens between soil particles and adsorbed water films coating soil particles using experimental psd and bulk density following mohammadi and meskini vishkaee 2012 and evaluated their influences on swcc estimation by the mv vg approach the lens water volume was expressed as matric suction independent pendular rings and the adsorbed water film volume was estimated with van der walls and electrostatic forces table 3 shows the maximum and average values of the lens water content and the content of adsorbed water film as well as their relative contributions to the volumetric water content for five soil textural classes the maximum value of lens water content εi varied from 0 0537 cm3 cm 3 for loamy clay soil to 0 0732 cm3 cm 3 for sandy soil the mean εi value increased from 0 0223 cm3 cm 3 for sandy soil to 0 0410 cm3 cm 3 for loamy clay soil the mean εi value for sandy clay loam 0 0377 cm3 cm 3 and clay loam 0 0361 cm3 cm 3 approximated to the values 0 0412 cm3 cm 3 and 0 0352 cm3 cm 3 for the two textural classes respectively reported by mohammadi and meskini vishkaee 2012 the value of εi θi decreased from 0 17 for sandy soil to 0 12 for clay loam soil suggesting that the contribution of lens water decreased with the increasing fine particle fractions mohammadi and meskini vishkaee 2012 explained that the water content in small pores of sandy soil is relatively low and the volume of lens water is accounted for with larger pores containing more water except for sandy soil the εi θi values for the other four textural classes were higher than those reported in mohammadi and meskini vishkaee 2012 the average value of εi θi for the five textural classes was 0 14 indicating that 14 of the water content of each pore was from lens water this value was lower than the reported value of 0 26 in mohammadi and meskini vishkaee 2012 these results suggest the differences in surface area pore geometry thus water status between soils within a textural class the maximum and mean values of adsorbed water film content δi cm3 cm 3 increased with increasing fine particle fractions table 3 the mean δi value was lower than that for the same textural class in mohammadi and meskini vishkaee 2012 the values of δi θi were nearly equal among the five textural classes with an average of 0 01 the lower values of δi and δi θi indicate the lower contribution of adsorbed water film to soil water content when compared to lens water the incorporation of both εi and δi into θi calculated using eq 2 for each particle fraction was assumed to be useful to improve the estimation of the mv vg approach fig 3 a shows the comparison in soil water content between the estimations and measurements at the thirteen experimental ψ values less points above the 1 1 line reflects the improvement of soil water content estimation in the dry range the incorporation of lens and film water volume generally improved the estimation of swcc by 3 7 when compared to the raw mv vg approach however the incorporation of lens water and adsorbed water film is unable to adequately estimate the residual water considering the lack in treatment of larger dead end pores om content roughness of soil particles and other unknown factors 4 2 the modified mv vg approach parameters α n and m of the modified mv vg approach differed slightly from those of the mv vg approach table 4 the r2 values varied from 0 957 for sandy loam soil to 0 987 for sandy soil indicating the good performance of the non linear regression procedure during parameterization the values of parameter α of the mv vg approach and the modified mv vg approach both decreased with increasing fine particle fractions table 4 this corresponded to the increased air entry pressure from coarse to fine textured soils fig 3b shows the comparison in θi values between the estimation by the modified mv vg approach and the measurement the majority of the points were tightly concentrated around the 1 1 line and the integration of soil structure feature improved the swcc estimation by 11 than the raw mv vg approach fig 3b this concurs with the report by meskini vishkaee et al 2014 that the scaled mv vg approach can improve the swcc estimations by 30 however the value of emin in eq 9 would affect the θ estimations in this study it was estimated from the minimum porosity of 0 259 given in hopkins and stillinger 2009 the porosity of 0 259 corresponds to the possible maximum 0 741 of the packing fractions for congruent hard spheres in three dimensions hopkins and stillinger 2009 pointed out that a disordered packing may approach higher terminal packing fractions up to but not reaching 0 741 smaller packing fractions of actual soil particles lead to larger values of porosity in turn larger emin values the corresponding θ values estimated by eq 10 would be smaller this indicates that using ideal minimum porosity of 0 259 might result in overestimation of soil water contents by the modified mv vg approach 4 3 the j fx approach the parameters α n and m of the fredlund and xing 1994 model were well fit using the eleven θ ψ data pairs for each sample high clay content can increase the specific surface area of soil matrix and enhance water adsorption botula et al 2012 arthur et al 2015 the value of parameter α increased with the increasing fine particle fractions fig 4 a because of its close correlation slightly higher than or equal to with the air entry suction fredlund and xing 1994 no obvious correlations were observed between the n and m parameters and the contents of clay and om when pooling all data together most values of n and m ranged from 1 to 2 and from 0 to 1 respectively fig 4 however the values of both n and m decreased with the refining of soil textures table 4 furthermore the values of n and m decreased remarkably with an increase in clay or silt contents when the contents of clay or silt were less than 10 fig 4b and 4c corresponding to sandy soil and loamy sand soil parameter n controls the slope of the swccs higher values of n give sharp corners near the air entry pressure while smaller m values produce moderate slopes in the high potential range fredlund and xing 1994 the variation of these three parameters is consistent with the shape of swccs of different soil textural classes the j fx approach performed well in estimating the θi values at the experimental ψi values the value of r2 0 846 was higher and the deviation of the estimation from the measurement me 0 0016 cm3 cm 3 rmse 0 0509 cm3 cm 3 fig 5 was less than those of the mv vg and the modified mv vg approaches fig 2b and 3b examples of the estimated swccs by different approaches with the least and largest deviations from the measurements for the five textural classes are given in fig 6 although soil structure features are integrated into the estimation by scaling the parameter n from the mv vg approach the values of parameters α and m remain unchanged estimations of the modified mv vg approach approximated to those of the mv vg approach the j fx approach generally gave more accurate estimations except for one sample of the sandy loam fig 6d and the loamy clay fig 6j respectively at the lowest experimental potential 10202 cm water soil water contents estimated by the j fx approach agreed better slope 0 968 r2 0 780 with the measured values than those by the modified mv vg approach slope 1 189 r2 0 686 permanent wilting point at potentials of 104 2 cm water is in theory larger than the values of θr the introduction of scaling factor λ in the modified mv vg approach seems to be not enough to compensate the effects of ignoring the θr the θ values at potentials of 104 2 cm water estimated by the modified mv vg approach were smaller than those by the j fx approach especially for the sandy soil and the remarkably low values of which seem to be abnormal tables 5 and 6 the θ values should not decrease sharply when potentials decreased from 104 0 cm water to 104 2 cm water the modified mv vg approach underestimated while the j fx approach gave satisfactory estimation of the θ values of wilting point tables 5 and 6 the potential of 106 9 cm water was regarded as the oven dryness condition with ideal zero water content groenevelt and grant 2004 arthur et al 2013 five textural classes all showed low but not zero values of θ estimated by the modified mv vg approach especially for the loamy clay soil table 5 the variation of θ values among samples within a textural class increased with the decreasing potentials for the two approaches tables 5 and 6 the absolutely lower values of coefficients of variation indicate that the j fx approach gave much concentrated estimations the j fx approach generally outperformed the modified mv vg approach in describing the dry region descriptions of soil properties and empirical parameters required and performances of different approaches involved in this study in estimating the swcc were summarized in table 7 organic matter plays a central role on water adsorption of coarse textured soils arthur et al 2014 whereas clay and om contents are the chief controlling factors for water adsorption of fine textured soils rawls et al 2004 naveed et al 2012 the effect of silt fraction on water adsorption of the dry range is more evident for soils with high silt and low clay contents jensen et al 2015 by taking into account the silt clay and om fractions the j fx approach effectively improved the estimation for the dry range swccs however this study used the empirical values of β1 and β2 in eq 12 and empirical coefficients of 0 08 and 0 15 in eq 13 given in jensen et al 2015 a calibration in specific studies seems to be necessary for better fit to the experimental data zero water content is usually considered in models for dry range water contents although it exists in neither theory nor practice the potential corresponding to zero water content was regarded as being a constant no matter the soil type fredlund and xing 1994 the value of 106 9 cm water has been proposed groenevelt and grant 2004 arthur et al 2013 instead of 107 campbell and shiozawa 1992 and 106 cm water croney and coleman 1961 richards 1965 as the matric potential for oven dryness however it has been pointed out that all soil water is in the form of tightly adsorbed water and the swcc is solely controlled by soil mineralogy for matric potentials lower than 105 cm water and the lower limit of this regime is not a unique number lu and khorshidi 2015 for example the linear extrapolation of the measured θ values from potential of 105 cm water to potential of 106 5 cm water provided several matric potential values of zero water content for soils with varying om contents karup et al 2017 using the unique value of 106 9 cm water as the matric potential of oven dryness for the five textural classes in this study might contribute to deviation in the estimations of the j fx approach from the measurements 5 conclusions this study aimed at looking for a feasible approach using easily accessible soil properties to estimate the entire swcc the performances of different approaches were evaluated by independently measured θ ψ data pairs of 195 undisturbed soil samples the mv method had a robust physical basis and was independent of any experimental θ ψ data pairs and database related parameters its combination with the fredlund and xing 1994 model performed worse than the mv vg approach the simplified pore geometry and the neglect of the surface areas of clay particles and om affected the swcc estimation by the mv vg approach the incorporation of lens water and adsorbed water films into the mv vg approach improved the estimation by 3 7 and the integration of soil structure features improved the swcc estimation by 11 however the mv method ignores the difference in governing forces between dry and wet ranges and requires at least twenty fractions of psd which are usually difficult to obtain in routine measurements the j fx approach separated the dry and wet ranges and related the psd specific surface area and om content to the pore size distribution the j fx approach matched the experimental data well and generally outperformed the mv vg and the modified mv vg approaches the j fx approach is expected to provide reliable estimations of the whole range water retention for soils with varying bulk density soil texture and om content further insights into the physical meaning of parameters α n and m more experimental θ ψ data pairs at high suction and samples from highly structured soils and from soils with more expansive clays or pronounced hysteresis behavior are necessary to calibrate the empirical parameters of the j fx approach for improving the entire swcc estimation declaration of competing interest none acknowledgements this study was financially supported by the strategic priority research program of the chinese academy of sciences xda19040500 and the national natural science foundation of china 41701251 the authors sincerely thank the two anonymous reviewers who provided constructive comments and suggestion to improve the quality of this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123971 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6224,three approaches were compared for estimating continuous soil water characteristic curves swccs from easily accessible soil properties the approaches included combining the mohammadi and vanclooster 2011 method the mv method with the van genuchten 1980 model mv vg approach the modified mv vg approach and combining the jensen et al 2015 method with the fredlund and xing 1994 model the j fx approach a total of 195 disturbed soil samples and 195 undisturbed soil cores were collected from 1 m soil profiles in an arid region of northwestern china particle size distribution psd and organic matter om content were determined the volumetric water content and matric potential data pairs of each sample during the drying process were measured using a high speed centrifuge all of the measured soil properties were used to evaluate the applicability of the approaches for continuous swcc estimation the mv method has a robust physical basis and is independent of any experimental swcc data pairs some intrinsic shortcomings affect the estimation of continuous swcc by the mv vg approach the integration of a soil structure feature improved the estimation of the modified mv vg approach the estimation of the j fx approach for swcc is robust for the five textural classes and outperformed the mv vg approach and the modified mv vg approach the good performance of the j fx approach can be attributed in part to the fact that it distinguishes the dominant forces governing water retention of dry and wet ranges and relates the psd specific surface area and om content to the pore size distribution all these factors are vital for soil water retention but have been simplified or ignored by the mv method both the modified mv vg approach and the j fx approach are promising for estimating continuous swccs at a regional scale the modified mv vg approach may be suitable for rigid soils with medium textures at potentials above wilting point the j fx approach is applicable for the whole range of water retention from saturation to oven dryness for soils with substantially varying bulk density soil texture and organic matter content at a regional scale the results of this study are fundamental for use in simulating the transfer of water and solutes in layered structured soil profiles and for estimating the vegetation carrying capacity of soil available water in arid regions keywords soil water retention pore size distribution particle size distribution predictive models pedotransfer function 1 introduction accurate determination of a soil water characteristic curve swcc is essential for understanding soil water related processes such as irrigation scheduling evaporation drainage solute transfer and water availability for plants in the vadose zone discrete data pairs of soil water content θ cm3 cm 3 and matric potential ψ cm water on the swcc can be determined by laboratory or field measurement direct measurements are primarily conducted for matric potentials above 104 2 cm water below pf 4 2 pf log 10 ψ and is sometimes impractical for application at a large and fine spatial scale due to low representativeness and long equilibrium times at small matric potential values bittelli and flury 2009 jensen et al 2015 various pedotransfer functions ptfs have acted as feasible alternatives for estimating either discrete θ ψ data pairs or parameters of the swcc by using easily accessible soil properties schaap et al 2001 gijsman et al 2003 nemes and rawls 2006 bayat et al 2013 ramos et al 2014 pachepsky et al 2015 however the applications of empirical ptfs have to be adapted to the specific situations in individual studies gijsman et al 2003 naveed et al 2012 antinoro et al 2014 pachepsky et al 2015 some point based ptfs using simple linear expressions to estimate the swcc from particle fractions usually yield discontinuous sets of θ ψ data pairs within the range of matric potentials during measurement which is usually at large or medium water contents khlosi et al 2008 bittelli and flury 2009 naveed et al 2012 karup et al 2017 several closed form parametric ptfs for the continuous swcc are successful in the wet part but ignore the dry end of the curve the dry end however is crucial for processes affected by small water contents such as discharge of soil particles by wind water vapour diffusion and film flow process microbial activity n mineralization ch4 oxidation and volatilization of organic compounds khlosi et al 2008 arthur et al 2014 karup et al 2017 some semi physical arya and paris 1981 arya et al 1999 and conceptual methods mohammadi and vanclooster 2011 meskini vishkaee et al 2014 arya and heitman 2015 have been proposed based on hypotheses and treatments between ideal and naturally structured soils the theory of these methods is based on the shape similarity between swcc and particle size distribution psd due to the close association between psd and pore size distribution the scaling parameter of α in the semi physical method of arya and paris 1981 is originally derived from measured θ ψ values and has been progressively modified to improve the swcc estimation arya et al 1999 vaz et al 2005 the application of semi physical methods reduced the dependence on measurements of water retention data however the few empirical parameters still rely on experimental θ ψ data pairs of individual studies arya et al 1999 antinoro et al 2014 arya and heitman 2015 on the contrary most conceptual methods have robust physical bases are independent of empirical or database related parameters and are promising for satisfactory estimations of swcc the semi physical and conceptual swcc methods can estimate water retention with high accuracy for example combined with the swcc model of van genuchten 1980 the mohammadi and vanclooster 2011 method mv method the combination is denoted as the mv vg approach hereafter outperformed the methods of arya et al 1999 and arya and heitman 2015 in estimating the swcc in an arid region of northwestern china li et al 2016 however these methods fail to distinguish the dominant forces governing water retention at the dry and wet ranges lebeau and konrad 2010 tokunaga 2011 and do not consider the effects of soil aggregation organic matter om and preferential pathways such as root channels cracks and wormholes on water retention arya et al 1999 mohammadi and vanclooster 2011 li et al 2016 using the concept of bundle of cylindrical capillaries to represent the pore space geometry and ignoring the surface forces will lead to the underestimation of the dry range of the swcc meskini vishkaee et al 2014 mohammadi and meskini vishkaee 2012 quantified the volume of water lens between soil particles and adsorbed water films coating soil particles to incorporate the contribution of interfacial area from water air interfaces in the corners of irregular and angular pore spaces meskini vishkaee et al 2014 integrated a soil particle packing scaling factor into the swcc estimation of the mv vg approach the modified mv vg approach efforts have been made to accurately represent the continuous swcc for ψ values over the entire range of water contents by extending the well known models of brooks and corey 1964 and van genuchten 1980 campbell and shiozawa 1992 fredlund and xing 1994 webb 2000 groenevelt and grant 2004 khlosi et al 2006 2008 however the performances of these extended methods are more or less dependent on measured data for example the fayer and simmons 1995 and webb 2000 models can extend the swcc to oven dryness using the given parameters of the van genuchten 1980 model and the performance of the fayer and simmons 1995 model would be affected by an error on one parameter estimated from the measured swcc data near the matric potential of 104 2 cm water the khlosi et al 2006 model has consistent good performances among different soils when having experimental water retention data above potentials of 501 cm water lu et al 2008 a continuous description of the swcc from saturation to oven dryness is essential which is preferably independent of the experimental θ ψ data and is able to distinguish the dominant water retention forces of the wet and dry ends jensen et al 2015 proposed a new two stage method to describe the continuous swcc from saturation to oven dryness using textural data om content saturated water content and dry bulk density this method relates the gravimetric soil fractions to adsorptive forces in the dry region and converts the volumetric particle size fractions to pore size fractions and utilizes the capillary rise equation in the wet region the entire swcc is in turn estimated by parameterizing the fredlund and xing 1994 model using the derived θ ψ data pairs in the dry and wet regions this method is hereafter denoted as the j fx approach in this study the consideration of both capillary and adsorptive contributions to water retention favors the adequate estimation of swcc from saturation to oven dryness using limited soil data in the arid inland river basins of northwestern china sandy desert coexists with cropland and meadow grassland in the middle reaches soils differ remarkably in psd structure and om content among layers in soil profiles and different landscapes li and shao 2014 the size connectivity and distribution of pores in soil greatly affected by these properties influence the transport of water and solute conductivity of heat and permeability of air in soil accurate representation of soil pores and estimation of complete soil water retention is fundamental for recognizing the exchange of water air and heat between soil and atmosphere therefore the objective of this study was to select the most suitable method for entire swcc estimation considering the complex soil and landscape patterns in the middle reaches of an inland river basin in northwestern china the parameters of the different approaches were derived from the measured psd om and bulk density values the performances of the approaches were validated by the experimental swcc data points 2 introduction of the approaches 2 1 the mv vg approach the mv method originates from the similarity between the shapes of swcc and pore size distribution the θ ψ data pairs are estimated for different particle fractions classified following arya and paris 1981 cumulative particle size distribution is divided into m m 20 fractions particles in the ith i 1 2 m fraction are assumed to assemble in a cubic closely packed structure consisting of uniform size spherical particles with solid mass wi and particle radius ri l respectively the bulk density ρb ml 3 and particle density ρs 2 65 ml 3 of naturally structured soils are assumed to be uniformly applicable to each fraction the void ratio e is given by 1 e ρ s ρ b ρ b the volumetric soil water content θi l3l 3 can be determined by dividing the progressive summation of the individual pore volumes from the first fraction to the ith fraction by the bulk volume of the sample arya et al 1999 arya and paris 1981 2 θ i θ s j 1 j i w j i 1 2 m where θs is the measured saturated soil water content l3l 3 and j is the jth particle size fraction in the assumed cubic close packed assemblage for each fraction eight spherical particles are needed to form the narrowest pore region the total volume and the solid volume of the cubic assemblage are equal to 4ri 3 and 8 4 π r i 3 3 respectively however more or less than eight particles are needed to form each assemblage in naturally structured soils a coefficient depending on the packing state ξ is introduced and the pore volume in the assemblage pvi l3 can then be calculated as mohammadi and vanclooster 2011 3 p v i 4 r i 3 8 ξ 4 π r i 3 3 the void ratio e of the assemblage can be determined by 4 e 4 r i 3 8 ξ 4 π r i 3 3 8 ξ 4 π r i 3 3 combining eqs 1 and 4 the coefficient ξ is given by 5 ξ 6 ρ b ρ s π the matric potential ψi l in a tube of general cross sectional shape of the naturally structured soil is then given by tuller et al 1999 mohammadi and vanclooster 2011 6 ψ i ξ c pi a pi γ cos θ ρ w g 12 ρ b γ ρ s 4 π ρ w g r i where cpi and api refer to the circumference 2πri and area 4 r i 2 π r i 2 of the cross section of the narrowest region of a single assembled pore respectively θ is the contact angle this method assumes perfect wettability θ 0 γ ρw and g are the surface tension at the air water interface 7 197 10 2 kg s 2 25 c density of water 997 1 kg m 3 and the acceleration due to gravity 9 81 m s 2 respectively for more details readers are referred to mohammadi and vanclooster 2011 the van genuchten swcc is widely used to describe discrete θ ψ data pairs and is given by van genuchten 1980 7 θ θ r θ s θ r 1 1 α ψ n m where θr is the residual soil water content l3l 3 α l 1 n and m are curve fitting parameters 2 2 the modified mv vg approach based on the assumption of θr 0 in the arya and paris 1981 method the integrated mv vg approach is given by meskini vishkaee et al 2014 8 j 1 j i w j 1 1 α 12 ρ b γ ρ s 4 π ρ w g r i n m by fitting eq 8 to measured psd data the parameters of α l 1 n and m can be determined mohammadi and meskini vishkaee 2013 pointed out that ignoring of θr would contribute to underestimation in the dry range of the swcc a scaling factor λ is suggested for each soil sample by 9 λ ξ ξ max ρ b 1 e min ρ s where ξmax and emin refer to the maximum value of packing parameter and the minimum value of void ratio for ideal soil which is assumed to consist of uniform size spherical particles arranged in random close packing state meskini vishkaee et al 2014 the value of emin is determined using the minimum porosity for ideal soil 0 259 hopkins and stillinger 2009 by introducing λ the parameter n in eq 8 can be scaled and eq 7 can be given by 10 θ θ s 1 1 α ψ λ n m where parameters α n and m are obtained by fitting eq 8 to experimental psd data detailed instruction of this approach was given in meskini vishkaee et al 2014 2 3 the j fx approach the dominant forces governing water retention at the wet and dry ranges of the swcc are capillary and adsorption forces respectively or and tuller 1999 tuller et al 1999 antinoro et al 2014 jensen et al 2015 accordingly separated the wet and dry ranges of the swcc at potentials of 104 2 cm water and proposed equations to determine the volumetric water contents for both matric potential ranges 2 3 1 wet range in a naturally structured soil soil particles are intermixed which reduces the pore size generated by bigger particles and increases the volume of small pores chan and govindaraju 2004 a squared summation of the relative volumetric particle size fractions is used to account for the mixing of soil particles the θ ψi l3l 3 is calculated as 11 θ ψ i θ s θ s j 1 j i v j ψ 2 where ψ is the matric potential l vj ψ is the relative volume of the j th fraction l3l 3 given by the volume of the j th fraction divided by the total volume of the soil this equation is only applicable for potentials above 1000 cm water corresponding to fractions of coarse sand 0 25 2 mm and fine sand 0 02 0 25 mm due to the lack of linearity between water content and the volume size fractions jensen et al 2015 extension of this equation for lower potentials is as follows jensen et al 2015 12 θ ψ θ s 1 v cs v fs β 1 v s β 2 α where β1 and β2 are parameters determining the pores filled partially filled or completely drained α refers to the cumulated volume fraction l3l 3 vcs vfs and vs are the relative volume fraction l3l 3 of coarse sand fine sand and silt 0 002 0 02 mm respectively general parameters of β1 β2 and α given in jensen et al 2015 are recommended for predicting the wet range swcc for any soil table 1 2 3 2 dry range water retention in the dry range is dominated by adsorption and is controlled by the specific surface area which is affected by the contents of fine particles including clay 0 002 mm silt and om wuddivira et al 2012 arthur et al 2014 jensen et al 2015 jensen et al 2015 proposed a regression model to calculate the volumetric water content at potentials of 106 cm water pf 6 θpf6 l3l 3 13 θ p f 6 0 08 c l a y 2 o m 0 15 s i l t ρ b where clay om and silt are the clay organic matter and silt contents mm 1 respectively 0 08 and 0 15 are the best fit empirical parameters jensen et al 2015 respectively and the coefficient of 2 is the weighting factor for om because its particle density is about half that of clay minerals hansen 1976 jensen et al 2015 the volumetric water contents for the dry range are calculated by adopting the linearity relationship of potential and the water content between 104 cm water and oven dryness campbell and shiozawa 1992 jensen et al 2015 14 θ ψ θ p f 6 6 9 log 10 ψ 6 9 6 where 6 9 is the pf at oven dryness arthur et al 2013 the fredlund and xing 1994 model is regarded to be applicable for the entire matric potential range and is given by 15 θ c ψ θ s ln e ψ a n m c ψ 1 ln 1 ψ ψ r ln 1 ψ max ψ r where e is the natural constant 2 718 ψr and ψmax are the residual and oven dry matric potential values l corresponding to 104 2 cm water and 106 9 cm water respectively and α n and m are fitting parameters obtained by nonlinear regression 3 materials and methods 3 1 study area and sampling soil samples were collected in a rectangular area 39 12 30 39 23 28 n 100 05 32 100 10 01 e 1372 1417 m a s l with a length of 20 km from north to south and a width of 5 km from east to west in the middle reaches of the heihe river in northwestern china fig 1 this region has a continental arid climate heterogeneous soils in both the vertical and horizontal directions and complex landscape patterns a detailed description of the study area can be found in li and shao 2013 and li et al 2016 thirty nine locations were selected representing desert 16 locations cropland 17 locations and grassland 6 locations in the rectangular area disturbed soil samples were collected using a 5 cm diameter hand auger at an interval of 20 cm down to a depth of 1 m and soil samples for each layer were taken with three duplicates randomly collected in a 5 5 m plot at each location five undisturbed soil cores were collected at the same depth intervals using stainless steel cutting rings 5 0 cm in height by 5 0 cm in diameter to a depth of 1 0 m at each location 3 2 laboratory measurements of soil properties in the laboratory air dried disturbed soil samples were divided into two sub samples and passed through a 0 25 mm sieve for determining soil organic carbon content and a 2 mm sieve for measuring the psd respectively the content of soil om contents were determined through multiplying the soil organic carbon concentration determined by dichromate oxidation nelson and sommers 1982 by 1 724 according to the instruction in the textbook of soil agro chemical analysis bao 2000 the soil psd was measured by laser diffraction using a mastersizer 2000 analyzer malvern instruments malven england to determine the water retention of various fractions using the mv method the soil psd was accordingly classified into 20 fractions with boundaries at particle diameters of 0 001 0 002 0 007 0 008 0 01 0 02 0 03 0 04 0 05 0 06 0 07 0 08 0 1 0 15 0 2 0 25 0 4 0 5 0 8 and 2 mm during the measurement measured soil textures covered five classes sand sandy loam sandy clay loam clay loam and loamy clay according to the international society of soil science table 2 the weight of each undisturbed soil core was measured after its saturation from below the θ ψ data pairs during the drying process were measured using a high speed centrifuge nimmo et al 2002 the weight of the core after decanting was measured when ψ values of 10 51 102 204 408 612 816 1020 2040 4081 6121 8161 and 10202 cm water were reached sequentially the information of the centrifuge time and angular velocity corresponding to each potential value was shown in supplementary information finally the soil core was oven dried at 105 c for 48 h and the dry weight of the solid mass was measured to determine the bulk density this steady state centrifuge method combines the advantages of simplicity and accuracy with the speed and versatility afforded by centrifugal force which permits a decrease in measurement time and or an increase in the range of ψ values to be determined for various textures this method can yield nearly uniform water content distributions and is useful in situations where compaction is not significant or where it is desired to measure hydraulic properties with oven burden pressures approximating those under field conditions this method allows the body force to be set at a desired value and to know the approximate values of both θ and ψ while a series of measurements is in progress nimmo et al 2002 3 3 evaluating the approaches the measured psd bulk density and om content values were used to calculate the θ ψ data pairs of the swcc twenty points were obtained for each sample by the mv method eleven reference points were estimated for each sample using the jensen et al 2015 method with six points in the dry region at potentials of 105 2 cm water 105 5 cm water 105 7 cm water 106 0 cm water 106 3 cm water and 106 5 cm water and five points for the wet range at potentials of 50 cm water 100 cm water 158 cm water 501 cm water and 1000 cm water respectively the best fit parameters were obtained using the retc program van genuchten et al 1991 for the mv vg approach and by employing the iterative non linear regression procedure using the matlab 7 0 software for the modified mv vg approach and the j fx approach at the thirteen experimental ψ values aforementioned the θ values estimated by different approaches were compared with the measured θ values three statistical criteria were used to evaluate the performance of the approaches including the coefficient of determination r2 the mean error me l3l 3 and the root mean square error rmse l3l 3 which are given by 16 r 2 i 1 n o i o p i p i 1 n o i o 2 0 5 i 1 n p i p 2 0 5 2 17 me 1 n i 1 n p i o i 18 rmse i 1 n p i o i 2 n where oi and pi are the measured and estimated values of the ith sample respectively o and p are the averages of the measurements and estimations respectively and n is the number of samples based on the evaluation the parameterized approaches were further assessed on the dry range by comparing the estimation of soil water contents at potentials of 104 2 cm water 105 cm water 105 5 cm water 106 cm water 106 5 cm water and 106 9 cm water 4 results and discussion 4 1 combining the mv method with the two models for each soil sample with twenty particle size fractions the mv method was used to calculate the θ ψ data pairs which were then used to parameterize the fredlund and xing 1994 model or the van genuchten 1980 model soil water contents at the thirteen experimental ψ values were accordingly determined and compared with the measured data for evaluating the performances for swcc estimation the three free parameters α n and m in the fredlund and xing 1994 model were well fit by nonlinear regression analysis with high coefficients of determination r2 0 993 although this model is modified from the van genuchten 1980 model the values of each parameter deviated greatly from the ranges of those in the van genuchten 1980 model parameter α approximated the upper limit set during the nonlinear minimization process indicating that the high r2 value is not enough for guaranteeing the meaningful definition of parameters fredlund and xing 1994 reported that parameter α decreased from 9 71 cm water for a sandy soil to 154530 cm water for a clay soil in this study we set wide value ranges for α n and m parameters during the fitting after considering the given values for various soil textural classes in fredlund and xing 1994 however the combination of the mv method with the fredlund and xing 1994 model fails to give realistic estimations of continuous swccs the slope value of 0 530 and positive value of me 0 181 suggest the overestimation at the thirteen ψ values and the low value of r2 0 291 large values of me and rmse 0 203 indicate the inaccuracy of the estimation fig 2 a the fredlund and xing 1994 model is a modification of the van genuchten 1980 model and is regarded to be applicable over the suction range of 0 107 cm water if the measured or estimated θ ψ data pairs are available the lowest ψ value calculated by the mv method corresponding to the smallest particles with mean radius of 0 002525 mm was 28 940 cm water among all of the samples this value was far above the value for zero water content of 106 cm water campbell and shiozawa 1992 106 9 cm water groenevelt and grant 2004 arthur et al 2013 or 107 cm water croney and coleman 1961 richards 1965 the absence of calculated θ ψ data pairs at high suctions may affect the parameter fit when combining the mv method with the fredlund and xing 1994 model the van genuchten 1980 model fits the estimated θ ψ data pairs well with r2 0 990 for the five textural classes table 3 the mv vg approach well estimated the θi values at the experimental ψi values fig 2b this result coincides with li et al 2016 who reported that the mv vg approach outperformed the semi physical arya and paris 1981 method and the empirical rosetta program schaap et al 2001 in estimating the soil water retention however the scatter of a majority of points above the 1 1 line and the negative me value indicate the overall underestimation of this approach for some loamy clay soils the estimated θi values were remarkably lower than the experimental values the underestimation of the dry range soil moisture content by the mv vg approach for fine textured soils has been previously reported mohammadi and vanclooster 2011 mohammadi and meskini vishkaee 2013 li et al 2016 fine textured soils have an abundant amount of clay minerals and om which are characterized with high porosity and high surface energy meskini vishkaee et al 2014 in the van genuchten 1980 model the volumetric water content is modified by referencing to zero water content and the normalized volumetric water content to account for the gradual air entry at suctions near saturation fredlund and xing 1994 the van genuchten 1980 model thus generally gives satisfactory approximations at large and medium water contents but has difficulty in representing the retention of the dry end khlosi et al 2006 2008 lu et al 2008 factors not fully involved such as non linearity between psd and pore size distribution aggregation complex pore geometry root channels structural cracks and wormholes hysteresis om content as well as volume change of clay fraction upon wetting and drying will all contribute to the disparities arya and paris 1981 rouault and assouline 1998 or and tuller 1999 hwang and powers 2003 pachepsky and rawls 2003 antinoro et al 2014 for multicomponent particle systems such as soils the relation between the sphere size and void size may be not a simple linear relationship and the pore volume may be not proportional to the particle volume rouault and assouline 1998 hwang and powers 2003 the aggregation microcracks and root channels would account for a fraction of the pore volume with radii not determined by the primary particle distribution the relative abundance of these pores would determine the extent to which the estimation would deviate from the reality arya and paris 1981 during the alternating periods of wetting and drying hysteresis for the swcc occurs and increases when texture becomes finer and the width of the hysteresis loop increases with increasing specific surface globus and neusypina 2006 significant hysteresis is reported for different soils from the intermediate moisture to the dry end globus and neusypina 2006 prunty and bell 2007 davis et al 2009 lu and khorshidi 2015 distinguished the particle surface hydration mechanism for little hydraulic hysteresis in non swelling soil kaolinite and the interlayer exchangeable cation hydration mechanism for strong hysteresis in swelling soil montmorillonite for high suction range the lack of consideration of surface forces suggests that the mv method cannot reflect the effect of hysteresis the mv method describes the pore space geometry using the concept of bundle of cylindrical tubes which ignores the porosity change caused by clay fraction during the wetting and drying the water filled corners pendular spaces and water films the incomplete desorption of residual water would lead to higher experimental θ values in the dry range or and tuller 1999 mohammadi and vanclooster 2011 antinoro et al 2014 the insufficient reflection of pore geometry by the packing parameter ξ and possible disagreement between the theoretical porosity and experimental maximum volumetric water content may also contribute to the estimation error many studies pointed out the importance of incorporating the contribution of interfacial area from water air interfaces in the corners of irregular and angular pore spaces dillard and blunt 2000 helland and skjæveland 2007 shahraeeni and or 2010 gras et al 2011 this study calculated the volume of water lens between soil particles and adsorbed water films coating soil particles using experimental psd and bulk density following mohammadi and meskini vishkaee 2012 and evaluated their influences on swcc estimation by the mv vg approach the lens water volume was expressed as matric suction independent pendular rings and the adsorbed water film volume was estimated with van der walls and electrostatic forces table 3 shows the maximum and average values of the lens water content and the content of adsorbed water film as well as their relative contributions to the volumetric water content for five soil textural classes the maximum value of lens water content εi varied from 0 0537 cm3 cm 3 for loamy clay soil to 0 0732 cm3 cm 3 for sandy soil the mean εi value increased from 0 0223 cm3 cm 3 for sandy soil to 0 0410 cm3 cm 3 for loamy clay soil the mean εi value for sandy clay loam 0 0377 cm3 cm 3 and clay loam 0 0361 cm3 cm 3 approximated to the values 0 0412 cm3 cm 3 and 0 0352 cm3 cm 3 for the two textural classes respectively reported by mohammadi and meskini vishkaee 2012 the value of εi θi decreased from 0 17 for sandy soil to 0 12 for clay loam soil suggesting that the contribution of lens water decreased with the increasing fine particle fractions mohammadi and meskini vishkaee 2012 explained that the water content in small pores of sandy soil is relatively low and the volume of lens water is accounted for with larger pores containing more water except for sandy soil the εi θi values for the other four textural classes were higher than those reported in mohammadi and meskini vishkaee 2012 the average value of εi θi for the five textural classes was 0 14 indicating that 14 of the water content of each pore was from lens water this value was lower than the reported value of 0 26 in mohammadi and meskini vishkaee 2012 these results suggest the differences in surface area pore geometry thus water status between soils within a textural class the maximum and mean values of adsorbed water film content δi cm3 cm 3 increased with increasing fine particle fractions table 3 the mean δi value was lower than that for the same textural class in mohammadi and meskini vishkaee 2012 the values of δi θi were nearly equal among the five textural classes with an average of 0 01 the lower values of δi and δi θi indicate the lower contribution of adsorbed water film to soil water content when compared to lens water the incorporation of both εi and δi into θi calculated using eq 2 for each particle fraction was assumed to be useful to improve the estimation of the mv vg approach fig 3 a shows the comparison in soil water content between the estimations and measurements at the thirteen experimental ψ values less points above the 1 1 line reflects the improvement of soil water content estimation in the dry range the incorporation of lens and film water volume generally improved the estimation of swcc by 3 7 when compared to the raw mv vg approach however the incorporation of lens water and adsorbed water film is unable to adequately estimate the residual water considering the lack in treatment of larger dead end pores om content roughness of soil particles and other unknown factors 4 2 the modified mv vg approach parameters α n and m of the modified mv vg approach differed slightly from those of the mv vg approach table 4 the r2 values varied from 0 957 for sandy loam soil to 0 987 for sandy soil indicating the good performance of the non linear regression procedure during parameterization the values of parameter α of the mv vg approach and the modified mv vg approach both decreased with increasing fine particle fractions table 4 this corresponded to the increased air entry pressure from coarse to fine textured soils fig 3b shows the comparison in θi values between the estimation by the modified mv vg approach and the measurement the majority of the points were tightly concentrated around the 1 1 line and the integration of soil structure feature improved the swcc estimation by 11 than the raw mv vg approach fig 3b this concurs with the report by meskini vishkaee et al 2014 that the scaled mv vg approach can improve the swcc estimations by 30 however the value of emin in eq 9 would affect the θ estimations in this study it was estimated from the minimum porosity of 0 259 given in hopkins and stillinger 2009 the porosity of 0 259 corresponds to the possible maximum 0 741 of the packing fractions for congruent hard spheres in three dimensions hopkins and stillinger 2009 pointed out that a disordered packing may approach higher terminal packing fractions up to but not reaching 0 741 smaller packing fractions of actual soil particles lead to larger values of porosity in turn larger emin values the corresponding θ values estimated by eq 10 would be smaller this indicates that using ideal minimum porosity of 0 259 might result in overestimation of soil water contents by the modified mv vg approach 4 3 the j fx approach the parameters α n and m of the fredlund and xing 1994 model were well fit using the eleven θ ψ data pairs for each sample high clay content can increase the specific surface area of soil matrix and enhance water adsorption botula et al 2012 arthur et al 2015 the value of parameter α increased with the increasing fine particle fractions fig 4 a because of its close correlation slightly higher than or equal to with the air entry suction fredlund and xing 1994 no obvious correlations were observed between the n and m parameters and the contents of clay and om when pooling all data together most values of n and m ranged from 1 to 2 and from 0 to 1 respectively fig 4 however the values of both n and m decreased with the refining of soil textures table 4 furthermore the values of n and m decreased remarkably with an increase in clay or silt contents when the contents of clay or silt were less than 10 fig 4b and 4c corresponding to sandy soil and loamy sand soil parameter n controls the slope of the swccs higher values of n give sharp corners near the air entry pressure while smaller m values produce moderate slopes in the high potential range fredlund and xing 1994 the variation of these three parameters is consistent with the shape of swccs of different soil textural classes the j fx approach performed well in estimating the θi values at the experimental ψi values the value of r2 0 846 was higher and the deviation of the estimation from the measurement me 0 0016 cm3 cm 3 rmse 0 0509 cm3 cm 3 fig 5 was less than those of the mv vg and the modified mv vg approaches fig 2b and 3b examples of the estimated swccs by different approaches with the least and largest deviations from the measurements for the five textural classes are given in fig 6 although soil structure features are integrated into the estimation by scaling the parameter n from the mv vg approach the values of parameters α and m remain unchanged estimations of the modified mv vg approach approximated to those of the mv vg approach the j fx approach generally gave more accurate estimations except for one sample of the sandy loam fig 6d and the loamy clay fig 6j respectively at the lowest experimental potential 10202 cm water soil water contents estimated by the j fx approach agreed better slope 0 968 r2 0 780 with the measured values than those by the modified mv vg approach slope 1 189 r2 0 686 permanent wilting point at potentials of 104 2 cm water is in theory larger than the values of θr the introduction of scaling factor λ in the modified mv vg approach seems to be not enough to compensate the effects of ignoring the θr the θ values at potentials of 104 2 cm water estimated by the modified mv vg approach were smaller than those by the j fx approach especially for the sandy soil and the remarkably low values of which seem to be abnormal tables 5 and 6 the θ values should not decrease sharply when potentials decreased from 104 0 cm water to 104 2 cm water the modified mv vg approach underestimated while the j fx approach gave satisfactory estimation of the θ values of wilting point tables 5 and 6 the potential of 106 9 cm water was regarded as the oven dryness condition with ideal zero water content groenevelt and grant 2004 arthur et al 2013 five textural classes all showed low but not zero values of θ estimated by the modified mv vg approach especially for the loamy clay soil table 5 the variation of θ values among samples within a textural class increased with the decreasing potentials for the two approaches tables 5 and 6 the absolutely lower values of coefficients of variation indicate that the j fx approach gave much concentrated estimations the j fx approach generally outperformed the modified mv vg approach in describing the dry region descriptions of soil properties and empirical parameters required and performances of different approaches involved in this study in estimating the swcc were summarized in table 7 organic matter plays a central role on water adsorption of coarse textured soils arthur et al 2014 whereas clay and om contents are the chief controlling factors for water adsorption of fine textured soils rawls et al 2004 naveed et al 2012 the effect of silt fraction on water adsorption of the dry range is more evident for soils with high silt and low clay contents jensen et al 2015 by taking into account the silt clay and om fractions the j fx approach effectively improved the estimation for the dry range swccs however this study used the empirical values of β1 and β2 in eq 12 and empirical coefficients of 0 08 and 0 15 in eq 13 given in jensen et al 2015 a calibration in specific studies seems to be necessary for better fit to the experimental data zero water content is usually considered in models for dry range water contents although it exists in neither theory nor practice the potential corresponding to zero water content was regarded as being a constant no matter the soil type fredlund and xing 1994 the value of 106 9 cm water has been proposed groenevelt and grant 2004 arthur et al 2013 instead of 107 campbell and shiozawa 1992 and 106 cm water croney and coleman 1961 richards 1965 as the matric potential for oven dryness however it has been pointed out that all soil water is in the form of tightly adsorbed water and the swcc is solely controlled by soil mineralogy for matric potentials lower than 105 cm water and the lower limit of this regime is not a unique number lu and khorshidi 2015 for example the linear extrapolation of the measured θ values from potential of 105 cm water to potential of 106 5 cm water provided several matric potential values of zero water content for soils with varying om contents karup et al 2017 using the unique value of 106 9 cm water as the matric potential of oven dryness for the five textural classes in this study might contribute to deviation in the estimations of the j fx approach from the measurements 5 conclusions this study aimed at looking for a feasible approach using easily accessible soil properties to estimate the entire swcc the performances of different approaches were evaluated by independently measured θ ψ data pairs of 195 undisturbed soil samples the mv method had a robust physical basis and was independent of any experimental θ ψ data pairs and database related parameters its combination with the fredlund and xing 1994 model performed worse than the mv vg approach the simplified pore geometry and the neglect of the surface areas of clay particles and om affected the swcc estimation by the mv vg approach the incorporation of lens water and adsorbed water films into the mv vg approach improved the estimation by 3 7 and the integration of soil structure features improved the swcc estimation by 11 however the mv method ignores the difference in governing forces between dry and wet ranges and requires at least twenty fractions of psd which are usually difficult to obtain in routine measurements the j fx approach separated the dry and wet ranges and related the psd specific surface area and om content to the pore size distribution the j fx approach matched the experimental data well and generally outperformed the mv vg and the modified mv vg approaches the j fx approach is expected to provide reliable estimations of the whole range water retention for soils with varying bulk density soil texture and om content further insights into the physical meaning of parameters α n and m more experimental θ ψ data pairs at high suction and samples from highly structured soils and from soils with more expansive clays or pronounced hysteresis behavior are necessary to calibrate the empirical parameters of the j fx approach for improving the entire swcc estimation declaration of competing interest none acknowledgements this study was financially supported by the strategic priority research program of the chinese academy of sciences xda19040500 and the national natural science foundation of china 41701251 the authors sincerely thank the two anonymous reviewers who provided constructive comments and suggestion to improve the quality of this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123971 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
