index,text
20850,a modified box cox transformed rayleigh mbr distribution for the wave crests is presented in this paper the basic idea contains two steps firstly non gaussian elevations are transformed into gaussian elevations by a modified box cox transformation afterwards the crests of the transformed elevations are described by the rayleigh distribution comparison between the mbr and tayfun distributions shows that these two models are the same if terms smaller than o ε 2 are ignored where ε is the elevations skewness finally verifications and comparisons are presented for two sets of field measurement based on the results the mbr distribution gives better results than the forristall model for very large wave crests moreover the mbr model matches the observations better than the tayfun distribution since it obtains larger probabilities for larger crest in addition to smaller probabilities for small crests keywords wave crest distribution box cox transform rayleigh distribution 1 introduction the distribution of wave crest is very important in ocean engineering for example it is useful for the prediction of the fixed offshore jacket platform response to the random wave loads endrami et al 2011 it has been found that the surface elevation process deviates from the gaussian assumption when the waves are nonlinear ochi 1998 wang 2016 in this case the wave crests are mostly higher and sharper than linear waves forristall 2017 many efforts have been made to consider the nonlinear effects for the wave crest distribution the most widely used method is the empirical distribution proposed by forristall bitner gregersen et al 2014 forristall 2000 2017 this distribution employs weibull formula and the parameters regarding the steepness and the ursel number are derived from the field data there are also some theoretical based models developed tayfun has proposed a narrow banded spectrum to include the second order effects tayfun 1980 thereafter many advances have been made for this model fedele and tayfun 2009 tayfun 1980 2006 2008 tayfun and alkhalidi 2020 several authors have indicated that the distributions proposed by forristall and tayfun can be employed to describe higher order waves and nonlinear directional waves bitner gregersen et al 2014 onorato et al 2009 socquet juglard et al 2005 toffoli et al 2008a 2008b kriebel and dawson 1990 have also proposed a distribution model for non linear waves however this distribution describes poorly over large waves tayfun 2006 other efforts includes the distributions proposed by tung and wang tung and huang 1985 arena and fedele arena and fedele 2002 fedele and arena 2005 to name a few based on the gram charlier series and hemite moments bitner 1980 has proposed a distribution for third order waves extending the idea of bitner 1980 tayfun and fedele also proposed a gram chalier type distribution tayfun and fedele 2007 this model has been verified by petrova et al for bimodal crossing seas petrova et al 2011 besides the semi empirical distribution proposed by bitner gregersen and toffoli 2012 can also be regarded as a model for third order waves these distributions employ certain assumptions such as narrow banded or the gram charlier series and hemite transformation however the narrow band assumption may not be applicable to some sea states due to the coexistence of various waves on the other hand the distributions based on the gram charlier series and hemite moments include some statistical parameters to be derived from wave records bitner gregersen et al 2014 which limits their applications moreover several researchers have indicated that the field records of limited durations may show poor agreements with the gram charlier series bitner gregersen et al 2014 cherneva et al 2009 tayfun and fedele 2007 rychlik and his colleagues rychlik et al 1997 rychlik and leadbetter 1997 put forward a new way to simulate the crest distribution of non gaussian waves by using transformed gaussian process with some conditions employing similar ideals wang and xia 2013 and wang 2016 have proposed the transformed rayleigh method and the asymptotic analysis method respectively however these methods are so complex and involve some empirical criterions wang 2016 inspired by the works of rychlik and wang and their colleagues a simple distribution based on the box cox transformation and the rayleigh distribution is proposed herein the modified box cox transformation is introduced with consideration for negative observations in section 2 in section 3 the corresponding distribution model is proposed and comparisons are made with those proposed by tayfun and forristall verifications and comparisons are presented in section 4 for two sets of field measurement finally the conclusions are drawn in section 5 2 modified box cox transformation for the mild nonlinear waves the kurtosis influence can be neglected tayfun and fedele 2007 the skewness can be taken as a small amount which suggests that 1 ε ε η σ 1 κ 3 where η is the elevation σ ε and κ the standard deviation skewness and kurtosis of the elevations respectively and the parameter e is of the same order as the maximum η σ the modified box cox transformation is given based on these assumptions 2 1 modified box cox transformation for negative observations the box cox box and cox 1964 transformation is proposed by box and cox to reduce anomalies 2 f x x λ 1 λ λ 0 ln x λ 0 where x is an abnormal series and λ is a parameter the transformation in eq 2 is valid only for positive x several modifications have made for negative observations bickel and doksum 1981 john and draper 1980 manly 1976 sakia 1992 however these modifications change the zero point which has a great impact on the statistics of crests rychlik et al 1997 rychlik and leadbetter 1997 therefore a modified transformation is proposed 3 r x α 1 λ 1 λ λ 0 ln α 1 λ 0 where 4 α x λ where λ is a positive parameter and x λ is smaller than 1 as a result α 1 is always positive moreover r 0 0 which meets the condition proposed by rychlik and his colleagues rychlik et al 1997 rychlik and leadbetter 1997 however the average of r x is a little different from zero and the effects will be addressed later the expansion of eq 3 is 5 r α k 1 a k α k where 6 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 fig 1 verifies the expansion of eq 3 by the comparison between the analytic and numerical results it shows that the good agreement has been achieved when k 3 2 2 parameters λ and λ with the assumption that the transformed series r x obeys the normal distribution the corresponding skewness ε r and kurtosis κ r can be expressed as 7 ε r a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 σ r 3 0 8 κ r e r x e r x 4 σ r 4 a 1 4 κ σ 4 λ 4 σ r 4 3 where σ r is the standard deviation details can be found in appendix a as a result parameters λ and λ can be estimated by 9 λ 1 2 λ ε 3 σ κ 1 10 κ r κ 3 when terms with order equal or higher than o α 4 are ignored and the influence of the kurtosis can not be considered meanwhile parameters λ and λ are not unique as discussed in section 4 the larger the parameter λ is the better the results will be since the higher order of α k can be ignored according to eq 5 λ should be as small as possible the minimum value of λ is 1 and it leads to 11 λ 1 2 s i g ε λ 6 σ ε in this case a k α k a k 1 α k 1 is strictly correct as shown in appendix b note that x λ is a small amount appendix a it brings to 12 α ε x 6 σ 1 3 distribution of wave crest in section 2 a modified box cox transformation is proposed the parameters λ and λ are obtained by assuming that the skewness and kurtosis of r x are equal to those of the normal distribution however it is still uncertain whether r x strictly obeys normal distribution in this paper it is assumed that r x obeys the normal distribution to derive the wave crest exceedance probability 3 1 distribution of wave crest by the modified box cox transform for a zero mean gaussian process y the level up crossing rate υ of level u can be estimated by rychlik et al 1997 rychlik and leadbetter 1997 13 ν u 1 2 π m 2 m 0 e u 2 2 m 0 where m 0 and m 2 are the zero and two order spectral moment of y note that m 0 is also equal to the variance of y it is defined that 14 η t r η t e r η t where η t is the raw elevations series obviously the variance of η t is equal to σ r 2 the exceedance probability of crest of η t can be obtained by eq 13 as following 15 p η c h ν h ν e r η exp h 2 e 2 r η 2 σ r 2 where η c is the crest of η t because the crossing point changes to be e r η the crest exceedance probability of η t is 16 p η c σ h p η c σ r r h exp r 2 h e 2 r η 2 σ r 2 it can be approximated to o α 3 as follows 17 p η c σ h exp μ h 1 1 2 s i g ε 1 2 2 1 2 s i g ε 2 μ 2 1 12 μ 2 s i g ε where μ 1 6 ε eq 17 is the final formula of the crest exceedance probability it is referred to the modified box cox rayleigh mbr distribution in the following sections 3 2 comparing with the generalized tayfun distribution the generalized tayfun distribution is fedele and tayfun 2009 tayfun 1980 2006 tayfun and alkhalidi 2020 18 p t η c σ h exp 1 2 μ h 1 2 2 μ 2 where μ 1 3 ε parameter μ was firstly defined as the wave steepness fedele and tayfun 2009 19 μ m σ k 1 where k 1 is the mean wave number however fedele and tayfun found that the exceedance probability estimated by μ m is overestimated compared to the observed data an approximation of ε was proposed by them fedele and tayfun 2009 20 ε a 3 μ m 1 ν ν 2 where ν is the band width for intermediate and shallow water waves another approximation of ε was proposed by tayfun and alkhalidi 2020 21 ε s 3 μ m d 1 d 2 1 μ m 2 d 1 2 d 2 2 3 where d 1 and d 2 are the parameters related to the depth and wave number tayfun and alkhalidi 2020 more details can be found in appendix c eq 18 can be expanded as 22 p t η c σ h exp h 2 2 1 ε 6 h ε 2 h 2 18 o ε 3 h 3 2 similarly eq 17 can be expanded as 23 p η c σ h exp h 2 2 1 12 μ 2 1 ε h 6 ε 2 h 2 36 o ε 3 h 3 2 ε 0 24 p η c σ h exp h 2 2 1 12 μ 2 1 ε h 6 ε 2 h 2 108 2 ε 0 obviously if the terms with order equal or larger than o ε 2 are neglected the tayfun distribution is the same as the mbr distribution the influence of higher order terms increases with ε and η c σ as shown in fig 2 left plot mbr s exceedance probabilities are always larger than those of tayfun distribution when ε 0 when ε 0 mbr s exceedance probabilities are initially smaller however with the increase of η c σ they are slightly larger than those of tayfun distribution as shown fig 2 right plot 3 3 comparing with the forristall distribution forristall 2000 developed a two parameter weibull distribution of wave crests 25 p f η c σ h exp h 4 p q parameters p and q are given in terms of the steepness s 1 and the ursel number u r defined as 26 s 1 2 π g h s t 1 2 u r h s k 1 2 d 3 where h s and d are the significant wave height and the water depth respectively and t 1 and k 1 are the mean period and wave number calculated by the ratio of the first two order spectral moments the relationships between p q s 1 and u r are different in 2d sea and 3d sea however the differences between these two seas are small in this paper the parameters of 2d sea are employed 27 p 1 2 2 0 2892 s 1 0 1060 u r q 2 2 1597 s 1 0 0968 u r 2 these parameters were linked to the skewness by tayfun tayfun 2006 2008 28 ε f 48 p 3 q γ 3 q 3 4 π 2 a comparison between these three distributions in terms of k 1 d and d h s is given in fig 3 the differences increase with k 1 d and decrease with d h s it is also found that forristall s probabilities are always smaller than those of mbr and tayfun distributions when k 1 d 1 however when d h s 10 and k 1 d 0 352 mbr s probability is quite different from those of tayfun and forristall distributions it may because the skewness obtained by s 1 and u r is very large ε 0 82 and it disables the mbr distribution 4 verification and comparisons 4 1 waves in the lagoon the first data set was gathered from january 2018 to april 2019 with a datawell dwr mkiii directional waverider buoy the buoy was located at a lagoon of the south china sea with water depth of about 20 m locations and deployment details are given in fig 4 and table 1 further details can be referred to our previous works cai et al 2019 2020 there are 592 waves whose significant wave height is larger than 1 m ε 6σ s 1 and u r of these waves are given in fig 5 ε 6σ varies from 0 1 to 0 15 s 1 and u r are very small which indicates that the waves are weakly nonlinear four samples with ε 6σ varying from 0 5 to 0 15 are selected to verify the mbr model the parameters of these waves are given in table 2 the measured ε is compared with ε a ε s and ε f in fig 6 obviously when ε is positive ε a ε s and ε f locate around the measured ε results are shown in fig 7 through fig 10 it shows that the estimated probabilities of the models are in the 95 confidence intervals of observations therefore these three models are valid for the four waves in the case ε 6σ equal to 0 05 fig 7 tayfun and mbr models with the measured ε give better results for large waves in other cases the exceedance probabilities of large waves are slightly over predicted in the case ε 6σ equal to 0 05 all models give similar results as shown in fig 8 the exceedance probabilities of large waves are slightly underestimated by these models the comparison for the case ε 6σ equal to 0 1 is shown in fig 9 in this case all models agree well with the observations the mbr model gives larger results for large waves especially when it is calculated with ε a ε s and ε f similar results can be found when ε 6σ is equal to 0 15 as shown in fig 10 however the forristall model underestimates the observations for this case for large wave crests the mbr and tayfun models give better results than the forristall model it is worth to point out that the differences between the mbr and tayfun models are very small this may be due to the limited number of waves 4 2 measurements from the tern platform the second data set was gathered from the tern platform the experiment lasted for 9 hours and was employed to verify the tayfun distribution by fedele and tayfun 2009 the data of tern platform are obtained from fedele and tayfun 2009 the time series of the original measurements are not available and the comparisons herein is only based on the plots in their paper parameters of the tern platform data set are given in table 3 exceedance probabilities of the crest are compared in fig 11 it is found that the mbr distribution appears larger than the tayfun distribution for larger wave crests when the measured ε is employed these three models are similar to each other in other cases the exceedance probabilities estimated by the tayfun model and mbr model are mostly larger than those of the forristall model the plots between the ratio η c σ η r and p are shown in fig 12 for small waves all of these models overestimate the probabilities compared to the observations in this case the forristall model gives the best results and the worst results are obtained by the tayfun model for large waves the forristall model fits the observations for most parts however it underestimates for very large waves nevertheless forristall s probabilities are still in the range of the σ bands when the ε of the measurements is employed the tayfun model and the mbr model underestimate when ε ε s and ε ε f the tayfun model and mbr model tend to overestimate these three models best fit the observations when ε ε a after these benchmark it can be concluded that the mbr model matches best for large wave crests since it obtains larger p for larger crest in addition to smaller p for small crests 5 conclusions a new distribution model named modified box cox rayleigh mbr distribution is proposed to describe the wave crest of the non gaussian elevations the basic idea contains two steps firstly non gaussian elevations are transformed into gaussian elevations by a modified box cox transformation afterwards the crests of the transformed elevations are described by the rayleigh distribution the basic assumptions of this model are 1 the influence of kurtosis can be neglected 2 the skewness can be taken as a small amount these assumptions can be expressed by 29 α x ε 6 σ 1 κ 3 in order to get the final expression it is also assumed that the transferred series r x obeys the normal distribution assumption 1 has been verified by the field data from the lagoon and tern platform for these waves the maximum εη c 6σ close to 0 2 which is much smaller than 1 as a result the probabilities predicted by the mbr distribution mostly are in the range of the confidence or the σ bands it demonstrates that the mbr distribution model is valid for these applications however as the influences of kurtosis are neglected the mbr distribution is limited to the mildly nonlinear waves equal or smaller than 2nd order several conclusions can be drawn by comparing the mbr distribution with the tayfun distribution and the forristall distribution 1 the mbr distribution is the same as the tayfun distribution if terms smaller than o ε 2 are ignored 2 mbr s exceedance probabilities are always larger than those of tayfun distribution when ε 0 when ε 0 mbr s exceedance probabilities are initially smaller however with the increase of η c σ they are slightly larger than those of tayfun distribution 3 when the skewness is estimated by parameters of forristall the differences between these three distributions increase with k 1 d and decrease with the d h s when k 1 h 1 the probabilities of forristall distribution are always smaller than other two distributions comparisons between these distribution models based on the two sets of measured data have shown that 1 the mbr distribution gives better results than the forristall model for very large wave crests 2 the mbr model matches the observations better than the tayfun distribution since it obtains larger probabilities for larger crest in addition to smaller probabilities for small crests the mbr distribution is described by elevations σ and ε so for future research is going to associate it with the wave heights spectral bandwidth and some other parameters the uncertainties of these parameters will be taken into account furthermore more field measurement data are needed to further verify the mbr distribution credit authorship contribution statement z w cai conceptualization methodology validation formal analysis writing original draft x l liu data curation writing review editing w w chen data curation z sun writing review editing j ding writing original draft project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by the ministry of industry and information technology under grant number 2016 22 and 2019 357 by the fund of southern marine science and engineering guangdong laboratory zhanjiang and by jiangsu province science foundation for youths no 351510008k0708la00 we thank dr zhang xinyu for its linguistic assistance during the preparation of this manuscript appendix a original and central moments of the transformed series in section 2 1 the modified transformation is defined as 30 r α α 1 λ 1 λ λ 0 ln α 1 λ 0 where α x λ and α is much less than 1 by applying mclaughlin expansion to eq 30 we get 31 r α k 1 a k α k where 32 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 the n power of r x can be written as 33 r n α k 1 a k α k n n i 0 n 1 n 2 n k n n n 1 n 2 n k 1 i k a i n i α i n i the first four terms limited to o α 4 are 34 r α a 1 α 1 a 2 α 2 a 3 α 3 a 4 α 4 o α 4 35 r 2 α a 1 α 1 a 2 α 2 a 3 α 3 o α 3 2 a 1 2 α 2 2 a 1 a 2 α 3 a 2 2 α 4 2 a 1 a 3 α 4 o α 4 36 r 3 α a 1 α 1 a 2 α 2 o α 3 3 a 1 3 α 3 3 a 1 2 a 2 α 4 o α 4 37 r 4 α a 1 α 1 o α 2 4 a 1 4 α 4 o α 4 and the original moments of r α are 38 e r α a 1 e α 1 a 2 e α 2 a 3 e α 3 a 4 e α 4 39 e r 2 α a 1 2 e α 2 2 a 1 a 2 e α 3 a 2 2 e α 4 2 a 1 a 3 e α 4 40 e r 3 α a 1 3 e α 3 3 a 1 2 a 2 e α 4 41 e r 4 α a 1 4 e α 4 taking α x λ in eqs 38 41 we get 42 e r x a 1 λ e x a 2 λ 2 e x 2 a 3 λ 3 e x 3 a 4 λ 4 e x 4 43 e r 2 x a 1 2 λ 2 e x 2 2 a 1 a 2 λ 3 e x 3 a 2 2 λ 4 e x 4 2 a 1 a 3 λ 4 e x 4 44 e r 3 x a 1 3 λ 3 e x 3 3 a 1 2 a 2 λ 4 e x 4 45 e r 4 x a 1 4 λ 4 e x 4 for a zero mean random process x e x 0 and eq 42 can be rewritten as 46 e r x a 2 λ 2 e x 2 a 3 λ 3 e x 3 a 4 λ 4 e x 4 the first four central moments of r x are 47 e r x e r x 2 e r 2 x e 2 r x 48 e r x e r x 3 e r 3 x 3 e r 2 x e r x 2 e 3 r x 49 e r x e r x 4 e r 4 x 4 e r 3 x e r x 6 e r 2 x e 2 r x 3 e 4 r x taking eqs 43 46 into eqs 47 49 we get 50 e r x e r x 2 a 1 2 e x 2 λ 2 2 a 1 a 2 e x 3 λ 3 2 a 1 a 3 a 2 2 e x 4 λ 4 a 2 e x 2 λ 2 2 51 e r x e r x 3 a 1 3 e x 3 λ 3 3 a 1 2 a 2 e x 4 λ 4 3 a 1 2 a 2 e x 2 λ 2 2 52 e r x e r x 4 a 1 4 e x 4 λ 4 the standard deviation σ skewness ε and kurtosis κ of x are defined as 53 σ 2 e x e x 2 e x 2 54 ε e x e x 3 σ 3 e x 3 σ 3 55 κ e x e x 4 σ 4 e x 4 σ 4 applying eqs 53 55 to eqs 50 52 we obtain 56 e r x e r x 2 a 1 2 σ 2 λ 2 2 a 1 a 2 ε σ 3 λ 3 2 a 1 a 3 a 2 2 κ σ 4 λ 4 a 2 σ 2 λ 2 2 57 e r x e r x 3 a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 58 e r x e r x 4 a 1 4 κ σ 4 λ 4 therefore the standard deviation σ r skewness ε r and kurtosis κ r of r x are 59 σ r 2 e r x e r x 2 a 1 2 σ 2 λ 2 2 a 1 a 2 ε σ 3 λ 3 2 a 1 a 3 a 2 2 κ σ 4 λ 4 a 2 σ 2 λ 2 2 60 ε r e r x e r x 3 σ r 3 a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 σ r 3 61 κ r e r x e r x 4 σ r 4 a 1 4 κ σ 4 λ 4 σ r 4 appendix b the influence of a k the a k can be expressed as 62 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 it leads to 63 a k 1 a k λ k k 1 λ 0 k k 1 λ 0 assuming that 64 a k 1 a k 1 one gets 65 k λ 2 k 1 or 1 λ k or λ k since k 1 2 3 we get 66 1 λ 1 or λ k so the minimum value of λ is 1 if λ 1 one gets 67 λ 3 σ ε 1 λ 6 σ ε as λ should be positive we set that 68 λ 6 σ ε it results in 69 λ 1 2 s i g ε 1 ε 0 3 ε 0 which meets eq 67 talking it into eq 62 one gets 70 a k 1 k λ 1 λ k 1 1 k ε 0 1 ε 0 a n d k 1 2 1 3 ε 0 a n d k 3 0 ε 0 a n d k 3 there are two points to be noticed 1 when ε 0 a k 1 which suggests that the order of a k α k depends only on the order of α k 2 when ε 0 and k 3 a k 0 which indicates that o a 4 α 4 0 these two points imply that it is reasonable to give up the terms with order equal or higher than o α 4 appendix c estimating the skewness for the original tayfun distribution the skewness was estimated by the wave steepness 71 ε t 3 μ m 3 σ k 1 fedele and tayfun found that the skewness was overestimated by eq 71 a fix was proposed by them 72 ε a 3 μ m 1 ν ν 2 3 σ ω m 2 g 1 ν ν 2 where 73 ν m 0 m 2 m 1 2 1 is the bandwidth the jth order spectral moment is 74 m j 0 ω j s ω d ω where s is the spectrum recently another approximation of ε was proposed by tayfun and alkhalidi 2020 75 ε s 3 μ m d 1 d 2 1 μ m 2 d 1 2 d 2 2 3 where 76 d 1 1 2 4 n 1 n 2 tanh k 1 d k 1 d d 2 cosh k 1 d 2 cosh 2 k 1 d 2 sinh k 1 d 3 77 n 1 2 1 2 k 1 d sinh 2 k 1 d a relationship between the skewness and the parameters of forristall model was proposed by tayfun tayfun 2006 2008 78 ε f 48 p 3 q γ 3 q 3 4 π 2 the parameters of 2d sea are 79 p 1 2 2 0 2892 s 1 0 1060 u r q 2 2 1597 s 1 0 0968 u r 2 and parameters of 3d sea are 80 p 1 2 2 0 2568 s 1 0 0800 u r q 2 1 7912 s 1 0 284 u r 2 
20850,a modified box cox transformed rayleigh mbr distribution for the wave crests is presented in this paper the basic idea contains two steps firstly non gaussian elevations are transformed into gaussian elevations by a modified box cox transformation afterwards the crests of the transformed elevations are described by the rayleigh distribution comparison between the mbr and tayfun distributions shows that these two models are the same if terms smaller than o ε 2 are ignored where ε is the elevations skewness finally verifications and comparisons are presented for two sets of field measurement based on the results the mbr distribution gives better results than the forristall model for very large wave crests moreover the mbr model matches the observations better than the tayfun distribution since it obtains larger probabilities for larger crest in addition to smaller probabilities for small crests keywords wave crest distribution box cox transform rayleigh distribution 1 introduction the distribution of wave crest is very important in ocean engineering for example it is useful for the prediction of the fixed offshore jacket platform response to the random wave loads endrami et al 2011 it has been found that the surface elevation process deviates from the gaussian assumption when the waves are nonlinear ochi 1998 wang 2016 in this case the wave crests are mostly higher and sharper than linear waves forristall 2017 many efforts have been made to consider the nonlinear effects for the wave crest distribution the most widely used method is the empirical distribution proposed by forristall bitner gregersen et al 2014 forristall 2000 2017 this distribution employs weibull formula and the parameters regarding the steepness and the ursel number are derived from the field data there are also some theoretical based models developed tayfun has proposed a narrow banded spectrum to include the second order effects tayfun 1980 thereafter many advances have been made for this model fedele and tayfun 2009 tayfun 1980 2006 2008 tayfun and alkhalidi 2020 several authors have indicated that the distributions proposed by forristall and tayfun can be employed to describe higher order waves and nonlinear directional waves bitner gregersen et al 2014 onorato et al 2009 socquet juglard et al 2005 toffoli et al 2008a 2008b kriebel and dawson 1990 have also proposed a distribution model for non linear waves however this distribution describes poorly over large waves tayfun 2006 other efforts includes the distributions proposed by tung and wang tung and huang 1985 arena and fedele arena and fedele 2002 fedele and arena 2005 to name a few based on the gram charlier series and hemite moments bitner 1980 has proposed a distribution for third order waves extending the idea of bitner 1980 tayfun and fedele also proposed a gram chalier type distribution tayfun and fedele 2007 this model has been verified by petrova et al for bimodal crossing seas petrova et al 2011 besides the semi empirical distribution proposed by bitner gregersen and toffoli 2012 can also be regarded as a model for third order waves these distributions employ certain assumptions such as narrow banded or the gram charlier series and hemite transformation however the narrow band assumption may not be applicable to some sea states due to the coexistence of various waves on the other hand the distributions based on the gram charlier series and hemite moments include some statistical parameters to be derived from wave records bitner gregersen et al 2014 which limits their applications moreover several researchers have indicated that the field records of limited durations may show poor agreements with the gram charlier series bitner gregersen et al 2014 cherneva et al 2009 tayfun and fedele 2007 rychlik and his colleagues rychlik et al 1997 rychlik and leadbetter 1997 put forward a new way to simulate the crest distribution of non gaussian waves by using transformed gaussian process with some conditions employing similar ideals wang and xia 2013 and wang 2016 have proposed the transformed rayleigh method and the asymptotic analysis method respectively however these methods are so complex and involve some empirical criterions wang 2016 inspired by the works of rychlik and wang and their colleagues a simple distribution based on the box cox transformation and the rayleigh distribution is proposed herein the modified box cox transformation is introduced with consideration for negative observations in section 2 in section 3 the corresponding distribution model is proposed and comparisons are made with those proposed by tayfun and forristall verifications and comparisons are presented in section 4 for two sets of field measurement finally the conclusions are drawn in section 5 2 modified box cox transformation for the mild nonlinear waves the kurtosis influence can be neglected tayfun and fedele 2007 the skewness can be taken as a small amount which suggests that 1 ε ε η σ 1 κ 3 where η is the elevation σ ε and κ the standard deviation skewness and kurtosis of the elevations respectively and the parameter e is of the same order as the maximum η σ the modified box cox transformation is given based on these assumptions 2 1 modified box cox transformation for negative observations the box cox box and cox 1964 transformation is proposed by box and cox to reduce anomalies 2 f x x λ 1 λ λ 0 ln x λ 0 where x is an abnormal series and λ is a parameter the transformation in eq 2 is valid only for positive x several modifications have made for negative observations bickel and doksum 1981 john and draper 1980 manly 1976 sakia 1992 however these modifications change the zero point which has a great impact on the statistics of crests rychlik et al 1997 rychlik and leadbetter 1997 therefore a modified transformation is proposed 3 r x α 1 λ 1 λ λ 0 ln α 1 λ 0 where 4 α x λ where λ is a positive parameter and x λ is smaller than 1 as a result α 1 is always positive moreover r 0 0 which meets the condition proposed by rychlik and his colleagues rychlik et al 1997 rychlik and leadbetter 1997 however the average of r x is a little different from zero and the effects will be addressed later the expansion of eq 3 is 5 r α k 1 a k α k where 6 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 fig 1 verifies the expansion of eq 3 by the comparison between the analytic and numerical results it shows that the good agreement has been achieved when k 3 2 2 parameters λ and λ with the assumption that the transformed series r x obeys the normal distribution the corresponding skewness ε r and kurtosis κ r can be expressed as 7 ε r a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 σ r 3 0 8 κ r e r x e r x 4 σ r 4 a 1 4 κ σ 4 λ 4 σ r 4 3 where σ r is the standard deviation details can be found in appendix a as a result parameters λ and λ can be estimated by 9 λ 1 2 λ ε 3 σ κ 1 10 κ r κ 3 when terms with order equal or higher than o α 4 are ignored and the influence of the kurtosis can not be considered meanwhile parameters λ and λ are not unique as discussed in section 4 the larger the parameter λ is the better the results will be since the higher order of α k can be ignored according to eq 5 λ should be as small as possible the minimum value of λ is 1 and it leads to 11 λ 1 2 s i g ε λ 6 σ ε in this case a k α k a k 1 α k 1 is strictly correct as shown in appendix b note that x λ is a small amount appendix a it brings to 12 α ε x 6 σ 1 3 distribution of wave crest in section 2 a modified box cox transformation is proposed the parameters λ and λ are obtained by assuming that the skewness and kurtosis of r x are equal to those of the normal distribution however it is still uncertain whether r x strictly obeys normal distribution in this paper it is assumed that r x obeys the normal distribution to derive the wave crest exceedance probability 3 1 distribution of wave crest by the modified box cox transform for a zero mean gaussian process y the level up crossing rate υ of level u can be estimated by rychlik et al 1997 rychlik and leadbetter 1997 13 ν u 1 2 π m 2 m 0 e u 2 2 m 0 where m 0 and m 2 are the zero and two order spectral moment of y note that m 0 is also equal to the variance of y it is defined that 14 η t r η t e r η t where η t is the raw elevations series obviously the variance of η t is equal to σ r 2 the exceedance probability of crest of η t can be obtained by eq 13 as following 15 p η c h ν h ν e r η exp h 2 e 2 r η 2 σ r 2 where η c is the crest of η t because the crossing point changes to be e r η the crest exceedance probability of η t is 16 p η c σ h p η c σ r r h exp r 2 h e 2 r η 2 σ r 2 it can be approximated to o α 3 as follows 17 p η c σ h exp μ h 1 1 2 s i g ε 1 2 2 1 2 s i g ε 2 μ 2 1 12 μ 2 s i g ε where μ 1 6 ε eq 17 is the final formula of the crest exceedance probability it is referred to the modified box cox rayleigh mbr distribution in the following sections 3 2 comparing with the generalized tayfun distribution the generalized tayfun distribution is fedele and tayfun 2009 tayfun 1980 2006 tayfun and alkhalidi 2020 18 p t η c σ h exp 1 2 μ h 1 2 2 μ 2 where μ 1 3 ε parameter μ was firstly defined as the wave steepness fedele and tayfun 2009 19 μ m σ k 1 where k 1 is the mean wave number however fedele and tayfun found that the exceedance probability estimated by μ m is overestimated compared to the observed data an approximation of ε was proposed by them fedele and tayfun 2009 20 ε a 3 μ m 1 ν ν 2 where ν is the band width for intermediate and shallow water waves another approximation of ε was proposed by tayfun and alkhalidi 2020 21 ε s 3 μ m d 1 d 2 1 μ m 2 d 1 2 d 2 2 3 where d 1 and d 2 are the parameters related to the depth and wave number tayfun and alkhalidi 2020 more details can be found in appendix c eq 18 can be expanded as 22 p t η c σ h exp h 2 2 1 ε 6 h ε 2 h 2 18 o ε 3 h 3 2 similarly eq 17 can be expanded as 23 p η c σ h exp h 2 2 1 12 μ 2 1 ε h 6 ε 2 h 2 36 o ε 3 h 3 2 ε 0 24 p η c σ h exp h 2 2 1 12 μ 2 1 ε h 6 ε 2 h 2 108 2 ε 0 obviously if the terms with order equal or larger than o ε 2 are neglected the tayfun distribution is the same as the mbr distribution the influence of higher order terms increases with ε and η c σ as shown in fig 2 left plot mbr s exceedance probabilities are always larger than those of tayfun distribution when ε 0 when ε 0 mbr s exceedance probabilities are initially smaller however with the increase of η c σ they are slightly larger than those of tayfun distribution as shown fig 2 right plot 3 3 comparing with the forristall distribution forristall 2000 developed a two parameter weibull distribution of wave crests 25 p f η c σ h exp h 4 p q parameters p and q are given in terms of the steepness s 1 and the ursel number u r defined as 26 s 1 2 π g h s t 1 2 u r h s k 1 2 d 3 where h s and d are the significant wave height and the water depth respectively and t 1 and k 1 are the mean period and wave number calculated by the ratio of the first two order spectral moments the relationships between p q s 1 and u r are different in 2d sea and 3d sea however the differences between these two seas are small in this paper the parameters of 2d sea are employed 27 p 1 2 2 0 2892 s 1 0 1060 u r q 2 2 1597 s 1 0 0968 u r 2 these parameters were linked to the skewness by tayfun tayfun 2006 2008 28 ε f 48 p 3 q γ 3 q 3 4 π 2 a comparison between these three distributions in terms of k 1 d and d h s is given in fig 3 the differences increase with k 1 d and decrease with d h s it is also found that forristall s probabilities are always smaller than those of mbr and tayfun distributions when k 1 d 1 however when d h s 10 and k 1 d 0 352 mbr s probability is quite different from those of tayfun and forristall distributions it may because the skewness obtained by s 1 and u r is very large ε 0 82 and it disables the mbr distribution 4 verification and comparisons 4 1 waves in the lagoon the first data set was gathered from january 2018 to april 2019 with a datawell dwr mkiii directional waverider buoy the buoy was located at a lagoon of the south china sea with water depth of about 20 m locations and deployment details are given in fig 4 and table 1 further details can be referred to our previous works cai et al 2019 2020 there are 592 waves whose significant wave height is larger than 1 m ε 6σ s 1 and u r of these waves are given in fig 5 ε 6σ varies from 0 1 to 0 15 s 1 and u r are very small which indicates that the waves are weakly nonlinear four samples with ε 6σ varying from 0 5 to 0 15 are selected to verify the mbr model the parameters of these waves are given in table 2 the measured ε is compared with ε a ε s and ε f in fig 6 obviously when ε is positive ε a ε s and ε f locate around the measured ε results are shown in fig 7 through fig 10 it shows that the estimated probabilities of the models are in the 95 confidence intervals of observations therefore these three models are valid for the four waves in the case ε 6σ equal to 0 05 fig 7 tayfun and mbr models with the measured ε give better results for large waves in other cases the exceedance probabilities of large waves are slightly over predicted in the case ε 6σ equal to 0 05 all models give similar results as shown in fig 8 the exceedance probabilities of large waves are slightly underestimated by these models the comparison for the case ε 6σ equal to 0 1 is shown in fig 9 in this case all models agree well with the observations the mbr model gives larger results for large waves especially when it is calculated with ε a ε s and ε f similar results can be found when ε 6σ is equal to 0 15 as shown in fig 10 however the forristall model underestimates the observations for this case for large wave crests the mbr and tayfun models give better results than the forristall model it is worth to point out that the differences between the mbr and tayfun models are very small this may be due to the limited number of waves 4 2 measurements from the tern platform the second data set was gathered from the tern platform the experiment lasted for 9 hours and was employed to verify the tayfun distribution by fedele and tayfun 2009 the data of tern platform are obtained from fedele and tayfun 2009 the time series of the original measurements are not available and the comparisons herein is only based on the plots in their paper parameters of the tern platform data set are given in table 3 exceedance probabilities of the crest are compared in fig 11 it is found that the mbr distribution appears larger than the tayfun distribution for larger wave crests when the measured ε is employed these three models are similar to each other in other cases the exceedance probabilities estimated by the tayfun model and mbr model are mostly larger than those of the forristall model the plots between the ratio η c σ η r and p are shown in fig 12 for small waves all of these models overestimate the probabilities compared to the observations in this case the forristall model gives the best results and the worst results are obtained by the tayfun model for large waves the forristall model fits the observations for most parts however it underestimates for very large waves nevertheless forristall s probabilities are still in the range of the σ bands when the ε of the measurements is employed the tayfun model and the mbr model underestimate when ε ε s and ε ε f the tayfun model and mbr model tend to overestimate these three models best fit the observations when ε ε a after these benchmark it can be concluded that the mbr model matches best for large wave crests since it obtains larger p for larger crest in addition to smaller p for small crests 5 conclusions a new distribution model named modified box cox rayleigh mbr distribution is proposed to describe the wave crest of the non gaussian elevations the basic idea contains two steps firstly non gaussian elevations are transformed into gaussian elevations by a modified box cox transformation afterwards the crests of the transformed elevations are described by the rayleigh distribution the basic assumptions of this model are 1 the influence of kurtosis can be neglected 2 the skewness can be taken as a small amount these assumptions can be expressed by 29 α x ε 6 σ 1 κ 3 in order to get the final expression it is also assumed that the transferred series r x obeys the normal distribution assumption 1 has been verified by the field data from the lagoon and tern platform for these waves the maximum εη c 6σ close to 0 2 which is much smaller than 1 as a result the probabilities predicted by the mbr distribution mostly are in the range of the confidence or the σ bands it demonstrates that the mbr distribution model is valid for these applications however as the influences of kurtosis are neglected the mbr distribution is limited to the mildly nonlinear waves equal or smaller than 2nd order several conclusions can be drawn by comparing the mbr distribution with the tayfun distribution and the forristall distribution 1 the mbr distribution is the same as the tayfun distribution if terms smaller than o ε 2 are ignored 2 mbr s exceedance probabilities are always larger than those of tayfun distribution when ε 0 when ε 0 mbr s exceedance probabilities are initially smaller however with the increase of η c σ they are slightly larger than those of tayfun distribution 3 when the skewness is estimated by parameters of forristall the differences between these three distributions increase with k 1 d and decrease with the d h s when k 1 h 1 the probabilities of forristall distribution are always smaller than other two distributions comparisons between these distribution models based on the two sets of measured data have shown that 1 the mbr distribution gives better results than the forristall model for very large wave crests 2 the mbr model matches the observations better than the tayfun distribution since it obtains larger probabilities for larger crest in addition to smaller probabilities for small crests the mbr distribution is described by elevations σ and ε so for future research is going to associate it with the wave heights spectral bandwidth and some other parameters the uncertainties of these parameters will be taken into account furthermore more field measurement data are needed to further verify the mbr distribution credit authorship contribution statement z w cai conceptualization methodology validation formal analysis writing original draft x l liu data curation writing review editing w w chen data curation z sun writing review editing j ding writing original draft project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by the ministry of industry and information technology under grant number 2016 22 and 2019 357 by the fund of southern marine science and engineering guangdong laboratory zhanjiang and by jiangsu province science foundation for youths no 351510008k0708la00 we thank dr zhang xinyu for its linguistic assistance during the preparation of this manuscript appendix a original and central moments of the transformed series in section 2 1 the modified transformation is defined as 30 r α α 1 λ 1 λ λ 0 ln α 1 λ 0 where α x λ and α is much less than 1 by applying mclaughlin expansion to eq 30 we get 31 r α k 1 a k α k where 32 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 the n power of r x can be written as 33 r n α k 1 a k α k n n i 0 n 1 n 2 n k n n n 1 n 2 n k 1 i k a i n i α i n i the first four terms limited to o α 4 are 34 r α a 1 α 1 a 2 α 2 a 3 α 3 a 4 α 4 o α 4 35 r 2 α a 1 α 1 a 2 α 2 a 3 α 3 o α 3 2 a 1 2 α 2 2 a 1 a 2 α 3 a 2 2 α 4 2 a 1 a 3 α 4 o α 4 36 r 3 α a 1 α 1 a 2 α 2 o α 3 3 a 1 3 α 3 3 a 1 2 a 2 α 4 o α 4 37 r 4 α a 1 α 1 o α 2 4 a 1 4 α 4 o α 4 and the original moments of r α are 38 e r α a 1 e α 1 a 2 e α 2 a 3 e α 3 a 4 e α 4 39 e r 2 α a 1 2 e α 2 2 a 1 a 2 e α 3 a 2 2 e α 4 2 a 1 a 3 e α 4 40 e r 3 α a 1 3 e α 3 3 a 1 2 a 2 e α 4 41 e r 4 α a 1 4 e α 4 taking α x λ in eqs 38 41 we get 42 e r x a 1 λ e x a 2 λ 2 e x 2 a 3 λ 3 e x 3 a 4 λ 4 e x 4 43 e r 2 x a 1 2 λ 2 e x 2 2 a 1 a 2 λ 3 e x 3 a 2 2 λ 4 e x 4 2 a 1 a 3 λ 4 e x 4 44 e r 3 x a 1 3 λ 3 e x 3 3 a 1 2 a 2 λ 4 e x 4 45 e r 4 x a 1 4 λ 4 e x 4 for a zero mean random process x e x 0 and eq 42 can be rewritten as 46 e r x a 2 λ 2 e x 2 a 3 λ 3 e x 3 a 4 λ 4 e x 4 the first four central moments of r x are 47 e r x e r x 2 e r 2 x e 2 r x 48 e r x e r x 3 e r 3 x 3 e r 2 x e r x 2 e 3 r x 49 e r x e r x 4 e r 4 x 4 e r 3 x e r x 6 e r 2 x e 2 r x 3 e 4 r x taking eqs 43 46 into eqs 47 49 we get 50 e r x e r x 2 a 1 2 e x 2 λ 2 2 a 1 a 2 e x 3 λ 3 2 a 1 a 3 a 2 2 e x 4 λ 4 a 2 e x 2 λ 2 2 51 e r x e r x 3 a 1 3 e x 3 λ 3 3 a 1 2 a 2 e x 4 λ 4 3 a 1 2 a 2 e x 2 λ 2 2 52 e r x e r x 4 a 1 4 e x 4 λ 4 the standard deviation σ skewness ε and kurtosis κ of x are defined as 53 σ 2 e x e x 2 e x 2 54 ε e x e x 3 σ 3 e x 3 σ 3 55 κ e x e x 4 σ 4 e x 4 σ 4 applying eqs 53 55 to eqs 50 52 we obtain 56 e r x e r x 2 a 1 2 σ 2 λ 2 2 a 1 a 2 ε σ 3 λ 3 2 a 1 a 3 a 2 2 κ σ 4 λ 4 a 2 σ 2 λ 2 2 57 e r x e r x 3 a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 58 e r x e r x 4 a 1 4 κ σ 4 λ 4 therefore the standard deviation σ r skewness ε r and kurtosis κ r of r x are 59 σ r 2 e r x e r x 2 a 1 2 σ 2 λ 2 2 a 1 a 2 ε σ 3 λ 3 2 a 1 a 3 a 2 2 κ σ 4 λ 4 a 2 σ 2 λ 2 2 60 ε r e r x e r x 3 σ r 3 a 1 3 ε σ 3 λ 3 3 a 1 2 a 2 κ σ 4 λ 4 3 a 1 2 a 2 σ 2 λ 2 2 σ r 3 61 κ r e r x e r x 4 σ r 4 a 1 4 κ σ 4 λ 4 σ r 4 appendix b the influence of a k the a k can be expressed as 62 a k 1 k λ 1 λ k 1 λ 0 1 k 1 k λ 0 it leads to 63 a k 1 a k λ k k 1 λ 0 k k 1 λ 0 assuming that 64 a k 1 a k 1 one gets 65 k λ 2 k 1 or 1 λ k or λ k since k 1 2 3 we get 66 1 λ 1 or λ k so the minimum value of λ is 1 if λ 1 one gets 67 λ 3 σ ε 1 λ 6 σ ε as λ should be positive we set that 68 λ 6 σ ε it results in 69 λ 1 2 s i g ε 1 ε 0 3 ε 0 which meets eq 67 talking it into eq 62 one gets 70 a k 1 k λ 1 λ k 1 1 k ε 0 1 ε 0 a n d k 1 2 1 3 ε 0 a n d k 3 0 ε 0 a n d k 3 there are two points to be noticed 1 when ε 0 a k 1 which suggests that the order of a k α k depends only on the order of α k 2 when ε 0 and k 3 a k 0 which indicates that o a 4 α 4 0 these two points imply that it is reasonable to give up the terms with order equal or higher than o α 4 appendix c estimating the skewness for the original tayfun distribution the skewness was estimated by the wave steepness 71 ε t 3 μ m 3 σ k 1 fedele and tayfun found that the skewness was overestimated by eq 71 a fix was proposed by them 72 ε a 3 μ m 1 ν ν 2 3 σ ω m 2 g 1 ν ν 2 where 73 ν m 0 m 2 m 1 2 1 is the bandwidth the jth order spectral moment is 74 m j 0 ω j s ω d ω where s is the spectrum recently another approximation of ε was proposed by tayfun and alkhalidi 2020 75 ε s 3 μ m d 1 d 2 1 μ m 2 d 1 2 d 2 2 3 where 76 d 1 1 2 4 n 1 n 2 tanh k 1 d k 1 d d 2 cosh k 1 d 2 cosh 2 k 1 d 2 sinh k 1 d 3 77 n 1 2 1 2 k 1 d sinh 2 k 1 d a relationship between the skewness and the parameters of forristall model was proposed by tayfun tayfun 2006 2008 78 ε f 48 p 3 q γ 3 q 3 4 π 2 the parameters of 2d sea are 79 p 1 2 2 0 2892 s 1 0 1060 u r q 2 2 1597 s 1 0 0968 u r 2 and parameters of 3d sea are 80 p 1 2 2 0 2568 s 1 0 0800 u r q 2 1 7912 s 1 0 284 u r 2 
20851,the use of deflectors as augmentation devices to improve the power performance of a 3 bladed conventional savonius turbine has been investigated by analyzing the deflectors effects on self starting capability and power performance at various deflector angles two deflector plates positioned at the upstream of the turbine were tested inside a closed circuit wind tunnel at an air flow speed of 7 0 m s equivalent to 0 4 m s water flow speed the self starting capability of the turbine was characterized in terms of the coefficient of static torque c ts at various advancing blade deflector angles and returning blade deflector angles of δ a 15 30 45 60 and 75 and δ r 30 60 90 respectively it was found that the c ts profiles were generally higher than without any deflector the increment of δ r showed that it had a significant effect on the c ts profile due to the reduction of drag force on the returning blade as compared to the variation of δ a the study highlighted that the c ts profiles shifted away from the no self start conditions c ts 0 with the presence of deflectors the experimental results also revealed that the coefficient of power c p significantly improved for the case with the deflectors particularly at δ r 90 the highest c p of 0 183 was achieved at δ a 75 and δ r 90 which was also the optimal deflector configuration for the best self starting characteristics thus deflector augmentation may be a practical solution to improve the power performance and self starting capability of the savonius turbine in hydrokinetic applications particularly at the low speeds of narrow and shallower rivers commonly found in rural areas keywords savonius rotor deflector power performance self starting speed hydrokinetic experiment nomenclature latin symbols ar aspect ratio br blockage ratio c p coefficient of power c p m a x maximum coefficient of power c t coefficient of torque c t s coefficient of static torque d diameter of turbine m d diameter of blade m d s diameter of shaft m f 1 load acquired by load cell 1 n f 2 load acquired by load cell 2 n h height of turbine m h wt height of the test section m h d height of deflector m l length of the test section m p o power generated by the turbine w r radius of turbine m rew water channel reynolds number rewt wind tunnel reynolds number r p radius of pulley m t dynamic torque nm t s static torque nm t b thickness of blade m u fluid flow speed m s w wt width of the test section m w width of the test section m w d width of deflector m greek symbols δ a advancing blade deflector angle δ r returning blade deflector angle θ rotor angle λ tip speed ratio λmax maximum tip speed ratio μ dynamic viscosity of fluid kg ms ρ density of fluid kg m3 ω angular velocity rad s abbreviations re reynolds number hkt hydrokinetic turbine rpm revolution per minute 1 introduction the depletion of fossil fuel reserves has sparked economic concerns around the world including those who live in remote areas and are highly dependent on diesel generators behrouzi et al 2016 renewable energy resources are now considered a sustainable alternative for a continuous electricity supply to those communities as most remote settlements are in a close proximity to a river its kinetic energy can be harnessed to generate electricity salleh et al 2019 for a low cost hydrokinetic application a savonius turbine may be a more practical option than other turbines which are currently available a conventional savonius turbine is a drag driven vertical axis turbine that has two semi circular blades as the flow passed through the turbine blades the drag force difference in between the blades generates a positive net torque that rotates the turbine maldar et al 2020 the rotational energy of the turbine then can be converted into electrical energy using a generator khan et al 2009 this turbine has the advantages in terms of its design simplicity low cost low noise and good self starting capability thus it is suitable to be employed in rivers with a low flow rate vermaak et al 2014 the main drawback is the turbine has a low power efficiency of usually less than 0 3 in comparison to the lift driven vertical axis turbines such as the darrieus turbine kumar and saini 2016 this is due to the flow asymmetry around the blades as it rotates which eventually limits the average power performance of the turbine tian et al 2019 there have been several attempts to improve the power performance of the savonius turbine by varying and optimizing design parameters such as the aspect ratio patel et al 2016 overlap ratio patel et al 2016 yaakob et al 2013 end plate ratio ogawa and yoshida 1986 saha et al 2008 jeon et al 2015 number of stages kumar et al 2020 blade profile kerikous and thévenin 2019a b masdari et al 2019 ramadan et al 2020 and auxiliary blades al ghriybah et al 2019 the concept of hybrid turbine by integrating the advantages of the savonius turbine in terms of its self starting capability into the excellent power performance of darrieus turbine has also been proposed by hosseini and goudarzi 2019 pan et al 2019 and saini and saini 2020 in addition many efforts have also been made towards implementing augmentation devices such as the guiding rotor house casing stators and deflectors manganhar et al 2019 introduced a guiding rotor house which is nested the savonius wind turbine and found a significant increment in the power performance of 2 3 times as compared to a turbine without the guiding rotor house they found that the guiding rotor house accelerated the incoming flow and allowed the turbine to be operated omnidirectionally antar and elkhoury 2019 optimized the curviness of geometric casing by performing a three dimensional simulation the optimal geometric shape casing caused the power performance to improve by 42 5 with respect to the caseless turbine next el deen et al 2020 optimized the stator parameters in terms of the stator angle length and distance from the savonius bach type turbine and found that the maximum coefficient of power reached a value of 6 times that of without the stator salleh et al 2020 used a flat deflector configured at 60 deflector angle to compare its effects on the power performance for both two bladed and three bladed conventional savonius turbines based on the experimental results the performance of the two bladed and three bladed turbines were improved by 128 4 and 604 6 respectively relative to the case without the deflector they also found that decreasing the longitudinal distance of the returning blade deflector to 0 28 m while increasing the advancing blade deflector longitudinal distance to 0 08 m from the centre of the turbine significantly improved the coefficient of power from 0 13 to 0 26 however when the deflector height was reduced by half the coefficient of power significantly reduced by 7 69 lower than without the deflector in another study golecha et al 2011 positioned a deflector plate at the upstream of the returning blade of a modified two bladed savonius hydrokinetic turbine the experimental results showed a 50 improvement in overall turbine power performance then by adding another deflector plate positioned at the upstream of the advancing blade golecha et al 2012 showed that the turbine can be further improved up to 150 alizadeh et al 2020 used a curve barrier that acted like a deflector to improve the savonius hydrokinetic turbine at low flow speed their numerical study revealed that the coefficient of power has improved by 19 compared to the case without the barrier considering the effectiveness of the deflector in improving the power performance of a turbine kerikous and thévenin 2019a b optimized the geometry of the deflector plate using an in house code optimization opal then payambarpour et al 2020 employed the concept of deflector for an in pipe savonius hydrokinetic turbine deflector parameters such as the deflector angle and blockage coefficient were studied and they showed the power performance of the turbine was influenced by those parameters as a savonius turbine generally does not suffer from a low self starting torque like its counterpart the darrieus turbine there has been limited literature related to characterizing its self starting capability as a result there has been limited coverage of this issue however it has become an issue in low flow rate conditions recently particularly in a developing country like malaysia nasef et al 2013 numerically and experimentally studied the effects of turbine diameter reynolds number and overlap ratio on the self starting characteristic of the two bladed savonius wind turbine represented in terms of coefficient of static torque they found that the first two parameters exhibited a small effect on the coefficient of static torque which increased when the overlap ratio increased from 0 to 0 5 for all tested overlap ratio the highest and the lowest coefficient of static torque has occurred at 45 and 135 of rotor angle respectively bhayo et al 2017 conducted an experimental study on the effect of the blade profiles and the number of stages on the coefficient of static torque the results showed that the coefficient of static torque was significantly influenced by the blade profile of the turbine their study also revealed that the double stages turbines have eliminated the negative coefficient of static torque characteristic of the turbine in comparison to the single stage turbine thus allowing the turbines to self start at any rotor angle then in a numerical study sarkar et al 2018 found that the static torque could be affected by the bucket angle of the savonius turbine blade profile they also found that the static torque increased with the present of end plates by 42 in comparison to the case without end plates a similar issue was also discussed by zhao et al 2018 as they highlighted that the presence of the end plates increased the value of the static torque the effects of augmentation devices on the self starting capability of the savonius turbines can also be seen in studies of the guide box casing and deflector respectively for instance a numerical study conducted by el askary et al 2015 demonstrated that the coefficient of static torque of a two bladed turbine significantly improved with the presence of a casing the negative coefficient of static torque was eliminated and its maximum value was shifted from a rotor angle of 45 without the casing to 140 irabu et al 2007 compared the coefficient of static torque with and without the guide box tunnel for two bladed and three bladed turbines the experimental results showed that the coefficient of static torque for both turbines increased with the implementation of the guide box tunnel for the two bladed turbine the negative coefficient of static torque has decreased or eliminated and the maximum coefficient of static torque has shifted from 30 rotor angle to 50 with the presence of the guide box tunnel on the other hand the shifting coefficient of static torque from about 25 rotor angle to 45 rotor angle was observed for the three bladed turbine similar results were also found by mohamed et al 2010 when a deflector plate was placed at the upstream of the returning blade of the two bladed and three bladed turbines the increment of coefficient of static torque from the region of no self starting improved the self starting capability of the turbine thus allowing the turbine to operate under low flow speed conditions previous studies have established that the usage and implementation of augmentation devices such as the guide box and the deflector not only influences the power performance of a turbine but also affects its capability to self start el askary et al 2015 irabu et al 2007 mohamed et al 2010 for this reason it is important to characterize the self starting capability of a turbine so that the feasibility to self start at any rotor angle can be improved particularly in a river with a low flow speed for hydrokinetic applications therefore this paper aims to characterize the self starting capability of a three bladed conventional savonius turbine at low flow speed for hydrokinetic applications with the presence of two deflector plates tested at various deflector angles in addition the corresponding power performance of the turbine with respect to the various deflector angles has been analyzed the correlation between the self starting speed and the power performance of the turbine with respect to the optimal deflector angle is also discussed 2 experimental model and measurement method in order to analyse the self starting capability of the savonius turbine model for hydrokinetic applications the static torques of the turbine model were measured and tested inside a closed circuit wind tunnel facility at the wind tunnel laboratory science and engineering research centre serc universiti sains malaysia the wind tunnel has a rectangular test section of 1 8 m length lwt 1 0 m width w wt 0 8 m height h wt with a contraction ratio of 10 1 and is capable to achieve a maximum air flow speed of 80 m s with a turbulence level of 0 1 inside the test section the air flow speed was acquired by a built in pitot tube and pressure transducer located at the upstream of the test section inlet in the present study the flow uniformity in which the air flow speed u a across the test section width w wt was measured using a hot wire anemometer with an accuracy of 3 and the relative uncertainty for the air speed was 0 71 the measurements were acquired 0 59 m from the origin at the centre of the test section where the turbine was mounted in the wind tunnel the air flow speed as shown in fig 1 was mostly consistent across the test section width where the average air flow speed was found to be the same with the reading acquired by the pressure transducers at around 7 0 m s equivalent to 0 4 m s of water flow speed and corresponding to the reynolds number of 148 000 2 1 savonius turbine model in the present study a three bladed semi circular savonius turbine model was constructed with a height h of 0 132 m and a diameter d of 0 329 m the aspect ratio ar of the turbine was set at 0 401 which was the optimal value for a low aspect ratio savonius turbine based on the study found from patel et al 2016 and the blockage ratio br of the turbine in the wind tunnel test section the ratio of the turbine frontal area to the cross sectional area of the test section was found to be at around 0 054 5 4 the blades of the turbine were made of aluminium with a thickness of 0 002 m and were arranged 120 from each other as shown in fig 2 the blade with its concave surface facing the incoming flow was denoted as the advancing blade while the other two were denoted as the returning blades because the turbine model was rotationally symmetrical at 120 the turbine had three sets of identical configurations with respect to the rotor angle θ in one complete rotation i e 0 θ 120 120 θ 240 and 240 θ 360 the rotor angle is defined as the angle between the advancing blade and the direction of the incoming flow the blades were covered like a sandwich with a top and bottom end plates made of clear acrylic with a thickness of 0 010 m the diameter of the end plate d e was 1 1d larger than the diameter of the turbine which was considered as the optimal value saha et al 2008 kamoji et al 2009 each end plate was attached to a shaft with a diameter of 0 025 m where the top shaft was connected to a pulley of a torque measurement setup table 1 summarizes the geometrical parameters of the turbine model 2 2 deflector plates two deflector plates were placed at the upstream of the turbine the width and height of the plates were 0 132 m and 0 183 m respectively as shown in fig 3 the returning blade deflector plate was positioned such that its edge was closest to the turbine at 1 204r 0 000r from the centre of the turbine while the advancing blade deflector plate was positioned such that its edge closest to the turbine at 0 000 r 1 204r from the centre of the turbine where r was the radius of the turbine in order to study the effect of deflector configuration on the self starting capability of the turbine model the returning blade deflector angle δ r was varied at 30 60 and 90 at each δ r the advancing blade deflector angle δ a was varied at 15 30 45 60 and 75 table 2 lists the variations of the δ r and δ a 2 3 torque measurements in this study the self starting capability of the turbine was analyzed in terms of static torques generated by the turbine model this torque was acquired by using a prony brake dynamometer set up positioned at the top of the test section of the wind tunnel two s type tension compression load cells 0 1 full scale precision were mounted on a support rig of the setup and used to measure the load applied to the turbine model as shown in fig 4 first the turbine model was held static at a specific rotor angle θ from 0 to 120 with a 15 interval then the traction belt wrapped around the pulley was slowly released as the turbine was just about to rotate simultaneously the applied loads indicated by the load display were recorded these applied loads were used to obtain the static torque t s and the coefficient of static torque c ts as governed by the following equations the static torque t s generated by the turbine model can be obtained as follows 1 t s δ f r p where δf was the force difference between the two load cells f 1 and f 2 where the turbine was at a static state just about to rotate and r p was the radius of the pulley r p 0 030 m it is common to present the static torque in terms of the coefficient of static torque against the rotor angle then the coefficient of static torque c ts can be obtained from 2 c t s 4 t s ρ h d 2 u 2 where ρ was the density of the incoming flow h was the height of the rotor d was the diameter of the rotor and u was the incoming flow speed of the working fluid medium meanwhile the power performance of the turbine was analyzed by obtaining the dynamic torque of the turbine with the same prony brake dynamometer setup as described above the braking loads or forces were applied to the rotating turbine until the turbine reached stalled condition these applied braking loads were reduced to obtain the dynamic torque t as follows 3 t δ f r p the ratio of the dynamic torque to the available torque for which the force acting on the turbine blades is defined as the coefficient of torque c t and is given by 4 c t 4 t ρ d 2 h u 2 based on the c t the power performance of the turbine in terms of coefficient of power c p an be obtained based on the following relation 5 c p 2 t ω ρ d h u 3 c t λ where λ is the tip speed ratio i e the ratio between the turbine tip speed with respect to the incoming flow speed and it is expressed as 6 λ ω d 2 u where ω is the turbine angular speed which can be obtained by converting the rotational speed of the turbine model in revolution per minute rpm as follows 7 ω 2 π 60 rpm where the rpm of the turbine model was acquired by a hall effect tachometer as the experiment on the savonius turbine model was conducted in a wind tunnel it was important to maintain the reynolds number similarity between two different working fluids i e air and water for hydrokinetic applications therefore 8 r e a r e w ρ a u a d a μ a ρ w u w d w μ w must be achieved while conducting the experiment where re was the reynolds number μ was the dynamic viscosity and subscripts a and w refer to air and water respectively the errors associated with the measurements were obtained based on the method proposed by moffat 1988 where the general formula is given as follows 9 u r δ r r a δ x 1 x 1 2 b δ x 2 x 2 2 m δ x m x m 2 1 2 for which a x 1 r r x 1 b x 2 r r x 2 m x m r r x m where u r is the relative uncertainty of the measured parameter in this study the relative uncertainties of the air flow speed reynolds number the highest coefficient of static torque and coefficient of power were 0 71 0 73 and 2 37 2 36 respectively 3 results and discussion the 3 bladed savonius turbine was tested in the wind tunnel at an air flow speed of 7 0 m s which is equivalent to 0 4 m s water flow speed in a water channel for hydrokinetic applications this was obtained based on the reynolds number similarity principle given by eq 8 the self starting capability in terms of coefficient of static torque was characterized with respect to the rotor angle at various returning and advancing blade deflector angles the results were compared with the case without the deflectors then the corresponding power performance in terms of coefficient of power was analyzed 3 1 self starting capability in order to study the effects of deflector configurations on the self starting capability of the turbine model the coefficient of static torque c ts against the rotor angle θ for the case of without the deflectors was first analyzed as a baseline for comparison comparing the results from the present study with the experimental study by irabu et al 2007 as shown in fig 5 the general trend for the c ts profiles for both turbine models without deflectors were similar for the range of the rotor angles tested from θ 0 120 however the c ts values in the present study were relatively higher compared to those from their study one likely reason for this difference is that the present experiment was conducted at a higher reynolds number of 1 48 105 their experiment was performed at a lower reynolds number of 6 05 104 the c ts increased when the θ increased from 0 to 30 then decreased when the θ increased to 45 then the c ts increased when the θ increased to 105 before it decreased again when the θ was at 120 the maximum and minimum coefficient of static torque were c tsmax 0 455 and c tsmin 0 156 respectively each occurred at θ 105 and 0 respectively the range of c ts i e the difference between the c tsmax and c tsmin was 0 298 in addition the c ts was positive for all range of θ tested in the current study which in principle it allows the turbine model to self start at any rotor angle note that due to the symmetry and periodicity of the 3 bladed turbine model by 120 only c ts in the range of 0 120 is presented a significant change in the c ts profile was observed with the presence of deflectors as shown in fig 6 for the returning blade deflector angle δ r 30 as shown in fig 5 a the c ts was first decreased when the θ increased from 0 to 15 then it increased as the θ further increased to 90 before it decreased again when θ reached 120 for the δ r 60 and δ r 90 similar profiles can be observed in fig 5 b and c where the c ts increased when the θ increased from 0 to 45 then it decreased when the θ further increased up to 120 similar to the case of without the deflector the c ts was positive for all tested θ hence the turbine model has the ability to self start at any rotor angle moreover for the tested θ most of the c ts with the presence of the deflectors was found to be higher than that of without the deflectors this value increased with the increment of the δ r from 30 to 90 although not consistant the value of c ts also increased with the increment of the advancing blade deflector angle δ a the results revealed that the increment in the c ts allowed the turbine model with the deflectors to self start even at a low flow speed thus it is practical for implementation in a slow flowing river the configuration of the deflectors at δ a 75 and δ r 90 resulted in the highest coefficient of static torque for most of the θ in comparison to the other deflector configurations therefore it was considered to be the optimal deflector configuration to obtain the highest self starting capbility for the three bladed savonius turbine further analysis on the c ts profiles indicated that the increment of δ r had a significant influence on the c ts as compared to the increment of δ a this can be observed in fig 7 where the c tsmax increased with a steep slope when the δ r increased from 30 to 90 in contrast the variation of δ a showed a small increment in the c tsmax in terms of the flow physics the deflector plate at δ r 90 effectively blocked the incoming flow towards the returning blade of the turbine hence reducing the drag force on this blade consequently the drag force difference between the advancing blade and the returning blade increased causing the increment of c ts the effect of drag force reduction on the returning blade was found to be more significant than the effect of drag force increment on the advancing blade due to the presence of the advancing blade deflector table 3 lists the maximum and minimum coefficients of static torque the rotor angle that corresponds to the maximum and minimum c ts and the range of c ts for the case of without and with the deflectors at various deflector configurations it was found that the c tsmax for the δ r 30 mostly occurred at θ 90 whereas for the δ r 60 and 90 the c tsmax mostly occurred at θ 45 for both without and with the deflectors the c tsmin occurred at θ 0 except for the δ r 30 where it occurred at θ 15 in general the c tsmin increased when the δ r increased which indicated that the c ts profile as a function of θ shifted away from the no self start condition c ts 0 morevoer the range of c ts also increased as δ r increased from 30 to 90 3 2 power performance the coefficient of power c p for the turbine model at various deflector angles tested in the self starting experiment is shown in fig 8 overall the presence of the deflectors resulted in higher c p curves than without deflectors except for the deflector configurations at δ a 15 δ r 30 and δ a 45 δ r 30 as shown in fig 8 a the c p reduction at these two deflector configurations was most likely due to the advancing blade deflector configuration and position that was unable to deflect the incoming flow towards the concave surface of the advancing blade at the same time the small angle of the returning blade at this condition with respect to the incoming flow could not be fully blocked from being impinged on the convex surface of the returning blade hence it eventually reduced the net torque to generate the power as the δ r increased the c p curves also increased higher than without the deflector as depicted in fig 8 b and c in addition the range of the tip speed ratio λ has also increased with the increment of δ r this indicated that the rotational speed of the turbine was increased as more kinetic energy from the incoming flow was harnessed by the turbine consequently generating more power on the other hand it was also found that the advancing blade deflector configured at the small angles of δ a 15 45 resulted in a lower c p curve regardless of δ r variation as shown in fig 9 the δ r increment was found to have a strong influence on the significant increments of the maximum coefficient of power c pmax as compared to the δ a increment it was revealed that the c pmax increased by around 1 5 and almost doubled when the δ r increased from 30 to 60 and 90 respectively this might be due to the c p curves for the turbine being generally higher than those without the deflectors at δ r 60 and 90 even though the advancing blade deflector was configured at δ a 15 45 as the δ r increased more area of the returning blade was blocked by the deflector hence it eventually reduced the amount of incoming flow that impinged on the blade consequently the negative torque due to the pressure drag on this bladed decreased increasing the net torque to generate power it was observed that this effect was more significant than the increament of positive torque on the advancing blade due to the concentrated incoming flow directed by the advancing blade moreover the effect of δ r increment on the c pmax was nearly consistent with the experimental results on the self starting capability of the turbine model table 4 lists the c pmax the corresponding λ at c pmax and the power performance improvement relative to that of without the deflectors case regardless of the deflector angle variations the c pmax has mostly occurred at the tip speed ratio around 0 68 to 0 74 meanwhile the power performance improvement of the turbine exhibited significant increment with the increment of δ r the highest power performance improvement of 109 97 was obtained for deflectors configuration at δ a 75 and δ r 90 where the c pmax 0 183 it is worth to note that these angles were also the optimal deflector configuration that resulted in the highest self starting capability of the turbine therefore the optimal deflector configuration for the deflector augmented three bladed savonius turbine tested in the present study resulting in the highest self starting capability and power improvement was found to be the same with such deflector angles the turbine will be able to self start at a lower flow speed without the need to change the deflector configuration to generate power the findings in the current study can be useful in designing a deflector augmented savonius turbine for hydrokinetic application in which an integrated active deflector angle controller can be omitted hence reducing the development and operational cost of the turbine for a sustainable power generation 4 conclusions in the present study the effects of deflector on the self starting capability of the three bladed semi circular savonius hkt model were investigated in terms of coefficient of static torque at various advancing and returning blade deflector angles using the reynolds number similarity approach the turbine model was tested in a closed circuit wind tunnel at an air flow speed of 7 0 m s which is equivalent to 0 40 m s water flow speed at re 148 000 then under the same flow conditions the corresponding power performance in terms of the coefficient of power was analyzed with respect to the varied deflector angles considered in the self starting experiment the c ts and c p for the case without the deflectors were also derived as a baseline for comparison it can be concluded that the c ts profiles with the presence of the deflectors were different from the case of without the deflectors and generally the c ts values were higher with the presence of the deflectors the value of c ts increased when the returning blade deflector angle increased from δ r 30 90 and the same trend was also observed with the increment of the advancing blade deflector angle from δ a 15 75 although it was not entirely consistent throughout the range the maximum coefficient of static torque c tsmax was significantly influenced by the increment of δ r whereas it was less affected by the increment of δ a the c ts profiles shifted away from the no self start condition with the presence of the deflectors and the optimal deflector configuration was found to be δ a 75 and δ r 90 similar trends were also found for the c p curves where the increment of δ r resulted in a significant c p increment as compared to the increment of δ a the optimal deflector configuration which resulted in the highest c pmax improvement by 109 97 was similar to the optimal deflector configuration found in the self starting experiment i e δ a 75 and δ r 90 this study has demonstrated the practicality of the deflector plates positioned at the upstream of the three bladed savonius turbine model the deflectors in most configuration not only increased the c ts values away from the no self start condition but also improved the power performance of the turbine the fact that the optimal deflector configuration resulted in the highest self starting capability and power performance was the same could potentially reduced the operational cost of the turbine in which the active deflector controller can be omitted thus this deflector augmented turbine model can be practically implemented for hydrokinetic applications in rivers with low flow speeds credit authorship contribution statement mohd badrul salleh investigation methodology formal analysis writing original draft noorfazreena m kamaruddin conceptualization methodology formal analysis writing review editing supervision project administration zulfaa mohamed kassim conceptualization resources writing review editing elmi abu bakar conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the financial support from universiti sains malaysia under the research university individual grant rui 1001 paero 8014132 
20851,the use of deflectors as augmentation devices to improve the power performance of a 3 bladed conventional savonius turbine has been investigated by analyzing the deflectors effects on self starting capability and power performance at various deflector angles two deflector plates positioned at the upstream of the turbine were tested inside a closed circuit wind tunnel at an air flow speed of 7 0 m s equivalent to 0 4 m s water flow speed the self starting capability of the turbine was characterized in terms of the coefficient of static torque c ts at various advancing blade deflector angles and returning blade deflector angles of δ a 15 30 45 60 and 75 and δ r 30 60 90 respectively it was found that the c ts profiles were generally higher than without any deflector the increment of δ r showed that it had a significant effect on the c ts profile due to the reduction of drag force on the returning blade as compared to the variation of δ a the study highlighted that the c ts profiles shifted away from the no self start conditions c ts 0 with the presence of deflectors the experimental results also revealed that the coefficient of power c p significantly improved for the case with the deflectors particularly at δ r 90 the highest c p of 0 183 was achieved at δ a 75 and δ r 90 which was also the optimal deflector configuration for the best self starting characteristics thus deflector augmentation may be a practical solution to improve the power performance and self starting capability of the savonius turbine in hydrokinetic applications particularly at the low speeds of narrow and shallower rivers commonly found in rural areas keywords savonius rotor deflector power performance self starting speed hydrokinetic experiment nomenclature latin symbols ar aspect ratio br blockage ratio c p coefficient of power c p m a x maximum coefficient of power c t coefficient of torque c t s coefficient of static torque d diameter of turbine m d diameter of blade m d s diameter of shaft m f 1 load acquired by load cell 1 n f 2 load acquired by load cell 2 n h height of turbine m h wt height of the test section m h d height of deflector m l length of the test section m p o power generated by the turbine w r radius of turbine m rew water channel reynolds number rewt wind tunnel reynolds number r p radius of pulley m t dynamic torque nm t s static torque nm t b thickness of blade m u fluid flow speed m s w wt width of the test section m w width of the test section m w d width of deflector m greek symbols δ a advancing blade deflector angle δ r returning blade deflector angle θ rotor angle λ tip speed ratio λmax maximum tip speed ratio μ dynamic viscosity of fluid kg ms ρ density of fluid kg m3 ω angular velocity rad s abbreviations re reynolds number hkt hydrokinetic turbine rpm revolution per minute 1 introduction the depletion of fossil fuel reserves has sparked economic concerns around the world including those who live in remote areas and are highly dependent on diesel generators behrouzi et al 2016 renewable energy resources are now considered a sustainable alternative for a continuous electricity supply to those communities as most remote settlements are in a close proximity to a river its kinetic energy can be harnessed to generate electricity salleh et al 2019 for a low cost hydrokinetic application a savonius turbine may be a more practical option than other turbines which are currently available a conventional savonius turbine is a drag driven vertical axis turbine that has two semi circular blades as the flow passed through the turbine blades the drag force difference in between the blades generates a positive net torque that rotates the turbine maldar et al 2020 the rotational energy of the turbine then can be converted into electrical energy using a generator khan et al 2009 this turbine has the advantages in terms of its design simplicity low cost low noise and good self starting capability thus it is suitable to be employed in rivers with a low flow rate vermaak et al 2014 the main drawback is the turbine has a low power efficiency of usually less than 0 3 in comparison to the lift driven vertical axis turbines such as the darrieus turbine kumar and saini 2016 this is due to the flow asymmetry around the blades as it rotates which eventually limits the average power performance of the turbine tian et al 2019 there have been several attempts to improve the power performance of the savonius turbine by varying and optimizing design parameters such as the aspect ratio patel et al 2016 overlap ratio patel et al 2016 yaakob et al 2013 end plate ratio ogawa and yoshida 1986 saha et al 2008 jeon et al 2015 number of stages kumar et al 2020 blade profile kerikous and thévenin 2019a b masdari et al 2019 ramadan et al 2020 and auxiliary blades al ghriybah et al 2019 the concept of hybrid turbine by integrating the advantages of the savonius turbine in terms of its self starting capability into the excellent power performance of darrieus turbine has also been proposed by hosseini and goudarzi 2019 pan et al 2019 and saini and saini 2020 in addition many efforts have also been made towards implementing augmentation devices such as the guiding rotor house casing stators and deflectors manganhar et al 2019 introduced a guiding rotor house which is nested the savonius wind turbine and found a significant increment in the power performance of 2 3 times as compared to a turbine without the guiding rotor house they found that the guiding rotor house accelerated the incoming flow and allowed the turbine to be operated omnidirectionally antar and elkhoury 2019 optimized the curviness of geometric casing by performing a three dimensional simulation the optimal geometric shape casing caused the power performance to improve by 42 5 with respect to the caseless turbine next el deen et al 2020 optimized the stator parameters in terms of the stator angle length and distance from the savonius bach type turbine and found that the maximum coefficient of power reached a value of 6 times that of without the stator salleh et al 2020 used a flat deflector configured at 60 deflector angle to compare its effects on the power performance for both two bladed and three bladed conventional savonius turbines based on the experimental results the performance of the two bladed and three bladed turbines were improved by 128 4 and 604 6 respectively relative to the case without the deflector they also found that decreasing the longitudinal distance of the returning blade deflector to 0 28 m while increasing the advancing blade deflector longitudinal distance to 0 08 m from the centre of the turbine significantly improved the coefficient of power from 0 13 to 0 26 however when the deflector height was reduced by half the coefficient of power significantly reduced by 7 69 lower than without the deflector in another study golecha et al 2011 positioned a deflector plate at the upstream of the returning blade of a modified two bladed savonius hydrokinetic turbine the experimental results showed a 50 improvement in overall turbine power performance then by adding another deflector plate positioned at the upstream of the advancing blade golecha et al 2012 showed that the turbine can be further improved up to 150 alizadeh et al 2020 used a curve barrier that acted like a deflector to improve the savonius hydrokinetic turbine at low flow speed their numerical study revealed that the coefficient of power has improved by 19 compared to the case without the barrier considering the effectiveness of the deflector in improving the power performance of a turbine kerikous and thévenin 2019a b optimized the geometry of the deflector plate using an in house code optimization opal then payambarpour et al 2020 employed the concept of deflector for an in pipe savonius hydrokinetic turbine deflector parameters such as the deflector angle and blockage coefficient were studied and they showed the power performance of the turbine was influenced by those parameters as a savonius turbine generally does not suffer from a low self starting torque like its counterpart the darrieus turbine there has been limited literature related to characterizing its self starting capability as a result there has been limited coverage of this issue however it has become an issue in low flow rate conditions recently particularly in a developing country like malaysia nasef et al 2013 numerically and experimentally studied the effects of turbine diameter reynolds number and overlap ratio on the self starting characteristic of the two bladed savonius wind turbine represented in terms of coefficient of static torque they found that the first two parameters exhibited a small effect on the coefficient of static torque which increased when the overlap ratio increased from 0 to 0 5 for all tested overlap ratio the highest and the lowest coefficient of static torque has occurred at 45 and 135 of rotor angle respectively bhayo et al 2017 conducted an experimental study on the effect of the blade profiles and the number of stages on the coefficient of static torque the results showed that the coefficient of static torque was significantly influenced by the blade profile of the turbine their study also revealed that the double stages turbines have eliminated the negative coefficient of static torque characteristic of the turbine in comparison to the single stage turbine thus allowing the turbines to self start at any rotor angle then in a numerical study sarkar et al 2018 found that the static torque could be affected by the bucket angle of the savonius turbine blade profile they also found that the static torque increased with the present of end plates by 42 in comparison to the case without end plates a similar issue was also discussed by zhao et al 2018 as they highlighted that the presence of the end plates increased the value of the static torque the effects of augmentation devices on the self starting capability of the savonius turbines can also be seen in studies of the guide box casing and deflector respectively for instance a numerical study conducted by el askary et al 2015 demonstrated that the coefficient of static torque of a two bladed turbine significantly improved with the presence of a casing the negative coefficient of static torque was eliminated and its maximum value was shifted from a rotor angle of 45 without the casing to 140 irabu et al 2007 compared the coefficient of static torque with and without the guide box tunnel for two bladed and three bladed turbines the experimental results showed that the coefficient of static torque for both turbines increased with the implementation of the guide box tunnel for the two bladed turbine the negative coefficient of static torque has decreased or eliminated and the maximum coefficient of static torque has shifted from 30 rotor angle to 50 with the presence of the guide box tunnel on the other hand the shifting coefficient of static torque from about 25 rotor angle to 45 rotor angle was observed for the three bladed turbine similar results were also found by mohamed et al 2010 when a deflector plate was placed at the upstream of the returning blade of the two bladed and three bladed turbines the increment of coefficient of static torque from the region of no self starting improved the self starting capability of the turbine thus allowing the turbine to operate under low flow speed conditions previous studies have established that the usage and implementation of augmentation devices such as the guide box and the deflector not only influences the power performance of a turbine but also affects its capability to self start el askary et al 2015 irabu et al 2007 mohamed et al 2010 for this reason it is important to characterize the self starting capability of a turbine so that the feasibility to self start at any rotor angle can be improved particularly in a river with a low flow speed for hydrokinetic applications therefore this paper aims to characterize the self starting capability of a three bladed conventional savonius turbine at low flow speed for hydrokinetic applications with the presence of two deflector plates tested at various deflector angles in addition the corresponding power performance of the turbine with respect to the various deflector angles has been analyzed the correlation between the self starting speed and the power performance of the turbine with respect to the optimal deflector angle is also discussed 2 experimental model and measurement method in order to analyse the self starting capability of the savonius turbine model for hydrokinetic applications the static torques of the turbine model were measured and tested inside a closed circuit wind tunnel facility at the wind tunnel laboratory science and engineering research centre serc universiti sains malaysia the wind tunnel has a rectangular test section of 1 8 m length lwt 1 0 m width w wt 0 8 m height h wt with a contraction ratio of 10 1 and is capable to achieve a maximum air flow speed of 80 m s with a turbulence level of 0 1 inside the test section the air flow speed was acquired by a built in pitot tube and pressure transducer located at the upstream of the test section inlet in the present study the flow uniformity in which the air flow speed u a across the test section width w wt was measured using a hot wire anemometer with an accuracy of 3 and the relative uncertainty for the air speed was 0 71 the measurements were acquired 0 59 m from the origin at the centre of the test section where the turbine was mounted in the wind tunnel the air flow speed as shown in fig 1 was mostly consistent across the test section width where the average air flow speed was found to be the same with the reading acquired by the pressure transducers at around 7 0 m s equivalent to 0 4 m s of water flow speed and corresponding to the reynolds number of 148 000 2 1 savonius turbine model in the present study a three bladed semi circular savonius turbine model was constructed with a height h of 0 132 m and a diameter d of 0 329 m the aspect ratio ar of the turbine was set at 0 401 which was the optimal value for a low aspect ratio savonius turbine based on the study found from patel et al 2016 and the blockage ratio br of the turbine in the wind tunnel test section the ratio of the turbine frontal area to the cross sectional area of the test section was found to be at around 0 054 5 4 the blades of the turbine were made of aluminium with a thickness of 0 002 m and were arranged 120 from each other as shown in fig 2 the blade with its concave surface facing the incoming flow was denoted as the advancing blade while the other two were denoted as the returning blades because the turbine model was rotationally symmetrical at 120 the turbine had three sets of identical configurations with respect to the rotor angle θ in one complete rotation i e 0 θ 120 120 θ 240 and 240 θ 360 the rotor angle is defined as the angle between the advancing blade and the direction of the incoming flow the blades were covered like a sandwich with a top and bottom end plates made of clear acrylic with a thickness of 0 010 m the diameter of the end plate d e was 1 1d larger than the diameter of the turbine which was considered as the optimal value saha et al 2008 kamoji et al 2009 each end plate was attached to a shaft with a diameter of 0 025 m where the top shaft was connected to a pulley of a torque measurement setup table 1 summarizes the geometrical parameters of the turbine model 2 2 deflector plates two deflector plates were placed at the upstream of the turbine the width and height of the plates were 0 132 m and 0 183 m respectively as shown in fig 3 the returning blade deflector plate was positioned such that its edge was closest to the turbine at 1 204r 0 000r from the centre of the turbine while the advancing blade deflector plate was positioned such that its edge closest to the turbine at 0 000 r 1 204r from the centre of the turbine where r was the radius of the turbine in order to study the effect of deflector configuration on the self starting capability of the turbine model the returning blade deflector angle δ r was varied at 30 60 and 90 at each δ r the advancing blade deflector angle δ a was varied at 15 30 45 60 and 75 table 2 lists the variations of the δ r and δ a 2 3 torque measurements in this study the self starting capability of the turbine was analyzed in terms of static torques generated by the turbine model this torque was acquired by using a prony brake dynamometer set up positioned at the top of the test section of the wind tunnel two s type tension compression load cells 0 1 full scale precision were mounted on a support rig of the setup and used to measure the load applied to the turbine model as shown in fig 4 first the turbine model was held static at a specific rotor angle θ from 0 to 120 with a 15 interval then the traction belt wrapped around the pulley was slowly released as the turbine was just about to rotate simultaneously the applied loads indicated by the load display were recorded these applied loads were used to obtain the static torque t s and the coefficient of static torque c ts as governed by the following equations the static torque t s generated by the turbine model can be obtained as follows 1 t s δ f r p where δf was the force difference between the two load cells f 1 and f 2 where the turbine was at a static state just about to rotate and r p was the radius of the pulley r p 0 030 m it is common to present the static torque in terms of the coefficient of static torque against the rotor angle then the coefficient of static torque c ts can be obtained from 2 c t s 4 t s ρ h d 2 u 2 where ρ was the density of the incoming flow h was the height of the rotor d was the diameter of the rotor and u was the incoming flow speed of the working fluid medium meanwhile the power performance of the turbine was analyzed by obtaining the dynamic torque of the turbine with the same prony brake dynamometer setup as described above the braking loads or forces were applied to the rotating turbine until the turbine reached stalled condition these applied braking loads were reduced to obtain the dynamic torque t as follows 3 t δ f r p the ratio of the dynamic torque to the available torque for which the force acting on the turbine blades is defined as the coefficient of torque c t and is given by 4 c t 4 t ρ d 2 h u 2 based on the c t the power performance of the turbine in terms of coefficient of power c p an be obtained based on the following relation 5 c p 2 t ω ρ d h u 3 c t λ where λ is the tip speed ratio i e the ratio between the turbine tip speed with respect to the incoming flow speed and it is expressed as 6 λ ω d 2 u where ω is the turbine angular speed which can be obtained by converting the rotational speed of the turbine model in revolution per minute rpm as follows 7 ω 2 π 60 rpm where the rpm of the turbine model was acquired by a hall effect tachometer as the experiment on the savonius turbine model was conducted in a wind tunnel it was important to maintain the reynolds number similarity between two different working fluids i e air and water for hydrokinetic applications therefore 8 r e a r e w ρ a u a d a μ a ρ w u w d w μ w must be achieved while conducting the experiment where re was the reynolds number μ was the dynamic viscosity and subscripts a and w refer to air and water respectively the errors associated with the measurements were obtained based on the method proposed by moffat 1988 where the general formula is given as follows 9 u r δ r r a δ x 1 x 1 2 b δ x 2 x 2 2 m δ x m x m 2 1 2 for which a x 1 r r x 1 b x 2 r r x 2 m x m r r x m where u r is the relative uncertainty of the measured parameter in this study the relative uncertainties of the air flow speed reynolds number the highest coefficient of static torque and coefficient of power were 0 71 0 73 and 2 37 2 36 respectively 3 results and discussion the 3 bladed savonius turbine was tested in the wind tunnel at an air flow speed of 7 0 m s which is equivalent to 0 4 m s water flow speed in a water channel for hydrokinetic applications this was obtained based on the reynolds number similarity principle given by eq 8 the self starting capability in terms of coefficient of static torque was characterized with respect to the rotor angle at various returning and advancing blade deflector angles the results were compared with the case without the deflectors then the corresponding power performance in terms of coefficient of power was analyzed 3 1 self starting capability in order to study the effects of deflector configurations on the self starting capability of the turbine model the coefficient of static torque c ts against the rotor angle θ for the case of without the deflectors was first analyzed as a baseline for comparison comparing the results from the present study with the experimental study by irabu et al 2007 as shown in fig 5 the general trend for the c ts profiles for both turbine models without deflectors were similar for the range of the rotor angles tested from θ 0 120 however the c ts values in the present study were relatively higher compared to those from their study one likely reason for this difference is that the present experiment was conducted at a higher reynolds number of 1 48 105 their experiment was performed at a lower reynolds number of 6 05 104 the c ts increased when the θ increased from 0 to 30 then decreased when the θ increased to 45 then the c ts increased when the θ increased to 105 before it decreased again when the θ was at 120 the maximum and minimum coefficient of static torque were c tsmax 0 455 and c tsmin 0 156 respectively each occurred at θ 105 and 0 respectively the range of c ts i e the difference between the c tsmax and c tsmin was 0 298 in addition the c ts was positive for all range of θ tested in the current study which in principle it allows the turbine model to self start at any rotor angle note that due to the symmetry and periodicity of the 3 bladed turbine model by 120 only c ts in the range of 0 120 is presented a significant change in the c ts profile was observed with the presence of deflectors as shown in fig 6 for the returning blade deflector angle δ r 30 as shown in fig 5 a the c ts was first decreased when the θ increased from 0 to 15 then it increased as the θ further increased to 90 before it decreased again when θ reached 120 for the δ r 60 and δ r 90 similar profiles can be observed in fig 5 b and c where the c ts increased when the θ increased from 0 to 45 then it decreased when the θ further increased up to 120 similar to the case of without the deflector the c ts was positive for all tested θ hence the turbine model has the ability to self start at any rotor angle moreover for the tested θ most of the c ts with the presence of the deflectors was found to be higher than that of without the deflectors this value increased with the increment of the δ r from 30 to 90 although not consistant the value of c ts also increased with the increment of the advancing blade deflector angle δ a the results revealed that the increment in the c ts allowed the turbine model with the deflectors to self start even at a low flow speed thus it is practical for implementation in a slow flowing river the configuration of the deflectors at δ a 75 and δ r 90 resulted in the highest coefficient of static torque for most of the θ in comparison to the other deflector configurations therefore it was considered to be the optimal deflector configuration to obtain the highest self starting capbility for the three bladed savonius turbine further analysis on the c ts profiles indicated that the increment of δ r had a significant influence on the c ts as compared to the increment of δ a this can be observed in fig 7 where the c tsmax increased with a steep slope when the δ r increased from 30 to 90 in contrast the variation of δ a showed a small increment in the c tsmax in terms of the flow physics the deflector plate at δ r 90 effectively blocked the incoming flow towards the returning blade of the turbine hence reducing the drag force on this blade consequently the drag force difference between the advancing blade and the returning blade increased causing the increment of c ts the effect of drag force reduction on the returning blade was found to be more significant than the effect of drag force increment on the advancing blade due to the presence of the advancing blade deflector table 3 lists the maximum and minimum coefficients of static torque the rotor angle that corresponds to the maximum and minimum c ts and the range of c ts for the case of without and with the deflectors at various deflector configurations it was found that the c tsmax for the δ r 30 mostly occurred at θ 90 whereas for the δ r 60 and 90 the c tsmax mostly occurred at θ 45 for both without and with the deflectors the c tsmin occurred at θ 0 except for the δ r 30 where it occurred at θ 15 in general the c tsmin increased when the δ r increased which indicated that the c ts profile as a function of θ shifted away from the no self start condition c ts 0 morevoer the range of c ts also increased as δ r increased from 30 to 90 3 2 power performance the coefficient of power c p for the turbine model at various deflector angles tested in the self starting experiment is shown in fig 8 overall the presence of the deflectors resulted in higher c p curves than without deflectors except for the deflector configurations at δ a 15 δ r 30 and δ a 45 δ r 30 as shown in fig 8 a the c p reduction at these two deflector configurations was most likely due to the advancing blade deflector configuration and position that was unable to deflect the incoming flow towards the concave surface of the advancing blade at the same time the small angle of the returning blade at this condition with respect to the incoming flow could not be fully blocked from being impinged on the convex surface of the returning blade hence it eventually reduced the net torque to generate the power as the δ r increased the c p curves also increased higher than without the deflector as depicted in fig 8 b and c in addition the range of the tip speed ratio λ has also increased with the increment of δ r this indicated that the rotational speed of the turbine was increased as more kinetic energy from the incoming flow was harnessed by the turbine consequently generating more power on the other hand it was also found that the advancing blade deflector configured at the small angles of δ a 15 45 resulted in a lower c p curve regardless of δ r variation as shown in fig 9 the δ r increment was found to have a strong influence on the significant increments of the maximum coefficient of power c pmax as compared to the δ a increment it was revealed that the c pmax increased by around 1 5 and almost doubled when the δ r increased from 30 to 60 and 90 respectively this might be due to the c p curves for the turbine being generally higher than those without the deflectors at δ r 60 and 90 even though the advancing blade deflector was configured at δ a 15 45 as the δ r increased more area of the returning blade was blocked by the deflector hence it eventually reduced the amount of incoming flow that impinged on the blade consequently the negative torque due to the pressure drag on this bladed decreased increasing the net torque to generate power it was observed that this effect was more significant than the increament of positive torque on the advancing blade due to the concentrated incoming flow directed by the advancing blade moreover the effect of δ r increment on the c pmax was nearly consistent with the experimental results on the self starting capability of the turbine model table 4 lists the c pmax the corresponding λ at c pmax and the power performance improvement relative to that of without the deflectors case regardless of the deflector angle variations the c pmax has mostly occurred at the tip speed ratio around 0 68 to 0 74 meanwhile the power performance improvement of the turbine exhibited significant increment with the increment of δ r the highest power performance improvement of 109 97 was obtained for deflectors configuration at δ a 75 and δ r 90 where the c pmax 0 183 it is worth to note that these angles were also the optimal deflector configuration that resulted in the highest self starting capability of the turbine therefore the optimal deflector configuration for the deflector augmented three bladed savonius turbine tested in the present study resulting in the highest self starting capability and power improvement was found to be the same with such deflector angles the turbine will be able to self start at a lower flow speed without the need to change the deflector configuration to generate power the findings in the current study can be useful in designing a deflector augmented savonius turbine for hydrokinetic application in which an integrated active deflector angle controller can be omitted hence reducing the development and operational cost of the turbine for a sustainable power generation 4 conclusions in the present study the effects of deflector on the self starting capability of the three bladed semi circular savonius hkt model were investigated in terms of coefficient of static torque at various advancing and returning blade deflector angles using the reynolds number similarity approach the turbine model was tested in a closed circuit wind tunnel at an air flow speed of 7 0 m s which is equivalent to 0 40 m s water flow speed at re 148 000 then under the same flow conditions the corresponding power performance in terms of the coefficient of power was analyzed with respect to the varied deflector angles considered in the self starting experiment the c ts and c p for the case without the deflectors were also derived as a baseline for comparison it can be concluded that the c ts profiles with the presence of the deflectors were different from the case of without the deflectors and generally the c ts values were higher with the presence of the deflectors the value of c ts increased when the returning blade deflector angle increased from δ r 30 90 and the same trend was also observed with the increment of the advancing blade deflector angle from δ a 15 75 although it was not entirely consistent throughout the range the maximum coefficient of static torque c tsmax was significantly influenced by the increment of δ r whereas it was less affected by the increment of δ a the c ts profiles shifted away from the no self start condition with the presence of the deflectors and the optimal deflector configuration was found to be δ a 75 and δ r 90 similar trends were also found for the c p curves where the increment of δ r resulted in a significant c p increment as compared to the increment of δ a the optimal deflector configuration which resulted in the highest c pmax improvement by 109 97 was similar to the optimal deflector configuration found in the self starting experiment i e δ a 75 and δ r 90 this study has demonstrated the practicality of the deflector plates positioned at the upstream of the three bladed savonius turbine model the deflectors in most configuration not only increased the c ts values away from the no self start condition but also improved the power performance of the turbine the fact that the optimal deflector configuration resulted in the highest self starting capability and power performance was the same could potentially reduced the operational cost of the turbine in which the active deflector controller can be omitted thus this deflector augmented turbine model can be practically implemented for hydrokinetic applications in rivers with low flow speeds credit authorship contribution statement mohd badrul salleh investigation methodology formal analysis writing original draft noorfazreena m kamaruddin conceptualization methodology formal analysis writing review editing supervision project administration zulfaa mohamed kassim conceptualization resources writing review editing elmi abu bakar conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the financial support from universiti sains malaysia under the research university individual grant rui 1001 paero 8014132 
20852,wave breaking occurs when waves reach a critical level of amplitude which results in releasing a significant amount of energy predicting the wave heights locations and other characteristics of breaking waves in shallow water is an important area of research the breaking wave height which is the most important characteristic depends on various parameters such as deepwater wavelength breaking water depth and seabed slope in this study new formulae are proposed for predicting the breaking wave height focusing on two types of breaking waves namely spilling and plunging the breaking wave types can be classified by using the iribarren number a comprehensive set of laboratory and field observations is utilized to develop new formulae based on the gene expression programming gep numerical method the datapoints representing individual waves whose breaking types have been determined to be different according to different wave breaking classification criteria have been ignored in comparison with previous formulae the new formulae proposed based on different breaking types have almost higher accuracy especially in the plunging case therefore it might be concluded that developing different formulae based on different breaking types rather than a general one for all types would lead to more accurate results keywords wave breaking breaker type breaking wave height gene expression programming iribarren number 1 introduction in certain heights when the amplitude of waves reaches a critical level wave breaking occurs and along with this phenomenon a considerable amount of energy is released there exist three limiting criteria for indicating wave breaking namely geometric kinematic and dynamic criteria according to the geometric one wave breaking occurs when the wave reaches a limiting steepness while the kinematic and dynamic criteria deal with the motion of wave particles including water particle velocity and vertical acceleration respectively brown 2014 based on the literature battjess 1974 wave breaking can be divided into different types according to the wave steepness and seabed slope breaking waves in shallow water and nearshore areas have considerable influence on their surroundings significant induced forces on coastal structures considerable amount of sediment transport both onshore and offshore that leads to beach morphological changes and several other essential factors are among these effects therefore it is vital to be able to successfully predict the occurrence of this phenomenon and its characteristics including location height etc sorensen 2005 it should be noted that breaking wave height is the most important characteristic of breaking waves and its accurate prediction is of significant importance since the early 1890s many researchers have been trying to propose different types of relations e g linear mccowan 1894 trigonometric miche 1944 and exponential rattanapitikon and shibayama 2000 for predicting the breaking wave height various input parameters that are believed to have direct influence on wave breaking have been used in these formulae some of them are based on the water depth only e g mccowan 1894 while some others depend on the water depth and seabed slope e g galvin 1968 or water depth and surf similarity parameter e g kaminsky and kraus 1993 in some other relations the breaking wavelength height and water depth are the input parameters e g liu et al 2011 therefore a trial and error procedure has to be carried out to find the breaking wave height using these types of relations other formulae depend on the offshore wavelength as well as the water depth and seabed slope e g rattanapitikon and shibayama 2000 some researchers have also used the wave steepness e g rattanapitikon et al 2003 the wave angle e g antoniadis 2018 and the wave number e g lin and sheng 2017 and salmon et al 2015 to sum up it can be concluded that according to the formulae existing in the literature the breaking wave height can be calculated using the following parameters 1 h b f d b h o l o m l b θ o where h b denotes the breaking wave height and d b is the corresponding breaking water depth h o is the offshore deepwater wave height and l o represents the offshore deepwater wavelength m is the seabed slope l b denotes the breaking wavelength and θ o indicates the incident wave angle moreover there is another paramter known as the surf similarity parameter or iribarren number which is denoted by ξ and is used in some of the formulae proposed in the literature this parameter can be constrcuted from other paramneters and it depends on seabed slope and wave steepness more information about this parameter is given in the next section according to the linear wave theory i e airy theory l o can be computed as follows sorensen 2005 2 l o g t 2 2 π where g is the gravitational acceleration and t indicates the wave period some of the proposed formulae existing in the literature are given in the following for more information regarding different wave breaking prediction formulae the interested reader may refer to the work of robertson et al 2013 mccowan 1894 3a h b 0 78 d b rattanapitikon and shibayama 2000 3b h b 0 17 l o 1 exp π d b l o 16 21 m 2 7 07 m 1 55 goda 2010 3c h b 0 17 l o 1 exp 1 5 π d b l o 1 11 m 4 3 robertson et al 2015 3d h b 0 17 l o 1 exp π d b l o 1 978 m 1 792 salmon et al 2015 3e h b d b γ 1 m tanh γ 1 m γ 2 k d b where γ 1 m γ 0 a 1 m and γ 2 k d b a 2 a 3 k d b in which γ 0 0 54 a 1 7 59 a 2 8 06 a 3 8 09 lin and sheng 2017 3f h b d b γ 1 m tanh γ 1 m γ 2 k d b where γ 1 m b 0 b 1 exp b 2 m and γ 2 k d b a 2 a 3 k d b in which b 0 0 54 b 1 0 47 b 2 0 018 a 2 8 06 a 3 8 09 tomasicchio et al 2019 3g h b d b 0 75 1 sin tan 1 m 5 exp 3 4 1 2 π tanh 2 π d b l o it should be noted that in eqs 3e and 3f k d b 0 where k is the wave number when waves propagate into increasingly shallow water and therefore both equations are reduced to h b d b γ 1 m traditionally the wave breaking prediction models were developed based on laboratory datasets however with the advancements made in the computing and numerical methods as well as measurement techniques numerical methods have been utilized to provide accurate models using wide ranges of laboratory and field datasets hence the presented formulae using these techniques have become applicable for more real situations some recent researchers e g robertson et al 2015 robertson et al 2017 antoniadis 2018 tomasicchio et al 2019 have used numerical methods dimensional analysis and other methods for developing the desired formula the gene expression programming gep is a numerical method for providing models for complex problems it is an updated form of the former genetic programming gp and it was first introduced by ferreira 2002 recently several studies have been carried out by implementing this numerical method for wave related problems for instance robertson et al 2017 used gep to predict breaking wave conditions and propose new formula in this regard in the work of power et al 2019 the wave run up on beaches has been predicted using gep moreover in other works such as jane et al 2016 pourzangbar et al 2017 formentin and zanuttigh 2019 other applications of genetic programming in coastal engineering problems can be seen in this research gep is utilized over a large laboratory and field dataset to propose new formulae for predicting the breaking wave height by emphasizing on the type of breaking in other words the main goals of the present study are to investigate the effect of wave breaking type on the existing wave breaking height prediction formulae and to propose different formulae based on the type of breaking among the four types of breaking waves namely spilling plunging surging and collapsing the two cases of spilling and plunging are considered here spilling waves break when the ocean floor has a gradual slope while the plunging ones occur in steep parts of the ocean floor or where sudden depth changes occur it should be mentioned that although there exist certain features for each breaking type distinguishing between them in large scale observations needs a great deal of effort according to the literature this categorization can be done using the wave steepness and bottom slope i e the iribarren number battjes 1974 camenen and larson 2007 the input parameters in the proposed formulae for predicting the breaking wave height are the water depth deepwater wavelength and seabed slope as mentioned earlier these parameters are among the ones previously used in several wave breaking prediction formulae to validate and verify the proposed relations some known formulae proposed in the literature in the area of wave breaking i e eqs 3a 3g are chosen and the outcomes of the proposed formulae are compared with their results moreover to investigate the effects of different input parameters on the proposed formulae and to compare their behavior with other formulae existing in the literature a sensitivity analysis has been carried out it is through this analysis that the real physical behavior of the wave breaking phenomenon can be checked for each formulae 2 wave breaking classification breaking waves are classified based on the surf similarity parameter also known as the iribarren number ξ this parameter can be defined using the offshore or breaking wave height and the corresponding surf similarity parameters are denoted by ξ o and ξ b respectively battjes 1974 4 ξ o m h o l o ξ b m h b l o in which h l o is known as the wave steepness according to battjes 1974 four types of breaking can occur depending on the value of ξ o or ξ b the breaking is called spilling large steepness waves on flat beaches when ξ o 0 5 for the case of 0 5 ξ o 3 3 it is called plunging which is the case of intermediate steep waves on intermediate slope beaches finally when ξ o 3 3 the type of breaking is called surging or collapsing the latter is the case between plunging and surging that is hardly recognized and surging is the case for flat waves on steep beaches there is another criterion for classifying wave breaking that is introduced by camenen and larson 2007 according to their study breaking waves can be classified based on the offshore iribarren number and breaker depth index in this classification the breaking type is spilling or plunging when 0 2 ξ o 0 6 where the value of ξ o can be obtained by ξ o 1 5 1 25 γ b it is plunging or collapsing when 0 8 ξ o 2 9 where the value of ξ o can be obtained by ξ o 4 4 2 5 γ b and finally it is collapsing or surging when 3 6 ξ o 6 where the value of ξ o can be obtained by ξ o 1 7 3 3 γ b γ b is known as the breaker depth index and is equal to h b d b in table 1 a summary of the criteria mentioned above for wave breaking classification is presented 3 wave breaking dataset the dataset used in this research contains laboratory and field data obtained from experiments conducted over the last 65 years about 710 laboratory data points have been collected and have been categorized into different breaking types using the criteria number 1 and number 3 given in table 1 the data points representing individual waves with different types of breaking according to these criteria have been ignored in other words only the data points that belong to the same type of wave breaking based on these criteria are used in ths study after carrying out this refinement process and ignoring the data points that did not have all of the necessary parameters i e water depth deepwater wavelength or seabed slope about 540 laboratory data points have been used moreover about 150 field data points have also been utilized in table 2 the datasets used in this research are presented as it is seen in table 2 a wide range of data points is implemented in this research the range of breaker height seabed slope and period of laboratory data are 1 64 129 cm 0 009 0 3759 and 0 7 5sec respectively for the field data these values change to 89 351 cm 0 0028 0 0663 and 8 34 23 45sec respectively the field data points used here are obtained from the work of robertson et al 2014 they have utilized novel optical methods for collecting the wave breaking characteristics at full scale resulting in recording individual waves characteristics in three locations namely pleseaure point calfornia sewers peak california and tropicana beach barbados 4 overview of gene expression programming in recent years many numerical methods have been developed for handling large datasets among them the artificial neural networks anns and gene expression programming gep can be pointed out according to the literature e g robertson et al 2015 some accurate and efficient models have been developed by using anns for predicting the wave breaking height however these models were rather complex and the advantage of gep over these methods is that more simplified and practical relations can be developed using this numerical method gep is an extension to the previous known genetic programming gp developed by koza 1992 which was developed by ferreira 2002 in comparison with the gp gep has shown better performance and it can solve more complicated problems using small population size it is in fact a genetic algorithm that uses populations of individuals and after selecting them according to fitness it introduces genetic variation by utilizing genetic opetaros just like what heppens in gp however the main difference between gep and gp is that in gep the individuals are encoded as linear strings with fixed length genomes or chromosomes and then they are defined as nonlinear entities with different sizes and shapes expression trees each chromosome contains one or more genes and a gene is made of a head and a tail the symbols in gep can be either functions or terminals the function symbols are mathematical operators and functions such as sin however the terminal symbols are constants and variables such as 2 a c the head of a gene consists of both function and terminal symbols while the tail contains only terminals ferreira 2002 the solution of gep can be expressed in two languages the language of genes karva language and the language of expression trees et tree like structures in fig 1 a sample expression tree is shown in order to derive the expression from the et one should start from the left side of the tree and the lowest member i e a in here and move toward the right side of the tree the expression of this example tree is a b c d e where a b c d and e are arbitrary constants the form of this expression tree in karva language is 0 1 2 3 4 5 6 7 8 9 q c a b d e where q denotes the square root function as it is seen the gene in this example consists of 10 members 6 in its head q c and 4 in its tail a b d e the genes are linked to each other using a linking function which can be addition multiplication or other mathematical operations generally gep consists of five basic components and two main parameters the components of gep are a function set a terminal set a fitness function control parameters and a terminal condition the parameters are chromosomes and expression trees the information is translated from chromosomes into expression trees in order to develop a model using gep five major steps must be followed aval et al 2017 1 selection of the fitness function 2 selection of the set of terminals and functions to create chromosomes 3 selection of the chromosomal architecture head length and number of genes 4 selection of the linking function 5 selection of the set of genetic operators that cause variation and their rates in gep a random distribution of functions and terminals are created in the genes the first randomly created individual is called the parent and by implementing genetic operators the parents yield to offspring fitness is defined as the offspring s error from the correct function value the process of making offspring yield to an environment with higher fitness it is through the fitness function that the fitness of an offspring can be evaluated robertson et al 2017 5 results and discussion 5 1 proposed formulae in this study in order to develop the formulae using gep the genexprotools software ver 5 0 is used the dataset used in this study has been randomly divided into training and validation data with the allocation of 7 3 moreover in order to verify and test the formulae some laboratory data points which are not included among the training and validation data points are utilized in this research three different formulae are proposed using the software mentioned earlier in the first one called general formula hereafter the wave breaking height is predicted for different types of wave breaking however the second and third formulae are specifically for the cases of spilling called spilling formula hereafter and plunging called plunging formula hereafter wave breaking types respectively a considerable amount of runs with a different number of genes chromosomes head size function set and linking function has been carried out in the software to find the best formulae in table 3 the final chosen values for different parameters required in the gep analysis are provided in table 3 the function set represents the mathematical functions used for developing the formulae the number of genes denotes the number of fundamental terms in the model as each gene code for a different sub expression tree the size of the head indicates the maximum size of each term in the model the linking function is applied whenever the number of genes is more than one and it is used to connect the mathematical terms encoded in each gene parameters such as mutation inversion and transportation are known as genetic operators which are developed for handling random numerical constants their values are selected based on the optimal evolution strategy for more information about these parameters the interested reader may refer to ferreira 2013 the fitness function chosen for the development of the models is as follows 5 f i 1000 1 1 rrse i in which rrse i j 1 n p i j o j 2 j 1 n o j o j 2 where p i j denotes the predicted value for the ith offspring with the jth fitness level and o j indicates the optimum value for the target fig 2 illustrates the expression trees for the three proposed formulae in this figure d 0 d 1 and d 2 are m l o and d b respectively the numerical constants for the general formula in the first gene are c 1 8 66 c 3 3 20 c 7 2 95 and in the second gene are c 1 4 50 c 2 8 40 c 7 5 61 for the spilling and plunging formulae the numerical constants for the first genes are c 1 55 16 c 2 7 61 c 4 39 95 c 9 5 30 and c 2 93 33 c 3 4 60 c 4 822 32 c 9 1 70 and for the second genes are c 5 11 07 c 7 646 14 and c 0 3 05 c 4 8 80 respectively the extracted forms of the corresponding equations from the expression trees are as follows 6a general formula d 2 exp d 2 c 1 c 3 d 1 d 0 c 7 d 0 exp d 0 c 1 c 2 2 d 2 c 7 6b spilling formula c 4 c 9 d 2 c 2 d 2 d 1 c 1 c 1 d 2 d 1 c 4 d 2 d 2 d 1 d 0 d 2 d 0 c 0 6c plunging formula c 2 d 2 c 2 d 2 c 9 d 0 d 2 c 4 d 2 d 1 c 7 c 5 d 0 c 5 d 0 after performing some mathematical manipulations the final forms of these three formulae are as below 7a general formula h b d b exp 3 202 d b 8 657 m 2 951 l o m exp m 4 498 0 1784 d b 70 5 7b spilling formula h b l o d b 8 797 l o d b d b m m 3 048 d b 7 611 39 95 d b 211 9 l o 55 16 d b 55 16 7c plunging formula h b d b 0 09037 m l o 646 1 m 11 07 d b 4 604 d b 93 33 d b 822 3 m 1 697 note that the obtained value of h b from the proposed formulae will be in centimetres in order to evaluate the performance of the proposed formulae some statistical evaluation parameters are implemented they include the root mean square error rmse the coefficient of determination r2 the bias b the relative error e and the mean average error mae whose descriptions are given below root mean square error rmse 8 rmse i 1 n h b c i h b o i 2 n coefficient of determination r2 9 r 2 i 1 n h b c i h b c h b o i h b o i 1 n h b c i h b c 2 i 1 n h b o i h b o 2 2 bias b 10 b i 1 n h b c i h b o i n relative error erel for average wave heights 11 e rel h b c h b o h b o mean average error mae 12 mae i 1 n h b c i h b o i n scatter index si 13 si r m s e h b o absolute error eabs for average wave heights 14 e abs h b c h b o in which h b o denotes the observed breaker height and h b c is the calculated one h b o denotes the average observed breaker height and h b c is the average calculated one and n indicates the number of data points in table 4 the statistical values of r2 rmse and mae for the training validation and all data in the three developed gep formulae are presented as it is seen the outcomes are satisfying and an acceptable correlation exists between the calculated and observed values since the values of r2 are high and the errors rmse and mae are low moreover comparisons are made between the observed and calculated values of the three proposed formulae in figs 3 5 5 2 comparison between the proposed formulae and the previous ones table 5 is provided to compare the results of the proposed formulae with the previous ones proposed in the literature using the statistical evaluation parameters mentioned earlier it should be noted that since the data used here are grouped into low and high values as seen in figs 3 5 they are separated into different subgroups based on the values of breaking wave heights and the errors for different subgroups are calculated first then the overall mean values are computed and the values given in this table are actually the mean values moreover since the incident wave conditions in the study cases differ significantly the rmse may not be a good metric for comparisons of model errors between different cases and the relative errors scatter index and relative bias are more appropriate to quantify the errors for the variables with a wide range of values as it is seen in table 5 the general formula rmse cm 11 65 r2 0 98 erel 0 02 si 20 41 shows acceptable performance in comparison with the other formulae by having the least amount of error in this comparison therefore it can be somehow used as a suitable tool for predicting the breaking wave height without considering the type of breaking however as it was mentioned earlier the main focus of this study is to investigate the effect of different breaking types i e spilling and plunging on the accuracy of the beraking wave height prediction relations considering this it can be understood from the table that although it has accurate outcomes the spilling formula rmse cm 8 91 r2 0 99 erel 0 03 si 17 98 does not have the best performance in comparison with the other existing formulae which are proposed based on general cases and the type of breaking has not been considered in them and the best performance in this case belongs to the formula proposed by robertson et al 2015 which has the least error however the plunging formula rmse cm 8 78 r2 0 99 erel 0 01 si 15 96 has the least error compared to the other formulae therefore it can be concluded that for the plunging type using the proposed formula may lead to more accurate results compared to the other formulae another factor to consider here is that due to the fact that the range of datapoints used in this study is not unlimited using the absolute error for showing the accuracy of the proposed formulae would also seem to be an appropriate tool it can be seen that this value for the proposed relations is almost less than the other formulae which may prove the fact that using these relations would lead to more accurate results to sum up by considering the outcomes of all of the statistical parameters among the three proposed formulae it seems that the plunging one has almost the best performance in comparison with the other ones and although the spilling formula has the least absolute error in comparison with other formulae it does not have the best performance in this comparison when considering all of the statistical parameters in conclusion it can be said that using different formulae based on different breaking types for predicting the wave breaking height may be useful in some cases and may be more accurate but this statement needs further investigation and examination especially over wider ranges of datapoints another point to mention here is that according to the physical differences between the plunging and spilling breaker types i e the plunging breaker type occurs when the seabed slope is steep which leads to steeper waves while the spilling one happens in gentle seabed slopes causing the waves to break when they are long and slow less steepness compared to the plunging type having specified formula for each breaking type would seem to be more useful and accurate in predicting the wave breaking height more discussion about the dependence of these formulae on steepness and seabed slope is provided in section 5 4 5 3 verification and testing in order to test the proposed formulae two laboratory datasets which are not included among the training and validation data are used as shown in table 6 in table 7 the performance of the proposed three gep formulae is evaluated using the testing dataset and a comparison is also made with some other existing formulae it can be understood from this table that except for the general formula the two other proposed formulae have almost appropriate performance the plunging formula has the least error in comparison with the other existing formulae and the spilling formula has acceptable performance however unlike the discussion given in section 5 2 the general formula which has an overall acceptable performance leads to less accurate results in comparison with the other existing formulae in conclusion it can be stated that the proposed plunging and spilling formulae show almost the same performance in the verification stage but according to this stage the outcomes of the general formula do not match with what was stated in section 5 2 however it is worthwhile to mention that the dataset used in this stage is much more limited than the one used in the model development section and hence concluding that the general formula is not accurate in any situation may not be true for instance changing the bottom slope could have a significant influence on the results as it was seen in the results of table 5 where a wide range of bottom slope existed in the dataset 5 4 sensitivity analysis of the proposed formulae here it is tried to investigate the ability of the presented relations in capturing the sensitivity of the input parameters to the predicted wave breaking height the aim is to compare the effect of each input parameter on the proposed formulae with the other existing ones to see whether the behaviours are the same or not each parameter s influence on the relations is investigated by changing the specific parameter s value while assigning a constant value for the others the effect of the specific parameter on the wave breaking height is studied through the values predicted by the proposed gep model and other formulae reported in the literature since the input parameters used in the proposed formulae are among the ones whose influence on the breaking wave height is experimentally documented the proposed relations accuracy based on the input parameters can be investigated here the conditions of gentle and steep slopes m 0 01 and m 0 3 respectively long and short deepwater wavelengths l o 1100 cm and l o 11000 cm respectively and relatively shallow and deeper water d b 15 cm and d b 100 cm respectively are considered here in figs 6 8 the effects of each parameter on the model are shown all of the proposed formulae i e general plunging and spilling are investigated here in fig 6 the influence of deepwater wavelength on different formulae is shown as it is seen the overall tendency of all formulae is that the breaking wave height increases up to a point by increasing the deepwater wavelength and then it remains almost constant however the rate of this increase is reduced when cosidering longer wave lengths it is seen that the changing rate of most of the formulae is completely different between gentle and steep slope conditions for instance there is no significant change in the proposed plunging formula when considering gentle slope fig 6 a but when investigating steep slope fig 6 c the breaking wave height predicted by this formula increasese significantly by increasing the deepwater wavelength this issue could be related to the fact that the plunging wave breaking type is generally occurred in steep slope condition and when this kind of slope is considered the changing rate of this formula will be increased according to fig 7 the breaking wave height increases by increasing the water depth no matter considering gentle or steep slopes and long or short deepwater wavelength however the rate of this increase is different among different formulae and different slope or wavelength conditions therefore the behavior of the proposed formulae when considering variations in water depth is in accordance with the breaker depth index dependence illustrated by mccowan 1894 and the cases confimred by laboratory and field studies based on previous studies carried out by different researchers e g camenen and larson 2007 there is an exponential relationship between the breaking height and seabed slope as seen in fig 8 this issue can be seen in some of the breaking wave height prediction formulae when moving from gentle slopes to steep ones in the formulae proposed by tomasicchio et al 2019 and goda 2010 as well as the proposed spilling formula the breaking wave height increases significantly by increasing the seabed slope while there is no significant change in the breaking wave height calculated by some other formulae in some formulae i e rattanapitikon and shibayama 2000 and robertson et al 2015 the breaking wave height decreases by moving from gentle slopes to steep ones it is wothwhile to mention that different behaviors can be observed among the formulae when considering different conditions e g short or long deepwater wavelength overall it can be conlcuded that according to what is documented in the literature and what is shown here the variations of the proposed formulae are somehow similar to the other formulae proposed in the literature in the area of breaking wave height prediction and the physical behavior of wave breaking phenomenon can be almost correctly interpreted in most cases though there are some dicrepencies and differences in some cases between the proposed formulae and the ones presented in the literature for instance the fact that waves with longer wavelengths can have higher breaking wave height if the similar limited steepness is applied can be seen in fig 6 6 conclusions in this research new formulae were developed for predicting the wave height in breaking condition which is considered as the most important characteristic of the wave breaking phenomenon the formulae were proposed by utilizing gene expression programming gep and the main focus was to develop different formulae based on the type of breaking so that its influence on the breaking wave height prediction could be investigated in order to obtain the proposed relations a wide range of laboratory and field dataset has been used after excluding the data points that represented different types of wave breaking according to different wave breaking classification criteria and ignoring the data points that did not contain all of the necessary information i e seabed slope water depth or deepwater wavelength the range of breaker height seabed slope and period of laboratory data used in this study has been become 1 64 129 cm 0 009 0 3759 and 0 7 5sec respectively for the field data these values were 89 351 cm 0 0028 0 0663 and 8 34 23 45sec respectively from this model three formulae were derived eq 7 one for all of the data rmse cm 11 65 r2 0 98 erel 0 02 si 20 41 without considering the type of breaking one for the spilling breaker type rmse cm 8 91 r2 0 99 erel 0 03 si 17 98 and one for the plunging one rmse cm 8 78 r2 0 99 erel 0 01 si 15 96 the outcomes of the proposed formulae were compared with the previous ones reported in the literature in order to verify the model a new laboratory dataset whose data points were not used in the model development process was applied moreover a sensitivity analysis was performed to investigate the influence of different parameters on the relations and to check whether the behavior is like the other existing formulae or not according to the results of this analysis as in the other existing formulae the breaker height increased by increasing the water depth and deepwater wavelength in the proposed formulae however the change in the seabed slope from gentle slopes to steep ones did not have a significant influence on the value of the breaker height in two of the proposed formula the one used for all wave breaking types and the one used for the plunging type this behavior was different from the other formulae proposed in the literature and it may be concluded that the two mentioned proposed formulae are not as sensitive as the other ones to the seabed slope directly to sum up it should be stated that the formula developed based on the plunging wave breaking type had almost higher accuracy than the other existing formulae therefore using this formula for predicting the wave breaking height in the plunging type may lead to more accurate results the spilling formula also showed acceptable performance but it was not the most accurate one in comparison with the other formulae overall it somehow can be concluded that using different formulae for different breaking types rather than using one general formula for all types in some cases could lead to more accurate predictions however further investigation and research should be done in this area to validate this statement for almost every wave breaking condition credit authorship contribution statement behrooz tadayon methodology software validation formal analysis writing original draft writing review editing hamid dehghani methodology software validation formal analysis writing original draft cyrus ershadi conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to appreciate dr robertson for his valuable guidance regarding providing the necessary information and data for carrying out this research it is worthwhile to mention that dr delavari has also gathered some of the data and the authors would like to appreciate him as well moreover the authors highly appreciate the gepsoft limited company for creating the genexprotools software which helped us to obtain the desired formulae in this research 
20852,wave breaking occurs when waves reach a critical level of amplitude which results in releasing a significant amount of energy predicting the wave heights locations and other characteristics of breaking waves in shallow water is an important area of research the breaking wave height which is the most important characteristic depends on various parameters such as deepwater wavelength breaking water depth and seabed slope in this study new formulae are proposed for predicting the breaking wave height focusing on two types of breaking waves namely spilling and plunging the breaking wave types can be classified by using the iribarren number a comprehensive set of laboratory and field observations is utilized to develop new formulae based on the gene expression programming gep numerical method the datapoints representing individual waves whose breaking types have been determined to be different according to different wave breaking classification criteria have been ignored in comparison with previous formulae the new formulae proposed based on different breaking types have almost higher accuracy especially in the plunging case therefore it might be concluded that developing different formulae based on different breaking types rather than a general one for all types would lead to more accurate results keywords wave breaking breaker type breaking wave height gene expression programming iribarren number 1 introduction in certain heights when the amplitude of waves reaches a critical level wave breaking occurs and along with this phenomenon a considerable amount of energy is released there exist three limiting criteria for indicating wave breaking namely geometric kinematic and dynamic criteria according to the geometric one wave breaking occurs when the wave reaches a limiting steepness while the kinematic and dynamic criteria deal with the motion of wave particles including water particle velocity and vertical acceleration respectively brown 2014 based on the literature battjess 1974 wave breaking can be divided into different types according to the wave steepness and seabed slope breaking waves in shallow water and nearshore areas have considerable influence on their surroundings significant induced forces on coastal structures considerable amount of sediment transport both onshore and offshore that leads to beach morphological changes and several other essential factors are among these effects therefore it is vital to be able to successfully predict the occurrence of this phenomenon and its characteristics including location height etc sorensen 2005 it should be noted that breaking wave height is the most important characteristic of breaking waves and its accurate prediction is of significant importance since the early 1890s many researchers have been trying to propose different types of relations e g linear mccowan 1894 trigonometric miche 1944 and exponential rattanapitikon and shibayama 2000 for predicting the breaking wave height various input parameters that are believed to have direct influence on wave breaking have been used in these formulae some of them are based on the water depth only e g mccowan 1894 while some others depend on the water depth and seabed slope e g galvin 1968 or water depth and surf similarity parameter e g kaminsky and kraus 1993 in some other relations the breaking wavelength height and water depth are the input parameters e g liu et al 2011 therefore a trial and error procedure has to be carried out to find the breaking wave height using these types of relations other formulae depend on the offshore wavelength as well as the water depth and seabed slope e g rattanapitikon and shibayama 2000 some researchers have also used the wave steepness e g rattanapitikon et al 2003 the wave angle e g antoniadis 2018 and the wave number e g lin and sheng 2017 and salmon et al 2015 to sum up it can be concluded that according to the formulae existing in the literature the breaking wave height can be calculated using the following parameters 1 h b f d b h o l o m l b θ o where h b denotes the breaking wave height and d b is the corresponding breaking water depth h o is the offshore deepwater wave height and l o represents the offshore deepwater wavelength m is the seabed slope l b denotes the breaking wavelength and θ o indicates the incident wave angle moreover there is another paramter known as the surf similarity parameter or iribarren number which is denoted by ξ and is used in some of the formulae proposed in the literature this parameter can be constrcuted from other paramneters and it depends on seabed slope and wave steepness more information about this parameter is given in the next section according to the linear wave theory i e airy theory l o can be computed as follows sorensen 2005 2 l o g t 2 2 π where g is the gravitational acceleration and t indicates the wave period some of the proposed formulae existing in the literature are given in the following for more information regarding different wave breaking prediction formulae the interested reader may refer to the work of robertson et al 2013 mccowan 1894 3a h b 0 78 d b rattanapitikon and shibayama 2000 3b h b 0 17 l o 1 exp π d b l o 16 21 m 2 7 07 m 1 55 goda 2010 3c h b 0 17 l o 1 exp 1 5 π d b l o 1 11 m 4 3 robertson et al 2015 3d h b 0 17 l o 1 exp π d b l o 1 978 m 1 792 salmon et al 2015 3e h b d b γ 1 m tanh γ 1 m γ 2 k d b where γ 1 m γ 0 a 1 m and γ 2 k d b a 2 a 3 k d b in which γ 0 0 54 a 1 7 59 a 2 8 06 a 3 8 09 lin and sheng 2017 3f h b d b γ 1 m tanh γ 1 m γ 2 k d b where γ 1 m b 0 b 1 exp b 2 m and γ 2 k d b a 2 a 3 k d b in which b 0 0 54 b 1 0 47 b 2 0 018 a 2 8 06 a 3 8 09 tomasicchio et al 2019 3g h b d b 0 75 1 sin tan 1 m 5 exp 3 4 1 2 π tanh 2 π d b l o it should be noted that in eqs 3e and 3f k d b 0 where k is the wave number when waves propagate into increasingly shallow water and therefore both equations are reduced to h b d b γ 1 m traditionally the wave breaking prediction models were developed based on laboratory datasets however with the advancements made in the computing and numerical methods as well as measurement techniques numerical methods have been utilized to provide accurate models using wide ranges of laboratory and field datasets hence the presented formulae using these techniques have become applicable for more real situations some recent researchers e g robertson et al 2015 robertson et al 2017 antoniadis 2018 tomasicchio et al 2019 have used numerical methods dimensional analysis and other methods for developing the desired formula the gene expression programming gep is a numerical method for providing models for complex problems it is an updated form of the former genetic programming gp and it was first introduced by ferreira 2002 recently several studies have been carried out by implementing this numerical method for wave related problems for instance robertson et al 2017 used gep to predict breaking wave conditions and propose new formula in this regard in the work of power et al 2019 the wave run up on beaches has been predicted using gep moreover in other works such as jane et al 2016 pourzangbar et al 2017 formentin and zanuttigh 2019 other applications of genetic programming in coastal engineering problems can be seen in this research gep is utilized over a large laboratory and field dataset to propose new formulae for predicting the breaking wave height by emphasizing on the type of breaking in other words the main goals of the present study are to investigate the effect of wave breaking type on the existing wave breaking height prediction formulae and to propose different formulae based on the type of breaking among the four types of breaking waves namely spilling plunging surging and collapsing the two cases of spilling and plunging are considered here spilling waves break when the ocean floor has a gradual slope while the plunging ones occur in steep parts of the ocean floor or where sudden depth changes occur it should be mentioned that although there exist certain features for each breaking type distinguishing between them in large scale observations needs a great deal of effort according to the literature this categorization can be done using the wave steepness and bottom slope i e the iribarren number battjes 1974 camenen and larson 2007 the input parameters in the proposed formulae for predicting the breaking wave height are the water depth deepwater wavelength and seabed slope as mentioned earlier these parameters are among the ones previously used in several wave breaking prediction formulae to validate and verify the proposed relations some known formulae proposed in the literature in the area of wave breaking i e eqs 3a 3g are chosen and the outcomes of the proposed formulae are compared with their results moreover to investigate the effects of different input parameters on the proposed formulae and to compare their behavior with other formulae existing in the literature a sensitivity analysis has been carried out it is through this analysis that the real physical behavior of the wave breaking phenomenon can be checked for each formulae 2 wave breaking classification breaking waves are classified based on the surf similarity parameter also known as the iribarren number ξ this parameter can be defined using the offshore or breaking wave height and the corresponding surf similarity parameters are denoted by ξ o and ξ b respectively battjes 1974 4 ξ o m h o l o ξ b m h b l o in which h l o is known as the wave steepness according to battjes 1974 four types of breaking can occur depending on the value of ξ o or ξ b the breaking is called spilling large steepness waves on flat beaches when ξ o 0 5 for the case of 0 5 ξ o 3 3 it is called plunging which is the case of intermediate steep waves on intermediate slope beaches finally when ξ o 3 3 the type of breaking is called surging or collapsing the latter is the case between plunging and surging that is hardly recognized and surging is the case for flat waves on steep beaches there is another criterion for classifying wave breaking that is introduced by camenen and larson 2007 according to their study breaking waves can be classified based on the offshore iribarren number and breaker depth index in this classification the breaking type is spilling or plunging when 0 2 ξ o 0 6 where the value of ξ o can be obtained by ξ o 1 5 1 25 γ b it is plunging or collapsing when 0 8 ξ o 2 9 where the value of ξ o can be obtained by ξ o 4 4 2 5 γ b and finally it is collapsing or surging when 3 6 ξ o 6 where the value of ξ o can be obtained by ξ o 1 7 3 3 γ b γ b is known as the breaker depth index and is equal to h b d b in table 1 a summary of the criteria mentioned above for wave breaking classification is presented 3 wave breaking dataset the dataset used in this research contains laboratory and field data obtained from experiments conducted over the last 65 years about 710 laboratory data points have been collected and have been categorized into different breaking types using the criteria number 1 and number 3 given in table 1 the data points representing individual waves with different types of breaking according to these criteria have been ignored in other words only the data points that belong to the same type of wave breaking based on these criteria are used in ths study after carrying out this refinement process and ignoring the data points that did not have all of the necessary parameters i e water depth deepwater wavelength or seabed slope about 540 laboratory data points have been used moreover about 150 field data points have also been utilized in table 2 the datasets used in this research are presented as it is seen in table 2 a wide range of data points is implemented in this research the range of breaker height seabed slope and period of laboratory data are 1 64 129 cm 0 009 0 3759 and 0 7 5sec respectively for the field data these values change to 89 351 cm 0 0028 0 0663 and 8 34 23 45sec respectively the field data points used here are obtained from the work of robertson et al 2014 they have utilized novel optical methods for collecting the wave breaking characteristics at full scale resulting in recording individual waves characteristics in three locations namely pleseaure point calfornia sewers peak california and tropicana beach barbados 4 overview of gene expression programming in recent years many numerical methods have been developed for handling large datasets among them the artificial neural networks anns and gene expression programming gep can be pointed out according to the literature e g robertson et al 2015 some accurate and efficient models have been developed by using anns for predicting the wave breaking height however these models were rather complex and the advantage of gep over these methods is that more simplified and practical relations can be developed using this numerical method gep is an extension to the previous known genetic programming gp developed by koza 1992 which was developed by ferreira 2002 in comparison with the gp gep has shown better performance and it can solve more complicated problems using small population size it is in fact a genetic algorithm that uses populations of individuals and after selecting them according to fitness it introduces genetic variation by utilizing genetic opetaros just like what heppens in gp however the main difference between gep and gp is that in gep the individuals are encoded as linear strings with fixed length genomes or chromosomes and then they are defined as nonlinear entities with different sizes and shapes expression trees each chromosome contains one or more genes and a gene is made of a head and a tail the symbols in gep can be either functions or terminals the function symbols are mathematical operators and functions such as sin however the terminal symbols are constants and variables such as 2 a c the head of a gene consists of both function and terminal symbols while the tail contains only terminals ferreira 2002 the solution of gep can be expressed in two languages the language of genes karva language and the language of expression trees et tree like structures in fig 1 a sample expression tree is shown in order to derive the expression from the et one should start from the left side of the tree and the lowest member i e a in here and move toward the right side of the tree the expression of this example tree is a b c d e where a b c d and e are arbitrary constants the form of this expression tree in karva language is 0 1 2 3 4 5 6 7 8 9 q c a b d e where q denotes the square root function as it is seen the gene in this example consists of 10 members 6 in its head q c and 4 in its tail a b d e the genes are linked to each other using a linking function which can be addition multiplication or other mathematical operations generally gep consists of five basic components and two main parameters the components of gep are a function set a terminal set a fitness function control parameters and a terminal condition the parameters are chromosomes and expression trees the information is translated from chromosomes into expression trees in order to develop a model using gep five major steps must be followed aval et al 2017 1 selection of the fitness function 2 selection of the set of terminals and functions to create chromosomes 3 selection of the chromosomal architecture head length and number of genes 4 selection of the linking function 5 selection of the set of genetic operators that cause variation and their rates in gep a random distribution of functions and terminals are created in the genes the first randomly created individual is called the parent and by implementing genetic operators the parents yield to offspring fitness is defined as the offspring s error from the correct function value the process of making offspring yield to an environment with higher fitness it is through the fitness function that the fitness of an offspring can be evaluated robertson et al 2017 5 results and discussion 5 1 proposed formulae in this study in order to develop the formulae using gep the genexprotools software ver 5 0 is used the dataset used in this study has been randomly divided into training and validation data with the allocation of 7 3 moreover in order to verify and test the formulae some laboratory data points which are not included among the training and validation data points are utilized in this research three different formulae are proposed using the software mentioned earlier in the first one called general formula hereafter the wave breaking height is predicted for different types of wave breaking however the second and third formulae are specifically for the cases of spilling called spilling formula hereafter and plunging called plunging formula hereafter wave breaking types respectively a considerable amount of runs with a different number of genes chromosomes head size function set and linking function has been carried out in the software to find the best formulae in table 3 the final chosen values for different parameters required in the gep analysis are provided in table 3 the function set represents the mathematical functions used for developing the formulae the number of genes denotes the number of fundamental terms in the model as each gene code for a different sub expression tree the size of the head indicates the maximum size of each term in the model the linking function is applied whenever the number of genes is more than one and it is used to connect the mathematical terms encoded in each gene parameters such as mutation inversion and transportation are known as genetic operators which are developed for handling random numerical constants their values are selected based on the optimal evolution strategy for more information about these parameters the interested reader may refer to ferreira 2013 the fitness function chosen for the development of the models is as follows 5 f i 1000 1 1 rrse i in which rrse i j 1 n p i j o j 2 j 1 n o j o j 2 where p i j denotes the predicted value for the ith offspring with the jth fitness level and o j indicates the optimum value for the target fig 2 illustrates the expression trees for the three proposed formulae in this figure d 0 d 1 and d 2 are m l o and d b respectively the numerical constants for the general formula in the first gene are c 1 8 66 c 3 3 20 c 7 2 95 and in the second gene are c 1 4 50 c 2 8 40 c 7 5 61 for the spilling and plunging formulae the numerical constants for the first genes are c 1 55 16 c 2 7 61 c 4 39 95 c 9 5 30 and c 2 93 33 c 3 4 60 c 4 822 32 c 9 1 70 and for the second genes are c 5 11 07 c 7 646 14 and c 0 3 05 c 4 8 80 respectively the extracted forms of the corresponding equations from the expression trees are as follows 6a general formula d 2 exp d 2 c 1 c 3 d 1 d 0 c 7 d 0 exp d 0 c 1 c 2 2 d 2 c 7 6b spilling formula c 4 c 9 d 2 c 2 d 2 d 1 c 1 c 1 d 2 d 1 c 4 d 2 d 2 d 1 d 0 d 2 d 0 c 0 6c plunging formula c 2 d 2 c 2 d 2 c 9 d 0 d 2 c 4 d 2 d 1 c 7 c 5 d 0 c 5 d 0 after performing some mathematical manipulations the final forms of these three formulae are as below 7a general formula h b d b exp 3 202 d b 8 657 m 2 951 l o m exp m 4 498 0 1784 d b 70 5 7b spilling formula h b l o d b 8 797 l o d b d b m m 3 048 d b 7 611 39 95 d b 211 9 l o 55 16 d b 55 16 7c plunging formula h b d b 0 09037 m l o 646 1 m 11 07 d b 4 604 d b 93 33 d b 822 3 m 1 697 note that the obtained value of h b from the proposed formulae will be in centimetres in order to evaluate the performance of the proposed formulae some statistical evaluation parameters are implemented they include the root mean square error rmse the coefficient of determination r2 the bias b the relative error e and the mean average error mae whose descriptions are given below root mean square error rmse 8 rmse i 1 n h b c i h b o i 2 n coefficient of determination r2 9 r 2 i 1 n h b c i h b c h b o i h b o i 1 n h b c i h b c 2 i 1 n h b o i h b o 2 2 bias b 10 b i 1 n h b c i h b o i n relative error erel for average wave heights 11 e rel h b c h b o h b o mean average error mae 12 mae i 1 n h b c i h b o i n scatter index si 13 si r m s e h b o absolute error eabs for average wave heights 14 e abs h b c h b o in which h b o denotes the observed breaker height and h b c is the calculated one h b o denotes the average observed breaker height and h b c is the average calculated one and n indicates the number of data points in table 4 the statistical values of r2 rmse and mae for the training validation and all data in the three developed gep formulae are presented as it is seen the outcomes are satisfying and an acceptable correlation exists between the calculated and observed values since the values of r2 are high and the errors rmse and mae are low moreover comparisons are made between the observed and calculated values of the three proposed formulae in figs 3 5 5 2 comparison between the proposed formulae and the previous ones table 5 is provided to compare the results of the proposed formulae with the previous ones proposed in the literature using the statistical evaluation parameters mentioned earlier it should be noted that since the data used here are grouped into low and high values as seen in figs 3 5 they are separated into different subgroups based on the values of breaking wave heights and the errors for different subgroups are calculated first then the overall mean values are computed and the values given in this table are actually the mean values moreover since the incident wave conditions in the study cases differ significantly the rmse may not be a good metric for comparisons of model errors between different cases and the relative errors scatter index and relative bias are more appropriate to quantify the errors for the variables with a wide range of values as it is seen in table 5 the general formula rmse cm 11 65 r2 0 98 erel 0 02 si 20 41 shows acceptable performance in comparison with the other formulae by having the least amount of error in this comparison therefore it can be somehow used as a suitable tool for predicting the breaking wave height without considering the type of breaking however as it was mentioned earlier the main focus of this study is to investigate the effect of different breaking types i e spilling and plunging on the accuracy of the beraking wave height prediction relations considering this it can be understood from the table that although it has accurate outcomes the spilling formula rmse cm 8 91 r2 0 99 erel 0 03 si 17 98 does not have the best performance in comparison with the other existing formulae which are proposed based on general cases and the type of breaking has not been considered in them and the best performance in this case belongs to the formula proposed by robertson et al 2015 which has the least error however the plunging formula rmse cm 8 78 r2 0 99 erel 0 01 si 15 96 has the least error compared to the other formulae therefore it can be concluded that for the plunging type using the proposed formula may lead to more accurate results compared to the other formulae another factor to consider here is that due to the fact that the range of datapoints used in this study is not unlimited using the absolute error for showing the accuracy of the proposed formulae would also seem to be an appropriate tool it can be seen that this value for the proposed relations is almost less than the other formulae which may prove the fact that using these relations would lead to more accurate results to sum up by considering the outcomes of all of the statistical parameters among the three proposed formulae it seems that the plunging one has almost the best performance in comparison with the other ones and although the spilling formula has the least absolute error in comparison with other formulae it does not have the best performance in this comparison when considering all of the statistical parameters in conclusion it can be said that using different formulae based on different breaking types for predicting the wave breaking height may be useful in some cases and may be more accurate but this statement needs further investigation and examination especially over wider ranges of datapoints another point to mention here is that according to the physical differences between the plunging and spilling breaker types i e the plunging breaker type occurs when the seabed slope is steep which leads to steeper waves while the spilling one happens in gentle seabed slopes causing the waves to break when they are long and slow less steepness compared to the plunging type having specified formula for each breaking type would seem to be more useful and accurate in predicting the wave breaking height more discussion about the dependence of these formulae on steepness and seabed slope is provided in section 5 4 5 3 verification and testing in order to test the proposed formulae two laboratory datasets which are not included among the training and validation data are used as shown in table 6 in table 7 the performance of the proposed three gep formulae is evaluated using the testing dataset and a comparison is also made with some other existing formulae it can be understood from this table that except for the general formula the two other proposed formulae have almost appropriate performance the plunging formula has the least error in comparison with the other existing formulae and the spilling formula has acceptable performance however unlike the discussion given in section 5 2 the general formula which has an overall acceptable performance leads to less accurate results in comparison with the other existing formulae in conclusion it can be stated that the proposed plunging and spilling formulae show almost the same performance in the verification stage but according to this stage the outcomes of the general formula do not match with what was stated in section 5 2 however it is worthwhile to mention that the dataset used in this stage is much more limited than the one used in the model development section and hence concluding that the general formula is not accurate in any situation may not be true for instance changing the bottom slope could have a significant influence on the results as it was seen in the results of table 5 where a wide range of bottom slope existed in the dataset 5 4 sensitivity analysis of the proposed formulae here it is tried to investigate the ability of the presented relations in capturing the sensitivity of the input parameters to the predicted wave breaking height the aim is to compare the effect of each input parameter on the proposed formulae with the other existing ones to see whether the behaviours are the same or not each parameter s influence on the relations is investigated by changing the specific parameter s value while assigning a constant value for the others the effect of the specific parameter on the wave breaking height is studied through the values predicted by the proposed gep model and other formulae reported in the literature since the input parameters used in the proposed formulae are among the ones whose influence on the breaking wave height is experimentally documented the proposed relations accuracy based on the input parameters can be investigated here the conditions of gentle and steep slopes m 0 01 and m 0 3 respectively long and short deepwater wavelengths l o 1100 cm and l o 11000 cm respectively and relatively shallow and deeper water d b 15 cm and d b 100 cm respectively are considered here in figs 6 8 the effects of each parameter on the model are shown all of the proposed formulae i e general plunging and spilling are investigated here in fig 6 the influence of deepwater wavelength on different formulae is shown as it is seen the overall tendency of all formulae is that the breaking wave height increases up to a point by increasing the deepwater wavelength and then it remains almost constant however the rate of this increase is reduced when cosidering longer wave lengths it is seen that the changing rate of most of the formulae is completely different between gentle and steep slope conditions for instance there is no significant change in the proposed plunging formula when considering gentle slope fig 6 a but when investigating steep slope fig 6 c the breaking wave height predicted by this formula increasese significantly by increasing the deepwater wavelength this issue could be related to the fact that the plunging wave breaking type is generally occurred in steep slope condition and when this kind of slope is considered the changing rate of this formula will be increased according to fig 7 the breaking wave height increases by increasing the water depth no matter considering gentle or steep slopes and long or short deepwater wavelength however the rate of this increase is different among different formulae and different slope or wavelength conditions therefore the behavior of the proposed formulae when considering variations in water depth is in accordance with the breaker depth index dependence illustrated by mccowan 1894 and the cases confimred by laboratory and field studies based on previous studies carried out by different researchers e g camenen and larson 2007 there is an exponential relationship between the breaking height and seabed slope as seen in fig 8 this issue can be seen in some of the breaking wave height prediction formulae when moving from gentle slopes to steep ones in the formulae proposed by tomasicchio et al 2019 and goda 2010 as well as the proposed spilling formula the breaking wave height increases significantly by increasing the seabed slope while there is no significant change in the breaking wave height calculated by some other formulae in some formulae i e rattanapitikon and shibayama 2000 and robertson et al 2015 the breaking wave height decreases by moving from gentle slopes to steep ones it is wothwhile to mention that different behaviors can be observed among the formulae when considering different conditions e g short or long deepwater wavelength overall it can be conlcuded that according to what is documented in the literature and what is shown here the variations of the proposed formulae are somehow similar to the other formulae proposed in the literature in the area of breaking wave height prediction and the physical behavior of wave breaking phenomenon can be almost correctly interpreted in most cases though there are some dicrepencies and differences in some cases between the proposed formulae and the ones presented in the literature for instance the fact that waves with longer wavelengths can have higher breaking wave height if the similar limited steepness is applied can be seen in fig 6 6 conclusions in this research new formulae were developed for predicting the wave height in breaking condition which is considered as the most important characteristic of the wave breaking phenomenon the formulae were proposed by utilizing gene expression programming gep and the main focus was to develop different formulae based on the type of breaking so that its influence on the breaking wave height prediction could be investigated in order to obtain the proposed relations a wide range of laboratory and field dataset has been used after excluding the data points that represented different types of wave breaking according to different wave breaking classification criteria and ignoring the data points that did not contain all of the necessary information i e seabed slope water depth or deepwater wavelength the range of breaker height seabed slope and period of laboratory data used in this study has been become 1 64 129 cm 0 009 0 3759 and 0 7 5sec respectively for the field data these values were 89 351 cm 0 0028 0 0663 and 8 34 23 45sec respectively from this model three formulae were derived eq 7 one for all of the data rmse cm 11 65 r2 0 98 erel 0 02 si 20 41 without considering the type of breaking one for the spilling breaker type rmse cm 8 91 r2 0 99 erel 0 03 si 17 98 and one for the plunging one rmse cm 8 78 r2 0 99 erel 0 01 si 15 96 the outcomes of the proposed formulae were compared with the previous ones reported in the literature in order to verify the model a new laboratory dataset whose data points were not used in the model development process was applied moreover a sensitivity analysis was performed to investigate the influence of different parameters on the relations and to check whether the behavior is like the other existing formulae or not according to the results of this analysis as in the other existing formulae the breaker height increased by increasing the water depth and deepwater wavelength in the proposed formulae however the change in the seabed slope from gentle slopes to steep ones did not have a significant influence on the value of the breaker height in two of the proposed formula the one used for all wave breaking types and the one used for the plunging type this behavior was different from the other formulae proposed in the literature and it may be concluded that the two mentioned proposed formulae are not as sensitive as the other ones to the seabed slope directly to sum up it should be stated that the formula developed based on the plunging wave breaking type had almost higher accuracy than the other existing formulae therefore using this formula for predicting the wave breaking height in the plunging type may lead to more accurate results the spilling formula also showed acceptable performance but it was not the most accurate one in comparison with the other formulae overall it somehow can be concluded that using different formulae for different breaking types rather than using one general formula for all types in some cases could lead to more accurate predictions however further investigation and research should be done in this area to validate this statement for almost every wave breaking condition credit authorship contribution statement behrooz tadayon methodology software validation formal analysis writing original draft writing review editing hamid dehghani methodology software validation formal analysis writing original draft cyrus ershadi conceptualization methodology validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to appreciate dr robertson for his valuable guidance regarding providing the necessary information and data for carrying out this research it is worthwhile to mention that dr delavari has also gathered some of the data and the authors would like to appreciate him as well moreover the authors highly appreciate the gepsoft limited company for creating the genexprotools software which helped us to obtain the desired formulae in this research 
20853,the accurate prediction of ship trajectory has great significance in maritime transportation among all the prediction methods multi step prediction has received increasing attention because it can predict both time and position information in the future period however the existing methods are either complex or have low prediction accuracy in order to overcome the limitations a physical hypothesis is introduced to balance the complexity and the accuracy the cubic spline interpolation and historical trajectories are used to realize it the advantages of tpnet and lstm are combined in the proposed method and four parts are involved the ais data preprocessing method the solutions of destination point and support point and the uncertainty analysis the proposed method is not only easy to implement and suitable for real time analysis but also has a high prediction accuracy the case study on a ferry ship in the jiangsu section of the yangtze river indicates the validity of the method keywords trajectory prediction multi step prediction ais data lstm neural network 1 introduction with the advancements in big data and internet of things iot technologies more and more sensors are being used in maritime transportation systems that has been playing a significant role in world trade the shipping industry is also undergoing a technological revolution namely shipping 4 0 rødseth et al 2016 ais data is one of the most common types of data source and has been used in many situations such as assessment of navigational risk jiang et al 2021 wu et al 2021 zhang et al 2020a evaluation on the influence of ship navigation activities to the environment zhang et al 2020b to list some the ship domain sd where any violation of other ships or targets are prohibited can be calculated according to the statistical analysis of the minimum distance to target ships in different bearing angles horteborn et al 2019 xin et al 2019 due to the increasingly strict requirement on the environment protection an approach for estimating the pollutant emissions from ships based on the ais data of the tianjin port in china is proposed chen et al 2016 risk assessment is an important application case which determines the closest point of approach cpa between ships by predicting the positions of adjacent ships based on the relative velocity and relative position thus the probability of ship collision can be evaluated as a guidance for the navigators to make appropriate decisions and actions at close encounters perera et al 2012 tarn et al 2009 however one premise of risk assessment is that the locations and dynamics of the ship are available with satisfactory precisions yuan et al 2021 this reflects that the better the ship dynamics data can be predicted the more response space and time for avoiding an accident therefore the prediction of ship trajectory is important for maritime risk assessment and collision avoidance in fact trajectory prediction han and micheline 2006 has been extensively studied in many fields schmidhuber 2015 such as vehicle trajectory prediction pedestrian trajectory prediction and robot trajectory prediction zhang et al 2018b proposed a matrix neural network to predict cyclone trajectory thus avoiding the lack of spatial information relevance caused by data vectorization hao et al 2018 proposed a pedestrian trajectory prediction method based on a hierarchical lstm network which not only considers the impact of social neighborhoods but also considers the impact of scene layout on the prediction results li et al 2018 proposed a pedestrian posture trajectory prediction method based on the three degree of freedom posture data learnt from ranging sensors and camera images altché and arnaud 2018 focused on the challenge that the existing advanced driving assistance systems adas cannot make mid term predictions and proposed a method for predicting the horizontal and vertical trajectories of vehicles on the road recalling these methods it can be seen that the accuracy of trajectory prediction can be improved by considering the data correlation the development of these methods in various fields provides a reference for solving the problems based on ais data in the field of ship trajectory prediction however the trajectory of ship has its unique characteristics compared with vehicles pedestrians and robots for example the spatial distribution of ship trajectory data is relatively stable and the navigation state of a ship in a certain area is closely related to the surrounding environment of the water area gan et al 2018 liu and chen 2014 these mean that the ships navigating in the same waters usually share common behaviors in a narrow water area the ship is usually slower than that in an open water area when the ship is approaching the port its velocity is likely to be very small similarly when a ship is navigating in a curved channel it may take steering operations frequently therefore it is difficult to achieve a satisfactory accuracy without considering the characteristics of the trajectory in spatial dimension from the perspective of ship traffic flow moreover the ships cannot make sharp turnings as pedestrians or robots due to the limitations in maneuver abilities these characteristics enable the prediction accuracy being improved by targeted modeling or using their historical data as a reference thus two typical approaches are developed according to two aspects which are the kinematic modeling based approach and the machine learning based approach respectively for the former approach some typical methods include nearly constant velocity ncv model ornstein uhlenbeck ou process kalman filter kf gaussian process gp etc ristic et al 2008 proposed the ncv model based on historical data in the framework of adaptive kernel density estimation and used a gaussian sum tracking filter to predict the ship s trajectory perera et al 2012 proposed an ekf based extended kalman filter method to make ship trajectory prediction by adding estimated noise in the kinematic model millefiori et al 2017 performed prediction for long series data based on the ou process rong et al 2019 treated the position of the ships as a gaussian distribution and predicted the trajectory of a ship through gp modeling these methods works well for the cases where the ship motion state is relatively stable however the ship dynamics is usually subject to different excitations imposed by the environment in different regions this may lead to a non stationary state and make the prediction less satisfactory in practice with respect to the latter approach machine learning based prediction methods can be classified as single step prediction trajectory matching and multi step prediction among them single step prediction means predicting the location of the next moment trajectory matching means predicting the possible future positions of a ship while not considering their relationship with time multi step prediction means that position and time can be predicted at the same time although single step prediction can be used at the next moment this brings error accumulation in terms of single step prediction the early work was usually based on a simple neural network for instance simsir and ertugrul 2009 used the position and speed data of ships to train an artificial neural network ann based on which the ship navigational risk early warning is investigated for narrow waters based on the forwarding prediction on the ship trajectories xu et al 2012 also proposed an ann based method for ship trajectory prediction which differs from the above method in using the latitude longitude difference speed and course to predict the ship position in this way the prediction value can avoid exceeding the range of the activation function meanwhile single step prediction can be applied to the real time prediction of ship behavior due to its calculation simplicity based machine learning zissis et al 2015 predicted the future behavior of ships and proposed a web based infrastructure that can achieve good results in small computation time however these methods did not consider the trajectory characteristics in spatial perspective thus they work well only in a very short time and their performance would degrade to a large degree for longer term prediction in terms of trajectory matching the introduction of historical ship trajectory is a solution of the above limitations some methods have been proposed to identify similar trajectories using clustering algorithms which can offer a reference to predict the future trajectories li et al 2017 improved the robustness of clustering algorithm through similarity metric and principal component analysis pca rong et al 2018 proposed a polynomial logistic regression model to predict the destination of a ship zhang et al 2018a used dbscan algorithm to obtain a trajectory that is similar to the ship trajectory that needs to be predicted gan et al 2018 dealt with historical trajectories by fuzzy c means fcm clustering algorithm and established the relationship model among multiple factors such as ship velocity load etc to predict the long term trajectory murray and perera 2019 improved the separability of the extracted features by using a gaussian mixture model to find similar historical trajectories to predict the future trajectory by matching similar trajectories the trajectory over a long period of time can be well predicted however due to the different velocities of ships similar trajectories cannot guarantee that they are also aligned in time that is the predicted trajectory has a large uncertainty in time dimension which is important for ship collision avoidance compared with single step prediction methods multi step prediction can offer a richer space information reference for ship navigation fan et al 2008 wang et al 2020 and compared with trajectory matching methods it can provide richer time information in fact multi step prediction methods for ship trajectories have been explored murray and perera 2020 proposed a dual linear autoencoder ae approach for multi step prediction which is optimized by minimizing the error between the output and the real data although the model can achieve a desired prediction accuracy in many cases it needs simultaneously learn the mapping relationship between each output value and the input data one limitation is that a large enough amount of data is necessary to train the model another limitation is that the prediction accuracy is affected by the complexity of the mapping relationships that need to be trained tpnet fang et al 2020 is a new multi step prediction method that was proposed for vehicle trajectory prediction it reduces the complexity of the motion prediction problem by introducing the prior knowledge which assumes that the future trajectory is a cubic spline curve however the direct application of tpnet to ship trajectory prediction has the following problems 1 the classification problem in tpnet is not suitable for high precision prediction 2 the waterway is very wide compared to the road which makes the cnn based modeling method difficult inspired by the framework of tpnet the characteristics of relative stability and low flexibility of ship trajectory over a period of time in many cases are considered in this paper a physical constraint prior knowledge is imposed in the construction of the multi step prediction model to reduce the complexity and prediction cost the constructed model is easy to implement and suitable for real time analysis since lstm greff et al 2016 can capture dynamic information in serialized data and is more suitable for long sequence data learning it is used in this study as a basic tool to learn the non linear relationship first of all in order to provide spatial location information for ship prediction a reference trajectory generation method based on historical data is proposed to avoid learning too much useless historical data then the support point is built to reduce the complexity of the prediction after that the destination point is calculated by the reference trajectory and the displacement at each moment is predicted by cubic spline interpolation finally four typical trajectories are used to verify the effectiveness of the method the main contributions of this paper are 1 a high precision multi step prediction method for ship trajectory is proposed to overcome the problems of complex mapping relationships and large data requirements existing in the traditional methods 2 the physical constraint is used in the construction of the model to reduce the complexity and prediction cost of the network 3 an automatic generation method of reference trajectory based on ship motion parameters is proposed 4 the effectiveness of the method is verified by making predictions under four different navigation states the remainder of this paper is organized as follows section 2 describes the theoretical background of tpnet framwork lstm and their problems in ship trajectory prediction in section 3 the method proposed in this paper is introduced in detail and in section 4 a dataset with 1000 trajectories and four typical navigation modes of the ferry ship in jiangsu section of the yangtze river are used to verify the proposed method finally section 5 concludes the paper 2 the tpnet framework and lstm model 2 1 tpnet framework the tpnet framework is an advanced approach in vehicle trajectory prediction the trajectory is modeled as a polynomial continuous curve to guarantee efficiency flexibility and robustness a cnn based encoder and decoder cnn ed is used to generate the predicted curves and two stages are consisted to determine two control points the end point and the curvature point as shown in fig 1 these two points and the current point can form a cubic spline curve as the predicted trajectory among them the curvature point is modeled by the distance between the curve and the midpoint on its chord γ it is worth mentioning that in tpnet the prediction of end point is a classification problem and cnn ed is used to learn the mapping relationship the final determination of γ corresponding to the curvature control point is also a classification problem and the network is trained by positive and negative sample division of multiple possible trajectories however for ship trajectory prediction the direct use of tpnet has following problems 1 compared with vehicles the apparent changes of motion states are usually not practicable for example at the crossroad some vehicles turn left or right some vehicles change lanes etc from a mathematical view that is to say compared to the 0 1 distribution the trajectory of a ship tends to be more like a gaussian distribution which is not suitable for modeling the trajectory using a classification problem 2 the navigation of ships is not constrained by lanes which increases the modeling difficulty by cnn ed 2 2 lstm model as a neural network to capture the dynamic information in serial data lstm greff et al 2016 can accurately predict the sequence data through memory storage unit which has been widely used in machine translation sutskever et al 2014 wu et al 2016 and other related fields wijnands et al 2018 yang et al 2020 lstm has great advantages in data prediction and can achieve a higher prediction accuracy than many methods the core idea is that it can store time varying state in the memory cell and its nonlinear gate units which are the forget gate input gate and output gate can control the inflow and outflow of information the structure diagram of lstm is shown in fig 2 the information which needs to be input into the different recurrent units rus can transmit and communicate between units the states that flow through the forget gate c t input gate c t 1 and output gate h t can be expressed as follows 1 c t σ w f h t 1 x t b f c t 1 2 c t c t σ w i h t 1 x t b i tanh w c h t 1 x t b c 3 h t σ w o h t 1 x t b o tanh c t where c t is the state cell at the current time point t h t 1 is the output of the previous cell is the hadamard product w f w i w o and w c are the weights of the forgetting gate input gate output gate and block input respectively b f b i b o and b c are the corresponding biases σ is the sigmod activation function and tanh is the activation function 3 methodology in order to improve the multi step prediction accuracy of ship trajectory an easy to implement method that is suitable for real time analysis is proposed by combining the advantages of tpnet and lstm the method is named multi step prediction lstm mp lstm lstm is introduced for the prediction of curvature control point that is the determination of the point is regarded as a regression problem rather than a classification problem in tpnet therefore it is referred to as the support point meanwhile the end point is also not solved through a classification problem it is solved based on a hypothesis that the values in the generated reference trajectory and the current trajectory are approximately equal compared with the classification problem that treats a portion of the region as a class regression problem can achieve a higher location resolution and therefore a higher prediction accuracy the relative stability of the ship s trajectory makes the proposed method reasonable it is noteworthy that the proposed prediction method is based on the displacement in equal time intervals rather than the positional sequence the technical roadmap of the proposed method is shown in fig 3 in which four parts are involved ais data preprocessing the solution of destination point the solution of support point and the uncertainty analysis 3 1 ais data preprocessing there are two main problems with trajectory prediction based on ais data measurement error and the inconsistency of time intervals measurement error means that the received ais data value is not the true value of the sensor at the time of measurement and sometimes the deviation is very large tu et al 2018 the inconsistency is influenced by many factors such as the inconsistency of the broadcast frequency of ais data and packet losses in order to restore the trajectory cubic spline interpolation and median filter are introduced to solve the above two problems cubic spline interpolation is used to fit the data to make the time intervals consistent compared to other interpolation methods such as cubic hermite spline boor 1978 the results from cubic spline interpolation method is smoother cubic spline interpolation adds constraints to the cubic polynomial by assuming that both the first and second order derivatives of the curve are zero while cubic hermite spline adds constraints by setting the tangent direction of the trajectory if the ais data is accurate enough and without delay cubic hermite spline can get a more accurate interpolation however the above assumptions are not practicable thus adding constraints to the equations through smoothness can lead to more accurate results moreover when the time interval to be interpolated is short cubic spline interpolation has some advantages due to the consideration of smoothness however when the time interval is long as in the case of hintzen et al 2010 cubic hermite spline can obtain better interpolation results due to the constraint of course by considering the above aspects cubic spline interpolation method is adopted in this study assuming that the time series interval a b can be divided into n intervals namely x 0 x 1 x 1 x 2 x n 1 x n and the corresponding function values of the n 1 data points are y 0 y 1 y n then if these points satisfy the interpolation function s i x as shown in eq 4 the undetermined coefficients in the equation can be obtained by adjacent data and can be used to interpolate the ais data in equal time intervals 4 s i x a i x 3 b i x 2 c i x d i where a i b i c i d i are undetermined coefficients mckinley and levine 1998 after interpolation the anomalies of the signals can be treated as the salt and pepper noises which appear in the signal with significantly increased or decreased amplitude and are quite different from the normal signal thus median filtering is used to remove the salt and pepper noises in the data after cubic spline interpolation chan et al 2005 3 2 multi step prediction model based on support point and destination point it may not acquire satisfactory accuracy by directly using the ship position information to predict the forwarding trajectory this is because 1 the position data are larger in magnitude than the displacement data per unit moment the former is the accumulation of the latter which will cause a large absolute error when the relative error of the network is certain 2 the training and test sets are usually not in the same region which means that the predicted position data is usually beyond the range of the activation function of the network and achieves a poor accuracy in the proposed method the destination point support point and start point are obtained by the displacement in equal time intervals 3 2 1 destination point the destination point is calculated by the historical data based on the assumption in eq 5 5 s j k 1 t m s j k 1 t 1 s j k 2 t m s j k 2 t 1 δ s j k 1 t i δ s j k 2 t i i 1 m s j k 1 t n s j k 1 t m s j k 2 t n s j k 2 t m δ s j k 1 t i δ s j k 2 t i i m 1 n where s j t is the latitude and longitude of the ship on the j th historical trajectory at time t and δ s j t is the corresponding displacement the assumption is that if the two trajectories satisfy the following conditions at the first t m moments 1 the displacements are equal 2 the average velocities are equal 3 the instantaneous velocities fluctuate within a small range e g 0 5knot then the two trajectories have approximate displacements in the next short time that is the displacements are entangled with each other based on this it is only necessary to find or generate a trajectory that meets the three conditions with the current ship trajectory then the ship s displacement at the end of the prediction the destination point can be estimated the trajectory that meets such conditions is called the reference trajectory the detailed calculation procedure is explained as follows 3 2 1 1 historical data processing the procedure of data processing is present in fig 4 where and represent the values of the current trajectory and historical data at different times respectively the training start point is t 0 the prediction start point is t m and the prediction end point is t n the red dot represents the time when the prediction starts firstly all historical data that are approximately equal to the position data in the time range t 0 to t n of the current trajectory are selected and a certain error ε should be kept at both ends of the intercepted historical data then the historical data are aligned with the current trajectory on the time scale by resampling on the cubic spline curves described in section 3 1 and making the longitude values consistent at the beginning of the prediction the processed data are easier to filter for appropriate historical trajectories 3 2 1 2 historical data filtering in order to prevent the cumulative error problem in multi step prediction the historical trajectory data is introduced in the prediction model however since historical data contains a wide variety of ship navigation status not all historical data can be used as a reference to improve the accuracy of the model in view of this a historical data filtering method based on the ship s navigation status and otsu 1979 method is introduced four ship motion parameters i d x d m δ x δ t δ y are used to measure the ship navigation status to determine the thresholds in the otsu method historical data suitable as reference trajectories can be initially filtered by these thresholds so that they can keep in line with the current trajectory in the main navigation direction such as longitude and allow a certain distance in other directions such as latitude the meanings of the four parameters and their roles in data filtering are present in table 1 the objective function of the otsu method is shown in eq 6 6 g u w 0 1 n 0 i 0 n 0 i d x 0 i u 2 w 1 1 n 1 i 0 n 1 i d x 1 i u 2 where u is the threshold w 0 and w 1 are the proportions of data points in the foreground and background respectively i d x 0 and n 0 are the values of data points in the foreground and the number of them i d x 1 and n 1 are the values and the number in the background then the objective function can be optimized and the threshold can be obtained by eq 7 7 t h r e s h o l d g 1 s u p g u 3 2 1 3 generation of reference trajectory and solution of destination point after filtering of the historical trajectories the selected data in the time period t 0 t m can be normalized as shown in eq 8 8 s j t n o r m j s j t s j t min s j t max s j t min s j t t t m t 0 where s j t is the value of the j th historical data at time t and s j t is the normalized value then the mean square errors mses shown in eq 9 are calculated to select the reference trajectory 9 m s e j t t m t 0 s j t s 0 t 2 where s 0 t is the normalized value of the current trajectory the index of the closest trajectory with the minimum error is obtained by an optimization function in eq 10 10 j 1 m s e 1 inf m s e j then the reference trajectory s j 1 t t t m t n is generated by inverse normalization using the normalization parameters of the current trajectory as shown in eq 11 11 s j 1 t n o r m 0 1 s j 1 t after the above process the generated trajectory and the current trajectory satisfy the assumption in eq 5 and the destination point of the current trajectory can be estimated by eq 12 12 δ s 0 t n δ s j 1 t n 3 2 2 support point the displacements in longitude and latitude directions are uncorrelated with each other thus in order to better learn the nonlinear relationship in the data based on a simple lstm model the displacements of support point are learned by two independent models as shown in fig 5 suppose that the input of the two networks are i x and i y 13 i x δ s x 0 t n 1 v 1 d 1 δ s x 0 t n 2 v 2 d 2 δ s x 0 t n k v k d k i y δ s y 0 t n 1 v 1 d 1 δ s y 0 t n 2 v 2 d 2 δ s y 0 t n k v k d k in the two matrices each row represents the input at each moment and a total of k moments are involved δ s x 0 t n i δ s y 0 t n i v i and d i represent the longitude displacement latitude displacement velocity and course of the ship at time t ni respectively to avoid the effect of different ranges of values in the training data on network training and make the network converge quickly the training data is normalized by eq 14 14 i i min i max i min i the information at each time is transferred by lstm through the recurrent unit r suppose the recurrent units at time t ni are r x i and r y i respectively then their output o x and o y can be expressed as 15 o x r x k δ s x 0 t n k v k d k r x k 1 o y r y k δ s y 0 t n k v k d k r y k 1 where r k 1 r k 1 δ s 0 t n k 1 v k 1 d k 1 r k 2 the recurrent units r x i and r y i are composed of the three gates in eqs 1 3 the networks are trained by comparing the differences between the values in longitude and latitude with the outputs of lstms and the mse in eq 16 is used as the loss function 16 m s e y y i 1 n y i y i 2 n where y and y represent the true value and the predicted value of lstm respectively adaptive moment estimation adam which can perform one step optimization on a random function is adopted to optimize the model the number of units in the hidden layer which can remember and store past states is used as a parameter by searching the optimal value in 85 170 255 340 425 when the value is large the complexity of the model increases and it is prone to overfitting but when the value is small the nonlinear fitting ability may be weakened the maximum training epoch is 1500 which is determined to ensure the convergence of network the training would terminate when the error is close to 0 or when the set number of maximum training epoch is reached the choice of recurrent unit number requires a balance between complexity and accuracy of a network a larger value means that the network is more accurate but more complex otherwise the opposite in this study it is set to 15 after a comprehensive analysis of multiple trials the number of steps is set according to the actual demand at the same time there is no direct relationship between the number of steps and the time intervals the time interval between adjacent data points in this paper is set to 1s while it can be set to ns then the predicted time series is n 2 n 30 n 3 2 3 uncertainty analysis the uncertainty of each predicted point is fitted by the uncertainties of the support point and the destination point assuming that the errors between the true and predicted values follow a gaussian distribution the uncertainties can be estimated by the training errors for the destination point the maximum likelihood estimation of the standard deviation of the errors σ ˆ d can be expressed as 17 σ ˆ d 1 n i 1 n e i 2 1 n i 1 n e i 2 where e i denotes the error between the training data and the reference trajectory at each moment and n denotes the length of the training data similarly the uncertainty of the support point is calculated by the difference between the true values and the predicted values of the training data then the maximum likelihood estimation of the standard deviation of the errors σ ˆ s can be expressed as 18 σ ˆ s 1 n i 1 n y i y i 2 1 n i 1 n y i y i 2 since the ship position at the start point is deterministic its uncertainty is zero afterwards the uncertainties can be obtained by linear interpolation of the uncertainties of these three points for a gaussian distribution the 95 confidence interval ci is 2 σ 2 σ therefore the cis of all predicted values can be obtained by the above calculations 4 results and discussion 4 1 data description in order to test the performance of the proposed trajectory prediction algorithm the ais data from ferry ships navigating in the jiangsu section of the yangtze river is used for analysis one of the reasons is that the ferry is crossing the waterway frequently during each voyage it usually performs acceleration and deceleration operations and sometimes with apparent turnings these features are quite suitable for testing the overall performance of the proposed approach under multiple navigation states a sample of 1 000 ais data with equal time length in the navigation state are randomly selected for testing in this paper to visualize the effect of the proposed method four typical trajectories including the straight line stage the turning stage the acceleration stage and the deceleration stage are selected to describe the prediction process and results in detail the latitude and longitude data of the studied water area is present in fig 6 it can be seen that the trajectories of various ships in the same area are closely correlated although there are some differences in specifics from the perspective of ship dynamics the trajectories can be divided into straight line trajectory and turning trajectory from the perspective of speed fluctuation the trajectories can be divided into acceleration trajectory deceleration trajectory and uniform trajectory in general straight line trajectories and uniform trajectories are easier to predict thus the straight one in the four selected trajectories can be treated as a basic line and the acceleration value is very small that is it can also be considered as a uniform trajectory in this paper eq 19 is used to determine the straight trajectory and turning trajectory 19 λ d max l where l refers to the distance between the start and the end point on a trajectory d max refers to the largest distance from any points on the trajectory to the line between the start point and the end point the ratio λ obtained by the eq 19 can describe the trajectory curvature the statistical results for the 1 000 trajectories are shown in fig 7 a according to the analysis 0 03 can be determined as the threshold to discriminate between the straight and turning trajectory in addition the average value of acceleration is counted as shown in fig 7 b in this study only two categories are set up based on acceleration if the average acceleration is larger than 0 it is acceleration trajectory otherwise it is deceleration trajectory for comparison and fairness the length of all the training data and test data are same normally the durations of the turning the acceleration and the deceleration states are short thus the training data of 70s and the test data of 30s are used in this case by considering the duration of different states together in fact the choice of these two values is flexible and is determined by the specific situation the adjacent time interval is 1s 4 2 multi step prediction first cubic spline interpolation is used to make the selected trajectories equally spaced in time then the abnormal data is removed and the ais data is processed according to the approach mentioned in section 3 1 after that the multi step prediction based on the support point the destination point and cubic spline interpolation is performed the detailed steps of the filtering process in the prediction are illustrated through the data processing of the straight line case as shown in fig 8 according to the changes of the historical data in the longitude direction the historical data set in this area contains the data that the ships are navigating in the opposite direction the data of the ships stop on the way as well some types of data that is similar to the data to be predicted besides the ship travel behaviors are influenced by navigation standards ship type water traffic complexity environmental conditions therefore it is necessary to perform a preliminary filtering of the data prior to prediction the four proposed ship motion indicators are used to measure the similarity of different ship trajectory data in the studied area and otsu method is used to calculate the segmentation threshold as shown in fig 9 from fig 9 a it can be seen that the ship direction reflected by the first indicator is clearly displayed when it is consistent with the current trajectory direction the indicator is close to 0 whereas when it is inconsistent it is close to 3 2 10 3 deg this polarization helps filter historical data based on ship course from fig 9 b the second indicator of different trajectories is not clustered but randomly distributed the calculated threshold value is 1 6 10 3 deg if the threshold is exceeded it can be considered that the state of the ship in the historical data is significantly different from that of the current ship besides it can be seen from fig 9 c and fig 9 d that only a few points have been filtered out this is because the data has been filtered by the first two indicators and most of the inconsistent data has been filtered out after this process the data similar to the current trajectory is preserved and the data with great difference is removed then the proposed method is used to predict the trajectories and the results of the four typical ones are shown in figs 10 13 the number of units in the hidden layer is 170 it can be seen from fig 10 a and b that in the straight line navigation stage the prediction of the latitude and longitude displacements per unit time are basically consistent with the true values the prediction results not only have a small error near the starting point of the prediction but also keep about 1 0 10 6 deg at the end of prediction meanwhile it can be seen that the uncertainties of the predicted values are lower before the support point this is because lstm has small training error in learning the data after the support point the uncertainties of the predicted values have a significant increase especially at the end moment this is caused by the generated reference trajectory which is based on historical data and cannot guarantee a high degree of overlap at each moment although the uncertainty is large according to the assumptions in eq 5 an accurate prediction value can be obtained by introducing a historical trajectory even for the location at a moment that is far away from the start point the ship positions shown in fig 10 c and d are calculated from the cumulative equal moment displacements in fig 10 a and b due to the relative large uncertainty of the destination point in the latitudinal direction it has a relatively large ci after the support point fig 10 e is the prediction plot of the ship by combining the mean values of gaussian distribution in fig 10 c and d fig 10 c e shows that the predicted position at each time is almost consistent with the real position the prediction error is used to quantitatively describe the effect of the method as shown in fig 10 f it is noticed that at the moments closer to the starting point the prediction error is relatively small although the error increases afterwards the maximum position error in the latitude and longitude direction is only about 1 0 10 5 deg and it remains within an acceptable range in the turning stage it can be seen from fig 11 a and b that although there is a certain error at the end moment the error symbol of equal moment displacements has changed as a result a smaller accumulative error is achieved as shown in fig 11 c e especially in the fig 11 d it is obvious that the prediction error at the 100 th moment is smaller than that at the 96 th moment besides the prediction accuracy in the longitude direction is higher than that in the latitude direction this is because when the ship is turning in the case its longitude still increases but the latitude switches from increase to decrease in other words the reason for the larger prediction error in the latitude direction is that the ship s navigation status has changed in the turning phase the position error is present in fig 11 f the longitude error reaches 3 4 10 6 deg at the 88 th moment but it approaches 0 at the 94 th moment the latitude error reaches 2 1 10 5 deg at the 96 th moment but only 1 8 10 6 deg at the end which is much smaller than the cumulative error of traditional methods in addition as in the straight line navigation stage the uncertainty also increases after the support point it can be seen from fig 12 that in the accelerated navigation stage the prediction result is significantly better at the early time than at the later time the time range for accurate prediction is longer than that in the deceleration state in fig 13 this is also caused by the change of the navigation motion parameters in the later period it is worth mentioning that in the first 10 moments the average error of the two directions is only 8 6 10 7 deg for the deceleration case since the displacement decreases fast as the ship decelerates and a turning process is accompanied the accurate prediction time range is shorter than the above cases as shown in fig 13 only in the first five moments the prediction error is close to 0 furthermore as can be seen in fig 12 although the predicted destination point deviates from the true destination point and has the largest error its error in both directions is only about 2 0 10 6 deg in fig 13 although the predicted and true values at the end moment are almost identical the error is still the largest this is due to the fact that the position error is the result of the accumulation of the prediction errors of its previous multiple moments this also illustrates that the accuracy of the trajectory prediction of the proposed method is not determined by a single point but the symbol of error which oscillates the prediction error of all points within an acceptable range based on a physical assumption 4 3 comparison of the two interpolation methods in many cases ais data are not equally spaced in time in order to predict the position information of a ship at multiple moments the original data set needs to be interpolated to make it equally spaced in the time dimension making the prediction model easier to implement according to section 3 1 the cubic spline interpolation method is used in this study in order to compare the two methods the results from the two approaches are shown in fig 14 it can be seen that for straight line trajectory the trajectories from the two methods almost coincide for acceleration and deceleration trajectories the deviations are also small and negligible however with respect to the turning trajectory the results from cubic hermite spline method are not smooth at the turning stage once the time interval is short the results from cubic spline interpolation can describe the trajectory much better as shown in fig 14b 4 4 comparative analysis of prediction results in order to demonstrate the effectiveness of the proposed method some other multi step prediction methods are compared in this section lstm s means using the lstm model to directly train the latitude and longitude data and make multi step predictions lstm δs means that the lstm model is used to train and predict the changes in latitude and longitude at each time and then the latitude and longitude are calculated from time to time svr δs and ekf δs are similar to the lstm δs method except that the model used is the svr model and ekf model in order to perform multi step prediction with the above methods it is necessary to continuously predict backward in taking its predicted values as known values therefore it has a significant error accumulation phenomenon ae δs is a multi step prediction method unlike the above methods it is trained by the data before filtering so that the model can be fully trained the commonly used indicators in trajectory prediction fde final displacement error and ade average displacement error are used to measure the quality of the prediction results at the same time in order to measure the prediction effect of the method at early stage the average displacement error ade 10 of the previous 10 moments is used as another measurement indicator the prediction results of each method under different navigation stages are present in figs 15 18 and table 2 in general the prediction accuracies of all methods are ordered as follows mp lstm ae ekf δs lstm δs svr δs lstm s first the multi step prediction methods reflect higher accuracy for example both mp lstm and ae have better results compared with other methods this is mainly due to that there is no error accumulation in the same direction second the kinematic model based ekf method is largely better than lstm δs and svr δs this is determined by the data specifics if the noise in a segment of data is easily predicted the ekf method will exhibit higher prediction accuracy third the prediction results of lstm δs are slightly better than svr δs although the three metrics of prediction errors are almost equal in the straight line phase however the lstm shows superiority in the trajectory prediction of some complex navigation states such as turning and acceleration this is due to the long term memory function of lstm meanwhile for the methods based on equal moment displacements there is a significant distortion at the final moment this is because the prediction error increases sharply with time in addition the multi step method based on position data fails to achieve good results in all four stages this is due to that the method performs multi step prediction without learning historical data which leads to insufficient training beyond that direct multi step prediction also makes the predictions out of the activation function range which results in large distortion the prediction accuracy at the closer moments can be seen from the indicator of ade 10 the results show that the errors are relatively small in the straight line stage and the acceleration stage with 5 32 10 7 deg and 8 61 10 7 deg respectively the prediction error at the later moments can be measured with the other two indicators which are ade and fde for ade the prediction error is also smaller in the straight line and the acceleration status but for fde the prediction error is only small in the straight line status and is similar in the remaining navigation states which is due to the large uncertainty of the ship s turning degree and acceleration to verify the generality of the proposed method all the 1 000 trajectories are trained and tested by the proposed methods the statistical results of them are present in table 3 the characteristics reflected by the four typical trajectories are largely consistent with those reflected by the data set the multi step prediction method especially the proposed mp lstm shows high superiority the ade 10 value of lstm s is significantly higher than other methods and it reaches 7 1746 5 3468 10 4 deg which indicates that the method has a large error at the closer moments in addition the average values of the three indicators of svr δs and lstm s in table 3 are lower than those in table 2 in the turning stage and acceleration stage this is because the ship s motion characteristics are not well learned by the two methods in contrast the proposed mp lstm not only has lower prediction error but also has smaller variance this proves its effectiveness and generality 5 conclusion in order to enhance the performance of ship trajectory prediction for a longer period of time compared with some existing approaches a high precision multi step prediction method combining current trajectory data and historical data is proposed in this paper the key idea is that the multi step predictions are performed by cubic spline interpolation on the start point support point and destination point among them the destination point is generated by historical data to keep the error at a low degree and the support point is generated by a trained lstm model this method can not only realize the high precision prediction of short distance and long distance at the same time but also predict the precise position of each moment which provides more abundant and accurate information for the prediction of ship collision comprehensive evaluation on the case study indicates that the proposed method can achieve higher prediction accuracy than several traditional approaches in the dataset and the four basic navigation states straight line turning acceleration and deceleration and even at the end of the time to be predicted the method can also achieve satisfactory prediction accuracy however this method needs some historical trajectories to achieve accurate prediction in the future work further study can be performed by improving the high precision multi step prediction method when the historical data is lacking credit authorship contribution statement da wei gao conceptualization methodology validation investigation writing original draft yong sheng zhu investigation writing original draft supervision jin fen zhang methodology writing original draft supervision yan kang he investigation writing review editing ke yan supervision visualization bo ran yan visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research is financially supported by national key technologies research development program 2017yfe0118000 2017yfe0118004 national natural science foundation of china 52071247 51920105014 and technical innovation project of hubei province international cooperation 2018ahb003 
20853,the accurate prediction of ship trajectory has great significance in maritime transportation among all the prediction methods multi step prediction has received increasing attention because it can predict both time and position information in the future period however the existing methods are either complex or have low prediction accuracy in order to overcome the limitations a physical hypothesis is introduced to balance the complexity and the accuracy the cubic spline interpolation and historical trajectories are used to realize it the advantages of tpnet and lstm are combined in the proposed method and four parts are involved the ais data preprocessing method the solutions of destination point and support point and the uncertainty analysis the proposed method is not only easy to implement and suitable for real time analysis but also has a high prediction accuracy the case study on a ferry ship in the jiangsu section of the yangtze river indicates the validity of the method keywords trajectory prediction multi step prediction ais data lstm neural network 1 introduction with the advancements in big data and internet of things iot technologies more and more sensors are being used in maritime transportation systems that has been playing a significant role in world trade the shipping industry is also undergoing a technological revolution namely shipping 4 0 rødseth et al 2016 ais data is one of the most common types of data source and has been used in many situations such as assessment of navigational risk jiang et al 2021 wu et al 2021 zhang et al 2020a evaluation on the influence of ship navigation activities to the environment zhang et al 2020b to list some the ship domain sd where any violation of other ships or targets are prohibited can be calculated according to the statistical analysis of the minimum distance to target ships in different bearing angles horteborn et al 2019 xin et al 2019 due to the increasingly strict requirement on the environment protection an approach for estimating the pollutant emissions from ships based on the ais data of the tianjin port in china is proposed chen et al 2016 risk assessment is an important application case which determines the closest point of approach cpa between ships by predicting the positions of adjacent ships based on the relative velocity and relative position thus the probability of ship collision can be evaluated as a guidance for the navigators to make appropriate decisions and actions at close encounters perera et al 2012 tarn et al 2009 however one premise of risk assessment is that the locations and dynamics of the ship are available with satisfactory precisions yuan et al 2021 this reflects that the better the ship dynamics data can be predicted the more response space and time for avoiding an accident therefore the prediction of ship trajectory is important for maritime risk assessment and collision avoidance in fact trajectory prediction han and micheline 2006 has been extensively studied in many fields schmidhuber 2015 such as vehicle trajectory prediction pedestrian trajectory prediction and robot trajectory prediction zhang et al 2018b proposed a matrix neural network to predict cyclone trajectory thus avoiding the lack of spatial information relevance caused by data vectorization hao et al 2018 proposed a pedestrian trajectory prediction method based on a hierarchical lstm network which not only considers the impact of social neighborhoods but also considers the impact of scene layout on the prediction results li et al 2018 proposed a pedestrian posture trajectory prediction method based on the three degree of freedom posture data learnt from ranging sensors and camera images altché and arnaud 2018 focused on the challenge that the existing advanced driving assistance systems adas cannot make mid term predictions and proposed a method for predicting the horizontal and vertical trajectories of vehicles on the road recalling these methods it can be seen that the accuracy of trajectory prediction can be improved by considering the data correlation the development of these methods in various fields provides a reference for solving the problems based on ais data in the field of ship trajectory prediction however the trajectory of ship has its unique characteristics compared with vehicles pedestrians and robots for example the spatial distribution of ship trajectory data is relatively stable and the navigation state of a ship in a certain area is closely related to the surrounding environment of the water area gan et al 2018 liu and chen 2014 these mean that the ships navigating in the same waters usually share common behaviors in a narrow water area the ship is usually slower than that in an open water area when the ship is approaching the port its velocity is likely to be very small similarly when a ship is navigating in a curved channel it may take steering operations frequently therefore it is difficult to achieve a satisfactory accuracy without considering the characteristics of the trajectory in spatial dimension from the perspective of ship traffic flow moreover the ships cannot make sharp turnings as pedestrians or robots due to the limitations in maneuver abilities these characteristics enable the prediction accuracy being improved by targeted modeling or using their historical data as a reference thus two typical approaches are developed according to two aspects which are the kinematic modeling based approach and the machine learning based approach respectively for the former approach some typical methods include nearly constant velocity ncv model ornstein uhlenbeck ou process kalman filter kf gaussian process gp etc ristic et al 2008 proposed the ncv model based on historical data in the framework of adaptive kernel density estimation and used a gaussian sum tracking filter to predict the ship s trajectory perera et al 2012 proposed an ekf based extended kalman filter method to make ship trajectory prediction by adding estimated noise in the kinematic model millefiori et al 2017 performed prediction for long series data based on the ou process rong et al 2019 treated the position of the ships as a gaussian distribution and predicted the trajectory of a ship through gp modeling these methods works well for the cases where the ship motion state is relatively stable however the ship dynamics is usually subject to different excitations imposed by the environment in different regions this may lead to a non stationary state and make the prediction less satisfactory in practice with respect to the latter approach machine learning based prediction methods can be classified as single step prediction trajectory matching and multi step prediction among them single step prediction means predicting the location of the next moment trajectory matching means predicting the possible future positions of a ship while not considering their relationship with time multi step prediction means that position and time can be predicted at the same time although single step prediction can be used at the next moment this brings error accumulation in terms of single step prediction the early work was usually based on a simple neural network for instance simsir and ertugrul 2009 used the position and speed data of ships to train an artificial neural network ann based on which the ship navigational risk early warning is investigated for narrow waters based on the forwarding prediction on the ship trajectories xu et al 2012 also proposed an ann based method for ship trajectory prediction which differs from the above method in using the latitude longitude difference speed and course to predict the ship position in this way the prediction value can avoid exceeding the range of the activation function meanwhile single step prediction can be applied to the real time prediction of ship behavior due to its calculation simplicity based machine learning zissis et al 2015 predicted the future behavior of ships and proposed a web based infrastructure that can achieve good results in small computation time however these methods did not consider the trajectory characteristics in spatial perspective thus they work well only in a very short time and their performance would degrade to a large degree for longer term prediction in terms of trajectory matching the introduction of historical ship trajectory is a solution of the above limitations some methods have been proposed to identify similar trajectories using clustering algorithms which can offer a reference to predict the future trajectories li et al 2017 improved the robustness of clustering algorithm through similarity metric and principal component analysis pca rong et al 2018 proposed a polynomial logistic regression model to predict the destination of a ship zhang et al 2018a used dbscan algorithm to obtain a trajectory that is similar to the ship trajectory that needs to be predicted gan et al 2018 dealt with historical trajectories by fuzzy c means fcm clustering algorithm and established the relationship model among multiple factors such as ship velocity load etc to predict the long term trajectory murray and perera 2019 improved the separability of the extracted features by using a gaussian mixture model to find similar historical trajectories to predict the future trajectory by matching similar trajectories the trajectory over a long period of time can be well predicted however due to the different velocities of ships similar trajectories cannot guarantee that they are also aligned in time that is the predicted trajectory has a large uncertainty in time dimension which is important for ship collision avoidance compared with single step prediction methods multi step prediction can offer a richer space information reference for ship navigation fan et al 2008 wang et al 2020 and compared with trajectory matching methods it can provide richer time information in fact multi step prediction methods for ship trajectories have been explored murray and perera 2020 proposed a dual linear autoencoder ae approach for multi step prediction which is optimized by minimizing the error between the output and the real data although the model can achieve a desired prediction accuracy in many cases it needs simultaneously learn the mapping relationship between each output value and the input data one limitation is that a large enough amount of data is necessary to train the model another limitation is that the prediction accuracy is affected by the complexity of the mapping relationships that need to be trained tpnet fang et al 2020 is a new multi step prediction method that was proposed for vehicle trajectory prediction it reduces the complexity of the motion prediction problem by introducing the prior knowledge which assumes that the future trajectory is a cubic spline curve however the direct application of tpnet to ship trajectory prediction has the following problems 1 the classification problem in tpnet is not suitable for high precision prediction 2 the waterway is very wide compared to the road which makes the cnn based modeling method difficult inspired by the framework of tpnet the characteristics of relative stability and low flexibility of ship trajectory over a period of time in many cases are considered in this paper a physical constraint prior knowledge is imposed in the construction of the multi step prediction model to reduce the complexity and prediction cost the constructed model is easy to implement and suitable for real time analysis since lstm greff et al 2016 can capture dynamic information in serialized data and is more suitable for long sequence data learning it is used in this study as a basic tool to learn the non linear relationship first of all in order to provide spatial location information for ship prediction a reference trajectory generation method based on historical data is proposed to avoid learning too much useless historical data then the support point is built to reduce the complexity of the prediction after that the destination point is calculated by the reference trajectory and the displacement at each moment is predicted by cubic spline interpolation finally four typical trajectories are used to verify the effectiveness of the method the main contributions of this paper are 1 a high precision multi step prediction method for ship trajectory is proposed to overcome the problems of complex mapping relationships and large data requirements existing in the traditional methods 2 the physical constraint is used in the construction of the model to reduce the complexity and prediction cost of the network 3 an automatic generation method of reference trajectory based on ship motion parameters is proposed 4 the effectiveness of the method is verified by making predictions under four different navigation states the remainder of this paper is organized as follows section 2 describes the theoretical background of tpnet framwork lstm and their problems in ship trajectory prediction in section 3 the method proposed in this paper is introduced in detail and in section 4 a dataset with 1000 trajectories and four typical navigation modes of the ferry ship in jiangsu section of the yangtze river are used to verify the proposed method finally section 5 concludes the paper 2 the tpnet framework and lstm model 2 1 tpnet framework the tpnet framework is an advanced approach in vehicle trajectory prediction the trajectory is modeled as a polynomial continuous curve to guarantee efficiency flexibility and robustness a cnn based encoder and decoder cnn ed is used to generate the predicted curves and two stages are consisted to determine two control points the end point and the curvature point as shown in fig 1 these two points and the current point can form a cubic spline curve as the predicted trajectory among them the curvature point is modeled by the distance between the curve and the midpoint on its chord γ it is worth mentioning that in tpnet the prediction of end point is a classification problem and cnn ed is used to learn the mapping relationship the final determination of γ corresponding to the curvature control point is also a classification problem and the network is trained by positive and negative sample division of multiple possible trajectories however for ship trajectory prediction the direct use of tpnet has following problems 1 compared with vehicles the apparent changes of motion states are usually not practicable for example at the crossroad some vehicles turn left or right some vehicles change lanes etc from a mathematical view that is to say compared to the 0 1 distribution the trajectory of a ship tends to be more like a gaussian distribution which is not suitable for modeling the trajectory using a classification problem 2 the navigation of ships is not constrained by lanes which increases the modeling difficulty by cnn ed 2 2 lstm model as a neural network to capture the dynamic information in serial data lstm greff et al 2016 can accurately predict the sequence data through memory storage unit which has been widely used in machine translation sutskever et al 2014 wu et al 2016 and other related fields wijnands et al 2018 yang et al 2020 lstm has great advantages in data prediction and can achieve a higher prediction accuracy than many methods the core idea is that it can store time varying state in the memory cell and its nonlinear gate units which are the forget gate input gate and output gate can control the inflow and outflow of information the structure diagram of lstm is shown in fig 2 the information which needs to be input into the different recurrent units rus can transmit and communicate between units the states that flow through the forget gate c t input gate c t 1 and output gate h t can be expressed as follows 1 c t σ w f h t 1 x t b f c t 1 2 c t c t σ w i h t 1 x t b i tanh w c h t 1 x t b c 3 h t σ w o h t 1 x t b o tanh c t where c t is the state cell at the current time point t h t 1 is the output of the previous cell is the hadamard product w f w i w o and w c are the weights of the forgetting gate input gate output gate and block input respectively b f b i b o and b c are the corresponding biases σ is the sigmod activation function and tanh is the activation function 3 methodology in order to improve the multi step prediction accuracy of ship trajectory an easy to implement method that is suitable for real time analysis is proposed by combining the advantages of tpnet and lstm the method is named multi step prediction lstm mp lstm lstm is introduced for the prediction of curvature control point that is the determination of the point is regarded as a regression problem rather than a classification problem in tpnet therefore it is referred to as the support point meanwhile the end point is also not solved through a classification problem it is solved based on a hypothesis that the values in the generated reference trajectory and the current trajectory are approximately equal compared with the classification problem that treats a portion of the region as a class regression problem can achieve a higher location resolution and therefore a higher prediction accuracy the relative stability of the ship s trajectory makes the proposed method reasonable it is noteworthy that the proposed prediction method is based on the displacement in equal time intervals rather than the positional sequence the technical roadmap of the proposed method is shown in fig 3 in which four parts are involved ais data preprocessing the solution of destination point the solution of support point and the uncertainty analysis 3 1 ais data preprocessing there are two main problems with trajectory prediction based on ais data measurement error and the inconsistency of time intervals measurement error means that the received ais data value is not the true value of the sensor at the time of measurement and sometimes the deviation is very large tu et al 2018 the inconsistency is influenced by many factors such as the inconsistency of the broadcast frequency of ais data and packet losses in order to restore the trajectory cubic spline interpolation and median filter are introduced to solve the above two problems cubic spline interpolation is used to fit the data to make the time intervals consistent compared to other interpolation methods such as cubic hermite spline boor 1978 the results from cubic spline interpolation method is smoother cubic spline interpolation adds constraints to the cubic polynomial by assuming that both the first and second order derivatives of the curve are zero while cubic hermite spline adds constraints by setting the tangent direction of the trajectory if the ais data is accurate enough and without delay cubic hermite spline can get a more accurate interpolation however the above assumptions are not practicable thus adding constraints to the equations through smoothness can lead to more accurate results moreover when the time interval to be interpolated is short cubic spline interpolation has some advantages due to the consideration of smoothness however when the time interval is long as in the case of hintzen et al 2010 cubic hermite spline can obtain better interpolation results due to the constraint of course by considering the above aspects cubic spline interpolation method is adopted in this study assuming that the time series interval a b can be divided into n intervals namely x 0 x 1 x 1 x 2 x n 1 x n and the corresponding function values of the n 1 data points are y 0 y 1 y n then if these points satisfy the interpolation function s i x as shown in eq 4 the undetermined coefficients in the equation can be obtained by adjacent data and can be used to interpolate the ais data in equal time intervals 4 s i x a i x 3 b i x 2 c i x d i where a i b i c i d i are undetermined coefficients mckinley and levine 1998 after interpolation the anomalies of the signals can be treated as the salt and pepper noises which appear in the signal with significantly increased or decreased amplitude and are quite different from the normal signal thus median filtering is used to remove the salt and pepper noises in the data after cubic spline interpolation chan et al 2005 3 2 multi step prediction model based on support point and destination point it may not acquire satisfactory accuracy by directly using the ship position information to predict the forwarding trajectory this is because 1 the position data are larger in magnitude than the displacement data per unit moment the former is the accumulation of the latter which will cause a large absolute error when the relative error of the network is certain 2 the training and test sets are usually not in the same region which means that the predicted position data is usually beyond the range of the activation function of the network and achieves a poor accuracy in the proposed method the destination point support point and start point are obtained by the displacement in equal time intervals 3 2 1 destination point the destination point is calculated by the historical data based on the assumption in eq 5 5 s j k 1 t m s j k 1 t 1 s j k 2 t m s j k 2 t 1 δ s j k 1 t i δ s j k 2 t i i 1 m s j k 1 t n s j k 1 t m s j k 2 t n s j k 2 t m δ s j k 1 t i δ s j k 2 t i i m 1 n where s j t is the latitude and longitude of the ship on the j th historical trajectory at time t and δ s j t is the corresponding displacement the assumption is that if the two trajectories satisfy the following conditions at the first t m moments 1 the displacements are equal 2 the average velocities are equal 3 the instantaneous velocities fluctuate within a small range e g 0 5knot then the two trajectories have approximate displacements in the next short time that is the displacements are entangled with each other based on this it is only necessary to find or generate a trajectory that meets the three conditions with the current ship trajectory then the ship s displacement at the end of the prediction the destination point can be estimated the trajectory that meets such conditions is called the reference trajectory the detailed calculation procedure is explained as follows 3 2 1 1 historical data processing the procedure of data processing is present in fig 4 where and represent the values of the current trajectory and historical data at different times respectively the training start point is t 0 the prediction start point is t m and the prediction end point is t n the red dot represents the time when the prediction starts firstly all historical data that are approximately equal to the position data in the time range t 0 to t n of the current trajectory are selected and a certain error ε should be kept at both ends of the intercepted historical data then the historical data are aligned with the current trajectory on the time scale by resampling on the cubic spline curves described in section 3 1 and making the longitude values consistent at the beginning of the prediction the processed data are easier to filter for appropriate historical trajectories 3 2 1 2 historical data filtering in order to prevent the cumulative error problem in multi step prediction the historical trajectory data is introduced in the prediction model however since historical data contains a wide variety of ship navigation status not all historical data can be used as a reference to improve the accuracy of the model in view of this a historical data filtering method based on the ship s navigation status and otsu 1979 method is introduced four ship motion parameters i d x d m δ x δ t δ y are used to measure the ship navigation status to determine the thresholds in the otsu method historical data suitable as reference trajectories can be initially filtered by these thresholds so that they can keep in line with the current trajectory in the main navigation direction such as longitude and allow a certain distance in other directions such as latitude the meanings of the four parameters and their roles in data filtering are present in table 1 the objective function of the otsu method is shown in eq 6 6 g u w 0 1 n 0 i 0 n 0 i d x 0 i u 2 w 1 1 n 1 i 0 n 1 i d x 1 i u 2 where u is the threshold w 0 and w 1 are the proportions of data points in the foreground and background respectively i d x 0 and n 0 are the values of data points in the foreground and the number of them i d x 1 and n 1 are the values and the number in the background then the objective function can be optimized and the threshold can be obtained by eq 7 7 t h r e s h o l d g 1 s u p g u 3 2 1 3 generation of reference trajectory and solution of destination point after filtering of the historical trajectories the selected data in the time period t 0 t m can be normalized as shown in eq 8 8 s j t n o r m j s j t s j t min s j t max s j t min s j t t t m t 0 where s j t is the value of the j th historical data at time t and s j t is the normalized value then the mean square errors mses shown in eq 9 are calculated to select the reference trajectory 9 m s e j t t m t 0 s j t s 0 t 2 where s 0 t is the normalized value of the current trajectory the index of the closest trajectory with the minimum error is obtained by an optimization function in eq 10 10 j 1 m s e 1 inf m s e j then the reference trajectory s j 1 t t t m t n is generated by inverse normalization using the normalization parameters of the current trajectory as shown in eq 11 11 s j 1 t n o r m 0 1 s j 1 t after the above process the generated trajectory and the current trajectory satisfy the assumption in eq 5 and the destination point of the current trajectory can be estimated by eq 12 12 δ s 0 t n δ s j 1 t n 3 2 2 support point the displacements in longitude and latitude directions are uncorrelated with each other thus in order to better learn the nonlinear relationship in the data based on a simple lstm model the displacements of support point are learned by two independent models as shown in fig 5 suppose that the input of the two networks are i x and i y 13 i x δ s x 0 t n 1 v 1 d 1 δ s x 0 t n 2 v 2 d 2 δ s x 0 t n k v k d k i y δ s y 0 t n 1 v 1 d 1 δ s y 0 t n 2 v 2 d 2 δ s y 0 t n k v k d k in the two matrices each row represents the input at each moment and a total of k moments are involved δ s x 0 t n i δ s y 0 t n i v i and d i represent the longitude displacement latitude displacement velocity and course of the ship at time t ni respectively to avoid the effect of different ranges of values in the training data on network training and make the network converge quickly the training data is normalized by eq 14 14 i i min i max i min i the information at each time is transferred by lstm through the recurrent unit r suppose the recurrent units at time t ni are r x i and r y i respectively then their output o x and o y can be expressed as 15 o x r x k δ s x 0 t n k v k d k r x k 1 o y r y k δ s y 0 t n k v k d k r y k 1 where r k 1 r k 1 δ s 0 t n k 1 v k 1 d k 1 r k 2 the recurrent units r x i and r y i are composed of the three gates in eqs 1 3 the networks are trained by comparing the differences between the values in longitude and latitude with the outputs of lstms and the mse in eq 16 is used as the loss function 16 m s e y y i 1 n y i y i 2 n where y and y represent the true value and the predicted value of lstm respectively adaptive moment estimation adam which can perform one step optimization on a random function is adopted to optimize the model the number of units in the hidden layer which can remember and store past states is used as a parameter by searching the optimal value in 85 170 255 340 425 when the value is large the complexity of the model increases and it is prone to overfitting but when the value is small the nonlinear fitting ability may be weakened the maximum training epoch is 1500 which is determined to ensure the convergence of network the training would terminate when the error is close to 0 or when the set number of maximum training epoch is reached the choice of recurrent unit number requires a balance between complexity and accuracy of a network a larger value means that the network is more accurate but more complex otherwise the opposite in this study it is set to 15 after a comprehensive analysis of multiple trials the number of steps is set according to the actual demand at the same time there is no direct relationship between the number of steps and the time intervals the time interval between adjacent data points in this paper is set to 1s while it can be set to ns then the predicted time series is n 2 n 30 n 3 2 3 uncertainty analysis the uncertainty of each predicted point is fitted by the uncertainties of the support point and the destination point assuming that the errors between the true and predicted values follow a gaussian distribution the uncertainties can be estimated by the training errors for the destination point the maximum likelihood estimation of the standard deviation of the errors σ ˆ d can be expressed as 17 σ ˆ d 1 n i 1 n e i 2 1 n i 1 n e i 2 where e i denotes the error between the training data and the reference trajectory at each moment and n denotes the length of the training data similarly the uncertainty of the support point is calculated by the difference between the true values and the predicted values of the training data then the maximum likelihood estimation of the standard deviation of the errors σ ˆ s can be expressed as 18 σ ˆ s 1 n i 1 n y i y i 2 1 n i 1 n y i y i 2 since the ship position at the start point is deterministic its uncertainty is zero afterwards the uncertainties can be obtained by linear interpolation of the uncertainties of these three points for a gaussian distribution the 95 confidence interval ci is 2 σ 2 σ therefore the cis of all predicted values can be obtained by the above calculations 4 results and discussion 4 1 data description in order to test the performance of the proposed trajectory prediction algorithm the ais data from ferry ships navigating in the jiangsu section of the yangtze river is used for analysis one of the reasons is that the ferry is crossing the waterway frequently during each voyage it usually performs acceleration and deceleration operations and sometimes with apparent turnings these features are quite suitable for testing the overall performance of the proposed approach under multiple navigation states a sample of 1 000 ais data with equal time length in the navigation state are randomly selected for testing in this paper to visualize the effect of the proposed method four typical trajectories including the straight line stage the turning stage the acceleration stage and the deceleration stage are selected to describe the prediction process and results in detail the latitude and longitude data of the studied water area is present in fig 6 it can be seen that the trajectories of various ships in the same area are closely correlated although there are some differences in specifics from the perspective of ship dynamics the trajectories can be divided into straight line trajectory and turning trajectory from the perspective of speed fluctuation the trajectories can be divided into acceleration trajectory deceleration trajectory and uniform trajectory in general straight line trajectories and uniform trajectories are easier to predict thus the straight one in the four selected trajectories can be treated as a basic line and the acceleration value is very small that is it can also be considered as a uniform trajectory in this paper eq 19 is used to determine the straight trajectory and turning trajectory 19 λ d max l where l refers to the distance between the start and the end point on a trajectory d max refers to the largest distance from any points on the trajectory to the line between the start point and the end point the ratio λ obtained by the eq 19 can describe the trajectory curvature the statistical results for the 1 000 trajectories are shown in fig 7 a according to the analysis 0 03 can be determined as the threshold to discriminate between the straight and turning trajectory in addition the average value of acceleration is counted as shown in fig 7 b in this study only two categories are set up based on acceleration if the average acceleration is larger than 0 it is acceleration trajectory otherwise it is deceleration trajectory for comparison and fairness the length of all the training data and test data are same normally the durations of the turning the acceleration and the deceleration states are short thus the training data of 70s and the test data of 30s are used in this case by considering the duration of different states together in fact the choice of these two values is flexible and is determined by the specific situation the adjacent time interval is 1s 4 2 multi step prediction first cubic spline interpolation is used to make the selected trajectories equally spaced in time then the abnormal data is removed and the ais data is processed according to the approach mentioned in section 3 1 after that the multi step prediction based on the support point the destination point and cubic spline interpolation is performed the detailed steps of the filtering process in the prediction are illustrated through the data processing of the straight line case as shown in fig 8 according to the changes of the historical data in the longitude direction the historical data set in this area contains the data that the ships are navigating in the opposite direction the data of the ships stop on the way as well some types of data that is similar to the data to be predicted besides the ship travel behaviors are influenced by navigation standards ship type water traffic complexity environmental conditions therefore it is necessary to perform a preliminary filtering of the data prior to prediction the four proposed ship motion indicators are used to measure the similarity of different ship trajectory data in the studied area and otsu method is used to calculate the segmentation threshold as shown in fig 9 from fig 9 a it can be seen that the ship direction reflected by the first indicator is clearly displayed when it is consistent with the current trajectory direction the indicator is close to 0 whereas when it is inconsistent it is close to 3 2 10 3 deg this polarization helps filter historical data based on ship course from fig 9 b the second indicator of different trajectories is not clustered but randomly distributed the calculated threshold value is 1 6 10 3 deg if the threshold is exceeded it can be considered that the state of the ship in the historical data is significantly different from that of the current ship besides it can be seen from fig 9 c and fig 9 d that only a few points have been filtered out this is because the data has been filtered by the first two indicators and most of the inconsistent data has been filtered out after this process the data similar to the current trajectory is preserved and the data with great difference is removed then the proposed method is used to predict the trajectories and the results of the four typical ones are shown in figs 10 13 the number of units in the hidden layer is 170 it can be seen from fig 10 a and b that in the straight line navigation stage the prediction of the latitude and longitude displacements per unit time are basically consistent with the true values the prediction results not only have a small error near the starting point of the prediction but also keep about 1 0 10 6 deg at the end of prediction meanwhile it can be seen that the uncertainties of the predicted values are lower before the support point this is because lstm has small training error in learning the data after the support point the uncertainties of the predicted values have a significant increase especially at the end moment this is caused by the generated reference trajectory which is based on historical data and cannot guarantee a high degree of overlap at each moment although the uncertainty is large according to the assumptions in eq 5 an accurate prediction value can be obtained by introducing a historical trajectory even for the location at a moment that is far away from the start point the ship positions shown in fig 10 c and d are calculated from the cumulative equal moment displacements in fig 10 a and b due to the relative large uncertainty of the destination point in the latitudinal direction it has a relatively large ci after the support point fig 10 e is the prediction plot of the ship by combining the mean values of gaussian distribution in fig 10 c and d fig 10 c e shows that the predicted position at each time is almost consistent with the real position the prediction error is used to quantitatively describe the effect of the method as shown in fig 10 f it is noticed that at the moments closer to the starting point the prediction error is relatively small although the error increases afterwards the maximum position error in the latitude and longitude direction is only about 1 0 10 5 deg and it remains within an acceptable range in the turning stage it can be seen from fig 11 a and b that although there is a certain error at the end moment the error symbol of equal moment displacements has changed as a result a smaller accumulative error is achieved as shown in fig 11 c e especially in the fig 11 d it is obvious that the prediction error at the 100 th moment is smaller than that at the 96 th moment besides the prediction accuracy in the longitude direction is higher than that in the latitude direction this is because when the ship is turning in the case its longitude still increases but the latitude switches from increase to decrease in other words the reason for the larger prediction error in the latitude direction is that the ship s navigation status has changed in the turning phase the position error is present in fig 11 f the longitude error reaches 3 4 10 6 deg at the 88 th moment but it approaches 0 at the 94 th moment the latitude error reaches 2 1 10 5 deg at the 96 th moment but only 1 8 10 6 deg at the end which is much smaller than the cumulative error of traditional methods in addition as in the straight line navigation stage the uncertainty also increases after the support point it can be seen from fig 12 that in the accelerated navigation stage the prediction result is significantly better at the early time than at the later time the time range for accurate prediction is longer than that in the deceleration state in fig 13 this is also caused by the change of the navigation motion parameters in the later period it is worth mentioning that in the first 10 moments the average error of the two directions is only 8 6 10 7 deg for the deceleration case since the displacement decreases fast as the ship decelerates and a turning process is accompanied the accurate prediction time range is shorter than the above cases as shown in fig 13 only in the first five moments the prediction error is close to 0 furthermore as can be seen in fig 12 although the predicted destination point deviates from the true destination point and has the largest error its error in both directions is only about 2 0 10 6 deg in fig 13 although the predicted and true values at the end moment are almost identical the error is still the largest this is due to the fact that the position error is the result of the accumulation of the prediction errors of its previous multiple moments this also illustrates that the accuracy of the trajectory prediction of the proposed method is not determined by a single point but the symbol of error which oscillates the prediction error of all points within an acceptable range based on a physical assumption 4 3 comparison of the two interpolation methods in many cases ais data are not equally spaced in time in order to predict the position information of a ship at multiple moments the original data set needs to be interpolated to make it equally spaced in the time dimension making the prediction model easier to implement according to section 3 1 the cubic spline interpolation method is used in this study in order to compare the two methods the results from the two approaches are shown in fig 14 it can be seen that for straight line trajectory the trajectories from the two methods almost coincide for acceleration and deceleration trajectories the deviations are also small and negligible however with respect to the turning trajectory the results from cubic hermite spline method are not smooth at the turning stage once the time interval is short the results from cubic spline interpolation can describe the trajectory much better as shown in fig 14b 4 4 comparative analysis of prediction results in order to demonstrate the effectiveness of the proposed method some other multi step prediction methods are compared in this section lstm s means using the lstm model to directly train the latitude and longitude data and make multi step predictions lstm δs means that the lstm model is used to train and predict the changes in latitude and longitude at each time and then the latitude and longitude are calculated from time to time svr δs and ekf δs are similar to the lstm δs method except that the model used is the svr model and ekf model in order to perform multi step prediction with the above methods it is necessary to continuously predict backward in taking its predicted values as known values therefore it has a significant error accumulation phenomenon ae δs is a multi step prediction method unlike the above methods it is trained by the data before filtering so that the model can be fully trained the commonly used indicators in trajectory prediction fde final displacement error and ade average displacement error are used to measure the quality of the prediction results at the same time in order to measure the prediction effect of the method at early stage the average displacement error ade 10 of the previous 10 moments is used as another measurement indicator the prediction results of each method under different navigation stages are present in figs 15 18 and table 2 in general the prediction accuracies of all methods are ordered as follows mp lstm ae ekf δs lstm δs svr δs lstm s first the multi step prediction methods reflect higher accuracy for example both mp lstm and ae have better results compared with other methods this is mainly due to that there is no error accumulation in the same direction second the kinematic model based ekf method is largely better than lstm δs and svr δs this is determined by the data specifics if the noise in a segment of data is easily predicted the ekf method will exhibit higher prediction accuracy third the prediction results of lstm δs are slightly better than svr δs although the three metrics of prediction errors are almost equal in the straight line phase however the lstm shows superiority in the trajectory prediction of some complex navigation states such as turning and acceleration this is due to the long term memory function of lstm meanwhile for the methods based on equal moment displacements there is a significant distortion at the final moment this is because the prediction error increases sharply with time in addition the multi step method based on position data fails to achieve good results in all four stages this is due to that the method performs multi step prediction without learning historical data which leads to insufficient training beyond that direct multi step prediction also makes the predictions out of the activation function range which results in large distortion the prediction accuracy at the closer moments can be seen from the indicator of ade 10 the results show that the errors are relatively small in the straight line stage and the acceleration stage with 5 32 10 7 deg and 8 61 10 7 deg respectively the prediction error at the later moments can be measured with the other two indicators which are ade and fde for ade the prediction error is also smaller in the straight line and the acceleration status but for fde the prediction error is only small in the straight line status and is similar in the remaining navigation states which is due to the large uncertainty of the ship s turning degree and acceleration to verify the generality of the proposed method all the 1 000 trajectories are trained and tested by the proposed methods the statistical results of them are present in table 3 the characteristics reflected by the four typical trajectories are largely consistent with those reflected by the data set the multi step prediction method especially the proposed mp lstm shows high superiority the ade 10 value of lstm s is significantly higher than other methods and it reaches 7 1746 5 3468 10 4 deg which indicates that the method has a large error at the closer moments in addition the average values of the three indicators of svr δs and lstm s in table 3 are lower than those in table 2 in the turning stage and acceleration stage this is because the ship s motion characteristics are not well learned by the two methods in contrast the proposed mp lstm not only has lower prediction error but also has smaller variance this proves its effectiveness and generality 5 conclusion in order to enhance the performance of ship trajectory prediction for a longer period of time compared with some existing approaches a high precision multi step prediction method combining current trajectory data and historical data is proposed in this paper the key idea is that the multi step predictions are performed by cubic spline interpolation on the start point support point and destination point among them the destination point is generated by historical data to keep the error at a low degree and the support point is generated by a trained lstm model this method can not only realize the high precision prediction of short distance and long distance at the same time but also predict the precise position of each moment which provides more abundant and accurate information for the prediction of ship collision comprehensive evaluation on the case study indicates that the proposed method can achieve higher prediction accuracy than several traditional approaches in the dataset and the four basic navigation states straight line turning acceleration and deceleration and even at the end of the time to be predicted the method can also achieve satisfactory prediction accuracy however this method needs some historical trajectories to achieve accurate prediction in the future work further study can be performed by improving the high precision multi step prediction method when the historical data is lacking credit authorship contribution statement da wei gao conceptualization methodology validation investigation writing original draft yong sheng zhu investigation writing original draft supervision jin fen zhang methodology writing original draft supervision yan kang he investigation writing review editing ke yan supervision visualization bo ran yan visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research is financially supported by national key technologies research development program 2017yfe0118000 2017yfe0118004 national natural science foundation of china 52071247 51920105014 and technical innovation project of hubei province international cooperation 2018ahb003 
20854,ship drag and self propulsion simulations of a twin screw high speed displacement vessel were performed using the unsteady reynolds averaged navier stokes rans method the sliding mesh and overset mesh methods were applied concurrently to simulate the coupling of the propeller rotation and the ship motion the effects of the propeller shaft brackets on the drag propulsion performance wake field and propeller excitation force were studied the influence of the shaft brackets on the wake field was visualized the high numerical accuracy of the proposed simulation method was proven through verification and validation analyses the low speed zones of nominal wake within the propeller disc were mainly caused by vortex shedding from the vicinity of the shaft brackets and the speed reduction of the frictional wake resulting from the velocity stagnation in front of the rudder the tangential wake velocity which was affected by the twist angle and vortex shedding had a considerable effect on the propulsion performance the wake non uniformity coefficient was highly correlated with the vortex shedding the spatial structure of the shaft bracket and the inward curved streamline around the stern aggravated the non uniformity further but the shaft bracket had a limited impact on the unsteady propeller bearing force in the absence of cavitation keywords shaft bracket wake field propulsion performance vortex shedding wake non uniformity nomenclature l pp length between perpendiculars b ship width d ship draft δ displacement v m model velocity fr froude number d propeller diameter z number of blades p d pitch ratio h d hub ratio ρ density f volume force v a axial velocity within the propeller disc v t tangential velocity within the propeller disc y non dimensional wall distance t time step r propeller radius k t thrust coefficient k q torque coefficient n propeller rotation rate u a axial induced velocity u t tangential induced velocity α k attack angle of blade element n s propeller rotation rate at self propulsion point t s thrust at self propulsion point t thrust deduction factor q b torque behind ship at self propulsion point η d propulsion efficiency ω e effective taylor wake fraction η r relative rotation efficiency η i ideal propeller efficiency 1 introduction the propeller shafts of many high speed ships often extend to the outside the ship depending on the arrangement requirements of the stern the shaft bracket is installed between the hull and the outside shaft of the ship to support the propulsion shafting the bracket is usually classified into two types an a bracket with double bracket arms and a p bracket with a single bracket arm as shown in fig 1 as a propulsion shafting reinforcement the shaft bracket bears the weight of the shaft and propeller the unbalanced centrifugal force the forces of inertia and the excitation force induced by the propeller contributing to the prevention of shaft breaking incidents and reducing shafting vibrations this requires the shaft bracket to have a sufficient stiffness and strength under normal and extreme operating conditions although the shaft bracket was originally intended for structural safety it has a significant influence on the ship hydrodynamic performance first as an exposed hull appendage the bracket will inevitably lead to added resistance second the bracket is located at the anterior of the propeller having an immediate effect on the propulsion performance the operating conditions of the propeller which determines the propeller thrust torque and efficiency will be changed by the influence of the bracket on the wake field of the propeller disc moreover the shaft bracket may disturb the flow into propeller causing a non uniform wake field the non uniformity will cause the operating conditions of the propeller to vary in different regions of the propeller disc leading to a periodic force on blade namely the excitation force of the propeller most of the stern vibration problems are caused by the excitation force of the propeller in practice the design of shaft brackets is a complicated task involving issues of the structure weight vibration installation technology and hydrodynamic characteristics jang et al 2009 indicated that the a bracket is more suitable for large sized ships because of the superior strength and stiffness these properties are related to various factors such as the included angle α see fig 1 of the two bracket arms the intersection angle β see fig 1 and the lengths and cross sections of the bracket arms the angles α and β should be determined to ensure that the lateral and vertical stiffnesses are adequate and avoid large increases in the bending moment losee 1957 moreover the bracket is usually bent to reduce the bracket weight and bending moment the bent bracket can also be inserted vertically into the hull to connect with the strong frame structures simplifying the installation process in addition an arc transition should be adopted at the bend to prevent stress concentration the width and area of the cross section of the bracket arm should be determined based on the strength requirements ccs 2015 when the shaft bracket is studied to determine its effect on the hydrodynamic performance the two main objects are the attack angle and the section profile as the other parameters are mainly determined based on the stiffness and strength requirements the consideration of the hydrodynamic performance will not be given priority the earliest resistance tests of brackets were carried out by lackenby 1954 and the bracket resistance was measured at model and full scales lap 1957 studied the impact of the attack angle of the bracket on the ship resistance and the propulsion performance and the scale effect of the appendages was analyzed in these early studies the influence of brackets on the wake field was not within the scope zhou and hua 1990 2003 pioneered the studies of the influence of brackets proposing a bracket optimization method to reduce the bracket resistance and improve the nominal wake field within the propeller disc their results achieved a considerable propulsion performance boost in full scale experiments hackett and jonk 1999 indicated that high wake occurred between the bracket arms which may have caused propeller cavitation and vibrations and they made some suggestions to avoid these cheng et al 2001 applied a uniform design method to optimize the twist angle of the shaft brackets and an energy saving effect was achieved wang et al 2012 studied the effect of the shaft bracket on the ship s viscous resistance as well as the nominal wake and he suggested that the shaft bracket should be installed along the free stream to improve the hydrodynamic performance li 2019 suggested that the attack angle of the brackets should be determined by the streamlines in front of the shaft bracket to reduce the bracket drag for the research of the wake field and propulsion performance numerical simulations became the main methodology after the mid 20th century in the early stage the main calculation methods were based on potential flow theory hess and smith 1962 1964 gadd 1978 first proposed a new method considering viscous effects with the gradual maturing of multiphase flow theory some studies on the wake field that included the influence of the free surface and the scale effect have also been published tsai and yue 1996 abdel 2000 lee et al 2001 wang et al 2015 sun et al 2020 the wake field within the propeller disc was also studied in several studies shakeel et al 2020 morteza and hamid 2020 in recent years aiming to determine the effect of the wake field on the propulsion performance some self propulsion numerical simulations were performed employing the body force method kawamura et al 1997 moctar 2001 or the fully resolved method muscari and di mascio 2011 the latter is more costly but it can obtain more details of the wake field hence it has been more widely used with the improvement of the computing power some numerical studies on single screw ships castro et al 2011 twin screw ships muscari et al 2017 guo et al 2018 and multi screw ships zong et al 2017 sun et al 2019 were conducted based on the fully resolved method the interaction between the propeller and the rudder and the difference of the wake fields between the inside and outside propellers of multi screw ships were covered in these studies the propeller excitation force is also an important element of ship self propulsion numerical research which is the primary cause of stern vibrations in the 26th international towing tank conference the specialist committee on computational fluid dynamics 2011 explained the engineering applications of computational fluid dynamics cfd technology in detail they suggested that cfd can satisfy the engineering requirements of propeller excitation force calculations after this some numerical predictions abbas et al 2015 zou et al 2020 of the propeller unsteady force based on the unsteady reynolds averaged navier stokes urans method were performed and the results were in good agreement with the test data in summary the numerical methods to calculate the propulsion performance wake field and propeller excitation forces are relatively mature the previous results were in good agreement with the test data however the existing studies on the propeller shaft bracket were mainly performed by the numerical simulations in the absence of a propeller focusing on the resistance and nominal wake the propulsion factor and excitation force of the propeller have been rarely studied the studies related to the mechanism of the interactions between the nominal wake effective wake propulsion factors and propeller excitation force have not been published yet the interaction process is important for improving the propeller efficiency and reducing stern vibrations thus it is necessary to study the interaction mechanism in this study the viscous flow of a high speed displacement vessel with and without propellers in different shaft bracket schemes were simulated using the urans method the different bracket schemes varied in attack angle and section profile the overset and sliding mesh methods were employed simultaneously to couple the heave and pitch with the propeller rotation the results of the simulation were verified and validated based on the ittc recommended procedures the drag nominal and effective wake fields propulsion factors and propeller excitation forces of different shaft bracket schemes were obtained by the simulations the relationships between these quantities were analyzed the effect of the shaft bracket on the wake field was visualized to demonstrate the influence mechanism of the shaft bracket on the quantities the remainder of this paper is organized as follows section 2 provides the descriptions of the high speed displacement ship and the shaft bracket the flow solver and numerical method are presented in section 3 verification and validation examples are given in section 4 results are discussed in section 5 the conclusions drawn from this research are summarized in section 6 2 model description the ship model in this research was a twin screw high speed displacement vessel and the propulsion shafting with a shaft brackets was adopted in this ship the propeller model was the b4 55 model and the propellers were external rotors the ship model with appendages is shown in fig 2 the main parameters of the ship and propellers are shown in table 1 based on the literature review in section 1 the shaft bracket used in the ship model was a complex spatial structure due to the angles α and β and the arc transition at the bend shown in fig 1 therefore the flow around the shaft bracket was very complicated and different regions of the bracket arm needed to be studied separately based on the attack angle the complex shaped bracket arm can be divided into three parts the bottom section the top section and the arc transition shown in fig 3 the part from the top of the arm to 0 134 m above the baseline was the top section which was perpendicular to the baseline the part from the bottom of the arm to 0 093 m above baseline was the bottom section and the angle between baseline and the bottom section was 45 the part between the top section and the bottom section was the arc transition which was one eighth of a circle with a 1 m radius the ends of this part were tangent to the parts mentioned above all three parts were inclined 15 relative to the bow because of the complexity of the shape the three parts had different attack angles the top section was basically installed along the streamline so the attack angle was about 0 the attack angle of the bottom section was 14 456 as a result of the tortuosity of the bracket arm the attack angle of the arc transition increased from 0 to 14 456 with the increase in the underwater depth fig 4 shows three characteristic cross sections of the three parts for simplicity the twist angle of the whole bracket arm of this prototype was defined as 0 the change of the twist angle was realized by rotating the shaft bracket around an axis fig 5 illustrates the axis and sign of the twist angle the twist angle had important influence on the direction of streamlines as shown in fig 6 the outer bracket arm of the smaller twist angle and the inner bracket arm of the larger twist angle were favorable for the inward curved flow which can change wake velocity and propulsion efficiency to indicate the local circumferential position of the measuring point for the wake velocity an angle ϕ named wake measurement angle was introduced shown in fig 7 two types of section profiles were adopted in this study the symmetric naca 0018 airfoil and the naca 2418 airfoil with a high ratio of lift to drag as shown in fig 8 the high lift to drag ratio of the naca 2418 airfoil had the same area and moment of inertia as the original naca 0018 airfoil preventing the reduction of the structural strengths of the brackets the initial shaft bracket with naca 0018 airfoil section was named bracket 0018 for convenience and the other type was named bracket 2418 3 mathematical and numerical method 3 1 numerical model the urans equations discretized by the finite volume method were used to simulate viscous flow around the ship with and without a propeller the flow solver was star ccm the reynolds averaged mass and momentum conservation equations for an incompressible flow are as follows 1 u i x i 0 2 ρ u i t ρ x j u i u j p x i x j μ u i x j ρ u i u j ρ f i i j 1 2 3 where u i and u j are the time averaged velocities p is the time averaged pressure and ρ u i u j is the reynolds stress term which creates a mathematical closure issue of these equations the sst k ω turbulence model menter 1994 was introduced to achieve closure the transport equation of the turbulence kinetic energy k and the dissipation rate ω are as follows 3 ρ k t ρ u j k x j τ i j u i x j β ρ k ω x j μ σ k μ t k x j 4 ρ ω t ρ u j ω x j γ ν t τ i j u i x j β ρ ω 2 x j μ σ ω μ t ω x j 2 ρ 1 f 1 σ ω 2 1 ω k x j ω x j the eddy viscosity coefficient μ t was defined as follows 5 μ t ρ a 1 k max a 1 ω ω f 2 the details of the other terms are shown elsewhere menter 1994 the sst k ω model is widely applied in engineering computations because of the satisfactory prediction accuracy in both the near wall and far field regions the second order upwind scheme was adopted for the spatial discretization a second order temporal discretization using the solution from the current and previous two time levels in a backward difference formulation was employed for the unsteady term the free surface was captured by the volume of fluids vof method hirt and nichols 1981 the convective term of the governing equation was discretized using the high resolution interface capture hric scheme muzaferija and peric 1999 to approximate the large spatial variations of the phase volume fractions the heave and pitch of the hull were simulated by the dynamic fluid body interaction dfbi method ohmori 1998 3 2 computational domain and discretization grid the computational domain and boundary conditions are illustrated in fig 9 only half the hull was included in the calculations based on the symmetry of the ship model a symmetric boundary was set at the center plane of the hull the computational domain consisted of three regions a stationary region called the virtual tank and two moving regions the overset region and the propeller region not included in the drag simulation which moved with the ship a high resolution overset mesh was bound to the ship model and translated with the model in the overset region to avoid the errors caused by mesh deformation the sliding mesh method was used concurrently in the propeller region to simulate the propeller rotation coupled with the ship motion the meshes were trimmed cell meshes and the meshes of the drag simulation are shown in fig 10 to improve the resolution of the flow features local mesh refinements were applied in the areas of the kelvin wake bow stern and appendages an anisotropic refinement in the normal direction of the free surface area was adopted to capture the interface between the water and the air to avoid the use of too many grid cells the clustering of grid cells in the near wall region was a prism layer grid to simulate the flow separation in the vicinity of the shaft bracket 16 layers of the prism grids with a 1 1 growth ratio were generated on the shaft bracket resulting in a y value of approximately 1 hence the low reynolds number approach can be used to resolve the boundary without modeling beyond the assumption of laminar flow the prism layers and growth ratio of the hull and other appendages were 10 and 1 2 respectively a wall function using algebraic relations was employed in these areas where flow separation was not evident or had little influence on the wake field of the propeller disc to obtain the wake field details within the disc the mesh near the area was also refined as shown in fig 11 the mesh topologies and refinement for the hull and appendages in self propulsion simulation were basically the same as those in the drag simulation the meshes in the propeller region especially at the leading and trailing edges were refined to capture the flow features as illustrated in fig 12 a low reynolds number method of the wall treatment was employed to simulate the flow separation on the blades to reduce the error of the data exchange between different regions the mesh between the propeller region and external fluid domain was set to be normal to the interface 4 result verification and validation to estimate the numerical and modelling uncertainty of the simulations described above solution verification and validation analyses were conducted 4 1 solution verification the numerical uncertainty is a consequence of discretization iteration and round off errors the latter two errors were assumed to be negligible compared with the discretization error resulting from the double precision and four orders of magnitude of the residual drop in the simulation thus the numerical uncertainties dominated by the contribution of the discretization error were obtained through convergence studies ittc 2008 for unsteady flow simulations discretization errors were decomposed into contributions from the grid size δ g spatial discretization and the time step δ t temporal discretization which gives the following expression 6 u s n 2 u g 2 u t 2 where u sn is the simulation numerical uncertainty and u g and u t are the grid size and time step uncertainties respectively three sets of meshes in the same topologies and three time steps in mesh2 were applied in the estimation of u sn the mesh refinement ratio was 2 which was determined based on the ittc recommended procedures mesh details of the self propulsion simulation are listed in table 2 the results are shown in table 3 the convergence ratio is be defined as follows to evaluate the convergence conditions 7 r i ε 21 ε 32 where ε 21 and ε 32 are the changes between the medium fine and coarse medium meshes respectively the grid and time step uncertainty estimation based on the approach presented by wilson et al were as follows 2004 8 u g t 9 6 1 c 2 1 1 δ 1 c 0 125 2 1 c 1 δ 1 c 0 125 where 9 δ ε 21 r p 1 c i r p 1 r p i e s t 1 here p iest is an estimate for the limiting order r is the refinement ratio and p is the order of accuracy defined as follows 10 p ln ε 32 ε 21 ln r the values of the above parameters used in this verification exercise are listed in table 4 and table 5 all the values of r are between 0 and 1 and thus the solution procedure converged monotonically 4 2 solution validation drag and self propulsion tests were conducted at the wuhan university of technology the test scenario is shown in fig 13 the modelling uncertainty u v which was assessed through validation exercise was defined as follows 11 u v 2 u d 2 u s n 2 where u d is the test uncertainty 1 and u sn is calculated by eq 6 the related parameters in the validation exercise are shown in table 6 e is the comparison error given by the difference between the test data d t and simulation values s it can be seen that e u v which indicated that the combination of all the errors in the model test and simulation were smaller than u v therefore the solution was validated at the u v level mesh2 and time step2 were selected for the following numerical computations the computed and experimental results are listed in table 7 5 results and discussion the drag and propulsion performance wake field and the relationships between them for the different shaft bracket schemes were compared in detail the influences of the attack angle and the section profile of the shaft bracket were analyzed 5 1 added resistance induced by shaft bracket in this section the calculation results of the resistance induced by the shaft bracket are presented and analyzed for different attack angles and section profiles of the shaft bracket fig 14 shows the resistance of bracket 0018 at different twist angles the trends of different parts varied which was ascribed to differences of the attack angle the resistance of the top section of the outer and inner bracket arm both obtained minimum values at a 0 twist angle where they were arranged along the free stream when the attack angle deviated from 0 the resistance increased the resistance of the bottom sections of the inner and outer shaft bracket decreased with the increase in the twist angle because their attack angle was about 14 5 when the twist angle was 0 as shown in fig 4 the increases in the twist angle diminished the real attack angle causing the brackets to be more closely aligned with the streamline when the twist angle was less than 0 an evident vortex was generated in this area as shown in fig 15 the resistance of the arc transition showed a trend of first increasing and then decreasing the attack angle of this part varied with depth ranging from 7 to 14 when the twist angle was 0 the change of the local attack angle with the twist angle was not uniform in this part this was the reason for the trends of the resistance of the arc transition for the total resistance the value of the outer and inner brackets both increased first and then decreased due to the difference of the attack angle of the different parts the twist angle of the minimum resistance should take the three parts into account the resistance of bracket 2418 is shown in fig 16 the overall trend of the resistance was basically the same as that of bracket 0018 but exact values were different the naca 2418 is a high lift to drag ratio airfoil with a 2 relative camber ratio and the lift generated by the airfoil is more advantageous for providing additional thrust at a proper attack angle the resistance values of the bottom section at some attack angles were negative indicating that additional thrust was generated however the total resistance of the bracket arm was positive because the twist angle of the three parts cannot be in the range where the additional thrust was generated simultaneously nevertheless the bracket 2418 still exhibited a better drag performance than bracket 0018 reducing the bracket resistance by 52 9 at the optimal twist angle compared with the prototype bracket 0018 0 twist angle the value for bracket 0018 was 44 7 5 2 nominal wake distribution within the propeller disc the effects of the shaft bracket on the nominal wake field of the propeller disc were studied the hydrodynamic mechanism of the effect was analyzed based on the simulation results the mean velocity v wr values of the nominal wake at different radii of the propeller disc were determined by a line average as follows 12 v w r r 0 2 π v w r r ϕ r d ϕ 2 π r where r is the local radius of the propeller disc v wr is the local wake velocity and ϕ is the wake measurement angle shown in fig 7 the mean velocity v w in the propeller disc was calculated by integrating the velocity on a volumetric basis of the form 13 v w r h u b r 0 2 π v w r r ϕ r d r d ϕ π r 2 r h u b 2 where r hub is the radius of the propeller hub to quantify the relationship between the attack angle wake field and propulsion performance the spearman rank order correlation coefficient r s was used to describe the degree to which one variable affects another 14 r s i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where the x and y are the quantities of interest in this study due to the influence of the interactions between the inner and outer bracket arms on the propulsion performance they needed to be coupled when the self propulsion simulation was conducted thus the number of shaft bracket schemes was the product of the number of twist angles of the inner and outer bracket arms moreover the self propulsion simulation required a larger computational effort because of the complexity of the coupling of the propeller rotation with the ship motion as well as the greater number of grid cells thus fewer twist angles 5 0 5 and 10 of the shaft bracket were chosen in the self propulsion simulation leading to sixteen bracket schemes the bracket arm twist angles of the schemes and graphs of the mean axial component v a and tangential component v t of wake velocity at different radii within the propeller disc of the sixteen schemes are listed in table 8 out denotes the outer arm twist angle and in denotes the inner arm twist angle for simplicity out in were used to indicate the twist angles of a bracket scheme in the remainder of this article the definition of the twist angles is shown in fig 5 the contours of axial and tangential components within propeller disc are shown in table 9 the sixteen schemes in tables 8 and 9 are divided into four parts marked off from each other with red lines corresponding four conditions which will be discussed subsequently in table 9 the axial components v a of brackets 0018 and 2418 and the tangential components v t of brackets 0018 and 2418 are shown in the top left top right bottom left and bottom right respectively the counterclockwise direction was positive for the tangential components as determined by the coordinate system the outer bracket arm was in front of the left side of the propeller disc the inner bracket was in front of the right side as shown in the graphs in table 8 the mean axial components of brackets 0018 and 2418 increased with increasing radius following similar trends predominantly resulting from the frictional wake field of the propeller shaft the axial component contours in table 9 shows that the axial velocity close to propeller shaft was a minimum and increased away from the shaft depending on the characteristics of the frictional wake field the low speed high taylor wake fraction zones were mainly behind the shaft bracket predominantly determined by the twist angle when the attack angle was too large the bracket arm induced significant flow separation the vortex shedding from the separation region brought about a low speed zone within the propeller disc when flow separation was not evident the velocity of the corresponding area within the propeller disc was higher which was mainly determined by the frictional wake of the shaft and shaft bracket the rudder behind the propeller disc also influenced the wake field which resulted from the velocity stagnation near the leading edge of the rudder under the influence of the contributing factors mentioned above and their interactions the wake field within the propeller disc can be roughly categorized into four conditions shown in tables 8 and 9 fig 17 shows the axial wake velocities of a horizontal plane at 0 077m above the baseline of the four conditions and main characteristics of the conditions in fig 17 were summarized as follows condition i both the inner and outer bracket arms were at an attack angle without significant flow separation the area with velocities less than 1 9 m s was small and mainly concentrated in the vicinity of the shaft as shown in the 4 schemes at the bottom left of table 9 under the influence of frictional wake under this condition the overall velocity was relatively high and the low speed zones only occurred behind the shaft bracket in the wake measurement angle ranges of 60 75 and 105 120 as shown in fig 19 a condition ii in condition ⅰ the flow separation was not evident but the velocity stagnation near the rudder was located downstream of the frictional wake of the bracket and shaft the velocity stagnation reduced the velocity of the frictional wake further creating a low speed zone of the propeller disc as shown in the 5 schemes at the bottom right of table 9 even without evident vertex shedding under this condition the low speed zone occurred not only behind the shaft bracket but also in front of the rudder in the wake measurement angle range of 75 105 shown in fig 19 b condition iii the vortex shedding occurred in the vicinity of one bracket arm and the velocity stagnation deviated downstream of the frictional wake the low speed zone was mainly located at one side of the propeller disc as shown in the 3 schemes at the top left of table 9 fig 18 shows the vortex structure of this condition based on the q criterion hunt et al 1988 the vortex was transported from the bottom of the shaft bracket to the propeller disc causing the low speed zone the wake measurement angle range of the low speed zone was 15 30 as shown in fig 19 c condition iv in condition ⅲ the velocity stagnation affected the frictional wake of another bracket arm and shaft another smaller low speed region occurred on the other side of the propeller disc in the wake measurement angle range of 90 105 shown in the 4 schemes at the top right of table 9 and fig 19 d for the complex shaped shaft bracket the attack angle varied with depth and hence the axial velocity within the propeller disc also varied with radius the attack angle of the bottom section was always larger than those of other parts thus the low speed zone was mainly concentrated in the vicinity of the shaft in addition flow separation did not occur on the outer arm in most cases this was a result from the streamline around the stern as shown in fig 20 inward curved streamlines always decreased the real attack angle of the outer arm in most schemes see fig 6 bringing about the better hydrodynamic performance although the attack angle of the top section possibly increased the vortex shedding from there had little influence on the wake field within the propeller disc due to the geometric relationship shown in fig 3 in engineering applications the quantity of interest is the mean velocity of the whole propeller disc which is shown in fig 21 the mean axial velocity of the whole disc varied little 3 maximum variation magnitude between the shaft bracket schemes the overall trends of the two airfoil sections were basically same both of which has the first minimum and second minimum values in scheme 7 5 5 and scheme 4 0 5 respectively the schemes with smaller mean axial velocities basically had evident vortex shedding generally the velocity of bracket 2418 was higher demonstrating that the twist angles selected in the simulation were more advantageous for avoiding flow separation for this section profile as for the tangential components basically the velocity on the left side of the propeller disc was negative clockwise and that of the right side was positive counterclockwise this distribution occurred principally because the propeller disc was not perpendicular to the incoming flow the inflow velocity had a component parallel to the propeller disc as shown in fig 22 the area did not conform to the distribution described above and was mainly brought about by the vortex shedding from the shaft bracket which hindered the upward flow in the propeller disc to some extent changing the velocity there black circle in fig 22 the mean tangential velocity within the whole disc was also influenced by the extent to which the shaft brackets changed the direction of the streamline as shown in fig 6 the capability of generating flow diversion can be expressed by the difference between the twist angle of the inner and outer arms denoted by δ io this kind of flow diversion in the upper half of the propeller disc was advantageous for achieving a negative mean tangential velocity fig 23 shows the mean tangential velocity within the whole disc and δ io of the 16 schemes the values of δ io between the two adjacent dashed lines were equal the spearman rank order correlation coefficient r s between δ io and v t of the bracket 0018 and 2418 airfoils were 0 697 and 0 887 respectively and the confidence levels of the r s values were beyond 99 indicating statistically significant correlations this showed that a negative correlation existed between v t and δ io for schemes 4 0 5 and 7 5 5 of bracket 2418 and schemes 2 5 5 4 0 5 7 5 5 and 8 0 0 of bracket 0018 that did not conform to this inverse relationship the low speed zone is evident in the axial component contours see table 9 the vortex shedding decreased the velocity and affected the inverse relationship bracket 2418 had a higher value of r s resulting from the reduced vortex shedding in summary the distributions of the axial and tangential velocities were closely related to the flow separation in the shaft bracket area the inner bracket arm and bracket 0018 were prone to flow separation because of the twist angle and streamlines around the stern 5 3 propulsion performance analysis the effect of the shaft bracket on the propulsion performance was studied by self propulsion and open water propeller simulations where the propeller was fully resolved the hydrodynamic mechanism of the effect was analyzed based on the numerical results the velocity of the effective wake was obtained through thrust identity method using the thrust of a self propulsion simulation the corresponding wake velocity was determined by the propeller open water characteristics the tangential and radial components of the wake were taken as apparent axial component into account all the propellers in self propulsion simulations were external rotating and the influence of the propeller turning direction was not eliminated in the self propulsion simulation the ship was under the action of the propeller thrust the resistance and a towing force when the towing force was equal to the friction resistance correction value frc the corresponding propeller rotation rate was the rate at the self propulsion point the frc value resulted from the absence of the reynolds identity in the model test and it is calculated as follows 15 f r c r m t r s t λ 3 where r st and r mt are the full scale and model scale ship friction resistances respectively and λ is the scale ratio after the correction the relationship of the model scale results f m and full scale results f s can be expressed as follows 16 f m f s λ 3 fig 24 shows the thrust and the torque coefficient of the 16 schemes where the rotation rate was 2000 rpm the upward trends with fluctuations of the thrust coefficient were basically the same between brackets 0018 and 2418 but the latter had smaller values these were mainly determined by the tangential velocity fig 25 shows the velocity distribution of the blade element based on the relationship between these velocity vectors the counter propeller flow could reduce the induced tangential velocity increasing the attack angle α k the increases in the attack angle within a certain range enabled the blade element to generate more thrust fig 26 shows the differences between advance coefficients denoted by δj obtained from axial wake velocity and the thrust identity method as well as the dimensionless tangential velocity v t 2πnr there was an evident inverse correlation between them which indicated that the tangential velocity played an important role in the propulsion performance in this paper the negative tangential velocity having the opposite direction to that of the propeller rotation acted as counter propeller flow leading to a negative linear relationship the smaller values of bracket 2418 resulted from the larger tangential velocity in the self propulsion simulations the propeller rotation accelerated the wake velocity which differed from that of the drag simulations fig 27 shows the acceleration of the propellers an evident high speed zone occurred behind the propeller region and the structure of the vortex shedding from the shaft bracket was destroyed by the acceleration the total wake velocity of self propulsion simulations consists of the effective velocity and the propeller induced velocity and the former is composed of interaction velocity and nominal velocity fig 28 shows the effective wake fraction ω e and nominal axial wake fraction ω n of the two airfoil sections and their difference ω e ω n the value of ω n was generally higher than that of ω e but they showed similar trends the value of ω e ω n was correlated with the interaction velocity and the thrust identity method where the tangential wake velocity was considered as apparent axial component the causes of the interaction velocity were complicated and involved many factors including changes of the streamline direction the thickness of the boundary layer and the wave patterns induced by the operating propeller for the thrust identity method it attributed the thrust changes only to the axial velocity thus the obtained effective wake velocity was different from the real axial wake velocity fig 28 b shows the variation of the differences ω e ω n with the tangential velocity generally the differences increased with the increase in the tangential velocity the interaction velocity led to deviations from the trend line in some schemes the differences between the nominal and the effective wake fraction of bracket 0018 with larger tangential components were higher indicating a greater influence of the absence of the tangential components when the effective wake was determined fig 29 shows the thrust deduction factor t which was determined by the ship resistance and propeller thrust scheme 3 10 0 6 10 5 10 10 10 13 5 10 and 15 0 10 with larger values of t had smaller thrust values as shown in fig 24 demonstrating the important role of thrust in the determination of the thrust deduction factor however the bracket 2418 schemes with smaller thrust coefficients generally had smaller thrust deduction factors because of the better resistance performances of these schemes details in section 5 1 fig 30 presents the relative rotation efficiency η r it is the ratio of the propeller torque in the open water to that behind the hull when the propeller generated the same thrust in the two different operating conditions the tangential components in the two operating conditions were different causing the torques to be unequal even if the same thrusts were generated indeed η r can also be influenced by the non uniformity of the wake field behind the hull the average wake velocity obtained through the thrust identity method was an approximation of the real wake velocity fig 31 presents the variations of the relative rotation efficiency with the tangential velocity showing a positive correlation between them the increase in the tangential velocity resulted in a smaller η r the non uniform wake velocity obscured this relationship to some extent and the influence of the wake non uniformity was basically random the influence on the bracket 0018 schemes was greater because the larger area of the low speed zone within propeller disc aggravated the wake non uniformity fig 32 shows the rotation rate n s at the self propulsion point due to the constant friction resistance in each scheme the towing force was also constant thus the self propulsion rotation rate was completely determined by the pressure resistance and the propeller thrust the scheme with a lower value basically corresponded to the larger propeller thrust shown in fig 24 the thrust values of the bracket 0018 schemes were larger but the pressure resistance was also larger hence the value of n s was basically the same as that of bracket 2418 the propulsion efficiency η d is presented in fig 33 which was calculated as follows 17 η d r m f r c v m 2 π n s q b where r m is the model scale ship resistance the propulsion efficiency η d represents the power to propel the ship in proportion to the power delivered to the propeller it can be analyzed qualitatively through the theory of ideal propellers the ideal propeller efficiency can be expressed as follows 18 η i v a v a u a 2 ω r u t 2 ω r the decrease in u t can reduce the energy loss in the wake increasing the propulsion efficiency the tangential velocity is negatively correlated with the tangential induced velocity u t therefore the correlation between the propulsion efficiency and tangential velocity should be negative the results in fig 33 are in agreement with the above analysis scheme 1 10 5 3 10 0 6 10 5 9 5 5 and 10 10 10 with lower propulsion efficiencies also had higher tangential velocities see fig 23 the influence of the axial velocity was not evident because the axial velocity changed little between the different schemes the delivered power p db is shown in fig 34 this was defined as follows 19 p d b 2 π n s q b the delivered power p db at the design speed is an important index to measure the propulsion performance it was determined by the propulsion efficiency and the ship drag scheme 3 10 0 6 10 5 10 10 10 and 13 5 10 with larger delivered power also had smaller propulsion efficiencies the bracket 2418 schemes had smaller values than those of the bracket 0018 schemes based on the wake distribution shown in table 9 the shaft bracket 2418 had less vortex shedding for the twist angles selected in this paper bringing about better inflow of the propeller disc the additional thrust provided by the lift also effectively reduced the shaft strut resistance therefore it had a considerable energy saving effect compared with the original bracket scheme 0 0 scheme 16 5 10 of bracket 2418 reduced the required engine power by 4 there is still great potential for optimization of the shaft bracket because only a small number of twist angles were selected in the self propulsion simulation 5 4 wake non uniformity and propeller excitation force the nominal wake non uniformity and the excitation force of the propeller were quantified and their relationships with the shaft bracket were analyzed to quantify the wake non uniformity the non uniformity coefficient w δ was introduced the coefficient w δ at each radius r is defined as follows 20 w δ r 0 2 π v w r r ϕ v w r r r d ϕ 2 π r v w r r where v wr is calculated by eq 12 the non uniformity coefficient w δ within the whole propeller disc is given as follows 21 w δ r h u b r 0 2 π v w r r ϕ v w r d r d ϕ π r 2 r h u b 2 v w where the v w was calculated by eq 13 fig 35 a shows the wake non uniformity coefficient w δ within the whole propeller and w δ at 0 7r for the axial velocity the values of w δ were all less than 0 1 corresponding to high velocity uniformity the schemes with the peak values all had large low speed zones resulting from the vortex shedding as shown in table 9 the different attack angles of the inner and outer bracket arms caused by the streamline around stern fig 20 and the complex geometry of the bracket brought about the different vortex shedding conditions of different parts of the shaft bracket aggravating the non uniformity further the non uniformity coefficient within the whole propeller disc was greater than that at 0 7r because the low speed zone caused by the vortex shedding and frictional wake were primarily within 0 7r fig 36 shows the trends of the non uniformity coefficient w δ at different radii generally the value of non uniformity declined with the radius moreover the non uniformity coefficient of shaft bracket 0018 was larger than that of shaft bracket 2418 indicating that there were fewer low speed zones for the latter the non uniformity coefficients of the tangential velocity are shown in fig 35 b the values were more than two orders of magnitude higher than the axial non uniformity however the tangential non uniformity coefficient may not necessarily realistically reflect the wake uniformity of the tangential velocity because the average tangential velocity was close to 0 see fig 23 the coefficient often depends on the magnitude of the average velocity the propeller excitation force consists of the propeller bearing force and the hull surface force the bearing force which arises from the unsteady force generated by the propeller affects the shafting vibration significantly the hull surface force is mainly caused by cavitation on the blades the shaft bracket is designed for the safety of the shafting and hence the quantity of interest is the bearing force to estimate the amplitude of the bearing force the frequency domain curves of the unsteady propeller forces were obtained using the fast fourier transform fft two amplitudes c fo and c mo considering variations of the thrust and forces leading to bending moments acting on propeller shafts respectively were adopted as the evaluation criteria they are defined as follows 22 c f o i 1 3 i c t h i 2 23 c m o i 1 3 i c v e r i 2 i 1 3 i c h o r i 2 where c th i is the peak value of thrust at i times of blade passing frequency bpf of frequency domain curves c ver i and c hor i are the peak values of vertical and horizontal propeller forces respectively the two amplitudes are shown in fig 37 the values of both the amplitudes did not vary significantly between the schemes and they had no evident correlation with the axial and tangential non uniformity coefficients this showed that the influence of the shaft bracket on the bearing force was limited in the absence of cavitation the time domain curves of thrust coefficient are shown in fig 38 the schemes selected were scheme 8 0 0 of bracket 0018 prototype and scheme 16 5 10 of bracket 2418 the latter had the best propulsion performance although the magnitudes of the thrust coefficient were different their fluctuation periods and amplitudes were uniform fig 39 shows the frequency domain curves of the thrust coefficient the peak values of the different schemes at 1 2 and 3 times the bpf were basically the same which also indicated the limited effect of the shaft bracket on the unsteady propeller bearing force 6 conclusions to study the mechanism of the effects of propeller shaft brackets on the wake field drag and propulsion performance as well as propeller excitation force numerical researches were conducted based on a rans solver with overset and sliding mesh methods the conclusions can be summarized as follows 1 the verification and validation analyses proved that the numerical method used in this paper is reasonable for predicting the hydrodynamic performance of a high speed ship 2 compared with bracket 0018 bracket 2418 exhibited better drag performance added thrust was generated in its bottom section resulting from the lift of the bracket 3 the low speed zone within the propeller disc was mainly caused by the vortex shedding from the vicinity of the shaft bracket and the influences of the velocity stagnation in front of the rudder on the frictional wake the outer bracket arm exhibited a better hydrodynamic performance because of the shape of the bracket and the flow direction around stern 4 the axial wake velocity varied little between the different twist angles and the section profile however the twist angle affected the tangential wake velocity significantly due to the changes of the streamlines and vortex shedding 5 the tangential velocity played an important role in the propulsion performance the thrust and torque coefficient the difference between the effective and nominal wake fraction the relative rotation efficiency and the propulsion were highly correlated with the tangential wake velocity 6 generally the bracket 2418 schemes exhibited better propulsion performances the optimal scheme in this paper can reduce the required engine power by 4 at the design speed 7 the axial wake non uniformity showed a high correlation with the vortex shedding the spatial structure of the shaft bracket and the inward curved streamline around the stern aggravated it the quantification of the tangential wake non uniformity was not satisfactory resulting from the absolute value being close to 0 moreover the wake non uniformity had a limited impact on the unsteady propeller bearing force in the absence of cavitation credit authorship contribution statement lianzheng cui investigation methodology software formal analysis writing original draft zuogang chen conceptualization writing review editing resources supervision jiangtao qin resources writing review editing lilan zhou validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors appreciate the academic support from the national natural science foundation of china grant no 51609189 
20854,ship drag and self propulsion simulations of a twin screw high speed displacement vessel were performed using the unsteady reynolds averaged navier stokes rans method the sliding mesh and overset mesh methods were applied concurrently to simulate the coupling of the propeller rotation and the ship motion the effects of the propeller shaft brackets on the drag propulsion performance wake field and propeller excitation force were studied the influence of the shaft brackets on the wake field was visualized the high numerical accuracy of the proposed simulation method was proven through verification and validation analyses the low speed zones of nominal wake within the propeller disc were mainly caused by vortex shedding from the vicinity of the shaft brackets and the speed reduction of the frictional wake resulting from the velocity stagnation in front of the rudder the tangential wake velocity which was affected by the twist angle and vortex shedding had a considerable effect on the propulsion performance the wake non uniformity coefficient was highly correlated with the vortex shedding the spatial structure of the shaft bracket and the inward curved streamline around the stern aggravated the non uniformity further but the shaft bracket had a limited impact on the unsteady propeller bearing force in the absence of cavitation keywords shaft bracket wake field propulsion performance vortex shedding wake non uniformity nomenclature l pp length between perpendiculars b ship width d ship draft δ displacement v m model velocity fr froude number d propeller diameter z number of blades p d pitch ratio h d hub ratio ρ density f volume force v a axial velocity within the propeller disc v t tangential velocity within the propeller disc y non dimensional wall distance t time step r propeller radius k t thrust coefficient k q torque coefficient n propeller rotation rate u a axial induced velocity u t tangential induced velocity α k attack angle of blade element n s propeller rotation rate at self propulsion point t s thrust at self propulsion point t thrust deduction factor q b torque behind ship at self propulsion point η d propulsion efficiency ω e effective taylor wake fraction η r relative rotation efficiency η i ideal propeller efficiency 1 introduction the propeller shafts of many high speed ships often extend to the outside the ship depending on the arrangement requirements of the stern the shaft bracket is installed between the hull and the outside shaft of the ship to support the propulsion shafting the bracket is usually classified into two types an a bracket with double bracket arms and a p bracket with a single bracket arm as shown in fig 1 as a propulsion shafting reinforcement the shaft bracket bears the weight of the shaft and propeller the unbalanced centrifugal force the forces of inertia and the excitation force induced by the propeller contributing to the prevention of shaft breaking incidents and reducing shafting vibrations this requires the shaft bracket to have a sufficient stiffness and strength under normal and extreme operating conditions although the shaft bracket was originally intended for structural safety it has a significant influence on the ship hydrodynamic performance first as an exposed hull appendage the bracket will inevitably lead to added resistance second the bracket is located at the anterior of the propeller having an immediate effect on the propulsion performance the operating conditions of the propeller which determines the propeller thrust torque and efficiency will be changed by the influence of the bracket on the wake field of the propeller disc moreover the shaft bracket may disturb the flow into propeller causing a non uniform wake field the non uniformity will cause the operating conditions of the propeller to vary in different regions of the propeller disc leading to a periodic force on blade namely the excitation force of the propeller most of the stern vibration problems are caused by the excitation force of the propeller in practice the design of shaft brackets is a complicated task involving issues of the structure weight vibration installation technology and hydrodynamic characteristics jang et al 2009 indicated that the a bracket is more suitable for large sized ships because of the superior strength and stiffness these properties are related to various factors such as the included angle α see fig 1 of the two bracket arms the intersection angle β see fig 1 and the lengths and cross sections of the bracket arms the angles α and β should be determined to ensure that the lateral and vertical stiffnesses are adequate and avoid large increases in the bending moment losee 1957 moreover the bracket is usually bent to reduce the bracket weight and bending moment the bent bracket can also be inserted vertically into the hull to connect with the strong frame structures simplifying the installation process in addition an arc transition should be adopted at the bend to prevent stress concentration the width and area of the cross section of the bracket arm should be determined based on the strength requirements ccs 2015 when the shaft bracket is studied to determine its effect on the hydrodynamic performance the two main objects are the attack angle and the section profile as the other parameters are mainly determined based on the stiffness and strength requirements the consideration of the hydrodynamic performance will not be given priority the earliest resistance tests of brackets were carried out by lackenby 1954 and the bracket resistance was measured at model and full scales lap 1957 studied the impact of the attack angle of the bracket on the ship resistance and the propulsion performance and the scale effect of the appendages was analyzed in these early studies the influence of brackets on the wake field was not within the scope zhou and hua 1990 2003 pioneered the studies of the influence of brackets proposing a bracket optimization method to reduce the bracket resistance and improve the nominal wake field within the propeller disc their results achieved a considerable propulsion performance boost in full scale experiments hackett and jonk 1999 indicated that high wake occurred between the bracket arms which may have caused propeller cavitation and vibrations and they made some suggestions to avoid these cheng et al 2001 applied a uniform design method to optimize the twist angle of the shaft brackets and an energy saving effect was achieved wang et al 2012 studied the effect of the shaft bracket on the ship s viscous resistance as well as the nominal wake and he suggested that the shaft bracket should be installed along the free stream to improve the hydrodynamic performance li 2019 suggested that the attack angle of the brackets should be determined by the streamlines in front of the shaft bracket to reduce the bracket drag for the research of the wake field and propulsion performance numerical simulations became the main methodology after the mid 20th century in the early stage the main calculation methods were based on potential flow theory hess and smith 1962 1964 gadd 1978 first proposed a new method considering viscous effects with the gradual maturing of multiphase flow theory some studies on the wake field that included the influence of the free surface and the scale effect have also been published tsai and yue 1996 abdel 2000 lee et al 2001 wang et al 2015 sun et al 2020 the wake field within the propeller disc was also studied in several studies shakeel et al 2020 morteza and hamid 2020 in recent years aiming to determine the effect of the wake field on the propulsion performance some self propulsion numerical simulations were performed employing the body force method kawamura et al 1997 moctar 2001 or the fully resolved method muscari and di mascio 2011 the latter is more costly but it can obtain more details of the wake field hence it has been more widely used with the improvement of the computing power some numerical studies on single screw ships castro et al 2011 twin screw ships muscari et al 2017 guo et al 2018 and multi screw ships zong et al 2017 sun et al 2019 were conducted based on the fully resolved method the interaction between the propeller and the rudder and the difference of the wake fields between the inside and outside propellers of multi screw ships were covered in these studies the propeller excitation force is also an important element of ship self propulsion numerical research which is the primary cause of stern vibrations in the 26th international towing tank conference the specialist committee on computational fluid dynamics 2011 explained the engineering applications of computational fluid dynamics cfd technology in detail they suggested that cfd can satisfy the engineering requirements of propeller excitation force calculations after this some numerical predictions abbas et al 2015 zou et al 2020 of the propeller unsteady force based on the unsteady reynolds averaged navier stokes urans method were performed and the results were in good agreement with the test data in summary the numerical methods to calculate the propulsion performance wake field and propeller excitation forces are relatively mature the previous results were in good agreement with the test data however the existing studies on the propeller shaft bracket were mainly performed by the numerical simulations in the absence of a propeller focusing on the resistance and nominal wake the propulsion factor and excitation force of the propeller have been rarely studied the studies related to the mechanism of the interactions between the nominal wake effective wake propulsion factors and propeller excitation force have not been published yet the interaction process is important for improving the propeller efficiency and reducing stern vibrations thus it is necessary to study the interaction mechanism in this study the viscous flow of a high speed displacement vessel with and without propellers in different shaft bracket schemes were simulated using the urans method the different bracket schemes varied in attack angle and section profile the overset and sliding mesh methods were employed simultaneously to couple the heave and pitch with the propeller rotation the results of the simulation were verified and validated based on the ittc recommended procedures the drag nominal and effective wake fields propulsion factors and propeller excitation forces of different shaft bracket schemes were obtained by the simulations the relationships between these quantities were analyzed the effect of the shaft bracket on the wake field was visualized to demonstrate the influence mechanism of the shaft bracket on the quantities the remainder of this paper is organized as follows section 2 provides the descriptions of the high speed displacement ship and the shaft bracket the flow solver and numerical method are presented in section 3 verification and validation examples are given in section 4 results are discussed in section 5 the conclusions drawn from this research are summarized in section 6 2 model description the ship model in this research was a twin screw high speed displacement vessel and the propulsion shafting with a shaft brackets was adopted in this ship the propeller model was the b4 55 model and the propellers were external rotors the ship model with appendages is shown in fig 2 the main parameters of the ship and propellers are shown in table 1 based on the literature review in section 1 the shaft bracket used in the ship model was a complex spatial structure due to the angles α and β and the arc transition at the bend shown in fig 1 therefore the flow around the shaft bracket was very complicated and different regions of the bracket arm needed to be studied separately based on the attack angle the complex shaped bracket arm can be divided into three parts the bottom section the top section and the arc transition shown in fig 3 the part from the top of the arm to 0 134 m above the baseline was the top section which was perpendicular to the baseline the part from the bottom of the arm to 0 093 m above baseline was the bottom section and the angle between baseline and the bottom section was 45 the part between the top section and the bottom section was the arc transition which was one eighth of a circle with a 1 m radius the ends of this part were tangent to the parts mentioned above all three parts were inclined 15 relative to the bow because of the complexity of the shape the three parts had different attack angles the top section was basically installed along the streamline so the attack angle was about 0 the attack angle of the bottom section was 14 456 as a result of the tortuosity of the bracket arm the attack angle of the arc transition increased from 0 to 14 456 with the increase in the underwater depth fig 4 shows three characteristic cross sections of the three parts for simplicity the twist angle of the whole bracket arm of this prototype was defined as 0 the change of the twist angle was realized by rotating the shaft bracket around an axis fig 5 illustrates the axis and sign of the twist angle the twist angle had important influence on the direction of streamlines as shown in fig 6 the outer bracket arm of the smaller twist angle and the inner bracket arm of the larger twist angle were favorable for the inward curved flow which can change wake velocity and propulsion efficiency to indicate the local circumferential position of the measuring point for the wake velocity an angle ϕ named wake measurement angle was introduced shown in fig 7 two types of section profiles were adopted in this study the symmetric naca 0018 airfoil and the naca 2418 airfoil with a high ratio of lift to drag as shown in fig 8 the high lift to drag ratio of the naca 2418 airfoil had the same area and moment of inertia as the original naca 0018 airfoil preventing the reduction of the structural strengths of the brackets the initial shaft bracket with naca 0018 airfoil section was named bracket 0018 for convenience and the other type was named bracket 2418 3 mathematical and numerical method 3 1 numerical model the urans equations discretized by the finite volume method were used to simulate viscous flow around the ship with and without a propeller the flow solver was star ccm the reynolds averaged mass and momentum conservation equations for an incompressible flow are as follows 1 u i x i 0 2 ρ u i t ρ x j u i u j p x i x j μ u i x j ρ u i u j ρ f i i j 1 2 3 where u i and u j are the time averaged velocities p is the time averaged pressure and ρ u i u j is the reynolds stress term which creates a mathematical closure issue of these equations the sst k ω turbulence model menter 1994 was introduced to achieve closure the transport equation of the turbulence kinetic energy k and the dissipation rate ω are as follows 3 ρ k t ρ u j k x j τ i j u i x j β ρ k ω x j μ σ k μ t k x j 4 ρ ω t ρ u j ω x j γ ν t τ i j u i x j β ρ ω 2 x j μ σ ω μ t ω x j 2 ρ 1 f 1 σ ω 2 1 ω k x j ω x j the eddy viscosity coefficient μ t was defined as follows 5 μ t ρ a 1 k max a 1 ω ω f 2 the details of the other terms are shown elsewhere menter 1994 the sst k ω model is widely applied in engineering computations because of the satisfactory prediction accuracy in both the near wall and far field regions the second order upwind scheme was adopted for the spatial discretization a second order temporal discretization using the solution from the current and previous two time levels in a backward difference formulation was employed for the unsteady term the free surface was captured by the volume of fluids vof method hirt and nichols 1981 the convective term of the governing equation was discretized using the high resolution interface capture hric scheme muzaferija and peric 1999 to approximate the large spatial variations of the phase volume fractions the heave and pitch of the hull were simulated by the dynamic fluid body interaction dfbi method ohmori 1998 3 2 computational domain and discretization grid the computational domain and boundary conditions are illustrated in fig 9 only half the hull was included in the calculations based on the symmetry of the ship model a symmetric boundary was set at the center plane of the hull the computational domain consisted of three regions a stationary region called the virtual tank and two moving regions the overset region and the propeller region not included in the drag simulation which moved with the ship a high resolution overset mesh was bound to the ship model and translated with the model in the overset region to avoid the errors caused by mesh deformation the sliding mesh method was used concurrently in the propeller region to simulate the propeller rotation coupled with the ship motion the meshes were trimmed cell meshes and the meshes of the drag simulation are shown in fig 10 to improve the resolution of the flow features local mesh refinements were applied in the areas of the kelvin wake bow stern and appendages an anisotropic refinement in the normal direction of the free surface area was adopted to capture the interface between the water and the air to avoid the use of too many grid cells the clustering of grid cells in the near wall region was a prism layer grid to simulate the flow separation in the vicinity of the shaft bracket 16 layers of the prism grids with a 1 1 growth ratio were generated on the shaft bracket resulting in a y value of approximately 1 hence the low reynolds number approach can be used to resolve the boundary without modeling beyond the assumption of laminar flow the prism layers and growth ratio of the hull and other appendages were 10 and 1 2 respectively a wall function using algebraic relations was employed in these areas where flow separation was not evident or had little influence on the wake field of the propeller disc to obtain the wake field details within the disc the mesh near the area was also refined as shown in fig 11 the mesh topologies and refinement for the hull and appendages in self propulsion simulation were basically the same as those in the drag simulation the meshes in the propeller region especially at the leading and trailing edges were refined to capture the flow features as illustrated in fig 12 a low reynolds number method of the wall treatment was employed to simulate the flow separation on the blades to reduce the error of the data exchange between different regions the mesh between the propeller region and external fluid domain was set to be normal to the interface 4 result verification and validation to estimate the numerical and modelling uncertainty of the simulations described above solution verification and validation analyses were conducted 4 1 solution verification the numerical uncertainty is a consequence of discretization iteration and round off errors the latter two errors were assumed to be negligible compared with the discretization error resulting from the double precision and four orders of magnitude of the residual drop in the simulation thus the numerical uncertainties dominated by the contribution of the discretization error were obtained through convergence studies ittc 2008 for unsteady flow simulations discretization errors were decomposed into contributions from the grid size δ g spatial discretization and the time step δ t temporal discretization which gives the following expression 6 u s n 2 u g 2 u t 2 where u sn is the simulation numerical uncertainty and u g and u t are the grid size and time step uncertainties respectively three sets of meshes in the same topologies and three time steps in mesh2 were applied in the estimation of u sn the mesh refinement ratio was 2 which was determined based on the ittc recommended procedures mesh details of the self propulsion simulation are listed in table 2 the results are shown in table 3 the convergence ratio is be defined as follows to evaluate the convergence conditions 7 r i ε 21 ε 32 where ε 21 and ε 32 are the changes between the medium fine and coarse medium meshes respectively the grid and time step uncertainty estimation based on the approach presented by wilson et al were as follows 2004 8 u g t 9 6 1 c 2 1 1 δ 1 c 0 125 2 1 c 1 δ 1 c 0 125 where 9 δ ε 21 r p 1 c i r p 1 r p i e s t 1 here p iest is an estimate for the limiting order r is the refinement ratio and p is the order of accuracy defined as follows 10 p ln ε 32 ε 21 ln r the values of the above parameters used in this verification exercise are listed in table 4 and table 5 all the values of r are between 0 and 1 and thus the solution procedure converged monotonically 4 2 solution validation drag and self propulsion tests were conducted at the wuhan university of technology the test scenario is shown in fig 13 the modelling uncertainty u v which was assessed through validation exercise was defined as follows 11 u v 2 u d 2 u s n 2 where u d is the test uncertainty 1 and u sn is calculated by eq 6 the related parameters in the validation exercise are shown in table 6 e is the comparison error given by the difference between the test data d t and simulation values s it can be seen that e u v which indicated that the combination of all the errors in the model test and simulation were smaller than u v therefore the solution was validated at the u v level mesh2 and time step2 were selected for the following numerical computations the computed and experimental results are listed in table 7 5 results and discussion the drag and propulsion performance wake field and the relationships between them for the different shaft bracket schemes were compared in detail the influences of the attack angle and the section profile of the shaft bracket were analyzed 5 1 added resistance induced by shaft bracket in this section the calculation results of the resistance induced by the shaft bracket are presented and analyzed for different attack angles and section profiles of the shaft bracket fig 14 shows the resistance of bracket 0018 at different twist angles the trends of different parts varied which was ascribed to differences of the attack angle the resistance of the top section of the outer and inner bracket arm both obtained minimum values at a 0 twist angle where they were arranged along the free stream when the attack angle deviated from 0 the resistance increased the resistance of the bottom sections of the inner and outer shaft bracket decreased with the increase in the twist angle because their attack angle was about 14 5 when the twist angle was 0 as shown in fig 4 the increases in the twist angle diminished the real attack angle causing the brackets to be more closely aligned with the streamline when the twist angle was less than 0 an evident vortex was generated in this area as shown in fig 15 the resistance of the arc transition showed a trend of first increasing and then decreasing the attack angle of this part varied with depth ranging from 7 to 14 when the twist angle was 0 the change of the local attack angle with the twist angle was not uniform in this part this was the reason for the trends of the resistance of the arc transition for the total resistance the value of the outer and inner brackets both increased first and then decreased due to the difference of the attack angle of the different parts the twist angle of the minimum resistance should take the three parts into account the resistance of bracket 2418 is shown in fig 16 the overall trend of the resistance was basically the same as that of bracket 0018 but exact values were different the naca 2418 is a high lift to drag ratio airfoil with a 2 relative camber ratio and the lift generated by the airfoil is more advantageous for providing additional thrust at a proper attack angle the resistance values of the bottom section at some attack angles were negative indicating that additional thrust was generated however the total resistance of the bracket arm was positive because the twist angle of the three parts cannot be in the range where the additional thrust was generated simultaneously nevertheless the bracket 2418 still exhibited a better drag performance than bracket 0018 reducing the bracket resistance by 52 9 at the optimal twist angle compared with the prototype bracket 0018 0 twist angle the value for bracket 0018 was 44 7 5 2 nominal wake distribution within the propeller disc the effects of the shaft bracket on the nominal wake field of the propeller disc were studied the hydrodynamic mechanism of the effect was analyzed based on the simulation results the mean velocity v wr values of the nominal wake at different radii of the propeller disc were determined by a line average as follows 12 v w r r 0 2 π v w r r ϕ r d ϕ 2 π r where r is the local radius of the propeller disc v wr is the local wake velocity and ϕ is the wake measurement angle shown in fig 7 the mean velocity v w in the propeller disc was calculated by integrating the velocity on a volumetric basis of the form 13 v w r h u b r 0 2 π v w r r ϕ r d r d ϕ π r 2 r h u b 2 where r hub is the radius of the propeller hub to quantify the relationship between the attack angle wake field and propulsion performance the spearman rank order correlation coefficient r s was used to describe the degree to which one variable affects another 14 r s i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 where the x and y are the quantities of interest in this study due to the influence of the interactions between the inner and outer bracket arms on the propulsion performance they needed to be coupled when the self propulsion simulation was conducted thus the number of shaft bracket schemes was the product of the number of twist angles of the inner and outer bracket arms moreover the self propulsion simulation required a larger computational effort because of the complexity of the coupling of the propeller rotation with the ship motion as well as the greater number of grid cells thus fewer twist angles 5 0 5 and 10 of the shaft bracket were chosen in the self propulsion simulation leading to sixteen bracket schemes the bracket arm twist angles of the schemes and graphs of the mean axial component v a and tangential component v t of wake velocity at different radii within the propeller disc of the sixteen schemes are listed in table 8 out denotes the outer arm twist angle and in denotes the inner arm twist angle for simplicity out in were used to indicate the twist angles of a bracket scheme in the remainder of this article the definition of the twist angles is shown in fig 5 the contours of axial and tangential components within propeller disc are shown in table 9 the sixteen schemes in tables 8 and 9 are divided into four parts marked off from each other with red lines corresponding four conditions which will be discussed subsequently in table 9 the axial components v a of brackets 0018 and 2418 and the tangential components v t of brackets 0018 and 2418 are shown in the top left top right bottom left and bottom right respectively the counterclockwise direction was positive for the tangential components as determined by the coordinate system the outer bracket arm was in front of the left side of the propeller disc the inner bracket was in front of the right side as shown in the graphs in table 8 the mean axial components of brackets 0018 and 2418 increased with increasing radius following similar trends predominantly resulting from the frictional wake field of the propeller shaft the axial component contours in table 9 shows that the axial velocity close to propeller shaft was a minimum and increased away from the shaft depending on the characteristics of the frictional wake field the low speed high taylor wake fraction zones were mainly behind the shaft bracket predominantly determined by the twist angle when the attack angle was too large the bracket arm induced significant flow separation the vortex shedding from the separation region brought about a low speed zone within the propeller disc when flow separation was not evident the velocity of the corresponding area within the propeller disc was higher which was mainly determined by the frictional wake of the shaft and shaft bracket the rudder behind the propeller disc also influenced the wake field which resulted from the velocity stagnation near the leading edge of the rudder under the influence of the contributing factors mentioned above and their interactions the wake field within the propeller disc can be roughly categorized into four conditions shown in tables 8 and 9 fig 17 shows the axial wake velocities of a horizontal plane at 0 077m above the baseline of the four conditions and main characteristics of the conditions in fig 17 were summarized as follows condition i both the inner and outer bracket arms were at an attack angle without significant flow separation the area with velocities less than 1 9 m s was small and mainly concentrated in the vicinity of the shaft as shown in the 4 schemes at the bottom left of table 9 under the influence of frictional wake under this condition the overall velocity was relatively high and the low speed zones only occurred behind the shaft bracket in the wake measurement angle ranges of 60 75 and 105 120 as shown in fig 19 a condition ii in condition ⅰ the flow separation was not evident but the velocity stagnation near the rudder was located downstream of the frictional wake of the bracket and shaft the velocity stagnation reduced the velocity of the frictional wake further creating a low speed zone of the propeller disc as shown in the 5 schemes at the bottom right of table 9 even without evident vertex shedding under this condition the low speed zone occurred not only behind the shaft bracket but also in front of the rudder in the wake measurement angle range of 75 105 shown in fig 19 b condition iii the vortex shedding occurred in the vicinity of one bracket arm and the velocity stagnation deviated downstream of the frictional wake the low speed zone was mainly located at one side of the propeller disc as shown in the 3 schemes at the top left of table 9 fig 18 shows the vortex structure of this condition based on the q criterion hunt et al 1988 the vortex was transported from the bottom of the shaft bracket to the propeller disc causing the low speed zone the wake measurement angle range of the low speed zone was 15 30 as shown in fig 19 c condition iv in condition ⅲ the velocity stagnation affected the frictional wake of another bracket arm and shaft another smaller low speed region occurred on the other side of the propeller disc in the wake measurement angle range of 90 105 shown in the 4 schemes at the top right of table 9 and fig 19 d for the complex shaped shaft bracket the attack angle varied with depth and hence the axial velocity within the propeller disc also varied with radius the attack angle of the bottom section was always larger than those of other parts thus the low speed zone was mainly concentrated in the vicinity of the shaft in addition flow separation did not occur on the outer arm in most cases this was a result from the streamline around the stern as shown in fig 20 inward curved streamlines always decreased the real attack angle of the outer arm in most schemes see fig 6 bringing about the better hydrodynamic performance although the attack angle of the top section possibly increased the vortex shedding from there had little influence on the wake field within the propeller disc due to the geometric relationship shown in fig 3 in engineering applications the quantity of interest is the mean velocity of the whole propeller disc which is shown in fig 21 the mean axial velocity of the whole disc varied little 3 maximum variation magnitude between the shaft bracket schemes the overall trends of the two airfoil sections were basically same both of which has the first minimum and second minimum values in scheme 7 5 5 and scheme 4 0 5 respectively the schemes with smaller mean axial velocities basically had evident vortex shedding generally the velocity of bracket 2418 was higher demonstrating that the twist angles selected in the simulation were more advantageous for avoiding flow separation for this section profile as for the tangential components basically the velocity on the left side of the propeller disc was negative clockwise and that of the right side was positive counterclockwise this distribution occurred principally because the propeller disc was not perpendicular to the incoming flow the inflow velocity had a component parallel to the propeller disc as shown in fig 22 the area did not conform to the distribution described above and was mainly brought about by the vortex shedding from the shaft bracket which hindered the upward flow in the propeller disc to some extent changing the velocity there black circle in fig 22 the mean tangential velocity within the whole disc was also influenced by the extent to which the shaft brackets changed the direction of the streamline as shown in fig 6 the capability of generating flow diversion can be expressed by the difference between the twist angle of the inner and outer arms denoted by δ io this kind of flow diversion in the upper half of the propeller disc was advantageous for achieving a negative mean tangential velocity fig 23 shows the mean tangential velocity within the whole disc and δ io of the 16 schemes the values of δ io between the two adjacent dashed lines were equal the spearman rank order correlation coefficient r s between δ io and v t of the bracket 0018 and 2418 airfoils were 0 697 and 0 887 respectively and the confidence levels of the r s values were beyond 99 indicating statistically significant correlations this showed that a negative correlation existed between v t and δ io for schemes 4 0 5 and 7 5 5 of bracket 2418 and schemes 2 5 5 4 0 5 7 5 5 and 8 0 0 of bracket 0018 that did not conform to this inverse relationship the low speed zone is evident in the axial component contours see table 9 the vortex shedding decreased the velocity and affected the inverse relationship bracket 2418 had a higher value of r s resulting from the reduced vortex shedding in summary the distributions of the axial and tangential velocities were closely related to the flow separation in the shaft bracket area the inner bracket arm and bracket 0018 were prone to flow separation because of the twist angle and streamlines around the stern 5 3 propulsion performance analysis the effect of the shaft bracket on the propulsion performance was studied by self propulsion and open water propeller simulations where the propeller was fully resolved the hydrodynamic mechanism of the effect was analyzed based on the numerical results the velocity of the effective wake was obtained through thrust identity method using the thrust of a self propulsion simulation the corresponding wake velocity was determined by the propeller open water characteristics the tangential and radial components of the wake were taken as apparent axial component into account all the propellers in self propulsion simulations were external rotating and the influence of the propeller turning direction was not eliminated in the self propulsion simulation the ship was under the action of the propeller thrust the resistance and a towing force when the towing force was equal to the friction resistance correction value frc the corresponding propeller rotation rate was the rate at the self propulsion point the frc value resulted from the absence of the reynolds identity in the model test and it is calculated as follows 15 f r c r m t r s t λ 3 where r st and r mt are the full scale and model scale ship friction resistances respectively and λ is the scale ratio after the correction the relationship of the model scale results f m and full scale results f s can be expressed as follows 16 f m f s λ 3 fig 24 shows the thrust and the torque coefficient of the 16 schemes where the rotation rate was 2000 rpm the upward trends with fluctuations of the thrust coefficient were basically the same between brackets 0018 and 2418 but the latter had smaller values these were mainly determined by the tangential velocity fig 25 shows the velocity distribution of the blade element based on the relationship between these velocity vectors the counter propeller flow could reduce the induced tangential velocity increasing the attack angle α k the increases in the attack angle within a certain range enabled the blade element to generate more thrust fig 26 shows the differences between advance coefficients denoted by δj obtained from axial wake velocity and the thrust identity method as well as the dimensionless tangential velocity v t 2πnr there was an evident inverse correlation between them which indicated that the tangential velocity played an important role in the propulsion performance in this paper the negative tangential velocity having the opposite direction to that of the propeller rotation acted as counter propeller flow leading to a negative linear relationship the smaller values of bracket 2418 resulted from the larger tangential velocity in the self propulsion simulations the propeller rotation accelerated the wake velocity which differed from that of the drag simulations fig 27 shows the acceleration of the propellers an evident high speed zone occurred behind the propeller region and the structure of the vortex shedding from the shaft bracket was destroyed by the acceleration the total wake velocity of self propulsion simulations consists of the effective velocity and the propeller induced velocity and the former is composed of interaction velocity and nominal velocity fig 28 shows the effective wake fraction ω e and nominal axial wake fraction ω n of the two airfoil sections and their difference ω e ω n the value of ω n was generally higher than that of ω e but they showed similar trends the value of ω e ω n was correlated with the interaction velocity and the thrust identity method where the tangential wake velocity was considered as apparent axial component the causes of the interaction velocity were complicated and involved many factors including changes of the streamline direction the thickness of the boundary layer and the wave patterns induced by the operating propeller for the thrust identity method it attributed the thrust changes only to the axial velocity thus the obtained effective wake velocity was different from the real axial wake velocity fig 28 b shows the variation of the differences ω e ω n with the tangential velocity generally the differences increased with the increase in the tangential velocity the interaction velocity led to deviations from the trend line in some schemes the differences between the nominal and the effective wake fraction of bracket 0018 with larger tangential components were higher indicating a greater influence of the absence of the tangential components when the effective wake was determined fig 29 shows the thrust deduction factor t which was determined by the ship resistance and propeller thrust scheme 3 10 0 6 10 5 10 10 10 13 5 10 and 15 0 10 with larger values of t had smaller thrust values as shown in fig 24 demonstrating the important role of thrust in the determination of the thrust deduction factor however the bracket 2418 schemes with smaller thrust coefficients generally had smaller thrust deduction factors because of the better resistance performances of these schemes details in section 5 1 fig 30 presents the relative rotation efficiency η r it is the ratio of the propeller torque in the open water to that behind the hull when the propeller generated the same thrust in the two different operating conditions the tangential components in the two operating conditions were different causing the torques to be unequal even if the same thrusts were generated indeed η r can also be influenced by the non uniformity of the wake field behind the hull the average wake velocity obtained through the thrust identity method was an approximation of the real wake velocity fig 31 presents the variations of the relative rotation efficiency with the tangential velocity showing a positive correlation between them the increase in the tangential velocity resulted in a smaller η r the non uniform wake velocity obscured this relationship to some extent and the influence of the wake non uniformity was basically random the influence on the bracket 0018 schemes was greater because the larger area of the low speed zone within propeller disc aggravated the wake non uniformity fig 32 shows the rotation rate n s at the self propulsion point due to the constant friction resistance in each scheme the towing force was also constant thus the self propulsion rotation rate was completely determined by the pressure resistance and the propeller thrust the scheme with a lower value basically corresponded to the larger propeller thrust shown in fig 24 the thrust values of the bracket 0018 schemes were larger but the pressure resistance was also larger hence the value of n s was basically the same as that of bracket 2418 the propulsion efficiency η d is presented in fig 33 which was calculated as follows 17 η d r m f r c v m 2 π n s q b where r m is the model scale ship resistance the propulsion efficiency η d represents the power to propel the ship in proportion to the power delivered to the propeller it can be analyzed qualitatively through the theory of ideal propellers the ideal propeller efficiency can be expressed as follows 18 η i v a v a u a 2 ω r u t 2 ω r the decrease in u t can reduce the energy loss in the wake increasing the propulsion efficiency the tangential velocity is negatively correlated with the tangential induced velocity u t therefore the correlation between the propulsion efficiency and tangential velocity should be negative the results in fig 33 are in agreement with the above analysis scheme 1 10 5 3 10 0 6 10 5 9 5 5 and 10 10 10 with lower propulsion efficiencies also had higher tangential velocities see fig 23 the influence of the axial velocity was not evident because the axial velocity changed little between the different schemes the delivered power p db is shown in fig 34 this was defined as follows 19 p d b 2 π n s q b the delivered power p db at the design speed is an important index to measure the propulsion performance it was determined by the propulsion efficiency and the ship drag scheme 3 10 0 6 10 5 10 10 10 and 13 5 10 with larger delivered power also had smaller propulsion efficiencies the bracket 2418 schemes had smaller values than those of the bracket 0018 schemes based on the wake distribution shown in table 9 the shaft bracket 2418 had less vortex shedding for the twist angles selected in this paper bringing about better inflow of the propeller disc the additional thrust provided by the lift also effectively reduced the shaft strut resistance therefore it had a considerable energy saving effect compared with the original bracket scheme 0 0 scheme 16 5 10 of bracket 2418 reduced the required engine power by 4 there is still great potential for optimization of the shaft bracket because only a small number of twist angles were selected in the self propulsion simulation 5 4 wake non uniformity and propeller excitation force the nominal wake non uniformity and the excitation force of the propeller were quantified and their relationships with the shaft bracket were analyzed to quantify the wake non uniformity the non uniformity coefficient w δ was introduced the coefficient w δ at each radius r is defined as follows 20 w δ r 0 2 π v w r r ϕ v w r r r d ϕ 2 π r v w r r where v wr is calculated by eq 12 the non uniformity coefficient w δ within the whole propeller disc is given as follows 21 w δ r h u b r 0 2 π v w r r ϕ v w r d r d ϕ π r 2 r h u b 2 v w where the v w was calculated by eq 13 fig 35 a shows the wake non uniformity coefficient w δ within the whole propeller and w δ at 0 7r for the axial velocity the values of w δ were all less than 0 1 corresponding to high velocity uniformity the schemes with the peak values all had large low speed zones resulting from the vortex shedding as shown in table 9 the different attack angles of the inner and outer bracket arms caused by the streamline around stern fig 20 and the complex geometry of the bracket brought about the different vortex shedding conditions of different parts of the shaft bracket aggravating the non uniformity further the non uniformity coefficient within the whole propeller disc was greater than that at 0 7r because the low speed zone caused by the vortex shedding and frictional wake were primarily within 0 7r fig 36 shows the trends of the non uniformity coefficient w δ at different radii generally the value of non uniformity declined with the radius moreover the non uniformity coefficient of shaft bracket 0018 was larger than that of shaft bracket 2418 indicating that there were fewer low speed zones for the latter the non uniformity coefficients of the tangential velocity are shown in fig 35 b the values were more than two orders of magnitude higher than the axial non uniformity however the tangential non uniformity coefficient may not necessarily realistically reflect the wake uniformity of the tangential velocity because the average tangential velocity was close to 0 see fig 23 the coefficient often depends on the magnitude of the average velocity the propeller excitation force consists of the propeller bearing force and the hull surface force the bearing force which arises from the unsteady force generated by the propeller affects the shafting vibration significantly the hull surface force is mainly caused by cavitation on the blades the shaft bracket is designed for the safety of the shafting and hence the quantity of interest is the bearing force to estimate the amplitude of the bearing force the frequency domain curves of the unsteady propeller forces were obtained using the fast fourier transform fft two amplitudes c fo and c mo considering variations of the thrust and forces leading to bending moments acting on propeller shafts respectively were adopted as the evaluation criteria they are defined as follows 22 c f o i 1 3 i c t h i 2 23 c m o i 1 3 i c v e r i 2 i 1 3 i c h o r i 2 where c th i is the peak value of thrust at i times of blade passing frequency bpf of frequency domain curves c ver i and c hor i are the peak values of vertical and horizontal propeller forces respectively the two amplitudes are shown in fig 37 the values of both the amplitudes did not vary significantly between the schemes and they had no evident correlation with the axial and tangential non uniformity coefficients this showed that the influence of the shaft bracket on the bearing force was limited in the absence of cavitation the time domain curves of thrust coefficient are shown in fig 38 the schemes selected were scheme 8 0 0 of bracket 0018 prototype and scheme 16 5 10 of bracket 2418 the latter had the best propulsion performance although the magnitudes of the thrust coefficient were different their fluctuation periods and amplitudes were uniform fig 39 shows the frequency domain curves of the thrust coefficient the peak values of the different schemes at 1 2 and 3 times the bpf were basically the same which also indicated the limited effect of the shaft bracket on the unsteady propeller bearing force 6 conclusions to study the mechanism of the effects of propeller shaft brackets on the wake field drag and propulsion performance as well as propeller excitation force numerical researches were conducted based on a rans solver with overset and sliding mesh methods the conclusions can be summarized as follows 1 the verification and validation analyses proved that the numerical method used in this paper is reasonable for predicting the hydrodynamic performance of a high speed ship 2 compared with bracket 0018 bracket 2418 exhibited better drag performance added thrust was generated in its bottom section resulting from the lift of the bracket 3 the low speed zone within the propeller disc was mainly caused by the vortex shedding from the vicinity of the shaft bracket and the influences of the velocity stagnation in front of the rudder on the frictional wake the outer bracket arm exhibited a better hydrodynamic performance because of the shape of the bracket and the flow direction around stern 4 the axial wake velocity varied little between the different twist angles and the section profile however the twist angle affected the tangential wake velocity significantly due to the changes of the streamlines and vortex shedding 5 the tangential velocity played an important role in the propulsion performance the thrust and torque coefficient the difference between the effective and nominal wake fraction the relative rotation efficiency and the propulsion were highly correlated with the tangential wake velocity 6 generally the bracket 2418 schemes exhibited better propulsion performances the optimal scheme in this paper can reduce the required engine power by 4 at the design speed 7 the axial wake non uniformity showed a high correlation with the vortex shedding the spatial structure of the shaft bracket and the inward curved streamline around the stern aggravated it the quantification of the tangential wake non uniformity was not satisfactory resulting from the absolute value being close to 0 moreover the wake non uniformity had a limited impact on the unsteady propeller bearing force in the absence of cavitation credit authorship contribution statement lianzheng cui investigation methodology software formal analysis writing original draft zuogang chen conceptualization writing review editing resources supervision jiangtao qin resources writing review editing lilan zhou validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors appreciate the academic support from the national natural science foundation of china grant no 51609189 
