index,text
790,x ray tomography has opened a window into the invisible world of pore structure in rocks using tomography images as input pore network models try to use a simple geometric representation to acquire a detailed description of the pore volume algorithms developed so far to extract the pore network from tomography images are primarily focused on calculating petrophysical properties of the rock sample the present study is concerned with extracting a pore network that enables us to elicit information about structural properties and features of the rock sample however there is no quantifiable definition of what a pore is and deciding how to divide the pore volume into discrete pores is vague and arbitrary fuzzy logic is an extension of classical logic that can accommodate situations where the nature of problem itself is vague we have developed an algorithm to extract the pore structure and quantify the pore properties from tomography images of rocks in the algorithm a fuzzy logic based inference engine is used to assess the quality of pores extracted by watershed segmentation and modify them if needed we have also designed a fingerprinting plot based on the information content of the network to quantify performance of the algorithm results show that the algorithm is able to link the overall structure of the porous space to the final network and produce reliable results for rocks with a variety of pore structures keywords pore network model percolation fuzzy logic tomography porous media information entropy 1 introduction it is not surprising to see different terms and quantities for what a pore is in the porous media literature in percolation theory a porous medium is modeled as a lattice of bonds pore throats that connect sites pores on the lattice in the microscale chatzis et al 1977 at macroscale different capillary pressure measurement techniques have been used to estimate pore size distribution in the rock samples mishra et al 1988 parameters such as pore and pore throat size distribution and pore coordination number are essential for many upscaling seetha et al 2017 and percolation ding et al 2015 methods and ironically there is no prior definition of what exactly a pore is luckily in recent years three dimensional x ray tomography has become readily available for probing detailed 3d structure of rocks at nanometre scale this has opened a window for observing the tiny world of pores inside a micrometre sized rock chip cnudde et al 2013 by applying a segmentation algorithm on 3d tomography images of rocks it is possible to easily distinguish the void phase pore volume from the solid phase müter et al 2012 salzer et al 2014 wang et al 2015 the pore volume on the other hand is usually continuous so determining where one pore ends and the next pore begins is somewhat arbitrary hunt et al 2014 and this is the topic we address in this paper our aim is to present a quantitative measure of the vaguely defined term pore pore network models are widely used in petroleum engineering and soil science to study geometric hydraulic or petrophysical properties of rocks blunt et al 2013 these networks are constructed out of some simplified geometric shapes characterizing and representing the pores and throats dong et al 2009 no matter which algorithm is used to extract the network the most important input is the three dimensional geometry of the porous medium itself traditionally 2d rock thin sections along with two or multiple point statistics were used to interpret the 3d structure or at least its statistical properties okabe et al 2005 hajizadeh et al 2011 meerschman et al 2014 researchers have proposed stochastic methods to reconstruct a 3d image from one or a few 2d scanning electron microscope sem images karimpouli et al 2016 to condition the reconstructed images on available permeability data a sampling algorithm such as metropolis hastings algorithm can be combined with genetic algorithm to modify the structure of generated 3d image tahmasebi et al 2016 in cases where no quantitative information is available the process of rock formation including sedimentation and compaction among other steps is simulated to obtain the grains and pores with a desired grain size distribution bakke et al 1997 øren et al 2003 many algorithms have been developed to extract the pore network structure from 3d tomographic images bai et al 2013 wang et al 2016 these algorithms fall into two very broad categories a skeletonization and distance transform based algorithms which try to capture the geometry of the pore volume by finding the best morphological or topological skeleton salim et al 2013 that encompasses the whole structure liang et al 2000 rabbani et al 2014 and b algorithms based on inscribing the pore volume with spheres centered at each voxel and then merging the spheres that fall into larger spheres to get the final set of spheres that represents the pore network silin et al 2006 dong and blunt 2009 the pore volume is a continuous space and so determining the boundaries between pores is arbitrary hunt et al 2014 this vagueness in definition of what a pore entity is would naturally cause the algorithms that use a set of exact criteria to sacrifice some real pores at the expense of removing some spurious ones the problem of deciding where to draw the boundaries between the pores is a typical case where classical logic fails the reason is that the whole nature of the problem is ambiguous one does not know exactly what a pore is a possible solution is to use a type of logic in which statements can have values other than only true or false this many valued logic is derived from a new form of set theory that is called fuzzy set theory zadeh 1965 the concept of fuzzy sets gottwald 2010 extends the idea of classical sets in a way that allows elements to partially belong to one or more sets this partiality is handled by the membership function of a set fig 1 which dictates the degree of membership of any element in relation to that set for example a rock with 5 porosity might belong to a low porosity category with a 0 95 membership degree and the same rock might also belong to an average porosity rock category with membership degree of 0 18 in a general sense it is very common for categories to overlap it is worthwhile to mention that fuzziness membership degree and probability must not be confused fuzziness describes the ambiguity of the event and describes the degree to which the event has occurred not whether or not the event has occurred in other words there is no confusion about occurrence of the event probability on the other hand describes the uncertainty in occurrence of the event kosko 1990 mathematically membership function lacks the normalization requirement of a probability density function pdf and therefore in contrast to pdf the membership degrees of a particular event do not have to add up to 1 to make reasonable decision about merging two connected pore regions we have used the ability of fuzzy logic to handle vagueness in description of the pore itself fuzzy inference system fis is the process of formulating the mapping from a given input to an output using fuzzy logic the mapping then provides a basis from which decisions can be made one of main goals of fuzzy logic is bringing the expert s knowledge to pore network extraction process there are some rules of thumb that we know very well about the properties of the pores in the porous samples for example we know that pores with very high coordination numbers number of neighboring pores directly connected to the current pore but expressing and translating such knowledge to mathematics is not possible using the traditional methods but the fuzzy logic provide a tool to convert these non exact rules into precise mathematical expression to analyze the pores while most of the pore network algorithms proposed so far are designed to reflect the petrophysical properties of the rock sample the aim of this study was an algorithm that would expertly partition the void volume into sets of pores the partitioning will have to be done in a way that in the resulting network of pores each pore would represent an entity such that from a geologic hydrodynamic point of view it would be different from the neighboring pores for example when considering an extended opening in the rock also known as a fracture such an algorithm must consider it as one single entity fig 7 and not a collection of pores aligned around a line in space fig 8 as produced by traditional methods of pore network extraction this ambiguity in deciding where to draw the partitioning boundaries in space can be handled by a form of logic called fuzzy logic which provides a means of taking ambiguity into calculations in this article we apply watershed transform to distance map the pore space we show that no matter how smooth the distance map is or has become for example by applying a 3d median filter as suggested by rabbani et al 2014 watershed will produce spurious pores using a synthetic channel with rough surface as the benchmarking data set we demonstrate that without proper merging and updating the network structure it is impossible to correctly detect and incorporate geometric structures such as channels in the pore network we then define an fis to iteratively modify and update the network structure and test it on real and synthetic data sets 2 methods the first step in extracting a pore network in our algorithm is to segment the pore volume into candidate regions that might represent the pores the watershed algorithm roerdink et al 2000 is an intuitive yet powerful tool for segmenting images watershed of a grey scale image corresponds to a catchment basin of a height map a drop of water following the gradient of an image flows along a path to finally reach a local minimum intuitively the watershed is analogous to the limits of the adjacent catchment basins for water detailed explanation of mathematical concepts behind watershed algorithm are discussed elsewhere tahmasebi et al 2015 to convert the pore volume into a height map we apply distance transformation paglieroni 1992 r kimmel 1996 on the voxels of the 3d image distance transformation labels each voxel in the pore volume of the 3d image with a number representing the distance from the nearest obstacle voxel in solid phase as shown in fig 2 distance transformation produces larger numbers for voxels further from the solid boundaries and therefore generates a height map depending on the metric used for calculating the distance different distance maps can be derived from the binary image euclidean maurer et al 2003 rectilinear and chebyshev distances rosenfeld et al 1966 are the most common distance metrics used for distance map derivation in cartesian coordinates if p p 1 p 2 pn and q q 1 q 2 qn are two points in euclidean n dimensional space then the metrics presented above are defined as 1 euclidean d p q i 1 n p i q i 2 2 i 1 2 n 2 rectilinear d p q i 1 n p i q i i 1 2 n 3 chebyshev d p q m a x i p i q i i 1 2 n experimenting with different metrics has shown that for images containing components of different shapes the chebyshev metric also known as the chessboard transform can achieve better watershed segmentation results than euclidean and rectilinear metrics qing chen 2004 in our implementation we use the chebyshev metric for deriving the distance map of the pore space we applied the watershed transform on the chebyshev distance map of the pore space the watershed algorithm divides the pore space into partitions of hypothetical pores these pores however do not necessarily represent real pores to make reasonable decisions about merging two connected pore regions we used the ability of fuzzy logic to handle vagueness in describing physical systems the fuzzy inference system fis is the process of formulating the mapping from a given input to an output using fuzzy logic the mapping then is a decision making system an fis of mamdani type mamdani et al 1999 was applied to build up an inference system to decide whether any two extracted pores from a previous iteration should be merged or remain intact designing the fis consists of the following steps to consider both geometric features and hydraulic properties of two connected pores we have chosen a set of input features which are calculated from the results of the previous iteration these features include sphericity ψ which compares the surface area ap of the given volume vp and surface area of the sphere ap occupying the same volume sphericity is a measure of how flat or spherical a given volume is wadell 1935 4 ψ π 1 3 6 v p 2 3 a p the ratio of the size of the throat the boundary at which two regions touch to the size of a smaller pore the radius of the pore is defined with respect to sphericity or the euclidean distance transformation paglieroni 1992 of the smaller 5 ψ throat size min r 1 r 2 r 3 4 v p π 1 3 ψ 0 6 m a x d i s t v ψ 0 6 similarity measure s which quantifies how the two pores are geometrically similar 6 s min ψ 1 ψ 2 max ψ 1 ψ 2 z or the coordination number is defined as the number of pores directly connected to a specific pore constriction ratio the ratio of smaller pore radius to the throat size length width ratio which is defined as the ratio of the distances between two pore centers to the throat size the features introduced above a f are calculated for all pore couples these features are real numbers and in order for if then rules to work we define membership functions for all the features we use them to convert values of features into categories and degree of membership fuzzification for each category the membership functions for each feature are shown in detail in the appendix each feature coordination number length width ration etc has a maximum of 3 categories to cover low middle and high values of that feature to cover the high values we use s shaped membership function smf that is a spline based curve 7 f x a b 0 x a 2 x a b a 2 a x a b 2 1 2 x b b a 2 a b 2 x b 1 x b to map the low values of the features into their membership degree we use a z shaped membership function zmf which is acting in the opposite direction to the smf zmf is a spline based curve defined parametrically as 8 f x a b 1 x a 1 2 x a b a 2 a x a b 2 2 x b b a 2 a b 2 x b 0 x b an exception to using zmf is low valued category of coordination number the goal is to let the pores with low coordination number stay unchanged while pores with very high coordination numbers should be merged to avoid presence of a lot of pores with high coordination number therefore all the low valued coordination numbers should belong to the same category here we used a trapezoidal shaped membership function defined as 9 f x a b c d 0 x a x a b a a x b 1 b x c d x d c c x d 0 d x we map the mid valued features to their membership degrees using a gaussian curve membership function that peaks in the middle and decays toward the high and low valued features 10 f x σ c e x c 2 2 σ 2 based on geometric and structural features a set of 12 if then rules appendix b is defined to decide about merging the two pores all if then rules share the same general structure if input1 is a and or input2 is b then output is c here input1 input2 and output are linguistic variables a b and c are also linguistic values that are characterized by membership functions high low medium elongated spherical etc this type of rule typically expresses an inference such that if we know a fact antecedent then we can infer or derive another fact called a conclusion consequent because of their concise form fuzzy if then rules are often used to capture the imprecise modes of reasoning that play an essential role in the human ability to make decisions in an environment of uncertainty and imprecision we combine the fuzzified inputs according to the fuzzy rules to establish a rule strength we use min operator for simulating and max operator for or min operator for implication and max operator for aggregation of all rule strengths fig 3 illustrates the logic of mamdani fis mathematically speaking if the proposed if then rules have the following form rule 1 if input1 is a11 and input2 is a12 then output is c1 rule 2 if input1 is a21 and input2 is a22 then output is c2 fact input1 is x0 and input2 is y0 consequence output is c then the rule strength or firing levels of the rules denoted by α i i 1 2 are determined from 11 α 1 m i n a 11 x 0 a 12 y 0 12 α 2 m i n a 21 x 0 a 22 y 0 4 next we find the consequence of the rule by combining the rule strength and the output membership function because we want to decide about merging the pores the output membership functions are two trapezoidal functions that cross at 0 5 fig 4 13 c 1 z m i n α 1 c 1 z 14 c 2 z m i n α 2 c 2 z in eqs 13 and 14 z represents the whole range of possible output elements with nonzero degree of membership 5 the consequences are combined to get an overall system output distribution 15 c z max c 1 z c 2 z 6 the output distribution is defuzzified using the middle of maximum mom operator this operator takes the mean of the maxima of the membership distribution of final output mom is especially helpful when the maxima of final output form a plateau after merging those pores selected by fis the new network is again evaluated and modified by fis until the change in the structure of the network is below a decided threshold in our implementation we have used a value of 5 change in the number of pores as the stopping criterion for the iteration fig 5 summarizes the steps of algorithm in order to clarify the steps of the algorithm we apply it on a synthetic digital geometry for a clearer picture of what is happening in each step the steps are applied on a 2d image slice taken from a 3d tomogram essentially the same holds true for the 3d images we assume that the tomography image fig 6 a is segmented into pore pixels black pixels in fig 6b and solid pixels white pixels in the first step distance map of the image is calculated the distance map shows the distance of each pore pixel to the nearest solid pixel in its surrounding fig 6c in order to get an initial estimate of the pore network we applied the watershed algorithm on the distance map the watershed algorithm segments the distance map into an initial set of pores fig 6d left these pores need to be modified in order to qualify as pores represented in the desired pore network model to do that all the pairs of pores that are connected they have a common interface are listed for feature extraction as discussed above sphericity coordination number constriction ratio and other features are calculated each of these features gives a real valued number we use the introduced membership functions to convert the features into their fuzzified values based on the output of the fuzzy inference system the current pair of pores under study will either remain separate or they are merged to form a single larger pore this process is repeated for all the pairs of pores that have not been investigated yet when the algorithm has considered all the pore sets in this manner another iteration of the procedure is performed for the new pore set after each iteration it is most likely that the number of pores have decreased due to potential merging of some of the pores we keep iterate until the number of merged pores are below a certain threshold and the final configuration of the pores in the pore network model is obtained fig 6d e 3 results to test the ability of the algorithm to successfully merge the pores while preserving and representing the geometrical structure of the pore space we use a simple model of a three dimensional channel the test image consists of the pore space of a channel with rectangular cross section we use diffusion limited aggregation dla witten et al 1981 to add fractal like irregularities to the surface of the pore to make it more realistic tsakiroglou et al 1993 a 3d representation of the resulting pore volume is shown in fig 7 after only two iterations our proposed algorithm correctly identified the test image as one single geometric hydraulic structure to highlight the effect of the fuzzy inference system we tested a morphological watershed based algorithm rabbani et al 2014 which does not include any merging on the same channel image we also changed the size of the smoothing median filter to check if it has any alleviating effect on the number of misidentified pores fig 8 shows the final network outputs associated with different filter size without a proper decision making about merging spurious pores the morphological algorithm fails to capture the true structure of the channel as a single hydraulic object and even a 13 13 13 median filter size captures many spurious pores we also tested a simple model of two spheres connected by a cylindrical throat fig 9 a as with the previous data set we used dla to decorate the geometries with fractal irregularities fig 9 shows the test pores and the resulting pore network the algorithm has correctly identified the two pores and has given an acceptable estimate of the pore sizes aside from the pore network structure and based on the region adjacency graph rag flavell et al 1991 of the network we can calculate the coordination number for all of the pores distribution of coordination number and average coordination number are important for mean field methods to estimate transport properties of the rocks hansen et al 1992 we used a 3d canny edge detector canny 1986 to extract the pore throat connecting two pores and its geometric measures which gives the throat size distribution of the network pore size distribution is calculated based on the pore radius definition given in eqn 5 we tested our proposed algorithm on 3d tomographic images of real rocks including 3 sandstones 650 nm resolution 3 dolomites 650 nm resolution and 3 chalk samples 100 nm resolution sandstone samples used here are subsamples of dataset sandstone baii s1 from gooya et al 2016 and we refer to them as sand ba sand ba1 and sand ba2 we worked on 3 sub volumes of the data set of dolomite 1 c1 from gooya et al 2016 here they are named dolomite 1 dolomite 2 and dolomite 3 chalk samples are subsamples taken from hc 16 müter et al 2014 for all 9 datasets the algorithm converged after only 2 iterations fig 10 shows one pore volume for each rock type where the solid has been removed and the corresponding pore network extracted pore network models are generally used to calculate transport properties permeability imbibition drainage etc of a porous medium a combination of these properties is then used to define a rock typing criterion abedini 2011 all of these properties heavily depend on the structural variability of the rock hence the network the way pores are connected to each other and how homogenous the coordination number distribution is herman et al 1996 on the other hand mean field theory requires knowledge about the average coordination number or structural importance to approximate the effective properties of the network redner 2007 regardless of the apparent physical shape of the samples studied both of these observations hint that a proper representation of structural properties should allow us to distinguish different rock types therefore we introduced a new plot that captures both the structural importance and structural variability of the network 4 discussion the pore network extraction algorithm provides probability mass function pmf of the coordination numbers in the test data fig 11 which gives the probability that a discrete random variable coordination number of a pore for example which is a positive integer equals some value sugiyama 2016 in other words if x is a discrete random variable that can generate some values x coordination number of each pore drawn from a possible outcome set a then pmf is defined following eqn 16 obviously pmf is zero for all but a countable number of values of x that has been observed 16 p x x pr x x x a p x x 1 from an information theoretic point of view the amount of knowledge that one gains from an event is inversely related to its probability of happening in a pore network if the probability of finding a pore with coordination number z is equal to p z then the surprisal i z associated with that event is shannon 1948 17 i z log p z the unit of information depends on the choice of log base in eqn 17 if base 2 is used the unit of information is called bit because z is a possible outcome of many observed coordination numbers in the set z the self information of z would have a distribution itself the information entropy h z of an event is therefore the expected value of its self information 18 h z e i z z z p z log p z from eqns eqs 17 to 18 it is obvious that the amount of information associated with an event depends only on the probability of its occurrence therefore information entropy of a pore network directly measures the amount of surprise unpredictability or deviation from purely homogenous distribution of coordination numbers and captures structural variability of the network we use the information entropy of the coordination number distribution expected value of self information of coordination number distribution and mean coordination number expected value of coordination number distribution as two features for analyzing the pore network model as shown in fig 12 the samples tend to cluster themselves based on the type of rock they have been extracted from the information content plot reveals and summarizes the porous structure geometry of the rock samples therefore it is useful to combine it with a clustering algorithm such as k mean clustering to identify the type of rock and its similarity to a certain rock type of interest mackay 2002 the plot matches with a visual inspection of typical 2d cross sections of the samples a two dimensional cross section of dolomite fig 13 b reveals that the porous space components are almost similar in shape and more elongated this results in lower coordination number and less surprisal in the structure of the network therefore we expect the dolomite to be on the lower left corner of the plot in case of sandstone fig 13c it can easily be seen that the porous components are very diverse in size and orientation and form more complex connections the higher value of unexpectedness in the structure and abundance of the pores that have many different connections fits with upper right location of sandstone cluster in fig 11 the chalk as it can be seen in fig 12a and fig 11 is somewhere between simple and tight structure of dolomite and the complexity of sandstone network the results of our proposed network extraction algorithm were compared with those of the modified maximal ball algorithm dong and blunt 2009 for the maximal ball algorithm the data points in fig 14 clustered rather similar the data points from the fuzzy logic algorithm although the average coordination numbers substantially larger the average coordination numbers z obtained from the maximal ball algorithm are extending all the way up to z 12 where the presented algorithm estimates the average coordination number only to around z 3 2 for dolomite z 5 for chalk and z 6 5 for sandstone these numbers are in closer agreement with other average coordination numbers found in the literature which generally ranges from z 3 5 to z 4 5 for both sandstone and chalk ioannidis et al 2000 talukdar 2001 raoof et al 2010 rabbani et al 2016 to probe the structural quality of the networks also extracted by rabbani et al 2014 we have also plotted the information content as function of the coordination number fig 14 although the results are consistent for sandstone and chalk the dolomite networks show a larger discrepancy in the information content of the coordination number distribution we have compared the pore and throat size distributions of the modified maximal ball algorithm to the results obtained with our proposed method in fig 15 fig 15a demonstrates that the pore radius probability distributions from the maximal ball method are all shifted significantly to lower values compared with our method this observation consistent for all three rock types a similar shift is observed for the throat radius distributions for the different rock types comparing the maximal ball and our method fig 15b the key observation is that in pore and throat size distributions a sizable fraction of the distribution is below the voxel size of the tomographic images of rocks this means that a lot of very small pores and throats have been assigned as a side effect of the maximal ball method because of image noise therefore these small pores will be connected to the large pores as satellite pores and thereby shift the average coordination number of pores to higher values to investigate which of the pore throat size distributions obtained by the maximal ball method or ours is most likely we compared them to a very different method of estimating the dominant throat size we used the morphological solid expansion method yang et al 2015 to provide the estimate of the dominant throat size in the solid expansion method the solid part of the image is expanded layer by layer with one voxel thickness at each expansion the number of individual pores in the system is counted then expanding the solid layer by layer the number of isolated pore increases initially until as throats get blocked until a critical point after which the number of isolated pores diminishes again this critical point qualitatively describes the most dominant throat size in the system table 2 summarizes the comparison between our method fuzzy the modified maximal ball method dong and blunt 2009 and the solid expansion method yang et al 2015 peak refer to the position of the peak maximum of the throat size distribution for each method this value represents the dominant throat size in the system for each method absolute relative error is equal to a b s p e a k m e t h o d p e a k e x p a n s i o n p e a k e x p a n s i o n table 2 shows that results of maximal ball algorithm for estimating throat size are farther away from the results of expansion method compared to our proposed method denoted by fuzzy in table 2 to put this observation in perspective we plotted the absolute relative error of our method versus the absolute relative error of maximal ball with respect to the results of solid expansion algorithm fig 16 the plot in fig 16 shows that our method produces results that have lower error compared to the error in maximal ball results with respect to the results of solid expansion method table 1 5 conclusions despite the fact that pores are central elements in a porous system and essential for the quantities that describe a porous system a quantifiable measure of pore ness has not previously been introduced we developed a new algorithm for extracting pore network from 3d tomography images from three samples each of three different rock types chalk dolomite and sandstone our algorithm iteratively uses a fuzzy logic inference engine to decide about the quality of pores extracted and merge them if necessary and update the whole network and fuzzy features the test results show that the algorithm generally converges after 2 to 3 iterations the outputs of the algorithm are distribution of pore coordination number pore size and throat size the main idea behind the proposed pore network extraction algorithm is to be equipped with a tool than can provide information about the geology and structure of the porous sample that s why in contrast to other algorithms we have used statistical properties of the network to classify different rock types rather than using conventional plots such as cross plot of porosity and permeability for checking the accuracy of the algorithm in estimating petrophysical properties of the samples we used the information content of the pore network to compare the results for different rock types the plot of information vs average coordination number shows that our algorithm correctly responds to the structural differences of the different rock types we suggest the use of this plot combined with a clustering algorithm for assessing pore network results or eliciting useful information about rock structure acknowledgments we acknowledge funding from innovation fund denmark and maersk oil and gas a s for the p3 project predicting petrophysical parameters and innovation fund denmark for the cinema project rg and am acknowledge fellowships from the european commission 7th framework programme itn no 317235 co2 react project appendices a membership functions defined for fis inputs unlabelled image b fis rules the rules have general format of if input1 is a and input2 is b and then output1 is output input1 a output throat ratio high merge coordination high merge input1 a input2 b output throat ratio low coordination not high no merge throat ratio medium coordination not low merge throat ratio not low coordination not low merge input1 a input2 b input3 c output sphericity1 not elongated throat ratio not high spherecity2 not elongated no merge throat ratio not low coordination low spherecity2 round merge throat ratio not low similarity different coordination medium merge sphericity1 not round throat ratio not low spherecity2 not round merge throat ratio low similarity different coordination not high no merge sphericity1 elongated throat ratio not low spherecity2 elongated merge input1 a input2 b input3 c input4 d output sphericity1 not round throat ratio medium coordination low spherecity2 not round merge 
790,x ray tomography has opened a window into the invisible world of pore structure in rocks using tomography images as input pore network models try to use a simple geometric representation to acquire a detailed description of the pore volume algorithms developed so far to extract the pore network from tomography images are primarily focused on calculating petrophysical properties of the rock sample the present study is concerned with extracting a pore network that enables us to elicit information about structural properties and features of the rock sample however there is no quantifiable definition of what a pore is and deciding how to divide the pore volume into discrete pores is vague and arbitrary fuzzy logic is an extension of classical logic that can accommodate situations where the nature of problem itself is vague we have developed an algorithm to extract the pore structure and quantify the pore properties from tomography images of rocks in the algorithm a fuzzy logic based inference engine is used to assess the quality of pores extracted by watershed segmentation and modify them if needed we have also designed a fingerprinting plot based on the information content of the network to quantify performance of the algorithm results show that the algorithm is able to link the overall structure of the porous space to the final network and produce reliable results for rocks with a variety of pore structures keywords pore network model percolation fuzzy logic tomography porous media information entropy 1 introduction it is not surprising to see different terms and quantities for what a pore is in the porous media literature in percolation theory a porous medium is modeled as a lattice of bonds pore throats that connect sites pores on the lattice in the microscale chatzis et al 1977 at macroscale different capillary pressure measurement techniques have been used to estimate pore size distribution in the rock samples mishra et al 1988 parameters such as pore and pore throat size distribution and pore coordination number are essential for many upscaling seetha et al 2017 and percolation ding et al 2015 methods and ironically there is no prior definition of what exactly a pore is luckily in recent years three dimensional x ray tomography has become readily available for probing detailed 3d structure of rocks at nanometre scale this has opened a window for observing the tiny world of pores inside a micrometre sized rock chip cnudde et al 2013 by applying a segmentation algorithm on 3d tomography images of rocks it is possible to easily distinguish the void phase pore volume from the solid phase müter et al 2012 salzer et al 2014 wang et al 2015 the pore volume on the other hand is usually continuous so determining where one pore ends and the next pore begins is somewhat arbitrary hunt et al 2014 and this is the topic we address in this paper our aim is to present a quantitative measure of the vaguely defined term pore pore network models are widely used in petroleum engineering and soil science to study geometric hydraulic or petrophysical properties of rocks blunt et al 2013 these networks are constructed out of some simplified geometric shapes characterizing and representing the pores and throats dong et al 2009 no matter which algorithm is used to extract the network the most important input is the three dimensional geometry of the porous medium itself traditionally 2d rock thin sections along with two or multiple point statistics were used to interpret the 3d structure or at least its statistical properties okabe et al 2005 hajizadeh et al 2011 meerschman et al 2014 researchers have proposed stochastic methods to reconstruct a 3d image from one or a few 2d scanning electron microscope sem images karimpouli et al 2016 to condition the reconstructed images on available permeability data a sampling algorithm such as metropolis hastings algorithm can be combined with genetic algorithm to modify the structure of generated 3d image tahmasebi et al 2016 in cases where no quantitative information is available the process of rock formation including sedimentation and compaction among other steps is simulated to obtain the grains and pores with a desired grain size distribution bakke et al 1997 øren et al 2003 many algorithms have been developed to extract the pore network structure from 3d tomographic images bai et al 2013 wang et al 2016 these algorithms fall into two very broad categories a skeletonization and distance transform based algorithms which try to capture the geometry of the pore volume by finding the best morphological or topological skeleton salim et al 2013 that encompasses the whole structure liang et al 2000 rabbani et al 2014 and b algorithms based on inscribing the pore volume with spheres centered at each voxel and then merging the spheres that fall into larger spheres to get the final set of spheres that represents the pore network silin et al 2006 dong and blunt 2009 the pore volume is a continuous space and so determining the boundaries between pores is arbitrary hunt et al 2014 this vagueness in definition of what a pore entity is would naturally cause the algorithms that use a set of exact criteria to sacrifice some real pores at the expense of removing some spurious ones the problem of deciding where to draw the boundaries between the pores is a typical case where classical logic fails the reason is that the whole nature of the problem is ambiguous one does not know exactly what a pore is a possible solution is to use a type of logic in which statements can have values other than only true or false this many valued logic is derived from a new form of set theory that is called fuzzy set theory zadeh 1965 the concept of fuzzy sets gottwald 2010 extends the idea of classical sets in a way that allows elements to partially belong to one or more sets this partiality is handled by the membership function of a set fig 1 which dictates the degree of membership of any element in relation to that set for example a rock with 5 porosity might belong to a low porosity category with a 0 95 membership degree and the same rock might also belong to an average porosity rock category with membership degree of 0 18 in a general sense it is very common for categories to overlap it is worthwhile to mention that fuzziness membership degree and probability must not be confused fuzziness describes the ambiguity of the event and describes the degree to which the event has occurred not whether or not the event has occurred in other words there is no confusion about occurrence of the event probability on the other hand describes the uncertainty in occurrence of the event kosko 1990 mathematically membership function lacks the normalization requirement of a probability density function pdf and therefore in contrast to pdf the membership degrees of a particular event do not have to add up to 1 to make reasonable decision about merging two connected pore regions we have used the ability of fuzzy logic to handle vagueness in description of the pore itself fuzzy inference system fis is the process of formulating the mapping from a given input to an output using fuzzy logic the mapping then provides a basis from which decisions can be made one of main goals of fuzzy logic is bringing the expert s knowledge to pore network extraction process there are some rules of thumb that we know very well about the properties of the pores in the porous samples for example we know that pores with very high coordination numbers number of neighboring pores directly connected to the current pore but expressing and translating such knowledge to mathematics is not possible using the traditional methods but the fuzzy logic provide a tool to convert these non exact rules into precise mathematical expression to analyze the pores while most of the pore network algorithms proposed so far are designed to reflect the petrophysical properties of the rock sample the aim of this study was an algorithm that would expertly partition the void volume into sets of pores the partitioning will have to be done in a way that in the resulting network of pores each pore would represent an entity such that from a geologic hydrodynamic point of view it would be different from the neighboring pores for example when considering an extended opening in the rock also known as a fracture such an algorithm must consider it as one single entity fig 7 and not a collection of pores aligned around a line in space fig 8 as produced by traditional methods of pore network extraction this ambiguity in deciding where to draw the partitioning boundaries in space can be handled by a form of logic called fuzzy logic which provides a means of taking ambiguity into calculations in this article we apply watershed transform to distance map the pore space we show that no matter how smooth the distance map is or has become for example by applying a 3d median filter as suggested by rabbani et al 2014 watershed will produce spurious pores using a synthetic channel with rough surface as the benchmarking data set we demonstrate that without proper merging and updating the network structure it is impossible to correctly detect and incorporate geometric structures such as channels in the pore network we then define an fis to iteratively modify and update the network structure and test it on real and synthetic data sets 2 methods the first step in extracting a pore network in our algorithm is to segment the pore volume into candidate regions that might represent the pores the watershed algorithm roerdink et al 2000 is an intuitive yet powerful tool for segmenting images watershed of a grey scale image corresponds to a catchment basin of a height map a drop of water following the gradient of an image flows along a path to finally reach a local minimum intuitively the watershed is analogous to the limits of the adjacent catchment basins for water detailed explanation of mathematical concepts behind watershed algorithm are discussed elsewhere tahmasebi et al 2015 to convert the pore volume into a height map we apply distance transformation paglieroni 1992 r kimmel 1996 on the voxels of the 3d image distance transformation labels each voxel in the pore volume of the 3d image with a number representing the distance from the nearest obstacle voxel in solid phase as shown in fig 2 distance transformation produces larger numbers for voxels further from the solid boundaries and therefore generates a height map depending on the metric used for calculating the distance different distance maps can be derived from the binary image euclidean maurer et al 2003 rectilinear and chebyshev distances rosenfeld et al 1966 are the most common distance metrics used for distance map derivation in cartesian coordinates if p p 1 p 2 pn and q q 1 q 2 qn are two points in euclidean n dimensional space then the metrics presented above are defined as 1 euclidean d p q i 1 n p i q i 2 2 i 1 2 n 2 rectilinear d p q i 1 n p i q i i 1 2 n 3 chebyshev d p q m a x i p i q i i 1 2 n experimenting with different metrics has shown that for images containing components of different shapes the chebyshev metric also known as the chessboard transform can achieve better watershed segmentation results than euclidean and rectilinear metrics qing chen 2004 in our implementation we use the chebyshev metric for deriving the distance map of the pore space we applied the watershed transform on the chebyshev distance map of the pore space the watershed algorithm divides the pore space into partitions of hypothetical pores these pores however do not necessarily represent real pores to make reasonable decisions about merging two connected pore regions we used the ability of fuzzy logic to handle vagueness in describing physical systems the fuzzy inference system fis is the process of formulating the mapping from a given input to an output using fuzzy logic the mapping then is a decision making system an fis of mamdani type mamdani et al 1999 was applied to build up an inference system to decide whether any two extracted pores from a previous iteration should be merged or remain intact designing the fis consists of the following steps to consider both geometric features and hydraulic properties of two connected pores we have chosen a set of input features which are calculated from the results of the previous iteration these features include sphericity ψ which compares the surface area ap of the given volume vp and surface area of the sphere ap occupying the same volume sphericity is a measure of how flat or spherical a given volume is wadell 1935 4 ψ π 1 3 6 v p 2 3 a p the ratio of the size of the throat the boundary at which two regions touch to the size of a smaller pore the radius of the pore is defined with respect to sphericity or the euclidean distance transformation paglieroni 1992 of the smaller 5 ψ throat size min r 1 r 2 r 3 4 v p π 1 3 ψ 0 6 m a x d i s t v ψ 0 6 similarity measure s which quantifies how the two pores are geometrically similar 6 s min ψ 1 ψ 2 max ψ 1 ψ 2 z or the coordination number is defined as the number of pores directly connected to a specific pore constriction ratio the ratio of smaller pore radius to the throat size length width ratio which is defined as the ratio of the distances between two pore centers to the throat size the features introduced above a f are calculated for all pore couples these features are real numbers and in order for if then rules to work we define membership functions for all the features we use them to convert values of features into categories and degree of membership fuzzification for each category the membership functions for each feature are shown in detail in the appendix each feature coordination number length width ration etc has a maximum of 3 categories to cover low middle and high values of that feature to cover the high values we use s shaped membership function smf that is a spline based curve 7 f x a b 0 x a 2 x a b a 2 a x a b 2 1 2 x b b a 2 a b 2 x b 1 x b to map the low values of the features into their membership degree we use a z shaped membership function zmf which is acting in the opposite direction to the smf zmf is a spline based curve defined parametrically as 8 f x a b 1 x a 1 2 x a b a 2 a x a b 2 2 x b b a 2 a b 2 x b 0 x b an exception to using zmf is low valued category of coordination number the goal is to let the pores with low coordination number stay unchanged while pores with very high coordination numbers should be merged to avoid presence of a lot of pores with high coordination number therefore all the low valued coordination numbers should belong to the same category here we used a trapezoidal shaped membership function defined as 9 f x a b c d 0 x a x a b a a x b 1 b x c d x d c c x d 0 d x we map the mid valued features to their membership degrees using a gaussian curve membership function that peaks in the middle and decays toward the high and low valued features 10 f x σ c e x c 2 2 σ 2 based on geometric and structural features a set of 12 if then rules appendix b is defined to decide about merging the two pores all if then rules share the same general structure if input1 is a and or input2 is b then output is c here input1 input2 and output are linguistic variables a b and c are also linguistic values that are characterized by membership functions high low medium elongated spherical etc this type of rule typically expresses an inference such that if we know a fact antecedent then we can infer or derive another fact called a conclusion consequent because of their concise form fuzzy if then rules are often used to capture the imprecise modes of reasoning that play an essential role in the human ability to make decisions in an environment of uncertainty and imprecision we combine the fuzzified inputs according to the fuzzy rules to establish a rule strength we use min operator for simulating and max operator for or min operator for implication and max operator for aggregation of all rule strengths fig 3 illustrates the logic of mamdani fis mathematically speaking if the proposed if then rules have the following form rule 1 if input1 is a11 and input2 is a12 then output is c1 rule 2 if input1 is a21 and input2 is a22 then output is c2 fact input1 is x0 and input2 is y0 consequence output is c then the rule strength or firing levels of the rules denoted by α i i 1 2 are determined from 11 α 1 m i n a 11 x 0 a 12 y 0 12 α 2 m i n a 21 x 0 a 22 y 0 4 next we find the consequence of the rule by combining the rule strength and the output membership function because we want to decide about merging the pores the output membership functions are two trapezoidal functions that cross at 0 5 fig 4 13 c 1 z m i n α 1 c 1 z 14 c 2 z m i n α 2 c 2 z in eqs 13 and 14 z represents the whole range of possible output elements with nonzero degree of membership 5 the consequences are combined to get an overall system output distribution 15 c z max c 1 z c 2 z 6 the output distribution is defuzzified using the middle of maximum mom operator this operator takes the mean of the maxima of the membership distribution of final output mom is especially helpful when the maxima of final output form a plateau after merging those pores selected by fis the new network is again evaluated and modified by fis until the change in the structure of the network is below a decided threshold in our implementation we have used a value of 5 change in the number of pores as the stopping criterion for the iteration fig 5 summarizes the steps of algorithm in order to clarify the steps of the algorithm we apply it on a synthetic digital geometry for a clearer picture of what is happening in each step the steps are applied on a 2d image slice taken from a 3d tomogram essentially the same holds true for the 3d images we assume that the tomography image fig 6 a is segmented into pore pixels black pixels in fig 6b and solid pixels white pixels in the first step distance map of the image is calculated the distance map shows the distance of each pore pixel to the nearest solid pixel in its surrounding fig 6c in order to get an initial estimate of the pore network we applied the watershed algorithm on the distance map the watershed algorithm segments the distance map into an initial set of pores fig 6d left these pores need to be modified in order to qualify as pores represented in the desired pore network model to do that all the pairs of pores that are connected they have a common interface are listed for feature extraction as discussed above sphericity coordination number constriction ratio and other features are calculated each of these features gives a real valued number we use the introduced membership functions to convert the features into their fuzzified values based on the output of the fuzzy inference system the current pair of pores under study will either remain separate or they are merged to form a single larger pore this process is repeated for all the pairs of pores that have not been investigated yet when the algorithm has considered all the pore sets in this manner another iteration of the procedure is performed for the new pore set after each iteration it is most likely that the number of pores have decreased due to potential merging of some of the pores we keep iterate until the number of merged pores are below a certain threshold and the final configuration of the pores in the pore network model is obtained fig 6d e 3 results to test the ability of the algorithm to successfully merge the pores while preserving and representing the geometrical structure of the pore space we use a simple model of a three dimensional channel the test image consists of the pore space of a channel with rectangular cross section we use diffusion limited aggregation dla witten et al 1981 to add fractal like irregularities to the surface of the pore to make it more realistic tsakiroglou et al 1993 a 3d representation of the resulting pore volume is shown in fig 7 after only two iterations our proposed algorithm correctly identified the test image as one single geometric hydraulic structure to highlight the effect of the fuzzy inference system we tested a morphological watershed based algorithm rabbani et al 2014 which does not include any merging on the same channel image we also changed the size of the smoothing median filter to check if it has any alleviating effect on the number of misidentified pores fig 8 shows the final network outputs associated with different filter size without a proper decision making about merging spurious pores the morphological algorithm fails to capture the true structure of the channel as a single hydraulic object and even a 13 13 13 median filter size captures many spurious pores we also tested a simple model of two spheres connected by a cylindrical throat fig 9 a as with the previous data set we used dla to decorate the geometries with fractal irregularities fig 9 shows the test pores and the resulting pore network the algorithm has correctly identified the two pores and has given an acceptable estimate of the pore sizes aside from the pore network structure and based on the region adjacency graph rag flavell et al 1991 of the network we can calculate the coordination number for all of the pores distribution of coordination number and average coordination number are important for mean field methods to estimate transport properties of the rocks hansen et al 1992 we used a 3d canny edge detector canny 1986 to extract the pore throat connecting two pores and its geometric measures which gives the throat size distribution of the network pore size distribution is calculated based on the pore radius definition given in eqn 5 we tested our proposed algorithm on 3d tomographic images of real rocks including 3 sandstones 650 nm resolution 3 dolomites 650 nm resolution and 3 chalk samples 100 nm resolution sandstone samples used here are subsamples of dataset sandstone baii s1 from gooya et al 2016 and we refer to them as sand ba sand ba1 and sand ba2 we worked on 3 sub volumes of the data set of dolomite 1 c1 from gooya et al 2016 here they are named dolomite 1 dolomite 2 and dolomite 3 chalk samples are subsamples taken from hc 16 müter et al 2014 for all 9 datasets the algorithm converged after only 2 iterations fig 10 shows one pore volume for each rock type where the solid has been removed and the corresponding pore network extracted pore network models are generally used to calculate transport properties permeability imbibition drainage etc of a porous medium a combination of these properties is then used to define a rock typing criterion abedini 2011 all of these properties heavily depend on the structural variability of the rock hence the network the way pores are connected to each other and how homogenous the coordination number distribution is herman et al 1996 on the other hand mean field theory requires knowledge about the average coordination number or structural importance to approximate the effective properties of the network redner 2007 regardless of the apparent physical shape of the samples studied both of these observations hint that a proper representation of structural properties should allow us to distinguish different rock types therefore we introduced a new plot that captures both the structural importance and structural variability of the network 4 discussion the pore network extraction algorithm provides probability mass function pmf of the coordination numbers in the test data fig 11 which gives the probability that a discrete random variable coordination number of a pore for example which is a positive integer equals some value sugiyama 2016 in other words if x is a discrete random variable that can generate some values x coordination number of each pore drawn from a possible outcome set a then pmf is defined following eqn 16 obviously pmf is zero for all but a countable number of values of x that has been observed 16 p x x pr x x x a p x x 1 from an information theoretic point of view the amount of knowledge that one gains from an event is inversely related to its probability of happening in a pore network if the probability of finding a pore with coordination number z is equal to p z then the surprisal i z associated with that event is shannon 1948 17 i z log p z the unit of information depends on the choice of log base in eqn 17 if base 2 is used the unit of information is called bit because z is a possible outcome of many observed coordination numbers in the set z the self information of z would have a distribution itself the information entropy h z of an event is therefore the expected value of its self information 18 h z e i z z z p z log p z from eqns eqs 17 to 18 it is obvious that the amount of information associated with an event depends only on the probability of its occurrence therefore information entropy of a pore network directly measures the amount of surprise unpredictability or deviation from purely homogenous distribution of coordination numbers and captures structural variability of the network we use the information entropy of the coordination number distribution expected value of self information of coordination number distribution and mean coordination number expected value of coordination number distribution as two features for analyzing the pore network model as shown in fig 12 the samples tend to cluster themselves based on the type of rock they have been extracted from the information content plot reveals and summarizes the porous structure geometry of the rock samples therefore it is useful to combine it with a clustering algorithm such as k mean clustering to identify the type of rock and its similarity to a certain rock type of interest mackay 2002 the plot matches with a visual inspection of typical 2d cross sections of the samples a two dimensional cross section of dolomite fig 13 b reveals that the porous space components are almost similar in shape and more elongated this results in lower coordination number and less surprisal in the structure of the network therefore we expect the dolomite to be on the lower left corner of the plot in case of sandstone fig 13c it can easily be seen that the porous components are very diverse in size and orientation and form more complex connections the higher value of unexpectedness in the structure and abundance of the pores that have many different connections fits with upper right location of sandstone cluster in fig 11 the chalk as it can be seen in fig 12a and fig 11 is somewhere between simple and tight structure of dolomite and the complexity of sandstone network the results of our proposed network extraction algorithm were compared with those of the modified maximal ball algorithm dong and blunt 2009 for the maximal ball algorithm the data points in fig 14 clustered rather similar the data points from the fuzzy logic algorithm although the average coordination numbers substantially larger the average coordination numbers z obtained from the maximal ball algorithm are extending all the way up to z 12 where the presented algorithm estimates the average coordination number only to around z 3 2 for dolomite z 5 for chalk and z 6 5 for sandstone these numbers are in closer agreement with other average coordination numbers found in the literature which generally ranges from z 3 5 to z 4 5 for both sandstone and chalk ioannidis et al 2000 talukdar 2001 raoof et al 2010 rabbani et al 2016 to probe the structural quality of the networks also extracted by rabbani et al 2014 we have also plotted the information content as function of the coordination number fig 14 although the results are consistent for sandstone and chalk the dolomite networks show a larger discrepancy in the information content of the coordination number distribution we have compared the pore and throat size distributions of the modified maximal ball algorithm to the results obtained with our proposed method in fig 15 fig 15a demonstrates that the pore radius probability distributions from the maximal ball method are all shifted significantly to lower values compared with our method this observation consistent for all three rock types a similar shift is observed for the throat radius distributions for the different rock types comparing the maximal ball and our method fig 15b the key observation is that in pore and throat size distributions a sizable fraction of the distribution is below the voxel size of the tomographic images of rocks this means that a lot of very small pores and throats have been assigned as a side effect of the maximal ball method because of image noise therefore these small pores will be connected to the large pores as satellite pores and thereby shift the average coordination number of pores to higher values to investigate which of the pore throat size distributions obtained by the maximal ball method or ours is most likely we compared them to a very different method of estimating the dominant throat size we used the morphological solid expansion method yang et al 2015 to provide the estimate of the dominant throat size in the solid expansion method the solid part of the image is expanded layer by layer with one voxel thickness at each expansion the number of individual pores in the system is counted then expanding the solid layer by layer the number of isolated pore increases initially until as throats get blocked until a critical point after which the number of isolated pores diminishes again this critical point qualitatively describes the most dominant throat size in the system table 2 summarizes the comparison between our method fuzzy the modified maximal ball method dong and blunt 2009 and the solid expansion method yang et al 2015 peak refer to the position of the peak maximum of the throat size distribution for each method this value represents the dominant throat size in the system for each method absolute relative error is equal to a b s p e a k m e t h o d p e a k e x p a n s i o n p e a k e x p a n s i o n table 2 shows that results of maximal ball algorithm for estimating throat size are farther away from the results of expansion method compared to our proposed method denoted by fuzzy in table 2 to put this observation in perspective we plotted the absolute relative error of our method versus the absolute relative error of maximal ball with respect to the results of solid expansion algorithm fig 16 the plot in fig 16 shows that our method produces results that have lower error compared to the error in maximal ball results with respect to the results of solid expansion method table 1 5 conclusions despite the fact that pores are central elements in a porous system and essential for the quantities that describe a porous system a quantifiable measure of pore ness has not previously been introduced we developed a new algorithm for extracting pore network from 3d tomography images from three samples each of three different rock types chalk dolomite and sandstone our algorithm iteratively uses a fuzzy logic inference engine to decide about the quality of pores extracted and merge them if necessary and update the whole network and fuzzy features the test results show that the algorithm generally converges after 2 to 3 iterations the outputs of the algorithm are distribution of pore coordination number pore size and throat size the main idea behind the proposed pore network extraction algorithm is to be equipped with a tool than can provide information about the geology and structure of the porous sample that s why in contrast to other algorithms we have used statistical properties of the network to classify different rock types rather than using conventional plots such as cross plot of porosity and permeability for checking the accuracy of the algorithm in estimating petrophysical properties of the samples we used the information content of the pore network to compare the results for different rock types the plot of information vs average coordination number shows that our algorithm correctly responds to the structural differences of the different rock types we suggest the use of this plot combined with a clustering algorithm for assessing pore network results or eliciting useful information about rock structure acknowledgments we acknowledge funding from innovation fund denmark and maersk oil and gas a s for the p3 project predicting petrophysical parameters and innovation fund denmark for the cinema project rg and am acknowledge fellowships from the european commission 7th framework programme itn no 317235 co2 react project appendices a membership functions defined for fis inputs unlabelled image b fis rules the rules have general format of if input1 is a and input2 is b and then output1 is output input1 a output throat ratio high merge coordination high merge input1 a input2 b output throat ratio low coordination not high no merge throat ratio medium coordination not low merge throat ratio not low coordination not low merge input1 a input2 b input3 c output sphericity1 not elongated throat ratio not high spherecity2 not elongated no merge throat ratio not low coordination low spherecity2 round merge throat ratio not low similarity different coordination medium merge sphericity1 not round throat ratio not low spherecity2 not round merge throat ratio low similarity different coordination not high no merge sphericity1 elongated throat ratio not low spherecity2 elongated merge input1 a input2 b input3 c input4 d output sphericity1 not round throat ratio medium coordination low spherecity2 not round merge 
791,this paper introduces a thermo hydro mechanical computational model for freezing and thawing in porous media domains with focus on freezing and thawing in soil the model is formulated based on the averaging theory and discretized using a mixed discretization scheme where the standard and extended finite element methods are simultaneously employed it is capable of capturing the strong coupling between all important phenomena and processes occurring during relatively high freezing thawing rates in porous media solid and fluid compressibility buoyancy phase change thermomechanical behavior water volume change pores expansion cryogenic suction melting point depression and water migration to the freezing zone are all considered in the model the cryogenic suction in particular is central to the occurrence of many of these phenomena and processes and thus treated as a primary state variable and discretized using the partition of unity method to make sure that it can be captured accurately the paper presents detailed formulation of the governing equations and the numerical discretization verification and numerical examples are given to demonstrate the accuracy and computational capability of the model in describing the behavior of a soil mass subjected to boundary conditions resembling those occurring in the vicinity of an energy pile the numerical examples show that the model is effectively mesh independent and can simulate all important phenomena using relatively coarse meshes keywords freezing thawing in soil energy pile cryogenic suction cryosuction thm model melting point depression ice lens 1 introduction freezing of water in porous media is a natural phenomenon which is of interest in a wide range of engineering applications including geotechnical engineering environmental engineering soil physics food industry and biomechanics just to name a few this paper focuses on freezing and thawing in soil though the model is generic and can readily be adopted for other applications in particular it focuses on freezing and thawing of soil in the vicinity of energy piles anstett et al 2005 the energy pile is a new shallow geothermal technology that utilizes the foundation piles as heat exchangers for heating and cooling of buildings normally users of this technology are restricted by operating the energy system to temperatures well above water freezing point to ensure that no thermally induced damages occur to the piles and the soil pile interaction however this restriction would significantly limit the amount of energy that can be extracted from the earth the goal of this work is to extend the operational limits of the system by studying the scenarios that might occur due to freezing and thawing of the soil mass and their consequences on the pile and provide the criteria for operating the energy piles at temperatures below the freezing point this paper is a step towards this goal it introduces a computational model describing freezing and thawing in a soil mass subjected to boundary conditions resembling those occurring in energy pile applications water freezing in porous media has been extensively studied experimentally and theoretically experimental studies have demonstrated that porous materials at temperatures well below freezing point preserve significant amount of unfrozen liquid water in their pores this characteristic is hypothesized to be attributed to two mechanisms interfacial premelting and curvature induced premelting wettlaufer and worster 2006 the interfacial premelting gives rise to an unfrozen thin film of liquid water at the contact surface between the ice crystals and the solid particles the curvature induced premelting generates supercooled pore water arising from the crystal ice surface curvature normally the premelting mechanisms are negligible in many applications but in soil as the specific surface area can be remarkably high and the surface curvature can be small these mechanisms can sum up to a significant amount of unfrozen water leading to what is known as the melting point depression the melting point depression in porous media is associated with the development of thermally induced negative pore pressure known as cryogenic suction williams and smith 1991 also denoted as cryosuction negative pore pressure of 11 to 12 atm generates from every degree celsius below zero the cryogenic suction gives rise to water migration from the unfrozen region to the frozen region the migrated water can create pockets where it amalgamates to form ice lens this phenomenon is important in permafrost regions like arctic and antarctic but for an energy pile application it is of minor significance however laboratory experiments on soil samples have shown that segregated ice lenses are generated in the frozen zone ming et al 2016 steiner et al 2017 formation of the ice lenses and migration of water to the frozen region lead to expansion of porosity giving rise to frost heaving the amount of frost heaving in a porous domain depends among others on the temperature gradient overburden pressure soil stiffness and the thermodynamic properties of water water in particular exhibits some unique abnormalities its specific volume above 4 c decreases with decreasing temperature down to 4 c below which unlike other materials its specific volume increases with decreasing temperature apparently soil freezing is a complicated phenomenon which encompasses highly coupled processes associating premelting to generation of cryogenic suction to expansion of porosity to formation of ice lenses to frost heaving upon thawing these processes undergo reversing action manifested by the diminishing of cryogenic suction retreating of water to its initial equilibrium condition and reversing the frost heaving to become thawing settlement evidently this strong coupling between thermal hydraulic and mechanical behavior in response to freezing and thawing necessitates considering all aforementioned processes in the model besides the significance of these processes is considerably affected by the geometry of the problem the gravitational forces and the material characteristics and hence the use of proper constitutive relationships and advanced numerical discretization schemes are essential attempts to model freezing and thawing in soil can be categorized into three types of models thermo hydraulic th models thermo mechanical tm models and thermo hydro mechanical thm models the th models are formulated based on the conservation of mass and energy equations with no regard given to the linear momentum equilibrium equation of the solid matrix models introduced by harlan 1973 guymon and luthin 1974 takagi 1979 gilpin 1980 o neill and miller 1985 konrad and duquennoi 1993 and sheng et al 1995 are among the th category the tm models are formulated based on the conservation of energy and linear momentum equations with no regard given to the fluid mass conservation equation the model introduced by kruschwitz and bluhm 2005 for instance is among the tm category models of this category ignore the cryogenic suction and its associated water mass migration to the frozen zone the thm models are formulated based on the conservation of mass energy and linear momentum equations models introduced by mikkola and hartikainen 2001 nishimura et al 2008 thomas et al 2009 and ming et al 2016 are among this category these models simulate soil freezing with different level of complexities with a noteworthy work given by zhou and meschke 2013 who introduced a thm model based on the theory of thermo poro elasticity of coussy 2005 and the theory of premelting dynamics of wettlaufer and worster 2006 the essence of this work is in the use of entropy for deriving the constitutive relationships of the materials the aforementioned models have been formulated based on the finite difference finite volume and finite element methods the focus was on simulating the physics of the problem and mainly standard discretization procedures have been employed to describe the primary state variables as a consequence these models entail the use of fine grids mainly if the freezing rate is high and the cryogenic suction is of interest nevertheless recent works on soil freezing focus also on the numerical procedure bekele et al 2017 presented an isogeometric finite element model for modeling artificial ground freezing this technique makes use of the computer aided design cad basis functions to formulate the finite elements which characteristically have better capabilities in describing the geometry na and sun 2017 introduced a stabilized finite element model for freezing and thawing of an elasto plastic porous domain they adopt a stabilization technique to counteract the lack of two fold inf sup condition and ill conditioning due to using primary state variables of different nature to prevent the likely occurrences of spurious oscillations recently amiri et al 2018 introduced a th model using the extended finite element method xfem to model the temperature discontinuity at the ice water interface in this work focus is placed on both the physics of the problem and the computational efficiency of the model compared to all existing works this work is distinct by three main features 1 the comprehensive mathematical formulation of the physics and the generic employment of the constitutive relationships 2 the choice of the primary state variables and 3 the use of the partition of unity to discretize the cryogenic suction these features and their novelty are highlighted in section 2 in section 3 details of the governing equations including the conservation equations constitutive relationships and initial and boundary conditions are given a step by step mixed finite element discretization scheme is presented in section 4 a partial verification exercise describing the model accuracy in simulating a numerical thawing benchmark case is given in section 5 section 6 presents a numerical example highlighting the complete features of the model the conclusions of this work are outlined in section 7 appendices a c provide additional details including the water equation of state eos the linearized equations and the complete components of finite element matrices and vectors 2 modeling approach developing an accurate efficient and effectively mesh independent model for freezing and thawing in deformable porous media requires a well designed conceptual model a descriptive mathematical formulation a good choice of the primary state variables and a well suited numerical method we undertake a conceptual model that comprises a saturated three phase deformable porous medium domain subjected to relatively high freezing thawing rates boundary conditions the porous domain constitutes a solid phase porous matrix and water which can be in a liquid phase ice phase or a mixture the conceptual model incorporates all important physical and thermodynamic phenomena and processes occurring during freezing and thawing in porous media including solid and fluid compressibility buoyancy phase change thermomechanical behavior pore volume expansion water volume change cryogenic suction melting point depression and water migration to the freezing zone the balance equations are formulated based on the representative elementary volume rev averaging theory lewis and schrefler 1998 phenomenological constitutive relationships and equations of state are employed for the solid and water phases the solid phase is considered temperature dependent elastic with its modulus of elasticity being a function of temperature the water equation of state is adopted from the international association for the properties of water and steam iapws 2007 the water and ice thermal expansion heat conductivity and dynamic viscosity are considered functions of temperature the clausius clapeyron relation describing the thermodynamic equilibrium between the frozen and unfrozen water contents in the porous domain is utilized to describe the cryogenic suction an empirical relationship describing the melting point depression is formulated water flow is governed by darcy s law and the relative permeability of the liquid water is described using the brooks and corey 1964 relationship appropriate choice of the primary state variables is very important for obtaining a stable numerical scheme as indicated above the conceptual model encompasses all important features involved in freezing and thawing of a porous domain constituting a solid phase liquid water phase ice phase and a water mixture as it will be apparent later on this paper the governing equations contain 21 mechanical and thermodynamic state variables describing the thermo hydro mechanical behavior of the domain and its constitutive relationships as the freezing and thawing processes in nature are relatively slow the state variables are smooth except for the cryogenic suction which exhibit a sharp increase jump for every degree celsius below zero as a consequence the cryogenic suction is considered here a primary state variable to have it directly computed from solving the finite element equations rather than been calculated in the post processing however its magnitude is restrained by the clausius clapeyron relation accordingly the model is formulated based on displacement pressure enthalpy cryosuction formulation with the primary state variables solid phase displacement u water mixture pressure p m water mixture specific enthalpy h m solid specific enthalpy h s and cryousuction s c the other 16 variables are dependent and defined by their relevant constitutive relationships the numerical solution is conducted using a mixed finite element discretization scheme in which state variables exhibiting continuous nature are discretized using the standard galerkin finite element method sg and those exhibiting high gradient are discretized using the extended finite element method xfem the mixed discretization scheme is similar to the well known mixed finite element method in that it allows using different primary state variables such as pore pressure and solid displacement but differs in its discretization approach in the mixed finite element method all primary state variables are discretized using a single discretization scheme such as sg but in the mixed discretization scheme the primary state variables can be discretized in different ways depending on their physical nature al khoury and sluys 2007 arzanfudi and al khoury 2017 xfem is an enhanced finite element scheme based on the partition of unity principles to model discontinuities and high gradient fields regardless of the finite element mesh it enables using structured and fixed meshes in this work the solid phase displacement u water mixture pressure p m water mixture specific enthalpy h m and solid specific enthalpy h s are discretized using sg and the cryogenic suction s c is discretized using xfem 3 governing equations the representative elementary volume rev averaging theory is utilized to formulate the governing equations lewis and schrefler 1998 for a multiphase system the averaging theory entails that each phase is assumed occupying the whole volume of rev and is distributed continuously over it regardless of its detailed heterogeneity the phases are distinct from each other by their physical properties and velocities and their mass and volume fractions within rev the size of rev must be significantly larger than the size of heterogeneity of the matter but much smaller than the size of the bulk material the porous domain is assumed saturated isotropic and non isothermal with local thermal equilibrium it constitutes a solid matrix and water with the solid matrix exhibiting deformation due to coupling between water freezing pore expansion and cryogenic suction and the water exhibiting thermally induced phase change from liquid to solid ice and vice versa the three phases solid liquid water and ice might interact physically with each other and exchange mass momentum and energy at their contact interfacial areas as mentioned in section 2 the model contains 21 state variables divided into 5 primary state variables and 16 dependent variables the partial differential equations describing the conservation of momentum mass and energy in a multiphase porous medium domain are expressed in terms of the primary state variables u p m h m h s s c as given below in sections 3 1 3 3 section 3 4 describes the relevant constitutive relationships for the 16 dependent variables these two sets of equations together with the initial and boundary conditions section 3 5 formulate the governing field equations which are numerically solved in section 4 3 1 momentum balance equation the averaged macroscopic linear momentum balance equation of a multiphase domain constituting a solid phase a liquid water phase and an ice phase and subjected to thermo hydro mechanical forces can be expressed in an incremental form as 1 d t l u t 1 3 m β s t s t m α p s t ρ e f f t g 0 where u is the displacement vector t s is the porous matrix temperature d t is the tangential solid stiffness matrix β s is the solid volumetric thermal expansion coefficient α is biot s coefficient g is the gravitational vector m 1 1 1 0 0 0 t and ρ eff and p s are the effective mass density and the pressure exerted by the water phase on the solid phase defined as 2 ρ e f f 1 φ ρ s φ s i c e ρ i c e φ s l w ρ l w p s s l w p l w s i c e p i c e and l is a differential operator given by 3 l x 0 0 y 0 z 0 y 0 x z 0 0 0 z 0 y x t in which φ is the porosity ρ s ρ lw and ρ ice are the mass density of solid liquid water and ice respectively and s lw and s ice are the liquid water and ice saturations the dependent variables in eq 1 are functions of the primary state variables such that t s t s h s p s p s p m h m s c and ρ eff ρ eff p m h m with the subscript m denoting the water mixture liquid water and ice using the chain rule the derivatives of these dependent variables can then be expressed as 4 t s t t s h s h s t 1 c p s h s t 5 p s t p s h m h m t p s p m p m t p s s c s c t 6 ρ e f f t ρ e f f h m h m t ρ e f f p m p m t where c ps is the specific heat capacity of the solid phase h m is the water mixture specific enthalpy h s is the solid specific enthalpy and s c is the cryosuction substituting eqs 4 6 into eq 1 gives 7 d s l u t 1 3 m β s 1 c p s h s t m α p s h m h m t p s p m p m t p s s c s c t ρ e f f h m h m t ρ e f f p m p m t g 0 by this derivation the momentum balance equation eq 1 is formulated in terms of the primary state variables u p m h m h s and s c 3 2 mass balance equation the averaged macroscopic mass balance equations for the solid phase liquid water phase ice phase and the mixtures are solid matrix phase the mass balance equation for the solid phase can be expressed as 8 1 φ ρ s ρ s t φ t 1 φ m t l u t 0 the constitutive relationship for the solid mass density can be described as lewis and schrefler 1998 9 1 ρ s ρ s t 1 1 φ α φ 1 k s p s t β s α φ t s t 1 α m t l u t in which k s is the bulk modulus of the solid grains substituting eqs 4 and 5 into eq 9 gives 10 1 ρ s ρ s t 1 1 φ α φ 1 k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t 1 α m t l u t substituting eq 10 into eq 8 and rearranging yields 11 φ t α φ k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t φ α m t l u t which indicates that the porosity is a function of enthalpy pore pressure cryosuction and solid matrix displacement liquid water phase the mass balance equation for the liquid water phase can be written as 12 φ t φ ρ l w ρ l w t φ s l w s l w t 1 s l w ρ l w ρ l w v l w φ m t l u t m l w i c e s l w ρ l w in which v lw is the mass averaged velocity of liquid water and m lw ice is the mass exchange rate between liquid water and ice arising from the phase change inserting eq 11 into eq 12 yields 13 α φ k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t α m t l u t φ ρ l w ρ l w t φ s l w s l w t 1 s l w ρ l w ρ l w v l w m l w i c e s l w ρ l w applying the chain rule to the liquid water density and saturation gives 14 ρ l w t ρ l w p m p m t ρ l w h m h m t 15 s l w t s l w p m p m t s l w h m h m t substituting eqs 14 and 15 into eq 13 and re arranging results in 16 α φ k s s l w ρ l w p s p m φ s l w ρ l w p m φ ρ l w s l w p m p m t α φ k s s l w ρ l w p s h m φ s l w ρ l w h m φ ρ l w s l w h m h m t α φ k s s l w ρ l w p s s c s c t β s α φ s l w ρ l w 1 c p s h s t α s l w ρ l w m t l u t ρ l w v l w m l w i c e ice phase similar to liquid water the mass balance equation of the ice phase can readily be derived to give 17 α φ k s s i c e ρ i c e p s p m φ s i c e ρ i c e p m φ ρ i c e s i c e p m p m t α φ k s s i c e ρ i c e p s h m φ s i c e ρ i c e h m φ ρ i c e s i c e h m h m t α φ k s s i c e ρ i c e p s s c s c t β s α φ s i c e ρ i c e 1 c p s h s t α s i c e ρ i c e m t l u t ρ i c e v i c e m l w i c e where v ice is the mass averaged velocity of ice water mixture liquid water and ice consider the following identities 18 s l w s i c e 1 ρ m s l w ρ l w s i c e ρ i c e s l w ρ l w h m ρ l w s l w h m s i c e ρ i c e h m ρ i c e s i c e h m s l w ρ l w h m s i c e ρ i c e h m s l w ρ l w s i c e ρ i c e h m ρ m h m summing eqs 16 and 17 and using eq 18 gives the mass balance equation of the water mixture as 19 α φ k s ρ m p s p m φ ρ m p m p m t α φ k s ρ m p s h m φ ρ m h m h m t α φ k s ρ m p s s c s c t β s α φ ρ m 1 c p s h s t α ρ m m t l u t ρ l w v l w ρ i c e v i c e 0 the ice velocity is negligible and can be ignored v ice 0 and the liquid water velocity can be described using darcy s law as 20 v l w k k r l w μ l w p l w ρ l w g in which k rlw and μ lw are the relative permeability and dynamic viscosity of the liquid water the water mixture pressure p m in eq 19 can be expressed as 21 p m p l w s c which indicates that before freezing s c 0 and hence the mixture pressure is equal to the liquid pressure p lw but upon freezing the cryogenic suction builds up and rapidly becomes much higher than the liquid pressure leading to the mixture pressure to be nearly equal to the ice pressure p ice inserting eq 21 into eq 20 gives 22 v l w k k r l w μ l w p m s c ρ l w g substituting eq 22 into eq 19 results in 23 d 1 p m t d 2 h m t d 3 h s t d 4 m t l u t e 1 s c t c 1 p m c 2 s c g 1 0 in which 24 d 1 φ ρ m p m α φ k s ρ m p s p m d 4 α ρ m d 2 φ ρ m h m α φ k s ρ m p s h m c 1 ρ l w k k r l w μ l w d 3 ρ m β s α φ 1 c p s c 2 ρ l w k k r l w μ l w e 1 α φ k s ρ m p s s c g 1 ρ l w k k r l w μ l w ρ l w g as for the momentum balance equation the mass balance equation eq 23 is formulated in terms of the primary state variables 3 3 energy balance equation the averaged macroscopic energy balance equation for a multiphase domain exhibiting local thermal equilibrium can be expressed as 25 t 1 φ ρ s h s φ ρ m h m 1 φ p s φ p m φ ρ m h m m t l u t ρ l w h l w v l w λ e f f t s 0 where h lw is the specific enthalpy of liquid water p s is the mean effective stress and 26 λ e f f 1 φ λ s φ s i c e λ i c e φ s l w λ l w is the effective thermal conductivity of the porous domain with λ s λ lw and λ ice denoting the thermal conductivity of the porous solid liquid water and ice respectively the temperature gradient can be described as 27 t s t h s h s 1 c p s h s substituting eqs 20 and 27 into eq 25 and expanding the time derivatives results in 28 ρ m h m ρ s h s p m p s φ t 1 φ h s ρ s t 1 φ ρ s h s t φ ρ m h m t φ h m ρ m t 1 φ p s t φ p m t φ ρ m h m m t l u t ρ l w h l w k k r l w μ l w p m s c ρ l w g λ e f f 1 c p s h s 0 applying the chain rule to the mixture mass density time derivative gives 29 ρ m t ρ m p m p m t ρ m h m h m t substituting eq 10 eq 11 and eq 29 into 28 leads to 30 d 5 h s t d 6 h m t d 7 p m t d 8 m t l u t e 2 s c t c 3 p m c 4 s c c 5 h s g 2 0 in which 31 d 5 1 φ ρ s β s α φ ρ m h m p m p s 1 c p s c 3 ρ l w h l w k k r l w μ l w d 6 φ ρ m φ h m ρ m h m ρ m h m p m p s α φ k s p s h m c 4 ρ l w h l w k k r l w μ l w d 7 ρ m h m p m p s α φ k s p s p m φ φ h m ρ m p m c 5 1 c p s λ e f f d 8 1 φ ρ s h s α ρ m h m φ α p m p s 1 φ k t g 2 ρ l w h l w k k r l w μ l w ρ l w g e 2 ρ m h m p m p s α φ k s p s s c in which k t is the bulk modulus of the solid skeleton eq 30 is the energy balance equation formulated in terms of the primary state variables since the specific enthalpies of water and solid phases are primary state variables the local thermal equilibrium can only be satisfied by imposing this constraint 32 t s t m 0 in which t m is the water mixture temperature using eq 27 this equation can be written as 33 1 c p s h s t m 0 3 4 constitutive relationships 3 4 1 porous matrix the stiffness matrix of a three dimensional isotropic solid is described as 34 d t e t t 1 ν s 1 2 ν s 1 ν s ν s ν s 0 0 0 1 ν s ν s 0 0 0 1 ν s 0 0 0 1 2 ν s 2 0 0 s y m m e t r i c 1 2 ν s 2 0 1 2 ν s 2 where ν s is poisson s ratio and e t t is a temperature dependent elastic modulus defined here as 35 e t t e 0 e b t s t 0 where e 0 is the young s modulus at a reference temperature t 0 and b is a material parameter it is worth noting though that the assumption of a temperature dependent linear elastic behavior of the solid matrix might be reasonable during freezing but upon thawing and repetitive freezing thawing cycles the behavior might become non linear elasto plastic modeling such a behavior will be treated in a follow up work 3 4 2 water equation of state eos the thermodynamic state variables and properties of the liquid water ice and the water mixture ρ m t m ρ ice ρ lw s ice s lw λ ice λ lw μ lw are obtained from the equation of state of water adopted from iapws 2007 and other relevant literature given in appendix a 3 4 3 melting point depression pore liquids in porous media freeze at temperatures well below their bulk freezing melting points the melting point is inversely proportional to the pore size as given by the gibbs thomson equation the use of this equation for porous media requires knowledge of the pore geometry solid liquid interface energy and the wetting angle inside the pores quantities which are normally difficult to measure especially for geoscience applications instead several empirical relationships have been obtained from experimental measurements of macroscopic specimens or from assuming the similarity between the soil water curves swc describing the relationship between the capillary pressure and the moisture content and the soil freezing curves sfc describing the relationship between the sub zero temperatures and the unfrozen water content kurylyk and watanabe 2013 presented an interesting review describing different forms of the clapeyron equation and empirical methods for describing the sfc relationships here we adopt an exponential function of the form 36 s l w s 1 s e a t w t f in which s is the residual unfrozen water content at a relatively cold condition t f is the bulk freezing temperature and a is a material constant this kind of constitutive relationships are easy to implement and can readily be obtained from relatively simple laboratory experiments on the type of soil under study nevertheless the proposed model is generic and any other constitutive relationship can be considered 3 4 4 cryogenic suction as indicated in section 2 the cryogenic suction s c exhibits a jump at every degree celsius below zero as a consequence the cryogenic suction is considered here a primary state variable to have it directly computed from solving the finite element equations see eq 69 rather than been calculated in the post processing however the computed quantity has to satisfy the clausius clapeyron relation lewis and schrefler 1998 37 s c ρ i c e l f ln t m t f where l f is the latent heat of fusion of water to satisfy this condition the following constraint is imposed 38 ρ i c e l f ln t m t f s c 0 which for simplicity of notation can be written as 39 f s c s c 0 3 4 5 relative permeability even though the domain is fully saturated the water exhibits phase change during freezing and thawing giving rise to a quasi partially saturated condition within the water phase as for the partially saturated conditions calculating this effect necessitates the use of the relative permeability coefficient as given in eq 20 here the relative permeability of liquid water is described based on the brooks and corey relationship brooks and corey 1964 40 k r l w s l w 2 3 η η where η is a material constant 3 5 initial and boundary conditions initially at t 0 the primary state variables are expressed as 41 g x 0 g 0 x where g can be any of the primary state variables u pm hm hs or sc the dirichlet boundary conditions might be described as 42 j t j t o n γ u where γ u is the dirichlet boundary and j can be any of the primary state variables the neumann boundary conditions for the mechanical hydraulic and conductive and convective thermal boundary conditions might be described respectively as 43 t σ n q l w ρ l w v l w n q cond λ e f f t s n on γ q q conv ρ l w h l w v l w n where γ q is the neumann boundary t is the prescribed traction q lw is the prescribed mass flow rate of liquid water and q cond and q conv are the prescribed conductive and convective heat fluxes respectively 4 finite element mixed discretization the model encompasses state variables of significantly different nature describing highly coupled thermo hydro mechanical processes it comprises porous matrix deformation and heat and fluid flow occurring due to gravity buoyancy thermal expansion and cryogenic suction discretizing such a system using standard finite element method can cause spurious oscillations and requires extensive cpu time and capacity importantly the standard finite element method fails to capture the jump in the cryogenic suction as it will be highlighted in the numerical example in section 6 here a mixed finite element discretization scheme is utilized for modeling relatively high freezing thawing rates in porous media the primary state variables that represent relatively smooth continuous fields namely the displacement enthalpy and pressure are discretized using the standard finite element method and the cryogenic suction is discretized using the partition of unity method within the framework of the extended finite element method a fixed and structured finite element discretization scheme is adopted 4 1 weak form formulation the weighted residual method is utilized to formulate the finite element equations in total five equations are discretized three conservation equations momentum eq 7 mass eq 23 and energy eq 30 a local thermal equilibrium constraint equation eq 33 and a cryosuction constraint equation eq 39 appling the standard weighted residual discretization procedure to eqs 7 23 30 and 33 yields momentum balance 44 ω l t w d s l u t d ω ω l t w d s 1 3 m β s 1 c p s h s t d ω ω l t w m α p s h m h m t d ω ω l t w m α p s p m p m t d ω ω l t w m α p s s c s c t d ω ω w ρ e f f h m h m t g d ω ω w ρ e f f p m p m t g d ω γ q w t t d γ 0 mass balance 45 ω w d 1 p m t d ω ω w d 2 h m t d ω ω w d 3 h s t d ω ω w d 4 m t l u t d ω ω w e 1 s c t d ω ω w c 1 p m c 2 s c g 1 d ω γ q w q l w d γ 0 energy balance 46 ω w d 5 h s t d ω ω w d 6 h m t d ω ω w d 7 p m t d ω ω w d 8 m t l u t d ω ω w e 2 s c t d ω ω w c 3 p m c 4 s c c 5 h s g 2 d ω γ q w q adv d γ γ q w q cond d γ 0 local thermal equilibrium constraint 47 ω w 1 c p s h s d ω ω w t m d ω 0 appling the partition of unity weighted residual discretization procedure to the cryosuction constraint equation eq 39 yields cryosuction constraint continuous 48 ω w f s c d ω ω w s c d ω 0 enhanced 49 ω w f s c d ω ω w s c d ω 0 where w and w are the standard and enhanced weighting functions 4 2 linearization the newton raphson method is utilized to linearize the problem the primary state variables and their time derivatives and gradients are linearized as 50 y r 1 y r δ y y r 1 y r δ y y u p m h m h s s c y r 1 y r δ y where r 1 denotes the current iteration and δ is the associated variation in the variable the dependent variables tm tm pm hm ρ eff ρ eff pm hm fsc fsc pm hm and ps ps pm hm sc and their derivatives are linearized as 51 x r 1 x r x h m r δ h m x p m r δ p m x t m ρ e f f f s c 52 ρ e f f h m r 1 ρ e f f h m r 2 ρ e f f h m 2 r δ h m 2 ρ e f f h m p m r δ p m 53 ρ e f f p m r 1 ρ e f f p m r 2 ρ e f f p m h m r δ h m 2 ρ e f f p m 2 r δ p m 54 p s r 1 p s r p s h m r δ h m p s p m r δ p m p s s c r δ s c 55 p s h m r 1 p s h m r 2 p s h m 2 r δ h m 2 p s h m p m r δ p m 2 p s h m s c r δ s c 56 p s p m r 1 p s p m r 2 p s p m h m r δ h m 2 p s p m 2 r δ p m 2 p s p m s c r δ s c 57 p s s c r 1 p s s c r 2 p s s c h m r δ h m 2 p s s c p m r δ p m 2 p s s c 2 r δ s c the coefficients in eqs 23 and 30 d 1 d 2 d 6 d 7 d 8 e 1 e 2 g pm hm sc andd 3 d 4 d 5 c 1 c 2 c 3 c 4 c 5 g 1 g 2 j pm hm are linearized as 58 g r 1 g r g h m r δ h m g p m r δ p m g s c r δ s c g d 1 d 2 d 6 d 7 d 8 e 1 e 2 59 j r 1 j r j h m r δ h m j p m r δ p m j d 3 d 4 d 5 c 1 c 2 c 3 c 4 c 5 g 1 g 2 the evolution of porosity eq 11 and the temperature dependent elastic modulus eq 35 are treated explicitly by updating their values at every time step substituting eqs 50 59 into eqs 45 47 eliminating the high order differentials and rearranging yields the linearized weak form finite element equations for the mass balance energy balance local thermal equilibrium constraint and the cryosuction constraint these equations are listed in appendix b 4 3 mixed fe formulation using the galerkin finite element method the solid displacement mixture pressure mixture specific enthalpy and solid phase specific enthalpy are discretized as 60 u x t n u x u t 61 p m x t n x p m t 62 h m x t n x h m t 63 h s x t n x h s t using the partition of unity the cryogenic suction is discretized as 64 s c x t n x s c t n x s c t in which the barred values are the nodal values n is the standard finite element shape function vector and 65 n x n x ψ x is the enhanced shape function with ψ the partition of unity enhancement function described here as 66 ψ x e x x ℓ c in which x is the normal projection of x on the freezing boundary γ q and ℓ c is a characteristic length which can be a property of the porous matrix the weight functions in eqs 44 49 are defined as 67 w n 68 w n substituting eqs 60 68 into the linearized equations in appendix b gives the finite element equations which can be described in a compact form as 69 k δ x c δ x f k 0 x r c 0 x r where 70 δ x δ u δ p m δ h m δ h s δ s c δ s c t δ x δ u δ p m δ h m δ h s δ s c δ s c t x r u r p m r h m r h s r s c r s c r x r u r p m r h m r h s r s c r s c r t f f 1 f 2 f 3 f 4 f 5 f 6 t the coefficients of the matrices and vectors of eq 69 are given in appendix c eq 69 is a semi discrete system of equations which can be solved using any of the time integration schemes here we use a fully implicit finite difference time integration scheme 5 model verification verifying the accuracy of the model against experimental work or numerical codes is not readily accessible as either the experimental set ups are not necessarily designed to examine all features of the model or the numerical codes are not appropriately verified validated or designed to be utilized as a reference case nevertheless recently an important comparison exercise is devised to numerically validate the accuracy and performance of th numerical codes introduced by grenier et al 2018 thirteen numerical codes with different numerical approaches spatial and temporal discretization schemes and computational efficiency were tested to examine two dimensional 2d thawing benchmark cases here we make use of this exercise to partially verify the introduced thm model a thawing benchmark case termed th2 in grenier et al 2018 is simulated this benchmark case examines heat and fluid flow in a 2d porous medium domain 3 m x 1 m initially at 5 c and includes a 0 333 m x 0 333 m initially frozen zone at 5 c the domain is closed at the top and bottom boundaries and insulated against conduction from the top bottom and right boundaries but subjected to a head difference of 0 03 m m from the left boundary fig 1 shows the geometry and initial and boundary conditions of this benchmark case the analysis is conducted by letting the frozen zone to thaw naturally for approximately 55 hr the analysis is conducted using the full feature thm model but to eliminate the effect of solid phase deformation the elastic modulus is made relatively high 10 gpa the material parameters and constitutive relationships as given by grenier et al 2018 are implemented except for the water and ice properties for which we utilized the water equation of state given in appendix a the water and ice properties in the reference benchmark are treated as constants the finite element domain is discretized using 2d linear quadrilateral finite elements the analysis is conducted on half of the domain using two mesh sizes 374 and 1134 elements fig 2 shows the computational results at 22 860 s and later obtained from both meshes it would have been ideal if the digital file of the reference benchmark had been accessible but comparing fig 2 at 22 860 s to fig 2b p 200 of grenier et al 2018 it can readily be noticed that the two results are very close the small difference however can be attributed to the way the ice and water properties are defined also it can be noticed that the coarse mesh 374 elements gave rather close results to the finer mesh 1134 elements indicating that the model is effectively mesh independent both meshes however are much smaller than those utilized in solving the reference benchmark fig 3 shows the evolution of the minimum temperature with time comparing this figure to fig 9a p 207 of grenier et al 2018 reveals that the two results are very close and as mentioned above the small difference in the results can be attributed to the difference in ice and water properties the same can be observed in comparing the evolution of the water volume with time given in fig 4 with that in fig 9b p 207 of grenier et al 2018 thus it can be concluded that the introduced thm model is capable of handling cases which are considered to be computationally challenging however this verification exercise does not reflect all features of the model and in order to highlight the complete features a more involved numerical example is given in the next section 6 numerical example a numerical example demonstrating the capabilities of the model to simulate a freezing and thawing cycle in soil is presented the geometry is designated to resemble a soil mass surrounding an energy pile an axial symmetric soil mass 24 5 m diameter and 12 m deep subjected to a 10 m long and 0 5 m diameter cylindrical heat source is simulated the heat source represents an energy pile coinciding along the symmetrical axis of the soil as shown in fig 5 initial and boundary conditions initially the temperature in the soil mass is assumed 5 c the pressure is hydrostatic and the horizontal effective stress is equal to overlying soil mass thermal mechanical and hydraulic boundary conditions are imposed the right hand side boundary is prescribed by 1 a constant temperature of 5 c 2 an overburden pressure equal to the weight of the soil mass and 3 made hydraulically open for groundwater flow the top and bottom boundaries are considered thermally insulated and hydraulically closed the left and bottom boundaries are supported by rollers to restrict the normal displacements to these boundaries at the contact surface between the soil mass and the heat source a cauchy boundary condition describing a heat flux arising due to their thermal interaction is imposed as 71 q b t s t p in which b is the thermal interaction coefficient and t p is a prescribed heat source temperature simulating a 28 days freezing thawing cycle shown in fig 6 material parameters and constitutive relationships table 1 lists the physical and thermomechanical properties of the materials fig 7 shows the soil elastic modulus versus temperature as given by eq 35 and the soil freezing curve sfc as given by eq 36 finite element analysis the finite element domain is discretized using 400 linear quadrilateral axisymmetric finite elements the axial symmetric finite element is formulated by solving the finite element system of equations eq 69 in the cylindrical coordinate system r z fig 8 shows the computational results for temperature cryogenic suction porosity expansion and deformed mesh at three instants in time just before freezing t 5 days during freezing t 14 days and just after freezing t 19 days fig 8a shows that as the temperature is above freezing point there is no sign of cryogenic suction and the porosity expansion and solid matrix heaving are minimal fig 8b shows that upon freezing the cryogenic suction arises associated with porosity expansion and frost heaving fig 8c shows that by thawing the cryogenic suction disappears and the porosity and heaving are decreased fig 9 shows the temporal evolution of temperature cryogenic suction porosity and heaving at point a r 0 25 m z 0 0 m shown in fig 5 at the surface fig 9a shows the evolution of temperature which reaches its minimum value of 4 9 c after 14 days followed by an increase in response to the temperature increase in the heat source fig 9b shows the evolution of cryogenic suction with its value reaches its maximum of 5 5 mpa 55 bar after 14 days in association with the minimum temperature fig 9c shows the evolution of porosity which closely follows the evolution of cryogenic suction the maximum reached porosity is ϕ 0 35 an increase of 17 of its initial value of 0 3 with thawing the porosity reduces to 0 33 after 19 days keeping some of the migrated moisture but after 28 days it becomes 0 3005 almost contracted to its initial value fig 9d shows the frost heaving at point a it shows that it evolves in association with the onset of cryosuction and pore expansion upon freezing it reached uz 0 052 m but during thawing most of the heave has been reversed and the remaining heave after 19 days is 0 033 m and after 28 days is 0 002 m apparently the nearly full reverse of the heave is due to the use of an elastic constitutive model for the solid phase caicedo 2017 has shown experimentally that during thawing the fine sand exhibits nearly full reversal of heave but the silt is irreversible leaving a considerable residual heave this difference in behavior among different soil materials necessitates the use of a proper elasto plastic model to simulate accurately the behavior under different freezing and thawing boundary conditions fig 10 shows the water flow vectors after 5 days just before freezing and after 14 days at the peak of freezing the figure shows that before freezing the water migrates from the cold region to the warm region due to its volumetric expansion but by the onset of freezing the water flows back to the frozen region due to cryogenic suction fig 11 shows the spatial distribution of temperature cryogenic suction porosity frost heaving ice saturation and liquid water pressure computed at the boundary along the heat source on six instants in times t 0 5 7 8 14 19 days where t 0 represents the initial condition t 5 days represents the time just before freezing t 7 14 days represents the time during freezing and t 19 days represents the time just after thawing the figure demonstrates the strong coupling between the involved phenomena which follow firmly the evolution of temperature an interesting observation can be noticed in fig 11a where during freezing on days 7 and 8 there is a time lag in the advancement of freezing at the upper side of the domain as compared to the lower side this can be attributed to the substantial expansion of porosity in this area as shown in fig 11c the porosity expansion is associated with the migration of unfrozen water from the warm region to the frozen region due to cryosuction giving rise to a warmer temperature another interesting observation can be seen in fig 11d where it shows that there is a neutral heaving point at around z 7m above this point the soil exhibits heaving due to the coupling effect between porosity expansion water volume expansion and the increase of water contents due to cryosuction below this point the soil exhibits contraction due to the overburden pressure fig 11f shows that before freezing the liquid water pressure is hydrostatic but after freezing it becomes negative due to the cryogenic suction examining the computational results reveals that the model is capable of capturing the strong coupling between thermo hydro mechanical phenomena occurring during freezing and thawing in soil a noteworthy feature of the model is the capturing of the jump in the cryogenic suction and its associated porosity expansion and frost heaving capturing such a behavior using a relatively coarse mesh was feasible by two main attributes the first attribute is the choice of the primary state variables especially the inclusion of the cryosuction s c among them and the second attribute is the use of the mixed discretization scheme where s c is discretized using the partition of unity method if use is made of the standard finite element method the jump in the cryogenic suction would not be possible to capture and its value would be underestimated this is shown in fig 12 where all primary state variables are discretized using the standard galerkin finite element method the figure shows that after 14 days of freezing there is no jump in the cryogenic suction as compared to fig 8b and its maximum magnitude is 3 6 mpa theoretically as per eq 37 the cryogenic suction at 4 9 c should be 5 5 mpa 55 bar 7 conclusions this paper presents a computational model capable of simulating the strong coupling between all important thermo hydro mechanical phenomena occurring during freezing and thawing of a porous domain resembling a soil mass surrounding an energy pile the model is formulated based on the averaging theory and discretized using the finite element method three features make the proposed model distinct from others the mathematical formulation of the physics the choice of the primary state variables and the discretization scheme a comprehensive mathematical formulation is employed to describe all important phenomena and processes in freezing thawing of porous media including solid and fluid compressibility buoyancy phase change thermomechanical behavior water volume change pores expansion cryogenic suction melting point depression and water migration to the freezing zone the use of fundamental balance equations within the framework of the averaging theory together with the equations of state of water and generic ice water constitutive relationships make the modeled physics rather wide ranging in current thm models the primary state variables are typically solid displacement pore pressure and temperature the use of these variables might be adequate for slow freezing rates which is the case in nature but for a relatively high freezing rate such as in artificial ground freezing or shallow geothermal systems this choice of state variables would most probably cause critical spurious oscillations unless treated properly na and sun 2017 thoroughly discussed this issue and asserted that the performance of their model was improved only after employing a stabilization technique in the weighted residuals of the mass and energy balance equations in this work we demonstrated that treating the cryogenic suction as a primary state variable alleviates this problem and in this case even the standard galerkin finite element method sg can handle relatively high freezing thawing rate problems however as discussed in section 6 and shown in fig 12 sg falls short from capturing the rapid rise of the cryogenic suction but tends to smear it we tackled this issue by discretizing the cryogenic suction using the partition of unity method the governing equations are solved using a mixed finite element discretization scheme where the continuous and smooth primary state variables namely the solid phase displacement water mixture pressure water mixture specific enthalpy and solid specific enthalpy are discretized using the standard galerkin finite element method and the cryogenic suction is discretized using the partition of unity within the framework of xfem this combination has enabled the simulation of a relatively high freezing thawing rate problem and resulted into an accurate robust and effectively mesh independent numerical scheme acknowledgements the authors acknowledge the financial support by nwo netherlands organization for scientific research under grant number 14698 they highly appreciate fundex piles company deltares geotechnics consultancy company and tno diana finite element company for their in kind contributions and technical support and the green village of delft for accommodating the energy pile they would also like to thank the three reviewers for their useful remarks supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 07 013 appendix d supplementary materials image application 1 appendix a water equations of state the water equations of state eos for subcooled liquid water supercooled water and ice are formulated from relevant references given below subcooled liquid water specific heat capacity iapws 2007 c p r h 2 o t m 2 2 γ p m 2 in which r h2o is specific gas constant for water p m p m 16 53 10 6 t m 1386 0 t m and γ p m t m i 1 34 n i 7 1 p m i j t m 1 222 j i where n i i i and j i are material constants density iapws 2007 ρ p m r h 2 o t m p m γ p m viscosity cooper and dooley 2008 μ 100 t m 647 096 i 0 3 h i t m 647 096 i e ρ 322 0 i 0 5 647 096 t m 1 i j 0 6 h i j ρ 322 0 1 j e 0 068 y where y h i and h ij are material constants heat conductivity ramires et al 1994 λ 0 6065 1 48445 4 12292 t m 298 15 1 63866 t m 298 15 2 supercooled liquid water specific heat capacity tombari et al 1999 c p 1 18 01528 10 3 0 044 t m 222 1 2 5 74 3 density hare and sorensen 1987 ρ 0 0228 t m 273 15 2 0 1176 t m 273 15 999 9 viscosity hallett 1963 μ 5 0 10 6 t m 273 15 2 3 0 10 5 t m 273 15 0 0018 heat conductivity benchikh et al 1985 λ 0 0017 t m 273 15 0 5583 ice specific heat capacity fukusako 1990 c p 185 0 6 89 t m 273 15 density fukusako 1990 ρ 917 0 1 1 17 1 0 4 t m 273 15 heat conductivity fukusako 1990 λ 1 16 1 91 8 66 10 3 t m 273 15 2 97 10 5 t m 273 15 2 appendix b linearized balance equations the linearized balance equations from section 4 2 are momentum balance ω l t w d s l u m d ω ω l t w d s l δ u d ω ω l t w d s 1 3 m β s 1 c p s h s r d ω ω l t w d s 1 3 m β s 1 c p s δ h s d ω ω l t w m α p s h m r h m r d ω ω l t w m α p s h m r δ h m d ω ω l t w m α 2 p s h m 2 r h m r δ h m d ω ω l t w m α 2 p s h m p m r h m r δ p m d ω ω l t w m α 2 p s h m s c r h m r δ s c d ω ω l t w m α p s p m r p m r d ω ω l t w m α p s p m r δ p m d ω ω l t w m α 2 p s p m h m r p m r δ h m d ω ω l t w m α 2 p s p m 2 r p m r δ p m d ω ω l t w m α 2 p s p m s c r p m r δ s c d ω ω l t w m α p s s c r s c r d ω ω l t w m α p s s c r δ s c d ω ω l t w m α 2 p s s c h m r s c r δ h m d ω ω l t w m α 2 p s s c p m r s c r δ p m d ω ω l t w m α 2 p s s c 2 r s c r δ s m d ω ω w ρ e f f h m r h m r g d ω ω w ρ e f f h m r δ h m g d ω ω w 2 ρ e f f h m 2 r h m r δ h m g d ω ω w 2 ρ e f f h m p m r h m r δ p m g d ω ω w ρ e f f p m r p m r g d ω ω w ρ e f f p m r δ p m g d ω ω w 2 ρ e f f p m h m r p m r δ h m g d ω ω w 2 ρ e f f p m 2 r p m r δ p m g d ω γ q w t d γ 0 mass balance ω w d 1 r p m r d ω ω w d 1 r δ p m d ω ω w d 1 h m r p m r δ h m d ω ω w d 1 p m r p m r δ p m d ω ω w d 1 s c r p m r δ s c d ω ω w d 2 r h m r d ω ω w d 2 r δ h m d ω ω w d 2 h m r h m r δ h m d ω ω w d 2 p m r h m r δ p m d ω ω w d 2 s c r h m r δ s c d ω ω w d 3 r h s r d ω ω w d 3 r δ h s d ω ω w d 3 h m r h s r δ h m d ω ω w d 3 p m r h s r δ p m d ω ω w d 4 r m t l u r d ω ω w d 4 r m t l δ u d ω ω w d 4 h m r m t l u r δ h m d ω ω w d 4 p m r m t l u r δ p m d ω ω w e 1 r s c r d ω ω w e 1 r δ s c d ω ω w e 1 h m r s c r δ h m d ω ω w e 1 p m r s c r δ p m d ω ω w e 1 s c r s c r δ s c d ω ω w c 1 r p m r d ω ω w c 1 r δ p m d ω ω w c 1 h m r p m r δ h m d ω ω w c 1 p m r p m r δ p m d ω ω w c 2 r s c r d ω ω w c 2 r δ s c d ω ω w c 2 h m r s c r δ h m d ω ω w c 2 p m r s c r δ p m d ω ω w g 1 r d ω ω w g 1 h m r δ h m d ω ω w g 1 p m r δ p m d ω γ q w q l w d γ 0 energy balance ω w d 5 r h s r d ω ω w d 5 r δ h s d ω ω w d 5 h m r h s r δ h m d ω ω w d 5 p m r h s r δ p m d ω ω w d 6 r h m r d ω ω w d 6 r δ h m d ω ω w d 6 h m r h m r δ h m d ω ω w d 6 p m r h m r δ p m d ω ω w d 6 s c r h m r δ s c d ω ω w d 7 r p m r d ω ω w d 7 r δ p m d ω ω w d 7 h m r p m r δ h m d ω ω w d 7 p m r p m r δ p m d ω ω w d 7 s c r p m r δ s c d ω ω w d 8 r m t l u r d ω ω w d 8 r m t l δ u d ω ω w d 8 h m r m t l u r δ h m d ω ω w d 8 p m r m t l u r δ p m d ω ω w d 8 h s r m t l u r δ h s d ω ω w e 2 r s c r d ω ω w e 2 r δ s c d ω ω w e 2 h m r s c r δ h m d ω ω w e 2 p m r s c r δ p m d ω ω w e 2 s c r s c r δ s c d ω ω w c 3 r p m r d ω ω w c 3 r δ p m d ω ω w c 3 h m r p m r δ h m d ω ω w c 3 p m r p m r δ p m d ω ω w c 4 r s c r d ω ω w c 4 r δ s c d ω ω w c 4 h m r s c r δ h m d ω ω w c 4 p m r s c r δ p m d ω ω w c 5 r h s r d ω ω w c 5 r δ h s d ω ω w c 5 h m r h s r δ h m d ω ω w c 5 p m r h s r δ p m d ω ω w g 2 r d ω ω w g 2 h m r δ h m d ω ω w g 2 p m r δ p m d ω γ q w q adv d γ γ q w q cond d γ 0 local thermal equilibrium constraint ω w 1 c p s h s r d ω ω w 1 c p s δ h s d ω ω w t m r d ω ω w t m h m r δ h m d ω ω w t m p m r δ p m d ω 0 cryosuction constraint continuous ω w f s c r d ω ω w f s c h m r δ h m d ω ω w f s c p m r δ p m d ω ω w s c r d ω ω w δ s c d ω 0 enhanced ω w f s c r d ω ω w f s c h m r δ h m d ω ω w f s c p m r δ p m d ω ω w s c r d ω ω w δ s c d ω 0 appendix c components of fe matrices and vectors eq 69 k 0 submatrices k 1 1 0 k 1 2 0 k 1 3 0 k 1 4 0 k 1 5 0 k 1 6 0 0 k 2 1 0 k 2 3 0 k 2 4 0 0 k 2 2 0 ω n t c 1 r n d ω k 2 5 0 ω n t c 2 r n d ω k 2 6 0 ω n t c 2 r n d ω k 3 1 0 k 3 3 0 0 k 3 2 0 ω n t c 3 r n d ω k 3 4 0 ω n t c 5 r n d ω k 3 5 0 ω n t c 4 r n d ω k 3 6 0 ω n t c 4 r n d ω k 4 1 0 k 4 2 0 k 4 3 0 k 4 5 0 k 4 6 0 0 k 4 4 0 ω n t 1 c p s n d ω k 5 1 0 k 5 2 0 k 5 3 0 k 5 4 0 k 5 5 0 k 5 6 0 0 k 6 1 0 k 6 2 0 k 6 3 0 k 6 4 0 k 6 5 0 k 6 6 0 0 c 0 submatrices c 1 1 0 ω b t d s b d ω c 1 2 0 ω b t m α p s p m r n d ω ω n u t ρ e f f p m r gn d ω c 1 3 0 ω b t m α p s h m r n d ω ω n u t ρ e f f h m r gn d ω c 1 4 0 ω b t d s 1 3 m β s 1 c p s n d ω c 1 5 0 ω b t m α p s s c r n d ω c 1 6 0 ω b t m α p s s c r n d ω c 2 1 0 ω n t d 4 r m t b d ω c 2 2 0 ω n t d 1 r n d ω c 2 3 0 ω n t d 2 r n d ω c 2 4 0 ω n t d 3 r n d ω c 2 5 0 ω n t e 1 r n d ω c 2 6 0 ω n t e 1 r n d ω c 3 1 0 ω n t d 8 r m t b d ω c 3 2 0 ω n t d 7 r n d ω c 3 3 0 ω n t d 6 r n d ω c 3 4 0 ω n t d 5 r n d ω c 3 5 0 ω n t e 2 r n d ω c 3 6 0 ω n t e 2 r n d ω c 4 1 0 c 4 2 0 c 4 3 0 c 4 4 0 c 4 5 0 c 4 6 0 0 c 5 1 0 c 5 2 0 c 5 3 0 c 5 4 0 c 5 5 0 c 5 6 0 0 c 6 1 0 c 4 2 0 c 6 3 0 c 6 4 0 c 6 5 0 c 6 6 0 0 f subvectors f 1 γ q n u t t d γ f 2 ω n t g 1 r d ω γ q n t q l w d γ f 3 ω n t g 2 r d ω γ q n t q adv d γ γ q n t q cond d γ f 4 ω n t t m r d ω f 5 ω n t f s c r d ω f 6 ω n t f s c r d ω k submatrices k 1 1 k 1 4 0 k 1 2 ω b t m α 2 p s h m p m r h m r n d ω ω b t m α 2 p s p m 2 r p m r n d ω ω b t m α 2 p s s c p m r s c r n d ω ω n u t 2 ρ e f f h m p m r h m r gn d ω ω n u t 2 ρ e f f p m 2 r p m r gn d ω k 1 3 ω b t m α 2 p s h m 2 r h m r n d ω ω b t m α 2 p s p m h m r p m r n d ω ω b t m α 2 p s s c h m r s c r n d ω ω n u t 2 ρ e f f h m 2 r h m r gn d ω ω n u t 2 ρ e f f p m h m r p m r gn d ω k 1 5 ω b t m α 2 p s h m s c r h m r n d ω ω b t m α 2 p s p m s c r p m r n d ω ω b t m α 2 p s s c 2 r s c r n d ω k 1 6 ω b t m α 2 p s h m s c r h m r n d ω ω b t m α 2 p s p m s c r p m r n d ω ω b t m α 2 p s s c 2 r s c r n d ω k 2 1 k 2 4 0 k 2 2 ω n t d 1 p m r p m r n d ω ω n t d 2 p m r h m r n d ω ω n t d 3 p m r h s r n d ω ω n t d 4 p m r m t l u r n d ω ω n t c 1 r n d ω ω n t c 1 p m r p m r n d ω ω n t c 2 p m r s c r n d ω ω n t g 1 p m r n d ω ω n t e 1 p m r s c r n d ω k 2 3 ω n t d 1 h m r p m r n d ω ω n t d 2 h m r h m r n d ω ω n t d 3 h m r h s r n d ω ω n t d 4 h m r m t l u r n d ω ω n t c 1 h m r p m r n d ω ω n t c 2 h m r s c r n d ω ω n t g 1 h m r n d ω ω n t e 1 h m r s c r n d ω k 2 5 ω n t c 2 r n d ω ω n t d 1 s c r p m r n d ω ω n t d 2 s c r h m r n d ω ω n t e 1 s c r s c r n d ω k 2 6 ω n t c 2 r n d ω ω n t d 1 s c r p m r n d ω ω n t d 2 s c r h m r n d ω ω n t e 1 s c r s c r n d ω k 3 1 0 k 3 2 ω n t d 5 p m r h s r n d ω ω n t d 6 p m r h m r n d ω ω n t d 7 p m r p m r n d ω ω n t d 8 p m r m t l u r n d ω ω n t c 3 r n d ω ω n t c 3 p m r p m r n d ω ω n t c 4 p m r s c r n d ω ω n t c 5 p m r h s r n d ω ω n t g 2 p m r n d ω ω n t e 2 p m r s c r n d ω k 3 3 ω n t d 5 h m r h s r n d ω ω n t d 6 h m r h m r n d ω ω n t d 7 h m r p m r n d ω ω n t d 8 h m r m t l u r n d ω ω n t c 3 h m r p m r n d ω ω n t c 4 h m r s c r n d ω ω n t c 5 h m r h s r n d ω ω n t g 2 h m r n d ω ω n t e 2 h m r s c r n d ω k 3 4 ω n t d 8 h s r m t l u r n d ω ω n t c 5 r n d ω k 3 5 ω n t c 4 r n d ω ω n t d 6 s c r h m r n d ω ω n t d 7 s c r p m r n d ω ω n t e 2 s c r s c r n d ω k 3 6 ω n t c 4 r n d ω ω n t d 6 s c r h m r n d ω ω n t d 7 s c r p m r n d ω ω n t e 2 s c r s c r n d ω k 4 1 k 4 5 k 4 6 0 k 4 2 ω n t t m p m r n d ω k 4 3 ω n t t m h m r n d ω k 4 4 ω n t 1 c p s n d ω k 5 1 k 5 4 k 5 5 k 5 6 0 k 5 2 ω n t f s c p m r n d ω k 5 3 ω n t f s c h m r n d ω k 6 1 k 6 4 k 6 5 k 6 6 0 k 6 2 ω n t f s c p m r n d ω k 6 3 ω n t f s c h m r n d ω c submatrices c 1 1 ω b t d s b d ω c 1 2 ω b t m α p s p m r n d ω ω n u t ρ e f f p m r gn d ω c 1 3 ω b t m α p s h m r n d ω ω n u t ρ e f f h m r gn d ω c 1 4 ω b t d s 1 3 m β s 1 c p s n d ω c 1 5 ω b t m α p s s c r n d ω c 1 6 ω b t m α p s s c r n d ω c 2 1 ω n t d 4 r m t b d ω c 2 2 ω n t d 1 r n d ω c 2 3 ω n t d 2 r n d ω c 2 4 ω n t d 3 r n d ω c 2 5 ω n t e 1 r n d ω c 2 6 ω n t e 1 r n d ω c 3 1 ω n t d 8 r m t b d ω c 3 2 ω n t d 7 r n d ω c 3 3 ω n t d 6 r n d ω c 3 4 ω n t d 5 r n d ω c 3 5 ω n t e 2 r n d ω c 3 6 ω n t e 2 r n d ω c 4 1 c 4 2 c 4 3 c 4 4 c 4 5 c 4 6 0 c 5 1 c 5 2 c 5 3 c 5 4 c 5 5 c 5 6 0 c 6 1 c 6 2 c 6 3 c 6 4 c 6 5 c 6 6 0 
791,this paper introduces a thermo hydro mechanical computational model for freezing and thawing in porous media domains with focus on freezing and thawing in soil the model is formulated based on the averaging theory and discretized using a mixed discretization scheme where the standard and extended finite element methods are simultaneously employed it is capable of capturing the strong coupling between all important phenomena and processes occurring during relatively high freezing thawing rates in porous media solid and fluid compressibility buoyancy phase change thermomechanical behavior water volume change pores expansion cryogenic suction melting point depression and water migration to the freezing zone are all considered in the model the cryogenic suction in particular is central to the occurrence of many of these phenomena and processes and thus treated as a primary state variable and discretized using the partition of unity method to make sure that it can be captured accurately the paper presents detailed formulation of the governing equations and the numerical discretization verification and numerical examples are given to demonstrate the accuracy and computational capability of the model in describing the behavior of a soil mass subjected to boundary conditions resembling those occurring in the vicinity of an energy pile the numerical examples show that the model is effectively mesh independent and can simulate all important phenomena using relatively coarse meshes keywords freezing thawing in soil energy pile cryogenic suction cryosuction thm model melting point depression ice lens 1 introduction freezing of water in porous media is a natural phenomenon which is of interest in a wide range of engineering applications including geotechnical engineering environmental engineering soil physics food industry and biomechanics just to name a few this paper focuses on freezing and thawing in soil though the model is generic and can readily be adopted for other applications in particular it focuses on freezing and thawing of soil in the vicinity of energy piles anstett et al 2005 the energy pile is a new shallow geothermal technology that utilizes the foundation piles as heat exchangers for heating and cooling of buildings normally users of this technology are restricted by operating the energy system to temperatures well above water freezing point to ensure that no thermally induced damages occur to the piles and the soil pile interaction however this restriction would significantly limit the amount of energy that can be extracted from the earth the goal of this work is to extend the operational limits of the system by studying the scenarios that might occur due to freezing and thawing of the soil mass and their consequences on the pile and provide the criteria for operating the energy piles at temperatures below the freezing point this paper is a step towards this goal it introduces a computational model describing freezing and thawing in a soil mass subjected to boundary conditions resembling those occurring in energy pile applications water freezing in porous media has been extensively studied experimentally and theoretically experimental studies have demonstrated that porous materials at temperatures well below freezing point preserve significant amount of unfrozen liquid water in their pores this characteristic is hypothesized to be attributed to two mechanisms interfacial premelting and curvature induced premelting wettlaufer and worster 2006 the interfacial premelting gives rise to an unfrozen thin film of liquid water at the contact surface between the ice crystals and the solid particles the curvature induced premelting generates supercooled pore water arising from the crystal ice surface curvature normally the premelting mechanisms are negligible in many applications but in soil as the specific surface area can be remarkably high and the surface curvature can be small these mechanisms can sum up to a significant amount of unfrozen water leading to what is known as the melting point depression the melting point depression in porous media is associated with the development of thermally induced negative pore pressure known as cryogenic suction williams and smith 1991 also denoted as cryosuction negative pore pressure of 11 to 12 atm generates from every degree celsius below zero the cryogenic suction gives rise to water migration from the unfrozen region to the frozen region the migrated water can create pockets where it amalgamates to form ice lens this phenomenon is important in permafrost regions like arctic and antarctic but for an energy pile application it is of minor significance however laboratory experiments on soil samples have shown that segregated ice lenses are generated in the frozen zone ming et al 2016 steiner et al 2017 formation of the ice lenses and migration of water to the frozen region lead to expansion of porosity giving rise to frost heaving the amount of frost heaving in a porous domain depends among others on the temperature gradient overburden pressure soil stiffness and the thermodynamic properties of water water in particular exhibits some unique abnormalities its specific volume above 4 c decreases with decreasing temperature down to 4 c below which unlike other materials its specific volume increases with decreasing temperature apparently soil freezing is a complicated phenomenon which encompasses highly coupled processes associating premelting to generation of cryogenic suction to expansion of porosity to formation of ice lenses to frost heaving upon thawing these processes undergo reversing action manifested by the diminishing of cryogenic suction retreating of water to its initial equilibrium condition and reversing the frost heaving to become thawing settlement evidently this strong coupling between thermal hydraulic and mechanical behavior in response to freezing and thawing necessitates considering all aforementioned processes in the model besides the significance of these processes is considerably affected by the geometry of the problem the gravitational forces and the material characteristics and hence the use of proper constitutive relationships and advanced numerical discretization schemes are essential attempts to model freezing and thawing in soil can be categorized into three types of models thermo hydraulic th models thermo mechanical tm models and thermo hydro mechanical thm models the th models are formulated based on the conservation of mass and energy equations with no regard given to the linear momentum equilibrium equation of the solid matrix models introduced by harlan 1973 guymon and luthin 1974 takagi 1979 gilpin 1980 o neill and miller 1985 konrad and duquennoi 1993 and sheng et al 1995 are among the th category the tm models are formulated based on the conservation of energy and linear momentum equations with no regard given to the fluid mass conservation equation the model introduced by kruschwitz and bluhm 2005 for instance is among the tm category models of this category ignore the cryogenic suction and its associated water mass migration to the frozen zone the thm models are formulated based on the conservation of mass energy and linear momentum equations models introduced by mikkola and hartikainen 2001 nishimura et al 2008 thomas et al 2009 and ming et al 2016 are among this category these models simulate soil freezing with different level of complexities with a noteworthy work given by zhou and meschke 2013 who introduced a thm model based on the theory of thermo poro elasticity of coussy 2005 and the theory of premelting dynamics of wettlaufer and worster 2006 the essence of this work is in the use of entropy for deriving the constitutive relationships of the materials the aforementioned models have been formulated based on the finite difference finite volume and finite element methods the focus was on simulating the physics of the problem and mainly standard discretization procedures have been employed to describe the primary state variables as a consequence these models entail the use of fine grids mainly if the freezing rate is high and the cryogenic suction is of interest nevertheless recent works on soil freezing focus also on the numerical procedure bekele et al 2017 presented an isogeometric finite element model for modeling artificial ground freezing this technique makes use of the computer aided design cad basis functions to formulate the finite elements which characteristically have better capabilities in describing the geometry na and sun 2017 introduced a stabilized finite element model for freezing and thawing of an elasto plastic porous domain they adopt a stabilization technique to counteract the lack of two fold inf sup condition and ill conditioning due to using primary state variables of different nature to prevent the likely occurrences of spurious oscillations recently amiri et al 2018 introduced a th model using the extended finite element method xfem to model the temperature discontinuity at the ice water interface in this work focus is placed on both the physics of the problem and the computational efficiency of the model compared to all existing works this work is distinct by three main features 1 the comprehensive mathematical formulation of the physics and the generic employment of the constitutive relationships 2 the choice of the primary state variables and 3 the use of the partition of unity to discretize the cryogenic suction these features and their novelty are highlighted in section 2 in section 3 details of the governing equations including the conservation equations constitutive relationships and initial and boundary conditions are given a step by step mixed finite element discretization scheme is presented in section 4 a partial verification exercise describing the model accuracy in simulating a numerical thawing benchmark case is given in section 5 section 6 presents a numerical example highlighting the complete features of the model the conclusions of this work are outlined in section 7 appendices a c provide additional details including the water equation of state eos the linearized equations and the complete components of finite element matrices and vectors 2 modeling approach developing an accurate efficient and effectively mesh independent model for freezing and thawing in deformable porous media requires a well designed conceptual model a descriptive mathematical formulation a good choice of the primary state variables and a well suited numerical method we undertake a conceptual model that comprises a saturated three phase deformable porous medium domain subjected to relatively high freezing thawing rates boundary conditions the porous domain constitutes a solid phase porous matrix and water which can be in a liquid phase ice phase or a mixture the conceptual model incorporates all important physical and thermodynamic phenomena and processes occurring during freezing and thawing in porous media including solid and fluid compressibility buoyancy phase change thermomechanical behavior pore volume expansion water volume change cryogenic suction melting point depression and water migration to the freezing zone the balance equations are formulated based on the representative elementary volume rev averaging theory lewis and schrefler 1998 phenomenological constitutive relationships and equations of state are employed for the solid and water phases the solid phase is considered temperature dependent elastic with its modulus of elasticity being a function of temperature the water equation of state is adopted from the international association for the properties of water and steam iapws 2007 the water and ice thermal expansion heat conductivity and dynamic viscosity are considered functions of temperature the clausius clapeyron relation describing the thermodynamic equilibrium between the frozen and unfrozen water contents in the porous domain is utilized to describe the cryogenic suction an empirical relationship describing the melting point depression is formulated water flow is governed by darcy s law and the relative permeability of the liquid water is described using the brooks and corey 1964 relationship appropriate choice of the primary state variables is very important for obtaining a stable numerical scheme as indicated above the conceptual model encompasses all important features involved in freezing and thawing of a porous domain constituting a solid phase liquid water phase ice phase and a water mixture as it will be apparent later on this paper the governing equations contain 21 mechanical and thermodynamic state variables describing the thermo hydro mechanical behavior of the domain and its constitutive relationships as the freezing and thawing processes in nature are relatively slow the state variables are smooth except for the cryogenic suction which exhibit a sharp increase jump for every degree celsius below zero as a consequence the cryogenic suction is considered here a primary state variable to have it directly computed from solving the finite element equations rather than been calculated in the post processing however its magnitude is restrained by the clausius clapeyron relation accordingly the model is formulated based on displacement pressure enthalpy cryosuction formulation with the primary state variables solid phase displacement u water mixture pressure p m water mixture specific enthalpy h m solid specific enthalpy h s and cryousuction s c the other 16 variables are dependent and defined by their relevant constitutive relationships the numerical solution is conducted using a mixed finite element discretization scheme in which state variables exhibiting continuous nature are discretized using the standard galerkin finite element method sg and those exhibiting high gradient are discretized using the extended finite element method xfem the mixed discretization scheme is similar to the well known mixed finite element method in that it allows using different primary state variables such as pore pressure and solid displacement but differs in its discretization approach in the mixed finite element method all primary state variables are discretized using a single discretization scheme such as sg but in the mixed discretization scheme the primary state variables can be discretized in different ways depending on their physical nature al khoury and sluys 2007 arzanfudi and al khoury 2017 xfem is an enhanced finite element scheme based on the partition of unity principles to model discontinuities and high gradient fields regardless of the finite element mesh it enables using structured and fixed meshes in this work the solid phase displacement u water mixture pressure p m water mixture specific enthalpy h m and solid specific enthalpy h s are discretized using sg and the cryogenic suction s c is discretized using xfem 3 governing equations the representative elementary volume rev averaging theory is utilized to formulate the governing equations lewis and schrefler 1998 for a multiphase system the averaging theory entails that each phase is assumed occupying the whole volume of rev and is distributed continuously over it regardless of its detailed heterogeneity the phases are distinct from each other by their physical properties and velocities and their mass and volume fractions within rev the size of rev must be significantly larger than the size of heterogeneity of the matter but much smaller than the size of the bulk material the porous domain is assumed saturated isotropic and non isothermal with local thermal equilibrium it constitutes a solid matrix and water with the solid matrix exhibiting deformation due to coupling between water freezing pore expansion and cryogenic suction and the water exhibiting thermally induced phase change from liquid to solid ice and vice versa the three phases solid liquid water and ice might interact physically with each other and exchange mass momentum and energy at their contact interfacial areas as mentioned in section 2 the model contains 21 state variables divided into 5 primary state variables and 16 dependent variables the partial differential equations describing the conservation of momentum mass and energy in a multiphase porous medium domain are expressed in terms of the primary state variables u p m h m h s s c as given below in sections 3 1 3 3 section 3 4 describes the relevant constitutive relationships for the 16 dependent variables these two sets of equations together with the initial and boundary conditions section 3 5 formulate the governing field equations which are numerically solved in section 4 3 1 momentum balance equation the averaged macroscopic linear momentum balance equation of a multiphase domain constituting a solid phase a liquid water phase and an ice phase and subjected to thermo hydro mechanical forces can be expressed in an incremental form as 1 d t l u t 1 3 m β s t s t m α p s t ρ e f f t g 0 where u is the displacement vector t s is the porous matrix temperature d t is the tangential solid stiffness matrix β s is the solid volumetric thermal expansion coefficient α is biot s coefficient g is the gravitational vector m 1 1 1 0 0 0 t and ρ eff and p s are the effective mass density and the pressure exerted by the water phase on the solid phase defined as 2 ρ e f f 1 φ ρ s φ s i c e ρ i c e φ s l w ρ l w p s s l w p l w s i c e p i c e and l is a differential operator given by 3 l x 0 0 y 0 z 0 y 0 x z 0 0 0 z 0 y x t in which φ is the porosity ρ s ρ lw and ρ ice are the mass density of solid liquid water and ice respectively and s lw and s ice are the liquid water and ice saturations the dependent variables in eq 1 are functions of the primary state variables such that t s t s h s p s p s p m h m s c and ρ eff ρ eff p m h m with the subscript m denoting the water mixture liquid water and ice using the chain rule the derivatives of these dependent variables can then be expressed as 4 t s t t s h s h s t 1 c p s h s t 5 p s t p s h m h m t p s p m p m t p s s c s c t 6 ρ e f f t ρ e f f h m h m t ρ e f f p m p m t where c ps is the specific heat capacity of the solid phase h m is the water mixture specific enthalpy h s is the solid specific enthalpy and s c is the cryosuction substituting eqs 4 6 into eq 1 gives 7 d s l u t 1 3 m β s 1 c p s h s t m α p s h m h m t p s p m p m t p s s c s c t ρ e f f h m h m t ρ e f f p m p m t g 0 by this derivation the momentum balance equation eq 1 is formulated in terms of the primary state variables u p m h m h s and s c 3 2 mass balance equation the averaged macroscopic mass balance equations for the solid phase liquid water phase ice phase and the mixtures are solid matrix phase the mass balance equation for the solid phase can be expressed as 8 1 φ ρ s ρ s t φ t 1 φ m t l u t 0 the constitutive relationship for the solid mass density can be described as lewis and schrefler 1998 9 1 ρ s ρ s t 1 1 φ α φ 1 k s p s t β s α φ t s t 1 α m t l u t in which k s is the bulk modulus of the solid grains substituting eqs 4 and 5 into eq 9 gives 10 1 ρ s ρ s t 1 1 φ α φ 1 k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t 1 α m t l u t substituting eq 10 into eq 8 and rearranging yields 11 φ t α φ k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t φ α m t l u t which indicates that the porosity is a function of enthalpy pore pressure cryosuction and solid matrix displacement liquid water phase the mass balance equation for the liquid water phase can be written as 12 φ t φ ρ l w ρ l w t φ s l w s l w t 1 s l w ρ l w ρ l w v l w φ m t l u t m l w i c e s l w ρ l w in which v lw is the mass averaged velocity of liquid water and m lw ice is the mass exchange rate between liquid water and ice arising from the phase change inserting eq 11 into eq 12 yields 13 α φ k s p s h m h m t p s p m p m t p s s c s c t β s α φ 1 c p s h s t α m t l u t φ ρ l w ρ l w t φ s l w s l w t 1 s l w ρ l w ρ l w v l w m l w i c e s l w ρ l w applying the chain rule to the liquid water density and saturation gives 14 ρ l w t ρ l w p m p m t ρ l w h m h m t 15 s l w t s l w p m p m t s l w h m h m t substituting eqs 14 and 15 into eq 13 and re arranging results in 16 α φ k s s l w ρ l w p s p m φ s l w ρ l w p m φ ρ l w s l w p m p m t α φ k s s l w ρ l w p s h m φ s l w ρ l w h m φ ρ l w s l w h m h m t α φ k s s l w ρ l w p s s c s c t β s α φ s l w ρ l w 1 c p s h s t α s l w ρ l w m t l u t ρ l w v l w m l w i c e ice phase similar to liquid water the mass balance equation of the ice phase can readily be derived to give 17 α φ k s s i c e ρ i c e p s p m φ s i c e ρ i c e p m φ ρ i c e s i c e p m p m t α φ k s s i c e ρ i c e p s h m φ s i c e ρ i c e h m φ ρ i c e s i c e h m h m t α φ k s s i c e ρ i c e p s s c s c t β s α φ s i c e ρ i c e 1 c p s h s t α s i c e ρ i c e m t l u t ρ i c e v i c e m l w i c e where v ice is the mass averaged velocity of ice water mixture liquid water and ice consider the following identities 18 s l w s i c e 1 ρ m s l w ρ l w s i c e ρ i c e s l w ρ l w h m ρ l w s l w h m s i c e ρ i c e h m ρ i c e s i c e h m s l w ρ l w h m s i c e ρ i c e h m s l w ρ l w s i c e ρ i c e h m ρ m h m summing eqs 16 and 17 and using eq 18 gives the mass balance equation of the water mixture as 19 α φ k s ρ m p s p m φ ρ m p m p m t α φ k s ρ m p s h m φ ρ m h m h m t α φ k s ρ m p s s c s c t β s α φ ρ m 1 c p s h s t α ρ m m t l u t ρ l w v l w ρ i c e v i c e 0 the ice velocity is negligible and can be ignored v ice 0 and the liquid water velocity can be described using darcy s law as 20 v l w k k r l w μ l w p l w ρ l w g in which k rlw and μ lw are the relative permeability and dynamic viscosity of the liquid water the water mixture pressure p m in eq 19 can be expressed as 21 p m p l w s c which indicates that before freezing s c 0 and hence the mixture pressure is equal to the liquid pressure p lw but upon freezing the cryogenic suction builds up and rapidly becomes much higher than the liquid pressure leading to the mixture pressure to be nearly equal to the ice pressure p ice inserting eq 21 into eq 20 gives 22 v l w k k r l w μ l w p m s c ρ l w g substituting eq 22 into eq 19 results in 23 d 1 p m t d 2 h m t d 3 h s t d 4 m t l u t e 1 s c t c 1 p m c 2 s c g 1 0 in which 24 d 1 φ ρ m p m α φ k s ρ m p s p m d 4 α ρ m d 2 φ ρ m h m α φ k s ρ m p s h m c 1 ρ l w k k r l w μ l w d 3 ρ m β s α φ 1 c p s c 2 ρ l w k k r l w μ l w e 1 α φ k s ρ m p s s c g 1 ρ l w k k r l w μ l w ρ l w g as for the momentum balance equation the mass balance equation eq 23 is formulated in terms of the primary state variables 3 3 energy balance equation the averaged macroscopic energy balance equation for a multiphase domain exhibiting local thermal equilibrium can be expressed as 25 t 1 φ ρ s h s φ ρ m h m 1 φ p s φ p m φ ρ m h m m t l u t ρ l w h l w v l w λ e f f t s 0 where h lw is the specific enthalpy of liquid water p s is the mean effective stress and 26 λ e f f 1 φ λ s φ s i c e λ i c e φ s l w λ l w is the effective thermal conductivity of the porous domain with λ s λ lw and λ ice denoting the thermal conductivity of the porous solid liquid water and ice respectively the temperature gradient can be described as 27 t s t h s h s 1 c p s h s substituting eqs 20 and 27 into eq 25 and expanding the time derivatives results in 28 ρ m h m ρ s h s p m p s φ t 1 φ h s ρ s t 1 φ ρ s h s t φ ρ m h m t φ h m ρ m t 1 φ p s t φ p m t φ ρ m h m m t l u t ρ l w h l w k k r l w μ l w p m s c ρ l w g λ e f f 1 c p s h s 0 applying the chain rule to the mixture mass density time derivative gives 29 ρ m t ρ m p m p m t ρ m h m h m t substituting eq 10 eq 11 and eq 29 into 28 leads to 30 d 5 h s t d 6 h m t d 7 p m t d 8 m t l u t e 2 s c t c 3 p m c 4 s c c 5 h s g 2 0 in which 31 d 5 1 φ ρ s β s α φ ρ m h m p m p s 1 c p s c 3 ρ l w h l w k k r l w μ l w d 6 φ ρ m φ h m ρ m h m ρ m h m p m p s α φ k s p s h m c 4 ρ l w h l w k k r l w μ l w d 7 ρ m h m p m p s α φ k s p s p m φ φ h m ρ m p m c 5 1 c p s λ e f f d 8 1 φ ρ s h s α ρ m h m φ α p m p s 1 φ k t g 2 ρ l w h l w k k r l w μ l w ρ l w g e 2 ρ m h m p m p s α φ k s p s s c in which k t is the bulk modulus of the solid skeleton eq 30 is the energy balance equation formulated in terms of the primary state variables since the specific enthalpies of water and solid phases are primary state variables the local thermal equilibrium can only be satisfied by imposing this constraint 32 t s t m 0 in which t m is the water mixture temperature using eq 27 this equation can be written as 33 1 c p s h s t m 0 3 4 constitutive relationships 3 4 1 porous matrix the stiffness matrix of a three dimensional isotropic solid is described as 34 d t e t t 1 ν s 1 2 ν s 1 ν s ν s ν s 0 0 0 1 ν s ν s 0 0 0 1 ν s 0 0 0 1 2 ν s 2 0 0 s y m m e t r i c 1 2 ν s 2 0 1 2 ν s 2 where ν s is poisson s ratio and e t t is a temperature dependent elastic modulus defined here as 35 e t t e 0 e b t s t 0 where e 0 is the young s modulus at a reference temperature t 0 and b is a material parameter it is worth noting though that the assumption of a temperature dependent linear elastic behavior of the solid matrix might be reasonable during freezing but upon thawing and repetitive freezing thawing cycles the behavior might become non linear elasto plastic modeling such a behavior will be treated in a follow up work 3 4 2 water equation of state eos the thermodynamic state variables and properties of the liquid water ice and the water mixture ρ m t m ρ ice ρ lw s ice s lw λ ice λ lw μ lw are obtained from the equation of state of water adopted from iapws 2007 and other relevant literature given in appendix a 3 4 3 melting point depression pore liquids in porous media freeze at temperatures well below their bulk freezing melting points the melting point is inversely proportional to the pore size as given by the gibbs thomson equation the use of this equation for porous media requires knowledge of the pore geometry solid liquid interface energy and the wetting angle inside the pores quantities which are normally difficult to measure especially for geoscience applications instead several empirical relationships have been obtained from experimental measurements of macroscopic specimens or from assuming the similarity between the soil water curves swc describing the relationship between the capillary pressure and the moisture content and the soil freezing curves sfc describing the relationship between the sub zero temperatures and the unfrozen water content kurylyk and watanabe 2013 presented an interesting review describing different forms of the clapeyron equation and empirical methods for describing the sfc relationships here we adopt an exponential function of the form 36 s l w s 1 s e a t w t f in which s is the residual unfrozen water content at a relatively cold condition t f is the bulk freezing temperature and a is a material constant this kind of constitutive relationships are easy to implement and can readily be obtained from relatively simple laboratory experiments on the type of soil under study nevertheless the proposed model is generic and any other constitutive relationship can be considered 3 4 4 cryogenic suction as indicated in section 2 the cryogenic suction s c exhibits a jump at every degree celsius below zero as a consequence the cryogenic suction is considered here a primary state variable to have it directly computed from solving the finite element equations see eq 69 rather than been calculated in the post processing however the computed quantity has to satisfy the clausius clapeyron relation lewis and schrefler 1998 37 s c ρ i c e l f ln t m t f where l f is the latent heat of fusion of water to satisfy this condition the following constraint is imposed 38 ρ i c e l f ln t m t f s c 0 which for simplicity of notation can be written as 39 f s c s c 0 3 4 5 relative permeability even though the domain is fully saturated the water exhibits phase change during freezing and thawing giving rise to a quasi partially saturated condition within the water phase as for the partially saturated conditions calculating this effect necessitates the use of the relative permeability coefficient as given in eq 20 here the relative permeability of liquid water is described based on the brooks and corey relationship brooks and corey 1964 40 k r l w s l w 2 3 η η where η is a material constant 3 5 initial and boundary conditions initially at t 0 the primary state variables are expressed as 41 g x 0 g 0 x where g can be any of the primary state variables u pm hm hs or sc the dirichlet boundary conditions might be described as 42 j t j t o n γ u where γ u is the dirichlet boundary and j can be any of the primary state variables the neumann boundary conditions for the mechanical hydraulic and conductive and convective thermal boundary conditions might be described respectively as 43 t σ n q l w ρ l w v l w n q cond λ e f f t s n on γ q q conv ρ l w h l w v l w n where γ q is the neumann boundary t is the prescribed traction q lw is the prescribed mass flow rate of liquid water and q cond and q conv are the prescribed conductive and convective heat fluxes respectively 4 finite element mixed discretization the model encompasses state variables of significantly different nature describing highly coupled thermo hydro mechanical processes it comprises porous matrix deformation and heat and fluid flow occurring due to gravity buoyancy thermal expansion and cryogenic suction discretizing such a system using standard finite element method can cause spurious oscillations and requires extensive cpu time and capacity importantly the standard finite element method fails to capture the jump in the cryogenic suction as it will be highlighted in the numerical example in section 6 here a mixed finite element discretization scheme is utilized for modeling relatively high freezing thawing rates in porous media the primary state variables that represent relatively smooth continuous fields namely the displacement enthalpy and pressure are discretized using the standard finite element method and the cryogenic suction is discretized using the partition of unity method within the framework of the extended finite element method a fixed and structured finite element discretization scheme is adopted 4 1 weak form formulation the weighted residual method is utilized to formulate the finite element equations in total five equations are discretized three conservation equations momentum eq 7 mass eq 23 and energy eq 30 a local thermal equilibrium constraint equation eq 33 and a cryosuction constraint equation eq 39 appling the standard weighted residual discretization procedure to eqs 7 23 30 and 33 yields momentum balance 44 ω l t w d s l u t d ω ω l t w d s 1 3 m β s 1 c p s h s t d ω ω l t w m α p s h m h m t d ω ω l t w m α p s p m p m t d ω ω l t w m α p s s c s c t d ω ω w ρ e f f h m h m t g d ω ω w ρ e f f p m p m t g d ω γ q w t t d γ 0 mass balance 45 ω w d 1 p m t d ω ω w d 2 h m t d ω ω w d 3 h s t d ω ω w d 4 m t l u t d ω ω w e 1 s c t d ω ω w c 1 p m c 2 s c g 1 d ω γ q w q l w d γ 0 energy balance 46 ω w d 5 h s t d ω ω w d 6 h m t d ω ω w d 7 p m t d ω ω w d 8 m t l u t d ω ω w e 2 s c t d ω ω w c 3 p m c 4 s c c 5 h s g 2 d ω γ q w q adv d γ γ q w q cond d γ 0 local thermal equilibrium constraint 47 ω w 1 c p s h s d ω ω w t m d ω 0 appling the partition of unity weighted residual discretization procedure to the cryosuction constraint equation eq 39 yields cryosuction constraint continuous 48 ω w f s c d ω ω w s c d ω 0 enhanced 49 ω w f s c d ω ω w s c d ω 0 where w and w are the standard and enhanced weighting functions 4 2 linearization the newton raphson method is utilized to linearize the problem the primary state variables and their time derivatives and gradients are linearized as 50 y r 1 y r δ y y r 1 y r δ y y u p m h m h s s c y r 1 y r δ y where r 1 denotes the current iteration and δ is the associated variation in the variable the dependent variables tm tm pm hm ρ eff ρ eff pm hm fsc fsc pm hm and ps ps pm hm sc and their derivatives are linearized as 51 x r 1 x r x h m r δ h m x p m r δ p m x t m ρ e f f f s c 52 ρ e f f h m r 1 ρ e f f h m r 2 ρ e f f h m 2 r δ h m 2 ρ e f f h m p m r δ p m 53 ρ e f f p m r 1 ρ e f f p m r 2 ρ e f f p m h m r δ h m 2 ρ e f f p m 2 r δ p m 54 p s r 1 p s r p s h m r δ h m p s p m r δ p m p s s c r δ s c 55 p s h m r 1 p s h m r 2 p s h m 2 r δ h m 2 p s h m p m r δ p m 2 p s h m s c r δ s c 56 p s p m r 1 p s p m r 2 p s p m h m r δ h m 2 p s p m 2 r δ p m 2 p s p m s c r δ s c 57 p s s c r 1 p s s c r 2 p s s c h m r δ h m 2 p s s c p m r δ p m 2 p s s c 2 r δ s c the coefficients in eqs 23 and 30 d 1 d 2 d 6 d 7 d 8 e 1 e 2 g pm hm sc andd 3 d 4 d 5 c 1 c 2 c 3 c 4 c 5 g 1 g 2 j pm hm are linearized as 58 g r 1 g r g h m r δ h m g p m r δ p m g s c r δ s c g d 1 d 2 d 6 d 7 d 8 e 1 e 2 59 j r 1 j r j h m r δ h m j p m r δ p m j d 3 d 4 d 5 c 1 c 2 c 3 c 4 c 5 g 1 g 2 the evolution of porosity eq 11 and the temperature dependent elastic modulus eq 35 are treated explicitly by updating their values at every time step substituting eqs 50 59 into eqs 45 47 eliminating the high order differentials and rearranging yields the linearized weak form finite element equations for the mass balance energy balance local thermal equilibrium constraint and the cryosuction constraint these equations are listed in appendix b 4 3 mixed fe formulation using the galerkin finite element method the solid displacement mixture pressure mixture specific enthalpy and solid phase specific enthalpy are discretized as 60 u x t n u x u t 61 p m x t n x p m t 62 h m x t n x h m t 63 h s x t n x h s t using the partition of unity the cryogenic suction is discretized as 64 s c x t n x s c t n x s c t in which the barred values are the nodal values n is the standard finite element shape function vector and 65 n x n x ψ x is the enhanced shape function with ψ the partition of unity enhancement function described here as 66 ψ x e x x ℓ c in which x is the normal projection of x on the freezing boundary γ q and ℓ c is a characteristic length which can be a property of the porous matrix the weight functions in eqs 44 49 are defined as 67 w n 68 w n substituting eqs 60 68 into the linearized equations in appendix b gives the finite element equations which can be described in a compact form as 69 k δ x c δ x f k 0 x r c 0 x r where 70 δ x δ u δ p m δ h m δ h s δ s c δ s c t δ x δ u δ p m δ h m δ h s δ s c δ s c t x r u r p m r h m r h s r s c r s c r x r u r p m r h m r h s r s c r s c r t f f 1 f 2 f 3 f 4 f 5 f 6 t the coefficients of the matrices and vectors of eq 69 are given in appendix c eq 69 is a semi discrete system of equations which can be solved using any of the time integration schemes here we use a fully implicit finite difference time integration scheme 5 model verification verifying the accuracy of the model against experimental work or numerical codes is not readily accessible as either the experimental set ups are not necessarily designed to examine all features of the model or the numerical codes are not appropriately verified validated or designed to be utilized as a reference case nevertheless recently an important comparison exercise is devised to numerically validate the accuracy and performance of th numerical codes introduced by grenier et al 2018 thirteen numerical codes with different numerical approaches spatial and temporal discretization schemes and computational efficiency were tested to examine two dimensional 2d thawing benchmark cases here we make use of this exercise to partially verify the introduced thm model a thawing benchmark case termed th2 in grenier et al 2018 is simulated this benchmark case examines heat and fluid flow in a 2d porous medium domain 3 m x 1 m initially at 5 c and includes a 0 333 m x 0 333 m initially frozen zone at 5 c the domain is closed at the top and bottom boundaries and insulated against conduction from the top bottom and right boundaries but subjected to a head difference of 0 03 m m from the left boundary fig 1 shows the geometry and initial and boundary conditions of this benchmark case the analysis is conducted by letting the frozen zone to thaw naturally for approximately 55 hr the analysis is conducted using the full feature thm model but to eliminate the effect of solid phase deformation the elastic modulus is made relatively high 10 gpa the material parameters and constitutive relationships as given by grenier et al 2018 are implemented except for the water and ice properties for which we utilized the water equation of state given in appendix a the water and ice properties in the reference benchmark are treated as constants the finite element domain is discretized using 2d linear quadrilateral finite elements the analysis is conducted on half of the domain using two mesh sizes 374 and 1134 elements fig 2 shows the computational results at 22 860 s and later obtained from both meshes it would have been ideal if the digital file of the reference benchmark had been accessible but comparing fig 2 at 22 860 s to fig 2b p 200 of grenier et al 2018 it can readily be noticed that the two results are very close the small difference however can be attributed to the way the ice and water properties are defined also it can be noticed that the coarse mesh 374 elements gave rather close results to the finer mesh 1134 elements indicating that the model is effectively mesh independent both meshes however are much smaller than those utilized in solving the reference benchmark fig 3 shows the evolution of the minimum temperature with time comparing this figure to fig 9a p 207 of grenier et al 2018 reveals that the two results are very close and as mentioned above the small difference in the results can be attributed to the difference in ice and water properties the same can be observed in comparing the evolution of the water volume with time given in fig 4 with that in fig 9b p 207 of grenier et al 2018 thus it can be concluded that the introduced thm model is capable of handling cases which are considered to be computationally challenging however this verification exercise does not reflect all features of the model and in order to highlight the complete features a more involved numerical example is given in the next section 6 numerical example a numerical example demonstrating the capabilities of the model to simulate a freezing and thawing cycle in soil is presented the geometry is designated to resemble a soil mass surrounding an energy pile an axial symmetric soil mass 24 5 m diameter and 12 m deep subjected to a 10 m long and 0 5 m diameter cylindrical heat source is simulated the heat source represents an energy pile coinciding along the symmetrical axis of the soil as shown in fig 5 initial and boundary conditions initially the temperature in the soil mass is assumed 5 c the pressure is hydrostatic and the horizontal effective stress is equal to overlying soil mass thermal mechanical and hydraulic boundary conditions are imposed the right hand side boundary is prescribed by 1 a constant temperature of 5 c 2 an overburden pressure equal to the weight of the soil mass and 3 made hydraulically open for groundwater flow the top and bottom boundaries are considered thermally insulated and hydraulically closed the left and bottom boundaries are supported by rollers to restrict the normal displacements to these boundaries at the contact surface between the soil mass and the heat source a cauchy boundary condition describing a heat flux arising due to their thermal interaction is imposed as 71 q b t s t p in which b is the thermal interaction coefficient and t p is a prescribed heat source temperature simulating a 28 days freezing thawing cycle shown in fig 6 material parameters and constitutive relationships table 1 lists the physical and thermomechanical properties of the materials fig 7 shows the soil elastic modulus versus temperature as given by eq 35 and the soil freezing curve sfc as given by eq 36 finite element analysis the finite element domain is discretized using 400 linear quadrilateral axisymmetric finite elements the axial symmetric finite element is formulated by solving the finite element system of equations eq 69 in the cylindrical coordinate system r z fig 8 shows the computational results for temperature cryogenic suction porosity expansion and deformed mesh at three instants in time just before freezing t 5 days during freezing t 14 days and just after freezing t 19 days fig 8a shows that as the temperature is above freezing point there is no sign of cryogenic suction and the porosity expansion and solid matrix heaving are minimal fig 8b shows that upon freezing the cryogenic suction arises associated with porosity expansion and frost heaving fig 8c shows that by thawing the cryogenic suction disappears and the porosity and heaving are decreased fig 9 shows the temporal evolution of temperature cryogenic suction porosity and heaving at point a r 0 25 m z 0 0 m shown in fig 5 at the surface fig 9a shows the evolution of temperature which reaches its minimum value of 4 9 c after 14 days followed by an increase in response to the temperature increase in the heat source fig 9b shows the evolution of cryogenic suction with its value reaches its maximum of 5 5 mpa 55 bar after 14 days in association with the minimum temperature fig 9c shows the evolution of porosity which closely follows the evolution of cryogenic suction the maximum reached porosity is ϕ 0 35 an increase of 17 of its initial value of 0 3 with thawing the porosity reduces to 0 33 after 19 days keeping some of the migrated moisture but after 28 days it becomes 0 3005 almost contracted to its initial value fig 9d shows the frost heaving at point a it shows that it evolves in association with the onset of cryosuction and pore expansion upon freezing it reached uz 0 052 m but during thawing most of the heave has been reversed and the remaining heave after 19 days is 0 033 m and after 28 days is 0 002 m apparently the nearly full reverse of the heave is due to the use of an elastic constitutive model for the solid phase caicedo 2017 has shown experimentally that during thawing the fine sand exhibits nearly full reversal of heave but the silt is irreversible leaving a considerable residual heave this difference in behavior among different soil materials necessitates the use of a proper elasto plastic model to simulate accurately the behavior under different freezing and thawing boundary conditions fig 10 shows the water flow vectors after 5 days just before freezing and after 14 days at the peak of freezing the figure shows that before freezing the water migrates from the cold region to the warm region due to its volumetric expansion but by the onset of freezing the water flows back to the frozen region due to cryogenic suction fig 11 shows the spatial distribution of temperature cryogenic suction porosity frost heaving ice saturation and liquid water pressure computed at the boundary along the heat source on six instants in times t 0 5 7 8 14 19 days where t 0 represents the initial condition t 5 days represents the time just before freezing t 7 14 days represents the time during freezing and t 19 days represents the time just after thawing the figure demonstrates the strong coupling between the involved phenomena which follow firmly the evolution of temperature an interesting observation can be noticed in fig 11a where during freezing on days 7 and 8 there is a time lag in the advancement of freezing at the upper side of the domain as compared to the lower side this can be attributed to the substantial expansion of porosity in this area as shown in fig 11c the porosity expansion is associated with the migration of unfrozen water from the warm region to the frozen region due to cryosuction giving rise to a warmer temperature another interesting observation can be seen in fig 11d where it shows that there is a neutral heaving point at around z 7m above this point the soil exhibits heaving due to the coupling effect between porosity expansion water volume expansion and the increase of water contents due to cryosuction below this point the soil exhibits contraction due to the overburden pressure fig 11f shows that before freezing the liquid water pressure is hydrostatic but after freezing it becomes negative due to the cryogenic suction examining the computational results reveals that the model is capable of capturing the strong coupling between thermo hydro mechanical phenomena occurring during freezing and thawing in soil a noteworthy feature of the model is the capturing of the jump in the cryogenic suction and its associated porosity expansion and frost heaving capturing such a behavior using a relatively coarse mesh was feasible by two main attributes the first attribute is the choice of the primary state variables especially the inclusion of the cryosuction s c among them and the second attribute is the use of the mixed discretization scheme where s c is discretized using the partition of unity method if use is made of the standard finite element method the jump in the cryogenic suction would not be possible to capture and its value would be underestimated this is shown in fig 12 where all primary state variables are discretized using the standard galerkin finite element method the figure shows that after 14 days of freezing there is no jump in the cryogenic suction as compared to fig 8b and its maximum magnitude is 3 6 mpa theoretically as per eq 37 the cryogenic suction at 4 9 c should be 5 5 mpa 55 bar 7 conclusions this paper presents a computational model capable of simulating the strong coupling between all important thermo hydro mechanical phenomena occurring during freezing and thawing of a porous domain resembling a soil mass surrounding an energy pile the model is formulated based on the averaging theory and discretized using the finite element method three features make the proposed model distinct from others the mathematical formulation of the physics the choice of the primary state variables and the discretization scheme a comprehensive mathematical formulation is employed to describe all important phenomena and processes in freezing thawing of porous media including solid and fluid compressibility buoyancy phase change thermomechanical behavior water volume change pores expansion cryogenic suction melting point depression and water migration to the freezing zone the use of fundamental balance equations within the framework of the averaging theory together with the equations of state of water and generic ice water constitutive relationships make the modeled physics rather wide ranging in current thm models the primary state variables are typically solid displacement pore pressure and temperature the use of these variables might be adequate for slow freezing rates which is the case in nature but for a relatively high freezing rate such as in artificial ground freezing or shallow geothermal systems this choice of state variables would most probably cause critical spurious oscillations unless treated properly na and sun 2017 thoroughly discussed this issue and asserted that the performance of their model was improved only after employing a stabilization technique in the weighted residuals of the mass and energy balance equations in this work we demonstrated that treating the cryogenic suction as a primary state variable alleviates this problem and in this case even the standard galerkin finite element method sg can handle relatively high freezing thawing rate problems however as discussed in section 6 and shown in fig 12 sg falls short from capturing the rapid rise of the cryogenic suction but tends to smear it we tackled this issue by discretizing the cryogenic suction using the partition of unity method the governing equations are solved using a mixed finite element discretization scheme where the continuous and smooth primary state variables namely the solid phase displacement water mixture pressure water mixture specific enthalpy and solid specific enthalpy are discretized using the standard galerkin finite element method and the cryogenic suction is discretized using the partition of unity within the framework of xfem this combination has enabled the simulation of a relatively high freezing thawing rate problem and resulted into an accurate robust and effectively mesh independent numerical scheme acknowledgements the authors acknowledge the financial support by nwo netherlands organization for scientific research under grant number 14698 they highly appreciate fundex piles company deltares geotechnics consultancy company and tno diana finite element company for their in kind contributions and technical support and the green village of delft for accommodating the energy pile they would also like to thank the three reviewers for their useful remarks supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 07 013 appendix d supplementary materials image application 1 appendix a water equations of state the water equations of state eos for subcooled liquid water supercooled water and ice are formulated from relevant references given below subcooled liquid water specific heat capacity iapws 2007 c p r h 2 o t m 2 2 γ p m 2 in which r h2o is specific gas constant for water p m p m 16 53 10 6 t m 1386 0 t m and γ p m t m i 1 34 n i 7 1 p m i j t m 1 222 j i where n i i i and j i are material constants density iapws 2007 ρ p m r h 2 o t m p m γ p m viscosity cooper and dooley 2008 μ 100 t m 647 096 i 0 3 h i t m 647 096 i e ρ 322 0 i 0 5 647 096 t m 1 i j 0 6 h i j ρ 322 0 1 j e 0 068 y where y h i and h ij are material constants heat conductivity ramires et al 1994 λ 0 6065 1 48445 4 12292 t m 298 15 1 63866 t m 298 15 2 supercooled liquid water specific heat capacity tombari et al 1999 c p 1 18 01528 10 3 0 044 t m 222 1 2 5 74 3 density hare and sorensen 1987 ρ 0 0228 t m 273 15 2 0 1176 t m 273 15 999 9 viscosity hallett 1963 μ 5 0 10 6 t m 273 15 2 3 0 10 5 t m 273 15 0 0018 heat conductivity benchikh et al 1985 λ 0 0017 t m 273 15 0 5583 ice specific heat capacity fukusako 1990 c p 185 0 6 89 t m 273 15 density fukusako 1990 ρ 917 0 1 1 17 1 0 4 t m 273 15 heat conductivity fukusako 1990 λ 1 16 1 91 8 66 10 3 t m 273 15 2 97 10 5 t m 273 15 2 appendix b linearized balance equations the linearized balance equations from section 4 2 are momentum balance ω l t w d s l u m d ω ω l t w d s l δ u d ω ω l t w d s 1 3 m β s 1 c p s h s r d ω ω l t w d s 1 3 m β s 1 c p s δ h s d ω ω l t w m α p s h m r h m r d ω ω l t w m α p s h m r δ h m d ω ω l t w m α 2 p s h m 2 r h m r δ h m d ω ω l t w m α 2 p s h m p m r h m r δ p m d ω ω l t w m α 2 p s h m s c r h m r δ s c d ω ω l t w m α p s p m r p m r d ω ω l t w m α p s p m r δ p m d ω ω l t w m α 2 p s p m h m r p m r δ h m d ω ω l t w m α 2 p s p m 2 r p m r δ p m d ω ω l t w m α 2 p s p m s c r p m r δ s c d ω ω l t w m α p s s c r s c r d ω ω l t w m α p s s c r δ s c d ω ω l t w m α 2 p s s c h m r s c r δ h m d ω ω l t w m α 2 p s s c p m r s c r δ p m d ω ω l t w m α 2 p s s c 2 r s c r δ s m d ω ω w ρ e f f h m r h m r g d ω ω w ρ e f f h m r δ h m g d ω ω w 2 ρ e f f h m 2 r h m r δ h m g d ω ω w 2 ρ e f f h m p m r h m r δ p m g d ω ω w ρ e f f p m r p m r g d ω ω w ρ e f f p m r δ p m g d ω ω w 2 ρ e f f p m h m r p m r δ h m g d ω ω w 2 ρ e f f p m 2 r p m r δ p m g d ω γ q w t d γ 0 mass balance ω w d 1 r p m r d ω ω w d 1 r δ p m d ω ω w d 1 h m r p m r δ h m d ω ω w d 1 p m r p m r δ p m d ω ω w d 1 s c r p m r δ s c d ω ω w d 2 r h m r d ω ω w d 2 r δ h m d ω ω w d 2 h m r h m r δ h m d ω ω w d 2 p m r h m r δ p m d ω ω w d 2 s c r h m r δ s c d ω ω w d 3 r h s r d ω ω w d 3 r δ h s d ω ω w d 3 h m r h s r δ h m d ω ω w d 3 p m r h s r δ p m d ω ω w d 4 r m t l u r d ω ω w d 4 r m t l δ u d ω ω w d 4 h m r m t l u r δ h m d ω ω w d 4 p m r m t l u r δ p m d ω ω w e 1 r s c r d ω ω w e 1 r δ s c d ω ω w e 1 h m r s c r δ h m d ω ω w e 1 p m r s c r δ p m d ω ω w e 1 s c r s c r δ s c d ω ω w c 1 r p m r d ω ω w c 1 r δ p m d ω ω w c 1 h m r p m r δ h m d ω ω w c 1 p m r p m r δ p m d ω ω w c 2 r s c r d ω ω w c 2 r δ s c d ω ω w c 2 h m r s c r δ h m d ω ω w c 2 p m r s c r δ p m d ω ω w g 1 r d ω ω w g 1 h m r δ h m d ω ω w g 1 p m r δ p m d ω γ q w q l w d γ 0 energy balance ω w d 5 r h s r d ω ω w d 5 r δ h s d ω ω w d 5 h m r h s r δ h m d ω ω w d 5 p m r h s r δ p m d ω ω w d 6 r h m r d ω ω w d 6 r δ h m d ω ω w d 6 h m r h m r δ h m d ω ω w d 6 p m r h m r δ p m d ω ω w d 6 s c r h m r δ s c d ω ω w d 7 r p m r d ω ω w d 7 r δ p m d ω ω w d 7 h m r p m r δ h m d ω ω w d 7 p m r p m r δ p m d ω ω w d 7 s c r p m r δ s c d ω ω w d 8 r m t l u r d ω ω w d 8 r m t l δ u d ω ω w d 8 h m r m t l u r δ h m d ω ω w d 8 p m r m t l u r δ p m d ω ω w d 8 h s r m t l u r δ h s d ω ω w e 2 r s c r d ω ω w e 2 r δ s c d ω ω w e 2 h m r s c r δ h m d ω ω w e 2 p m r s c r δ p m d ω ω w e 2 s c r s c r δ s c d ω ω w c 3 r p m r d ω ω w c 3 r δ p m d ω ω w c 3 h m r p m r δ h m d ω ω w c 3 p m r p m r δ p m d ω ω w c 4 r s c r d ω ω w c 4 r δ s c d ω ω w c 4 h m r s c r δ h m d ω ω w c 4 p m r s c r δ p m d ω ω w c 5 r h s r d ω ω w c 5 r δ h s d ω ω w c 5 h m r h s r δ h m d ω ω w c 5 p m r h s r δ p m d ω ω w g 2 r d ω ω w g 2 h m r δ h m d ω ω w g 2 p m r δ p m d ω γ q w q adv d γ γ q w q cond d γ 0 local thermal equilibrium constraint ω w 1 c p s h s r d ω ω w 1 c p s δ h s d ω ω w t m r d ω ω w t m h m r δ h m d ω ω w t m p m r δ p m d ω 0 cryosuction constraint continuous ω w f s c r d ω ω w f s c h m r δ h m d ω ω w f s c p m r δ p m d ω ω w s c r d ω ω w δ s c d ω 0 enhanced ω w f s c r d ω ω w f s c h m r δ h m d ω ω w f s c p m r δ p m d ω ω w s c r d ω ω w δ s c d ω 0 appendix c components of fe matrices and vectors eq 69 k 0 submatrices k 1 1 0 k 1 2 0 k 1 3 0 k 1 4 0 k 1 5 0 k 1 6 0 0 k 2 1 0 k 2 3 0 k 2 4 0 0 k 2 2 0 ω n t c 1 r n d ω k 2 5 0 ω n t c 2 r n d ω k 2 6 0 ω n t c 2 r n d ω k 3 1 0 k 3 3 0 0 k 3 2 0 ω n t c 3 r n d ω k 3 4 0 ω n t c 5 r n d ω k 3 5 0 ω n t c 4 r n d ω k 3 6 0 ω n t c 4 r n d ω k 4 1 0 k 4 2 0 k 4 3 0 k 4 5 0 k 4 6 0 0 k 4 4 0 ω n t 1 c p s n d ω k 5 1 0 k 5 2 0 k 5 3 0 k 5 4 0 k 5 5 0 k 5 6 0 0 k 6 1 0 k 6 2 0 k 6 3 0 k 6 4 0 k 6 5 0 k 6 6 0 0 c 0 submatrices c 1 1 0 ω b t d s b d ω c 1 2 0 ω b t m α p s p m r n d ω ω n u t ρ e f f p m r gn d ω c 1 3 0 ω b t m α p s h m r n d ω ω n u t ρ e f f h m r gn d ω c 1 4 0 ω b t d s 1 3 m β s 1 c p s n d ω c 1 5 0 ω b t m α p s s c r n d ω c 1 6 0 ω b t m α p s s c r n d ω c 2 1 0 ω n t d 4 r m t b d ω c 2 2 0 ω n t d 1 r n d ω c 2 3 0 ω n t d 2 r n d ω c 2 4 0 ω n t d 3 r n d ω c 2 5 0 ω n t e 1 r n d ω c 2 6 0 ω n t e 1 r n d ω c 3 1 0 ω n t d 8 r m t b d ω c 3 2 0 ω n t d 7 r n d ω c 3 3 0 ω n t d 6 r n d ω c 3 4 0 ω n t d 5 r n d ω c 3 5 0 ω n t e 2 r n d ω c 3 6 0 ω n t e 2 r n d ω c 4 1 0 c 4 2 0 c 4 3 0 c 4 4 0 c 4 5 0 c 4 6 0 0 c 5 1 0 c 5 2 0 c 5 3 0 c 5 4 0 c 5 5 0 c 5 6 0 0 c 6 1 0 c 4 2 0 c 6 3 0 c 6 4 0 c 6 5 0 c 6 6 0 0 f subvectors f 1 γ q n u t t d γ f 2 ω n t g 1 r d ω γ q n t q l w d γ f 3 ω n t g 2 r d ω γ q n t q adv d γ γ q n t q cond d γ f 4 ω n t t m r d ω f 5 ω n t f s c r d ω f 6 ω n t f s c r d ω k submatrices k 1 1 k 1 4 0 k 1 2 ω b t m α 2 p s h m p m r h m r n d ω ω b t m α 2 p s p m 2 r p m r n d ω ω b t m α 2 p s s c p m r s c r n d ω ω n u t 2 ρ e f f h m p m r h m r gn d ω ω n u t 2 ρ e f f p m 2 r p m r gn d ω k 1 3 ω b t m α 2 p s h m 2 r h m r n d ω ω b t m α 2 p s p m h m r p m r n d ω ω b t m α 2 p s s c h m r s c r n d ω ω n u t 2 ρ e f f h m 2 r h m r gn d ω ω n u t 2 ρ e f f p m h m r p m r gn d ω k 1 5 ω b t m α 2 p s h m s c r h m r n d ω ω b t m α 2 p s p m s c r p m r n d ω ω b t m α 2 p s s c 2 r s c r n d ω k 1 6 ω b t m α 2 p s h m s c r h m r n d ω ω b t m α 2 p s p m s c r p m r n d ω ω b t m α 2 p s s c 2 r s c r n d ω k 2 1 k 2 4 0 k 2 2 ω n t d 1 p m r p m r n d ω ω n t d 2 p m r h m r n d ω ω n t d 3 p m r h s r n d ω ω n t d 4 p m r m t l u r n d ω ω n t c 1 r n d ω ω n t c 1 p m r p m r n d ω ω n t c 2 p m r s c r n d ω ω n t g 1 p m r n d ω ω n t e 1 p m r s c r n d ω k 2 3 ω n t d 1 h m r p m r n d ω ω n t d 2 h m r h m r n d ω ω n t d 3 h m r h s r n d ω ω n t d 4 h m r m t l u r n d ω ω n t c 1 h m r p m r n d ω ω n t c 2 h m r s c r n d ω ω n t g 1 h m r n d ω ω n t e 1 h m r s c r n d ω k 2 5 ω n t c 2 r n d ω ω n t d 1 s c r p m r n d ω ω n t d 2 s c r h m r n d ω ω n t e 1 s c r s c r n d ω k 2 6 ω n t c 2 r n d ω ω n t d 1 s c r p m r n d ω ω n t d 2 s c r h m r n d ω ω n t e 1 s c r s c r n d ω k 3 1 0 k 3 2 ω n t d 5 p m r h s r n d ω ω n t d 6 p m r h m r n d ω ω n t d 7 p m r p m r n d ω ω n t d 8 p m r m t l u r n d ω ω n t c 3 r n d ω ω n t c 3 p m r p m r n d ω ω n t c 4 p m r s c r n d ω ω n t c 5 p m r h s r n d ω ω n t g 2 p m r n d ω ω n t e 2 p m r s c r n d ω k 3 3 ω n t d 5 h m r h s r n d ω ω n t d 6 h m r h m r n d ω ω n t d 7 h m r p m r n d ω ω n t d 8 h m r m t l u r n d ω ω n t c 3 h m r p m r n d ω ω n t c 4 h m r s c r n d ω ω n t c 5 h m r h s r n d ω ω n t g 2 h m r n d ω ω n t e 2 h m r s c r n d ω k 3 4 ω n t d 8 h s r m t l u r n d ω ω n t c 5 r n d ω k 3 5 ω n t c 4 r n d ω ω n t d 6 s c r h m r n d ω ω n t d 7 s c r p m r n d ω ω n t e 2 s c r s c r n d ω k 3 6 ω n t c 4 r n d ω ω n t d 6 s c r h m r n d ω ω n t d 7 s c r p m r n d ω ω n t e 2 s c r s c r n d ω k 4 1 k 4 5 k 4 6 0 k 4 2 ω n t t m p m r n d ω k 4 3 ω n t t m h m r n d ω k 4 4 ω n t 1 c p s n d ω k 5 1 k 5 4 k 5 5 k 5 6 0 k 5 2 ω n t f s c p m r n d ω k 5 3 ω n t f s c h m r n d ω k 6 1 k 6 4 k 6 5 k 6 6 0 k 6 2 ω n t f s c p m r n d ω k 6 3 ω n t f s c h m r n d ω c submatrices c 1 1 ω b t d s b d ω c 1 2 ω b t m α p s p m r n d ω ω n u t ρ e f f p m r gn d ω c 1 3 ω b t m α p s h m r n d ω ω n u t ρ e f f h m r gn d ω c 1 4 ω b t d s 1 3 m β s 1 c p s n d ω c 1 5 ω b t m α p s s c r n d ω c 1 6 ω b t m α p s s c r n d ω c 2 1 ω n t d 4 r m t b d ω c 2 2 ω n t d 1 r n d ω c 2 3 ω n t d 2 r n d ω c 2 4 ω n t d 3 r n d ω c 2 5 ω n t e 1 r n d ω c 2 6 ω n t e 1 r n d ω c 3 1 ω n t d 8 r m t b d ω c 3 2 ω n t d 7 r n d ω c 3 3 ω n t d 6 r n d ω c 3 4 ω n t d 5 r n d ω c 3 5 ω n t e 2 r n d ω c 3 6 ω n t e 2 r n d ω c 4 1 c 4 2 c 4 3 c 4 4 c 4 5 c 4 6 0 c 5 1 c 5 2 c 5 3 c 5 4 c 5 5 c 5 6 0 c 6 1 c 6 2 c 6 3 c 6 4 c 6 5 c 6 6 0 
792,in this work we present a novel method to interpret at a field scale the preferential flows generated by harmonic pumping tests in which the pumped flowrate varies according to a sinusoidal function with a given period the experimental protocol relies on the application of harmonic pumping tests in a karstic field located near to montpellier southern france at 4 different boreholes each time with a shorter and a longer period and the analysis of the hydraulic responses recorded at the 13 observation wells a qualitative analysis of the oscillatory component in the hydraulic responses in term of amplitude decay and phase lag permitted to propose a preliminary model of degree of connectivity between the boreholes through the network of conduits then a quantitative interpretation of the harmonic responses was applied to image the spatial heterogeneity of the hydraulic properties hydraulic conductivity and storage coefficient by using a deterministic inverse algorithm called cadi this algorithm is based on an equivalent porous medium concept and parameterized by a cellular automata approach in order to provide a realistic reconstruction of the karstic network this algorithm is linked to the groundwater flow equation reformulated in frequency domain to simulate the amplitudes and phase shifts responses to the harmonic pumping tests the inverse process was successfully applied on the dataset collected with both periods in a separate and joint way the results obtained allowed for a discussion on the efficiency of the harmonic pumping tomography for the characterization of the karstic structures keywords hydraulic tomography karst oscillatory signal connectivity modeling conduit network 1 introduction the protection and the management of the water resources involve the identification of the preferential flow paths in the ground therefore one needs to characterize the spatial distribution of the hydraulic properties in the field subsurface a common way to assess the hydraulic properties of a field such as conductivity and specific storage is the analysis of the drawdown responses to a pumping test from which local or average properties can be inferred from analytical equations that relate the hydraulic response to the hydraulic properties butler 2005 however in the case of karstic aquifers the assessment of the hydraulic properties is challenging white 2002 hartmann et al 2014 as the hydraulic properties in this type of aquifer can vary by several orders of magnitude within a short distance wang et al 2016 this makes the characterization of the karstic fields very complex to face this difficulty it is then necessary to interpret the responses of the field by taking into account the positioning of the conduits network which determines the preferential flow paths kovacs 2003 ghasemizadeh et al 2012 saller et al 2013 the hydraulic tomography concept has been widely applied to map the spatial variability of hydraulic properties in both type of aquifers porous and fractured by performing a joint interpretation of hydraulic data recorded simultaneously at several wells as responses to extraction injection of water yeh and liu 2000 bohling et al 2002 zhu and yeh 2005 yeh and lee 2007 cardiff et al 2009a castagna et al 2011 berg and illman 2013 cardiff et al 2013a zha et al 2015 zha et al 2016 zha et al 2017 this approach relies on a numerical technique such as finite difference finite element and finite volume to solve the groundwater flow equation and the inverse process to reconstruct the heterogeneity of the hydraulic conductivities and the storage properties by fitting the piezometric responses the inversion process usually provides a non unique solution which can produce an ambiguous interpretation of the hydraulic data to overcome this issue a prior information on the distribution of the properties can be used to constrain and guide the inversion to a more realistic solution carrera and neuman 1986 in the case of aquifers with a low heterogeneity the geostatistical constraints remain the most simple and efficient way to find accurate solutions hoeksema and kitanidis 1984 kitanidis 1995 fischer et al 2017a in the context of fractured and karstic aquifers the definition of the a priori model or even the strategy for the numerical groundwater flow simulation which can be performed by using various techniques such as equivalent porous media or discrete fractures networks remain the subject of open debates among hydrogeologists in fact for a successful interpretation of hydraulic responses of karstic aquifers the classical geostatistical inversion method would require a dense network of measurement and a significant resolution of model parameterization because of the high contrasts existing in the distribution of the spatial properties recently several inversion methods have been developed for characterizing karst networks one way is to directly incorporate a discrete geometry within a background model using a discrete continuum forward model teutsch 1993 liedl et al 2003 de rooij et al 2013 in this case the parameterization of the inverse problems usually relies on a stochastic generation of discrete fracture networks that are conditioned to statistical li et al 2014 le coz et al 2017 mechanical jaquet et al 2004 bonneau et al 2013 or structural data pardo iguzquiza et al 2012 collon et al 2017 another way is based on a deterministic optimization of the geometry of discrete networks borghi et al 2016 fischer et al 2018a previous studies have shown that equivalent porous media models are able to reproduce the hydraulic flows in karstic aquifers at a kilometric scale larocque et al 1999 abusaada and sauter 2013 or a decametric scale wang et al 2016 however if the scale of investigation is too small this type of model can become unreliable for the characterization of the properties of fractured rocks extremely contrasted and structured at a small scale illman 2014 although the classical geostatistical inverse approaches were originally proposed for inversion of hydraulic fields they can be made adaptive to discrete geometries with special treatments to the prior model e g the total variation prior model lee and kitanidis 2013 or using an iterative procedure e g the sequential successive linear estimator ni and yeh 2008 hao et al 2008 illman et al 2009 sharmeen et al 2012 other methods for inversion of complex discrete structures involve introducing constraints of a priori knowledge to the inverse model using a guided image hale 2009 soueid ahmed et al 2015 a training image lochbühler et al 2015 a probability perturbation caers and hoffman 2006 a transition probability distribution wang et al 2017 a multi scale resolution ackerer and delay 2010 a level set method lu and robinson 2006 cardiff and kitanidis 2009b or based on cellular automata fischer et al 2017b apart from these challenges in modeling techniques a further difficulty in karst aquifer characterization raises from characteristics of hydraulic tests due to the integration nature of pressure diffusion the steady state responses of long term constant rate pumping tests in a karst aquifer represent the combined effect of the multiple media conduits fissures and matrix rather than specific components although the interpretation of transient responses may provide additional information about the relative importance of each aquifer components the inclusion of such data in a modeling in the time domain is also computationally demanding recently harmonic pumping tests have been introduced as an alternative for the identification of the networks of preferential groundwater flows harmonic characterization designates an investigation in which an oscillatory sinusoidal signal is used to disturb the water level of an aquifer different ways to produce such signals have already been proposed a pumping reinjecting system rasmussen et al 2003 renner and messar 2006 a moving mass at the water table interface guiltinan and becker 2015 or a controlled pumping system lavenue and de marsily 2001 then the response signals among the aquifer contain an oscillatory part characterized by an amplitude and a phase offset values that can be easily isolated from the ambient noise bakhos et al 2014 cardiff and barrash 2015 harmonic characterization has already been successfully applied to a large range of complex cases such as contaminated aquifer rasmussen et al 2003 leakage detection sun et al 2015 or fractured aquifers renner and messar 2006 maineult et al 2008 guiltinan and becker 2015 the theoretical aspects of the application of harmonic pumping to karstic aquifers have also been developed in fischer et al 2018b the imagery potential of harmonic investigations has been studied for mapping the distribution of hydraulic properties in heterogeneous aquifers with models solved in the time domain lavenue and de marsily 2001 soueid ahmed et al 2016 or in the frequency domain cardiff et al 2013b zhou et al 2016 in this article we will present a field characterization of karst network based on a harmonic pumping tomography hydraulic data were obtained from the terrieu experimental site located in montpellier in southern france at the same site results of hydraulic tomography in which hydraulic responses were generated with constant rate pumping tests have already been presented and discussed in our previous works wang et al 2016 2017 fischer et al 2017c in this new work we rely our analysis on a set of responses to harmonic pumping tests with different oscillation periods to characterize the karst network we describe in section 2 the experimental study site the harmonic pumping investigation led on it and the processing made on the measured field responses for the later interpretation then in section 3 we briefly introduce the numerical model setup and the cellular automata based deterministic inversion cadi algorithm further details of our inverse algorithm can be found in fischer et al 2017b in section 4 we present the inversion results obtained with the cadi method at the terrieu field site and the efficiency of the method in reproducing the observed hydraulic responses finally section 5 presents a discussion of the effect of the harmonic signal period on the inversion results 2 field investigation 2 1 experimental site presentation the terrieu experimental site is located 15 km in north of the town of montpellier in southern france the site consists of 22 vertical boreholes drilled within a surface area of approximately 2500 m² 40 60 m and permits the study of karstic flows at a local scale fig 1 as a part of the network of the french karst observatory sno karst www sokarst org and the medycyss network jourde et al 2011 the site has been used as a field laboratory for testing new field hydraulic methods and tools developed for the characterization of karstic aquifers jourde et al 2002 jazayeri noushabadi 2009 jazayeri noushabadi et al 2011 dausse 2015 wang et al 2016 wang et al 2017 fischer et al 2017c the geological logs collected from the different boreholes shows that the subsurface of the field is composed of 35 45 m of thin layered marly cretaceous limestones deposited on pure and massive jurassic limestones the interface between these two units is a sloped monocline bedding plane dipping at 20 toward nord west wang et al 2016 the terrieu field is located in the lez regional aquifer temperature and electrical conductivity measurements and packer tests in boreholes presented in previous works jazayeri noushabadi 2009 dausse 2015 have shown the existence of preferential flow paths shown in fig 1 along the bedding plane between the cretaceous and jurassic limestones downhole videos in the boreholes show that at this interface karstic conduits with aperture up to 50 cm are present jazayeri noushabadi et al 2011 the massive jurassic limestones are non aquifer and the cretaceous limestones have a low permeability this causes the aquifer to be confined at the interface between these two layers in the bedding plane a network of karstic conduits has developed preferentially on this bedding plane and controls the fluid circulation within the aquifer 2 2 harmonic pumping investigation the main dataset used in this study was collected from an investigation using harmonic pumping tests performed at the terrieu site we have conducted pumping sequentially in four different boreholes while recording the water level responses in 13 selected observational boreholes see fig 1 the water level responses were also measured in the pumping wells p9 p15 and p20 but not in p3 the static water level before the hydraulic investigation was at a depth of 20 m the maximal drawdown generated by the pumping tests was 4 m therefore the karstic conduits located at a depth of 35 45 m were saturated during the entire duration of hydraulic tests the harmonic pumping tests were performed with a configurable electronical device specially designed for this study by electronics engineers this device controls a flow rate variator linked to the pump which can generate a pumping signal with a sinusoidal shape around a mean value the period and amplitude of the sinusoid signal can be configured with the device the generated pumping rate can be described by 1 q t q m q a cos ω t where q is the output pumping signal m3 s qm the mean pumping rate m3 s qa the oscillatory signal amplitude m3 s and ω 2 π t the pulsation rad s 1 with t the period s different signal amplitudes and mean values were independently applied in each different pumping borehole according to its productivity see table 1 for each pumping location two pumping tests with different periods t 2 min and t 5 min were conducted during 30 min 15 cycles for a 2 min period 6 cycles for a 5 min period water level variations were continuously measured with digital pressure sensors installed in the measurement wells overall this investigation permitted to record 104 drawdown curves 13 measurements for each 2 different periods of signal applied in each 4 pumping wells 2 3 data processing in order to interpret the harmonic signal in the drawdown curves we have performed the same signal decomposition as proposed in fischer et al 2018b this decomposition consists in removing the linear part induced by the mean pumping signal qm from the drawdown curve through a linear regression to keep only the oscillatory response this operation is feasible only after an early transient period accordingly we truncate the first cycle of the recorded responses as we show in fig 2 for the pumping in p15 the operation of removing the linear part is acceptable as the resulting signals appear to be purely oscillatory some natural noises and vibrations induced by the pumping appear as high frequencies fluctuations in the oscillatory responses mathematically the drawdown curves generated by the harmonic pumping tests can be approximated as a sum of a linear signal and an oscillatory signal applied on the initial water table level 2 h t h l i n t h o s c t h 0 w i t h h l i n t a t h 0 a n d h o s c t a cos 2 π t t φ π 180 where h represents the drawdown m over time h lin is a linear signal described by its slope a m s and its intercept h 0 m whose values can be retrieved by linear regression h osc is an oscillatory signal described by its amplitude a m its period t s and its phase shift φ and h 0 represents the initial water table level m in our case we considered h 0 0 m the linear signal h lin can be easily estimated in a first approximation through a linear regression performed on each drawdown curve after removing this linear trend the amplitude and phase offset of the remaining signal of each borehole can be determined by a fast fourier transform fft on their oscillatory signals the fft permits to extract the main oscillatory components of a signal to denoise it and to interpret its parameters fig 3 presents the fft results for the oscillatory signals of three representative boreholes p10 p11 p2 during a pumping in p15 with the two periods 2 min and 5 min the interpretation results of amplitude and phase offset for the entire dataset are presented in appendix table a1 2 4 preliminary analysis the different responses of amplitude and phase offset interpreted in p10 p11 and p2 highlight three distinct flow behaviors fischer et al 2018b the responses in p10 having a negligible amplitude 1 mm relatively to the pumping signal which we interpreted as a negligible oscillatory response is associated to a matrix connectivity between the pumping and the observational well in contrast the response in p11 has a significant amplitude and an almost invariable phase relatively to the pumping signal for the two different periods this behavior is associated to a conduit connectivity response meaning that p15 and p11 would be connected through a karstic conduit network the response in p2 has a lower amplitude response than p11 and its phase offset relatively to the pumping signal increases as the pumping period decreases 71 for a 2 min signal 38 for a 5 min signal this third behavior is associated to a dual connectivity response which corresponds to an inter well connection either through fissures or when the observation borehole is located in the matrix but close to a conduit following the method described in fischer et al 2018b and through the integration of the amplitude and phase offset results interpreted for each pumping observation well pair it is possible to obtain a map of inter well connectivity which contains qualitative information regarding the spatial distribution of the conduit network and the relative position of boreholes to the network we can first link on the map the boreholes with a low phase shift relatively to the pumping signal to represent a conduit connection from this conduit connectivity we can then establish a possible conduit network and then verify that the other boreholes responses would be adequate toward their position to the interpret network dual connectivity with higher phase shift for boreholes close to the network and matrix connectivity with negligible responses for the others possible connectivity maps interpreted with the responses to the harmonic pumping test in p15 for a period of 2 min and 5 min are proposed in fig 4 the comparison between the two connectivity maps in fig 4 shows that the period of the harmonic pumping signal may have a slight impact on the connectivity interpretation for example in the pumping test with a 2 min period p1 can be interpreted as connected to the pumping well through conduits but not in the pumping test with a 5 min period this implies that a change in the period of the pumping signal modifies the flow field induced by the pumping furthermore the manual interpretation is possible only when the amount of hydraulic data to deal with is limited 13 responses for each period in fig 4 therefore although such a qualitative analysis through manual interpretation of inter well connectivity could provide some important guidance to hydrogeological investigation such as indicating the general trend of the main conduits and relative inter well connectivity to obtain a quantitative hydrodynamics characterization and to integrate a larger amount of hydraulic measurements 104 responses from 4 different pumping locations with each time two different periods an inverse modeling is required 3 modeling methodology 3 1 forward problem and model parameterization inverse modeling involves the use of the forward problem in order to simulate for a given model of hydraulic properties the hydraulic responses in this section we present a 2d model that represents the property field along the bedding plane interface in which the karstic network has developed on the terrieu site as seen in the previous section the variation of the piezometric level among the site in response to a harmonic pumping can be approximated by the sum of a linear drawdown and an oscillatory drawdown eq 2 we simulate in the model only the oscillatory part of the drawdown responses h osc the inversion aims to reproduce the values of amplitude and phase offset of the oscillatory part in the measured responses this oscillatory part can be described as a signal in the frequency domain in the model 3 h osc x y t re h ω x y e i ω t with h ω a complex parameter holding the amplitude and phase offset responses over space x y re the function returning the real part of a complex value ω 2 π t the pulsation rad s 1 and i the imaginary unit this oscillatory feature of the hydraulic signal permits to rewrite the time domain form of the groundwater flow equation into a frequency form in order to reduce the computation time of the forward problem in a 2d porous isotropic and saturated domain γ the groundwater flow equation based on the darcy s law in a frequency domain can be expressed as 4 i ω s s h ω k h ω q a v el δ x x s y y s with s s the specific storage distribution m 1 k the conductivity distribution m s q a the pumping amplitude m3 s v el an elementary volume of the finite element grid in the model and δ x xs y ys the dirac distribution where xs ys represents a pumping location as the system is 2d with a unit thickness conductivity k and transmissivity t are of same value as well as specific storage s s and storativity s in this study we considered darcy s law to be acceptable for representing the flows generated in the karstic structures in fact it appears from the previous studies on the terrieu site that the flows in the conduits have a low velocity inducing a low reynolds value even for higher pumping rates than the ones used during this new investigation the initial and boundary conditions used for solving eq 4 are 5 h ω x y 0 x y γ a s i n i t i a l c o n d i t i o n h ω x y 0 w h e n x y γ b o u n d a s b o u n d a r y c o n d i t i o n the spatial distribution of the complex parameter h ω permits the reconstruction of the oscillatory responses simulated among the model through the calculation of their amplitude and phase offset values 6 ampl itude a x y re h ω x y 2 im h ω x y 2 in m phase offs et φ x y 180 π atan 2 im h ω x y re h ω x y in where re and im are the functions returning the real and imaginary parts of a complex value and atan2 is the function returning the inverse tangent value in radian mode from two arguments the simulated response signals are then reconstructed temporally and spatially 7 h o s c x y t a x y cos ω t φ x y π 180 in a karstic medium the spatial response signals are very dependent to the highly heterogeneous distribution of the field properties t and s along the karstic conduits therefore this heterogeneity has to be taken into account in the distribution of these properties in the model in order to simulate a realistic responses behavior for this purpose we chose to apply as parameterization for our model and inverse problem the cellular automata based deterministic inversion cadi method developed and detailed in fischer et al 2017b for a detailed description of the cadi method we refer the reader to fischer et al 2017b as we will only briefly summarize the concept in this article the cadi method uses a particular parameterization of the property field in the model to generate linear structures conduits over a background matrix the field is composed of a grid of cells each cell being assigned to a value of transmissivity and storativity this grid of cells is divided in m ca subspaces each one being controlled by a cellular automaton piloting the part of the cells inside of its subspace fig 5 the cellular automata concept is a mathematical tool which permits to generate structures within a grid with simple neighborhood and transition rules von neumann and burks 1966 the cellular automata control the local direction of generation of the conduit in the different subspaces they are piloted through eight different neighborhood definition n i i 1 8 that permit to define eight different directions one of these eight direction possibilities is assigned to each cellular automaton in the subspaces the conduit network is generated by first assigning a state matrix or conduit to each cell the whole cells are initially in state matrix except an initial cell of the grid in state conduit which designates the starting point and starting subspace for the generation of the conduits the network of conduits then generates following the different local direction affected to each subspace it crosses the generation ends once each part of the network has reached an end either the limit of the model or a subspace in which the network has already generated then property values are assigned to the cells depending on their state matrix or conduit and their localization subspace each subspace defines locally a value for t mat and s mat for its cells in state matrix and a value for t cond and s cond for its cells in state conduit in order to be able to easily pilot and modify the configuration of the model through this parameterization the structural directions and properties assigned to each subspace are defined in two parameter vectors p n and p β p n is a m ca vector containing the directions of generation n i i 1 8 assigned to each subspace several independent networks can be generated in the same model with different directions parameters for each network in this case p n becomes a m ca frac matrix where frac represents the amount of independent networks in the model each column contains the subspaces directions for each network p β is a 4 m ca vector containing the t mat and s mat and the t cond and s cond values assigned to each subspace in this way the parameters controlling the configuration of the model and thus the model itself can be easily and locally modified p n and p β represent the parameters to be optimized in the inverse problem in order to reproduce the observed data amplitude and phase offset responses through a suitable model 3 2 inverse problem the inverse problem consists in retrieving the best values for the parameters contained in pn and p β regarding the minimization of the gap between the simulated data and the observed data amplitude and phase offset responses at the measurement points for the different pumping tests this inverse algorithm contains two steps in which we seek to minimize two objective functions sequentially ψ structure for the optimization of the structural parameter p n and ψ properties for the optimization of the property parameter p β tarantola and valette 1982 8 ψ s t r u c t u r e p n 1 2 d o b s f γ p n p β t c d 1 d o b s f γ p n p β 1 2 p n p r i o r p n t c p n 1 p n p r i o r p n 9 ψ p r o p e r t i e s p β 1 2 d o b s f γ p n p β t c d 1 d o b s f γ p n p β 1 2 p β p r i o r p β t c p β 1 p β p r i o r p β where d obs is a n vector containing the n measured responses f γ p n p β is a n vector containing the responses simulated with the model at the same positions than in d obs c d is a n n matrix of covariance on the data p n prior is a m ca vector holding a priori structural parameters for p n p β prior is a 4 m ca vector holding a priori property values for p β and c p n and c p β are m ca m ca and 4 m ca 4 m ca matrices of prior covariance on the parameters p n and p β at the beginning of the inversion process the variable parameters p n and p β are initialized with a priori conduit directions and property values in order to create the initial model then a sequential and deterministic process optimizes firstly the structural parameters in p n considering the initial properties in p β as invariable and then in second step the property parameters in p β considering the previously optimized p n as invariable finally after the optimization process the posterior uncertainties on the structural and property parameters are estimated 3 2 1 optimization of the structural parameters the optimization of the structural parameters in p n is an iterative process in which a sensitivity matrix is computed at each iteration step to minimize the objective function in eq 8 this analysis requires the computation of a 8 m ca sensitivity matrix s at a given iteration step k each element i j of the matrix is calculated as follow 10 s k i j d o b s f γ p n k p n k j n i p β t c d 1 d o b s f γ p n k p n k j n i p β 1 2 p n p r i o r j n i t c p n 1 p n p r i o r j n i where f γ p n k p n k j n i p β represents the responses simulated with the modified direction n i in the subspace p n k j and p n prior j n i denotes the angular gap between the modified direction n i and the a priori direction p n prior j the coordinates i min j min of the minimal value in the sensitivity matrix provide the subspace to be optimized j min and the direction to apply i min in order to minimize the objective function during this iteration at the end of an iteration the value of the structural objective function is recalculated this iterative optimization ends when the objective function has reached a minimum no more structural modification can decrease the objective function the optimized parameters in p n will then be considered as invariable during the optimization of p β after the convergence of the objective function in the structural optimization the uncertainties on the local directions of the geometry of the network can be estimated from the posterior structural covariance 11 c p n post j 1 8 i 1 8 s post i j ψ stru cture post c p n 1 j j 1 where c p n post j denotes the uncertainty associated to the direction of the subspace j s post is the sensitivity matrix of the last iteration and ψ stru cture post is the value of the minimized objective function associated to the last iteration the higher the uncertainty value associated to a subspace is the more the direction of the subspace in uncertain in the contrary a low value denotes a well constrained direction 3 2 2 optimization of the property parameters in the second step we estimate the hydraulic properties in p β through an iterative optimization process and by considering the previously optimized p n as invariable the process relies on a linearization of the objective function in eq 9 through the computation of the jacobian matrix at an iteration step k the values of the properties in p β are updated from the previous ones as follow 12 p β k 1 p β k j k t c d 1 j k c p β 1 1 j k t c d 1 d obs f γ p n p β k c p β 1 p β prior p β k where j is the n 4 m ca jacobian matrix calculated with a finite difference method j i j f i p β p β j p β j δ p β with δp β a finite difference step the value of the properties objective function is recalculated at the end of each iteration this iterative optimization ends when the objective function converges to a minimum value the uncertainties on the t and s values can then be estimated through the computation of the posterior properties covariance matrix the square root values of the diagonal entries of this matrix represent the standard deviation associated to each property value 13 c p β post j post t c d 1 j post c p β 1 1 where c p β post j j denotes the variance of the jth property parameter in p β and j post is the jacobian matrix of the last iteration 4 modeling application 4 1 modeling strategy we have applied the cadi method on the 2d parameterized model presented in the previous section in order to find a structured property distribution able to reproduce the measured oscillatory responses amplitudes and phase offsets presented in the section 2 3 we considered the oscillatory responses interpreted as negligible amplitude 1 mm to be null for the inversion we have coded the cadi algorithm with matlab and used comsol multiphysics to solve the model in the frequency domain see eq 5 this resolution was led using a finite element method on a triangular mesh refined around the boundaries between the matrix and the conduit network represented by the equivalent porous media properties distributed over the model this mesh refinement is performed with the comsol mphimage2geom function on the conduit network image generated by the cellular automata the distributed model is constructed as a 40 60 m² rectangle included in a 1000 1000 m² buffer zone the external boundaries of the buffer zone are built with imposed dirichlet boundary conditions as presented in eq 5 thus this zone permits to limit the effect of the boundary conditions on the parameterized model the values of the parameters chosen for the model parameterization and the inversion process are presented in table 2 the initial values for the inversion were chosen accordingly to estimates from previous studies on the terrieu site jazayeri noushabadi 2009 dausse 2015 wang et al 2016 in the inverse problem the properties values β in p β were associated to the exponent of the transmissivity and the storativity the initial standard deviation values on the data σ data and on the property parameters σ t σ s are used to construct the covariance matrices as diagonal matrices cd σ data 2 id n and c p β σ prop 2 id 4 m ca no a priori information were considered for the structure local directions in p n prior and c p n the inversion was led following a multi scale method grimstadt et al 2003 as described in fig 6 the multi scale inversion consists in performing an inversion first for a coarse resolution of the model and then use the inversion result as a new initial model with a higher resolution for a new inversion process this permits to progressively reduce the size of the discretization cells for the property field during the inversion which can be interesting for studies on heterogeneous fields with no prior information on the property distribution this was already done with the cadi method in fischer et al 2017c the initial model has been constructed with two unidirectional conduits with uniform property values see table 2 as a coarse approximation of the manual estimation made in fig 4 a first set of inversions were led by separating the 2 min and 5 min period responses and with a 6 4 subspaces partitioning of the model with a conduit thickness of 2 m the results of these separate inversions have then been repartitioned in 12 8 subspaces models with a conduit thickness of 1 m which were used as initial models for a new inversions with the same datasets this partitioning of the models permits to give more liberty to the inversion process while starting from not too far solutions which is especially interesting for a deterministic process the inversion results for the 12 8 models with 2 min and 5 min data separated will be presented in section 4 2 a final inversion process has consisted in starting from these 12 8 separate results with the same partitioning by adding the 5 min data to the 2 min inversion result and the 2 min data to the 5 min results for joint inversions the results of these joint inversions will be discussed in section 4 3 4 2 modeling results fig 9 shows the spatial distribution of hydraulic transmissivity and storativity inverted using the responses to the 2 min and 5 min periods respectively the comparison between the measured and simulated hydraulic responses is presented in fig 7 and table 3 it can be seen that the simulated responses match the measured ones quite well the simulated responses to the p15 pumping appear to be slightly overestimated implying the existence of a very productive conduit in p15 that could not be simulated in the presented model otherwise the responses proportions and behaviors for each pumping are well respected with the simulated signals overall the root mean square error rmse of the amplitude is 1 1 cm for the 2 min response signals and 0 5 cm for the 5 min response signals the rmse of the phase offset is 56 for the 2 min response signals and 66 for the 5 min response signals see table 3 the difficulties in reproducing the phase offset data with the cadi method may be contributed to the high degree of variation of the phase shift within the low transmissivity matrix fig 8 a small displacement of a certain wellbore location by 1 m in the matrix can modify the phase offset by a value of 90 thus our phase offset rmses remain under the variations produced by a 1 m displacement on the field which is acceptable at our scale the amplitude of the signal is also decaying very fast in the matrix fig 8 thus the amplitude of a response is already a good information to characterize the proximity of a borehole with a conduit of the karst network according to fischer et al 2018b and the maps in fig 8 produced with the cadi method the amplitude in the responses signals of a karstic aquifer permit to distinguish the boreholes in or near conduits from the ones in the matrix on the other side the phase offset response permit to characterize more precisely the distance of a responding borehole to conduits as it varies orthogonally to the direction of the conduit and stays very low within the network one advantage of using the cadi method in this work is that the optimized conduits networks can be clearly distinguished from the matrix in the inverted fields in fig 9 if these optimized conduits networks represent only one possible geometry among other likely models they permit to interpret the relative positioning of each borehole in a conduit close to a conduit or in the matrix and thus a degree of connectivity between them the models of networks produced by inversions of pumping tests of different periods are very different indicating that the both sets of responses provide different hydraulic information of the aquifer the reconstructed network for the dataset of a period of 5 min is denser than that for a period of 2 min the 5 min period dataset seems to carry information about karstic structures of different scales conduits fractures fissures around the measurement points while the 2 min period dataset tends to characterize more specifically the most conductive karstic structures over the field scale this hypothesis is supported by the maps of the amplitude in the models amplitude responses to a 2 min pumping signal in p15 quickly decease around the borehole but remain visible in the coarse network over almost the entire field while the ones to a 5 min pumping signal stay high in the dense karstic network around p15 and decrease beyond fig 8 concerning the property values it appears that the reproduction of the responses required more modifications on the transmissivity values than on the storativity especially for the conduits some similarities appear between the results to both periods for example the existence of conduits near p9 with lower transmissivities which can then be assimilated more likely to large fissures rather than conduits also in both results the conduits around p15 have been associated to very high transmissivities 1 m² s which tends to indicate the existence of a very productive conduit at this position this information could already been deduced by the fact that the responses induced by a pumping in p15 in the model were slightly overestimated fig 7 the fact that the two periods of signal lead to different solutions to the inverse problem even by starting from a same initial model tends to indicate that different periods of pumping signal induce different flow fields in the tested karst aquifer in order to better understand the benefits of each period in a harmonic pumping characterization one would need to study the results of the joint inversions led with the responses to both periods simultaneously 4 3 effect of the period of pumping signal on the inversion results it appears in fact see table 3 that the separate models can badly simulate the responses associated to the signal period not used in each inversion i e 5 min responses simulated through the model generated with 2 min responses and conversely suggesting that each set of response contains different and complementary information for the characterization of the field therefore new inversions were started from the results presented in fig 9 as initial models by joining the missing responses to the observed responses dataset in the inverse process see the joint inversion results in fig 6 for a better understanding we will mention as 2 min and 5 min separate results the model results in fig 9 produced from the inversion of the responses to the 2 min and 5 min periods separately the models produced by inversions of the joint datasets started with the 2 min model and with the 5 min model will be respectively mentioned as the 2 min 5 min and 5 min 2 min joint results the results of the joint inversions are presented in fig 10 the 2 min 5 min result solution to the inversion started from the 2 min result is very close to its initial model the 5 min 2 min result solution to the inversion started from the 5 min result shows some modifications on the periphery of its network p4 p5 p10 p11 both joint solutions however do not permit a reproduction of the measured signals as good as the one generated by the 2 min and 5 min separate results see table 3 although the phase offsets rmses are almost the same for the joint results and the separate results the amplitudes rmses are multiplied by 5 10 with the joint results this shows that even if the amplitude responses can be well reproduced by separate models for each period they cannot be reproduced very well with a unique model this tends to validate the hypothesis that different periods of pumping signal induce different flow fields in the aquifer which need to be characterized separately in fact the cadi method is limited in its ability to represent a variation of aperture in the generated network which can partly explain why the joint inversions are less good than the separate ones if the flows mobilized with each period occur in structures of different apertures however even if the preferential flows change among the field for different pumping periods the relative distance of each borehole toward the karstic network does not depend on the hydrodynamic but on the morphology of the karst structures and thus their connectivity behavior should logically remain the same as the karst structure does not vary with the period of pumping this is also what the reproduction of the phase offset values in the joint results would tend to indicate in fact according to fig 8 if the area of propagation of the amplitude response is dependent to the density of the conduit network at that scale it is not true for its phase offset which remains null in the conduits regardless of the network geometry in table 4 we present the interpretation of the position of each borehole relatively to the conduits network with the data processing estimations the separate modeling results and the joint modeling results first it is interesting to point out that the estimations made manually in fig 4 for the p15 pumping match for 62 in term of position in the conduit close to a conduit in the matrix the separate modeling results 2 min and 5 min taking account that the estimation were made with only 13 responses over the 52 available it shows that the manual interpretation method described in section 2 4 and in fischer et al 2018b can already provide rather interesting and fast estimations according to fig 8 the amplitude and phase offset responses of an observable point very close to a conduit 0 5 m are almost undistinguishable to the ones directly in a conduit therefore we consider these points to also have a conduit connectivity response in table 4 fig 11 maps represent the interpreted connectivity of each borehole obtained from the joint inversion results this figure also shows that these results reproduce the schema of connectivity of the preferential flow path established in jazayeri noushabadi 2009 and dausse 2015 between p2 p11 p15 and p20 see fig 1 taking into account the connectivity response 57 of the boreholes show a similar behavior between the 2 min and the 5 min separate results this degree of similarity increases to 93 when comparing the boreholes connectivity responses from the two joint results the only behavior difference between the two results comes from p21 which appears as connected through the matrix in the 2 min 5 min result and as connected through conduits in the 5 min 2 min result however the property distribution of the 2 min 5 min result in fig 10 shows that its matrix transmissivity near the p21 point has a value close to a conduit transmissivity this permits to induce a conduit connectivity behavior for p21 even if the conduit is distant from the borehole therefore we can consider that p21 should have a conduit connection behavior the fact that the degree of similarity of the boreholes behavior has increased to almost 100 for two joint result clearly shows that the reproduction of the whole responses dataset requires to delineate a unique connectivity relation between each borehole even if it is not sufficient to reproduce the amplitudes of the measured responses the remaining question is which period of signal contains this information as the separate results show only a 57 similarity the conduits network almost didn t change during the joint inversion started from the 2 min result and in fact the separate 2 min result and the joint 2 min 5 min result show a 93 similarity in their borehole behaviors while the 5 min result has a degree of similarity of 71 with 5 min 2 min then most of the borehole behaviors found in the joint results were already present in the result of the 2 min signal period which indicates that the 2 min responses contain the most information about the connectivity of each borehole if the two sets of amplitude responses are not well reproduced by the joint inversion while they both delineate a similar type of response for each borehole it shows that the characterized property distribution in extenso the induced flow paths network is different for each period in fact the responses to a 5 min period require a dense flow network to be reproduced while the responses to a 2 min period require a much more dispersed network the structural posterior uncertainty maps in fig 12 indicate that the network of the 2 min result is very uncertain compared to the network of the 5 min result this indicates that the responses to a 5 min period contain more information on the localization of the flow paths around the measurement points than the responses to a 2 min period these last ones seem to provide less precise information on the localization of the flows between the boreholes among the field when inverting jointly the responses from the two period the networks in the joint results show overall lower uncertainties globally the study of the structural uncertainties tends to indicate that while as seen before responses to a the lower period contain more information on the type of connectivity of each borehole the responses to the higher period contain more information on the position of the preferential flow paths around the boreholes however the fact that these both sets of responses cannot be well reproduced simultaneously also indicates that the flows highlighted in the 5 min result do not exist with a period of 2 min therefore while the lower period essentially mobilizes water from the most conductive karstic structures among the field the dense flow field highlighted by the higher period can be assimilated to a mobilization of water also in less conductive karstic structures the maps of the posterior uncertainties on the transmissivity values in fig 13 tend to show that the responses to a 2 min period give more information on the transmissivity of conduits locally around the pumping points average 0 1 on the transmissivity exponent than the responses to a 5 min period 0 2 on the transmissivity exponent the uncertainties on the storativity values remain high in the whole conduit network and for both periods 0 2 on the storativity exponent further from the pumping boreholes both property values in the conduits network transmissivity and storativity globally remain uncertain 0 3 on the exponent even in the joint results the transmissivity and storativity values in the matrix are more constrained around the measurement points in the matrix these information indicate that for both periods the characterization of the property values with oscillatory responses remains local around the boreholes oscillatory responses provide more information on the global connectivity and the localization of preferential flows rather than on the property values of the matrix and the conduits and fissures in the aquifer overall regarding our results it appears that the flow paths generated by periods of 2 min and a 5 min in the pumping signals in this karstic field are very different it appears in fact that at our field scale higher frequency signals here a period of 2 min activate principally the most conductive flow paths over the field mostly located in the conduits network these frequencies permit to better characterize the distance between each borehole and the most conductive karstic structures therefore they allow a better interpretation of a degree of connectivity between boreholes through the network of karstic conduits lower frequency signals here a period of 5 min activate at our field scale both conductive and also less conductive structures therefore these frequencies permit to better characterize the existence and the localization of networks of fractures and fissures around the boreholes 5 discussion in fischer et al 2018b the authors have described a qualitative method for interpreting inter well connectivity from the responses to harmonic pumping tests in karstic aquifers by categorizing the extracted oscillatory responses in three types conduit dual matrix connectivity in this work the method is further developed through the integration of a quantitative interpretation with an inverse algorithm the cadi method that can handle a large number of measured data simultaneously and generate complex distributions of properties the integrated approach permits to produce spatial distributions of amplitude and phase offset responses consistent with those studied by fischer et al 2018b the comparison of inverted conduit networks from periods of 2 min and 5 min indicates different pumping frequency generate different flow fields a higher frequency will permit to better characterize the flows in highly conductive structures and the conduit connectivity at a field scale this finding is consistent with the work of rabinovich et al 2015 where the authors show that the flow paths tend to follow the most conductive media especially at lower period on the contrary a lower frequency will permit to better characterize the flows in less conductive structures and thus the localization of networks of smaller conduits fractures and fissures each frequency of signal permits to generate responses holding different and complementary information on karst structures there is therefore according to our results no best choice of period for the characterization of a karstic field this choice should be made accordingly to what structures one would most likely characterize the important impact of the period of the pumping signal on the ratio of conduit matrix flows has already been highlighted with a simplified study case in fischer et al 2018b but our new work also shows a more complex role of the different structures conduit fracture fissure matrix on the generation of different flow fields with the different frequencies of pumping signal to summarize if at a regional scale one would imagine that the difference between a lower and a higher frequency pumping would principally concern the zone of influence in the aquifer with a larger zone for a lower frequency this difference implies more specific behaviors at a smaller site scale in fact at this scale higher frequencies mobilize water essentially in the most conductive structures while lower frequencies permit to reach also a mobilization of water in the less conductive structures and media on another hand oscillatory responses do not provide precise information on the conductivity and specific storage values in the conduits and the matrix very far from the pumping point however the same observation was made on the same field for the inversion of steady state responses to eight pumping tests at constant rates in fischer et al 2017c this previous article also showed that steady state data to constant rate pumping comparable to an infinitely high oscillatory period were more sensitive to fracture flows and required a dense inverted network to be reproduced which is in agreement with our observation for a higher period of signal in this work furthermore the uncertainty analysis from this previous article indicated that the constant rate data as the data for a period of 5 min in the pumping signal in this work permitted to better characterize the flow structures in areas where we had measurement points the inverted networks in the results from our new work and the ones in fischer et al 2017c both reproduce the established connectivity of the terrieu field jazayeri noushabadi 2009 dausse 2015 but in the case of the constant rate data the inversions were led with responses to an investigation of eight pumping points instead of four with the harmonic investigation the results of our new work associated to the previous ones in fischer et al 2017c tend to indicate that the steady state responses to a constant pumping rate would blur the connectivity associated to the most conductive conduits among the field while better characterizing the karstic structures of different scales in the areas around the pumping wells therefore it would require several well distributed pumping points in order to characterize the whole karstic network responses to an oscillatory pumping rate on contrary allow an already good characterization of the karstic connectivity from a unique pumping in a borehole in the karstic network as p15 in this work 6 conclusion in this work we have extended the qualitative method presented in fischer et al 2018b for interpreting a karstic network connectivity from the hydraulic responses to harmonic pumping tests to a quantitative analysis by combining these responses with an inversion algorithm the integrated approach is able to deal with a large set of data simultaneously and to construct structurally contrasted distributions of hydraulic properties conditioned to the measured tomographic harmonic pumping responses our results show that tomographic harmonic pumping tests performed with different signal frequencies led to a characterization of different structures of the karstic network higher frequency signals tend to assist in interpreting a degree of connectivity between each borehole of the field and the most conductive structures while lower frequency signals are more useful in the localization of less conductive features such as small fractures and fissures the cadi method as imaging tool shows limitations in its ability to represent complex structures of different aperture simultaneously as already noticed in fischer et al 2017c which can partly explain the less good results of the joint inversions compared to the separate inversions in this work however we believe that the combination of the cadi method with tomographic harmonic pumping tests appears as a promising methodology for a quantitative characterization of the hydraulic properties and the hydraulic connectivity in karstic aquifers conflict of interest none acknowledgments we would like to thank todd c rasmussen and two anonymous reviewers for their relevant comments and propositions which permitted to significantly improve the quality of this article we thank the normandy region for providing financial support for the ph d of pierre fischer we also thank michel simon for his precious contribution during the field investigation the hydraulic data collection and hydrogeological characterization of the terrieu experimental site are part of work of the french research network sno karst appendix a 
792,in this work we present a novel method to interpret at a field scale the preferential flows generated by harmonic pumping tests in which the pumped flowrate varies according to a sinusoidal function with a given period the experimental protocol relies on the application of harmonic pumping tests in a karstic field located near to montpellier southern france at 4 different boreholes each time with a shorter and a longer period and the analysis of the hydraulic responses recorded at the 13 observation wells a qualitative analysis of the oscillatory component in the hydraulic responses in term of amplitude decay and phase lag permitted to propose a preliminary model of degree of connectivity between the boreholes through the network of conduits then a quantitative interpretation of the harmonic responses was applied to image the spatial heterogeneity of the hydraulic properties hydraulic conductivity and storage coefficient by using a deterministic inverse algorithm called cadi this algorithm is based on an equivalent porous medium concept and parameterized by a cellular automata approach in order to provide a realistic reconstruction of the karstic network this algorithm is linked to the groundwater flow equation reformulated in frequency domain to simulate the amplitudes and phase shifts responses to the harmonic pumping tests the inverse process was successfully applied on the dataset collected with both periods in a separate and joint way the results obtained allowed for a discussion on the efficiency of the harmonic pumping tomography for the characterization of the karstic structures keywords hydraulic tomography karst oscillatory signal connectivity modeling conduit network 1 introduction the protection and the management of the water resources involve the identification of the preferential flow paths in the ground therefore one needs to characterize the spatial distribution of the hydraulic properties in the field subsurface a common way to assess the hydraulic properties of a field such as conductivity and specific storage is the analysis of the drawdown responses to a pumping test from which local or average properties can be inferred from analytical equations that relate the hydraulic response to the hydraulic properties butler 2005 however in the case of karstic aquifers the assessment of the hydraulic properties is challenging white 2002 hartmann et al 2014 as the hydraulic properties in this type of aquifer can vary by several orders of magnitude within a short distance wang et al 2016 this makes the characterization of the karstic fields very complex to face this difficulty it is then necessary to interpret the responses of the field by taking into account the positioning of the conduits network which determines the preferential flow paths kovacs 2003 ghasemizadeh et al 2012 saller et al 2013 the hydraulic tomography concept has been widely applied to map the spatial variability of hydraulic properties in both type of aquifers porous and fractured by performing a joint interpretation of hydraulic data recorded simultaneously at several wells as responses to extraction injection of water yeh and liu 2000 bohling et al 2002 zhu and yeh 2005 yeh and lee 2007 cardiff et al 2009a castagna et al 2011 berg and illman 2013 cardiff et al 2013a zha et al 2015 zha et al 2016 zha et al 2017 this approach relies on a numerical technique such as finite difference finite element and finite volume to solve the groundwater flow equation and the inverse process to reconstruct the heterogeneity of the hydraulic conductivities and the storage properties by fitting the piezometric responses the inversion process usually provides a non unique solution which can produce an ambiguous interpretation of the hydraulic data to overcome this issue a prior information on the distribution of the properties can be used to constrain and guide the inversion to a more realistic solution carrera and neuman 1986 in the case of aquifers with a low heterogeneity the geostatistical constraints remain the most simple and efficient way to find accurate solutions hoeksema and kitanidis 1984 kitanidis 1995 fischer et al 2017a in the context of fractured and karstic aquifers the definition of the a priori model or even the strategy for the numerical groundwater flow simulation which can be performed by using various techniques such as equivalent porous media or discrete fractures networks remain the subject of open debates among hydrogeologists in fact for a successful interpretation of hydraulic responses of karstic aquifers the classical geostatistical inversion method would require a dense network of measurement and a significant resolution of model parameterization because of the high contrasts existing in the distribution of the spatial properties recently several inversion methods have been developed for characterizing karst networks one way is to directly incorporate a discrete geometry within a background model using a discrete continuum forward model teutsch 1993 liedl et al 2003 de rooij et al 2013 in this case the parameterization of the inverse problems usually relies on a stochastic generation of discrete fracture networks that are conditioned to statistical li et al 2014 le coz et al 2017 mechanical jaquet et al 2004 bonneau et al 2013 or structural data pardo iguzquiza et al 2012 collon et al 2017 another way is based on a deterministic optimization of the geometry of discrete networks borghi et al 2016 fischer et al 2018a previous studies have shown that equivalent porous media models are able to reproduce the hydraulic flows in karstic aquifers at a kilometric scale larocque et al 1999 abusaada and sauter 2013 or a decametric scale wang et al 2016 however if the scale of investigation is too small this type of model can become unreliable for the characterization of the properties of fractured rocks extremely contrasted and structured at a small scale illman 2014 although the classical geostatistical inverse approaches were originally proposed for inversion of hydraulic fields they can be made adaptive to discrete geometries with special treatments to the prior model e g the total variation prior model lee and kitanidis 2013 or using an iterative procedure e g the sequential successive linear estimator ni and yeh 2008 hao et al 2008 illman et al 2009 sharmeen et al 2012 other methods for inversion of complex discrete structures involve introducing constraints of a priori knowledge to the inverse model using a guided image hale 2009 soueid ahmed et al 2015 a training image lochbühler et al 2015 a probability perturbation caers and hoffman 2006 a transition probability distribution wang et al 2017 a multi scale resolution ackerer and delay 2010 a level set method lu and robinson 2006 cardiff and kitanidis 2009b or based on cellular automata fischer et al 2017b apart from these challenges in modeling techniques a further difficulty in karst aquifer characterization raises from characteristics of hydraulic tests due to the integration nature of pressure diffusion the steady state responses of long term constant rate pumping tests in a karst aquifer represent the combined effect of the multiple media conduits fissures and matrix rather than specific components although the interpretation of transient responses may provide additional information about the relative importance of each aquifer components the inclusion of such data in a modeling in the time domain is also computationally demanding recently harmonic pumping tests have been introduced as an alternative for the identification of the networks of preferential groundwater flows harmonic characterization designates an investigation in which an oscillatory sinusoidal signal is used to disturb the water level of an aquifer different ways to produce such signals have already been proposed a pumping reinjecting system rasmussen et al 2003 renner and messar 2006 a moving mass at the water table interface guiltinan and becker 2015 or a controlled pumping system lavenue and de marsily 2001 then the response signals among the aquifer contain an oscillatory part characterized by an amplitude and a phase offset values that can be easily isolated from the ambient noise bakhos et al 2014 cardiff and barrash 2015 harmonic characterization has already been successfully applied to a large range of complex cases such as contaminated aquifer rasmussen et al 2003 leakage detection sun et al 2015 or fractured aquifers renner and messar 2006 maineult et al 2008 guiltinan and becker 2015 the theoretical aspects of the application of harmonic pumping to karstic aquifers have also been developed in fischer et al 2018b the imagery potential of harmonic investigations has been studied for mapping the distribution of hydraulic properties in heterogeneous aquifers with models solved in the time domain lavenue and de marsily 2001 soueid ahmed et al 2016 or in the frequency domain cardiff et al 2013b zhou et al 2016 in this article we will present a field characterization of karst network based on a harmonic pumping tomography hydraulic data were obtained from the terrieu experimental site located in montpellier in southern france at the same site results of hydraulic tomography in which hydraulic responses were generated with constant rate pumping tests have already been presented and discussed in our previous works wang et al 2016 2017 fischer et al 2017c in this new work we rely our analysis on a set of responses to harmonic pumping tests with different oscillation periods to characterize the karst network we describe in section 2 the experimental study site the harmonic pumping investigation led on it and the processing made on the measured field responses for the later interpretation then in section 3 we briefly introduce the numerical model setup and the cellular automata based deterministic inversion cadi algorithm further details of our inverse algorithm can be found in fischer et al 2017b in section 4 we present the inversion results obtained with the cadi method at the terrieu field site and the efficiency of the method in reproducing the observed hydraulic responses finally section 5 presents a discussion of the effect of the harmonic signal period on the inversion results 2 field investigation 2 1 experimental site presentation the terrieu experimental site is located 15 km in north of the town of montpellier in southern france the site consists of 22 vertical boreholes drilled within a surface area of approximately 2500 m² 40 60 m and permits the study of karstic flows at a local scale fig 1 as a part of the network of the french karst observatory sno karst www sokarst org and the medycyss network jourde et al 2011 the site has been used as a field laboratory for testing new field hydraulic methods and tools developed for the characterization of karstic aquifers jourde et al 2002 jazayeri noushabadi 2009 jazayeri noushabadi et al 2011 dausse 2015 wang et al 2016 wang et al 2017 fischer et al 2017c the geological logs collected from the different boreholes shows that the subsurface of the field is composed of 35 45 m of thin layered marly cretaceous limestones deposited on pure and massive jurassic limestones the interface between these two units is a sloped monocline bedding plane dipping at 20 toward nord west wang et al 2016 the terrieu field is located in the lez regional aquifer temperature and electrical conductivity measurements and packer tests in boreholes presented in previous works jazayeri noushabadi 2009 dausse 2015 have shown the existence of preferential flow paths shown in fig 1 along the bedding plane between the cretaceous and jurassic limestones downhole videos in the boreholes show that at this interface karstic conduits with aperture up to 50 cm are present jazayeri noushabadi et al 2011 the massive jurassic limestones are non aquifer and the cretaceous limestones have a low permeability this causes the aquifer to be confined at the interface between these two layers in the bedding plane a network of karstic conduits has developed preferentially on this bedding plane and controls the fluid circulation within the aquifer 2 2 harmonic pumping investigation the main dataset used in this study was collected from an investigation using harmonic pumping tests performed at the terrieu site we have conducted pumping sequentially in four different boreholes while recording the water level responses in 13 selected observational boreholes see fig 1 the water level responses were also measured in the pumping wells p9 p15 and p20 but not in p3 the static water level before the hydraulic investigation was at a depth of 20 m the maximal drawdown generated by the pumping tests was 4 m therefore the karstic conduits located at a depth of 35 45 m were saturated during the entire duration of hydraulic tests the harmonic pumping tests were performed with a configurable electronical device specially designed for this study by electronics engineers this device controls a flow rate variator linked to the pump which can generate a pumping signal with a sinusoidal shape around a mean value the period and amplitude of the sinusoid signal can be configured with the device the generated pumping rate can be described by 1 q t q m q a cos ω t where q is the output pumping signal m3 s qm the mean pumping rate m3 s qa the oscillatory signal amplitude m3 s and ω 2 π t the pulsation rad s 1 with t the period s different signal amplitudes and mean values were independently applied in each different pumping borehole according to its productivity see table 1 for each pumping location two pumping tests with different periods t 2 min and t 5 min were conducted during 30 min 15 cycles for a 2 min period 6 cycles for a 5 min period water level variations were continuously measured with digital pressure sensors installed in the measurement wells overall this investigation permitted to record 104 drawdown curves 13 measurements for each 2 different periods of signal applied in each 4 pumping wells 2 3 data processing in order to interpret the harmonic signal in the drawdown curves we have performed the same signal decomposition as proposed in fischer et al 2018b this decomposition consists in removing the linear part induced by the mean pumping signal qm from the drawdown curve through a linear regression to keep only the oscillatory response this operation is feasible only after an early transient period accordingly we truncate the first cycle of the recorded responses as we show in fig 2 for the pumping in p15 the operation of removing the linear part is acceptable as the resulting signals appear to be purely oscillatory some natural noises and vibrations induced by the pumping appear as high frequencies fluctuations in the oscillatory responses mathematically the drawdown curves generated by the harmonic pumping tests can be approximated as a sum of a linear signal and an oscillatory signal applied on the initial water table level 2 h t h l i n t h o s c t h 0 w i t h h l i n t a t h 0 a n d h o s c t a cos 2 π t t φ π 180 where h represents the drawdown m over time h lin is a linear signal described by its slope a m s and its intercept h 0 m whose values can be retrieved by linear regression h osc is an oscillatory signal described by its amplitude a m its period t s and its phase shift φ and h 0 represents the initial water table level m in our case we considered h 0 0 m the linear signal h lin can be easily estimated in a first approximation through a linear regression performed on each drawdown curve after removing this linear trend the amplitude and phase offset of the remaining signal of each borehole can be determined by a fast fourier transform fft on their oscillatory signals the fft permits to extract the main oscillatory components of a signal to denoise it and to interpret its parameters fig 3 presents the fft results for the oscillatory signals of three representative boreholes p10 p11 p2 during a pumping in p15 with the two periods 2 min and 5 min the interpretation results of amplitude and phase offset for the entire dataset are presented in appendix table a1 2 4 preliminary analysis the different responses of amplitude and phase offset interpreted in p10 p11 and p2 highlight three distinct flow behaviors fischer et al 2018b the responses in p10 having a negligible amplitude 1 mm relatively to the pumping signal which we interpreted as a negligible oscillatory response is associated to a matrix connectivity between the pumping and the observational well in contrast the response in p11 has a significant amplitude and an almost invariable phase relatively to the pumping signal for the two different periods this behavior is associated to a conduit connectivity response meaning that p15 and p11 would be connected through a karstic conduit network the response in p2 has a lower amplitude response than p11 and its phase offset relatively to the pumping signal increases as the pumping period decreases 71 for a 2 min signal 38 for a 5 min signal this third behavior is associated to a dual connectivity response which corresponds to an inter well connection either through fissures or when the observation borehole is located in the matrix but close to a conduit following the method described in fischer et al 2018b and through the integration of the amplitude and phase offset results interpreted for each pumping observation well pair it is possible to obtain a map of inter well connectivity which contains qualitative information regarding the spatial distribution of the conduit network and the relative position of boreholes to the network we can first link on the map the boreholes with a low phase shift relatively to the pumping signal to represent a conduit connection from this conduit connectivity we can then establish a possible conduit network and then verify that the other boreholes responses would be adequate toward their position to the interpret network dual connectivity with higher phase shift for boreholes close to the network and matrix connectivity with negligible responses for the others possible connectivity maps interpreted with the responses to the harmonic pumping test in p15 for a period of 2 min and 5 min are proposed in fig 4 the comparison between the two connectivity maps in fig 4 shows that the period of the harmonic pumping signal may have a slight impact on the connectivity interpretation for example in the pumping test with a 2 min period p1 can be interpreted as connected to the pumping well through conduits but not in the pumping test with a 5 min period this implies that a change in the period of the pumping signal modifies the flow field induced by the pumping furthermore the manual interpretation is possible only when the amount of hydraulic data to deal with is limited 13 responses for each period in fig 4 therefore although such a qualitative analysis through manual interpretation of inter well connectivity could provide some important guidance to hydrogeological investigation such as indicating the general trend of the main conduits and relative inter well connectivity to obtain a quantitative hydrodynamics characterization and to integrate a larger amount of hydraulic measurements 104 responses from 4 different pumping locations with each time two different periods an inverse modeling is required 3 modeling methodology 3 1 forward problem and model parameterization inverse modeling involves the use of the forward problem in order to simulate for a given model of hydraulic properties the hydraulic responses in this section we present a 2d model that represents the property field along the bedding plane interface in which the karstic network has developed on the terrieu site as seen in the previous section the variation of the piezometric level among the site in response to a harmonic pumping can be approximated by the sum of a linear drawdown and an oscillatory drawdown eq 2 we simulate in the model only the oscillatory part of the drawdown responses h osc the inversion aims to reproduce the values of amplitude and phase offset of the oscillatory part in the measured responses this oscillatory part can be described as a signal in the frequency domain in the model 3 h osc x y t re h ω x y e i ω t with h ω a complex parameter holding the amplitude and phase offset responses over space x y re the function returning the real part of a complex value ω 2 π t the pulsation rad s 1 and i the imaginary unit this oscillatory feature of the hydraulic signal permits to rewrite the time domain form of the groundwater flow equation into a frequency form in order to reduce the computation time of the forward problem in a 2d porous isotropic and saturated domain γ the groundwater flow equation based on the darcy s law in a frequency domain can be expressed as 4 i ω s s h ω k h ω q a v el δ x x s y y s with s s the specific storage distribution m 1 k the conductivity distribution m s q a the pumping amplitude m3 s v el an elementary volume of the finite element grid in the model and δ x xs y ys the dirac distribution where xs ys represents a pumping location as the system is 2d with a unit thickness conductivity k and transmissivity t are of same value as well as specific storage s s and storativity s in this study we considered darcy s law to be acceptable for representing the flows generated in the karstic structures in fact it appears from the previous studies on the terrieu site that the flows in the conduits have a low velocity inducing a low reynolds value even for higher pumping rates than the ones used during this new investigation the initial and boundary conditions used for solving eq 4 are 5 h ω x y 0 x y γ a s i n i t i a l c o n d i t i o n h ω x y 0 w h e n x y γ b o u n d a s b o u n d a r y c o n d i t i o n the spatial distribution of the complex parameter h ω permits the reconstruction of the oscillatory responses simulated among the model through the calculation of their amplitude and phase offset values 6 ampl itude a x y re h ω x y 2 im h ω x y 2 in m phase offs et φ x y 180 π atan 2 im h ω x y re h ω x y in where re and im are the functions returning the real and imaginary parts of a complex value and atan2 is the function returning the inverse tangent value in radian mode from two arguments the simulated response signals are then reconstructed temporally and spatially 7 h o s c x y t a x y cos ω t φ x y π 180 in a karstic medium the spatial response signals are very dependent to the highly heterogeneous distribution of the field properties t and s along the karstic conduits therefore this heterogeneity has to be taken into account in the distribution of these properties in the model in order to simulate a realistic responses behavior for this purpose we chose to apply as parameterization for our model and inverse problem the cellular automata based deterministic inversion cadi method developed and detailed in fischer et al 2017b for a detailed description of the cadi method we refer the reader to fischer et al 2017b as we will only briefly summarize the concept in this article the cadi method uses a particular parameterization of the property field in the model to generate linear structures conduits over a background matrix the field is composed of a grid of cells each cell being assigned to a value of transmissivity and storativity this grid of cells is divided in m ca subspaces each one being controlled by a cellular automaton piloting the part of the cells inside of its subspace fig 5 the cellular automata concept is a mathematical tool which permits to generate structures within a grid with simple neighborhood and transition rules von neumann and burks 1966 the cellular automata control the local direction of generation of the conduit in the different subspaces they are piloted through eight different neighborhood definition n i i 1 8 that permit to define eight different directions one of these eight direction possibilities is assigned to each cellular automaton in the subspaces the conduit network is generated by first assigning a state matrix or conduit to each cell the whole cells are initially in state matrix except an initial cell of the grid in state conduit which designates the starting point and starting subspace for the generation of the conduits the network of conduits then generates following the different local direction affected to each subspace it crosses the generation ends once each part of the network has reached an end either the limit of the model or a subspace in which the network has already generated then property values are assigned to the cells depending on their state matrix or conduit and their localization subspace each subspace defines locally a value for t mat and s mat for its cells in state matrix and a value for t cond and s cond for its cells in state conduit in order to be able to easily pilot and modify the configuration of the model through this parameterization the structural directions and properties assigned to each subspace are defined in two parameter vectors p n and p β p n is a m ca vector containing the directions of generation n i i 1 8 assigned to each subspace several independent networks can be generated in the same model with different directions parameters for each network in this case p n becomes a m ca frac matrix where frac represents the amount of independent networks in the model each column contains the subspaces directions for each network p β is a 4 m ca vector containing the t mat and s mat and the t cond and s cond values assigned to each subspace in this way the parameters controlling the configuration of the model and thus the model itself can be easily and locally modified p n and p β represent the parameters to be optimized in the inverse problem in order to reproduce the observed data amplitude and phase offset responses through a suitable model 3 2 inverse problem the inverse problem consists in retrieving the best values for the parameters contained in pn and p β regarding the minimization of the gap between the simulated data and the observed data amplitude and phase offset responses at the measurement points for the different pumping tests this inverse algorithm contains two steps in which we seek to minimize two objective functions sequentially ψ structure for the optimization of the structural parameter p n and ψ properties for the optimization of the property parameter p β tarantola and valette 1982 8 ψ s t r u c t u r e p n 1 2 d o b s f γ p n p β t c d 1 d o b s f γ p n p β 1 2 p n p r i o r p n t c p n 1 p n p r i o r p n 9 ψ p r o p e r t i e s p β 1 2 d o b s f γ p n p β t c d 1 d o b s f γ p n p β 1 2 p β p r i o r p β t c p β 1 p β p r i o r p β where d obs is a n vector containing the n measured responses f γ p n p β is a n vector containing the responses simulated with the model at the same positions than in d obs c d is a n n matrix of covariance on the data p n prior is a m ca vector holding a priori structural parameters for p n p β prior is a 4 m ca vector holding a priori property values for p β and c p n and c p β are m ca m ca and 4 m ca 4 m ca matrices of prior covariance on the parameters p n and p β at the beginning of the inversion process the variable parameters p n and p β are initialized with a priori conduit directions and property values in order to create the initial model then a sequential and deterministic process optimizes firstly the structural parameters in p n considering the initial properties in p β as invariable and then in second step the property parameters in p β considering the previously optimized p n as invariable finally after the optimization process the posterior uncertainties on the structural and property parameters are estimated 3 2 1 optimization of the structural parameters the optimization of the structural parameters in p n is an iterative process in which a sensitivity matrix is computed at each iteration step to minimize the objective function in eq 8 this analysis requires the computation of a 8 m ca sensitivity matrix s at a given iteration step k each element i j of the matrix is calculated as follow 10 s k i j d o b s f γ p n k p n k j n i p β t c d 1 d o b s f γ p n k p n k j n i p β 1 2 p n p r i o r j n i t c p n 1 p n p r i o r j n i where f γ p n k p n k j n i p β represents the responses simulated with the modified direction n i in the subspace p n k j and p n prior j n i denotes the angular gap between the modified direction n i and the a priori direction p n prior j the coordinates i min j min of the minimal value in the sensitivity matrix provide the subspace to be optimized j min and the direction to apply i min in order to minimize the objective function during this iteration at the end of an iteration the value of the structural objective function is recalculated this iterative optimization ends when the objective function has reached a minimum no more structural modification can decrease the objective function the optimized parameters in p n will then be considered as invariable during the optimization of p β after the convergence of the objective function in the structural optimization the uncertainties on the local directions of the geometry of the network can be estimated from the posterior structural covariance 11 c p n post j 1 8 i 1 8 s post i j ψ stru cture post c p n 1 j j 1 where c p n post j denotes the uncertainty associated to the direction of the subspace j s post is the sensitivity matrix of the last iteration and ψ stru cture post is the value of the minimized objective function associated to the last iteration the higher the uncertainty value associated to a subspace is the more the direction of the subspace in uncertain in the contrary a low value denotes a well constrained direction 3 2 2 optimization of the property parameters in the second step we estimate the hydraulic properties in p β through an iterative optimization process and by considering the previously optimized p n as invariable the process relies on a linearization of the objective function in eq 9 through the computation of the jacobian matrix at an iteration step k the values of the properties in p β are updated from the previous ones as follow 12 p β k 1 p β k j k t c d 1 j k c p β 1 1 j k t c d 1 d obs f γ p n p β k c p β 1 p β prior p β k where j is the n 4 m ca jacobian matrix calculated with a finite difference method j i j f i p β p β j p β j δ p β with δp β a finite difference step the value of the properties objective function is recalculated at the end of each iteration this iterative optimization ends when the objective function converges to a minimum value the uncertainties on the t and s values can then be estimated through the computation of the posterior properties covariance matrix the square root values of the diagonal entries of this matrix represent the standard deviation associated to each property value 13 c p β post j post t c d 1 j post c p β 1 1 where c p β post j j denotes the variance of the jth property parameter in p β and j post is the jacobian matrix of the last iteration 4 modeling application 4 1 modeling strategy we have applied the cadi method on the 2d parameterized model presented in the previous section in order to find a structured property distribution able to reproduce the measured oscillatory responses amplitudes and phase offsets presented in the section 2 3 we considered the oscillatory responses interpreted as negligible amplitude 1 mm to be null for the inversion we have coded the cadi algorithm with matlab and used comsol multiphysics to solve the model in the frequency domain see eq 5 this resolution was led using a finite element method on a triangular mesh refined around the boundaries between the matrix and the conduit network represented by the equivalent porous media properties distributed over the model this mesh refinement is performed with the comsol mphimage2geom function on the conduit network image generated by the cellular automata the distributed model is constructed as a 40 60 m² rectangle included in a 1000 1000 m² buffer zone the external boundaries of the buffer zone are built with imposed dirichlet boundary conditions as presented in eq 5 thus this zone permits to limit the effect of the boundary conditions on the parameterized model the values of the parameters chosen for the model parameterization and the inversion process are presented in table 2 the initial values for the inversion were chosen accordingly to estimates from previous studies on the terrieu site jazayeri noushabadi 2009 dausse 2015 wang et al 2016 in the inverse problem the properties values β in p β were associated to the exponent of the transmissivity and the storativity the initial standard deviation values on the data σ data and on the property parameters σ t σ s are used to construct the covariance matrices as diagonal matrices cd σ data 2 id n and c p β σ prop 2 id 4 m ca no a priori information were considered for the structure local directions in p n prior and c p n the inversion was led following a multi scale method grimstadt et al 2003 as described in fig 6 the multi scale inversion consists in performing an inversion first for a coarse resolution of the model and then use the inversion result as a new initial model with a higher resolution for a new inversion process this permits to progressively reduce the size of the discretization cells for the property field during the inversion which can be interesting for studies on heterogeneous fields with no prior information on the property distribution this was already done with the cadi method in fischer et al 2017c the initial model has been constructed with two unidirectional conduits with uniform property values see table 2 as a coarse approximation of the manual estimation made in fig 4 a first set of inversions were led by separating the 2 min and 5 min period responses and with a 6 4 subspaces partitioning of the model with a conduit thickness of 2 m the results of these separate inversions have then been repartitioned in 12 8 subspaces models with a conduit thickness of 1 m which were used as initial models for a new inversions with the same datasets this partitioning of the models permits to give more liberty to the inversion process while starting from not too far solutions which is especially interesting for a deterministic process the inversion results for the 12 8 models with 2 min and 5 min data separated will be presented in section 4 2 a final inversion process has consisted in starting from these 12 8 separate results with the same partitioning by adding the 5 min data to the 2 min inversion result and the 2 min data to the 5 min results for joint inversions the results of these joint inversions will be discussed in section 4 3 4 2 modeling results fig 9 shows the spatial distribution of hydraulic transmissivity and storativity inverted using the responses to the 2 min and 5 min periods respectively the comparison between the measured and simulated hydraulic responses is presented in fig 7 and table 3 it can be seen that the simulated responses match the measured ones quite well the simulated responses to the p15 pumping appear to be slightly overestimated implying the existence of a very productive conduit in p15 that could not be simulated in the presented model otherwise the responses proportions and behaviors for each pumping are well respected with the simulated signals overall the root mean square error rmse of the amplitude is 1 1 cm for the 2 min response signals and 0 5 cm for the 5 min response signals the rmse of the phase offset is 56 for the 2 min response signals and 66 for the 5 min response signals see table 3 the difficulties in reproducing the phase offset data with the cadi method may be contributed to the high degree of variation of the phase shift within the low transmissivity matrix fig 8 a small displacement of a certain wellbore location by 1 m in the matrix can modify the phase offset by a value of 90 thus our phase offset rmses remain under the variations produced by a 1 m displacement on the field which is acceptable at our scale the amplitude of the signal is also decaying very fast in the matrix fig 8 thus the amplitude of a response is already a good information to characterize the proximity of a borehole with a conduit of the karst network according to fischer et al 2018b and the maps in fig 8 produced with the cadi method the amplitude in the responses signals of a karstic aquifer permit to distinguish the boreholes in or near conduits from the ones in the matrix on the other side the phase offset response permit to characterize more precisely the distance of a responding borehole to conduits as it varies orthogonally to the direction of the conduit and stays very low within the network one advantage of using the cadi method in this work is that the optimized conduits networks can be clearly distinguished from the matrix in the inverted fields in fig 9 if these optimized conduits networks represent only one possible geometry among other likely models they permit to interpret the relative positioning of each borehole in a conduit close to a conduit or in the matrix and thus a degree of connectivity between them the models of networks produced by inversions of pumping tests of different periods are very different indicating that the both sets of responses provide different hydraulic information of the aquifer the reconstructed network for the dataset of a period of 5 min is denser than that for a period of 2 min the 5 min period dataset seems to carry information about karstic structures of different scales conduits fractures fissures around the measurement points while the 2 min period dataset tends to characterize more specifically the most conductive karstic structures over the field scale this hypothesis is supported by the maps of the amplitude in the models amplitude responses to a 2 min pumping signal in p15 quickly decease around the borehole but remain visible in the coarse network over almost the entire field while the ones to a 5 min pumping signal stay high in the dense karstic network around p15 and decrease beyond fig 8 concerning the property values it appears that the reproduction of the responses required more modifications on the transmissivity values than on the storativity especially for the conduits some similarities appear between the results to both periods for example the existence of conduits near p9 with lower transmissivities which can then be assimilated more likely to large fissures rather than conduits also in both results the conduits around p15 have been associated to very high transmissivities 1 m² s which tends to indicate the existence of a very productive conduit at this position this information could already been deduced by the fact that the responses induced by a pumping in p15 in the model were slightly overestimated fig 7 the fact that the two periods of signal lead to different solutions to the inverse problem even by starting from a same initial model tends to indicate that different periods of pumping signal induce different flow fields in the tested karst aquifer in order to better understand the benefits of each period in a harmonic pumping characterization one would need to study the results of the joint inversions led with the responses to both periods simultaneously 4 3 effect of the period of pumping signal on the inversion results it appears in fact see table 3 that the separate models can badly simulate the responses associated to the signal period not used in each inversion i e 5 min responses simulated through the model generated with 2 min responses and conversely suggesting that each set of response contains different and complementary information for the characterization of the field therefore new inversions were started from the results presented in fig 9 as initial models by joining the missing responses to the observed responses dataset in the inverse process see the joint inversion results in fig 6 for a better understanding we will mention as 2 min and 5 min separate results the model results in fig 9 produced from the inversion of the responses to the 2 min and 5 min periods separately the models produced by inversions of the joint datasets started with the 2 min model and with the 5 min model will be respectively mentioned as the 2 min 5 min and 5 min 2 min joint results the results of the joint inversions are presented in fig 10 the 2 min 5 min result solution to the inversion started from the 2 min result is very close to its initial model the 5 min 2 min result solution to the inversion started from the 5 min result shows some modifications on the periphery of its network p4 p5 p10 p11 both joint solutions however do not permit a reproduction of the measured signals as good as the one generated by the 2 min and 5 min separate results see table 3 although the phase offsets rmses are almost the same for the joint results and the separate results the amplitudes rmses are multiplied by 5 10 with the joint results this shows that even if the amplitude responses can be well reproduced by separate models for each period they cannot be reproduced very well with a unique model this tends to validate the hypothesis that different periods of pumping signal induce different flow fields in the aquifer which need to be characterized separately in fact the cadi method is limited in its ability to represent a variation of aperture in the generated network which can partly explain why the joint inversions are less good than the separate ones if the flows mobilized with each period occur in structures of different apertures however even if the preferential flows change among the field for different pumping periods the relative distance of each borehole toward the karstic network does not depend on the hydrodynamic but on the morphology of the karst structures and thus their connectivity behavior should logically remain the same as the karst structure does not vary with the period of pumping this is also what the reproduction of the phase offset values in the joint results would tend to indicate in fact according to fig 8 if the area of propagation of the amplitude response is dependent to the density of the conduit network at that scale it is not true for its phase offset which remains null in the conduits regardless of the network geometry in table 4 we present the interpretation of the position of each borehole relatively to the conduits network with the data processing estimations the separate modeling results and the joint modeling results first it is interesting to point out that the estimations made manually in fig 4 for the p15 pumping match for 62 in term of position in the conduit close to a conduit in the matrix the separate modeling results 2 min and 5 min taking account that the estimation were made with only 13 responses over the 52 available it shows that the manual interpretation method described in section 2 4 and in fischer et al 2018b can already provide rather interesting and fast estimations according to fig 8 the amplitude and phase offset responses of an observable point very close to a conduit 0 5 m are almost undistinguishable to the ones directly in a conduit therefore we consider these points to also have a conduit connectivity response in table 4 fig 11 maps represent the interpreted connectivity of each borehole obtained from the joint inversion results this figure also shows that these results reproduce the schema of connectivity of the preferential flow path established in jazayeri noushabadi 2009 and dausse 2015 between p2 p11 p15 and p20 see fig 1 taking into account the connectivity response 57 of the boreholes show a similar behavior between the 2 min and the 5 min separate results this degree of similarity increases to 93 when comparing the boreholes connectivity responses from the two joint results the only behavior difference between the two results comes from p21 which appears as connected through the matrix in the 2 min 5 min result and as connected through conduits in the 5 min 2 min result however the property distribution of the 2 min 5 min result in fig 10 shows that its matrix transmissivity near the p21 point has a value close to a conduit transmissivity this permits to induce a conduit connectivity behavior for p21 even if the conduit is distant from the borehole therefore we can consider that p21 should have a conduit connection behavior the fact that the degree of similarity of the boreholes behavior has increased to almost 100 for two joint result clearly shows that the reproduction of the whole responses dataset requires to delineate a unique connectivity relation between each borehole even if it is not sufficient to reproduce the amplitudes of the measured responses the remaining question is which period of signal contains this information as the separate results show only a 57 similarity the conduits network almost didn t change during the joint inversion started from the 2 min result and in fact the separate 2 min result and the joint 2 min 5 min result show a 93 similarity in their borehole behaviors while the 5 min result has a degree of similarity of 71 with 5 min 2 min then most of the borehole behaviors found in the joint results were already present in the result of the 2 min signal period which indicates that the 2 min responses contain the most information about the connectivity of each borehole if the two sets of amplitude responses are not well reproduced by the joint inversion while they both delineate a similar type of response for each borehole it shows that the characterized property distribution in extenso the induced flow paths network is different for each period in fact the responses to a 5 min period require a dense flow network to be reproduced while the responses to a 2 min period require a much more dispersed network the structural posterior uncertainty maps in fig 12 indicate that the network of the 2 min result is very uncertain compared to the network of the 5 min result this indicates that the responses to a 5 min period contain more information on the localization of the flow paths around the measurement points than the responses to a 2 min period these last ones seem to provide less precise information on the localization of the flows between the boreholes among the field when inverting jointly the responses from the two period the networks in the joint results show overall lower uncertainties globally the study of the structural uncertainties tends to indicate that while as seen before responses to a the lower period contain more information on the type of connectivity of each borehole the responses to the higher period contain more information on the position of the preferential flow paths around the boreholes however the fact that these both sets of responses cannot be well reproduced simultaneously also indicates that the flows highlighted in the 5 min result do not exist with a period of 2 min therefore while the lower period essentially mobilizes water from the most conductive karstic structures among the field the dense flow field highlighted by the higher period can be assimilated to a mobilization of water also in less conductive karstic structures the maps of the posterior uncertainties on the transmissivity values in fig 13 tend to show that the responses to a 2 min period give more information on the transmissivity of conduits locally around the pumping points average 0 1 on the transmissivity exponent than the responses to a 5 min period 0 2 on the transmissivity exponent the uncertainties on the storativity values remain high in the whole conduit network and for both periods 0 2 on the storativity exponent further from the pumping boreholes both property values in the conduits network transmissivity and storativity globally remain uncertain 0 3 on the exponent even in the joint results the transmissivity and storativity values in the matrix are more constrained around the measurement points in the matrix these information indicate that for both periods the characterization of the property values with oscillatory responses remains local around the boreholes oscillatory responses provide more information on the global connectivity and the localization of preferential flows rather than on the property values of the matrix and the conduits and fissures in the aquifer overall regarding our results it appears that the flow paths generated by periods of 2 min and a 5 min in the pumping signals in this karstic field are very different it appears in fact that at our field scale higher frequency signals here a period of 2 min activate principally the most conductive flow paths over the field mostly located in the conduits network these frequencies permit to better characterize the distance between each borehole and the most conductive karstic structures therefore they allow a better interpretation of a degree of connectivity between boreholes through the network of karstic conduits lower frequency signals here a period of 5 min activate at our field scale both conductive and also less conductive structures therefore these frequencies permit to better characterize the existence and the localization of networks of fractures and fissures around the boreholes 5 discussion in fischer et al 2018b the authors have described a qualitative method for interpreting inter well connectivity from the responses to harmonic pumping tests in karstic aquifers by categorizing the extracted oscillatory responses in three types conduit dual matrix connectivity in this work the method is further developed through the integration of a quantitative interpretation with an inverse algorithm the cadi method that can handle a large number of measured data simultaneously and generate complex distributions of properties the integrated approach permits to produce spatial distributions of amplitude and phase offset responses consistent with those studied by fischer et al 2018b the comparison of inverted conduit networks from periods of 2 min and 5 min indicates different pumping frequency generate different flow fields a higher frequency will permit to better characterize the flows in highly conductive structures and the conduit connectivity at a field scale this finding is consistent with the work of rabinovich et al 2015 where the authors show that the flow paths tend to follow the most conductive media especially at lower period on the contrary a lower frequency will permit to better characterize the flows in less conductive structures and thus the localization of networks of smaller conduits fractures and fissures each frequency of signal permits to generate responses holding different and complementary information on karst structures there is therefore according to our results no best choice of period for the characterization of a karstic field this choice should be made accordingly to what structures one would most likely characterize the important impact of the period of the pumping signal on the ratio of conduit matrix flows has already been highlighted with a simplified study case in fischer et al 2018b but our new work also shows a more complex role of the different structures conduit fracture fissure matrix on the generation of different flow fields with the different frequencies of pumping signal to summarize if at a regional scale one would imagine that the difference between a lower and a higher frequency pumping would principally concern the zone of influence in the aquifer with a larger zone for a lower frequency this difference implies more specific behaviors at a smaller site scale in fact at this scale higher frequencies mobilize water essentially in the most conductive structures while lower frequencies permit to reach also a mobilization of water in the less conductive structures and media on another hand oscillatory responses do not provide precise information on the conductivity and specific storage values in the conduits and the matrix very far from the pumping point however the same observation was made on the same field for the inversion of steady state responses to eight pumping tests at constant rates in fischer et al 2017c this previous article also showed that steady state data to constant rate pumping comparable to an infinitely high oscillatory period were more sensitive to fracture flows and required a dense inverted network to be reproduced which is in agreement with our observation for a higher period of signal in this work furthermore the uncertainty analysis from this previous article indicated that the constant rate data as the data for a period of 5 min in the pumping signal in this work permitted to better characterize the flow structures in areas where we had measurement points the inverted networks in the results from our new work and the ones in fischer et al 2017c both reproduce the established connectivity of the terrieu field jazayeri noushabadi 2009 dausse 2015 but in the case of the constant rate data the inversions were led with responses to an investigation of eight pumping points instead of four with the harmonic investigation the results of our new work associated to the previous ones in fischer et al 2017c tend to indicate that the steady state responses to a constant pumping rate would blur the connectivity associated to the most conductive conduits among the field while better characterizing the karstic structures of different scales in the areas around the pumping wells therefore it would require several well distributed pumping points in order to characterize the whole karstic network responses to an oscillatory pumping rate on contrary allow an already good characterization of the karstic connectivity from a unique pumping in a borehole in the karstic network as p15 in this work 6 conclusion in this work we have extended the qualitative method presented in fischer et al 2018b for interpreting a karstic network connectivity from the hydraulic responses to harmonic pumping tests to a quantitative analysis by combining these responses with an inversion algorithm the integrated approach is able to deal with a large set of data simultaneously and to construct structurally contrasted distributions of hydraulic properties conditioned to the measured tomographic harmonic pumping responses our results show that tomographic harmonic pumping tests performed with different signal frequencies led to a characterization of different structures of the karstic network higher frequency signals tend to assist in interpreting a degree of connectivity between each borehole of the field and the most conductive structures while lower frequency signals are more useful in the localization of less conductive features such as small fractures and fissures the cadi method as imaging tool shows limitations in its ability to represent complex structures of different aperture simultaneously as already noticed in fischer et al 2017c which can partly explain the less good results of the joint inversions compared to the separate inversions in this work however we believe that the combination of the cadi method with tomographic harmonic pumping tests appears as a promising methodology for a quantitative characterization of the hydraulic properties and the hydraulic connectivity in karstic aquifers conflict of interest none acknowledgments we would like to thank todd c rasmussen and two anonymous reviewers for their relevant comments and propositions which permitted to significantly improve the quality of this article we thank the normandy region for providing financial support for the ph d of pierre fischer we also thank michel simon for his precious contribution during the field investigation the hydraulic data collection and hydrogeological characterization of the terrieu experimental site are part of work of the french research network sno karst appendix a 
793,solute dispersion and mixing in beach aquifers is strongly influenced by highly transient flow induced from wave forcing while transport at the groundwater ocean interface has been modelled little is known about the quantitative effect of wave forcing on solute dispersion and mixing in beach aquifers we use a prototype scale laboratory flume experiment to conduct tracer transport experiments at two locations within a wave forced beach aquifer for the first time we demonstrate by systematic laboratory experimentation that transient conditions in the re circulation zone due to run up and beach face infiltration as well as head oscillations caused by wave forcing strongly disperse and mix subsurface solute plumes wave forcing can increase the apparent dispersion by an order of magnitude depending on conditions compared to solute transport without waves our findings illustrate that beach aquifer transport models need to consider the additional dispersion to correctly quantify mixing and biogeochemical processes in this highly dynamic zone keywords beach aquifer solute transport dispersion groundwater ocean interface 1 introduction beach aquifers comprise approx 80 of the estimated 356 000 km of global coastline crossland et al 2005 trenhaile 1987 and therefore form one of the longest most significant and hydraulically challenging hydrologic interfaces in the world hydraulic processes control the exchange and mixing of solutes such as salts nutrients dissolved oxygen organic matter and pollutants across the interface e g geng and boufadel 2015 moore 1999 the water exchange and associated dispersion and mixing of dissolved solutes in beach aquifers is highly dynamic due to transient pressure forcing of the sea robinson et al 2006 understanding and quantifying the dispersion is a requirement for predicting biogeochemical processes such as recycling of organic matter and nutrients and the attenuation and degradation of pollutants e g geng et al 2015 kim et al 2017 solute transport in beach aquifers is driven by the pressure gradient between ocean and land on the land side the pressure depends on the groundwater hydraulic heads controlled by inland groundwater dynamics which vary over longer time frames e g months to years on the ocean side the pressure is highly dynamic in time and space as it consists of superimposed oscillations by tide and wave forcing li and barry 2000 wave run up and water infiltration cause mounding of groundwater in the beach aquifer which results in a local subsurface seawater circulation zone e g longuet higgins 1983 turner et al 2013 2016 numerical modelling and experiments have illustrated that tides while of low frequency have a significant effect on the location movement and dispersion of the freshwater salt water interface in shallow coastal aquifers ataie ashtiani et al 1999 boufadel 2000 robinson et al 2006 it has also been shown that the influence of tides can affect the hydrodynamic dispersion and solute concentrations boufadel et al 2011 the hydrodynamic dispersion is commonly modelled using the assumptions inherent to terrestrial groundwater transport e g bear and cheng 2010 however beach aquifers are exposed to transient pressure forces including periodic change in flow direction this is known to increase hydrodynamic dispersion compared to steady state flow conditions xin et al 2010 and referred to as apparent dispersion goode and konikow 1990 numerical modelling found that tidal forcing increases solute mixing within beach aquifers la licata et al 2011 and that this depends on tidal amplitude and period pool et al 2015 wave forcing acts at much higher frequency compared to tides xin et al 2010 further compared the influence of tides and waves in a numerical model and found that waves increase overall groundwater mixing however their model was based on assumed values for hydrodynamic dispersion effects of wave forcing on transport include an increase in solute residence time if waves break seaward of the plume boufadel et al 2007 and a higher impact on solute dispersion compared to tidal forcing bakhtyar et al 2013 beach face infiltration can move solutes vertically below the groundwater table besides increasing the dilution geng and boufadel 2015 geng et al 2014 consequently wave action must be considered when assessing solute transport and mixing in beach aquifers geng et al 2015 despite the increasing interest in subsurface solute transport at the ocean land interface research has predominantly focused on numerical modelling and low frequency pressure forces such as tides only a few studies have tackled the challenges posed by the impact of waves on these systems e g geng et al 2014 xin et al 2010 2015 however several authors have noted that solute diffusion rates in shallow sediments are significantly increased by the presence of fluctuating pressure gradients typical of passing waves e g hebert et al 2007 webster 2003 webster and taylor 1992 while their investigations are representative of the conditions within shallow seabed sediments experimental investigations of such effects in beach aquifers do not exist to the best of our knowledge we provide systematic experimental measurements and analysis of solute dispersion within a beach aquifer exposed to highly transient hydraulic conditions induced by waves using a field scale flume experiment 2 methodology 2 1 the flume experiment a prototype scale beach aquifer a series of controlled experiments were conducted in a prototype scale beach barrier 4 5 m high and 75 m long constructed inside a 5 m wide flume fig 1 using uniform sand d 50 0 42 mm total porosity ϕ 0 41 we note that by only using freshwater our experiment intentionally avoids the additional complexity that would arise from variable density flow patterns involving saline seawater and fresh groundwater as is typical for ocean beaches this allows a focus on the dispersion mechanisms caused by transient flow due to wave forcing alone the experiments were part of the barrier dynamics experiment 2 bardex 2 program in the delta flume laboratory facilities deltares in vollenhove netherlands in june 2012 an overview of this program is given in masselink et al 2016 the sand barrier represents a typical ocean beach aquifer but includes a back barrier lagoon to experimentally control regional groundwater flow by adjusting the sea and lagoon relative water levels fig 1 we investigate and contrast two different hydraulic conditions within the beach aquifer 1 steady state and uniform flow no waves 2 highly transient flow due to wave action the lagoon and mean sea levels were held constant for the duration of each experiment wave forcing signals were induced using a wave paddle on the seaward side within the following limits for the results presented here significant wave heights of 0 6 and 0 8 m peak wave period of 8 and 12 s and test durations ranging from 17 to 335 min table 1 in masselink et al 2016 hydraulic heads were measured in 15 fully screened wells and 4 small screened piezometers mounted at the flume wall fig 1a pressure transducers were used to record head time series in wells and piezometers with a frequency of 20 hz and 1 hz respectively turner et al 2016 2 2 tracer rig deployment release and transport measurement tracer rigs were constructed from stainless steel rods and structural connectors to form a cubic frame with edge lengths 0 5 m two tracer release pipes 30 mm diameter pvc providing access to the surface were equipped with a 1 m long slotted section screen at the bottom end and were mounted vertically and centred on opposite sides of the cube frame in the direction of groundwater flow fig 1 the slotted sections were covered with meshed filter socks to prevent sand ingress into the pipes fig 1b the rigs were buried in the barrier before the flume sea and lagoon was filled with water at depth below the anticipated lowest groundwater head to ensure full water saturation under all experimental conditions fig 1a the rigs were placed at approximately the same distance from the flume side wall 2 m and their position was accurately surveyed fig 1a we used two custom made tracer rigs located within the beach aquifer to measure transport dispersion and mixing of a conservative tracer at two different distances from the beach tracer rig 1 tr1 and tracer rig 2 tr2 fig 1a note that any adjustment of the seawater level moved the wave boundary horizontally relative to the rigs miniature 3 mm diameter fluid electrical conductivity ec sensors microelectrodes inc usa were mounted on each release pipe 0 24 m distance from the opposite pipe and one in the centreline 0 12 m from each release pipe and another two at distances of 0 05 m perpendicular to the flow path this configuration allowed monitoring of the release and transport of tracer pulses through the beach aquifer under both seaward and lagoon ward flow directions using at least 5 sensors fig 1c as tracer was either released near sensor 1 or 3 depending on the anticipated flow direction using a fixed sensor numbering system does not allow a flow direction based sensor referencing we therefore use the terms up r 0 m upstream centre r 0 12 m centre and down r 0 24 m downstream to reflect the sensors that were passed by during the longitudinal movement of the tracer pulse the fluid ec sensors were sampled using a custom made multi channel electronic circuit applying the bipolar pulse technique details in rau et al 2012 connected to a data acquisition system usb 6225 national instruments inc usa and transmitted digitally through a usb cable to a laptop with custom labview software located in a control room beside the flume the sampling frequency was 1 hz for all sensors and experiments the tracer solutions were prepared by dissolving nacl in flume water until the electric conductivity measured using a hand held device sc72 yokogawa of the solution was strong enough to generate a detectable contrast 4 5 5 ms cm vs flume water of 0 5 ms cm but weak enough to avoid density effects density stability was confirmed using the criterion developed by oostrom et al 1992 k δρ ρ q 0 3 where values larger than 0 3 lead to instability in our experimentation we derive a value of 0 185 for the worst case scenario parameters as follows the maximum fluid density contrast was δρ 2 7 kg m 3 as evaluated from ec measurements of the ambient flume water ρ 999 k g m 3 and the highest tracer concentration post 2012 the hydraulic conductivity of the homogeneous sand was measured as k 8 10 4 m s turner et al 2016 the smallest advective darcy flux was assumed to be q 1 m d the tracer pulses were released using a sealed tube with a fixed volume of tracer this tube was lowered to the bottom of the tracer release pipe ensuring that the tracer level in the tube was identical with the level in the aquifer a bottom seal was then removed and the tube smoothly lifted up to leave behind an even vertical line source of tracer without premature mixing with the aquifer water the tracer was inserted into either the upstream or the downstream release pipes of both rigs depending on the anticipated direction of the hydraulic gradient at the time of release after release the tracer moved through the screen advected and dispersed according to the hydraulic conditions within the beach aquifer 2 3 quantifying solute dispersion in a steady state and uniform flow field to provide the hydraulic context for the tracer experiments the average flow and its direction were evaluated at the centre of each rig for each tracer release to calculate the 2d flow vector at the location of each tracer rig we used a finite element grid to solve the hydraulic heads for steady state conditions where the measured water levels and heads were averaged during the same time period as the evaluated solute transport this modelling approach was described in detail in turner et al 2016 and is therefore not repeated here the ec sensors could not be calibrated before deployment because measurements were affected by burial in the sand however quantitative dispersion analysis is possible despite the lack of calibration by using the following approach first measurements were integrated with respect to time this transformation allows us to treat the results as if the tracer release was continuous yu et al 1999 concentrations were then normalized to 0 cn 1 here referred to as normalized breakthrough curve nbtc the time integration effectively minimized measurement noise and potential sensor drift to quantify the dispersion coefficient the nbtc s were fitted to a semi analytical forward model based on an analytical solution of the 2d advection diffusion transport equation this assumes a spatially infinite porous medium with a step heaviside function as boundary condition the normalised downstream concentration is calculated as rau et al 2012 1 c n 2 r t n c 0 2 i 1 n δ c i i 1 1 r c r τ where tn is time s for step n c 0 2 is an estimated initial concentration zero in our case δ c i i 1 1 is the normalised concentration difference between two discrete sampling times δ t i i 1 at an upstream point and 2 c r τ 1 2 e r f c r v τ 2 d l τ e x p r v d l e r f c r v τ 2 d l τ is a weighting function further τ t n t i is a time difference s r r 2 d l ϵ m where r is the horizontal distance between both locations m while the tracer rigs were aligned to capture longitudinal flow we allow for possible lateral transport by including an error parameter ϵ which combines lateral distance as well as dispersion finally dl is the longitudinal dispersion coefficient the parameter of interest here which is known to be a function of the average pore water velocity the forward modelling approach is adapted from rau et al 2012 and has the advantage that it does not assume an ideal tracer release because actual measurements at any point in space can be used as boundary condition to predict the tracer breakthrough at a point further downstream forward modelled nbtcs eq 1 were fitted to measurement derived nbtcs using the non linear least squares fitting routine in matlab the free parameters were pore water velocity v longitudinal dispersion coefficient dl and the error parameter ϵ the goodness of fit is represented by the coefficient of determination r 2 the magnitude of the contribution of hydrodynamic solute dispersion caused by the tortuosity of the flow paths on the micro scale in the sand can be assessed by normalising the dispersion result obtained from fitting by the solute diffusion in porous media 3 d l d 0 d l ϕ d f where df is the diffusion coefficient for sodium chloride in water 1 848 10 10 m 2 s lobo et al 1998 ϕ is the porosity and the porous media diffusion coefficient is d 0 ϕ d f the relative contributions of dispersive and diffusive transport can be assessed using the péclet number 4 p e v l d f where l is a characteristic length here equal to the median grain size d 50 0 42 mm when pe 1 the tracer transport is dominated by hydrodynamic dispersion from advection whereas diffusion dominates when pe 1 2 4 evaluating solute dispersion and mixing in a highly transient flow field to quantify the amount of hydraulic transience as a driver for tracer transport dispersion and mixing we calculated the amplitude spectrum of the hydraulic heads using the fast fourier transform fft the fft of a signal is defined as 5 s f k f s t n n 0 n 1 s t n e 2 π i k n n where k and n denote the indices of discretely sampled frequency and time respectively which range from 0 to n 1 the discrete frequencies of the transformed signal are 6 f k k f s n the absolute value of the i th entry fi 7 a f i s f i r 2 f i i 2 f i corresponds to the amplitude at that frequency we calculated the piezometric head frequency spectrum in the beach aquifer for a representative period of measurements down sampled from 20 hz to 1 hz and for all available piezometers and well locations quantitative evaluation of the solute dispersion experiments was challenging because tracer concentration and mass varied for each release and hydraulic conditions differed for each experiment for a quantitative comparison of dispersion and mixing during all experiments uniform or transient flow conditions a new and generalised approach was developed as follows 1 all ec measurements were transformed into nbtcs same as described earlier this enables comparison of the curve s shape despite the difference in release quantity and measured concentrations 2 the differing hydraulic conditions thwarted a comparison of time breakthrough curves therefore for each nbtc the net transport distance was calculated from the mean pore water velocity and time as 8 s v t the relative transport distance is then calculated by shifting the data relative to the mean mass breakthrough so that s r c n 0 5 0 this relative travel distance based approach provided a convenient way to compare the dispersion results acquired for different flow velocities nbtc s were then combined in plots grouped by tracer rig and sensor fig 1c note that we used the radial distance relative to tracer release location r 0 m in the horizontal plane to identify the locations of the sensors as net flow was either seaward or lagoon ward sensors 1 or 3 fig 1c 3 we assume that solute dispersion and mixing for steady state and transient cases is caused by stochastic processes and therefore used moment analysis because it does not assume fick type transport e g jury and roth 1990 for each net travel distance based nbtc we calculate the first and second moments using 9 μ 0 w s r c s r d s r c s r d s r and 10 σ 0 w s r μ 0 w 2 c s r d s r c s r d s r moments for transient conditions waves are depicted by σw whereas σ 0 expresses the uniform no waves case 4 finally we compared tracer dispersion and mixing due to wave action with the steady state case by calculating the ratio 11 d w σ w σ 0 using the transient waves and uniform no waves moments this quotient is an indicator of the relative magnitude of dispersion and mixing compared for transient compared to steady state flow conditions and is expected to be larger than 1 to assess the variability of dw we further calculated the median as well as percentiles p 10 and p 90 all tracers were carefully released in the same way therefore eq 11 should cancel out any biases or uncertainties stemming from the release further this ratio can be used to directly estimate the apparent dispersion coefficient affected by wave action when multiplied with the dispersion coefficient quantified during steady state conditions 3 results and discussion 3 1 baseline dispersion measured under uniform and steady state hydraulic conditions a detailed summary of the transport modelling results for the steady state no waves case is given in fig 2 and table 1 during this experiment water flowed through the beach aquifer from the lagoon to the sea almost horizontally at both rigs and the hydraulic heads confirm that the assumption of uniform and steady state flow is valid fig 2c the mean tracer breakthrough time t c n 0 5 at both rigs occurred approximately one hour after release table 1 pore water velocities differed slightly between rigs with tr1 measuring a faster advective flow compared to tr2 the measured nbtcs for both tr1 and tr2 closely match the fickian advection dispersion transport theory fig 2a b the correlation coefficients demonstrate an excellent match between measurements and prediction table 1 which confirms the appropriateness of the fick type transport for the uniform hydraulic conditions results indicate that the solute transport was dominated by hydrodynamic dispersion with coefficients that are approx one order of magnitude larger than that for pure diffusion in sand as quantified using the pe values eq 4 these results comply well with the widely accepted theory of solute dispersion e g bear and cheng 2010 and importantly provide a foundation for benchmarking dispersion under the influence of wave action 3 2 apparent dispersion and mixing under the influence of wave action fig 3 shows the raw ec signal measuring tracer transport under steady state no waves as well as transient waves conditions for tr2 while the tracer exhibits the expected behaviour of spreading for the no wave condition it is noteworthy that there was no breakthrough measured by the sensors located off line first release in fig 3a in contrast tracer breakthrough is clearly apparent for off line sensors when wave forcing is present second release in fig 3a hinting at an increased spread for the case with waves it is further apparent that the released tracer cloud is immediately affected by transient flow conditions fig 3b and that the peak concentrations are decreased compared to the case without waves fig 3a the waves created a swash zone and wave run up resulting in beach face infiltration causing groundwater table mounding and a seawater circulation zone in the shallow aquifer e g longuet higgins 1983 turner et al 2013 2016 flow vectors in fig 3c illustrate the existence of this seawater circulation zone to illustrate the general hydraulic conditions in the beach aquifer during waves a representative period from an experiment with significant wave height of 0 8 m and peak wave period of 8 s were used series a2 conducted on 12 june 2012 refer to masselink et al 2016 for details the frequency domain amplitudes of hydraulic heads were calculated so that conditions can be compared to the tracer dispersion results fig 4 illustrates that the dominant spectral amplitudes in the sea water level were in the frequency band 0 115 f 0 13 the oscillations from the sea boundary propagated into the beach aquifer as can be seen in the time and frequency domains in both wells figs 4a c and piezometers figs 4b d fig 5 shows the relative travel distance based nbtcs derived from all tracer experiments with transient conditions separated by tracer rig and sensor and compared to the steady state case it is clear that the nbtc shapes differ significantly for each experiment and that transient hydraulic conditions induce transport processes whose influence on tracer transport is best considered as stochastic tables a 1 and a 2 in the appendix provide a comprehensive summary of the moments calculated for all tracer experiments shown in fig 4 a h we note the following significant aspects while the experimental set up was designed to represent 2d conditions masselink et al 2016 the wave action caused continuous erosion and deposition and therefore reworked the beach profile across shore spatially variable infiltration induced a groundwater circulation zone that can only be adequately described considering full dimensions turner et al 2016 the time scale of hydraulic processes within the beach aquifer is much slower than that occurring at the surface for instance a tracer release would be affected by the gradual build up of the seawater mount and circulation zone as the waves were switched on transience in general flow pattern it was therefore impossible to systematically measure tracer transport as a result of particular wave forcing conditions figs 5a h demonstrate that tracer dispersion and mixing is significantly increased under transient flow conditions as induced from wave action our increased apparent dispersion generally agrees with the observations by several authors who have attributed increased solute diffusion in shallow seabed sediments to pressure fluctuations caused by passing waves for example webster and taylor 1992 proposed that rotational pressure gradients cause rotational dispersion whereas webster 2003 developed the concept of shear dispersion which can enhance solute diffusion rates by orders of magnitude in comparison to molecular diffusion we illustrate that this concept may also apply to beach aquifers where waves cause a transient pressure boundary that propagates landwards into the aquifer further the increased mixing apparent from our results also confirms the observations made by xin et al 2010 who numerically modelled the dynamics in a beach aquifer but used a fixed hydrodynamic dispersion coefficient throughout the domain fig 5i shows the amplitudes of the head oscillations in the beach aquifer in the frequency band 0 115 f 0 13 hz for all wells and piezometers and the same experiment as shown in fig 4 also plotted are the median and percentile p 10 and p 90 values of the dispersion ratio eq 11 derived from the second moments for transient conditions σw normalized by the ones for steady state conditions σ 0 the median values for tr1 are upstream d w 14 908 and downstream d w 11 895 number of samples n 24 and for tr2 upstream d w 2 630 centre d w 1 642 and d w 0 971 n 10 respectively we note that the tracer was released in either the upstream or downstream tube sensor 1 or 3 fig 1c depending on the ambient flow direction due to controlled changes of the lagoon water level relative to the sea results were aggregated for each rig on the basis of flow direction upstream to downstream rather than sensor number to provide enough experiments for a meaningful statistical evaluation we further note that the rig scale 0 24 m is small in comparison to the distance between the tracer rigs 8 7 m this means that the dispersion results are broadly representative of the tracer rig location consequently while the dispersion ratios from both rigs can be compared they should not be interpreted at smaller scales than that of the rig i e comparison between sensors the dispersion results demonstrate the increase in tracer spread due to wave action relative to uniform and steady state flow tr1 which was much closer to the sea boundary demonstrates an order of magnitude increase in dispersion ratio compared to tr2 we attribute the increased tracer dispersion and mixing to two factors a a circulation zone caused by wave run up and net beach face infiltration turner et al 2016 xin et al 2010 with a spatially variable and transient flow field b an oscillating pressure in the beach aquifer with amplitudes that diminish rapidly from the sea boundary it is clear that both rigs were affected by the circulation zone whereas tr1 closer to the sea was also influenced by additional head oscillations from wave forcing within the beach aquifer wave action results in oscillating pressure gradients that are highly variable in space and time which renders deterministic solute transport models impractical while tracer transport and dispersion without waves can be described as fick type fig 2 dispersion and spread under the influence of wave action is clearly best considered as a stochastic process due to the complexity of transport caused by the highly transient flow field and the inability to resolve this flow in time and space we note that tracer transport occurs on much slower time scale compared to that of individual waves however waves create an oscillating pressure field which translates into an accumulated increase in tracer spread as is evidenced by our correlation between amplitudes and dispersion ratio in fig 5i in reality dispersion in beach aquifers will depend on many parameters including wave height and wave period which may vary in space and time this illustrates the complexity of the processes that influence solute transport in beach aquifers 3 3 implications for transport modelling at the groundwater ocean interface for the first time we use direct experimental measurements to quantify by how much oscillating hydraulic boundaries for example ubiquitous in beach aquifers induced by waves significantly increase solute dispersion and mixing our results indicate a rapid exponential damping of the pressure amplitudes away from the wave forcing dispersion and mixing can be increased by orders of magnitude but appears to decrease with distance away from the oscillating boundary our findings have significant implications for understanding and modelling reactive solute transport and biogeochemical processes in this highly dynamic zone for example investigations of solute transport in beach aquifers exposed to wave forcing must either apply highly sophisticated numerical models which properly reflect the transient flow field or account for the increased spread by using an apparent dispersion coefficient which could be a function of the wave forcing and location in the subsurface while xin et al 2010 illustrate a sophisticated numerical model that is capable of simulating at the time scale of waves they used a constant valued hydrodynamic dispersivity coefficient throughout the entire modelling domain and neither explained its values nor explored the effects that differing dispersion could have on their results we demonstrate using laboratory experimentation that the dispersion coefficient can be highly variable in space and time because it requires high computational effort to simulate such high frequency spatio temporal cases we recommend the use of an apparent dispersion coefficient correctly reflecting the transient conditions to model transport in beach aquifers the transient processes could lead to increased mixing between the regional discharging groundwater and infiltrating surface seawater via the re circulation zone for chemical reactions between dissolved species in the two water types this increased mixing across the interface i e fringe controlled reactions prommer et al 2006 would lead to an increased net reaction per meter of coastline for systems with a high damköhler number examples include the reaction of groundwater nitrate with dissolved organic matter dom or an organic pollutant in groundwater with dissolved oxygen in seawater this will also affect the distribution and functioning of biogeochemical hotspots at the beach interface kim et al 2017 and the cycling of carbon and nutrients charbonnier et al 2013 our results provide a foundation for improving numerical modelling of processes in beach aquifers and demonstrate the need for experimentation elucidating dispersion and mixing with increased complexity further work is required to systematically evaluate solute dispersion as a function of wave height and period beach profiles sediment properties and location beneath the swash zone such analyses could provide relationships that can be used to estimate solute transport and mixing under different scenarios future research should also include the effects of density to reflect the real world conditions encountered at the land ocean interface our work further highlights the many practical challenges associated with measuring and characterising solute transport in this highly dynamic zone for example we designed the tracer rigs to provide a rigid framework known sensor locations with sufficient number of sensors for a meaningful transport characterisation under different flow directions but without excessive interference of the flow field tracer strength was adjusted to generate a contrast against the background concentration yet avoid density flow effects resulting in measurements over centimetre scale distances we therefore acknowledge that the interpretation of our results has limitations we suggest that future experimental research should aim to improve upon our work in the following ways 1 development and installation of spatially distributed sensors to capture tracer dispersion in all dimensions without significantly changing or impairing flow and transport 2 calibration of sensors in situ to measure actual concentrations of dissolved compounds 3 repeated experiments with different types of beach aquifer materials and textures and 4 systematic variation of the wave height and period such experiments combined with numerical modelling would provide a generic framework to fundamentally characterise solute dispersion in beach aquifers 4 conclusions to quantify the effect of realistic wave forcing on solute dispersion in beach aquifers we conducted detailed flume experiments within a prototype scale sandy beach barrier solute tracer was released from two locations within the beach face at different distances from the sea and the breakthrough was measured at discrete locations downstream from the release point we compare the solute transport and dispersion measurements for uniform and steady state flow without waves with those influenced by waves for conditions of 0 8 m significant wave heights and 8 12 s peak wave periods as expected our results show that wave forcing induces a highly transient flow field in the beach aquifer two transient effects were distinguished 1 a re circulation zone caused by wave run up and beach face infiltration 2 an oscillating pressure boundary originating from wave forcing at the seaward side these transient flow effects increase solute dispersion and mixing by orders of magnitude compared to the uniform flow without waves we further show that the apparent dispersion decreases with distance away from the wave forcing boundary since our experiments were conducted using freshwater only density effects are excluded and we were able to explicitly isolate the effects induced by wave forcing our experiments confirm the findings of previous modelling efforts that wave forcing should be considered our results further illustrate that numerical modelling of flow transport and biogeochemical processes in beach aquifers require consideration of the effect that highly transient flow has on dispersion this would either require a considerably increased resolution in space and time to accurately resolve the flow field or rely on experimentally determined empirical dispersion relationships with dependency on location relative to as well as character of the forcing to account for the increased dispersion and mixing resulting from highly transient flow fields our results provide a foundation for future work and demonstrate the need for further more detailed and targeted experimentation in particular the relationship between wave forcing parameters such as significant wave height and period and solute spread should be explored further experiments should include variable density conditions this would improve our understanding of the solute dispersion and biogeochemical processes that rely on the degree of mixing at the ocean land interface acknowledgements the work described in this publication was supported by the european community s 7th framework programme through the grant to the budget of the integrating activity hydralab iv contract no 261520 the academic lead of the project was prof gerd masselink and the deltares coordinator was dr guido wolters the bardex ii partners would like to thank the delta flume staff leen johan piet and ab for making the experiment such an enjoyable and successful experience this research was supported by the national centre for groundwater research and training ncgrt an australian government initiative supported by the australian research council arc and the national water commission nwc the experimental dataset is available for download https doi org 10 6084 m9 figshare 6741443 we acknowledge the excellent matplotlib library hunter 2007 which was used to create some of the figures in this work appendix 
793,solute dispersion and mixing in beach aquifers is strongly influenced by highly transient flow induced from wave forcing while transport at the groundwater ocean interface has been modelled little is known about the quantitative effect of wave forcing on solute dispersion and mixing in beach aquifers we use a prototype scale laboratory flume experiment to conduct tracer transport experiments at two locations within a wave forced beach aquifer for the first time we demonstrate by systematic laboratory experimentation that transient conditions in the re circulation zone due to run up and beach face infiltration as well as head oscillations caused by wave forcing strongly disperse and mix subsurface solute plumes wave forcing can increase the apparent dispersion by an order of magnitude depending on conditions compared to solute transport without waves our findings illustrate that beach aquifer transport models need to consider the additional dispersion to correctly quantify mixing and biogeochemical processes in this highly dynamic zone keywords beach aquifer solute transport dispersion groundwater ocean interface 1 introduction beach aquifers comprise approx 80 of the estimated 356 000 km of global coastline crossland et al 2005 trenhaile 1987 and therefore form one of the longest most significant and hydraulically challenging hydrologic interfaces in the world hydraulic processes control the exchange and mixing of solutes such as salts nutrients dissolved oxygen organic matter and pollutants across the interface e g geng and boufadel 2015 moore 1999 the water exchange and associated dispersion and mixing of dissolved solutes in beach aquifers is highly dynamic due to transient pressure forcing of the sea robinson et al 2006 understanding and quantifying the dispersion is a requirement for predicting biogeochemical processes such as recycling of organic matter and nutrients and the attenuation and degradation of pollutants e g geng et al 2015 kim et al 2017 solute transport in beach aquifers is driven by the pressure gradient between ocean and land on the land side the pressure depends on the groundwater hydraulic heads controlled by inland groundwater dynamics which vary over longer time frames e g months to years on the ocean side the pressure is highly dynamic in time and space as it consists of superimposed oscillations by tide and wave forcing li and barry 2000 wave run up and water infiltration cause mounding of groundwater in the beach aquifer which results in a local subsurface seawater circulation zone e g longuet higgins 1983 turner et al 2013 2016 numerical modelling and experiments have illustrated that tides while of low frequency have a significant effect on the location movement and dispersion of the freshwater salt water interface in shallow coastal aquifers ataie ashtiani et al 1999 boufadel 2000 robinson et al 2006 it has also been shown that the influence of tides can affect the hydrodynamic dispersion and solute concentrations boufadel et al 2011 the hydrodynamic dispersion is commonly modelled using the assumptions inherent to terrestrial groundwater transport e g bear and cheng 2010 however beach aquifers are exposed to transient pressure forces including periodic change in flow direction this is known to increase hydrodynamic dispersion compared to steady state flow conditions xin et al 2010 and referred to as apparent dispersion goode and konikow 1990 numerical modelling found that tidal forcing increases solute mixing within beach aquifers la licata et al 2011 and that this depends on tidal amplitude and period pool et al 2015 wave forcing acts at much higher frequency compared to tides xin et al 2010 further compared the influence of tides and waves in a numerical model and found that waves increase overall groundwater mixing however their model was based on assumed values for hydrodynamic dispersion effects of wave forcing on transport include an increase in solute residence time if waves break seaward of the plume boufadel et al 2007 and a higher impact on solute dispersion compared to tidal forcing bakhtyar et al 2013 beach face infiltration can move solutes vertically below the groundwater table besides increasing the dilution geng and boufadel 2015 geng et al 2014 consequently wave action must be considered when assessing solute transport and mixing in beach aquifers geng et al 2015 despite the increasing interest in subsurface solute transport at the ocean land interface research has predominantly focused on numerical modelling and low frequency pressure forces such as tides only a few studies have tackled the challenges posed by the impact of waves on these systems e g geng et al 2014 xin et al 2010 2015 however several authors have noted that solute diffusion rates in shallow sediments are significantly increased by the presence of fluctuating pressure gradients typical of passing waves e g hebert et al 2007 webster 2003 webster and taylor 1992 while their investigations are representative of the conditions within shallow seabed sediments experimental investigations of such effects in beach aquifers do not exist to the best of our knowledge we provide systematic experimental measurements and analysis of solute dispersion within a beach aquifer exposed to highly transient hydraulic conditions induced by waves using a field scale flume experiment 2 methodology 2 1 the flume experiment a prototype scale beach aquifer a series of controlled experiments were conducted in a prototype scale beach barrier 4 5 m high and 75 m long constructed inside a 5 m wide flume fig 1 using uniform sand d 50 0 42 mm total porosity ϕ 0 41 we note that by only using freshwater our experiment intentionally avoids the additional complexity that would arise from variable density flow patterns involving saline seawater and fresh groundwater as is typical for ocean beaches this allows a focus on the dispersion mechanisms caused by transient flow due to wave forcing alone the experiments were part of the barrier dynamics experiment 2 bardex 2 program in the delta flume laboratory facilities deltares in vollenhove netherlands in june 2012 an overview of this program is given in masselink et al 2016 the sand barrier represents a typical ocean beach aquifer but includes a back barrier lagoon to experimentally control regional groundwater flow by adjusting the sea and lagoon relative water levels fig 1 we investigate and contrast two different hydraulic conditions within the beach aquifer 1 steady state and uniform flow no waves 2 highly transient flow due to wave action the lagoon and mean sea levels were held constant for the duration of each experiment wave forcing signals were induced using a wave paddle on the seaward side within the following limits for the results presented here significant wave heights of 0 6 and 0 8 m peak wave period of 8 and 12 s and test durations ranging from 17 to 335 min table 1 in masselink et al 2016 hydraulic heads were measured in 15 fully screened wells and 4 small screened piezometers mounted at the flume wall fig 1a pressure transducers were used to record head time series in wells and piezometers with a frequency of 20 hz and 1 hz respectively turner et al 2016 2 2 tracer rig deployment release and transport measurement tracer rigs were constructed from stainless steel rods and structural connectors to form a cubic frame with edge lengths 0 5 m two tracer release pipes 30 mm diameter pvc providing access to the surface were equipped with a 1 m long slotted section screen at the bottom end and were mounted vertically and centred on opposite sides of the cube frame in the direction of groundwater flow fig 1 the slotted sections were covered with meshed filter socks to prevent sand ingress into the pipes fig 1b the rigs were buried in the barrier before the flume sea and lagoon was filled with water at depth below the anticipated lowest groundwater head to ensure full water saturation under all experimental conditions fig 1a the rigs were placed at approximately the same distance from the flume side wall 2 m and their position was accurately surveyed fig 1a we used two custom made tracer rigs located within the beach aquifer to measure transport dispersion and mixing of a conservative tracer at two different distances from the beach tracer rig 1 tr1 and tracer rig 2 tr2 fig 1a note that any adjustment of the seawater level moved the wave boundary horizontally relative to the rigs miniature 3 mm diameter fluid electrical conductivity ec sensors microelectrodes inc usa were mounted on each release pipe 0 24 m distance from the opposite pipe and one in the centreline 0 12 m from each release pipe and another two at distances of 0 05 m perpendicular to the flow path this configuration allowed monitoring of the release and transport of tracer pulses through the beach aquifer under both seaward and lagoon ward flow directions using at least 5 sensors fig 1c as tracer was either released near sensor 1 or 3 depending on the anticipated flow direction using a fixed sensor numbering system does not allow a flow direction based sensor referencing we therefore use the terms up r 0 m upstream centre r 0 12 m centre and down r 0 24 m downstream to reflect the sensors that were passed by during the longitudinal movement of the tracer pulse the fluid ec sensors were sampled using a custom made multi channel electronic circuit applying the bipolar pulse technique details in rau et al 2012 connected to a data acquisition system usb 6225 national instruments inc usa and transmitted digitally through a usb cable to a laptop with custom labview software located in a control room beside the flume the sampling frequency was 1 hz for all sensors and experiments the tracer solutions were prepared by dissolving nacl in flume water until the electric conductivity measured using a hand held device sc72 yokogawa of the solution was strong enough to generate a detectable contrast 4 5 5 ms cm vs flume water of 0 5 ms cm but weak enough to avoid density effects density stability was confirmed using the criterion developed by oostrom et al 1992 k δρ ρ q 0 3 where values larger than 0 3 lead to instability in our experimentation we derive a value of 0 185 for the worst case scenario parameters as follows the maximum fluid density contrast was δρ 2 7 kg m 3 as evaluated from ec measurements of the ambient flume water ρ 999 k g m 3 and the highest tracer concentration post 2012 the hydraulic conductivity of the homogeneous sand was measured as k 8 10 4 m s turner et al 2016 the smallest advective darcy flux was assumed to be q 1 m d the tracer pulses were released using a sealed tube with a fixed volume of tracer this tube was lowered to the bottom of the tracer release pipe ensuring that the tracer level in the tube was identical with the level in the aquifer a bottom seal was then removed and the tube smoothly lifted up to leave behind an even vertical line source of tracer without premature mixing with the aquifer water the tracer was inserted into either the upstream or the downstream release pipes of both rigs depending on the anticipated direction of the hydraulic gradient at the time of release after release the tracer moved through the screen advected and dispersed according to the hydraulic conditions within the beach aquifer 2 3 quantifying solute dispersion in a steady state and uniform flow field to provide the hydraulic context for the tracer experiments the average flow and its direction were evaluated at the centre of each rig for each tracer release to calculate the 2d flow vector at the location of each tracer rig we used a finite element grid to solve the hydraulic heads for steady state conditions where the measured water levels and heads were averaged during the same time period as the evaluated solute transport this modelling approach was described in detail in turner et al 2016 and is therefore not repeated here the ec sensors could not be calibrated before deployment because measurements were affected by burial in the sand however quantitative dispersion analysis is possible despite the lack of calibration by using the following approach first measurements were integrated with respect to time this transformation allows us to treat the results as if the tracer release was continuous yu et al 1999 concentrations were then normalized to 0 cn 1 here referred to as normalized breakthrough curve nbtc the time integration effectively minimized measurement noise and potential sensor drift to quantify the dispersion coefficient the nbtc s were fitted to a semi analytical forward model based on an analytical solution of the 2d advection diffusion transport equation this assumes a spatially infinite porous medium with a step heaviside function as boundary condition the normalised downstream concentration is calculated as rau et al 2012 1 c n 2 r t n c 0 2 i 1 n δ c i i 1 1 r c r τ where tn is time s for step n c 0 2 is an estimated initial concentration zero in our case δ c i i 1 1 is the normalised concentration difference between two discrete sampling times δ t i i 1 at an upstream point and 2 c r τ 1 2 e r f c r v τ 2 d l τ e x p r v d l e r f c r v τ 2 d l τ is a weighting function further τ t n t i is a time difference s r r 2 d l ϵ m where r is the horizontal distance between both locations m while the tracer rigs were aligned to capture longitudinal flow we allow for possible lateral transport by including an error parameter ϵ which combines lateral distance as well as dispersion finally dl is the longitudinal dispersion coefficient the parameter of interest here which is known to be a function of the average pore water velocity the forward modelling approach is adapted from rau et al 2012 and has the advantage that it does not assume an ideal tracer release because actual measurements at any point in space can be used as boundary condition to predict the tracer breakthrough at a point further downstream forward modelled nbtcs eq 1 were fitted to measurement derived nbtcs using the non linear least squares fitting routine in matlab the free parameters were pore water velocity v longitudinal dispersion coefficient dl and the error parameter ϵ the goodness of fit is represented by the coefficient of determination r 2 the magnitude of the contribution of hydrodynamic solute dispersion caused by the tortuosity of the flow paths on the micro scale in the sand can be assessed by normalising the dispersion result obtained from fitting by the solute diffusion in porous media 3 d l d 0 d l ϕ d f where df is the diffusion coefficient for sodium chloride in water 1 848 10 10 m 2 s lobo et al 1998 ϕ is the porosity and the porous media diffusion coefficient is d 0 ϕ d f the relative contributions of dispersive and diffusive transport can be assessed using the péclet number 4 p e v l d f where l is a characteristic length here equal to the median grain size d 50 0 42 mm when pe 1 the tracer transport is dominated by hydrodynamic dispersion from advection whereas diffusion dominates when pe 1 2 4 evaluating solute dispersion and mixing in a highly transient flow field to quantify the amount of hydraulic transience as a driver for tracer transport dispersion and mixing we calculated the amplitude spectrum of the hydraulic heads using the fast fourier transform fft the fft of a signal is defined as 5 s f k f s t n n 0 n 1 s t n e 2 π i k n n where k and n denote the indices of discretely sampled frequency and time respectively which range from 0 to n 1 the discrete frequencies of the transformed signal are 6 f k k f s n the absolute value of the i th entry fi 7 a f i s f i r 2 f i i 2 f i corresponds to the amplitude at that frequency we calculated the piezometric head frequency spectrum in the beach aquifer for a representative period of measurements down sampled from 20 hz to 1 hz and for all available piezometers and well locations quantitative evaluation of the solute dispersion experiments was challenging because tracer concentration and mass varied for each release and hydraulic conditions differed for each experiment for a quantitative comparison of dispersion and mixing during all experiments uniform or transient flow conditions a new and generalised approach was developed as follows 1 all ec measurements were transformed into nbtcs same as described earlier this enables comparison of the curve s shape despite the difference in release quantity and measured concentrations 2 the differing hydraulic conditions thwarted a comparison of time breakthrough curves therefore for each nbtc the net transport distance was calculated from the mean pore water velocity and time as 8 s v t the relative transport distance is then calculated by shifting the data relative to the mean mass breakthrough so that s r c n 0 5 0 this relative travel distance based approach provided a convenient way to compare the dispersion results acquired for different flow velocities nbtc s were then combined in plots grouped by tracer rig and sensor fig 1c note that we used the radial distance relative to tracer release location r 0 m in the horizontal plane to identify the locations of the sensors as net flow was either seaward or lagoon ward sensors 1 or 3 fig 1c 3 we assume that solute dispersion and mixing for steady state and transient cases is caused by stochastic processes and therefore used moment analysis because it does not assume fick type transport e g jury and roth 1990 for each net travel distance based nbtc we calculate the first and second moments using 9 μ 0 w s r c s r d s r c s r d s r and 10 σ 0 w s r μ 0 w 2 c s r d s r c s r d s r moments for transient conditions waves are depicted by σw whereas σ 0 expresses the uniform no waves case 4 finally we compared tracer dispersion and mixing due to wave action with the steady state case by calculating the ratio 11 d w σ w σ 0 using the transient waves and uniform no waves moments this quotient is an indicator of the relative magnitude of dispersion and mixing compared for transient compared to steady state flow conditions and is expected to be larger than 1 to assess the variability of dw we further calculated the median as well as percentiles p 10 and p 90 all tracers were carefully released in the same way therefore eq 11 should cancel out any biases or uncertainties stemming from the release further this ratio can be used to directly estimate the apparent dispersion coefficient affected by wave action when multiplied with the dispersion coefficient quantified during steady state conditions 3 results and discussion 3 1 baseline dispersion measured under uniform and steady state hydraulic conditions a detailed summary of the transport modelling results for the steady state no waves case is given in fig 2 and table 1 during this experiment water flowed through the beach aquifer from the lagoon to the sea almost horizontally at both rigs and the hydraulic heads confirm that the assumption of uniform and steady state flow is valid fig 2c the mean tracer breakthrough time t c n 0 5 at both rigs occurred approximately one hour after release table 1 pore water velocities differed slightly between rigs with tr1 measuring a faster advective flow compared to tr2 the measured nbtcs for both tr1 and tr2 closely match the fickian advection dispersion transport theory fig 2a b the correlation coefficients demonstrate an excellent match between measurements and prediction table 1 which confirms the appropriateness of the fick type transport for the uniform hydraulic conditions results indicate that the solute transport was dominated by hydrodynamic dispersion with coefficients that are approx one order of magnitude larger than that for pure diffusion in sand as quantified using the pe values eq 4 these results comply well with the widely accepted theory of solute dispersion e g bear and cheng 2010 and importantly provide a foundation for benchmarking dispersion under the influence of wave action 3 2 apparent dispersion and mixing under the influence of wave action fig 3 shows the raw ec signal measuring tracer transport under steady state no waves as well as transient waves conditions for tr2 while the tracer exhibits the expected behaviour of spreading for the no wave condition it is noteworthy that there was no breakthrough measured by the sensors located off line first release in fig 3a in contrast tracer breakthrough is clearly apparent for off line sensors when wave forcing is present second release in fig 3a hinting at an increased spread for the case with waves it is further apparent that the released tracer cloud is immediately affected by transient flow conditions fig 3b and that the peak concentrations are decreased compared to the case without waves fig 3a the waves created a swash zone and wave run up resulting in beach face infiltration causing groundwater table mounding and a seawater circulation zone in the shallow aquifer e g longuet higgins 1983 turner et al 2013 2016 flow vectors in fig 3c illustrate the existence of this seawater circulation zone to illustrate the general hydraulic conditions in the beach aquifer during waves a representative period from an experiment with significant wave height of 0 8 m and peak wave period of 8 s were used series a2 conducted on 12 june 2012 refer to masselink et al 2016 for details the frequency domain amplitudes of hydraulic heads were calculated so that conditions can be compared to the tracer dispersion results fig 4 illustrates that the dominant spectral amplitudes in the sea water level were in the frequency band 0 115 f 0 13 the oscillations from the sea boundary propagated into the beach aquifer as can be seen in the time and frequency domains in both wells figs 4a c and piezometers figs 4b d fig 5 shows the relative travel distance based nbtcs derived from all tracer experiments with transient conditions separated by tracer rig and sensor and compared to the steady state case it is clear that the nbtc shapes differ significantly for each experiment and that transient hydraulic conditions induce transport processes whose influence on tracer transport is best considered as stochastic tables a 1 and a 2 in the appendix provide a comprehensive summary of the moments calculated for all tracer experiments shown in fig 4 a h we note the following significant aspects while the experimental set up was designed to represent 2d conditions masselink et al 2016 the wave action caused continuous erosion and deposition and therefore reworked the beach profile across shore spatially variable infiltration induced a groundwater circulation zone that can only be adequately described considering full dimensions turner et al 2016 the time scale of hydraulic processes within the beach aquifer is much slower than that occurring at the surface for instance a tracer release would be affected by the gradual build up of the seawater mount and circulation zone as the waves were switched on transience in general flow pattern it was therefore impossible to systematically measure tracer transport as a result of particular wave forcing conditions figs 5a h demonstrate that tracer dispersion and mixing is significantly increased under transient flow conditions as induced from wave action our increased apparent dispersion generally agrees with the observations by several authors who have attributed increased solute diffusion in shallow seabed sediments to pressure fluctuations caused by passing waves for example webster and taylor 1992 proposed that rotational pressure gradients cause rotational dispersion whereas webster 2003 developed the concept of shear dispersion which can enhance solute diffusion rates by orders of magnitude in comparison to molecular diffusion we illustrate that this concept may also apply to beach aquifers where waves cause a transient pressure boundary that propagates landwards into the aquifer further the increased mixing apparent from our results also confirms the observations made by xin et al 2010 who numerically modelled the dynamics in a beach aquifer but used a fixed hydrodynamic dispersion coefficient throughout the domain fig 5i shows the amplitudes of the head oscillations in the beach aquifer in the frequency band 0 115 f 0 13 hz for all wells and piezometers and the same experiment as shown in fig 4 also plotted are the median and percentile p 10 and p 90 values of the dispersion ratio eq 11 derived from the second moments for transient conditions σw normalized by the ones for steady state conditions σ 0 the median values for tr1 are upstream d w 14 908 and downstream d w 11 895 number of samples n 24 and for tr2 upstream d w 2 630 centre d w 1 642 and d w 0 971 n 10 respectively we note that the tracer was released in either the upstream or downstream tube sensor 1 or 3 fig 1c depending on the ambient flow direction due to controlled changes of the lagoon water level relative to the sea results were aggregated for each rig on the basis of flow direction upstream to downstream rather than sensor number to provide enough experiments for a meaningful statistical evaluation we further note that the rig scale 0 24 m is small in comparison to the distance between the tracer rigs 8 7 m this means that the dispersion results are broadly representative of the tracer rig location consequently while the dispersion ratios from both rigs can be compared they should not be interpreted at smaller scales than that of the rig i e comparison between sensors the dispersion results demonstrate the increase in tracer spread due to wave action relative to uniform and steady state flow tr1 which was much closer to the sea boundary demonstrates an order of magnitude increase in dispersion ratio compared to tr2 we attribute the increased tracer dispersion and mixing to two factors a a circulation zone caused by wave run up and net beach face infiltration turner et al 2016 xin et al 2010 with a spatially variable and transient flow field b an oscillating pressure in the beach aquifer with amplitudes that diminish rapidly from the sea boundary it is clear that both rigs were affected by the circulation zone whereas tr1 closer to the sea was also influenced by additional head oscillations from wave forcing within the beach aquifer wave action results in oscillating pressure gradients that are highly variable in space and time which renders deterministic solute transport models impractical while tracer transport and dispersion without waves can be described as fick type fig 2 dispersion and spread under the influence of wave action is clearly best considered as a stochastic process due to the complexity of transport caused by the highly transient flow field and the inability to resolve this flow in time and space we note that tracer transport occurs on much slower time scale compared to that of individual waves however waves create an oscillating pressure field which translates into an accumulated increase in tracer spread as is evidenced by our correlation between amplitudes and dispersion ratio in fig 5i in reality dispersion in beach aquifers will depend on many parameters including wave height and wave period which may vary in space and time this illustrates the complexity of the processes that influence solute transport in beach aquifers 3 3 implications for transport modelling at the groundwater ocean interface for the first time we use direct experimental measurements to quantify by how much oscillating hydraulic boundaries for example ubiquitous in beach aquifers induced by waves significantly increase solute dispersion and mixing our results indicate a rapid exponential damping of the pressure amplitudes away from the wave forcing dispersion and mixing can be increased by orders of magnitude but appears to decrease with distance away from the oscillating boundary our findings have significant implications for understanding and modelling reactive solute transport and biogeochemical processes in this highly dynamic zone for example investigations of solute transport in beach aquifers exposed to wave forcing must either apply highly sophisticated numerical models which properly reflect the transient flow field or account for the increased spread by using an apparent dispersion coefficient which could be a function of the wave forcing and location in the subsurface while xin et al 2010 illustrate a sophisticated numerical model that is capable of simulating at the time scale of waves they used a constant valued hydrodynamic dispersivity coefficient throughout the entire modelling domain and neither explained its values nor explored the effects that differing dispersion could have on their results we demonstrate using laboratory experimentation that the dispersion coefficient can be highly variable in space and time because it requires high computational effort to simulate such high frequency spatio temporal cases we recommend the use of an apparent dispersion coefficient correctly reflecting the transient conditions to model transport in beach aquifers the transient processes could lead to increased mixing between the regional discharging groundwater and infiltrating surface seawater via the re circulation zone for chemical reactions between dissolved species in the two water types this increased mixing across the interface i e fringe controlled reactions prommer et al 2006 would lead to an increased net reaction per meter of coastline for systems with a high damköhler number examples include the reaction of groundwater nitrate with dissolved organic matter dom or an organic pollutant in groundwater with dissolved oxygen in seawater this will also affect the distribution and functioning of biogeochemical hotspots at the beach interface kim et al 2017 and the cycling of carbon and nutrients charbonnier et al 2013 our results provide a foundation for improving numerical modelling of processes in beach aquifers and demonstrate the need for experimentation elucidating dispersion and mixing with increased complexity further work is required to systematically evaluate solute dispersion as a function of wave height and period beach profiles sediment properties and location beneath the swash zone such analyses could provide relationships that can be used to estimate solute transport and mixing under different scenarios future research should also include the effects of density to reflect the real world conditions encountered at the land ocean interface our work further highlights the many practical challenges associated with measuring and characterising solute transport in this highly dynamic zone for example we designed the tracer rigs to provide a rigid framework known sensor locations with sufficient number of sensors for a meaningful transport characterisation under different flow directions but without excessive interference of the flow field tracer strength was adjusted to generate a contrast against the background concentration yet avoid density flow effects resulting in measurements over centimetre scale distances we therefore acknowledge that the interpretation of our results has limitations we suggest that future experimental research should aim to improve upon our work in the following ways 1 development and installation of spatially distributed sensors to capture tracer dispersion in all dimensions without significantly changing or impairing flow and transport 2 calibration of sensors in situ to measure actual concentrations of dissolved compounds 3 repeated experiments with different types of beach aquifer materials and textures and 4 systematic variation of the wave height and period such experiments combined with numerical modelling would provide a generic framework to fundamentally characterise solute dispersion in beach aquifers 4 conclusions to quantify the effect of realistic wave forcing on solute dispersion in beach aquifers we conducted detailed flume experiments within a prototype scale sandy beach barrier solute tracer was released from two locations within the beach face at different distances from the sea and the breakthrough was measured at discrete locations downstream from the release point we compare the solute transport and dispersion measurements for uniform and steady state flow without waves with those influenced by waves for conditions of 0 8 m significant wave heights and 8 12 s peak wave periods as expected our results show that wave forcing induces a highly transient flow field in the beach aquifer two transient effects were distinguished 1 a re circulation zone caused by wave run up and beach face infiltration 2 an oscillating pressure boundary originating from wave forcing at the seaward side these transient flow effects increase solute dispersion and mixing by orders of magnitude compared to the uniform flow without waves we further show that the apparent dispersion decreases with distance away from the wave forcing boundary since our experiments were conducted using freshwater only density effects are excluded and we were able to explicitly isolate the effects induced by wave forcing our experiments confirm the findings of previous modelling efforts that wave forcing should be considered our results further illustrate that numerical modelling of flow transport and biogeochemical processes in beach aquifers require consideration of the effect that highly transient flow has on dispersion this would either require a considerably increased resolution in space and time to accurately resolve the flow field or rely on experimentally determined empirical dispersion relationships with dependency on location relative to as well as character of the forcing to account for the increased dispersion and mixing resulting from highly transient flow fields our results provide a foundation for future work and demonstrate the need for further more detailed and targeted experimentation in particular the relationship between wave forcing parameters such as significant wave height and period and solute spread should be explored further experiments should include variable density conditions this would improve our understanding of the solute dispersion and biogeochemical processes that rely on the degree of mixing at the ocean land interface acknowledgements the work described in this publication was supported by the european community s 7th framework programme through the grant to the budget of the integrating activity hydralab iv contract no 261520 the academic lead of the project was prof gerd masselink and the deltares coordinator was dr guido wolters the bardex ii partners would like to thank the delta flume staff leen johan piet and ab for making the experiment such an enjoyable and successful experience this research was supported by the national centre for groundwater research and training ncgrt an australian government initiative supported by the australian research council arc and the national water commission nwc the experimental dataset is available for download https doi org 10 6084 m9 figshare 6741443 we acknowledge the excellent matplotlib library hunter 2007 which was used to create some of the figures in this work appendix 
794,hydrologic model input datasets such as climate land use elevation soil and geology information are available in a range of scales for use in water resources investigations smaller spatial and temporal scale input data allow groundwater recharge models to simulate more physically realistic processes and presumably result in more accurate estimates of groundwater recharge projected climate data are therefore often downscaled to smaller spatial and temporal scales for use in these models it is unknown however if increasingly smaller scale climate data produce substantially different simulated recharge results either in magnitude or trend also even if simulated recharge results are different at a higher space and time resolution simulation at coarser resolution might be adequate to provide recharge information at decision scales e g meeting colorado river compact requirements on a ten year moving average basis historical climate datasets at three spatial 800 m 4 km and 12 km and two temporal daily and monthly scales were used in a soil water balance swb model of the upper colorado river basin ucrb to simulate groundwater recharge over the water year 1982 2014 time period the magnitude of annual and moving ten year annual average recharge results for daily climate data were within 5 and 7 of 4 km results for 800 m and 12 km climate data respectively with deviations from 1982 to 2014 means within 1 and 3 median respectively comparison of simulated recharge results using the coarsest spatial and temporal climate data with results from the finest scale data indicated similar small differences over ten year moving annual averages over water years and during high recharge months while differences in simulated groundwater recharge magnitude which may be important for groundwater flow simulations were substantial during some seasonal comparisons trends in recharge were almost identical across scales leading to similar conclusions about change from normal considering the uncertainty inherent in projected climate data coarser spatial and longer temporal scale input data may be sufficient for water resources managers who need to understand changes in trends in groundwater recharge over water year or longer time periods keywords upper colorado river basin groundwater recharge climate change 1 introduction for water resources managers seeking information on projected groundwater resources investigation of impacts from projected climate change on groundwater systems often involve the use of hydrologic model simulations with climate data from general circulation models gcms e g allen et al 2010 crosbie et al 2011 kopytkovskiy et al 2015 climate output from gcms is typically provided at relatively coarse spatial resolutions of about 100 200 km on each cell side which are then downscaled to finer resolutions e g 12 km 1 8th degree monthly datasets brekke et al 2013 and 6 km 1 16th degree daily datasets pierce et al 2014 in groundwater recharge simulations finer spatial scale models permit incorporation of more realistic variations in geologic land use and topographic information likewise recharge in many areas of the southwestern united states occurs on a daily or sub daily time scale stonestrom et al 2007 considerable time and effort is therefore expended in downscaling gcm output to smaller spatial and temporal scales for use in hydrologic models published studies of simulated groundwater recharge utilize spatial data ranging from relatively small scales i e 20 m to 100 m often used with quasi two dimensional models scibek and allen 2006 nyenje and batelaan 2009 towes and allen 2009 to fractional degree i e 5 km to 25 km scales barnett et al 2007 christensen et al 2004 crosbie et al 2010 2013 mileham et al 2009 niraula et al 2017 daily time steps are commonly used in published recharge simulation investigations ali et al 2012 barnett et al 2007 crosbie et al 2010 2011 dams et al 2012 holman et al 2009 mccallum et al 2010 mileham et al 2009 scibek and allen 2006 toews and allen 2009 niraula et al 2017 recently tillman et al 2016 2017a b used downscaled projected and historical climate data at 1 8th degree spatial and daily temporal scales to simulate groundwater recharge in the upper colorado river basin ucrb the value of higher resolution modeling particularly when providing water managers with recharge information at decision scales such as meeting compact requirements on a ten year moving average basis in the colorado river basin colorado river compact 1922 is unclear while smaller scales allow more realistic hydrologic processes to be simulated it is unknown whether meaningfully different groundwater recharge simulations either in magnitude or trend result from using smaller versus larger scale climate data this paper presents results from a new investigation of simulated groundwater recharge in the ucrb using historical climate data at the 12 km 1 8th degree 4 km 1 24th degree and 800 m 1 120th degree scales on both daily and monthly time steps these scale choices correspond to available contemporary climate data from archives such as the downscaled climate and hydrology projections maurer et al 2007 and prism prism climate group 2016 that are routinely used in a range of water resources planning studies e g tillman et al 2017a b bureau of reclamation 2017 for others simulated basin scale groundwater recharge results for the different spatial and temporal scale data are compared on seasonal annual and moving ten year average basis results of the magnitude of simulated groundwater recharge are compared as well as deviations from the period of record mean which may be of more interest to water managers to whom changes from normal are important 1 1 study area this study investigates the effect of spatial and temporal scale on groundwater recharge simulations in the upper colorado river basin fig 1 the colorado river is an important source of water in the southwestern united states u s supplying the industrial and domestic water needs of more than 38 million people in the u s and mexico colorado river basin salinity control forum 2013 bureau of reclamation 2011 at lake mead in arizona downstream of which nearly all of the colorado river water is used the ucrb contributes almost 90 of the flow in the river u s geological survey 2016 the ucrb stream system receives an estimated 30 50 of its flow from groundwater discharge rumsey et al 2015 miller et al 2014 in his investigation of the hydrologic and groundwater flow systems in the ucrb geldon 2003 estimates about 8 1 km3 of annual recharge to all groundwater systems in the area excluding the upper san juan basin which was not part of the study for the current study the ucrb is defined as the colorado river drainage area that is upstream of the compact point at lee ferry arizona plus the great divide closed basin as delineated by the u s geological survey region 14 hydrologic unit code fig 1 u s geological survey 2018 2 methods and data groundwater recharge in the ucrb was simulated with the distributed parameter soil water balance swb model for this spatial and temporal scale study westenbroek et al 2010 groundwater recharge is estimated by the swb model at daily time steps by calculating water balance parameters using a modified thornthwaite mather soil water balance accounting method with groundwater recharge estimated within each model cell of the study area thornthwaite 1948 thornthwaite and mather 1957 the swb model calculates water sources and sinks within each cell of the model domain from landscape characteristics and climate data groundwater recharge is then estimated as the difference between the change in soil moisture and these water sources and sinks swb model simulations require spatially gridded datasets including daily minimum temperature daily maximum temperature daily precipitation hydrologic soil group land cover available soil water capacity and overland flow direction swb simulations also require input datasets in a tabular format including vegetation rooting depths runoff curve numbers interception values and maximum daily recharge values for each combination of land cover type and hydrologic soil group a detailed discussion of input datasets computational details and limitations of the swb model are presented in the supplementary material for each combination of spatial and temporal scale climate data the ucrb swb model was initially run for a period of 10 years using initial conditions of 100 soil moisture and 0 snow cover the final soil moisture and snow cover conditions at the end of the 10 year initialization period were then used as initial conditions for full 1981 2014 model runs daily climate data for the 1981 2014 time period at a 1 24th degree 4 km spatial scale fig 2 middle panel covering the ucrb study area were obtained from the prism climate group at oregon state university prism climate group 2016 the daily 4 km prism climate data were aggregated to 1 8th degree 12 km spatial scale fig 2 bottom panel and disaggregated to 1 120th 800 m spatial scale fig 2 top panel climate data disaggregation from coarse to finer scale data 4 km to 800 m was performed using the bilinear interpolation method specifically the linint2 function from the national center for atmospheric research ncar command language ncl ncar 2017 this method has been used by reclamation and reclamation collaborators to downscale relatively coarse 100 200 km climate projections to finer spatial scales 1 8th degree using the bias correction and spatial disaggregation bcsd statistical downscaling algorithm bilinear interpolation is a two dimensional version of linear interpolation that is performed on a rectangular grid of points a weighted average of the four surrounding grid points is used to calculate the interpolated value national institute of standards and technology 2018 fine grid to a coarse grid 4 km to 12 km aggregation was performed using the area hi2lores ncl function ncar 2017 this function uses local area averaging to interpolate from a high resolution rectilinear grid to a low resolution rectilinear grid a low resolution rectangular grid is created from high resolution grid points by averaging them based on their fractional contribution to the low resolution grid point though ncl provides a number of re gridding functions the linint2 and area hi2lores for disaggregation and aggregation respectively were used in this study because they have been used previously in developing and studying contemporary climate datasets from gcm projections e g maurer et al 2007 gutmann et al 2014 daily precipitation and temperature data at the three spatial scales also were aggregated into monthly stress periods for swb simulations daily precipitation data were summed over each month and then the daily average for a month assigned to each day in that month daily minimum and maximum temperatures were each averaged over each month with the daily average for a month then assigned to each day in that month in this way the swb model which runs on a daily time step could be used to simulate groundwater recharge as if only monthly climate data were available to summarize and compare temperature data across spatial and temporal scales potential evapotranspiration pet values are used instead of temperature values directly pet values are a convenient measure of the effect of basin wide temperature change and have more hydrologic meaning than temperature alone pet estimates in this study are directly related to maximum and minimum daily temperatures and are computed as a volume of water which is used directly in the water balance equation see supplementary material for complete description using the numpy package in python scripts precipitation input data and swb output of pet recharge and snowmelt in dimensions of length i e inches were converted to dimensions of volume i e m3 and summed over the ucrb study area on daily time steps the distributed precipitation and swb output values were multiplied by their associated individual cell areas within the study area cell areas within the ucrb range from 15 5 km2 along the northern boundary to 17 6 km2 along the southern boundary for the 1 24th degree 4 km spatial scale data precipitation and simulation results in m3 were then summarized analyzed and compared in excel using visual basic for applications vba scripts recharge simulations using three spatial and two temporal scales were run with results compared over ten year moving average water year and seasonal time periods 3 results and discussion ucrb groundwater recharge was simulated with the swb model at three spatial and two temporal scales results from simulations using 12 km and 800 m daily climate data are compared with simulation results using the original 4 km daily prism climate data similarly simulation results using 12 km and 800 m climate data on monthly time steps are compared with simulation results using 4 km monthly climate data for both daily and monthly climate data results are summarized and compared over ten year average annual periods over water years and over three month seasons all ucrb groundwater recharge modeling results are available at the u s geological survey sciencebase web site tillman 2017 average annual recharge simulated during the 1981 2014 time period by the swb model using 4 km climate data over the same ucrb area as the geldon 2003 study was 7 9 km3 representing 2 5 difference with the geldon 2003 estimate 3 1 results from simulations with daily climate data 3 1 1 ten year moving average comparisons annual simulated groundwater recharge averaged over ten year periods moving every year for the original 4 km daily prism climate data ranged from a high of 10 4 billion b m3 over the 1982 1991 time period to a low of 7 8b m3 over the 1998 2007 time period fig 3 a recharge results using 12 km and 800 m climate data follow the same temporal pattern as the 4 km results fig 3a but are systematically less than the 4 km results fig 3b the amount of reduced recharge however is relatively small with a median percentage change from the 4 km results difference divided by the 4 km result of 4 6 for the 800 m results and 5 8 for the 12 km results fig 3b table 1 the temporal trend in simulated recharge defined here as deviation from the 1982 2014 period of record por average for each spatial scale ranged from 114 to 86 of the por mean for the 4 km results fig 3c recharge trends for the 12 km and 800 m results are even more similar to the 4 km trends than the recharge magnitude results with median percentage change from the 4 km ten year average annual recharge trends of less than 1 for both the 800 m and 12 km results fig 3d table 1 over ten year moving annual averages recharge simulations using daily climate data at the smallest spatial scale investigated do not differ substantially from simulations at the larger scales either in absolute magnitude or in trend 3 1 2 water year comparisons ucrb simulated recharge over water years from 1982 through 2014 using the original 4 km daily prism climate data ranged from a high of 16 6b m3 during water year 1993 to a low of 2 9b m3 during water year 2002 fig 4 a similar to the ten year moving annual average results water year recharge results using 12 km and 800 m climate data follow the same temporal pattern as the 4 km results fig 4a also are systematically less than the 4 km results fig 4b and only by a similarly small amount median percentage change from the 4 km results of 4 7 for the 800 m results and 6 3 for the 12 km results fig 4b table 1 simulated recharge in a few low recharge years however is substantially less for the 12 km climate data than for the 4 km climate data including a 13 6 decrease in 1992 a 13 1 decrease in 2012 and a 12 1 decrease in 2002 fig 4a differences in simulated recharge in these years are in contrast to the very small differences in precipitation of 0 18 and potential evapotranspiration pet of 0 03 figs s2 and s3 in the supplementary material deviation from the por average is predictably greater for the water year results compared with the smoothed ten year moving annual average results fig 4c water year recharge results using the 4 km climate data are as much as 76 greater and 70 less than the 1982 2014 average fig 4c recharge trends for the 12 km and 800 m results also are similar to the 4 km trends with median percentage change from the 4 km water year recharge trends of less than 3 for both the 800 m and 12 km results fig 4d table 1 unlike the ten year moving annual average results water year deviations from por means are less for 4 km results than for the other spatial resolutions in several years particularly the 12 km results fig 4d with the exception of a few years water year simulation results for the 1982 2014 time period for all spatial resolutions are similar in both magnitude and trend of recharge 3 1 3 seasonal comparisons simulated recharge results from daily climate data also were summarized in water years 1982 to 2014 over seasonal time periods including the winter months of december february djf spring months of march may mam summer months of june august jja and fall months of september november son winter and spring seasonal recharge which account for 8 and 71 of simulated annual recharge in the ucrb respectively showed similar small differences in both magnitude and trend between simulations using the different spatial resolution datasets as were seen with the water year and ten year moving annual average results figs s4 and s5 in the supplementary material median differences in djf recharge magnitude from 4 km results were 4 1 and 6 9 for 800 m and 12 km climate data respectively and median mam differences in recharge magnitude from 4 km results were 4 for both 800 m and 12 km climate data figs s4 and s5 in the supplementary material table 1 simulated recharge in the jja summer months which account for 16 of simulated annual ucrb recharge resulted in substantial differences in recharge magnitude between the 4 km climate data and the 800 m median difference of 20 5 and 12 km median difference of 35 8 climate data fig 5 a b table 1 the somewhat higher simulated jja recharge using 4 km climate data than simulations using 800 m or 12 km data cannot be explained by differences in either precipitation fig s6 in the supplementary material or pet fig s7 in the supplementary material both of which differ by less than 0 2 from 4 km data for both resolutions simulated snowmelt in jja however differs from 4 km results by a similar amount to differences in recharge results with a 15 median difference in snowmelt for the 800 m climate data and a 35 median difference for the 12 km data fig 6 differences in temperature between the different spatial datasets particularly when temperatures are near freezing in relatively limited high altitude areas of the ucrb can result in differences in the amount of snowcover and subsequent differences in the amount of snowmelt during warmer months these potentially small temperature differences in limited areas would not show up in the ucrb wide summary of temperature in the pet comparisons fig s7 in the supplementary material trends in jja recharge from simulations using the different spatial resolutions however were more similar than magnitude results with a median difference of 4 7 for the 800 m results and a median difference of 12 3 for the 12 km results compared with results from the 4 km climate data fig 5c d table 1 recharge magnitude during fall months of september november differs between simulations using the different spatial resolutions somewhat less than during jja with median percentage change of 18 5 and 15 7 for 800 m results and 12 km results compared with results from the 4 km climate data fig s8 in the supplementary material table 1 differences in trends in son recharge are similar to those from jja with median differences of 6 7 and 9 2 for 800 m results and 12 km results compared with results from the 4 km climate data fig s8 in the supplementary material table 1 simulated recharge in son however is only about 5 of the total annual amount for the ucrb 3 2 results from simulations with monthly climate data 3 2 1 ten year moving average comparisons daily precipitation and temperature data at the three spatial scales were aggregated into monthly stress periods for swb simulations as described previously annual simulated groundwater recharge averaged over ten year periods moving every year using the 4 km monthly climate data ranged from a high of 9 5 billion b m3 over the 1982 1991 time period to a low of 6 8b m3 over the 1998 2007 time period fig 7 a recharge results using 4 km monthly climate data were 6 3 12 5 less than results using 4 km daily data over comparable time periods fig 7a as with the daily climate data results recharge results using 12 km and 800 m monthly climate data follow the same temporal pattern as the monthly 4 km results fig 7a but are systematically less than the 4 km results fig 7b the amount of reduced recharge from monthly data is similar to comparative reductions from daily climate results with a median percentage change from the 4 km results of 3 6 for the 800 m results and 5 9 for the 12 km results fig 7b table 2 the temporal trend in simulated recharge ranged from 116 to 83 of the por mean for the monthly 4 km results with nearly identical deviations from por mean as results from daily 4 km climate data fig 7c recharge trends for the monthly 12 km and 800 m results also are nearly identical to the 4 km trends fig 7d table 2 3 2 2 water year comparisons ucrb water year simulated recharge over the 1982 2014 time period using monthly 4 km climate data ranged from a high of 15 7b m3 during water year 1993 to a low of 2 6b m3 during water year 2002 fig 8 a recharge results using 4 km monthly climate data were from 2 8 more in 2004 to 22 8 less in 2007 than results using 4 km daily data over comparable time periods with most water year values about 10 less fig 8a similar to water year results using daily climate data water year recharge results using 12 km and 800 m monthly climate data follow the same temporal pattern as the 4 km monthly data results fig 8a and also are systematically less than the 4 km monthly results by a small amount fig 8b the median percentage change of 800 m and 12 km monthly data results from 4 km monthly data results is 3 5 and 6 9 respectively fig 8b table 2 simulated recharge in a few low recharge years also is substantially less for the 12 km monthly climate data than for the 4 km monthly climate data including a 14 3 decrease in 1992 and a 12 7 decrease in 2012 in a similar manner to daily climate data results differences in monthly climate data simulated recharge in these years are in contrast to the very small differences in precipitation of 0 17 and potential evapotranspiration pet of 0 03 fig s9 and s10 in the supplementary material deviation of water year results from the 1982 2014 average are similar between results from all spatial resolution data on a monthly time step and between the monthly and daily 4 km climate data results fig 8c d median percentage change from the monthly 4 km recharge trends is less than 2 5 for both the monthly 800 m and 12 km results fig 8d table 2 median percentage change of monthly 4 km climate data results from daily 4 km climate data results is 4 8 for the most part water year simulation results for the 1982 2014 time period using monthly climate data are similar among all spatial resolutions and between 4 km daily and all monthly resolutions particularly when comparing deviation of recharge from por means 3 3 3 seasonal comparisons as seen with simulated recharge results using daily climate data over seasonal time spans the magnitude of recharge results from simulations using monthly climate data were more variable among the different spatial datasets for the summer jja fig 9 and fall son fig s11 in the supplementary material months than for winter djf fig s12 in the supplementary material or spring mam fig s13 in the supplementary material the magnitude of simulated recharge in the summer months of jja which account for 27 of the annual simulated recharge using monthly climate data were less than 4 km results by median values of 19 and 32 for 800 m and 12 km results respectively the magnitude of recharge results from the fall months of son differ from 4 km results by 25 and 30 for 800 m and 12 km results respectively but make up only 2 of the annual simulated ucrb recharge using monthly climate data fig s11 in the supplementary material recharge trends are more similar among the different spatial scales during all seasons with the highest median difference of 19 between 12 km and 4 km results in son fig s11 in the supplementary material for the two seasons of mam fig s13 in the supplementary material and jja fig 9 comprising almost 95 of the annual ucrb recharge median differences between monthly 4 km results and other spatial data results was 12 or less table 2 in a similar manner to the daily climate data results differences in simulated recharge in jja using monthly climate data appears to be related to differences in snowmelt during this time period fig 10 3 3 comparison of 800 m daily and 12 km monthly results ucrb recharge from simulations using 800 m daily and 12 km monthly data were compared in order to explore the effect of the maximum range in both spatial and temporal data on recharge results the magnitude of annual simulated groundwater recharge averaged over ten year periods moving every year was greater for the 800 m daily climate data than for the 12 km monthly climate data by about 10 over the 1982 2014 time period fig 11 a b comparison of results from each climate dataset to their respective por mean however indicate almost identical simulated groundwater recharge trends with a median difference in results between the two climate datasets of less than 2 fig 11c d the magnitude of ucrb simulated recharge over water years from 1982 through 2014 using 800 m daily climate data also were somewhat greater than results using 12 km monthly data by a median difference of 11 fig 12 a b simulated recharge trends between the two climate datasets were similar with deviation from the por mean sometimes greater for the 800 m daily climate data but sometimes less fig 12c d with an overall median difference between the two datasets of 5 9 as with results within the daily and monthly time scale comparisons smaller differences in seasonal results between simulations using 800 m daily climate data and 12 km monthly data are seen in the season with largest percentage of ucrb yearly recharge fig 13 the spring months of march may account for about 73 of the yearly ucrb recharge for both the 800 m daily and 12 km monthly simulations with median differences in simulated recharge magnitude of about 9 and median differences in trends of about 6 fig 13 recharge in summer jja is less but still accounts for a substantial 14 21 of simulated annual ucrb recharge jja simulated recharge differs between the 800 m daily and 12 km monthly simulations by a median of 55 for magnitude comparisons and by 21 for trend comparisons fig 14 fall and winter seasons together account for about 10 of annual ucrb recharge and differ between simulations from the two climate datasets by a median 80 or more in magnitude and 34 or more in trend figs s14 and s15 in the supplementary material 4 applicability of results to other basins this investigation of the effect of spatial and temporal scale on simulated groundwater recharge was performed in the upper colorado river basin but conclusions from this study may be applicable to other hydrologic regions with respect to the perceived importance of spatial scale the ucrb may be a relatively extreme test case compared with most other hydrologic regions in the u s fig 15 a higher percentage of ucrb precipitation falls in a smaller portion of the basin than in all other major hydrologic regions in the u s with the exception of the california and pacific northwest regions fig 15 and these regions have total precipitation of 2 2 and 5 9 times the precipitation in the ucrb respectively limited high elevation mountainous headwater areas in the ucrb receive a majority of the basin precipitation while most of the basin is semi arid to arid plains that receive little precipitation liebermann et al 1989 based on this information it might have been assumed that small spatial discretization of climate data would be important for recharge studies in the ucrb however substantial differences in simulated ucrb groundwater recharge were not observed in the spatial scale comparisons particularly when trends were compared even between the 800 m and 12 km climate datasets simulated groundwater recharge in hydrologic regions with more dispersed precipitation might be expected to result in similar or perhaps smaller differences between simulations using different spatial scale data conclusions from this study related to the importance of temporal scale however may require more investigation before being applied to dissimilar basins elsewhere in the ucrb snowpack and subsequent snowmelt dominate the hydrology of the basin the dominance and slower time frame of snowmelt in the basin may have obscured differences in daily monthly simulation results that may be apparent in other regions in monsoon dominated hydrologic systems such as the lower colorado river basin and the lower rio grande daily precipitation in local areas can be extreme during the summer monsoon however winter rain in these regions is generally more effective at producing groundwater recharge than an equivalent amount of precipitation during summer owing to lower et losses from lower winter temperatures stonestrom et al 2007 it is unclear therefore if substantial variations in daily monsoon precipitation would result in greater differences between daily and monthly recharge simulations than were seen for ucrb simulations other regions with hydrology dominated by snowmelt or regions with precipitation that is distributed over longer time scales might be expected to perform similarly in daily monthly recharge simulations as this study 5 summary and conclusions while smaller spatial and temporal scale input data allow hydrologic models to simulate more physically realistic processes it is not clear that increasingly smaller scale data produce substantially different results useful to water resources managers this study investigated the effect of spatial and temporal scale on simulated groundwater recharge in the upper colorado river basin using the soil water balance model over the water year 1982 2014 time period groundwater recharge was simulated using 12 km 4 km and 800 m climate data at both daily and monthly time steps for both daily and monthly temporal scale simulations similar recharge magnitude and trend deviation from period of record mean were seen across all spatial scales for ten year annual average and water year comparisons seasonal comparisons of results revealed similarities in magnitude and trend of recharge during the spring season of march may when 70 of ucrb recharge occurs substantial differences were seen in simulated recharge magnitudes in other seasons between different spatial scales with median differences of as much as 36 from 4 km results comparison of simulated recharge results using the coarsest spatial and temporal climate data 12 km monthly scale with results from the finest scale data 800 m daily data indicated similar small differences in results from the different scales over ten year moving annual averages over water years and during the high recharge months of march may again it is important to note the tradeoffs such an analysis presents in terms of the need of using high resolution inputs to a hydrologic model versus the decisions such findings help support while differences in simulated groundwater recharge magnitude which may be important for groundwater flow simulations across spatial and temporal scale simulations are substantial during some seasonal comparisons trends in recharge are almost identical across scales leading to similar conclusions for water resources managers about change from normal especially considering the uncertainty inherent in projected climate data coarser spatial and longer temporal scale climate data may be sufficient for simulating changes in groundwater recharge particularly for providing water resources managers an understanding of trends in recharge over water year or longer time scales conflict of interest none acknowledgments investigation of the impact of spatial and temporal scale on simulated groundwater recharge in the upper colorado river basin was supported by the bureau of reclamation science and technology program and the usgs groundwater resources program all swb groundwater recharge modeling results for the ucrb discussed in this article are available at the u s geological survey sciencebase web site tillman 2017 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 07 014 appendix supplementary materials image application 1 
794,hydrologic model input datasets such as climate land use elevation soil and geology information are available in a range of scales for use in water resources investigations smaller spatial and temporal scale input data allow groundwater recharge models to simulate more physically realistic processes and presumably result in more accurate estimates of groundwater recharge projected climate data are therefore often downscaled to smaller spatial and temporal scales for use in these models it is unknown however if increasingly smaller scale climate data produce substantially different simulated recharge results either in magnitude or trend also even if simulated recharge results are different at a higher space and time resolution simulation at coarser resolution might be adequate to provide recharge information at decision scales e g meeting colorado river compact requirements on a ten year moving average basis historical climate datasets at three spatial 800 m 4 km and 12 km and two temporal daily and monthly scales were used in a soil water balance swb model of the upper colorado river basin ucrb to simulate groundwater recharge over the water year 1982 2014 time period the magnitude of annual and moving ten year annual average recharge results for daily climate data were within 5 and 7 of 4 km results for 800 m and 12 km climate data respectively with deviations from 1982 to 2014 means within 1 and 3 median respectively comparison of simulated recharge results using the coarsest spatial and temporal climate data with results from the finest scale data indicated similar small differences over ten year moving annual averages over water years and during high recharge months while differences in simulated groundwater recharge magnitude which may be important for groundwater flow simulations were substantial during some seasonal comparisons trends in recharge were almost identical across scales leading to similar conclusions about change from normal considering the uncertainty inherent in projected climate data coarser spatial and longer temporal scale input data may be sufficient for water resources managers who need to understand changes in trends in groundwater recharge over water year or longer time periods keywords upper colorado river basin groundwater recharge climate change 1 introduction for water resources managers seeking information on projected groundwater resources investigation of impacts from projected climate change on groundwater systems often involve the use of hydrologic model simulations with climate data from general circulation models gcms e g allen et al 2010 crosbie et al 2011 kopytkovskiy et al 2015 climate output from gcms is typically provided at relatively coarse spatial resolutions of about 100 200 km on each cell side which are then downscaled to finer resolutions e g 12 km 1 8th degree monthly datasets brekke et al 2013 and 6 km 1 16th degree daily datasets pierce et al 2014 in groundwater recharge simulations finer spatial scale models permit incorporation of more realistic variations in geologic land use and topographic information likewise recharge in many areas of the southwestern united states occurs on a daily or sub daily time scale stonestrom et al 2007 considerable time and effort is therefore expended in downscaling gcm output to smaller spatial and temporal scales for use in hydrologic models published studies of simulated groundwater recharge utilize spatial data ranging from relatively small scales i e 20 m to 100 m often used with quasi two dimensional models scibek and allen 2006 nyenje and batelaan 2009 towes and allen 2009 to fractional degree i e 5 km to 25 km scales barnett et al 2007 christensen et al 2004 crosbie et al 2010 2013 mileham et al 2009 niraula et al 2017 daily time steps are commonly used in published recharge simulation investigations ali et al 2012 barnett et al 2007 crosbie et al 2010 2011 dams et al 2012 holman et al 2009 mccallum et al 2010 mileham et al 2009 scibek and allen 2006 toews and allen 2009 niraula et al 2017 recently tillman et al 2016 2017a b used downscaled projected and historical climate data at 1 8th degree spatial and daily temporal scales to simulate groundwater recharge in the upper colorado river basin ucrb the value of higher resolution modeling particularly when providing water managers with recharge information at decision scales such as meeting compact requirements on a ten year moving average basis in the colorado river basin colorado river compact 1922 is unclear while smaller scales allow more realistic hydrologic processes to be simulated it is unknown whether meaningfully different groundwater recharge simulations either in magnitude or trend result from using smaller versus larger scale climate data this paper presents results from a new investigation of simulated groundwater recharge in the ucrb using historical climate data at the 12 km 1 8th degree 4 km 1 24th degree and 800 m 1 120th degree scales on both daily and monthly time steps these scale choices correspond to available contemporary climate data from archives such as the downscaled climate and hydrology projections maurer et al 2007 and prism prism climate group 2016 that are routinely used in a range of water resources planning studies e g tillman et al 2017a b bureau of reclamation 2017 for others simulated basin scale groundwater recharge results for the different spatial and temporal scale data are compared on seasonal annual and moving ten year average basis results of the magnitude of simulated groundwater recharge are compared as well as deviations from the period of record mean which may be of more interest to water managers to whom changes from normal are important 1 1 study area this study investigates the effect of spatial and temporal scale on groundwater recharge simulations in the upper colorado river basin fig 1 the colorado river is an important source of water in the southwestern united states u s supplying the industrial and domestic water needs of more than 38 million people in the u s and mexico colorado river basin salinity control forum 2013 bureau of reclamation 2011 at lake mead in arizona downstream of which nearly all of the colorado river water is used the ucrb contributes almost 90 of the flow in the river u s geological survey 2016 the ucrb stream system receives an estimated 30 50 of its flow from groundwater discharge rumsey et al 2015 miller et al 2014 in his investigation of the hydrologic and groundwater flow systems in the ucrb geldon 2003 estimates about 8 1 km3 of annual recharge to all groundwater systems in the area excluding the upper san juan basin which was not part of the study for the current study the ucrb is defined as the colorado river drainage area that is upstream of the compact point at lee ferry arizona plus the great divide closed basin as delineated by the u s geological survey region 14 hydrologic unit code fig 1 u s geological survey 2018 2 methods and data groundwater recharge in the ucrb was simulated with the distributed parameter soil water balance swb model for this spatial and temporal scale study westenbroek et al 2010 groundwater recharge is estimated by the swb model at daily time steps by calculating water balance parameters using a modified thornthwaite mather soil water balance accounting method with groundwater recharge estimated within each model cell of the study area thornthwaite 1948 thornthwaite and mather 1957 the swb model calculates water sources and sinks within each cell of the model domain from landscape characteristics and climate data groundwater recharge is then estimated as the difference between the change in soil moisture and these water sources and sinks swb model simulations require spatially gridded datasets including daily minimum temperature daily maximum temperature daily precipitation hydrologic soil group land cover available soil water capacity and overland flow direction swb simulations also require input datasets in a tabular format including vegetation rooting depths runoff curve numbers interception values and maximum daily recharge values for each combination of land cover type and hydrologic soil group a detailed discussion of input datasets computational details and limitations of the swb model are presented in the supplementary material for each combination of spatial and temporal scale climate data the ucrb swb model was initially run for a period of 10 years using initial conditions of 100 soil moisture and 0 snow cover the final soil moisture and snow cover conditions at the end of the 10 year initialization period were then used as initial conditions for full 1981 2014 model runs daily climate data for the 1981 2014 time period at a 1 24th degree 4 km spatial scale fig 2 middle panel covering the ucrb study area were obtained from the prism climate group at oregon state university prism climate group 2016 the daily 4 km prism climate data were aggregated to 1 8th degree 12 km spatial scale fig 2 bottom panel and disaggregated to 1 120th 800 m spatial scale fig 2 top panel climate data disaggregation from coarse to finer scale data 4 km to 800 m was performed using the bilinear interpolation method specifically the linint2 function from the national center for atmospheric research ncar command language ncl ncar 2017 this method has been used by reclamation and reclamation collaborators to downscale relatively coarse 100 200 km climate projections to finer spatial scales 1 8th degree using the bias correction and spatial disaggregation bcsd statistical downscaling algorithm bilinear interpolation is a two dimensional version of linear interpolation that is performed on a rectangular grid of points a weighted average of the four surrounding grid points is used to calculate the interpolated value national institute of standards and technology 2018 fine grid to a coarse grid 4 km to 12 km aggregation was performed using the area hi2lores ncl function ncar 2017 this function uses local area averaging to interpolate from a high resolution rectilinear grid to a low resolution rectilinear grid a low resolution rectangular grid is created from high resolution grid points by averaging them based on their fractional contribution to the low resolution grid point though ncl provides a number of re gridding functions the linint2 and area hi2lores for disaggregation and aggregation respectively were used in this study because they have been used previously in developing and studying contemporary climate datasets from gcm projections e g maurer et al 2007 gutmann et al 2014 daily precipitation and temperature data at the three spatial scales also were aggregated into monthly stress periods for swb simulations daily precipitation data were summed over each month and then the daily average for a month assigned to each day in that month daily minimum and maximum temperatures were each averaged over each month with the daily average for a month then assigned to each day in that month in this way the swb model which runs on a daily time step could be used to simulate groundwater recharge as if only monthly climate data were available to summarize and compare temperature data across spatial and temporal scales potential evapotranspiration pet values are used instead of temperature values directly pet values are a convenient measure of the effect of basin wide temperature change and have more hydrologic meaning than temperature alone pet estimates in this study are directly related to maximum and minimum daily temperatures and are computed as a volume of water which is used directly in the water balance equation see supplementary material for complete description using the numpy package in python scripts precipitation input data and swb output of pet recharge and snowmelt in dimensions of length i e inches were converted to dimensions of volume i e m3 and summed over the ucrb study area on daily time steps the distributed precipitation and swb output values were multiplied by their associated individual cell areas within the study area cell areas within the ucrb range from 15 5 km2 along the northern boundary to 17 6 km2 along the southern boundary for the 1 24th degree 4 km spatial scale data precipitation and simulation results in m3 were then summarized analyzed and compared in excel using visual basic for applications vba scripts recharge simulations using three spatial and two temporal scales were run with results compared over ten year moving average water year and seasonal time periods 3 results and discussion ucrb groundwater recharge was simulated with the swb model at three spatial and two temporal scales results from simulations using 12 km and 800 m daily climate data are compared with simulation results using the original 4 km daily prism climate data similarly simulation results using 12 km and 800 m climate data on monthly time steps are compared with simulation results using 4 km monthly climate data for both daily and monthly climate data results are summarized and compared over ten year average annual periods over water years and over three month seasons all ucrb groundwater recharge modeling results are available at the u s geological survey sciencebase web site tillman 2017 average annual recharge simulated during the 1981 2014 time period by the swb model using 4 km climate data over the same ucrb area as the geldon 2003 study was 7 9 km3 representing 2 5 difference with the geldon 2003 estimate 3 1 results from simulations with daily climate data 3 1 1 ten year moving average comparisons annual simulated groundwater recharge averaged over ten year periods moving every year for the original 4 km daily prism climate data ranged from a high of 10 4 billion b m3 over the 1982 1991 time period to a low of 7 8b m3 over the 1998 2007 time period fig 3 a recharge results using 12 km and 800 m climate data follow the same temporal pattern as the 4 km results fig 3a but are systematically less than the 4 km results fig 3b the amount of reduced recharge however is relatively small with a median percentage change from the 4 km results difference divided by the 4 km result of 4 6 for the 800 m results and 5 8 for the 12 km results fig 3b table 1 the temporal trend in simulated recharge defined here as deviation from the 1982 2014 period of record por average for each spatial scale ranged from 114 to 86 of the por mean for the 4 km results fig 3c recharge trends for the 12 km and 800 m results are even more similar to the 4 km trends than the recharge magnitude results with median percentage change from the 4 km ten year average annual recharge trends of less than 1 for both the 800 m and 12 km results fig 3d table 1 over ten year moving annual averages recharge simulations using daily climate data at the smallest spatial scale investigated do not differ substantially from simulations at the larger scales either in absolute magnitude or in trend 3 1 2 water year comparisons ucrb simulated recharge over water years from 1982 through 2014 using the original 4 km daily prism climate data ranged from a high of 16 6b m3 during water year 1993 to a low of 2 9b m3 during water year 2002 fig 4 a similar to the ten year moving annual average results water year recharge results using 12 km and 800 m climate data follow the same temporal pattern as the 4 km results fig 4a also are systematically less than the 4 km results fig 4b and only by a similarly small amount median percentage change from the 4 km results of 4 7 for the 800 m results and 6 3 for the 12 km results fig 4b table 1 simulated recharge in a few low recharge years however is substantially less for the 12 km climate data than for the 4 km climate data including a 13 6 decrease in 1992 a 13 1 decrease in 2012 and a 12 1 decrease in 2002 fig 4a differences in simulated recharge in these years are in contrast to the very small differences in precipitation of 0 18 and potential evapotranspiration pet of 0 03 figs s2 and s3 in the supplementary material deviation from the por average is predictably greater for the water year results compared with the smoothed ten year moving annual average results fig 4c water year recharge results using the 4 km climate data are as much as 76 greater and 70 less than the 1982 2014 average fig 4c recharge trends for the 12 km and 800 m results also are similar to the 4 km trends with median percentage change from the 4 km water year recharge trends of less than 3 for both the 800 m and 12 km results fig 4d table 1 unlike the ten year moving annual average results water year deviations from por means are less for 4 km results than for the other spatial resolutions in several years particularly the 12 km results fig 4d with the exception of a few years water year simulation results for the 1982 2014 time period for all spatial resolutions are similar in both magnitude and trend of recharge 3 1 3 seasonal comparisons simulated recharge results from daily climate data also were summarized in water years 1982 to 2014 over seasonal time periods including the winter months of december february djf spring months of march may mam summer months of june august jja and fall months of september november son winter and spring seasonal recharge which account for 8 and 71 of simulated annual recharge in the ucrb respectively showed similar small differences in both magnitude and trend between simulations using the different spatial resolution datasets as were seen with the water year and ten year moving annual average results figs s4 and s5 in the supplementary material median differences in djf recharge magnitude from 4 km results were 4 1 and 6 9 for 800 m and 12 km climate data respectively and median mam differences in recharge magnitude from 4 km results were 4 for both 800 m and 12 km climate data figs s4 and s5 in the supplementary material table 1 simulated recharge in the jja summer months which account for 16 of simulated annual ucrb recharge resulted in substantial differences in recharge magnitude between the 4 km climate data and the 800 m median difference of 20 5 and 12 km median difference of 35 8 climate data fig 5 a b table 1 the somewhat higher simulated jja recharge using 4 km climate data than simulations using 800 m or 12 km data cannot be explained by differences in either precipitation fig s6 in the supplementary material or pet fig s7 in the supplementary material both of which differ by less than 0 2 from 4 km data for both resolutions simulated snowmelt in jja however differs from 4 km results by a similar amount to differences in recharge results with a 15 median difference in snowmelt for the 800 m climate data and a 35 median difference for the 12 km data fig 6 differences in temperature between the different spatial datasets particularly when temperatures are near freezing in relatively limited high altitude areas of the ucrb can result in differences in the amount of snowcover and subsequent differences in the amount of snowmelt during warmer months these potentially small temperature differences in limited areas would not show up in the ucrb wide summary of temperature in the pet comparisons fig s7 in the supplementary material trends in jja recharge from simulations using the different spatial resolutions however were more similar than magnitude results with a median difference of 4 7 for the 800 m results and a median difference of 12 3 for the 12 km results compared with results from the 4 km climate data fig 5c d table 1 recharge magnitude during fall months of september november differs between simulations using the different spatial resolutions somewhat less than during jja with median percentage change of 18 5 and 15 7 for 800 m results and 12 km results compared with results from the 4 km climate data fig s8 in the supplementary material table 1 differences in trends in son recharge are similar to those from jja with median differences of 6 7 and 9 2 for 800 m results and 12 km results compared with results from the 4 km climate data fig s8 in the supplementary material table 1 simulated recharge in son however is only about 5 of the total annual amount for the ucrb 3 2 results from simulations with monthly climate data 3 2 1 ten year moving average comparisons daily precipitation and temperature data at the three spatial scales were aggregated into monthly stress periods for swb simulations as described previously annual simulated groundwater recharge averaged over ten year periods moving every year using the 4 km monthly climate data ranged from a high of 9 5 billion b m3 over the 1982 1991 time period to a low of 6 8b m3 over the 1998 2007 time period fig 7 a recharge results using 4 km monthly climate data were 6 3 12 5 less than results using 4 km daily data over comparable time periods fig 7a as with the daily climate data results recharge results using 12 km and 800 m monthly climate data follow the same temporal pattern as the monthly 4 km results fig 7a but are systematically less than the 4 km results fig 7b the amount of reduced recharge from monthly data is similar to comparative reductions from daily climate results with a median percentage change from the 4 km results of 3 6 for the 800 m results and 5 9 for the 12 km results fig 7b table 2 the temporal trend in simulated recharge ranged from 116 to 83 of the por mean for the monthly 4 km results with nearly identical deviations from por mean as results from daily 4 km climate data fig 7c recharge trends for the monthly 12 km and 800 m results also are nearly identical to the 4 km trends fig 7d table 2 3 2 2 water year comparisons ucrb water year simulated recharge over the 1982 2014 time period using monthly 4 km climate data ranged from a high of 15 7b m3 during water year 1993 to a low of 2 6b m3 during water year 2002 fig 8 a recharge results using 4 km monthly climate data were from 2 8 more in 2004 to 22 8 less in 2007 than results using 4 km daily data over comparable time periods with most water year values about 10 less fig 8a similar to water year results using daily climate data water year recharge results using 12 km and 800 m monthly climate data follow the same temporal pattern as the 4 km monthly data results fig 8a and also are systematically less than the 4 km monthly results by a small amount fig 8b the median percentage change of 800 m and 12 km monthly data results from 4 km monthly data results is 3 5 and 6 9 respectively fig 8b table 2 simulated recharge in a few low recharge years also is substantially less for the 12 km monthly climate data than for the 4 km monthly climate data including a 14 3 decrease in 1992 and a 12 7 decrease in 2012 in a similar manner to daily climate data results differences in monthly climate data simulated recharge in these years are in contrast to the very small differences in precipitation of 0 17 and potential evapotranspiration pet of 0 03 fig s9 and s10 in the supplementary material deviation of water year results from the 1982 2014 average are similar between results from all spatial resolution data on a monthly time step and between the monthly and daily 4 km climate data results fig 8c d median percentage change from the monthly 4 km recharge trends is less than 2 5 for both the monthly 800 m and 12 km results fig 8d table 2 median percentage change of monthly 4 km climate data results from daily 4 km climate data results is 4 8 for the most part water year simulation results for the 1982 2014 time period using monthly climate data are similar among all spatial resolutions and between 4 km daily and all monthly resolutions particularly when comparing deviation of recharge from por means 3 3 3 seasonal comparisons as seen with simulated recharge results using daily climate data over seasonal time spans the magnitude of recharge results from simulations using monthly climate data were more variable among the different spatial datasets for the summer jja fig 9 and fall son fig s11 in the supplementary material months than for winter djf fig s12 in the supplementary material or spring mam fig s13 in the supplementary material the magnitude of simulated recharge in the summer months of jja which account for 27 of the annual simulated recharge using monthly climate data were less than 4 km results by median values of 19 and 32 for 800 m and 12 km results respectively the magnitude of recharge results from the fall months of son differ from 4 km results by 25 and 30 for 800 m and 12 km results respectively but make up only 2 of the annual simulated ucrb recharge using monthly climate data fig s11 in the supplementary material recharge trends are more similar among the different spatial scales during all seasons with the highest median difference of 19 between 12 km and 4 km results in son fig s11 in the supplementary material for the two seasons of mam fig s13 in the supplementary material and jja fig 9 comprising almost 95 of the annual ucrb recharge median differences between monthly 4 km results and other spatial data results was 12 or less table 2 in a similar manner to the daily climate data results differences in simulated recharge in jja using monthly climate data appears to be related to differences in snowmelt during this time period fig 10 3 3 comparison of 800 m daily and 12 km monthly results ucrb recharge from simulations using 800 m daily and 12 km monthly data were compared in order to explore the effect of the maximum range in both spatial and temporal data on recharge results the magnitude of annual simulated groundwater recharge averaged over ten year periods moving every year was greater for the 800 m daily climate data than for the 12 km monthly climate data by about 10 over the 1982 2014 time period fig 11 a b comparison of results from each climate dataset to their respective por mean however indicate almost identical simulated groundwater recharge trends with a median difference in results between the two climate datasets of less than 2 fig 11c d the magnitude of ucrb simulated recharge over water years from 1982 through 2014 using 800 m daily climate data also were somewhat greater than results using 12 km monthly data by a median difference of 11 fig 12 a b simulated recharge trends between the two climate datasets were similar with deviation from the por mean sometimes greater for the 800 m daily climate data but sometimes less fig 12c d with an overall median difference between the two datasets of 5 9 as with results within the daily and monthly time scale comparisons smaller differences in seasonal results between simulations using 800 m daily climate data and 12 km monthly data are seen in the season with largest percentage of ucrb yearly recharge fig 13 the spring months of march may account for about 73 of the yearly ucrb recharge for both the 800 m daily and 12 km monthly simulations with median differences in simulated recharge magnitude of about 9 and median differences in trends of about 6 fig 13 recharge in summer jja is less but still accounts for a substantial 14 21 of simulated annual ucrb recharge jja simulated recharge differs between the 800 m daily and 12 km monthly simulations by a median of 55 for magnitude comparisons and by 21 for trend comparisons fig 14 fall and winter seasons together account for about 10 of annual ucrb recharge and differ between simulations from the two climate datasets by a median 80 or more in magnitude and 34 or more in trend figs s14 and s15 in the supplementary material 4 applicability of results to other basins this investigation of the effect of spatial and temporal scale on simulated groundwater recharge was performed in the upper colorado river basin but conclusions from this study may be applicable to other hydrologic regions with respect to the perceived importance of spatial scale the ucrb may be a relatively extreme test case compared with most other hydrologic regions in the u s fig 15 a higher percentage of ucrb precipitation falls in a smaller portion of the basin than in all other major hydrologic regions in the u s with the exception of the california and pacific northwest regions fig 15 and these regions have total precipitation of 2 2 and 5 9 times the precipitation in the ucrb respectively limited high elevation mountainous headwater areas in the ucrb receive a majority of the basin precipitation while most of the basin is semi arid to arid plains that receive little precipitation liebermann et al 1989 based on this information it might have been assumed that small spatial discretization of climate data would be important for recharge studies in the ucrb however substantial differences in simulated ucrb groundwater recharge were not observed in the spatial scale comparisons particularly when trends were compared even between the 800 m and 12 km climate datasets simulated groundwater recharge in hydrologic regions with more dispersed precipitation might be expected to result in similar or perhaps smaller differences between simulations using different spatial scale data conclusions from this study related to the importance of temporal scale however may require more investigation before being applied to dissimilar basins elsewhere in the ucrb snowpack and subsequent snowmelt dominate the hydrology of the basin the dominance and slower time frame of snowmelt in the basin may have obscured differences in daily monthly simulation results that may be apparent in other regions in monsoon dominated hydrologic systems such as the lower colorado river basin and the lower rio grande daily precipitation in local areas can be extreme during the summer monsoon however winter rain in these regions is generally more effective at producing groundwater recharge than an equivalent amount of precipitation during summer owing to lower et losses from lower winter temperatures stonestrom et al 2007 it is unclear therefore if substantial variations in daily monsoon precipitation would result in greater differences between daily and monthly recharge simulations than were seen for ucrb simulations other regions with hydrology dominated by snowmelt or regions with precipitation that is distributed over longer time scales might be expected to perform similarly in daily monthly recharge simulations as this study 5 summary and conclusions while smaller spatial and temporal scale input data allow hydrologic models to simulate more physically realistic processes it is not clear that increasingly smaller scale data produce substantially different results useful to water resources managers this study investigated the effect of spatial and temporal scale on simulated groundwater recharge in the upper colorado river basin using the soil water balance model over the water year 1982 2014 time period groundwater recharge was simulated using 12 km 4 km and 800 m climate data at both daily and monthly time steps for both daily and monthly temporal scale simulations similar recharge magnitude and trend deviation from period of record mean were seen across all spatial scales for ten year annual average and water year comparisons seasonal comparisons of results revealed similarities in magnitude and trend of recharge during the spring season of march may when 70 of ucrb recharge occurs substantial differences were seen in simulated recharge magnitudes in other seasons between different spatial scales with median differences of as much as 36 from 4 km results comparison of simulated recharge results using the coarsest spatial and temporal climate data 12 km monthly scale with results from the finest scale data 800 m daily data indicated similar small differences in results from the different scales over ten year moving annual averages over water years and during the high recharge months of march may again it is important to note the tradeoffs such an analysis presents in terms of the need of using high resolution inputs to a hydrologic model versus the decisions such findings help support while differences in simulated groundwater recharge magnitude which may be important for groundwater flow simulations across spatial and temporal scale simulations are substantial during some seasonal comparisons trends in recharge are almost identical across scales leading to similar conclusions for water resources managers about change from normal especially considering the uncertainty inherent in projected climate data coarser spatial and longer temporal scale climate data may be sufficient for simulating changes in groundwater recharge particularly for providing water resources managers an understanding of trends in recharge over water year or longer time scales conflict of interest none acknowledgments investigation of the impact of spatial and temporal scale on simulated groundwater recharge in the upper colorado river basin was supported by the bureau of reclamation science and technology program and the usgs groundwater resources program all swb groundwater recharge modeling results for the ucrb discussed in this article are available at the u s geological survey sciencebase web site tillman 2017 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 07 014 appendix supplementary materials image application 1 
