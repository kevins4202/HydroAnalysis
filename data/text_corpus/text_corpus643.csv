index,text
3215,flooding is one of the most destructive natural hazards that has caused catastrophic effects worldwide recently machine learning methods have become widespread in flood susceptibility assessments due to their efficiency and robustness however flood inventory data acquired from historical flooding records and field surveys in existing studies are sparse and not enough to develop accurate machine learning models thus we developed a hybrid approach that integrates hydrodynamic model hec hms ras rapid flood model height above the nearest drainage hand and machine learning model random forest rf for flood susceptibility assessment the proposed approach was then implemented in the xinluo watershed a flood prone mountainous catchment in china the results showed that the spatially continuous flood inventory map generated from hec hms ras model satisfies the big data requirements of the rf model and the proposed hybrid approach demonstrates the effectiveness and efficiency in flood susceptibility assessment with overall accuracy and area under the roc curve values of 0 915 and 0 912 respectively the geographical and hydromorphological factors had greater effects on riverine flooding with average contribution of 27 8 and 27 6 in comparison the average contribution of land cover and meteorological factors were 24 3 and 20 3 respectively the method proposed in this study is effective in assessing and forecasting flood susceptibility and can facilitate resilience planning as well as integrated flood management keywords flood susceptibility assessment hec hms ras hand influencing factors random forest data availability the authors do not have permission to share data 1 introduction flooding is one of the most devastating and deadly natural hazards worldwide causing enormous economic losses and death over the last few decades chapi et al 2017 chen et al 2020 khosravi et al 2019 the global temperature has risen by 2 c compared to that in the pre industrialization period leading to an increase in the frequency and intensity of precipitation it is estimated that more than 2 billion people will be affected by floods by 2050 ipcc 2019 siegert et al 2020 it is almost impossible to completely prevent the occurrence of floods and developing countries are highly vulnerable due to lack of adequate drainage facilities china is the largest and fastest growing developing country and its urbanization rate exceeded 60 in 2019 cai et al 2021 more than 200 cities in china have experienced flooding in the last decade according to the state flood control and drought relief headquarters of china zhang et al 2018a b hence flood susceptibility and driving mechanisms for flooding control in china must be determined flood susceptibility refers to the likelihood of flooding in a particular area based on a series of geo environmental conditions ahmadlou et al 2019 flood susceptibility assessment identifies potentially flood prone areas and evaluates the driving forces of flood it has played an essential role in flood management and hazard mitigation tang et al 2020 tehrany et al 2015 in previous studies various physical based flood models have been widely used to simulate and assess flood susceptibility alaghmand et al 2012 alfy 2016 renschler wang 2017 hec hms ras mike flood and swmm are prominent software that can simulate the inundation area and depth by calculating the flood routing progress in the channel reach using the saint venant s principle and the overland flood extent using the navier stokes equations brunner 2016 rossman 2015 however these traditional hydraulic models typically require complex input data and long calculation time because of their complicated model structure chen et al 2012 furthermore these flood models are not suitable for simulating the flood evolution in large scale watersheds with areas over 1 000 km2 afshari et al 2018 neelz pender 2013 therefore more efficient and effective methods are necessary to overcome these shortcomings of the traditional models a newly proposed low complexity and rapid flood mapping method based on hand model has been introduced recently maidment 2017 nobre et al 2016 the hand model is a normalized digital elevation model dem defined as the vertical distance from a hillslope surface cell to a respective outlet to the drainage cell i e the difference between cells that belong to a mutually connecting flowpath nobre et al 2011 the hand model has been widely used in different regions worldwide due to its calculation efficiency and simulation accuracy it has been considered the best indicator of stationary surface water distribution martinis et al 2015 olorunfemi et al 2020 rahmati et al 2018 sutanudjaja et al 2013 young nobre 2012 zheng et al 2018 liu et al 2016 successfully established a near real time flood inundation system that integrated the hand model and national weather service nws of the national oceanic and atmospheric administration noaa based on the 10 m us national elevation dataset ned liu et al 2016 maidment 2017 these studies show that the hand model is an efficient and flexible alternative to flood models to assess the flood susceptibility at multi scales however the hand model cannot provide hydrological data such as water depth and discharge in the reach which are critical for flood inundation and depth mapping therefore a hybrid of the hand model and hydrological model could be a feasible accurate and efficient solution for flood simulation the susceptibility of flooding at any location depends on its geomorphology land cover hydrometeorological condition and other flood inducing factors khosravi et al 2018 currently the multiple criteria decision analysis mcda and analytic hierarchy process ahp are the most commonly used methods for evaluating the flood inducing factors ozturk and kılıç 2011 papathoma köhle 2016 shadmehri toosi et al 2019 however when there are various flood inducing factors and large amount of data decision makers struggle to rate all the factors fairly leading to biased scores and weights this is one of the potential limitations of the mcda and ahp in analyzing flood inducing factors and flood management therefore a more objective evaluation method that can avoid human related bias is needed in weighing the flood inducing factors data driven or machine learning methods that can significantly reduce such bias have gained more attention and have been successfully applied to flood susceptibility assessments and flood inducing factor analyses munawar et al 2021 recently many studies have focused on flood susceptibility mapping and evaluation of flood inducing factors by using machine learning and geographic information systems gis costache et al 2020 shafizadeh moghadam et al 2018 these include support vector machine svm bafitlhile and li 2019 choubin et al 2019 artificial neural network ann carreau guinot 2021 costache et al 2020 and random forest rf chen et al 2020 woznicki et al 2019 among these methods the rf method was found to have a superior performance due to its ability to handle large datasets with correlated variables and the built in variable importance evaluation chen et al 2020 svetnik et al 2003a b wang et al 2015 woznicki et al 2019 zhao et al 2018a rf model is an ensemble supervised machine learning method that consists of multiple decision trees i e forest where each tree corresponds to a vote and the final rf model depends on the total votes breiman cutler 2001 although the rf model is one of the most efficient and widely used machine learning methods to identify patterns in big data some prerequisites must be met to create a more accurate prediction these prerequisites include a large volume of data and a variety of variables for the model training and importance evaluation however most previous studies have applied spatially sparse flood points and flooding inventory maps from field surveys or historical flood marks as the training dataset these insufficient data lead to sampling errors during the random training process in machine learning chen et al 2019 chen et al 2020 pham et al 2021 zhao et al 2018b therefore a spatially continuous and unbiased flooding dataset containing all the hydro geomorphological information is needed for the training and validation process xinluo is the upper sub watershed of the jiulong river watershed jrw which is the second largest in fujian province china it has an area of approximately 600 km2 and lies between 24 55 00 n 25 15 00 n and 116 45 00 e 117 05 00 e fig 1 subtropical monsoon is the dominant climate condition resulting in abundant rainfall especially during the wet season with an average annual rainfall of about 1600 mm as the headwater of jrw the xinluo sub watershed has more than 100 streams with a catchment area of 50 km2 in recent years the frequency and intensity trend of rainfall have increased under the impact of climate change leading to several severe storm related hazards for example the cumulative precipitation in the xinluo sub watershed reached 687 9 mm in june 2019 accounting for 30 of the total annual precipitation which was also the highest in all cities and regions in china cmdc 2020 in addition to extreme weather the complex terrain characterized by the mountainous area in the upstream and rapidly developing built up area downstream of the watershed are ideal for applying flood susceptibility assessment and flood inducing factor analysis the aims of this study are 1 to develop a hybrid flood susceptibility approach combining the hydrodynamic hec hms ras rapid flood hand and machine learning rf models and 2 to evaluate the impact of each flood inducing factor xinluo sub watershed is selected as the study area due to its frequent flooding records and diverse geomorphological features to realize an unbiased flood inducing factor analysis using machine learning methods we applied a random sampling method to the study area a total of 1 000 spatially random points were created fig 1 this feature is distinguishable from those in previous studies which mainly focused on the flooded area when analyzing flood inducing factors bui et al 2020 chen et al 2020 tehrany et al 2019 2 hybrid approach for flood susceptibility assessment the methodological workflow of this study is presented in fig 2 this hybrid approach mainly consists of three components 1 data preparation and processing including flood inducing factors and flood inventory map 2 training and validation of the rf model and 3 flood susceptibility mapping and importance analysis of each flood inducing factor the major procedures involved are described in the following sections 2 1 data preparation and processing the flood inventory map was acquired by integrating the hydrodynamic hec ras and rapid flood hand models based on the output of a calibrated hydrological model hec hms the detailed descriptions of these models are given as follows 2 1 1 hec hms ras model the hydrologic modeling system hec hms and center river analysis system hec ras were developed by the us army corps of engineers usace 2016 the hec hms is designed to simulate the complete hydrological processes of dendritic watershed systems in a user friendly interface this model can provide continuous hydrograph simulation over a long period or event based rainfall runoff process at an hourly interval the input data for setting up the hec hms model include dem rainfall discharge land use land cover and soil type in this study hourly precipitation data from 2010 to 2019 and corresponding hydrological data at the watershed outlet were collected to build and validate the hec hms model a total of eight flood inducing storms were selected and used to calibrate and validate the model the spatial distribution of precipitation and hydrological stations are shown in fig 1 the spatial input data to the hec hms model are shown in fig a 1 appendix a including the land use and land cover data of 2018 based on landsat images from the united states geological survey usgs fig a 1 a the soil types were collected from china soil science data center fig a 1 b cssdc 2020 a 10 m resolution dem was used to characterize the boundary of the sub basin based on the d8 algorithm and 16 sub basins were delineated fig a 1 c the topographic parameters of each sub basin are listed in table a 1 the spatial distribution of the curve number cn was derived based on the soil conservation service cn scs cn method fig a 1 d and the average cn for each sub basin was summarized in table a 2 in general the calculated hydrographs of the hec hms model can serve as boundary conditions in hydraulic models such as hec ras brunner 2016 the hec ras is an integrated system of software designed for interactive use in a multi tasking environment it can perform one dimensional and two dimensional hydraulic calculations for an entire network of natural and constructed channels based on steady and unsteady flow computational methods more details about the hec ras model can be obtained from the studies of ben khalfallah saidi 2018 brunner 2016 and knebl et al 2005 in this study we used the hec hms model to generate hydrographs that reflect the rainfall runoff process for each of the eight rainstorms and the corresponding observed discharge data were used to calibrate and validate the model the hydrograph produced by the most severe rainstorm event i e june 2019 served as the input data to reconstruct the riverine flood inventory map 2 1 2 hand model executing the hec ras model however requires substantial spatial details e g channel cross section and optimum parameter values which are often unavailable accordingly the model needs considerable setup and computation time especially at the watershed scale afshari et al 2018 kauffeldt et al 2016 driven by such constraints we used the hand model a novel fast computing low complexity inundation mapping model with simplified input requirements and process representations to simulate the flooding extent at the upstream of the watershed liu et al 2016 maidment 2017 nobre et al 2016 the hand is a drainage normalized model that computes the differences in elevation between each grid cell and the elevations of the flow path connected downslope grid cells where the flow enters the channel nobre et al 2016 there are two sets of procedures to create the hand model using dem fig 3 the first procedure is to condition the original dem fix sinks identify the flowpaths and select the threshold for calculating an accumulation area as recommended in previous studies one tenth of the total watershed area was used as the accumulation threshold that represents a drainage system in this study o callaghan mark 1984 tarboton 1997 the second procedure includes the following 1 using flow directions and stream networks to generate the nearest drainage points map 2 assigning the elevation of each drainage point to the corresponding grids in the same drainage system and 3 subtracting the elevation of the original dem by the revised dem fig 4 shows that the hand model is relatively flat compared to the original dem this is the key feature to distinguish the hand model from other rapid flood models which are based on the absolute height above sea level resulting in the simulated floods concentrated in low lying areas teng et al 2015 although the hand model can simulate flood inundation in a large area streamflow is required as the input data for the inundation modeling in this study the hand model was coupled with the hec hms model that can provide the input streamflow data the peak flow value in the june 2019 event was used as the input data for the hand model to simulate the extent of flooding at the upstream of the watershed the inundation area of the whole watershed based on the hand and hec ras models was utilized as the input training and validation dataset for the machine learning rf model 2 1 3 flood inducing factors in general the risk of flood hazard is subject to changes in physical topography and meteorological conditions selecting the flood inducing factors depends on data availability and specific location conditions in this study 15 flood inducing factors were selected according to previous studies and data availability these factors can be broadly categorized as geographical hydromorphological land cover and meteorological factors ahmadlou et al 2019 chapi et al 2017 chen et al 2020 khosravi et al 2018 wang et al 2015 because the flood movement is significantly affected by the physical terrain geography forms a key factor in identifying the severity and extent of flooding fantin cruz et al 2011 woodrow et al 2016 flat and low lying areas receive more runoff within a short period thus slope is critical in hydrological calculations kia et al 2012 aspect is another useful factor in flood analysis which accounts for the level of rainfall incurred due to its impact on precipitation and sunshine levels abubakar et al 2012 profile and planar curvatures can influence the water movement at the vertical and horizontal levels respectively topographic position index tpi and topographic roughness index tri are two morphological factors highly associated with flooding werner et al 2005 tpi is the average difference in elevation of the target cell and adjacent cells whereas the tri is the average squared difference a floodplain may be affected by the roughness elements such as surface variation and land cover the topographic wetness index twi also has considerable impact on flooding which indicates the tendency of water to move downward due to the gravitational force it can be used to quantify the topographical effect on hydrological processes lee et al 2017 thus slope fig 5 a aspect fig 5 b profile curvature fig 5 c planar curvature fig 5 d tpi fig 5 e tri fig 5 f and twi fig 5 g were used as the geographical factors associated with flooding in most cases the spatial distribution of hydromorphological indicators is significant to understanding the potential flooding process because flooding occurs along the riverside distance to the river dtr is an important factor in mapping flood susceptibility glenn et al 2012 khosravi et al 2018 flow accumulation indicates the total amount of accumulated water received from upstream at a location stream power index spi and stream transportation index sti indicate the erosive and transport capacity of overland flow at a given point on the surface moore grayson 1991 the stream order classifies the type of stream based on its tributaries the stream order increases with increasing number of upstream tributaries resulting in more susceptibility to flooding tarboton et al 1991 therefore the dtr fig 5 h flow accumulation fig 5 i spi fig 5 j sti fig 5 k and stream order fig 5 l were selected as the hydromorphological indicators land use and land cover lulc types are also important factors for flood susceptibility assessment brath et al 2006 normalized difference vegetation index ndvi fig 5 m and normalized difference impervious surface index ndisi fig 5 n were calculated using different bands of landsat 8 oli satellite images collected from the usgs eros data center usgs 2020 ndvi is often used for the early detection of water stress providing information on both the spatial distribution of water stress on vegetation and its temporal evolution over long periods of time there is a negative correlation between vegetation density and flood occurrences and thus ndvi is an influencing factor in flood analysis tehrany et al 2015 ndisi is a lulc factor used to identify areas that are prone to inundation by analyzing the spatial distribution of impervious surfaces high ndisi values are correlated with built up areas that decrease the infiltration capacity of the terrain musse et al 2018 zhang et al 2018a b ndvi and ndisi were calculated based on landsat images on july 27th 2019 given the biased and incomplete meteorological data used in previous studies for assessing the flood susceptibility bui et al 2020 chapi et al 2017 mind je et al 2019 shafizadeh moghadam et al 2018 tang et al 2020 zhao et al 2018b this study for the first time proposed a new rainfall dynamic pattern index rdpi fig 5 o based on high spatiotemporal resolution radar rainfall dataset 1 km spatial resolution at 1 h time interval the method used to derive rdpi mainly consists of three steps 1 getis ord gi a local clustering analysis method is used to statistically identify the hot and cold spots of precipitation areas at each time slice of the radar images getis and ord 2010 ord and getis 1995 the hot cold spots of precipitation areas will have a high low gi value and be surrounded by other grids with high low gi values 2 the mann kendall trend test is then used to analyze the trend of the gi value in each column the mann kendall trend test is a non parametric test which means it works for all distributions the null hypothesis for this test is that there is no monotonic trend in the series and the alternate hypothesis is that a trend exists 3 the spatiotemporal dynamic patterns of precipitation for each column are then identified according to the trend characteristics arcgis pro 2019 to simplify the research these patterns are reclassified into three major types hot spots at different significance level cold spots at different significance level and no pattern detected this data driven method and rdpi can provide a comprehensive understanding of the spatiotemporal dynamics of precipitation not only in the static data frame but also in the entire time series more details of this method are discussed by fang et al 2020 2 2 flood susceptibility assessment using rf rf is an ensemble machine learning method that uses numerous classifications and regression trees carts to make a decision breiman cutler 2001 the rf model trains each cart on bootstrap resamples of the total dataset unlike rf the traditional cart method uses all dataset features which normally leads to overfitting and multicollinearity issues murphy 2012 the rf model randomly selects features to split each node instead of using all the features in the training process rules based on response variables are developed to divide explanatory variables until the resulting predictions have a minimum amount of node impurity the impurity is the sum of the squared deviations between the predicted and actual value loh 2011 in this study the training and validation datasets were generated using 1 flood inducing factors and 2 flood inventory map which were provided by the hand and hec ras models we randomly created 1 000 points in the study area as sampling points to reflect all possible combinations of flood inducing conditions 50 of which were located in flooded areas while the remaining 50 were located in non flooded areas the spatial distribution of these random points is shown in fig 1 this is a remarkable improvement compared to previous studies which only used the flooded area as the input dataset for machine learning models the continuous flood inventory map from the hec ras and hand models can provide a large unbiased dataset for the training and validation procedures of the rf model hyperparameters define the characteristics of the model that can impact the accuracy and computational efficiency the ratio of points used for training and testing number of iterations and number of trees are the most important hyperparameters in the rf model breiman cutler 2001 svetnik et al 2003a b all points in the flooded and non flooded areas were randomly sampled according to a certain ratio in each iteration of the machine learning process such ratio decides the percentage of points used for training and testing procedures in this study the number of iterations and ratio were set to 10 000 and 70 respectively which means that 700 points were randomly selected and used for the training process whereas the remaining 300 points were used for cross validation using the out of bag oob error method for each iteration the above process was repeated 10 000 times to obtain the final result the number of trees was decided by the trial and error method and the optimal results are shown in section 3 1 the oob score is computed as the number of correctly predicted rows from the oob sample with bootstrapping each of the remaining samples had an oob score that could be used to test the accuracy of each tree the random selection of flood inducing factors and response variables in the training of the individual classification trees created various weak learners thus avoiding the over fitting issue the accuracy of the rf model can be obtained by averaging the accuracy of each tree with their oob error as follows 1 e oob 1 n i 1 n y i y i 2 where n is the total number of oob samples y i is the observed output of oob samples and y i is the rf output that corresponds to the oob input factors aside from its predictive capability the rf model can be used to evaluate the importance of each variable based on its built in gini importance method this indicator measures how the gini impurity decreases when a variable is chosen to split a node the gini decrease across every tree of the forest is accumulated every time that variable is chosen to split a node then the sum is divided by the number of trees in the forest to derive the final gini importance the rf model can learn and record the gini importance of the input variables in the training and predicting procedures chen et al 2020 2 3 accuracy assessment quantitative criteria were used to evaluate the accuracy of the models a reasonable output from the hec hms model is critical in this analysis however several parameters cannot be estimated directly from field measurements and uncertainty always exists in the parameter values the amplification of this uncertainty in the modeling parameters and structure can result in unreliable models therefore sensitivity analysis is used to quantify the relative impact of various sources of uncertainty on the output variables allowing the decision makers to assess and identify the input parameters with the greatest impact on the model output the univariate gradient ug search algorithm was selected to calibrate and optimize the parameters of the hec hms model this method increases or decreases a parameter value by 5 in every iteration while keeping other variables unchanged usace 2016 several hydrological and hydrodynamic parameters including initial losses cn scs lag base flow recession constant peak ratio muskingum k and muskingum x were chosen as the target sensitive parameters for example the initial losses represent interception and depression storage the cn controls the excess runoff from precipitation which is a function of cumulative precipitation soil cover land use and antecedent moisture and the muskingum k and muskingum x decide the travel time of the flood wave when solving the routing equation the resultant effects of the sensitivity analysis were quantified using discharge volume peak discharge and peak time castro maidment 2020 halwatura najim 2013 usace 2016 the relative error in peak discharge rep relative error in total discharge volume req peak time error δt and determination coefficient dc were used to evaluate the agreement of the observed and simulated hydrographs of the hec hms for both calibration and validation processes the calculation equations are given as follows 2 re p p s p o p o 100 where p s is the simulated peak flow and p o is the observed peak flow 3 re q q s q o q o 100 where q s is the simulated total discharge and q o is the observed total discharge 4 δ t t s t o where t s is the simulated peak flow time and t o is the actual observed peak flow time 5 dc 1 i 1 n q s i q o i 2 i 1 n q s i q o 2 where q o i is the observed discharge for each time step i q s i is the simulated value at time step i q o is the mean observed discharge and n is the total number of values within the time period results from the flood models were evaluated using the receiver operating characteristic roc curve which is considered as the standard technique to validate the general performance of the flood models pham et al 2021 tehrany et al 2019 the roc curve is graphed with the x axis as 1 specificity and y axis as sensitivity specificity is the proportion of non flood pixels correctly classified as non flood whereas sensitivity is the proportion of flood pixels correctly classified as flood the roc curve shows the trade off between sensitivity and specificity models that give curves closer to the top left corner indicate a better performance this means that the top left corner of the plot is the ideal point though this is not very realistic as a baseline a random model is expected to give points lying along the diagonal the area under the roc curve auc is a quantitative index for identifying the general performance of the flood models higher auc indicates better model performance and ranges from 0 5 for inaccurate models to 1 for perfect models bui et al 2019 bui et al 2020 these indices were calculated as 6 s e n s i t i v i t y tp tp f n 7 s p e c i f i c i t y tn fp t n 8 auc t p t n p n 9 accuracy tp t n tp t n f p f n where true positive tp represents the number of pixels that were correctly classified as flood true negative tn represents the number of pixels that were correctly classified as non flood false positive fp and false negative fn indicate the number of pixels that were incorrectly classified as flood and non flood respectively 3 results 3 1 performance of the hybrid approach optimizations and performance examinations were applied to the models of the hybrid approach first sensitivity analysis was applied to the hec hms hydrological model based on the ug method the average effect of each target parameter on the response variables is shown in fig a 2 the variation of each parameter with peak discharge and discharge volume are shown in fig a 3 and fig a 4 respectively these figures show that cn scs lag and muskingum k are the most sensitive parameters that need close attention in the calibration process of the hec hms model second the hec hms model was calibrated and validated using eight flood inducing rainstorm events from 2010 to 2019 four of which were used for calibration and the remaining four for validation the detailed observed and simulated hydrographs of different rainstorm events are plotted in fig a 5 the calibration and validation performance is listed in table 1 the results showed that all the simulated and observed peak discharges occurred on the same day and the maximum peak time error was 1 h all dc values of the different rainstorms were above 0 8 except for the 2015 08 31 event because there had been a long period of drought until this storm and therefore making the simulated discharge overestimated the rep and req were less than 15 in the calibration phase and less than 20 in the validation phase in general these statistical measures indicate that a highly satisfactory rainfall runoff prediction with relatively small errors was achieved and the performance of the hec hms flood model was acceptable the calibrated model was thereafter used to inverse peak discharge and its evolution process induced by the most severe rainstorm event 2019 06 11 to provide the input data for the flood models the flood inventory map of the whole watershed was then reconstructed by coupling the hec ras downstream and hand upstream as shown in fig 6 it is worth noting that for a long return or extreme fluvial flooding event the inundation area will definitely cover that of short return e g the inundation area of a 200 year flood is larger than that of 50 year flood therefore the inundation area produced by 2019 06 11 storm can provide big enough training dataset for the machine learning model for the number of trees 12 trial and error iterations were applied to optimize this hyperparameter to improve the predictive performance of the rf model the detailed configuration and running efficiency of the number of trees from 2 to 2000 are listed in table 2 the model accuracy of the training and validation periods are shown in fig 7 these results indicated that the running time significantly increased with an increase in the number of trees however the accuracies of training and validation stabilized at 0 99 and 0 89 respectively when the number of trees exceeded 200 therefore the value of the number of trees was set to 200 for cost effective consideration 3 2 flood susceptibility assessment based on the proposed hybrid approach the flood susceptibility map was successfully generated using the spatially distributed flood inducing factors as shown in fig 8 this inundation map produced by the rf model showed a performance comparable to that of the traditional flood models fig 6 demonstrating the efficiency of the rf model for flood susceptibility mapping especially in ungauged regions with sparse data the resulting flood susceptibility map simulated by the rf model indicated a robust spatial correlation with several flood inducing factors such as twi fig 5 g and dtr fig 5 h in contrast several factors showed lower flooding effectiveness such as aspect fig 5 b and stream order fig 5 l to quantify the importance and contribution of each factor on flooding the gini coefficients were used to further examine the importance of each flood inducing factor and the results are shown in fig 9 it can be indicated that geographical factors significantly influenced the occurrence of flood hazards with an overall contribution rate of 48 followed by hydromorphological land cover and meteorological factors with contribution rates of 34 12 and 5 respectively among these indicators land cover factors including ndisi and ndvi were ranked in the middle indicating that geographical and hydromorphological features had a greater effect on flooding compared to human activities and urbanization precipitation however had limited influence in determining the flooded areas riverine flooding is normally driven by extreme or long term precipitation occurring in the upstream of catchment and the peak river flow at each tributary may arrive simultaneously at the downstream river that will eventually cause riverine flooding even though no rainfall is observed in the vicinity of downstream in addition only one precipitation index was used for the machine learning model which significantly weakened the weight of this index compared to that of the other three categories 3 3 inter comparison and validation of flood susceptibility map a set of different random points was created 1 000 points in order to evaluate the predictive performance of the rf model compared with the flood inventory map produced by the mechanism model using the same rainstorm event 2019 06 11 the inter comparison of models for inundation extent is shown in fig 10 it can be seen that the rf model produced a larger inundation area compared to the mechanism based models however these overestimated flood points and areas are the potential flood risk zones especially when the water level rises and breaks dams and dikes to overflow onto the surrounding banks shores and neighboring land nonetheless the spatial distribution of the inundation areas predicted by the rf model was highly conformable with that of the mechanism based models where the inundation areas were mainly distributed along the riverside and the confluence area downstream the tp fp tn and tp values were 6 79 855 and 60 respectively the sensitivity and 1 specificity of the rf model were 0 909 and 0 085 respectively which indicated that the rf model can achieve a high flood recognition rate while maintaining a low false alarm rate the overall accuracy of the rf model was 0 915 and the auc was 0 912 fig 11 these indicators show that the machine learning based method can provide an effective and efficient alternative approach for flood susceptibility mapping based on the readily accessible flood inducing factors compared to the traditional mechanism based methods which are usually time consuming and data intensive for the flood susceptibility assessment in addition this feature is essential for ungauged areas dealing with the same issue 4 discussion 4 1 effectiveness of the proposed hybrid approach as natural hazards such as flooding can hardly be entirely prevented it is critical to improve the predictive ability and mitigation methods to minimize their impacts on human life and socioeconomic aspects especially in developing countries where flood risk is more serious due to the lack of adequate flood proofing facilities therefore rapid and efficient flood susceptibility mapping becomes the first and key step in flood modeling and risk assessment in general various mechanism based flood models hec ras hand and mcda methods are widely used frameworks for flood susceptibility identification and resilient adaption development however these frameworks have several limitations 1 they are extremely data intensive and time consuming with regard to setting up models and identifying the decision makers preferences 2 the vast amount of data may not be available and 3 the weighting of variables is intensely subjective these limitations have been recognized in previous studies khosravi et al 2019 velasquez hester 2013 machine learning and data driven approaches are now being increasingly used to assess flood susceptibility and gain insights into the driving forces of flooding with the support of the ever increasing big dataset reichstein et al 2019 although many previous studies have pointed out that the rf model outperforms other machine learning methods such as svm ann alternating decision tree and naive bayes tree for flood susceptibility assessment few have utilized the full capability of the big geospatial datasets as only limited flood location points were used as the training dataset chen et al 2020 sadler et al 2018 woznicki et al 2019 zhao et al 2018b therefore to our knowledge the proposed hybrid modeling approach which integrates physical based models with the machine learning method can provide an unprecedented insight for both flood susceptibility mapping and flooding mechanism analysis several quantitative measures were applied in this study to ensure the reliability of the proposed hybrid model and diverse and widely used validation procedures were applied to evaluate the accuracy of this model the input data were extracted from a physical based hydrological model hec hms that was calibrated based on several rainstorms the average calibration and validation dcs were 0 86 and 0 85 respectively table 1 and fig a 5 previous studies however acquired flood inventory maps through field surveys and historical records which unavoidably caused uncertainties and errors in the following analyses chen et al 2020 costache et al 2020 mind je et al 2019 zhao et al 2018a in contrast the predictive ability and efficiency of the rf model were quantitatively evaluated using the overall accuracy 0 915 and auc 0 912 fig 10 and fig 11 indicating that the rf model has more potential for flood susceptibility assessment than the physical based flood models similar findings have been concluded in many comparison studies between the rf model and other models chen et al 2020 lee et al 2017 pahlavan rad et al 2020 sadler et al 2018 it is worth mentioning that the data driven and machine learning based rf model predicts according to the relationship between dependent and explanatory variables hence the resultant inundation area can be observed in any locations if the pre conditions are satisfied this feature is particularly useful when assessments are to be conducted in data sparse areas although the rf model produced a larger inundation area compared to the mechanism based models these overestimated flood points and areas that represent the potential flood risk zones especially when the water level rises and breaks dams and dikes to overflow onto the surroundings should be given more attention in general our proposed approach offers several advantages compared to previous studies first the proposed hybrid approach is a close coupled and transplantable method that could be extended to data sparse regions for flood susceptibility assessment second the spatially continuous flood inventory map can theoretically provide all possible combinations of flood inducing conditions which can satisfy the large data demand of the machine learning model fig 6 third the underlying driving mechanism of flooding was quantified instead of a descriptive analysis fig 9 4 2 importance and contribution of flood inducing factors the factors generating floods are relatively complex and their mechanisms are still being studied based on the results of this study we discovered that the geographical and hydromorphological factors such as twi and dtr greatly affected the spatial distribution of the inundation area fig 8 and fig 9 however land cover factors ndisi and ndvi related to the degree of human activities and urbanization had less impact on flooding china has witnessed rapid development since its economic reform however most of the infrastructure and activities such as drainage facilities road network construction and land reclamation from lakes are primarily located in urban areas furthermore owing to emerging issues such as increasing rate of urbanization drainage and flood proofing facilities in most cities of china have not been able to keep up such inadequate drainage finally results in more surface runoff during extreme precipitation and its accumulation in low lying areas zhou et al 2019 these imbalances and non regulated development impair the stochastic sampling process resulting in a highly skewed training dataset he et al 2019 yue et al 2017 another major finding which significantly distinguishes our study from previous studies is that the data driven method and rdpi proposed in this study can provide comprehensive understanding about the spatiotemporal dynamics of precipitation in this mountainous urban area precipitation showed limited influence in determining the flooded areas implying that the peak river flow at each tributary may arrive simultaneously downstream eventually causing riverine flooding even though no rainfall is observed in the vicinity of downstream similar findings have been emphasized by bui et al 2020 4 3 implications for flood management based on this study and relevant works a number of implications on flood susceptibility assessment and resilience can be of interest to different stakeholders such as communities industries and the government firstly and most significantly the proposed hybrid model can be used for evaluating various influencing factors such as the spatial patterns of hydromorphological and land cover types etc which can then be applied for flood forecasting taking into account the dynamic changes of these factors in the future secondly this method can be used in scenarios of other natural hazards such as landslides and earthquakes to determine the influence of related driving forces on hazard and for enhancing risk management especially in regions with sparse data thirdly flood inducing factors related to human activities and climate change are an important consideration for resilience planning and design as well as flood risk management lastly the combination of including interactions among these influencing factors derived from this hybrid approach can be further investigated for enhancing their synergies and or limiting their constraints to the integrated flood resilience management 4 4 limitations and future work although the hybrid approach proposed in this work achieved acceptable and comparable performance in flood susceptibility assessment the enormous computational demand and running time of the rf model are the major limitations hindering the application of this approach the running time significantly increases as the number of trees increases it reaches approximately 4 h when the number of trees is 2 000 this time consuming procedure can potentially impact the efficiency of this approach in flood susceptibility assessment therefore in the next step parallel computing technology such as the hadoop platform will be chosen as a feasible solution to improve the optimization of this approach 5 conclusions accurate and rapid flood susceptibility mapping is of great importance in hazard preparedness to mitigate potential damages to flood prone areas a hybrid method that coupled machine learning and physical based flood models offered new insights into flood susceptibility assessment and its driving mechanism in xinluo watershed in china several extreme rainstorms were used to set up a hydrological model hec hms and the average dc calibration and validation values were 0 86 and 0 85 respectively the continuous flood inventory map was derived from the two flood models hec ras and hand based on the extreme rainstorm event on 2019 06 11 the rf model showed efficient and comparable predictive ability with an overall accuracy of 0 915 and auc of 0 912 using 15 flood inducing factors including geographical hydromorphological meteorological and land cover factors the study of the importance of each flood inducing factor indicated that the geographical and hydromorphological factors had a greater effect on flooding compared to human activities urbanization and climate change the proposed method demonstrated its effectiveness in assessing and forecasting flood susceptibility and showed potential in terms of providing guidance to the stakeholders communities industries and government about emergency responses and integrated flood management declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge financial support from the national natural science foundation of china grant no 41661144032 grant no 41971231 we would like to thank the reviewers for valuable and constructive comments and suggestions appendix 
3215,flooding is one of the most destructive natural hazards that has caused catastrophic effects worldwide recently machine learning methods have become widespread in flood susceptibility assessments due to their efficiency and robustness however flood inventory data acquired from historical flooding records and field surveys in existing studies are sparse and not enough to develop accurate machine learning models thus we developed a hybrid approach that integrates hydrodynamic model hec hms ras rapid flood model height above the nearest drainage hand and machine learning model random forest rf for flood susceptibility assessment the proposed approach was then implemented in the xinluo watershed a flood prone mountainous catchment in china the results showed that the spatially continuous flood inventory map generated from hec hms ras model satisfies the big data requirements of the rf model and the proposed hybrid approach demonstrates the effectiveness and efficiency in flood susceptibility assessment with overall accuracy and area under the roc curve values of 0 915 and 0 912 respectively the geographical and hydromorphological factors had greater effects on riverine flooding with average contribution of 27 8 and 27 6 in comparison the average contribution of land cover and meteorological factors were 24 3 and 20 3 respectively the method proposed in this study is effective in assessing and forecasting flood susceptibility and can facilitate resilience planning as well as integrated flood management keywords flood susceptibility assessment hec hms ras hand influencing factors random forest data availability the authors do not have permission to share data 1 introduction flooding is one of the most devastating and deadly natural hazards worldwide causing enormous economic losses and death over the last few decades chapi et al 2017 chen et al 2020 khosravi et al 2019 the global temperature has risen by 2 c compared to that in the pre industrialization period leading to an increase in the frequency and intensity of precipitation it is estimated that more than 2 billion people will be affected by floods by 2050 ipcc 2019 siegert et al 2020 it is almost impossible to completely prevent the occurrence of floods and developing countries are highly vulnerable due to lack of adequate drainage facilities china is the largest and fastest growing developing country and its urbanization rate exceeded 60 in 2019 cai et al 2021 more than 200 cities in china have experienced flooding in the last decade according to the state flood control and drought relief headquarters of china zhang et al 2018a b hence flood susceptibility and driving mechanisms for flooding control in china must be determined flood susceptibility refers to the likelihood of flooding in a particular area based on a series of geo environmental conditions ahmadlou et al 2019 flood susceptibility assessment identifies potentially flood prone areas and evaluates the driving forces of flood it has played an essential role in flood management and hazard mitigation tang et al 2020 tehrany et al 2015 in previous studies various physical based flood models have been widely used to simulate and assess flood susceptibility alaghmand et al 2012 alfy 2016 renschler wang 2017 hec hms ras mike flood and swmm are prominent software that can simulate the inundation area and depth by calculating the flood routing progress in the channel reach using the saint venant s principle and the overland flood extent using the navier stokes equations brunner 2016 rossman 2015 however these traditional hydraulic models typically require complex input data and long calculation time because of their complicated model structure chen et al 2012 furthermore these flood models are not suitable for simulating the flood evolution in large scale watersheds with areas over 1 000 km2 afshari et al 2018 neelz pender 2013 therefore more efficient and effective methods are necessary to overcome these shortcomings of the traditional models a newly proposed low complexity and rapid flood mapping method based on hand model has been introduced recently maidment 2017 nobre et al 2016 the hand model is a normalized digital elevation model dem defined as the vertical distance from a hillslope surface cell to a respective outlet to the drainage cell i e the difference between cells that belong to a mutually connecting flowpath nobre et al 2011 the hand model has been widely used in different regions worldwide due to its calculation efficiency and simulation accuracy it has been considered the best indicator of stationary surface water distribution martinis et al 2015 olorunfemi et al 2020 rahmati et al 2018 sutanudjaja et al 2013 young nobre 2012 zheng et al 2018 liu et al 2016 successfully established a near real time flood inundation system that integrated the hand model and national weather service nws of the national oceanic and atmospheric administration noaa based on the 10 m us national elevation dataset ned liu et al 2016 maidment 2017 these studies show that the hand model is an efficient and flexible alternative to flood models to assess the flood susceptibility at multi scales however the hand model cannot provide hydrological data such as water depth and discharge in the reach which are critical for flood inundation and depth mapping therefore a hybrid of the hand model and hydrological model could be a feasible accurate and efficient solution for flood simulation the susceptibility of flooding at any location depends on its geomorphology land cover hydrometeorological condition and other flood inducing factors khosravi et al 2018 currently the multiple criteria decision analysis mcda and analytic hierarchy process ahp are the most commonly used methods for evaluating the flood inducing factors ozturk and kılıç 2011 papathoma köhle 2016 shadmehri toosi et al 2019 however when there are various flood inducing factors and large amount of data decision makers struggle to rate all the factors fairly leading to biased scores and weights this is one of the potential limitations of the mcda and ahp in analyzing flood inducing factors and flood management therefore a more objective evaluation method that can avoid human related bias is needed in weighing the flood inducing factors data driven or machine learning methods that can significantly reduce such bias have gained more attention and have been successfully applied to flood susceptibility assessments and flood inducing factor analyses munawar et al 2021 recently many studies have focused on flood susceptibility mapping and evaluation of flood inducing factors by using machine learning and geographic information systems gis costache et al 2020 shafizadeh moghadam et al 2018 these include support vector machine svm bafitlhile and li 2019 choubin et al 2019 artificial neural network ann carreau guinot 2021 costache et al 2020 and random forest rf chen et al 2020 woznicki et al 2019 among these methods the rf method was found to have a superior performance due to its ability to handle large datasets with correlated variables and the built in variable importance evaluation chen et al 2020 svetnik et al 2003a b wang et al 2015 woznicki et al 2019 zhao et al 2018a rf model is an ensemble supervised machine learning method that consists of multiple decision trees i e forest where each tree corresponds to a vote and the final rf model depends on the total votes breiman cutler 2001 although the rf model is one of the most efficient and widely used machine learning methods to identify patterns in big data some prerequisites must be met to create a more accurate prediction these prerequisites include a large volume of data and a variety of variables for the model training and importance evaluation however most previous studies have applied spatially sparse flood points and flooding inventory maps from field surveys or historical flood marks as the training dataset these insufficient data lead to sampling errors during the random training process in machine learning chen et al 2019 chen et al 2020 pham et al 2021 zhao et al 2018b therefore a spatially continuous and unbiased flooding dataset containing all the hydro geomorphological information is needed for the training and validation process xinluo is the upper sub watershed of the jiulong river watershed jrw which is the second largest in fujian province china it has an area of approximately 600 km2 and lies between 24 55 00 n 25 15 00 n and 116 45 00 e 117 05 00 e fig 1 subtropical monsoon is the dominant climate condition resulting in abundant rainfall especially during the wet season with an average annual rainfall of about 1600 mm as the headwater of jrw the xinluo sub watershed has more than 100 streams with a catchment area of 50 km2 in recent years the frequency and intensity trend of rainfall have increased under the impact of climate change leading to several severe storm related hazards for example the cumulative precipitation in the xinluo sub watershed reached 687 9 mm in june 2019 accounting for 30 of the total annual precipitation which was also the highest in all cities and regions in china cmdc 2020 in addition to extreme weather the complex terrain characterized by the mountainous area in the upstream and rapidly developing built up area downstream of the watershed are ideal for applying flood susceptibility assessment and flood inducing factor analysis the aims of this study are 1 to develop a hybrid flood susceptibility approach combining the hydrodynamic hec hms ras rapid flood hand and machine learning rf models and 2 to evaluate the impact of each flood inducing factor xinluo sub watershed is selected as the study area due to its frequent flooding records and diverse geomorphological features to realize an unbiased flood inducing factor analysis using machine learning methods we applied a random sampling method to the study area a total of 1 000 spatially random points were created fig 1 this feature is distinguishable from those in previous studies which mainly focused on the flooded area when analyzing flood inducing factors bui et al 2020 chen et al 2020 tehrany et al 2019 2 hybrid approach for flood susceptibility assessment the methodological workflow of this study is presented in fig 2 this hybrid approach mainly consists of three components 1 data preparation and processing including flood inducing factors and flood inventory map 2 training and validation of the rf model and 3 flood susceptibility mapping and importance analysis of each flood inducing factor the major procedures involved are described in the following sections 2 1 data preparation and processing the flood inventory map was acquired by integrating the hydrodynamic hec ras and rapid flood hand models based on the output of a calibrated hydrological model hec hms the detailed descriptions of these models are given as follows 2 1 1 hec hms ras model the hydrologic modeling system hec hms and center river analysis system hec ras were developed by the us army corps of engineers usace 2016 the hec hms is designed to simulate the complete hydrological processes of dendritic watershed systems in a user friendly interface this model can provide continuous hydrograph simulation over a long period or event based rainfall runoff process at an hourly interval the input data for setting up the hec hms model include dem rainfall discharge land use land cover and soil type in this study hourly precipitation data from 2010 to 2019 and corresponding hydrological data at the watershed outlet were collected to build and validate the hec hms model a total of eight flood inducing storms were selected and used to calibrate and validate the model the spatial distribution of precipitation and hydrological stations are shown in fig 1 the spatial input data to the hec hms model are shown in fig a 1 appendix a including the land use and land cover data of 2018 based on landsat images from the united states geological survey usgs fig a 1 a the soil types were collected from china soil science data center fig a 1 b cssdc 2020 a 10 m resolution dem was used to characterize the boundary of the sub basin based on the d8 algorithm and 16 sub basins were delineated fig a 1 c the topographic parameters of each sub basin are listed in table a 1 the spatial distribution of the curve number cn was derived based on the soil conservation service cn scs cn method fig a 1 d and the average cn for each sub basin was summarized in table a 2 in general the calculated hydrographs of the hec hms model can serve as boundary conditions in hydraulic models such as hec ras brunner 2016 the hec ras is an integrated system of software designed for interactive use in a multi tasking environment it can perform one dimensional and two dimensional hydraulic calculations for an entire network of natural and constructed channels based on steady and unsteady flow computational methods more details about the hec ras model can be obtained from the studies of ben khalfallah saidi 2018 brunner 2016 and knebl et al 2005 in this study we used the hec hms model to generate hydrographs that reflect the rainfall runoff process for each of the eight rainstorms and the corresponding observed discharge data were used to calibrate and validate the model the hydrograph produced by the most severe rainstorm event i e june 2019 served as the input data to reconstruct the riverine flood inventory map 2 1 2 hand model executing the hec ras model however requires substantial spatial details e g channel cross section and optimum parameter values which are often unavailable accordingly the model needs considerable setup and computation time especially at the watershed scale afshari et al 2018 kauffeldt et al 2016 driven by such constraints we used the hand model a novel fast computing low complexity inundation mapping model with simplified input requirements and process representations to simulate the flooding extent at the upstream of the watershed liu et al 2016 maidment 2017 nobre et al 2016 the hand is a drainage normalized model that computes the differences in elevation between each grid cell and the elevations of the flow path connected downslope grid cells where the flow enters the channel nobre et al 2016 there are two sets of procedures to create the hand model using dem fig 3 the first procedure is to condition the original dem fix sinks identify the flowpaths and select the threshold for calculating an accumulation area as recommended in previous studies one tenth of the total watershed area was used as the accumulation threshold that represents a drainage system in this study o callaghan mark 1984 tarboton 1997 the second procedure includes the following 1 using flow directions and stream networks to generate the nearest drainage points map 2 assigning the elevation of each drainage point to the corresponding grids in the same drainage system and 3 subtracting the elevation of the original dem by the revised dem fig 4 shows that the hand model is relatively flat compared to the original dem this is the key feature to distinguish the hand model from other rapid flood models which are based on the absolute height above sea level resulting in the simulated floods concentrated in low lying areas teng et al 2015 although the hand model can simulate flood inundation in a large area streamflow is required as the input data for the inundation modeling in this study the hand model was coupled with the hec hms model that can provide the input streamflow data the peak flow value in the june 2019 event was used as the input data for the hand model to simulate the extent of flooding at the upstream of the watershed the inundation area of the whole watershed based on the hand and hec ras models was utilized as the input training and validation dataset for the machine learning rf model 2 1 3 flood inducing factors in general the risk of flood hazard is subject to changes in physical topography and meteorological conditions selecting the flood inducing factors depends on data availability and specific location conditions in this study 15 flood inducing factors were selected according to previous studies and data availability these factors can be broadly categorized as geographical hydromorphological land cover and meteorological factors ahmadlou et al 2019 chapi et al 2017 chen et al 2020 khosravi et al 2018 wang et al 2015 because the flood movement is significantly affected by the physical terrain geography forms a key factor in identifying the severity and extent of flooding fantin cruz et al 2011 woodrow et al 2016 flat and low lying areas receive more runoff within a short period thus slope is critical in hydrological calculations kia et al 2012 aspect is another useful factor in flood analysis which accounts for the level of rainfall incurred due to its impact on precipitation and sunshine levels abubakar et al 2012 profile and planar curvatures can influence the water movement at the vertical and horizontal levels respectively topographic position index tpi and topographic roughness index tri are two morphological factors highly associated with flooding werner et al 2005 tpi is the average difference in elevation of the target cell and adjacent cells whereas the tri is the average squared difference a floodplain may be affected by the roughness elements such as surface variation and land cover the topographic wetness index twi also has considerable impact on flooding which indicates the tendency of water to move downward due to the gravitational force it can be used to quantify the topographical effect on hydrological processes lee et al 2017 thus slope fig 5 a aspect fig 5 b profile curvature fig 5 c planar curvature fig 5 d tpi fig 5 e tri fig 5 f and twi fig 5 g were used as the geographical factors associated with flooding in most cases the spatial distribution of hydromorphological indicators is significant to understanding the potential flooding process because flooding occurs along the riverside distance to the river dtr is an important factor in mapping flood susceptibility glenn et al 2012 khosravi et al 2018 flow accumulation indicates the total amount of accumulated water received from upstream at a location stream power index spi and stream transportation index sti indicate the erosive and transport capacity of overland flow at a given point on the surface moore grayson 1991 the stream order classifies the type of stream based on its tributaries the stream order increases with increasing number of upstream tributaries resulting in more susceptibility to flooding tarboton et al 1991 therefore the dtr fig 5 h flow accumulation fig 5 i spi fig 5 j sti fig 5 k and stream order fig 5 l were selected as the hydromorphological indicators land use and land cover lulc types are also important factors for flood susceptibility assessment brath et al 2006 normalized difference vegetation index ndvi fig 5 m and normalized difference impervious surface index ndisi fig 5 n were calculated using different bands of landsat 8 oli satellite images collected from the usgs eros data center usgs 2020 ndvi is often used for the early detection of water stress providing information on both the spatial distribution of water stress on vegetation and its temporal evolution over long periods of time there is a negative correlation between vegetation density and flood occurrences and thus ndvi is an influencing factor in flood analysis tehrany et al 2015 ndisi is a lulc factor used to identify areas that are prone to inundation by analyzing the spatial distribution of impervious surfaces high ndisi values are correlated with built up areas that decrease the infiltration capacity of the terrain musse et al 2018 zhang et al 2018a b ndvi and ndisi were calculated based on landsat images on july 27th 2019 given the biased and incomplete meteorological data used in previous studies for assessing the flood susceptibility bui et al 2020 chapi et al 2017 mind je et al 2019 shafizadeh moghadam et al 2018 tang et al 2020 zhao et al 2018b this study for the first time proposed a new rainfall dynamic pattern index rdpi fig 5 o based on high spatiotemporal resolution radar rainfall dataset 1 km spatial resolution at 1 h time interval the method used to derive rdpi mainly consists of three steps 1 getis ord gi a local clustering analysis method is used to statistically identify the hot and cold spots of precipitation areas at each time slice of the radar images getis and ord 2010 ord and getis 1995 the hot cold spots of precipitation areas will have a high low gi value and be surrounded by other grids with high low gi values 2 the mann kendall trend test is then used to analyze the trend of the gi value in each column the mann kendall trend test is a non parametric test which means it works for all distributions the null hypothesis for this test is that there is no monotonic trend in the series and the alternate hypothesis is that a trend exists 3 the spatiotemporal dynamic patterns of precipitation for each column are then identified according to the trend characteristics arcgis pro 2019 to simplify the research these patterns are reclassified into three major types hot spots at different significance level cold spots at different significance level and no pattern detected this data driven method and rdpi can provide a comprehensive understanding of the spatiotemporal dynamics of precipitation not only in the static data frame but also in the entire time series more details of this method are discussed by fang et al 2020 2 2 flood susceptibility assessment using rf rf is an ensemble machine learning method that uses numerous classifications and regression trees carts to make a decision breiman cutler 2001 the rf model trains each cart on bootstrap resamples of the total dataset unlike rf the traditional cart method uses all dataset features which normally leads to overfitting and multicollinearity issues murphy 2012 the rf model randomly selects features to split each node instead of using all the features in the training process rules based on response variables are developed to divide explanatory variables until the resulting predictions have a minimum amount of node impurity the impurity is the sum of the squared deviations between the predicted and actual value loh 2011 in this study the training and validation datasets were generated using 1 flood inducing factors and 2 flood inventory map which were provided by the hand and hec ras models we randomly created 1 000 points in the study area as sampling points to reflect all possible combinations of flood inducing conditions 50 of which were located in flooded areas while the remaining 50 were located in non flooded areas the spatial distribution of these random points is shown in fig 1 this is a remarkable improvement compared to previous studies which only used the flooded area as the input dataset for machine learning models the continuous flood inventory map from the hec ras and hand models can provide a large unbiased dataset for the training and validation procedures of the rf model hyperparameters define the characteristics of the model that can impact the accuracy and computational efficiency the ratio of points used for training and testing number of iterations and number of trees are the most important hyperparameters in the rf model breiman cutler 2001 svetnik et al 2003a b all points in the flooded and non flooded areas were randomly sampled according to a certain ratio in each iteration of the machine learning process such ratio decides the percentage of points used for training and testing procedures in this study the number of iterations and ratio were set to 10 000 and 70 respectively which means that 700 points were randomly selected and used for the training process whereas the remaining 300 points were used for cross validation using the out of bag oob error method for each iteration the above process was repeated 10 000 times to obtain the final result the number of trees was decided by the trial and error method and the optimal results are shown in section 3 1 the oob score is computed as the number of correctly predicted rows from the oob sample with bootstrapping each of the remaining samples had an oob score that could be used to test the accuracy of each tree the random selection of flood inducing factors and response variables in the training of the individual classification trees created various weak learners thus avoiding the over fitting issue the accuracy of the rf model can be obtained by averaging the accuracy of each tree with their oob error as follows 1 e oob 1 n i 1 n y i y i 2 where n is the total number of oob samples y i is the observed output of oob samples and y i is the rf output that corresponds to the oob input factors aside from its predictive capability the rf model can be used to evaluate the importance of each variable based on its built in gini importance method this indicator measures how the gini impurity decreases when a variable is chosen to split a node the gini decrease across every tree of the forest is accumulated every time that variable is chosen to split a node then the sum is divided by the number of trees in the forest to derive the final gini importance the rf model can learn and record the gini importance of the input variables in the training and predicting procedures chen et al 2020 2 3 accuracy assessment quantitative criteria were used to evaluate the accuracy of the models a reasonable output from the hec hms model is critical in this analysis however several parameters cannot be estimated directly from field measurements and uncertainty always exists in the parameter values the amplification of this uncertainty in the modeling parameters and structure can result in unreliable models therefore sensitivity analysis is used to quantify the relative impact of various sources of uncertainty on the output variables allowing the decision makers to assess and identify the input parameters with the greatest impact on the model output the univariate gradient ug search algorithm was selected to calibrate and optimize the parameters of the hec hms model this method increases or decreases a parameter value by 5 in every iteration while keeping other variables unchanged usace 2016 several hydrological and hydrodynamic parameters including initial losses cn scs lag base flow recession constant peak ratio muskingum k and muskingum x were chosen as the target sensitive parameters for example the initial losses represent interception and depression storage the cn controls the excess runoff from precipitation which is a function of cumulative precipitation soil cover land use and antecedent moisture and the muskingum k and muskingum x decide the travel time of the flood wave when solving the routing equation the resultant effects of the sensitivity analysis were quantified using discharge volume peak discharge and peak time castro maidment 2020 halwatura najim 2013 usace 2016 the relative error in peak discharge rep relative error in total discharge volume req peak time error δt and determination coefficient dc were used to evaluate the agreement of the observed and simulated hydrographs of the hec hms for both calibration and validation processes the calculation equations are given as follows 2 re p p s p o p o 100 where p s is the simulated peak flow and p o is the observed peak flow 3 re q q s q o q o 100 where q s is the simulated total discharge and q o is the observed total discharge 4 δ t t s t o where t s is the simulated peak flow time and t o is the actual observed peak flow time 5 dc 1 i 1 n q s i q o i 2 i 1 n q s i q o 2 where q o i is the observed discharge for each time step i q s i is the simulated value at time step i q o is the mean observed discharge and n is the total number of values within the time period results from the flood models were evaluated using the receiver operating characteristic roc curve which is considered as the standard technique to validate the general performance of the flood models pham et al 2021 tehrany et al 2019 the roc curve is graphed with the x axis as 1 specificity and y axis as sensitivity specificity is the proportion of non flood pixels correctly classified as non flood whereas sensitivity is the proportion of flood pixels correctly classified as flood the roc curve shows the trade off between sensitivity and specificity models that give curves closer to the top left corner indicate a better performance this means that the top left corner of the plot is the ideal point though this is not very realistic as a baseline a random model is expected to give points lying along the diagonal the area under the roc curve auc is a quantitative index for identifying the general performance of the flood models higher auc indicates better model performance and ranges from 0 5 for inaccurate models to 1 for perfect models bui et al 2019 bui et al 2020 these indices were calculated as 6 s e n s i t i v i t y tp tp f n 7 s p e c i f i c i t y tn fp t n 8 auc t p t n p n 9 accuracy tp t n tp t n f p f n where true positive tp represents the number of pixels that were correctly classified as flood true negative tn represents the number of pixels that were correctly classified as non flood false positive fp and false negative fn indicate the number of pixels that were incorrectly classified as flood and non flood respectively 3 results 3 1 performance of the hybrid approach optimizations and performance examinations were applied to the models of the hybrid approach first sensitivity analysis was applied to the hec hms hydrological model based on the ug method the average effect of each target parameter on the response variables is shown in fig a 2 the variation of each parameter with peak discharge and discharge volume are shown in fig a 3 and fig a 4 respectively these figures show that cn scs lag and muskingum k are the most sensitive parameters that need close attention in the calibration process of the hec hms model second the hec hms model was calibrated and validated using eight flood inducing rainstorm events from 2010 to 2019 four of which were used for calibration and the remaining four for validation the detailed observed and simulated hydrographs of different rainstorm events are plotted in fig a 5 the calibration and validation performance is listed in table 1 the results showed that all the simulated and observed peak discharges occurred on the same day and the maximum peak time error was 1 h all dc values of the different rainstorms were above 0 8 except for the 2015 08 31 event because there had been a long period of drought until this storm and therefore making the simulated discharge overestimated the rep and req were less than 15 in the calibration phase and less than 20 in the validation phase in general these statistical measures indicate that a highly satisfactory rainfall runoff prediction with relatively small errors was achieved and the performance of the hec hms flood model was acceptable the calibrated model was thereafter used to inverse peak discharge and its evolution process induced by the most severe rainstorm event 2019 06 11 to provide the input data for the flood models the flood inventory map of the whole watershed was then reconstructed by coupling the hec ras downstream and hand upstream as shown in fig 6 it is worth noting that for a long return or extreme fluvial flooding event the inundation area will definitely cover that of short return e g the inundation area of a 200 year flood is larger than that of 50 year flood therefore the inundation area produced by 2019 06 11 storm can provide big enough training dataset for the machine learning model for the number of trees 12 trial and error iterations were applied to optimize this hyperparameter to improve the predictive performance of the rf model the detailed configuration and running efficiency of the number of trees from 2 to 2000 are listed in table 2 the model accuracy of the training and validation periods are shown in fig 7 these results indicated that the running time significantly increased with an increase in the number of trees however the accuracies of training and validation stabilized at 0 99 and 0 89 respectively when the number of trees exceeded 200 therefore the value of the number of trees was set to 200 for cost effective consideration 3 2 flood susceptibility assessment based on the proposed hybrid approach the flood susceptibility map was successfully generated using the spatially distributed flood inducing factors as shown in fig 8 this inundation map produced by the rf model showed a performance comparable to that of the traditional flood models fig 6 demonstrating the efficiency of the rf model for flood susceptibility mapping especially in ungauged regions with sparse data the resulting flood susceptibility map simulated by the rf model indicated a robust spatial correlation with several flood inducing factors such as twi fig 5 g and dtr fig 5 h in contrast several factors showed lower flooding effectiveness such as aspect fig 5 b and stream order fig 5 l to quantify the importance and contribution of each factor on flooding the gini coefficients were used to further examine the importance of each flood inducing factor and the results are shown in fig 9 it can be indicated that geographical factors significantly influenced the occurrence of flood hazards with an overall contribution rate of 48 followed by hydromorphological land cover and meteorological factors with contribution rates of 34 12 and 5 respectively among these indicators land cover factors including ndisi and ndvi were ranked in the middle indicating that geographical and hydromorphological features had a greater effect on flooding compared to human activities and urbanization precipitation however had limited influence in determining the flooded areas riverine flooding is normally driven by extreme or long term precipitation occurring in the upstream of catchment and the peak river flow at each tributary may arrive simultaneously at the downstream river that will eventually cause riverine flooding even though no rainfall is observed in the vicinity of downstream in addition only one precipitation index was used for the machine learning model which significantly weakened the weight of this index compared to that of the other three categories 3 3 inter comparison and validation of flood susceptibility map a set of different random points was created 1 000 points in order to evaluate the predictive performance of the rf model compared with the flood inventory map produced by the mechanism model using the same rainstorm event 2019 06 11 the inter comparison of models for inundation extent is shown in fig 10 it can be seen that the rf model produced a larger inundation area compared to the mechanism based models however these overestimated flood points and areas are the potential flood risk zones especially when the water level rises and breaks dams and dikes to overflow onto the surrounding banks shores and neighboring land nonetheless the spatial distribution of the inundation areas predicted by the rf model was highly conformable with that of the mechanism based models where the inundation areas were mainly distributed along the riverside and the confluence area downstream the tp fp tn and tp values were 6 79 855 and 60 respectively the sensitivity and 1 specificity of the rf model were 0 909 and 0 085 respectively which indicated that the rf model can achieve a high flood recognition rate while maintaining a low false alarm rate the overall accuracy of the rf model was 0 915 and the auc was 0 912 fig 11 these indicators show that the machine learning based method can provide an effective and efficient alternative approach for flood susceptibility mapping based on the readily accessible flood inducing factors compared to the traditional mechanism based methods which are usually time consuming and data intensive for the flood susceptibility assessment in addition this feature is essential for ungauged areas dealing with the same issue 4 discussion 4 1 effectiveness of the proposed hybrid approach as natural hazards such as flooding can hardly be entirely prevented it is critical to improve the predictive ability and mitigation methods to minimize their impacts on human life and socioeconomic aspects especially in developing countries where flood risk is more serious due to the lack of adequate flood proofing facilities therefore rapid and efficient flood susceptibility mapping becomes the first and key step in flood modeling and risk assessment in general various mechanism based flood models hec ras hand and mcda methods are widely used frameworks for flood susceptibility identification and resilient adaption development however these frameworks have several limitations 1 they are extremely data intensive and time consuming with regard to setting up models and identifying the decision makers preferences 2 the vast amount of data may not be available and 3 the weighting of variables is intensely subjective these limitations have been recognized in previous studies khosravi et al 2019 velasquez hester 2013 machine learning and data driven approaches are now being increasingly used to assess flood susceptibility and gain insights into the driving forces of flooding with the support of the ever increasing big dataset reichstein et al 2019 although many previous studies have pointed out that the rf model outperforms other machine learning methods such as svm ann alternating decision tree and naive bayes tree for flood susceptibility assessment few have utilized the full capability of the big geospatial datasets as only limited flood location points were used as the training dataset chen et al 2020 sadler et al 2018 woznicki et al 2019 zhao et al 2018b therefore to our knowledge the proposed hybrid modeling approach which integrates physical based models with the machine learning method can provide an unprecedented insight for both flood susceptibility mapping and flooding mechanism analysis several quantitative measures were applied in this study to ensure the reliability of the proposed hybrid model and diverse and widely used validation procedures were applied to evaluate the accuracy of this model the input data were extracted from a physical based hydrological model hec hms that was calibrated based on several rainstorms the average calibration and validation dcs were 0 86 and 0 85 respectively table 1 and fig a 5 previous studies however acquired flood inventory maps through field surveys and historical records which unavoidably caused uncertainties and errors in the following analyses chen et al 2020 costache et al 2020 mind je et al 2019 zhao et al 2018a in contrast the predictive ability and efficiency of the rf model were quantitatively evaluated using the overall accuracy 0 915 and auc 0 912 fig 10 and fig 11 indicating that the rf model has more potential for flood susceptibility assessment than the physical based flood models similar findings have been concluded in many comparison studies between the rf model and other models chen et al 2020 lee et al 2017 pahlavan rad et al 2020 sadler et al 2018 it is worth mentioning that the data driven and machine learning based rf model predicts according to the relationship between dependent and explanatory variables hence the resultant inundation area can be observed in any locations if the pre conditions are satisfied this feature is particularly useful when assessments are to be conducted in data sparse areas although the rf model produced a larger inundation area compared to the mechanism based models these overestimated flood points and areas that represent the potential flood risk zones especially when the water level rises and breaks dams and dikes to overflow onto the surroundings should be given more attention in general our proposed approach offers several advantages compared to previous studies first the proposed hybrid approach is a close coupled and transplantable method that could be extended to data sparse regions for flood susceptibility assessment second the spatially continuous flood inventory map can theoretically provide all possible combinations of flood inducing conditions which can satisfy the large data demand of the machine learning model fig 6 third the underlying driving mechanism of flooding was quantified instead of a descriptive analysis fig 9 4 2 importance and contribution of flood inducing factors the factors generating floods are relatively complex and their mechanisms are still being studied based on the results of this study we discovered that the geographical and hydromorphological factors such as twi and dtr greatly affected the spatial distribution of the inundation area fig 8 and fig 9 however land cover factors ndisi and ndvi related to the degree of human activities and urbanization had less impact on flooding china has witnessed rapid development since its economic reform however most of the infrastructure and activities such as drainage facilities road network construction and land reclamation from lakes are primarily located in urban areas furthermore owing to emerging issues such as increasing rate of urbanization drainage and flood proofing facilities in most cities of china have not been able to keep up such inadequate drainage finally results in more surface runoff during extreme precipitation and its accumulation in low lying areas zhou et al 2019 these imbalances and non regulated development impair the stochastic sampling process resulting in a highly skewed training dataset he et al 2019 yue et al 2017 another major finding which significantly distinguishes our study from previous studies is that the data driven method and rdpi proposed in this study can provide comprehensive understanding about the spatiotemporal dynamics of precipitation in this mountainous urban area precipitation showed limited influence in determining the flooded areas implying that the peak river flow at each tributary may arrive simultaneously downstream eventually causing riverine flooding even though no rainfall is observed in the vicinity of downstream similar findings have been emphasized by bui et al 2020 4 3 implications for flood management based on this study and relevant works a number of implications on flood susceptibility assessment and resilience can be of interest to different stakeholders such as communities industries and the government firstly and most significantly the proposed hybrid model can be used for evaluating various influencing factors such as the spatial patterns of hydromorphological and land cover types etc which can then be applied for flood forecasting taking into account the dynamic changes of these factors in the future secondly this method can be used in scenarios of other natural hazards such as landslides and earthquakes to determine the influence of related driving forces on hazard and for enhancing risk management especially in regions with sparse data thirdly flood inducing factors related to human activities and climate change are an important consideration for resilience planning and design as well as flood risk management lastly the combination of including interactions among these influencing factors derived from this hybrid approach can be further investigated for enhancing their synergies and or limiting their constraints to the integrated flood resilience management 4 4 limitations and future work although the hybrid approach proposed in this work achieved acceptable and comparable performance in flood susceptibility assessment the enormous computational demand and running time of the rf model are the major limitations hindering the application of this approach the running time significantly increases as the number of trees increases it reaches approximately 4 h when the number of trees is 2 000 this time consuming procedure can potentially impact the efficiency of this approach in flood susceptibility assessment therefore in the next step parallel computing technology such as the hadoop platform will be chosen as a feasible solution to improve the optimization of this approach 5 conclusions accurate and rapid flood susceptibility mapping is of great importance in hazard preparedness to mitigate potential damages to flood prone areas a hybrid method that coupled machine learning and physical based flood models offered new insights into flood susceptibility assessment and its driving mechanism in xinluo watershed in china several extreme rainstorms were used to set up a hydrological model hec hms and the average dc calibration and validation values were 0 86 and 0 85 respectively the continuous flood inventory map was derived from the two flood models hec ras and hand based on the extreme rainstorm event on 2019 06 11 the rf model showed efficient and comparable predictive ability with an overall accuracy of 0 915 and auc of 0 912 using 15 flood inducing factors including geographical hydromorphological meteorological and land cover factors the study of the importance of each flood inducing factor indicated that the geographical and hydromorphological factors had a greater effect on flooding compared to human activities urbanization and climate change the proposed method demonstrated its effectiveness in assessing and forecasting flood susceptibility and showed potential in terms of providing guidance to the stakeholders communities industries and government about emergency responses and integrated flood management declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge financial support from the national natural science foundation of china grant no 41661144032 grant no 41971231 we would like to thank the reviewers for valuable and constructive comments and suggestions appendix 
3216,non point source nps pollution is an important factor affecting the quality of water environment in recent years a large number of online water quality monitoring stations have been used to obtain continuous time series water quality monitoring data these data provide the necessary basis for the application of deep learning methods in water quality prediction however the prediction accuracy of traditional deep learning methods is low especially in predicting the water quality with nps pollution aiming to address this limitation a novel deep learning model named sod vgg lstm with the simulation observation difference sod modular based on physical process the visual geometry vgg modular reflecting spatial characteristics and the long short term memory lstm modular based on deep learning method was developed to improve the accuracy of the water quality prediction with nps pollution the established model can overcome the problem that mechanism models can not predict the changes of water quality on the hourly or minute time scale the model was applied in lijiang river watershed experimental results indicated that the proposed model had the highest accuracy in the extreme value prediction compared with the mechanism model and lstm model the maximum relative errors between the predicted and observed results for do codmn nh3 n and tp were 8 47 19 76 24 1 and 35 4 respectively the model evaluation demonstrated thatthe established sod vgg lstm model achieved superior computational performance compared to auto regression integreate moving average model arima support vector regression model svr and recurrent neural network model rnn the evaluation results showed that sod vgg lstm achieved 3 2 39 3 higher r2 than arima svr and rnn the proposed model can provide a new method for water quality prediction with nps pollution keywords non point source pollution spatial characteristics lstm vgg data availability data will be made available on request 1 introduction non point source nps pollution is one of the important factors causing water quality deterioration dong et al 2018 xie et al 2018 accurate prediction of water quality changes caused by nps pollution is of great significance to regional water environment protection however nps pollution is characterized by randomness and uncertainty with complex transport process and mechanism huang et al 2016 zuo et al 2021 which lead to inconvenience in simulating and predicting water quality changes caused by nps pollution therefore it is imperative to develop an effective and accurate water quality prediction model to simulate and predict the change of water quality caused by nps pollution mechanism models based on physical process have been developed and used to predict water quality changes caused by nps pollution for many years paparrizos and maris 2017 such as swat soil water assessment tool hspf hydrological simulation program fortran and mike she mike system hydrological european models among them swat model might be the most popular and concerned model for water quality prediction with nps pollution at present but problems of complex structures redundant parameters and uncertain assumptions are difficult to ignore bahman et al 2018 hspf model required high precision data for areas with low precision data the error of prediction results was large liu and tong 2015 as a commercial software mikeshe did not support secondary development the assumptions in the model might have inestimable differences for different regions and were difficult to correct wan et al 2021a mechanism models for water quality prediction are usually constructed based on understanding the physical processes and factors the advantage of mechanism models is that parameters of those models have strict physical interpretation zhou et al 2021 but problems of difficulties in parameter calibration complex modeling structures uncertain model parameters and high calculation cost also limit their application in watershed water quality prediction additionally mechanism models are difficult to calibrate and often require high levels of expertise to implement moreover typical applications of mechanism models for close to real time or short time in water quality caused by nps pollution are limited senent aparicio et al 2019 compared with mechanism models deep learning models may be effective tools to overcome those limitations cui et al 2016 tiyasha et al 2020 zhang et al 2021a deep learning models can handle nonlinear and highly stochastic predictions through dynamically and adaptively correcting model elements which can effectively reduce the workload of modelers and different from mechanism models deep learning models just focus on the input output relationship without considering the causal relationship between parameters which can bring convenience to the modeling process for environmental managers therefore deep learning models may replace mechanism models to some extent and become effective tools for water quality prediction in the future methods based on the back propagation bp network and radial basis function rbf neural network could provide certain applicability in water quality prediction wang et al 2013 but the problem of insufficient training could not be ignored deng et al 2021 the hybrid model combined with mechanism model and artificial neural network ann was developed to improve the accuracy of water quality prediction but the model could not learn the state characteristics between time series data which could result in large errors in extreme value prediction navideh et al 2020 recently a new type neural network namely long short term memory lstm neural network that considered the long term dependence in time series data has been introduced into the field of water quality prediction to improve the accuracy of extreme value prediction nitzan et al 2021 jiang et al 2021 previous studies have shown that compared with traditional neural network models lstm model is more accurate and suitable for time series data prediction nitzan et al 2021 wan et al 2021b xu et al 2021 however lstm model cannot reflect the impact of spatial characteristics on nps pollution in study area fortunately the convolutional neural network cnn was developed and applied to extract spatial characteristics due to its strong image recognition performance krizhevsky et al 2017 shelhamer et al 2017 which can reflect the impact of spatial characteristics on nps prediction chen et al 2016 baek et al 2020 as a representative of cnn model the visual geometry group vgg model has stable performance and concise structure mcilwaine and rivas 2020 which can be an effective method to reflect the impact of spatial characteristics on nps pollution with deep learning methods these studies show the potential application of the hybrid model that couples mechanism model vgg model and lstm model in water quality prediction caused by nps pollution in the paper a hybrid deep learning model with the simulation observation difference sod modular the vgg modular and the lstm modular was developed to predict the water quality changes caused by nps pollution in watershed the developed model has the following innovations a a intelligent model coupling with deep learning and feature extraction methods was developed to reflect the impact of spatial features on water quality in the study area b a method to estimate the hourly water quality obtained by combining mechanism model and intelligent model was proposed and then verified by comparison with observation results in lijiang river watershed c the established method can improve the prediction accuracy of extreme value for water quality with coupling mechanism method and deep learning methods d the developed model was applied to lijiang river watershed and performed very well in water quality prediction 2 problem definition the change of water quality in watershed is the result of comprehensive actions of multiple factors such as spatial factors and meteorological factors wijesiri et al 2015 hu et al 2020 however traditional lstm models cannot reflect the impacts of spatial factors on water quality in watershed because lstm models do not have the ability to identify and extract spatial features of the watershed the research on coupling spatial features into deep learning models to predict water quality changes caused by nps pollution has not been carried out and faces some challenges huang and simon 2002 bahaa et al 2012 wan et al 2021b fortunately vgg methods can extract spatial features and reduce data dimension through convolution processes which brings opportunities to predict water quality changes caused by nps pollution by coupling spatial features into deep learning method hence a novel intelligent model based on lstm and vgg methods was developed to overcome those limitations for water quality prediction caused by nps pollution 3 research area and data collection the rapid development of planting industry and urbanization in the study area has affected the water quality of lijiang river research have shown that the total amount of cod and nh3 n entering lijiang river through runoff in yangshuo county alone has reached 12766 t a and 2553 t a xu et al 2010 the concentrations of no3 at the source of lijiang river was between 2 16 and 3 32 mg l while that of guilin raised to 14 35 mg l li et al 2019 the locations of study area and stations distribution along the lijiang river are shown in fig 1 the hybrid deep learning model coupling sod modular vgg modular and lstm modular was established to improve the accuracy of water quality prediction with nps pollutants in the paper there are 16 hydrometeorology and water quality monitoring stations in the study area data collected from monitoring stations include the hydrometeorology data and pollutant data hydrometeorology data include conductivity ec potential of hydrogen ph turbidity tb flow rate q water temperature wt and rainfall pcp pollutant data include total phosphorus tp chemical oxygen demand codmn ammonia nitrogen nh3 n and dissolved oxygen do spatial data includes land use vegetation and slope details are shown in table 1 the water quality of yangshuo station for next time steps was predicted based on the antecedent meteorological hydrological water quality data at neighboring 15 stations and spatial data in the study area the locations of these stations were shown in fig 1 these hourly data comprising 4 years from 2016 04 to 2019 12 were divided into training and testing sets chronological order each accounting for 80 and 20 of the total data respectively the training set was used to train the model parameters and testing set was employed to evaluate the model performance 4 methods 4 1 framework a hybrid deep learning model coupling with sod modular vgg modular and lstm modular was developed in the paper the model frame is shown in fig 2 including data collection part vgg feature extraction part pollutant transport and diffusion simulation part error correction part and result analysis part firstly the research data including spatial information hydrometeorology parameters and pollutant parameters were collected and pre processed secondly the vgg model was adopted to extract the spatial features of the watershed to generate the multi dimensional time series data with spatial features thirdly the spatial correlation of water quality monitoring stations was studied and multi source water diffusion model was built the difference between the simulated and observed results was used to construct the error sequence fourthly a hybrid deep learning model was developed to predict water quality changes caused by nps pollution finally using the root mean square error rmse mean absolute error mae and symmetric mean absolute percentage error smape as the evaluation parameters the model parameters are optimized through experiments the accuracy of the proposed model is verified through comparison with state of the art prediction models 4 2 feature extraction through vgg water quality changes are affected by spatial factors such as topography vegetation and slope and have a nonlinear trend the watershed considered in this study is dominated by planting and has high vegetation coverage river channels and distinct geographical features of the sub watershed the middle and northeastern regions of the watershed are flat the north and northwest regions are the origins of the main river channels which have alpine forest topography the other regions have typical karst topography in this study vgg model was used to determine the influence of spatial features on water quality through convolution processes the model includes 13 convolutional layers 3 fully connected layers and 5 pooling layers a 3 3 convolution kernel was adopted to extract image features by scanning the image matrix as shown in fig 3 the original matrix data image can be scanned through a fixed matrix convolution kernel to obtain image features simonyan and zisserman 2004 results in fig 3 indicated that the features of the original image could be extracted and the dimension of the image could be reduced by the convolution processes the general law can be summarized that the matrix dimension after convolution process is equal to the difference between the matrix dimension of image and the matrix dimension of convolution kernel plus 1 the convolution layer has a continuous 3 3 convolution kernel and a maximum pooling size of 2 2 in the convolutional layer the input of each layer denotes a small part of the output of the previous layer and the size of this small part is the same as the size of the convolution kernel the convolutional layer was used to analyze the small part of each upper layer to obtain more abstract spatial features the convolutional layer is defined by eq 1 the relu function is used as an activation function of this layer because it can effectively avoid the problem of gradient disappearance and accelerate the training process the relu function is defined by eq 2 1 x j l f i m j x j l 1 k i j l b j l 2 f x m a x 0 x in eqs 1 and 2 l represent the l th network layer m j represents the receptive field output by the previous layer b denotes the bias k is the convolutional layer and f is the nonlinear activation function in vgg model the pooling layers can reduce the size of the input feature to simplify the computational complexity of the neural network model the max pooling layer outputs the maximum value of the input features and it can be defined as 3 x j l f β j i p x j i 1 b j l where p is the pooling function and β is the weight the spatial remote sensing image can provide rich land attribute information as shown in fig 4 firstly the remote sensing data including land use vegetation and slope was collected from web secondly images of spatial features were converted into an image format of 224 224 3 and then features were extracted by vgg model finally the time series high dimensional features of spatial images were obtained in order to eliminate the influence of noise caused by high dimensional redundant features the principal component analysis was used to reduce the dimensions of high dimensional features to obtain multi dimensional spatial feature time series data combining these data with hydrometeorology data pollutant data and target pollutant error the input and output dataset of the hybrid deep learning model can be constructed 4 3 simulation observation difference for pollutant in the paper the mechanism model based on physical process was adopted to simulate the transport and diffusion process of pollutants in the watershed the physical based model is a modular structure model which consists of hydrological process sub module soil erosion sub module and pollution load sub module the model is mainly driven by the water balance equation which can be expressed as 4 s w t s w 0 i 1 t r d q surf e a w seep q gw where s w t represents the soil water content s w 0 represents the initial soil water content t is the time r d q surf e a w seep and q gw represent precipitation surface runoff evaporation permeation and underground water content respectively the study area was divided into 8 sub basins based on dem and measured river network the calibration and validation of the model followed the principle of first runoff followed by nutrients the runoff was calibrated and validated by the flow data of yangshuo hydrological monitoring station and the trend validation was carried out by the daily measured water quality data of the river in yangshuo some key parameters and processes of the mechanism model were not calibrated and corrected which could only ensure the accuracy of the model prediction trends the purpose of model calibration only needs to ensure the accuracy of model prediction trend based on the predicted results the simulation observation difference was used to stabilize the water quality time series to reduce the prediction error of extreme value 5 x diff s t v t t 1 n where n is the length of data series s t and v t are the data record at time t for the simulation results and the observation results respectively x diff is the first order difference based on s t and v t and will be used as the output for the established model the error time series of the pollutant at the target station is obtained through x diff 4 4 error correlation through lstm long short term memory model was used to predict the pollutant error at the next moment based on hydrometeorology indexes pollutants indexes spatial features indexes and target pollutant errors in the past few moments the rolling prediction scheme was used in this scheme all indexes in the prediction window were used to predict pollutant error in the next moment this process was repeated until the error prediction of the target pollutant is complete in the simulation the target pollutant error sequence was assumed to be e the hydrometeorology parameters were h h 1 h 2 h n other pollutant indexes were p p 1 p 2 p n and the spatial feature indexed were set as s s 1 s 2 s n in the proposed model the input matrix was x x 1 x 2 x n as shown in eq 6 the target sequence was e e 1 e 2 e n as shown in eq 7 where f x denoted the training function of the lstm neural network the training process of lstm model was defined by eqs 6 and 7 in the model the size of the rolling window was l the input and output of the model were respectively defined by eqs 8 and 9 6 x x 1 x 2 x n e 1 e 2 e n h 1 h 2 h n p 1 s 1 p 2 s 2 p n s n 7 e e 1 e 2 e n f x f x 1 x 2 x 2 x 3 x l x l 1 x n l 1 x n l 2 x n 8 x t x t x t 1 x t l 1 t t 1 2 n l 1 9 e t f x t x t 1 x t l 1 t 1 2 n l 1 the error series of water quality between simulated and monitored values based on mechanism model the time series of spatial features extracted by vgg model and hydrological and water quality data of upstream monitoring stations were used as the output or input of lstm model to predict the pollutant concentration error of the river finally the actual water quality of the river was inversed by error series of pollutant concentration predict by lstm model and estimated values simulated by mechanism model the final model structure was shown in fig 5 4 5 model performance evaluation the accuracy and performance of the established sod vgg lstm model have been evaluated by a series of numerical tests in the paper firstly it was examined whether the proposed sod vgg lstm model could overcome the extreme value problem of deviating data effectively then the proposed model was compared with lstm model without considering the spatial watershed features finally the proposed method was compared with several state of the art prediction models namely the autoregressive moving average model arima based on statistical theory the support vector regression model svr based on traditional machine learning and the traditional neural network model rnn model based on deep learning the evaluation indexes included rmse mae and smape which indicated the deviation of the model prediction results from the true values the evaluation indexes rmse mae and smape were expressed as follows 10 rmse y y 1 n i 1 n y i y i 2 11 mae y y 1 n i 1 n y i y i 12 smape y y 1 n i 1 n y i y i y i y i 2 where n denotes the total number of samples y i is the observed value and y i is the corresponding predicted value 5 results and analysis 5 1 network parameters super parameters control the network structure of the lstm model yan et al 2019 which determines the simulation results in this paper super parameters mainly included time step and neurons time step represents the length of the past data used in the prediction as the prediction process progresses these time step values slide along the time axis in the sliding window finally reaching the end of the dataset xu et al 2022 neurons in lstm model represent the complexity and learning ability of the established model in water quality prediction values of super parameters affect the performance and accuracy of the established model therefore the sensitivity analysis setting of supper parameters needs to be evaluated by changing values of super parameters the performance of the model was optimized by setting super parameters as shown in table 2 the number of neurons was selected from the set of 16 32 64 128 256 the test results showed that the performance of the model increased firstly and then decreased with the increase of the number of neurons the test results indicated that the model accuracy was the highest when the number of hidden neurons was 64 the time step values which denoted the length of the time series required for prediction was selected from the set of 4 8 12 16 20 the model achieved the best prediction performance for the time step of 12 thus the data of the past 12 h were used to predict the concentration of pollutants at the next moment in the paper 5 2 spatial feature extraction visual geometry group method was adopt to extract the spatial feature and reduce the dimension of the input remote sensing image in this way the high dimensional data could be characterized as multi dimensional spatial feature time series data which would be used as the feature expression vectors of image data remote sensing data from january 2018 july 2018 and january 2019 were used to demonstrate the effectiveness of the established vgg model in this part the data before and after dimensionality reduction were shown in fig 6 it could be observed that before dimensionality reduction the original data including land use vegetation and slope was scattered and complex and the amount of data was large after dimensionality reduction the spatial features of remote sensing image could be extracted and the extracted data were separated which greatly reduced the complexity of calculation and the identification error caused by redundant information more importantly through dimensionality reduction complex remote sensing images could be transformed into simple multi dimensional vectors which could be directly coupled with deep learning method to realize water quality prediction with considering spatial feature 5 3 prediction performance for water quality the indicators of water quality do codmn nh3 n and tp were selected as performance evaluation indicators of the established sod vgg lstm model in this part the online monitoring data from april 2016 to march 2019 were used to train the model and the hourly values of do codmn nh3 n and tp concentration from april 2019 to december 2019 were predicted the input data were preprocessed before being put into the model the preprocessing included deleting the wrong and missing data and replacing those with the average daily values the 3σ principle was used to analyze and eliminate abnormal data in addition to improve the training speed and prediction accuracy of the model the z score standardization method was used to normalize the input dataset after training and convergence the optimal sod vgg lstm model was obtained to verify the prediction performance of the optimal model the test dataset was used for model evaluation the comparison between the predicted values obtained by the model and the corresponding observed values during the period from may 1 2019 to may 12 2019 was shown in fig 7 the maximum relative error of do codmn nh3 n and tp were 8 47 19 76 24 1 and 35 4 respectively the reason for the large prediction error of tp might be that some enterprises secretly emissions leakage emissions were not considered in the established model resulting in the sudden change of water quality 5 4 extreme values prediction when nps pollutants changes sharply under extreme meteorological conditions traditional deep learning methods are limited by historical data and cannot effectively predict extreme values while physical models can ensure that the predictions are within a controllable range to evaluate the prediction performance of the proposed model for extreme values sod vgg lstm was tested on the data that did not appear in the training dataset the prediction results were shown in fig 8 which showed the comparison of the predicted observed and calculated results of the extreme values for do codmn nh3 n and tp concentration within 30 d the prediction results showed that the maximum relative error between the predicted value and observed value were 6 07 11 6 22 1 and 23 9 obviously the established sod vgg lstm model achieved good prediction accuracy after coupling mechanism model in predicting the extreme values on a day scale previous studies have indicated that spatial characteristics influenced the transport and diffusion process of nps pollution in watershed but traditional deep learning methods neglected the influence of spatial characteristics on the transport diffusion process of nps pollution in this paper vgg method in the established sod vgg lstm model was used to extract spatial features of the study area to improve the prediction accuracy of the model fig 9 showed the comparison of the predication results for do codmn nh3 n and tp with 60 h obtained from sod vgg lstm model with spatial information and lstm model without spatial information the results of the maximum relative error between the predicted value and observed value for two models were presented in fig 9 the results showed that the predication accuracy of lstm model without considering spatial characteristics is lower than that of sod vgg lstm model 5 5 comparison with other models traditional models including arima svr rnn were used to verify the superiority and advancement of the established sod vgg lstm model in this part among them arima based on statistical theory is often used to predict time series which is a short term prediction method with high prediction accuracy an arima model is characterized by 3 terms p d q where p is the order of the ar term q is the order of the ma term d is the number of differencing required to make the time series stationary acf autocorrelation and pacf partial autocorrelation were adopted to determine the optimal parameters for models in the paper expressed as arima 2 1 2 for do arima 2 1 2 for codmn arima 5 1 5 for nh3 n and arima 5 1 2 for tp svr is a non linear regression approach that is based on statistical learning theory smola and schölkopf 2004 the foundation of this strategy is to transfer the original input space into a new hyperspace using a non linear transformation approach kernel functions penalty parameter c kernel function and kernel parameter σ are the main factors that affect the prediction accuracy of the svr model radial basis function rbf may be the best performing algorithm for svr models kooh et al 2022 penalty factors and kernel function parameters in the established svr models were 2 4 and 8 for do 1 2 and 3 for codmn nh3 n and tp respectively rnn is a feedforward neural network that can store past information in time series data by introducing state variables zhang et al 2021b the input of the hidden layer for rnn consists of two parts including the output of the network layer at a given time and the output of the hidden layer at the previous time the nodes of the hidden layer are connected to each other this can ensured that the output of the current hidden layer can be affected by the output of the previous layers therefore rnn model can deal with time series data well the optimal structure of rnn adopted in this study had three hidden layers with 30 neurons in each layer the results of rmse mae and smape for four models were presented in table 3 according to the statistics the proposed sod vgg lstm model achieved the best prediction results compared with other models among four state of the art prediction models arima was the worst based on all statistics compared with arima model svr model had a higher accuracy in water quality prediction but the prediction accuracy was still lower neural networks for processing sequence data including rnn and sod vgg lstm could help in improving the model performance results in table 3 reflected the stability and robustness of the established models the do codmn nh3 n and tp concentration predicted by different models including arima svr rnn and sod vgg lstm were showed in fig 10 among them arima and svr models could reflect the time varying trend of pollutants concentration in river but neither model had some shortcomings in extreme value predict this might be because arima model was based on sliding average and autoregression the predicted results of arima model were close to historical average arima might be more appropriate when the true value did not fluctuate very strongly svr model failed to consider the impact of time series data on prediction results the impact of the previous time on the next time which might result in a reduction in the accuracy of extreme value predicting in contrast rnn and sod vgg lstm models achieved good performance in water quality prediction sod vgg lstm model that coupled mechanistic model and spatial data had higher water quality prediction accuracy than rnn model the evaluation results showed that sod vgg lstm achieved 3 2 39 3 higher r2 than arima svr and rnn the established sod vgg lstm model in the paper could provide a new method for water quality prediction especially for water quality prediction affected by nps pollution 6 conclusions a hybrid deep learning model coupling with sod vgg and lstm modular was developed in the paper the training dataset was constructed by a set of time series data including hydrometeorological parameters pollutant parameters error sequence and spatial feature sequences the error sequence was calculated by the sod modular and the spatial feature was extracted by the vgg modular the error sequence of pollutant concentration was used as output of lstm for error and water quality prediction the established model could not only overcome the problem of extreme value prediction but also reflect the impact of spatial characteristics at different times or regions on water quality the performance of the established model was evaluated and compared with three state of the art prediction models arima svr and rnn models the indicators of do codmn nh3 n and tp were selected as performance evaluation indicators the rmse index of the established model were 0 261 0 088 0 017 and 0 005 respectively the results showed that the established sod vgg lstm model could predict the water quality change caused by nps pollution well sod vgg lstm model had higher accuracy than arima svr and rnn model in water quality prediction the evaluation results also showed that the established model could improve the prediction accuracy of the extreme value for water quality with coupling mechanism method and deep learning method the model framework proposed in this study can not only effectively solve the defect that traditional deep learning methods can not couple point and surface data but also overcome the problem that mechanism models can not predict the changes of hydrology or water quality on the hourly or minute time scale the model proposed in the study is an intelligent watershed water quality prediction model which can be the key link to solve the non point source pollution in the development stage of intelligent water conservancy also the proposed model can provide effective decision support for the control and risk management of the basin flood forecast in the future because the established model can provide timely and efficient early warning of the hydrological process the model proposed in this study has great application potential credit authorship contribution statement hang wan conceptualization methodology writing original draft rui xu validation formal analysis meng zhang data curation software yanpeng cai methodology formal analysis jian li validation software xia shen data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0403 the national natural science foundation of china 52009023 guangxi natural science foundation 2021jja170096 guangxi key research and development program ab21196063 guilin science and technology development program 20190213 1 
3216,non point source nps pollution is an important factor affecting the quality of water environment in recent years a large number of online water quality monitoring stations have been used to obtain continuous time series water quality monitoring data these data provide the necessary basis for the application of deep learning methods in water quality prediction however the prediction accuracy of traditional deep learning methods is low especially in predicting the water quality with nps pollution aiming to address this limitation a novel deep learning model named sod vgg lstm with the simulation observation difference sod modular based on physical process the visual geometry vgg modular reflecting spatial characteristics and the long short term memory lstm modular based on deep learning method was developed to improve the accuracy of the water quality prediction with nps pollution the established model can overcome the problem that mechanism models can not predict the changes of water quality on the hourly or minute time scale the model was applied in lijiang river watershed experimental results indicated that the proposed model had the highest accuracy in the extreme value prediction compared with the mechanism model and lstm model the maximum relative errors between the predicted and observed results for do codmn nh3 n and tp were 8 47 19 76 24 1 and 35 4 respectively the model evaluation demonstrated thatthe established sod vgg lstm model achieved superior computational performance compared to auto regression integreate moving average model arima support vector regression model svr and recurrent neural network model rnn the evaluation results showed that sod vgg lstm achieved 3 2 39 3 higher r2 than arima svr and rnn the proposed model can provide a new method for water quality prediction with nps pollution keywords non point source pollution spatial characteristics lstm vgg data availability data will be made available on request 1 introduction non point source nps pollution is one of the important factors causing water quality deterioration dong et al 2018 xie et al 2018 accurate prediction of water quality changes caused by nps pollution is of great significance to regional water environment protection however nps pollution is characterized by randomness and uncertainty with complex transport process and mechanism huang et al 2016 zuo et al 2021 which lead to inconvenience in simulating and predicting water quality changes caused by nps pollution therefore it is imperative to develop an effective and accurate water quality prediction model to simulate and predict the change of water quality caused by nps pollution mechanism models based on physical process have been developed and used to predict water quality changes caused by nps pollution for many years paparrizos and maris 2017 such as swat soil water assessment tool hspf hydrological simulation program fortran and mike she mike system hydrological european models among them swat model might be the most popular and concerned model for water quality prediction with nps pollution at present but problems of complex structures redundant parameters and uncertain assumptions are difficult to ignore bahman et al 2018 hspf model required high precision data for areas with low precision data the error of prediction results was large liu and tong 2015 as a commercial software mikeshe did not support secondary development the assumptions in the model might have inestimable differences for different regions and were difficult to correct wan et al 2021a mechanism models for water quality prediction are usually constructed based on understanding the physical processes and factors the advantage of mechanism models is that parameters of those models have strict physical interpretation zhou et al 2021 but problems of difficulties in parameter calibration complex modeling structures uncertain model parameters and high calculation cost also limit their application in watershed water quality prediction additionally mechanism models are difficult to calibrate and often require high levels of expertise to implement moreover typical applications of mechanism models for close to real time or short time in water quality caused by nps pollution are limited senent aparicio et al 2019 compared with mechanism models deep learning models may be effective tools to overcome those limitations cui et al 2016 tiyasha et al 2020 zhang et al 2021a deep learning models can handle nonlinear and highly stochastic predictions through dynamically and adaptively correcting model elements which can effectively reduce the workload of modelers and different from mechanism models deep learning models just focus on the input output relationship without considering the causal relationship between parameters which can bring convenience to the modeling process for environmental managers therefore deep learning models may replace mechanism models to some extent and become effective tools for water quality prediction in the future methods based on the back propagation bp network and radial basis function rbf neural network could provide certain applicability in water quality prediction wang et al 2013 but the problem of insufficient training could not be ignored deng et al 2021 the hybrid model combined with mechanism model and artificial neural network ann was developed to improve the accuracy of water quality prediction but the model could not learn the state characteristics between time series data which could result in large errors in extreme value prediction navideh et al 2020 recently a new type neural network namely long short term memory lstm neural network that considered the long term dependence in time series data has been introduced into the field of water quality prediction to improve the accuracy of extreme value prediction nitzan et al 2021 jiang et al 2021 previous studies have shown that compared with traditional neural network models lstm model is more accurate and suitable for time series data prediction nitzan et al 2021 wan et al 2021b xu et al 2021 however lstm model cannot reflect the impact of spatial characteristics on nps pollution in study area fortunately the convolutional neural network cnn was developed and applied to extract spatial characteristics due to its strong image recognition performance krizhevsky et al 2017 shelhamer et al 2017 which can reflect the impact of spatial characteristics on nps prediction chen et al 2016 baek et al 2020 as a representative of cnn model the visual geometry group vgg model has stable performance and concise structure mcilwaine and rivas 2020 which can be an effective method to reflect the impact of spatial characteristics on nps pollution with deep learning methods these studies show the potential application of the hybrid model that couples mechanism model vgg model and lstm model in water quality prediction caused by nps pollution in the paper a hybrid deep learning model with the simulation observation difference sod modular the vgg modular and the lstm modular was developed to predict the water quality changes caused by nps pollution in watershed the developed model has the following innovations a a intelligent model coupling with deep learning and feature extraction methods was developed to reflect the impact of spatial features on water quality in the study area b a method to estimate the hourly water quality obtained by combining mechanism model and intelligent model was proposed and then verified by comparison with observation results in lijiang river watershed c the established method can improve the prediction accuracy of extreme value for water quality with coupling mechanism method and deep learning methods d the developed model was applied to lijiang river watershed and performed very well in water quality prediction 2 problem definition the change of water quality in watershed is the result of comprehensive actions of multiple factors such as spatial factors and meteorological factors wijesiri et al 2015 hu et al 2020 however traditional lstm models cannot reflect the impacts of spatial factors on water quality in watershed because lstm models do not have the ability to identify and extract spatial features of the watershed the research on coupling spatial features into deep learning models to predict water quality changes caused by nps pollution has not been carried out and faces some challenges huang and simon 2002 bahaa et al 2012 wan et al 2021b fortunately vgg methods can extract spatial features and reduce data dimension through convolution processes which brings opportunities to predict water quality changes caused by nps pollution by coupling spatial features into deep learning method hence a novel intelligent model based on lstm and vgg methods was developed to overcome those limitations for water quality prediction caused by nps pollution 3 research area and data collection the rapid development of planting industry and urbanization in the study area has affected the water quality of lijiang river research have shown that the total amount of cod and nh3 n entering lijiang river through runoff in yangshuo county alone has reached 12766 t a and 2553 t a xu et al 2010 the concentrations of no3 at the source of lijiang river was between 2 16 and 3 32 mg l while that of guilin raised to 14 35 mg l li et al 2019 the locations of study area and stations distribution along the lijiang river are shown in fig 1 the hybrid deep learning model coupling sod modular vgg modular and lstm modular was established to improve the accuracy of water quality prediction with nps pollutants in the paper there are 16 hydrometeorology and water quality monitoring stations in the study area data collected from monitoring stations include the hydrometeorology data and pollutant data hydrometeorology data include conductivity ec potential of hydrogen ph turbidity tb flow rate q water temperature wt and rainfall pcp pollutant data include total phosphorus tp chemical oxygen demand codmn ammonia nitrogen nh3 n and dissolved oxygen do spatial data includes land use vegetation and slope details are shown in table 1 the water quality of yangshuo station for next time steps was predicted based on the antecedent meteorological hydrological water quality data at neighboring 15 stations and spatial data in the study area the locations of these stations were shown in fig 1 these hourly data comprising 4 years from 2016 04 to 2019 12 were divided into training and testing sets chronological order each accounting for 80 and 20 of the total data respectively the training set was used to train the model parameters and testing set was employed to evaluate the model performance 4 methods 4 1 framework a hybrid deep learning model coupling with sod modular vgg modular and lstm modular was developed in the paper the model frame is shown in fig 2 including data collection part vgg feature extraction part pollutant transport and diffusion simulation part error correction part and result analysis part firstly the research data including spatial information hydrometeorology parameters and pollutant parameters were collected and pre processed secondly the vgg model was adopted to extract the spatial features of the watershed to generate the multi dimensional time series data with spatial features thirdly the spatial correlation of water quality monitoring stations was studied and multi source water diffusion model was built the difference between the simulated and observed results was used to construct the error sequence fourthly a hybrid deep learning model was developed to predict water quality changes caused by nps pollution finally using the root mean square error rmse mean absolute error mae and symmetric mean absolute percentage error smape as the evaluation parameters the model parameters are optimized through experiments the accuracy of the proposed model is verified through comparison with state of the art prediction models 4 2 feature extraction through vgg water quality changes are affected by spatial factors such as topography vegetation and slope and have a nonlinear trend the watershed considered in this study is dominated by planting and has high vegetation coverage river channels and distinct geographical features of the sub watershed the middle and northeastern regions of the watershed are flat the north and northwest regions are the origins of the main river channels which have alpine forest topography the other regions have typical karst topography in this study vgg model was used to determine the influence of spatial features on water quality through convolution processes the model includes 13 convolutional layers 3 fully connected layers and 5 pooling layers a 3 3 convolution kernel was adopted to extract image features by scanning the image matrix as shown in fig 3 the original matrix data image can be scanned through a fixed matrix convolution kernel to obtain image features simonyan and zisserman 2004 results in fig 3 indicated that the features of the original image could be extracted and the dimension of the image could be reduced by the convolution processes the general law can be summarized that the matrix dimension after convolution process is equal to the difference between the matrix dimension of image and the matrix dimension of convolution kernel plus 1 the convolution layer has a continuous 3 3 convolution kernel and a maximum pooling size of 2 2 in the convolutional layer the input of each layer denotes a small part of the output of the previous layer and the size of this small part is the same as the size of the convolution kernel the convolutional layer was used to analyze the small part of each upper layer to obtain more abstract spatial features the convolutional layer is defined by eq 1 the relu function is used as an activation function of this layer because it can effectively avoid the problem of gradient disappearance and accelerate the training process the relu function is defined by eq 2 1 x j l f i m j x j l 1 k i j l b j l 2 f x m a x 0 x in eqs 1 and 2 l represent the l th network layer m j represents the receptive field output by the previous layer b denotes the bias k is the convolutional layer and f is the nonlinear activation function in vgg model the pooling layers can reduce the size of the input feature to simplify the computational complexity of the neural network model the max pooling layer outputs the maximum value of the input features and it can be defined as 3 x j l f β j i p x j i 1 b j l where p is the pooling function and β is the weight the spatial remote sensing image can provide rich land attribute information as shown in fig 4 firstly the remote sensing data including land use vegetation and slope was collected from web secondly images of spatial features were converted into an image format of 224 224 3 and then features were extracted by vgg model finally the time series high dimensional features of spatial images were obtained in order to eliminate the influence of noise caused by high dimensional redundant features the principal component analysis was used to reduce the dimensions of high dimensional features to obtain multi dimensional spatial feature time series data combining these data with hydrometeorology data pollutant data and target pollutant error the input and output dataset of the hybrid deep learning model can be constructed 4 3 simulation observation difference for pollutant in the paper the mechanism model based on physical process was adopted to simulate the transport and diffusion process of pollutants in the watershed the physical based model is a modular structure model which consists of hydrological process sub module soil erosion sub module and pollution load sub module the model is mainly driven by the water balance equation which can be expressed as 4 s w t s w 0 i 1 t r d q surf e a w seep q gw where s w t represents the soil water content s w 0 represents the initial soil water content t is the time r d q surf e a w seep and q gw represent precipitation surface runoff evaporation permeation and underground water content respectively the study area was divided into 8 sub basins based on dem and measured river network the calibration and validation of the model followed the principle of first runoff followed by nutrients the runoff was calibrated and validated by the flow data of yangshuo hydrological monitoring station and the trend validation was carried out by the daily measured water quality data of the river in yangshuo some key parameters and processes of the mechanism model were not calibrated and corrected which could only ensure the accuracy of the model prediction trends the purpose of model calibration only needs to ensure the accuracy of model prediction trend based on the predicted results the simulation observation difference was used to stabilize the water quality time series to reduce the prediction error of extreme value 5 x diff s t v t t 1 n where n is the length of data series s t and v t are the data record at time t for the simulation results and the observation results respectively x diff is the first order difference based on s t and v t and will be used as the output for the established model the error time series of the pollutant at the target station is obtained through x diff 4 4 error correlation through lstm long short term memory model was used to predict the pollutant error at the next moment based on hydrometeorology indexes pollutants indexes spatial features indexes and target pollutant errors in the past few moments the rolling prediction scheme was used in this scheme all indexes in the prediction window were used to predict pollutant error in the next moment this process was repeated until the error prediction of the target pollutant is complete in the simulation the target pollutant error sequence was assumed to be e the hydrometeorology parameters were h h 1 h 2 h n other pollutant indexes were p p 1 p 2 p n and the spatial feature indexed were set as s s 1 s 2 s n in the proposed model the input matrix was x x 1 x 2 x n as shown in eq 6 the target sequence was e e 1 e 2 e n as shown in eq 7 where f x denoted the training function of the lstm neural network the training process of lstm model was defined by eqs 6 and 7 in the model the size of the rolling window was l the input and output of the model were respectively defined by eqs 8 and 9 6 x x 1 x 2 x n e 1 e 2 e n h 1 h 2 h n p 1 s 1 p 2 s 2 p n s n 7 e e 1 e 2 e n f x f x 1 x 2 x 2 x 3 x l x l 1 x n l 1 x n l 2 x n 8 x t x t x t 1 x t l 1 t t 1 2 n l 1 9 e t f x t x t 1 x t l 1 t 1 2 n l 1 the error series of water quality between simulated and monitored values based on mechanism model the time series of spatial features extracted by vgg model and hydrological and water quality data of upstream monitoring stations were used as the output or input of lstm model to predict the pollutant concentration error of the river finally the actual water quality of the river was inversed by error series of pollutant concentration predict by lstm model and estimated values simulated by mechanism model the final model structure was shown in fig 5 4 5 model performance evaluation the accuracy and performance of the established sod vgg lstm model have been evaluated by a series of numerical tests in the paper firstly it was examined whether the proposed sod vgg lstm model could overcome the extreme value problem of deviating data effectively then the proposed model was compared with lstm model without considering the spatial watershed features finally the proposed method was compared with several state of the art prediction models namely the autoregressive moving average model arima based on statistical theory the support vector regression model svr based on traditional machine learning and the traditional neural network model rnn model based on deep learning the evaluation indexes included rmse mae and smape which indicated the deviation of the model prediction results from the true values the evaluation indexes rmse mae and smape were expressed as follows 10 rmse y y 1 n i 1 n y i y i 2 11 mae y y 1 n i 1 n y i y i 12 smape y y 1 n i 1 n y i y i y i y i 2 where n denotes the total number of samples y i is the observed value and y i is the corresponding predicted value 5 results and analysis 5 1 network parameters super parameters control the network structure of the lstm model yan et al 2019 which determines the simulation results in this paper super parameters mainly included time step and neurons time step represents the length of the past data used in the prediction as the prediction process progresses these time step values slide along the time axis in the sliding window finally reaching the end of the dataset xu et al 2022 neurons in lstm model represent the complexity and learning ability of the established model in water quality prediction values of super parameters affect the performance and accuracy of the established model therefore the sensitivity analysis setting of supper parameters needs to be evaluated by changing values of super parameters the performance of the model was optimized by setting super parameters as shown in table 2 the number of neurons was selected from the set of 16 32 64 128 256 the test results showed that the performance of the model increased firstly and then decreased with the increase of the number of neurons the test results indicated that the model accuracy was the highest when the number of hidden neurons was 64 the time step values which denoted the length of the time series required for prediction was selected from the set of 4 8 12 16 20 the model achieved the best prediction performance for the time step of 12 thus the data of the past 12 h were used to predict the concentration of pollutants at the next moment in the paper 5 2 spatial feature extraction visual geometry group method was adopt to extract the spatial feature and reduce the dimension of the input remote sensing image in this way the high dimensional data could be characterized as multi dimensional spatial feature time series data which would be used as the feature expression vectors of image data remote sensing data from january 2018 july 2018 and january 2019 were used to demonstrate the effectiveness of the established vgg model in this part the data before and after dimensionality reduction were shown in fig 6 it could be observed that before dimensionality reduction the original data including land use vegetation and slope was scattered and complex and the amount of data was large after dimensionality reduction the spatial features of remote sensing image could be extracted and the extracted data were separated which greatly reduced the complexity of calculation and the identification error caused by redundant information more importantly through dimensionality reduction complex remote sensing images could be transformed into simple multi dimensional vectors which could be directly coupled with deep learning method to realize water quality prediction with considering spatial feature 5 3 prediction performance for water quality the indicators of water quality do codmn nh3 n and tp were selected as performance evaluation indicators of the established sod vgg lstm model in this part the online monitoring data from april 2016 to march 2019 were used to train the model and the hourly values of do codmn nh3 n and tp concentration from april 2019 to december 2019 were predicted the input data were preprocessed before being put into the model the preprocessing included deleting the wrong and missing data and replacing those with the average daily values the 3σ principle was used to analyze and eliminate abnormal data in addition to improve the training speed and prediction accuracy of the model the z score standardization method was used to normalize the input dataset after training and convergence the optimal sod vgg lstm model was obtained to verify the prediction performance of the optimal model the test dataset was used for model evaluation the comparison between the predicted values obtained by the model and the corresponding observed values during the period from may 1 2019 to may 12 2019 was shown in fig 7 the maximum relative error of do codmn nh3 n and tp were 8 47 19 76 24 1 and 35 4 respectively the reason for the large prediction error of tp might be that some enterprises secretly emissions leakage emissions were not considered in the established model resulting in the sudden change of water quality 5 4 extreme values prediction when nps pollutants changes sharply under extreme meteorological conditions traditional deep learning methods are limited by historical data and cannot effectively predict extreme values while physical models can ensure that the predictions are within a controllable range to evaluate the prediction performance of the proposed model for extreme values sod vgg lstm was tested on the data that did not appear in the training dataset the prediction results were shown in fig 8 which showed the comparison of the predicted observed and calculated results of the extreme values for do codmn nh3 n and tp concentration within 30 d the prediction results showed that the maximum relative error between the predicted value and observed value were 6 07 11 6 22 1 and 23 9 obviously the established sod vgg lstm model achieved good prediction accuracy after coupling mechanism model in predicting the extreme values on a day scale previous studies have indicated that spatial characteristics influenced the transport and diffusion process of nps pollution in watershed but traditional deep learning methods neglected the influence of spatial characteristics on the transport diffusion process of nps pollution in this paper vgg method in the established sod vgg lstm model was used to extract spatial features of the study area to improve the prediction accuracy of the model fig 9 showed the comparison of the predication results for do codmn nh3 n and tp with 60 h obtained from sod vgg lstm model with spatial information and lstm model without spatial information the results of the maximum relative error between the predicted value and observed value for two models were presented in fig 9 the results showed that the predication accuracy of lstm model without considering spatial characteristics is lower than that of sod vgg lstm model 5 5 comparison with other models traditional models including arima svr rnn were used to verify the superiority and advancement of the established sod vgg lstm model in this part among them arima based on statistical theory is often used to predict time series which is a short term prediction method with high prediction accuracy an arima model is characterized by 3 terms p d q where p is the order of the ar term q is the order of the ma term d is the number of differencing required to make the time series stationary acf autocorrelation and pacf partial autocorrelation were adopted to determine the optimal parameters for models in the paper expressed as arima 2 1 2 for do arima 2 1 2 for codmn arima 5 1 5 for nh3 n and arima 5 1 2 for tp svr is a non linear regression approach that is based on statistical learning theory smola and schölkopf 2004 the foundation of this strategy is to transfer the original input space into a new hyperspace using a non linear transformation approach kernel functions penalty parameter c kernel function and kernel parameter σ are the main factors that affect the prediction accuracy of the svr model radial basis function rbf may be the best performing algorithm for svr models kooh et al 2022 penalty factors and kernel function parameters in the established svr models were 2 4 and 8 for do 1 2 and 3 for codmn nh3 n and tp respectively rnn is a feedforward neural network that can store past information in time series data by introducing state variables zhang et al 2021b the input of the hidden layer for rnn consists of two parts including the output of the network layer at a given time and the output of the hidden layer at the previous time the nodes of the hidden layer are connected to each other this can ensured that the output of the current hidden layer can be affected by the output of the previous layers therefore rnn model can deal with time series data well the optimal structure of rnn adopted in this study had three hidden layers with 30 neurons in each layer the results of rmse mae and smape for four models were presented in table 3 according to the statistics the proposed sod vgg lstm model achieved the best prediction results compared with other models among four state of the art prediction models arima was the worst based on all statistics compared with arima model svr model had a higher accuracy in water quality prediction but the prediction accuracy was still lower neural networks for processing sequence data including rnn and sod vgg lstm could help in improving the model performance results in table 3 reflected the stability and robustness of the established models the do codmn nh3 n and tp concentration predicted by different models including arima svr rnn and sod vgg lstm were showed in fig 10 among them arima and svr models could reflect the time varying trend of pollutants concentration in river but neither model had some shortcomings in extreme value predict this might be because arima model was based on sliding average and autoregression the predicted results of arima model were close to historical average arima might be more appropriate when the true value did not fluctuate very strongly svr model failed to consider the impact of time series data on prediction results the impact of the previous time on the next time which might result in a reduction in the accuracy of extreme value predicting in contrast rnn and sod vgg lstm models achieved good performance in water quality prediction sod vgg lstm model that coupled mechanistic model and spatial data had higher water quality prediction accuracy than rnn model the evaluation results showed that sod vgg lstm achieved 3 2 39 3 higher r2 than arima svr and rnn the established sod vgg lstm model in the paper could provide a new method for water quality prediction especially for water quality prediction affected by nps pollution 6 conclusions a hybrid deep learning model coupling with sod vgg and lstm modular was developed in the paper the training dataset was constructed by a set of time series data including hydrometeorological parameters pollutant parameters error sequence and spatial feature sequences the error sequence was calculated by the sod modular and the spatial feature was extracted by the vgg modular the error sequence of pollutant concentration was used as output of lstm for error and water quality prediction the established model could not only overcome the problem of extreme value prediction but also reflect the impact of spatial characteristics at different times or regions on water quality the performance of the established model was evaluated and compared with three state of the art prediction models arima svr and rnn models the indicators of do codmn nh3 n and tp were selected as performance evaluation indicators the rmse index of the established model were 0 261 0 088 0 017 and 0 005 respectively the results showed that the established sod vgg lstm model could predict the water quality change caused by nps pollution well sod vgg lstm model had higher accuracy than arima svr and rnn model in water quality prediction the evaluation results also showed that the established model could improve the prediction accuracy of the extreme value for water quality with coupling mechanism method and deep learning method the model framework proposed in this study can not only effectively solve the defect that traditional deep learning methods can not couple point and surface data but also overcome the problem that mechanism models can not predict the changes of hydrology or water quality on the hourly or minute time scale the model proposed in the study is an intelligent watershed water quality prediction model which can be the key link to solve the non point source pollution in the development stage of intelligent water conservancy also the proposed model can provide effective decision support for the control and risk management of the basin flood forecast in the future because the established model can provide timely and efficient early warning of the hydrological process the model proposed in this study has great application potential credit authorship contribution statement hang wan conceptualization methodology writing original draft rui xu validation formal analysis meng zhang data curation software yanpeng cai methodology formal analysis jian li validation software xia shen data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0403 the national natural science foundation of china 52009023 guangxi natural science foundation 2021jja170096 guangxi key research and development program ab21196063 guilin science and technology development program 20190213 1 
3217,the availability of freshwater is highly influenced by climate change extreme climate events and by anthropogenic use countries where a large part of the population depends on the agricultural sector such as south africa are strongly affected by changes in climate which emphasizes that water is an essential source for food production and drinking water to analyze changes in surface and subsurface water model simulations and in situ data are commonly used however both have limitations for example the models rely on potentially erroneous forcing data and insufficient process representations and the in situ data do not represent the larger scale weather and climate due to spatial and temporal heterogeneity this can be mitigated by assimilating remote sensed satellite data into models in this research we build a realistic picture of the water and its propagation measured between peak times from fluxes as precipitation to its way through the storages and its impact on vegetation at the 50 km scale by using observation based data the observations are derived from modis remote sensing and integrating grace total water storage anomaly twsa observations into a hydrological model via data assimilation our objective is to identify shortcomings in model simulations by confronting them with the synthesized observations moreover we demonstrate the importance of integrating observations into the models we base these comparisons on signatures or sub signals e g temporal lags and annual amplitudes that we derive via regression analysis principal component analysis sensitivity analysis and correlation analysis from the synthetic data and the model output our main results show that correlations and signatures in real observations are found weaker as compared to what is simulated in the model e g for the contribution of precipitation to groundwater lag times between precipitation and surface and groundwater storage peaks are observed to be longer than in the model the observed propagation of soil water from storages to vegetation is often shorter than in the model while for groundwater it is longer we believe our findings will be highly relevant for modelers the gained knowledge can be used to improve models in addition we feel our study underlines the potential of grace assimilation into hydrological models keywords grace data assimilation precipitation water storage vegetation signatures hydrological modeling remote sensing extreme climate events 1 introduction available water resources represent one of the most important factors to ensure food production and water supply for the population all over the world 884 million people of the global workforce 27 were employed in 2019 in the agricultural sector fao 2020 the water storages that are most relevant for these fields are the surface water soil moisture and groundwater soil moisture is known as the main driver for vegetation and its health it limits vegetation activity and serves as a direct water source for plants but the vegetation systems do not only depend on soil moisture but also have an increasing dependency on groundwater especially in semi arid or arid regions droughts for example 2015 2016 in south africa that we will investigate in our study were identified as factors with high influence on food security and can threaten people s livelihoods and their right to freshwater availability this illustrates that water storages and vegetation are strongly controlled by climate variability and change masipa 2017 thus the interaction between the water storages and vegetation plays a major role south africa is mainly represented by semi arid to arid areas especially in the west and north while some parts in the east are more humid e g beck et al 2018 there are ca 843 000 people directly working in the agricultural sector world bank 2021 thus being directly dependent on it a household based survey revealed that 6 8 million people experienced hunger in 2017 statistics south africa 2019 and an estimation for over 570 cities highlighted that cape town among other cities will experience a decline in freshwater availability by 2050 c40 cities 2018 therefore the management of water resources especially groundwater was identified in this country to require more attention because of its underevaluation and dependency on expertise for multiple scales e g münch and conrad 2007 knüppe 2011 a large number of studies used in situ surface water and water table depth or models to study very locally relations between storages and vegetation or indicators of vegetation as evapotranspiration et for example tree roots were identified to control the water table depth in specific floodplains of south africa e g dzikiti et al 2013 humphries et al 2011 such associations were also analyzed in other regions e g the heihe river in china zhang et al 2018 in new mexico kurc and small 2004 and in arizona cavanaugh et al 2011 hydrological models enabled to extend the very local analysis to a regional or even global scale e g in berg and sheffield 2019 global maps of summertime mean correlation between soil and et were derived for example they showed that for south africa correlations between 0 5 and 1 occurred which means et is soil moisture driven in situ data can be very limited in space and time and access can be restricted which complicates achieving findings for all climates representative of the study region furthermore model simulations involve high uncertainty because of assumptions and errors in the forcing data e g chen et al 2013 over the last decades more attention was paid to include remote sensing data in the analyses e g the satellite mission grace gravity recovery and climate experiment with the help of grace correlations between soil moisture and or total water storage anomalies twsa with vegetation data were determined for example for africa ndehedehe et al 2019 ugbaje and bishop 2020 where generally lags of one month for soil moisture and twsa with vegetation were found further studies applied a similar analysis to other regions for example in mainland australia a lag of one month was mostly identified for areas dominated by crops between soil moisture twsa and the normalized difference vegetation index ndvi in ukraine soil moisture and ndvi showed a maximum correlation of 0 68 ghazaryan et al 2016 and in east to west asia correlations between soil moisture and et were ranging from 0 14 to 0 94 depending on the deepness of the soil layer a few studies even examined relations on a global scale tao et al 2020 xie et al 2019 and identified e g twsa as a cause of vegetation greenness for more than 40 of the global vegetated areas using remote sensing data also has limitations soil moisture monitoring from space can only sense water in the upper soil layers but not in the effective root zone yang et al 2014 so far grace and its successor grace follow on are the only global satellite missions that are able to observe the sum of surface and sub surface water storages thus that observe groundwater storage variability however grace has a limited spatial resolution of about 300 km and can only sense the total amount of water changes as water column not the individual water storages for example ugbaje and bishop 2020 emphasized the need to partition the grace twsa into its sub compartments furthermore in many cases the remote sensing data is used for the analysis directly or to validate model results the coupling of model strengths with observations is needed e g levine et al 2016 and can be implemented by integrating grace observations into hydrological models through data assimilation e g zaitchik et al 2008 schumacher et al 2016 several studies assimilated grace twsa into hydrological models for example zaitchik et al 2008 girotto et al 2016 and li et al 2019 integrated the grace twsa into the catchment land surface model clsm on regional scales like the mississippi river basin in the united states or on the global scale however the clsm does not represent anthropogenic water use in contrast a global hydrological model that considers anthropogenic water use is the watergap hydrological model wghm schmied et al 2021 in previous work eicker et al 2014 schumacher et al 2016 and schumacher et al 2018 assimilated grace twsa into the wghm model and found improved realism when confronting to observations based on this framework we set up our data assimilation scheme used in this study to assimilate grace twsa for south africa in this study soil moisture surface water and groundwater derived from the grace assimilation are used together with vegetation indices from satellite remote sensing to obtain the time delayed correlation on the basis of real observation and to determine realistic signatures of the propagation of precipitation peaks through the water cycle these signatures begin with rain that recharges the water storages and eventually leads to vegetation mass increase which can be quantified via vegetation indices we argue that assimilating grace into a model can be viewed predominantly as a spatial and vertical downscaling of grace that is supported by physical relations in other words we consider the assimilation result as a synthesized data set we assimilate grace derived twsa for south africa into the wghm effectively pulling the model simulations closer to the grace observations our assumption here is that at large scale 50 km grace assimilating hydrological modeling provides a more realistic picture of groundwater and surface water evolution as compared to modeling only we then apply statistical methods and identify signatures e g temporal lags and annual amplitudes with the observation based data sets and later test the model according to the found signatures to identify these relations we extract sub signals and dominant modes from the model simulation and assimilation to empirically set water and vegetation variables in relation these variables include precipitation surface water soil moisture groundwater actual evapotranspiration aet and leaf area index lai we show in which regions correlations lags and sensitivities between observed water storages and vegetation are similar to those between the modeled storages and vegetation and in which regions or climate and vegetation regimes we find significant differences taken all together our analysis aims at confronting shortcomings in the model with synthesized observations we stress that our synthesized observations could be used to compare to any hydrological or land surface model 2 study area south africa south africa extends over an area of 1 2 million km2 and its population totals about 60 million the largest river basin is the orange river which rises in the drakensberg mountains in lesotho flowing westwards through south africa into the atlantic ocean at the border of namibia the ocean and the interior plateau lead to warm temperatures and dry weather with an average annual rainfall of 500 mm for the western cape most of the rainfall is falling in winter while the remaining area of the country is experiencing most of the rainfall in summer government communications gcis 2020 due to its specific climate characteristics and its location south africa s hydrology is affected by climate events for example the el niño southern oscillation enso is influencing the south african rainfall e g richard et al 2000 kane 2010 on a regular basis in the considered observation period strong dry el niño events occurred in 2015 2016 and moderate events in 2002 2003 and 2009 2010 the counterpart la niña led to strong wet events in 2007 2008 and 2010 2011 and a moderate event in 2011 2012 south africa was also frequently affected by extreme drought in the past for example 2003 2004 and 2015 can be found as drought years in the literature e g mussá et al 2015 guha sapir et al 2020 savanna is the dominant biome in the north fig 1 large parts in central and east are grassland the albany thicket woodland exists in the south in central and west there is low shrubland called nama karoo and the fynbos biome is in the south west of south africa according to mabhaudhi et al 2018 rainfed agriculture is mainly apparent in central east where grassland is the main vegetation while irrigated areas can be found for large parts of the fynbos biome and in the north and northeastern savanna a large part of the population depends directly or indirectly on the agricultural sector e g schreiner et al 2018 the main crops by harvest area are cereals maize oil crops soybeans and wheat fao 2021 3 data and models 3 1 grace the grace mission was a joint gravity satellite mission by the national aeronautics and space administration nasa and the german aerospace center deutsches zentrum für luft und raumfahrt dlr launched in march 2002 ended in october 2017 and consisted of a tandem constellation of two satellites flying in the same orbit continuous inter satellite range measurement with an accuracy of a few micrometers was implemented to observe gravity changes which can be post processed and converted to monthly gravity fields expressed via spherical harmonic coefficients level 2 level 2 solutions itshg 2018 of degree and order 96 are provided by tu graz and we post process them using several consecutive steps the lower degree coefficients were replaced by degree 1 and c20 coefficients by nasa jpl because grace measures them inaccurately swenson et al 2008 cheng et al 2011 the temporal mean for 2003 to 2016 is reduced from the geopotential coefficients and filtering with ddk3 anisotropic filter is applied to account for striping effects that occur due to the measurement constellation e g kusche 2007 kusche et al 2009 then the coefficients are transformed to total water storage anomalies twsa via spherical harmonic synthesis wahr et al 1998 to an 0 5 grid similar to the model resolution after the transformation the effect of glacial isostatic adjustment gia is removed to account for post glacial rebounding effects here a gia model is provided by nasa jpl a et al 2013 further we apply a full error propagation from spherical harmonic coefficients to gridded mass changes to be able to include the error information also into the assimilation framework see section 4 we note that at the south africa basin level grace spatially averaged time series derived from csr or gfz rl06 data products would differ only by an rms of about 1 5 mm from the itsg solutions we used here in other words our results are robust against the choice of the grace data set since the resolution of grace is much coarser than the model resolution grace data is typically aggregated or spatially averaged within the study regions schumacher et al 2016 showed that for higher spatial degrees e g 1 numerical problems appear during the assimilation thus we decided to apply aggregation to a spatial resolution of 4 hereinafter the 4 grace twsa monthly grids are then used as input for the data assimilation which means we assimilate them into the hydrological model 3 2 remote sensed vegetation indices for this study moderate resolution imaging spectroradiometer modis based actual evapotranspiration aet and leaf area index lai time series were extracted from modis c6 lai fpar product spanning from 2003 to 2016 aet is an important variable that characterizes the water fluxes from earth s surfaces and vegetation while lai characterizes the canopy of vegetation on the ground and is defined as the leaf area per unit ground e g huang et al 2015 the aet running et al 2017 data set was extracted from modis net evapotranspiration product which is derived using the concepts of penman monteith energy balance model based on several remotely sensed and meteorological reanalysis data sets ghazaryan et al 2020 the lai product myneni et al 2015 is an 8 day composite data set with a 500 m resolution which corresponds to the best pixel available during the 8 day period both data sets have been shown to be reliable and have been validated validation stage 2 for lai and 3 for aet and the accuracy of the products has been assessed over several locations and time periods sun et al 2013 abiodun et al 2018 mu et al 2007 li and xiao 2020 yan et al 2016 by using the quality assessment information of both data sets the pixels with reduced quality were masked out the 8 day time series were aggregated to monthly values by calculating the pixel wise mean for lai and sum for aet data finally the data sets were aggregated to 0 5 resolution using the median modis time series were accessed and pre processed using google earth engine gorelick et al 2017 3 3 watergap hydrology model and precipitation data the watergap hydrology model wghm schmied et al 2021 is a global hydrological model that simulates among other fields storages on a spatial resolution of 0 5 for this analysis we consider surface water storages sum of local lakes local wetlands global lakes global wetlands rivers and reservoirs soil moisture and groundwater the model was forced by precipitation temperature longwave radiation and shortwave radiation which are derived from the gswp3 era5 forcing data sets kim 2017 hersbach et al 2019 hersbach et al 2020 joint by homogenization lange 2019 lange 2020 we use the same precipitation fields also in section 6 1 for our analysis of the propagation of water starting from this observed flux in wghm vegetation types are mainly based on using static land cover classes and fluxes to derive vegetation indices the growth of the vegetation is simulated in the growing period to simulate monthly leaf area indices lai wghm uses a function of daily temperature and precipitation and then limits lai values to minimum and maximum values these minimum and maximum values are determined based on the static land cover classes deciduous plants fractions and factors for evergreen plants additionally wghm simulates the actual evapotranspiration aet which is used in this study as the second vegetation index the simulated aet is derived by adding up four different fluxes canopy evaporation snow sublimation actual evapotranspiration from soil and potential evaporation of open water surfaces they all have in common that they either use the priestly taylor method for its calculation or an adaption of this method finally the transpiration from irrigated surfaces is added to derive the total aet more computational details about lai and aet in wghm can be found in schmied et al 2014 and schmied et al 2021 fig 2 shows the maximum cross correlations and corresponding lags between remote sensed aet and aet simulated during an open loop run it is obvious that both are highly correlated in particular in the east of south africa but there are also regions where the two aet time series are less correlated mainly in the albany thicket this is also the region where we identify lags between remote sensed aet and modeled aet of about 4 or more months thus the aet simulation and observation do not only differ in magnitude they are shifted in time this finding underlines that compared to the observed aet the wghm does not perfectly simulate aet which was also shown in schmied et al 2014 who found that there can be unrealistic high positive and negative values of aet in some areas and in kaspar 2004 who found that evapotranspiration parameters and land cover attributes lead to major uncertainties in simulated river discharge anthropogenic water use is included in wghm via the groundwater surface water use gwswuse model which distinguishes between the amount of potential net surface water and groundwater abstraction in fig 3 the linear trends of these water uses for the time period 2003 to 2016 are visualized the west of south africa shows a region with slight negative groundwater use trends while for surface water negative use trends are rather localized in the south an increase in groundwater use is found in the south and for the surface water use in the west close to the border to namibia however with 0 05 0 05 mm per year the water use trends that are included in the model are still small and are probably underestimated as was shown in the past for example scanlon et al 2018 showed that modeled linear trends e g of the total water storage are underestimated while e g grace data show more realistic trends 4 data assimilation framework data assimilation seeks to merge modeling and observations by adjusting model states and model parameters in this work we use the ensemble kalman filter enkf evensen 1994 which is a filter algorithm for sequential data assimilation the enkf works via two steps first a prediction step and then an update step simulating the model states for one month represents the prediction x it is applied for each ensemble member k we use monthly simulations because we also use monthly grace observations the model states for a specific time step t depend on the model states of the previous time step x k t 1 model parameters p k and forcing data u k 1 x k t f x k t 1 u k t p k the prediction is then updated using the observation data y by weighting the difference between model prediction and observation the model prediction is incrementally updated by 2 x k t x k t k k t y k t a x k t where k k t is the kalman gain matrix and a is the observation operator that refers the observations to the simulations model uncertainty and data uncertainty are weighted via second moment statistics within k k t where the model uncertainty is represented via a suitably generated model ensemble more details about data assimilation using enkf can be found in e g evensen 2009 the specific enkf implementation for grace twsa assimilation was developed at the institute of geodesy and geoinformation at bonn university igg e g eicker et al 2014 schumacher et al 2016 schumacher et al 2018 but updated for this study by coupling wghm to the parallel data assimilation framework pdaf nerger and hiller 2013 to apply the data assimilation of grace twsa into wghm a framework is set up with different phases as follows first during an initialization phase we run the model from 1995 to 2000 then we produce 32 ensembles by disturbing the forcing data and model parameters to be able to build a representation of the model uncertainty which are used for the following spin up phase from 2001 to 2002 next we utilize the 32 ensemble members from the end of the spin up phase to produce two following runs from 2003 to 2016 1 an open loop ol simulation that represents the spread of monthly model predictions for each of the 32 ensembles from which we derive the ol ensemble mean and 2 an assimilative ensemble where the grace observations are merged into the model runs it is important to understand that the spatial resolution of the data assimilation output product corresponds to the model resolution i e 0 5 i e much denser as compared to the resolution of the grace data 4 however the reader should keep in mind that data assimilation is not independent from a model another caveat is that data assimilation cannot guarantee physical consistency e g budget closures but on the other hand this is also the case for remote sensing data sets due to the unavoidable presence of errors 5 methodology 5 1 extracting seasonality via a regression model in this section we separate sub signals of the different data sets for comparison via solving a regression problem similar as in phillips et al 2012 forootan et al 2016 here we separate the signal into a linear trend annual amplitudes and phases as well as semi annual amplitudes and phases we do not estimate trend rates accelerations since we found that the method could not clearly and meaningfully separate linear trend and constant acceleration in south africa due to the short time series the equation can then be written for each grid j as 3 x j t a 0 j a 1 j t t 0 b 1 j cos ω t b 2 j sin ω t c 1 j cos 2 ω t c 2 j sin 2 ω t where t is the time in years a 0 is a constant a 1 is the linear trend b 1 and b 2 represent the annual signal and c 1 and c 2 represent the semi annual signal the coefficients a 0 to c 2 are estimated using a least squares approach the annual amplitudes a and phases ϕ can be computed from the estimated seasonal coefficients 4 a j annual b 1 j 2 b 2 j 2 ϕ j annual arctan b 2 j b 1 j and similar for the amplitude and phase of the semi annual oscillation next in order to empirically quantify the temporal response of the various storages and the vegetation we relate amplitudes and phases to each other as exemplarily shown for precipitation and groundwater 5 a j p gw a j gw σ a gw a j p σ a p ϕ j p gw ϕ j gw ϕ j p where σ a gw σ a p represents the spatial standard deviation of previously estimated groundwater precipitation amplitudes we are aware that in wghm these factors depend on the model representation of processes and various model parameters such as the precipitation multiplier but they are not independent of the hydrological setting 5 2 principal component analysis another way of comparing data and model simulations is to look at the dominant modes of variability one of the most common methods is principal component analysis pca preisendorfer and mobley 1988 khandu et al 2016 khaki et al 2018 cerón et al 2020 the pca can also be seen as a reduction of dimensions it breaks down the original data into only a few dominant modes that represent the majority of the variability contained in the original data for example rangelova et al 2007 extracted the dominant modes for grace and hydrological models to explore hydrological signatures and li et al 2021 extracted the dominant modes to reconstruct grace twsa and fill data gaps here a signal x for example groundwater with n rows describing the number of months and m columns describing the number of grids is decomposed preisendorfer and mobley 1988 by 6 x pe t p xe where the columns of p contain the principal components pcs and the columns of e the eigenvectors i e the empirical orthogonal functions eofs the decomposition is performed via singular value decomposition pc has uncorrelated time series in columns thus it represents the temporal component of the mode whereas the eofs represent the spatial component here we normalize the unitless pcs while the eofs have the same unit as the data 7 pc i p i σ p i eof i σ p i e i where i represents the i th mode the eigenvalues λ can be used to compute the percentage contribution of the i th mode to the total variance by 8 η i 100 λ i 2 i 1 n λ i 2 the modes are sorted from highest mode 1 with pc1 and eof1 to lowest percentage contribution to the total variance 5 3 process model here we define an order one process model similar as in humphrey and gudmundsson 2019 with the purpose to relate water storage in a given month to previous water storage and precipitation this will be applied both to observed e g via data assimilation and simulated storages in the following the process model is defined via 9 s i t c i s i t 1 d i p i t where s i t and p i t are the storage and precipitation of the current month at grid i and s i t 1 is the storage in the previous month at grid i as storage input we consider either absolute values of surface water soil moisture or groundwater derived from the assimilation or model simulation we estimate the temporally stationary process coefficients c and d which are used in the following to describe the sensitivity of this particular storage compartment to previous storage and precipitation for example when we apply the process model to predict the precipitation groundwater dynamics the coefficient c describes how the groundwater of the current month is related to the previous month which is expressed with unitless coefficients the coefficient d then describes how the groundwater of the current month is related to same month precipitation this relation is additionally accompanied by specific units in this case the d coefficients are given per month because we need to refer a storage to a flux the same methodology can also be applied to describe vegetation indices v t 10 v i t e i v i t 1 f i s i t 6 results and discussion in the following first we will focus on comparing the observed with the simulated water propagation from the annual maximum of precipitation to the annual maximum of surface water soil moisture and groundwater section 6 1 second the focus is set on the further course of water from the storages to vegetation indices section 6 2 third nonseasonal signals are extracted and the full propagation from precipitation to vegetation is analyzed and compared in order to identify temporal relations during climate events and pitfalls in the modeling section 6 3 finally a region specific analysis uncovers more details for the five largest vegetation regimes in south africa section 6 4 6 1 precipitation water storage dynamics here we will quantify the dynamics of the link between precipitation and the replenishing of surface water storage soil moisture conditions and groundwater recharge first at the seasonal scale from observations and from model simulations with watergap we will identify and isolate the dominant spatial and temporal patterns using methods as outlined in section 5 annual amplitudes of precipitation relative to annual amplitudes of observed and modeled soil moisture surface water and groundwater are shown in eq 5 an amplitude factor lower than one suggests that the normalized storage amplitude appears lower as compared to the normalized amplitude of annual precipitation this means that the annual precipitation but not all of the precipitation partially recharges the soil moisture an amplitude factor of one indicates that normalized precipitation and storage amplitudes are equal thus the precipitation mainly recharges the storage a value higher than one indicates a larger normalized storage amplitude than normalized precipitation amplitude which suggests that the change in the storage is mainly forced by other fluxes than precipitation for brevity we will call this ratio in the following the precipitation storage factor fig 4 shows the precipitation storage factors for observed storages derived from assimilation as and open loop simulation ol for the observed soil moisture based on assimilation the factor is closer to one for most of the area especially for the interior of the region as compared to surface water and groundwater thus the soil moisture amplitudes are very similar to the amplitudes of precipitation in other words the precipitation mainly propagates to the soil moisture for the fynbos biome the factor is higher than two our explanation is that the biome has significantly denser vegetation see fig 1 which buffers the seasonal dynamics for example hamilton 2003 suggested reinstating vegetation cover in south texas to mitigate water loss in the soil during drought periods the amplitude relation of precipitation to observed surface water and groundwater is lower than what was found with soil moisture thus precipitation propagates to these storages but not in the same amount as to soil moisture we find that modeled soil moisture and surface water exhibit similar precipitation storage factors as compared to observations larger differences can be observed for the seasonal precipitation groundwater dynamics the precipitation groundwater factor based on simulations is much closer to one than the factor based on observation we suggest that the sensitivity of groundwater with respect to precipitation is too rigid in the model representation in order to investigate the duration that the precipitation storage dynamics require fig 4 displays the phase lags of the storage annual cycles with respect to precipitation for many regions we observe soil moisture i e assimilation dynamics are hardly lagging behind precipitation while at the south eastern coast and the indian ocean belt phase shifts of three to six months occur observed surface water show longer phase shifts to precipitation of mainly two to four months all over the country the largest phase shift can be found in observed groundwater with three to six months over most of the area of south africa very large phase shifts of six or more months are found in south west of south africa we find that observed soil moisture is similar to the model simulations the lags between precipitation and modeled surface water or groundwater are shorter than with the observations for about two months thus compared to the observations the model underestimates the duration of the dynamics the process model coefficients c and d section 5 3 are shown in fig 5 for the december march season we observe from the c coefficients top two rows in fig 5 that in the observations soil moisture in a given month is closely related to the previous month values of about 0 4 to 0 6 we notice that for the region surrounding cape town soil moisture is much less depending on the previous month the same region has an increased same month precipitation sensitivity coefficient d as compared to other regions in the observations surface water and groundwater show a much higher sensitivity towards previous month storage c than soil moisture at the same time the observations show that the sensitivity of soil moisture to same month precipitation d is higher than with surface water and groundwater this coincides with our findings on the relative amplitudes overall we identify high sensitivity of the storages to same month precipitation along the southern coast soil moisture in the fynbos biome soil moisture and groundwater and in the orange basin surface water the regions that are showing a higher sensitivity of soil moisture towards precipitation agree with the regions of irrigated areas as shown in mabhaudhi et al 2019 in the modeling the sensitivity of soil moisture towards the previous month c is slightly lower as compared to the observations which is also the case for the surface water this means that the model underestimates the sensitivity of soil moisture and surface water towards previous month storage furthermore in the modeling we notice a slightly higher sensitivity of soil moisture to same month precipitation d as compared to the observations especially in the northwest of south africa reversely the sensitivity of simulated groundwater to previous month precipitation is slightly lower than observed the sensitivity of surface water to precipitation d does not show a difference between model simulations so at this point we cannot clearly identify an under or overestimated of the storage sensitivity to precipitation in the model therefore we now shortly summarize our sensitivity results during the winter season june august fig a 1 we notice that in the modeling all storages are less sensitive to the previous month as compared to the observation the opposite is found for the sensitivity of the water storages to precipitation which means a higher sensitivity is observed using the model simulation than using observations thus the sensitivity of the storages to precipitation is generally higher modeled than it is observed except for groundwater in the winter months to corroborate the previous findings the maximum cross correlation moving 6 months window and the corresponding lags between precipitation and the storages observed and modeled are shown in fig 6 the cross correlations result in similar findings as previously made in the modeling the sensitivity of precipitation to the storages is found to be higher than in the observations since this was already analyzed and interpreted we concentrate on the analysis of the lags observed soil moisture shows no lags to precipitation over nearly the entire area of south africa except the indian ocean belt while we observe that surface water lags precipitation of about 1 to 3 months thus the precipitation immediately refills soil moisture and a few months later surface water after some time 3 to 6 months the precipitation also refills groundwater we suggest that the duration of precipitation to refill the surface water is longer than for soil moisture because the water takes some time in the routing process the water propagation to groundwater is even longer because the water needs to seep through different soil layers in the modeling we derive a similar duration for the precipitation soil moisture dynamics contrary for the precipitation propagating to surface water and groundwater it takes less time in the model simulations as compared to the observations this coincides with the analysis of relative phases where we also identified a shorter simulated duration for the precipitation storage contribution of water as it was observed to relate our correlation analysis to the seasonal cycle we apply pca and choose those modes of precipitation observed storages and simulated storages that most resemble the annual sub signal in fact we found for all variables that the first mode eof1 and pc1 represents the annual cycle table 1 shows the maximum cross correlation and corresponding lags between the annual modes pc1 of precipitation with the observed assimilation as or modeled open loop ol storages since the corresponding pcs only show the correct sign together with its spatial component eof we consider only absolute correlations in the model simulations we find higher correlations between the annual modes of precipitation and all storages as in the observations the part of precipitation that belongs to the seasonal cycle nearly directly propagated to the seasonal and simulated soil moisture cycle 0 months the duration for the precipitation surface water dynamics is shorter than simulated 2 months as it is observed 3 months similar findings are derived for groundwater simulated lags of 3 months observed lags of 4 months therefore and due to the previous results we find that the seasonal cycle is largely contributing to the identified simulation and observation discrepancies however a detailed analysis on non seasonal events section 6 3 will investigate whether the non seasonal part of the observations and simulation also differs in the same manner overall the different methods used in this section are consistent in their findings the model shows an overestimation of precipitation contributing to the water storages the observation based analyses show that the simulated time shift between precipitation and the storages is generally too short as compared to the observations 6 2 water storage vegetation dynamics now we focus our analysis on the further course of water through the water cycle namely the propagation of water stored in soil moisture surface water and groundwater that contributes to vegetation growth we aim to investigate temporal and spatial signatures of the storage vegetation dynamics by using the methods as outlined in section 5 we will compare observed storages via assimilation and vegetation indices via remote sensing against modeled via open loop storages and vegetation indices fig 7 shows amplitudes of observed via as and modeled via ol storages relative to observed via remote sensing and modeled via ol vegetation indices aet and lai see eq 5 respectively again for conciseness we define a storage vegetation factor similar to the precipitation storage factor a value lower than one indicates that the vegetation has lower normalized amplitudes compared to the normalized storage amplitudes this means that the storage contributes partially to the vegetation growth a value of one suggests that both are equal thus all of the stored water is leading to vegetation growth and a value higher than one indicates that the vegetation has higher normalized amplitudes as the normalized storage amplitudes this indicates that a change in vegetation can but does not need to be fully forced by the storage and can additionally be forced by other storage compartments than those integrated in the analyses or by fluxes in the observations first row for aet and third row for lai in fig 7 as expected the soil moisture vegetation dynamic is stronger storage vegetation factors close to 1 for most of the area of south africa except the indian ocean belt than with surface water and groundwater thus vegetation growth mainly depends on soil moisture nonetheless we notice that surface water and groundwater additionally impact the vegetation growth we find that the observed surface water vegetation dynamics are strongest along the orange river while we identify strong groundwater aet dynamics in the center from north to south which is decreasing towards the west the east shows relative amplitudes of 5 or higher this means that we cannot directly verify if the storage or any flux is leading to vegetation growth at this point in the modeling we find that for soil moisture and surface water a larger area shows storage vegetation factors higher than two as compared to the observations thus the model might either overestimate the contribution of soil moisture and surface water to the vegetation growth or other fluxes are more important for the vegetation growth for groundwater we cannot conclude if the model is under or overestimating in comparison to the observations but we find that the spatial extent between model and observation is different in order to investigate the duration that it takes for the water storages to propagate to the vegetation fig 8 shows phases of observed via as and modeled via ol storages relative to observed via remote sensing and modeled via ol vegetation indices aet and lai see eq 5 in the observations first row for aet and third row for lai of fig 8 the relative phases between soil moisture and aet show no or a very small phase shift of one or two months in the north and east of south africa which was also found in ugbaje and bishop 2020 and means that the vegetation starts growing shortly after the soil moisture is recharged at the indian ocean belt it takes 5 and towards the center up to 9 months for the vegetation to evapotranspirate the water in the soil similar to what was found with precipitation we observe a longer duration of the surface water and groundwater as compared to the soil moisture but we find this only for the north south and east in the west the soil moisture takes longer to contribute to aet as compared to surface water and groundwater generally similar conclusions can be drawn when analyzing the relative phases between the observed storages and lai but the regions slightly differ for example for lai the largest phase shift is not only found from the belt towards the inland but also in parts of albany thicket in the modeling the relative phases between storages and vegetation indices are not clearly longer or shorter than with the observations as was the case for the precipitation storage propagation for modeled soil moisture and surface water we identify shorter phase shifts to vegetation in the west as compared to the observation while for groundwater we find longer relative phases especially in the albany thicket this means that in the west of south africa the model might underestimate the time it takes for peak soil moisture and surface water availability to propagate to peak vegetation at the same time it overestimates the duration for groundwater to affect vegetation growth in the west in the following the process model coefficients e and f eq 10 for the dec march season are shown fig 9 to investigate the sensitivity of the aet to the previous month e or to same month storages f in the observations we notice that aet has the strongest sensitivity to its previous month first row when including groundwater in the process model we suggest that this is because the vegetation growth depends stronger on the water in the soil and surface water than on groundwater for the sensitivity of aet to same month soil moisture third row we observe that the north and east are more sensitive than the west the sensitivity of aet towards same month surface water is much more pronounced values higher than 1 0 kg m2 per mm as compared to soil moisture for example at the southeastern coast while the sensitivity towards groundwater is less pronounced than soil moisture here we find two regions that show medium sensitivity between 0 5 and 0 8 kg m2 per mm the north close to the border to botswana and the east close to the border to namibia where the orange river is routing in the modeling second and fourth rows we find a higher sensitivity of aet towards same month storages as compared to the observations thus the sensitivity of aet to the storages is overestimated in the model which was also found in schmied et al 2014 and confirms the previous results at the same time the model underestimates the sensitivity of aet to the previous month however this under and overestimation seem not to be as pronounced as it was found for the precipitation storage relation if we apply the same analysis for the winter months fig a 2 we derive very similar insights and conclusions nevertheless the spatial extent of the identified sensitivities changes partially and we overall find that during the winter months the sensitivity is decreased compared to the summer months observed and modeled coefficients we assume that this is due to the fact that south africa experiences a dry phase in winter the results for lai are attached to the appendix for completeness and mainly confirm the overestimation of the modeled storage vegetation dynamics that we found with aet figs a 3 and a 4 applying cross correlation analysis fig a 5 moving 6 months window between storages and vegetation indices observed and modeled confirms previous results and leads to similar conclusions as the regression model and the process model namely that the model overestimates the storage vegetation dynamics a deeper look into the corresponding lags is provided in fig 10 we identify no or small negative lags in the east of south africa between soil moisture and aet with the observations first row in the west we find negative lags of about 3 months which means aet is lagging soil moisture at the indian ocean belt aet is lagging soil moisture with about 6 months for surface water and groundwater we identify shorter lags ca 2 months in the west than with soil moisture this shows that in the west the water includes a temporal delay during its propagation from soil moisture peaks to surface water peaks and finally groundwater peaks but all water storages contribute to the vegetation growth this is different for the east where we identify positive lags for surface water about two months and groundwater 4 to 6 months so the storages are following aet thus in the east the vegetation growth is mainly influenced by water from soil moisture and reacts directly to that storage instead of reacting to surface and groundwater storages in the modeling we notice shorter lags between soil moisture and vegetation in the west than it was observed modeled water in the soil immediately evaporates thus the duration of the soil moisture aet dynamics is underestimated in the model the same region shows discrepancies between model and observations for surface water and groundwater we find positive lags between simulated surface water and groundwater instead of negative lags which were found with the observations this means that in the modeling the vegetation growth is mainly stimulated by soil moisture while in the observation surface water and groundwater follow vegetation growth and therefore do not contribute to it in turn this shows that the model does not correctly reflect the storage vegetation dynamics furthermore we identify an interesting spatial pattern close to the border of namibia with positive lags up to 6 months between modeled surface water groundwater and aet which is not shown in the observed data fig 3 provides a possible explanation this region shows positive surface water trends and negative groundwater use trends hence the model might experience restrictions in the simulation of surface and groundwater use in the following we extract the annual modes first modes extracted with pca of storages and vegetation indices to relate our correlation and lag analysis to the seasonal cycle table 2 shows the maximum cross correlation and corresponding lags between the first temporal modes pc1 of the observed via assimilation as and modeled via open loop ol storages with the observed via remote sensing and modeled via ol vegetation indices respectively in the modeling we identify a higher correlation of the storages to the vegetation indices as compared to the observations so the model overestimates the contribution of the seasonal cycle of the storages to the vegetation growth when considering the lags it is shown that for modeled groundwater and surface water the lags to the vegetation indices are all positive which means that first a change in vegetation occurs and 2 months later the surface water groundwater change is notified this confirms what we found in the lag analysis that included the full storage and vegetation signal we suggest that in the modeling the vegetation in south africa depends stronger on soil moisture than on surface and groundwater considering the observations we find that the duration of the storage vegetation dynamics in the seasonal cycle is longer than in the modeling thus the model underestimates the duration this cannot confirm what we found in the full signal lag analysis where we identified strong duration differences between east and west of south africa a reason for that might be that in the model simulations the non seasonal sub signal of the storage vegetation dynamic is not clearly underestimating as it is shown here with the seasonal dynamics all in all this section demonstrated that the model overestimates the amount of water that contributes to the vegetation growth we cannot clearly conclude if the model under or overestimates the duration of the process in general the analysis of the annual cycle showed an underestimation of the modeled duration for the storage vegetation dynamics as compared to the observations but other results containing the full signal showed strong differences between the east and west of south africa this emphasizes the need for a more detailed analysis on the non seasonal storage vegetation dynamics and a deeper look into the different vegetation regimes see section 6 4 however we consistently found that especially for the west of south africa surface water and groundwater are also found to contribute to the vegetation growth which in most cases was not simulated 6 3 non seasonal signals here we extract non seasonal extreme events like enso and droughts using the pca method as outlined in section 5 2 to better understand the precipitation storage vegetation dynamics during these events fig 11 refers to spatial eofs and temporal pcs derived from the observations that showed peaks in 2006 2007 and 2011 years are shaded in gray and thus are identified to show the enso events la niña events we exemplarily show the second mode of precipitation the fourth mode of groundwater the third mode of aet and the fifth mode of lai for comparison we add the modeled temporal modes that identified the enso events except for precipitation we find that the temporal mode pc2 of observed precipitation shows positive peaks in 2006 which is showing the first la niña event during our time period a few months later 1 2 months we notice the same event in the groundwater pc4 before the turn of the year 2006 2007 we find the first enso event in the aet and half a year later in lai this means that the 2006 la niña event propagates from precipitation to the groundwater and finally increases vegetation growth when we compare this to the model simulations we find that the vegetation indices model the 2006 2007 peak more than half a year earlier the enso is a strongly precipitation driven event thus the findings here show that the model underestimates the time it takes for the enso driven precipitation seeping through the storages to contribute to the vegetation growth spatially the corresponding eofs of the modes have in common that positive light blue patterns are shown for the west in the fynbos biome succulent karoo and albany thicket thus the la niña events mainly affects precipitation and its propagation thought the water cycle in the center towards the west of south africa the analysis of the precipitation storage vegetation dynamics during drought events is more complex than with the enso events in the observations a few temporal modes can be referred to the 2015 2016 drought fig 12 shows the identified modes of precipitation mode 4 groundwater mode 1 and aet mode 4 that include drought patterns for south africa s 2015 2016 drought years are shaded in gray in the observations for the comparison we also show the modes derived from the model simulations that include the drought pattern except for precipitation in the observations all pc time series indicate a decrease in the drought period the strongest impact of the drought on precipitation and aet is observed to occur in the region surrounding the orange river negative patterns however by comparing the results to the modeled temporal modes we cannot identify temporal delays some of the temporal modes also contain other components for example the annual cycle e g temporal mode of modeled groundwater which renders the interpretation difficult since the separation of the drought signature from the annual signal is not always possible additional example attached for observed groundwater fig a 6 it is not always obvious whether there are no temporal delays or whether they cannot be separated from other sub signals which then might reflect that the applied methodologies are limited in their application 6 4 region specific analysis in the previous sections we discovered that the findings are very region specific for example the southeastern coast with the fynbos biome or the coastal belt of the indian ocean differed in many cases from other regions since most of the spatial patterns coincided with the vegetation in fig 1 we aim to identify dominant signatures and correlations for the regimes each 0 5 grid cell will be assigned to a vegetation cluster defined by merging the polygons in fig 1 and we will study the five largest clusters albany thicket fynbos biome succulent karoo savanna and grassland we will start analyzing the signatures for the cluster for the precipitation storage dynamics and continue with the storage vegetation dynamics table 3 shows the annual phases of soil moisture surface water and groundwater relative to precipitation eq 5 within the five different clustered regions in the observations we find that not all regions show similar relative phases between precipitation and soil moisture for example soil moisture lags precipitation with a bit more than half a month 0 66 months in the savanna while in other regions soil moisture lags precipitation with 1 to 2 months e g 1 05 months for the grassland and 1 95 months for the fynbos biome the lags between precipitation and surface water groundwater are longer than those found with soil moisture for example in the fynbos biome we find that surface water lags precipitation with about 4 5 months and groundwater lags precipitation with about 6 months comparing the different regions we find that all observed storages have the shortest lags to precipitation in the savanna and in albany thicket in these two regions the climate is very dry and vegetation is very sparse and cannot decrease the duration of water propagation from soil to other compartments thus the short lags explain the immediate and fast propagation of precipitation to the different storages the fynbos biome and succulent karoo are widely covered with vegetation which explains that these two regions identify the longest phase lags for observed storages in most regions we notice slightly shorter phase lags in the modeling than in the observations for example the modeled surface water shows lags between one and two months to precipitation in all regions instead of 1 5 to 4 5 months as it was found in the observations this shows that the model underestimates the duration for precipitation replenishing the water storages additionally when we compare the lags for the modeled storages for the different regions it is not possible to separate the fynbos biome and succulent karoo as clearly as with the observed storages this suggests that the model cannot capture regional characteristics as well as observations table 4 show the phases of observed or modeled water storages relative to observed or modeled vegetation indices eq 5 we identify short lags of about 2 months between soil water and aet in the savanna and grassland using the observations while lags of 3 or more months are found in the fynbos biome succulent karoo and albany thicket e g 4 1 3 8 and 4 1 months with aet for surface water we notice lags of 4 to 5 months for all vegetation regimes which means that a specific vegetation regime has low impact on the surface water vegetation dynamics on the soil moisture vegetation dynamics the contribution of groundwater to vegetation growth shows the longest lags for example we find aet lags groundwater by 8 or more months for the savanna and grassland in the modeling the duration of soil moisture propagating to vegetation is often shorter as compared to the observations for example in the albany thicket we identify a lag of 2 7 months between simulated soil moisture and aet while the observed soil moisture and remote sensed aet are lagging with 4 months which underlines previous findings that the model underestimates the duration of the process the only exception is the grassland where we find that the model overestimates the duration as compared to the observations we discover similar conclusions for the lai in contrast we notice that the modeled duration of groundwater propagating to vegetation is longer than what we observe thus the model overestimates the duration an extreme example is found for the groundwater aet dynamics in the albany thicket where the simulated duration is 5 months longer than the observed duration for surface water the results are very different as compared to soil moisture and groundwater while the duration between simulated surface water and lai is in each vegetation regime shorter as compared to the observation we cannot clearly conclude an over or underestimation using aet the findings illustrate that the simulation generally underestimates the duration of the propagation of the soil moisture annual maximum to the vegetation annual maximum in most regions and overestimates the groundwater vegetation contribution however the findings for surface water cannot be generalized in the same way because the dynamics strongly depend on the vegetation 7 conclusion this study aimed to revise the propagation of water through the water cycle that is simulated in models by using observation based data sets namely grace data assimilation and remote sensing vegetation indices we used statistical methods to identify and relate dominant spatial and temporal signatures for the propagation from precipitation peaks to water storage peaks surface water soil moisture and groundwater that affect vegetation growth the applied methods were the multi linear regression for detecting annual amplitudes and phases relatively a process model for relating water storages to the previous month storages or to same month precipitation a principal component analysis for extracting dominant modes from the data sets and a correlation analysis to find relations and lags between the data sets or their sub signals of the data sets we found that the amount of precipitation replenishing the water storages is often overestimated in the watergap hydrological model furthermore the duration that is takes for the precipitation to affect the water storages is often shorter simulated than with the observation based data sets we also found an overestimation in the model for the amount of water from the water storages that affects the vegetation growth but the duration for this process was in most cases shorter simulated than observed for soil moisture while it was mainly longer simulated for groundwater compared to the observations this showed us that there are main differences in the storage vegetation dynamics depending on the considered storage and also depending on the regions that were analyzed therefore we were not able to set an overall statement if the duration of the storage vegetation dynamics is under or overestimated as it was possible for the precipitation storage dynamics in the first parts of this study we focused our analysis on the full signal and the seasonal cycle to discover events like the enso in 2006 2007 and 2011 and the 2015 2016 drought events we separated non seasonal sub signal from the observations and model simulations in the last parts of our study the observation based data sets revealed that the timing of the enso events in vegetation is modeled too early for drought events we could not identify a delay in a more detailed analysis we studied the differences between the data sets according to five different vegetation regions the albany thicket the fynbos biome the succulent karoo the savanna and the grassland for example we found that the fynbos biome and succulent karoo experienced the longest lags between precipitation and assimilated storages observations as compared to the other regions but it was not possible to find such strong differences between the regions using the model simulations this study highlighted important relations between different meteorological hydrological and vegetation variables which represent the propagation of water through the water cycle we generally found that these relations are underestimated or temporally shifted in a hydrological model modelers can use these quantitative findings to improve their models and adapt simulation strategies based on the vegetation regimes we could also show that it is highly relevant to include observations e g from remote sensing into the analysis and emphasize the need for assimilating grace observations into the models in fact the chosen approach identifying shortcomings in the simulation of precipitation storage vegetation signatures could be used to identify shortcomings in other hydrological models and thus a transferring of the applied scenario to other models would also be reasonable there are many possibilities to improve or to extend this study in the future the assimilation framework can spatially be extended to a global scale in the further analysis we will aim in achieving longer time series for example by including grace follow on data which is the successor mission of grace the framework will benefit from a temporal extension because their statistical methods gain stability with a higher number of observations furthermore a simultaneous calibration and data assimilation approach will enable direct adaption of model calibration parameters these improvements might provide new insights across climate regions climate and weather extremes are expected to increase in frequency and magnitude ipcc 2021 thus it will be even more relevant to be able to simulate these events in order to avoid socio economic damage to society author contribution hg and jk designed all computations of the data assimilation and hg carried them out ks contributed to the setup of the data assimilation framework gg and od provided the vegetation indicators hg prepared the manuscript with contributions from all authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge olga gassen engels for all her effort and contribution to the data assimilation framework and petra döll hannes müller schmied and sebastian ackermann for providing the watergap model and improving its interfaces for the data assimilation framework furthermore we would like to acknowledge christoph menz stephanie gleixner and stefan lange for preparing and providing the gswp3 era5 climate data set this work was supported by the german federal ministry of education and research bmbf in the framework of the globedrought project grant no 02wgr1457a and the german research foundation dfg in the framework of the research unit understanding the global freshwater system by combining geodetic and remote sensing information with modeling using a calibration data assimilation approach globalcda grant no ku 1207 26 1 appendix a results a 1 process model figs a 1 a 2 a 3 and a 4 a 2 correlations fig a 5 a 3 principal component analysis fig a 6 
3217,the availability of freshwater is highly influenced by climate change extreme climate events and by anthropogenic use countries where a large part of the population depends on the agricultural sector such as south africa are strongly affected by changes in climate which emphasizes that water is an essential source for food production and drinking water to analyze changes in surface and subsurface water model simulations and in situ data are commonly used however both have limitations for example the models rely on potentially erroneous forcing data and insufficient process representations and the in situ data do not represent the larger scale weather and climate due to spatial and temporal heterogeneity this can be mitigated by assimilating remote sensed satellite data into models in this research we build a realistic picture of the water and its propagation measured between peak times from fluxes as precipitation to its way through the storages and its impact on vegetation at the 50 km scale by using observation based data the observations are derived from modis remote sensing and integrating grace total water storage anomaly twsa observations into a hydrological model via data assimilation our objective is to identify shortcomings in model simulations by confronting them with the synthesized observations moreover we demonstrate the importance of integrating observations into the models we base these comparisons on signatures or sub signals e g temporal lags and annual amplitudes that we derive via regression analysis principal component analysis sensitivity analysis and correlation analysis from the synthetic data and the model output our main results show that correlations and signatures in real observations are found weaker as compared to what is simulated in the model e g for the contribution of precipitation to groundwater lag times between precipitation and surface and groundwater storage peaks are observed to be longer than in the model the observed propagation of soil water from storages to vegetation is often shorter than in the model while for groundwater it is longer we believe our findings will be highly relevant for modelers the gained knowledge can be used to improve models in addition we feel our study underlines the potential of grace assimilation into hydrological models keywords grace data assimilation precipitation water storage vegetation signatures hydrological modeling remote sensing extreme climate events 1 introduction available water resources represent one of the most important factors to ensure food production and water supply for the population all over the world 884 million people of the global workforce 27 were employed in 2019 in the agricultural sector fao 2020 the water storages that are most relevant for these fields are the surface water soil moisture and groundwater soil moisture is known as the main driver for vegetation and its health it limits vegetation activity and serves as a direct water source for plants but the vegetation systems do not only depend on soil moisture but also have an increasing dependency on groundwater especially in semi arid or arid regions droughts for example 2015 2016 in south africa that we will investigate in our study were identified as factors with high influence on food security and can threaten people s livelihoods and their right to freshwater availability this illustrates that water storages and vegetation are strongly controlled by climate variability and change masipa 2017 thus the interaction between the water storages and vegetation plays a major role south africa is mainly represented by semi arid to arid areas especially in the west and north while some parts in the east are more humid e g beck et al 2018 there are ca 843 000 people directly working in the agricultural sector world bank 2021 thus being directly dependent on it a household based survey revealed that 6 8 million people experienced hunger in 2017 statistics south africa 2019 and an estimation for over 570 cities highlighted that cape town among other cities will experience a decline in freshwater availability by 2050 c40 cities 2018 therefore the management of water resources especially groundwater was identified in this country to require more attention because of its underevaluation and dependency on expertise for multiple scales e g münch and conrad 2007 knüppe 2011 a large number of studies used in situ surface water and water table depth or models to study very locally relations between storages and vegetation or indicators of vegetation as evapotranspiration et for example tree roots were identified to control the water table depth in specific floodplains of south africa e g dzikiti et al 2013 humphries et al 2011 such associations were also analyzed in other regions e g the heihe river in china zhang et al 2018 in new mexico kurc and small 2004 and in arizona cavanaugh et al 2011 hydrological models enabled to extend the very local analysis to a regional or even global scale e g in berg and sheffield 2019 global maps of summertime mean correlation between soil and et were derived for example they showed that for south africa correlations between 0 5 and 1 occurred which means et is soil moisture driven in situ data can be very limited in space and time and access can be restricted which complicates achieving findings for all climates representative of the study region furthermore model simulations involve high uncertainty because of assumptions and errors in the forcing data e g chen et al 2013 over the last decades more attention was paid to include remote sensing data in the analyses e g the satellite mission grace gravity recovery and climate experiment with the help of grace correlations between soil moisture and or total water storage anomalies twsa with vegetation data were determined for example for africa ndehedehe et al 2019 ugbaje and bishop 2020 where generally lags of one month for soil moisture and twsa with vegetation were found further studies applied a similar analysis to other regions for example in mainland australia a lag of one month was mostly identified for areas dominated by crops between soil moisture twsa and the normalized difference vegetation index ndvi in ukraine soil moisture and ndvi showed a maximum correlation of 0 68 ghazaryan et al 2016 and in east to west asia correlations between soil moisture and et were ranging from 0 14 to 0 94 depending on the deepness of the soil layer a few studies even examined relations on a global scale tao et al 2020 xie et al 2019 and identified e g twsa as a cause of vegetation greenness for more than 40 of the global vegetated areas using remote sensing data also has limitations soil moisture monitoring from space can only sense water in the upper soil layers but not in the effective root zone yang et al 2014 so far grace and its successor grace follow on are the only global satellite missions that are able to observe the sum of surface and sub surface water storages thus that observe groundwater storage variability however grace has a limited spatial resolution of about 300 km and can only sense the total amount of water changes as water column not the individual water storages for example ugbaje and bishop 2020 emphasized the need to partition the grace twsa into its sub compartments furthermore in many cases the remote sensing data is used for the analysis directly or to validate model results the coupling of model strengths with observations is needed e g levine et al 2016 and can be implemented by integrating grace observations into hydrological models through data assimilation e g zaitchik et al 2008 schumacher et al 2016 several studies assimilated grace twsa into hydrological models for example zaitchik et al 2008 girotto et al 2016 and li et al 2019 integrated the grace twsa into the catchment land surface model clsm on regional scales like the mississippi river basin in the united states or on the global scale however the clsm does not represent anthropogenic water use in contrast a global hydrological model that considers anthropogenic water use is the watergap hydrological model wghm schmied et al 2021 in previous work eicker et al 2014 schumacher et al 2016 and schumacher et al 2018 assimilated grace twsa into the wghm model and found improved realism when confronting to observations based on this framework we set up our data assimilation scheme used in this study to assimilate grace twsa for south africa in this study soil moisture surface water and groundwater derived from the grace assimilation are used together with vegetation indices from satellite remote sensing to obtain the time delayed correlation on the basis of real observation and to determine realistic signatures of the propagation of precipitation peaks through the water cycle these signatures begin with rain that recharges the water storages and eventually leads to vegetation mass increase which can be quantified via vegetation indices we argue that assimilating grace into a model can be viewed predominantly as a spatial and vertical downscaling of grace that is supported by physical relations in other words we consider the assimilation result as a synthesized data set we assimilate grace derived twsa for south africa into the wghm effectively pulling the model simulations closer to the grace observations our assumption here is that at large scale 50 km grace assimilating hydrological modeling provides a more realistic picture of groundwater and surface water evolution as compared to modeling only we then apply statistical methods and identify signatures e g temporal lags and annual amplitudes with the observation based data sets and later test the model according to the found signatures to identify these relations we extract sub signals and dominant modes from the model simulation and assimilation to empirically set water and vegetation variables in relation these variables include precipitation surface water soil moisture groundwater actual evapotranspiration aet and leaf area index lai we show in which regions correlations lags and sensitivities between observed water storages and vegetation are similar to those between the modeled storages and vegetation and in which regions or climate and vegetation regimes we find significant differences taken all together our analysis aims at confronting shortcomings in the model with synthesized observations we stress that our synthesized observations could be used to compare to any hydrological or land surface model 2 study area south africa south africa extends over an area of 1 2 million km2 and its population totals about 60 million the largest river basin is the orange river which rises in the drakensberg mountains in lesotho flowing westwards through south africa into the atlantic ocean at the border of namibia the ocean and the interior plateau lead to warm temperatures and dry weather with an average annual rainfall of 500 mm for the western cape most of the rainfall is falling in winter while the remaining area of the country is experiencing most of the rainfall in summer government communications gcis 2020 due to its specific climate characteristics and its location south africa s hydrology is affected by climate events for example the el niño southern oscillation enso is influencing the south african rainfall e g richard et al 2000 kane 2010 on a regular basis in the considered observation period strong dry el niño events occurred in 2015 2016 and moderate events in 2002 2003 and 2009 2010 the counterpart la niña led to strong wet events in 2007 2008 and 2010 2011 and a moderate event in 2011 2012 south africa was also frequently affected by extreme drought in the past for example 2003 2004 and 2015 can be found as drought years in the literature e g mussá et al 2015 guha sapir et al 2020 savanna is the dominant biome in the north fig 1 large parts in central and east are grassland the albany thicket woodland exists in the south in central and west there is low shrubland called nama karoo and the fynbos biome is in the south west of south africa according to mabhaudhi et al 2018 rainfed agriculture is mainly apparent in central east where grassland is the main vegetation while irrigated areas can be found for large parts of the fynbos biome and in the north and northeastern savanna a large part of the population depends directly or indirectly on the agricultural sector e g schreiner et al 2018 the main crops by harvest area are cereals maize oil crops soybeans and wheat fao 2021 3 data and models 3 1 grace the grace mission was a joint gravity satellite mission by the national aeronautics and space administration nasa and the german aerospace center deutsches zentrum für luft und raumfahrt dlr launched in march 2002 ended in october 2017 and consisted of a tandem constellation of two satellites flying in the same orbit continuous inter satellite range measurement with an accuracy of a few micrometers was implemented to observe gravity changes which can be post processed and converted to monthly gravity fields expressed via spherical harmonic coefficients level 2 level 2 solutions itshg 2018 of degree and order 96 are provided by tu graz and we post process them using several consecutive steps the lower degree coefficients were replaced by degree 1 and c20 coefficients by nasa jpl because grace measures them inaccurately swenson et al 2008 cheng et al 2011 the temporal mean for 2003 to 2016 is reduced from the geopotential coefficients and filtering with ddk3 anisotropic filter is applied to account for striping effects that occur due to the measurement constellation e g kusche 2007 kusche et al 2009 then the coefficients are transformed to total water storage anomalies twsa via spherical harmonic synthesis wahr et al 1998 to an 0 5 grid similar to the model resolution after the transformation the effect of glacial isostatic adjustment gia is removed to account for post glacial rebounding effects here a gia model is provided by nasa jpl a et al 2013 further we apply a full error propagation from spherical harmonic coefficients to gridded mass changes to be able to include the error information also into the assimilation framework see section 4 we note that at the south africa basin level grace spatially averaged time series derived from csr or gfz rl06 data products would differ only by an rms of about 1 5 mm from the itsg solutions we used here in other words our results are robust against the choice of the grace data set since the resolution of grace is much coarser than the model resolution grace data is typically aggregated or spatially averaged within the study regions schumacher et al 2016 showed that for higher spatial degrees e g 1 numerical problems appear during the assimilation thus we decided to apply aggregation to a spatial resolution of 4 hereinafter the 4 grace twsa monthly grids are then used as input for the data assimilation which means we assimilate them into the hydrological model 3 2 remote sensed vegetation indices for this study moderate resolution imaging spectroradiometer modis based actual evapotranspiration aet and leaf area index lai time series were extracted from modis c6 lai fpar product spanning from 2003 to 2016 aet is an important variable that characterizes the water fluxes from earth s surfaces and vegetation while lai characterizes the canopy of vegetation on the ground and is defined as the leaf area per unit ground e g huang et al 2015 the aet running et al 2017 data set was extracted from modis net evapotranspiration product which is derived using the concepts of penman monteith energy balance model based on several remotely sensed and meteorological reanalysis data sets ghazaryan et al 2020 the lai product myneni et al 2015 is an 8 day composite data set with a 500 m resolution which corresponds to the best pixel available during the 8 day period both data sets have been shown to be reliable and have been validated validation stage 2 for lai and 3 for aet and the accuracy of the products has been assessed over several locations and time periods sun et al 2013 abiodun et al 2018 mu et al 2007 li and xiao 2020 yan et al 2016 by using the quality assessment information of both data sets the pixels with reduced quality were masked out the 8 day time series were aggregated to monthly values by calculating the pixel wise mean for lai and sum for aet data finally the data sets were aggregated to 0 5 resolution using the median modis time series were accessed and pre processed using google earth engine gorelick et al 2017 3 3 watergap hydrology model and precipitation data the watergap hydrology model wghm schmied et al 2021 is a global hydrological model that simulates among other fields storages on a spatial resolution of 0 5 for this analysis we consider surface water storages sum of local lakes local wetlands global lakes global wetlands rivers and reservoirs soil moisture and groundwater the model was forced by precipitation temperature longwave radiation and shortwave radiation which are derived from the gswp3 era5 forcing data sets kim 2017 hersbach et al 2019 hersbach et al 2020 joint by homogenization lange 2019 lange 2020 we use the same precipitation fields also in section 6 1 for our analysis of the propagation of water starting from this observed flux in wghm vegetation types are mainly based on using static land cover classes and fluxes to derive vegetation indices the growth of the vegetation is simulated in the growing period to simulate monthly leaf area indices lai wghm uses a function of daily temperature and precipitation and then limits lai values to minimum and maximum values these minimum and maximum values are determined based on the static land cover classes deciduous plants fractions and factors for evergreen plants additionally wghm simulates the actual evapotranspiration aet which is used in this study as the second vegetation index the simulated aet is derived by adding up four different fluxes canopy evaporation snow sublimation actual evapotranspiration from soil and potential evaporation of open water surfaces they all have in common that they either use the priestly taylor method for its calculation or an adaption of this method finally the transpiration from irrigated surfaces is added to derive the total aet more computational details about lai and aet in wghm can be found in schmied et al 2014 and schmied et al 2021 fig 2 shows the maximum cross correlations and corresponding lags between remote sensed aet and aet simulated during an open loop run it is obvious that both are highly correlated in particular in the east of south africa but there are also regions where the two aet time series are less correlated mainly in the albany thicket this is also the region where we identify lags between remote sensed aet and modeled aet of about 4 or more months thus the aet simulation and observation do not only differ in magnitude they are shifted in time this finding underlines that compared to the observed aet the wghm does not perfectly simulate aet which was also shown in schmied et al 2014 who found that there can be unrealistic high positive and negative values of aet in some areas and in kaspar 2004 who found that evapotranspiration parameters and land cover attributes lead to major uncertainties in simulated river discharge anthropogenic water use is included in wghm via the groundwater surface water use gwswuse model which distinguishes between the amount of potential net surface water and groundwater abstraction in fig 3 the linear trends of these water uses for the time period 2003 to 2016 are visualized the west of south africa shows a region with slight negative groundwater use trends while for surface water negative use trends are rather localized in the south an increase in groundwater use is found in the south and for the surface water use in the west close to the border to namibia however with 0 05 0 05 mm per year the water use trends that are included in the model are still small and are probably underestimated as was shown in the past for example scanlon et al 2018 showed that modeled linear trends e g of the total water storage are underestimated while e g grace data show more realistic trends 4 data assimilation framework data assimilation seeks to merge modeling and observations by adjusting model states and model parameters in this work we use the ensemble kalman filter enkf evensen 1994 which is a filter algorithm for sequential data assimilation the enkf works via two steps first a prediction step and then an update step simulating the model states for one month represents the prediction x it is applied for each ensemble member k we use monthly simulations because we also use monthly grace observations the model states for a specific time step t depend on the model states of the previous time step x k t 1 model parameters p k and forcing data u k 1 x k t f x k t 1 u k t p k the prediction is then updated using the observation data y by weighting the difference between model prediction and observation the model prediction is incrementally updated by 2 x k t x k t k k t y k t a x k t where k k t is the kalman gain matrix and a is the observation operator that refers the observations to the simulations model uncertainty and data uncertainty are weighted via second moment statistics within k k t where the model uncertainty is represented via a suitably generated model ensemble more details about data assimilation using enkf can be found in e g evensen 2009 the specific enkf implementation for grace twsa assimilation was developed at the institute of geodesy and geoinformation at bonn university igg e g eicker et al 2014 schumacher et al 2016 schumacher et al 2018 but updated for this study by coupling wghm to the parallel data assimilation framework pdaf nerger and hiller 2013 to apply the data assimilation of grace twsa into wghm a framework is set up with different phases as follows first during an initialization phase we run the model from 1995 to 2000 then we produce 32 ensembles by disturbing the forcing data and model parameters to be able to build a representation of the model uncertainty which are used for the following spin up phase from 2001 to 2002 next we utilize the 32 ensemble members from the end of the spin up phase to produce two following runs from 2003 to 2016 1 an open loop ol simulation that represents the spread of monthly model predictions for each of the 32 ensembles from which we derive the ol ensemble mean and 2 an assimilative ensemble where the grace observations are merged into the model runs it is important to understand that the spatial resolution of the data assimilation output product corresponds to the model resolution i e 0 5 i e much denser as compared to the resolution of the grace data 4 however the reader should keep in mind that data assimilation is not independent from a model another caveat is that data assimilation cannot guarantee physical consistency e g budget closures but on the other hand this is also the case for remote sensing data sets due to the unavoidable presence of errors 5 methodology 5 1 extracting seasonality via a regression model in this section we separate sub signals of the different data sets for comparison via solving a regression problem similar as in phillips et al 2012 forootan et al 2016 here we separate the signal into a linear trend annual amplitudes and phases as well as semi annual amplitudes and phases we do not estimate trend rates accelerations since we found that the method could not clearly and meaningfully separate linear trend and constant acceleration in south africa due to the short time series the equation can then be written for each grid j as 3 x j t a 0 j a 1 j t t 0 b 1 j cos ω t b 2 j sin ω t c 1 j cos 2 ω t c 2 j sin 2 ω t where t is the time in years a 0 is a constant a 1 is the linear trend b 1 and b 2 represent the annual signal and c 1 and c 2 represent the semi annual signal the coefficients a 0 to c 2 are estimated using a least squares approach the annual amplitudes a and phases ϕ can be computed from the estimated seasonal coefficients 4 a j annual b 1 j 2 b 2 j 2 ϕ j annual arctan b 2 j b 1 j and similar for the amplitude and phase of the semi annual oscillation next in order to empirically quantify the temporal response of the various storages and the vegetation we relate amplitudes and phases to each other as exemplarily shown for precipitation and groundwater 5 a j p gw a j gw σ a gw a j p σ a p ϕ j p gw ϕ j gw ϕ j p where σ a gw σ a p represents the spatial standard deviation of previously estimated groundwater precipitation amplitudes we are aware that in wghm these factors depend on the model representation of processes and various model parameters such as the precipitation multiplier but they are not independent of the hydrological setting 5 2 principal component analysis another way of comparing data and model simulations is to look at the dominant modes of variability one of the most common methods is principal component analysis pca preisendorfer and mobley 1988 khandu et al 2016 khaki et al 2018 cerón et al 2020 the pca can also be seen as a reduction of dimensions it breaks down the original data into only a few dominant modes that represent the majority of the variability contained in the original data for example rangelova et al 2007 extracted the dominant modes for grace and hydrological models to explore hydrological signatures and li et al 2021 extracted the dominant modes to reconstruct grace twsa and fill data gaps here a signal x for example groundwater with n rows describing the number of months and m columns describing the number of grids is decomposed preisendorfer and mobley 1988 by 6 x pe t p xe where the columns of p contain the principal components pcs and the columns of e the eigenvectors i e the empirical orthogonal functions eofs the decomposition is performed via singular value decomposition pc has uncorrelated time series in columns thus it represents the temporal component of the mode whereas the eofs represent the spatial component here we normalize the unitless pcs while the eofs have the same unit as the data 7 pc i p i σ p i eof i σ p i e i where i represents the i th mode the eigenvalues λ can be used to compute the percentage contribution of the i th mode to the total variance by 8 η i 100 λ i 2 i 1 n λ i 2 the modes are sorted from highest mode 1 with pc1 and eof1 to lowest percentage contribution to the total variance 5 3 process model here we define an order one process model similar as in humphrey and gudmundsson 2019 with the purpose to relate water storage in a given month to previous water storage and precipitation this will be applied both to observed e g via data assimilation and simulated storages in the following the process model is defined via 9 s i t c i s i t 1 d i p i t where s i t and p i t are the storage and precipitation of the current month at grid i and s i t 1 is the storage in the previous month at grid i as storage input we consider either absolute values of surface water soil moisture or groundwater derived from the assimilation or model simulation we estimate the temporally stationary process coefficients c and d which are used in the following to describe the sensitivity of this particular storage compartment to previous storage and precipitation for example when we apply the process model to predict the precipitation groundwater dynamics the coefficient c describes how the groundwater of the current month is related to the previous month which is expressed with unitless coefficients the coefficient d then describes how the groundwater of the current month is related to same month precipitation this relation is additionally accompanied by specific units in this case the d coefficients are given per month because we need to refer a storage to a flux the same methodology can also be applied to describe vegetation indices v t 10 v i t e i v i t 1 f i s i t 6 results and discussion in the following first we will focus on comparing the observed with the simulated water propagation from the annual maximum of precipitation to the annual maximum of surface water soil moisture and groundwater section 6 1 second the focus is set on the further course of water from the storages to vegetation indices section 6 2 third nonseasonal signals are extracted and the full propagation from precipitation to vegetation is analyzed and compared in order to identify temporal relations during climate events and pitfalls in the modeling section 6 3 finally a region specific analysis uncovers more details for the five largest vegetation regimes in south africa section 6 4 6 1 precipitation water storage dynamics here we will quantify the dynamics of the link between precipitation and the replenishing of surface water storage soil moisture conditions and groundwater recharge first at the seasonal scale from observations and from model simulations with watergap we will identify and isolate the dominant spatial and temporal patterns using methods as outlined in section 5 annual amplitudes of precipitation relative to annual amplitudes of observed and modeled soil moisture surface water and groundwater are shown in eq 5 an amplitude factor lower than one suggests that the normalized storage amplitude appears lower as compared to the normalized amplitude of annual precipitation this means that the annual precipitation but not all of the precipitation partially recharges the soil moisture an amplitude factor of one indicates that normalized precipitation and storage amplitudes are equal thus the precipitation mainly recharges the storage a value higher than one indicates a larger normalized storage amplitude than normalized precipitation amplitude which suggests that the change in the storage is mainly forced by other fluxes than precipitation for brevity we will call this ratio in the following the precipitation storage factor fig 4 shows the precipitation storage factors for observed storages derived from assimilation as and open loop simulation ol for the observed soil moisture based on assimilation the factor is closer to one for most of the area especially for the interior of the region as compared to surface water and groundwater thus the soil moisture amplitudes are very similar to the amplitudes of precipitation in other words the precipitation mainly propagates to the soil moisture for the fynbos biome the factor is higher than two our explanation is that the biome has significantly denser vegetation see fig 1 which buffers the seasonal dynamics for example hamilton 2003 suggested reinstating vegetation cover in south texas to mitigate water loss in the soil during drought periods the amplitude relation of precipitation to observed surface water and groundwater is lower than what was found with soil moisture thus precipitation propagates to these storages but not in the same amount as to soil moisture we find that modeled soil moisture and surface water exhibit similar precipitation storage factors as compared to observations larger differences can be observed for the seasonal precipitation groundwater dynamics the precipitation groundwater factor based on simulations is much closer to one than the factor based on observation we suggest that the sensitivity of groundwater with respect to precipitation is too rigid in the model representation in order to investigate the duration that the precipitation storage dynamics require fig 4 displays the phase lags of the storage annual cycles with respect to precipitation for many regions we observe soil moisture i e assimilation dynamics are hardly lagging behind precipitation while at the south eastern coast and the indian ocean belt phase shifts of three to six months occur observed surface water show longer phase shifts to precipitation of mainly two to four months all over the country the largest phase shift can be found in observed groundwater with three to six months over most of the area of south africa very large phase shifts of six or more months are found in south west of south africa we find that observed soil moisture is similar to the model simulations the lags between precipitation and modeled surface water or groundwater are shorter than with the observations for about two months thus compared to the observations the model underestimates the duration of the dynamics the process model coefficients c and d section 5 3 are shown in fig 5 for the december march season we observe from the c coefficients top two rows in fig 5 that in the observations soil moisture in a given month is closely related to the previous month values of about 0 4 to 0 6 we notice that for the region surrounding cape town soil moisture is much less depending on the previous month the same region has an increased same month precipitation sensitivity coefficient d as compared to other regions in the observations surface water and groundwater show a much higher sensitivity towards previous month storage c than soil moisture at the same time the observations show that the sensitivity of soil moisture to same month precipitation d is higher than with surface water and groundwater this coincides with our findings on the relative amplitudes overall we identify high sensitivity of the storages to same month precipitation along the southern coast soil moisture in the fynbos biome soil moisture and groundwater and in the orange basin surface water the regions that are showing a higher sensitivity of soil moisture towards precipitation agree with the regions of irrigated areas as shown in mabhaudhi et al 2019 in the modeling the sensitivity of soil moisture towards the previous month c is slightly lower as compared to the observations which is also the case for the surface water this means that the model underestimates the sensitivity of soil moisture and surface water towards previous month storage furthermore in the modeling we notice a slightly higher sensitivity of soil moisture to same month precipitation d as compared to the observations especially in the northwest of south africa reversely the sensitivity of simulated groundwater to previous month precipitation is slightly lower than observed the sensitivity of surface water to precipitation d does not show a difference between model simulations so at this point we cannot clearly identify an under or overestimated of the storage sensitivity to precipitation in the model therefore we now shortly summarize our sensitivity results during the winter season june august fig a 1 we notice that in the modeling all storages are less sensitive to the previous month as compared to the observation the opposite is found for the sensitivity of the water storages to precipitation which means a higher sensitivity is observed using the model simulation than using observations thus the sensitivity of the storages to precipitation is generally higher modeled than it is observed except for groundwater in the winter months to corroborate the previous findings the maximum cross correlation moving 6 months window and the corresponding lags between precipitation and the storages observed and modeled are shown in fig 6 the cross correlations result in similar findings as previously made in the modeling the sensitivity of precipitation to the storages is found to be higher than in the observations since this was already analyzed and interpreted we concentrate on the analysis of the lags observed soil moisture shows no lags to precipitation over nearly the entire area of south africa except the indian ocean belt while we observe that surface water lags precipitation of about 1 to 3 months thus the precipitation immediately refills soil moisture and a few months later surface water after some time 3 to 6 months the precipitation also refills groundwater we suggest that the duration of precipitation to refill the surface water is longer than for soil moisture because the water takes some time in the routing process the water propagation to groundwater is even longer because the water needs to seep through different soil layers in the modeling we derive a similar duration for the precipitation soil moisture dynamics contrary for the precipitation propagating to surface water and groundwater it takes less time in the model simulations as compared to the observations this coincides with the analysis of relative phases where we also identified a shorter simulated duration for the precipitation storage contribution of water as it was observed to relate our correlation analysis to the seasonal cycle we apply pca and choose those modes of precipitation observed storages and simulated storages that most resemble the annual sub signal in fact we found for all variables that the first mode eof1 and pc1 represents the annual cycle table 1 shows the maximum cross correlation and corresponding lags between the annual modes pc1 of precipitation with the observed assimilation as or modeled open loop ol storages since the corresponding pcs only show the correct sign together with its spatial component eof we consider only absolute correlations in the model simulations we find higher correlations between the annual modes of precipitation and all storages as in the observations the part of precipitation that belongs to the seasonal cycle nearly directly propagated to the seasonal and simulated soil moisture cycle 0 months the duration for the precipitation surface water dynamics is shorter than simulated 2 months as it is observed 3 months similar findings are derived for groundwater simulated lags of 3 months observed lags of 4 months therefore and due to the previous results we find that the seasonal cycle is largely contributing to the identified simulation and observation discrepancies however a detailed analysis on non seasonal events section 6 3 will investigate whether the non seasonal part of the observations and simulation also differs in the same manner overall the different methods used in this section are consistent in their findings the model shows an overestimation of precipitation contributing to the water storages the observation based analyses show that the simulated time shift between precipitation and the storages is generally too short as compared to the observations 6 2 water storage vegetation dynamics now we focus our analysis on the further course of water through the water cycle namely the propagation of water stored in soil moisture surface water and groundwater that contributes to vegetation growth we aim to investigate temporal and spatial signatures of the storage vegetation dynamics by using the methods as outlined in section 5 we will compare observed storages via assimilation and vegetation indices via remote sensing against modeled via open loop storages and vegetation indices fig 7 shows amplitudes of observed via as and modeled via ol storages relative to observed via remote sensing and modeled via ol vegetation indices aet and lai see eq 5 respectively again for conciseness we define a storage vegetation factor similar to the precipitation storage factor a value lower than one indicates that the vegetation has lower normalized amplitudes compared to the normalized storage amplitudes this means that the storage contributes partially to the vegetation growth a value of one suggests that both are equal thus all of the stored water is leading to vegetation growth and a value higher than one indicates that the vegetation has higher normalized amplitudes as the normalized storage amplitudes this indicates that a change in vegetation can but does not need to be fully forced by the storage and can additionally be forced by other storage compartments than those integrated in the analyses or by fluxes in the observations first row for aet and third row for lai in fig 7 as expected the soil moisture vegetation dynamic is stronger storage vegetation factors close to 1 for most of the area of south africa except the indian ocean belt than with surface water and groundwater thus vegetation growth mainly depends on soil moisture nonetheless we notice that surface water and groundwater additionally impact the vegetation growth we find that the observed surface water vegetation dynamics are strongest along the orange river while we identify strong groundwater aet dynamics in the center from north to south which is decreasing towards the west the east shows relative amplitudes of 5 or higher this means that we cannot directly verify if the storage or any flux is leading to vegetation growth at this point in the modeling we find that for soil moisture and surface water a larger area shows storage vegetation factors higher than two as compared to the observations thus the model might either overestimate the contribution of soil moisture and surface water to the vegetation growth or other fluxes are more important for the vegetation growth for groundwater we cannot conclude if the model is under or overestimating in comparison to the observations but we find that the spatial extent between model and observation is different in order to investigate the duration that it takes for the water storages to propagate to the vegetation fig 8 shows phases of observed via as and modeled via ol storages relative to observed via remote sensing and modeled via ol vegetation indices aet and lai see eq 5 in the observations first row for aet and third row for lai of fig 8 the relative phases between soil moisture and aet show no or a very small phase shift of one or two months in the north and east of south africa which was also found in ugbaje and bishop 2020 and means that the vegetation starts growing shortly after the soil moisture is recharged at the indian ocean belt it takes 5 and towards the center up to 9 months for the vegetation to evapotranspirate the water in the soil similar to what was found with precipitation we observe a longer duration of the surface water and groundwater as compared to the soil moisture but we find this only for the north south and east in the west the soil moisture takes longer to contribute to aet as compared to surface water and groundwater generally similar conclusions can be drawn when analyzing the relative phases between the observed storages and lai but the regions slightly differ for example for lai the largest phase shift is not only found from the belt towards the inland but also in parts of albany thicket in the modeling the relative phases between storages and vegetation indices are not clearly longer or shorter than with the observations as was the case for the precipitation storage propagation for modeled soil moisture and surface water we identify shorter phase shifts to vegetation in the west as compared to the observation while for groundwater we find longer relative phases especially in the albany thicket this means that in the west of south africa the model might underestimate the time it takes for peak soil moisture and surface water availability to propagate to peak vegetation at the same time it overestimates the duration for groundwater to affect vegetation growth in the west in the following the process model coefficients e and f eq 10 for the dec march season are shown fig 9 to investigate the sensitivity of the aet to the previous month e or to same month storages f in the observations we notice that aet has the strongest sensitivity to its previous month first row when including groundwater in the process model we suggest that this is because the vegetation growth depends stronger on the water in the soil and surface water than on groundwater for the sensitivity of aet to same month soil moisture third row we observe that the north and east are more sensitive than the west the sensitivity of aet towards same month surface water is much more pronounced values higher than 1 0 kg m2 per mm as compared to soil moisture for example at the southeastern coast while the sensitivity towards groundwater is less pronounced than soil moisture here we find two regions that show medium sensitivity between 0 5 and 0 8 kg m2 per mm the north close to the border to botswana and the east close to the border to namibia where the orange river is routing in the modeling second and fourth rows we find a higher sensitivity of aet towards same month storages as compared to the observations thus the sensitivity of aet to the storages is overestimated in the model which was also found in schmied et al 2014 and confirms the previous results at the same time the model underestimates the sensitivity of aet to the previous month however this under and overestimation seem not to be as pronounced as it was found for the precipitation storage relation if we apply the same analysis for the winter months fig a 2 we derive very similar insights and conclusions nevertheless the spatial extent of the identified sensitivities changes partially and we overall find that during the winter months the sensitivity is decreased compared to the summer months observed and modeled coefficients we assume that this is due to the fact that south africa experiences a dry phase in winter the results for lai are attached to the appendix for completeness and mainly confirm the overestimation of the modeled storage vegetation dynamics that we found with aet figs a 3 and a 4 applying cross correlation analysis fig a 5 moving 6 months window between storages and vegetation indices observed and modeled confirms previous results and leads to similar conclusions as the regression model and the process model namely that the model overestimates the storage vegetation dynamics a deeper look into the corresponding lags is provided in fig 10 we identify no or small negative lags in the east of south africa between soil moisture and aet with the observations first row in the west we find negative lags of about 3 months which means aet is lagging soil moisture at the indian ocean belt aet is lagging soil moisture with about 6 months for surface water and groundwater we identify shorter lags ca 2 months in the west than with soil moisture this shows that in the west the water includes a temporal delay during its propagation from soil moisture peaks to surface water peaks and finally groundwater peaks but all water storages contribute to the vegetation growth this is different for the east where we identify positive lags for surface water about two months and groundwater 4 to 6 months so the storages are following aet thus in the east the vegetation growth is mainly influenced by water from soil moisture and reacts directly to that storage instead of reacting to surface and groundwater storages in the modeling we notice shorter lags between soil moisture and vegetation in the west than it was observed modeled water in the soil immediately evaporates thus the duration of the soil moisture aet dynamics is underestimated in the model the same region shows discrepancies between model and observations for surface water and groundwater we find positive lags between simulated surface water and groundwater instead of negative lags which were found with the observations this means that in the modeling the vegetation growth is mainly stimulated by soil moisture while in the observation surface water and groundwater follow vegetation growth and therefore do not contribute to it in turn this shows that the model does not correctly reflect the storage vegetation dynamics furthermore we identify an interesting spatial pattern close to the border of namibia with positive lags up to 6 months between modeled surface water groundwater and aet which is not shown in the observed data fig 3 provides a possible explanation this region shows positive surface water trends and negative groundwater use trends hence the model might experience restrictions in the simulation of surface and groundwater use in the following we extract the annual modes first modes extracted with pca of storages and vegetation indices to relate our correlation and lag analysis to the seasonal cycle table 2 shows the maximum cross correlation and corresponding lags between the first temporal modes pc1 of the observed via assimilation as and modeled via open loop ol storages with the observed via remote sensing and modeled via ol vegetation indices respectively in the modeling we identify a higher correlation of the storages to the vegetation indices as compared to the observations so the model overestimates the contribution of the seasonal cycle of the storages to the vegetation growth when considering the lags it is shown that for modeled groundwater and surface water the lags to the vegetation indices are all positive which means that first a change in vegetation occurs and 2 months later the surface water groundwater change is notified this confirms what we found in the lag analysis that included the full storage and vegetation signal we suggest that in the modeling the vegetation in south africa depends stronger on soil moisture than on surface and groundwater considering the observations we find that the duration of the storage vegetation dynamics in the seasonal cycle is longer than in the modeling thus the model underestimates the duration this cannot confirm what we found in the full signal lag analysis where we identified strong duration differences between east and west of south africa a reason for that might be that in the model simulations the non seasonal sub signal of the storage vegetation dynamic is not clearly underestimating as it is shown here with the seasonal dynamics all in all this section demonstrated that the model overestimates the amount of water that contributes to the vegetation growth we cannot clearly conclude if the model under or overestimates the duration of the process in general the analysis of the annual cycle showed an underestimation of the modeled duration for the storage vegetation dynamics as compared to the observations but other results containing the full signal showed strong differences between the east and west of south africa this emphasizes the need for a more detailed analysis on the non seasonal storage vegetation dynamics and a deeper look into the different vegetation regimes see section 6 4 however we consistently found that especially for the west of south africa surface water and groundwater are also found to contribute to the vegetation growth which in most cases was not simulated 6 3 non seasonal signals here we extract non seasonal extreme events like enso and droughts using the pca method as outlined in section 5 2 to better understand the precipitation storage vegetation dynamics during these events fig 11 refers to spatial eofs and temporal pcs derived from the observations that showed peaks in 2006 2007 and 2011 years are shaded in gray and thus are identified to show the enso events la niña events we exemplarily show the second mode of precipitation the fourth mode of groundwater the third mode of aet and the fifth mode of lai for comparison we add the modeled temporal modes that identified the enso events except for precipitation we find that the temporal mode pc2 of observed precipitation shows positive peaks in 2006 which is showing the first la niña event during our time period a few months later 1 2 months we notice the same event in the groundwater pc4 before the turn of the year 2006 2007 we find the first enso event in the aet and half a year later in lai this means that the 2006 la niña event propagates from precipitation to the groundwater and finally increases vegetation growth when we compare this to the model simulations we find that the vegetation indices model the 2006 2007 peak more than half a year earlier the enso is a strongly precipitation driven event thus the findings here show that the model underestimates the time it takes for the enso driven precipitation seeping through the storages to contribute to the vegetation growth spatially the corresponding eofs of the modes have in common that positive light blue patterns are shown for the west in the fynbos biome succulent karoo and albany thicket thus the la niña events mainly affects precipitation and its propagation thought the water cycle in the center towards the west of south africa the analysis of the precipitation storage vegetation dynamics during drought events is more complex than with the enso events in the observations a few temporal modes can be referred to the 2015 2016 drought fig 12 shows the identified modes of precipitation mode 4 groundwater mode 1 and aet mode 4 that include drought patterns for south africa s 2015 2016 drought years are shaded in gray in the observations for the comparison we also show the modes derived from the model simulations that include the drought pattern except for precipitation in the observations all pc time series indicate a decrease in the drought period the strongest impact of the drought on precipitation and aet is observed to occur in the region surrounding the orange river negative patterns however by comparing the results to the modeled temporal modes we cannot identify temporal delays some of the temporal modes also contain other components for example the annual cycle e g temporal mode of modeled groundwater which renders the interpretation difficult since the separation of the drought signature from the annual signal is not always possible additional example attached for observed groundwater fig a 6 it is not always obvious whether there are no temporal delays or whether they cannot be separated from other sub signals which then might reflect that the applied methodologies are limited in their application 6 4 region specific analysis in the previous sections we discovered that the findings are very region specific for example the southeastern coast with the fynbos biome or the coastal belt of the indian ocean differed in many cases from other regions since most of the spatial patterns coincided with the vegetation in fig 1 we aim to identify dominant signatures and correlations for the regimes each 0 5 grid cell will be assigned to a vegetation cluster defined by merging the polygons in fig 1 and we will study the five largest clusters albany thicket fynbos biome succulent karoo savanna and grassland we will start analyzing the signatures for the cluster for the precipitation storage dynamics and continue with the storage vegetation dynamics table 3 shows the annual phases of soil moisture surface water and groundwater relative to precipitation eq 5 within the five different clustered regions in the observations we find that not all regions show similar relative phases between precipitation and soil moisture for example soil moisture lags precipitation with a bit more than half a month 0 66 months in the savanna while in other regions soil moisture lags precipitation with 1 to 2 months e g 1 05 months for the grassland and 1 95 months for the fynbos biome the lags between precipitation and surface water groundwater are longer than those found with soil moisture for example in the fynbos biome we find that surface water lags precipitation with about 4 5 months and groundwater lags precipitation with about 6 months comparing the different regions we find that all observed storages have the shortest lags to precipitation in the savanna and in albany thicket in these two regions the climate is very dry and vegetation is very sparse and cannot decrease the duration of water propagation from soil to other compartments thus the short lags explain the immediate and fast propagation of precipitation to the different storages the fynbos biome and succulent karoo are widely covered with vegetation which explains that these two regions identify the longest phase lags for observed storages in most regions we notice slightly shorter phase lags in the modeling than in the observations for example the modeled surface water shows lags between one and two months to precipitation in all regions instead of 1 5 to 4 5 months as it was found in the observations this shows that the model underestimates the duration for precipitation replenishing the water storages additionally when we compare the lags for the modeled storages for the different regions it is not possible to separate the fynbos biome and succulent karoo as clearly as with the observed storages this suggests that the model cannot capture regional characteristics as well as observations table 4 show the phases of observed or modeled water storages relative to observed or modeled vegetation indices eq 5 we identify short lags of about 2 months between soil water and aet in the savanna and grassland using the observations while lags of 3 or more months are found in the fynbos biome succulent karoo and albany thicket e g 4 1 3 8 and 4 1 months with aet for surface water we notice lags of 4 to 5 months for all vegetation regimes which means that a specific vegetation regime has low impact on the surface water vegetation dynamics on the soil moisture vegetation dynamics the contribution of groundwater to vegetation growth shows the longest lags for example we find aet lags groundwater by 8 or more months for the savanna and grassland in the modeling the duration of soil moisture propagating to vegetation is often shorter as compared to the observations for example in the albany thicket we identify a lag of 2 7 months between simulated soil moisture and aet while the observed soil moisture and remote sensed aet are lagging with 4 months which underlines previous findings that the model underestimates the duration of the process the only exception is the grassland where we find that the model overestimates the duration as compared to the observations we discover similar conclusions for the lai in contrast we notice that the modeled duration of groundwater propagating to vegetation is longer than what we observe thus the model overestimates the duration an extreme example is found for the groundwater aet dynamics in the albany thicket where the simulated duration is 5 months longer than the observed duration for surface water the results are very different as compared to soil moisture and groundwater while the duration between simulated surface water and lai is in each vegetation regime shorter as compared to the observation we cannot clearly conclude an over or underestimation using aet the findings illustrate that the simulation generally underestimates the duration of the propagation of the soil moisture annual maximum to the vegetation annual maximum in most regions and overestimates the groundwater vegetation contribution however the findings for surface water cannot be generalized in the same way because the dynamics strongly depend on the vegetation 7 conclusion this study aimed to revise the propagation of water through the water cycle that is simulated in models by using observation based data sets namely grace data assimilation and remote sensing vegetation indices we used statistical methods to identify and relate dominant spatial and temporal signatures for the propagation from precipitation peaks to water storage peaks surface water soil moisture and groundwater that affect vegetation growth the applied methods were the multi linear regression for detecting annual amplitudes and phases relatively a process model for relating water storages to the previous month storages or to same month precipitation a principal component analysis for extracting dominant modes from the data sets and a correlation analysis to find relations and lags between the data sets or their sub signals of the data sets we found that the amount of precipitation replenishing the water storages is often overestimated in the watergap hydrological model furthermore the duration that is takes for the precipitation to affect the water storages is often shorter simulated than with the observation based data sets we also found an overestimation in the model for the amount of water from the water storages that affects the vegetation growth but the duration for this process was in most cases shorter simulated than observed for soil moisture while it was mainly longer simulated for groundwater compared to the observations this showed us that there are main differences in the storage vegetation dynamics depending on the considered storage and also depending on the regions that were analyzed therefore we were not able to set an overall statement if the duration of the storage vegetation dynamics is under or overestimated as it was possible for the precipitation storage dynamics in the first parts of this study we focused our analysis on the full signal and the seasonal cycle to discover events like the enso in 2006 2007 and 2011 and the 2015 2016 drought events we separated non seasonal sub signal from the observations and model simulations in the last parts of our study the observation based data sets revealed that the timing of the enso events in vegetation is modeled too early for drought events we could not identify a delay in a more detailed analysis we studied the differences between the data sets according to five different vegetation regions the albany thicket the fynbos biome the succulent karoo the savanna and the grassland for example we found that the fynbos biome and succulent karoo experienced the longest lags between precipitation and assimilated storages observations as compared to the other regions but it was not possible to find such strong differences between the regions using the model simulations this study highlighted important relations between different meteorological hydrological and vegetation variables which represent the propagation of water through the water cycle we generally found that these relations are underestimated or temporally shifted in a hydrological model modelers can use these quantitative findings to improve their models and adapt simulation strategies based on the vegetation regimes we could also show that it is highly relevant to include observations e g from remote sensing into the analysis and emphasize the need for assimilating grace observations into the models in fact the chosen approach identifying shortcomings in the simulation of precipitation storage vegetation signatures could be used to identify shortcomings in other hydrological models and thus a transferring of the applied scenario to other models would also be reasonable there are many possibilities to improve or to extend this study in the future the assimilation framework can spatially be extended to a global scale in the further analysis we will aim in achieving longer time series for example by including grace follow on data which is the successor mission of grace the framework will benefit from a temporal extension because their statistical methods gain stability with a higher number of observations furthermore a simultaneous calibration and data assimilation approach will enable direct adaption of model calibration parameters these improvements might provide new insights across climate regions climate and weather extremes are expected to increase in frequency and magnitude ipcc 2021 thus it will be even more relevant to be able to simulate these events in order to avoid socio economic damage to society author contribution hg and jk designed all computations of the data assimilation and hg carried them out ks contributed to the setup of the data assimilation framework gg and od provided the vegetation indicators hg prepared the manuscript with contributions from all authors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge olga gassen engels for all her effort and contribution to the data assimilation framework and petra döll hannes müller schmied and sebastian ackermann for providing the watergap model and improving its interfaces for the data assimilation framework furthermore we would like to acknowledge christoph menz stephanie gleixner and stefan lange for preparing and providing the gswp3 era5 climate data set this work was supported by the german federal ministry of education and research bmbf in the framework of the globedrought project grant no 02wgr1457a and the german research foundation dfg in the framework of the research unit understanding the global freshwater system by combining geodetic and remote sensing information with modeling using a calibration data assimilation approach globalcda grant no ku 1207 26 1 appendix a results a 1 process model figs a 1 a 2 a 3 and a 4 a 2 correlations fig a 5 a 3 principal component analysis fig a 6 
3218,in the context of accelerating climate changes and economic boom in the past decades lakes have undergone drasticchanges worldwide particularly in arid and semi arid regions those lakes were severely impacted and threatened due to their hydrologic sensitivity and ecological vulnerability as the largest lake in northwest china with arid climate bosten lake provides precious water resources and ecosystem services to local communities although a large quantity of earlier efforts have been paid on bosten lake there is still absence of tracking its changing trajectory at a long timescale e g one century which restricts the holistic understanding of the decadal periodic lake desiccations and their driving forces this study employs a machine learning method to reconstruct the centenary covariations of water storage and salinity of bosten lake by integrating multi source data the results showed that compared with the high stage of 6 76 109 m3 in 1961 the lake water storage substantially dropped twice to 3 96 109 m3 in 1987 and 4 67 109 m3 in 2013 in recent years the lake level rose rapidly and recovered back to the comparable stage of the 1960 s by 2020 four metrics of accuracy evaluation employed in this study indicate the reliability of the xgboost model with the mean absolute error of 0 31 m mean squared error of 0 37 m r square of 0 85 and adjusted r square of 0 84 the centenary reconstruction results reveal that the lake salinity underwent six phase fluctuations with the water level and storage changes during 1920 2020 with the highest value of 1 87 g l in 1987 and the lowest value of 1 19 g l in 2002 during the past century the water salinity and storage of bosten lake were influenced chiefly by vapor pressure and precipitation followed by wet day frequency daily mean temperature and potential evapotranspiration moreover the uncertainty of the machine learning model was also explored and discussed it could be mainly associated with the data accuracy of input climate variables and the ignorance of environmental impacts from the intense agricultural activities after the 1960 s this study is expected to advance the scientific understanding of long term change characteristics of bosten lake and to provide a technical reference of reconstructing centenary hydrologic and environmental trajectory for dryland lakes keywords lake water storage salinity bosten lake machine learning climate change data availability no data was used for the research described in the article 1 introduction as an indispensable component of the hydrological cycle lakes influence the environment in many aspects and provide ecosystem services to local communities abd elaty et al 2021a bai et al 2011 lehner and döll 2004 ma et al 2007 mueller et al 2016 rinke et al 2019 in the context of the accelerating climate changes and economic boom worldwide numerous lakes have undergone unprecedented changes in the area water storage and water quality in the past decades abd elaty et al 2021b han et al 2022 pickens et al 2020 song et al 2014 song et al 2020 particularly lakes in semi arid and arid regions were extremely vulnerable and slight natural or anthropogenic disturbances may trigger serious consequences bai et al 2021 fang et al 2018 fu et al 2021 seitz et al 2022 tan et al 2018 for instance the water storage of the aral sea shrank by 87 85 over the past several decades due to human activities and climate warming yang et al 2020 such lake degradations can also be observed in other drylands worldwide in iran lake urmia has suffered a substantial reduction in water storage since the second half of the 20th century hosseini moghari et al 2020 in china over 50 of the lakes in semi arid and arid regions became desiccated intermittently in recent decades mainly because of the drying climate liu et al 2013 overall advancing the knowledge of lake hydrological and water quality changes in semi arid and arid regions is urgently needed to protect the local environment and to manage water resources the arid semi arid area in northwest china is one of the driest lands among all regions at the same latitudes wang and qin 2017 the topographic influence of the high altitude tibetan plateau and the location far away from the sea make it suffer intensified droughts over the past several decades qiang et al 2000 as the largest lake in this arid area bosten lake is widespread concerned for example wang et al 2018 developed an index system for evaluating the water environment carrying capacity in the bosten lake basin guo et al 2015 analyzed the salinization processes of bosten lake from 1960 to 2010 also there are many other studies that tried to explore the dynamic changes of bosten lake in response to climate changes and anthropogenic influences in the last decades dai et al 2020 liu et al 2020 yao et al 2018 however most of these studies focus on the changes of bosten lake in recent decades owing to the lack of earlier historical in situ observations considering that the changes of bosten lake may behave with heterogeneous characteristics in different historic periods fontana et al 2019 tarasov et al 2019 the absence of a holistic picture of the change trajectory in long term is unfavorable to the macroscopic understanding of hydrological and environmental evolutions of bosten lake thus it is pressing to explore the bosten lake changes in longer time series by employing state of the art techniques the hydrological model is a traditional way to quantify changes of hydrological elements devia et al 2015 over the past several decades many powerful models have been developed and improved adnan et al 2019 janssen et al 2021 teklay et al 2021 however hydrological models require a bunch of observation data to serve as the model inputs making them unsuitable for the remote regions lacking historical in situ observations since the late 20th century remote sensing has been employed as an efficient and simple solution to monitor lakes in more and more research benveniste and berry 2004 deoli et al 2021 duan and niu 2018 lu et al 2013 unfortunately the satellite remote sensing observations before the 1960 s are rarely available which cannot be applied to explore the long term changes of data sparse lake basins in earlier periods in recent years machine learning algorithms have been widely used to find hidden relationships between driving variables and then the results are applied to make predictions jordan and mitchell 2015 mitchell 1997 hydrological predictions based on driving factors e g climate variables also benefit from the rapid development of machine learning algorithms erickson et al 2021 jing et al 2020 yu et al 2020 given that there exist datasets of climate variables with a long time period of more than one century the machine learning method becomes a possible solution to reconstruct the centenary or longer term hydrologic changes of bosten lake as mentioned above the observations of hydrological variables or remote sensing data of bosten lake are absent in earlier times so that most previous studies focus on investigating the changes of bosten lake in recent decades this also leads to a lack of comprehensive understanding of the hydrological change characteristics and driving forces of bosten lake in different periods keeping these problems in view the main objective of this study is to reconstruct the long time series of the water storage and salinity covariations of bosten lake over the past century by machine learning algorithms moreover we aim to reveal the hidden relationships between climate and hydrological variables which lead to the changes in the water storage and salinity this study is expected to reveal the characteristics of centenary covariations of water salinity and storage of bosten lake and to provide scientific references for protecting local water resources and ecosystems in drylands 2 study area bosten lake 41 56 42 14 n 86 40 87 56 e is the largest inland lake in northwest china fig 1 the length and width of bosten lake are approximately 55 km and 20 km respectively the lake area is approximately 1002 4 km2 at the water level of 1048 75 m nagrengerile and wang 2017 the bosten lake basin is a typical inland desert region with abundant heat dry air and scarce rainfall the annual mean temperature of the lake area is approximately 8 4 accompanied by annual precipitation of only 64 7 mm and mean annual potential evaporation up to 1800 mm bosten lake is mainly supplied by the kaidu river the huangshuigou river the qingshui river and the ushatara river the kaidu river originates from the snow covered tianshan mountains in the northwest which is replenished mainly by precipitation and meltwater it is divided into the east and west branches at the baolangsumu blsm hydrological station in the southeast of yanqi respectively flowing into bosten lake and the adjacent wetland zone after the completion of the xiaerwuxun flood diversion gate in 1964 another river the huangshuigou river was diverted into the kaidu river and the original river channel has become the main sewage channel in the bosten lake region chen et al 2020 in the northern part the qingshui river and the ushatara river supply a small amount of water for bosten lake only in flood season the artificial pumping station the yangshui ys hydrological station being built in 1982 serves as the only outlet of water and salt in bosten lake and pumps water into the kongque river which plays an important role in the supplement of water resources for the downstream desert areas wang et al 2005 across the basin four counties bohu hejing heshuo and yanqi are nurtured by these inflow rivers of bosten lake however along with the large scale development of water and land resources by human activities and climate change impacts in recent decades bosten lake underwent an increase in the lake salinity which seriously affected the stability of watershed ecosystem and its ecological service function guo et al 2015 li and yuan 2002 rusuli et al 2016 tan et al 2004 xu et al 2003 zhong and dong 2008 3 data and methods 3 1 data and processing 3 1 1 multi source data and pre processing of the water level water storage and lake salinity the used dataset of the water level and storage of bosten lake is described in table 1 the gauge based data of the annual water level of bosten lake from 1961 to 2018 were collected from the bosten lake administration in addition the hydroweb database provides time series of water levels in the rivers and lakes around the world based on multi mission satellite altimetry measurements crétaux et al 2011 in this study the satellite based water levels of bosten lake started in 2003 were collected from the site at hydroweb https hydroweb theia land fr as the water level data from the hydroweb database are recorded unevenly in time we calculated the annual and monthly mean values from the original time series considering that hydroweb altimetry observations have different elevation datum from the gauged water levels they were cross evaluated in the overlapping periods to derive the adjusted water levels in 2019 and 2020 another data set of monthly water levels of bosten lake from 1986 to 2019 was collected from the bazhou environmental monitoring station personally provided by dr xiangming tang which was employed to examine the interannual variations of the lake level besides the annual water storage data from 1961 to 2010 was obtained from wu et al 2013 it was used to establish the relationship between the lake level and storage changes of bosten lake the lake salinity data from 1987 to 2010 were collected from the bazhou environmental monitoring station and were used to explore the relationship between the lake salinity and the water level or storage there also exists a few salinity records before 1987 which were extracted from prior literature table 2 however those records before 1987 are short of unified and consistent calculation methods sampling locations and measurement units so they were not used to investigate the relationships between lake salinity and water storage but only used for cross evaluation of the machine learning modeling results 3 1 2 climate variables from the cru dataset climatic research unit cru data set is widely used in different research collins et al 2021 mutti et al 2020 zhao and fu 2006 the data set is constructed by interpolating monthly climate anomalies from monthly observations from weather stations all over the world except antarctica harris et al 2020 the cru ts v 4 05 gridded data sets have a high spatial resolution of 0 5 0 5 and range from 1901 to the present harris et al 2020 including ten monthly climate variables cloud cover diurnal temperature range frost day frequency potential evapotranspiration pet precipitation pre monthly average daily minimum temperature daily mean temperature tmp monthly average daily maximum temperature vapor pressure vap and wet day frequency wet in this study pet pre tmp vap and wet which are considered to be closely related with the lake level variations were selected to reconstruct the changing trajectory of the water level of bosten lake between 1920 and 2020 the boundary of the bosten lake basin was used as a mask to extract the value of five selected climate variables the annual averages of tmp vap and wet were calculated while pet and pre were summarized into the annual summation the cumulative anomaly of each variable was calculated as the input climate data of the machine learning model from 1920 to 2020 3 1 3 spatial observation network of the lake salinity owing to the broad extent spatially heterogeneous hydrological characteristics and the surrounding environmental influences of bosten lake the salinity records of 17 monitoring sites maintained by the bazhou environmental monitoring station in xinjiang were also collected to indicate the inhomogeneous distribution characteristics of lake water salinity sites 1 6 and 15 17 are located in the middle and the east of bosten lake while sites 7 12 and sites 13 14 are located in the inflow estuary of the huangshuigou river and the outlet of the kaidu river in the southwest corner respectively as bosten lake freezes over in winters the lake salinity was only observed at the monitoring sites from may to october the lake salinity data of the 17 monitoring sites used in this study was only sampled for the period of may to october in 2010 personally provided by dr xiangming tang 3 2 methods 3 2 1 extreme gradient boosting tree model considered as a simple and easy to use nonparametric model the decision tree model is one of the most popular machine algorithms representative algorithms of the tree model include random forest gradient boosting decision tree extreme gradient boosting tree xgboost etc xgboost was one of boosting algorithms proposed by chen and guestrin 2016 it was widely used in hydrologic research and proved to be effective in exploring the relationships between variables in a long time series fan et al 2021 ibrahem ahmed osman et al 2021 ni et al 2020 despite the powerful prediction capacity of the xgboost model the greedy method adopted by xgboost is very time consuming when the amount of modeling data is large ma et al 2021 the idea of boosting algorithms is to integrate many weak classifiers to form a strong classifier therefore xgboost integrates many decision trees and then weights and sums the weak classifiers obtained from each round of training to obtain the final classifier the objective function of the model is shown as follows 1 obj i 1 n l y i y i k 1 k ω f k 2 ω f k γ t 1 2 λ j 1 t w j 2 where l is a loss function and l y i y i represents the difference between the predicted value y i and the true value y i k 1 k ω f k is the sum of the complexity of all decision trees where k is the sum of decision trees in the xgboost model it is added to the model to prevent overfitting as a regular item the complexity of decision trees is composed of the number of leaves as t the regularization coefficients as γ and λ and the l2 norm of leaf scores as w j 2 the annual time series of water level and climate variables from 1961 to 2020 were randomly split into the training set and the testing set the training set was composed of 42 year water level data and five climate variables which account for 70 of all samples over the six decades the rest 30 samples were used as the testing set after the training and testing procedures the xgboost model was used to predict the water levels from 1920 to 1960 to avoid the influence of the random split of the training set and the testing set we repeated the above algorithm 500 times based on the randomly split samples and calculated the mean value of all the iteratively predicting results 3 2 2 performance evaluation metrics performance evaluation metrics used in this study for xgboost include mean absolute error mae eq 3 root mean square error rmse eq 4 r square r2 eq 5 and adjusted r square adjusted r2 eq 6 the mae is the absolute of the average of the difference between the predicted value and the true the rmse is the average of the square root of errors the r2 and the adjusted r2 are the statistical indexes that reflect whether the variations of dependent variables could be explained by independent variables through regression relationships the four metrics are calculated as follows specifically 3 mae 1 m i 1 m y i y i 4 rmse 1 m i 1 m y i y i 2 5 r 2 1 i y i y i 2 i y i y i 2 6 adjusted r 2 1 1 r 2 n 1 n p 1 where y i and y i represents the true and predicted value respectively m is the number of observations that are used to estimate the performance of xgboost y i indicates the average of all the predictions n and p are the numbers of samples and features respectively 4 results and analyses 4 1 changes in the water level and storage of bosten lake from 1961 to 2020 the cross evaluation of the annual water levels measured by the bosten lake administration and from hydroweb altimetry observations over the overlapping period of 2003 to 2018 is shown in fig 2 a it indicates a close match and a significant linear correlation with a high r2 value of 0 992 according to the fitting relationship the missing water levels in 2019 and 2020 were calculated based on the hydroweb data to reconstruct the long time series of bosten water levels during 1961 2020 further we examined that the water storage has a positive correlation with the water level time series during 1961 2010 r2 0 977 as shown in fig 2b by referring to the hypsometric curve we can estimate the complete time series of lake water storage for the period 1961 2020 based on water level data the reconstructed time series of annual changes in the water level and storage of bosten lake is illustrated in fig 2c it is clear to observe the substantial changes over the past six decades the variations in the water level and storage of bosten lake could be divided into four different stages from 1961 to 2020 from 1961 to 1987 the water level experienced a drop of approximately 2 7 m and the declining tendency was accelerated with a sharp water level decrease of 2 1 m during the short period of six years 1981 1987 correspondingly the water storage decreased by about 41 compared with that in 1961 from 1988 to 2002 the water level changing trend reversed rapidly and had a substantial increase by 3 3 m at the rate of approximately 0 24 m a meanwhile the water storage increased from 4 48 109 m3 to 7 38 109 m3 the water level and storage around 2000 even went beyond that in the early 1960 s during the periods of 2003 2013 and 2014 2020 the water level and storage change trajectories generally duplicated the first two phases specifically from 2003 to 2013 the water level dropped by about 3 4 m and the water storage decreased by about 2 71 109 m3 from 2014 to 2020 the water level and storage increased by about 2 4 m and 2 18 109 m3 respectively although the water level and storage of bosten lake decreased rapidly in the early 21st century it has experienced a significant recovery in the past seven years and has reached the stages around the early 1960 s 4 2 centenary time series of the water level and salinity of bosten lake reconstructed by xgboost the xgboost model was used to reconstruct the one century water level of bosten lake to indicate the modeling uncertainty the mean values and standard deviations of the predicted water level series of 500 time iterations were calculated and compared with observed water levels in the validation data set fig 3 a moreover the four metrics mae rmse r2 and adjusted r2 were used to quantify the accuracy of the xgboost model on both the training set and the testing set table 3 we can clearly find that the accuracy of the water level predictions using the xgboost model was high with the mae rmse r2 and adjusted r2 reaching 0 31 m 0 37 m 0 85 and 0 84 on the testing set respectively it suggests the results of the xgboost model are reliable and acceptable the predicted result indicated that the water level of bosten lake experienced a sharp decline around 1935 which was close to 20 times the change rate during 1920 1934 this sharp drop in water level could be a response to one of the worst droughts on record at the same time wang and pan 2017 following the sudden decrease the water level gradually increased till the early 1960s based on the collected records of the salinity during 1987 2010 we can find that there is a strong negative correlation of lake variations between the water salinity and storage with an r2 value of 0 964 fig 4 a it should be mentioned that the water storage during the period experienced not only the historical lowest stage 1987 3 96 109 m3 but also the highest level 2002 7 38 109 m3 thus the statistical relationship could be applied to reconstruct the lake salinity from the century scale water level and storage time series based on the water storage series and its relationship with the lake salinity we reconstructed the lake salinity of bosten lake from 1920 to 2020 the reconstructed long time series of the lake salinity is shown in fig 4b which showed substantial periodic changes during the past century the lake salinity increased slowly by 0 09 g l in the 1920 s and started to exceed 1 40 g l in the early 1930 s in correspondence with the abrupt decline of water level in 1935 the lake salinity showed a substantial increase and kept at high values around 1 60 g l between 1935 and 1944 thereafter the lake salinity began to decrease at a rate of 0 01 g l per year until 1964 afterward it showed a sharp increase from 1 27 to 1 87 g l between 1964 and 1987 reaching the historical peak of 1 87 g l in 1987 however the lake salinity was soon observed a continuous downward even faster than before and reached the bottom of 1 19 g l in 2002 in the first two decades of the 21st century another decadal oscillation was observed and the lake salinity went up to 1 84 g l in 2013 lower than that in 1987 by 0 03 g l and then declined rapidly by approximately 0 60 g l during 2013 2020 4 3 relationships between the water level and salinity variations and key climate variables the synchronization relationships between the water level and salinity variations of bosten lake and five key climate variables were further examined fig 5 in fig 5f o the yellow color highlighted regions represent the periods when the water level and salinity were significantly influenced by such climate variables the arrow direction means the correlation between the input variables specifically the arrows from left to right and right to left indicate in phase and anti phase respectively for both the water level and salinity the influencing patterns were similar and contrary for each climate variable vap and pre accompanying the clearest influencing phases showed the most significant influences on water level and salinity variations followed by wet tmp and pet as shown in fig 5h vap showed in phase correlations with the water level in 12 28 years bands from 1960 to 2020 indicating that the water level was in a 12 28 years fluctuation of increase corresponding to the rise of vap despite the slight anti phase correlations appearing in 24 34 years band during 1970 2020 pre showed significant in phase correlations with the water level and anti phase correlations with the lake salinity in 2 10 years band regions all the periods fig 5g 5 l the influence of wet on the water level and salinity was concentrated in the 1 8 years band during 1940 1990 and tmp had a similar influence in the 6 12 years band during 1960 1990 in other periods clear influencing regions were absent in wet tmp and pet overall vap and pre were considered the primary factors that impact the water level and salinity changes of bosten lake 5 discussions 5 1 the spatial distribution and intra annual variation characteristics of the lake salinity our results reconstructed the centenary variations of the water storage and salinity of bosten lake however for the lake salinity the presented results are limited to annual scale and lake wide averages there are different levels of socioeconomic activities or natural conditions in different periods or areas around the lake which may induce inhomogeneous changes in lake salinity over time and space to understand bosten lake at a finer scale and to protect its ecology the spatial distribution and intra annual variations of the lake salinity deserve to be investigated further as shown in fig 6 the spatial distribution of water salinity in bosten lake was characterized by strong heterogeneity the salinity observed at sites 7 12 which were located at the northwest corner of the lake was significantly higher it was mainly because the northwest corner is the drainage area of the huangshuigou river most of the agricultural and industrial wastewater produced by the four counties located in the bosten lake basin was discharged into bosten lake from here on the contrary sites 13 14 were located near the outlet of the kaidu river which is supplied by precipitation runoff and meltwater a great amount of fresh water flowed into bosten lake and desalinated the water thus the salinity observed here had the lowest value and was mostly less than 1 00 g l their salinity level reached the freshwater standard in most months as for sites 1 6 and 15 17 that were in the center or the east part of the lake the observed salinity showed slight differences of less than 0 10 g l mostly maintained at 1 35 1 60 g l during the whole warm season that was mainly because this part is far away from the ys station in the southeast which serves as the only outlet of the whole lake it is thus difficult to form effective water exchanges and results in a longer hydraulic residence time in the central and eastern lake lu et al 2015 the lake salinity change was also characterized by the evident intra annual variability see fig 7 the annual lake salinity has a close relationship with the water level so the monthly variation of water salinity could be represented by changes in the water level to some extent fig 7a illustrates the normalized monthly water levels and the multi year averages in 1986 2020 it is clear to observe the seasonal cycle of water level changes in most years with positive annual water budgeting the lake level reaches the lowest in january and the highest in august or september in springs and summers the water level gradually ascends with the increasing supply of snow ice meltwater and precipitation runoff while from autumn to winter the decreasing river discharges that cannot offset the strong evaporation make the water level decline rapidly the intra annual variations of lake salinity can generally display the corresponding response to water level changes according to the monthly salinity of 17 monitoring sites in bosten lake fig 7b the observations mainly had salinity higher than 1 50 g l from may to july while from august to september the salinity for most sites was below 1 50 g l 5 2 comparison of the water storage and salinity reconstruction results and its influencing factors with previous studies in this study the water storage and salinity of bosten lake were reconstructed by xgboost using five climate variables with a century of continuous records and the statistical relationship between the lake salinity and water storage we obtained time series of the water storage and salinity with a longer time span and better continuity compared with previous studies the reconstruction results revealed that the lake salinity underwent six fluctuations synchronized with the water level and storage from 1920 to 2020 with the highest value in 1987 and the lowest value in 2002 the relationships between climate variables and hydrological variables are also revealed during the past century the water salinity and storage of bosten lake were influenced chiefly by vapor pressure and precipitation followed by wet day frequency daily mean temperature and potential evapotranspiration the results show a high agreement with the findings of guo et al 2015 who used a water balance model and the climate elasticity method to explore the reasons for the water level changes of bosten lake they found an increase in evaporation led to a continuous decrease in lake level from 1958 to 1987 from 2003 to 2010 the lake inflow obviously decreased because of a decrease in precipitation further our reconstruction of the changes of the lake salinity agreed with zuo et al 2006 it presented the quantitative model that describes the systems of water quantity water quality ecology in an integrated way and that simulates the changing processes of lake salinization in the past it is worth noting that our results contradict the views of a few earlier studies on the changes of the lake salinity for example wu et al 2013 tended to suggest that the lake salinity of bosten lake was less than 1 g l between 1961 and 1970 whereas our results showed that the minimum content of salinity of bosten lake has been above 1 g l since 1920 till now this may be because the previous studies calculated the time series of the lake salinity by linear regression directly for the missing values they used several salinity dispersions before the 1980 s which are listed in table 2 and the salinity values measured in 1958 to perform a linear regression for supplementing the pre 1980 s time series of the lake salinity however the lake salinity measured in 1958 was the average value of three samples that were collected at the outlet of the kaidu river in the southwest corner of bosten lake wang et al 2005 the spatial distribution of the lake salinity in bosten lake as discussed above in section 5 1 indicates that the water salinity here is severely lower than the average of the whole lake salinities which may lead to the underestimation of the lake salinity in earlier reports 5 3 uncertainty of the statistical and machine learning modeling of lake salinity the lake salinity results derived from the statistical and machine learning modeling cannot avoid various uncertainties due to the limited spatial and temporal coverage of input data the data accuracy and the inherently complicated processes of lake salinity associated with hydrological and climatological variables in this study five climate variables of the cru datasets served as the input data and were used to reconstruct the centenary time series of the water level and salinity of bosten lake thus the reliability of the cru dataset may partially account for the modeling performances to estimate the accuracy of the cru dataset tmp pet and pre were examined with monthly available data of four weather stations within the bosten lake basin from the china meteorological data sharing service system http cdc cma gov cn and there were close relationships between them fig 8 the cru datasets were considered to be acceptable for modeling the climatological influences of lake water balance while the modeling results based on climate variables only reflect the natural driver of lake changes the absent consideration of influences of human activities also led to the bias of the modeling result from 1960 to 1980 intensified agricultural activities happened in the bosten lake basin zhou et al 2014 fig 9 shows that the agricultural water diversion increased significantly with the continuous rise of irrigation area at the same time a great quantity of farmland irrigation wastewater entered bosten lake and elevated the water salinity due to the implementation of agricultural irrigation water saving projects and the improvement of agricultural technology the amount of agricultural water diversion gradually decreased and showed a stable trend after 1985 considering that the statistical model of lake salinity was established for the period of 1987 2010 and there were few agricultural activities in the bosten lake basin before 1961 tan et al 2004 we may underestimate the lake salinity the periods of 1961 1986 and 2010 2020 and overestimate it during 1920 1960 consistent with the speculation the predicted water salinity was lower than the measurement records in several scattered years in 1961 1986 as shown in fig 4b for example the lake salinity simulated by the model has a negative bias of 6 25 from the observed value in 1975 however the differences were up to 10 20 during 1980 1986 the drastic increase of salinity in agricultural sewage could be the main reason for such modeling biases 6 conclusions in this study we aimed to reconstruct the centenary covariations of the lake salinity with the water storage changes of bosten lake by the statistical model and xgboost machine learning method the multi source data including in situ measurement records the hydroweb based satellite altimetry database and those from previously published literature were cross evaluated to explore the changes in the water level and storage of bosten lake from 1961 to 2020 the centenary time series of water levels were reconstructed by xgboost which revealed the hidden relationships between the lake level and climate variables tmp pre vap pet and wet the four performance evaluation metrics mae rmse r2 and adjusted r2 were examined with the value of 0 31 m 0 37 m 0 85 and 0 84 on the testing set indicating that the result was reliable in combination with the statistical model of the water salinity and storage centenary time series of changes in salinity was accessible overall the lake salinity showed a close negative correlation with the water storage with an r2 value reaching 0 96 it underwent six fluctuations during the past century with the highest value of 1 87 g l in 1987 and the lowest value of 1 19 g l in 2002 despite the continuous rise in 1960 1987 and the high value appearing in the early 2010 s it experienced a significant recovery in the past seven years and has decreased to the comparable level of the 1960 s furthermore the associations of the water level and salinity with climate variables were analyzed the annual changes in the water level and salinity were mostly influenced by vap and pre followed by wet tmp and pet the spatial distribution and the intra annual variation of the lake salinity were examined in this study the salinity was high in the northwest part of the lake and low in the southwest which was mainly influenced by a large amount of high salinity wastewater flowing into the lake from different sources the salinity showed a slight difference in the center and east part of the lake because of the less frequent water exchange and longer hydraulic residence time at the locations far away from the only lake outlet with an artificial pumping station in most cases intra annual variation of the lake salinity changed with the water level synchronously similar to the annual pattern the reconstruction results of the water storage and salinity were compared with previous studies and the underestimation of lake salinity in previous studies may come from the fact that the used sampling data were not representative of the average level of lake salinity of bosten lake the uncertainty of the reconstruction of water salinity was eventually discussed including the data accuracy and the ignored influences from anthropogenic activities this study can advance the scientific understanding of both characteristics of the water salinity and storage changes of the largest inland lake bosten lake in arid semi arid northwest china and its hydrological response to both natural and artificial factors during the past century further research will extend the technical approach and scientific exploration to other lakes in semi arid and arid regions due to the lack of historical and local observation data credit authorship contribution statement xingan jiang conceptualization data curation formal analysis investigation methodology validation visualization writing original draft chenyu fan data curation formal analysis methodology supervision kai liu investigation project administration resources supervision validation tan chen investigation validation zhigang cao methodology supervision chunqiao song conceptualization data curation formal analysis funding acquisition methodology project administration resources supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partly funded by the national key research and development program of china grant no 2019yfa0607101 2018yfd0900804 and 2018yfd1100101 the strategic priority research program of the chinese academy of sciences grant no xda23100102 and the national natural science foundation of china no 41971403 41801321 we would like to thank the two anonymous reviewers whose suggestions greatly strengthened the work appendix a table 4 acronyms that are used in this study acronym full name description blsm the baolangsumu hydrological station a hydrological station in the bosten lake basin ys the yangshui hydrological station a hydrological station in the bosten lake basin tsd the tashidian hydrological station a hydrological station in the bosten lake basin koral the koral country a country near the bosten lake basin bohu the bohu country a country in the bosten lake basin heshuo the heshuo country a country in the bosten lake basin hejing the hejing country a country in the bosten lake basin yanqi the yanqi country a country in the bosten lake basin xgboost extreme gradient boosting a machine learning model cru climatic research unit a climate dataset containing ten climate variables pet potential evapotranspiration one of the climate variables in cru pre precipitation one of the climate variables in cru tmp daily mean temperature one of the climate variables in cru vap vapor pressure one of the climate variables in cru wet wet day frequency one of the climate variables in cru mae mean absolute error an evaluation metrics for machine learning models rmse root mean square error an evaluation metrics for machine learning models r2 r square an evaluation metrics for machine learning models adjusted r2 adjusted r square an evaluation metrics for machine learning models 
3218,in the context of accelerating climate changes and economic boom in the past decades lakes have undergone drasticchanges worldwide particularly in arid and semi arid regions those lakes were severely impacted and threatened due to their hydrologic sensitivity and ecological vulnerability as the largest lake in northwest china with arid climate bosten lake provides precious water resources and ecosystem services to local communities although a large quantity of earlier efforts have been paid on bosten lake there is still absence of tracking its changing trajectory at a long timescale e g one century which restricts the holistic understanding of the decadal periodic lake desiccations and their driving forces this study employs a machine learning method to reconstruct the centenary covariations of water storage and salinity of bosten lake by integrating multi source data the results showed that compared with the high stage of 6 76 109 m3 in 1961 the lake water storage substantially dropped twice to 3 96 109 m3 in 1987 and 4 67 109 m3 in 2013 in recent years the lake level rose rapidly and recovered back to the comparable stage of the 1960 s by 2020 four metrics of accuracy evaluation employed in this study indicate the reliability of the xgboost model with the mean absolute error of 0 31 m mean squared error of 0 37 m r square of 0 85 and adjusted r square of 0 84 the centenary reconstruction results reveal that the lake salinity underwent six phase fluctuations with the water level and storage changes during 1920 2020 with the highest value of 1 87 g l in 1987 and the lowest value of 1 19 g l in 2002 during the past century the water salinity and storage of bosten lake were influenced chiefly by vapor pressure and precipitation followed by wet day frequency daily mean temperature and potential evapotranspiration moreover the uncertainty of the machine learning model was also explored and discussed it could be mainly associated with the data accuracy of input climate variables and the ignorance of environmental impacts from the intense agricultural activities after the 1960 s this study is expected to advance the scientific understanding of long term change characteristics of bosten lake and to provide a technical reference of reconstructing centenary hydrologic and environmental trajectory for dryland lakes keywords lake water storage salinity bosten lake machine learning climate change data availability no data was used for the research described in the article 1 introduction as an indispensable component of the hydrological cycle lakes influence the environment in many aspects and provide ecosystem services to local communities abd elaty et al 2021a bai et al 2011 lehner and döll 2004 ma et al 2007 mueller et al 2016 rinke et al 2019 in the context of the accelerating climate changes and economic boom worldwide numerous lakes have undergone unprecedented changes in the area water storage and water quality in the past decades abd elaty et al 2021b han et al 2022 pickens et al 2020 song et al 2014 song et al 2020 particularly lakes in semi arid and arid regions were extremely vulnerable and slight natural or anthropogenic disturbances may trigger serious consequences bai et al 2021 fang et al 2018 fu et al 2021 seitz et al 2022 tan et al 2018 for instance the water storage of the aral sea shrank by 87 85 over the past several decades due to human activities and climate warming yang et al 2020 such lake degradations can also be observed in other drylands worldwide in iran lake urmia has suffered a substantial reduction in water storage since the second half of the 20th century hosseini moghari et al 2020 in china over 50 of the lakes in semi arid and arid regions became desiccated intermittently in recent decades mainly because of the drying climate liu et al 2013 overall advancing the knowledge of lake hydrological and water quality changes in semi arid and arid regions is urgently needed to protect the local environment and to manage water resources the arid semi arid area in northwest china is one of the driest lands among all regions at the same latitudes wang and qin 2017 the topographic influence of the high altitude tibetan plateau and the location far away from the sea make it suffer intensified droughts over the past several decades qiang et al 2000 as the largest lake in this arid area bosten lake is widespread concerned for example wang et al 2018 developed an index system for evaluating the water environment carrying capacity in the bosten lake basin guo et al 2015 analyzed the salinization processes of bosten lake from 1960 to 2010 also there are many other studies that tried to explore the dynamic changes of bosten lake in response to climate changes and anthropogenic influences in the last decades dai et al 2020 liu et al 2020 yao et al 2018 however most of these studies focus on the changes of bosten lake in recent decades owing to the lack of earlier historical in situ observations considering that the changes of bosten lake may behave with heterogeneous characteristics in different historic periods fontana et al 2019 tarasov et al 2019 the absence of a holistic picture of the change trajectory in long term is unfavorable to the macroscopic understanding of hydrological and environmental evolutions of bosten lake thus it is pressing to explore the bosten lake changes in longer time series by employing state of the art techniques the hydrological model is a traditional way to quantify changes of hydrological elements devia et al 2015 over the past several decades many powerful models have been developed and improved adnan et al 2019 janssen et al 2021 teklay et al 2021 however hydrological models require a bunch of observation data to serve as the model inputs making them unsuitable for the remote regions lacking historical in situ observations since the late 20th century remote sensing has been employed as an efficient and simple solution to monitor lakes in more and more research benveniste and berry 2004 deoli et al 2021 duan and niu 2018 lu et al 2013 unfortunately the satellite remote sensing observations before the 1960 s are rarely available which cannot be applied to explore the long term changes of data sparse lake basins in earlier periods in recent years machine learning algorithms have been widely used to find hidden relationships between driving variables and then the results are applied to make predictions jordan and mitchell 2015 mitchell 1997 hydrological predictions based on driving factors e g climate variables also benefit from the rapid development of machine learning algorithms erickson et al 2021 jing et al 2020 yu et al 2020 given that there exist datasets of climate variables with a long time period of more than one century the machine learning method becomes a possible solution to reconstruct the centenary or longer term hydrologic changes of bosten lake as mentioned above the observations of hydrological variables or remote sensing data of bosten lake are absent in earlier times so that most previous studies focus on investigating the changes of bosten lake in recent decades this also leads to a lack of comprehensive understanding of the hydrological change characteristics and driving forces of bosten lake in different periods keeping these problems in view the main objective of this study is to reconstruct the long time series of the water storage and salinity covariations of bosten lake over the past century by machine learning algorithms moreover we aim to reveal the hidden relationships between climate and hydrological variables which lead to the changes in the water storage and salinity this study is expected to reveal the characteristics of centenary covariations of water salinity and storage of bosten lake and to provide scientific references for protecting local water resources and ecosystems in drylands 2 study area bosten lake 41 56 42 14 n 86 40 87 56 e is the largest inland lake in northwest china fig 1 the length and width of bosten lake are approximately 55 km and 20 km respectively the lake area is approximately 1002 4 km2 at the water level of 1048 75 m nagrengerile and wang 2017 the bosten lake basin is a typical inland desert region with abundant heat dry air and scarce rainfall the annual mean temperature of the lake area is approximately 8 4 accompanied by annual precipitation of only 64 7 mm and mean annual potential evaporation up to 1800 mm bosten lake is mainly supplied by the kaidu river the huangshuigou river the qingshui river and the ushatara river the kaidu river originates from the snow covered tianshan mountains in the northwest which is replenished mainly by precipitation and meltwater it is divided into the east and west branches at the baolangsumu blsm hydrological station in the southeast of yanqi respectively flowing into bosten lake and the adjacent wetland zone after the completion of the xiaerwuxun flood diversion gate in 1964 another river the huangshuigou river was diverted into the kaidu river and the original river channel has become the main sewage channel in the bosten lake region chen et al 2020 in the northern part the qingshui river and the ushatara river supply a small amount of water for bosten lake only in flood season the artificial pumping station the yangshui ys hydrological station being built in 1982 serves as the only outlet of water and salt in bosten lake and pumps water into the kongque river which plays an important role in the supplement of water resources for the downstream desert areas wang et al 2005 across the basin four counties bohu hejing heshuo and yanqi are nurtured by these inflow rivers of bosten lake however along with the large scale development of water and land resources by human activities and climate change impacts in recent decades bosten lake underwent an increase in the lake salinity which seriously affected the stability of watershed ecosystem and its ecological service function guo et al 2015 li and yuan 2002 rusuli et al 2016 tan et al 2004 xu et al 2003 zhong and dong 2008 3 data and methods 3 1 data and processing 3 1 1 multi source data and pre processing of the water level water storage and lake salinity the used dataset of the water level and storage of bosten lake is described in table 1 the gauge based data of the annual water level of bosten lake from 1961 to 2018 were collected from the bosten lake administration in addition the hydroweb database provides time series of water levels in the rivers and lakes around the world based on multi mission satellite altimetry measurements crétaux et al 2011 in this study the satellite based water levels of bosten lake started in 2003 were collected from the site at hydroweb https hydroweb theia land fr as the water level data from the hydroweb database are recorded unevenly in time we calculated the annual and monthly mean values from the original time series considering that hydroweb altimetry observations have different elevation datum from the gauged water levels they were cross evaluated in the overlapping periods to derive the adjusted water levels in 2019 and 2020 another data set of monthly water levels of bosten lake from 1986 to 2019 was collected from the bazhou environmental monitoring station personally provided by dr xiangming tang which was employed to examine the interannual variations of the lake level besides the annual water storage data from 1961 to 2010 was obtained from wu et al 2013 it was used to establish the relationship between the lake level and storage changes of bosten lake the lake salinity data from 1987 to 2010 were collected from the bazhou environmental monitoring station and were used to explore the relationship between the lake salinity and the water level or storage there also exists a few salinity records before 1987 which were extracted from prior literature table 2 however those records before 1987 are short of unified and consistent calculation methods sampling locations and measurement units so they were not used to investigate the relationships between lake salinity and water storage but only used for cross evaluation of the machine learning modeling results 3 1 2 climate variables from the cru dataset climatic research unit cru data set is widely used in different research collins et al 2021 mutti et al 2020 zhao and fu 2006 the data set is constructed by interpolating monthly climate anomalies from monthly observations from weather stations all over the world except antarctica harris et al 2020 the cru ts v 4 05 gridded data sets have a high spatial resolution of 0 5 0 5 and range from 1901 to the present harris et al 2020 including ten monthly climate variables cloud cover diurnal temperature range frost day frequency potential evapotranspiration pet precipitation pre monthly average daily minimum temperature daily mean temperature tmp monthly average daily maximum temperature vapor pressure vap and wet day frequency wet in this study pet pre tmp vap and wet which are considered to be closely related with the lake level variations were selected to reconstruct the changing trajectory of the water level of bosten lake between 1920 and 2020 the boundary of the bosten lake basin was used as a mask to extract the value of five selected climate variables the annual averages of tmp vap and wet were calculated while pet and pre were summarized into the annual summation the cumulative anomaly of each variable was calculated as the input climate data of the machine learning model from 1920 to 2020 3 1 3 spatial observation network of the lake salinity owing to the broad extent spatially heterogeneous hydrological characteristics and the surrounding environmental influences of bosten lake the salinity records of 17 monitoring sites maintained by the bazhou environmental monitoring station in xinjiang were also collected to indicate the inhomogeneous distribution characteristics of lake water salinity sites 1 6 and 15 17 are located in the middle and the east of bosten lake while sites 7 12 and sites 13 14 are located in the inflow estuary of the huangshuigou river and the outlet of the kaidu river in the southwest corner respectively as bosten lake freezes over in winters the lake salinity was only observed at the monitoring sites from may to october the lake salinity data of the 17 monitoring sites used in this study was only sampled for the period of may to october in 2010 personally provided by dr xiangming tang 3 2 methods 3 2 1 extreme gradient boosting tree model considered as a simple and easy to use nonparametric model the decision tree model is one of the most popular machine algorithms representative algorithms of the tree model include random forest gradient boosting decision tree extreme gradient boosting tree xgboost etc xgboost was one of boosting algorithms proposed by chen and guestrin 2016 it was widely used in hydrologic research and proved to be effective in exploring the relationships between variables in a long time series fan et al 2021 ibrahem ahmed osman et al 2021 ni et al 2020 despite the powerful prediction capacity of the xgboost model the greedy method adopted by xgboost is very time consuming when the amount of modeling data is large ma et al 2021 the idea of boosting algorithms is to integrate many weak classifiers to form a strong classifier therefore xgboost integrates many decision trees and then weights and sums the weak classifiers obtained from each round of training to obtain the final classifier the objective function of the model is shown as follows 1 obj i 1 n l y i y i k 1 k ω f k 2 ω f k γ t 1 2 λ j 1 t w j 2 where l is a loss function and l y i y i represents the difference between the predicted value y i and the true value y i k 1 k ω f k is the sum of the complexity of all decision trees where k is the sum of decision trees in the xgboost model it is added to the model to prevent overfitting as a regular item the complexity of decision trees is composed of the number of leaves as t the regularization coefficients as γ and λ and the l2 norm of leaf scores as w j 2 the annual time series of water level and climate variables from 1961 to 2020 were randomly split into the training set and the testing set the training set was composed of 42 year water level data and five climate variables which account for 70 of all samples over the six decades the rest 30 samples were used as the testing set after the training and testing procedures the xgboost model was used to predict the water levels from 1920 to 1960 to avoid the influence of the random split of the training set and the testing set we repeated the above algorithm 500 times based on the randomly split samples and calculated the mean value of all the iteratively predicting results 3 2 2 performance evaluation metrics performance evaluation metrics used in this study for xgboost include mean absolute error mae eq 3 root mean square error rmse eq 4 r square r2 eq 5 and adjusted r square adjusted r2 eq 6 the mae is the absolute of the average of the difference between the predicted value and the true the rmse is the average of the square root of errors the r2 and the adjusted r2 are the statistical indexes that reflect whether the variations of dependent variables could be explained by independent variables through regression relationships the four metrics are calculated as follows specifically 3 mae 1 m i 1 m y i y i 4 rmse 1 m i 1 m y i y i 2 5 r 2 1 i y i y i 2 i y i y i 2 6 adjusted r 2 1 1 r 2 n 1 n p 1 where y i and y i represents the true and predicted value respectively m is the number of observations that are used to estimate the performance of xgboost y i indicates the average of all the predictions n and p are the numbers of samples and features respectively 4 results and analyses 4 1 changes in the water level and storage of bosten lake from 1961 to 2020 the cross evaluation of the annual water levels measured by the bosten lake administration and from hydroweb altimetry observations over the overlapping period of 2003 to 2018 is shown in fig 2 a it indicates a close match and a significant linear correlation with a high r2 value of 0 992 according to the fitting relationship the missing water levels in 2019 and 2020 were calculated based on the hydroweb data to reconstruct the long time series of bosten water levels during 1961 2020 further we examined that the water storage has a positive correlation with the water level time series during 1961 2010 r2 0 977 as shown in fig 2b by referring to the hypsometric curve we can estimate the complete time series of lake water storage for the period 1961 2020 based on water level data the reconstructed time series of annual changes in the water level and storage of bosten lake is illustrated in fig 2c it is clear to observe the substantial changes over the past six decades the variations in the water level and storage of bosten lake could be divided into four different stages from 1961 to 2020 from 1961 to 1987 the water level experienced a drop of approximately 2 7 m and the declining tendency was accelerated with a sharp water level decrease of 2 1 m during the short period of six years 1981 1987 correspondingly the water storage decreased by about 41 compared with that in 1961 from 1988 to 2002 the water level changing trend reversed rapidly and had a substantial increase by 3 3 m at the rate of approximately 0 24 m a meanwhile the water storage increased from 4 48 109 m3 to 7 38 109 m3 the water level and storage around 2000 even went beyond that in the early 1960 s during the periods of 2003 2013 and 2014 2020 the water level and storage change trajectories generally duplicated the first two phases specifically from 2003 to 2013 the water level dropped by about 3 4 m and the water storage decreased by about 2 71 109 m3 from 2014 to 2020 the water level and storage increased by about 2 4 m and 2 18 109 m3 respectively although the water level and storage of bosten lake decreased rapidly in the early 21st century it has experienced a significant recovery in the past seven years and has reached the stages around the early 1960 s 4 2 centenary time series of the water level and salinity of bosten lake reconstructed by xgboost the xgboost model was used to reconstruct the one century water level of bosten lake to indicate the modeling uncertainty the mean values and standard deviations of the predicted water level series of 500 time iterations were calculated and compared with observed water levels in the validation data set fig 3 a moreover the four metrics mae rmse r2 and adjusted r2 were used to quantify the accuracy of the xgboost model on both the training set and the testing set table 3 we can clearly find that the accuracy of the water level predictions using the xgboost model was high with the mae rmse r2 and adjusted r2 reaching 0 31 m 0 37 m 0 85 and 0 84 on the testing set respectively it suggests the results of the xgboost model are reliable and acceptable the predicted result indicated that the water level of bosten lake experienced a sharp decline around 1935 which was close to 20 times the change rate during 1920 1934 this sharp drop in water level could be a response to one of the worst droughts on record at the same time wang and pan 2017 following the sudden decrease the water level gradually increased till the early 1960s based on the collected records of the salinity during 1987 2010 we can find that there is a strong negative correlation of lake variations between the water salinity and storage with an r2 value of 0 964 fig 4 a it should be mentioned that the water storage during the period experienced not only the historical lowest stage 1987 3 96 109 m3 but also the highest level 2002 7 38 109 m3 thus the statistical relationship could be applied to reconstruct the lake salinity from the century scale water level and storage time series based on the water storage series and its relationship with the lake salinity we reconstructed the lake salinity of bosten lake from 1920 to 2020 the reconstructed long time series of the lake salinity is shown in fig 4b which showed substantial periodic changes during the past century the lake salinity increased slowly by 0 09 g l in the 1920 s and started to exceed 1 40 g l in the early 1930 s in correspondence with the abrupt decline of water level in 1935 the lake salinity showed a substantial increase and kept at high values around 1 60 g l between 1935 and 1944 thereafter the lake salinity began to decrease at a rate of 0 01 g l per year until 1964 afterward it showed a sharp increase from 1 27 to 1 87 g l between 1964 and 1987 reaching the historical peak of 1 87 g l in 1987 however the lake salinity was soon observed a continuous downward even faster than before and reached the bottom of 1 19 g l in 2002 in the first two decades of the 21st century another decadal oscillation was observed and the lake salinity went up to 1 84 g l in 2013 lower than that in 1987 by 0 03 g l and then declined rapidly by approximately 0 60 g l during 2013 2020 4 3 relationships between the water level and salinity variations and key climate variables the synchronization relationships between the water level and salinity variations of bosten lake and five key climate variables were further examined fig 5 in fig 5f o the yellow color highlighted regions represent the periods when the water level and salinity were significantly influenced by such climate variables the arrow direction means the correlation between the input variables specifically the arrows from left to right and right to left indicate in phase and anti phase respectively for both the water level and salinity the influencing patterns were similar and contrary for each climate variable vap and pre accompanying the clearest influencing phases showed the most significant influences on water level and salinity variations followed by wet tmp and pet as shown in fig 5h vap showed in phase correlations with the water level in 12 28 years bands from 1960 to 2020 indicating that the water level was in a 12 28 years fluctuation of increase corresponding to the rise of vap despite the slight anti phase correlations appearing in 24 34 years band during 1970 2020 pre showed significant in phase correlations with the water level and anti phase correlations with the lake salinity in 2 10 years band regions all the periods fig 5g 5 l the influence of wet on the water level and salinity was concentrated in the 1 8 years band during 1940 1990 and tmp had a similar influence in the 6 12 years band during 1960 1990 in other periods clear influencing regions were absent in wet tmp and pet overall vap and pre were considered the primary factors that impact the water level and salinity changes of bosten lake 5 discussions 5 1 the spatial distribution and intra annual variation characteristics of the lake salinity our results reconstructed the centenary variations of the water storage and salinity of bosten lake however for the lake salinity the presented results are limited to annual scale and lake wide averages there are different levels of socioeconomic activities or natural conditions in different periods or areas around the lake which may induce inhomogeneous changes in lake salinity over time and space to understand bosten lake at a finer scale and to protect its ecology the spatial distribution and intra annual variations of the lake salinity deserve to be investigated further as shown in fig 6 the spatial distribution of water salinity in bosten lake was characterized by strong heterogeneity the salinity observed at sites 7 12 which were located at the northwest corner of the lake was significantly higher it was mainly because the northwest corner is the drainage area of the huangshuigou river most of the agricultural and industrial wastewater produced by the four counties located in the bosten lake basin was discharged into bosten lake from here on the contrary sites 13 14 were located near the outlet of the kaidu river which is supplied by precipitation runoff and meltwater a great amount of fresh water flowed into bosten lake and desalinated the water thus the salinity observed here had the lowest value and was mostly less than 1 00 g l their salinity level reached the freshwater standard in most months as for sites 1 6 and 15 17 that were in the center or the east part of the lake the observed salinity showed slight differences of less than 0 10 g l mostly maintained at 1 35 1 60 g l during the whole warm season that was mainly because this part is far away from the ys station in the southeast which serves as the only outlet of the whole lake it is thus difficult to form effective water exchanges and results in a longer hydraulic residence time in the central and eastern lake lu et al 2015 the lake salinity change was also characterized by the evident intra annual variability see fig 7 the annual lake salinity has a close relationship with the water level so the monthly variation of water salinity could be represented by changes in the water level to some extent fig 7a illustrates the normalized monthly water levels and the multi year averages in 1986 2020 it is clear to observe the seasonal cycle of water level changes in most years with positive annual water budgeting the lake level reaches the lowest in january and the highest in august or september in springs and summers the water level gradually ascends with the increasing supply of snow ice meltwater and precipitation runoff while from autumn to winter the decreasing river discharges that cannot offset the strong evaporation make the water level decline rapidly the intra annual variations of lake salinity can generally display the corresponding response to water level changes according to the monthly salinity of 17 monitoring sites in bosten lake fig 7b the observations mainly had salinity higher than 1 50 g l from may to july while from august to september the salinity for most sites was below 1 50 g l 5 2 comparison of the water storage and salinity reconstruction results and its influencing factors with previous studies in this study the water storage and salinity of bosten lake were reconstructed by xgboost using five climate variables with a century of continuous records and the statistical relationship between the lake salinity and water storage we obtained time series of the water storage and salinity with a longer time span and better continuity compared with previous studies the reconstruction results revealed that the lake salinity underwent six fluctuations synchronized with the water level and storage from 1920 to 2020 with the highest value in 1987 and the lowest value in 2002 the relationships between climate variables and hydrological variables are also revealed during the past century the water salinity and storage of bosten lake were influenced chiefly by vapor pressure and precipitation followed by wet day frequency daily mean temperature and potential evapotranspiration the results show a high agreement with the findings of guo et al 2015 who used a water balance model and the climate elasticity method to explore the reasons for the water level changes of bosten lake they found an increase in evaporation led to a continuous decrease in lake level from 1958 to 1987 from 2003 to 2010 the lake inflow obviously decreased because of a decrease in precipitation further our reconstruction of the changes of the lake salinity agreed with zuo et al 2006 it presented the quantitative model that describes the systems of water quantity water quality ecology in an integrated way and that simulates the changing processes of lake salinization in the past it is worth noting that our results contradict the views of a few earlier studies on the changes of the lake salinity for example wu et al 2013 tended to suggest that the lake salinity of bosten lake was less than 1 g l between 1961 and 1970 whereas our results showed that the minimum content of salinity of bosten lake has been above 1 g l since 1920 till now this may be because the previous studies calculated the time series of the lake salinity by linear regression directly for the missing values they used several salinity dispersions before the 1980 s which are listed in table 2 and the salinity values measured in 1958 to perform a linear regression for supplementing the pre 1980 s time series of the lake salinity however the lake salinity measured in 1958 was the average value of three samples that were collected at the outlet of the kaidu river in the southwest corner of bosten lake wang et al 2005 the spatial distribution of the lake salinity in bosten lake as discussed above in section 5 1 indicates that the water salinity here is severely lower than the average of the whole lake salinities which may lead to the underestimation of the lake salinity in earlier reports 5 3 uncertainty of the statistical and machine learning modeling of lake salinity the lake salinity results derived from the statistical and machine learning modeling cannot avoid various uncertainties due to the limited spatial and temporal coverage of input data the data accuracy and the inherently complicated processes of lake salinity associated with hydrological and climatological variables in this study five climate variables of the cru datasets served as the input data and were used to reconstruct the centenary time series of the water level and salinity of bosten lake thus the reliability of the cru dataset may partially account for the modeling performances to estimate the accuracy of the cru dataset tmp pet and pre were examined with monthly available data of four weather stations within the bosten lake basin from the china meteorological data sharing service system http cdc cma gov cn and there were close relationships between them fig 8 the cru datasets were considered to be acceptable for modeling the climatological influences of lake water balance while the modeling results based on climate variables only reflect the natural driver of lake changes the absent consideration of influences of human activities also led to the bias of the modeling result from 1960 to 1980 intensified agricultural activities happened in the bosten lake basin zhou et al 2014 fig 9 shows that the agricultural water diversion increased significantly with the continuous rise of irrigation area at the same time a great quantity of farmland irrigation wastewater entered bosten lake and elevated the water salinity due to the implementation of agricultural irrigation water saving projects and the improvement of agricultural technology the amount of agricultural water diversion gradually decreased and showed a stable trend after 1985 considering that the statistical model of lake salinity was established for the period of 1987 2010 and there were few agricultural activities in the bosten lake basin before 1961 tan et al 2004 we may underestimate the lake salinity the periods of 1961 1986 and 2010 2020 and overestimate it during 1920 1960 consistent with the speculation the predicted water salinity was lower than the measurement records in several scattered years in 1961 1986 as shown in fig 4b for example the lake salinity simulated by the model has a negative bias of 6 25 from the observed value in 1975 however the differences were up to 10 20 during 1980 1986 the drastic increase of salinity in agricultural sewage could be the main reason for such modeling biases 6 conclusions in this study we aimed to reconstruct the centenary covariations of the lake salinity with the water storage changes of bosten lake by the statistical model and xgboost machine learning method the multi source data including in situ measurement records the hydroweb based satellite altimetry database and those from previously published literature were cross evaluated to explore the changes in the water level and storage of bosten lake from 1961 to 2020 the centenary time series of water levels were reconstructed by xgboost which revealed the hidden relationships between the lake level and climate variables tmp pre vap pet and wet the four performance evaluation metrics mae rmse r2 and adjusted r2 were examined with the value of 0 31 m 0 37 m 0 85 and 0 84 on the testing set indicating that the result was reliable in combination with the statistical model of the water salinity and storage centenary time series of changes in salinity was accessible overall the lake salinity showed a close negative correlation with the water storage with an r2 value reaching 0 96 it underwent six fluctuations during the past century with the highest value of 1 87 g l in 1987 and the lowest value of 1 19 g l in 2002 despite the continuous rise in 1960 1987 and the high value appearing in the early 2010 s it experienced a significant recovery in the past seven years and has decreased to the comparable level of the 1960 s furthermore the associations of the water level and salinity with climate variables were analyzed the annual changes in the water level and salinity were mostly influenced by vap and pre followed by wet tmp and pet the spatial distribution and the intra annual variation of the lake salinity were examined in this study the salinity was high in the northwest part of the lake and low in the southwest which was mainly influenced by a large amount of high salinity wastewater flowing into the lake from different sources the salinity showed a slight difference in the center and east part of the lake because of the less frequent water exchange and longer hydraulic residence time at the locations far away from the only lake outlet with an artificial pumping station in most cases intra annual variation of the lake salinity changed with the water level synchronously similar to the annual pattern the reconstruction results of the water storage and salinity were compared with previous studies and the underestimation of lake salinity in previous studies may come from the fact that the used sampling data were not representative of the average level of lake salinity of bosten lake the uncertainty of the reconstruction of water salinity was eventually discussed including the data accuracy and the ignored influences from anthropogenic activities this study can advance the scientific understanding of both characteristics of the water salinity and storage changes of the largest inland lake bosten lake in arid semi arid northwest china and its hydrological response to both natural and artificial factors during the past century further research will extend the technical approach and scientific exploration to other lakes in semi arid and arid regions due to the lack of historical and local observation data credit authorship contribution statement xingan jiang conceptualization data curation formal analysis investigation methodology validation visualization writing original draft chenyu fan data curation formal analysis methodology supervision kai liu investigation project administration resources supervision validation tan chen investigation validation zhigang cao methodology supervision chunqiao song conceptualization data curation formal analysis funding acquisition methodology project administration resources supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partly funded by the national key research and development program of china grant no 2019yfa0607101 2018yfd0900804 and 2018yfd1100101 the strategic priority research program of the chinese academy of sciences grant no xda23100102 and the national natural science foundation of china no 41971403 41801321 we would like to thank the two anonymous reviewers whose suggestions greatly strengthened the work appendix a table 4 acronyms that are used in this study acronym full name description blsm the baolangsumu hydrological station a hydrological station in the bosten lake basin ys the yangshui hydrological station a hydrological station in the bosten lake basin tsd the tashidian hydrological station a hydrological station in the bosten lake basin koral the koral country a country near the bosten lake basin bohu the bohu country a country in the bosten lake basin heshuo the heshuo country a country in the bosten lake basin hejing the hejing country a country in the bosten lake basin yanqi the yanqi country a country in the bosten lake basin xgboost extreme gradient boosting a machine learning model cru climatic research unit a climate dataset containing ten climate variables pet potential evapotranspiration one of the climate variables in cru pre precipitation one of the climate variables in cru tmp daily mean temperature one of the climate variables in cru vap vapor pressure one of the climate variables in cru wet wet day frequency one of the climate variables in cru mae mean absolute error an evaluation metrics for machine learning models rmse root mean square error an evaluation metrics for machine learning models r2 r square an evaluation metrics for machine learning models adjusted r2 adjusted r square an evaluation metrics for machine learning models 
3219,groundwater is an important natural resource and its security depends largely on the confinement of the aquifer here we use ten years of continuous groundwater data from a well in southwest china to show that seasonal precipitation may change the aquifer s response to earth tides from being confined like during dry seasons to being unconfined like during rainy seasons comparing the response of water level in this well with the theoretical prediction from a leaky aquifer model we show that the observed changes of aquifer confinement reflect a seasonal increase of the vertical hydraulic conductivity from being low in the dry season when the water level is low to being high in the rainy season when the water level is high such seasonal change of aquifer confinement has not been reported before and may impact our understanding on the subsurface transport the security of groundwater resources and the safety of toxic waste repositories keywords aquifer confinement seasonal change tidal response vertical conductivity groundwater transport data availability the authors do not have permission to share data 1 introduction the transport properties in earth s crust bears on many important issues in earth sciences such as groundwater flow energy exploration induced seismicity and waste isolation permeability of the crust controls the transport in the subsurface but is one of the most difficult properties to estimate because it varies over 16 orders in magnitude and also because it may change dynamically with time with the increased analysis of the tidal response of groundwater to earth tides e g elkhoury et al 2006 liao et al 2015 allègre et al 2016 xue et al 2016 shi and wang 2016 wang et al 2016 liao and wang 2018 wang et al 2018 zhu and wang 2020 zhang et al 2021 shi and wang 2016 liao et al 2021 it was shown that large earthquakes may enhance the permeability of aquifers and may even change the confinement of some aquifers from being confined before the earthquake to being unconfined after earthquakes here we show by analyzing a ten year continuous water level record from a well in southwest china fig 1 a that seasonal precipitation may also change the aquifer confinement we find that the tidal response of the aquifer opened to this well changes seasonally from being confined like during dry seasons when the water level is low to being unconfined like during rainy season when the water level is high this result has not been reported before and may have important implications on the subsurface transport and impact our understanding on the security of groundwater resources and the safety of toxic waste repositories 2 data and analysis the studied well luxi well is located in the yunnan province southwest china 103 775 e 24 538 n fig 1a in the foothills of a local groundwater system fig 1b 1d the hydrogeology of the region consists of a carbonate aquifer of triassic age which is overlain by an aquitard consisting of quaternary laterite soils crisscrossed by fractures generated by seasonal changes of water contents in the laterite soils yang et al 2019 fig 1c 1d 1e the studied well is 109 m deep and is open to a fine grained carbonate aquifer at depths from 26 5 to 109 m fig 1d a pressure gauge with precision of 1 mm of change of water level was installed in the well and a digital recorder is used to document the water pressure at a rate of 1 sample per minute a local meteorological station 103 765 e 24 530 n near the luxi well monitored the precipitation in the luxi county fig 1b 1c fig 2 a shows the time series of water level in the luxi well referring to the ground surface from 2010 to 2019 together with the precipitation record from a nearby luxi meteorological station fig 2a shows that seasonal precipitation in the area normally occurs from june to september the annual increases of the water level occur from july to october we use a widely used routine baytap g tamura et al 1991 to extract the tidal signals from the water level recorded at the luxi well fig 2b shows the typical tidal response of the water level in the luxi well after removing the high frequency and low frequency or trend components from the time series we focus on the response to the m2 tide semi diurnal lunar tide because it has large signal to noise ratio and small response to diurnal barometric changes e g doan et al 2006 we use a time window of 29 50 days that is the minimum needed to separate the m2 from the s2 semi diurnal solar tides allègre et al 2016 xue et al 2016 the effect of the ocean tides on this time series is expected to be negligible because the luxi well is far 1200 km from the coast fig 3 displays the amplitude and phase shift of the response of water level to the m2 tide in the luxi well as functions of time from 2010 to 2019 since measurement of the tidal strain is unavailable near the well we use the theoretical tidal strain calculated at the well as the reference as in most similar studies e g xue et al 2016 liao wang 2018 zhang et al 2021 fig 3 shows that during most years the amplitude and phase shift change little with time during the dry seasons from november to may with the amplitude attending its maximum and the phase shift being slightly below 0 during the rainy seasons from june to october on the other hand the amplitude significantly decreases but the phase shift significantly increases and becomes positive except in 2010 2011 and 2013 when the precipitation was lower than the average precipitation in a hydrological year 3 interpretation in fig 4 a we plot the ten years of phase shift and amplitude ratio in the luxi well together as functions of the water level the figure shows that when the water level is below 26 m blue symbols changes of the amplitude ratio and that of the phase shift change in the same direction on the other hand when the water level increase from 26 m to 23 m red symbols the amplitude ratio decreases from 0 7 to 0 2 while phase shift increases from 10 to positive at water levels higher than 23 m green symbols the amplitude ratio and phase shift are insensitive to the changes of water level and become nearly constant in fig 4b we plot the ten years of amplitude ratio against the corresponding phase shift the figure shows that when the water level is lower than 26 m blue symbols the amplitude ratio and the phase shift are positively correlated on the other hand when the water level is between 26 m and 23 m red symbols the phase shifts and amplitude ratios are negatively correlated finally when the water level is higher than 23 m green symbols amplitude ratio and phase shift are no longer correlated interpretation of the tidal response of groundwater in fig 4 requires a brief explanation of the tidal response of a leaky aquifer which was explained in greater detail in wang et al 2018 this model reduces to a confined aquifer model e g hsieh et al 1987 when the vertical conductivity is small and becomes an unconfined aquifer model e g roeloffs 1996 when the vertical conductivity is large this model shows that the complex amplitude of the tidal response of water level in the well hw 0 is related to the volumetric strain of the earth tide ε 0 by 1 h w 0 i ω s i ω s k b ξ b k u ε 0 ρ g 1 ξ h 0 where h 0 is the complex amplitude of the water level oscillations away from the well and 2 ξ 1 r c r w 2 i ω r w 2 t β k 0 β r w k 1 β r w 3 β k t b i ω s t 1 2 where t k b is the transmissivity of the aquifer b k u ε 0 ρ g is the tidal strain equivalent hydraulic head b and k u respectively are the skempton s coefficient and the undrained bulk modulus ρ is the density of groundwater g is the gravitational acceleration k and b respectively are the radial hydraulic conductivity and the thickness of the aquifer k and b respectively are the vertical hydraulic conductivity and the thickness of the aquitard s is the storativity of the aquifer r w is the radius of the well where the water flows in and out the well rc is radius of the casing in which the water level rises and falls ω the angular frequency of tidal waves and k 0 and k 1 the modified bessel function of the second kind of the 0th and the 1st order respectively the amplitude ratio a and the phase shift η of the tidal response of the water level in the well referenced to the tidal strain equivalent hydraulic head are respectively 4a a h w 0 b k u ε 0 ρ g 4b η a r g h w 0 b k u ε 0 ρ g for the interpretation of the tidal response in the luxi well we plot in fig 4b the model predicted contours of amplitude ratio versus phase shift at constant leakage k b wang et al 2018 at water levels lower than 26 m the tidal data blue fall closely to the contour of constant leakage k b 6 10 9 s 1 suggesting that the aquifer is relatively confined between 26 and 23 m however the tidal data red fall across the contours with increasing k b suggesting that the leakage increases with the increasing water level at high k b 10 7 s 1 the theoretical contours become flat and amplitude ratio no longer correlates with phase shift fig 4b suggesting that the tidal response becomes insensitive to the water level changes at high leakage in support of the above interpretation we plot in fig 5 the model predictions for a confined aquifer 5a and b hsieh et al 1987 and for a leaky aquifer 5c and d wang et al 2018 at different leakage fig 5a and b show that for confined aquifers the predicted changes of phase shift and amplitude ratio are positively correlated similar to that observed in the luxi well when the water level is lower than 26 m fig 4 blue symbols on the other hand fig 5c and d show that for leaky aquifers the predicted changes of phase shift and amplitude ratio are negatively correlated similar to that observed in the luxi well when the water level rises from 26 m to 23 m fig 4 red symbols at large leakage both the predicted amplitude ratio and phase shift become insensitive to the change of water level similar as that observed in the luxi well when the water level rises above 23 m we may thus conclude that our interpretation of the tidal response in the luxi well is consistent with the theoretical predictions and that the seasonal change of the tidal response in the luxi well may reflect a seasonal change of the confinement of the aquifer from being confined like during the dry seasons to being unconfined like during the rainy seasons 4 discussion increasing hydraulic conductivity of groundwater systems during rainy seasons was reported before and several hypotheses were proposed to explain the seasonal changes e g saar and manga 2003 faoro et al 2012 johnson et al 2017 liao and wang 2018 but none may explain why the aquifer becomes confined when the water level becomes lower than 26 m when the water level is lower than 26 m the upper boundary of the fine grained carbonate aquifer is exposed to air see fig 1e in the traditional model the aquifer would become unconfined when exposed to air this inference however contradicts the observation that the tidal response in the luxi well becomes confined like when the water level is lower than 26 m as discussed earlier here we interpret the confined like behavior when the water level is lower than 26 m to reflect the presence of a capillary zone above the water level when air enters the fine grained carbonate aquifer since the hydraulic conductivity in the capillary zone decreases drastically above the capillary fringe e g bear 1972 wang et al 2019 liang et al 2022 the presence of a capillary zone above the water level may thus effectively confine the aquifer and cause its tidal response to behave like a confined aquifer quantitative verification of this hypothesis would require experimental data for the water retention curve for an unsaturated carbonate aquifer which unfortunately is presently unavailable when the water level is higher than the interface between the aquifer and the aquitard the water level is higher than 26 m the capillary zone in the aquifer disappears and the tidal response is controlled by the hydraulic behaviors of the upper layer of laterite soils fig 1e which as noted earlier is crisscrossed by pre existing fractures movement of fluids through this layer would be dominated by preferential flow through fractures e g nimmo 2012 that is vastly faster and more effective than that through the porous matrix movement of pore water through fractures in this layer enhances the vertical conductivity and causes the underlain aquifer to become unconfined like when the water level is higher than 23 m the vertical conductivity becomes so high that the aquifer behaves as an unconfined aquifer with high vertical conductivity such that its tidal response is no longer sensitive to further increases of the vertical conductivity fig 5c d roeloffs 1996 doan et al 2006 5 concluding remarks in this work we show for the first time that seasonal precipitation in southwest china significantly affects the tidal response of water level changes in a well which is interpreted to correspond to a change of aquifer confinement from being confined like during dry seasons to being unconfined like during rainy seasons by comparing this observed change with the theoretical predictions from a leaky aquifer model we infer that this transition of tidal response was associated with a change of the vertical conductivity of the groundwater system from being low during dry seasons to being high during rainy seasons this result may have important implications on the subsurface transport and may impact our understanding on the security of groundwater resources and the safety of the subsurface storage of toxic waste credit authorship contribution statement xin liao conceptualization methodology software writing original draft formal analysis resources funding acquisition chi yuen wang writing review editing supervision funding acquisition zhen yu wang data curation software visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was supported by the fundamental research funds for the central universities zy201602012 national natural science foundation of china 41602274 and national science foundation ear1344424 we thank xiao jing hu for data collection xiang zhang for the help in field hydrogeological survey ai yu zhu yun shi and chun ping liu for helpful comments xiong zhang and wei liao for graphic drawings and the china earthquake datacenter for providing the water level and precipitation data well water level data may be downloaded through application to china earthquake networks center national earthquake data center url http data earthquake cn gcywfl index html site instructions are in chinese 
3219,groundwater is an important natural resource and its security depends largely on the confinement of the aquifer here we use ten years of continuous groundwater data from a well in southwest china to show that seasonal precipitation may change the aquifer s response to earth tides from being confined like during dry seasons to being unconfined like during rainy seasons comparing the response of water level in this well with the theoretical prediction from a leaky aquifer model we show that the observed changes of aquifer confinement reflect a seasonal increase of the vertical hydraulic conductivity from being low in the dry season when the water level is low to being high in the rainy season when the water level is high such seasonal change of aquifer confinement has not been reported before and may impact our understanding on the subsurface transport the security of groundwater resources and the safety of toxic waste repositories keywords aquifer confinement seasonal change tidal response vertical conductivity groundwater transport data availability the authors do not have permission to share data 1 introduction the transport properties in earth s crust bears on many important issues in earth sciences such as groundwater flow energy exploration induced seismicity and waste isolation permeability of the crust controls the transport in the subsurface but is one of the most difficult properties to estimate because it varies over 16 orders in magnitude and also because it may change dynamically with time with the increased analysis of the tidal response of groundwater to earth tides e g elkhoury et al 2006 liao et al 2015 allègre et al 2016 xue et al 2016 shi and wang 2016 wang et al 2016 liao and wang 2018 wang et al 2018 zhu and wang 2020 zhang et al 2021 shi and wang 2016 liao et al 2021 it was shown that large earthquakes may enhance the permeability of aquifers and may even change the confinement of some aquifers from being confined before the earthquake to being unconfined after earthquakes here we show by analyzing a ten year continuous water level record from a well in southwest china fig 1 a that seasonal precipitation may also change the aquifer confinement we find that the tidal response of the aquifer opened to this well changes seasonally from being confined like during dry seasons when the water level is low to being unconfined like during rainy season when the water level is high this result has not been reported before and may have important implications on the subsurface transport and impact our understanding on the security of groundwater resources and the safety of toxic waste repositories 2 data and analysis the studied well luxi well is located in the yunnan province southwest china 103 775 e 24 538 n fig 1a in the foothills of a local groundwater system fig 1b 1d the hydrogeology of the region consists of a carbonate aquifer of triassic age which is overlain by an aquitard consisting of quaternary laterite soils crisscrossed by fractures generated by seasonal changes of water contents in the laterite soils yang et al 2019 fig 1c 1d 1e the studied well is 109 m deep and is open to a fine grained carbonate aquifer at depths from 26 5 to 109 m fig 1d a pressure gauge with precision of 1 mm of change of water level was installed in the well and a digital recorder is used to document the water pressure at a rate of 1 sample per minute a local meteorological station 103 765 e 24 530 n near the luxi well monitored the precipitation in the luxi county fig 1b 1c fig 2 a shows the time series of water level in the luxi well referring to the ground surface from 2010 to 2019 together with the precipitation record from a nearby luxi meteorological station fig 2a shows that seasonal precipitation in the area normally occurs from june to september the annual increases of the water level occur from july to october we use a widely used routine baytap g tamura et al 1991 to extract the tidal signals from the water level recorded at the luxi well fig 2b shows the typical tidal response of the water level in the luxi well after removing the high frequency and low frequency or trend components from the time series we focus on the response to the m2 tide semi diurnal lunar tide because it has large signal to noise ratio and small response to diurnal barometric changes e g doan et al 2006 we use a time window of 29 50 days that is the minimum needed to separate the m2 from the s2 semi diurnal solar tides allègre et al 2016 xue et al 2016 the effect of the ocean tides on this time series is expected to be negligible because the luxi well is far 1200 km from the coast fig 3 displays the amplitude and phase shift of the response of water level to the m2 tide in the luxi well as functions of time from 2010 to 2019 since measurement of the tidal strain is unavailable near the well we use the theoretical tidal strain calculated at the well as the reference as in most similar studies e g xue et al 2016 liao wang 2018 zhang et al 2021 fig 3 shows that during most years the amplitude and phase shift change little with time during the dry seasons from november to may with the amplitude attending its maximum and the phase shift being slightly below 0 during the rainy seasons from june to october on the other hand the amplitude significantly decreases but the phase shift significantly increases and becomes positive except in 2010 2011 and 2013 when the precipitation was lower than the average precipitation in a hydrological year 3 interpretation in fig 4 a we plot the ten years of phase shift and amplitude ratio in the luxi well together as functions of the water level the figure shows that when the water level is below 26 m blue symbols changes of the amplitude ratio and that of the phase shift change in the same direction on the other hand when the water level increase from 26 m to 23 m red symbols the amplitude ratio decreases from 0 7 to 0 2 while phase shift increases from 10 to positive at water levels higher than 23 m green symbols the amplitude ratio and phase shift are insensitive to the changes of water level and become nearly constant in fig 4b we plot the ten years of amplitude ratio against the corresponding phase shift the figure shows that when the water level is lower than 26 m blue symbols the amplitude ratio and the phase shift are positively correlated on the other hand when the water level is between 26 m and 23 m red symbols the phase shifts and amplitude ratios are negatively correlated finally when the water level is higher than 23 m green symbols amplitude ratio and phase shift are no longer correlated interpretation of the tidal response of groundwater in fig 4 requires a brief explanation of the tidal response of a leaky aquifer which was explained in greater detail in wang et al 2018 this model reduces to a confined aquifer model e g hsieh et al 1987 when the vertical conductivity is small and becomes an unconfined aquifer model e g roeloffs 1996 when the vertical conductivity is large this model shows that the complex amplitude of the tidal response of water level in the well hw 0 is related to the volumetric strain of the earth tide ε 0 by 1 h w 0 i ω s i ω s k b ξ b k u ε 0 ρ g 1 ξ h 0 where h 0 is the complex amplitude of the water level oscillations away from the well and 2 ξ 1 r c r w 2 i ω r w 2 t β k 0 β r w k 1 β r w 3 β k t b i ω s t 1 2 where t k b is the transmissivity of the aquifer b k u ε 0 ρ g is the tidal strain equivalent hydraulic head b and k u respectively are the skempton s coefficient and the undrained bulk modulus ρ is the density of groundwater g is the gravitational acceleration k and b respectively are the radial hydraulic conductivity and the thickness of the aquifer k and b respectively are the vertical hydraulic conductivity and the thickness of the aquitard s is the storativity of the aquifer r w is the radius of the well where the water flows in and out the well rc is radius of the casing in which the water level rises and falls ω the angular frequency of tidal waves and k 0 and k 1 the modified bessel function of the second kind of the 0th and the 1st order respectively the amplitude ratio a and the phase shift η of the tidal response of the water level in the well referenced to the tidal strain equivalent hydraulic head are respectively 4a a h w 0 b k u ε 0 ρ g 4b η a r g h w 0 b k u ε 0 ρ g for the interpretation of the tidal response in the luxi well we plot in fig 4b the model predicted contours of amplitude ratio versus phase shift at constant leakage k b wang et al 2018 at water levels lower than 26 m the tidal data blue fall closely to the contour of constant leakage k b 6 10 9 s 1 suggesting that the aquifer is relatively confined between 26 and 23 m however the tidal data red fall across the contours with increasing k b suggesting that the leakage increases with the increasing water level at high k b 10 7 s 1 the theoretical contours become flat and amplitude ratio no longer correlates with phase shift fig 4b suggesting that the tidal response becomes insensitive to the water level changes at high leakage in support of the above interpretation we plot in fig 5 the model predictions for a confined aquifer 5a and b hsieh et al 1987 and for a leaky aquifer 5c and d wang et al 2018 at different leakage fig 5a and b show that for confined aquifers the predicted changes of phase shift and amplitude ratio are positively correlated similar to that observed in the luxi well when the water level is lower than 26 m fig 4 blue symbols on the other hand fig 5c and d show that for leaky aquifers the predicted changes of phase shift and amplitude ratio are negatively correlated similar to that observed in the luxi well when the water level rises from 26 m to 23 m fig 4 red symbols at large leakage both the predicted amplitude ratio and phase shift become insensitive to the change of water level similar as that observed in the luxi well when the water level rises above 23 m we may thus conclude that our interpretation of the tidal response in the luxi well is consistent with the theoretical predictions and that the seasonal change of the tidal response in the luxi well may reflect a seasonal change of the confinement of the aquifer from being confined like during the dry seasons to being unconfined like during the rainy seasons 4 discussion increasing hydraulic conductivity of groundwater systems during rainy seasons was reported before and several hypotheses were proposed to explain the seasonal changes e g saar and manga 2003 faoro et al 2012 johnson et al 2017 liao and wang 2018 but none may explain why the aquifer becomes confined when the water level becomes lower than 26 m when the water level is lower than 26 m the upper boundary of the fine grained carbonate aquifer is exposed to air see fig 1e in the traditional model the aquifer would become unconfined when exposed to air this inference however contradicts the observation that the tidal response in the luxi well becomes confined like when the water level is lower than 26 m as discussed earlier here we interpret the confined like behavior when the water level is lower than 26 m to reflect the presence of a capillary zone above the water level when air enters the fine grained carbonate aquifer since the hydraulic conductivity in the capillary zone decreases drastically above the capillary fringe e g bear 1972 wang et al 2019 liang et al 2022 the presence of a capillary zone above the water level may thus effectively confine the aquifer and cause its tidal response to behave like a confined aquifer quantitative verification of this hypothesis would require experimental data for the water retention curve for an unsaturated carbonate aquifer which unfortunately is presently unavailable when the water level is higher than the interface between the aquifer and the aquitard the water level is higher than 26 m the capillary zone in the aquifer disappears and the tidal response is controlled by the hydraulic behaviors of the upper layer of laterite soils fig 1e which as noted earlier is crisscrossed by pre existing fractures movement of fluids through this layer would be dominated by preferential flow through fractures e g nimmo 2012 that is vastly faster and more effective than that through the porous matrix movement of pore water through fractures in this layer enhances the vertical conductivity and causes the underlain aquifer to become unconfined like when the water level is higher than 23 m the vertical conductivity becomes so high that the aquifer behaves as an unconfined aquifer with high vertical conductivity such that its tidal response is no longer sensitive to further increases of the vertical conductivity fig 5c d roeloffs 1996 doan et al 2006 5 concluding remarks in this work we show for the first time that seasonal precipitation in southwest china significantly affects the tidal response of water level changes in a well which is interpreted to correspond to a change of aquifer confinement from being confined like during dry seasons to being unconfined like during rainy seasons by comparing this observed change with the theoretical predictions from a leaky aquifer model we infer that this transition of tidal response was associated with a change of the vertical conductivity of the groundwater system from being low during dry seasons to being high during rainy seasons this result may have important implications on the subsurface transport and may impact our understanding on the security of groundwater resources and the safety of the subsurface storage of toxic waste credit authorship contribution statement xin liao conceptualization methodology software writing original draft formal analysis resources funding acquisition chi yuen wang writing review editing supervision funding acquisition zhen yu wang data curation software visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was supported by the fundamental research funds for the central universities zy201602012 national natural science foundation of china 41602274 and national science foundation ear1344424 we thank xiao jing hu for data collection xiang zhang for the help in field hydrogeological survey ai yu zhu yun shi and chun ping liu for helpful comments xiong zhang and wei liao for graphic drawings and the china earthquake datacenter for providing the water level and precipitation data well water level data may be downloaded through application to china earthquake networks center national earthquake data center url http data earthquake cn gcywfl index html site instructions are in chinese 
