index,text
21225,experimental results are presented of the cooperative operation of two maritime autonomous surface vehicles asvs executing a pre defined task in a complex marine environment the asvs are equipped with algorithms for motion planning path following and motion control where the motion planning algorithm is based in the angle guidance fast marching square method the path planning module is based in the vector field path following method and the controller is a pid the asvs are two self propelled models of 2 5 m and 3 2 m length instrumented with several sensors actuators and communication unit such as inertial measurement units global positioning system anemometers accelerometers inclinometers dc motors and wi fi communication to monitor and command the asvs a real time program was coded in labview 2018 finally in order to validate the developed system experimental tests were carried out in an open door pool with low wind conditions and from these experiments good capabilities of the system were found keywords cooperative algorithm experimental validation autonomous surface vehicles motion planning model tests 1 introduction in the last decade there is a growing interest in the topic of unmanned navigation with the ultimate goal of design a sophisticated and intelligent shipping system to make the maritime trade safer and more efficient in this scenario multiples companies have been started challenging projects for example rolls royce and intel has announced in 2018 a cooperation to develop an advanced smart and connected data centre system for sea ships and marine activities rolls royce 2018 yara birkeland has announced in 2018 the first autonomous cargo vessel which is planned start their activities fully autonomous in 2020 the benefits of using a team of autonomous surface vehicles are cover a large mission area improve the system robustness and provide redundancy against individual failure and increased fault tolerant resilience hinostroza et al 2019 liu and bucknall 2016 however field experiments and deployment of multiple autonomous vehicles generally proves to be expensive and burdened with high operational requirements thus a simple and inexpensive autonomous vehicle platform would enable a more rapid turnaround in algorithm developments in particular the study of cooperative and collaborative marine robot behaviour requires a small fleet of robotic vehicles during the testing and development stages in 2004 four scout surface craft for oceanographic and undersea testing vehicles were fabricated at massachusetts institute of technology mit and a number of field experiments have been conducted using these craft in that work the design of the scout vehicles was discussed and some examples of the utility of this platform were introduced as a tool for improved software development particularly in the area of cooperative autonomy fig 1 a presents a family of scouts performing a line formation also in curcio et al 2005 a real time cooperative localization of multiple autonomous underwater vehicles was presented this works describes a series of experiments that utilize autonomous surface craft asc equipped with undersea acoustic modems global positioning system gps and 802 11 b wireless ethernet communications to acquire data and develop software for cooperative localization of distributed vehicle networks three kayak unmanned surface vehicles usvs developed by mit in operation on the charles river fig 1b shows these same vehicles alongside auvs for which the usvs provided mobile navigation references later in arrichiello et al 2010 a study on the use of cooperative robots to execute a caging mission on the water s surface was presented in particular this study considered the problem of using two robotic boats under actuated autonomous surface vessels connected with a floating rope to capture a floating object from a known location on the water s surface and shepherd it to a designated position this work was focused on the cooperative control strategy of the two vessels this technique was validated by field experiments with two autonomous robotic boats on the surface of a lake fig 1c presents the two asvs performing a cage manoeuvre this paper presents experimental results and numerical simulations of the cooperative operation of two asvs for maintaining position navigating in a marine complex environment including static obstacles the paths for the asvs are computed using the angle guidance fast marching square method the control and guidance modules are similar as presented in hinostroza et al 2018 it is important to mention that there are similitudes between the formation control and the cooperative motion planning as was remarked in liu and bucknall 2018 however the present work prioritizes the vehicles coordination safety distance from obstacles and the trajectory smoothness the delay in the information plays an important role in the control and trajectory tracking a solution for this delay of information is the use of state estimators such as kalman filter however this problem is beyond the scope of this paper and will be studied at a later stage fig 2 presents the diagram block of the cooperative operation of two asvs the autonomous surface vehicles are self propelled models of 2 5 m and 3 2 m length equipped with an inertial measurement unit imu gps dc motors and wi fi communication the numerical simulations were performed using the mathematical model presented in hinostroza et al 2019 the experimental tests were conducted in an open door pool located in oeiras portugal during the month of november 2019 during tests two different configurations were tested and from these tests the good capabilities of the developed system was verified the remaining part of the paper is organized as follows in section 2 the mathematical formulation of the cooperative operation of a team of asvs are presented later numerical simulations of the system are presented in section 3 the experimental set up including the asvs hardware and software description is presented in section 4 while the experimental results of a cooperative operation of 2 asvs is addressed in section 5 and section 6 is the conclusion 2 cooperative operation of asv in this section a brief description of the mathematical formulation used for the cooperative operation of a team of asvs navigating in marine complex environments is presented for details see hinostroza et al 2019 also the mathematical formulation of guidance and control for asvs is addressed 2 1 mathematical modelling of an asv the availability of a sufficiently accurate autonomous surface vehicle model enabling effective design of guidance control and state estimators is imperative for simulation study purposes as the asvs have no requirements for consideration of either passenger comfort or cargo stability its primary purpose is merely to ensure the asv follows the desired path as accurately as possible the general 6 degrees of freedom dof model can be reduced to only consider motion in the surge forward sway lateral and heading yaw categories the traditional asv kinematic model fossen 2011 in planar motion and without the presence of disturbances can then be expressed as 1 η r ψ ν where η x y ψ t represents the vector of position and orientation with coordinates in the earth fixed reference frame ν u v r t denotes the vector of linear and angular velocity with coordinates in the body fixed reference frame r is the rotation matrix between the earth fixed reference frame and body fixed reference frame ψ is the orientation yaw heading angle of the asv in the earth fixed reference frame x y is the position of the asv and u v and r represents the velocity of surge sway and yaw in the body fixed reference frame respectively in addition to kinematic models asv dynamic models have also been largely studied because their importance for advanced controller design do and pan 2009 in order to better facilitate control design existing research assumes that 1 asvs are moving in a horizontal plane in the ideal fluid 2 asv masses are uniformly distributed 3 the body fixed coordinate axis coincides with the center of gravity cg 4 both the cg and the center of buoyancy cb point vertically along the z axis 5 asvs own the port starboard symmetry and 6 surge and sway yaw dynamics are essentially decoupled based on these assumptions the widely used dynamic model can then be obtained fossen 2011 2 m ν c ν ν d ν ν g η τ τ e where m is system inertia matrix including added mass c ν is the coriolis and centripetal matrix including added mass d ν is the hydrodynamic damping matrix induced by skin friction g η is the restoring forces and moments due to gravitation buoyancy τ is the control inputs the forces and moments of propulsion system and control surfaces acting on asv τ e is the environmental disturbances winds waves and currents the system inertia matrix including the added mass m has the form 3 m m r b m a m 11 0 0 0 m 22 m 23 0 m 32 m 33 where m r b is the rigid body system inertia matrix 4 m r b m 0 0 0 m m x g 0 m x g i z and m a is the added mass forces and moments induced by the pressure from a forced harmonic motion of the asv body 5 m a x u 0 0 0 y v y r 0 n v n r the coriolis and centripetal matrix including added mass c v has the form 6 c v c r b v c a v 0 0 m 22 v 1 2 m 23 m 32 r 0 0 m 11 u m 22 v 1 2 m 23 m 32 r m 11 u 0 where c r b v is the rigid body coriolis and centripetal matrix 7 c r b v 0 0 m x g r v 0 0 m u m x g r v m u 0 and the c a v is the hydrodynamic coriolis and centripetal matrix 8 c a v 0 0 y v v 1 2 y r n v r 0 0 x u u y v v 1 2 y r n v r x u u 0 the d v is the hydrodynamic damping matrix induced by skin friction potential damping due to the energy carried away by waves vortex shedding damping and wave drift damping 9 d v d d n v d 11 u 0 0 0 d 22 v r d 23 v r 0 d 32 v r d 33 v r where d is the linear damping matrix 10 d x u 0 0 0 y v y r 0 n v n r and d n v is the nonlinear damping matrix 11 d n v x u u u 0 0 0 y v v v y v r r y r v v y r r r 0 n v v v n v r r n r v v n r r r where m is mass of asv i z is the asv inertia about the z axis of the body fixed frame x g is the asv cg along the x coordinate of the body fixed frame with regard to other hydrodynamic coefficients and hydrodynamic derivatives it can be found in xu et al 2018 2 2 cooperative operation of asvs in this subsection the chosen strategy for asvs formation is presented the formation shape is pre defined based on the number of asvs distance between asvs d and formation angle θ in this work the triangular shape will be used fig 3 the procedure is designed based in followers leader formation control schema as presented in hinostroza et al 2019 and liu and bucknall 2016 in this formulation the leader target point is defined as the asv formation target which is beforehand defined and remains unaltered during the task execution while followers desired target position is recomputed during each time step operation according to follower leader formation shape the trajectories for the followers are calculated from the leader s path using the algorithm proposed in arrichiello et al 2010 and álvarez et al 2015 which can compliantly produce the sub targets according to environment modifications static or dynamic obstacles and makes the shape of the asv formation deformable based on the follower leader scheme each follower s sub target is re computed by referring to the desired angle of formation θ and the formation distance between the follower and leader as presented in fig 3 θ determines the desired angle between the follower and the leader while the formation distance represents the desired distance that the follower asv wants to preserve with respect to the leader the angle of formation θ can be combined to have the desired formation configuration vector as can be seen in fig 4 12 d l f 1 d 12 cos θ n i d 12 sin θ m j d l f 2 d 13 cos θ n i d 13 sin θ m j in equation 12 n i m j are the unitary vectors with respect to the heading angle ψ of leader asv d l f 1 and d l f 2 are the vector from the leader s origin to the follower s origin respectively is important to mention that the unitary vectors and the origin of the asv formation s frame can be computed from the absolute frame of reference see fig 4 using the leader heading angle given that the desired distance is represented by d 12 d 13 for a formation with triangular shape sub target points can be obtained as 13 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ however according to equations 12 13 the shape of the formation cannot be altered however the safety map m s computed by the fast marching method has good capabilities for representing local information detailed information about this formulation can be found in hinostroza et al 2019 2 3 guidance and control for asvs 2 3 1 line of sight guidance algorithm in the line of sight los algorithm the desired geometric path is composed by a collection of way points p k organized in a two dimension way point table moreira et al 2007 the los position is located somewhere along the straight line segment connecting the previous p k 1 and current p k way points as shown in fig 5 from this figure the ship s actual horizontal position p x y is located at the centre of a circle with radius of n ship lengths n l p p this circle will intersect the current straight line segment at two points where p l o s is selected as the point closest to the next way point to calculate p l o s two equations with two unknowns must be solved online these are 14 y l o s y 2 x l o s x 2 nl p p 2 15 y l o s y k 1 x l o s x k 1 y k y k 1 x k x k 1 tan α k 1 equation 14 is recognized as the theorem of pythagoras while the second equation equation 15 states that the slope of the path between the previous and current way point is constant selecting way points in the way point table relies on a switching algorithm a criterion for selecting the next way point located at p k 1 x k 1 y k 1 is for the ship to be within a circle of acceptance of the current way point pk hence if at some instant of time t the ship position p t satisfies 16 x k x t 2 y k y t 2 r k 2 the next way point is selected from the way point table r k denotes the radius of the circle of acceptance for the current way point it is imperative that the circle enclosing the ship has a sufficient radius such that the solutions of equation 16 exist therefore n l p p r k for all values of k is necessary bound 2 3 2 pid with feedforward heading control for asvs based on the nomoto model nomoto 1957 a pid plus feedforward heading controller is designed as follows assuming that ψ is measured by a compass consider the pid controller law 17 τ p i d s k p ψ d ψ k d ψ k i 0 t ψ d ψ τ d τ k p 1 t d s 1 t i s ψ d ψ where τ p i d is the yaw moment controller k d k p t d k i k p t i k p 0 k d 0 and k i 0 are the regulator design parameters applying this control law to nomoto model nomoto 1957 the closed loop characteristic equation is as follows xu and guedes soares 2016 18 t σ 3 1 k k d σ 2 k k p σ k k i 0 according to the routh s stability criterion the controller gains can be calculated using pole placement in the terms of the design parameters ω n and ζ as shown below 19 k p ω n 2 t k 0 k d 2 ζ ω n t 1 k 0 k i ω n 3 t 10 k 0 where k and t are parameter of the vessel ω n is the natural frequency and ζ is the relative damping ratio of the 1st order system in order to achieve accurate and rapid course changing manoeuvres a feedforward term can be applied to the controller the pid controller for full state feedback is given by 20 τ n τ f f τ p i d s where τ f f is a feedforward term using nomoto s first order model as basis for feedforward suggests that reference feedforward should be included according to 21 τ f f t k r d 1 k r d where r d and r d are the desired yaw rate and the derivate of the desired yaw rate respectively 3 numerical simulations of cooperative operation of asv in this section numerical simulation of cooperative operation of 3 asvs navigating in marine complex environment is presented the model for the simulation can be found in hinostroza et al 2019 it is important to mention that these simulations have been used to tuning the parameters before the experimental tests 3 1 cooperative operation simulations table 1 shows the model configuration for the numerical simulation considering static obstacles the three asvs starts at the same nearly position with similar headings the formation shape is a triangular with d 25 m and θ 45 ο the starting speeds are 0 5 m s fig 6 presents the sequence motions of asvs during the execution of the pre defined task from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles in sequence motion t 500 s the formation is a perfect triangle because there are no obstacles in this area however in t 1100 s the formation shape changes in order to pass through a complex sector this simulation shows the good performance of the system even when the initial conditions are different for each asvs i e initial heading angles are different fig 7 presents the asvs formation parameters during the simulation fig 7a presents the distance between leader and followers asvs during the execution of the mission task as was expected the distance changes during the mission execution according to the obstacle distribution fig 7b presents the speeds of each asv the speed of asv leader keeps constant and unchanged while the speed of the others asvs changes in order to preserve the formation shape or avoid collision between vessels thus is important to notice that the speeds are changing in order to avoid collision between asvs or trying to achieve the desired formation shape fig 8 presents the comparison of the paths obtained with the afms and the a methods the a method is a deterministic searching algorithm that calculates the least distance path it consists of a finite ordered sequence of waypoints from the mission start point to the mission end point this method is the most efficient algorithm for calculating a safe route with the shortest distance costs the trajectory presented in this simulation was obtained using the algorithms presented in einar et al 2017 and in song et al 2019 fig 8a presents the selected environment for simulation which is a square area of 4 km on the estuary of tagus river in lisbon in the grid map representation 1 pixel is equal to 10 m fig 8b presents the initial configuration for simulations the starting point is located at the entrance of the estuary and the target point is the navy dock in alfeite portugal a static obstacle was simulated to create a more challenging scenario fig 8c shows the colour map plot from the angle guidance fast marching square method where the points with a highest value yellow points represents free space fig 8d presents the comparison of the paths generated by the conventional a and the afms methods it can be seen that in the case of the a path the line in green it generates several number of zig zags making such a path unsuitable for practical navigation this path does not consider the asv kinematics the line in blue is the trajectory obtained by afms method this path is smooth and can be easy follow by the asvs however is important to mention that the a method is very fast compared with the afms method i e in core i7 2 6 ghz with 8 gb ram memory computer running a matlab 2019a the a path takes 30 s and afms takes 3 min 3 2 guidance and control simulations in order to test the performance of the proposed asv s guidance and control algorithm i e los and pid numerical simulations were carried out since these techniques were proposed before and largely studied the objective of the present simulation is to tune the path following and control parameters for experimental tests table 2 presents the initial configuration for path following numerical simulations in this simulation two different values of the value of radius of acceptance are considered i e r 0 l p p and r 0 2 l p p table 2 also presents the way points for simulations a complex distribution of the way points was considered fig 9 presents the simulation s results of the los and pid guidance and control algorithm in this figure the desired trajectory is plot as a red dashed line the trajectory for the case r 0 l p p is plotted in blue and for the r 0 2 l p p in green from this figure is clear to see the effects of the radius of acceptance in the path following algorithm in this case better results were obtained for r 0 l p p the successful results obtained in this simulation demonstrates the good capabilities of the los pid algorithms to overcoming the challenges faced by vessel steering notice that in order to generate a smooth reference model for the heading angle a third order pre filter was used for details see perera et al 2012 4 experimental set up in this section the experimental set up for manoeuvring tests is presented addressing detailed information of ship model and place of tests also the hardware and software developed to control the self running model is outline for more details see hinostroza et al 2017a 2017b additionally the plan of tests including the number of water depths and total number of repetitions is addressed at the end of this section 4 1 particularities of the first asv the first ship model considered in this experimental test is presented in fig 10 the model is a 1 65 scaled model of a chemical tanker the vessel model is built in single skin glass reinforced polyester with plywood framings and that is controlled by the navigation and control platform which can be divided into two sections hardware structure and software architecture its design speed is 0 98 m s and his main particularities are given in table 3 detailed information regarding to the hardware and software of this asv is presented in perera et al 2015 ferrari et al 2015 hinostroza et al 2018 2020 4 2 particularities of the second asv in order to perform cooperative tests a new asv has been instrumented this second asv is a new ship model which is a scaled model from a container ship this is a 3 2 m length model equipped with several sensors actuators and wi fi communication table 4 presents the main particularities of the second asv model which is built in single skin glass reinforced polyester with plywood framings it is overall length is 3 2 m the breath is 0 43 m and has one propeller and one rudder fig 11 present the model ship equipped with several sensors and actuators and wi fi communication system during the model tests it is important to mentioned that this second ship was instrumented from scratch for these experiments fig 12 presents the diagram of connections of sensors and actuators onboard of the second asv the hardware architecture is similar than the chemical tanker model however in this second asvs the control system is performed using a modern wireless compact rio 9037 which has a dual core processor and runs labview 2018 the motions of the asv are measured using an imu from xsens company named mti g which allows to measure the 6dof of the vehicle the position of the asv is tracked using the gps incorporated with the imu the wireless communication unit is done using the tp link tl wr841n which provides a fast communication up to 300 mbps the asv is moved by one propeller which is controlled by a dc brushed motor the rudder is controlled using a servo motor hs 485hb from hi tec company the power system is supplied by two marine batteries from barta company in order to provide 24 v dc two batteries are connected additionally to the on board instrumentation the system includes a wireless weather station david vantage pro which allows recording several meteorological parameters such as wind speed wind direction temperature uv radiation pressure this weather station allows the connection to a laptop using a rs 232 communication therefore the system can be monitored by the control unit furthermore the data can be downloaded and stored in a laptop as is shown in fig 13 the software architecture is mainly programmed in labview using a real time toolbox which allows to develop applications in the real time the software architecture consists of several program loops fpga loop real time loop and tcp ip loop the fpga loop is associated with collecting data from the sensors i e gps ims and fibre optic gyrocompass units and controlling the actuations of propeller and rudder sub systems that have been programmed under a reconfigurable fpga platform where labview provides the vdhl software codes the hardware can be divided in the following modules monitoring communication control recording and manoeuvring as shown in fig 14 in the recording module all data from sensors is stored the manoeuvring module allows to perform manoeuvres autonomously the communication module allows the communication between onboard and shore equipment the monitoring module is where the sensors signals and model parameters are displayed the control module is where the propeller and rudder motors are controlled the i o module is where the signals are converted from analogic to digital and vice versa 4 3 place of tests the experimental tests were conducted in piscina oceânica in oeiras portugal during the months of october and november of 2019 in order to design a proper motion planning guidance and control system it is necessary to have a good description of the place for tests therefore a new gps coordinates of the pool were measured and the contour is present in fig 15 it is important to mention that in order to perform calculations in the algorithm for motion planning guidance and control system it is necessary to have the position in earth centred coordinates therefore it is necessary to transform the readings of the gps coordinates into earth centred ecef coordinates for this purpose a function called llh2ecef was programmed and the results are show in fig 16 5 experimental results in this subsection the plan for tests the wind conditions and the experimental results are presented two experiments were carried out in which the main objective is to study the performance of the developed system i e test the capabilities to maintaining the formation of two asvs while they are performing a pre defined task in a complex marine environment including static obstacles fig 17 presents the 2 asvs during the execution of model tests the experimental tests were conducted with low wind condition table 5 presents a 10 min record of the wind pressure rain and air density from the weather station from this table is possible see that during the test the average wind speed was below 1 m s which in beaufort scale corresponds to calm conditions 5 1 path planning calculations the next step after obtaining the pool contour in the ecef coordinates is to compute the optimal path for the formation thus using the angle guidance fast marching square algorithm the optimal path was calculated in summary having as an input the gps pool contour it is possible to create the map grid and the applied the motion planning algorithm fig 18 presents the intermediate outputs of the motion planning algorithm fig 18b shows the map grid including the two static obstacles in black and fig 18b address the resulting colour map after applied the fmm algorithm where the yellow colour represents a free space and blue colour represents an obstacle table 6 presents the model configuration for experimental tests in fig 18 in blue are plotted the static obstacles and the pool contour in red the asv leader optimal path and in pink the follower 1 path notice that this figure is presented in pixels and need to be transformed into cartesian coordinates in which case a 1 pixel is equal to 0 1 m from the figure it is possible to see in the leader this path some changes in the initial trajectory because the afms method considers the initial heading angle fig 19 presents the optimal paths for formation i e leader and follower it is important to mention that this optimal path can be change according to the changes in the obstacles i e dynamic obstacles 5 2 trajectory tracking later when the optimal path is computed it is important to define the strategy of formation in this study the follower asv s position is defined based in the position of the leader asv and the strategy of formation parameters 22 a s v 2 t arg e t a s v 1 l o n g i t u d e x c o o p a s v 1 l a t i t u d e y c o o p where x c o o p and y c o o p depends on the algorithm of formation fig 20 presents the sequence of motion of the asv formation while executing a pre defined task in this figure the start point and target are located in opposite corners of the pool and plotted with circles the static obstacles are plotted in pink the pool contour is plotted in blue the leader asv trajectory is plotted in cyan and the follower asv in green this figure present 4 instants of the test corresponding to the seconds t 0 15 30 and 45 s in the initial situation t 0 s the leader asv has already started his motion and the follower is still stopped at t 15s the leader is performing his trajectory tracking and the follower is now starting his motion at t 30s is possible to see that the follower has now reached its constant speed and is following the leader at t 45s the leader is almost arrived to the desired target and is reducing his velocity therefore the follower is now near to the leader this details can be appreciate in the distance plot fig 21 presents the time series of the distance between leader and follower asvs during the execution of the pre defined task as is possible to see at the beginning the distance is increasing because the leader asvs is already moving at full speed while the follower is starting his motion later the follower accelerates until he reaches the formation distance afterwards when the leader has reached the target the distance is again decreasing because the leader is now stopped and the follower is still moving it is important to mention that the model starts from 0 speed and it takes some time to reach the constant speed fig 21 also presents the time series of heading roll and pitch angles for both asvs during the model test execution from the heading plot is possible to see that at the beginning both models have a similar heading but they are changing during the tests the roll and pitch angles are very small as was expected due to low wind conditions for the case b the idea is to test a different configuration of the static obstacles including more static and dynamic obstacles fig 22 presents the sequence of motion of the asv formation while executes a pre defined task fig 23 presents the time series of the distance between leader and follower asvs during the execution of the pre defined task as is possible to see the follower asv is trying to chase the leader because the distance between leader and follower is decreasing during the tests while is true that several authors have presented works for the cooperative operation of asvs i e liu and bucknall 2016 curcio et al 2005 arrichiello et al 2010 the main contributions of the present work are a the integration of a complete guidance navigation and control system onboard of two small asvs b experimental validation of the cooperative operation system therefore this work aims to propose a practical motion planning guidance and control for the cooperative operation of for asvs in realistic environments a number of previous works have developed path planning algorithms for asvs naeem et al 2012 liu and bucknall 2016 however nearly all of them simulated algorithms in simple self constructed environments rather than real environments the algorithm designed in this paper is able to extract information from a real navigation map to construct a synthetic grid map where both static and dynamic obstacles are well represented by using such a map a collision free path may be generated which can be directly used as a guidance trajectory for practical navigation 6 conclusions this paper presented the experimental results of the cooperative operation of two asv in a complex environment including simulated static obstacles the subject is of particular relevance for modern autonomous maritime transportation always seeking for more robustness safety and greener operations because promoting safer and more efficient maritime trades can result in a positive impact on an extremely wide range of life aspects the use of a team of asvs increases the system robustness and range of operations in the developed system the leader followers architecture was adopted the motion planning is based in an extended angle guidance fast marching square method the guidance unit employs the line of sight guidance algorithm and the control unit is composed by a pid heading controller and a speed controller numerical simulations were carried out a team composed by 3 identical asvs was chosen to simulate a fleet and the triangular formation shape the numerical simulations were carried out to test each module first individually and then all together from the results of numerical simulation in static environment a good performance of the motion planning unit guidance and control system was found thus during the execution of a pre defined task the heading and speeds of the asv followers were adjusting in order overpass difficult regions and to keep as much as it is possible the desired formation shape the experimental cooperative tests were done in an open door pool of 50 20 m2 including various static obstacles also model tests for the guidance and control system were carried out and the results obtained are acceptable considering the influence of the wind and currents from the experimental results it is clear to see a good performance of the system tracking a desired path in a marine environment including static obstacles this good performance is quantified visually based in the fact of not collision with obstacles and smooth trajectory credit authorship contribution statement m a hinostroza methodology formal analysis visualization writing original draft haitong xu writing original draft c guedes soares writing review editing supervision declaration of competing interest there are no conflicts of interest acknowledgment this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 the first author has been funded by a phd scholarship from the university of lisbon and the centre for marine technology and ocean engineering centec under the contract bd 579 2016 the experimental tests with ship models were not possible without the collaboration of eng jose costa from the oeiras city council who allowed the realization of the model tests in the piscina oceânica oeiras portugal the authors are grateful with m calvario and h rong for their help in experimental tests the authors would like to thank the anonymous reviewers for their helpful and constructive comments that contributed to improving the final version of the manuscript 
21225,experimental results are presented of the cooperative operation of two maritime autonomous surface vehicles asvs executing a pre defined task in a complex marine environment the asvs are equipped with algorithms for motion planning path following and motion control where the motion planning algorithm is based in the angle guidance fast marching square method the path planning module is based in the vector field path following method and the controller is a pid the asvs are two self propelled models of 2 5 m and 3 2 m length instrumented with several sensors actuators and communication unit such as inertial measurement units global positioning system anemometers accelerometers inclinometers dc motors and wi fi communication to monitor and command the asvs a real time program was coded in labview 2018 finally in order to validate the developed system experimental tests were carried out in an open door pool with low wind conditions and from these experiments good capabilities of the system were found keywords cooperative algorithm experimental validation autonomous surface vehicles motion planning model tests 1 introduction in the last decade there is a growing interest in the topic of unmanned navigation with the ultimate goal of design a sophisticated and intelligent shipping system to make the maritime trade safer and more efficient in this scenario multiples companies have been started challenging projects for example rolls royce and intel has announced in 2018 a cooperation to develop an advanced smart and connected data centre system for sea ships and marine activities rolls royce 2018 yara birkeland has announced in 2018 the first autonomous cargo vessel which is planned start their activities fully autonomous in 2020 the benefits of using a team of autonomous surface vehicles are cover a large mission area improve the system robustness and provide redundancy against individual failure and increased fault tolerant resilience hinostroza et al 2019 liu and bucknall 2016 however field experiments and deployment of multiple autonomous vehicles generally proves to be expensive and burdened with high operational requirements thus a simple and inexpensive autonomous vehicle platform would enable a more rapid turnaround in algorithm developments in particular the study of cooperative and collaborative marine robot behaviour requires a small fleet of robotic vehicles during the testing and development stages in 2004 four scout surface craft for oceanographic and undersea testing vehicles were fabricated at massachusetts institute of technology mit and a number of field experiments have been conducted using these craft in that work the design of the scout vehicles was discussed and some examples of the utility of this platform were introduced as a tool for improved software development particularly in the area of cooperative autonomy fig 1 a presents a family of scouts performing a line formation also in curcio et al 2005 a real time cooperative localization of multiple autonomous underwater vehicles was presented this works describes a series of experiments that utilize autonomous surface craft asc equipped with undersea acoustic modems global positioning system gps and 802 11 b wireless ethernet communications to acquire data and develop software for cooperative localization of distributed vehicle networks three kayak unmanned surface vehicles usvs developed by mit in operation on the charles river fig 1b shows these same vehicles alongside auvs for which the usvs provided mobile navigation references later in arrichiello et al 2010 a study on the use of cooperative robots to execute a caging mission on the water s surface was presented in particular this study considered the problem of using two robotic boats under actuated autonomous surface vessels connected with a floating rope to capture a floating object from a known location on the water s surface and shepherd it to a designated position this work was focused on the cooperative control strategy of the two vessels this technique was validated by field experiments with two autonomous robotic boats on the surface of a lake fig 1c presents the two asvs performing a cage manoeuvre this paper presents experimental results and numerical simulations of the cooperative operation of two asvs for maintaining position navigating in a marine complex environment including static obstacles the paths for the asvs are computed using the angle guidance fast marching square method the control and guidance modules are similar as presented in hinostroza et al 2018 it is important to mention that there are similitudes between the formation control and the cooperative motion planning as was remarked in liu and bucknall 2018 however the present work prioritizes the vehicles coordination safety distance from obstacles and the trajectory smoothness the delay in the information plays an important role in the control and trajectory tracking a solution for this delay of information is the use of state estimators such as kalman filter however this problem is beyond the scope of this paper and will be studied at a later stage fig 2 presents the diagram block of the cooperative operation of two asvs the autonomous surface vehicles are self propelled models of 2 5 m and 3 2 m length equipped with an inertial measurement unit imu gps dc motors and wi fi communication the numerical simulations were performed using the mathematical model presented in hinostroza et al 2019 the experimental tests were conducted in an open door pool located in oeiras portugal during the month of november 2019 during tests two different configurations were tested and from these tests the good capabilities of the developed system was verified the remaining part of the paper is organized as follows in section 2 the mathematical formulation of the cooperative operation of a team of asvs are presented later numerical simulations of the system are presented in section 3 the experimental set up including the asvs hardware and software description is presented in section 4 while the experimental results of a cooperative operation of 2 asvs is addressed in section 5 and section 6 is the conclusion 2 cooperative operation of asv in this section a brief description of the mathematical formulation used for the cooperative operation of a team of asvs navigating in marine complex environments is presented for details see hinostroza et al 2019 also the mathematical formulation of guidance and control for asvs is addressed 2 1 mathematical modelling of an asv the availability of a sufficiently accurate autonomous surface vehicle model enabling effective design of guidance control and state estimators is imperative for simulation study purposes as the asvs have no requirements for consideration of either passenger comfort or cargo stability its primary purpose is merely to ensure the asv follows the desired path as accurately as possible the general 6 degrees of freedom dof model can be reduced to only consider motion in the surge forward sway lateral and heading yaw categories the traditional asv kinematic model fossen 2011 in planar motion and without the presence of disturbances can then be expressed as 1 η r ψ ν where η x y ψ t represents the vector of position and orientation with coordinates in the earth fixed reference frame ν u v r t denotes the vector of linear and angular velocity with coordinates in the body fixed reference frame r is the rotation matrix between the earth fixed reference frame and body fixed reference frame ψ is the orientation yaw heading angle of the asv in the earth fixed reference frame x y is the position of the asv and u v and r represents the velocity of surge sway and yaw in the body fixed reference frame respectively in addition to kinematic models asv dynamic models have also been largely studied because their importance for advanced controller design do and pan 2009 in order to better facilitate control design existing research assumes that 1 asvs are moving in a horizontal plane in the ideal fluid 2 asv masses are uniformly distributed 3 the body fixed coordinate axis coincides with the center of gravity cg 4 both the cg and the center of buoyancy cb point vertically along the z axis 5 asvs own the port starboard symmetry and 6 surge and sway yaw dynamics are essentially decoupled based on these assumptions the widely used dynamic model can then be obtained fossen 2011 2 m ν c ν ν d ν ν g η τ τ e where m is system inertia matrix including added mass c ν is the coriolis and centripetal matrix including added mass d ν is the hydrodynamic damping matrix induced by skin friction g η is the restoring forces and moments due to gravitation buoyancy τ is the control inputs the forces and moments of propulsion system and control surfaces acting on asv τ e is the environmental disturbances winds waves and currents the system inertia matrix including the added mass m has the form 3 m m r b m a m 11 0 0 0 m 22 m 23 0 m 32 m 33 where m r b is the rigid body system inertia matrix 4 m r b m 0 0 0 m m x g 0 m x g i z and m a is the added mass forces and moments induced by the pressure from a forced harmonic motion of the asv body 5 m a x u 0 0 0 y v y r 0 n v n r the coriolis and centripetal matrix including added mass c v has the form 6 c v c r b v c a v 0 0 m 22 v 1 2 m 23 m 32 r 0 0 m 11 u m 22 v 1 2 m 23 m 32 r m 11 u 0 where c r b v is the rigid body coriolis and centripetal matrix 7 c r b v 0 0 m x g r v 0 0 m u m x g r v m u 0 and the c a v is the hydrodynamic coriolis and centripetal matrix 8 c a v 0 0 y v v 1 2 y r n v r 0 0 x u u y v v 1 2 y r n v r x u u 0 the d v is the hydrodynamic damping matrix induced by skin friction potential damping due to the energy carried away by waves vortex shedding damping and wave drift damping 9 d v d d n v d 11 u 0 0 0 d 22 v r d 23 v r 0 d 32 v r d 33 v r where d is the linear damping matrix 10 d x u 0 0 0 y v y r 0 n v n r and d n v is the nonlinear damping matrix 11 d n v x u u u 0 0 0 y v v v y v r r y r v v y r r r 0 n v v v n v r r n r v v n r r r where m is mass of asv i z is the asv inertia about the z axis of the body fixed frame x g is the asv cg along the x coordinate of the body fixed frame with regard to other hydrodynamic coefficients and hydrodynamic derivatives it can be found in xu et al 2018 2 2 cooperative operation of asvs in this subsection the chosen strategy for asvs formation is presented the formation shape is pre defined based on the number of asvs distance between asvs d and formation angle θ in this work the triangular shape will be used fig 3 the procedure is designed based in followers leader formation control schema as presented in hinostroza et al 2019 and liu and bucknall 2016 in this formulation the leader target point is defined as the asv formation target which is beforehand defined and remains unaltered during the task execution while followers desired target position is recomputed during each time step operation according to follower leader formation shape the trajectories for the followers are calculated from the leader s path using the algorithm proposed in arrichiello et al 2010 and álvarez et al 2015 which can compliantly produce the sub targets according to environment modifications static or dynamic obstacles and makes the shape of the asv formation deformable based on the follower leader scheme each follower s sub target is re computed by referring to the desired angle of formation θ and the formation distance between the follower and leader as presented in fig 3 θ determines the desired angle between the follower and the leader while the formation distance represents the desired distance that the follower asv wants to preserve with respect to the leader the angle of formation θ can be combined to have the desired formation configuration vector as can be seen in fig 4 12 d l f 1 d 12 cos θ n i d 12 sin θ m j d l f 2 d 13 cos θ n i d 13 sin θ m j in equation 12 n i m j are the unitary vectors with respect to the heading angle ψ of leader asv d l f 1 and d l f 2 are the vector from the leader s origin to the follower s origin respectively is important to mention that the unitary vectors and the origin of the asv formation s frame can be computed from the absolute frame of reference see fig 4 using the leader heading angle given that the desired distance is represented by d 12 d 13 for a formation with triangular shape sub target points can be obtained as 13 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ however according to equations 12 13 the shape of the formation cannot be altered however the safety map m s computed by the fast marching method has good capabilities for representing local information detailed information about this formulation can be found in hinostroza et al 2019 2 3 guidance and control for asvs 2 3 1 line of sight guidance algorithm in the line of sight los algorithm the desired geometric path is composed by a collection of way points p k organized in a two dimension way point table moreira et al 2007 the los position is located somewhere along the straight line segment connecting the previous p k 1 and current p k way points as shown in fig 5 from this figure the ship s actual horizontal position p x y is located at the centre of a circle with radius of n ship lengths n l p p this circle will intersect the current straight line segment at two points where p l o s is selected as the point closest to the next way point to calculate p l o s two equations with two unknowns must be solved online these are 14 y l o s y 2 x l o s x 2 nl p p 2 15 y l o s y k 1 x l o s x k 1 y k y k 1 x k x k 1 tan α k 1 equation 14 is recognized as the theorem of pythagoras while the second equation equation 15 states that the slope of the path between the previous and current way point is constant selecting way points in the way point table relies on a switching algorithm a criterion for selecting the next way point located at p k 1 x k 1 y k 1 is for the ship to be within a circle of acceptance of the current way point pk hence if at some instant of time t the ship position p t satisfies 16 x k x t 2 y k y t 2 r k 2 the next way point is selected from the way point table r k denotes the radius of the circle of acceptance for the current way point it is imperative that the circle enclosing the ship has a sufficient radius such that the solutions of equation 16 exist therefore n l p p r k for all values of k is necessary bound 2 3 2 pid with feedforward heading control for asvs based on the nomoto model nomoto 1957 a pid plus feedforward heading controller is designed as follows assuming that ψ is measured by a compass consider the pid controller law 17 τ p i d s k p ψ d ψ k d ψ k i 0 t ψ d ψ τ d τ k p 1 t d s 1 t i s ψ d ψ where τ p i d is the yaw moment controller k d k p t d k i k p t i k p 0 k d 0 and k i 0 are the regulator design parameters applying this control law to nomoto model nomoto 1957 the closed loop characteristic equation is as follows xu and guedes soares 2016 18 t σ 3 1 k k d σ 2 k k p σ k k i 0 according to the routh s stability criterion the controller gains can be calculated using pole placement in the terms of the design parameters ω n and ζ as shown below 19 k p ω n 2 t k 0 k d 2 ζ ω n t 1 k 0 k i ω n 3 t 10 k 0 where k and t are parameter of the vessel ω n is the natural frequency and ζ is the relative damping ratio of the 1st order system in order to achieve accurate and rapid course changing manoeuvres a feedforward term can be applied to the controller the pid controller for full state feedback is given by 20 τ n τ f f τ p i d s where τ f f is a feedforward term using nomoto s first order model as basis for feedforward suggests that reference feedforward should be included according to 21 τ f f t k r d 1 k r d where r d and r d are the desired yaw rate and the derivate of the desired yaw rate respectively 3 numerical simulations of cooperative operation of asv in this section numerical simulation of cooperative operation of 3 asvs navigating in marine complex environment is presented the model for the simulation can be found in hinostroza et al 2019 it is important to mention that these simulations have been used to tuning the parameters before the experimental tests 3 1 cooperative operation simulations table 1 shows the model configuration for the numerical simulation considering static obstacles the three asvs starts at the same nearly position with similar headings the formation shape is a triangular with d 25 m and θ 45 ο the starting speeds are 0 5 m s fig 6 presents the sequence motions of asvs during the execution of the pre defined task from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles in sequence motion t 500 s the formation is a perfect triangle because there are no obstacles in this area however in t 1100 s the formation shape changes in order to pass through a complex sector this simulation shows the good performance of the system even when the initial conditions are different for each asvs i e initial heading angles are different fig 7 presents the asvs formation parameters during the simulation fig 7a presents the distance between leader and followers asvs during the execution of the mission task as was expected the distance changes during the mission execution according to the obstacle distribution fig 7b presents the speeds of each asv the speed of asv leader keeps constant and unchanged while the speed of the others asvs changes in order to preserve the formation shape or avoid collision between vessels thus is important to notice that the speeds are changing in order to avoid collision between asvs or trying to achieve the desired formation shape fig 8 presents the comparison of the paths obtained with the afms and the a methods the a method is a deterministic searching algorithm that calculates the least distance path it consists of a finite ordered sequence of waypoints from the mission start point to the mission end point this method is the most efficient algorithm for calculating a safe route with the shortest distance costs the trajectory presented in this simulation was obtained using the algorithms presented in einar et al 2017 and in song et al 2019 fig 8a presents the selected environment for simulation which is a square area of 4 km on the estuary of tagus river in lisbon in the grid map representation 1 pixel is equal to 10 m fig 8b presents the initial configuration for simulations the starting point is located at the entrance of the estuary and the target point is the navy dock in alfeite portugal a static obstacle was simulated to create a more challenging scenario fig 8c shows the colour map plot from the angle guidance fast marching square method where the points with a highest value yellow points represents free space fig 8d presents the comparison of the paths generated by the conventional a and the afms methods it can be seen that in the case of the a path the line in green it generates several number of zig zags making such a path unsuitable for practical navigation this path does not consider the asv kinematics the line in blue is the trajectory obtained by afms method this path is smooth and can be easy follow by the asvs however is important to mention that the a method is very fast compared with the afms method i e in core i7 2 6 ghz with 8 gb ram memory computer running a matlab 2019a the a path takes 30 s and afms takes 3 min 3 2 guidance and control simulations in order to test the performance of the proposed asv s guidance and control algorithm i e los and pid numerical simulations were carried out since these techniques were proposed before and largely studied the objective of the present simulation is to tune the path following and control parameters for experimental tests table 2 presents the initial configuration for path following numerical simulations in this simulation two different values of the value of radius of acceptance are considered i e r 0 l p p and r 0 2 l p p table 2 also presents the way points for simulations a complex distribution of the way points was considered fig 9 presents the simulation s results of the los and pid guidance and control algorithm in this figure the desired trajectory is plot as a red dashed line the trajectory for the case r 0 l p p is plotted in blue and for the r 0 2 l p p in green from this figure is clear to see the effects of the radius of acceptance in the path following algorithm in this case better results were obtained for r 0 l p p the successful results obtained in this simulation demonstrates the good capabilities of the los pid algorithms to overcoming the challenges faced by vessel steering notice that in order to generate a smooth reference model for the heading angle a third order pre filter was used for details see perera et al 2012 4 experimental set up in this section the experimental set up for manoeuvring tests is presented addressing detailed information of ship model and place of tests also the hardware and software developed to control the self running model is outline for more details see hinostroza et al 2017a 2017b additionally the plan of tests including the number of water depths and total number of repetitions is addressed at the end of this section 4 1 particularities of the first asv the first ship model considered in this experimental test is presented in fig 10 the model is a 1 65 scaled model of a chemical tanker the vessel model is built in single skin glass reinforced polyester with plywood framings and that is controlled by the navigation and control platform which can be divided into two sections hardware structure and software architecture its design speed is 0 98 m s and his main particularities are given in table 3 detailed information regarding to the hardware and software of this asv is presented in perera et al 2015 ferrari et al 2015 hinostroza et al 2018 2020 4 2 particularities of the second asv in order to perform cooperative tests a new asv has been instrumented this second asv is a new ship model which is a scaled model from a container ship this is a 3 2 m length model equipped with several sensors actuators and wi fi communication table 4 presents the main particularities of the second asv model which is built in single skin glass reinforced polyester with plywood framings it is overall length is 3 2 m the breath is 0 43 m and has one propeller and one rudder fig 11 present the model ship equipped with several sensors and actuators and wi fi communication system during the model tests it is important to mentioned that this second ship was instrumented from scratch for these experiments fig 12 presents the diagram of connections of sensors and actuators onboard of the second asv the hardware architecture is similar than the chemical tanker model however in this second asvs the control system is performed using a modern wireless compact rio 9037 which has a dual core processor and runs labview 2018 the motions of the asv are measured using an imu from xsens company named mti g which allows to measure the 6dof of the vehicle the position of the asv is tracked using the gps incorporated with the imu the wireless communication unit is done using the tp link tl wr841n which provides a fast communication up to 300 mbps the asv is moved by one propeller which is controlled by a dc brushed motor the rudder is controlled using a servo motor hs 485hb from hi tec company the power system is supplied by two marine batteries from barta company in order to provide 24 v dc two batteries are connected additionally to the on board instrumentation the system includes a wireless weather station david vantage pro which allows recording several meteorological parameters such as wind speed wind direction temperature uv radiation pressure this weather station allows the connection to a laptop using a rs 232 communication therefore the system can be monitored by the control unit furthermore the data can be downloaded and stored in a laptop as is shown in fig 13 the software architecture is mainly programmed in labview using a real time toolbox which allows to develop applications in the real time the software architecture consists of several program loops fpga loop real time loop and tcp ip loop the fpga loop is associated with collecting data from the sensors i e gps ims and fibre optic gyrocompass units and controlling the actuations of propeller and rudder sub systems that have been programmed under a reconfigurable fpga platform where labview provides the vdhl software codes the hardware can be divided in the following modules monitoring communication control recording and manoeuvring as shown in fig 14 in the recording module all data from sensors is stored the manoeuvring module allows to perform manoeuvres autonomously the communication module allows the communication between onboard and shore equipment the monitoring module is where the sensors signals and model parameters are displayed the control module is where the propeller and rudder motors are controlled the i o module is where the signals are converted from analogic to digital and vice versa 4 3 place of tests the experimental tests were conducted in piscina oceânica in oeiras portugal during the months of october and november of 2019 in order to design a proper motion planning guidance and control system it is necessary to have a good description of the place for tests therefore a new gps coordinates of the pool were measured and the contour is present in fig 15 it is important to mention that in order to perform calculations in the algorithm for motion planning guidance and control system it is necessary to have the position in earth centred coordinates therefore it is necessary to transform the readings of the gps coordinates into earth centred ecef coordinates for this purpose a function called llh2ecef was programmed and the results are show in fig 16 5 experimental results in this subsection the plan for tests the wind conditions and the experimental results are presented two experiments were carried out in which the main objective is to study the performance of the developed system i e test the capabilities to maintaining the formation of two asvs while they are performing a pre defined task in a complex marine environment including static obstacles fig 17 presents the 2 asvs during the execution of model tests the experimental tests were conducted with low wind condition table 5 presents a 10 min record of the wind pressure rain and air density from the weather station from this table is possible see that during the test the average wind speed was below 1 m s which in beaufort scale corresponds to calm conditions 5 1 path planning calculations the next step after obtaining the pool contour in the ecef coordinates is to compute the optimal path for the formation thus using the angle guidance fast marching square algorithm the optimal path was calculated in summary having as an input the gps pool contour it is possible to create the map grid and the applied the motion planning algorithm fig 18 presents the intermediate outputs of the motion planning algorithm fig 18b shows the map grid including the two static obstacles in black and fig 18b address the resulting colour map after applied the fmm algorithm where the yellow colour represents a free space and blue colour represents an obstacle table 6 presents the model configuration for experimental tests in fig 18 in blue are plotted the static obstacles and the pool contour in red the asv leader optimal path and in pink the follower 1 path notice that this figure is presented in pixels and need to be transformed into cartesian coordinates in which case a 1 pixel is equal to 0 1 m from the figure it is possible to see in the leader this path some changes in the initial trajectory because the afms method considers the initial heading angle fig 19 presents the optimal paths for formation i e leader and follower it is important to mention that this optimal path can be change according to the changes in the obstacles i e dynamic obstacles 5 2 trajectory tracking later when the optimal path is computed it is important to define the strategy of formation in this study the follower asv s position is defined based in the position of the leader asv and the strategy of formation parameters 22 a s v 2 t arg e t a s v 1 l o n g i t u d e x c o o p a s v 1 l a t i t u d e y c o o p where x c o o p and y c o o p depends on the algorithm of formation fig 20 presents the sequence of motion of the asv formation while executing a pre defined task in this figure the start point and target are located in opposite corners of the pool and plotted with circles the static obstacles are plotted in pink the pool contour is plotted in blue the leader asv trajectory is plotted in cyan and the follower asv in green this figure present 4 instants of the test corresponding to the seconds t 0 15 30 and 45 s in the initial situation t 0 s the leader asv has already started his motion and the follower is still stopped at t 15s the leader is performing his trajectory tracking and the follower is now starting his motion at t 30s is possible to see that the follower has now reached its constant speed and is following the leader at t 45s the leader is almost arrived to the desired target and is reducing his velocity therefore the follower is now near to the leader this details can be appreciate in the distance plot fig 21 presents the time series of the distance between leader and follower asvs during the execution of the pre defined task as is possible to see at the beginning the distance is increasing because the leader asvs is already moving at full speed while the follower is starting his motion later the follower accelerates until he reaches the formation distance afterwards when the leader has reached the target the distance is again decreasing because the leader is now stopped and the follower is still moving it is important to mention that the model starts from 0 speed and it takes some time to reach the constant speed fig 21 also presents the time series of heading roll and pitch angles for both asvs during the model test execution from the heading plot is possible to see that at the beginning both models have a similar heading but they are changing during the tests the roll and pitch angles are very small as was expected due to low wind conditions for the case b the idea is to test a different configuration of the static obstacles including more static and dynamic obstacles fig 22 presents the sequence of motion of the asv formation while executes a pre defined task fig 23 presents the time series of the distance between leader and follower asvs during the execution of the pre defined task as is possible to see the follower asv is trying to chase the leader because the distance between leader and follower is decreasing during the tests while is true that several authors have presented works for the cooperative operation of asvs i e liu and bucknall 2016 curcio et al 2005 arrichiello et al 2010 the main contributions of the present work are a the integration of a complete guidance navigation and control system onboard of two small asvs b experimental validation of the cooperative operation system therefore this work aims to propose a practical motion planning guidance and control for the cooperative operation of for asvs in realistic environments a number of previous works have developed path planning algorithms for asvs naeem et al 2012 liu and bucknall 2016 however nearly all of them simulated algorithms in simple self constructed environments rather than real environments the algorithm designed in this paper is able to extract information from a real navigation map to construct a synthetic grid map where both static and dynamic obstacles are well represented by using such a map a collision free path may be generated which can be directly used as a guidance trajectory for practical navigation 6 conclusions this paper presented the experimental results of the cooperative operation of two asv in a complex environment including simulated static obstacles the subject is of particular relevance for modern autonomous maritime transportation always seeking for more robustness safety and greener operations because promoting safer and more efficient maritime trades can result in a positive impact on an extremely wide range of life aspects the use of a team of asvs increases the system robustness and range of operations in the developed system the leader followers architecture was adopted the motion planning is based in an extended angle guidance fast marching square method the guidance unit employs the line of sight guidance algorithm and the control unit is composed by a pid heading controller and a speed controller numerical simulations were carried out a team composed by 3 identical asvs was chosen to simulate a fleet and the triangular formation shape the numerical simulations were carried out to test each module first individually and then all together from the results of numerical simulation in static environment a good performance of the motion planning unit guidance and control system was found thus during the execution of a pre defined task the heading and speeds of the asv followers were adjusting in order overpass difficult regions and to keep as much as it is possible the desired formation shape the experimental cooperative tests were done in an open door pool of 50 20 m2 including various static obstacles also model tests for the guidance and control system were carried out and the results obtained are acceptable considering the influence of the wind and currents from the experimental results it is clear to see a good performance of the system tracking a desired path in a marine environment including static obstacles this good performance is quantified visually based in the fact of not collision with obstacles and smooth trajectory credit authorship contribution statement m a hinostroza methodology formal analysis visualization writing original draft haitong xu writing original draft c guedes soares writing review editing supervision declaration of competing interest there are no conflicts of interest acknowledgment this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 the first author has been funded by a phd scholarship from the university of lisbon and the centre for marine technology and ocean engineering centec under the contract bd 579 2016 the experimental tests with ship models were not possible without the collaboration of eng jose costa from the oeiras city council who allowed the realization of the model tests in the piscina oceânica oeiras portugal the authors are grateful with m calvario and h rong for their help in experimental tests the authors would like to thank the anonymous reviewers for their helpful and constructive comments that contributed to improving the final version of the manuscript 
21226,this paper is concerned with the leader following consensus of discrete time multi auv recovery systems with time varying delay during the recycling process the mothership is regarded as a leader and auvs are regarded as followers the multi auv recovery problem is transformed into the leader following coordinated control problem a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology new stability criteria are established to guarantee the consensus of the multi auv recovery system based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities therefore the controller gains are derived finally simulation results are provided to illustrate the effectiveness of theoretical results keywords multiple auvs recovery system discrete time leader following consensus time varying delay 1 introduction as one of the essential components of the unmanned underwater system autonomous underwater vehicle auv is a kind of submersible vehicle that relies on its energy self propulsion autonomous control and can be recovered and reused at present auv is widely used in marine engineering and other fields compared with the single auv the multi auv system has more advantages in distribution applicability coordination safety and intelligence team coordination to complete tasks can effectively improve efficiency expand capabilities save costs and improve accuracy zhang et al 2019 the research of multi auv coordinated control is the inevitable direction of auv development recovery is the essential operation of auv in task execution and it is also the last and most critical step to ensure the successful completion of the task unsuccessful recycling will not only lead to task failure but even cause the auv to be damaged or lost the recovery of the multi auv system is different from that of single auv and new requirements are put forward for the multiple auv recovery system during the recovery process all states of the multi auv system are finally consistent during the recycling process the mothership is regarded as a leader and auvs are regarded as followers therefore the multi auv recovery problem is transformed into the leader following coordinated control problem due to the complex and unknown marine environment and auv has highly complex nonlinear dynamics the leader following coordinated control problem of the multi auv system is a well known challenge in the past few decades many researchers have done much research on the coordinated control of multi auv fiorelli et al 2004 cui et al 2010 peng et al 2013 millán et al 2014 wang et al 2016 chen and ho 2016 yan et al 2017 yuan et al 2018 fabiani et al 2018 cao and guo 2019 these articles mainly focus on the consensus control of continuous time multi auv however the communication information of multi auv is discrete data in actual work besides there are a few pieces of research related to the multi auv recovery system the studies of coordinated control of the multi auv recovery system have practical significance multi auv can effectively perform recovery tasks under the condition of successful information exchange nevertheless communication information among auvs may be delayed affected by actual sea conditions and this situation may lead to instability and poor performance of control systems for the consensus of the discrete time multi agent systems with time delays there have been many research results wu and shi 2011 investigates the sampled data consensus control protocol for the multi agent system with the statistical characteristics of delays governed by a markov chain liu et al 2012 considers the distributed time delays including a single or multiple time delay a distributed consensus control protocol for discrete time multi agent network with fixed topologies is deduced hou et al 2014 proposes the stationary and dynamic consensus control protocol for a multi agent system with input delays governed by markov jumping and the controller is designed by a ccl based algorithm li et al 2014 assumes that each agent receives the delayed quantized information only from its neighbors the consensus model of discrete time multi agent system with quantization and communication delay is proposed for second order multiple flying vehicles systems with fixed topology and switching topologies the sampled data consensus protocol is proposed in mu et al 2015 besides delays governed by a partially unknown markov chain are also discussed considering markov switching topologies and time delay pei and sun 2015 introduces the average consensus protocol for discrete time multi agent systems ding and guo 2015 is proposed a sampled data consensus control protocol with a variable sampling period for high order nonlinear multi agent systems with switching topologies governed by a markov chain and communication delay a multi leaders collaborative localization based on the unscented particle filter for auvs is presented in zhao et al 2016 which solves the depletion problem of particles and improves the effectiveness of the filtering method considering the undirected graph between followers and a digraph between leaders and followers xing et al 2017 summarizes the influence on the convergence speed of multi auv systems and then proposes a localization approach is based on a consensus unscented particle filter algorithm liu et al 2017 considers the problem of large delay sequences leader following consensus control protocol for discrete time multi agent systems is developed liu and shan 2017 proposes an event triggered leader follower consensus controller for lipschitz nonlinear multi agent systems liang et al 2019 addresses a leader following exponential consensus protocol for discrete time multi agent systems with fixed topology and switching topologies inspired by the above works this paper aims to investigate leader following consensus of discrete time multi auv recovery system with time varying delay the multi auv recovery problem is transformed into the leader following coordinated control problem the remainder of this paper is organized as follows in section 2 graph theory auv dynamic model and some lemma are presented in section 3 a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology and considering the effect of communication delay in section 4 the leader following consensus problem is equivalently converted to the stability of the multi auv recovery system with time varying delay new stability criteria are established to guarantee the consensus of the multi auv recovery system based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities therefore the controller gains are derived in section 5 simulation results are provided to illustrate the effectiveness of theoretical results finally some conclusions are drawn in section 6 a leader following consensus control protocol for multi auv recovery system is proposed in this paper considering that the auv is a second order nonlinear model and the communication information between auvs is discrete and delayed therefore this model can describe the practical problems encountered by multiple auvs in the recovery process more effectively and accurately if the delay problem is ignored in the actual recovery process the multi auv recovery system cannot accurately obtain the current state of all auvs in the recovery process which will lead to the failure of recovery therefore the leader following consensus control protocol established in this paper has great significance and value in practical application and provides a good theoretical reference for the successful recovery of multiple auvs 2 preliminaries in this section basic notions of graph theory auv dynamic models and some lemma are presented 2 1 graph theory the interaction topology of a network of auvs can be described by the weighted directed graph suppose a multi auv recovery system consists of n auvs and a mothership digraph g v ε a denotes the communication topology between n auvs and the node set v v 1 v 2 v n represents multi auv an edge set ε v v represents information exchange between auv and an adjacency matrix a a i j ℝ n n of the directed digraph g is the matrix with non negative elements where a i j 0 if the auv j transmits information to the auv i that is v j v i ε otherwise a i j 0 i j moreover a i i 0 for all i v the neighbor set of auv i is denoted by n i j v v j v i ε the laplacian matrix l ℝ n n of the multi auv recovery system is defined as l i i j 1 j i n a i j l i j a i j denote the matrix m d i a g m 1 m 2 m n m ℝ n n if the mothership and auv i are connected m i 0 i 1 2 n otherwise m i 0 2 2 the auv model according to the body fixed and earth fixed coordinate systems both mothership and auv dynamic models can be established by the 6 degrees of freedom dofs model as shown in fig 1 the symbols and parameters of mothership and auv conform to the international pool conference ittc and the society of shipbuilding and marine engineering sname terminology bulletin the coordinate system satisfies the right hand cartesian rectangular coordinate system see table 1 fossen et al 2011 the torpedo like auv is selected in this paper the auv is symmetrical in horizontal and vertical directions as shown in fig 1 the roll speed is ignored in this paper fossen 2011 the kinematics model and kinetics model of auv are shown as follows respectively 1 η j η v 2 m v c v v d v v g η τ where η x y z θ ϕ t ℝ 5 describes the states of position and euler angles of auv v i u i v i w i q i r i t ℝ 5 describes the states of auv s velocities j v is the jacobian matrix matrix m c v and d v denote the inertia matrix coriolis and centripetal matrix and damping matrix respectively g η is a vector of generalized gravitational and buoyancy forces equal to zero in this paper τ is the control input further details of auv model parameters are available in fossen 2011 fossen 1994 the model of auv can be derived as follows 3 η v i 0 0 m 1 j η v g v v 0 m 1 γ ξ u τ then standard nonlinearization function of auv s dynamic model can be described as 4 ξ f ξ g ξ u τ 5 μ h ξ where ξ η t v t t h ξ η f ξ f 1 ξ f 2 ξ f 10 ξ i 0 0 m 1 j η v g v v g ξ g 1 ξ g 2 ξ g 5 ξ 0 m 1 γ ξ based on the concept of relative order and lie derivative the control input in the new linearization system is defined as 6 u b ξ γ ξ u τ where b ξ l f 2 h 1 ξ l f 2 h 2 ξ l f 2 h 3 ξ l f 2 h 4 ξ l f 2 h 5 ξ t γ ξ γ i j ξ l k j l f h i ξ ℝ 5 5 1 i 5 1 j 5 the standard feedback linearization dynamic model of the auv can be deduced as follows 7 x i v i v i u i where x i ℝ 5 v i ℝ 5 u i ℝ 5 the details can be referred to yan et al 2017 2 3 lemma the following lemmas will be applied to the derivation below lemma 1 graham 1982 the kronecker product is an operation between two matrices which has the following properties 1 α a b a α b 2 a b c a c b c 3 a b c d a c b d kronecker product is marked as lemma 2 wang et al 1992 for any x y r n and any positive definite matrix p r n n there are the following relationship 2 x t y x t p x y t p 1 y lemma 3 boyd et al 1994 for a given matrix s s 11 s 12 s 22 with s 11 s 11 t s 22 s 22 t then s 0 if and only if s 11 0 s 22 s 12 t s 11 1 s 12 0 or equivalently s 22 0 s 11 s 12 t s 22 1 s 12 0 3 problem formulation in this section consider a discrete time multi auv recovery system with time varying delay the multi auv recovery problem is transformed into the leader following coordinated control problem suppose the multi auv system consists of auvs following agents and mothership leader agent where each auv is considered a node in graph g the dynamics of the mothership can be described by 8 x m k 1 a x m k where x m k ℝ 10 is the state of the mothership the mothership provides the information for auvs to track its trajectory the dynamics of auv is a discrete time system p i k 1 p i k v i k v i k 1 v i k u i k where p i k ℝ 5 v i k ℝ 5 and u i k ℝ 5 are the state and control input of auv i respectively the state of mothership and auv i can be described as x m t p m t t v m t t t ℝ 10 x i t p i t t v i t t t ℝ 10 then the dynamics of auv can be rewritten as 9 x i k 1 a x i k b u i k a i i 0 i ℝ 10 10 and b 0 0 i i ℝ 10 10 are constant matrices with appropriate dimensions to solve the dynamic consensus problem for multiple auvs system the consensus protocol is designed as 10 u i k k j n i a i j k x i k x j k m i x i k x m k k ℝ 10 10 is the consensus control gain matrix to be designed later considering the communication delay caused by the limited underwater communication of auv the control protocol with time delay is 11 u i k k j n i a i j k x i k d k x j k d k m i x i k d k x m k d k d k is a time varying integer delay satisfying 0 d m d k d m then discrete time system 9 under the protocol 11 can be written as 12 x i k 1 a x i k b k j n i a i j k x i k d k x j k d k m i x i k d k x m k d k let ε i k x i k x m denote ε k ε 1 t k ε 2 t k ε n t k t u k u 1 t k u 2 t k u n t k t by using lemma 1 the error dynamics of the multi auv recovery system is described as 13 ε k 1 i n a ε k h b k ε k d k where h l m assumption 1 the multi auv recovery system s communication network is fixed and its topology graph contains a directed spanning tree whose mothership is the root node definition 1 sakthivel et al 2018 the multi auv recovery system 8 9 is said to reach exponential consensus under the consensus protocol 11 if the error dynamics of the multi auv recovery system 13 is exponentially stable with a convergence rate α i e there exist scalars α 0 β 0 such that x i t x m t β e α k ϕ i 1 2 n k z where ϕ sup k z d m 0 x i t x m t the paper aims to design appropriate consensus controller k to ensure that the multi auv recovery system can reach leader following consensus the leader following consensus problem is equivalently converted to the stability of the multi auv recovery system with time varying delay the stability problem will be discussed in the next section remark 1 in the process of auv transmitting information underwater communication delay and noise interference may occur in this paper we only consider the influence of communication delay remark 2 assumption 1 is a necessary condition when the auvs work underwater the communication infrastructure needs to be constructed in advance and cannot be reconfigured hou et al 2014 the auvs communication relation is that one auv can affect all other auvs through the communication links otherwise there will exist two subgroups of auvs and information cannot be transferred between them therefore consistency cannot be achieved the assumption is an essential requirement for a multi auv recovery system wu and shi 2011 4 main results in this section to solve the leader following coordinated control problem of a multi auv recovery system with time varying delay two critical issues will be addressed 1 establish stability criteria 2 design controllers 4 1 consensus analysis a sufficient condition will be established suitable lyapunov krosovskii functional and a set of linear matrix inequalities for the multi auv recovery system in this section the stability criteria guarantee the consensus of the multi auv recovery system theorem 1 will be present in the position theorem 1 assume that assumptions 1 hold for a given scalars α 0 the consensus of the multi auv recovery system 13 can be achieved if there exist matrices p 0 r 0 q 1 q 2 q 3 0 and matrices g with appropriate dimensions such that the following linear matrix inequality holds 14 ω 1 ω 2 ω 2 t ω 3 ω 4 0 where ω 1 ω 11 0 ω 13 0 ω 22 0 0 ω 33 0 ω 44 ω 11 e 2 α i n a t p i n a d m i n a t r i n a p q 1 d m d m 1 q 2 q 3 ω 22 q 1 ω 33 e 2 α d m 1 h b k t p h b k d m e 2 α d m 1 h b k t r h b k q 2 ω 44 q 3 ω 13 e α d m 2 i n a t p h b k d m e α d m 1 i n a t r h b k ω 2 g 0 0 g ω 3 g 0 0 0 ω 4 d i a g r 0 0 0 proofdefine z k e α k ε k and ϒ k z k z k d m z k d k z k d m the error dynamics 13 can be rewritten as 15 z k 1 e α i n a z k e α d k 1 h b k z k d k construct the following lyapunov krasovskii functional candidate 16 v k v 1 k v 2 k v 3 k v 4 k where v 1 k z t k p z k v 2 k i k d m k 1 z t i q 1 z i i k d k k 1 z t i q 2 z i i k d m k 1 z t i q 3 z i v 3 k j d m 2 d m 1 i k j 1 k 1 z t i q 2 z i v 4 k j d m 1 i k j k 1 ξ t i r ξ i with ξ k z k 1 z k p ℝ n n r ℝ n n q 1 ℝ n n q 2 ℝ n n and q 3 ℝ n n are positive definite matrices to be determined calculating the difference for four terms of the lyapunov function δ v 1 k v 1 k 1 v 1 k z t k 1 p z k 1 z t k p z k z t k e 2 α i n a t p i n a p z k z t k e α d k 2 i n a t p h b k z k d k z t k d k e α d k 2 h b k t p i n a z k z t k d k e 2 α d k 1 h b k t p h b k z k d k using lemma 2 it is calculated as 17 δ v 1 k z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p i n a z k z t k d k e α d m 2 h b k t p h b k z k d k z t k d k e 2 α d m 1 h b k t p h b k z k d k 18 δ v 2 k v 2 k 1 v 2 k i k d m 1 k z t i q 1 z i i k d k 1 1 k z t i q 2 z i i k d m 1 k z t i q 3 z i i k d m k 1 z t i q 1 z i i k d k k 1 z t i q 2 z i i k d m k 1 z t i q 3 z i z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m i k d m 1 k d m z t i q 2 z i 19 δ v 3 k v 3 k 1 v 3 k j d m 2 d m 1 i k j k z t i q 2 z i j d m 2 d m 1 i k j 1 k 1 z t i q 2 z i d m d m z t k q 2 z k i k d m 1 k d m z t i q 2 z i 20 δ v 4 k v 4 k 1 v 4 k j d m 1 i k j 1 k ξ t i r ξ i j d m 1 i k j k 1 ξ t i r ξ i d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k i k d m k 1 ξ t i r ξ i a e α a 1 21 δ v k z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p h b k z k d k z t k d k e α d m 2 h b k t p i n a z k z t k d k e 2 α d m 1 h b k t p h b k z k d k z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m d m d m z t k q 2 z k d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k i k d m k 1 ξ t i r ξ i 2 ϒ t k g z k z k d m i k d m k 1 ξ i z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p h b k z k d k z t k d k e α d m 2 h b k t p i n a z k z t k d k e 2 α d m 1 h b k t p h b k z k d k z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m d m d m z t k q 2 z k d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k ϒ t k ω 2 ω 2 t ϒ k ϒ t k g r 1 g t ϒ k ϒ t k ω 1 ω 2 ω 2 t g r 1 g t ϒ k in what follows if lmi 14 holds we have ω 1 ω 2 ω 2 t g r 1 g t 0 by using schur complement lemma 3 then we can obtain δ v k 0 namely v k v 0 the subsequent task is to prove that the multi auv recovery system is exponentially stable liang et al 2019 δ 1 and δ 2 are defined as follows firstly δ 1 λ min p δ 2 λ max p e α d m 2 d m λ max q 1 d m λ m a x q 2 d m λ m a x q 3 1 2 d m d m 2 λ max q 2 1 2 d m 2 λ max r λ min p means the minimum eigenvalue of the structure matrix p we know that 22 δ 1 z k 2 v k v 0 δ 2 φ 2 it is easy to prove that z k δ 2 δ 1 φ thus it can be obtained that 23 ε k δ 2 δ 1 e α k φ therefore the error system 13 is exponentially stable from theorem 1 the multi auv recovery system can reach the exponential consensus the proof is completed 4 2 consensus controller design a sufficient condition for the multi auv recovery system on the existence of consensus controller gains based on theorem 1 will be derived in this part theorem 2 assume that assumptions 1 hold for given scalars α 0 the consensus of the multi auv recovery system 13 can be achieved if there exist matrices p 0 r 0 q 1 q 2 q 3 0 and matrices g with appropriate dimensions satisfying the following linear matrix inequality 24 λ ω 2 ω 2 t ω 3 γ 0 ω 4 t 0 ξ 0 σ 0 where λ d i a g p q 1 d m d m 1 q 2 q 3 q 1 q 2 q 3 ω 2 g 0 0 g ω 3 g 0 0 0 ω 4 d i a g r 0 0 0 γ i n a 0 0 0 0 0 0 h b k 0 0 t i n a 0 0 0 0 0 0 h b k 0 0 ξ e 2 α p 0 e α d m 2 p 0 0 0 0 e 2 α d m 1 p 0 0 2 i n p σ d m r 0 e α d m 1 d m r 0 0 0 0 e 2 α d m 1 d m r 0 0 2 i n p the consensus protocol gains are given by k k p proofinequality 14 can be rewritten as 25 ω 1 ω 2 ω 2 t ω 3 ω 4 λ γ t ξ γ t t σ t ω 2 ω 2 t ω 3 ω 4 λ ω 2 ω 2 t ω 3 ω 4 γ t ξ γ t t σ t 0 0 0 λ ω 2 ω 2 t ω 3 ω 4 γ t t t 0 0 ξ 0 0 σ γ 0 t 0 0 where λ d i a g p q 1 d m d m 1 q 2 q 3 q 1 q 2 q 3 γ i n a 0 0 0 0 0 0 h b k 0 0 t i n a 0 0 0 0 0 0 h b k 0 0 ξ e 2 α p 0 e α d m 2 p 0 0 0 0 e 2 α d m 1 p 0 0 σ d m r 0 e α d m 1 d m r 0 0 0 0 e 2 α d m 1 d m r 0 0 using the schur complement we have 26 λ ω 2 ω 2 t ω 3 γ 0 ω 4 t 0 ξ 1 0 σ 1 0 pre and post multiplying inequality 26 by matrix j d i a g i n p i n p i n p i n p defining p p 1 k k p q p q p g p g p r p r p a p a p a p a p h p h for any matrix r 0 we have that wu and shi 2011 27 p r 1 p r 2 p from 27 it is easy to prove that 28 ξ 1 i n p i n p ξ 1 i n p i n p i n p ξ 2 p i n p i n p ξ i n p 2 i n p ξ σ 1 i n p i n p σ 1 i n p i n p i n p σ 2 p i n p i n p σ i n p 2 i n p σ therefore if the lmi 24 holds the multi auv recovery system 13 is stable the proof is completed 5 numerical example in this section two numerical examples are given to illustrate the correctness of the consensus control protocol of the multi auv recovery system in this paper example 1 in this example the multi auv recovery system consists of a mothership and five auvs fig 2 shows the directed fixed communication topology the parameters of the auv model refer to yan et al 2015 table 2 shows the initial value of mothership the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 pitch angles θ of auvs are set in the interval π 9 π 9 yaw angles φ are set in the interval 0 2 π the initial velocities of auvs are zero the time varying delay is set as d k 2 sin k π 2 α 0 12 the recovery path is expressed as x t 100 cos 0 05 π t y t 100 sin 0 05 π t z t 0 05 t according to theorem 2 the controller gain matrix can be obtained as k 0 135 0 852 i 5 5 simulation results are shown in figs 3 6 fig 3 describes the trajectories of multi auv spatial position errors in the recovery process the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 the spatial position errors are asymptotically convergent to zero in 250 s that is the positions of auvs finally converge to the state of the mothership within 250 s fig 4 describes trajectories of multi auv pitch angle errors in the recovery process the initial pitch angles of auvs are in the interval π 9 π 9 the pitch angle errors are asymptotically convergent to zero in 300 s that is the pitch angles of auvs finally converge to the state of the mothership within 300 s fig 5 describes trajectories of multi auv yaw angle errors in the recovery process the initial yaw angles of auvs are in the interval 0 2 π the yaw angle errors are asymptotically convergent to zero in 400 s that is the yaw angles of auvs finally converge to the state of the mothership within 400 s the three dimensional trajectories of the multi auv recovery system are shown in fig 6 intuitively the initial locations of auvs are randomly distributed the mothership tracks the known recovery trajectory auvs convergent to the mothership and then keep consistent with the mothership in the remaining seconds stability the multi auv recovery system can reach consensus by using the consensus algorithm 11 therefore the recovery task can be completed example 2 in this scenario we assume that the different time delay is set as d k 3 cos k π 2 other parameters are the same as in example 1 the controller gain matrix can be obtained as k 0 083 0 972 i 5 5 fig 7 describes trajectories of multi auv spatial position errors in the recovery process the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 the spatial position errors are asymptotically convergent to zero in 300 s fig 8 describes trajectories of multi auv pitch angle errors in the recovery process the initial pitch angles of auvs are in the interval π 9 π 9 the pitch angle errors are asymptotically convergent to zero in 300 s fig 9 describes trajectories of multi auv yaw angle errors in the recovery process the initial yaw angles of auvs are in the interval 0 2 π the yaw angle errors are asymptotically convergent to zero in 500 s three dimensional trajectories describe the whole recovery process more intuitively fig 10 auv s initial locations are randomly distributed auvs convergent to the mothership and stay consistent with the mothership stability comparing the two examples the initial position error of example 1 is larger than that of example 2 but the convergence speed is faster than that of example 2 the pitch angle error and yaw angle error range of example 2 are bigger and the convergence speed is slower than example 1 the comparison results show that example 2 takes more time to stabilization comparing with example 1 it can be seen that the time delay affects the convergence speed based on the simulation results above it is easy to derive that a multi auv recovery system with time varying delay under directed topology can reach a convergence state from a random initial state the multi auv recovery system completes the recovery task the multi auv recovery system can reach consensus by using the consensus algorithm 11 the consensus algorithm 11 can not only attain consistency but also make all the state of auvs maintain the same level with mothership after a period of time it is worth noting that the auvs model needs to be rotated by the feedback linearization method and the convergence speed is slow 6 conclusions in this paper the leader following consensus of discrete time multi auv recovery systems with time varying delay has been investigated the mothership is regarded as a leader and auvs are regarded as followers the multi auv recovery problem has been transformed into the leader following coordinated control problem under the consideration of the directed fixed communication topology a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems has been proposed with this protocol the leader following consensus problem has been equivalently converted to the stability of the multi auv recovery system with time varying delay based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities new stability criteria have been established to guarantee the consensus of the multi auv recovery system therefore the controller gains have been derived finally simulation results have been provided to illustrate the effectiveness of theoretical results based on the simulation results above it is easy to derive that the multi auv recovery system could effectively complete the recovery task there could be some further improvements to this work 1 the multi auv recovery system scenario can be extended to the influence of asynchronous switching 2 the experimental validation by applying the consensus protocols to the real auvs formation system also needs further investigation credit author statement wei zhang methodology investigation jia zeng investigation writing original draft zheping yan project administration funding acquisition shilin wei writing review editing weida tian software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china the funding number is 51609046 fundamental research funds for the central universities the number are heucp201736 and heucfm171011 and science fund project in heilongjiang province the number is e2016020 
21226,this paper is concerned with the leader following consensus of discrete time multi auv recovery systems with time varying delay during the recycling process the mothership is regarded as a leader and auvs are regarded as followers the multi auv recovery problem is transformed into the leader following coordinated control problem a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology new stability criteria are established to guarantee the consensus of the multi auv recovery system based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities therefore the controller gains are derived finally simulation results are provided to illustrate the effectiveness of theoretical results keywords multiple auvs recovery system discrete time leader following consensus time varying delay 1 introduction as one of the essential components of the unmanned underwater system autonomous underwater vehicle auv is a kind of submersible vehicle that relies on its energy self propulsion autonomous control and can be recovered and reused at present auv is widely used in marine engineering and other fields compared with the single auv the multi auv system has more advantages in distribution applicability coordination safety and intelligence team coordination to complete tasks can effectively improve efficiency expand capabilities save costs and improve accuracy zhang et al 2019 the research of multi auv coordinated control is the inevitable direction of auv development recovery is the essential operation of auv in task execution and it is also the last and most critical step to ensure the successful completion of the task unsuccessful recycling will not only lead to task failure but even cause the auv to be damaged or lost the recovery of the multi auv system is different from that of single auv and new requirements are put forward for the multiple auv recovery system during the recovery process all states of the multi auv system are finally consistent during the recycling process the mothership is regarded as a leader and auvs are regarded as followers therefore the multi auv recovery problem is transformed into the leader following coordinated control problem due to the complex and unknown marine environment and auv has highly complex nonlinear dynamics the leader following coordinated control problem of the multi auv system is a well known challenge in the past few decades many researchers have done much research on the coordinated control of multi auv fiorelli et al 2004 cui et al 2010 peng et al 2013 millán et al 2014 wang et al 2016 chen and ho 2016 yan et al 2017 yuan et al 2018 fabiani et al 2018 cao and guo 2019 these articles mainly focus on the consensus control of continuous time multi auv however the communication information of multi auv is discrete data in actual work besides there are a few pieces of research related to the multi auv recovery system the studies of coordinated control of the multi auv recovery system have practical significance multi auv can effectively perform recovery tasks under the condition of successful information exchange nevertheless communication information among auvs may be delayed affected by actual sea conditions and this situation may lead to instability and poor performance of control systems for the consensus of the discrete time multi agent systems with time delays there have been many research results wu and shi 2011 investigates the sampled data consensus control protocol for the multi agent system with the statistical characteristics of delays governed by a markov chain liu et al 2012 considers the distributed time delays including a single or multiple time delay a distributed consensus control protocol for discrete time multi agent network with fixed topologies is deduced hou et al 2014 proposes the stationary and dynamic consensus control protocol for a multi agent system with input delays governed by markov jumping and the controller is designed by a ccl based algorithm li et al 2014 assumes that each agent receives the delayed quantized information only from its neighbors the consensus model of discrete time multi agent system with quantization and communication delay is proposed for second order multiple flying vehicles systems with fixed topology and switching topologies the sampled data consensus protocol is proposed in mu et al 2015 besides delays governed by a partially unknown markov chain are also discussed considering markov switching topologies and time delay pei and sun 2015 introduces the average consensus protocol for discrete time multi agent systems ding and guo 2015 is proposed a sampled data consensus control protocol with a variable sampling period for high order nonlinear multi agent systems with switching topologies governed by a markov chain and communication delay a multi leaders collaborative localization based on the unscented particle filter for auvs is presented in zhao et al 2016 which solves the depletion problem of particles and improves the effectiveness of the filtering method considering the undirected graph between followers and a digraph between leaders and followers xing et al 2017 summarizes the influence on the convergence speed of multi auv systems and then proposes a localization approach is based on a consensus unscented particle filter algorithm liu et al 2017 considers the problem of large delay sequences leader following consensus control protocol for discrete time multi agent systems is developed liu and shan 2017 proposes an event triggered leader follower consensus controller for lipschitz nonlinear multi agent systems liang et al 2019 addresses a leader following exponential consensus protocol for discrete time multi agent systems with fixed topology and switching topologies inspired by the above works this paper aims to investigate leader following consensus of discrete time multi auv recovery system with time varying delay the multi auv recovery problem is transformed into the leader following coordinated control problem the remainder of this paper is organized as follows in section 2 graph theory auv dynamic model and some lemma are presented in section 3 a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology and considering the effect of communication delay in section 4 the leader following consensus problem is equivalently converted to the stability of the multi auv recovery system with time varying delay new stability criteria are established to guarantee the consensus of the multi auv recovery system based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities therefore the controller gains are derived in section 5 simulation results are provided to illustrate the effectiveness of theoretical results finally some conclusions are drawn in section 6 a leader following consensus control protocol for multi auv recovery system is proposed in this paper considering that the auv is a second order nonlinear model and the communication information between auvs is discrete and delayed therefore this model can describe the practical problems encountered by multiple auvs in the recovery process more effectively and accurately if the delay problem is ignored in the actual recovery process the multi auv recovery system cannot accurately obtain the current state of all auvs in the recovery process which will lead to the failure of recovery therefore the leader following consensus control protocol established in this paper has great significance and value in practical application and provides a good theoretical reference for the successful recovery of multiple auvs 2 preliminaries in this section basic notions of graph theory auv dynamic models and some lemma are presented 2 1 graph theory the interaction topology of a network of auvs can be described by the weighted directed graph suppose a multi auv recovery system consists of n auvs and a mothership digraph g v ε a denotes the communication topology between n auvs and the node set v v 1 v 2 v n represents multi auv an edge set ε v v represents information exchange between auv and an adjacency matrix a a i j ℝ n n of the directed digraph g is the matrix with non negative elements where a i j 0 if the auv j transmits information to the auv i that is v j v i ε otherwise a i j 0 i j moreover a i i 0 for all i v the neighbor set of auv i is denoted by n i j v v j v i ε the laplacian matrix l ℝ n n of the multi auv recovery system is defined as l i i j 1 j i n a i j l i j a i j denote the matrix m d i a g m 1 m 2 m n m ℝ n n if the mothership and auv i are connected m i 0 i 1 2 n otherwise m i 0 2 2 the auv model according to the body fixed and earth fixed coordinate systems both mothership and auv dynamic models can be established by the 6 degrees of freedom dofs model as shown in fig 1 the symbols and parameters of mothership and auv conform to the international pool conference ittc and the society of shipbuilding and marine engineering sname terminology bulletin the coordinate system satisfies the right hand cartesian rectangular coordinate system see table 1 fossen et al 2011 the torpedo like auv is selected in this paper the auv is symmetrical in horizontal and vertical directions as shown in fig 1 the roll speed is ignored in this paper fossen 2011 the kinematics model and kinetics model of auv are shown as follows respectively 1 η j η v 2 m v c v v d v v g η τ where η x y z θ ϕ t ℝ 5 describes the states of position and euler angles of auv v i u i v i w i q i r i t ℝ 5 describes the states of auv s velocities j v is the jacobian matrix matrix m c v and d v denote the inertia matrix coriolis and centripetal matrix and damping matrix respectively g η is a vector of generalized gravitational and buoyancy forces equal to zero in this paper τ is the control input further details of auv model parameters are available in fossen 2011 fossen 1994 the model of auv can be derived as follows 3 η v i 0 0 m 1 j η v g v v 0 m 1 γ ξ u τ then standard nonlinearization function of auv s dynamic model can be described as 4 ξ f ξ g ξ u τ 5 μ h ξ where ξ η t v t t h ξ η f ξ f 1 ξ f 2 ξ f 10 ξ i 0 0 m 1 j η v g v v g ξ g 1 ξ g 2 ξ g 5 ξ 0 m 1 γ ξ based on the concept of relative order and lie derivative the control input in the new linearization system is defined as 6 u b ξ γ ξ u τ where b ξ l f 2 h 1 ξ l f 2 h 2 ξ l f 2 h 3 ξ l f 2 h 4 ξ l f 2 h 5 ξ t γ ξ γ i j ξ l k j l f h i ξ ℝ 5 5 1 i 5 1 j 5 the standard feedback linearization dynamic model of the auv can be deduced as follows 7 x i v i v i u i where x i ℝ 5 v i ℝ 5 u i ℝ 5 the details can be referred to yan et al 2017 2 3 lemma the following lemmas will be applied to the derivation below lemma 1 graham 1982 the kronecker product is an operation between two matrices which has the following properties 1 α a b a α b 2 a b c a c b c 3 a b c d a c b d kronecker product is marked as lemma 2 wang et al 1992 for any x y r n and any positive definite matrix p r n n there are the following relationship 2 x t y x t p x y t p 1 y lemma 3 boyd et al 1994 for a given matrix s s 11 s 12 s 22 with s 11 s 11 t s 22 s 22 t then s 0 if and only if s 11 0 s 22 s 12 t s 11 1 s 12 0 or equivalently s 22 0 s 11 s 12 t s 22 1 s 12 0 3 problem formulation in this section consider a discrete time multi auv recovery system with time varying delay the multi auv recovery problem is transformed into the leader following coordinated control problem suppose the multi auv system consists of auvs following agents and mothership leader agent where each auv is considered a node in graph g the dynamics of the mothership can be described by 8 x m k 1 a x m k where x m k ℝ 10 is the state of the mothership the mothership provides the information for auvs to track its trajectory the dynamics of auv is a discrete time system p i k 1 p i k v i k v i k 1 v i k u i k where p i k ℝ 5 v i k ℝ 5 and u i k ℝ 5 are the state and control input of auv i respectively the state of mothership and auv i can be described as x m t p m t t v m t t t ℝ 10 x i t p i t t v i t t t ℝ 10 then the dynamics of auv can be rewritten as 9 x i k 1 a x i k b u i k a i i 0 i ℝ 10 10 and b 0 0 i i ℝ 10 10 are constant matrices with appropriate dimensions to solve the dynamic consensus problem for multiple auvs system the consensus protocol is designed as 10 u i k k j n i a i j k x i k x j k m i x i k x m k k ℝ 10 10 is the consensus control gain matrix to be designed later considering the communication delay caused by the limited underwater communication of auv the control protocol with time delay is 11 u i k k j n i a i j k x i k d k x j k d k m i x i k d k x m k d k d k is a time varying integer delay satisfying 0 d m d k d m then discrete time system 9 under the protocol 11 can be written as 12 x i k 1 a x i k b k j n i a i j k x i k d k x j k d k m i x i k d k x m k d k let ε i k x i k x m denote ε k ε 1 t k ε 2 t k ε n t k t u k u 1 t k u 2 t k u n t k t by using lemma 1 the error dynamics of the multi auv recovery system is described as 13 ε k 1 i n a ε k h b k ε k d k where h l m assumption 1 the multi auv recovery system s communication network is fixed and its topology graph contains a directed spanning tree whose mothership is the root node definition 1 sakthivel et al 2018 the multi auv recovery system 8 9 is said to reach exponential consensus under the consensus protocol 11 if the error dynamics of the multi auv recovery system 13 is exponentially stable with a convergence rate α i e there exist scalars α 0 β 0 such that x i t x m t β e α k ϕ i 1 2 n k z where ϕ sup k z d m 0 x i t x m t the paper aims to design appropriate consensus controller k to ensure that the multi auv recovery system can reach leader following consensus the leader following consensus problem is equivalently converted to the stability of the multi auv recovery system with time varying delay the stability problem will be discussed in the next section remark 1 in the process of auv transmitting information underwater communication delay and noise interference may occur in this paper we only consider the influence of communication delay remark 2 assumption 1 is a necessary condition when the auvs work underwater the communication infrastructure needs to be constructed in advance and cannot be reconfigured hou et al 2014 the auvs communication relation is that one auv can affect all other auvs through the communication links otherwise there will exist two subgroups of auvs and information cannot be transferred between them therefore consistency cannot be achieved the assumption is an essential requirement for a multi auv recovery system wu and shi 2011 4 main results in this section to solve the leader following coordinated control problem of a multi auv recovery system with time varying delay two critical issues will be addressed 1 establish stability criteria 2 design controllers 4 1 consensus analysis a sufficient condition will be established suitable lyapunov krosovskii functional and a set of linear matrix inequalities for the multi auv recovery system in this section the stability criteria guarantee the consensus of the multi auv recovery system theorem 1 will be present in the position theorem 1 assume that assumptions 1 hold for a given scalars α 0 the consensus of the multi auv recovery system 13 can be achieved if there exist matrices p 0 r 0 q 1 q 2 q 3 0 and matrices g with appropriate dimensions such that the following linear matrix inequality holds 14 ω 1 ω 2 ω 2 t ω 3 ω 4 0 where ω 1 ω 11 0 ω 13 0 ω 22 0 0 ω 33 0 ω 44 ω 11 e 2 α i n a t p i n a d m i n a t r i n a p q 1 d m d m 1 q 2 q 3 ω 22 q 1 ω 33 e 2 α d m 1 h b k t p h b k d m e 2 α d m 1 h b k t r h b k q 2 ω 44 q 3 ω 13 e α d m 2 i n a t p h b k d m e α d m 1 i n a t r h b k ω 2 g 0 0 g ω 3 g 0 0 0 ω 4 d i a g r 0 0 0 proofdefine z k e α k ε k and ϒ k z k z k d m z k d k z k d m the error dynamics 13 can be rewritten as 15 z k 1 e α i n a z k e α d k 1 h b k z k d k construct the following lyapunov krasovskii functional candidate 16 v k v 1 k v 2 k v 3 k v 4 k where v 1 k z t k p z k v 2 k i k d m k 1 z t i q 1 z i i k d k k 1 z t i q 2 z i i k d m k 1 z t i q 3 z i v 3 k j d m 2 d m 1 i k j 1 k 1 z t i q 2 z i v 4 k j d m 1 i k j k 1 ξ t i r ξ i with ξ k z k 1 z k p ℝ n n r ℝ n n q 1 ℝ n n q 2 ℝ n n and q 3 ℝ n n are positive definite matrices to be determined calculating the difference for four terms of the lyapunov function δ v 1 k v 1 k 1 v 1 k z t k 1 p z k 1 z t k p z k z t k e 2 α i n a t p i n a p z k z t k e α d k 2 i n a t p h b k z k d k z t k d k e α d k 2 h b k t p i n a z k z t k d k e 2 α d k 1 h b k t p h b k z k d k using lemma 2 it is calculated as 17 δ v 1 k z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p i n a z k z t k d k e α d m 2 h b k t p h b k z k d k z t k d k e 2 α d m 1 h b k t p h b k z k d k 18 δ v 2 k v 2 k 1 v 2 k i k d m 1 k z t i q 1 z i i k d k 1 1 k z t i q 2 z i i k d m 1 k z t i q 3 z i i k d m k 1 z t i q 1 z i i k d k k 1 z t i q 2 z i i k d m k 1 z t i q 3 z i z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m i k d m 1 k d m z t i q 2 z i 19 δ v 3 k v 3 k 1 v 3 k j d m 2 d m 1 i k j k z t i q 2 z i j d m 2 d m 1 i k j 1 k 1 z t i q 2 z i d m d m z t k q 2 z k i k d m 1 k d m z t i q 2 z i 20 δ v 4 k v 4 k 1 v 4 k j d m 1 i k j 1 k ξ t i r ξ i j d m 1 i k j k 1 ξ t i r ξ i d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k i k d m k 1 ξ t i r ξ i a e α a 1 21 δ v k z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p h b k z k d k z t k d k e α d m 2 h b k t p i n a z k z t k d k e 2 α d m 1 h b k t p h b k z k d k z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m d m d m z t k q 2 z k d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k i k d m k 1 ξ t i r ξ i 2 ϒ t k g z k z k d m i k d m k 1 ξ i z t k e 2 α i n a t p i n a p z k z t k e α d m 2 i n a t p h b k z k d k z t k d k e α d m 2 h b k t p i n a z k z t k d k e 2 α d m 1 h b k t p h b k z k d k z t k q 1 q 2 q 3 z k z t k d m q 1 z k d m z t k d k q 2 z k d k z t k d m q 3 z k d m d m d m z t k q 2 z k d m z t k i n a t r i n a z k d m z t k e α d m 1 i n a t r h b k z k d k d m z t k d k e α d m 1 h b k t r i n a z k d m z t k d k e 2 α d m 1 h b k t r h b k z k d k ϒ t k ω 2 ω 2 t ϒ k ϒ t k g r 1 g t ϒ k ϒ t k ω 1 ω 2 ω 2 t g r 1 g t ϒ k in what follows if lmi 14 holds we have ω 1 ω 2 ω 2 t g r 1 g t 0 by using schur complement lemma 3 then we can obtain δ v k 0 namely v k v 0 the subsequent task is to prove that the multi auv recovery system is exponentially stable liang et al 2019 δ 1 and δ 2 are defined as follows firstly δ 1 λ min p δ 2 λ max p e α d m 2 d m λ max q 1 d m λ m a x q 2 d m λ m a x q 3 1 2 d m d m 2 λ max q 2 1 2 d m 2 λ max r λ min p means the minimum eigenvalue of the structure matrix p we know that 22 δ 1 z k 2 v k v 0 δ 2 φ 2 it is easy to prove that z k δ 2 δ 1 φ thus it can be obtained that 23 ε k δ 2 δ 1 e α k φ therefore the error system 13 is exponentially stable from theorem 1 the multi auv recovery system can reach the exponential consensus the proof is completed 4 2 consensus controller design a sufficient condition for the multi auv recovery system on the existence of consensus controller gains based on theorem 1 will be derived in this part theorem 2 assume that assumptions 1 hold for given scalars α 0 the consensus of the multi auv recovery system 13 can be achieved if there exist matrices p 0 r 0 q 1 q 2 q 3 0 and matrices g with appropriate dimensions satisfying the following linear matrix inequality 24 λ ω 2 ω 2 t ω 3 γ 0 ω 4 t 0 ξ 0 σ 0 where λ d i a g p q 1 d m d m 1 q 2 q 3 q 1 q 2 q 3 ω 2 g 0 0 g ω 3 g 0 0 0 ω 4 d i a g r 0 0 0 γ i n a 0 0 0 0 0 0 h b k 0 0 t i n a 0 0 0 0 0 0 h b k 0 0 ξ e 2 α p 0 e α d m 2 p 0 0 0 0 e 2 α d m 1 p 0 0 2 i n p σ d m r 0 e α d m 1 d m r 0 0 0 0 e 2 α d m 1 d m r 0 0 2 i n p the consensus protocol gains are given by k k p proofinequality 14 can be rewritten as 25 ω 1 ω 2 ω 2 t ω 3 ω 4 λ γ t ξ γ t t σ t ω 2 ω 2 t ω 3 ω 4 λ ω 2 ω 2 t ω 3 ω 4 γ t ξ γ t t σ t 0 0 0 λ ω 2 ω 2 t ω 3 ω 4 γ t t t 0 0 ξ 0 0 σ γ 0 t 0 0 where λ d i a g p q 1 d m d m 1 q 2 q 3 q 1 q 2 q 3 γ i n a 0 0 0 0 0 0 h b k 0 0 t i n a 0 0 0 0 0 0 h b k 0 0 ξ e 2 α p 0 e α d m 2 p 0 0 0 0 e 2 α d m 1 p 0 0 σ d m r 0 e α d m 1 d m r 0 0 0 0 e 2 α d m 1 d m r 0 0 using the schur complement we have 26 λ ω 2 ω 2 t ω 3 γ 0 ω 4 t 0 ξ 1 0 σ 1 0 pre and post multiplying inequality 26 by matrix j d i a g i n p i n p i n p i n p defining p p 1 k k p q p q p g p g p r p r p a p a p a p a p h p h for any matrix r 0 we have that wu and shi 2011 27 p r 1 p r 2 p from 27 it is easy to prove that 28 ξ 1 i n p i n p ξ 1 i n p i n p i n p ξ 2 p i n p i n p ξ i n p 2 i n p ξ σ 1 i n p i n p σ 1 i n p i n p i n p σ 2 p i n p i n p σ i n p 2 i n p σ therefore if the lmi 24 holds the multi auv recovery system 13 is stable the proof is completed 5 numerical example in this section two numerical examples are given to illustrate the correctness of the consensus control protocol of the multi auv recovery system in this paper example 1 in this example the multi auv recovery system consists of a mothership and five auvs fig 2 shows the directed fixed communication topology the parameters of the auv model refer to yan et al 2015 table 2 shows the initial value of mothership the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 pitch angles θ of auvs are set in the interval π 9 π 9 yaw angles φ are set in the interval 0 2 π the initial velocities of auvs are zero the time varying delay is set as d k 2 sin k π 2 α 0 12 the recovery path is expressed as x t 100 cos 0 05 π t y t 100 sin 0 05 π t z t 0 05 t according to theorem 2 the controller gain matrix can be obtained as k 0 135 0 852 i 5 5 simulation results are shown in figs 3 6 fig 3 describes the trajectories of multi auv spatial position errors in the recovery process the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 the spatial position errors are asymptotically convergent to zero in 250 s that is the positions of auvs finally converge to the state of the mothership within 250 s fig 4 describes trajectories of multi auv pitch angle errors in the recovery process the initial pitch angles of auvs are in the interval π 9 π 9 the pitch angle errors are asymptotically convergent to zero in 300 s that is the pitch angles of auvs finally converge to the state of the mothership within 300 s fig 5 describes trajectories of multi auv yaw angle errors in the recovery process the initial yaw angles of auvs are in the interval 0 2 π the yaw angle errors are asymptotically convergent to zero in 400 s that is the yaw angles of auvs finally converge to the state of the mothership within 400 s the three dimensional trajectories of the multi auv recovery system are shown in fig 6 intuitively the initial locations of auvs are randomly distributed the mothership tracks the known recovery trajectory auvs convergent to the mothership and then keep consistent with the mothership in the remaining seconds stability the multi auv recovery system can reach consensus by using the consensus algorithm 11 therefore the recovery task can be completed example 2 in this scenario we assume that the different time delay is set as d k 3 cos k π 2 other parameters are the same as in example 1 the controller gain matrix can be obtained as k 0 083 0 972 i 5 5 fig 7 describes trajectories of multi auv spatial position errors in the recovery process the initial locations of auvs are randomly distributed in the 0 100 0 100 5 0 0 the spatial position errors are asymptotically convergent to zero in 300 s fig 8 describes trajectories of multi auv pitch angle errors in the recovery process the initial pitch angles of auvs are in the interval π 9 π 9 the pitch angle errors are asymptotically convergent to zero in 300 s fig 9 describes trajectories of multi auv yaw angle errors in the recovery process the initial yaw angles of auvs are in the interval 0 2 π the yaw angle errors are asymptotically convergent to zero in 500 s three dimensional trajectories describe the whole recovery process more intuitively fig 10 auv s initial locations are randomly distributed auvs convergent to the mothership and stay consistent with the mothership stability comparing the two examples the initial position error of example 1 is larger than that of example 2 but the convergence speed is faster than that of example 2 the pitch angle error and yaw angle error range of example 2 are bigger and the convergence speed is slower than example 1 the comparison results show that example 2 takes more time to stabilization comparing with example 1 it can be seen that the time delay affects the convergence speed based on the simulation results above it is easy to derive that a multi auv recovery system with time varying delay under directed topology can reach a convergence state from a random initial state the multi auv recovery system completes the recovery task the multi auv recovery system can reach consensus by using the consensus algorithm 11 the consensus algorithm 11 can not only attain consistency but also make all the state of auvs maintain the same level with mothership after a period of time it is worth noting that the auvs model needs to be rotated by the feedback linearization method and the convergence speed is slow 6 conclusions in this paper the leader following consensus of discrete time multi auv recovery systems with time varying delay has been investigated the mothership is regarded as a leader and auvs are regarded as followers the multi auv recovery problem has been transformed into the leader following coordinated control problem under the consideration of the directed fixed communication topology a new leader following consensus control protocol with time varying delay for discrete time multi auv recovery systems has been proposed with this protocol the leader following consensus problem has been equivalently converted to the stability of the multi auv recovery system with time varying delay based on suitable lyapunov krosovskii functional and a set of linear matrix inequalities new stability criteria have been established to guarantee the consensus of the multi auv recovery system therefore the controller gains have been derived finally simulation results have been provided to illustrate the effectiveness of theoretical results based on the simulation results above it is easy to derive that the multi auv recovery system could effectively complete the recovery task there could be some further improvements to this work 1 the multi auv recovery system scenario can be extended to the influence of asynchronous switching 2 the experimental validation by applying the consensus protocols to the real auvs formation system also needs further investigation credit author statement wei zhang methodology investigation jia zeng investigation writing original draft zheping yan project administration funding acquisition shilin wei writing review editing weida tian software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china the funding number is 51609046 fundamental research funds for the central universities the number are heucp201736 and heucfm171011 and science fund project in heilongjiang province the number is e2016020 
21227,this paper addresses the tracking control of a fully submerged hydrofoil craft fshc on the horizontal plane the motions of a fshc can be classified into three cruising conditions namely the hulborne the taking off and the foilborne considering that the fshc has the different model dynamics and disturbances between the three cruising conditions we treat the fshc model as a switched system between the hullborne and the foliborne conditions in which the taking off condition is conveniently omitted and deemed as the fast transient the compound learning technique is introduced to offset the uncertainties and it is comprised of two parts first the fuzzy logic system fls is employed to approximate the unknown model dynamics in each degree of freedom based on a serial parallel estimation model spem the composite adaptive laws are fabricated to estimate the weights of the fls by combining the tracking errors with the prediction errors between the estimation model and the dynamic loop of the fshc second the disturbance observer dob is fabricated to estimate the compound disturbance which is comprised of the approximation error of the fls and the disturbance based on the compound learning we develop the switched adaptive backstepping control laws of the fshc by employing the average dwell time method all the tracking and the estimation errors in the switched system are proved to be semi globally uniformly ultimately bounded sguub finally the numerical experiment is conducted to verify the effectiveness of the proposed scheme keywords fully submerged hydrofoil crafts switched systems compound learning disturbance observers 1 introduction the hydrofoil craft is a kind of high speed craft characterized by the foilborne navigation when the hydrofoil craft cruises at a high speed the hydrofoil can provide the lift to elevate the hull of the craft off the water surface this cruising condition is called the foilborne condition of the fshc seeing the left side of fig 1 this characteristic leads to the less wave resistance and friction of the hydrofoil craft than the common surface craft such that the hydrofoil craft can achieve better seakeeping and energy saving performance due to the limited bearing capacity of hydrofoils the hydrofoil craft is usually built with the light weight and the small size which makes it a decent candidate for the unmanned surface vessel to undertake the tasks such as patrol reconnaissance mine clearance and ocean monitoring there are mainly two types of hydrofoil crafts the first type is the surface piercing hydrofoil craft sphc which is usually installed with the fixed u shaped or v shaped hydrofoils the second one is the fully submerged hydrofoil craft fshc which is usually installed with the adjustable inverted t shaped hydrofoils because the sphc possesses the self calibrated ability in its roll motion it is fitted with the simpler control system than the fshc but is more susceptible to the influence of waves in contrast the fshc has the better seakeeping performance and can cruise like a platform in the irregular waves but it needs a complicated control system accommodating both longitudinal and lateral motions this reality motivates the research in this paper the existing researches of the fshc mainly concentrated on the hydrodynamic analysis and the optimization of the hydrofoil such as djavareshkian et al 2013 bi et al 2019 compared with the common surface craft the researches on controlling the fshc are not enriched according to our survey the control of fshc can be divided into two classes namely the longitudinal control and the planar control including the course keep and the path following for the longitudinal control kim and yamato 2004a studied the lift variation of the hydrofoils in the regular waves and developed a linear quadratic regulator lqg with kalman filtering of states it substantiated that the feedback control is inefficient in the following sea due to the lift variation to overcome this problem kim and yamato 2004b developed an optimal preview controller by using the future information of wave elevation and disturbance using this control scheme the fshc can achieve good performance of contouring waves in the following sea bai and kim 2010 compared the control performance of the pid the linear quadratic regulator lqr and the sliding mode control in the longitudinal control of the fshc the sliding mode control was found to have the best anti disturbance performance in liu et al 2019 a modified integral sliding mode controller was developed by involving the disturbance estimate it obtained the good attenuation of disturbances with little input chattering for the planar control of the fshc liu et al 2017b addressed the course keeping by integrating the sliding mode control with the iterative learning observer this observer can estimate both the states and the generalized disturbances in liu et al 2017a the path following of the fshc was achieved by using the adaptive los guidance and the integral sign feedback control laws the desired roll angle was generated in coordination with the yaw motion nevertheless the above control schemes only addressed the foilborne condition of the fshc as is shown in the right side of fig 1 the fshc will cruise like the common surface craft at the low speed which is called the hullborne condition of the fshc the transient between hullborne and foilborne conditions is called the taking off condition there is no doubt that the model dynamics and the influence of disturbances are totally different between three cruising conditions although the taking off condition can be omitted the controllers for the fshc in the foilborne condition may be invalid in the hullborne condition to address the switched models of the marine craft in different operating conditions the switched controller is required in koshkouei and nowak 2012 two switching methods between the pid and the sliding model control smc were presented for the triplet of controllers in the rudder fin roll stabilizer although the proposed switched control can achieve better anti roll and course keeping performance than single control the stability of the switched closed loop system is not proved it should be noted that the switched controllers in zhang and guo 2019 ghommam et al 2006 zhang and wu 2014 aim to solve the stabilization problem of underactuated surface vessels without satisfying the brocket condition and the models therein were not switched to control the switched model we can refer to the outcomes of nonlinear systems for more information in wu 2009 the unified controller was designed for the switched strict feedback nonlinear system with known model dynamics based on the simultaneous domination assumption for the switched nonlinear systems with unknown model dynamics the fls and the neural network nn were introduced as the approximators and the direct adaptive laws were fabricated yu et al 2010 han et al 2009 long and zhao 2015 tong et al 2015 2016 designed the switched controllers for this kind of system and the stability of the switched closed loop system was analyzed by using the average dwell time method with the minimum learning parameter of the fls li and tong 2017 designed a unified controller for the switched mimo nonstrict feedback nonlinear system compared with the switched controller the unified controller is more conservative another concern of this paper lies in dealing with the synthetic uncertainties including the unknown model dynamics and the disturbances according to deng et al 2019a b 2020a the fls and the nn were widely used to approximate the unknown model dynamics in marine crafts nevertheless there existed two drawbacks for these researches the first drawback was that the update laws of the fls and the nn therein only focused on guaranteeing the closed loop stability whereas the identification function was missing the composite learning was an effective tool to counteract this drawback in pan et al 2013 xu et al 2014 liu et al 2016 the spem was established to evaluate the approximation performance of the nn the prediction errors between the spem and the system model were involved in the direct adaptive law of the nn such that both the approximation performance of the nn and the tracking performance were guaranteed pan and yu 2018 xu et al 2018 further improved the prediction error with the online recorded data and the persistent excitation pe condition was released in our recent work of deng et al 2020b deng and zhang 2020 the composite adaptive fuzzy control was applied in the marine craft nevertheless the above composite learning schemes did not handle the disturbances and the approximation errors to unknown model dynamics which was deemed as the second drawback as was discussed in xu et al 2019 it was impossible to distinguish the disturbances from the unknown model dynamics and the leakage from unknown model dynamics to disturbances would largely degrade the approximation accuracy of the fls or nn as a new technique the compound learning was developed to provide a solution for this problem in xu 2018 xu et al 2019 the compound disturbance was defined by combining the approximation error of the nn with the disturbance and then the nn and the dob were organized in a compound way to learn the unknown dynamics and the compound disturbances separately to achieve the precise tracking control of the fshc it is worthwhile to ruminate over the application of compound learning to the control of the fshc motivated by the above challenges this paper proposes a switched compound learning tracking control scheme of the fshc at first a 4 degrees of freedom dof switched fshc model is established in which two sets of hydrodynamic parameters and disturbances switch between the hullborne and the foilborne conditions corresponding to the surge speed according to the planar motions of the fshc the reference roll angle is generated to facilitate the coordinate turning maneuver of the fshc based on the dynamic loop of the model a spem is established by using the flss and the prediction errors are derived by subtracting the estimated kinematic states from their real values the adaptive laws of the fls weights are fabricated by involving the tracking errors and the prediction errors to estimate the compound disturbances the dob is constructed by using the flss and the tracking errors then the switched control laws are designed according to the backstepping approach finally the stability analysis is completed by using the average dwell time method compared with the existing literature the contributions of this paper are mainly fourfold 1 for the first time the fshc is treated as a switched nonlinear system compared with the existing control researches of the fshc the proposed fshc model can describe both the hullborne and the foilborne conditions and the proposed switched controller can ensure the high precision tracking of the fshc to the trajectory generated by the virtual ship with the switched surge speeds 2 by the merit of compound learning the proposed control scheme can achieve the better understanding of uncertainties than the existing neural and fuzzy control schemes of the marine crafts this fact leads to the stronger robustness to disturbances and the better tracking performance of the proposed control scheme 3 by the merit of the average dwell time method the stability of the switched closed loop system is analyzed and the compound learning in the switched form is proved to effective moreover the influence of tuning parameters is analyzed compared with koshkouei and nowak 2012 the more logical and rigorous mathematical inference is preserved in this paper 4 the proposed reference roll angle facilitates the coordinated turning maneuver of the fshc such that the fast and steady turning of the fshc can be realized compared with liu et al 2017a the proposed reference roll angle utilizes the past information of itself which is not sensitive to the perturbation of the yaw rate the rest of this paper are organized as follows section 2 presents the preliminaries including the establishment of the switched fshc model and some useful lemmas section 3 carries out the control design including the control laws the adaptive laws and the dob section 4 analyzes the closed loop stability section 5 performs the numerical experiment for the algorithmic validation section 6 concludes the entire work uniformly in this paper s ˆ denotes the estimate of the variable s and s s s ˆ denotes the estimation error s t a denotes the right limit of s for t t a whereas s t a the left limit 2 preliminaries 2 1 switched model of fshc according to fossen 2011 the 3 dof model is usually used to describe the marine craft moving on the surface which only concerns surge sway and yaw motions because the roll motion exerts an important influence on the planar motions of the fshc the 4 dof model including the roll motion is preferred for the fshc fig 2 exhibits the relationship between the earth frame and the body frame as well as the profile of a fshc where x y denote the positional coordinates on the surface of the fshc ψ the heading angle φ the roll angle u the surge speed v the sway speed r the yaw rate and p the roll rate there are two hydrofoils installed in the bow and the aft of the fshc respectively fig 3 illustrates the details of the hydrofoils each hydrofoil has a pair of synchronous flaps to regulate the heave and the pitch motions of the fshc which are not addressed and assumed to be self stable in this paper a pair of ailerons are installed in the aft hydrofoil which rotate conversely the rudder is installed in the middle strut of the aft hydrofoil the ailerons and the rudder work together to regulate the roll and the yaw motions of the fshc the surge motion is regulated by the supercavitation propeller which is not shown in fig 3 below the middle strut of the aft hydrofoil the sway motion is out of control then the 4 dof model of the fshc is expressed as 1 x u cos ψ v cos φ sin ψ y u sin ψ v cos φ cos ψ φ p ψ r cos φ 2 m u i u m v i v r x u i u x i υ x n i n i τ w u i m v i v m u i u r y v i v y r i r y p i p y i υ τ w v i m p i p k p i p k v i v k r i r k i υ k δ r i δ r i k δ a i δ a i τ w p i m r i r m u i m v i u v n r i r n v i v n p i p n i υ n δ r i δ r i n δ a i δ a i τ w r i where υ u v p r t is the vector of kinematic states m u i m v i m p i and m r i denote the known inertia parameters x u i y v i y r i y p i k p i k v i k r i n v i n r i n p i denote the unknown first order hydrodynamic parameters x i υ y i υ k i υ and n i υ imply the unknown nonlinearities composed of the components of second order hydrodynamic derivatives n i is the revolution rate of the propeller δ r i is the rudder angle δ a i is the aileron angle x n i k δ r i k δ a i n δ r i and n δ a i denote the known control gains τ u w i τ v w i τ p w i τ r w i imply the unknown time varying disturbances generated by waves and winds it is noticed in 2 that all the variables have a subscript of i which is different with the traditional models in liu et al 2017a b here i t t 0 m 1 2 denotes the current cruising condition of the fshc i 1 means the hullborne condition and i 2 the foilborne condition according to the motion characteristics of the fshc i t is decided by the surge speed of u namely i 1 for u u t and i 2 for u u t where u t is a positive threshold thus the proposed fshc model is deemed as a switched system for the epoch t t j t j 1 with j 0 1 it has i t k j m and k j k j 1 to facilitate the control design 2 is simplified as 3 according to the definitions of parameters 3 u d u i f u i υ d w u i v f v i υ d w v i p d p i f p i υ d w p i r d r i f r i υ d w r i where d w u i τ w u i m u i d w v i τ w v i m v i d w r i τ w r i m r i and d w p i τ w p i m p i denote the disturbances in the form of acceleration f u i υ m v i v r x u i u x i υ f v i υ y v i v y r i r y p i p y i υ m u i v r f p i υ k p i p k v i v k r i r k i υ and f r i υ m u i m v i u v n r i r n v i v n p i p n i υ denote the unknown model dynamics d u i x n i n i m u i d p i k δ r i δ r i k δ a i δ a i m p i and d r i n δ r i δ r i n δ a i δ a i m r i denote the control inputs as the required parameters are known the real control commands of n i δ r i and δ a i can be reversely derived from d u i d p i and d r i then the control objective is concluded as follows control objective assume that there is a smooth trajectory generated by the virtual fshc free of damping and inertia namely it has x d u d cos ψ d y d u d sin ψ d and ψ d r d where the sway speed v d can be conveniently omitted this paper aims to find the control inputs of d u i and d r i such that x y and ψ of the fshc will converge to x d y d and ψ d besides the control input of d p i can coordinate the roll motion of the fshc with its planar motions assumption 1 the disturbance of d w l i with l u v p r is bounded by d w l i b d w l i in t t j t j 1 and its derivative is bounded by d w l i b d w l i where b d w l i and b d w l i are two positive constants assumption 2 the yaw rate r of the fshc will never exceed 95 deg s such that the stability of the model 1 and 2 is always guaranteed 2 2 useful lemmas to facilitate the analysis of the switched system the following lemma is introduced lemma 1 tong et al 2015 the switching signal of i t is called having the average dwell time of ζ if ζ 0 and it satisfies n i t a t b n 0 t b t a ζ t 0 t a t b where n i t a t b is the number of switching times in t t a t b and n 0 0 the flss are employed to approximate unknown model dynamics in this paper a fls is composed of four components namely the fuzzier the defuzzier the fuzzy rule base and the fuzzy inference engine the fuzzy rule is described by the if then statement by using the singleton fuzzier the product reasoning and the center average defuzzier a multiple inputs single output miso fls can be simplified as y f w t ϕ x f where w denotes the vector of the fls weights and ϕ x f denotes the vector of fuzzy basis functions and satisfies ϕ x f 1 then the universal approximation theorem of the fls can be described as follows lemma 2 wang 1994 for any continuous miso function f x f defined in a compact set namely x f ω there always exists a fls satisfying f x f w t ϕ x f ε where ε can be bounded by an arbitrary positive constant besides it is tenable to assume that ε is a slow time varying value 3 control design corresponding to the kinematic loop of 1 and the dynamic loop of 2 the control design is divided into two parts the first part addresses the virtual control laws and the reference roll angle the second part addresses the real control laws the adaptive laws and the dob 3 1 virtual control laws define the transformed tracking errors as 4 x e y e ψ e cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 x x d y y d ψ ψ d it is clear from 4 that x e 0 y e 0 and ψ e 0 implies x x d y y d and ψ ψ d by differentiating 4 along with 1 it yields 5 x e u u d cos ψ e r y e cos φ y e v cos φ u d sin ψ e r x e cos φ ψ e r cos φ r d to stabilize x e design the virtual control law of u as 6 α u i k x i x e u d cos ψ ψ d where k x i is a switched positive tuning parameter to stabilize y e design the virtual control of ψ e as 7 α ψ e i arcsin k y i y e v cos φ u d where k y i is a switched positive tuning parameter by selecting k y i properly it is assumed that u d k y i y e v cos φ always holds to avoid the complexity explosion caused by differentiating the virtual control laws the first order filters are introduced as follows 8 η u i β u β u α u i η ψ i β ψ β ψ α ψ e i η φ i β φ β φ φ d η r i β r β r α r i η p i β p β p α p i where φ d α r i and α p i will be designed later and η u i η ψ i η φ i η r i and η p i are switched positive tuning parameters in 8 we set β u t j β u t j β ψ t j β ψ t j β φ t j β φ t j β r t j β r t j and β p t j β p t j at the switching instant t j denote the filtering errors as q u β u α u i q ψ β ψ α ψ e i q φ β φ φ d q r β r α r i and q p β p α p i denote the filtered tracking errors of virtual control laws as u e u β u r e r β r ψ e e ψ e β ψ and p e p β p to stabilize ψ e e design the virtual control law of r as 9 α r i 1 cos φ k ψ i ψ e e r d β ψ where k ψ i is a switched positive tuning parameter in consideration of the foilborne condition the fshc performs the coordinated turning maneuver shown in fig 4 where β is the drift angle u u 2 v 2 cos φ 2 is the resultant speed on the surface f l is the resultant lift force generated by hydrofoils and g is the gravitational acceleration to maintain the steady turning the mechanical balance should be satisfied as 10 f l cos φ m g f l sin φ cos β m u r according to 10 and by invoking cos β u u the reference roll angle is designed as 11 φ d t φ d t τ γ φ arctan u 2 r g u φ d t τ where γ φ is the update rate of φ d and τ is the time constant compared with the reference roll angle in liu et al 2017a 11 can mitigate the influence of perturbations of r on φ d denote the tracking error as φ e φ β φ to stabilize φ e the virtual control law of p is designed as 12 α p i k φ i φ e β φ where k φ i is a switched positive tuning parameter then by substituting 6 and 7 to 5 and by differentiating ψ e e and φ e along with 9 and 12 the differential equations of tracking errors are yielded as 13 x e k x i x e r y e cos φ q u u e y e k y i y e r x e cos φ u d ψ y ψ e e k ψ i ψ e e r e cos φ q r cos φ φ e k φ i φ e p e q p 3 2 real control laws according to lemma 2 the unknown model dynamics in 3 can be expressed by the flss namely f u i υ w u i t ϕ u i υ ε u i f p i υ w p i t ϕ p i υ ε p i and f r i υ w r i t ϕ r i υ ε r i define the compound disturbances as σ u i ε u i d w u i σ p i ε p i d w p i and σ r i ε r i d w r i corresponding to 3 the spem can be designed as 14 u ˆ d u i w ˆ u t ϕ u i υ k u ˆ i u p ˆ d p i w ˆ p t ϕ p i υ k p ˆ i p r ˆ d r i w ˆ r t ϕ r i υ k r ˆ i r where k u ˆ i k p ˆ i and k r ˆ i are switched positive tuning parameters and we set u ˆ t j u ˆ t j p ˆ t j p ˆ t j and r ˆ t j r ˆ t j by subtracting 14 from 3 the differentials of prediction errors are obtained as 15 u w u t ϕ u i υ σ u i k u ˆ i u p w p t ϕ p i υ σ p i k p ˆ i p r w r t ϕ r i υ σ r i k r ˆ i r according to the composite learning deng et al 2020b the adaptive laws of the fls weights are designed as 16 w ˆ u γ u i ϕ u i u e ϕ u i u γ u i w ˆ u w ˆ p γ p i ϕ p i p e ϕ p i p γ p i w ˆ p w ˆ r γ r i ϕ r i r e ϕ r i r γ r i w ˆ r where γ l i and γ l i with l u p r are switched positive tuning parameters and we set w ˆ u t j w ˆ u t j w ˆ p t j w ˆ p t j and w ˆ r t j w ˆ r t j to estimate the compound disturbances of σ u i σ p i and σ r i the dob is established as 17 σ ˆ u k σ ˆ u i u t u t j t j t σ ˆ u w ˆ u t ϕ u i d u i d t z u t 0 t u e d t σ ˆ p k σ ˆ p i p t p t j t j t σ ˆ p w ˆ p t ϕ p i d p i d t z p t 0 t p e d t σ ˆ r k σ ˆ r i r t r t j t j t σ ˆ r w ˆ r t ϕ r i d r i d t z r t 0 t r e d t where k σ ˆ u i k σ ˆ p i and k σ ˆ r i are switched positive tuning parameters and it has 18 z u l 0 j 1 k σ ˆ u i t l u t l 1 u t l t l t l 1 σ ˆ u w ˆ u t ϕ u i d u i d t z p l 0 j 1 k σ ˆ p i t l p t l 1 p t l t l t l 1 σ ˆ p w ˆ p t ϕ p i d p i d t z r l 0 j 1 k σ ˆ r i t l r t l 1 r t l t l t l 1 σ ˆ r w ˆ r t ϕ r i d r i d t according to the compound learning xu et al 2019 the real control laws can be derived by synthesizing the flss with the outputs of the dob and it yields 19 d u i k u i u e σ ˆ u w ˆ u t ϕ u i β u x e d p i k p i p e σ ˆ p w ˆ p t ϕ p i β p φ e d r i k r i r e σ ˆ r w ˆ r t ϕ r i β r ψ e e cos φ where k u i k p i and k r i are switched positive tuning parameters by differentiating u e p e and r e along with 3 and 19 it renders 20 u e k u i u e σ u w u t ϕ u i x e p e k p i p e σ p w p t ϕ p i φ e r e k r i r e σ r w r t ϕ r i ψ e e cos φ by differentiating σ u σ p and σ r along with 3 and 17 it renders 21 σ u k σ ˆ u i σ u i k σ ˆ u i w u t ϕ u i σ u i u e σ p k σ ˆ p i σ p i k σ ˆ p i w p t ϕ p i σ p i p e σ r k σ ˆ r i σ r i k σ ˆ r i w r t ϕ r i σ r i r e 4 stability analysis the proposed control scheme can be concluded as the following theorem theorem 1 suppose that all the states in the switched fshc model of 1 and 2 are defined in a compact set and the assumption 1 and assumption 2 are satisfied if the adaptive laws of 16 the dob of 17 and the switched control laws of 19 are employed and the average dwell time in lemma 1 satisfies ζ ln μ a then all the tracking and the estimation errors are ensured to be sguub besides if one cruising condition of the fshc is maintained for long enough the proposed scheme can guarantee the convergence of x e y e ψ e e and φ e to arbitrarily small values if the tuning parameters are selected properly proof select the lyapunov functions as v 1 i x e 2 y e 2 ψ e e 2 φ e 2 2 v 2 i q u 2 q ψ 2 q φ 2 q r 2 q p 2 2 v 3 i u e 2 p e 2 r e 2 2 v 4 i w u t w u 2 γ u i w p t w p 2 γ p i w r t w r 2 γ r i σ u 2 σ p 2 σ r 2 2 v 5 i u 2 p 2 r 2 2 and v i v 1 i v 2 i v 3 i v 4 i v 5 i differentiating v 1 i along with 13 and using the young s inequality it renders 22 v 1 i x e x e y e y e ψ e e ψ e e φ e φ e k x i 1 2 x e 2 k y i 1 2 y e 2 k ψ i 1 2 ψ e e 2 k φ i 1 2 φ e 2 1 2 q u 2 1 2 q r 2 1 2 q p 2 1 2 u d 2 ψ y 2 x e u e p e φ e r e ψ e e cos φ differentiating v 2 i along with 8 and using the young s inequality it renders 23 v 2 i q u q u q ψ q ψ q φ q φ q r q r q p q p 1 η u i 1 2 q u 2 1 η ψ i 1 2 q ψ 2 1 η φ i 1 2 q φ 2 1 η r i 1 2 q r 2 1 η p i 1 2 q p 2 1 2 φ d 2 1 2 α u i 2 1 2 α ψ e i 2 1 2 α r i 2 1 2 α p i 2 differentiating v 3 i along with 20 it renders 24 v 3 i u e u e p e p e r e r e k u i u e 2 k p i p e 2 k r i r e 2 x e u e r e ψ e e cos φ p e φ e σ u u e σ p p e σ r r e w u t ϕ u i u e w p t ϕ p i p e w r t ϕ r i r e differentiating v 4 i along with 16 and 21 and using the young s inequality it renders 25 v 4 i 1 γ u i w u t w u 1 γ p i w p t w p 1 γ r i w r t w r σ u σ u σ p σ p σ r σ r γ u i 2 k σ ˆ u i 2 w u t w u γ p i 2 k σ ˆ p i 2 w p t w p γ r i 2 k σ ˆ r i 2 w r t w r k σ ˆ u i 2 1 2 σ u 2 k σ ˆ p i 2 1 2 σ p 2 k σ ˆ r i 2 1 2 σ r 2 w u t ϕ u i u e w u t ϕ u i u w p t ϕ p i p e w p t ϕ p i p w r t ϕ r i r e w r t ϕ r i r u e σ u p e σ p r e σ r γ u i 2 w u i t w u i γ p i 2 w p i t w p i γ r i 2 w r i t w r i 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 differentiating v 5 i along with 15 and using the young s inequality it renders 26 v 5 i u u p p r r k u ˆ i 1 2 u 2 k p ˆ i 1 2 p 2 k r ˆ i 1 2 r 2 w u t ϕ u i u w p t ϕ p i p w r t ϕ r i r 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 by synthesizing 22 26 we can render the differential of v i satisfying 27 v i k x i 1 2 x e 2 k y i 1 2 y e 2 k ψ i 1 2 ψ e e 2 k φ i 1 2 φ e 2 1 η φ i 1 2 q φ 2 1 η u i 1 q u 2 1 η r i 1 q r 2 1 η p i 1 q p 2 1 η ψ i 1 2 q ψ 2 k u i u e 2 k p i p e 2 k r i r e 2 k u ˆ i 1 2 u 2 k p ˆ i 1 2 p 2 k r ˆ i 1 2 r 2 γ u i 2 k σ ˆ u i 2 w u t w u γ p i 2 k σ ˆ p i 2 w p t w p γ r i 2 k σ ˆ r i 2 w r t w r k σ ˆ u i 2 1 2 σ u 2 k σ ˆ p i 2 1 2 σ p 2 k σ ˆ r i 2 1 2 σ r 2 1 2 u d 2 ψ y 2 1 2 α u i 2 1 2 α ψ e i 2 1 2 α r i 2 1 2 φ d 2 1 2 α p i 2 1 2 σ p i 2 1 2 σ r i 2 1 2 σ u i 2 γ u i 2 w u i t w u i γ p i 2 w p i t w p i γ r i 2 w r i t w r i 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 define a i min 2 k x i 1 2 k y i 1 2 k ψ i 1 2 k φ i 1 2 η φ i 1 2 η u i 2 2 η r i 2 2 η p i 2 2 η ψ i 1 2 k u i 2 k p i 2 k r i 2 k u ˆ i 1 2 k p ˆ i 1 2 k r ˆ i 1 γ u i k σ ˆ u i γ u i γ p i k σ ˆ p i γ p i γ r i k σ ˆ r i γ r i k σ ˆ u i 1 k σ ˆ p i 1 k σ ˆ r i 1 and b i sup u d 2 ψ y 2 2 α u i 2 2 α ψ e i 2 2 α r i 2 2 φ d 2 2 α p i 2 2 σ p i 2 2 σ r i 2 2 σ u i 2 2 γ u i w u i t w u i 2 γ p i w p i t w p i 2 γ r i w r i t w r i 2 σ u i 2 2 σ p i 2 2 σ r i 2 2 the selection of tuning parameters should ensure a i 0 and let a min a i because all the states are defined in a compact set and according to assumption 1 it is tenable to assume the existence of b i and let b max b i then it can be inferred from 27 that 28 v i a v i b from 28 we know that v i t v i t j e a t t j 1 e a t t j b a holds for t t j t j 1 if t j t j 1 is long enough v i will converge to the arbitrarily small value by increasing a because x e y e ψ e e φ e 2 v i holds the same conclusion can be made for them then we will prove that all the errors in v i are sguub in the entire voyage time and analyze the influence of the switching of cruising conditions to the stability select the lyapunov function as w e a t t 0 v i and define a vector θ x y ψ e φ β u β r β p β φ u p r u ˆ p ˆ r ˆ w ˆ u t w ˆ p t w ˆ r t σ ˆ u σ ˆ p σ ˆ r t it follows from 28 that 29 w a e a t t 0 v i e a t t 0 v i b e a t t 0 t t j t j 1 according to tong et al 2016 long and zhao 2015 the selection of lyapunov functions can guarantee the relationship of v k j 1 θ μ v k j θ where μ 1 is a constant then it has 30 w t j 1 e a t j 1 t 0 v i t j 1 θ t j 1 μ e a t j 1 t 0 v i t j θ t j 1 μ w t j t j t j 1 b e a s t 0 d s it follows from 30 that 31 w t w t n i t 0 t t n i t 0 t t b e a s t 0 d s μ w t n i t 0 t 1 t n i t 0 t 1 t n i t 0 t b e a s t 0 d s μ 1 t n i t 0 t t b e a s t 0 d s μ 2 w t n i t 0 t 2 t n i t 0 t 2 t n i t 0 t 1 b e a s t 0 d s μ n i t 0 t t n i t 0 t t b e a s t 0 d s μ 1 t n i t 0 t 1 t n i t 0 t b e a s t 0 d s μ 2 t n i t 0 t t b e a s t 0 d s μ n i t 0 t w t 0 j 0 n i t 0 t 1 μ j t j t j 1 b e a s t 0 d s according to theorem 1 it has ζ ln μ a we can further infer that ζ ln μ a δ holds for δ 0 a ln μ ζ according to lemma 1 it renders 32 n i t a t b n 0 a δ t b t a ln μ t 0 t a t b it is clear from the definition of n i that n i t 0 t j n i t j 1 t 1 always holds for j 0 1 n i t 0 t 1 invoking 32 it renders 33 n i t 0 t j n 0 1 a δ t t j 1 ln μ besides the following inequality is presented 34 t j t j 1 b e a s t 0 d s e a δ t j 1 t 0 t j t j 1 b e δ s t 0 d s by substituting 33 and 34 to 31 it has 35 w t μ n i t 0 t w t 0 μ n 0 1 j 0 n i t 0 t 1 e a δ t t j 1 t j t j 1 b e a s t 0 d s e a δ t t 0 t n i t 0 t t b e δ s t 0 d s μ n 0 e a δ t t 0 w t 0 μ n 0 1 e a δ t t 0 t 0 t b e δ s t 0 d s μ n 0 e a δ t t 0 w t 0 b δ μ n 0 1 e a t t 0 e a δ t t 0 by multiplying both sides of 35 by e a t t 0 v i t can be obtained as 36 v i t μ n 0 e δ t t 0 v i t 0 b δ μ n 0 1 it is inferred from 36 that all the errors in v i t are sguub the proof is completed in the proposed scheme we should determine one set of parameters for one cruising condition of the fshc in turns in each set of parameters the parameter selection follows two steps 1 select k u ˆ i 1 2 k p ˆ i 1 2 k r ˆ i 1 2 k σ ˆ u i 1 k σ ˆ p i 1 k σ ˆ r i 1 γ u i k σ ˆ u i γ p i k σ ˆ p i γ r i k σ ˆ r i γ u i 0 γ p i 0 and γ r i 0 to maintain the acceptable performance of the fls and the dob 2 select τ 0 k x i 1 2 k y i 1 2 k ψ i 1 2 k φ i 1 2 0 η φ i 2 0 η ψ i 2 0 η u i 1 0 η r i 1 0 η p i 1 k u i 0 k p i 0 and k r i 0 to maintain the satisfactory tracking performance remark 1 for the parameters of n 0 and ζ they are only presented for the analytical use as is shown in 36 the larger n 0 will lead to the larger stable tracking and estimation errors in the closed loop system and for any n 0 0 these errors are always sguub invoking ζ ln μ a although a can be derived from the tuning parameters μ cannot be exactly known thus the average dwell time method cannot determine the values of n 0 and ζ seeing long and zhao 2015 tong et al 2015 nevertheless it can be inferred from 32 that the larger a will lead to the smaller n 0 while n i t a t b and μ are fixed 5 numerical experiments to verify the effectiveness of the proposed scheme the pch 1 fshc of the united states navy is selected as the simulation objective it possesses the length of 35 1 m and the breadth of 9 45 m seeing fig 5 liu et al 2017a gave its inertia parameters and hydrodynamic derivatives in the foilborne condition and some of them are shown in table i because there was no record of the model parameters of the fshc in the hullborne condition we assume a reasonable setting of model parameters in the hullborne condition by considering the hull resistance and friction set the threshold of u t as 40 knots the assumed parameters in the hullborne condition are set as m u 1 m u 2 m v 1 m v 2 m p 1 m p 2 m r 1 m r 2 x u 1 10 x u 2 x 1 υ 5 x 2 υ x n 1 10 x n 2 τ w u 1 10 τ w u 2 y v 1 10 y v 2 y r 1 10 y r 2 y p 1 y p 2 y 1 υ 5 y 2 υ τ w v 1 10 τ w v 2 k p 1 10 k p 2 k v 1 k v 2 k r 1 10 k r 2 k 1 υ 5 k 2 υ k δ r 1 5 k δ r 2 k δ a 1 0 5 k δ a 2 τ w p 1 10 τ w p 2 n r 1 10 n r 2 n v 1 n v 2 n p 1 10 n p 2 n 1 υ 5 n 2 υ n δ r 1 10 n δ r 2 n δ a 1 n δ a 2 and τ w r 1 2 τ w r 2 three control schemes are compared in the simulation firstly the proposed scheme is marked as s dob cf in which s is the abbreviation of switched and cf the abbreviation of composite fuzzy secondly by referring to deng et al 2020b we set the switched composite learning fuzzy control of the fshc which is marked as s cf this scheme abandons the dob in 19 and all its tuning parameters keep same with s dob cf thirdly by referring to li and tong 2017 deng et al 2019b we set the unified robust fuzzy damping control of the fshc which is marked as u rfd and u is the abbreviation of unified this scheme only uses one set of tuning parameters by using the fuzzy damping technique the real control laws of this scheme are derived as 37 d u k u u e k f u φ u u e β u x e d p k p p e k f p φ p p e β p φ e d r k r r e k f r φ r r e β r ψ e e cos φ where k f u k f p and k f r are damping parameters and φ u ϕ u i 1 φ p ϕ p i 1 and φ r ϕ r i 1 in the simulation the disturbances are generated by the platform of the simulated sea environment which has been successfully employed in our previous researches of deng et al 2019a 2020a in this platform the wave is described by the torsethaugen spectrum and the mechanical effects can be calculated with the known ship scales the details were illustrated in fossen 2011 the influence of wind on the fshc is omitted in the simulation the average wave direction is set as 30 to the north and the sea state is set as no 4 with the significant wave height of 1 5 m the spectral peak period is set as 15s and it implies that the swell is dominant then the wave surface is shown in fig 6 which reflects a moderate sea the reference signals are generated by setting the initial position and the heading angle of the virtual ship as x d 0 0 m y d 0 0 m ψ d 0 45 and letting 1 u d t 20 knots and r d t 0 1 e 0 1 t s 1 for 0 s t 20 s 2 u d t 45 knots and r d t 0 1 e 0 1 t s 1 for 20 s t 40 s 3 u d t 20 knots and r d t 0 1 e 0 1 t s 1 for 40 s t 60 s 4 u d t 40 knots and r d t 0 1 s 1 for 60 s t 100 s the initial position and attitudes of the fshc are set as x 0 50 m y 0 0 m ψ 0 45 and φ 0 0 all the initial values of the other states and variables are set to be zeros in this simulation we set 7 fuzzy rules for the fls the same set of membership functions is employed for the flss of all the three motions in both the hullborne and the foilborne conditions the jth fuzzy rule has the membership functions as 38 θ j u e u 12 2 j 2 j 3 θ j v e v 2 j 2 j 3 θ j p e p 0 4 0 1 j 2 j 3 θ j r e r 0 4 0 1 j 2 j 3 then the jth element of ϕ l i υ with l u p r is expressed as 39 ϕ l i j υ θ j u θ j v θ j p θ j r j 1 7 θ j u θ j v θ j p θ j r corresponding to the hullborne and the foilborne conditions two sets of tuning parameters are presented for the s dof cf and the s cf as 40 k x 1 0 1 k y 1 0 1 k ψ 1 0 1 k φ 1 0 1 k u 1 1 k p 1 1 k r 1 1 k u ˆ 1 1 k p ˆ 1 1 k r ˆ 1 1 γ u 1 1 γ p 1 1 γ r 1 1 γ u 1 0 1 γ p 1 0 1 γ r 1 0 1 k σ ˆ u 1 1 k σ ˆ p 1 1 k σ ˆ r 1 1 γ φ 0 01 η ψ 1 η u 1 η φ 1 η r 1 η p 1 0 1 and 41 k x 2 0 5 k y 2 0 2 k ψ 2 0 2 k φ 2 0 1 k u 2 0 5 k p 2 1 k r 2 1 k u ˆ 2 1 k p ˆ 2 1 k r ˆ 2 1 γ u 2 1 γ p 2 1 γ r 2 1 γ u 2 0 1 γ p 2 0 1 γ r 2 0 1 k σ ˆ u 2 1 k σ ˆ p 2 1 k σ ˆ r 2 1 η ψ 2 η u 2 η φ 2 η r 2 η p 2 0 1 the tuning parameters for the u rfd are set as 42 k x 0 2 k y 0 2 k ψ 0 5 k φ 2 k u 1 k p 1 k r 1 k f u 0 5 k f p 0 5 k f r 0 5 denote the synthetic uncertainty in each motion as ϒ j f j i υ d w j i with j u p r the estimate of ϒ j for the s dob cf is expressed as ϒ ˆ j w ˆ j t ϕ j i υ σ j i and that for the s cf is expressed as ϒ ˆ j w ˆ j t ϕ j i υ two performance indexes are constructed as 43 j c iae t 0 t ϒ u ϒ p ϒ r t d τ j c itae t 0 t τ ϒ u ϒ p ϒ r t d τ the trajectories of the fshcs with the three comparative schemes are shown in fig 7 it is clear that the s dob cf has the best tracking performance due to its sufficient compensation for the synthetic uncertainties because the compound disturbances are not handled in the s cf its tracking precision is lower than the s dob cf the u rfd cannot take the switched system well it has the worst tracking performance than the other two fig 8 demonstrates the environmental disturbances imposed on the fshc of the s dob cf following from the surge speed u of the fshc the disturbances are presented in the switched form fig 9 shows the surge speeds the yaw rates and the heading angles of the fshcs in the three schemes in the first subgraph it is clear that the u rfd algorithm cannot reach the switching threshold of u t by altering its tuning parameters a large deviation from the reference trajectory is noticed while u breaks through u t in the second subgraph all the yaw rates are within the limit of 95 deg s thus the assumption 2 is satisfied and the fshc model is stable in the third subgraph all the three schemes can ensure the satisfactory tracking of the heading angle to the reference fig 10 compares the roll angles of the fshcs it is observed that the reference roll angles have less fluctuation which substantiates that the proposed reference roll angle of 11 is insensitive to the perturbation of the yaw rate it can also be observed that only the s dob cf can ensure the high precision tracking of the roll angle to the reference fig 11 fig 12 and fig 13 demonstrate the control inputs of the three control schemes the switched control inputs are observed in figs 11 and 12 the control input for one cruising condition is set to 0 while the other cruising condition is activated at the current time fig 13 shows the unified control inputs without switching it should be noted that the jumps of u d inevitably induce the chattering of control inputs at the switching instant fig 14 reveals the estimates of fls weights in the surge motion of the fshcs with the s dob cf and the s cf algorithms it is observed that all the estimates of fls weights keep bounded during the voyage and the switching of u d will reset the convergence of these estimates fig 15 shows the estimates of compound disturbances in the s dob cf fig 16 and fig 17 compare the approximation performance of the flss to synthetic uncertainties in the s dob cf and the s cf schemes it is clear that the s dob cf can achieve the better approximation than the s cf this point is incarnated in the slower growth of the performance indexes of the s dob cf than the s cf in fig 18 the final values of j c iae of s dob cf and s cf are 280 97 and 712 62 respectively the final values of j c itae of s dob cf and s cf are 11121 89 and 34934 56 respectively 6 conclusion this paper develops a switched compound learning tracking control scheme for the fshc to fit with the different cruising conditions of the fshc the fshc model is described as a switched system and the switched control laws are designed the compound learning is achieved by setting the fls and the dob with the fls accounting for the unknown model dynamics the composite adaptive laws of the fls weights are designed by combining the tracking errors with the prediction errors calculated from the spem the dob is established to estimate the compound disturbances composed of the disturbances and the approximation errors of the fls both the fls and the dob are involved in the switched control laws by using the average dwell time method the stability of the switched system is analyzed finally the numerical experiment in the simulated sea environment is carried out to verify the superiority of the proposed switched control scheme in the future we would like to incorporate the event triggered control deng and zhang 2020 deng et al 2019b 2020b into the switched control of the fshc besides the online recorded data based prediction errors xu et al 2018 2019 can be involved in the adaptive laws to improve the learning performance of the fls credit authorship contribution statement yingjie deng writing manuscripts preparation simulation revision xianku zhang conceptualization supervision namkyun im revision writing review editing cailei liang investigation hardware realization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partially supported by the national science foundation of china no 51679024 the fundamental research funds for the central university no 3132019501 the university 111 project of china no b08046 and the national research foundation of korea no nrf 2020r1f1a1050113 titled with the technology for marine traffic hazard control system using ship navigation big data 
21227,this paper addresses the tracking control of a fully submerged hydrofoil craft fshc on the horizontal plane the motions of a fshc can be classified into three cruising conditions namely the hulborne the taking off and the foilborne considering that the fshc has the different model dynamics and disturbances between the three cruising conditions we treat the fshc model as a switched system between the hullborne and the foliborne conditions in which the taking off condition is conveniently omitted and deemed as the fast transient the compound learning technique is introduced to offset the uncertainties and it is comprised of two parts first the fuzzy logic system fls is employed to approximate the unknown model dynamics in each degree of freedom based on a serial parallel estimation model spem the composite adaptive laws are fabricated to estimate the weights of the fls by combining the tracking errors with the prediction errors between the estimation model and the dynamic loop of the fshc second the disturbance observer dob is fabricated to estimate the compound disturbance which is comprised of the approximation error of the fls and the disturbance based on the compound learning we develop the switched adaptive backstepping control laws of the fshc by employing the average dwell time method all the tracking and the estimation errors in the switched system are proved to be semi globally uniformly ultimately bounded sguub finally the numerical experiment is conducted to verify the effectiveness of the proposed scheme keywords fully submerged hydrofoil crafts switched systems compound learning disturbance observers 1 introduction the hydrofoil craft is a kind of high speed craft characterized by the foilborne navigation when the hydrofoil craft cruises at a high speed the hydrofoil can provide the lift to elevate the hull of the craft off the water surface this cruising condition is called the foilborne condition of the fshc seeing the left side of fig 1 this characteristic leads to the less wave resistance and friction of the hydrofoil craft than the common surface craft such that the hydrofoil craft can achieve better seakeeping and energy saving performance due to the limited bearing capacity of hydrofoils the hydrofoil craft is usually built with the light weight and the small size which makes it a decent candidate for the unmanned surface vessel to undertake the tasks such as patrol reconnaissance mine clearance and ocean monitoring there are mainly two types of hydrofoil crafts the first type is the surface piercing hydrofoil craft sphc which is usually installed with the fixed u shaped or v shaped hydrofoils the second one is the fully submerged hydrofoil craft fshc which is usually installed with the adjustable inverted t shaped hydrofoils because the sphc possesses the self calibrated ability in its roll motion it is fitted with the simpler control system than the fshc but is more susceptible to the influence of waves in contrast the fshc has the better seakeeping performance and can cruise like a platform in the irregular waves but it needs a complicated control system accommodating both longitudinal and lateral motions this reality motivates the research in this paper the existing researches of the fshc mainly concentrated on the hydrodynamic analysis and the optimization of the hydrofoil such as djavareshkian et al 2013 bi et al 2019 compared with the common surface craft the researches on controlling the fshc are not enriched according to our survey the control of fshc can be divided into two classes namely the longitudinal control and the planar control including the course keep and the path following for the longitudinal control kim and yamato 2004a studied the lift variation of the hydrofoils in the regular waves and developed a linear quadratic regulator lqg with kalman filtering of states it substantiated that the feedback control is inefficient in the following sea due to the lift variation to overcome this problem kim and yamato 2004b developed an optimal preview controller by using the future information of wave elevation and disturbance using this control scheme the fshc can achieve good performance of contouring waves in the following sea bai and kim 2010 compared the control performance of the pid the linear quadratic regulator lqr and the sliding mode control in the longitudinal control of the fshc the sliding mode control was found to have the best anti disturbance performance in liu et al 2019 a modified integral sliding mode controller was developed by involving the disturbance estimate it obtained the good attenuation of disturbances with little input chattering for the planar control of the fshc liu et al 2017b addressed the course keeping by integrating the sliding mode control with the iterative learning observer this observer can estimate both the states and the generalized disturbances in liu et al 2017a the path following of the fshc was achieved by using the adaptive los guidance and the integral sign feedback control laws the desired roll angle was generated in coordination with the yaw motion nevertheless the above control schemes only addressed the foilborne condition of the fshc as is shown in the right side of fig 1 the fshc will cruise like the common surface craft at the low speed which is called the hullborne condition of the fshc the transient between hullborne and foilborne conditions is called the taking off condition there is no doubt that the model dynamics and the influence of disturbances are totally different between three cruising conditions although the taking off condition can be omitted the controllers for the fshc in the foilborne condition may be invalid in the hullborne condition to address the switched models of the marine craft in different operating conditions the switched controller is required in koshkouei and nowak 2012 two switching methods between the pid and the sliding model control smc were presented for the triplet of controllers in the rudder fin roll stabilizer although the proposed switched control can achieve better anti roll and course keeping performance than single control the stability of the switched closed loop system is not proved it should be noted that the switched controllers in zhang and guo 2019 ghommam et al 2006 zhang and wu 2014 aim to solve the stabilization problem of underactuated surface vessels without satisfying the brocket condition and the models therein were not switched to control the switched model we can refer to the outcomes of nonlinear systems for more information in wu 2009 the unified controller was designed for the switched strict feedback nonlinear system with known model dynamics based on the simultaneous domination assumption for the switched nonlinear systems with unknown model dynamics the fls and the neural network nn were introduced as the approximators and the direct adaptive laws were fabricated yu et al 2010 han et al 2009 long and zhao 2015 tong et al 2015 2016 designed the switched controllers for this kind of system and the stability of the switched closed loop system was analyzed by using the average dwell time method with the minimum learning parameter of the fls li and tong 2017 designed a unified controller for the switched mimo nonstrict feedback nonlinear system compared with the switched controller the unified controller is more conservative another concern of this paper lies in dealing with the synthetic uncertainties including the unknown model dynamics and the disturbances according to deng et al 2019a b 2020a the fls and the nn were widely used to approximate the unknown model dynamics in marine crafts nevertheless there existed two drawbacks for these researches the first drawback was that the update laws of the fls and the nn therein only focused on guaranteeing the closed loop stability whereas the identification function was missing the composite learning was an effective tool to counteract this drawback in pan et al 2013 xu et al 2014 liu et al 2016 the spem was established to evaluate the approximation performance of the nn the prediction errors between the spem and the system model were involved in the direct adaptive law of the nn such that both the approximation performance of the nn and the tracking performance were guaranteed pan and yu 2018 xu et al 2018 further improved the prediction error with the online recorded data and the persistent excitation pe condition was released in our recent work of deng et al 2020b deng and zhang 2020 the composite adaptive fuzzy control was applied in the marine craft nevertheless the above composite learning schemes did not handle the disturbances and the approximation errors to unknown model dynamics which was deemed as the second drawback as was discussed in xu et al 2019 it was impossible to distinguish the disturbances from the unknown model dynamics and the leakage from unknown model dynamics to disturbances would largely degrade the approximation accuracy of the fls or nn as a new technique the compound learning was developed to provide a solution for this problem in xu 2018 xu et al 2019 the compound disturbance was defined by combining the approximation error of the nn with the disturbance and then the nn and the dob were organized in a compound way to learn the unknown dynamics and the compound disturbances separately to achieve the precise tracking control of the fshc it is worthwhile to ruminate over the application of compound learning to the control of the fshc motivated by the above challenges this paper proposes a switched compound learning tracking control scheme of the fshc at first a 4 degrees of freedom dof switched fshc model is established in which two sets of hydrodynamic parameters and disturbances switch between the hullborne and the foilborne conditions corresponding to the surge speed according to the planar motions of the fshc the reference roll angle is generated to facilitate the coordinate turning maneuver of the fshc based on the dynamic loop of the model a spem is established by using the flss and the prediction errors are derived by subtracting the estimated kinematic states from their real values the adaptive laws of the fls weights are fabricated by involving the tracking errors and the prediction errors to estimate the compound disturbances the dob is constructed by using the flss and the tracking errors then the switched control laws are designed according to the backstepping approach finally the stability analysis is completed by using the average dwell time method compared with the existing literature the contributions of this paper are mainly fourfold 1 for the first time the fshc is treated as a switched nonlinear system compared with the existing control researches of the fshc the proposed fshc model can describe both the hullborne and the foilborne conditions and the proposed switched controller can ensure the high precision tracking of the fshc to the trajectory generated by the virtual ship with the switched surge speeds 2 by the merit of compound learning the proposed control scheme can achieve the better understanding of uncertainties than the existing neural and fuzzy control schemes of the marine crafts this fact leads to the stronger robustness to disturbances and the better tracking performance of the proposed control scheme 3 by the merit of the average dwell time method the stability of the switched closed loop system is analyzed and the compound learning in the switched form is proved to effective moreover the influence of tuning parameters is analyzed compared with koshkouei and nowak 2012 the more logical and rigorous mathematical inference is preserved in this paper 4 the proposed reference roll angle facilitates the coordinated turning maneuver of the fshc such that the fast and steady turning of the fshc can be realized compared with liu et al 2017a the proposed reference roll angle utilizes the past information of itself which is not sensitive to the perturbation of the yaw rate the rest of this paper are organized as follows section 2 presents the preliminaries including the establishment of the switched fshc model and some useful lemmas section 3 carries out the control design including the control laws the adaptive laws and the dob section 4 analyzes the closed loop stability section 5 performs the numerical experiment for the algorithmic validation section 6 concludes the entire work uniformly in this paper s ˆ denotes the estimate of the variable s and s s s ˆ denotes the estimation error s t a denotes the right limit of s for t t a whereas s t a the left limit 2 preliminaries 2 1 switched model of fshc according to fossen 2011 the 3 dof model is usually used to describe the marine craft moving on the surface which only concerns surge sway and yaw motions because the roll motion exerts an important influence on the planar motions of the fshc the 4 dof model including the roll motion is preferred for the fshc fig 2 exhibits the relationship between the earth frame and the body frame as well as the profile of a fshc where x y denote the positional coordinates on the surface of the fshc ψ the heading angle φ the roll angle u the surge speed v the sway speed r the yaw rate and p the roll rate there are two hydrofoils installed in the bow and the aft of the fshc respectively fig 3 illustrates the details of the hydrofoils each hydrofoil has a pair of synchronous flaps to regulate the heave and the pitch motions of the fshc which are not addressed and assumed to be self stable in this paper a pair of ailerons are installed in the aft hydrofoil which rotate conversely the rudder is installed in the middle strut of the aft hydrofoil the ailerons and the rudder work together to regulate the roll and the yaw motions of the fshc the surge motion is regulated by the supercavitation propeller which is not shown in fig 3 below the middle strut of the aft hydrofoil the sway motion is out of control then the 4 dof model of the fshc is expressed as 1 x u cos ψ v cos φ sin ψ y u sin ψ v cos φ cos ψ φ p ψ r cos φ 2 m u i u m v i v r x u i u x i υ x n i n i τ w u i m v i v m u i u r y v i v y r i r y p i p y i υ τ w v i m p i p k p i p k v i v k r i r k i υ k δ r i δ r i k δ a i δ a i τ w p i m r i r m u i m v i u v n r i r n v i v n p i p n i υ n δ r i δ r i n δ a i δ a i τ w r i where υ u v p r t is the vector of kinematic states m u i m v i m p i and m r i denote the known inertia parameters x u i y v i y r i y p i k p i k v i k r i n v i n r i n p i denote the unknown first order hydrodynamic parameters x i υ y i υ k i υ and n i υ imply the unknown nonlinearities composed of the components of second order hydrodynamic derivatives n i is the revolution rate of the propeller δ r i is the rudder angle δ a i is the aileron angle x n i k δ r i k δ a i n δ r i and n δ a i denote the known control gains τ u w i τ v w i τ p w i τ r w i imply the unknown time varying disturbances generated by waves and winds it is noticed in 2 that all the variables have a subscript of i which is different with the traditional models in liu et al 2017a b here i t t 0 m 1 2 denotes the current cruising condition of the fshc i 1 means the hullborne condition and i 2 the foilborne condition according to the motion characteristics of the fshc i t is decided by the surge speed of u namely i 1 for u u t and i 2 for u u t where u t is a positive threshold thus the proposed fshc model is deemed as a switched system for the epoch t t j t j 1 with j 0 1 it has i t k j m and k j k j 1 to facilitate the control design 2 is simplified as 3 according to the definitions of parameters 3 u d u i f u i υ d w u i v f v i υ d w v i p d p i f p i υ d w p i r d r i f r i υ d w r i where d w u i τ w u i m u i d w v i τ w v i m v i d w r i τ w r i m r i and d w p i τ w p i m p i denote the disturbances in the form of acceleration f u i υ m v i v r x u i u x i υ f v i υ y v i v y r i r y p i p y i υ m u i v r f p i υ k p i p k v i v k r i r k i υ and f r i υ m u i m v i u v n r i r n v i v n p i p n i υ denote the unknown model dynamics d u i x n i n i m u i d p i k δ r i δ r i k δ a i δ a i m p i and d r i n δ r i δ r i n δ a i δ a i m r i denote the control inputs as the required parameters are known the real control commands of n i δ r i and δ a i can be reversely derived from d u i d p i and d r i then the control objective is concluded as follows control objective assume that there is a smooth trajectory generated by the virtual fshc free of damping and inertia namely it has x d u d cos ψ d y d u d sin ψ d and ψ d r d where the sway speed v d can be conveniently omitted this paper aims to find the control inputs of d u i and d r i such that x y and ψ of the fshc will converge to x d y d and ψ d besides the control input of d p i can coordinate the roll motion of the fshc with its planar motions assumption 1 the disturbance of d w l i with l u v p r is bounded by d w l i b d w l i in t t j t j 1 and its derivative is bounded by d w l i b d w l i where b d w l i and b d w l i are two positive constants assumption 2 the yaw rate r of the fshc will never exceed 95 deg s such that the stability of the model 1 and 2 is always guaranteed 2 2 useful lemmas to facilitate the analysis of the switched system the following lemma is introduced lemma 1 tong et al 2015 the switching signal of i t is called having the average dwell time of ζ if ζ 0 and it satisfies n i t a t b n 0 t b t a ζ t 0 t a t b where n i t a t b is the number of switching times in t t a t b and n 0 0 the flss are employed to approximate unknown model dynamics in this paper a fls is composed of four components namely the fuzzier the defuzzier the fuzzy rule base and the fuzzy inference engine the fuzzy rule is described by the if then statement by using the singleton fuzzier the product reasoning and the center average defuzzier a multiple inputs single output miso fls can be simplified as y f w t ϕ x f where w denotes the vector of the fls weights and ϕ x f denotes the vector of fuzzy basis functions and satisfies ϕ x f 1 then the universal approximation theorem of the fls can be described as follows lemma 2 wang 1994 for any continuous miso function f x f defined in a compact set namely x f ω there always exists a fls satisfying f x f w t ϕ x f ε where ε can be bounded by an arbitrary positive constant besides it is tenable to assume that ε is a slow time varying value 3 control design corresponding to the kinematic loop of 1 and the dynamic loop of 2 the control design is divided into two parts the first part addresses the virtual control laws and the reference roll angle the second part addresses the real control laws the adaptive laws and the dob 3 1 virtual control laws define the transformed tracking errors as 4 x e y e ψ e cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 x x d y y d ψ ψ d it is clear from 4 that x e 0 y e 0 and ψ e 0 implies x x d y y d and ψ ψ d by differentiating 4 along with 1 it yields 5 x e u u d cos ψ e r y e cos φ y e v cos φ u d sin ψ e r x e cos φ ψ e r cos φ r d to stabilize x e design the virtual control law of u as 6 α u i k x i x e u d cos ψ ψ d where k x i is a switched positive tuning parameter to stabilize y e design the virtual control of ψ e as 7 α ψ e i arcsin k y i y e v cos φ u d where k y i is a switched positive tuning parameter by selecting k y i properly it is assumed that u d k y i y e v cos φ always holds to avoid the complexity explosion caused by differentiating the virtual control laws the first order filters are introduced as follows 8 η u i β u β u α u i η ψ i β ψ β ψ α ψ e i η φ i β φ β φ φ d η r i β r β r α r i η p i β p β p α p i where φ d α r i and α p i will be designed later and η u i η ψ i η φ i η r i and η p i are switched positive tuning parameters in 8 we set β u t j β u t j β ψ t j β ψ t j β φ t j β φ t j β r t j β r t j and β p t j β p t j at the switching instant t j denote the filtering errors as q u β u α u i q ψ β ψ α ψ e i q φ β φ φ d q r β r α r i and q p β p α p i denote the filtered tracking errors of virtual control laws as u e u β u r e r β r ψ e e ψ e β ψ and p e p β p to stabilize ψ e e design the virtual control law of r as 9 α r i 1 cos φ k ψ i ψ e e r d β ψ where k ψ i is a switched positive tuning parameter in consideration of the foilborne condition the fshc performs the coordinated turning maneuver shown in fig 4 where β is the drift angle u u 2 v 2 cos φ 2 is the resultant speed on the surface f l is the resultant lift force generated by hydrofoils and g is the gravitational acceleration to maintain the steady turning the mechanical balance should be satisfied as 10 f l cos φ m g f l sin φ cos β m u r according to 10 and by invoking cos β u u the reference roll angle is designed as 11 φ d t φ d t τ γ φ arctan u 2 r g u φ d t τ where γ φ is the update rate of φ d and τ is the time constant compared with the reference roll angle in liu et al 2017a 11 can mitigate the influence of perturbations of r on φ d denote the tracking error as φ e φ β φ to stabilize φ e the virtual control law of p is designed as 12 α p i k φ i φ e β φ where k φ i is a switched positive tuning parameter then by substituting 6 and 7 to 5 and by differentiating ψ e e and φ e along with 9 and 12 the differential equations of tracking errors are yielded as 13 x e k x i x e r y e cos φ q u u e y e k y i y e r x e cos φ u d ψ y ψ e e k ψ i ψ e e r e cos φ q r cos φ φ e k φ i φ e p e q p 3 2 real control laws according to lemma 2 the unknown model dynamics in 3 can be expressed by the flss namely f u i υ w u i t ϕ u i υ ε u i f p i υ w p i t ϕ p i υ ε p i and f r i υ w r i t ϕ r i υ ε r i define the compound disturbances as σ u i ε u i d w u i σ p i ε p i d w p i and σ r i ε r i d w r i corresponding to 3 the spem can be designed as 14 u ˆ d u i w ˆ u t ϕ u i υ k u ˆ i u p ˆ d p i w ˆ p t ϕ p i υ k p ˆ i p r ˆ d r i w ˆ r t ϕ r i υ k r ˆ i r where k u ˆ i k p ˆ i and k r ˆ i are switched positive tuning parameters and we set u ˆ t j u ˆ t j p ˆ t j p ˆ t j and r ˆ t j r ˆ t j by subtracting 14 from 3 the differentials of prediction errors are obtained as 15 u w u t ϕ u i υ σ u i k u ˆ i u p w p t ϕ p i υ σ p i k p ˆ i p r w r t ϕ r i υ σ r i k r ˆ i r according to the composite learning deng et al 2020b the adaptive laws of the fls weights are designed as 16 w ˆ u γ u i ϕ u i u e ϕ u i u γ u i w ˆ u w ˆ p γ p i ϕ p i p e ϕ p i p γ p i w ˆ p w ˆ r γ r i ϕ r i r e ϕ r i r γ r i w ˆ r where γ l i and γ l i with l u p r are switched positive tuning parameters and we set w ˆ u t j w ˆ u t j w ˆ p t j w ˆ p t j and w ˆ r t j w ˆ r t j to estimate the compound disturbances of σ u i σ p i and σ r i the dob is established as 17 σ ˆ u k σ ˆ u i u t u t j t j t σ ˆ u w ˆ u t ϕ u i d u i d t z u t 0 t u e d t σ ˆ p k σ ˆ p i p t p t j t j t σ ˆ p w ˆ p t ϕ p i d p i d t z p t 0 t p e d t σ ˆ r k σ ˆ r i r t r t j t j t σ ˆ r w ˆ r t ϕ r i d r i d t z r t 0 t r e d t where k σ ˆ u i k σ ˆ p i and k σ ˆ r i are switched positive tuning parameters and it has 18 z u l 0 j 1 k σ ˆ u i t l u t l 1 u t l t l t l 1 σ ˆ u w ˆ u t ϕ u i d u i d t z p l 0 j 1 k σ ˆ p i t l p t l 1 p t l t l t l 1 σ ˆ p w ˆ p t ϕ p i d p i d t z r l 0 j 1 k σ ˆ r i t l r t l 1 r t l t l t l 1 σ ˆ r w ˆ r t ϕ r i d r i d t according to the compound learning xu et al 2019 the real control laws can be derived by synthesizing the flss with the outputs of the dob and it yields 19 d u i k u i u e σ ˆ u w ˆ u t ϕ u i β u x e d p i k p i p e σ ˆ p w ˆ p t ϕ p i β p φ e d r i k r i r e σ ˆ r w ˆ r t ϕ r i β r ψ e e cos φ where k u i k p i and k r i are switched positive tuning parameters by differentiating u e p e and r e along with 3 and 19 it renders 20 u e k u i u e σ u w u t ϕ u i x e p e k p i p e σ p w p t ϕ p i φ e r e k r i r e σ r w r t ϕ r i ψ e e cos φ by differentiating σ u σ p and σ r along with 3 and 17 it renders 21 σ u k σ ˆ u i σ u i k σ ˆ u i w u t ϕ u i σ u i u e σ p k σ ˆ p i σ p i k σ ˆ p i w p t ϕ p i σ p i p e σ r k σ ˆ r i σ r i k σ ˆ r i w r t ϕ r i σ r i r e 4 stability analysis the proposed control scheme can be concluded as the following theorem theorem 1 suppose that all the states in the switched fshc model of 1 and 2 are defined in a compact set and the assumption 1 and assumption 2 are satisfied if the adaptive laws of 16 the dob of 17 and the switched control laws of 19 are employed and the average dwell time in lemma 1 satisfies ζ ln μ a then all the tracking and the estimation errors are ensured to be sguub besides if one cruising condition of the fshc is maintained for long enough the proposed scheme can guarantee the convergence of x e y e ψ e e and φ e to arbitrarily small values if the tuning parameters are selected properly proof select the lyapunov functions as v 1 i x e 2 y e 2 ψ e e 2 φ e 2 2 v 2 i q u 2 q ψ 2 q φ 2 q r 2 q p 2 2 v 3 i u e 2 p e 2 r e 2 2 v 4 i w u t w u 2 γ u i w p t w p 2 γ p i w r t w r 2 γ r i σ u 2 σ p 2 σ r 2 2 v 5 i u 2 p 2 r 2 2 and v i v 1 i v 2 i v 3 i v 4 i v 5 i differentiating v 1 i along with 13 and using the young s inequality it renders 22 v 1 i x e x e y e y e ψ e e ψ e e φ e φ e k x i 1 2 x e 2 k y i 1 2 y e 2 k ψ i 1 2 ψ e e 2 k φ i 1 2 φ e 2 1 2 q u 2 1 2 q r 2 1 2 q p 2 1 2 u d 2 ψ y 2 x e u e p e φ e r e ψ e e cos φ differentiating v 2 i along with 8 and using the young s inequality it renders 23 v 2 i q u q u q ψ q ψ q φ q φ q r q r q p q p 1 η u i 1 2 q u 2 1 η ψ i 1 2 q ψ 2 1 η φ i 1 2 q φ 2 1 η r i 1 2 q r 2 1 η p i 1 2 q p 2 1 2 φ d 2 1 2 α u i 2 1 2 α ψ e i 2 1 2 α r i 2 1 2 α p i 2 differentiating v 3 i along with 20 it renders 24 v 3 i u e u e p e p e r e r e k u i u e 2 k p i p e 2 k r i r e 2 x e u e r e ψ e e cos φ p e φ e σ u u e σ p p e σ r r e w u t ϕ u i u e w p t ϕ p i p e w r t ϕ r i r e differentiating v 4 i along with 16 and 21 and using the young s inequality it renders 25 v 4 i 1 γ u i w u t w u 1 γ p i w p t w p 1 γ r i w r t w r σ u σ u σ p σ p σ r σ r γ u i 2 k σ ˆ u i 2 w u t w u γ p i 2 k σ ˆ p i 2 w p t w p γ r i 2 k σ ˆ r i 2 w r t w r k σ ˆ u i 2 1 2 σ u 2 k σ ˆ p i 2 1 2 σ p 2 k σ ˆ r i 2 1 2 σ r 2 w u t ϕ u i u e w u t ϕ u i u w p t ϕ p i p e w p t ϕ p i p w r t ϕ r i r e w r t ϕ r i r u e σ u p e σ p r e σ r γ u i 2 w u i t w u i γ p i 2 w p i t w p i γ r i 2 w r i t w r i 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 differentiating v 5 i along with 15 and using the young s inequality it renders 26 v 5 i u u p p r r k u ˆ i 1 2 u 2 k p ˆ i 1 2 p 2 k r ˆ i 1 2 r 2 w u t ϕ u i u w p t ϕ p i p w r t ϕ r i r 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 by synthesizing 22 26 we can render the differential of v i satisfying 27 v i k x i 1 2 x e 2 k y i 1 2 y e 2 k ψ i 1 2 ψ e e 2 k φ i 1 2 φ e 2 1 η φ i 1 2 q φ 2 1 η u i 1 q u 2 1 η r i 1 q r 2 1 η p i 1 q p 2 1 η ψ i 1 2 q ψ 2 k u i u e 2 k p i p e 2 k r i r e 2 k u ˆ i 1 2 u 2 k p ˆ i 1 2 p 2 k r ˆ i 1 2 r 2 γ u i 2 k σ ˆ u i 2 w u t w u γ p i 2 k σ ˆ p i 2 w p t w p γ r i 2 k σ ˆ r i 2 w r t w r k σ ˆ u i 2 1 2 σ u 2 k σ ˆ p i 2 1 2 σ p 2 k σ ˆ r i 2 1 2 σ r 2 1 2 u d 2 ψ y 2 1 2 α u i 2 1 2 α ψ e i 2 1 2 α r i 2 1 2 φ d 2 1 2 α p i 2 1 2 σ p i 2 1 2 σ r i 2 1 2 σ u i 2 γ u i 2 w u i t w u i γ p i 2 w p i t w p i γ r i 2 w r i t w r i 1 2 σ u i 2 1 2 σ p i 2 1 2 σ r i 2 define a i min 2 k x i 1 2 k y i 1 2 k ψ i 1 2 k φ i 1 2 η φ i 1 2 η u i 2 2 η r i 2 2 η p i 2 2 η ψ i 1 2 k u i 2 k p i 2 k r i 2 k u ˆ i 1 2 k p ˆ i 1 2 k r ˆ i 1 γ u i k σ ˆ u i γ u i γ p i k σ ˆ p i γ p i γ r i k σ ˆ r i γ r i k σ ˆ u i 1 k σ ˆ p i 1 k σ ˆ r i 1 and b i sup u d 2 ψ y 2 2 α u i 2 2 α ψ e i 2 2 α r i 2 2 φ d 2 2 α p i 2 2 σ p i 2 2 σ r i 2 2 σ u i 2 2 γ u i w u i t w u i 2 γ p i w p i t w p i 2 γ r i w r i t w r i 2 σ u i 2 2 σ p i 2 2 σ r i 2 2 the selection of tuning parameters should ensure a i 0 and let a min a i because all the states are defined in a compact set and according to assumption 1 it is tenable to assume the existence of b i and let b max b i then it can be inferred from 27 that 28 v i a v i b from 28 we know that v i t v i t j e a t t j 1 e a t t j b a holds for t t j t j 1 if t j t j 1 is long enough v i will converge to the arbitrarily small value by increasing a because x e y e ψ e e φ e 2 v i holds the same conclusion can be made for them then we will prove that all the errors in v i are sguub in the entire voyage time and analyze the influence of the switching of cruising conditions to the stability select the lyapunov function as w e a t t 0 v i and define a vector θ x y ψ e φ β u β r β p β φ u p r u ˆ p ˆ r ˆ w ˆ u t w ˆ p t w ˆ r t σ ˆ u σ ˆ p σ ˆ r t it follows from 28 that 29 w a e a t t 0 v i e a t t 0 v i b e a t t 0 t t j t j 1 according to tong et al 2016 long and zhao 2015 the selection of lyapunov functions can guarantee the relationship of v k j 1 θ μ v k j θ where μ 1 is a constant then it has 30 w t j 1 e a t j 1 t 0 v i t j 1 θ t j 1 μ e a t j 1 t 0 v i t j θ t j 1 μ w t j t j t j 1 b e a s t 0 d s it follows from 30 that 31 w t w t n i t 0 t t n i t 0 t t b e a s t 0 d s μ w t n i t 0 t 1 t n i t 0 t 1 t n i t 0 t b e a s t 0 d s μ 1 t n i t 0 t t b e a s t 0 d s μ 2 w t n i t 0 t 2 t n i t 0 t 2 t n i t 0 t 1 b e a s t 0 d s μ n i t 0 t t n i t 0 t t b e a s t 0 d s μ 1 t n i t 0 t 1 t n i t 0 t b e a s t 0 d s μ 2 t n i t 0 t t b e a s t 0 d s μ n i t 0 t w t 0 j 0 n i t 0 t 1 μ j t j t j 1 b e a s t 0 d s according to theorem 1 it has ζ ln μ a we can further infer that ζ ln μ a δ holds for δ 0 a ln μ ζ according to lemma 1 it renders 32 n i t a t b n 0 a δ t b t a ln μ t 0 t a t b it is clear from the definition of n i that n i t 0 t j n i t j 1 t 1 always holds for j 0 1 n i t 0 t 1 invoking 32 it renders 33 n i t 0 t j n 0 1 a δ t t j 1 ln μ besides the following inequality is presented 34 t j t j 1 b e a s t 0 d s e a δ t j 1 t 0 t j t j 1 b e δ s t 0 d s by substituting 33 and 34 to 31 it has 35 w t μ n i t 0 t w t 0 μ n 0 1 j 0 n i t 0 t 1 e a δ t t j 1 t j t j 1 b e a s t 0 d s e a δ t t 0 t n i t 0 t t b e δ s t 0 d s μ n 0 e a δ t t 0 w t 0 μ n 0 1 e a δ t t 0 t 0 t b e δ s t 0 d s μ n 0 e a δ t t 0 w t 0 b δ μ n 0 1 e a t t 0 e a δ t t 0 by multiplying both sides of 35 by e a t t 0 v i t can be obtained as 36 v i t μ n 0 e δ t t 0 v i t 0 b δ μ n 0 1 it is inferred from 36 that all the errors in v i t are sguub the proof is completed in the proposed scheme we should determine one set of parameters for one cruising condition of the fshc in turns in each set of parameters the parameter selection follows two steps 1 select k u ˆ i 1 2 k p ˆ i 1 2 k r ˆ i 1 2 k σ ˆ u i 1 k σ ˆ p i 1 k σ ˆ r i 1 γ u i k σ ˆ u i γ p i k σ ˆ p i γ r i k σ ˆ r i γ u i 0 γ p i 0 and γ r i 0 to maintain the acceptable performance of the fls and the dob 2 select τ 0 k x i 1 2 k y i 1 2 k ψ i 1 2 k φ i 1 2 0 η φ i 2 0 η ψ i 2 0 η u i 1 0 η r i 1 0 η p i 1 k u i 0 k p i 0 and k r i 0 to maintain the satisfactory tracking performance remark 1 for the parameters of n 0 and ζ they are only presented for the analytical use as is shown in 36 the larger n 0 will lead to the larger stable tracking and estimation errors in the closed loop system and for any n 0 0 these errors are always sguub invoking ζ ln μ a although a can be derived from the tuning parameters μ cannot be exactly known thus the average dwell time method cannot determine the values of n 0 and ζ seeing long and zhao 2015 tong et al 2015 nevertheless it can be inferred from 32 that the larger a will lead to the smaller n 0 while n i t a t b and μ are fixed 5 numerical experiments to verify the effectiveness of the proposed scheme the pch 1 fshc of the united states navy is selected as the simulation objective it possesses the length of 35 1 m and the breadth of 9 45 m seeing fig 5 liu et al 2017a gave its inertia parameters and hydrodynamic derivatives in the foilborne condition and some of them are shown in table i because there was no record of the model parameters of the fshc in the hullborne condition we assume a reasonable setting of model parameters in the hullborne condition by considering the hull resistance and friction set the threshold of u t as 40 knots the assumed parameters in the hullborne condition are set as m u 1 m u 2 m v 1 m v 2 m p 1 m p 2 m r 1 m r 2 x u 1 10 x u 2 x 1 υ 5 x 2 υ x n 1 10 x n 2 τ w u 1 10 τ w u 2 y v 1 10 y v 2 y r 1 10 y r 2 y p 1 y p 2 y 1 υ 5 y 2 υ τ w v 1 10 τ w v 2 k p 1 10 k p 2 k v 1 k v 2 k r 1 10 k r 2 k 1 υ 5 k 2 υ k δ r 1 5 k δ r 2 k δ a 1 0 5 k δ a 2 τ w p 1 10 τ w p 2 n r 1 10 n r 2 n v 1 n v 2 n p 1 10 n p 2 n 1 υ 5 n 2 υ n δ r 1 10 n δ r 2 n δ a 1 n δ a 2 and τ w r 1 2 τ w r 2 three control schemes are compared in the simulation firstly the proposed scheme is marked as s dob cf in which s is the abbreviation of switched and cf the abbreviation of composite fuzzy secondly by referring to deng et al 2020b we set the switched composite learning fuzzy control of the fshc which is marked as s cf this scheme abandons the dob in 19 and all its tuning parameters keep same with s dob cf thirdly by referring to li and tong 2017 deng et al 2019b we set the unified robust fuzzy damping control of the fshc which is marked as u rfd and u is the abbreviation of unified this scheme only uses one set of tuning parameters by using the fuzzy damping technique the real control laws of this scheme are derived as 37 d u k u u e k f u φ u u e β u x e d p k p p e k f p φ p p e β p φ e d r k r r e k f r φ r r e β r ψ e e cos φ where k f u k f p and k f r are damping parameters and φ u ϕ u i 1 φ p ϕ p i 1 and φ r ϕ r i 1 in the simulation the disturbances are generated by the platform of the simulated sea environment which has been successfully employed in our previous researches of deng et al 2019a 2020a in this platform the wave is described by the torsethaugen spectrum and the mechanical effects can be calculated with the known ship scales the details were illustrated in fossen 2011 the influence of wind on the fshc is omitted in the simulation the average wave direction is set as 30 to the north and the sea state is set as no 4 with the significant wave height of 1 5 m the spectral peak period is set as 15s and it implies that the swell is dominant then the wave surface is shown in fig 6 which reflects a moderate sea the reference signals are generated by setting the initial position and the heading angle of the virtual ship as x d 0 0 m y d 0 0 m ψ d 0 45 and letting 1 u d t 20 knots and r d t 0 1 e 0 1 t s 1 for 0 s t 20 s 2 u d t 45 knots and r d t 0 1 e 0 1 t s 1 for 20 s t 40 s 3 u d t 20 knots and r d t 0 1 e 0 1 t s 1 for 40 s t 60 s 4 u d t 40 knots and r d t 0 1 s 1 for 60 s t 100 s the initial position and attitudes of the fshc are set as x 0 50 m y 0 0 m ψ 0 45 and φ 0 0 all the initial values of the other states and variables are set to be zeros in this simulation we set 7 fuzzy rules for the fls the same set of membership functions is employed for the flss of all the three motions in both the hullborne and the foilborne conditions the jth fuzzy rule has the membership functions as 38 θ j u e u 12 2 j 2 j 3 θ j v e v 2 j 2 j 3 θ j p e p 0 4 0 1 j 2 j 3 θ j r e r 0 4 0 1 j 2 j 3 then the jth element of ϕ l i υ with l u p r is expressed as 39 ϕ l i j υ θ j u θ j v θ j p θ j r j 1 7 θ j u θ j v θ j p θ j r corresponding to the hullborne and the foilborne conditions two sets of tuning parameters are presented for the s dof cf and the s cf as 40 k x 1 0 1 k y 1 0 1 k ψ 1 0 1 k φ 1 0 1 k u 1 1 k p 1 1 k r 1 1 k u ˆ 1 1 k p ˆ 1 1 k r ˆ 1 1 γ u 1 1 γ p 1 1 γ r 1 1 γ u 1 0 1 γ p 1 0 1 γ r 1 0 1 k σ ˆ u 1 1 k σ ˆ p 1 1 k σ ˆ r 1 1 γ φ 0 01 η ψ 1 η u 1 η φ 1 η r 1 η p 1 0 1 and 41 k x 2 0 5 k y 2 0 2 k ψ 2 0 2 k φ 2 0 1 k u 2 0 5 k p 2 1 k r 2 1 k u ˆ 2 1 k p ˆ 2 1 k r ˆ 2 1 γ u 2 1 γ p 2 1 γ r 2 1 γ u 2 0 1 γ p 2 0 1 γ r 2 0 1 k σ ˆ u 2 1 k σ ˆ p 2 1 k σ ˆ r 2 1 η ψ 2 η u 2 η φ 2 η r 2 η p 2 0 1 the tuning parameters for the u rfd are set as 42 k x 0 2 k y 0 2 k ψ 0 5 k φ 2 k u 1 k p 1 k r 1 k f u 0 5 k f p 0 5 k f r 0 5 denote the synthetic uncertainty in each motion as ϒ j f j i υ d w j i with j u p r the estimate of ϒ j for the s dob cf is expressed as ϒ ˆ j w ˆ j t ϕ j i υ σ j i and that for the s cf is expressed as ϒ ˆ j w ˆ j t ϕ j i υ two performance indexes are constructed as 43 j c iae t 0 t ϒ u ϒ p ϒ r t d τ j c itae t 0 t τ ϒ u ϒ p ϒ r t d τ the trajectories of the fshcs with the three comparative schemes are shown in fig 7 it is clear that the s dob cf has the best tracking performance due to its sufficient compensation for the synthetic uncertainties because the compound disturbances are not handled in the s cf its tracking precision is lower than the s dob cf the u rfd cannot take the switched system well it has the worst tracking performance than the other two fig 8 demonstrates the environmental disturbances imposed on the fshc of the s dob cf following from the surge speed u of the fshc the disturbances are presented in the switched form fig 9 shows the surge speeds the yaw rates and the heading angles of the fshcs in the three schemes in the first subgraph it is clear that the u rfd algorithm cannot reach the switching threshold of u t by altering its tuning parameters a large deviation from the reference trajectory is noticed while u breaks through u t in the second subgraph all the yaw rates are within the limit of 95 deg s thus the assumption 2 is satisfied and the fshc model is stable in the third subgraph all the three schemes can ensure the satisfactory tracking of the heading angle to the reference fig 10 compares the roll angles of the fshcs it is observed that the reference roll angles have less fluctuation which substantiates that the proposed reference roll angle of 11 is insensitive to the perturbation of the yaw rate it can also be observed that only the s dob cf can ensure the high precision tracking of the roll angle to the reference fig 11 fig 12 and fig 13 demonstrate the control inputs of the three control schemes the switched control inputs are observed in figs 11 and 12 the control input for one cruising condition is set to 0 while the other cruising condition is activated at the current time fig 13 shows the unified control inputs without switching it should be noted that the jumps of u d inevitably induce the chattering of control inputs at the switching instant fig 14 reveals the estimates of fls weights in the surge motion of the fshcs with the s dob cf and the s cf algorithms it is observed that all the estimates of fls weights keep bounded during the voyage and the switching of u d will reset the convergence of these estimates fig 15 shows the estimates of compound disturbances in the s dob cf fig 16 and fig 17 compare the approximation performance of the flss to synthetic uncertainties in the s dob cf and the s cf schemes it is clear that the s dob cf can achieve the better approximation than the s cf this point is incarnated in the slower growth of the performance indexes of the s dob cf than the s cf in fig 18 the final values of j c iae of s dob cf and s cf are 280 97 and 712 62 respectively the final values of j c itae of s dob cf and s cf are 11121 89 and 34934 56 respectively 6 conclusion this paper develops a switched compound learning tracking control scheme for the fshc to fit with the different cruising conditions of the fshc the fshc model is described as a switched system and the switched control laws are designed the compound learning is achieved by setting the fls and the dob with the fls accounting for the unknown model dynamics the composite adaptive laws of the fls weights are designed by combining the tracking errors with the prediction errors calculated from the spem the dob is established to estimate the compound disturbances composed of the disturbances and the approximation errors of the fls both the fls and the dob are involved in the switched control laws by using the average dwell time method the stability of the switched system is analyzed finally the numerical experiment in the simulated sea environment is carried out to verify the superiority of the proposed switched control scheme in the future we would like to incorporate the event triggered control deng and zhang 2020 deng et al 2019b 2020b into the switched control of the fshc besides the online recorded data based prediction errors xu et al 2018 2019 can be involved in the adaptive laws to improve the learning performance of the fls credit authorship contribution statement yingjie deng writing manuscripts preparation simulation revision xianku zhang conceptualization supervision namkyun im revision writing review editing cailei liang investigation hardware realization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partially supported by the national science foundation of china no 51679024 the fundamental research funds for the central university no 3132019501 the university 111 project of china no b08046 and the national research foundation of korea no nrf 2020r1f1a1050113 titled with the technology for marine traffic hazard control system using ship navigation big data 
21228,reliable predictions of oceanic waves during storms have always been foremost for offshore design and operation coastal hazards and navigation safety indeed many accidents that occurred during storms were ascribed to the impact with unforeseen large waves in this context the purpose of this study is to improve the present state extreme wave estimate from spectral wave models we describe an implementation for the wam model and we investigate the use of wam and wavewatch iii fed with common routines designed to evaluate the short term range maximum wave statistics an extensive assessment of models results in the adriatic and north sea is performed using time and space time wave measurements and through an intercomparison between wam and wavewatch iii applied with three different input dissipation source term parametrizations st3 4 6 further models capabilities are investigated and extreme waves characterized in the mediterranean sea aiming also at disentangling the wave spectrum bulk parameters that may point to favorable conditions for the generation of high waves based on the comparisons between model results and measurements we conclude that for the model characterization of extremes the accuracy of the significant wave height is pivotal differences between models of other spectral parameters seem to have a minor effect keywords sea wave extremes maximum crest and wave heights wam wavewatch iii stereo imaging mediterranean sea north sea 1 introduction the characterization of extreme waves during marine storms has been an active topic of research for decades because of its importance for shipping offshore design and operations and coastal hazards theoretical progress has been fast but it has not been accompanied by an improvement of numerical predictions and of field measurement strategies significant efforts are being undertaken to better understand the occurrence and magnitude of extreme waves including rogue waves benetazzo et al 2017a cavaleri et al 2012 2016 dematteis et al 2019 donelan and magnusson 2017 dysthe et al 2008 fedele et al 2017 gemmrich and garrett 2011 janssen 2003 onorato et al 2001 2013 slunyaev et al 2005 toffoli et al 2005 waseda et al 2011 but modeling strategies resulted ineffective in warning seafarers or avoiding structural damage to offshore facilities see e g bitner gregersen and gramstad 2015 fedele et al 2017 although there are different theoretical approaches to tackle the extreme and rogue wave problem kharif et al 2009 what mainly limited their high resolution characterization at large spatial and temporal scales is the lack of widespread modeling tools and standardized observational data from a wave model point of view the extreme value problem can in principle be addressed by numerically solving in detail the complete fluid mechanics equations describing the sea surface elevation field mei 1983 this direct approach has a high computational cost and requires accurate initial conditions that are generally not easy to achieve it is generally limited to simulations of small space and time scales a hundred wavelengths or periods typical for instance of coastal surf zones or laboratory conditions still recent efforts using high order spectral simulations of the euler equations for directional sea states dommermuth and yue 1987 proved to be a powerful tool for investigating the oceanic rogue wave behaviour focusing however on individual rogue wave events e g fedele et al 2016 in this paper this deterministic approach and any model examination of wave by wave heights are set aside and we look instead at the statistical properties of the wave field these are customarily described by the directional wave energy spectrum which is the variable integrated by the phase averaged wave models solving the wave energy balance equation gelci et al 1957 this approach is based on a spectral decomposition of the sea surface elevation variance across frequencies or wavenumbers and directions while wave phases are not resolved phase averaged spectral wave models are the primary objects of our study the focus is on wam janssen 2008 komen et al 1994 and wavewatch iii hereinafter ww3 tolman and ww3dg 2014 which are the two most widely used open source community spectral wave models applied to forecast and hindcast studies spectral wave models provide an essential part of marine weather analysis and made significant improvements in simulating wave spectrum bulk parameters such as the significant wave height the peak period and the zero crossing mean wave period see e g http www ecmwf int en forecasts charts this means that model parameterizations describe the air sea interaction processes reasonably well little information on the other hand is known about their performance with focus on extremes namely the maximum wave and crest heights in this respect the motivation for the present model development arises from the extreme wave analysis that was implemented by janssen and bidlot 2009 in the european centre for medium range weather forecasts ecmwf version of the wam model called ecwam in ecwam the distribution of extremes is based on the mori and janssen 2006 formulation for the wave envelope height and is used to estimate the expected value of the maximum envelope height over a three hour duration there are no other operational forecasting centers that release maximum wave products on a regional or oceanic scale however information on the maximum wave heights are required by users and the offshore industry for the definition of the environmental loads over the lifetime of a ship or structure dnv gl 2017 but the common strategy used so far has been based on the off line processing of model spectra to derive meaningful parameters at certain sea locations to define extreme wave features and their spatial temporal variability ww3 was equipped with on line routines for maximum waves barbariol et al 2017 and the simulating waves nearshore swan spectral model booij et al 1999 was developed with the same purpose barbariol et al 2015 sclavo et al 2015 in this study an implementation for extreme wave computation has been developed for the calculation in wam cycle 4 5 4 or later versions https github com mywave wam of the maximum crest height i e the maximum surface elevation and the maximum crest to trough wave height i e the maximum vertical distance between a crest and the closest trough for each sea state these two variables complement the envelope height released by ecmwf and at the same time are consistent with the standard outputs of wave analysis e g obtained via zero crossing holthuijsen 2007 this study concentrates on documenting the code modification and its optimization for operational purposes the goal is to upgrade wam and to endow it with the same extreme wave outputs as ww3 this allows the assessment of their relative performance with focus on extremes and documenting how well they compare against observations to this end sea surface elevation records from two wave buoys and one wave probe are used in this study to establish differences between models these temporal records are complemented with stereo video data that are used to analyze maxima of space time wave trains we also discuss the way field observations ought to be managed so as to provide meaningful extreme wave information that may prove useful for model validation further we point out that since extreme wave statistics depend on the higher order spectral moments the assessment of maximum waves is an indirect way to test how well models reproduce the shape of the directional wave spectrum the combined use of wam and ww3 is used in this study to provide for the first time a characterization of the magnitude and spatial variability of extreme waves one can encounter in the mediterranean sea the atmospheric and wave pattern in this basin is rather complex with strong offshore winds such as the mistral in the western mediterranean region the etesian or meltem in the aegean sea and the bora and sirocco in the adriatic sea in the innermost areas the wave growth is limited by the available fetch the mediterranean sea is also exposed to site specific storm events called medicanes mediterranean hurricanes that are tropical like cyclones with winds well exceeding 100 km h additionally this basin is among the world s busiest waterways hence information about the intensity and distribution of maximum wave heights is crucial there are many reports on very large waves hitting ships for instance the louis majesty accident that caused two fatalities cavaleri et al 2012 while en route from barcelona to genoa or the jean nicoli ferry accident in 2017 that en route from ajaccio to marseille was hit by what was considered a rogue wave so far however the wave climate characterization has been limited to the extremes of the significant wave height sartini et al 2017 while it lacks any information on the maximum waves which are instead considered in this study this manuscript will proceed as follows section 2 is dedicated to explaining the theoretical formulations implemented in wam for the estimate of maximum crest and wave heights the theories are presented for temporal short term extremes and spatio temporal short term range extremes in the same section the observations of time extreme and space time extreme waves and the wam and ww3 setups in the adriatic mediterranean and north sea are described section 3 presents details of the wam implementation and assessment of model outputs against observations collected in the adriatic and north seas a model analysis of extreme waves in the mediterranean sea completes the section a discussion and summary of the main conclusions of the study are presented in section 4 2 materials and methods 2 1 short term range extreme value statistics in this section we are going to describe theories that are adopted for the estimation of extreme wave events in wam technical details of this implementation are given afterwards in section 3 1 while here we focus on the theoretical aspects and present key formulae the equivalent ww3 implementation was extensively described in a previous study barbariol et al 2017 so only what it is necessary to make a straight comparison with wam and with newly collected observations will be recalled in the present work the basic concept supporting the extreme value analysis is the steady state sea condition and the derived statistics is referred to as short term time interval from minutes to 1 hour or so later in this section we shall include the condition of homogeneity of the wave field and the joined short term range derived statistics in this context it is therefore necessary to motivate the two approaches we have adopted for extreme wave evaluation indeed till recently researchers have concentrated on the probability of extreme events from a given sea surface elevation η t time series i e point statistics in the temporal domain t at a fixed point x 0 x 0 y 0 in space being the two cartesian horizontal x and y axes lying on the still water surface in this context starting from the rayleigh distribution valid for linear wave trains with a narrow spectrum longuet higgins 1952 it has been established that nonlinear effects like second order bound waves and four wave interactions may have a profound impact on the statistics of extreme events fedele and tayfun 2009 janssen 2003 mori and janssen 2006 waseda et al 2011 also including nonlinearities however in the point statistics very high and even rogue waves remain very unlikely christou and ewans 2014 gemmrich and thomson 2017 magnusson et al 1999 a development of these models is due to advances started by adler 1981 and piterbarg 1996 who studied the extreme value problem in multi dimensional manifolds and introduced the concept of excursion probability for oceanic waves crossing a 2d sea surface region being the surface elevation η x y t the variable of interest the problem was reduced to three dimensions fedele 2012 fedele et al 2013 krogstad et al 2004 two in space x and y and one in time t in the 3d spatio temporal domain x y t the number of extreme events is larger than what could be expected in the 1d temporal domain t regardless the sample size benetazzo et al 2015 this achievement was used to explain the high likelihood of rogue waves when extreme events are studied in a 3d spatio temporal region benetazzo et al 2017a so that the very notion of rogue wave in stormy seas was questioned cavaleri et al 2016 for consistency in the degenerated case of null space e g in long crested sea states for which the areal effects become negligible the spatio temporal statistics coincides with the temporal one having said this and in line with the ww3 extreme wave implementation ww3dg 2019 for wam we have chosen to estimate two variables for a given sea state the expected value or expectation of the random variable maximum crest height c m and the expected value of the random variable maximum crest to trough wave height h m both variables are specified in the 1d temporal domain hereinafter time extremes and in the 3d spatio temporal domain hereinafter space time extremes 2 1 1 time extreme waves in this study to approximate the actual distribution function of c m at a fixed point x 0 on the sea surface we considered two time extreme statistical models of the wave elevation η t η x 0 t that include the effects of second order bound nonlinear modes longuet higgins 1963 the nonlinear effects on the geometry of ocean waves is to display higher and sharper crests a feature predicted by the gram charlier solution of longuet higgins we then rely on the dispersive focusing of second order non resonant harmonic waves as the leading physical mechanism for large wave formation this mechanism proved to suffice to explain most of the real oceanic large and rogue wave behaviour benetazzo et al 2015 fedele et al 2016 still limiting from a numerical model point of view the computational burden that is required to assess extremes with higher order corrections to the linear first order representation janssen 2017 we have hence not considered the role of four wave nonlinear interactions and any effect such as the modulation instability for narrow band wave packets in deep water janssen 2003 mori and janssen 2006 onorato et al 2013 still those higher order nonlinearities are considered via the kurtosis of the surface elevation probability density functions pdf in the freak wave warning system that is included in the wave model ecwam ecmwf 2019 however granted that difference in the order of nonlinearities and the choice of defining in ecwam the wave height as twice the envelope the ecwam theoretical approach for extremes and the methods used in ww3 implementation and here adopted for wam proved to have similar statistical scores when compared against open sea estimates of average values of maxima barbariol et al 2019 this suggests that four wave nonlinear interactions may have a minor effect on expected extreme waves occurring in directionally spread stormy seas as it was also proposed in other studies fedele et al 2016 2019 the first model we shall consider for c m is based upon the tayfun 1980 nonlinear formulation and it will be detailed further as a particular case i e null xy space of the space time extremes section 2 1 2 the second nonlinear model taken into consideration relies on the forristall 2000 exceedance distribution of the individual crest heights c in a record for an elevation threshold h and a sea state with significant wave height h s the forristall distribution prfo is expressed by a weibull like function given by 1 pr fo c h exp h α f h s β f where α f h s 0 is the scale parameter and β f 0 is the shape parameter of the distribution the effects of second order bound nonlinearities are included as a function of the water depth d and the wave spectrum via the steepness parameter s 2 π h s g t 1 2 1 and the ursell number u h s k 1 2 d 3 1 which both contribute to the values of α f and β f as follows 2 α f 0 3536 0 2568 s 0 0800 u β f 2 1 7912 s 0 5302 u 0 284 u 2 here g is the gravitational acceleration t 1 is the mean wave period calculated from the ratio of the first two moments of the frequency spectrum and k 1 is the deep water mean wavenumber for a frequency t 1 1 forristall obtained α f and β f by empirical fitting using simulations of short crested nonlinear waves typical of stormy sea states following gumbel 1958 the distribution of extremes can be written down as a function of the initial distribution and of the sample size n accordingly the probability that the maximum crest height c m in a sea state of duration d from minutes to a few hours and holding n waves on average is more than h can be expressed as follows 3 pr c m h d 1 1 pr fo n the previous formula for large values of h and n is fairly well approximated by a double exponential gumbel type distribution of crest heights this allows computing the expected value indicated with an overbar of the maximum crest height at a fixed point in the following form 4 c m 4 σ α f ln n 1 β f 1 γ β f ln n being γ 0 5772 the euler mascheroni constant and σ 2 the sea surface elevation variance the average number of waves is computed as n d t z 1 where and t z is the average zero crossing wave period the value of c m in eq 4 as well as the extremal values defined below increases with the sample size the time extreme model for the maximum crest to trough height h m is based on the naess 1985 theory of crest to trough heights h that generalizes the rayleigh distribution to account for the spectral bandwidth effects on the wave heights as follows 5 pr na h h exp 1 4 1 ψ h σ 2 where ψ 1 0 is a bandwidth parameter to be defined in section 3 1 which in typical wind sea conditions assumes values in the 0 75 0 65 range and it is a function according to naess of the dominant wave period the inclusion of the parameter ψ decreases the probability levels with respect to rayleigh for which ψ 1 since the bandwidth of the spectral density function approaches zero which hence represents an upper bound for the wave height probabilities the choice of a linear model for individual wave heights was dictated by two factors the effect on h of second order nonlinearities is small a few percent much smaller than that on crest heights tayfun and fedele 2007 and the requirement of limiting the computational effort needed to model higher order wave heights we shall verify this assumption later on in the paper by comparing model and observed extremes the extreme value exceedance distribution of the maximum wave height h m in a sea state with an average number n of waves can be expressed as follows 6 pr h m h d 1 1 pr na n for large values of h and n the gumbel type approximation provides the expected value of the maximum wave height at a fixed point that is 7 h m 2 σ 1 ψ ln n 1 2 1 γ 2 ln n the same result for h m can be obtained in a similar manner by means of the quasi determinism asymptotic theory boccotti 2000 that assumes a scale relationship between the shape of the highest waves and the expected value of the maximum crest height boccotti theory will be used in this study to characterize the value and the meaning of ψ for a given wave model spectrum 2 1 2 space time extreme waves when the domain of interest for extremes includes a 2d sea surface region i e the physical xy space crossed by wave trains the extreme value statistics incorporates the condition of short range homogeneous sea state which is the analogous condition for random variables that are ordered in space instead of time therefore if the averages and the variances of the variables are constant in time and space the process is called weakly stationary and homogeneous and the derived extreme statistics is defined as space time the so called space time extremes are here theoretically approached within the framework of the space time quasi determinism theory benetazzo et al 2015 2017b boccotti 2000 fedele 2012 accordingly the excursion probability pr of second order nonlinear maximum crest heights c m exceeding a large elevation threshold h over a 2d sea surface region with sides x and y and area a x y and a 1d time interval of duration d is expressed as follows benetazzo et al 2015 8 pr c m h d a n 3 h 0 2 σ 2 1 n 2 h 0 σ n 1 exp h 0 2 2 σ 2 where 9 h 0 σ 1 1 2 μ h σ 1 μ 1 is the tayfun formula that relates the linear h 0 and the second order nonlinear h crest heights via the steepness parameter μ see section 3 1 1 for its characterization in this respect fedele et al 2016 confirmed that in the space time extreme models the second order nonlinearities cannot be neglected while it is expected a modest contribution from the third order nonlinearities the exceedance probability in eq 8 is the sum of three terms fedele 2012 i the probability proportional to the number of waves n 3 that the threshold is exceeded within the space time region γ of 3d volume v xyd ii the probability proportional to the number of waves n 2 that the threshold is exceeded on the 2d faces of γ and iii the probability proportional to the number of waves n 1 that the threshold is exceeded on the 1d edges of γ in analogy with time extreme models in space and time the average numbers of 3d 2d and 1d waves are computed including the region sides and characteristic wavelengths and period in particular we have 10 n 3 d n 3 2 π x y d l x l y t z 1 α x t 2 α x y 2 α y t 2 2 α x t α x y α y t n 2 d n 2 2 π x d l x t z 1 α x t 2 y d l y t z 1 α y t 2 x y l x l y 1 α x y 2 n 1 d n 1 x l x y l y d t z the term x l x y l y d t z in the formula for n 3d represents the average number of 3d waves with mean wave length l x and mean crest length l y crossing the cuboid region γ assuming that the sea surface is confused with no organized movement of waves in that case the covariance matrix of sea surface elevation gradients is diagonal meaning that the space time surface elevation gradients are linearly uncorrelated which is consistent with them being independent baxevani and rychlik 2004 the degree of organization of the 3d wave motion is expressed by the additional term 1 α x t 2 α x y 2 α y t 2 2 α x t α x y α y t that becomes equal to zero in the limit of directionally narrow sea for which then n 3 d 0 see section 3 1 1 for the spectral definition of the parameters α xt α xy and α yt for large values of the crest height the excursion probability can be approximated with a gumbel type distribution from which we determine the expected value of the maximum crest height in space and time space time extreme as follows 11 c m ξ 0 μ 2 ξ 0 2 σ σ γ 1 μ ξ 0 σ 1 ξ 0 σ 1 2 n 3 ξ 0 σ 1 n 2 n 3 ξ 0 2 σ 2 n 2 ξ 0 σ 1 n 1 1 in eq 11 ξ 0 σ 1 is the normalized mode of the pdf of linear space time extremes fedele et al 2012 as a particular case assuming x 0 and y 0 the number of waves n 3 d and n 2 d vanish while n 1 d t z and eq 11 provides the prediction based on the tayfun 1980 model which is then incorporated in the wam and ww3 implementations of time extremes as particular case of space time extremes finally maximum crest to trough wave heights h m over a space time region are estimated by means of the quasi determinism theory boccotti 2000 which establishes a relationship via the surface elevation autocovariance function between the expected maximum crest and crest to trough wave heights in the context of the deterministic behaviour of the largest waves letting μ 0 in eq 11 and hence assessing the linear part of c m the space time extreme value of h m is computed as follows 12 h m ξ 0 σ γ ξ 0 σ 1 2 n 3 ξ 0 σ 1 n 2 n 3 ξ 0 2 σ 2 n 2 ξ 0 σ 1 n 1 1 2 1 ψ to complete this section it is worth clarifying the meaning of the sea surface area a with orthogonal sides of length x and y that are used for space time extremes we start by assuming the ergodicity of the random wave process such that the elevation probability density function over the 2d space give the same results as over an ensemble of realizations however the space must satisfy the requirement that statistical properties such as moments of the distribution are invariant under translation of coordinates this condition of homogeneity is preserved if the sea surface area is small enough that the wave spectrum and its moments do not change within it the short range condition is satisfied by keeping both x and y range within o 102 m plainly depending also on the spatial variability of external forcing and other wave related processes for numerical models the area a is supposed to be drawn around each grid node where the wave spectrum is firmly defined at each time step as a consequence x and y should be approximately smaller than the usual model grid size through which spectral properties are expected to change 2 2 time and space time extreme wave observations the assessment of the theoretical formulations aimed at predicting the short term range distribution of maximum wave parameters is a challenging task indeed for a given sea state the maximum heights in time and space time wave trains are randomly distributed and cannot be deterministically predicted but only statistically characterized by their pdf therefore nothing can be said about the worthiness of a theoretical model for extremes just having for instance from a record η t of given duration δ say 20 minutes for wave buoys only one realization of the random variable h m max h t δ or c m max c t δ a set of independent realizations of c m and h m must be produced so as to simulate the stochastic process and to provide an assessment of the theoretical formulations for fixed point oceanic wave observations this requires that within a time interval δ where η t can be assumed stationary in a statistical sense the elevation series is split into independent wave records say n of equal duration d δ n where maxima are gauged benetazzo et al 2018 the samples of the random variables c mi and h mi with i 1 2 n have an empirical distribution function of which we can compute the sample means defined as 13 c m obs c mi h m obs h mi to be then compared with the theoretical predictions c m and h m respectively as a corollary because of the inherent randomness of the process very little can be said about the relationship between the sea state characteristics and the likelihood or intensity of wave maxima taking only one observation h mi or c mi unless the pdf of maximum heights is fairly narrow all this said a strict requirement for model assessment is that the observed sea surface elevation series such as η t is logged and made available for processing this data is rarely available which implies that modeled extremes can only be assessed for short time periods and on a few sparse places requesting that in general ad hoc experiments with dedicated technology must be planned see e g filipot et al 2019 to be compared with modeled results dedicated in situ observations of maximum waves from one adriatic sea and two north sea stations were taken into account in this study in the adriatic sea instruments were mounted on the acqua alta oceanographic platform longitude 12 51 e latitude 45 31 n 15 km off the venice coast italy although the adriatic sea is on average a calm sea the acqua alta platform is a favorable site for wave observations during storms since it is exposed to a variety of directional sea states cavaleri 1999 spanning short fetched northeasterly wave conditions generated by bora winds well developed southeasterly wave conditions generated by sirocco winds and occasionally southeasterly swells crossing northeasterly wind waves since our purpose is to assess both time and space time extreme model predictions two distinct datasets of observed waves are considered the first one includes space time elevation data η x y t gathered with a stereo imaging system while the second one contains time data η t collected with a vertical looking point like wave radar model vegapuls 42 that sampled the surface elevation at 2 hz with accuracy of 0 05 and 1 mm resolution it is worth reminding that acqua alta was the test site for previous experiments dedicated to the observation and modeling of the largest waves during storms benetazzo et al 2015 2017a including the test used to assess the ww3 implementation for extremes barbariol et al 2017 as mentioned before for space time extreme assessment we have used a stereo wave imaging system based on the technology of wass wave acquisition stereo system benetazzo et al 2012 bergamasco et al 2017 that allows to observe 3d wave fields while they evolve on the space time domain the wass setup at acqua alta is similar to that adopted in previous applications benetazzo et al 2012 leckler et al 2015 and it used a pair of 5 mpixel digital cameras 2456 columns by 2048 rows array of 3 45 μm square active elements mounting 5 mm distortion less lenses and placed 3 23 m apart and 14 5 m above the mean sea level the cameras internal parameters were estimated using the bouguet s matlab calibration toolbox http www vision caltech edu bouguetj calib doc whereas the spatial configuration of cameras i e the extrinsic parameters was computed using an auto calibration approach based on the photometric consistency between stereo images bergamasco et al 2017 with the device calibrated each image pair acquired was stereo rectified and processed by a modified version bergamasco et al 2017 of the dense stereo algorithm proposed by hirschmüller 2008 available in the opencv library http opencv org by bradski and kaehler 2008 the semi global nature of the approach has the great advantage that it can relate the photometric consistency of several matching pixels to improve the reliability of the disparity map especially for areas with loosely distinctive features as a consequence we can keep a relatively small window size 13 13 pixels while still obtaining a precise localization of the matches a discussion of the errors associated with the wass measurements is reported in the study of benetazzo et al 2012 from which we recall the mean absolute quantization error of the adopted wass setup which is in the order of 3 cm along the three orthogonal directions for each image pair output of the stereo process is a cloud of 3d points of the sea surface field for each point cloud after being transformed to a common earth reference frame benetazzo 2006 a patch wise planar surface was constructed by means of 2d delaunay triangulation over the xy space then the wave elevations η were resampled over a regular xy grid fig 1 at a resolution of 0 3 m to span the space x 65 m 65 m and y 20 m 100 m to limit the influence of high frequency noise time series η t taken at each xy position of the space time wave burst η x y t were low pass filtered at 1 2 hz thus removing from the field the spectral components shorter than about 1 m for each burst the standard deviation σ has been estimated from the second order moments of the surface displacement η x y t probability density function as follows 14 σ η x y t η x y t 2 1 2 and by definition the observed significant wave height was taken as h s 4σ for the investigation of the model capability to estimate space time maximum wave parameters we have focused on metocean conditions that include wind sea dominant ne bora and se sirocco winds and one case of se swell for a total of eight bursts that were collected during the stormy periods march april and september october 2018 table 1 we have then considered the maximum waves within the eight space time elevation records η x y t to this end we have followed the same approach as adopted by benetazzo et al 2015 and benetazzo et al 2018 and we have split the entire time interval δ in adjacent and non overlapping space time subrecords here we choose space time regions γ i of equal square area a xy 30 m 30 m and duration d 180 s in order to yield a set of independent observations of the random variables maximum crest and wave heights for each γ i the former is defined as follows 15 c m i max η x y t x y t γ i while the individual maximum wave height h mi for x y t γ i was calculated via zero crossing analysis of each time series of duration d defined in the sampled xy space the statistical independence of these realizations was verified by checking that maxima did not belong to the same 3d wave group a similar strategy and same time interval were used to extract the time extreme statistics using point wise radar data collected in the adriatic sea in that case the continuous time series of surface elevations η t has been divided in consecutive time intervals δ 3600 s each of them split in d 180 s long non overlapping records r i 20 time per hour then for the ith record r i we defined the maximum crest height as follows 16 c m i max η t t r i and accordingly h mi was computed by adopting a zero crossing analysis within each interval this analysis produced a sample at hourly intervals of 20 individual values of c mi and h mi whose averages c mi and h mi were compared with model predictions centered at the same hour observed extremes have been up scaled to account for the underestimation of wave height statistics due to the sampling rate tayfun 1993 correction factors depend on the sampling interval and mean wave period they vary in the range 1 00 1 08 with most probable values around 1 03 the histogram of observed values is shown in fig 2 mean and maximum values for c mi and h mi are respectively 0 85 m and 1 59 m and 4 34 m and 6 88 m to complement adriatic sea data in the north sea raw sea surface elevation data η t were collected by two datawell directional waverider buoys moored at the stations westerland 8 13 18 12 e 54 55 01 92 n depth 13 3 m years spanning 2013 2017 and helgoland 7 52 04 80 e 54 09 36 00 n depth 15 7 m years spanning 2011 2017 in order to obtain empirical estimates of c m and h m we averaged twelve values of maximum crest height c mi and crest to trough height h mi from zero crossing analysis that were obtained by splitting the 30 minute records into two equally long bursts d 900 s and then assuming a stationary sea state for a duration of 3 hours the tayfun correction factors due to the buoy sampling rate is within the range 1 0 1 1 with most probable values around 1 05 histograms of the observed maximum wave parameters from the two buoys are shown in fig 3 results highlight the different characteristics of the wave climate at the two stations in the north sea in particular the helgoland station displays wave extremes that are around 20 on average and 50 at most higher than those at the westerland station 2 3 wave modeling wam and ww3 setups and forcings wave model datasets have been based on wam cycle 6 http mywave github io wam and ww3 version 6 07 https polar ncep noaa gov waves wavewatch both models integrate the spectral wave action equation in space and time with discretized wavenumbers or frequencies and directions and balance conservative wave processes by the non conservative sources and sinks for the purposes of the study wam and ww3 were set up in the adriatic sea and mediterranean sea sharing the same domains and computational grids whilst in the north sea only wam runs were taken into account models were prepared on the one hand to assess the models capability of reproducing the maximum wave statistics derived from the adriatic sea time and space time extreme data and north sea time extreme data observations and on the other hand to make a wam versus ww3 comparison and a climate assessment of the maximum waves in the mediterranean sea at first to evaluate the extreme wave predictions at the position of the acqua alta platform section 3 2 wam and ww3 used a model grid covering the adriatic sea and ionian sea the southern boundary is placed along the 39th parallel north where no wave forcing was imposed with 0 05 uniform resolution in longitude and latitude and a spectral grid composed of 36 evenly spaced directions and 32 frequencies exponentially spaced from 0 0500 to 0 9597 hz at an increment of 10 in wam the wind wave interaction source term is based on the wave growth theory of miles 1957 that was applied to wave forecasting by janssen 1991 in our study wind input dissipation source terms st were switched to the bidlot et al 2005 configuration with parameters chosen to match the operational ecwam contained in the forecasting system of ecmwf since version cy38r1 ecmwf 2012 dissipation owing to bottom friction is taken from the jonswap parameterization hasselmann et al 1973 with friction coefficient equal to 0 038 m2s 3 default in wam and ecwam ww3 based adriatic sea runs were implemented setting three alternative st parameterizations namely st3 st4 and st6 ww3dg 2019 they describe the wind input wave dissipation due to whitecapping and swell dissipation differently with the nonlinear four wave interactions the same for all st setups those are the main processes in deep water conditions the objective is to focus on the st performance especially on the predictions of maximum waves the st3 parameterization hereinafter ww3 st3 follows ecmwf 2012 to make the source term implementation as close as possible to the one in the wam model the st4 setup hereinafter ww3 st4 is described by ardhuin et al 2010 and as it was originally implemented it allows a set of parameters to be defined by the user we focused on two of them namely β max and z 0 max that were accordingly modified using three different combinations i ww3 default parameters of test471 ii parameters of test405 of ardhuin et al 2010 iii parameters of test471 but setting β max 1 55 and z 0 max 0 002 as in test405 which was thought to perform well for younger seas from our tests the last setup provided the best performance not shown here compared with observations of h s at acqua alta and least scatter with respect to wam and ww3 st3 outputs and it was then used for all st4 based implementations of this study finally st6 hereinafter ww3 st6 package for parameterizations of wind input wave breaking and swell dissipation terms was set using the default configuration babanin et al 2010 liu et al 2019 rogers et al 2012 ww3dg 2019 zieger et al 2015 for all three above mentioned ww3 setups as for wam the bottom friction was switched to the jonswap formulation with default value of 0 067 m2s 3 for the friction coefficient this definition is different from the standard in wam further numerical schemes for wam first order upwind and ww3 third order with garden sprinkler effect alleviation were kept as default although different numerics may lead to different results ecmwf 2019 we have chosen to test and intercompare the models in their standard configuration for wave action equation solution aware that differences in model results might be partially due to numerics the purpose of testing three physical formulations in ww3 is to make an analysis albeit preliminary of their relative performances with focus on the estimation of extremes and related spectral parameters and to verify on the one hand if the ww3 behaviour compared to wam is influenced by the source terms which on the other hand would be an unimportant factor for wave extremes obviously excluding the correct computation of h s in this respect stopa et al 2016 made a thorough comparison of the three source term parameterizations they concluded that st3 is a good predictor of h s and higher order moments of the wave spectrum and can be used under the majority of wave conditions for all sea states st4 has minimal h s biases and the higher order wave parameters perform reasonably well st6 performs similarly to st4 with major differences in the higher order wave parameters and low wave heights a recent re calibration of st6 improved its performance and it was made available in ww3 since version 6 07 liu et al 2019 however differences between st4 and st6 still remain with respect to the directionality of the wave field in the adriatic sea runs wam and ww3 were forced with high resolution 10 m height wind fields produced by the cosmo i2 forecasting local model the cosmo i2 model is run operationally at the regional environmental agency arpa simc of the emilia romagna region italy twice a day at 00 utc and 12 utc producing hourly wind fields with horizontal spatial resolution of 0 025 0 025 cosmo i2 winds performed reasonably well in the area of interest fig 4 at the 95th percentile level the model minus observation bias is 0 2 m s left panel while wind model results are less accurate for rarer events fig 4 depicts on the right panel a time series comparison between modeled and observed wind speeds during the sirocco storms of the 28 29 october 2018 there is good agreement between the two data being the cross correlation coefficient cc 0 85 the root mean square difference rmsd 2 48 m s and the slope of the best fit line between modeled and observed winds p 1 03 the mediterranean sea wave model setup covers the whole basin with 0 05 uniform resolution in longitude and latitude and with a spectral grid composed of 36 evenly spaced directions and 32 frequencies exponentially spaced from 0 0500 to 0 9597 hz at an increment of 10 wam was run with the same setup as for the adriatic sea implementation while ww3 was formulated using the st4 source term configuration with input parameters as in the adriatic sea run i e st4 default value configuration but with adjusted coefficients β max 1 55 and z 0 max 0 002 wave models were forced with hourly winds from the ecmwf reanalysis era5 https confluence ecmwf int display ckb era5 3a data documentation that were downloaded at the nominal resolution of 0 25 the native era5 resolution is 0 28125 simulations spanned 10 years from 01 january 2001 to 31 december 2010 despite partially lacking the high resolution recommended for the wind forcing in closed and semi enclosed sea areas cavaleri and bertotti 2004 the worthiness of the era5 forcing wind field in the mediterranean sea was demonstrated taking advantage of the derived measurements of u 10 from the envisat 1 satellite altimeter for the period 2002 2010 which partially spans the numerical simulations period typical error metrics of the era5 performance clearly indicate that model winds are overall well reproduced in the basin fig 5 the model minus observation bias is 0 02 m s the rmsd is 1 44 m s and best fit linear slope p is slightly smaller than 1 p 0 97 notwithstanding these good marks there are features that are worth being mentioned at first not shown here performances are not spatially homogenous since the era5 resolution penalizes the coastal areas and the sea regions sheltered by small islands moreover there is clearly an u 10 dependent performance the quantile quantile plot circles in fig 5 and its residual right panel exhibit a negative model bias that grows with the wind intensity i e the bias is larger for the more intense storm this residual is equal to 0 1 m s 0 4 m s and 1 2 m s for the 90th 95th and 99th percentile respectively given this score result the 99th percentile threshold is adopted as the highest confidence level for sea states and wave extreme model assessment in the mediterranean sea section 3 3 in the north sea wam hindcast spanned eight years from 2010 to 2017 and was applied to the gcoast area geesthacht coupled coastal model system that includes the north sea and the baltic sea staneva et al 2015 2018 wam was run on a model grid located between 40 04 00 n to 65 56 15 n and 19 53 20 e to 30 10 00 e with a spatial resolution of about 3 5 km 318 745 active model grid points the solution of the energy balance equation was provided for 24 directional bands at 15 each starting at 7 5 and measured clockwise with respect to true north and 30 frequencies logarithmically spaced from 0 042 hz to 0 66 hz at intervals of δf f 0 1 the wave model takes into account depth refraction and depth induced wave breaking and is driven by hourly era5 wind fields at its open boundaries it receives values generated by a coarse grid model spatial resolution 0 25 0 25 for the north atlantic situated from 5 s to 75 n and from 100 w to 40 e the integrated wave parameters for all active model grid points and spectral data at locations where measurements are available are stored at hourly intervals 3 results 3 1 the wam implementation for maximum waves the novel wam code reproduces the structures that can be encountered in ww3 with some tweaks to adapt them to the wam philosophy and some optimization addenda in this section we focus on how the parameters for maximum waves have been included in wam new subroutine wamax details in appendix a and how the computational time that is required to evaluate the new variables has been optimized wam input files and namelists have been adapted in particular modifications dealt with the following items three new input variables x in metres y in metres d in seconds for the computations of space time extremes all three values must be larger than zero four new output variables c m in metres and h m in metres for both time extremes and space time extremes 3 1 1 spectral moments and derived parameters focusing that leads to energy concentration in wave trains is a phase governed process the use of phase averaged models imposes to set aside a deterministic approach for the description of maximum waves and instead to use a statistical approach as a basis of the methods used in this study we then exclude any examination of wave by wave heights and rather we look at the properties of the wave field as it is customarily described by the directional wave energy spectrum s ω θ hence consistently with the ww3 implementation to estimate all parameters included in the extreme wave pdfs we rely on the ijl moments m i j l of s ω θ defined as follows 17 m i j l k x i k y j ω l s ω θ d θ d ω where ω and θ are the intrinsic angular wave frequency and the wave direction respectively and k x k y are the components of the wavenumber vector k no contribution from the frequency spectral tail is taken into account and the full spectrum is integrated without partition for multiple wave systems moments m i j l with i 0 and j 0 depend on the orientation of the coordinate system and it should be a natural choice to select the x and y axis orientation in such a way that the variance of spatial derivatives along one axis say x is maximized baxevani and rychlik 2004 this condition is satisfied assuming the peak direction of wave propagation coincident with the x axis after this axis orientation below we describe the way the new variables are used in wam and their meaning to estimate the value of the bandwidth ψ that is used in the distribution of maximum wave heights we rely on boccotti 2000 who defined ψ for general bandwidth processes as the normalized minimum of the temporal autocovariance function ψ τ of the sea surface elevation field η t that is 18 ψ ψ τ ψ 0 where τ is the abscissa of the absolute minimum of ψ τ which is defined as follows 19 ψ τ η t η t τ where τ is the time lag the autocovariance function ψ τ is estimated from the directional spectrum as follows 20 ψ τ s ω θ d θ cos ω τ d ω in regard to the nonlinear large crest height distribution an integral measure of the steepness μ that accounts for bandwidth effects has been proposed by fedele and tayfun 2009 21 μ μ a 1 υ υ 2 where 22 μ a σ k a σ ω a 2 g σ m 001 m 000 2 g is an integral measure of the steepness for narrow band waves in deep waters and ν m 000 m 002 m 001 2 1 is the spectral bandwidth longuet higgins 1975 as for the space time extremes formulations it is pivotal to obtain the three values of average number of waves n 1 n 2 and n 3 that are defined in eq 10 they include the irregularity parameters which are given by 23 α x t m 101 m 200 m 002 α y t m 011 m 020 m 002 α x y m 110 m 200 m 020 and are equal to the normalized cross correlation coefficient between the components of the sea surface gradient it is worth noting that while some moments m ijl change with the orientation of the axes baxevani and rychlik 2004 the determinant of the sea surface gradients covariance matrix which enter the extreme estimate is unaffected by an axes rotation with the selected axes moments m 200 m 020 and m 002 are related to the mean zero crossing period t z the mean zero crossing wavelength l x and the mean wave crest length l y by the following equations 24 t z 2 π m 000 m 002 l x 2 π m 000 m 200 l y 2 π m 000 m 020 where m 000 σ 2 is the variance of the wave field such mean wave parameters have a direct connection with the mean square slope mss of the sea surface elevation field indeed we can write mss as follows 25 m s s 2 π 2 m 000 1 l x 2 1 l y 2 the so defined wave lengths are proportional to the fourth order moment of the wave spectrum in deep water k 2 is proportional to f 4 and therefore as for mss they are strongly influenced by the high frequency wave components this leads to the important result that extremes depend on the higher order spectral moments which were verified to be sensitive to some extent to the source term parameterizations in spectral models rascle and ardhuin 2013 stopa et al 2016 in this respect assessment of model extremes is also an indirect way for the evaluation of the directional spectrum shape in eq 11 the computation of the mode of the probability density function of space time maximum linear crest heights requires the solution of an implicit equation in ξ 0 fedele 2012 therefore to optimize numerical performance in ww3 we adopted a strategy that gives an estimate of ξ 0 as follows barbariol et al 2017 26 ξ 0 2 ln n 3 2 ln 2 ln n 3 2 ln 2 ln n 3 where n 3 is given by eq 10 the above approximation strictly works when the number of 3d waves is large enough given the customary duration of a sea state including o 102 waves on average over the duration d error in using eq 26 is smaller than 3 when the sea surface area xy l x l y in wam we have adopted the same strategy 3 1 2 numerical performance optimization the most time demanding task in wamax involves the computation of the auto covariance function ψ τ this stage was then optimized in order to reduce the time required for its calculation clearly there is no need for a full computation of ψ τ for τ 0 as only the normalized minimum is required being ψ min ψ τ max ψ τ the maximum value max ψ τ occurs clearly for τ 0 and it equals the elevation variance m 000 hence only the time lag and value of min ψ τ must be sought this led barbariol et al 2017 to develop an ad hoc strategy which was implemented in ww3 this implementation computes twenty points around the time position where the minimum is assumed to occur this method is robust and its computational time is known which is an advantage for operational purposes however this strategy can not control the accuracy of the result even though the actual error is less than a few percent of the actual value the point is that the assumption that the minimum is located inside a region which is statistically determined on simple spectra may fall the use of a search method to estimate the second zero of the ψ τ derivative can overcome this aspect and help improve the accuracy and reduce the computational cost the optimal alternatives we tested are the newton method the secant method the bi section method and the golden section search for all strategies a reliable starting point region is needed this is especially crucial for the newton method in order to determine a consistent statistic for the estimate we evaluated the time τ m i n 1 of the first minimum of ψ τ using one month january 2014 of global era interim directional spectra afterwards we normalized τ m i n 1 and the half period τ m a x 2 τ m i n 1 where τ m a x 2 is the time of the second maximum of ψ with respect to three characteristic wave periods t m 01 t m 02 and t e t m 10 table 2 indicates the median values the distribution of t e appears sharper than the other two thus the value τ 0 47 t e will be taken as the starting point for the search moreover using the era interim spectra we found that the best computational option is represented by the golden section search the first option i e newton method is the fastest see table 3 even if it had to be degraded to a quasi newton method with a search path strategy problems arise from the second derivative of the autocovariance function which besides doubling the computational load often shows problematic behaviour leading to non convergence the secant method happened to be slower than the quasi newton strategy even though the number of iterations could be controlled by accepting a sufficiently high tolerance the most robust method has proven to be the bi section despite being the slowest the golden section search showed a stable and trustworthy behaviour while maintaining a certain speed the computational time required to produce extreme wave outputs was found to have a small impact on the total cpu load used by the model using the mediterranean sea setup described in section 2 3 the time spent in wamax is less than 0 5 of the total model time we have also tested cases where the convergence may fail in providing a good estimate of ψ indeed it may happen that the first minimum of ψ τ is not the absolute one and in very few cases it lies above zero those situations occur in mixed sea states when a swell is super imposed to a wind sea of similar energy see for instance fig 4 9 in boccotti 2000 in this respect fig 6 shows the scatter between the values of the first minimum ψ m i n 1 and of the second minimum ψ m i n 2 in most of the cases 99 the first minimum is deeper than the second one but there are few wave conditions for which the first local minimum is not the absolute one these however are represented by non severe sea conditions median value of h s about 0 4 m and maximum below 2 m for which as a consequence the prediction of h m might be slightly underestimated 3 2 wam and ww3 maximum wave assessment adriatic sea and north sea preliminary to any analysis of model outputs is the assessment of model scores using reference observations of targeted parameters in this respect we must recall that maximum crest and wave heights derived from numerical runs were compared against in situ observations in a few previous studies barbariol et al 2019 used era interim and era5 wave spectra in the pacific ocean station papa to assess time and space time extreme wave statistics against stereo two experiments in a single day near the station and buoy data at the station while in ecwam envelope maximum heights were assessed against canadian and norwegian buoys ecmwf 2019 however in most cases model extremes were characterized off line by processing 2d wave spectra either computed from the data benetazzo et al 2015 or modeled at the specific location of wave observations fedele et al 2016 having wave models with inbuilt routines for extremes allows bypassing this strategy since extremes may be computed on line by wave models whose overall performance can be hence assessed to support this evaluation in this study 2d spectra were still processed off line to calculate ancillary variables such as the wave steepness and the spectral bandwidth that enter in the theoretical formulations in situ observations from stereo cameras wave radar and wave buoys are hence compared with the modeled results for this purpose data collected in the adriatic sea are here used to assess the wam and ww3 capabilities of correctly estimating the statistics of observed maximum waves whilst in the north sea only wam outputs were considered we distinguish between space time and time extremes as we show below 3 2 1 space time extremes in regard to the space time statistics observed wave parameters are summarized in table 1 which encloses details of the experiments we performed with the stereo imaging system reference 3d space time region γ used to produce the extreme data sample has orthogonal sides x 30 m y 30 m and d 180 s same values were then set in wam and ww3 model runs the observational wave sample is composed by a variety of sea conditions that accordingly produced a large spread of extreme values c m obs is equal to 1 01h s at least and 1 30h s at most while h m obs ranges between 1 65h s and 1 99h s it is understood that the proportional relation in eqs 11 and 12 between extremes and the number of waves n 3 n 2 and n 1 provides for a fixed space time region xyd and given h s that is the principal scale factor for maximum wave parameters a path for the maximum waves whose expectations c m and h m decrease increase for sea states that comprises on average longer shorter waves mori and janssen 2006 we shall partially account for this behaviour in the following analysis before quantitatively evaluating the errors on extreme values for each model parameterization we firstly proceed assessing the performance in the reproduction of the h s behaviour at the acqua alta platform for the four months 01 march 30 april and 01 september 31 october 2018 when stereo data were collected fig 7 top left we observe that all model configurations show a degree of scatter around the observations which however are well modeled on the whole with absolute bias for h s smaller than 0 1 m despite having a somewhat limited prospect both temporal spanning four months and spatial comprising a single station this result is consistent with that of stopa et al 2016 who noted that at a global scale the three ww3 source term parameterizations behave reasonably well for most wave conditions going into details we note that wam generally overestimates ww3 with relative bias larger than 0 07 m instead there are small differences among the three ww3 parameterizations being the relative bias at most 0 06 m and in particular st4 and st6 that perform similarly up to h s 3 m the largest differences between wam and ww3 all parameterizations occur when the sea states are more energetic as can be observed by comparing the q q quantile quantile plot of h s depicted in fig 7 bottom left the probability distributions of h s deviate above the 95th percentile where the ww3 minus wam residual reaches on average about 10 the largest discrepancy visible at h s 4 m is associated to the peak condition of a single storm occurred on 28 29 october 2018 which hence has small statistical significance we note however that differences between wam and ww3 may be partially explained based on the friction coefficient default value which makes the bottom friction of ww3 stronger examining the space time extreme values for the same period scatter and q q plots of c m and h m in fig 7 central and right panels respectively show that as for h s wam slightly overestimates ww3 the ww3 minus wam bias is small and larger than 0 17 m for h m and 0 11 m for c m ww3 runs with different source term parameterizations show similar distribution maximum bias is about 0 1 m for both variables in particular st4 and st6 with the only exception of the 29 october storm when c m 4 m and h m 6 m ww3 underestimation with respect to wam grows with the order of the quantile percentage at the 95th percentile shown with a vertical dashed line in the qq plots the residuals are on average about 8 and grow for the rarer conditions the differences on extreme values we have pointed out stem mostly from the performance of h s which is then the pivotal variable for maximum wave accuracy to complement this view we examine the spectral parameters that contribute to extreme estimates from model spectra we concentrate on the nonlinear steepness parameter μ used in the statistics of c m and on the bandwidth parameter ψ used in the statistics of h m results are shown in fig 8 where ww3 is compared with wam top panels and model outputs with observations bottom panels we note that ww3 spectra are on average steeper than wam spectra the normalized bias for μ is at most 6 for st6 and at least 2 for st3 a fact that would favour other parameters being equal e g h s and the average number of waves within the space time region that ww3 maximum crest heights are slightly larger than wam heights differences of a smaller degree albeit pointing to the same direction i e ww3 values larger than wam ones are observed for ψ ww3 spectra are generally narrower and hence the probability density function of maximum wave heights h m is expected to shift towards larger values when compared to observations bottom panels wam and ww3 st3 have a good match with the observed μ while ww3 st4 and ww3 st6 produce slightly steeper conditions difference of a few percent inspecting the distribution of the variable 1 ψ that is used in the computation of h m we note a large spreading of model data around the observation which are however well reproduced on average by all models being the normalized bias smaller than 1 we shall return to the analysis of the wam and ww3 values of μ and ψ in the next section where we shall assess extremes in the mediterranean sea next we focus our attention on the comparison between modeled and stereo derived space time extremes granted the possible difference between modeled and observed h s in order to remove the contribution of the sea state severity the assessment is provided for values of c m and h m that are normalized with h s indicated as c m and h m in fig 9 we observe for wam a small negative bias 0 03h s and 0 02h s for c m and h m respectively suggesting that model frequency spectra are slightly less steep and broader than observations the opposite is true for ww3 with a positive bias for both extreme values and with st4 and st6 that typically produce similar values and with smaller variability than st3 as it was stated before the normalization with h s removes only part of the difference between observed and modeled values since the extreme distributions incorporate also the sample size i e the average number of waves n 1 n 2 and n 3 over the space time domain for example for a fixed number of waves the maximum wave height distribution in the time domain according to rayleigh theory is constant we shall examine how to remove the effect of the sample size in the analysis provided in section 3 3 for the time being we point out that after normalization more less energetic sea states produce longer shorter waves and hence for a fixed space time or time region a smaller larger number of waves which imply smaller larger wave extremes it is easily understood therefore that the probability of extreme waves exceeding a specified value depends on the number of waves within the record to account for this variability we have analyzed the relative error between model and observed normalized extremes as a function of the difference between mean wave periods that we use as a proxy for the number of waves fig 9 right panels as expected in confirmation of the theoretical approaches positive errors i e model observation imply that the model period is smaller than the observed period and vice versa however overall model errors are small for all model runs indeed model estimates of normalized space time maximum wave parameters compared fairly with stereo observations for c m the model minus observations mean difference is 1 1 with a rmsd of 4 9 while for h m the mean difference is 1 9 and the rmsd is 4 8 3 2 2 time extremes as for the time extreme assessment wam and ww3 have been firstly tested against the observed values obtained processing the radar probe data from acqua alta in the same period march april and september october 2018 during which we run models in the space time extreme configuration we have thus set x 0 y 0 and d 180 s in order to switch on the computation of the maximum wave parameters that are expected in the temporal domain point statistics scatter diagrams in fig 10 represent the comparison between observed and wam values of c m forristall distribution left panel and h m naess distribution right panel error metrics of the model performance text in the panels clearly indicates that wam performs well in estimating both variables indeed the absolute bias is smaller than 3 cm and the rmsd is 0 25 m and 0 41 m for crest and wave heights respectively observed and modeled datasets are well correlated with cross correlation coefficient cc 0 90 and best fit linear slope 1 for both variables when c m 3 m and h m 5 m wam overestimates the observations although those data refer to the october 29 2018 storm which also challenged the model simulations of h s as we pointed out before in the context of forristall and naess models for extremes results presented here have similar errors as those presented by barbariol et al 2019 who performed a comprehensive study of extremes using era interim and era5 wave spectra in the pacific ocean finally ww3 and wam time extreme model scores are summarized in table 4 and show a good overall agreement between modeled and observed values of c m and h m as we have pointed out for the space time extremes the ww3 source term parameterization has a minor impact on extremes in particular those obtained setting st4 and st6 show good and almost identical statistical scores st3 results are slightly less satisfactory although with differences of a few centimetres that we do not consider as statistically relevant averaging model scores we can conclude that c m and h m are estimated respectively with absolute bias of 3 cm and 10 cm and with rmsd of 24 cm and 40 cm in the north sea surface elevation buoy data at the two stations westerland and helgoland provided an opportunity to compare the wam time extremes with an extensive dataset covering a few years model performance for h s c m and h m are summarized in table 5 on both stations wam performs well in reproducing h s with under overestimation within 5 and absolute model minus observation bias smaller than 0 08 m likewise wam extremes show similar scores with departures from observations consistent with those of h s quantitatively performance at the two north sea buoys is similar to that found at the acqua alta platform this result confirms the validity of the theoretical and model approaches that are used to estimate extremes in wam and ww3 and gives it generality in summary the evaluation of maximum wave parameters shows that model data are statistically consistent with spatio temporal stereo and temporal probe and buoy data in particular the relevant role of h s in reproducing correct maximum wave heights must be acknowledged with this in mind the following analysis focuses on wam and ww3 model results in the mediterranean sea where we proceed with the aim of disentangling the principal spectral parameters responsible for the generation of high waves within the theoretical framework adopted in this study 3 3 short term range extreme wave analysis in the mediterranean sea the advantage of having a set of wave models equipped with routines capable of providing estimates of wave maxima with high spatial temporal resolution is that predictions of their intensity can be made at large spatial and temporal scale this type of analysis would help identify the sea regions exposed with high probability to very large waves and discern the physical processes responsible for their occurrence for the analysis made in this study we have used wam and ww3 st4 results in the mediterranean sea with the following goals i the assessment of the maximum wave climate in the mediterranean sea ii the comparison between wam and ww3 st4 predictions of wave maxima at basin scale and iii the understanding of the principal processes yielding maximum crest and wave heights to pursue these objectives we used the 10 year wave hindcast dataset using the space time extreme formulations that we have applied with two strategies a first one with fixed term and range and a second one with variable term and range as we describe in the following sections 3 3 1 pattern and size of maximum crest and wave heights we aim at examining the intensity and spatial distribution of space time maximum waves crest and wave heights that can be encountered in the mediterranean sea we have adopted a fixed volume space time region with sides x 100 m y 100 m and d 1200 s hence targeting the typical horizontal footprint of an offshore platform xy 100 100 m2 and the typical wave buoy record length 20 minutes still satisfying the requirements of spatial homogeneity short range and temporal stationarity short term of the sea state the latter in particular is fulfilled since 20 minutes is a duration smaller than the timescale related to the changes in the synoptic conditions in the mediterranean sea due to its nature of semi enclosed basin previous global estimates of wave extremes barbariol et al 2019 which relied on era interim spectra at 1 and 6 hour resolution lacked the possibility of describing the complex atmospheric pattern and the maximum wave conditions in the mediterranean sea using era5 reanalysis wind forcings which are more resolved in space and time than the era interim ones we focus on the spatial distribution of the 50th the median value and 99th percentile a rare value with 1 chance of being exceeded in ten years of the two variables c m fig 11 and h m fig 12 as for the spatial variability of h s not shown here individual waves with maximum heights are triggered in regions with strongest prevailing and dominant offshore winds cavaleri and sclavo 2006 sartini et al 2017 soukissian et al 2018 which blow in the northwestern mediterranean basin near the gulf of lion and balearic sea north westerly mistral winds steadily present through the year and in the aegean sea north easterly etesian seasonal winds the typical value 50th percentile of the probability distribution of c m h m do not exceed about 1 8 m 2 8 m east of crete island and 1 6 m 2 6 m south of the gulf of lion and are as low as 0 8 m 1 2 m in the enclosed sub basins such as the adriatic sea and the tyrrenian sea surrounding the italian peninsula the rest of the mediterranean sea has a median value of c m h m smaller than 1 3 m 2 0 m we do observe large regional differences with maxima arranged in patterns following the variety of meteorological features we observe differences between wam and ww3 st4 maxima in all the areas with highest median conditions ww3 st4 overestimates wam up to 15 cm 25 cm while differences are smaller about 10 cm in the calmest sub basins the spatial variability of extreme waves for more intense storms 99th percentile is indeed different it is relevant where the mistral wind jet drives very intense sea states in the gulf of lion which experiences c m 8 m and h m 12 m whilst the rest of the mediterranean sea does not exceed about c m 5 5 m h m 8 m for the strongest sea states basin wide differences between wam and ww3 st4 are more articulated with wam overestimating ww3 st4 up to gulf of lion c m 0 5 m h m 1 0 m in the northernmost part of the sea while an underestimation of about 0 2 m is visible in the southern regions 3 3 2 extreme wave sensitivity to spectral parameters the previous analysis was conducted using a fixed volume xyd for extremes since this is the way the maximum wave evaluation was implemented in wam and ww3 this choice albeit being suitable for most practical applications dnv gl 2017 partially masks the capability of assessing the dependence of the occurrence of high waves on the characteristics of the sea state such as nonlinearity parameters or spectral spreading since the number of waves i e the sample size is as important as other factors for determining the probability of maximum crest and wave heights in linear and nonlinear wave trains mori and janssen 2006 ochi 1998 as we have made clear above in the comparison with observations in order to gain insight into the principal features of the wave field in influencing maxima the strategy that must be adopted would keep the number of waves as constant as possible and hence use for each model directional spectrum a sea state dependent space time region γ of variable volume xyd we have thus loosened the variability of the number of waves n 3d by normalizing the 3d space sides x y and d with the local and instantaneous spectral values of the mean zero crossing wavelength l x crest length l y and wave period t z respectively we have chosen the following values x l x y l y d 100t z and selected two key locations exposed to different sea states for a detailed analysis the acqua alta platform position and the grid point of coordinates 4 65 e 42 06 n just southeast of the gulf of lion we discuss the general behaviour of the pdf of maximum crest and wave heights in the wave field by showing the histograms of c m and h m normalized with h s as a function of μ and ψ respectively at the acqua alta fig 13 and the gulf of lion station fig 14 data are highly correlated and the dependencies are clear as it was expected from eqs 11 and 12 at acqua alta ww3 st4 produces sea states marginally steeper and less variable than wam which generate slightly larger 2 crest heights fig 13 left panels however differences with wam are very small 2 also when the variability of wave heights equal on average to about 1 95 with the bandwidth is taken into account fig 13 right panels normalized extreme values of c m h m from both models vary difference between 95th and 5th percentile values of 0 18 0 20 about 16 and 10 of the mean of c m and h m respectively at the gulf of lion station spectra are 10 steeper and as narrow as those at acqua alta this reflects proportionally in the values of wave maxima it is interesting that albeit the wind and wave regime at the two locations are indeed different in variety and intensity normalized maxima at the two locations have very similar distributions even though variation of extremes in the gulf of lion is smaller and values 2 on average for both extremes as well as wam and ww3 st4 not showing large differences which instead exist for non normalized extremes for which h s scales the extreme values 4 discussion and conclusions our present study opens a research direction on the extreme value prediction with spectral wave models the variables of interest are the maximum crest height and the maximum crest to trough wave height in a given sea state all parameters used in the time and space time extreme theoretical distributions have been computed from the wave energy directional spectrum s f θ or s k θ which is then the key quantity used for the evaluation as a consequence because of the phase averaging approach of spectral models only statistical quantities of extreme waves such as the mean are defined and provided in this study the wave model wam has been targeted for the new implementation in order to comply with the existing ww3 community wave modeling framework extreme wave outputs have been assessed against observations and differences between wam and ww3 results have been considered ad hoc runs have been performed to assess the principal features of the maximum wave climate in the mediterranean sea the estimate of extreme wave heights presented in this paper deals with wave conditions in short term range steady state and homogenous seas duration 1 hour extent in deep water 1 km far less in near coast areas the basic assumption is that the wave spectrum as well as the significant wave height and spectral moments are constant in a given sea state this is the way spectral models compute and process wave spectra and as a consequence the short term range statistics is the unique option for the evaluation of extremes within such a model code it may be of interest however to estimate the maximum waves in the short range but long term from hours to days when the sea severity namely h s is changing for instance during a storm including its growing and decaying phases the method to determine the long term statistics of individual maximum wave heights in a storm relies on the accumulation of the statistics for all short term stationary conditions taking into account the occurrence probability and the number of waves for each piecewise steady state sea state battjes 1972 borgman 1973 for space time extremes during storms the long term exceedance probability of c m was outlined by fedele 2012 who assumed that the sea surface elevation field is spatially homogeneous over the area a and piecewise non stationary in a time interval covering a storm using those methods the long term analysis of extreme waves can be easily achieved for instance by post processing the wave spectra at a certain location in the ocean the distribution function of maximum wave heights has been used by computing the expected value probability weighted average of maximum crest height and maximum wave height other parameters would be possible such as the standard deviation of the extremes that is included in ww3 but not in wam or the probability that the maximum wave heights exceed a given level for instance the rogue wave threshold 1 25h s for c m our choice to release the expected values is based on the consideration that it can be easily compared with the arithmetic mean from observations either from stereo systems or traditional wave probes theoretical statistics for extremes have been considered in both their temporal and spatio temporal formulations the latter allowing the description of the statistics of large wave groups crossing sea surface regions which have a practical application for instance at the air gap problem of offshore structures forristall 2011 in general due to the larger sample size of space time formulations the likelihood of extreme event is increased the choice of the space time region sides x y and d is constrained to the homogeneity and stationary conditions and it is arbitrary depending only on practical applications e g x and y may correspond to the sides of a marine structure we mention that the magnitude of extreme waves increase substantially with n 1d n 2d and n 3d during the first 30 60 minutes ochi 1998 and a few tens of meters benetazzo et al 2017b and thereafter increases slowly with time and space irrespective of sea severity it is important to note that the extreme value pdfs both time and space time lack the saturation induced by wave breaking babanin 2011 or nonlinear dispersion fedele 2014 which should modify the far tail of the pdf by restricting the wave heights fedele et al 2017 this would suggest that some of the largest waves in the pdf might be at the onset of incipient breaking or already breaking this effect is more pronounced for space time extreme theoretical models with large sample size which may overestimate maximum waves over large areas and time duration in this respect the study by benetazzo et al 2020 showed that space time estimates are reliable over surface areas with a side o 102 m for all sea states and time interval shorter than one hour formulae for space time extreme wave estimates depend on sea state parameters that are obtained from higher order moments of the directional spectrum as pointed out by stopa et al 2016 and liu et al 2019 wave models may have difficulty in describing the directional properties of wave spectra and differences exist among the ww3 source term parameterizations as far as the wave spectrum moments are concerned by comparing modeled space time extremes against stereo observations we have shown however that model performances and differences between models mostly stem from the accurate simulation of the significant wave height h s which represents the leading scale factor for maximum waves we note also that models relative performance is better for extremes than for h s the reason for that is that the underestimation overestimation of h s implies a larger smaller number of waves i e the sample size over a fixed duration region which in turn gives rise to higher smaller maximum heights compared to h s with the wamax routine implementation both wam and ww3 are equipped with procedures to compute maximum waves parameters though with some differences between models as shown in table 6 in particular in ww3 the nonlinear formulation for the time x 0 and y 0 and space time x 0 and y 0 crest height is based on the tayfun model only while in wam the nonlinear crest height for time extremes is computed also using the forristall model moreover we choose to produce time extremes in wam forristall and naess models also when setting x 0 and y 0 this option is not available for ww3 where a strict and distinct set of variables is computed for time and space time extremes in this sense wam allows additional time extreme outputs to be computed compared to ww3 whereas the space time extreme implementation is based on identical formulations some differences between wam and ww3 concern also the numerical implementation and its optimization finally the capability of assessing modeled extremes is based on the capacity of processing observed data with ad hoc strategies strictly speaking the model response requires continuous time or space time elevation records at high temporal and spatial resolution to be processed to isolate independent high wave trains such series of data are rarely available see for instance https cdip ucsd edu m and this limits the possibility of extensive model output assessment though spotty validations can still be carried out as was established in this study to summarize some of the key achievements and findings of our study wam code was upgraded to generate outputs of maximum crest and wave heights both in time and in space time theoretical formulations were based on second order nonlinear models for crest height and linear model for crest to trough wave heights we relied on the existing ww3 implementation for extremes tests at the global scale with the extreme wave routines implemented on wam are in progress on a research version of ecwam comparison with observations showed that theories used for extremes provide good model performance provided that the wave model and its forcings have sufficient accuracy to properly reproduce the total energy say h s of the sea states we observed differences between extreme wave outputs from wam and ww3 and for the latter we documented the sensitivity of extremes on the three source term configurations st3 st4 and st6 we noted that the differences mainly concern the value of h s while the variability of other parameters such as the steepness the bandwidth or the directional properties of wave spectra seems to have a smaller effect on extremes main features of the maximum wave climate in the mediterranean sea have been highlighted although limited to a 10 year period 2001 2010 the analysis disclosed the magnitude of maximum waves and helped reveal the relevant process concurring in generating high waves during marine storms because of its importance for marine safety a better understanding of wave extremes is critical for a variety of applications there is a consensus that high quality predictions of extreme events caused by storms could substantially contribute to avoiding or minimizing human and material damages and losses therefore reliable wave forecasts together with long term statistics of extreme conditions are of utmost importance for marine areas this works strengthens the capability of spectral wave models to be a powerful tool for studying the intensity and geographical distribution of extreme waves more work is needed to determine how the proposed approach apply to a variety of sea conditions that have not been focused in this study such as the oceanic swells or the strongly forced wind wave conditions for instance hurricanes and typhoons future measurements and numerical experiments will be valuable to further test the models performance credit authorship contribution statement alvise benetazzo conceptualization methodology formal analysis supervision writing original draft project administration funding acquisition francesco barbariol methodology formal analysis software investigation funding acquisition paolo pezzutto software investigation funding acquisition joanna staneva and arno behrens software investigation silvio davison and filippo bergamasco formal analysis mauro sclavo and luigi cavaleri resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been carried out as part of the copernicus marine environment monitoring service cmems latemar project https www mercator ocean fr en portfolio latemar cmems is implemented by mercator ocean in the framework of a delegation agreement with the european union dr tiziana paccagnella and dr andrea valentini from the regional agency arpae simc italy are tanked for providing cosmo i2 wind data we are grateful to dr mauro bastianini cnr ismar for his work on the acqua alta platform and to dr jean bidlot ecmwf for useful discussions on wave model source terms joanna staneva and arno behrens acknowledge the funding by initiative and networking fund of the helmholtz association through the project advanced earth system modelling capacity esm and cliccs center of excellence project appendix a changes in the wam source file code new subroutine wamax the new wam code that includes the wamax routine was tested debugged and transferred to the code maintainer helmholtz zentrum geesthacht hzg contact persons dr joanna staneva and dr arno behrens main changes in the wam source file code are described in table a 1 table a 1 summary of the wam source code changes made to implement the wamax routine for the computation of the extreme wave parameters maximum crest height and crest to trough maximum wave height table a 1 source file purpose changes chief read wam user f90 reads user options from input file wam user wamax user options reader mod wam interface module f90 procedures used in wam to compute parameters from spectra and to interpolate spectra added subroutine wamax which computes o cmax f time maximum crest height forristall o hmax n time maximum wave height naess o cmax st space time maximum crest height stqd o hmax st space time maximum wave stqd given o f block of spectra o depth depth o thmax peak direction mod wam output parameter module f90 output parameter names and scales for printing extended output to include the four wamax output variables mod wam output set up module f90 output times and flags added a subroutine set wammax options mod wam print user module f90 prints set up options modified number of output variables mod wam user module f90 default settings adapted for wamax user options print wam netcdf module f90 creates netcdf files from binary format adapted to include wamax outputs 
21228,reliable predictions of oceanic waves during storms have always been foremost for offshore design and operation coastal hazards and navigation safety indeed many accidents that occurred during storms were ascribed to the impact with unforeseen large waves in this context the purpose of this study is to improve the present state extreme wave estimate from spectral wave models we describe an implementation for the wam model and we investigate the use of wam and wavewatch iii fed with common routines designed to evaluate the short term range maximum wave statistics an extensive assessment of models results in the adriatic and north sea is performed using time and space time wave measurements and through an intercomparison between wam and wavewatch iii applied with three different input dissipation source term parametrizations st3 4 6 further models capabilities are investigated and extreme waves characterized in the mediterranean sea aiming also at disentangling the wave spectrum bulk parameters that may point to favorable conditions for the generation of high waves based on the comparisons between model results and measurements we conclude that for the model characterization of extremes the accuracy of the significant wave height is pivotal differences between models of other spectral parameters seem to have a minor effect keywords sea wave extremes maximum crest and wave heights wam wavewatch iii stereo imaging mediterranean sea north sea 1 introduction the characterization of extreme waves during marine storms has been an active topic of research for decades because of its importance for shipping offshore design and operations and coastal hazards theoretical progress has been fast but it has not been accompanied by an improvement of numerical predictions and of field measurement strategies significant efforts are being undertaken to better understand the occurrence and magnitude of extreme waves including rogue waves benetazzo et al 2017a cavaleri et al 2012 2016 dematteis et al 2019 donelan and magnusson 2017 dysthe et al 2008 fedele et al 2017 gemmrich and garrett 2011 janssen 2003 onorato et al 2001 2013 slunyaev et al 2005 toffoli et al 2005 waseda et al 2011 but modeling strategies resulted ineffective in warning seafarers or avoiding structural damage to offshore facilities see e g bitner gregersen and gramstad 2015 fedele et al 2017 although there are different theoretical approaches to tackle the extreme and rogue wave problem kharif et al 2009 what mainly limited their high resolution characterization at large spatial and temporal scales is the lack of widespread modeling tools and standardized observational data from a wave model point of view the extreme value problem can in principle be addressed by numerically solving in detail the complete fluid mechanics equations describing the sea surface elevation field mei 1983 this direct approach has a high computational cost and requires accurate initial conditions that are generally not easy to achieve it is generally limited to simulations of small space and time scales a hundred wavelengths or periods typical for instance of coastal surf zones or laboratory conditions still recent efforts using high order spectral simulations of the euler equations for directional sea states dommermuth and yue 1987 proved to be a powerful tool for investigating the oceanic rogue wave behaviour focusing however on individual rogue wave events e g fedele et al 2016 in this paper this deterministic approach and any model examination of wave by wave heights are set aside and we look instead at the statistical properties of the wave field these are customarily described by the directional wave energy spectrum which is the variable integrated by the phase averaged wave models solving the wave energy balance equation gelci et al 1957 this approach is based on a spectral decomposition of the sea surface elevation variance across frequencies or wavenumbers and directions while wave phases are not resolved phase averaged spectral wave models are the primary objects of our study the focus is on wam janssen 2008 komen et al 1994 and wavewatch iii hereinafter ww3 tolman and ww3dg 2014 which are the two most widely used open source community spectral wave models applied to forecast and hindcast studies spectral wave models provide an essential part of marine weather analysis and made significant improvements in simulating wave spectrum bulk parameters such as the significant wave height the peak period and the zero crossing mean wave period see e g http www ecmwf int en forecasts charts this means that model parameterizations describe the air sea interaction processes reasonably well little information on the other hand is known about their performance with focus on extremes namely the maximum wave and crest heights in this respect the motivation for the present model development arises from the extreme wave analysis that was implemented by janssen and bidlot 2009 in the european centre for medium range weather forecasts ecmwf version of the wam model called ecwam in ecwam the distribution of extremes is based on the mori and janssen 2006 formulation for the wave envelope height and is used to estimate the expected value of the maximum envelope height over a three hour duration there are no other operational forecasting centers that release maximum wave products on a regional or oceanic scale however information on the maximum wave heights are required by users and the offshore industry for the definition of the environmental loads over the lifetime of a ship or structure dnv gl 2017 but the common strategy used so far has been based on the off line processing of model spectra to derive meaningful parameters at certain sea locations to define extreme wave features and their spatial temporal variability ww3 was equipped with on line routines for maximum waves barbariol et al 2017 and the simulating waves nearshore swan spectral model booij et al 1999 was developed with the same purpose barbariol et al 2015 sclavo et al 2015 in this study an implementation for extreme wave computation has been developed for the calculation in wam cycle 4 5 4 or later versions https github com mywave wam of the maximum crest height i e the maximum surface elevation and the maximum crest to trough wave height i e the maximum vertical distance between a crest and the closest trough for each sea state these two variables complement the envelope height released by ecmwf and at the same time are consistent with the standard outputs of wave analysis e g obtained via zero crossing holthuijsen 2007 this study concentrates on documenting the code modification and its optimization for operational purposes the goal is to upgrade wam and to endow it with the same extreme wave outputs as ww3 this allows the assessment of their relative performance with focus on extremes and documenting how well they compare against observations to this end sea surface elevation records from two wave buoys and one wave probe are used in this study to establish differences between models these temporal records are complemented with stereo video data that are used to analyze maxima of space time wave trains we also discuss the way field observations ought to be managed so as to provide meaningful extreme wave information that may prove useful for model validation further we point out that since extreme wave statistics depend on the higher order spectral moments the assessment of maximum waves is an indirect way to test how well models reproduce the shape of the directional wave spectrum the combined use of wam and ww3 is used in this study to provide for the first time a characterization of the magnitude and spatial variability of extreme waves one can encounter in the mediterranean sea the atmospheric and wave pattern in this basin is rather complex with strong offshore winds such as the mistral in the western mediterranean region the etesian or meltem in the aegean sea and the bora and sirocco in the adriatic sea in the innermost areas the wave growth is limited by the available fetch the mediterranean sea is also exposed to site specific storm events called medicanes mediterranean hurricanes that are tropical like cyclones with winds well exceeding 100 km h additionally this basin is among the world s busiest waterways hence information about the intensity and distribution of maximum wave heights is crucial there are many reports on very large waves hitting ships for instance the louis majesty accident that caused two fatalities cavaleri et al 2012 while en route from barcelona to genoa or the jean nicoli ferry accident in 2017 that en route from ajaccio to marseille was hit by what was considered a rogue wave so far however the wave climate characterization has been limited to the extremes of the significant wave height sartini et al 2017 while it lacks any information on the maximum waves which are instead considered in this study this manuscript will proceed as follows section 2 is dedicated to explaining the theoretical formulations implemented in wam for the estimate of maximum crest and wave heights the theories are presented for temporal short term extremes and spatio temporal short term range extremes in the same section the observations of time extreme and space time extreme waves and the wam and ww3 setups in the adriatic mediterranean and north sea are described section 3 presents details of the wam implementation and assessment of model outputs against observations collected in the adriatic and north seas a model analysis of extreme waves in the mediterranean sea completes the section a discussion and summary of the main conclusions of the study are presented in section 4 2 materials and methods 2 1 short term range extreme value statistics in this section we are going to describe theories that are adopted for the estimation of extreme wave events in wam technical details of this implementation are given afterwards in section 3 1 while here we focus on the theoretical aspects and present key formulae the equivalent ww3 implementation was extensively described in a previous study barbariol et al 2017 so only what it is necessary to make a straight comparison with wam and with newly collected observations will be recalled in the present work the basic concept supporting the extreme value analysis is the steady state sea condition and the derived statistics is referred to as short term time interval from minutes to 1 hour or so later in this section we shall include the condition of homogeneity of the wave field and the joined short term range derived statistics in this context it is therefore necessary to motivate the two approaches we have adopted for extreme wave evaluation indeed till recently researchers have concentrated on the probability of extreme events from a given sea surface elevation η t time series i e point statistics in the temporal domain t at a fixed point x 0 x 0 y 0 in space being the two cartesian horizontal x and y axes lying on the still water surface in this context starting from the rayleigh distribution valid for linear wave trains with a narrow spectrum longuet higgins 1952 it has been established that nonlinear effects like second order bound waves and four wave interactions may have a profound impact on the statistics of extreme events fedele and tayfun 2009 janssen 2003 mori and janssen 2006 waseda et al 2011 also including nonlinearities however in the point statistics very high and even rogue waves remain very unlikely christou and ewans 2014 gemmrich and thomson 2017 magnusson et al 1999 a development of these models is due to advances started by adler 1981 and piterbarg 1996 who studied the extreme value problem in multi dimensional manifolds and introduced the concept of excursion probability for oceanic waves crossing a 2d sea surface region being the surface elevation η x y t the variable of interest the problem was reduced to three dimensions fedele 2012 fedele et al 2013 krogstad et al 2004 two in space x and y and one in time t in the 3d spatio temporal domain x y t the number of extreme events is larger than what could be expected in the 1d temporal domain t regardless the sample size benetazzo et al 2015 this achievement was used to explain the high likelihood of rogue waves when extreme events are studied in a 3d spatio temporal region benetazzo et al 2017a so that the very notion of rogue wave in stormy seas was questioned cavaleri et al 2016 for consistency in the degenerated case of null space e g in long crested sea states for which the areal effects become negligible the spatio temporal statistics coincides with the temporal one having said this and in line with the ww3 extreme wave implementation ww3dg 2019 for wam we have chosen to estimate two variables for a given sea state the expected value or expectation of the random variable maximum crest height c m and the expected value of the random variable maximum crest to trough wave height h m both variables are specified in the 1d temporal domain hereinafter time extremes and in the 3d spatio temporal domain hereinafter space time extremes 2 1 1 time extreme waves in this study to approximate the actual distribution function of c m at a fixed point x 0 on the sea surface we considered two time extreme statistical models of the wave elevation η t η x 0 t that include the effects of second order bound nonlinear modes longuet higgins 1963 the nonlinear effects on the geometry of ocean waves is to display higher and sharper crests a feature predicted by the gram charlier solution of longuet higgins we then rely on the dispersive focusing of second order non resonant harmonic waves as the leading physical mechanism for large wave formation this mechanism proved to suffice to explain most of the real oceanic large and rogue wave behaviour benetazzo et al 2015 fedele et al 2016 still limiting from a numerical model point of view the computational burden that is required to assess extremes with higher order corrections to the linear first order representation janssen 2017 we have hence not considered the role of four wave nonlinear interactions and any effect such as the modulation instability for narrow band wave packets in deep water janssen 2003 mori and janssen 2006 onorato et al 2013 still those higher order nonlinearities are considered via the kurtosis of the surface elevation probability density functions pdf in the freak wave warning system that is included in the wave model ecwam ecmwf 2019 however granted that difference in the order of nonlinearities and the choice of defining in ecwam the wave height as twice the envelope the ecwam theoretical approach for extremes and the methods used in ww3 implementation and here adopted for wam proved to have similar statistical scores when compared against open sea estimates of average values of maxima barbariol et al 2019 this suggests that four wave nonlinear interactions may have a minor effect on expected extreme waves occurring in directionally spread stormy seas as it was also proposed in other studies fedele et al 2016 2019 the first model we shall consider for c m is based upon the tayfun 1980 nonlinear formulation and it will be detailed further as a particular case i e null xy space of the space time extremes section 2 1 2 the second nonlinear model taken into consideration relies on the forristall 2000 exceedance distribution of the individual crest heights c in a record for an elevation threshold h and a sea state with significant wave height h s the forristall distribution prfo is expressed by a weibull like function given by 1 pr fo c h exp h α f h s β f where α f h s 0 is the scale parameter and β f 0 is the shape parameter of the distribution the effects of second order bound nonlinearities are included as a function of the water depth d and the wave spectrum via the steepness parameter s 2 π h s g t 1 2 1 and the ursell number u h s k 1 2 d 3 1 which both contribute to the values of α f and β f as follows 2 α f 0 3536 0 2568 s 0 0800 u β f 2 1 7912 s 0 5302 u 0 284 u 2 here g is the gravitational acceleration t 1 is the mean wave period calculated from the ratio of the first two moments of the frequency spectrum and k 1 is the deep water mean wavenumber for a frequency t 1 1 forristall obtained α f and β f by empirical fitting using simulations of short crested nonlinear waves typical of stormy sea states following gumbel 1958 the distribution of extremes can be written down as a function of the initial distribution and of the sample size n accordingly the probability that the maximum crest height c m in a sea state of duration d from minutes to a few hours and holding n waves on average is more than h can be expressed as follows 3 pr c m h d 1 1 pr fo n the previous formula for large values of h and n is fairly well approximated by a double exponential gumbel type distribution of crest heights this allows computing the expected value indicated with an overbar of the maximum crest height at a fixed point in the following form 4 c m 4 σ α f ln n 1 β f 1 γ β f ln n being γ 0 5772 the euler mascheroni constant and σ 2 the sea surface elevation variance the average number of waves is computed as n d t z 1 where and t z is the average zero crossing wave period the value of c m in eq 4 as well as the extremal values defined below increases with the sample size the time extreme model for the maximum crest to trough height h m is based on the naess 1985 theory of crest to trough heights h that generalizes the rayleigh distribution to account for the spectral bandwidth effects on the wave heights as follows 5 pr na h h exp 1 4 1 ψ h σ 2 where ψ 1 0 is a bandwidth parameter to be defined in section 3 1 which in typical wind sea conditions assumes values in the 0 75 0 65 range and it is a function according to naess of the dominant wave period the inclusion of the parameter ψ decreases the probability levels with respect to rayleigh for which ψ 1 since the bandwidth of the spectral density function approaches zero which hence represents an upper bound for the wave height probabilities the choice of a linear model for individual wave heights was dictated by two factors the effect on h of second order nonlinearities is small a few percent much smaller than that on crest heights tayfun and fedele 2007 and the requirement of limiting the computational effort needed to model higher order wave heights we shall verify this assumption later on in the paper by comparing model and observed extremes the extreme value exceedance distribution of the maximum wave height h m in a sea state with an average number n of waves can be expressed as follows 6 pr h m h d 1 1 pr na n for large values of h and n the gumbel type approximation provides the expected value of the maximum wave height at a fixed point that is 7 h m 2 σ 1 ψ ln n 1 2 1 γ 2 ln n the same result for h m can be obtained in a similar manner by means of the quasi determinism asymptotic theory boccotti 2000 that assumes a scale relationship between the shape of the highest waves and the expected value of the maximum crest height boccotti theory will be used in this study to characterize the value and the meaning of ψ for a given wave model spectrum 2 1 2 space time extreme waves when the domain of interest for extremes includes a 2d sea surface region i e the physical xy space crossed by wave trains the extreme value statistics incorporates the condition of short range homogeneous sea state which is the analogous condition for random variables that are ordered in space instead of time therefore if the averages and the variances of the variables are constant in time and space the process is called weakly stationary and homogeneous and the derived extreme statistics is defined as space time the so called space time extremes are here theoretically approached within the framework of the space time quasi determinism theory benetazzo et al 2015 2017b boccotti 2000 fedele 2012 accordingly the excursion probability pr of second order nonlinear maximum crest heights c m exceeding a large elevation threshold h over a 2d sea surface region with sides x and y and area a x y and a 1d time interval of duration d is expressed as follows benetazzo et al 2015 8 pr c m h d a n 3 h 0 2 σ 2 1 n 2 h 0 σ n 1 exp h 0 2 2 σ 2 where 9 h 0 σ 1 1 2 μ h σ 1 μ 1 is the tayfun formula that relates the linear h 0 and the second order nonlinear h crest heights via the steepness parameter μ see section 3 1 1 for its characterization in this respect fedele et al 2016 confirmed that in the space time extreme models the second order nonlinearities cannot be neglected while it is expected a modest contribution from the third order nonlinearities the exceedance probability in eq 8 is the sum of three terms fedele 2012 i the probability proportional to the number of waves n 3 that the threshold is exceeded within the space time region γ of 3d volume v xyd ii the probability proportional to the number of waves n 2 that the threshold is exceeded on the 2d faces of γ and iii the probability proportional to the number of waves n 1 that the threshold is exceeded on the 1d edges of γ in analogy with time extreme models in space and time the average numbers of 3d 2d and 1d waves are computed including the region sides and characteristic wavelengths and period in particular we have 10 n 3 d n 3 2 π x y d l x l y t z 1 α x t 2 α x y 2 α y t 2 2 α x t α x y α y t n 2 d n 2 2 π x d l x t z 1 α x t 2 y d l y t z 1 α y t 2 x y l x l y 1 α x y 2 n 1 d n 1 x l x y l y d t z the term x l x y l y d t z in the formula for n 3d represents the average number of 3d waves with mean wave length l x and mean crest length l y crossing the cuboid region γ assuming that the sea surface is confused with no organized movement of waves in that case the covariance matrix of sea surface elevation gradients is diagonal meaning that the space time surface elevation gradients are linearly uncorrelated which is consistent with them being independent baxevani and rychlik 2004 the degree of organization of the 3d wave motion is expressed by the additional term 1 α x t 2 α x y 2 α y t 2 2 α x t α x y α y t that becomes equal to zero in the limit of directionally narrow sea for which then n 3 d 0 see section 3 1 1 for the spectral definition of the parameters α xt α xy and α yt for large values of the crest height the excursion probability can be approximated with a gumbel type distribution from which we determine the expected value of the maximum crest height in space and time space time extreme as follows 11 c m ξ 0 μ 2 ξ 0 2 σ σ γ 1 μ ξ 0 σ 1 ξ 0 σ 1 2 n 3 ξ 0 σ 1 n 2 n 3 ξ 0 2 σ 2 n 2 ξ 0 σ 1 n 1 1 in eq 11 ξ 0 σ 1 is the normalized mode of the pdf of linear space time extremes fedele et al 2012 as a particular case assuming x 0 and y 0 the number of waves n 3 d and n 2 d vanish while n 1 d t z and eq 11 provides the prediction based on the tayfun 1980 model which is then incorporated in the wam and ww3 implementations of time extremes as particular case of space time extremes finally maximum crest to trough wave heights h m over a space time region are estimated by means of the quasi determinism theory boccotti 2000 which establishes a relationship via the surface elevation autocovariance function between the expected maximum crest and crest to trough wave heights in the context of the deterministic behaviour of the largest waves letting μ 0 in eq 11 and hence assessing the linear part of c m the space time extreme value of h m is computed as follows 12 h m ξ 0 σ γ ξ 0 σ 1 2 n 3 ξ 0 σ 1 n 2 n 3 ξ 0 2 σ 2 n 2 ξ 0 σ 1 n 1 1 2 1 ψ to complete this section it is worth clarifying the meaning of the sea surface area a with orthogonal sides of length x and y that are used for space time extremes we start by assuming the ergodicity of the random wave process such that the elevation probability density function over the 2d space give the same results as over an ensemble of realizations however the space must satisfy the requirement that statistical properties such as moments of the distribution are invariant under translation of coordinates this condition of homogeneity is preserved if the sea surface area is small enough that the wave spectrum and its moments do not change within it the short range condition is satisfied by keeping both x and y range within o 102 m plainly depending also on the spatial variability of external forcing and other wave related processes for numerical models the area a is supposed to be drawn around each grid node where the wave spectrum is firmly defined at each time step as a consequence x and y should be approximately smaller than the usual model grid size through which spectral properties are expected to change 2 2 time and space time extreme wave observations the assessment of the theoretical formulations aimed at predicting the short term range distribution of maximum wave parameters is a challenging task indeed for a given sea state the maximum heights in time and space time wave trains are randomly distributed and cannot be deterministically predicted but only statistically characterized by their pdf therefore nothing can be said about the worthiness of a theoretical model for extremes just having for instance from a record η t of given duration δ say 20 minutes for wave buoys only one realization of the random variable h m max h t δ or c m max c t δ a set of independent realizations of c m and h m must be produced so as to simulate the stochastic process and to provide an assessment of the theoretical formulations for fixed point oceanic wave observations this requires that within a time interval δ where η t can be assumed stationary in a statistical sense the elevation series is split into independent wave records say n of equal duration d δ n where maxima are gauged benetazzo et al 2018 the samples of the random variables c mi and h mi with i 1 2 n have an empirical distribution function of which we can compute the sample means defined as 13 c m obs c mi h m obs h mi to be then compared with the theoretical predictions c m and h m respectively as a corollary because of the inherent randomness of the process very little can be said about the relationship between the sea state characteristics and the likelihood or intensity of wave maxima taking only one observation h mi or c mi unless the pdf of maximum heights is fairly narrow all this said a strict requirement for model assessment is that the observed sea surface elevation series such as η t is logged and made available for processing this data is rarely available which implies that modeled extremes can only be assessed for short time periods and on a few sparse places requesting that in general ad hoc experiments with dedicated technology must be planned see e g filipot et al 2019 to be compared with modeled results dedicated in situ observations of maximum waves from one adriatic sea and two north sea stations were taken into account in this study in the adriatic sea instruments were mounted on the acqua alta oceanographic platform longitude 12 51 e latitude 45 31 n 15 km off the venice coast italy although the adriatic sea is on average a calm sea the acqua alta platform is a favorable site for wave observations during storms since it is exposed to a variety of directional sea states cavaleri 1999 spanning short fetched northeasterly wave conditions generated by bora winds well developed southeasterly wave conditions generated by sirocco winds and occasionally southeasterly swells crossing northeasterly wind waves since our purpose is to assess both time and space time extreme model predictions two distinct datasets of observed waves are considered the first one includes space time elevation data η x y t gathered with a stereo imaging system while the second one contains time data η t collected with a vertical looking point like wave radar model vegapuls 42 that sampled the surface elevation at 2 hz with accuracy of 0 05 and 1 mm resolution it is worth reminding that acqua alta was the test site for previous experiments dedicated to the observation and modeling of the largest waves during storms benetazzo et al 2015 2017a including the test used to assess the ww3 implementation for extremes barbariol et al 2017 as mentioned before for space time extreme assessment we have used a stereo wave imaging system based on the technology of wass wave acquisition stereo system benetazzo et al 2012 bergamasco et al 2017 that allows to observe 3d wave fields while they evolve on the space time domain the wass setup at acqua alta is similar to that adopted in previous applications benetazzo et al 2012 leckler et al 2015 and it used a pair of 5 mpixel digital cameras 2456 columns by 2048 rows array of 3 45 μm square active elements mounting 5 mm distortion less lenses and placed 3 23 m apart and 14 5 m above the mean sea level the cameras internal parameters were estimated using the bouguet s matlab calibration toolbox http www vision caltech edu bouguetj calib doc whereas the spatial configuration of cameras i e the extrinsic parameters was computed using an auto calibration approach based on the photometric consistency between stereo images bergamasco et al 2017 with the device calibrated each image pair acquired was stereo rectified and processed by a modified version bergamasco et al 2017 of the dense stereo algorithm proposed by hirschmüller 2008 available in the opencv library http opencv org by bradski and kaehler 2008 the semi global nature of the approach has the great advantage that it can relate the photometric consistency of several matching pixels to improve the reliability of the disparity map especially for areas with loosely distinctive features as a consequence we can keep a relatively small window size 13 13 pixels while still obtaining a precise localization of the matches a discussion of the errors associated with the wass measurements is reported in the study of benetazzo et al 2012 from which we recall the mean absolute quantization error of the adopted wass setup which is in the order of 3 cm along the three orthogonal directions for each image pair output of the stereo process is a cloud of 3d points of the sea surface field for each point cloud after being transformed to a common earth reference frame benetazzo 2006 a patch wise planar surface was constructed by means of 2d delaunay triangulation over the xy space then the wave elevations η were resampled over a regular xy grid fig 1 at a resolution of 0 3 m to span the space x 65 m 65 m and y 20 m 100 m to limit the influence of high frequency noise time series η t taken at each xy position of the space time wave burst η x y t were low pass filtered at 1 2 hz thus removing from the field the spectral components shorter than about 1 m for each burst the standard deviation σ has been estimated from the second order moments of the surface displacement η x y t probability density function as follows 14 σ η x y t η x y t 2 1 2 and by definition the observed significant wave height was taken as h s 4σ for the investigation of the model capability to estimate space time maximum wave parameters we have focused on metocean conditions that include wind sea dominant ne bora and se sirocco winds and one case of se swell for a total of eight bursts that were collected during the stormy periods march april and september october 2018 table 1 we have then considered the maximum waves within the eight space time elevation records η x y t to this end we have followed the same approach as adopted by benetazzo et al 2015 and benetazzo et al 2018 and we have split the entire time interval δ in adjacent and non overlapping space time subrecords here we choose space time regions γ i of equal square area a xy 30 m 30 m and duration d 180 s in order to yield a set of independent observations of the random variables maximum crest and wave heights for each γ i the former is defined as follows 15 c m i max η x y t x y t γ i while the individual maximum wave height h mi for x y t γ i was calculated via zero crossing analysis of each time series of duration d defined in the sampled xy space the statistical independence of these realizations was verified by checking that maxima did not belong to the same 3d wave group a similar strategy and same time interval were used to extract the time extreme statistics using point wise radar data collected in the adriatic sea in that case the continuous time series of surface elevations η t has been divided in consecutive time intervals δ 3600 s each of them split in d 180 s long non overlapping records r i 20 time per hour then for the ith record r i we defined the maximum crest height as follows 16 c m i max η t t r i and accordingly h mi was computed by adopting a zero crossing analysis within each interval this analysis produced a sample at hourly intervals of 20 individual values of c mi and h mi whose averages c mi and h mi were compared with model predictions centered at the same hour observed extremes have been up scaled to account for the underestimation of wave height statistics due to the sampling rate tayfun 1993 correction factors depend on the sampling interval and mean wave period they vary in the range 1 00 1 08 with most probable values around 1 03 the histogram of observed values is shown in fig 2 mean and maximum values for c mi and h mi are respectively 0 85 m and 1 59 m and 4 34 m and 6 88 m to complement adriatic sea data in the north sea raw sea surface elevation data η t were collected by two datawell directional waverider buoys moored at the stations westerland 8 13 18 12 e 54 55 01 92 n depth 13 3 m years spanning 2013 2017 and helgoland 7 52 04 80 e 54 09 36 00 n depth 15 7 m years spanning 2011 2017 in order to obtain empirical estimates of c m and h m we averaged twelve values of maximum crest height c mi and crest to trough height h mi from zero crossing analysis that were obtained by splitting the 30 minute records into two equally long bursts d 900 s and then assuming a stationary sea state for a duration of 3 hours the tayfun correction factors due to the buoy sampling rate is within the range 1 0 1 1 with most probable values around 1 05 histograms of the observed maximum wave parameters from the two buoys are shown in fig 3 results highlight the different characteristics of the wave climate at the two stations in the north sea in particular the helgoland station displays wave extremes that are around 20 on average and 50 at most higher than those at the westerland station 2 3 wave modeling wam and ww3 setups and forcings wave model datasets have been based on wam cycle 6 http mywave github io wam and ww3 version 6 07 https polar ncep noaa gov waves wavewatch both models integrate the spectral wave action equation in space and time with discretized wavenumbers or frequencies and directions and balance conservative wave processes by the non conservative sources and sinks for the purposes of the study wam and ww3 were set up in the adriatic sea and mediterranean sea sharing the same domains and computational grids whilst in the north sea only wam runs were taken into account models were prepared on the one hand to assess the models capability of reproducing the maximum wave statistics derived from the adriatic sea time and space time extreme data and north sea time extreme data observations and on the other hand to make a wam versus ww3 comparison and a climate assessment of the maximum waves in the mediterranean sea at first to evaluate the extreme wave predictions at the position of the acqua alta platform section 3 2 wam and ww3 used a model grid covering the adriatic sea and ionian sea the southern boundary is placed along the 39th parallel north where no wave forcing was imposed with 0 05 uniform resolution in longitude and latitude and a spectral grid composed of 36 evenly spaced directions and 32 frequencies exponentially spaced from 0 0500 to 0 9597 hz at an increment of 10 in wam the wind wave interaction source term is based on the wave growth theory of miles 1957 that was applied to wave forecasting by janssen 1991 in our study wind input dissipation source terms st were switched to the bidlot et al 2005 configuration with parameters chosen to match the operational ecwam contained in the forecasting system of ecmwf since version cy38r1 ecmwf 2012 dissipation owing to bottom friction is taken from the jonswap parameterization hasselmann et al 1973 with friction coefficient equal to 0 038 m2s 3 default in wam and ecwam ww3 based adriatic sea runs were implemented setting three alternative st parameterizations namely st3 st4 and st6 ww3dg 2019 they describe the wind input wave dissipation due to whitecapping and swell dissipation differently with the nonlinear four wave interactions the same for all st setups those are the main processes in deep water conditions the objective is to focus on the st performance especially on the predictions of maximum waves the st3 parameterization hereinafter ww3 st3 follows ecmwf 2012 to make the source term implementation as close as possible to the one in the wam model the st4 setup hereinafter ww3 st4 is described by ardhuin et al 2010 and as it was originally implemented it allows a set of parameters to be defined by the user we focused on two of them namely β max and z 0 max that were accordingly modified using three different combinations i ww3 default parameters of test471 ii parameters of test405 of ardhuin et al 2010 iii parameters of test471 but setting β max 1 55 and z 0 max 0 002 as in test405 which was thought to perform well for younger seas from our tests the last setup provided the best performance not shown here compared with observations of h s at acqua alta and least scatter with respect to wam and ww3 st3 outputs and it was then used for all st4 based implementations of this study finally st6 hereinafter ww3 st6 package for parameterizations of wind input wave breaking and swell dissipation terms was set using the default configuration babanin et al 2010 liu et al 2019 rogers et al 2012 ww3dg 2019 zieger et al 2015 for all three above mentioned ww3 setups as for wam the bottom friction was switched to the jonswap formulation with default value of 0 067 m2s 3 for the friction coefficient this definition is different from the standard in wam further numerical schemes for wam first order upwind and ww3 third order with garden sprinkler effect alleviation were kept as default although different numerics may lead to different results ecmwf 2019 we have chosen to test and intercompare the models in their standard configuration for wave action equation solution aware that differences in model results might be partially due to numerics the purpose of testing three physical formulations in ww3 is to make an analysis albeit preliminary of their relative performances with focus on the estimation of extremes and related spectral parameters and to verify on the one hand if the ww3 behaviour compared to wam is influenced by the source terms which on the other hand would be an unimportant factor for wave extremes obviously excluding the correct computation of h s in this respect stopa et al 2016 made a thorough comparison of the three source term parameterizations they concluded that st3 is a good predictor of h s and higher order moments of the wave spectrum and can be used under the majority of wave conditions for all sea states st4 has minimal h s biases and the higher order wave parameters perform reasonably well st6 performs similarly to st4 with major differences in the higher order wave parameters and low wave heights a recent re calibration of st6 improved its performance and it was made available in ww3 since version 6 07 liu et al 2019 however differences between st4 and st6 still remain with respect to the directionality of the wave field in the adriatic sea runs wam and ww3 were forced with high resolution 10 m height wind fields produced by the cosmo i2 forecasting local model the cosmo i2 model is run operationally at the regional environmental agency arpa simc of the emilia romagna region italy twice a day at 00 utc and 12 utc producing hourly wind fields with horizontal spatial resolution of 0 025 0 025 cosmo i2 winds performed reasonably well in the area of interest fig 4 at the 95th percentile level the model minus observation bias is 0 2 m s left panel while wind model results are less accurate for rarer events fig 4 depicts on the right panel a time series comparison between modeled and observed wind speeds during the sirocco storms of the 28 29 october 2018 there is good agreement between the two data being the cross correlation coefficient cc 0 85 the root mean square difference rmsd 2 48 m s and the slope of the best fit line between modeled and observed winds p 1 03 the mediterranean sea wave model setup covers the whole basin with 0 05 uniform resolution in longitude and latitude and with a spectral grid composed of 36 evenly spaced directions and 32 frequencies exponentially spaced from 0 0500 to 0 9597 hz at an increment of 10 wam was run with the same setup as for the adriatic sea implementation while ww3 was formulated using the st4 source term configuration with input parameters as in the adriatic sea run i e st4 default value configuration but with adjusted coefficients β max 1 55 and z 0 max 0 002 wave models were forced with hourly winds from the ecmwf reanalysis era5 https confluence ecmwf int display ckb era5 3a data documentation that were downloaded at the nominal resolution of 0 25 the native era5 resolution is 0 28125 simulations spanned 10 years from 01 january 2001 to 31 december 2010 despite partially lacking the high resolution recommended for the wind forcing in closed and semi enclosed sea areas cavaleri and bertotti 2004 the worthiness of the era5 forcing wind field in the mediterranean sea was demonstrated taking advantage of the derived measurements of u 10 from the envisat 1 satellite altimeter for the period 2002 2010 which partially spans the numerical simulations period typical error metrics of the era5 performance clearly indicate that model winds are overall well reproduced in the basin fig 5 the model minus observation bias is 0 02 m s the rmsd is 1 44 m s and best fit linear slope p is slightly smaller than 1 p 0 97 notwithstanding these good marks there are features that are worth being mentioned at first not shown here performances are not spatially homogenous since the era5 resolution penalizes the coastal areas and the sea regions sheltered by small islands moreover there is clearly an u 10 dependent performance the quantile quantile plot circles in fig 5 and its residual right panel exhibit a negative model bias that grows with the wind intensity i e the bias is larger for the more intense storm this residual is equal to 0 1 m s 0 4 m s and 1 2 m s for the 90th 95th and 99th percentile respectively given this score result the 99th percentile threshold is adopted as the highest confidence level for sea states and wave extreme model assessment in the mediterranean sea section 3 3 in the north sea wam hindcast spanned eight years from 2010 to 2017 and was applied to the gcoast area geesthacht coupled coastal model system that includes the north sea and the baltic sea staneva et al 2015 2018 wam was run on a model grid located between 40 04 00 n to 65 56 15 n and 19 53 20 e to 30 10 00 e with a spatial resolution of about 3 5 km 318 745 active model grid points the solution of the energy balance equation was provided for 24 directional bands at 15 each starting at 7 5 and measured clockwise with respect to true north and 30 frequencies logarithmically spaced from 0 042 hz to 0 66 hz at intervals of δf f 0 1 the wave model takes into account depth refraction and depth induced wave breaking and is driven by hourly era5 wind fields at its open boundaries it receives values generated by a coarse grid model spatial resolution 0 25 0 25 for the north atlantic situated from 5 s to 75 n and from 100 w to 40 e the integrated wave parameters for all active model grid points and spectral data at locations where measurements are available are stored at hourly intervals 3 results 3 1 the wam implementation for maximum waves the novel wam code reproduces the structures that can be encountered in ww3 with some tweaks to adapt them to the wam philosophy and some optimization addenda in this section we focus on how the parameters for maximum waves have been included in wam new subroutine wamax details in appendix a and how the computational time that is required to evaluate the new variables has been optimized wam input files and namelists have been adapted in particular modifications dealt with the following items three new input variables x in metres y in metres d in seconds for the computations of space time extremes all three values must be larger than zero four new output variables c m in metres and h m in metres for both time extremes and space time extremes 3 1 1 spectral moments and derived parameters focusing that leads to energy concentration in wave trains is a phase governed process the use of phase averaged models imposes to set aside a deterministic approach for the description of maximum waves and instead to use a statistical approach as a basis of the methods used in this study we then exclude any examination of wave by wave heights and rather we look at the properties of the wave field as it is customarily described by the directional wave energy spectrum s ω θ hence consistently with the ww3 implementation to estimate all parameters included in the extreme wave pdfs we rely on the ijl moments m i j l of s ω θ defined as follows 17 m i j l k x i k y j ω l s ω θ d θ d ω where ω and θ are the intrinsic angular wave frequency and the wave direction respectively and k x k y are the components of the wavenumber vector k no contribution from the frequency spectral tail is taken into account and the full spectrum is integrated without partition for multiple wave systems moments m i j l with i 0 and j 0 depend on the orientation of the coordinate system and it should be a natural choice to select the x and y axis orientation in such a way that the variance of spatial derivatives along one axis say x is maximized baxevani and rychlik 2004 this condition is satisfied assuming the peak direction of wave propagation coincident with the x axis after this axis orientation below we describe the way the new variables are used in wam and their meaning to estimate the value of the bandwidth ψ that is used in the distribution of maximum wave heights we rely on boccotti 2000 who defined ψ for general bandwidth processes as the normalized minimum of the temporal autocovariance function ψ τ of the sea surface elevation field η t that is 18 ψ ψ τ ψ 0 where τ is the abscissa of the absolute minimum of ψ τ which is defined as follows 19 ψ τ η t η t τ where τ is the time lag the autocovariance function ψ τ is estimated from the directional spectrum as follows 20 ψ τ s ω θ d θ cos ω τ d ω in regard to the nonlinear large crest height distribution an integral measure of the steepness μ that accounts for bandwidth effects has been proposed by fedele and tayfun 2009 21 μ μ a 1 υ υ 2 where 22 μ a σ k a σ ω a 2 g σ m 001 m 000 2 g is an integral measure of the steepness for narrow band waves in deep waters and ν m 000 m 002 m 001 2 1 is the spectral bandwidth longuet higgins 1975 as for the space time extremes formulations it is pivotal to obtain the three values of average number of waves n 1 n 2 and n 3 that are defined in eq 10 they include the irregularity parameters which are given by 23 α x t m 101 m 200 m 002 α y t m 011 m 020 m 002 α x y m 110 m 200 m 020 and are equal to the normalized cross correlation coefficient between the components of the sea surface gradient it is worth noting that while some moments m ijl change with the orientation of the axes baxevani and rychlik 2004 the determinant of the sea surface gradients covariance matrix which enter the extreme estimate is unaffected by an axes rotation with the selected axes moments m 200 m 020 and m 002 are related to the mean zero crossing period t z the mean zero crossing wavelength l x and the mean wave crest length l y by the following equations 24 t z 2 π m 000 m 002 l x 2 π m 000 m 200 l y 2 π m 000 m 020 where m 000 σ 2 is the variance of the wave field such mean wave parameters have a direct connection with the mean square slope mss of the sea surface elevation field indeed we can write mss as follows 25 m s s 2 π 2 m 000 1 l x 2 1 l y 2 the so defined wave lengths are proportional to the fourth order moment of the wave spectrum in deep water k 2 is proportional to f 4 and therefore as for mss they are strongly influenced by the high frequency wave components this leads to the important result that extremes depend on the higher order spectral moments which were verified to be sensitive to some extent to the source term parameterizations in spectral models rascle and ardhuin 2013 stopa et al 2016 in this respect assessment of model extremes is also an indirect way for the evaluation of the directional spectrum shape in eq 11 the computation of the mode of the probability density function of space time maximum linear crest heights requires the solution of an implicit equation in ξ 0 fedele 2012 therefore to optimize numerical performance in ww3 we adopted a strategy that gives an estimate of ξ 0 as follows barbariol et al 2017 26 ξ 0 2 ln n 3 2 ln 2 ln n 3 2 ln 2 ln n 3 where n 3 is given by eq 10 the above approximation strictly works when the number of 3d waves is large enough given the customary duration of a sea state including o 102 waves on average over the duration d error in using eq 26 is smaller than 3 when the sea surface area xy l x l y in wam we have adopted the same strategy 3 1 2 numerical performance optimization the most time demanding task in wamax involves the computation of the auto covariance function ψ τ this stage was then optimized in order to reduce the time required for its calculation clearly there is no need for a full computation of ψ τ for τ 0 as only the normalized minimum is required being ψ min ψ τ max ψ τ the maximum value max ψ τ occurs clearly for τ 0 and it equals the elevation variance m 000 hence only the time lag and value of min ψ τ must be sought this led barbariol et al 2017 to develop an ad hoc strategy which was implemented in ww3 this implementation computes twenty points around the time position where the minimum is assumed to occur this method is robust and its computational time is known which is an advantage for operational purposes however this strategy can not control the accuracy of the result even though the actual error is less than a few percent of the actual value the point is that the assumption that the minimum is located inside a region which is statistically determined on simple spectra may fall the use of a search method to estimate the second zero of the ψ τ derivative can overcome this aspect and help improve the accuracy and reduce the computational cost the optimal alternatives we tested are the newton method the secant method the bi section method and the golden section search for all strategies a reliable starting point region is needed this is especially crucial for the newton method in order to determine a consistent statistic for the estimate we evaluated the time τ m i n 1 of the first minimum of ψ τ using one month january 2014 of global era interim directional spectra afterwards we normalized τ m i n 1 and the half period τ m a x 2 τ m i n 1 where τ m a x 2 is the time of the second maximum of ψ with respect to three characteristic wave periods t m 01 t m 02 and t e t m 10 table 2 indicates the median values the distribution of t e appears sharper than the other two thus the value τ 0 47 t e will be taken as the starting point for the search moreover using the era interim spectra we found that the best computational option is represented by the golden section search the first option i e newton method is the fastest see table 3 even if it had to be degraded to a quasi newton method with a search path strategy problems arise from the second derivative of the autocovariance function which besides doubling the computational load often shows problematic behaviour leading to non convergence the secant method happened to be slower than the quasi newton strategy even though the number of iterations could be controlled by accepting a sufficiently high tolerance the most robust method has proven to be the bi section despite being the slowest the golden section search showed a stable and trustworthy behaviour while maintaining a certain speed the computational time required to produce extreme wave outputs was found to have a small impact on the total cpu load used by the model using the mediterranean sea setup described in section 2 3 the time spent in wamax is less than 0 5 of the total model time we have also tested cases where the convergence may fail in providing a good estimate of ψ indeed it may happen that the first minimum of ψ τ is not the absolute one and in very few cases it lies above zero those situations occur in mixed sea states when a swell is super imposed to a wind sea of similar energy see for instance fig 4 9 in boccotti 2000 in this respect fig 6 shows the scatter between the values of the first minimum ψ m i n 1 and of the second minimum ψ m i n 2 in most of the cases 99 the first minimum is deeper than the second one but there are few wave conditions for which the first local minimum is not the absolute one these however are represented by non severe sea conditions median value of h s about 0 4 m and maximum below 2 m for which as a consequence the prediction of h m might be slightly underestimated 3 2 wam and ww3 maximum wave assessment adriatic sea and north sea preliminary to any analysis of model outputs is the assessment of model scores using reference observations of targeted parameters in this respect we must recall that maximum crest and wave heights derived from numerical runs were compared against in situ observations in a few previous studies barbariol et al 2019 used era interim and era5 wave spectra in the pacific ocean station papa to assess time and space time extreme wave statistics against stereo two experiments in a single day near the station and buoy data at the station while in ecwam envelope maximum heights were assessed against canadian and norwegian buoys ecmwf 2019 however in most cases model extremes were characterized off line by processing 2d wave spectra either computed from the data benetazzo et al 2015 or modeled at the specific location of wave observations fedele et al 2016 having wave models with inbuilt routines for extremes allows bypassing this strategy since extremes may be computed on line by wave models whose overall performance can be hence assessed to support this evaluation in this study 2d spectra were still processed off line to calculate ancillary variables such as the wave steepness and the spectral bandwidth that enter in the theoretical formulations in situ observations from stereo cameras wave radar and wave buoys are hence compared with the modeled results for this purpose data collected in the adriatic sea are here used to assess the wam and ww3 capabilities of correctly estimating the statistics of observed maximum waves whilst in the north sea only wam outputs were considered we distinguish between space time and time extremes as we show below 3 2 1 space time extremes in regard to the space time statistics observed wave parameters are summarized in table 1 which encloses details of the experiments we performed with the stereo imaging system reference 3d space time region γ used to produce the extreme data sample has orthogonal sides x 30 m y 30 m and d 180 s same values were then set in wam and ww3 model runs the observational wave sample is composed by a variety of sea conditions that accordingly produced a large spread of extreme values c m obs is equal to 1 01h s at least and 1 30h s at most while h m obs ranges between 1 65h s and 1 99h s it is understood that the proportional relation in eqs 11 and 12 between extremes and the number of waves n 3 n 2 and n 1 provides for a fixed space time region xyd and given h s that is the principal scale factor for maximum wave parameters a path for the maximum waves whose expectations c m and h m decrease increase for sea states that comprises on average longer shorter waves mori and janssen 2006 we shall partially account for this behaviour in the following analysis before quantitatively evaluating the errors on extreme values for each model parameterization we firstly proceed assessing the performance in the reproduction of the h s behaviour at the acqua alta platform for the four months 01 march 30 april and 01 september 31 october 2018 when stereo data were collected fig 7 top left we observe that all model configurations show a degree of scatter around the observations which however are well modeled on the whole with absolute bias for h s smaller than 0 1 m despite having a somewhat limited prospect both temporal spanning four months and spatial comprising a single station this result is consistent with that of stopa et al 2016 who noted that at a global scale the three ww3 source term parameterizations behave reasonably well for most wave conditions going into details we note that wam generally overestimates ww3 with relative bias larger than 0 07 m instead there are small differences among the three ww3 parameterizations being the relative bias at most 0 06 m and in particular st4 and st6 that perform similarly up to h s 3 m the largest differences between wam and ww3 all parameterizations occur when the sea states are more energetic as can be observed by comparing the q q quantile quantile plot of h s depicted in fig 7 bottom left the probability distributions of h s deviate above the 95th percentile where the ww3 minus wam residual reaches on average about 10 the largest discrepancy visible at h s 4 m is associated to the peak condition of a single storm occurred on 28 29 october 2018 which hence has small statistical significance we note however that differences between wam and ww3 may be partially explained based on the friction coefficient default value which makes the bottom friction of ww3 stronger examining the space time extreme values for the same period scatter and q q plots of c m and h m in fig 7 central and right panels respectively show that as for h s wam slightly overestimates ww3 the ww3 minus wam bias is small and larger than 0 17 m for h m and 0 11 m for c m ww3 runs with different source term parameterizations show similar distribution maximum bias is about 0 1 m for both variables in particular st4 and st6 with the only exception of the 29 october storm when c m 4 m and h m 6 m ww3 underestimation with respect to wam grows with the order of the quantile percentage at the 95th percentile shown with a vertical dashed line in the qq plots the residuals are on average about 8 and grow for the rarer conditions the differences on extreme values we have pointed out stem mostly from the performance of h s which is then the pivotal variable for maximum wave accuracy to complement this view we examine the spectral parameters that contribute to extreme estimates from model spectra we concentrate on the nonlinear steepness parameter μ used in the statistics of c m and on the bandwidth parameter ψ used in the statistics of h m results are shown in fig 8 where ww3 is compared with wam top panels and model outputs with observations bottom panels we note that ww3 spectra are on average steeper than wam spectra the normalized bias for μ is at most 6 for st6 and at least 2 for st3 a fact that would favour other parameters being equal e g h s and the average number of waves within the space time region that ww3 maximum crest heights are slightly larger than wam heights differences of a smaller degree albeit pointing to the same direction i e ww3 values larger than wam ones are observed for ψ ww3 spectra are generally narrower and hence the probability density function of maximum wave heights h m is expected to shift towards larger values when compared to observations bottom panels wam and ww3 st3 have a good match with the observed μ while ww3 st4 and ww3 st6 produce slightly steeper conditions difference of a few percent inspecting the distribution of the variable 1 ψ that is used in the computation of h m we note a large spreading of model data around the observation which are however well reproduced on average by all models being the normalized bias smaller than 1 we shall return to the analysis of the wam and ww3 values of μ and ψ in the next section where we shall assess extremes in the mediterranean sea next we focus our attention on the comparison between modeled and stereo derived space time extremes granted the possible difference between modeled and observed h s in order to remove the contribution of the sea state severity the assessment is provided for values of c m and h m that are normalized with h s indicated as c m and h m in fig 9 we observe for wam a small negative bias 0 03h s and 0 02h s for c m and h m respectively suggesting that model frequency spectra are slightly less steep and broader than observations the opposite is true for ww3 with a positive bias for both extreme values and with st4 and st6 that typically produce similar values and with smaller variability than st3 as it was stated before the normalization with h s removes only part of the difference between observed and modeled values since the extreme distributions incorporate also the sample size i e the average number of waves n 1 n 2 and n 3 over the space time domain for example for a fixed number of waves the maximum wave height distribution in the time domain according to rayleigh theory is constant we shall examine how to remove the effect of the sample size in the analysis provided in section 3 3 for the time being we point out that after normalization more less energetic sea states produce longer shorter waves and hence for a fixed space time or time region a smaller larger number of waves which imply smaller larger wave extremes it is easily understood therefore that the probability of extreme waves exceeding a specified value depends on the number of waves within the record to account for this variability we have analyzed the relative error between model and observed normalized extremes as a function of the difference between mean wave periods that we use as a proxy for the number of waves fig 9 right panels as expected in confirmation of the theoretical approaches positive errors i e model observation imply that the model period is smaller than the observed period and vice versa however overall model errors are small for all model runs indeed model estimates of normalized space time maximum wave parameters compared fairly with stereo observations for c m the model minus observations mean difference is 1 1 with a rmsd of 4 9 while for h m the mean difference is 1 9 and the rmsd is 4 8 3 2 2 time extremes as for the time extreme assessment wam and ww3 have been firstly tested against the observed values obtained processing the radar probe data from acqua alta in the same period march april and september october 2018 during which we run models in the space time extreme configuration we have thus set x 0 y 0 and d 180 s in order to switch on the computation of the maximum wave parameters that are expected in the temporal domain point statistics scatter diagrams in fig 10 represent the comparison between observed and wam values of c m forristall distribution left panel and h m naess distribution right panel error metrics of the model performance text in the panels clearly indicates that wam performs well in estimating both variables indeed the absolute bias is smaller than 3 cm and the rmsd is 0 25 m and 0 41 m for crest and wave heights respectively observed and modeled datasets are well correlated with cross correlation coefficient cc 0 90 and best fit linear slope 1 for both variables when c m 3 m and h m 5 m wam overestimates the observations although those data refer to the october 29 2018 storm which also challenged the model simulations of h s as we pointed out before in the context of forristall and naess models for extremes results presented here have similar errors as those presented by barbariol et al 2019 who performed a comprehensive study of extremes using era interim and era5 wave spectra in the pacific ocean finally ww3 and wam time extreme model scores are summarized in table 4 and show a good overall agreement between modeled and observed values of c m and h m as we have pointed out for the space time extremes the ww3 source term parameterization has a minor impact on extremes in particular those obtained setting st4 and st6 show good and almost identical statistical scores st3 results are slightly less satisfactory although with differences of a few centimetres that we do not consider as statistically relevant averaging model scores we can conclude that c m and h m are estimated respectively with absolute bias of 3 cm and 10 cm and with rmsd of 24 cm and 40 cm in the north sea surface elevation buoy data at the two stations westerland and helgoland provided an opportunity to compare the wam time extremes with an extensive dataset covering a few years model performance for h s c m and h m are summarized in table 5 on both stations wam performs well in reproducing h s with under overestimation within 5 and absolute model minus observation bias smaller than 0 08 m likewise wam extremes show similar scores with departures from observations consistent with those of h s quantitatively performance at the two north sea buoys is similar to that found at the acqua alta platform this result confirms the validity of the theoretical and model approaches that are used to estimate extremes in wam and ww3 and gives it generality in summary the evaluation of maximum wave parameters shows that model data are statistically consistent with spatio temporal stereo and temporal probe and buoy data in particular the relevant role of h s in reproducing correct maximum wave heights must be acknowledged with this in mind the following analysis focuses on wam and ww3 model results in the mediterranean sea where we proceed with the aim of disentangling the principal spectral parameters responsible for the generation of high waves within the theoretical framework adopted in this study 3 3 short term range extreme wave analysis in the mediterranean sea the advantage of having a set of wave models equipped with routines capable of providing estimates of wave maxima with high spatial temporal resolution is that predictions of their intensity can be made at large spatial and temporal scale this type of analysis would help identify the sea regions exposed with high probability to very large waves and discern the physical processes responsible for their occurrence for the analysis made in this study we have used wam and ww3 st4 results in the mediterranean sea with the following goals i the assessment of the maximum wave climate in the mediterranean sea ii the comparison between wam and ww3 st4 predictions of wave maxima at basin scale and iii the understanding of the principal processes yielding maximum crest and wave heights to pursue these objectives we used the 10 year wave hindcast dataset using the space time extreme formulations that we have applied with two strategies a first one with fixed term and range and a second one with variable term and range as we describe in the following sections 3 3 1 pattern and size of maximum crest and wave heights we aim at examining the intensity and spatial distribution of space time maximum waves crest and wave heights that can be encountered in the mediterranean sea we have adopted a fixed volume space time region with sides x 100 m y 100 m and d 1200 s hence targeting the typical horizontal footprint of an offshore platform xy 100 100 m2 and the typical wave buoy record length 20 minutes still satisfying the requirements of spatial homogeneity short range and temporal stationarity short term of the sea state the latter in particular is fulfilled since 20 minutes is a duration smaller than the timescale related to the changes in the synoptic conditions in the mediterranean sea due to its nature of semi enclosed basin previous global estimates of wave extremes barbariol et al 2019 which relied on era interim spectra at 1 and 6 hour resolution lacked the possibility of describing the complex atmospheric pattern and the maximum wave conditions in the mediterranean sea using era5 reanalysis wind forcings which are more resolved in space and time than the era interim ones we focus on the spatial distribution of the 50th the median value and 99th percentile a rare value with 1 chance of being exceeded in ten years of the two variables c m fig 11 and h m fig 12 as for the spatial variability of h s not shown here individual waves with maximum heights are triggered in regions with strongest prevailing and dominant offshore winds cavaleri and sclavo 2006 sartini et al 2017 soukissian et al 2018 which blow in the northwestern mediterranean basin near the gulf of lion and balearic sea north westerly mistral winds steadily present through the year and in the aegean sea north easterly etesian seasonal winds the typical value 50th percentile of the probability distribution of c m h m do not exceed about 1 8 m 2 8 m east of crete island and 1 6 m 2 6 m south of the gulf of lion and are as low as 0 8 m 1 2 m in the enclosed sub basins such as the adriatic sea and the tyrrenian sea surrounding the italian peninsula the rest of the mediterranean sea has a median value of c m h m smaller than 1 3 m 2 0 m we do observe large regional differences with maxima arranged in patterns following the variety of meteorological features we observe differences between wam and ww3 st4 maxima in all the areas with highest median conditions ww3 st4 overestimates wam up to 15 cm 25 cm while differences are smaller about 10 cm in the calmest sub basins the spatial variability of extreme waves for more intense storms 99th percentile is indeed different it is relevant where the mistral wind jet drives very intense sea states in the gulf of lion which experiences c m 8 m and h m 12 m whilst the rest of the mediterranean sea does not exceed about c m 5 5 m h m 8 m for the strongest sea states basin wide differences between wam and ww3 st4 are more articulated with wam overestimating ww3 st4 up to gulf of lion c m 0 5 m h m 1 0 m in the northernmost part of the sea while an underestimation of about 0 2 m is visible in the southern regions 3 3 2 extreme wave sensitivity to spectral parameters the previous analysis was conducted using a fixed volume xyd for extremes since this is the way the maximum wave evaluation was implemented in wam and ww3 this choice albeit being suitable for most practical applications dnv gl 2017 partially masks the capability of assessing the dependence of the occurrence of high waves on the characteristics of the sea state such as nonlinearity parameters or spectral spreading since the number of waves i e the sample size is as important as other factors for determining the probability of maximum crest and wave heights in linear and nonlinear wave trains mori and janssen 2006 ochi 1998 as we have made clear above in the comparison with observations in order to gain insight into the principal features of the wave field in influencing maxima the strategy that must be adopted would keep the number of waves as constant as possible and hence use for each model directional spectrum a sea state dependent space time region γ of variable volume xyd we have thus loosened the variability of the number of waves n 3d by normalizing the 3d space sides x y and d with the local and instantaneous spectral values of the mean zero crossing wavelength l x crest length l y and wave period t z respectively we have chosen the following values x l x y l y d 100t z and selected two key locations exposed to different sea states for a detailed analysis the acqua alta platform position and the grid point of coordinates 4 65 e 42 06 n just southeast of the gulf of lion we discuss the general behaviour of the pdf of maximum crest and wave heights in the wave field by showing the histograms of c m and h m normalized with h s as a function of μ and ψ respectively at the acqua alta fig 13 and the gulf of lion station fig 14 data are highly correlated and the dependencies are clear as it was expected from eqs 11 and 12 at acqua alta ww3 st4 produces sea states marginally steeper and less variable than wam which generate slightly larger 2 crest heights fig 13 left panels however differences with wam are very small 2 also when the variability of wave heights equal on average to about 1 95 with the bandwidth is taken into account fig 13 right panels normalized extreme values of c m h m from both models vary difference between 95th and 5th percentile values of 0 18 0 20 about 16 and 10 of the mean of c m and h m respectively at the gulf of lion station spectra are 10 steeper and as narrow as those at acqua alta this reflects proportionally in the values of wave maxima it is interesting that albeit the wind and wave regime at the two locations are indeed different in variety and intensity normalized maxima at the two locations have very similar distributions even though variation of extremes in the gulf of lion is smaller and values 2 on average for both extremes as well as wam and ww3 st4 not showing large differences which instead exist for non normalized extremes for which h s scales the extreme values 4 discussion and conclusions our present study opens a research direction on the extreme value prediction with spectral wave models the variables of interest are the maximum crest height and the maximum crest to trough wave height in a given sea state all parameters used in the time and space time extreme theoretical distributions have been computed from the wave energy directional spectrum s f θ or s k θ which is then the key quantity used for the evaluation as a consequence because of the phase averaging approach of spectral models only statistical quantities of extreme waves such as the mean are defined and provided in this study the wave model wam has been targeted for the new implementation in order to comply with the existing ww3 community wave modeling framework extreme wave outputs have been assessed against observations and differences between wam and ww3 results have been considered ad hoc runs have been performed to assess the principal features of the maximum wave climate in the mediterranean sea the estimate of extreme wave heights presented in this paper deals with wave conditions in short term range steady state and homogenous seas duration 1 hour extent in deep water 1 km far less in near coast areas the basic assumption is that the wave spectrum as well as the significant wave height and spectral moments are constant in a given sea state this is the way spectral models compute and process wave spectra and as a consequence the short term range statistics is the unique option for the evaluation of extremes within such a model code it may be of interest however to estimate the maximum waves in the short range but long term from hours to days when the sea severity namely h s is changing for instance during a storm including its growing and decaying phases the method to determine the long term statistics of individual maximum wave heights in a storm relies on the accumulation of the statistics for all short term stationary conditions taking into account the occurrence probability and the number of waves for each piecewise steady state sea state battjes 1972 borgman 1973 for space time extremes during storms the long term exceedance probability of c m was outlined by fedele 2012 who assumed that the sea surface elevation field is spatially homogeneous over the area a and piecewise non stationary in a time interval covering a storm using those methods the long term analysis of extreme waves can be easily achieved for instance by post processing the wave spectra at a certain location in the ocean the distribution function of maximum wave heights has been used by computing the expected value probability weighted average of maximum crest height and maximum wave height other parameters would be possible such as the standard deviation of the extremes that is included in ww3 but not in wam or the probability that the maximum wave heights exceed a given level for instance the rogue wave threshold 1 25h s for c m our choice to release the expected values is based on the consideration that it can be easily compared with the arithmetic mean from observations either from stereo systems or traditional wave probes theoretical statistics for extremes have been considered in both their temporal and spatio temporal formulations the latter allowing the description of the statistics of large wave groups crossing sea surface regions which have a practical application for instance at the air gap problem of offshore structures forristall 2011 in general due to the larger sample size of space time formulations the likelihood of extreme event is increased the choice of the space time region sides x y and d is constrained to the homogeneity and stationary conditions and it is arbitrary depending only on practical applications e g x and y may correspond to the sides of a marine structure we mention that the magnitude of extreme waves increase substantially with n 1d n 2d and n 3d during the first 30 60 minutes ochi 1998 and a few tens of meters benetazzo et al 2017b and thereafter increases slowly with time and space irrespective of sea severity it is important to note that the extreme value pdfs both time and space time lack the saturation induced by wave breaking babanin 2011 or nonlinear dispersion fedele 2014 which should modify the far tail of the pdf by restricting the wave heights fedele et al 2017 this would suggest that some of the largest waves in the pdf might be at the onset of incipient breaking or already breaking this effect is more pronounced for space time extreme theoretical models with large sample size which may overestimate maximum waves over large areas and time duration in this respect the study by benetazzo et al 2020 showed that space time estimates are reliable over surface areas with a side o 102 m for all sea states and time interval shorter than one hour formulae for space time extreme wave estimates depend on sea state parameters that are obtained from higher order moments of the directional spectrum as pointed out by stopa et al 2016 and liu et al 2019 wave models may have difficulty in describing the directional properties of wave spectra and differences exist among the ww3 source term parameterizations as far as the wave spectrum moments are concerned by comparing modeled space time extremes against stereo observations we have shown however that model performances and differences between models mostly stem from the accurate simulation of the significant wave height h s which represents the leading scale factor for maximum waves we note also that models relative performance is better for extremes than for h s the reason for that is that the underestimation overestimation of h s implies a larger smaller number of waves i e the sample size over a fixed duration region which in turn gives rise to higher smaller maximum heights compared to h s with the wamax routine implementation both wam and ww3 are equipped with procedures to compute maximum waves parameters though with some differences between models as shown in table 6 in particular in ww3 the nonlinear formulation for the time x 0 and y 0 and space time x 0 and y 0 crest height is based on the tayfun model only while in wam the nonlinear crest height for time extremes is computed also using the forristall model moreover we choose to produce time extremes in wam forristall and naess models also when setting x 0 and y 0 this option is not available for ww3 where a strict and distinct set of variables is computed for time and space time extremes in this sense wam allows additional time extreme outputs to be computed compared to ww3 whereas the space time extreme implementation is based on identical formulations some differences between wam and ww3 concern also the numerical implementation and its optimization finally the capability of assessing modeled extremes is based on the capacity of processing observed data with ad hoc strategies strictly speaking the model response requires continuous time or space time elevation records at high temporal and spatial resolution to be processed to isolate independent high wave trains such series of data are rarely available see for instance https cdip ucsd edu m and this limits the possibility of extensive model output assessment though spotty validations can still be carried out as was established in this study to summarize some of the key achievements and findings of our study wam code was upgraded to generate outputs of maximum crest and wave heights both in time and in space time theoretical formulations were based on second order nonlinear models for crest height and linear model for crest to trough wave heights we relied on the existing ww3 implementation for extremes tests at the global scale with the extreme wave routines implemented on wam are in progress on a research version of ecwam comparison with observations showed that theories used for extremes provide good model performance provided that the wave model and its forcings have sufficient accuracy to properly reproduce the total energy say h s of the sea states we observed differences between extreme wave outputs from wam and ww3 and for the latter we documented the sensitivity of extremes on the three source term configurations st3 st4 and st6 we noted that the differences mainly concern the value of h s while the variability of other parameters such as the steepness the bandwidth or the directional properties of wave spectra seems to have a smaller effect on extremes main features of the maximum wave climate in the mediterranean sea have been highlighted although limited to a 10 year period 2001 2010 the analysis disclosed the magnitude of maximum waves and helped reveal the relevant process concurring in generating high waves during marine storms because of its importance for marine safety a better understanding of wave extremes is critical for a variety of applications there is a consensus that high quality predictions of extreme events caused by storms could substantially contribute to avoiding or minimizing human and material damages and losses therefore reliable wave forecasts together with long term statistics of extreme conditions are of utmost importance for marine areas this works strengthens the capability of spectral wave models to be a powerful tool for studying the intensity and geographical distribution of extreme waves more work is needed to determine how the proposed approach apply to a variety of sea conditions that have not been focused in this study such as the oceanic swells or the strongly forced wind wave conditions for instance hurricanes and typhoons future measurements and numerical experiments will be valuable to further test the models performance credit authorship contribution statement alvise benetazzo conceptualization methodology formal analysis supervision writing original draft project administration funding acquisition francesco barbariol methodology formal analysis software investigation funding acquisition paolo pezzutto software investigation funding acquisition joanna staneva and arno behrens software investigation silvio davison and filippo bergamasco formal analysis mauro sclavo and luigi cavaleri resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work has been carried out as part of the copernicus marine environment monitoring service cmems latemar project https www mercator ocean fr en portfolio latemar cmems is implemented by mercator ocean in the framework of a delegation agreement with the european union dr tiziana paccagnella and dr andrea valentini from the regional agency arpae simc italy are tanked for providing cosmo i2 wind data we are grateful to dr mauro bastianini cnr ismar for his work on the acqua alta platform and to dr jean bidlot ecmwf for useful discussions on wave model source terms joanna staneva and arno behrens acknowledge the funding by initiative and networking fund of the helmholtz association through the project advanced earth system modelling capacity esm and cliccs center of excellence project appendix a changes in the wam source file code new subroutine wamax the new wam code that includes the wamax routine was tested debugged and transferred to the code maintainer helmholtz zentrum geesthacht hzg contact persons dr joanna staneva and dr arno behrens main changes in the wam source file code are described in table a 1 table a 1 summary of the wam source code changes made to implement the wamax routine for the computation of the extreme wave parameters maximum crest height and crest to trough maximum wave height table a 1 source file purpose changes chief read wam user f90 reads user options from input file wam user wamax user options reader mod wam interface module f90 procedures used in wam to compute parameters from spectra and to interpolate spectra added subroutine wamax which computes o cmax f time maximum crest height forristall o hmax n time maximum wave height naess o cmax st space time maximum crest height stqd o hmax st space time maximum wave stqd given o f block of spectra o depth depth o thmax peak direction mod wam output parameter module f90 output parameter names and scales for printing extended output to include the four wamax output variables mod wam output set up module f90 output times and flags added a subroutine set wammax options mod wam print user module f90 prints set up options modified number of output variables mod wam user module f90 default settings adapted for wamax user options print wam netcdf module f90 creates netcdf files from binary format adapted to include wamax outputs 
21229,pack ice is a matter of considerable importance for ships and offshore structures operating in ice covered waters in particular arctic sea ice has been melting much faster recently than previously thought with ships and offshore structures in arctic regions and ice covered waters being frequently exposed to pack ice conditions consequently minimizing ice loads and ensuring safety under these conditions is a key consideration from a design perspective this study aims to provide a better understanding of ship resistance characteristics and to investigate the factors that influence ship resistance when navigating pack ice fields in the study a preparation procedure for pack ice conditions for model testing in an ice tank is introduced and some of the variables that can affect the ship resistance channel width broken ice floe size ice concentration and ice thickness are considered in the experiments the significance of each variable is discussed and non dimensional regression analysis is then applied to derive the relationships between the four variables and an equation for pack ice resistance prediction is established on the basis of this analysis the reliability of the equation is verified by comparing the predicted results and the results of full scale ice trials using the icebreaker araon keywords pack ice ice covered waters ship resistance characteristics non dimensional regression analysis pack ice resistance prediction 1 introduction the melting of the arctic ice sheet has caused shipping along the northern sea route to increase along with possibilities for economic development in the arctic regions such as production activities and exploration for natural resources yamal lng is one of the world s largest liquefied natural gas lng plant projects comprising gas production liquefaction and shipping with an output capacity of around 16 5 million tons per year from 2019 exported to east asia and europe by icebreaking tanker url https yamallng ru en for the arctic regions safe navigation is an absolute priority and one of the most important environmental factors is the condition of the ice when ships interact with it the sea surface during ship voyages in the arctic summer is typically covered by fragmented ice floes called pack ice thus ship resistance characteristics in pack ice is a significant aspect of ship performance predictions when considering the summer operations of vessels and ship performance in pack ice fields depends on factors such as ice concentration floe size and ice thickness many studies have been conducted to understand ship performance in pack ice murray and spencer 1996 conducted model tests of a semi submersible and a tanker hull in pack ice the model tests covered different thicknesses and concentrations colbourne 2000 presented prediction formulae based on the non dimensional relationships of moored ship shaped vessels and a full scale prediction methodology from experimental results brown 2002 investigated ship maneuverability under pack ice conditions by using hexagonally shaped paraffin wax to conduct the pack ice tests the study mainly focused on the calculation of maneuvering coefficients to develop a method for assessing the maneuverability of a ship in pack ice spencer and molyneux 2009 developed an equation for predicting loads on the hull due to pack ice based on model tests woolgar and colbourne 2006 studied the effect of the hull ice friction coefficient of a vessel with a bulbous bow they used a froude number based non dimensional methodology to predict the pack ice forces created by the pack ice loading for various friction coefficients in addition woolgar and colbourne 2010 studied the effect of hull ice friction under pack ice conditions for moored offshore vessels the study was based on a non dimensional analysis to establish the relationships between the predicted pack ice forces and the hull ice friction coefficient grochowalski and hermanski 2011 have conducted extensive work on ship resistance and propulsion characteristics under pack ice their study investigated the prediction of ship performance in broken ice fields and proposed an estimation method based on the model test results kim et al 2013 studied the resistance performance of an icebreaking cargo vessel in pack ice conditions both numerically and experimentally they analyzed ship resistance characteristics in different pack ice concentrations using an ls dyna commercial fe package and compared them with model test results sawamura et al 2018 investigated ice resistance characteristics using synthetic ice floes with a regular wave condition demonstrating that ice floe motion induced by waves affects ice resistance zhou et al 2019 carried out ice model tests using icebreaking tanker uikku to analyze the ice loading process and the physics of ice hull interaction zong and zhou 2019 studied the ice resistance of a ship moving in waters covered with broken ice floes they discovered that the ship resistance coefficient is proportional to squared ship velocity beam to length ratio ice thickness to length ratio and sea ice concentration kim et al 2019 proposed a numerical simulation for ice sea ice structure and ice ice interactions to minimize computational time and simulation results were compared with the model test results in an ice tank these results were in good agreement from an average ice load point of view an investigation of ice resistance in randomly distributed pack ice conditions was performed by yang et al 2020 they analyzed ship resistance in pack ice using a numerical model and simulation results were compared with the empirical formula wang et al 2020 investigated the effects of sailing speed and ice concentration on the ice loads of an ice area bulk carrier in broken ice they analyzed the characteristics of ice loads including the average ice loads extreme ice loads and characteristic frequency zong et al 2020 examined ship resistance in broken ice using artificial ice floes to investigate the influences of sea ice concentration floe shape and floe size on ship resistance as mentioned above ship resistance characteristics in pack ice are one of the significant issues in the performance predictions of ships in addition model tests in an ice tank can provide valuable information for ship resistance characteristics the international towing tank conference ittc ice committee provides the testing procedures and methods of analysis international towing tank committee ittc 2017a international towing tank committee ittc 2017b international towing tank committee ittc 2017c the guidelines provide detailed preparation procedures for various ice conditions such as level brash and ridged ice measurement methods of model ice properties and ice test procedures however the description of ice testing in pack ice conditions is quite simple consisting of a general description of the ice concentration and the classification of ice floe sizes in pack ice fields this means that it is quite difficult in experiments under pack ice conditions to simulate natural conditions identically for a range of environmental variables previous studies have investigated the effects of hull ice friction and ice concentration extensively with simulated results in line with model test results but the effects of channel width under pack ice broken ice floe size and thickness of ice have not been sufficiently examined the main purpose of this study is to better understand ship resistance characteristics for pack ice fields from a ship design perspective ship performance has become a critical aspect of a ship s operation in such conditions and several variables such as channel width broken ice floe size ice concentration and ice thickness are investigated by the model tests on an icebreaking ship the key to performing any experiment is to identify the variables that may affect the ship resistance characteristics in pack ice and how much influence the variables have on the amount of ship resistance in this study the quantitative results are obtained from the ice model tests the results can provide valuable information about ship performance characteristics under pack ice in addition a non dimensional regression analysis is performed to find the correlations between the four independent variables mentioned above and to formulate the relation equation the established equation could contribute significantly to predictions of a ship s resistance in pack ice fields 2 preparation of pack ice conditions in general the definition of pack ice is coverage of a large area by ice floes which can be divided according to size and horizontal extent international towing tank committee ittc 2017b with regard to pack ice conditions concentration is a significant factor affecting ship resistance characteristics ice concentration describes the percentage of area covered by floating ice of a known area it is typically given as a percentage 0 100 percent thus a low concentration indicates the presence of a few ice floes on the sea surface and a high concentration indicates that the surface is mostly composed of ice floes according to previous studies an ice concentration of above 60 can affect the efficient performance of a ship on its voyage but less than of 60 can be regarded as open sea conditions grochowalski and hermanski 2011 kim et al 2013 modeling methods of pack ice have not been defined clearly thus the preparation procedures for model testing for pack ice conditions are developed in this study preparation of pack ice is composed of three phases desired area calculation ice cutting and breaking of ice into floes and arrangements for the modeling of pack ice conditions first the required length and width of the test channel are calculated the cutting length and width are calculated while considering the ice concentration second after a parental level ice thickness has reached the target conditions parental level ice sheet cutting is accomplished using an electric chainsaw to the required channel width and then horizontal cuts of the parental level ice sheet are accomplished at the beginning and end locations of the ship track third the superfluous level ice sheet based at the beginning location of the testing channel is sawn and removed from the channel to achieve the desired concentration in the testing channel see fig 1 after the ice cutting the parental level ice sheets are broken into the desired ice floe size by manual type ice pushers on the service carriage along the testing channel the broken ice floes are then scattered irregularly using the ice pusher to simulate natural conditions as the ship advances the hull contacts broken ice floes and pieces of ice are pushed aside and forward some floes may push the parental level ice sheet especially if the sides of broken ice floe segments are parallel to that sheet to cause an additional force component to be applied to the ship as that component may interfere with the results of the ice model tests the flat side of ice floe segments must not be arranged parallel to the side wall of the testing channel these procedures can be relatively efficient methods for performing model testing under pack ice conditions fig 2 shows the pack ice prepared for ice model testing during the tests a camera is located on the ceiling to determine the ice floe size and coverage the information can be obtained from the image processing of photographs based on a localized binarization of quadtree subdivided image analysis for more details including the filtering threshold setting and binarization procedure can be found in lee et al 2017 fig 3 shows the calculation results of broken ice floe size distribution and concentration for the prepared pack ice test channel 3 model tests and results discussion 3 1 experimental conditions a series of ice model tests were carried out in the ice tank of the korea research institute of ships and ocean engineering kriso the ice tank length is 42 m long by 32 m wide and 2 5 m deep the model ice sheets were generated by a cooling seeding freezing and tempering process the production methods of the model ice and the property measurements are described in jeong et al 2017 propylene glycol pg was recently added to the cd eg ad model ice in the kriso ice tank where cd eg and ad denote controlled density ethylene glycol and an aliphatic detergent respectively pg is a compound that is generally recognized as environmentally friendly its chemical characteristics are quite similar to those of eg thus the model ice type used in the kriso ice tank is cd pg ed ad model ice jeong and ha 2020 studied the physical properties of this model ice during the tempering phase in this study a model of the korean icebreaking research vessel araon was used a scaling factor of λ 18 667 was used for these tests the korean icebreaking research vessel was designed to operate in 1m thick multi year ice with continuous icebreaking capability at 3 knots the ship has a displacement of approximately 6950 tons and a design draft of 6 8 m it is propelled by twin azimuth propulsion units driven by a diesel electric propulsion plant with a total propulsion power of 10 mw the main particulars of the model and full scale vessel are given in table 1 the model tests on the bare hull condition were conducted by towing the model at a constant speed through the pack ice conditions using a towing pole the model was constrained in surge and allowed limited sway in addition the model was restricted in yaw by a fork that was attached to the towing carriage the model was also connected to a parallel sliding bar at the bow and the stern however the model was mainly towed along in a forward direction so these constraints did not have a significant effect on ship resistance for each pack ice condition several tests were conducted at three velocities 1 3 and 5 knots in full scale the physical properties of each ice sheet were checked before and after each test in accordance with kriso s procedures jeong et al 2017 during the tests the density of the model ice was around 870 880 kg m3 and the frictional coefficient between the model ship s surface and model ice was taken as 0 05 for the pack ice conditions when a ship is sailing in the channel the ship and the ice interactions involve the turning and submerging of the ice floes and mainly crushing between the ice floes and the ship s hull or ice collisions with each other and spalling of the edges thus the compressive strength of the ice is a significant factor in the experiments the average compressive strength of the ice was approximately 1 19 mpa in full scale 63 7 kpa in model scale and the average flexural strength of the ice was about 0 74 mpa in full scale 39 6 kpa in model scale here the flexural strength of the ice was slightly greater than the general strength value of first year ice 0 63 mpa in full scale to obtain the particular compressive strength of the ice in the tests therefore a slightly high flexural strength of ice was used the elastic modulus was not directly measured but the range of elastic modulus is roughly 770 times its compressive strength according to a previous study jeong and ha 2020 in the tests two ice floe sizes were considered at 30 and 50 of the model ship s beam namely 0 3 and 0 5 m 5 7 and 9 5 m in full scale the value was based on the field observations from a full scale ice trial of the araon during the antarctic summer expedition in 2019 around the ross sea see fig 4 the model test conditions are summarized in table 2 and the calculated results for ice concentration and floe size based on the image processing analysis are summarized in table 3 according to colbourne 2000 the total resistance in pack ice r it can be considered as the sum of two resistance components 1 r i t r p a c k r o w where r pack and r ow denote the pack ice and open water resistance components in this study r it can be obtained directly from the ice model tests therefore the net pack ice resistance r pack can be calculated by subtracting the open water resistance component r ow from the total resistance in pack ice r it thus the net pack ice resistance r pack can be calculated as follows 2 r p a c k r i t r o w from previous open water resistance test results jeong et al 2011 the following equation for ship resistance in open water r ow was obtained 3 r o w 13 14 v 2 where v is the model ship speed in meter per second r ow measured in newtons and eq 3 is valid for v 1 07 m s 9 kts in full scale in addition ice model tests were carried out in low speed ranges from 0 119 to 0 595 m s 1 5 kts in full scale thus the skin friction drag component in the total ship resistance in pack ice was considered to be negligible 3 2 effect of channel width under pack ice the characteristics of ship resistance under pack ice is a matter of considerable importance but knowledge is still limited due to the relationships between variables such as channel width broken ice floe size ice concentration and ice thickness in particular the effect of channel width in pack ice has not been specified generally channel width can affect the amount of ship resistance thus model tests in pack ice with two different channel widths were performed to investigate how much influence the channel width had on the magnitude of ship resistance in pack ice for the tests two ice floe sizes were applied i e 0 3 and 0 5 m in model scale or 5 7 and 9 5 m in full scale the channel width effect is shown in fig 5 as can be seen from the figure the intercept of the fitting curve i e 0 m s indicates the speed independent resistance component in ice the average differences in pack ice resistance were 10 7 and 14 5 n respectively for both model ship speeds the test results showed that the channel width strongly affects the magnitude of ship resistance under pack ice and that resistance also increases with the increase of broken ice floe size accordingly experiments for various channel width conditions with 0 3 m of ice floe size and 80 ice concentration were carried out in order to verify whether ice floe size influences pack ice resistance characteristics the testing channels prepared are depicted in fig 6 and the results are summarized in table 4 the effect of the channel width can be quantified by calculating the deviation δ as follows 4 δ r m e a s u r e d r t a r g e t r t a r g e t 100 where r target is the resistance results of the channel width of 8 times the beam i e test no 200d and r measured is the resistance results for each channel width condition fig 7 shows the net pack ice resistance r pack for several different channel width conditions when the ship model enters the pack ice the broken ice floes around the waterline area are pushed by the model hull the broken ice floes push each other which leads to an interference effect at the channel wall and a ship resistance increment occurs in particular the magnitude of pack ice resistance decreases when the channel width increases but this decreasing trend converges when the channel width reaches 8 times the beam of the model ship if the broken ice floe size increases the convergence of pack ice resistance will occur at a wider channel width condition fig 8 shows the underwater feature for channel widths of 4 and 8 times the beam as the model ship enters the narrow pack ice channel it displaces the broken ice floes some of the broken ice floes are submerged and slide along the bottom of the model hull or are pushed to the side these ice floes can easily overlay one another and can cause a compressive force on the model ship pack ice resistance will thus increase in the relatively narrow channel due to the compression of the ice floes around the waterline area of the model ship the distribution of ice floes as the model ship passes through the pack ice is shown in fig 9 the yellow blue and red dashed lines denote channel widths that are 4 6 and 8 times the beam respectively when the model is moving through the pack ice the broken ice floes may overlap with one another in relatively narrow channel widths which further increases ship resistance more specifically interactions between the broken ice floes are more frequent in channels below 4 times the beam where the broken floes are pushed against the channel wall in addition when a ship model is proceeding through pack ice broken ice floes are pushed aside and forward simultaneously while ice floe compressions are formed in the pack ice therefore larger total resistance can be encountered in narrow channel width conditions as shown in fig 9 there is little significant difference for channels between 6 and 8 times the beam with regard to the movement of the ice floes but pack ice resistance is higher at 6 times the beam than 8 times the beam for both 80 and 90 ice concentrations due to the ice compression it is worth pointing out that the magnitude of ship resistance under pack ice should depend on channel width but ice floe size ice concentration and ice thickness also affect the amount of ship resistance the effects of the variables were therefore investigated 3 3 effect of broken ice floe size on resistance in pack ice as previously mentioned the floe size of broken ice can affect ship resistance in pack ice therefore two broken ice floe sizes 30 and 50 of the model ship s beam i e 0 3 and 0 5 m 5 7 m and 9 5 m in full scale were used in the experiments the model tests were carried out in ice 26 mm and 80 mm thick 0 5 and 1 5 m thick in full scale at 80 ice concentration in a channel width of 8 times the model ship s beam the ice floe size effect is presented in fig 10 the ship s resistance in pack ice given large floe size is much higher than with small floe size as can be seen from fig 10 pack ice resistance has exponential growth with the increase of ice floe size because pack ice resistance strongly depends on the momentum exchange between the ship s hull and the ice floes and the rotating and sliding of broken ice floes can cause additional ice forces resulting from the ventilation of ice pieces thus high pack ice resistance can occur in large ice floe size conditions the difference in pack ice resistance between 0 5 m floe size and 0 3 m floe size at 80 mm thick is greater than at 26 mm thick for 26 mm thickness and 80 coverage pack ice resistance with a 0 5 m floe size is approximately 1 6 times greater than that for a 0 3 m floe size and the pack ice resistance for 80 mm thickness with a 0 5 m floe size is 1 9 times greater on average than that for a 0 3 m floe size with the same ice concentration thus pack ice resistance with large floes and thicker ice may be much higher than for small floes 3 4 effect of ice concentration on resistance in pack ice ice model tests at three different ice concentrations 80 90 and 100 were carried out for two ice thicknesses namely 26 mm and 40 mm 0 5 and 0 7 m at full scale respectively with a channel width of 8 times the beam of the ship model with 0 3 m ice floe size for the experiments 100 ice concentration denotes the pre sawn ice condition in this case the pre sawn pack ice resistance may be different from that in an actual 100 ice concentration case due to the ship and ice interactions but the results can be significant for identifying ship resistance characteristics in pack ice prior to tests at 100 coverage the parental level ice was sawn to the required cutting patterns which is the bow breaking pattern of the ittc s recommended procedure international towing tank committee ittc 2017c the characteristics of pack ice resistance are presented in fig 11 as can be seen from the figure when the ice concentration increases the pack ice resistance also increases and the test results follow an exponential trend at 80 ice concentration the differences in pack ice resistance between ice thicknesses of 26 mm and 40 mm for three speeds are 4 0 6 0 and 7 8 n respectively at 90 ice concentration these differences are 7 4 9 2 and 12 6 n respectively furthermore the pack ice resistance at an ice thickness of 80 mm and 80 ice concentration is 5 5 times greater on average than that of 26 mm and the pack ice resistance at 80 mm thickness and 90 ice concentration is on average 3 9 times greater than that at 26 mm the ratio at 90 ice concentration is slightly lower than that at 80 but the differences in pack ice resistance at 90 according to the model ship s speeds are much greater than at 80 the effect of ice concentration for pack ice resistance at two ice thicknesses is illustrated in fig 12 the data are fitted to a power function of the ice concentration in addition the characteristics of ship resistance in ice are presented in fig 13 not only for the pack ice condition but also for the level ice condition as can be seen from the figure total ship resistance in level ice is significantly higher than for pack ice the total ship resistance in pack ice at 80 coverage with a 0 3 m ice floe size is approximately 18 6 of total ship resistance given level ice at 80 mm thick and 14 kpa flexural strength i e 1 5 m and 261 kpa in full scale and the value for 90 ice coverage with the same floe size is close to 30 6 of the level ice case these increasing trends can also be seen in 65 mm ice conditions this demonstrates that the breaking force component is mainly related to the flexural bending of the ice sheet in level ice during the ship and ice interactions thus ship resistance in level ice is higher than in pack ice 3 5 effect of ice thickness on resistance in pack ice to understand the effect of ice thickness model tests were performed with three different ice thicknesses for two ice concentrations in a channel width of 8 times the beam the test results of pack ice resistance for ice thickness variations corresponding to 26 40 65 and 80 mm i e 0 5 0 7 1 2 and 1 5 m in full scale are presented in fig 14 it appears that pack ice resistance tends to increase rapidly when ice thickness increases and the results show an exponential trend the intercept of the exponential fitting curve at zero speed i e 0 m s indicates the speed independent resistance component in ice in addition pack ice resistance at 40 mm thick is on average 1 8 times greater than that at 26 mm thick and pack ice resistance at 80 mm thick is on average 5 5 times greater than that at 26 mm thick with 80 ice concentration the increasing trends are shown for 90 ice concentration as well it would be worth noting that ice thickness and concentration affect each other since they are related through the behavioral characteristics of broken ice floes during the passing of the model ship through the pack ice conditions this phenomenon can have major effects on the increment of ship resistance fig 15 shows the underwater features while the model ship passes through the pack ice the broken ice floes can be rotated and submerged around the waterline area of the model due to the ship and ice interactions the turning and submerging of ice floes can be understood in terms of ship resistance as well as friction between the ship and ice floes accordingly the phenomena are closely related to increases in ship resistance under pack ice conditions as shown in fig 15 the model featured large amounts of submerged ice floes at 80 mm thick and 90 ice concentration and consequently pack ice resistance was greater than at 65 mm thickness with the same coverage 3 6 experimental uncertainty analysis for ice testing results the experimental uncertainty of the model test results must be taken into account when interpreting the ship resistance in pack ice to do this the results can be quantified by experimental uncertainty analysis derradji aouat 2004 and derradji aouat et al 2004 studied the experimental uncertainties in results obtained from ship model testing in an ice tank both studies were based on ship resistance tests for the canadian icebreaker terry fox contributing an important experimental uncertainty analysis that has been used to quantify experimental uncertainties in test results the detailed procedure is currently part of the ittc recommended guidelines for the experimental uncertainty analysis international towing tank committee ittc 2005 in the present study the random uncertainties are calculated based on the ittc recommended procedures international towing tank committee ittc 2005 the procedures indicate the segment length of each test run should be approximately 1 5 2 5 times the length of the model ship and one test run result should divided into 10 segments with each segment being analyzed as a statistically independent test if the general trends are repeated reasonably in each segment at a constant speed herein chauvenet s criterion is applied to identify outliers and the chauvenet number for mean tow force is 5 c h a u v m e a n f t m e a n m e a n f t m e a n s t d f t m e a n where chauv mean is the chauvenet number and f t mean is the mean tow force for each segment mean f t mean and std f t mean are the mean and standard deviation of the f t mean respectively chauvenet number values greater than 1 96 are disregarded the new mean of the means and the new standard deviation of the means are calculated from the remaining valid data points and the random uncertainty u f t mean is then derived as 6 u f t m e a n t s t d f t m e a n n where t is assumed to be 2 and n is the number of the valid data points after this the random uncertainty percentage u p f t mean can be expressed as 7 u p f t m e a n u f t m e a n m e a n f t m e a n 100 the calculated random uncertainty percentage for each ice test are summarized in table 5 in a previous study derradji aouat 2004 random uncertainties of up to 18 were obtained in broken ice tests but as can be seen from table 5 the uncertainty values ranged from 3 24 to 9 42 with the level of random uncertainty percentage falling slightly lower than those of derradji aouat 2004 furthermore the random uncertainties in broken ice at 100 coverage were relatively less than both the 80 and 90 coverages in the present study the pre sawn ice condition was regarded as 100 coverage representing when a ship proceeds through a pre sawn channel with ice floes constantly submerged and passing beneath the hull therefore the level of the random uncertainties is relatively smaller than those of 80 and 90 coverages however the random uncertainties in broken ice at actual 100 coverage will be higher than both 80 and 90 coverages because an irregular compression situation of broken ice floes around the waterline area of ship model will occur more frequently at high ice concentration than lower ice concentration 3 7 non dimensional analysis of ship resistance under pack ice in line with previous studies colbourne 2000 woolgar and colbourne 2006 2010 spencer and molyneux 2009 grochowalski and hermanski 2011 a non dimensional analysis was performed in order to predict ship resistance under pack ice conditions the non dimensional coefficient of pack ice resistance c pack and the ice thickness froude number f h was determined herein the original froude number is the non dimensional parameter in terms of wave making phenomena but the ship resistance in ice is strongly affected by the ice thickness therefore the ice thickness froude number was applied in this study these are given by the following equation 8 c p a c k r p a c k 1 2 ρ b h v 2 f h v g h where r pack is ship resistance under pack ice ρ is the density of the ice b is the model beam h is ice thickness v is the model ship speed and g is the acceleration due to gravity in the experiments only one friction coefficient i e 0 05 was considered so other variables such as ice thickness floe size ice concentration and channel width were investigated to establish an empirical relationship with the model test data in particular the pack ice resistance would depend on relative ratio of broken ice floe size to channel width thus the ratio is normalized to the ship s beam and non dimensional coefficients are established to extrapolate the model test data to full scale conditions based on froude scaling law in addition the independent variables are transformed by logarithmic function to predict the dependent variable therefore a multiple regression analysis using the log transformations was applied to determine the relationships among the four independent variables mentioned above thus the non dimensional coefficient of ship resistance under pack ice c pack can be assumed as follows 9 c p a c k 10 a f h b d f l o e b c c c o n c d w c h b e where d floe b and c conc denote the normalized ice floe size and ice concentration and w ch b denotes the normalized channel width for the model tests if it is assumed that the w ch is over 8 times the ship s beam the value of w ch b is 8 in the equation in addition a is the intercept of the regression analysis and b c d and e are the regression coefficients for the four variables respectively in this study the logarithmic transformation for the regression model with four independent variables was applied for the 42 test data items and the coefficients of non dimensional correlation were determined the regression coefficients between the log transformed variables are presented in table 6 along with the standard errors the value of the adjusted coefficient of determination is 0 971 and the high value for r square shows that the log log transformed data is a good fit for the regression model for the ship resistance under pack ice r pack is defined as 10 r p a c k 10 2 651 f h 1 665 d f l o e b 1 019 c c o n c 5 196 w c h b 1 211 1 2 ρ b h v 2 in eq 10 the coefficient of the pack ice froude number f h is found to be a negative value the normalized broken ice floe size by the ship s beam d floe b represents an approximately linear relationship and the ice concentration c conc and the normalized channel width by the ship s beam w ch b are related by power functions fig 16 shows the pack ice resistance as calculated from eq 10 against the measured results from the ice tests and the deviation between the measured results and the predicted results are summarized in table 7 as shown in fig 16 the predicted results represent the measured results quite well near the one to one curve but the predicted results are about 1 07 times higher than the measured results it is interesting to note that the large deviations mainly arise from the regression coefficient of the ice concentration woolgar and colbourne 2010 established a value of 5 88 for n with a standard error of 0 251 from the model test results for a floating offshore production vessel but the best fit was produced in this study when n was 5 20 with a standard error of 0 622 however the value of the standard error for ice concentrations was higher than other for variables the reason probably is that the there was some uncertainty in the use of image processing analysis to calculate the concentration of broken ice floes under the pack ice due to reflected light from the surface of the broken ice floes the error rates in identifying the ice concentration had a margin of error between 2 and 7 5 when comparing the results of the image analysis with those of the total quantity of inserted ice sheets i e actual ice concentration in the experiments see table 3 as mentioned above the exponent for normalized broken ice floe size by the ship s beam d floe b is close to 1 0 to verify how changes in the coefficient of the normalized broken ice floe size by the ship s beam d floe b in eq 10 affect the slope in fig 16 the coefficient is set to 1 0 related results are summarized in table 7 which shows when the value of d floe b is 1 0 the graph has a slope of approximately 1 09 there is no significant difference between measured and predicted results but standard deviation increases slightly therefore an exponent value of 1 0 for the normalized broken ice floe size by the ship s beam d floe b can be applied to simplify eq 10 but the value of 1 019 for d floe b is applied in this study according to the model test results the open water resistance component can be expressed as a cubic curve but the net pack ice resistance increases linearly with speed and the increasing rate of the pack ice resistance curve is much smaller than the open water resistance curve therefore ice model tests were conducted within a low speed range about 5 kts in full scale but eq 10 can be applied at a high speed range for calculating the pack ice resistance as well therefore the full scale pack ice resistance at various conditions can be calculated by eq 10 in accordance with kim et al 2018 the attainable net thrust t ant can be expressed as 11 t a n t 1 t t m c r r o w where t is the thrust deduction factor and t mcr is the maximum thrust at maximum continuous rating in this study the thrust deduction factor t was regarded as 0 135 in both open water and ice and ship resistance in open water for speeds in the range of 1 19 2 02 m s 10 17 kts in full scale was obtained from the resistance test in the kriso towing tank in fig 17 the characteristics of attainable net thrust for the icebreaker araon is plotted against the predicted ship resistance curve in pack ice with ice floe sizes of 0 3 and 0 5 m 5 7 and 9 5 m in full scale for 26 40 65 and 80 mm thicknesses 0 5 0 7 1 2 and 1 5 m in full scale at 80 and 90 ice concentrations in the figures the intersection points at each ice thickness h between the attainable net thrust curve and ship resistance curve in pack ice conditions describe the attainable ship speed v under certain ice thickness conditions from fig 17 the relationships can be defined as an h v curve describing the ship s performance diagram for each ice condition the h v curve has been applied generally to ship performance in level ice as it describes the icebreaking capability of a vessel by the ship speed achieved in certain ice thickness the h v curve under pack ice conditions does not consider the effects of ice concentration and ice floe size but it characterizes the effect of ship speed at certain ice thicknesses and would be useful when compared to the ship performance in level ice the simulated h v curves are given in fig 18 it can be seen that good performance in pack ice fields is achieved with enough margin the attainable ship speed of the icebreaker araon under pack ice conditions is much higher than the required ship speed in level ice i e 3 0 kt at 1 0 m thickness 3 8 comparison of full scale ice trials results and the predicted results to evaluate the established equation full scale ice trials of the icebreaker araon were conducted in the ross sea in december 2019 during the trials the ship s speed was obtained from the data of the voyage data recorder when the ship sailed through pack ice fields ice floes were rotated around the bow and parallel area of the ship and the ice thickness profiles could be derived from image processing analysis on the basis of object tracking the method developed by kim and nam 2016 made it possible to determine ice thickness during the ship s ice trials a detailed explanation of the object tracking and image processing procedures can be found in kim and nam 2016 fig 19 shows the rotated ice floes in the starboard area and the black line denotes the thickness of the ice floes field measurements were carried out with ice auger and coring equipment physical properties of the sea ice such as temperature salinity and density were measured in cored ice samples along the depth the flexural strength of the sea ice was then calculated using an empirical formula developed by timco and o brien 1994 the calculated flexural strength values ranged from 0 21 to 0 29 mpa broken ice floe size was not directly measured during the ice trials but considering the size of the 20 foot containers on the bow deck area in general the broken ice did not exceed 30 of the ship s beam i e about 5 7 m and from the bridge view images of icebreaker araon the channel width could be regarded as over 8 times the ship s beam see fig 4 with ice concentration at 80 90 and 100 conditions the calculated total ship resistance in pack ice against the attainable net thrust curve is shown in fig 20 and the measured average ship speed calculated ship speed and percentage error are summarized in table 8 as can be seen the predicted ship speeds are 12 57 12 14 and 5 93 kts respectively for each ice condition even though there are some differences between the measured values and the predicted values the results obtained using eq 10 are in reasonable agreement with the available data from full scale ice trials 4 conclusions this study presented the results of a study of ship resistance characteristics in pack ice first the preparation procedure for ice model testing in pack ice conditions was developed and then four variables channel width ice floe size ice concentration and ice thickness were investigated with quantitative results being obtained the following are the main conclusions from the experimental and predicted results in pack ice a significant reduction of pack ice resistance is obtained with an increase in channel width the results show that channel width strongly affects the amount of pack ice resistance and that resistance rapidly increases with the increase in broken ice floe size in addition ship resistance in pack ice depends strongly on the momentum exchange between the ship s hull and ice floes the rotating and sliding of the broken ice floes can cause additional forces in normal and tangential directions resulting from the ventilation of ice pieces and the interaction between the hull surface and the ice floes when the ship is advancing in pack ice fields when ice concentration increases pack ice resistance increases as well and the resistance tends to increase rapidly with increases in ice thickness both results follow an exponential trend it would be worth noting that ice thickness and concentration affect each other because they are related through the behavioral characteristics of broken ice floes below the waterlines in particular a pressure change in the ice floes affects the friction forces as the ship passes through the pack ice fields this phenomenon can have a significant impact on the increment of ship resistance under pack ice conditions in addition ship performance in pack ice is rather better than in level ice conditions the reliability of the proposed equation for predicting pack ice resistance was validated by comparing the predicted data with the full scale ice trial data from the icebreaker araon the predicted results were in relatively good agreement with those of the full scale ice trials in the ross sea in december 2019 this would be seem to indicate that the proposed equation has an acceptable level of reliability and can be used for ice going ships regarded as icebreakers there is still limited knowledge about ship resistance characteristics in pack ice fields however further studies should be conducted on the effects of other significant variables that might affect ship resistance in this study only one ice strength was considered therefore there is insufficient data available to determine how ice strength might affect ship resistance predictions since ice strength is to related ice piece fracturing further investigation should be carried out to thoroughly analyze the effect of fractures on broken ice floes in addition the dominant factor affecting ship resistance in pack ice is the friction generated between the ice and the hull therefore two different values for the coefficient of friction i e low and high friction coefficients should be considered by future study the results of such studies should be compared with available full scale ice trial data in order to improve the predictive accuracy of the established equation credit authorship contribution statement seong yeob jeong conceptualization writing original draft writing review editing kyungsik choi conceptualization investigation supervision hyun soo kim conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by a grant from endowment project of development of prediction method for turning ability in ice of ships operating in ice covered waters funded by the korea research institute of ships and ocean engineering prs0190 and the national r d project for the development of basic design technology for arc7 class arctic offshore structures funded by the ministry of trade industry and energy 10063417 the authors are very grateful to the captain and crew of the ibrv araon and to the icebreaker operation team of the korea polar research institute for their assistance 
21229,pack ice is a matter of considerable importance for ships and offshore structures operating in ice covered waters in particular arctic sea ice has been melting much faster recently than previously thought with ships and offshore structures in arctic regions and ice covered waters being frequently exposed to pack ice conditions consequently minimizing ice loads and ensuring safety under these conditions is a key consideration from a design perspective this study aims to provide a better understanding of ship resistance characteristics and to investigate the factors that influence ship resistance when navigating pack ice fields in the study a preparation procedure for pack ice conditions for model testing in an ice tank is introduced and some of the variables that can affect the ship resistance channel width broken ice floe size ice concentration and ice thickness are considered in the experiments the significance of each variable is discussed and non dimensional regression analysis is then applied to derive the relationships between the four variables and an equation for pack ice resistance prediction is established on the basis of this analysis the reliability of the equation is verified by comparing the predicted results and the results of full scale ice trials using the icebreaker araon keywords pack ice ice covered waters ship resistance characteristics non dimensional regression analysis pack ice resistance prediction 1 introduction the melting of the arctic ice sheet has caused shipping along the northern sea route to increase along with possibilities for economic development in the arctic regions such as production activities and exploration for natural resources yamal lng is one of the world s largest liquefied natural gas lng plant projects comprising gas production liquefaction and shipping with an output capacity of around 16 5 million tons per year from 2019 exported to east asia and europe by icebreaking tanker url https yamallng ru en for the arctic regions safe navigation is an absolute priority and one of the most important environmental factors is the condition of the ice when ships interact with it the sea surface during ship voyages in the arctic summer is typically covered by fragmented ice floes called pack ice thus ship resistance characteristics in pack ice is a significant aspect of ship performance predictions when considering the summer operations of vessels and ship performance in pack ice fields depends on factors such as ice concentration floe size and ice thickness many studies have been conducted to understand ship performance in pack ice murray and spencer 1996 conducted model tests of a semi submersible and a tanker hull in pack ice the model tests covered different thicknesses and concentrations colbourne 2000 presented prediction formulae based on the non dimensional relationships of moored ship shaped vessels and a full scale prediction methodology from experimental results brown 2002 investigated ship maneuverability under pack ice conditions by using hexagonally shaped paraffin wax to conduct the pack ice tests the study mainly focused on the calculation of maneuvering coefficients to develop a method for assessing the maneuverability of a ship in pack ice spencer and molyneux 2009 developed an equation for predicting loads on the hull due to pack ice based on model tests woolgar and colbourne 2006 studied the effect of the hull ice friction coefficient of a vessel with a bulbous bow they used a froude number based non dimensional methodology to predict the pack ice forces created by the pack ice loading for various friction coefficients in addition woolgar and colbourne 2010 studied the effect of hull ice friction under pack ice conditions for moored offshore vessels the study was based on a non dimensional analysis to establish the relationships between the predicted pack ice forces and the hull ice friction coefficient grochowalski and hermanski 2011 have conducted extensive work on ship resistance and propulsion characteristics under pack ice their study investigated the prediction of ship performance in broken ice fields and proposed an estimation method based on the model test results kim et al 2013 studied the resistance performance of an icebreaking cargo vessel in pack ice conditions both numerically and experimentally they analyzed ship resistance characteristics in different pack ice concentrations using an ls dyna commercial fe package and compared them with model test results sawamura et al 2018 investigated ice resistance characteristics using synthetic ice floes with a regular wave condition demonstrating that ice floe motion induced by waves affects ice resistance zhou et al 2019 carried out ice model tests using icebreaking tanker uikku to analyze the ice loading process and the physics of ice hull interaction zong and zhou 2019 studied the ice resistance of a ship moving in waters covered with broken ice floes they discovered that the ship resistance coefficient is proportional to squared ship velocity beam to length ratio ice thickness to length ratio and sea ice concentration kim et al 2019 proposed a numerical simulation for ice sea ice structure and ice ice interactions to minimize computational time and simulation results were compared with the model test results in an ice tank these results were in good agreement from an average ice load point of view an investigation of ice resistance in randomly distributed pack ice conditions was performed by yang et al 2020 they analyzed ship resistance in pack ice using a numerical model and simulation results were compared with the empirical formula wang et al 2020 investigated the effects of sailing speed and ice concentration on the ice loads of an ice area bulk carrier in broken ice they analyzed the characteristics of ice loads including the average ice loads extreme ice loads and characteristic frequency zong et al 2020 examined ship resistance in broken ice using artificial ice floes to investigate the influences of sea ice concentration floe shape and floe size on ship resistance as mentioned above ship resistance characteristics in pack ice are one of the significant issues in the performance predictions of ships in addition model tests in an ice tank can provide valuable information for ship resistance characteristics the international towing tank conference ittc ice committee provides the testing procedures and methods of analysis international towing tank committee ittc 2017a international towing tank committee ittc 2017b international towing tank committee ittc 2017c the guidelines provide detailed preparation procedures for various ice conditions such as level brash and ridged ice measurement methods of model ice properties and ice test procedures however the description of ice testing in pack ice conditions is quite simple consisting of a general description of the ice concentration and the classification of ice floe sizes in pack ice fields this means that it is quite difficult in experiments under pack ice conditions to simulate natural conditions identically for a range of environmental variables previous studies have investigated the effects of hull ice friction and ice concentration extensively with simulated results in line with model test results but the effects of channel width under pack ice broken ice floe size and thickness of ice have not been sufficiently examined the main purpose of this study is to better understand ship resistance characteristics for pack ice fields from a ship design perspective ship performance has become a critical aspect of a ship s operation in such conditions and several variables such as channel width broken ice floe size ice concentration and ice thickness are investigated by the model tests on an icebreaking ship the key to performing any experiment is to identify the variables that may affect the ship resistance characteristics in pack ice and how much influence the variables have on the amount of ship resistance in this study the quantitative results are obtained from the ice model tests the results can provide valuable information about ship performance characteristics under pack ice in addition a non dimensional regression analysis is performed to find the correlations between the four independent variables mentioned above and to formulate the relation equation the established equation could contribute significantly to predictions of a ship s resistance in pack ice fields 2 preparation of pack ice conditions in general the definition of pack ice is coverage of a large area by ice floes which can be divided according to size and horizontal extent international towing tank committee ittc 2017b with regard to pack ice conditions concentration is a significant factor affecting ship resistance characteristics ice concentration describes the percentage of area covered by floating ice of a known area it is typically given as a percentage 0 100 percent thus a low concentration indicates the presence of a few ice floes on the sea surface and a high concentration indicates that the surface is mostly composed of ice floes according to previous studies an ice concentration of above 60 can affect the efficient performance of a ship on its voyage but less than of 60 can be regarded as open sea conditions grochowalski and hermanski 2011 kim et al 2013 modeling methods of pack ice have not been defined clearly thus the preparation procedures for model testing for pack ice conditions are developed in this study preparation of pack ice is composed of three phases desired area calculation ice cutting and breaking of ice into floes and arrangements for the modeling of pack ice conditions first the required length and width of the test channel are calculated the cutting length and width are calculated while considering the ice concentration second after a parental level ice thickness has reached the target conditions parental level ice sheet cutting is accomplished using an electric chainsaw to the required channel width and then horizontal cuts of the parental level ice sheet are accomplished at the beginning and end locations of the ship track third the superfluous level ice sheet based at the beginning location of the testing channel is sawn and removed from the channel to achieve the desired concentration in the testing channel see fig 1 after the ice cutting the parental level ice sheets are broken into the desired ice floe size by manual type ice pushers on the service carriage along the testing channel the broken ice floes are then scattered irregularly using the ice pusher to simulate natural conditions as the ship advances the hull contacts broken ice floes and pieces of ice are pushed aside and forward some floes may push the parental level ice sheet especially if the sides of broken ice floe segments are parallel to that sheet to cause an additional force component to be applied to the ship as that component may interfere with the results of the ice model tests the flat side of ice floe segments must not be arranged parallel to the side wall of the testing channel these procedures can be relatively efficient methods for performing model testing under pack ice conditions fig 2 shows the pack ice prepared for ice model testing during the tests a camera is located on the ceiling to determine the ice floe size and coverage the information can be obtained from the image processing of photographs based on a localized binarization of quadtree subdivided image analysis for more details including the filtering threshold setting and binarization procedure can be found in lee et al 2017 fig 3 shows the calculation results of broken ice floe size distribution and concentration for the prepared pack ice test channel 3 model tests and results discussion 3 1 experimental conditions a series of ice model tests were carried out in the ice tank of the korea research institute of ships and ocean engineering kriso the ice tank length is 42 m long by 32 m wide and 2 5 m deep the model ice sheets were generated by a cooling seeding freezing and tempering process the production methods of the model ice and the property measurements are described in jeong et al 2017 propylene glycol pg was recently added to the cd eg ad model ice in the kriso ice tank where cd eg and ad denote controlled density ethylene glycol and an aliphatic detergent respectively pg is a compound that is generally recognized as environmentally friendly its chemical characteristics are quite similar to those of eg thus the model ice type used in the kriso ice tank is cd pg ed ad model ice jeong and ha 2020 studied the physical properties of this model ice during the tempering phase in this study a model of the korean icebreaking research vessel araon was used a scaling factor of λ 18 667 was used for these tests the korean icebreaking research vessel was designed to operate in 1m thick multi year ice with continuous icebreaking capability at 3 knots the ship has a displacement of approximately 6950 tons and a design draft of 6 8 m it is propelled by twin azimuth propulsion units driven by a diesel electric propulsion plant with a total propulsion power of 10 mw the main particulars of the model and full scale vessel are given in table 1 the model tests on the bare hull condition were conducted by towing the model at a constant speed through the pack ice conditions using a towing pole the model was constrained in surge and allowed limited sway in addition the model was restricted in yaw by a fork that was attached to the towing carriage the model was also connected to a parallel sliding bar at the bow and the stern however the model was mainly towed along in a forward direction so these constraints did not have a significant effect on ship resistance for each pack ice condition several tests were conducted at three velocities 1 3 and 5 knots in full scale the physical properties of each ice sheet were checked before and after each test in accordance with kriso s procedures jeong et al 2017 during the tests the density of the model ice was around 870 880 kg m3 and the frictional coefficient between the model ship s surface and model ice was taken as 0 05 for the pack ice conditions when a ship is sailing in the channel the ship and the ice interactions involve the turning and submerging of the ice floes and mainly crushing between the ice floes and the ship s hull or ice collisions with each other and spalling of the edges thus the compressive strength of the ice is a significant factor in the experiments the average compressive strength of the ice was approximately 1 19 mpa in full scale 63 7 kpa in model scale and the average flexural strength of the ice was about 0 74 mpa in full scale 39 6 kpa in model scale here the flexural strength of the ice was slightly greater than the general strength value of first year ice 0 63 mpa in full scale to obtain the particular compressive strength of the ice in the tests therefore a slightly high flexural strength of ice was used the elastic modulus was not directly measured but the range of elastic modulus is roughly 770 times its compressive strength according to a previous study jeong and ha 2020 in the tests two ice floe sizes were considered at 30 and 50 of the model ship s beam namely 0 3 and 0 5 m 5 7 and 9 5 m in full scale the value was based on the field observations from a full scale ice trial of the araon during the antarctic summer expedition in 2019 around the ross sea see fig 4 the model test conditions are summarized in table 2 and the calculated results for ice concentration and floe size based on the image processing analysis are summarized in table 3 according to colbourne 2000 the total resistance in pack ice r it can be considered as the sum of two resistance components 1 r i t r p a c k r o w where r pack and r ow denote the pack ice and open water resistance components in this study r it can be obtained directly from the ice model tests therefore the net pack ice resistance r pack can be calculated by subtracting the open water resistance component r ow from the total resistance in pack ice r it thus the net pack ice resistance r pack can be calculated as follows 2 r p a c k r i t r o w from previous open water resistance test results jeong et al 2011 the following equation for ship resistance in open water r ow was obtained 3 r o w 13 14 v 2 where v is the model ship speed in meter per second r ow measured in newtons and eq 3 is valid for v 1 07 m s 9 kts in full scale in addition ice model tests were carried out in low speed ranges from 0 119 to 0 595 m s 1 5 kts in full scale thus the skin friction drag component in the total ship resistance in pack ice was considered to be negligible 3 2 effect of channel width under pack ice the characteristics of ship resistance under pack ice is a matter of considerable importance but knowledge is still limited due to the relationships between variables such as channel width broken ice floe size ice concentration and ice thickness in particular the effect of channel width in pack ice has not been specified generally channel width can affect the amount of ship resistance thus model tests in pack ice with two different channel widths were performed to investigate how much influence the channel width had on the magnitude of ship resistance in pack ice for the tests two ice floe sizes were applied i e 0 3 and 0 5 m in model scale or 5 7 and 9 5 m in full scale the channel width effect is shown in fig 5 as can be seen from the figure the intercept of the fitting curve i e 0 m s indicates the speed independent resistance component in ice the average differences in pack ice resistance were 10 7 and 14 5 n respectively for both model ship speeds the test results showed that the channel width strongly affects the magnitude of ship resistance under pack ice and that resistance also increases with the increase of broken ice floe size accordingly experiments for various channel width conditions with 0 3 m of ice floe size and 80 ice concentration were carried out in order to verify whether ice floe size influences pack ice resistance characteristics the testing channels prepared are depicted in fig 6 and the results are summarized in table 4 the effect of the channel width can be quantified by calculating the deviation δ as follows 4 δ r m e a s u r e d r t a r g e t r t a r g e t 100 where r target is the resistance results of the channel width of 8 times the beam i e test no 200d and r measured is the resistance results for each channel width condition fig 7 shows the net pack ice resistance r pack for several different channel width conditions when the ship model enters the pack ice the broken ice floes around the waterline area are pushed by the model hull the broken ice floes push each other which leads to an interference effect at the channel wall and a ship resistance increment occurs in particular the magnitude of pack ice resistance decreases when the channel width increases but this decreasing trend converges when the channel width reaches 8 times the beam of the model ship if the broken ice floe size increases the convergence of pack ice resistance will occur at a wider channel width condition fig 8 shows the underwater feature for channel widths of 4 and 8 times the beam as the model ship enters the narrow pack ice channel it displaces the broken ice floes some of the broken ice floes are submerged and slide along the bottom of the model hull or are pushed to the side these ice floes can easily overlay one another and can cause a compressive force on the model ship pack ice resistance will thus increase in the relatively narrow channel due to the compression of the ice floes around the waterline area of the model ship the distribution of ice floes as the model ship passes through the pack ice is shown in fig 9 the yellow blue and red dashed lines denote channel widths that are 4 6 and 8 times the beam respectively when the model is moving through the pack ice the broken ice floes may overlap with one another in relatively narrow channel widths which further increases ship resistance more specifically interactions between the broken ice floes are more frequent in channels below 4 times the beam where the broken floes are pushed against the channel wall in addition when a ship model is proceeding through pack ice broken ice floes are pushed aside and forward simultaneously while ice floe compressions are formed in the pack ice therefore larger total resistance can be encountered in narrow channel width conditions as shown in fig 9 there is little significant difference for channels between 6 and 8 times the beam with regard to the movement of the ice floes but pack ice resistance is higher at 6 times the beam than 8 times the beam for both 80 and 90 ice concentrations due to the ice compression it is worth pointing out that the magnitude of ship resistance under pack ice should depend on channel width but ice floe size ice concentration and ice thickness also affect the amount of ship resistance the effects of the variables were therefore investigated 3 3 effect of broken ice floe size on resistance in pack ice as previously mentioned the floe size of broken ice can affect ship resistance in pack ice therefore two broken ice floe sizes 30 and 50 of the model ship s beam i e 0 3 and 0 5 m 5 7 m and 9 5 m in full scale were used in the experiments the model tests were carried out in ice 26 mm and 80 mm thick 0 5 and 1 5 m thick in full scale at 80 ice concentration in a channel width of 8 times the model ship s beam the ice floe size effect is presented in fig 10 the ship s resistance in pack ice given large floe size is much higher than with small floe size as can be seen from fig 10 pack ice resistance has exponential growth with the increase of ice floe size because pack ice resistance strongly depends on the momentum exchange between the ship s hull and the ice floes and the rotating and sliding of broken ice floes can cause additional ice forces resulting from the ventilation of ice pieces thus high pack ice resistance can occur in large ice floe size conditions the difference in pack ice resistance between 0 5 m floe size and 0 3 m floe size at 80 mm thick is greater than at 26 mm thick for 26 mm thickness and 80 coverage pack ice resistance with a 0 5 m floe size is approximately 1 6 times greater than that for a 0 3 m floe size and the pack ice resistance for 80 mm thickness with a 0 5 m floe size is 1 9 times greater on average than that for a 0 3 m floe size with the same ice concentration thus pack ice resistance with large floes and thicker ice may be much higher than for small floes 3 4 effect of ice concentration on resistance in pack ice ice model tests at three different ice concentrations 80 90 and 100 were carried out for two ice thicknesses namely 26 mm and 40 mm 0 5 and 0 7 m at full scale respectively with a channel width of 8 times the beam of the ship model with 0 3 m ice floe size for the experiments 100 ice concentration denotes the pre sawn ice condition in this case the pre sawn pack ice resistance may be different from that in an actual 100 ice concentration case due to the ship and ice interactions but the results can be significant for identifying ship resistance characteristics in pack ice prior to tests at 100 coverage the parental level ice was sawn to the required cutting patterns which is the bow breaking pattern of the ittc s recommended procedure international towing tank committee ittc 2017c the characteristics of pack ice resistance are presented in fig 11 as can be seen from the figure when the ice concentration increases the pack ice resistance also increases and the test results follow an exponential trend at 80 ice concentration the differences in pack ice resistance between ice thicknesses of 26 mm and 40 mm for three speeds are 4 0 6 0 and 7 8 n respectively at 90 ice concentration these differences are 7 4 9 2 and 12 6 n respectively furthermore the pack ice resistance at an ice thickness of 80 mm and 80 ice concentration is 5 5 times greater on average than that of 26 mm and the pack ice resistance at 80 mm thickness and 90 ice concentration is on average 3 9 times greater than that at 26 mm the ratio at 90 ice concentration is slightly lower than that at 80 but the differences in pack ice resistance at 90 according to the model ship s speeds are much greater than at 80 the effect of ice concentration for pack ice resistance at two ice thicknesses is illustrated in fig 12 the data are fitted to a power function of the ice concentration in addition the characteristics of ship resistance in ice are presented in fig 13 not only for the pack ice condition but also for the level ice condition as can be seen from the figure total ship resistance in level ice is significantly higher than for pack ice the total ship resistance in pack ice at 80 coverage with a 0 3 m ice floe size is approximately 18 6 of total ship resistance given level ice at 80 mm thick and 14 kpa flexural strength i e 1 5 m and 261 kpa in full scale and the value for 90 ice coverage with the same floe size is close to 30 6 of the level ice case these increasing trends can also be seen in 65 mm ice conditions this demonstrates that the breaking force component is mainly related to the flexural bending of the ice sheet in level ice during the ship and ice interactions thus ship resistance in level ice is higher than in pack ice 3 5 effect of ice thickness on resistance in pack ice to understand the effect of ice thickness model tests were performed with three different ice thicknesses for two ice concentrations in a channel width of 8 times the beam the test results of pack ice resistance for ice thickness variations corresponding to 26 40 65 and 80 mm i e 0 5 0 7 1 2 and 1 5 m in full scale are presented in fig 14 it appears that pack ice resistance tends to increase rapidly when ice thickness increases and the results show an exponential trend the intercept of the exponential fitting curve at zero speed i e 0 m s indicates the speed independent resistance component in ice in addition pack ice resistance at 40 mm thick is on average 1 8 times greater than that at 26 mm thick and pack ice resistance at 80 mm thick is on average 5 5 times greater than that at 26 mm thick with 80 ice concentration the increasing trends are shown for 90 ice concentration as well it would be worth noting that ice thickness and concentration affect each other since they are related through the behavioral characteristics of broken ice floes during the passing of the model ship through the pack ice conditions this phenomenon can have major effects on the increment of ship resistance fig 15 shows the underwater features while the model ship passes through the pack ice the broken ice floes can be rotated and submerged around the waterline area of the model due to the ship and ice interactions the turning and submerging of ice floes can be understood in terms of ship resistance as well as friction between the ship and ice floes accordingly the phenomena are closely related to increases in ship resistance under pack ice conditions as shown in fig 15 the model featured large amounts of submerged ice floes at 80 mm thick and 90 ice concentration and consequently pack ice resistance was greater than at 65 mm thickness with the same coverage 3 6 experimental uncertainty analysis for ice testing results the experimental uncertainty of the model test results must be taken into account when interpreting the ship resistance in pack ice to do this the results can be quantified by experimental uncertainty analysis derradji aouat 2004 and derradji aouat et al 2004 studied the experimental uncertainties in results obtained from ship model testing in an ice tank both studies were based on ship resistance tests for the canadian icebreaker terry fox contributing an important experimental uncertainty analysis that has been used to quantify experimental uncertainties in test results the detailed procedure is currently part of the ittc recommended guidelines for the experimental uncertainty analysis international towing tank committee ittc 2005 in the present study the random uncertainties are calculated based on the ittc recommended procedures international towing tank committee ittc 2005 the procedures indicate the segment length of each test run should be approximately 1 5 2 5 times the length of the model ship and one test run result should divided into 10 segments with each segment being analyzed as a statistically independent test if the general trends are repeated reasonably in each segment at a constant speed herein chauvenet s criterion is applied to identify outliers and the chauvenet number for mean tow force is 5 c h a u v m e a n f t m e a n m e a n f t m e a n s t d f t m e a n where chauv mean is the chauvenet number and f t mean is the mean tow force for each segment mean f t mean and std f t mean are the mean and standard deviation of the f t mean respectively chauvenet number values greater than 1 96 are disregarded the new mean of the means and the new standard deviation of the means are calculated from the remaining valid data points and the random uncertainty u f t mean is then derived as 6 u f t m e a n t s t d f t m e a n n where t is assumed to be 2 and n is the number of the valid data points after this the random uncertainty percentage u p f t mean can be expressed as 7 u p f t m e a n u f t m e a n m e a n f t m e a n 100 the calculated random uncertainty percentage for each ice test are summarized in table 5 in a previous study derradji aouat 2004 random uncertainties of up to 18 were obtained in broken ice tests but as can be seen from table 5 the uncertainty values ranged from 3 24 to 9 42 with the level of random uncertainty percentage falling slightly lower than those of derradji aouat 2004 furthermore the random uncertainties in broken ice at 100 coverage were relatively less than both the 80 and 90 coverages in the present study the pre sawn ice condition was regarded as 100 coverage representing when a ship proceeds through a pre sawn channel with ice floes constantly submerged and passing beneath the hull therefore the level of the random uncertainties is relatively smaller than those of 80 and 90 coverages however the random uncertainties in broken ice at actual 100 coverage will be higher than both 80 and 90 coverages because an irregular compression situation of broken ice floes around the waterline area of ship model will occur more frequently at high ice concentration than lower ice concentration 3 7 non dimensional analysis of ship resistance under pack ice in line with previous studies colbourne 2000 woolgar and colbourne 2006 2010 spencer and molyneux 2009 grochowalski and hermanski 2011 a non dimensional analysis was performed in order to predict ship resistance under pack ice conditions the non dimensional coefficient of pack ice resistance c pack and the ice thickness froude number f h was determined herein the original froude number is the non dimensional parameter in terms of wave making phenomena but the ship resistance in ice is strongly affected by the ice thickness therefore the ice thickness froude number was applied in this study these are given by the following equation 8 c p a c k r p a c k 1 2 ρ b h v 2 f h v g h where r pack is ship resistance under pack ice ρ is the density of the ice b is the model beam h is ice thickness v is the model ship speed and g is the acceleration due to gravity in the experiments only one friction coefficient i e 0 05 was considered so other variables such as ice thickness floe size ice concentration and channel width were investigated to establish an empirical relationship with the model test data in particular the pack ice resistance would depend on relative ratio of broken ice floe size to channel width thus the ratio is normalized to the ship s beam and non dimensional coefficients are established to extrapolate the model test data to full scale conditions based on froude scaling law in addition the independent variables are transformed by logarithmic function to predict the dependent variable therefore a multiple regression analysis using the log transformations was applied to determine the relationships among the four independent variables mentioned above thus the non dimensional coefficient of ship resistance under pack ice c pack can be assumed as follows 9 c p a c k 10 a f h b d f l o e b c c c o n c d w c h b e where d floe b and c conc denote the normalized ice floe size and ice concentration and w ch b denotes the normalized channel width for the model tests if it is assumed that the w ch is over 8 times the ship s beam the value of w ch b is 8 in the equation in addition a is the intercept of the regression analysis and b c d and e are the regression coefficients for the four variables respectively in this study the logarithmic transformation for the regression model with four independent variables was applied for the 42 test data items and the coefficients of non dimensional correlation were determined the regression coefficients between the log transformed variables are presented in table 6 along with the standard errors the value of the adjusted coefficient of determination is 0 971 and the high value for r square shows that the log log transformed data is a good fit for the regression model for the ship resistance under pack ice r pack is defined as 10 r p a c k 10 2 651 f h 1 665 d f l o e b 1 019 c c o n c 5 196 w c h b 1 211 1 2 ρ b h v 2 in eq 10 the coefficient of the pack ice froude number f h is found to be a negative value the normalized broken ice floe size by the ship s beam d floe b represents an approximately linear relationship and the ice concentration c conc and the normalized channel width by the ship s beam w ch b are related by power functions fig 16 shows the pack ice resistance as calculated from eq 10 against the measured results from the ice tests and the deviation between the measured results and the predicted results are summarized in table 7 as shown in fig 16 the predicted results represent the measured results quite well near the one to one curve but the predicted results are about 1 07 times higher than the measured results it is interesting to note that the large deviations mainly arise from the regression coefficient of the ice concentration woolgar and colbourne 2010 established a value of 5 88 for n with a standard error of 0 251 from the model test results for a floating offshore production vessel but the best fit was produced in this study when n was 5 20 with a standard error of 0 622 however the value of the standard error for ice concentrations was higher than other for variables the reason probably is that the there was some uncertainty in the use of image processing analysis to calculate the concentration of broken ice floes under the pack ice due to reflected light from the surface of the broken ice floes the error rates in identifying the ice concentration had a margin of error between 2 and 7 5 when comparing the results of the image analysis with those of the total quantity of inserted ice sheets i e actual ice concentration in the experiments see table 3 as mentioned above the exponent for normalized broken ice floe size by the ship s beam d floe b is close to 1 0 to verify how changes in the coefficient of the normalized broken ice floe size by the ship s beam d floe b in eq 10 affect the slope in fig 16 the coefficient is set to 1 0 related results are summarized in table 7 which shows when the value of d floe b is 1 0 the graph has a slope of approximately 1 09 there is no significant difference between measured and predicted results but standard deviation increases slightly therefore an exponent value of 1 0 for the normalized broken ice floe size by the ship s beam d floe b can be applied to simplify eq 10 but the value of 1 019 for d floe b is applied in this study according to the model test results the open water resistance component can be expressed as a cubic curve but the net pack ice resistance increases linearly with speed and the increasing rate of the pack ice resistance curve is much smaller than the open water resistance curve therefore ice model tests were conducted within a low speed range about 5 kts in full scale but eq 10 can be applied at a high speed range for calculating the pack ice resistance as well therefore the full scale pack ice resistance at various conditions can be calculated by eq 10 in accordance with kim et al 2018 the attainable net thrust t ant can be expressed as 11 t a n t 1 t t m c r r o w where t is the thrust deduction factor and t mcr is the maximum thrust at maximum continuous rating in this study the thrust deduction factor t was regarded as 0 135 in both open water and ice and ship resistance in open water for speeds in the range of 1 19 2 02 m s 10 17 kts in full scale was obtained from the resistance test in the kriso towing tank in fig 17 the characteristics of attainable net thrust for the icebreaker araon is plotted against the predicted ship resistance curve in pack ice with ice floe sizes of 0 3 and 0 5 m 5 7 and 9 5 m in full scale for 26 40 65 and 80 mm thicknesses 0 5 0 7 1 2 and 1 5 m in full scale at 80 and 90 ice concentrations in the figures the intersection points at each ice thickness h between the attainable net thrust curve and ship resistance curve in pack ice conditions describe the attainable ship speed v under certain ice thickness conditions from fig 17 the relationships can be defined as an h v curve describing the ship s performance diagram for each ice condition the h v curve has been applied generally to ship performance in level ice as it describes the icebreaking capability of a vessel by the ship speed achieved in certain ice thickness the h v curve under pack ice conditions does not consider the effects of ice concentration and ice floe size but it characterizes the effect of ship speed at certain ice thicknesses and would be useful when compared to the ship performance in level ice the simulated h v curves are given in fig 18 it can be seen that good performance in pack ice fields is achieved with enough margin the attainable ship speed of the icebreaker araon under pack ice conditions is much higher than the required ship speed in level ice i e 3 0 kt at 1 0 m thickness 3 8 comparison of full scale ice trials results and the predicted results to evaluate the established equation full scale ice trials of the icebreaker araon were conducted in the ross sea in december 2019 during the trials the ship s speed was obtained from the data of the voyage data recorder when the ship sailed through pack ice fields ice floes were rotated around the bow and parallel area of the ship and the ice thickness profiles could be derived from image processing analysis on the basis of object tracking the method developed by kim and nam 2016 made it possible to determine ice thickness during the ship s ice trials a detailed explanation of the object tracking and image processing procedures can be found in kim and nam 2016 fig 19 shows the rotated ice floes in the starboard area and the black line denotes the thickness of the ice floes field measurements were carried out with ice auger and coring equipment physical properties of the sea ice such as temperature salinity and density were measured in cored ice samples along the depth the flexural strength of the sea ice was then calculated using an empirical formula developed by timco and o brien 1994 the calculated flexural strength values ranged from 0 21 to 0 29 mpa broken ice floe size was not directly measured during the ice trials but considering the size of the 20 foot containers on the bow deck area in general the broken ice did not exceed 30 of the ship s beam i e about 5 7 m and from the bridge view images of icebreaker araon the channel width could be regarded as over 8 times the ship s beam see fig 4 with ice concentration at 80 90 and 100 conditions the calculated total ship resistance in pack ice against the attainable net thrust curve is shown in fig 20 and the measured average ship speed calculated ship speed and percentage error are summarized in table 8 as can be seen the predicted ship speeds are 12 57 12 14 and 5 93 kts respectively for each ice condition even though there are some differences between the measured values and the predicted values the results obtained using eq 10 are in reasonable agreement with the available data from full scale ice trials 4 conclusions this study presented the results of a study of ship resistance characteristics in pack ice first the preparation procedure for ice model testing in pack ice conditions was developed and then four variables channel width ice floe size ice concentration and ice thickness were investigated with quantitative results being obtained the following are the main conclusions from the experimental and predicted results in pack ice a significant reduction of pack ice resistance is obtained with an increase in channel width the results show that channel width strongly affects the amount of pack ice resistance and that resistance rapidly increases with the increase in broken ice floe size in addition ship resistance in pack ice depends strongly on the momentum exchange between the ship s hull and ice floes the rotating and sliding of the broken ice floes can cause additional forces in normal and tangential directions resulting from the ventilation of ice pieces and the interaction between the hull surface and the ice floes when the ship is advancing in pack ice fields when ice concentration increases pack ice resistance increases as well and the resistance tends to increase rapidly with increases in ice thickness both results follow an exponential trend it would be worth noting that ice thickness and concentration affect each other because they are related through the behavioral characteristics of broken ice floes below the waterlines in particular a pressure change in the ice floes affects the friction forces as the ship passes through the pack ice fields this phenomenon can have a significant impact on the increment of ship resistance under pack ice conditions in addition ship performance in pack ice is rather better than in level ice conditions the reliability of the proposed equation for predicting pack ice resistance was validated by comparing the predicted data with the full scale ice trial data from the icebreaker araon the predicted results were in relatively good agreement with those of the full scale ice trials in the ross sea in december 2019 this would be seem to indicate that the proposed equation has an acceptable level of reliability and can be used for ice going ships regarded as icebreakers there is still limited knowledge about ship resistance characteristics in pack ice fields however further studies should be conducted on the effects of other significant variables that might affect ship resistance in this study only one ice strength was considered therefore there is insufficient data available to determine how ice strength might affect ship resistance predictions since ice strength is to related ice piece fracturing further investigation should be carried out to thoroughly analyze the effect of fractures on broken ice floes in addition the dominant factor affecting ship resistance in pack ice is the friction generated between the ice and the hull therefore two different values for the coefficient of friction i e low and high friction coefficients should be considered by future study the results of such studies should be compared with available full scale ice trial data in order to improve the predictive accuracy of the established equation credit authorship contribution statement seong yeob jeong conceptualization writing original draft writing review editing kyungsik choi conceptualization investigation supervision hyun soo kim conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by a grant from endowment project of development of prediction method for turning ability in ice of ships operating in ice covered waters funded by the korea research institute of ships and ocean engineering prs0190 and the national r d project for the development of basic design technology for arc7 class arctic offshore structures funded by the ministry of trade industry and energy 10063417 the authors are very grateful to the captain and crew of the ibrv araon and to the icebreaker operation team of the korea polar research institute for their assistance 
