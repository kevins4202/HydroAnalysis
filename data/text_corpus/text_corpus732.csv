index,text
3660,reliable streamflow prediction is an important productive information in the hydrology and water resources management fields as used to forecast the nonlinear streamflow time series the conventional artificial intelligence model may suffer from local convergence defect and fail to track the dynamic changes of the hydrological process when the model parameters and network structure are not well identified thus this research develops a practical hydrological forecasting model based on parallel cooperation search algorithm pcsa and extreme learning machine elm where the standard elm method is chosen as the basic forecasting model and then the pcsa method using several smaller and independent subswarms for parallel computation is used to determine satisfying input hidden weights and hidden biases of the elm model the proposed model is used to forecast the nonlinear streamflow time series of several real world hydrological stations in china the results demonstrate that the proposed model outperforms the standard elm model in various evaluation indicators thus the key contributions of this study lie in two aspects 1 for the first time the parallel computing technique is developed to improve the global search ability and resources utilization efficiency of the emerging cooperation search algorithm 2 an artificial intelligence model coupled with parallel evolutionary optimizer is proposed to improve the prediction accuracy of hydrological time series keywords hydrological time series forecasting artificial intelligence evolutionary computation parallel computing 1 introduction accurate simulation and prediction of nonlinear hydrological time series can provide abundant information and strong technical support for water resources planning and management under changing environment ma et al 2013 zhang et al 2018 zheng et al 2017 reliable and accurate simulation and forecasting of streamflow play an important role in reducing the loss of natural hazard e g drought and flood and supporting the scientific planning and management of water resources si et al 2019 sun et al 2018 yin et al 2014 however it is difficult to model nonlinear streamflow process owing to many factors like runoff characteristics rainfall patterns and underlying surface conditions bai et al 2015 chang et al 2015 meng et al 2019 in order to meet the actual demand for forecasting scholars have paid growing attention to develop more effective models suitable for tracking nonlinear behaviors of natural runoff based on the involved internal mechanism hydrological models can be divided into two kinds of categories physical based models and data driven models wang et al 2015 wu and chau 2011 xu et al 2013 physical based models designs some modules or equations to simulate the physical process and interaction behaviors of hydrologic system badrzadeh et al 2015 gao et al 2020 qi et al 2019 xie et al 2019 but may produce dissatisfying forecasting results if the model structure or parameters are not suitable for the studied area cea et al 2010 jiang et al 2019 vogel et al 2021 on the other hand data driven models can well identify the latent nonlinearity of streamflow data whereas the relevant parameters and physical mechanism are not required morales et al 2021 tan et al 2018 zhang et al 2021 thus data driven models are becoming increasingly popular in hydrological forecasting field due to the high flexibility and reliability taormina and chau 2015 wang et al 2009 zhao et al 2006 single layer feedforward neural network slfn is one of the most famous data driven models with universal approximation ability which has been widely used in hydrology and water resource and other engineeering fields bo and qiwen 2021 dongli et al 2021 m tien 2020 traditional gradient based learning methods are often used to adjust the slfn parameters unfortunately these methods may need long execution time but provide suboptimal solutions in many scenarios huang et al 2012 huang and chen 2007 lan et al 2013 lendasse et al 2017 then extreme learning machine elm is developed to alleviate the drawbacks of gradient based methods after choosing the input weights and hidden biases elm uses the moore penrose generalized inverse method to deduce the hidden weights lima et al 2016 milukow et al 2019 taormina et al 2015 compared to the conventional gradient based method elm has higher learning rate stronger generalization ability and stopping condition avoidance however elm is easily trapped into local optimum due to the random selection of network parameters to enhance its generalization capability evolutionary algorithm is commonly used to search for the satisfying parameter combination of the elm model huang et al 2015 kumar et al 2019 zhu et al 2005 recently a novel population based evolutionary algorithm called cooperation search algorithm csa is developed for global optimization feng et al 2021 niu et al 2021a csa mimics the team cooperation behaviors in modern enterprises via three carefully designed search modules which includes the team communication operator for promoting global exploitation the reflective learning operator for improving local search and the internal competition operator for storing elite staffs feng and niu 2021 the applications show that the performances of the csa method are better than several traditional evolutionary algorithms the csa method characterized by rapid convergence speed and strong search ability is used to solve numerical functions and engineering optimization however the standard csa method using the large population sized mechanism and serial computing mode may suffer from local optima and low resource utilization efficiency in recent years parallel computing is becoming a popular tool to improve the performances of evolutionary algorithms for instance the parallel inverse modeling and uncertainty quantification are used to improve the performances of computationally demanding groundwater flow models elshall et al 2015 a parallel evolutionary algorithm is proposed for designing water distribution networks to minimize background leakage shafiee et al 2016 the self adaptive parallelization scheme exploiting cooperative search populations is developed to balance exploration uncertainty and computational demands in many objective reservoir optimization zatarain salazar et al 2017 a genetic algorithm parallel strategy is presented for operation optimization of reservoir with multiple eco environmental goals chen et al 2016 a parallel particle swarm optimization is developed for the operation of inter basin water transfer supply systems peng et al 2017 a multi population parallel co evolutionary differential evolution is used to optimize the parameters of photovoltaic models and enhance conversion efficiency of solar energy song et al 2021 the above studies collectively show that parallel computing is an effective alternative to overcome the defects in traditional algorithm although elm has already been widely used in streamflow prediction there are few literatures using parallel computing to improve its performance in hydrological time series forecasting in practice parallel computing can improve the search efficiency and solution efficiency of global optimization problem at the same time in other words it is of great importance to testify the possibility of resolving the elm parameters with a new parallel algorithm to refill this research gap this study for the first time proposes a parallel cooperation search algorithm pcsa based on the divide and conquer strategy in the fork join framework in pcsa a large sized population is firstly split into a set of small and independent subpopulations each subswarm uses the csa modules to concurrently find promising schemes on different units finally the results of all subswarms are merged to produce the final scheme by this mean the small population based evolution strategy and parallel computing tool are combined to enhance the csa performance on this basis this paper successfully develops a hybrid method for runoff prediction where the pcsa method is used to search for the ideal elm parameters the real world applications demonstrate the feasibility and reliability of the proposed model to sum up the main contributions of this study lie in two aspects 1 for the first time a parallelized version of the emerging csa method is developed to improve the search capability and execution efficiency 2 to accurately predict nonlinear runoff data series this research develops an effective evolutionary artificial intelligence model where the network parameters are optimized by parallel metaheuristic algorithm this paper is organized as follows section 2 gives the technical details of the proposed method section 3 testifies the performances of the proposed method section 4 gives the conclusions 2 methodologies 2 1 extreme learning machine elm elm illustrated in fig 1 is an effective learning technique developed to train the single layer feedforward neural network with a n node input layer a l node hidden layer and a m node hidden layer the core thought behind elm lies in that the nonlinear combination problem of multiple variables like input or output weights hidden biases is equal to determine the optimal outputs of a special linear system wang et al 2019 wen et al 2019 wu et al 2019 specially elm starts with the random assignments of the parameters between the input and hidden layers and then analytically obtains the output weights by the moore penrose generalized inverse method rather than the iterative adjustment procedures in the conventional gradient based method chen et al 2020 ghaith and li 2020 moon et al 2019 in this way elm is endowed the merits of fast learning rate strong generalization capability and stopping condition avoidance promoting its popularity in both regression and classification problems without loss of generality it is assumed that n pairs of distinct samples are involved in the training dataset and then the relevant outputs of the elm model with l hidden nodes is given as 1 t i l 1 l β l g w l x i b l i 1 2 n where n is the size of the training dataset l and i are the lth hidden nodes and the ith output nodes respectively g is the activation function for information conversion x i and t i are the ith input vectors and simulated vectors of the elm model w l and b l are the randomly assigned input weights and hidden biases i e the decision variables β l are the hidden output weights based on the elm theory the slfn model is able to ideally approach all the training samples without zero error which means that the simulated outputs are totally equal to the desired outputs the mathematical expression can be given as below 2 t i l 1 l β l g w l x i b l where t i is the ith desired output vector in the training dataset from the viewpoint of matrix eq 3 can be reformulated in the following compact manner 3 h β t where 4 h g w 1 x 1 b 1 g w l x 1 b l g w 1 x n b 1 g w l x n b l n l where β is the matrix of the hidden output weights t is the matrix of the desired outputs with n training vectors h is the output matrix of the hidden layer with n training samples for the specified input hidden weights and hidden bias the above equation will become a linear system and then the hidden output can be directly determined by 5 β h t where h is the moore penrose generalized inverse matrix of h 2 2 parallel cooperation search algorithm pcsa 2 2 1 cooperation search algorithm csa csa is an emerging population based evolutionary algorithm inspired by the team cooperation behaviors in modern enterprises niu et al 2021b in csa the search process of the optimization problem is seen as the enterprise development the candidate solution is seen as the staff while a set of staffs form the swarm for evolution the personal best known solution per staff and the global best known solutions of the swarm denote the board of supervisors and directors owing to its easy implementation and high efficiency csa can yield solutions with better performances than several traditional evolutionary algorithms promoting its applications in global optimization problems feng et al 2020 after randomly assigning the positions of the initial swarm the csa method makes use of three operators to incrementally approach promising areas including the team communication operator for gaining favorable information from elite agents the reflective learning operator for experience summarization and self improvement the internal competition operator for preserving elite agents for a population with i staffs the csa method searches for the minimal objective value of a j variable optimization problem in k cycles which can be briefly given as below 1 team building phase all elements of the initial staffs are randomly generated in the feasible problem space which can be expressed as below 6 x i j k ϕ x j x j i 1 i j 1 j k 1 where x i j k denotes the jth element of the ith solution at the kth iteration ϕ x x denotes the function for obtaining a uniformly random number in x x 2 team communication operator elite individuals with better performances often have larger chances to provide higher quality solutions hence the personal best known positions of each staff and the global best known position of the swarm are treated as the board of supervisors and directors each staff gradually gains knowledge from elite agents by 7 u i j k 1 x i j k a i j k b i j k c i j k i 1 i j 1 j k 1 k 8 a i j k log 1 ϕ 0 1 gbes t ind j k x i j k 9 b i j k α ϕ 0 1 1 m m 1 m gbes t m j k x i j k 10 c i j k β ϕ 0 1 1 i i 1 i pbes t i j k x i j k where pbes t i j k and gbes t ind j k are the jth element of the ith personal best known solution and the indth global best known solution at the kth iteration u i j k 1 is the jth element of the ith group solution at the k 1th iteration α and β are the positive adjusting parameters m is the number of the global best known solutions ind is the integer randomly chosen from 1 2 m 3 reflective learning operator for each staff active thinking and experience summarization are conducive to find the schemes for puzzling problems which can make obvious promotions on the comprehensive abilities of the staff in the long run 11 v i j k 1 r i j k 1 if u i j k 1 c j p i j k 1 if u i j k 1 c j i 1 i j 1 j k 1 k 12 r i j k 1 ϕ x j x j u i j k 1 c j if u i j k 1 c j ϕ 0 1 x j x j ϕ x j x j x j u i j k 1 otherwise 13 p i j k 1 ϕ c j x j x j u i j k 1 if u i j k 1 c j ϕ 0 1 x j x j ϕ x j x j u i j k 1 x j otherwise 14 c j x j x j 0 5 where v i j k 1 represents the jth element of the ith reflective solution at the k 1th iteration 4 internal competition operator to increase the team competitiveness and population quality the newly obtained staffs will become the members of the next generation if its performance is superior to the competitor 15 x i j k 1 u i j k 1 if f u i k 1 f v i k 1 v i j k 1 if f u i k 1 f v i k 1 i 1 i j 1 j k 1 k where f x is the fitness value of the solution x 2 2 2 fork join parallel computing framework fork join is a famous parallel computing framework based on the divide and conquer strategy coppa et al 2019 huo et al 2018 liu et al 2018 peng et al 2017 for the fork join framework in fig 2 the original large and complex computation task is firstly divided into a set of relatively simple subtasks secondary all the subtasks are assigned to various computing units and then resolved by some simple methods at the same time finally the main thread is blocked until the search process of all the subtasks are finished and then all the results are merged to produce the final solution for the original problem during the parallel computation process the father task will be iteratively divided into a group of subtasks until the size of the split subtask is smaller than the threshold value otherwise the obtained small sized subtasks can be directly resolved by the specified method obviously the parallel computing has a direct relation with the threshold value because it determines the start and stop of the recursive decomposition process a large threshold value may reduce the size of subtasks and fail to use the computing resource while a small value may yield a plenty of subtasks and lead to heavy overhead to balance execution efficiency and computation size the threshold value β is defined as 16 β round α p where round x denotes the minimum integer that is larger than x a and p denote the size of the optimization task and computing units respectively 2 2 3 parallel cooperation search algorithm for the standard csa method the search modules are executed in the serial computing mode and there are two possible defects deserving attention 1 similar to other evolutionary methods the staff s diversity is gradually decreased as the iteration proceed and then the csa method may suffer from the premature convergence problem with a large probability 2 compared with the small population parallel strategy the large sized population usually takes more time to finish the search process while the abundant computation resources are not fully unitized which may affect the engineering practicability of the csa method based on the above considerations this paper aims at developing a parallel cooperation search algorithm pcsa to alleviate the above defects in pcsa the large sized and small sized population are regarded as the father and child tasks respectively after randomly generating the initial staffs the pcsa method divides the large sized population into a set of small sized subswarms for concurrent execution in multiple threads each subswarm iteratively make use of the csa operators to improve the solution quality in the state space until the stopping criterion is met finally the main thread compares the performances of the solutions of all the subpopulations to determine the best solution it can be clearly seen in fig 3 that the pcsa method can use two or more computing units in the execution machine while the csa method can only use a single computing unit besides in pcsa several swarms start from different positions to independently search for solutions from generation to generation which can effectively improve the staff diversity and convergence rate compared to the standard csa method the pcsa method can make significant improvements in the computation complexity and execution efficiency by combining the small population search strategies and parallel computing technique besides the pcsa method can effectively finish more computing tasks with the increase of computing units or reduce the execution time in the same running environment 2 3 proposed hydrological forecasting method as mentioned above elm makes significant decreases in the training time of multiple variable regression problems by stochastically determining the network parameters rather than iterative tuning however the unadjusted parameters tend to yield suboptimal minimum or dissatisfactory network structure which will influence the model s generalization performance and increase the forecasting uncertainty for an elm model with n input nodes and l hidden nodes the number of parameters n l input hidden full connection weights and l hidden biases to be optimized will reach n l l obviously the parameters determination of the elm model or multilayer networks is a typical combination optimization problem to improve its performance various evolutionary algorithms have been used to optimize the elm parameters feng et al 2021 wen et al 2019 yaseen et al 2019 however these methods based on the serial computing mode not only suffers from long execution time but also fails to fully use the existing computing resources supposing n samples i solutions and j cycles are involved in the learning process the time complexity of evolutionary algorithm is in direct proportion to n i j when the values of the basic elements like n i or j become large the involved calculations may be too long to tolerate but the results may be still unsatisfying thus there are still crying needs for the integrated combination between advanced parallel technology and artificial intelligence model to settle this problem a novel hydrological forecasting model combining parallel evolutionary algorithm into artificial intelligence is developed for streamflow series prediction fig 4 draws the sketch map of the proposed model where the pcsa algorithm is used to optimize the network parameters of the elm model the main modules of the proposed method can be divided into three parts 1 population decomposition the initial large scale swarm i e father task is divided into a set of small and independent subswarms i e child task until the subproblem s size is smaller than the preset threshold value 2 parallel optimization each subtask is assigned to a computing unit based on the specified strategies and then make use of the csa modules to finish the evolutionary computation at the same time 3 model determination the main thread collects all the subtasks schemes to choose the best parameter combination for practical applications by combining the merits of parallel computing technique and advanced evolutionary algorithm the developed model can yield an artificial intelligence model possessing more compact structure than the elm model without parameter tuning in this way the generalization ability and forecasting performance of the neural network based model can be effectively improved next the execution procedures of the developed model for runoff prediction are briefly given as below step 1 parameter definition define the necessary computational parameters like the number of hidden nodes and activation function in elm the number of individuals and iterations as well as the threshold value in pcsa the raw input and output variables are adjusted to the normalized range and then divided into the training dataset and testing dataset step 2 population decomposition a thread pool is created to divide the large scale population into a set of subpopulations where each individual represents a possible model structure and its initial elements are randomly generated in the feasible decision space step 3 parallel optimization all the subpopulations are allocated to different computing units to finish the evolutionary process in a parallel manner for each subtask the objective values of all the individuals are firstly evaluated to update the board of supervisors and directors secondary the positions of all the staffs are dynamically updated with the guidance of three csa operators finally the above iterative search process is repeated until the stopping criteria is met for the target subpopulation the elements in the global best known staff are seen as the final input weights and hidden biases of the elm model and then the hidden weights can be obtained by the moore penrose generalized inverse method step 4 model determination the solutions produced by all the subpopulations are compared to choose the best model that can be used to forecast the runoff time series 3 case studies 3 1 study area and dataset in this section the long term daily runoff data collected from 4 hydrological stations are used to demonstrate the advantages of the proposed model fig 5 draws the streamflow time series of the studied hydrological stations the first about 70 dataset is used for training and validating while the rest for testing during the optimization process the 5 fold method is used to evaluate the quality of the solutions specially for the training dataset 80 subsets are used for training while the other data is used for validation at each experiment table 1 lists the statistical information of various datasets from hydrological stations a d it can be found that the training and testing datasets of 4 hydrological stations vary in a relatively large range which increases the modeling challenge and fully test the engineering applicability of the proposed model in the optimization process the raw data is normalized to the preset range to avoid the numerical problem and then the simulated outputs are renormalized into the original raw range to yield the results 3 2 evaluation indicators to fully assess the model s performance the following indexes are introduced for comparison including root mean squared error rmse mean absolute percentage error mape correlation coefficient r and nash sutcliffe efficiency nse rmse one of the most popular indexes in hydrological forecasting can effectively measure the total differences between the predicted data and the observed data which is defined as below 21 rmse 1 n i 1 n y i y i 2 where n is the size of dataset for evaluation y i and y i are the ith observed and forecasted value mape is an unbiased index designed to compute the relative accuracy between the predicted data and the observed data which is defined as below 22 mape 1 n i 1 n y i y i y i 100 r an index ranging from 1 to 1 can effectively measure the collinearity degree between the predicted data and the observed data a larger r value denotes a well behaved forecasting model if r 0 there is no linear relationship if r 1 or 1 there is a perfect positive or negative linear correlation the r definition is given as below 23 r i 1 n y i y avg y i y avg i 1 n y i y avg 2 y i y avg 2 where y avg and y avg denote the average of the observed and forecasted values nse a normalized index ranging from to 1 can measure the relative deviation between the predicted data and the observed data a larger nse value denotes the model s superiority if nse 1 an ideal match between the forecasted data and observed data exists if nse 0 the forecasting values are equal to the average of the observed dataset nse is defined as below 24 nse 1 i 1 n y i y i 2 i 1 n y i y avg 2 3 3 simulation of the proposed model at hydrological station a a typical forecasting model with different inputs can be expressed as eq 25 obviously the performance of a forecasting model is affected by input variables whereas it is not an easy work to directly find the ideal combinations 25 q t t h x t h q t 1 q t i q t l 1 where h is the developed forecasting model q t t is the simulated streamflow at period t t and q t i is the antecedent value at period t i l 1 is the number of antecedent streamflow for testifying the robustness of the proposed model various inputs are designed to develop reasonable forecasting models in the experiments the same parameters of both the elm model and the proposed model are set as the sigmoid function is chosen as the activation function the number of hidden nodes is defined as 2d because the strategy can provide satisfying simulation results in many cases feng and niu 2021 for the proposed method the number of staffs and iterations are set as 200 and 100 to balance execution efficiency and solution accuracy while all the cores in the execution machine are used for computing elm has no termination criteria while the proposed method stops when reaching the maximum iteration table 2 lists the statistical indexes of the 1 step ahead forecasting results by the proposed model with various inputs at station a as considering 1 antecedent runoff the performance of the proposed model is not good enough due to the smaller nse value in other cases the performances of the proposed model become better but change with input variables proving the importance of selecting parameter and inputs the possible reasons are analyzed as below if the size of inputs is too small the information is not enough to construct the forecasting model if the number of inputs is too large more noisy information are involved in the forecasting system and thereby the difficulty of parameters optimization is increased thus it is a challenging task to forecast the streamflow process since it is simultaneously affected by the input variables network structure and connection weights based on full consideration h9 with 10 antecedent inputs is seen as the best structure of the proposed model for runoff prediction table 3 lists the statistical indexes of the multi step ahead forecasting results by two models at hydrological station a it can be observed that the proposed model outperforms the standard elm model in various evaluation indexes at training and testing phases demonstrating the superiority of the modified strategies in improving the model s compactness for instance the 1 step ahead forecasting results of the proposed model betters the elm method with about 32 76 and 29 16 improvements in the rmse index at the training and testing phases besides with the increase of the forecasting period more uncertain factors are involved in the hydrological process and thereby the performances of two models become worse for instance as the forecasting period increase from 1 to 7 the nse values of the proposed model at the testing phases are reduced from 0 9323 to 0 4880 better than elm from 0 8652 to 0 4399 hence the feasibility of parallel evolutionary algorithm in improving the elm performance is proved for the sake of full comparison fig 6 draws the observed and forecasted streamflow obtained by two models where the x axis denotes the observed data and the y axis denotes the forecasted data in the scatter diagram when the forecasted and observed data have similar values the point pairs will gather around the ideal regression line y x while the regression coefficient is close to 1 in fig 6 two methods can well approximate the changing tendency of the observed runoff on the whole as the forecast periods increase the performances of two methods become worse but the proposed model is always superior to the elm method due to the larger regression coefficient thus the proposed model can effectively handle the complex runoff prediction problem 3 4 simulation of the proposed model at hydrological station b table 4 shows the statistical indexes of multi step ahead forecasting results by two models at hydrological station b the data shows that the results of the proposed model are superior to the control models at various forecasting periods for the 2 step ahead results the proposed model betters the original elm method with about 2 82 and 3 79 improvements in the nse value at the training and testing phases thus the integration of artificial intelligence and evolutionary algorithms can enhance the model s performance in the runoff forecasting task fig 7 compares the forecasting results obtained by different models for hydrological station b during the testing phase it can be clearly seen that the forecasting models can track the dynamic process of nonlinear streamflow time series demonstrating the effectiveness and feasibility of the developed models besides the performances of the standard elm method are inferior to the proposed model owing to the larger distances between its regression line and the ideal one hence the proposed method proves to be an effective tool for hydrological forecasting 3 5 simulation of the proposed model at hydrological station c table 5 lists the statistical indexes of the multi step ahead forecasting results obtained by two model at hydrological station c the data shows that the elm method without parameter tunning is inferior to the proposed model for instance the 7 step ahead forecasting result of the proposed model betters the original elm method with about 1 80 and 1 32 improvements in the r index at training and testing phases by combining parallel computing and evolutionary algorithm into artificial intelligence the proposed model becomes a competitive tool to address the runoff prediction task fig 8 shows the forecasting results obtained by different models for hydrological station c at the testing phase it can be seen that in different forecasting periods two models are able to mimic the changing process of the runoff series while the regression coefficients of the elm method are smaller than the proposed model for elm some important parameters remain unchanged after the random phase so that the neural network falls into some areas around local optima reducing its prediction ability for unknown operation scenes the superiority of the proposed model is contributed by the dynamic integration of artificial intelligence tool and parallel evolutionary algorithm thus the superiority of the proposed model in hydrological forecasting is proved 3 6 simulation of the proposed model at hydrological station d to demonstrate the effectiveness and necessity of the proposed method this section develops the gradient based back propagation neural network bp and several elm variants optimized by various evolutionary methods including genetic algorithm ga particle swarm optimization pso differential evolution de gravitational search algorithm gsa and csa table 6 lists the statistical indexes of 1 step ahead forecasting results by various model at hydrological station d where elm ea denotes that the elm model is optimized by the ea method it can be found that the performance of the traditional bp method is worse than other methods while the elm variants are superior to their origin version proving the importance of training technique besides the proposed model provides better forecasting results than several control methods for instance the rmse value of the proposed model are improved by about 41 4 36 9 21 2 17 7 21 5 18 3 and 13 1 than bp elm elm ga elm pso elm de elm gsa as well as elm csa at the testing phases fig 9 draws 1 step ahead forecasting results by various models at hydrological station d at the testing phase it can be seen that the forecasted runoff obtained by the proposed model is closer to the observed data due to its larger regression coefficient hence the superiority of the proposed model in simulating nonlinear runoff series are proved to further demonstrate its feasibility the proposed method is used to search for the parameters of neural networks with different number of nodes and layers table 7 gives the statistical indexes of 2 step ahead forecasting results of two models with different structures at hydrological station d fig 10 draws the rmse and r indexes of two models during the testing phase at hydrological station d when the number of hidden nodes per layer are not enough two models tend to yield poor performances with the increase of hidden layers nodes the number of variables to be optimized and the model complexity grow sharply increasing the difficulty of determining feasible parameter combinations owing to the strong search ability of the pcsa method the proposed model can find satisfying parameters to guarantee the generalization ability of the neural network producing stable solutions under different structure condition moreover regardless of the changing layers and nodes the proposed method still works well and produce better results than the standard elm model with respective to various indexes thus this case demonstrates the robustness of the pcsa method in optimizing neural network for hydrological forecasting 3 7 discussions for the standard elm model some nonideal parameters like input hidden weights and hidden biases may be randomly assigned at the initial phase but remain unchanged at the late learning process thus the elm method often falls into local optima and fails to yield satisfying results in practical applications from the mathematic viewpoint the choice of the elm parameters belongs to the typical complicated multivariable combination optimization problem that can be addressed by the population based evolutionary algorithms obviously the results of the target problem are directly influenced by the selected optimizer compared with several conventional evolutionary algorithms the csa method uses three well designed operators to effectively traverse the state space in an efficient manner which can balance the global exploration and local exploitation to produce high quality solutions even though the feasibility of combining the csa method into the elm model was proved in previous research results feng et al 2021 the abundant computing resources in normal computers are not fully utilized to overcome this defect this study develops the pcsa method to incrementally search for reasonable parameter combinations which can effectively improve the search ability of the swarm in the state space and increase the probability of finding better network structures compared with the csa method using the serial computing mode the pcsa method takes advantages of multiple computing units in normal computers to create two or more independent swarms for optimization the size of swarm is reduced to achieve the goal of avoiding the potential resources waste problem improving the search precision and execution efficiency by linking the parallel computing and evolutionary algorithm into artificial intelligence the proposed method can produce stronger network structures than the original elm method as used to address the hydrological forecasting problem besides the proposed approach may suffer from local convergence defect since it is difficult to guarantee the optimal forecasting model in theory hence the future research work can be directed to enhance the performances on the involved modules like the adaptive determination of network structure of the elm model the modified strategies of the csa method and their parallel implementations in cloud or distributed computing environment 4 conclusion to meet the growing requirement for accurate forecasting this study develops a practical runoff forecasting model by combining the merits of parallel cooperation search algorithm and artificial intelligence method specially a large sized population is firstly divided into several small and independent subpopulations to be synchronously executed at various computing units for each subswarm the csa modules are used to find the satisfying network parameters to improve the generalization ability of the elm model the streamflow data of several hydrological stations is chosen to testify the performance of the proposed model the experiment results indicate that the proposed method can effectively yield robust model structure and improve the prediction accuracy hence artificial intelligence model coupled with parallel evolutionary algorithm is a promising research direction in the hydrological forecasting filed declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is supported by the fundamental research funds for the central universities b210201046 national natural science foundation of china 52009012 51809072 u1865202 52039004 natural science foundation of hubei province 2020cfb340 the authors would like to thank editors and reviewers for their valuable comments and suggestions 
3660,reliable streamflow prediction is an important productive information in the hydrology and water resources management fields as used to forecast the nonlinear streamflow time series the conventional artificial intelligence model may suffer from local convergence defect and fail to track the dynamic changes of the hydrological process when the model parameters and network structure are not well identified thus this research develops a practical hydrological forecasting model based on parallel cooperation search algorithm pcsa and extreme learning machine elm where the standard elm method is chosen as the basic forecasting model and then the pcsa method using several smaller and independent subswarms for parallel computation is used to determine satisfying input hidden weights and hidden biases of the elm model the proposed model is used to forecast the nonlinear streamflow time series of several real world hydrological stations in china the results demonstrate that the proposed model outperforms the standard elm model in various evaluation indicators thus the key contributions of this study lie in two aspects 1 for the first time the parallel computing technique is developed to improve the global search ability and resources utilization efficiency of the emerging cooperation search algorithm 2 an artificial intelligence model coupled with parallel evolutionary optimizer is proposed to improve the prediction accuracy of hydrological time series keywords hydrological time series forecasting artificial intelligence evolutionary computation parallel computing 1 introduction accurate simulation and prediction of nonlinear hydrological time series can provide abundant information and strong technical support for water resources planning and management under changing environment ma et al 2013 zhang et al 2018 zheng et al 2017 reliable and accurate simulation and forecasting of streamflow play an important role in reducing the loss of natural hazard e g drought and flood and supporting the scientific planning and management of water resources si et al 2019 sun et al 2018 yin et al 2014 however it is difficult to model nonlinear streamflow process owing to many factors like runoff characteristics rainfall patterns and underlying surface conditions bai et al 2015 chang et al 2015 meng et al 2019 in order to meet the actual demand for forecasting scholars have paid growing attention to develop more effective models suitable for tracking nonlinear behaviors of natural runoff based on the involved internal mechanism hydrological models can be divided into two kinds of categories physical based models and data driven models wang et al 2015 wu and chau 2011 xu et al 2013 physical based models designs some modules or equations to simulate the physical process and interaction behaviors of hydrologic system badrzadeh et al 2015 gao et al 2020 qi et al 2019 xie et al 2019 but may produce dissatisfying forecasting results if the model structure or parameters are not suitable for the studied area cea et al 2010 jiang et al 2019 vogel et al 2021 on the other hand data driven models can well identify the latent nonlinearity of streamflow data whereas the relevant parameters and physical mechanism are not required morales et al 2021 tan et al 2018 zhang et al 2021 thus data driven models are becoming increasingly popular in hydrological forecasting field due to the high flexibility and reliability taormina and chau 2015 wang et al 2009 zhao et al 2006 single layer feedforward neural network slfn is one of the most famous data driven models with universal approximation ability which has been widely used in hydrology and water resource and other engineeering fields bo and qiwen 2021 dongli et al 2021 m tien 2020 traditional gradient based learning methods are often used to adjust the slfn parameters unfortunately these methods may need long execution time but provide suboptimal solutions in many scenarios huang et al 2012 huang and chen 2007 lan et al 2013 lendasse et al 2017 then extreme learning machine elm is developed to alleviate the drawbacks of gradient based methods after choosing the input weights and hidden biases elm uses the moore penrose generalized inverse method to deduce the hidden weights lima et al 2016 milukow et al 2019 taormina et al 2015 compared to the conventional gradient based method elm has higher learning rate stronger generalization ability and stopping condition avoidance however elm is easily trapped into local optimum due to the random selection of network parameters to enhance its generalization capability evolutionary algorithm is commonly used to search for the satisfying parameter combination of the elm model huang et al 2015 kumar et al 2019 zhu et al 2005 recently a novel population based evolutionary algorithm called cooperation search algorithm csa is developed for global optimization feng et al 2021 niu et al 2021a csa mimics the team cooperation behaviors in modern enterprises via three carefully designed search modules which includes the team communication operator for promoting global exploitation the reflective learning operator for improving local search and the internal competition operator for storing elite staffs feng and niu 2021 the applications show that the performances of the csa method are better than several traditional evolutionary algorithms the csa method characterized by rapid convergence speed and strong search ability is used to solve numerical functions and engineering optimization however the standard csa method using the large population sized mechanism and serial computing mode may suffer from local optima and low resource utilization efficiency in recent years parallel computing is becoming a popular tool to improve the performances of evolutionary algorithms for instance the parallel inverse modeling and uncertainty quantification are used to improve the performances of computationally demanding groundwater flow models elshall et al 2015 a parallel evolutionary algorithm is proposed for designing water distribution networks to minimize background leakage shafiee et al 2016 the self adaptive parallelization scheme exploiting cooperative search populations is developed to balance exploration uncertainty and computational demands in many objective reservoir optimization zatarain salazar et al 2017 a genetic algorithm parallel strategy is presented for operation optimization of reservoir with multiple eco environmental goals chen et al 2016 a parallel particle swarm optimization is developed for the operation of inter basin water transfer supply systems peng et al 2017 a multi population parallel co evolutionary differential evolution is used to optimize the parameters of photovoltaic models and enhance conversion efficiency of solar energy song et al 2021 the above studies collectively show that parallel computing is an effective alternative to overcome the defects in traditional algorithm although elm has already been widely used in streamflow prediction there are few literatures using parallel computing to improve its performance in hydrological time series forecasting in practice parallel computing can improve the search efficiency and solution efficiency of global optimization problem at the same time in other words it is of great importance to testify the possibility of resolving the elm parameters with a new parallel algorithm to refill this research gap this study for the first time proposes a parallel cooperation search algorithm pcsa based on the divide and conquer strategy in the fork join framework in pcsa a large sized population is firstly split into a set of small and independent subpopulations each subswarm uses the csa modules to concurrently find promising schemes on different units finally the results of all subswarms are merged to produce the final scheme by this mean the small population based evolution strategy and parallel computing tool are combined to enhance the csa performance on this basis this paper successfully develops a hybrid method for runoff prediction where the pcsa method is used to search for the ideal elm parameters the real world applications demonstrate the feasibility and reliability of the proposed model to sum up the main contributions of this study lie in two aspects 1 for the first time a parallelized version of the emerging csa method is developed to improve the search capability and execution efficiency 2 to accurately predict nonlinear runoff data series this research develops an effective evolutionary artificial intelligence model where the network parameters are optimized by parallel metaheuristic algorithm this paper is organized as follows section 2 gives the technical details of the proposed method section 3 testifies the performances of the proposed method section 4 gives the conclusions 2 methodologies 2 1 extreme learning machine elm elm illustrated in fig 1 is an effective learning technique developed to train the single layer feedforward neural network with a n node input layer a l node hidden layer and a m node hidden layer the core thought behind elm lies in that the nonlinear combination problem of multiple variables like input or output weights hidden biases is equal to determine the optimal outputs of a special linear system wang et al 2019 wen et al 2019 wu et al 2019 specially elm starts with the random assignments of the parameters between the input and hidden layers and then analytically obtains the output weights by the moore penrose generalized inverse method rather than the iterative adjustment procedures in the conventional gradient based method chen et al 2020 ghaith and li 2020 moon et al 2019 in this way elm is endowed the merits of fast learning rate strong generalization capability and stopping condition avoidance promoting its popularity in both regression and classification problems without loss of generality it is assumed that n pairs of distinct samples are involved in the training dataset and then the relevant outputs of the elm model with l hidden nodes is given as 1 t i l 1 l β l g w l x i b l i 1 2 n where n is the size of the training dataset l and i are the lth hidden nodes and the ith output nodes respectively g is the activation function for information conversion x i and t i are the ith input vectors and simulated vectors of the elm model w l and b l are the randomly assigned input weights and hidden biases i e the decision variables β l are the hidden output weights based on the elm theory the slfn model is able to ideally approach all the training samples without zero error which means that the simulated outputs are totally equal to the desired outputs the mathematical expression can be given as below 2 t i l 1 l β l g w l x i b l where t i is the ith desired output vector in the training dataset from the viewpoint of matrix eq 3 can be reformulated in the following compact manner 3 h β t where 4 h g w 1 x 1 b 1 g w l x 1 b l g w 1 x n b 1 g w l x n b l n l where β is the matrix of the hidden output weights t is the matrix of the desired outputs with n training vectors h is the output matrix of the hidden layer with n training samples for the specified input hidden weights and hidden bias the above equation will become a linear system and then the hidden output can be directly determined by 5 β h t where h is the moore penrose generalized inverse matrix of h 2 2 parallel cooperation search algorithm pcsa 2 2 1 cooperation search algorithm csa csa is an emerging population based evolutionary algorithm inspired by the team cooperation behaviors in modern enterprises niu et al 2021b in csa the search process of the optimization problem is seen as the enterprise development the candidate solution is seen as the staff while a set of staffs form the swarm for evolution the personal best known solution per staff and the global best known solutions of the swarm denote the board of supervisors and directors owing to its easy implementation and high efficiency csa can yield solutions with better performances than several traditional evolutionary algorithms promoting its applications in global optimization problems feng et al 2020 after randomly assigning the positions of the initial swarm the csa method makes use of three operators to incrementally approach promising areas including the team communication operator for gaining favorable information from elite agents the reflective learning operator for experience summarization and self improvement the internal competition operator for preserving elite agents for a population with i staffs the csa method searches for the minimal objective value of a j variable optimization problem in k cycles which can be briefly given as below 1 team building phase all elements of the initial staffs are randomly generated in the feasible problem space which can be expressed as below 6 x i j k ϕ x j x j i 1 i j 1 j k 1 where x i j k denotes the jth element of the ith solution at the kth iteration ϕ x x denotes the function for obtaining a uniformly random number in x x 2 team communication operator elite individuals with better performances often have larger chances to provide higher quality solutions hence the personal best known positions of each staff and the global best known position of the swarm are treated as the board of supervisors and directors each staff gradually gains knowledge from elite agents by 7 u i j k 1 x i j k a i j k b i j k c i j k i 1 i j 1 j k 1 k 8 a i j k log 1 ϕ 0 1 gbes t ind j k x i j k 9 b i j k α ϕ 0 1 1 m m 1 m gbes t m j k x i j k 10 c i j k β ϕ 0 1 1 i i 1 i pbes t i j k x i j k where pbes t i j k and gbes t ind j k are the jth element of the ith personal best known solution and the indth global best known solution at the kth iteration u i j k 1 is the jth element of the ith group solution at the k 1th iteration α and β are the positive adjusting parameters m is the number of the global best known solutions ind is the integer randomly chosen from 1 2 m 3 reflective learning operator for each staff active thinking and experience summarization are conducive to find the schemes for puzzling problems which can make obvious promotions on the comprehensive abilities of the staff in the long run 11 v i j k 1 r i j k 1 if u i j k 1 c j p i j k 1 if u i j k 1 c j i 1 i j 1 j k 1 k 12 r i j k 1 ϕ x j x j u i j k 1 c j if u i j k 1 c j ϕ 0 1 x j x j ϕ x j x j x j u i j k 1 otherwise 13 p i j k 1 ϕ c j x j x j u i j k 1 if u i j k 1 c j ϕ 0 1 x j x j ϕ x j x j u i j k 1 x j otherwise 14 c j x j x j 0 5 where v i j k 1 represents the jth element of the ith reflective solution at the k 1th iteration 4 internal competition operator to increase the team competitiveness and population quality the newly obtained staffs will become the members of the next generation if its performance is superior to the competitor 15 x i j k 1 u i j k 1 if f u i k 1 f v i k 1 v i j k 1 if f u i k 1 f v i k 1 i 1 i j 1 j k 1 k where f x is the fitness value of the solution x 2 2 2 fork join parallel computing framework fork join is a famous parallel computing framework based on the divide and conquer strategy coppa et al 2019 huo et al 2018 liu et al 2018 peng et al 2017 for the fork join framework in fig 2 the original large and complex computation task is firstly divided into a set of relatively simple subtasks secondary all the subtasks are assigned to various computing units and then resolved by some simple methods at the same time finally the main thread is blocked until the search process of all the subtasks are finished and then all the results are merged to produce the final solution for the original problem during the parallel computation process the father task will be iteratively divided into a group of subtasks until the size of the split subtask is smaller than the threshold value otherwise the obtained small sized subtasks can be directly resolved by the specified method obviously the parallel computing has a direct relation with the threshold value because it determines the start and stop of the recursive decomposition process a large threshold value may reduce the size of subtasks and fail to use the computing resource while a small value may yield a plenty of subtasks and lead to heavy overhead to balance execution efficiency and computation size the threshold value β is defined as 16 β round α p where round x denotes the minimum integer that is larger than x a and p denote the size of the optimization task and computing units respectively 2 2 3 parallel cooperation search algorithm for the standard csa method the search modules are executed in the serial computing mode and there are two possible defects deserving attention 1 similar to other evolutionary methods the staff s diversity is gradually decreased as the iteration proceed and then the csa method may suffer from the premature convergence problem with a large probability 2 compared with the small population parallel strategy the large sized population usually takes more time to finish the search process while the abundant computation resources are not fully unitized which may affect the engineering practicability of the csa method based on the above considerations this paper aims at developing a parallel cooperation search algorithm pcsa to alleviate the above defects in pcsa the large sized and small sized population are regarded as the father and child tasks respectively after randomly generating the initial staffs the pcsa method divides the large sized population into a set of small sized subswarms for concurrent execution in multiple threads each subswarm iteratively make use of the csa operators to improve the solution quality in the state space until the stopping criterion is met finally the main thread compares the performances of the solutions of all the subpopulations to determine the best solution it can be clearly seen in fig 3 that the pcsa method can use two or more computing units in the execution machine while the csa method can only use a single computing unit besides in pcsa several swarms start from different positions to independently search for solutions from generation to generation which can effectively improve the staff diversity and convergence rate compared to the standard csa method the pcsa method can make significant improvements in the computation complexity and execution efficiency by combining the small population search strategies and parallel computing technique besides the pcsa method can effectively finish more computing tasks with the increase of computing units or reduce the execution time in the same running environment 2 3 proposed hydrological forecasting method as mentioned above elm makes significant decreases in the training time of multiple variable regression problems by stochastically determining the network parameters rather than iterative tuning however the unadjusted parameters tend to yield suboptimal minimum or dissatisfactory network structure which will influence the model s generalization performance and increase the forecasting uncertainty for an elm model with n input nodes and l hidden nodes the number of parameters n l input hidden full connection weights and l hidden biases to be optimized will reach n l l obviously the parameters determination of the elm model or multilayer networks is a typical combination optimization problem to improve its performance various evolutionary algorithms have been used to optimize the elm parameters feng et al 2021 wen et al 2019 yaseen et al 2019 however these methods based on the serial computing mode not only suffers from long execution time but also fails to fully use the existing computing resources supposing n samples i solutions and j cycles are involved in the learning process the time complexity of evolutionary algorithm is in direct proportion to n i j when the values of the basic elements like n i or j become large the involved calculations may be too long to tolerate but the results may be still unsatisfying thus there are still crying needs for the integrated combination between advanced parallel technology and artificial intelligence model to settle this problem a novel hydrological forecasting model combining parallel evolutionary algorithm into artificial intelligence is developed for streamflow series prediction fig 4 draws the sketch map of the proposed model where the pcsa algorithm is used to optimize the network parameters of the elm model the main modules of the proposed method can be divided into three parts 1 population decomposition the initial large scale swarm i e father task is divided into a set of small and independent subswarms i e child task until the subproblem s size is smaller than the preset threshold value 2 parallel optimization each subtask is assigned to a computing unit based on the specified strategies and then make use of the csa modules to finish the evolutionary computation at the same time 3 model determination the main thread collects all the subtasks schemes to choose the best parameter combination for practical applications by combining the merits of parallel computing technique and advanced evolutionary algorithm the developed model can yield an artificial intelligence model possessing more compact structure than the elm model without parameter tuning in this way the generalization ability and forecasting performance of the neural network based model can be effectively improved next the execution procedures of the developed model for runoff prediction are briefly given as below step 1 parameter definition define the necessary computational parameters like the number of hidden nodes and activation function in elm the number of individuals and iterations as well as the threshold value in pcsa the raw input and output variables are adjusted to the normalized range and then divided into the training dataset and testing dataset step 2 population decomposition a thread pool is created to divide the large scale population into a set of subpopulations where each individual represents a possible model structure and its initial elements are randomly generated in the feasible decision space step 3 parallel optimization all the subpopulations are allocated to different computing units to finish the evolutionary process in a parallel manner for each subtask the objective values of all the individuals are firstly evaluated to update the board of supervisors and directors secondary the positions of all the staffs are dynamically updated with the guidance of three csa operators finally the above iterative search process is repeated until the stopping criteria is met for the target subpopulation the elements in the global best known staff are seen as the final input weights and hidden biases of the elm model and then the hidden weights can be obtained by the moore penrose generalized inverse method step 4 model determination the solutions produced by all the subpopulations are compared to choose the best model that can be used to forecast the runoff time series 3 case studies 3 1 study area and dataset in this section the long term daily runoff data collected from 4 hydrological stations are used to demonstrate the advantages of the proposed model fig 5 draws the streamflow time series of the studied hydrological stations the first about 70 dataset is used for training and validating while the rest for testing during the optimization process the 5 fold method is used to evaluate the quality of the solutions specially for the training dataset 80 subsets are used for training while the other data is used for validation at each experiment table 1 lists the statistical information of various datasets from hydrological stations a d it can be found that the training and testing datasets of 4 hydrological stations vary in a relatively large range which increases the modeling challenge and fully test the engineering applicability of the proposed model in the optimization process the raw data is normalized to the preset range to avoid the numerical problem and then the simulated outputs are renormalized into the original raw range to yield the results 3 2 evaluation indicators to fully assess the model s performance the following indexes are introduced for comparison including root mean squared error rmse mean absolute percentage error mape correlation coefficient r and nash sutcliffe efficiency nse rmse one of the most popular indexes in hydrological forecasting can effectively measure the total differences between the predicted data and the observed data which is defined as below 21 rmse 1 n i 1 n y i y i 2 where n is the size of dataset for evaluation y i and y i are the ith observed and forecasted value mape is an unbiased index designed to compute the relative accuracy between the predicted data and the observed data which is defined as below 22 mape 1 n i 1 n y i y i y i 100 r an index ranging from 1 to 1 can effectively measure the collinearity degree between the predicted data and the observed data a larger r value denotes a well behaved forecasting model if r 0 there is no linear relationship if r 1 or 1 there is a perfect positive or negative linear correlation the r definition is given as below 23 r i 1 n y i y avg y i y avg i 1 n y i y avg 2 y i y avg 2 where y avg and y avg denote the average of the observed and forecasted values nse a normalized index ranging from to 1 can measure the relative deviation between the predicted data and the observed data a larger nse value denotes the model s superiority if nse 1 an ideal match between the forecasted data and observed data exists if nse 0 the forecasting values are equal to the average of the observed dataset nse is defined as below 24 nse 1 i 1 n y i y i 2 i 1 n y i y avg 2 3 3 simulation of the proposed model at hydrological station a a typical forecasting model with different inputs can be expressed as eq 25 obviously the performance of a forecasting model is affected by input variables whereas it is not an easy work to directly find the ideal combinations 25 q t t h x t h q t 1 q t i q t l 1 where h is the developed forecasting model q t t is the simulated streamflow at period t t and q t i is the antecedent value at period t i l 1 is the number of antecedent streamflow for testifying the robustness of the proposed model various inputs are designed to develop reasonable forecasting models in the experiments the same parameters of both the elm model and the proposed model are set as the sigmoid function is chosen as the activation function the number of hidden nodes is defined as 2d because the strategy can provide satisfying simulation results in many cases feng and niu 2021 for the proposed method the number of staffs and iterations are set as 200 and 100 to balance execution efficiency and solution accuracy while all the cores in the execution machine are used for computing elm has no termination criteria while the proposed method stops when reaching the maximum iteration table 2 lists the statistical indexes of the 1 step ahead forecasting results by the proposed model with various inputs at station a as considering 1 antecedent runoff the performance of the proposed model is not good enough due to the smaller nse value in other cases the performances of the proposed model become better but change with input variables proving the importance of selecting parameter and inputs the possible reasons are analyzed as below if the size of inputs is too small the information is not enough to construct the forecasting model if the number of inputs is too large more noisy information are involved in the forecasting system and thereby the difficulty of parameters optimization is increased thus it is a challenging task to forecast the streamflow process since it is simultaneously affected by the input variables network structure and connection weights based on full consideration h9 with 10 antecedent inputs is seen as the best structure of the proposed model for runoff prediction table 3 lists the statistical indexes of the multi step ahead forecasting results by two models at hydrological station a it can be observed that the proposed model outperforms the standard elm model in various evaluation indexes at training and testing phases demonstrating the superiority of the modified strategies in improving the model s compactness for instance the 1 step ahead forecasting results of the proposed model betters the elm method with about 32 76 and 29 16 improvements in the rmse index at the training and testing phases besides with the increase of the forecasting period more uncertain factors are involved in the hydrological process and thereby the performances of two models become worse for instance as the forecasting period increase from 1 to 7 the nse values of the proposed model at the testing phases are reduced from 0 9323 to 0 4880 better than elm from 0 8652 to 0 4399 hence the feasibility of parallel evolutionary algorithm in improving the elm performance is proved for the sake of full comparison fig 6 draws the observed and forecasted streamflow obtained by two models where the x axis denotes the observed data and the y axis denotes the forecasted data in the scatter diagram when the forecasted and observed data have similar values the point pairs will gather around the ideal regression line y x while the regression coefficient is close to 1 in fig 6 two methods can well approximate the changing tendency of the observed runoff on the whole as the forecast periods increase the performances of two methods become worse but the proposed model is always superior to the elm method due to the larger regression coefficient thus the proposed model can effectively handle the complex runoff prediction problem 3 4 simulation of the proposed model at hydrological station b table 4 shows the statistical indexes of multi step ahead forecasting results by two models at hydrological station b the data shows that the results of the proposed model are superior to the control models at various forecasting periods for the 2 step ahead results the proposed model betters the original elm method with about 2 82 and 3 79 improvements in the nse value at the training and testing phases thus the integration of artificial intelligence and evolutionary algorithms can enhance the model s performance in the runoff forecasting task fig 7 compares the forecasting results obtained by different models for hydrological station b during the testing phase it can be clearly seen that the forecasting models can track the dynamic process of nonlinear streamflow time series demonstrating the effectiveness and feasibility of the developed models besides the performances of the standard elm method are inferior to the proposed model owing to the larger distances between its regression line and the ideal one hence the proposed method proves to be an effective tool for hydrological forecasting 3 5 simulation of the proposed model at hydrological station c table 5 lists the statistical indexes of the multi step ahead forecasting results obtained by two model at hydrological station c the data shows that the elm method without parameter tunning is inferior to the proposed model for instance the 7 step ahead forecasting result of the proposed model betters the original elm method with about 1 80 and 1 32 improvements in the r index at training and testing phases by combining parallel computing and evolutionary algorithm into artificial intelligence the proposed model becomes a competitive tool to address the runoff prediction task fig 8 shows the forecasting results obtained by different models for hydrological station c at the testing phase it can be seen that in different forecasting periods two models are able to mimic the changing process of the runoff series while the regression coefficients of the elm method are smaller than the proposed model for elm some important parameters remain unchanged after the random phase so that the neural network falls into some areas around local optima reducing its prediction ability for unknown operation scenes the superiority of the proposed model is contributed by the dynamic integration of artificial intelligence tool and parallel evolutionary algorithm thus the superiority of the proposed model in hydrological forecasting is proved 3 6 simulation of the proposed model at hydrological station d to demonstrate the effectiveness and necessity of the proposed method this section develops the gradient based back propagation neural network bp and several elm variants optimized by various evolutionary methods including genetic algorithm ga particle swarm optimization pso differential evolution de gravitational search algorithm gsa and csa table 6 lists the statistical indexes of 1 step ahead forecasting results by various model at hydrological station d where elm ea denotes that the elm model is optimized by the ea method it can be found that the performance of the traditional bp method is worse than other methods while the elm variants are superior to their origin version proving the importance of training technique besides the proposed model provides better forecasting results than several control methods for instance the rmse value of the proposed model are improved by about 41 4 36 9 21 2 17 7 21 5 18 3 and 13 1 than bp elm elm ga elm pso elm de elm gsa as well as elm csa at the testing phases fig 9 draws 1 step ahead forecasting results by various models at hydrological station d at the testing phase it can be seen that the forecasted runoff obtained by the proposed model is closer to the observed data due to its larger regression coefficient hence the superiority of the proposed model in simulating nonlinear runoff series are proved to further demonstrate its feasibility the proposed method is used to search for the parameters of neural networks with different number of nodes and layers table 7 gives the statistical indexes of 2 step ahead forecasting results of two models with different structures at hydrological station d fig 10 draws the rmse and r indexes of two models during the testing phase at hydrological station d when the number of hidden nodes per layer are not enough two models tend to yield poor performances with the increase of hidden layers nodes the number of variables to be optimized and the model complexity grow sharply increasing the difficulty of determining feasible parameter combinations owing to the strong search ability of the pcsa method the proposed model can find satisfying parameters to guarantee the generalization ability of the neural network producing stable solutions under different structure condition moreover regardless of the changing layers and nodes the proposed method still works well and produce better results than the standard elm model with respective to various indexes thus this case demonstrates the robustness of the pcsa method in optimizing neural network for hydrological forecasting 3 7 discussions for the standard elm model some nonideal parameters like input hidden weights and hidden biases may be randomly assigned at the initial phase but remain unchanged at the late learning process thus the elm method often falls into local optima and fails to yield satisfying results in practical applications from the mathematic viewpoint the choice of the elm parameters belongs to the typical complicated multivariable combination optimization problem that can be addressed by the population based evolutionary algorithms obviously the results of the target problem are directly influenced by the selected optimizer compared with several conventional evolutionary algorithms the csa method uses three well designed operators to effectively traverse the state space in an efficient manner which can balance the global exploration and local exploitation to produce high quality solutions even though the feasibility of combining the csa method into the elm model was proved in previous research results feng et al 2021 the abundant computing resources in normal computers are not fully utilized to overcome this defect this study develops the pcsa method to incrementally search for reasonable parameter combinations which can effectively improve the search ability of the swarm in the state space and increase the probability of finding better network structures compared with the csa method using the serial computing mode the pcsa method takes advantages of multiple computing units in normal computers to create two or more independent swarms for optimization the size of swarm is reduced to achieve the goal of avoiding the potential resources waste problem improving the search precision and execution efficiency by linking the parallel computing and evolutionary algorithm into artificial intelligence the proposed method can produce stronger network structures than the original elm method as used to address the hydrological forecasting problem besides the proposed approach may suffer from local convergence defect since it is difficult to guarantee the optimal forecasting model in theory hence the future research work can be directed to enhance the performances on the involved modules like the adaptive determination of network structure of the elm model the modified strategies of the csa method and their parallel implementations in cloud or distributed computing environment 4 conclusion to meet the growing requirement for accurate forecasting this study develops a practical runoff forecasting model by combining the merits of parallel cooperation search algorithm and artificial intelligence method specially a large sized population is firstly divided into several small and independent subpopulations to be synchronously executed at various computing units for each subswarm the csa modules are used to find the satisfying network parameters to improve the generalization ability of the elm model the streamflow data of several hydrological stations is chosen to testify the performance of the proposed model the experiment results indicate that the proposed method can effectively yield robust model structure and improve the prediction accuracy hence artificial intelligence model coupled with parallel evolutionary algorithm is a promising research direction in the hydrological forecasting filed declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this paper is supported by the fundamental research funds for the central universities b210201046 national natural science foundation of china 52009012 51809072 u1865202 52039004 natural science foundation of hubei province 2020cfb340 the authors would like to thank editors and reviewers for their valuable comments and suggestions 
3661,to optimize irrigation amount and date and water allocation target across spatially distributed crops under uncertainties and risks the framework of the distributed ann bi level two stage stochastic fuzzy possibilistic programming with bayesian distributed ann bltsfppb model was established by integrating bi level programming two stochastic programming tsp fuzzy possibilistic programming bayesian downside risk with the distributed ann model decisions making of distributed crops were conducted by building distributed model to optimize decisions at several spatially heterogeneous units the risks of economic benefit and water productivity were considered and measured by the downside risk approach and uncertainties of runoff were presented as fuzzy normal distribution numbers to reduce uncertainties and improve robustness of decisions besides tradeoffs between economic benefit and risks in the upper layers and contradictory relationships across objectives at the upper and lower layers were balanced by the bltsfppb model moreover effects of water right trading on economic benefit with considerations of subjectivities of managers under different hydrological years were quantified by bayesian approach calculation efficiencies of the distributed aquacrop optimization model were effectively improved by establishing the distributed ann bltsfppb making it easy to use and expanding its applications the developed model was applied to yingke district to verify its application the results disclosed that economic benefit and yield enlarged and water productivity and risks lessened when the water right trading was considered the results could offer insight into how to establish the distributed ann model to replace distributed simulation model and further couple with optimization model to conduct spatially distributed decisions and improve calculation efficiencies for managers they can reach key tradeoffs across economic benefit yield and risks and support in depth analysis about how water right trading affects system outcomes keywords distributed ann model bi level two stage stochastic programming fuzzy possibilistic programming bayesian principle water right trading uncertainties 1 introduction water resources contradictions expressed as drought have been widely existed worldwide mainly caused by natural poor rainfall evapotranspiration and hydrological conditions zhang et al 2017 zeng et al 2017 talebmorad et al 2020 sahar et al 2021 for countries giving priority to agriculture they have high probabilities in facing with economic and social losses problems when they encounter drought events hoekema and ryu 2016 zhang et al 2017 ostad et al 2018 sahar et al 2021 therefore how to manage agricultural water resources becomes an effective and foundational way to alleviate water contradictions and eliminate drought as soon as possible water resources management system usually has multiple decision makers with different hierarchies as well as preferences and attitudes towards on water resources management managers at upper layer usually seek strongly system s economic and social benefits while managers farmers at lower layer emphasize heavily respective maximum yields in practice water contradictions and inconsistent decisions amid multiple managers inevitably lead to tradeoffs and feedbacks of water resources under limited water availability to explore key tradeoffs across multiple contradictory users with different powers and find out compromise optimal solution the bi level programming blp has been widely used in water resources management hu et al 2019 ren et al 2019 li et al 2017 ostad and ahayannejad 2020 yao et al 2020 for managers at upper layer incomes mainly come from water charges but incomes change with multiple variations and randomness of water availability the incomes are equal to water charges when available water resources are enough while the incomes need to deduct penalty losses because water shortage supplied by external water transfer requires more cost as available water resources are not adequate the above process needs making reasonable water allocation strategies to avoid unacceptable penalty losses and reach high economic benefit the above problems are usually encountered by managers in practical events which have been addressed by two stage stochastic programming tsp approach it is an effective flexible approach to allow for seeking key tradeoff points and find out optimal decisions under random environment li and zhang 2020 li et al 2015 nematian 2016 however the tsp is incapable of controlling risks generated by random environment for example the economic loss risk occurs when the available water resources are below the expected water resources owing to randomness of water availability except for the economic loss risk risks have other types such risks of water shortage yield loss and water productivity existences of risks aggravate difficulties in making decisions therefore measuring and controlling risks is an effective way to deal with risks the downside risk approach dra as one risk quantification method can effectively quantify and control risks via measuring single risk loss combing multiple risk losses and constraining expected risk losses xie et al 2018 therefore the tsp is enhanced by introducing the dar method and incorporated with the blp to construct a bi level two stage stochastic programming bltsp for achieving irrigation water resources with consideration of risks in reality water right trading can effectively improve water use efficiency by transforming low efficiency water users into high efficiency water users as water shortage problems exist it concerns inevitably subjective willingness of participants that have various willingness of trading under diverse hydrological years owing to different natural available water resources conditions for example buyers have low probabilities to purchase water rights under wet year because they owned enough available water resources how subjectivities of mangers affect water transfers and how to make water transfer amounts may be encountered by managers however the bltsp approach can hardly address occurrence probability of water rights trading concerning subjectivities of participants under different hydrological years and embody consequences of water rights trading on decisions the bayesian theory a dynamic game with incomplete information deducing posterior distribution based on priori distribution with inadequate information has been widely used in runoff water quality forecast etc varouchakis et al 2016 massari et al 2019 even though it has never been used in quantifying occurrence probability of water right trading it provides a new perspective to deal with problems of water right trading concerning subjectivities therefore the combination of bltsp and bayesian theory is a potential method to measure probabilities of water right trading taking hydrological years and subjectivities of participants into into account and making decisions considering water right trading nevertheless it is unable to cope with uncertainties caused by multiple variations of hydro meteorological conditions water supply demand environment and other complexed elements the above problems can be addressed by uncertain mathematical methods such as interval programming ip fuzzy programming fp and stochastic programming sp zhu et al 2019 yu et al 2020 liu et al 2019 the above approaches can reflect uncertainties of related parameters and incorporate uncertainties in the process of decisions which effectively reduce uncertainties and improve robustness of decisions the above three uncertain mathematical methods have different focus on uncertain expressions and various data requirement and robustness the ip fp and sp can deal with grey numbers fuzziness and randomness respectively fu et al 2016 zarghami et al 2015 xu and qin 2015 fu et al 2016 ji et al 2017 zhang and xi 2020 compared with other two approaches the fp has higher opportunities to be used in water resources management because of its relatively moderate data request and good robustness roy and bhaumik 2018 guan et al 2016 fazli khalaf et al 2019 the fp constructs membership functions of fuzzy numbers to represent uncertainties of parameters and usually adopted linear membership function simplifies continues variable as linear fuzzy format making it easy to use but lose some information about complex distribution and thus the linear membership function was transformed into normal membership function which was called fuzzy possibilistic programming fpp one improved version of the fp approaches dealing with fuzzy numbers with normal distributions in right hands of constraints however it is rarely used in agricultural water resources management however above optimize approaches are incapable of revealing of crop physical growth process coupling simulation model with the optimization model can address the above problem which combines advantages of describing crop growths of simulation model and advantages of searching automatically optimal decisions of optimization model connections between simulation model and optimization model are intermediate variables e g yield intermediate variables calculated by crop simulation model are selected as state variables and judge factors to examine which irrigation scheduling is optimal under associated constraints in the optimization model irrigation scheduling owns spatially distributed heterogeneity for heterogeneous study areas and thus simulation optimization models have evolved into spatially distributed simulation optimization model to make decisions at several smaller units with higher accuracy called homogeneous decision making units dmus derived from overlying spatial heterogeneous soil layer and crop type level based on the gis platform such as distributed swap interval programming aquacrop probabilistic possibilistic programming li et al 2018 smilovic et al 2016 gohain et al 2020 muller and martre 2019 tenreiro et al 2020 water resources optimization requires high efficiency scientific decisions but current distributed simulation optimization approaches have limitations in low calculation efficiencies when facing with multiple dimension inputs caused by external complex and fussy calling process of distributed mode spatial yield simulation is relatively difficult to be simulated because it is affected by multiple kinds of driving meteorological elements irrigation and soil characters therefore a simpler yield model is required to improve efficiency meanwhile reflecting effects of the multiple driving factors the ann model pertains to a black box which can quickly simulate and forecast dependent variables by automatically building relationship between input associate sensitive driving variables and dependent variables without physical machine at the same time promising high calculation efficiency and precise accuracy bozorg haddad et al 2016 banadkooki et al 2021 it has been widely applied in runoff forecast flood identities and water environment monitor etc however it is rarely used in yield forecast least of the distributed yield nevertheless it proposes an awareness to building the distributed ann model to replace the distributed crop simulation model to simulate spatial distributed yield and coupling with the bltssfppb model to settle existed low calculation efficiencies and get optimal solutions therefore the distributed ann bi level two stage stochastic fuzzy possibilistic programming with bayesian distributed ann bltsfppb was established in this paper firstly the distributed ann model was built to simulate spatially distributed crop yield secondly the bi level two stage stochastic fuzzy possibilistic programming with bayesian bltsfppb approach was developed by blending the blp tsp fpp bayesian with dra approaches finally the distributed ann bltsfppb approach was contributed by coupling the distributed ann with bltsfppb model the model has following advantages 1 it recognizes effects of water right trading on economic benefit by using bayesian theory to bridge relationship between subjective willingness of participants and trading probabilities and also broadens applications of the tsp model 2 it provides new insights to improve operation efficiency of the distributed simulation optimization model by building distributed ann replaced model 3 it boosts the fuzzy linear distribution as fuzzy normal distribution highly strengthening precisions of distribution functions the model is used to the yingke district to verify its application 2 methodology 2 1 equilibrium strategy 2 1 1 bi level programming blp blp can handle water contradictions between managers at upper and lower layers the upper managers control over the upper level variables x1 and vector x2 donate the lower level variables which are dominated by the low level managers the decision mechanism of blp approach lies in that the upper managers and lower managers adopt the leader follow or dominate subordinate stackelberg game its expressions are shown as follows hu et al 2019 chen et al 2017 upper level max x 1 f 11 x 1 x 2 f 12 x 1 x 2 f 1 m x 1 x 2 min x 1 f 1 m 1 x 1 x 2 f 1 m 2 x 1 x 2 f 1 m x 1 x 2 1 where x 2 can be solved from lower level 2 max x 2 f 21 x 1 x 2 f 22 x 1 x 2 f 2 m x 1 x 2 subject to 3 g x 1 x 2 g i x 1 x 2 0 i 1 2 m x 1 x 2 0 where f 11 f 12 f 1 m denote first second and m objective functions in the upper level separately f 21 f 22 f 2 m are first second and m objective functions in the lower level discretely x 1 x 2 represent decision variables individually g i x 1 x 2 imply constraints the subscript of i means numbers of constraints g is constraints set 2 1 2 two stage stochastic programming based on bayesian theory 1 two stage stochastic programming tsp the tsp model can achieve tradeoffs between pre regulated policy and associated economic penalty because of any infeasible event via recourse and adaptive adjustment in the tsp model an initial decision is firstly generated according to random events and the model will adjust on decision variables by tacking corrective measures after the random events happened therefore the forms of the tsp contain two stages and can be written as follows li and zhang 2020 4 max f c x e q x ω 5 max f c x h 1 h p h q y h ξ h c x h 1 h p h x y h subject to 6 ax b 7 x 0 y 0 where f is an objective function c a and b are coefficients separately x and y are decision variables at first stage and second stage individually q and e are penalty loss and expected penalty losses respectively ω is random environment h implies subscript of scenarios ξ h is stochastic variables ph is occurrence probability of ξ h 2 dynamic game with incomplete information bayesian theory the participants possess various trading willingness under different hydrological years owing to various available water resources and thus occurrence probabilities of trading are different the tsp is unable to deal with recourse penalty losses caused by water right trading and incapable of reflecting trading probabilities of participants under different hydrological years caused by subjectivities of managers therefore the tsp is enhanced by introducing the bayesian theory that measures trading possibilities of sellers and buyers the priori probabilities are occurrence probabilities of hydrological year taking 0 25 0 5 and 0 25 for wet normal and dry year individually and the posterior probability are trading probabilities of participants taking their subjective willingness into account calculation methods are shown as follows the conditional probability of wet year under conditions of selling water rights 8 p w s p s w p w p s w p w p s n p n p s d p d the conditional probability of wet year under conditions of buying water rights p sw p b w p w s p b w p w s p b n p n s p b d p d s 9 the conditional probability of normal year under conditions of selling water rights 10 p n s p s n p n p s w p w p s n p n p s d p d the conditional probability of normal year under conditions of buying water rights p sn p b n p n s p b w p w s p b n p n s p b d p d s 11 the conditional probability of dry year under conditions of selling water rights 12 p d s 1 p w s p n s the conditional probability of dry year under conditions of selling water rights p sd 1 p sw p sn 13 where p w p n and p d represent probabilities of wet year normal year and dry year individually which are prior probabilities p s w p s n and p s d denote conditional probabilities of selling water under wet year normal year and dry year p b w p b n and p b d signify conditional probabilities of buying water under wet year normal year and dry year p sw p sn and p sd embody conditional probabilities of wet normal and dry year under the condition of buying water separately p w s p n s and p d s mean conditional probabilities of wet normal and dry years under the condition of selling water respectively 3 tsp based on bayesian theory the target water allocation could be satisfied by regional available water resources external water transfer and water right trading the external water transfer and water right trading have higher cost than regional water resources because they require more labor and material resources equal to penalty compared with original cost the advantages of existence of penalty is to reduce cost and make reasonable water allocation target and water allocation the penalty losses in the tsp model are consisted of water shortage caused by external water transfer p curre n t and water shortage by water right trading p wrt the values of p curre n t and p wrt change with variations of hydrological years that can be characterized by corresponding occurrence probabilities the occurrence probabilities of hydrological years ph are transformed into posterior probabilities psh via taking subjectivities of participants into account when there has water trading events thus the eq 5 can be rewritten as follows 14 max f c x p curre n t p wrt 15 p curre n t h 1 h p sh e x y h 16 p wrt h 1 h p sh t x y h where t are coefficients 2 2 fuzzy probabilistic programming fpp fpp can handle uncertain parameters presented as fuzzy normal distribution numbers in the right hands of constraints definitions of fuzzy normal distribution are shown as follows fazli khalaf et al 2019 let the crisp normal random variable with mean value μ and variance δ 2 is denoted by n μ δ 2 whose density function is defined as f x μ δ 2 1 σ 2 π e x μ 2 2 σ 2 σ 0 a normal fuzzy random variable is a normally distributed random variable n μ δ 2 with fuzzy mean μ and fuzzy variance δ 2 as fuzzy parameters when parameter b in the right hand of constraints is expressed as fuzzy normal distribution the eq 6 ax b is converted into following formats 17 p a x b γ t t 1 2 m 18 p a x b γ t 1 φ ax μ b σ b μ b μ b α σ b σ b α where γ t represents credibility levels fuzzy numbers and t is scenarios of credibility level p means fuzzy measure φ denotes probability distribution of b where μ b and σ b are mean value and standard deviation respectively the nonlinear format of φ can be transformed following forms according to min or max principles shown as follows 19 min 1 φ ax μ b σ b 1 φ ax μ b σ b 20 max 1 φ ax μ b σ b 1 φ ax μ b σ b where μ b μ b are lower and upper boundary of μ b respectively σ b σ b denote lower and upper boundary of σ b separately thus eq 17 is transformed into eq 21 21 p a x b γ t α 1 φ ax μ b σ b 1 φ ax μ b σ b γ t therefore the eq 21 is converted into following linear formats ax 1 φ 1 γ t σ b μ b ax 1 φ 1 γ t σ b μ b 2 3 downside risk approach dra the dar is an effective measure to avoid the expected revenue risk that can incorporate risk concern i e the tradeoff between the expected value and variability of the expected value into the optimization process the dra measures expected risk value d r i s k δ x ω by multiplying discrete variables δ h with corresponding occurrence probabilities p sh the risk loss value δ h x h ω h equals to difference between economic benefit pr o f i t h x h and target economic benefit ω h if the economic benefit exceeds target economic benefit there is no risk and vice versa its expression is shown as follows 22 δ h x h ω h ω h pr o f i t h x h i f pr o f i t h x h ω h 0 i f pr o f i t h x h ω h h 23 d r i s k δ x ω e δ x ω h 1 h p sh δ h x h ω h 2 4 distributed ann model to overcome low simulation efficiency of the distributed aquacrop model the distributed ann model is built to replace the distributed aquacrop model to simulate distributed yield distributed ann model consists of several ann models at the homogeneous decision making units dmus which are obtained from overlying spatially heterogeneous crop and soil type layers and each dmu has one crop type and one soil type wang et al 2021 the relationships across yield and driving factors are developed based on distributed ann model the detailed steps are shown as follows step1 collect historical meteorological data series e g minimum and maximum temperatures rainfall and calculate the reference evapotranspiration et0 and prepare soil character data e g field capacity and wilting points and generate random irrigation amounts and dates which are called driving factors step2 divide the heterogeneous study area into several dmus and build the distributed aquacrop model and the detailed process can refer to wang wang et al 2021 step3 calculate spatially yields based on the distributed aquacrop model under pre known driving factors step4 compute correlation degrees between the driving factors and yield to further select sensitive factors step5 establish and tested the distributed ann model by fitting relationship between sensitive factors and spatial yields with different time series step6 given sensitive factors to simulate and forecast spatial yield based on calibrated distributed ann model step7 end 2 5 the formulation of distributed ann bltsfppb model and solving method the distributed ann approach is incapable of get optimal solutions the bltsfppb approach is unable to simulate crop yield with consideration of crop physical growth process therefore the distributed ann bltsfppb model is coupled and their connection is distributed yield simulated by the distributed ann model and yield is selected as judge factor and stage variable of the optimization model to calculate objectives and contribute to making optimal water allocation decisions the detailed processes of formulating the distributed ann bltsfppb are shown as follows step1 establish the bltsfppb based on sections 2 1 2 2 and 2 3 step2 develop the distributed ann model on basic of the section 2 4 step3 couple the bltsfppb with the distributed ann model and formulate the distributed ann bltsfppb step4 solve the proposed model by the genetic algorithm method step5 obtain optimal water allocation target water allocation irrigation date economic benefit yield and risk the framework of the distributed ann bltsfppb is shown in the fig 1 3 case study 3 1 study area yingke irrigation district yid is located at middle reaches of heihe river basin hrb shown in the fig 2 northwest china 38 50 38 58 n 100 17 100 34 e it is the third largest irrigation district of the middle oasis region its main production way is agriculture covering a planting area of 19 200 hm2 68 of irrigated land the yid belongs to arid district and the average minimum temperature and maximum temperature are 28 5 and 33 5 monitored by the zhangye meteorological station which represents spatial meteorological condition because of their relatively small variations besides rainfall is about 125 mm and is less than evapotranspiration 1200 mm making its crop production from irrigation the irrigation resources include surface water from the yingluoxia hydrological station of the heihe river and groundwater exploitation the surface water resources and groundwater are 1 45 108m3 and 0 9 108 m3 separately and the field water use efficiencies of surface water and groundwater are 0 521 and 0 78 individually water consumption of the yid occupied about 10 of the middle oasis water demand but water shortage reaches 1 8 107m3 yid mainly has four soil types including first soil type named type 1 the top soil and the subsoil are both silty loam second soil named type 2 the top soil is silty loam and the subsoil is sandy loam third soil named type 3 the top soil is silty loam and the subsoil is loam and fourth soil named type 4 the top soil and subsoil are both loam wang et al 2021 the main crops include seed corn field corn and wheat occupying about 80 of total planting areas the growth periods of the above three crops cover march to september the spatially distributed soil types and crop types make water allocation present spatially distribution and require precise irrigation taking spatially heterogeneities into account 3 2 problem statement the district exists water contradictions between water supplies and water demands and thus water resources optimization can effectively relieve the problems the tsp model can tradeoff relationship between pre defined policy and penalty losses caused by water allocation shortage when current water availability cannot satisfy water demands external water resources and water right trading may happen to supply water shortage but these operations will increase cost heavily however the tsp has limitation in quantifying effects of water right trading on water shortage and economic benefit water rights trading of participants possess obvious different trading willingness under different hydrological years owing to various available water resources for example buyers own higher willingness to pursuit water right while sellers have higher willingness to sell water right to earn more money under dry year a dynamic game therefore it is essential to measure subjectivities and game of participants on water right trading and quantify effects of water right trading on economic benefit distributed simulation optimization model is an effective tool to get optimal decisions considering crop growth process but it has an obvious disadvantage of low operation efficiency optimal decisions usually require high applicability and robustness as well as easy and quick to be obtained therefore an alternative distributed simulation optimization model that quickly gets optimal strategies is required moreover runoff owns complexed uncertainties due to interactions and multiple variations of meteorological and hydrological elements which causes complexities of optimization and reduce robustness of decisions and thus uncertain optimization method is needed to be established to improve robustness of decisions the fuzzy numbers are one effective uncertain method to solve the above problem but usually adopted regular triangular or trapezoidal fuzzy numbers owns relatively small precision because they imply distribution functions as linear functions therefore a higher precision fuzzy distribution functions are needed 3 3 data collection the input data of the distributed ann bltsfppb model include interval water allocation target benefit coefficient penalty coefficient daily minimum temperature daily maximum temperature and daily rainfall daily evapotranspiration minimum and maximum irrigation amounts starting and ending irrigation date at each growth period irrigation areas of crops available water resources the penalty coefficient contains two kinds of formats and the one is penalty caused by water shortage unsatisfied by regular water resources and the other is penalty resulted from water shortage unsatisfied by water rights trading the penalty degree of the former is lower than the latter the probabilities of wet year normal year and dry year take 0 25 0 5 and 0 25 the conditional probabilities of wet year normal year and dry year take 0 26 0 51 and 0 23 the required data for calculating above conditional probabilities include the conditional probabilities of selling and buying water under wet year normal year and dry year which are set as 0 9 0 8 0 7 and 0 9 1 0 1 0 based on background of local subjectivities of managers separately the reasons for values of probabilities are that selling willingness of sellers decrease as hydrological years change from wet year to dry year because of degraded available trading water resources and buying willingness of buyers present opposite tendencies owing to increased purchasing requirement to satisfy water demands of crops the surface water resource is expressed as fuzzy normal numbers where the average value and variance are determined by water resources time series the minimum and maximum economic benefit and water productivity is calculated separately within given constraints the triangular fuzzy economic benefit target and fuzzy water productivity target are presented as 9800 10000 12000 104yuan and 1 8 2 0 2 2 kg m3 individually there are ten decision making units dmus including seed corn with type1 named sct1 seed corn with type 2 sct2 seed corn with type 3 sct3 seed corn with type 4 sct4 field corn with type 1 fct1 field corn with type 3 fct3 field corn with type 4 fct4 wheat with type 1 wt1 wheat with type 3 wt3 and wheat with type 4 wt4 and each dmu has homogeneous soil and crop type the year 2019 2012 and 2016 was selected as wet normal and dry year individually and the meteorological data of growth periods 4 1 9 22 are got from and meteorological website the 14 driving variables including maximum minimum temperature mat mit evapotranspiration et rainfall r water allocations irrigation amounts at four growth periods wa1 wa2 wa3 and wa4 irrigation dates at four growth periods id1 id2 id3 and id4 and field capacity and wilting point as input data are used to simulate yield and yield is chosen as dependent variable 40 yields time series simulated by the distributed aquacrop under given 40 years driving variables are together with driving variables to select sensitivity variable by exploring correlation between yield and driving variables and further construct the ann model the associated data are obtained from statistical yearbook and local survey and shown as tables1 2 3 4 application of the distributed ann bltsfppb model the expressions of bltsfppb model are shown as follows upper level objective1 maximizing economic benefit f 1 max i 1 i j 1 j n b ij w t ij i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth 25 objective2 minimizing loss risks of economic benefit losses and water productivity 26 f 2 min h 1 h p h δ ht w a ω benefit h 1 h p h δ hs w a ω wp lower level objective function maximizing spatial yield 27 f max i 1 i j 1 j h 1 h p h y ijh w a ijh constraints 1 water availability constraints 28 p i 1 i j 1 j w a ijh a ij q h γ h 2 irrigation dates constraints 29 i d ijt min i d ijht i d ijt max i j h t 3 irrigation amounts constraints 30 w a ijt min w a ijht w a ijt max i j h t 4 yield simulation by distributed ann model 31 an n 1 a n n 2 a n n 3 a n n 10 y i e l d i d w a 5 risk control of benefit pr o f i t i 1 i j 1 j n b ij w t ij i 1 i j 1 j 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j β p c t ij w t ij t 1 t w a ijth 32 33 δ ht w a i d ω benefit ω benefit pr o f i t i f pr o f i t ω benefit 0 i f pr o f i t ω benefit h 34 h 1 h p h δ ht w a i d ω benefit λ ψ benefit 6 risk control of water productivity 35 wp i 1 i j 1 j y ijh i d w a a ij w a ijh a ij h 36 δ hs w a i d ω wp ω wp w p i f w p ω wp 0 i f w p ω wp 37 h 1 h p h δ hs w a i d ω wp λ ψ wp 7 non negative constraints 38 w a ijht 0 i d ijht 0 i j h t where f1 f2 and f denote economic benefit 103yuan total risk losses that including economic benefit loss and water productivity loss and yield 103kg individually i j t and h imply subscript of crop type soil type growth period and hydrological year separately wt wa and id mean water allocation target water allocation mm and irrigation date day decision variables and there are totally 252 decision variables covering all kinds of crop type soil type hydrological years and growth periods wp y δ ht and δ hs are water productivity kg m3 yield ton hm2 risk loss of economic benefit 103yuan and risk loss of water productivity kg m3 a is planting area of crop hm2 ann implies constructed ann model used for simulating crop yield profit ω benefit ψ benefit ω wp and ψ wp denote economic benefit 103yuan target economic benefit 103yuan allowable economic benefit loss 103yuan target water productivity kg m3 and allowable water productivity loss kg m3 β γ and λ are proportion of water shortage caused by water right trading confidence level and allowable level individually i 1 i j 1 j n b ij w t ij i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth indicate regular economic benefit reb first penalty loss named first penalty loss fpl and second penalty loss called second penalty loss spl 103yuan separately h 1 h p h δ ht w a ω benefit and h 1 h p h δ hs w a ω wp imply economic benefit risk loss and water productivity risk loss individually and the sum of the above two kind of losses is total risk losses rlv 4 result analysis 4 1 fitting results of the distributed ann the correlations rc across 14 driving variables and yield are shown as table 3 table 3 showed that yields of all dmus had high correlations with driving factors variables taking ysct1 as an example the rc between 14 driving variables and yield reached around 0 95 indicating 14 driving variables all owning strong correlations with yield of the seed corn with t1 and thus they were all chosen as sensitive driving variables which are also suitable for other nine dmus consequently 14 driving variables were all selected as sensitive driving variables together with yield to train and test the distributed ann model and the results are shown in the fig 3 fig 3 disclosed that spatial yields of ten dmus at the training and testing stages simulated by the distributed ann model had good fittings with yield simulated by the distributed aquacrop model the relative error rates rer varied from 0 6 to 19 within allowable acceptable ranges illustrating that the distributed anns model can replace successfully and effectively the distributed aquacrop model and couple with the bltsfppb model to conduct irrigation scheduling management 4 2 optimal water allocation target and water allocation optimal water allocation target water allocation and irrigation dates could be obtained by solving the distributed ann bltsfppb model using the genetic algorithm ga method that has 400 generations and interactions and each generation owns 100 individuals the satisfactory degree a representation of multiple interactive objectives with variations of iterative process is shown as fig 4 fig 4 illustrates that satisfactory degree tended to stabilize after 400 iterations and 10th individual at 400th generation was selected as the optimal scheme the selection processes were as follows the maximum satisfactory degree across 100 individuals at one generation was chosen as satisfactory degree of each generation and maximum satisfactory degree across 400 generations was selected as final satisfactory degree 1 optimal water allocation target table 4 are results of optimal water allocation target and related intermediate decision variables that determine increased degree of water allocation target compared to lower boundary of water allocation the results showed that crop had different tendencies with variations of soil types water allocation target of seed corn under t2 was biggest followed by t3 t4 and t1 which was also suitable for field corn this is because the yield was positive with water allocation under deficient irrigation and yield under t2 was biggest followed by t3 t4 and t1 under same irrigation scheduling specially water allocation target of wheat with t4 was higher than t3 reasons are that soil characters of t3 and t4 have relatively small differences and one crop with one soil type and water allocation pattern owns different yield because of various water sensitivity at different growth stages consequently water allocation target was affected by yield and water allocation pattern 2 optimal water allocation total water allocations of crops under three hydrological years are represented as the fig 5 fig 5 illustrated that water allocation of one crop under different soil types existed differences the resulted discovered that water allocation of the seed corn under t3 was biggest ranked by t2 t4 and t1 also suitable for field corn and wheat which was mainly affected by benefit coefficient and water allocation target the achievement of biggest economic benefit needs crop with high benefit coefficient and water allocation target that has relatively big water allocation the results demonstrated that water allocations of crops under wet year were higher than normal year and dry year for most dmus while water allocation of some dmus owned different variations with most dmus such as field corn which presented that water allocation under dry year was higher than normal year and this can be explained by reasons that water demands of crops under three hydrological years had interactive intervals and it was allowed that water allocation under dry year was higher than normal year in general water allocation under wet year was biggest followed by normal year and dry year owing to ranked different water demand intervals of crops however water allocation of crop was also affected by water allocation pattern that was water allocation amount at each growth stage taking water allocation of field corn with t3 under three hydrological years as an example and results are shown in fig 6 fig 6 disclosed that water allocation of field corn with t3 at each irrigation period under three hydrological years had no obvious regulations even though there are no apparent regulations water allocation directly affected yield water productivity and economic benefit and risks the yield has different water sensitive degree and first third and fourth growth stages have relatively high influences on yield and thus high water allocation at these stages will improve yield yields under three hydrological years were the same because excessive irrigation will arise deep infiltration ineffective for improving yield optimizing spatially distributed irrigation amount advances irrigation scheduling from views that providing insights into how to allocate water resources following crop growth process according to soil type division crop types and weather conditions under uncertainties 3 optimal irrigation dates table 5 is optimal irrigation dates of crop under four soil types and wet year table 5 illustrated that optimal irrigation dates of crops had obvious differences with variations of soil types combined with optimal water allocation conclusion that irrigation date and water allocation affected each other could be obtained taking the field corn with t3 as an example water allocations at first growth period were 121 mm and 131 mm and optimal irrigation dates at second growth period were 67th day and 73rd day separately water allocations at second growth period were 148 and 104 mm and irrigation dates at third growth period were 100th day and 94th day individually illustrating that higher water allocation might delay irrigation date at next growth period which is because bigger water allocation alleviates duration of water shortage and water shortage degree consequently optimal water allocation and irrigation date affect each other optimizing spatially distributed irrigation date and amount explores their interactions and feedbacks affected by crop water demand and available water resources reflecting dynamic variations of decision changing with spatially distributed hydro meteorological conditions and soil condition a more flexible manner to guide precise irrigation making irrigation scheduling more applicable with actual conditions 4 3 economic benefit risk and yield fig 7 shows yields of crops under three hydrological years it demonstrated that yields of crops had obvious different regulations there were two variation tendencies and one tendency was that yields of crops at some dmus e g sct3 sct4 fct1 and fct3 were the same and another tendency was that yields of crops at rested dmus under three hydrological years were different the reasons for first tendency were mainly affected by water allocation pattern that referred to water allocation amount at each growth period the seed corn has four growth periods including jointing period heading period grouting period and mature period each growth period owns different sensitive degree on water allocation and water allocation exceeding field capacity will result into deep infiltration that is ineffective for improving yield second tendency could be explained by reasons that except for influences of water allocation pattern rainfalls and irrigation dates also generated influences and rainfall effective for improving yield under wet year was higher than normal year and dry year yield was also affected by other objectives objects of economic benefit and yield required more water allocation while object of losses risk needed less water allocation this concerns a comprise process of yield economic benefit and water productivity the losses risk controls yield and water productivity around target yield and water productivity to avoid excessive loss values but target yield and target water productivity have different water allocation threshold this requires water allocation is between water threshold of target water productivity and water threshold of target yield if water allocation equals water threshold of target water productivity and water productivity will be maximum and yield will be small and if water allocation equals water threshold of target yield and yield will be maximum and water productivity will be small the water allocation between the above two water thresholds affects water productivity and yield directly taking the sct1 as an example water shortages were 572 mm 171 mm and 203 mm respectively under wet normal and dry years and thus associated economic benefit lessens and economic loss risk enlarged with decrease of hydrological years the risk and yield represented contradictory relationships because probability of normal year was higher than wet year and dry year and thus yield under normal year occupied a relatively large proportion in expected yield and thus the yield under normal year was biggest in summary the yield was influenced by water allocation pattern and other objectives table 6 are results of regular economic benefit first penalty loss fpl generated from water shortage unsatisfied by current water availability second penalty loss spl caused by water shortage unsatisfied by water right trading economic benefit described as regular economic benefit subtracting first and second penalty losses yield water productivity economic benefit loss water productivity loss and total risk loss value the results illustrated that regular benefits were the same and took 16 7 103yuan under three hydrological years because it was calculated by multiplying fixed water allocation target by fixed benefit coefficient the fpl and spl increased with decrease of hydrological years which was because water shortage enlarges with decreasing hydrological years the increased degree of spl was smaller than fpl which was because spl had higher penalty value under the same water shortage amount and owned smaller weight determining proportion of penalty loss than fpl where weights were set as 0 7 and 0 3 for fpl and spl separately the economic benefit increased with rise of hydrological years because increased degree of regular benefit was higher than total penalty losses with variations of hydrological years the total yield of crop under normal year was biggest followed by wet year and dry year this could be explained by reasons that total yield under each hydrological year was calculated by multiplying yield by occurrence probability of corresponding hydrological year and probability of normal year was highest and ranked by equaled wet year and dry year so increasing yield under normal year had a higher total yield increase degree and better yield economic benefit than other hydrological years the results disclosed that wp enlarged with decrease of hydrological years which was caused by wp was negative with water allocation the results showed that water productivity losses years were zero while economic losses were 0 1 87 103yuan and 3 66 103yuan under three hydrological years separately the 0 denotes there is no risk losses and negative value implies there is risk losses the economic losses increased with rise of hydrological years caused by increasing water shortage the ec was positive reb negative with fpl and spl the ecl and wpl determined rlv the results could provide insight into variation regulations of economic components and achieve risk control for manager optimizing spatially irrigation scheduling with consideration of tradeoff across economic benefit yield and risks emphasizes effects of external economic conditions risks and subjectivities of mangers on decisions forming a manager participants form which builds connections between decisions and managers preferences and pursuits making decisions more flexible and applicable 5 discussion 5 1 comparison with distributed ann bltsfpp model the distributed ann bltsfpp model is the distributed ann bltsfppb without consideration of bayesian based water right trading the expressions of the distributed ann bltsfppb and the distributed ann bltsfpp model are as follows the distributed ann bltsfppb model max f 1 i 1 i j 1 j n b ij w t ij regular benefit i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth fpl first penalty loss caused by external water trasnfer i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth spl second penaly loss caused bywater right trading the distributed ann bltsfpp model max f 1 i 1 i j 1 j n b ij w t ij regular benefit i 1 i j 1 j ho 1 ho p ho p c ij w t ij t 1 t w a ijth penalty loss caused by external water transfer compared with the distributed ann bltsfpp model the distributed ann bltsfpp model divided the penalty loss into first penalty loss caused by water transfer fpl and second penalty loss resulted from water right trading spl and respective weights were set as 0 7 and 0 3 the optimal water allocation target water allocation yield economic components obtained from the above two models were analyzed and advantages of the distributed ann bltsfppb model were stocked out the iterative process of the distributed ann bltsfpp model and the distributed ann bltsfppb is shown in the fig 9 fig 9 disclosed that satisfactory degree of the distributed ann bltsfppb was higher than the distributed ann bltsfpp model illustrating that economic benefit risks and yield considering water right trading were better than without considering trading to understand regulations of water allocation targets of these two models results are shown in table 7 it illustrated that water allocation target considering water right trading was higher than this without water right trading for most dmus this was because penalty loss generated by the distributed ann bltsfppb model was less than the distributed ann bltsfpp model owing to different water allocation water allocation target and water allocation affected penalty losses feed backed and adjusted for each other to determine automatically optimal water allocation and water allocation target and further reduce penalty loss and achieve higher economic benefit if the water allocation is less and penalty loss will enlarge and water allocation target will be adjusted to be less to reduce penalty loss differences of water allocations of these two model named d value of water allocation and differences of yields named d value of yield were used to compare water allocation and yield differences of these two models shown in fig 10 the results demonstrated that d values of water allocations under three hydrological years all exceeded 0 illustrating that water allocation considering water right trading was higher than this without water right trading d values of yields for most dmus outstripped 0 clarifying that yield with consideration of water right trading was bigger than this without trading conclusion that yield was affected deeply by total water allocation and total water allocation played mostly impacts on yield could be obtained table 8 are differences of economic components yield and risks of the distributed ann bltsfppb model and the distributed ann bltsfpp model the d values of the above components were calculated by values obtained from the ann bltsfpp model subtracting values obtained from the distributed ann bltsfppb model the results showed that economic benefit ec considering water right trading was higher than without trading which was because that regular benefit associated with water allocation target with consideration of water right trading was slightly higher than this without water right trading while penalty loss with water right trading was obviously lower than this without trading for example the sum of fpl and spl of the distributed ann bltsfppb model was 8 12 103yuan while the fpl of the distributed ann bltsfpp model took 11 66 103yuan the expected economic benefit and yield with water right trading enlarged by 3 46 103yuan and 0 97 ton hm2 than the ec and yield without water trading separately this means that water trading can improve economic benefit and yield the d value of total economic loss drlv valued positive values demonstrating that total risks considering water right trading bore less economic loss risk values than without water trading highly reducing economic loss risks consequently compared with the ann bltsfpp model the distributed ann bltsfppb model could reach yield improvement economic benefit raise risk loss control at the expense of water allocation reaching a key tradeoff across multiple variables and getting comprised results optimizing spatially irrigation scheduling taking water right trading into account help to figure out effects of water right trading on decisions and provide decision supports for managers about how to make decisions irrigation scheduling via water right trading when there is not enough water availability 5 2 comparison with the distributed aquacrop probabilistic possibilistic programming distributed aquacrop pp with fuzzy random coefficient model the distributed aquacrop pp model was developed by wang et al wang et al 2021 to optimize irrigation scheduling under uncertainties the expressions of the model were shown as follows objective function maximizing economic benefit generated from yield maxf i 1 i c i t a i i 1 i h 1 h p h e i d ih where f is economic benefit 103yuan ta and d denote yield target and yield shortage separately kg hm2 c i e i imply crop price of yield and penalty coefficient caused by yield shortage individually yuan kg i is subscript of decision making units dmus there are mainly five differences including objective decision variables yield simulation method calculation times ct water allocations between the two models shown in table 9 1 it discovered that calculation times were about 0 5 day and 3 days by running 500 generations based on the ga method for the distributed ann bltsfppb model and distributed aquacrop pp model individually the obvious differences were caused by that the distributed aquacrop pp model required calling complexed and time consuming external aquacrop plug in exe while the developed model simplified calling process of external exe by calling internal subfunctions significantly promoting efficiencies optimizing spatially irrigation scheduling using the distributed ann model can highly improve calculation efficiencies when there are complexed input scenarios bordering application the distributed ann optimization model in optimizing irrigation scheduling 2 it disclosed that water allocation and yield of the distributed aquacrop pp model were both higher slightly than the distributed ann bltsfppb model and increased rate of water allocation was bigger than yield taking 5 and 1 respectively reasons for the above phenomenon were that emphasizes of the former was maximum yield positive with water allocation under deficient irrigation and thus it inevitably raised relatively low water productivity besides it ignored risk control water resources feedbacks and tradeoffs making water allocation lack of widely application and extension which sideways highlighted advantages of the distributed ann bltsfppb model consequently the distributed ann bltsfppb model could improve successfully calculation efficiency with promising simulation accuracy besides it could reach critical tradeoffs of water resources between managers at different power layers and multiple objectives as well as ensure losses risk to vary in acceptable ranges 6 conclusion this paper developed a distributed ann bltsfppb model by incorporating distributed ann model with blp tsp fpp bayesian and downside risk approaches for optimizing distributed irrigation amounts dates and water allocation target collectively the important conclusions were that 1 economic benefit yield with consideration of water right trading enlarged by 70 and 16 5 than these without water right trading 2 the economic loss risk value decreased by 70 considering water right trading 3 the distributed ann model can effectively replace with the distributed aquacrop model by saving about 5 times of times the developed model has following advantages in 1 it establishes a bltsfppb model giving new insight into how to reflect subjectivities of mangers on water right trading and how to allocate water resources taking water right trading into account 2 it reduces uncertainties of decisions by simulating spatial heterogeneous yield simulated by distributed ann model and deals with uncertainties of runoff as fuzzy normal distribution enhancing robustness of decisions 3 it improve highly calculation efficiencies of the distributed simulation optimization model by replacing distributed aquacrop model with the distributed ann model that couples with the bltsfppb model the developed model was proved to be an efficient tool to optimize distributed irrigation scheduling simultaneously in the arid and semi arid district however uncertainties of crop simulation model because yield is widely affected by multiple driving factors such as rainfall temperature and irrigation are not studied which affects simulation accuracy of yield this problem can be handled in future studies credit authorship contribution statement youzhi wang conceptualization methodology software writing original draft huijuan yin data curation xinwei guo wenge zhang visualization supervision qiangkun li investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was financially supported by national natural science foundation of china no 51809104 
3661,to optimize irrigation amount and date and water allocation target across spatially distributed crops under uncertainties and risks the framework of the distributed ann bi level two stage stochastic fuzzy possibilistic programming with bayesian distributed ann bltsfppb model was established by integrating bi level programming two stochastic programming tsp fuzzy possibilistic programming bayesian downside risk with the distributed ann model decisions making of distributed crops were conducted by building distributed model to optimize decisions at several spatially heterogeneous units the risks of economic benefit and water productivity were considered and measured by the downside risk approach and uncertainties of runoff were presented as fuzzy normal distribution numbers to reduce uncertainties and improve robustness of decisions besides tradeoffs between economic benefit and risks in the upper layers and contradictory relationships across objectives at the upper and lower layers were balanced by the bltsfppb model moreover effects of water right trading on economic benefit with considerations of subjectivities of managers under different hydrological years were quantified by bayesian approach calculation efficiencies of the distributed aquacrop optimization model were effectively improved by establishing the distributed ann bltsfppb making it easy to use and expanding its applications the developed model was applied to yingke district to verify its application the results disclosed that economic benefit and yield enlarged and water productivity and risks lessened when the water right trading was considered the results could offer insight into how to establish the distributed ann model to replace distributed simulation model and further couple with optimization model to conduct spatially distributed decisions and improve calculation efficiencies for managers they can reach key tradeoffs across economic benefit yield and risks and support in depth analysis about how water right trading affects system outcomes keywords distributed ann model bi level two stage stochastic programming fuzzy possibilistic programming bayesian principle water right trading uncertainties 1 introduction water resources contradictions expressed as drought have been widely existed worldwide mainly caused by natural poor rainfall evapotranspiration and hydrological conditions zhang et al 2017 zeng et al 2017 talebmorad et al 2020 sahar et al 2021 for countries giving priority to agriculture they have high probabilities in facing with economic and social losses problems when they encounter drought events hoekema and ryu 2016 zhang et al 2017 ostad et al 2018 sahar et al 2021 therefore how to manage agricultural water resources becomes an effective and foundational way to alleviate water contradictions and eliminate drought as soon as possible water resources management system usually has multiple decision makers with different hierarchies as well as preferences and attitudes towards on water resources management managers at upper layer usually seek strongly system s economic and social benefits while managers farmers at lower layer emphasize heavily respective maximum yields in practice water contradictions and inconsistent decisions amid multiple managers inevitably lead to tradeoffs and feedbacks of water resources under limited water availability to explore key tradeoffs across multiple contradictory users with different powers and find out compromise optimal solution the bi level programming blp has been widely used in water resources management hu et al 2019 ren et al 2019 li et al 2017 ostad and ahayannejad 2020 yao et al 2020 for managers at upper layer incomes mainly come from water charges but incomes change with multiple variations and randomness of water availability the incomes are equal to water charges when available water resources are enough while the incomes need to deduct penalty losses because water shortage supplied by external water transfer requires more cost as available water resources are not adequate the above process needs making reasonable water allocation strategies to avoid unacceptable penalty losses and reach high economic benefit the above problems are usually encountered by managers in practical events which have been addressed by two stage stochastic programming tsp approach it is an effective flexible approach to allow for seeking key tradeoff points and find out optimal decisions under random environment li and zhang 2020 li et al 2015 nematian 2016 however the tsp is incapable of controlling risks generated by random environment for example the economic loss risk occurs when the available water resources are below the expected water resources owing to randomness of water availability except for the economic loss risk risks have other types such risks of water shortage yield loss and water productivity existences of risks aggravate difficulties in making decisions therefore measuring and controlling risks is an effective way to deal with risks the downside risk approach dra as one risk quantification method can effectively quantify and control risks via measuring single risk loss combing multiple risk losses and constraining expected risk losses xie et al 2018 therefore the tsp is enhanced by introducing the dar method and incorporated with the blp to construct a bi level two stage stochastic programming bltsp for achieving irrigation water resources with consideration of risks in reality water right trading can effectively improve water use efficiency by transforming low efficiency water users into high efficiency water users as water shortage problems exist it concerns inevitably subjective willingness of participants that have various willingness of trading under diverse hydrological years owing to different natural available water resources conditions for example buyers have low probabilities to purchase water rights under wet year because they owned enough available water resources how subjectivities of mangers affect water transfers and how to make water transfer amounts may be encountered by managers however the bltsp approach can hardly address occurrence probability of water rights trading concerning subjectivities of participants under different hydrological years and embody consequences of water rights trading on decisions the bayesian theory a dynamic game with incomplete information deducing posterior distribution based on priori distribution with inadequate information has been widely used in runoff water quality forecast etc varouchakis et al 2016 massari et al 2019 even though it has never been used in quantifying occurrence probability of water right trading it provides a new perspective to deal with problems of water right trading concerning subjectivities therefore the combination of bltsp and bayesian theory is a potential method to measure probabilities of water right trading taking hydrological years and subjectivities of participants into into account and making decisions considering water right trading nevertheless it is unable to cope with uncertainties caused by multiple variations of hydro meteorological conditions water supply demand environment and other complexed elements the above problems can be addressed by uncertain mathematical methods such as interval programming ip fuzzy programming fp and stochastic programming sp zhu et al 2019 yu et al 2020 liu et al 2019 the above approaches can reflect uncertainties of related parameters and incorporate uncertainties in the process of decisions which effectively reduce uncertainties and improve robustness of decisions the above three uncertain mathematical methods have different focus on uncertain expressions and various data requirement and robustness the ip fp and sp can deal with grey numbers fuzziness and randomness respectively fu et al 2016 zarghami et al 2015 xu and qin 2015 fu et al 2016 ji et al 2017 zhang and xi 2020 compared with other two approaches the fp has higher opportunities to be used in water resources management because of its relatively moderate data request and good robustness roy and bhaumik 2018 guan et al 2016 fazli khalaf et al 2019 the fp constructs membership functions of fuzzy numbers to represent uncertainties of parameters and usually adopted linear membership function simplifies continues variable as linear fuzzy format making it easy to use but lose some information about complex distribution and thus the linear membership function was transformed into normal membership function which was called fuzzy possibilistic programming fpp one improved version of the fp approaches dealing with fuzzy numbers with normal distributions in right hands of constraints however it is rarely used in agricultural water resources management however above optimize approaches are incapable of revealing of crop physical growth process coupling simulation model with the optimization model can address the above problem which combines advantages of describing crop growths of simulation model and advantages of searching automatically optimal decisions of optimization model connections between simulation model and optimization model are intermediate variables e g yield intermediate variables calculated by crop simulation model are selected as state variables and judge factors to examine which irrigation scheduling is optimal under associated constraints in the optimization model irrigation scheduling owns spatially distributed heterogeneity for heterogeneous study areas and thus simulation optimization models have evolved into spatially distributed simulation optimization model to make decisions at several smaller units with higher accuracy called homogeneous decision making units dmus derived from overlying spatial heterogeneous soil layer and crop type level based on the gis platform such as distributed swap interval programming aquacrop probabilistic possibilistic programming li et al 2018 smilovic et al 2016 gohain et al 2020 muller and martre 2019 tenreiro et al 2020 water resources optimization requires high efficiency scientific decisions but current distributed simulation optimization approaches have limitations in low calculation efficiencies when facing with multiple dimension inputs caused by external complex and fussy calling process of distributed mode spatial yield simulation is relatively difficult to be simulated because it is affected by multiple kinds of driving meteorological elements irrigation and soil characters therefore a simpler yield model is required to improve efficiency meanwhile reflecting effects of the multiple driving factors the ann model pertains to a black box which can quickly simulate and forecast dependent variables by automatically building relationship between input associate sensitive driving variables and dependent variables without physical machine at the same time promising high calculation efficiency and precise accuracy bozorg haddad et al 2016 banadkooki et al 2021 it has been widely applied in runoff forecast flood identities and water environment monitor etc however it is rarely used in yield forecast least of the distributed yield nevertheless it proposes an awareness to building the distributed ann model to replace the distributed crop simulation model to simulate spatial distributed yield and coupling with the bltssfppb model to settle existed low calculation efficiencies and get optimal solutions therefore the distributed ann bi level two stage stochastic fuzzy possibilistic programming with bayesian distributed ann bltsfppb was established in this paper firstly the distributed ann model was built to simulate spatially distributed crop yield secondly the bi level two stage stochastic fuzzy possibilistic programming with bayesian bltsfppb approach was developed by blending the blp tsp fpp bayesian with dra approaches finally the distributed ann bltsfppb approach was contributed by coupling the distributed ann with bltsfppb model the model has following advantages 1 it recognizes effects of water right trading on economic benefit by using bayesian theory to bridge relationship between subjective willingness of participants and trading probabilities and also broadens applications of the tsp model 2 it provides new insights to improve operation efficiency of the distributed simulation optimization model by building distributed ann replaced model 3 it boosts the fuzzy linear distribution as fuzzy normal distribution highly strengthening precisions of distribution functions the model is used to the yingke district to verify its application 2 methodology 2 1 equilibrium strategy 2 1 1 bi level programming blp blp can handle water contradictions between managers at upper and lower layers the upper managers control over the upper level variables x1 and vector x2 donate the lower level variables which are dominated by the low level managers the decision mechanism of blp approach lies in that the upper managers and lower managers adopt the leader follow or dominate subordinate stackelberg game its expressions are shown as follows hu et al 2019 chen et al 2017 upper level max x 1 f 11 x 1 x 2 f 12 x 1 x 2 f 1 m x 1 x 2 min x 1 f 1 m 1 x 1 x 2 f 1 m 2 x 1 x 2 f 1 m x 1 x 2 1 where x 2 can be solved from lower level 2 max x 2 f 21 x 1 x 2 f 22 x 1 x 2 f 2 m x 1 x 2 subject to 3 g x 1 x 2 g i x 1 x 2 0 i 1 2 m x 1 x 2 0 where f 11 f 12 f 1 m denote first second and m objective functions in the upper level separately f 21 f 22 f 2 m are first second and m objective functions in the lower level discretely x 1 x 2 represent decision variables individually g i x 1 x 2 imply constraints the subscript of i means numbers of constraints g is constraints set 2 1 2 two stage stochastic programming based on bayesian theory 1 two stage stochastic programming tsp the tsp model can achieve tradeoffs between pre regulated policy and associated economic penalty because of any infeasible event via recourse and adaptive adjustment in the tsp model an initial decision is firstly generated according to random events and the model will adjust on decision variables by tacking corrective measures after the random events happened therefore the forms of the tsp contain two stages and can be written as follows li and zhang 2020 4 max f c x e q x ω 5 max f c x h 1 h p h q y h ξ h c x h 1 h p h x y h subject to 6 ax b 7 x 0 y 0 where f is an objective function c a and b are coefficients separately x and y are decision variables at first stage and second stage individually q and e are penalty loss and expected penalty losses respectively ω is random environment h implies subscript of scenarios ξ h is stochastic variables ph is occurrence probability of ξ h 2 dynamic game with incomplete information bayesian theory the participants possess various trading willingness under different hydrological years owing to various available water resources and thus occurrence probabilities of trading are different the tsp is unable to deal with recourse penalty losses caused by water right trading and incapable of reflecting trading probabilities of participants under different hydrological years caused by subjectivities of managers therefore the tsp is enhanced by introducing the bayesian theory that measures trading possibilities of sellers and buyers the priori probabilities are occurrence probabilities of hydrological year taking 0 25 0 5 and 0 25 for wet normal and dry year individually and the posterior probability are trading probabilities of participants taking their subjective willingness into account calculation methods are shown as follows the conditional probability of wet year under conditions of selling water rights 8 p w s p s w p w p s w p w p s n p n p s d p d the conditional probability of wet year under conditions of buying water rights p sw p b w p w s p b w p w s p b n p n s p b d p d s 9 the conditional probability of normal year under conditions of selling water rights 10 p n s p s n p n p s w p w p s n p n p s d p d the conditional probability of normal year under conditions of buying water rights p sn p b n p n s p b w p w s p b n p n s p b d p d s 11 the conditional probability of dry year under conditions of selling water rights 12 p d s 1 p w s p n s the conditional probability of dry year under conditions of selling water rights p sd 1 p sw p sn 13 where p w p n and p d represent probabilities of wet year normal year and dry year individually which are prior probabilities p s w p s n and p s d denote conditional probabilities of selling water under wet year normal year and dry year p b w p b n and p b d signify conditional probabilities of buying water under wet year normal year and dry year p sw p sn and p sd embody conditional probabilities of wet normal and dry year under the condition of buying water separately p w s p n s and p d s mean conditional probabilities of wet normal and dry years under the condition of selling water respectively 3 tsp based on bayesian theory the target water allocation could be satisfied by regional available water resources external water transfer and water right trading the external water transfer and water right trading have higher cost than regional water resources because they require more labor and material resources equal to penalty compared with original cost the advantages of existence of penalty is to reduce cost and make reasonable water allocation target and water allocation the penalty losses in the tsp model are consisted of water shortage caused by external water transfer p curre n t and water shortage by water right trading p wrt the values of p curre n t and p wrt change with variations of hydrological years that can be characterized by corresponding occurrence probabilities the occurrence probabilities of hydrological years ph are transformed into posterior probabilities psh via taking subjectivities of participants into account when there has water trading events thus the eq 5 can be rewritten as follows 14 max f c x p curre n t p wrt 15 p curre n t h 1 h p sh e x y h 16 p wrt h 1 h p sh t x y h where t are coefficients 2 2 fuzzy probabilistic programming fpp fpp can handle uncertain parameters presented as fuzzy normal distribution numbers in the right hands of constraints definitions of fuzzy normal distribution are shown as follows fazli khalaf et al 2019 let the crisp normal random variable with mean value μ and variance δ 2 is denoted by n μ δ 2 whose density function is defined as f x μ δ 2 1 σ 2 π e x μ 2 2 σ 2 σ 0 a normal fuzzy random variable is a normally distributed random variable n μ δ 2 with fuzzy mean μ and fuzzy variance δ 2 as fuzzy parameters when parameter b in the right hand of constraints is expressed as fuzzy normal distribution the eq 6 ax b is converted into following formats 17 p a x b γ t t 1 2 m 18 p a x b γ t 1 φ ax μ b σ b μ b μ b α σ b σ b α where γ t represents credibility levels fuzzy numbers and t is scenarios of credibility level p means fuzzy measure φ denotes probability distribution of b where μ b and σ b are mean value and standard deviation respectively the nonlinear format of φ can be transformed following forms according to min or max principles shown as follows 19 min 1 φ ax μ b σ b 1 φ ax μ b σ b 20 max 1 φ ax μ b σ b 1 φ ax μ b σ b where μ b μ b are lower and upper boundary of μ b respectively σ b σ b denote lower and upper boundary of σ b separately thus eq 17 is transformed into eq 21 21 p a x b γ t α 1 φ ax μ b σ b 1 φ ax μ b σ b γ t therefore the eq 21 is converted into following linear formats ax 1 φ 1 γ t σ b μ b ax 1 φ 1 γ t σ b μ b 2 3 downside risk approach dra the dar is an effective measure to avoid the expected revenue risk that can incorporate risk concern i e the tradeoff between the expected value and variability of the expected value into the optimization process the dra measures expected risk value d r i s k δ x ω by multiplying discrete variables δ h with corresponding occurrence probabilities p sh the risk loss value δ h x h ω h equals to difference between economic benefit pr o f i t h x h and target economic benefit ω h if the economic benefit exceeds target economic benefit there is no risk and vice versa its expression is shown as follows 22 δ h x h ω h ω h pr o f i t h x h i f pr o f i t h x h ω h 0 i f pr o f i t h x h ω h h 23 d r i s k δ x ω e δ x ω h 1 h p sh δ h x h ω h 2 4 distributed ann model to overcome low simulation efficiency of the distributed aquacrop model the distributed ann model is built to replace the distributed aquacrop model to simulate distributed yield distributed ann model consists of several ann models at the homogeneous decision making units dmus which are obtained from overlying spatially heterogeneous crop and soil type layers and each dmu has one crop type and one soil type wang et al 2021 the relationships across yield and driving factors are developed based on distributed ann model the detailed steps are shown as follows step1 collect historical meteorological data series e g minimum and maximum temperatures rainfall and calculate the reference evapotranspiration et0 and prepare soil character data e g field capacity and wilting points and generate random irrigation amounts and dates which are called driving factors step2 divide the heterogeneous study area into several dmus and build the distributed aquacrop model and the detailed process can refer to wang wang et al 2021 step3 calculate spatially yields based on the distributed aquacrop model under pre known driving factors step4 compute correlation degrees between the driving factors and yield to further select sensitive factors step5 establish and tested the distributed ann model by fitting relationship between sensitive factors and spatial yields with different time series step6 given sensitive factors to simulate and forecast spatial yield based on calibrated distributed ann model step7 end 2 5 the formulation of distributed ann bltsfppb model and solving method the distributed ann approach is incapable of get optimal solutions the bltsfppb approach is unable to simulate crop yield with consideration of crop physical growth process therefore the distributed ann bltsfppb model is coupled and their connection is distributed yield simulated by the distributed ann model and yield is selected as judge factor and stage variable of the optimization model to calculate objectives and contribute to making optimal water allocation decisions the detailed processes of formulating the distributed ann bltsfppb are shown as follows step1 establish the bltsfppb based on sections 2 1 2 2 and 2 3 step2 develop the distributed ann model on basic of the section 2 4 step3 couple the bltsfppb with the distributed ann model and formulate the distributed ann bltsfppb step4 solve the proposed model by the genetic algorithm method step5 obtain optimal water allocation target water allocation irrigation date economic benefit yield and risk the framework of the distributed ann bltsfppb is shown in the fig 1 3 case study 3 1 study area yingke irrigation district yid is located at middle reaches of heihe river basin hrb shown in the fig 2 northwest china 38 50 38 58 n 100 17 100 34 e it is the third largest irrigation district of the middle oasis region its main production way is agriculture covering a planting area of 19 200 hm2 68 of irrigated land the yid belongs to arid district and the average minimum temperature and maximum temperature are 28 5 and 33 5 monitored by the zhangye meteorological station which represents spatial meteorological condition because of their relatively small variations besides rainfall is about 125 mm and is less than evapotranspiration 1200 mm making its crop production from irrigation the irrigation resources include surface water from the yingluoxia hydrological station of the heihe river and groundwater exploitation the surface water resources and groundwater are 1 45 108m3 and 0 9 108 m3 separately and the field water use efficiencies of surface water and groundwater are 0 521 and 0 78 individually water consumption of the yid occupied about 10 of the middle oasis water demand but water shortage reaches 1 8 107m3 yid mainly has four soil types including first soil type named type 1 the top soil and the subsoil are both silty loam second soil named type 2 the top soil is silty loam and the subsoil is sandy loam third soil named type 3 the top soil is silty loam and the subsoil is loam and fourth soil named type 4 the top soil and subsoil are both loam wang et al 2021 the main crops include seed corn field corn and wheat occupying about 80 of total planting areas the growth periods of the above three crops cover march to september the spatially distributed soil types and crop types make water allocation present spatially distribution and require precise irrigation taking spatially heterogeneities into account 3 2 problem statement the district exists water contradictions between water supplies and water demands and thus water resources optimization can effectively relieve the problems the tsp model can tradeoff relationship between pre defined policy and penalty losses caused by water allocation shortage when current water availability cannot satisfy water demands external water resources and water right trading may happen to supply water shortage but these operations will increase cost heavily however the tsp has limitation in quantifying effects of water right trading on water shortage and economic benefit water rights trading of participants possess obvious different trading willingness under different hydrological years owing to various available water resources for example buyers own higher willingness to pursuit water right while sellers have higher willingness to sell water right to earn more money under dry year a dynamic game therefore it is essential to measure subjectivities and game of participants on water right trading and quantify effects of water right trading on economic benefit distributed simulation optimization model is an effective tool to get optimal decisions considering crop growth process but it has an obvious disadvantage of low operation efficiency optimal decisions usually require high applicability and robustness as well as easy and quick to be obtained therefore an alternative distributed simulation optimization model that quickly gets optimal strategies is required moreover runoff owns complexed uncertainties due to interactions and multiple variations of meteorological and hydrological elements which causes complexities of optimization and reduce robustness of decisions and thus uncertain optimization method is needed to be established to improve robustness of decisions the fuzzy numbers are one effective uncertain method to solve the above problem but usually adopted regular triangular or trapezoidal fuzzy numbers owns relatively small precision because they imply distribution functions as linear functions therefore a higher precision fuzzy distribution functions are needed 3 3 data collection the input data of the distributed ann bltsfppb model include interval water allocation target benefit coefficient penalty coefficient daily minimum temperature daily maximum temperature and daily rainfall daily evapotranspiration minimum and maximum irrigation amounts starting and ending irrigation date at each growth period irrigation areas of crops available water resources the penalty coefficient contains two kinds of formats and the one is penalty caused by water shortage unsatisfied by regular water resources and the other is penalty resulted from water shortage unsatisfied by water rights trading the penalty degree of the former is lower than the latter the probabilities of wet year normal year and dry year take 0 25 0 5 and 0 25 the conditional probabilities of wet year normal year and dry year take 0 26 0 51 and 0 23 the required data for calculating above conditional probabilities include the conditional probabilities of selling and buying water under wet year normal year and dry year which are set as 0 9 0 8 0 7 and 0 9 1 0 1 0 based on background of local subjectivities of managers separately the reasons for values of probabilities are that selling willingness of sellers decrease as hydrological years change from wet year to dry year because of degraded available trading water resources and buying willingness of buyers present opposite tendencies owing to increased purchasing requirement to satisfy water demands of crops the surface water resource is expressed as fuzzy normal numbers where the average value and variance are determined by water resources time series the minimum and maximum economic benefit and water productivity is calculated separately within given constraints the triangular fuzzy economic benefit target and fuzzy water productivity target are presented as 9800 10000 12000 104yuan and 1 8 2 0 2 2 kg m3 individually there are ten decision making units dmus including seed corn with type1 named sct1 seed corn with type 2 sct2 seed corn with type 3 sct3 seed corn with type 4 sct4 field corn with type 1 fct1 field corn with type 3 fct3 field corn with type 4 fct4 wheat with type 1 wt1 wheat with type 3 wt3 and wheat with type 4 wt4 and each dmu has homogeneous soil and crop type the year 2019 2012 and 2016 was selected as wet normal and dry year individually and the meteorological data of growth periods 4 1 9 22 are got from and meteorological website the 14 driving variables including maximum minimum temperature mat mit evapotranspiration et rainfall r water allocations irrigation amounts at four growth periods wa1 wa2 wa3 and wa4 irrigation dates at four growth periods id1 id2 id3 and id4 and field capacity and wilting point as input data are used to simulate yield and yield is chosen as dependent variable 40 yields time series simulated by the distributed aquacrop under given 40 years driving variables are together with driving variables to select sensitivity variable by exploring correlation between yield and driving variables and further construct the ann model the associated data are obtained from statistical yearbook and local survey and shown as tables1 2 3 4 application of the distributed ann bltsfppb model the expressions of bltsfppb model are shown as follows upper level objective1 maximizing economic benefit f 1 max i 1 i j 1 j n b ij w t ij i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth 25 objective2 minimizing loss risks of economic benefit losses and water productivity 26 f 2 min h 1 h p h δ ht w a ω benefit h 1 h p h δ hs w a ω wp lower level objective function maximizing spatial yield 27 f max i 1 i j 1 j h 1 h p h y ijh w a ijh constraints 1 water availability constraints 28 p i 1 i j 1 j w a ijh a ij q h γ h 2 irrigation dates constraints 29 i d ijt min i d ijht i d ijt max i j h t 3 irrigation amounts constraints 30 w a ijt min w a ijht w a ijt max i j h t 4 yield simulation by distributed ann model 31 an n 1 a n n 2 a n n 3 a n n 10 y i e l d i d w a 5 risk control of benefit pr o f i t i 1 i j 1 j n b ij w t ij i 1 i j 1 j 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j β p c t ij w t ij t 1 t w a ijth 32 33 δ ht w a i d ω benefit ω benefit pr o f i t i f pr o f i t ω benefit 0 i f pr o f i t ω benefit h 34 h 1 h p h δ ht w a i d ω benefit λ ψ benefit 6 risk control of water productivity 35 wp i 1 i j 1 j y ijh i d w a a ij w a ijh a ij h 36 δ hs w a i d ω wp ω wp w p i f w p ω wp 0 i f w p ω wp 37 h 1 h p h δ hs w a i d ω wp λ ψ wp 7 non negative constraints 38 w a ijht 0 i d ijht 0 i j h t where f1 f2 and f denote economic benefit 103yuan total risk losses that including economic benefit loss and water productivity loss and yield 103kg individually i j t and h imply subscript of crop type soil type growth period and hydrological year separately wt wa and id mean water allocation target water allocation mm and irrigation date day decision variables and there are totally 252 decision variables covering all kinds of crop type soil type hydrological years and growth periods wp y δ ht and δ hs are water productivity kg m3 yield ton hm2 risk loss of economic benefit 103yuan and risk loss of water productivity kg m3 a is planting area of crop hm2 ann implies constructed ann model used for simulating crop yield profit ω benefit ψ benefit ω wp and ψ wp denote economic benefit 103yuan target economic benefit 103yuan allowable economic benefit loss 103yuan target water productivity kg m3 and allowable water productivity loss kg m3 β γ and λ are proportion of water shortage caused by water right trading confidence level and allowable level individually i 1 i j 1 j n b ij w t ij i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth indicate regular economic benefit reb first penalty loss named first penalty loss fpl and second penalty loss called second penalty loss spl 103yuan separately h 1 h p h δ ht w a ω benefit and h 1 h p h δ hs w a ω wp imply economic benefit risk loss and water productivity risk loss individually and the sum of the above two kind of losses is total risk losses rlv 4 result analysis 4 1 fitting results of the distributed ann the correlations rc across 14 driving variables and yield are shown as table 3 table 3 showed that yields of all dmus had high correlations with driving factors variables taking ysct1 as an example the rc between 14 driving variables and yield reached around 0 95 indicating 14 driving variables all owning strong correlations with yield of the seed corn with t1 and thus they were all chosen as sensitive driving variables which are also suitable for other nine dmus consequently 14 driving variables were all selected as sensitive driving variables together with yield to train and test the distributed ann model and the results are shown in the fig 3 fig 3 disclosed that spatial yields of ten dmus at the training and testing stages simulated by the distributed ann model had good fittings with yield simulated by the distributed aquacrop model the relative error rates rer varied from 0 6 to 19 within allowable acceptable ranges illustrating that the distributed anns model can replace successfully and effectively the distributed aquacrop model and couple with the bltsfppb model to conduct irrigation scheduling management 4 2 optimal water allocation target and water allocation optimal water allocation target water allocation and irrigation dates could be obtained by solving the distributed ann bltsfppb model using the genetic algorithm ga method that has 400 generations and interactions and each generation owns 100 individuals the satisfactory degree a representation of multiple interactive objectives with variations of iterative process is shown as fig 4 fig 4 illustrates that satisfactory degree tended to stabilize after 400 iterations and 10th individual at 400th generation was selected as the optimal scheme the selection processes were as follows the maximum satisfactory degree across 100 individuals at one generation was chosen as satisfactory degree of each generation and maximum satisfactory degree across 400 generations was selected as final satisfactory degree 1 optimal water allocation target table 4 are results of optimal water allocation target and related intermediate decision variables that determine increased degree of water allocation target compared to lower boundary of water allocation the results showed that crop had different tendencies with variations of soil types water allocation target of seed corn under t2 was biggest followed by t3 t4 and t1 which was also suitable for field corn this is because the yield was positive with water allocation under deficient irrigation and yield under t2 was biggest followed by t3 t4 and t1 under same irrigation scheduling specially water allocation target of wheat with t4 was higher than t3 reasons are that soil characters of t3 and t4 have relatively small differences and one crop with one soil type and water allocation pattern owns different yield because of various water sensitivity at different growth stages consequently water allocation target was affected by yield and water allocation pattern 2 optimal water allocation total water allocations of crops under three hydrological years are represented as the fig 5 fig 5 illustrated that water allocation of one crop under different soil types existed differences the resulted discovered that water allocation of the seed corn under t3 was biggest ranked by t2 t4 and t1 also suitable for field corn and wheat which was mainly affected by benefit coefficient and water allocation target the achievement of biggest economic benefit needs crop with high benefit coefficient and water allocation target that has relatively big water allocation the results demonstrated that water allocations of crops under wet year were higher than normal year and dry year for most dmus while water allocation of some dmus owned different variations with most dmus such as field corn which presented that water allocation under dry year was higher than normal year and this can be explained by reasons that water demands of crops under three hydrological years had interactive intervals and it was allowed that water allocation under dry year was higher than normal year in general water allocation under wet year was biggest followed by normal year and dry year owing to ranked different water demand intervals of crops however water allocation of crop was also affected by water allocation pattern that was water allocation amount at each growth stage taking water allocation of field corn with t3 under three hydrological years as an example and results are shown in fig 6 fig 6 disclosed that water allocation of field corn with t3 at each irrigation period under three hydrological years had no obvious regulations even though there are no apparent regulations water allocation directly affected yield water productivity and economic benefit and risks the yield has different water sensitive degree and first third and fourth growth stages have relatively high influences on yield and thus high water allocation at these stages will improve yield yields under three hydrological years were the same because excessive irrigation will arise deep infiltration ineffective for improving yield optimizing spatially distributed irrigation amount advances irrigation scheduling from views that providing insights into how to allocate water resources following crop growth process according to soil type division crop types and weather conditions under uncertainties 3 optimal irrigation dates table 5 is optimal irrigation dates of crop under four soil types and wet year table 5 illustrated that optimal irrigation dates of crops had obvious differences with variations of soil types combined with optimal water allocation conclusion that irrigation date and water allocation affected each other could be obtained taking the field corn with t3 as an example water allocations at first growth period were 121 mm and 131 mm and optimal irrigation dates at second growth period were 67th day and 73rd day separately water allocations at second growth period were 148 and 104 mm and irrigation dates at third growth period were 100th day and 94th day individually illustrating that higher water allocation might delay irrigation date at next growth period which is because bigger water allocation alleviates duration of water shortage and water shortage degree consequently optimal water allocation and irrigation date affect each other optimizing spatially distributed irrigation date and amount explores their interactions and feedbacks affected by crop water demand and available water resources reflecting dynamic variations of decision changing with spatially distributed hydro meteorological conditions and soil condition a more flexible manner to guide precise irrigation making irrigation scheduling more applicable with actual conditions 4 3 economic benefit risk and yield fig 7 shows yields of crops under three hydrological years it demonstrated that yields of crops had obvious different regulations there were two variation tendencies and one tendency was that yields of crops at some dmus e g sct3 sct4 fct1 and fct3 were the same and another tendency was that yields of crops at rested dmus under three hydrological years were different the reasons for first tendency were mainly affected by water allocation pattern that referred to water allocation amount at each growth period the seed corn has four growth periods including jointing period heading period grouting period and mature period each growth period owns different sensitive degree on water allocation and water allocation exceeding field capacity will result into deep infiltration that is ineffective for improving yield second tendency could be explained by reasons that except for influences of water allocation pattern rainfalls and irrigation dates also generated influences and rainfall effective for improving yield under wet year was higher than normal year and dry year yield was also affected by other objectives objects of economic benefit and yield required more water allocation while object of losses risk needed less water allocation this concerns a comprise process of yield economic benefit and water productivity the losses risk controls yield and water productivity around target yield and water productivity to avoid excessive loss values but target yield and target water productivity have different water allocation threshold this requires water allocation is between water threshold of target water productivity and water threshold of target yield if water allocation equals water threshold of target water productivity and water productivity will be maximum and yield will be small and if water allocation equals water threshold of target yield and yield will be maximum and water productivity will be small the water allocation between the above two water thresholds affects water productivity and yield directly taking the sct1 as an example water shortages were 572 mm 171 mm and 203 mm respectively under wet normal and dry years and thus associated economic benefit lessens and economic loss risk enlarged with decrease of hydrological years the risk and yield represented contradictory relationships because probability of normal year was higher than wet year and dry year and thus yield under normal year occupied a relatively large proportion in expected yield and thus the yield under normal year was biggest in summary the yield was influenced by water allocation pattern and other objectives table 6 are results of regular economic benefit first penalty loss fpl generated from water shortage unsatisfied by current water availability second penalty loss spl caused by water shortage unsatisfied by water right trading economic benefit described as regular economic benefit subtracting first and second penalty losses yield water productivity economic benefit loss water productivity loss and total risk loss value the results illustrated that regular benefits were the same and took 16 7 103yuan under three hydrological years because it was calculated by multiplying fixed water allocation target by fixed benefit coefficient the fpl and spl increased with decrease of hydrological years which was because water shortage enlarges with decreasing hydrological years the increased degree of spl was smaller than fpl which was because spl had higher penalty value under the same water shortage amount and owned smaller weight determining proportion of penalty loss than fpl where weights were set as 0 7 and 0 3 for fpl and spl separately the economic benefit increased with rise of hydrological years because increased degree of regular benefit was higher than total penalty losses with variations of hydrological years the total yield of crop under normal year was biggest followed by wet year and dry year this could be explained by reasons that total yield under each hydrological year was calculated by multiplying yield by occurrence probability of corresponding hydrological year and probability of normal year was highest and ranked by equaled wet year and dry year so increasing yield under normal year had a higher total yield increase degree and better yield economic benefit than other hydrological years the results disclosed that wp enlarged with decrease of hydrological years which was caused by wp was negative with water allocation the results showed that water productivity losses years were zero while economic losses were 0 1 87 103yuan and 3 66 103yuan under three hydrological years separately the 0 denotes there is no risk losses and negative value implies there is risk losses the economic losses increased with rise of hydrological years caused by increasing water shortage the ec was positive reb negative with fpl and spl the ecl and wpl determined rlv the results could provide insight into variation regulations of economic components and achieve risk control for manager optimizing spatially irrigation scheduling with consideration of tradeoff across economic benefit yield and risks emphasizes effects of external economic conditions risks and subjectivities of mangers on decisions forming a manager participants form which builds connections between decisions and managers preferences and pursuits making decisions more flexible and applicable 5 discussion 5 1 comparison with distributed ann bltsfpp model the distributed ann bltsfpp model is the distributed ann bltsfppb without consideration of bayesian based water right trading the expressions of the distributed ann bltsfppb and the distributed ann bltsfpp model are as follows the distributed ann bltsfppb model max f 1 i 1 i j 1 j n b ij w t ij regular benefit i 1 i j 1 j h 1 h 1 p h 1 β p c ij w t ij t 1 t w a ijth fpl first penalty loss caused by external water trasnfer i 1 i j 1 j h 1 h p h β p c t ij w t ij t 1 t w a ijth spl second penaly loss caused bywater right trading the distributed ann bltsfpp model max f 1 i 1 i j 1 j n b ij w t ij regular benefit i 1 i j 1 j ho 1 ho p ho p c ij w t ij t 1 t w a ijth penalty loss caused by external water transfer compared with the distributed ann bltsfpp model the distributed ann bltsfpp model divided the penalty loss into first penalty loss caused by water transfer fpl and second penalty loss resulted from water right trading spl and respective weights were set as 0 7 and 0 3 the optimal water allocation target water allocation yield economic components obtained from the above two models were analyzed and advantages of the distributed ann bltsfppb model were stocked out the iterative process of the distributed ann bltsfpp model and the distributed ann bltsfppb is shown in the fig 9 fig 9 disclosed that satisfactory degree of the distributed ann bltsfppb was higher than the distributed ann bltsfpp model illustrating that economic benefit risks and yield considering water right trading were better than without considering trading to understand regulations of water allocation targets of these two models results are shown in table 7 it illustrated that water allocation target considering water right trading was higher than this without water right trading for most dmus this was because penalty loss generated by the distributed ann bltsfppb model was less than the distributed ann bltsfpp model owing to different water allocation water allocation target and water allocation affected penalty losses feed backed and adjusted for each other to determine automatically optimal water allocation and water allocation target and further reduce penalty loss and achieve higher economic benefit if the water allocation is less and penalty loss will enlarge and water allocation target will be adjusted to be less to reduce penalty loss differences of water allocations of these two model named d value of water allocation and differences of yields named d value of yield were used to compare water allocation and yield differences of these two models shown in fig 10 the results demonstrated that d values of water allocations under three hydrological years all exceeded 0 illustrating that water allocation considering water right trading was higher than this without water right trading d values of yields for most dmus outstripped 0 clarifying that yield with consideration of water right trading was bigger than this without trading conclusion that yield was affected deeply by total water allocation and total water allocation played mostly impacts on yield could be obtained table 8 are differences of economic components yield and risks of the distributed ann bltsfppb model and the distributed ann bltsfpp model the d values of the above components were calculated by values obtained from the ann bltsfpp model subtracting values obtained from the distributed ann bltsfppb model the results showed that economic benefit ec considering water right trading was higher than without trading which was because that regular benefit associated with water allocation target with consideration of water right trading was slightly higher than this without water right trading while penalty loss with water right trading was obviously lower than this without trading for example the sum of fpl and spl of the distributed ann bltsfppb model was 8 12 103yuan while the fpl of the distributed ann bltsfpp model took 11 66 103yuan the expected economic benefit and yield with water right trading enlarged by 3 46 103yuan and 0 97 ton hm2 than the ec and yield without water trading separately this means that water trading can improve economic benefit and yield the d value of total economic loss drlv valued positive values demonstrating that total risks considering water right trading bore less economic loss risk values than without water trading highly reducing economic loss risks consequently compared with the ann bltsfpp model the distributed ann bltsfppb model could reach yield improvement economic benefit raise risk loss control at the expense of water allocation reaching a key tradeoff across multiple variables and getting comprised results optimizing spatially irrigation scheduling taking water right trading into account help to figure out effects of water right trading on decisions and provide decision supports for managers about how to make decisions irrigation scheduling via water right trading when there is not enough water availability 5 2 comparison with the distributed aquacrop probabilistic possibilistic programming distributed aquacrop pp with fuzzy random coefficient model the distributed aquacrop pp model was developed by wang et al wang et al 2021 to optimize irrigation scheduling under uncertainties the expressions of the model were shown as follows objective function maximizing economic benefit generated from yield maxf i 1 i c i t a i i 1 i h 1 h p h e i d ih where f is economic benefit 103yuan ta and d denote yield target and yield shortage separately kg hm2 c i e i imply crop price of yield and penalty coefficient caused by yield shortage individually yuan kg i is subscript of decision making units dmus there are mainly five differences including objective decision variables yield simulation method calculation times ct water allocations between the two models shown in table 9 1 it discovered that calculation times were about 0 5 day and 3 days by running 500 generations based on the ga method for the distributed ann bltsfppb model and distributed aquacrop pp model individually the obvious differences were caused by that the distributed aquacrop pp model required calling complexed and time consuming external aquacrop plug in exe while the developed model simplified calling process of external exe by calling internal subfunctions significantly promoting efficiencies optimizing spatially irrigation scheduling using the distributed ann model can highly improve calculation efficiencies when there are complexed input scenarios bordering application the distributed ann optimization model in optimizing irrigation scheduling 2 it disclosed that water allocation and yield of the distributed aquacrop pp model were both higher slightly than the distributed ann bltsfppb model and increased rate of water allocation was bigger than yield taking 5 and 1 respectively reasons for the above phenomenon were that emphasizes of the former was maximum yield positive with water allocation under deficient irrigation and thus it inevitably raised relatively low water productivity besides it ignored risk control water resources feedbacks and tradeoffs making water allocation lack of widely application and extension which sideways highlighted advantages of the distributed ann bltsfppb model consequently the distributed ann bltsfppb model could improve successfully calculation efficiency with promising simulation accuracy besides it could reach critical tradeoffs of water resources between managers at different power layers and multiple objectives as well as ensure losses risk to vary in acceptable ranges 6 conclusion this paper developed a distributed ann bltsfppb model by incorporating distributed ann model with blp tsp fpp bayesian and downside risk approaches for optimizing distributed irrigation amounts dates and water allocation target collectively the important conclusions were that 1 economic benefit yield with consideration of water right trading enlarged by 70 and 16 5 than these without water right trading 2 the economic loss risk value decreased by 70 considering water right trading 3 the distributed ann model can effectively replace with the distributed aquacrop model by saving about 5 times of times the developed model has following advantages in 1 it establishes a bltsfppb model giving new insight into how to reflect subjectivities of mangers on water right trading and how to allocate water resources taking water right trading into account 2 it reduces uncertainties of decisions by simulating spatial heterogeneous yield simulated by distributed ann model and deals with uncertainties of runoff as fuzzy normal distribution enhancing robustness of decisions 3 it improve highly calculation efficiencies of the distributed simulation optimization model by replacing distributed aquacrop model with the distributed ann model that couples with the bltsfppb model the developed model was proved to be an efficient tool to optimize distributed irrigation scheduling simultaneously in the arid and semi arid district however uncertainties of crop simulation model because yield is widely affected by multiple driving factors such as rainfall temperature and irrigation are not studied which affects simulation accuracy of yield this problem can be handled in future studies credit authorship contribution statement youzhi wang conceptualization methodology software writing original draft huijuan yin data curation xinwei guo wenge zhang visualization supervision qiangkun li investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was financially supported by national natural science foundation of china no 51809104 
3662,transport of contaminants in coastal aquifers subject to tidal fluctuations is an important topic and a growing problem due to increasing populations and development in coastal areas many studies have used variable boundary conditions to simulate transport behavior at the interface between seawater and groundwater however to the best of our knowledge no analytical solution accounting for variable concentration boundary conditions exists for plume migration of land derived contaminants passing through the inland zone of aquifers under tidally induced periodic flow here a two dimensional 2d semi analytical solution for land derived solute transport was developed with variable boundary conditions at the seaward boundary under tidal fluctuations the proposed 2d semi analytical solution was verified through comparison with an existing one dimensional semi analytical solution and a 2d numerical solution developed using the finite element method sensitivity analysis was performed to explore factors including hydraulic properties tidal amplitude and the location and distribution of initial contaminants which affect the characteristics of land derived pollutant transport in coastal aquifers through comparison of the calculated masses remaining over time in the aquifer using the proposed semi analytical solution under two types of variable boundary conditions dirichlet neumann and cauchy neumann variable boundary conditions we found that the cauchy neumann variable boundary conditions reflected reality better than did the dirichlet neumann variable boundary conditions the proposed analytical solution will be useful for obtaining insights into the mechanisms that drive the plume behavior of contaminants such as radionuclides or toxic chemicals released into coastal aquifers of tidally affected systems keywords cauchy neumann variable boundary conditions land derived solute transport proposed 2d semi analytical solution tidally induced variable boundary conditions 1 introduction transport of contaminants in coastal aquifers subject to tidal fluctuations is an important topic in addressing a growing problem caused by increasing population and development in coastal areas plume migration of land derived contaminants passing through the inland zone and discharging into the sea or estuaries can lead to significant degradation of the receiving coastal ecosystems however relatively little research has been done to investigate the fate of land derived contaminants subject to tidal fluctuations relative to the submarine groundwater discharge yim and mohsen 1992 developed a 1d numerical model to simulate mass transport from a contaminant plume to a tidal estuary in their study the oscillating velocity field induced by tides was determined by differentiating the 1d hydraulic head fluctuation equation which represents the response of the groundwater level to sinusoidal tidal fluctuations in a homogeneous and isotropic confined aquifer at the surface groundwater interface variable boundary conditions were imposed to account for the effects of tidal fluctuations on land derived contaminant transport when surface water enters the aquifer at this interface the dirichlet boundary condition of zero contaminant concentration is used to represent infiltration of uncontaminated surface water into the aquifer along with an assumption of zero concentration gradient otherwise when groundwater discharges into a tidal stream the concentration gradient is set equal to zero at the boundary between the surface and the groundwater at the landward boundary a concentration gradient equal to zero is imposed assuming that this boundary is sufficiently far from the land derived contaminant plume boufadel 2000 conducted two laboratory experiments to investigate the effects of tides and buoyancy on beach hydraulics and performed simulations using the marine unsaturated marun model in this simulation of transport water influx to the beach is assigned dirichlet boundary conditions with the seawater concentration at the beach surface while water leaving the beach is assigned the neumann boundary conditions with zero dispersive flux such boundary conditions are referred to as variable boundary conditions which switch between dirichlet and neumann boundary conditions depending on the flow direction at the boundary variable boundary conditions have been widely used in numerous studies galeati et al 1992 huyakorn et al 1987 sherif et al 1988 yim and mohsen 1992 geng and boufadel 2015 park and aral 2008 mulligan et al 2011 kolditz et al 2016 smith 2004 walther et al 2017 in particular park and aral 2008 found that submarine groundwater discharge may vary significantly depending on the type of boundary conditions used indicating that use of the appropriate variable boundary conditions at the seaward boundary is essential to prevent artificial accumulation of contaminant mass at the boundary however to our knowledge no analytical solutions that account for variable boundary conditions exist for investigating plume migration of land derived contaminants through the inland zone of aquifers adjacent to coastal areas under oscillating tidal flow conditions and discharge into seas or estuaries this study focused on contaminants of terrestrial origin that are either absent or extremely scarce in seawater such as an oil spill due to the failure of an inshore underground storage tank or radioactive contaminant leakage due to a nuclear power plant accident while most previous work has focused almost exclusively on describing and predicting saltwater distribution in aquifers here the tidally induced oscillating flow is periodic flow with exponentially decreasing amplitude of groundwater head changes with distance inland from the coast although suk 2017 derived a one dimensional analytical solution for land derived solute transport subject to tidal fluctuations in a homogeneous confined coastal aquifer that solution was limited to the neumann boundary condition with zero dispersive flux at the seaward boundary the neumann boundary conditions are applicable only when flow is directed seaward whereas for flow directed toward the aquifer from the sea and plumes that have already reached the seaward boundary the neumann boundary conditions are physically inappropriate this difference arises because dispersive flux never reaches zero under the assumption of strong flushing with seawater as strong dilution due to mixing with seawater of zero concentration occurs at the boundary and therefore the concentration gradient at the boundary is large in such cases the cauchy boundary conditions with zero mass flux are more physically appropriate than the neumann boundary conditions as in the real physical situation no mass is added to the aquifer through the seaward boundary notably in this study a semi analytical solution was developed under the assumption that contaminants discharging into the sea do not affect the concentration in seawater this assumption is logical as the sea is substantially larger than the pollutant mass flux discharging into it on the other hand even under weak or moderate flushing conditions the neumann boundary conditions violate the mass balance principle and are therefore inappropriate because advective flux at the boundary i e the boundary concentration multiplied by advective velocity will never be zero as noted above in reality no mass is added to the aquifer through the seaward boundary therefore if the neumann boundary conditions were applied quantification of the mass remaining within the aquifer would be erroneous in other words spurious mass influx into the aquifer and accumulation will occur at the seaward boundary the primary objective of this study was to obtain a two dimensional analytical solution for land derived solute transport subject to tidal fluctuations while accounting for variable boundary conditions at the seaward boundary in a homogeneous coastal confined aquifer here we did not consider the density difference between seawater and groundwater or forced convection of groundwater due to hydraulic head differences between groundwater and seawater because we did not account for the density difference between seawater and groundwater we did not consider the interface between saltwater and freshwater or density driven convection cells caused by seawater intrusion and hydrodynamic dispersion of salt within the coastal salt wedge this solution provides a useful mathematical tool for validating numerical models and elucidating the physical mechanism of plume discharge into seas or estuaries we also performed sensitivity analysis to examine the factors affecting land derived pollutant transport in coastal aquifers furthermore this study builds on the work of suk 2017 to include variable boundary conditions at the seaward boundary and extends that study to a two dimensional analytical solution to clarify the multi dimensional behaviors of land derived solute transport in complex hydrodynamics or locations as well as the two dimensional distribution of the initial contaminant load 2 problem formulation 2 1 governing equation and boundary conditions jacob 1950 analytically solved the response of groundwater head to a sinusoidal boundary condition in a homogeneous and isotropic semi infinite confined aquifer as follows 1 h x t h 0 exp β x sin 2 π t t 0 β x where h x t represents the rise and fall of the piezometric surface at a distance x inland of the shoreline with respect to the mean surface water level at time t h0 is the amplitude of the tide and t0 is the period of the tidal cycle the term β represents the physical properties of the aquifer and is defined as 2 β π s t 0 t xx π s t 0 k xx b where s is the storage coefficient t xx is the x directional transmissivity k xx is the x directional hydraulic conductivity and b is the thickness of the confined aquifer this solution essentially forms the shape of a landward traveling wave with an exponentially narrowing envelope for the purpose of deriving the semi analytical solution of solute transport with advection and dispersion subject to tidal fluctuations in a confined aquifer the tidally induced x directional velocity field v x x t can be obtained by differentiating eq 1 with respect to x as follows 3a v x x t v 0 x exp β x sin ω t β x π 4 where 3b v 0 x 2 k xx n e h 0 β 3c ω 2 π t 0 and where ne is the effective porosity of the aquifer here it is assumed that groundwater flow is directed only along the x axis and has no y directional velocity component accordingly the x and y directional dispersion coefficients d xx x t and d yy x t respectively can be obtained as the product of dispersivity and velocity as follows 4a d xx x t α l v x x t 4b d yy x t α t v x x t where α l and α t are the constant local longitudinal dispersivity and transverse dispersivity respectively furthermore the dispersion coefficient can be expressed using the groundwater velocity of eq 3a as follows 5a d xx x t d 0 x x exp β x sin ω t β x π 4 d 0 x x e x p β x 1 n x t s i n ω t β x π 4 5b d yy x t d 0 y y exp β x sin ω t β x π 4 d 0 y y e x p β x 1 n x t s i n ω t β x π 4 where 5c d 0 x x α l v 0 x 5d d 0 y y α t v 0 x 5e n x t int ω t π β x π 1 4 0 t t f a n d 0 x l x where int rounds a number down to the nearest integer l x is the x axis length and t f is the final simulation time notably the dispersion coefficient is always positive regardless of velocity therefore to make the dispersion coefficient positive n is calculated in eq 5e depending on both time and the x axis coordinate a detailed explanation of the derivation of n x t can be found in suk 2017 with the velocities and dispersion coefficients described above the concentration distribution of the contaminant plume can be obtained using the following two dimensional advection and dispersion equation elfeki et al 2007 bear 1979 6 r c t x v x x t c x d xx x t c x d yy x t 2 c y 2 k c where r is the retardation factor k is the first order decay rate constant and c is the concentration here the landward side is assumed to follow the zero dispersive flux boundary condition while the top and bottom of the domain use zero dispersive flux boundary conditions as shown in fig 1 the mathematical expression of the boundary conditions at the landward side are expressed as eq 7 and those of the bottom and top are eqs 8 and 9 respectively 7 d xx c x x l x 0 0 y l y a n d 0 t t f 8 d yy c y y 0 0 0 x l x a n d 0 t t f 9 d yy c y y l y 0 0 x l x a n d 0 t t f where l y is the y axis length and t f is the final simulation time in addition the seaward boundary conditions imposed are the variable boundary conditions described as follows 10a d xx c x v x c x 0 0 0 y l y a n d 0 t t f when s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 10b d xx c x x 0 0 0 y l y a n d 0 t t f when g r o u n d w a t e r d i s c h a r g e s i n t o t h e s e a v x 0 t 0 eqs 10a and 10b represent the cauchy and neumann boundary conditions respectively in contrast to previous studies galeati et al 1992 huyakorn et al 1987 sherif et al 1988 yim and mohsen 1992 geng and boufadel 2015 park and aral 2008 in which the variable boundary conditions switched between dirichlet and neumann depending on the flow direction at the boundary in this study the variable boundary conditions switch between cauchy and neumann boundary conditions in previous studies the neumann boundary conditions were prescribed with zero dispersive flux wherein the concentration at an infinitesimal distance inward from the seaward boundary is very close to the concentration in the seawater on the other hand in this study the cauchy boundary conditions are prescribed with zero total mass flux allowing no contaminants to enter the aquifer because seawater adjacent to the boundary is strongly mixed during the high tide cycle and seawater is nearly free of the contaminant in fact if the land derived contaminant concentration in seawater is assumed to always be zero and the concentration gradient adjacent to the seaward boundary is assumed to be negligible the dirichlet boundary conditions used in previous studies would mimic the cauchy boundary conditions note that jacob 1950 solved the groundwater head fluctuation for a semi infinite domain under the assumption that the tide has no effect far inland as x approaches infinity whereas in this study solute transport is solved for a finite domain with the neumann boundary condition to remain physically consistent in the boundary conditions between fluid flow and solute transport problems we assume that the finite region length l x is large enough to negate the tidal effect at the land boundary so that the tidal induced velocity is also negligible at the landward boundary therefore the neumann boundary of the landward boundary used here is equivalent to a cauchy boundary condition with zero mass flux and ensures that pollutants within the domain do not physically move through the landward boundary through dispersive or advective fluxes during the simulation period the initial conditions are assumed to have an arbitrary distribution as follows 11 c x y t 0 c 0 f x y 0 x l x a n d 0 y l y where c 0 is the maximum initial concentration and f x y is the initial concentration normalized by c 0 by defining the following dimensionless quantities 12a x x l x y y l y t t t f c c c 0 a l α l l x 1 p e a t l x l y 2 α t v 0 x 1 r t f l x v 0 x k 1 r k t f e 0 x x a l v 0 x e 0 y y a t v 0 x β β l x ω ω t f 12b v x x t v 0 x exp β x sin ω t β x π 4 12c e xx x t e 0 x x 1 n x t exp β x sin ω t β x π 4 12d e yy x t e 0 y y 1 n x t exp β x sin ω t β x π 4 12e n x t int ω π t β π x 1 4 where p e 1 a l l x α l is the péclet number eqs 6 11 can be rewritten with eq 12a 12d respectively as follows 13 c t x v x x t c x e xx x t c x e yy x t 2 c y 2 k c 14 e xx c x x 1 0 0 y 1 a n d 0 t 1 15 e yy c y y 0 0 0 x 1 a n d 0 t 1 16 e yy c y y 1 0 0 x 1 a n d 0 t 1 17a e xx c x v x c x 0 0 0 y 1 a n d 0 t 1 when s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 17b e xx c x x 0 0 0 y 1 a n d 0 t 1 when g r o u n d w a t e r d i s c h a r g e s i n t o t h e s e a v x 0 t 0 18 c x y t 0 f x y 2 2 analytical solution of the mathematical model to solve eq 13 using the general integral transformation technique gitt x and y directional eigenfunctions x and y directional eigenvalues and x and y directional norms are defined based on the imposed boundary conditions for the detailed derivations of these eigenfunctions eigenvalues and norms please refer to supplementary section a when seawater enters the aquifer v x 0 t 0 in the x direction that is when the cauchy boundary conditions with zero mass flux are imposed at the seaward boundary the x directional eigenfunctions are defined by eq 19a specifically the x directional eigenvalues λ i x 1 can be obtained through solution of nonlinear equation 19b then x directional norms are calculated with eq 19c using those eigenvalues 19a φ i x 1 x cos λ i x 1 1 x i 1 2 m x 19b cos λ i x 1 a l λ i x 1 sin λ i x 1 0 i 1 2 m x 19c n i x 1 1 2 1 4 λ i x 1 sin 2 λ i x 1 i 1 2 m x where m x is a value sufficiently large to produce the desired level of accuracy in the x axis on the other hand when groundwater is discharged into the sea in the x direction v x 0 t 0 i e under the neumann boundary conditions with zero dispersive flux at the seaward boundary the x directional eigenfunctions x directional eigenvalues and x directional norms are obtained using in eqs 20a 20b and 20c respectively 20a φ i x 2 x 1 i 0 cos λ i x 2 x i 1 2 m x 20b λ i x 2 0 i 0 i π i 1 2 m x 20c n i x 2 1 i 0 1 2 i 1 2 m x in addition y directional eigenfunctions y directional eigenvalues and y directional norms can be determined using eqs 21a 21b and 21c respectively 21a φ j y y 1 j 0 cos λ j y y j 1 2 m y 21b λ j y 0 j 0 j π j 1 2 m y 21c n j y 1 j 0 1 2 j 1 2 m y where m y is a value sufficiently large to produce the desired level of accuracy along the y axis following the procedures of the gitt the generalized integral transform pairs can be defined as follows when seawater enters the aquifer along the x axis v x 0 t 0 22a s ij 1 t 0 1 0 1 ψ i x 1 x ψ j y y c x y t d y d x i 1 2 m x j 0 1 m y 22b c x y t i 1 m x j 0 m y ψ i x 1 x ψ j y y s ij 1 t where s ij 1 t represents variables transformed in the gitt when seawater enters the aquifer ψ i x 1 x is the normalized x directional eigenfunction when seawater enters the aquifer along the x axis and ψ j y y is the normalized y directional eigenfunction here the normalized x directional eigenfunction and normalized y directional eigenfunction are described by eqs 23a and 23b respectively 23a ψ i x 1 x φ i x 1 x n i x 1 1 2 i 1 2 m x 23b ψ j y y φ j y y n j y 1 2 j 0 1 m y otherwise when groundwater discharges into the sea along the x axis v x 0 t 0 the generalized integral transform pair can be defined as follows 24a s ij 2 t 0 1 0 1 ψ i x 2 x ψ j y y c x y t d y d x i 0 1 m x j 0 1 m y 24b c x y t i 0 m x j 0 m y ψ i x 2 x ψ j y y s ij 2 t where s ij 2 t represents variables transformed in the gitt when groundwater discharges into the sea and ψ i x 2 x is the normalized x directional eigenfunction when groundwater discharges into the sea similarly the normalized x directional eigenfunctions are expressed as eq 25 25 ψ i x 2 x φ i x 2 x n i x 2 1 2 i 0 1 m x in the forward transform multiplying both sides of eq 13 by ψ i x 1 x ψ j y y and then integrating with respect to both y and x from 0 to 1 using green s theorem and the boundary conditions of eqs 14 16 and 17a and then finally replacing c x y t with the inverse transform of gitt given by eq 22b the truncated linear system of coupled first order ordinary differential equations ode can be constructed to solve for the transformed variable s 1 t in eq 22a the details of constructing the ode system and solving the transformed variables s 1 t are presented in appendix a after the set of coupled first order differential equations for s 1 t is solved the inverse gitt formula shown in eq 22b can be calculated to obtain c x y t the abovementioned derviation of c x y t corresponds to the case when seawater enters the aquifer in this case the analytical solution is derived with eigenfunctions φ i x 1 x eigenvalues λ i x 1 and norms n i x 1 obtained from the auxiliary equation that is compatible with the cauchy boundary condition as expressed in eq 17a similarly when groundwater discharges into the sea an analytical solution can be derived using eigenfunctions φ i x 2 x eigenvalues λ i x 2 and norms n i x 2 obtained from the auxiliary equation corresponding to the neumann boundary condition as shown in eq 17b similar to the derivation of c x y t for the case when seawater enters the aquifer shown in appendix a appendix b shows the mathematical derivation for when groundwater discharges to the sea as mentioned previously we have provided analytical solutions of land derived solute transport under tidal fluctuations in a confined aquifer under both cauchy and neumann boundary conditions at the seaward boundary however since most coastal areas have two high tides and two low tides each day and the flow direction between seawater and groundwater i e groundwater discharging to the sea or seawater influx to the aquifer changes almost regularly each day depending on the tide procedures are required to obtain an analytical solution describing land derived contaminant transport over time that reflects the regular reversal of flow direction the procedure for implementing a variable boundary condition that switches between the neumann discharge of groundwater into the sea and cauchy seawater flowing into the aquifer boundary conditions according to the flow direction is as follows for example we assume that the simulation time starts at zero and that at a simulation time of 0 t t 1 3 4 π ω the velocity at the seaward boundary directs flow from the sea into the aquifer for the sake of clarity the procedure of gitt considering such variable boundary conditions is systematically defined in table 1 according to table 1 we first obtain an analytical solution at simulation time 0 t t 1 using eq a6a in appendix a along with the initial condition at time zero 26a s 1 t exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ s 1 0 a t 0 t t 1 where 26b s mn 1 0 0 1 0 1 c x y 0 ψ m x 1 x ψ n y y d y d x m 1 2 m x n 1 2 m y then the concentration distribution c x y t at time 0 t t 1 is determined using the inverse transform described in eq 22b as follows 26c c x y t i 1 m x j 0 m y ψ i x 1 x ψ j y y s ij 1 t a t 0 t t 1 after we solve concentration distributions at simulation time 0 t t 1 using eq 26c the concentration distribution at time t t 1 t t 2 7 4 π ω can be determined using the concentration distribution at simulation time t 1 obtained from eq 26c in this case at simulation time t 1 t t 2 the velocity at the seaward boundary changes from flow into the aquifer to flow out of the aquifer and thus the boundary conditions switch from cauchy to neumann from simulation time t 1 to t 2 an analytical solution based on gitt can be obtained using eq b3a in appendix b as follows 27a s 2 t exp t 1 t c 1 σ c 2 σ c 3 σ c 4 σ d σ s 2 t 1 a t t 1 t t 2 where 27b s mn 2 t 1 0 1 0 1 c x y t 1 ψ m x 2 x ψ n y y d y d x m 0 1 2 m x n 0 1 2 m y after we solve eq 27a the inverse gitt formula in eq 24b can be used to obtain c x y t at time t 1 t t 2 as follows 27c c x y t i 0 m x j 0 m y ψ i x 2 x ψ j y y s ij 2 t a t t 1 t t 2 then after solving the concentration distribution c x y t 2 using eq 27c the concentration distribution c x y t at t 2 t t 3 11 4 π ω can be obtained from the concentration c x y t 2 in this case at a simulation time of t 2 t t 3 velocity at the seaward boundary changes from flow out of the aquifer to flow into the aquifer switching from the neumann to the cauchy boundary condition from the simulation time t 2 to t 3 the concentration distribution c x y t can be calculated using eqs 26a 26c again but with the starting time changed from 0 to t 2 and the ending time changed from t 1 to t 3 thus far we have developed an analytical solution for land derived solute transport under variable boundary conditions at the seaward boundary with a single switch from one boundary condition to another however under real conditions periodic flow due to tidal fluctuations causes repeated switches of the boundary conditions over time in this case an analytical solution can be easily obtained by sequential calculation through repetition of the processes described above 3 verification in this section the proposed two dimensional 2d analytical solution is verified through comparison with the one dimensional 1d semi analytical solution described previously by suk 2017 and the 2d numerical solution obtained using a finite element method for verification of the proposed 2d analytical solution against the existing 1d analytical solution of suk 2017 the initial plume of the 2d problem is located in the center of the domain away from the boundaries to avoid effects of the boundary conditions accordingly at the seaward boundary the neumann boundary conditions used for analytical solution of the 1d problem and the variable boundary conditions used for the 2d problem do not produce different simulation results as the plumes do not contact the seaward boundary and thus the solute concentration at the seaward boundary remains zero throughout the simulation if the initial contaminant distribution is assumed to be even across the whole domain of the y axis the 2d analytical solution will be identical to the 1d analytical solution furthermore to match the flow conditions of the 2d problem to those used in the 1d problem the x directional velocity is defined as equal to the velocity in the 1d problem in this study the y directional velocity component is assumed to be zero lastly to align the dispersion effect in the 2d problem with that in the 1d problem transverse dispersion effects in the 2d problem are suppressed by setting the transverse dispersivity α t to zero all input parameters are listed in table 2 as shown in table 2 all of the input parameters of the proposed 2d solution are the same as those used for the 1d semi analytical solution except d 0 y y transverse dispersivity α t and l y comparisons of the proposed 2d solutions against 1d semi analytical solutions at four time points are presented in fig 2 the proposed 2d solutions have identical results to the 1d solutions in the second verification example in contrast to the first problem two dimensional plume migration was simulated using the proposed analytical solution and in house code developed using the two dimensional finite element method fem in this study to compare our analytical solution from this study against numerical results the standard galerkin finite element method with the crank nicolson scheme was employed to obtain numerical code for simulating two dimensional solute transport subject to tidal fluctuations under variable boundary conditions as shown in fig 1 the initial plume concentration distribution had a prism shape with a width of 0 4 m along the x axis a length of 0 4 m along the y axis and maximum concentration of 1 ppm its center was located 1 m from the seaward boundary except for the seaward boundary where variable boundary conditions were prescribed all boundaries had zero dispersive flux boundary conditions the input parameters used for this simulation are summarized in table 3 the results of the proposed 2d analytical solution and numerical solutions at various times are shown in fig 3 and fig s1 in supplementary section f as shown in fig 3 the results aligned well at all times because the tidal period was 0 52 days flow direction changed every 0 26 days thus in fig 3a plumes migrate in the landward direction during the initial 0 26 days and then from 0 26 days to 0 52 days the plumes move in the seaward direction as shown in fig 3b where the neumann variable boundary conditions were applied at the seaward boundary in accordance with the seaward flow direction and the plumes hit the seaward boundary before the end of the first cycle after one cycle the plumes traveled landward again as shown in fig 3c and the cauchy variable boundary conditions were applied with no mass flux as flow was landward at the boundary lastly after one and a half periods the plumes traveled back in the seaward direction and the variable boundary conditions switched to the neumann boundary conditions in fig 3d to show that the numerical solutions obtained using the newly developed numerical code had negligible numerical errors various grid sizes were used to obtain concentration distributions at different times and the results were compared to the analytical solutions for clearer visualization of the comparison between numerical solutions at various grid sizes and analytical solutions only the concentration profiles at y 1 5 m and x 1 0 m are shown in figs s1a and b in supplementary section f respectively as shown in figs s1a and b at smaller grid sizes the numerical results are closer to the analytical solutions finally when the x and y directional grid sizes and time step size were 0 005 m 0 005 m and 0 001 days respectively the numerical solutions nearly matched the analytical solutions in this case the proposed 2d analytical solution had almost 74 fold faster performance in terms of cpu time compared to the fem data not shown although much smaller grid and time step sizes were tested the results did not change data not shown therefore we can conclude that the grid and time step sizes employed are sufficient to converge at an accurate solution 4 results and discussion 4 1 effects of tides and hydraulic properties this section focuses on the effects of the hydraulic properties of the confined aquifer and tides on contaminant transport near the seaward boundary using the proposed 2d analytical solution to study these effects an example was analyzed as shown in table 4 the domain was set to 10 m by 5 m and the source shape was a prism similar to fig 1 the initial source was located near the seaward boundary for analysis of the distribution of the contaminant over time and for exploring the influences of variable boundary conditions on x and y directional centroid displacements the mass remaining in the aquifer x y and xy directional variances and longitudinal and transverse macrodispersion sensitivity analysis of the tidal amplitude hydraulic conductivity and storage coefficient was conducted to investigate plume behavior near the boundary to determine the effects of tide and hydraulic properties on contaminant transport some plume characteristics such as centroid displacements variances and macrodispersion coefficients were derived analytically using the statistical moments of the plumes the x directional centroid displacement x t y directional centroid displacement y t mass remaining in the aquifer m t x directional variance σ xx 2 t y directional variance σ yy 2 t x y directional variance σ xy 2 t longitudinal macrodispersion d l t and transverse macrodispersion d t t can be readily and accurately calculated using gitt first we calculated the spatial moments at dimensionless time t using the following equation 28 m pq t 0 1 0 1 x p y q c x y t d y d x where p q is the order of the moment in eq 28 m pq t can be calculated as shown in eq 29a or 29b using eq 22b or eq 24b respectively depending on whether the direction of flow at the seaward boundary v x x 0 t is landward or seaward as follows 29a m pq t i 1 m x j 0 m y 0 1 x p ψ i x 1 x d x 0 1 y q ψ j y y d y s ij 1 t w h e n s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 29b m pq t i 0 m x j 0 m y 0 1 x p ψ i x 2 x d x 0 1 y q ψ j y y d y s ij 2 t when groundwater is discharged v x 0 t 0 using m pq t in eq 29a or 29b depending on the direction of groundwater velocity the x directional centroid displacement x t y directional centroid displacement y t remaining mass m t x directional variance σ xx 2 t y directional variance σ yy 2 t xy directional variance σ xy 2 t longitudinal macrodispersion d l t and transverse macrodispersion d t t can be calculated as follows 30a x t m 10 t m 00 t 30b y t m 01 t m 00 t 30c m t m 00 t 30d σ xx 2 t m 20 t m 00 t m 10 t m 00 t 2 30e σ yy 2 t m 02 t m 00 t m 01 t m 00 t 2 30f σ xy 2 t σ yx 2 t m 11 t m 00 t m 10 t m 00 t m 01 t m 00 t 30 g d l t 1 2 d σ xx 2 t dt 30 h d t t 1 2 d σ yy 2 t dt notably all statistical moments described above can be calculated analytically and the errors involved are negligible 4 1 1 effect of the magnitude of tidal amplitude on plume behavior to explore the effect of the magnitude of tidal amplitude concentration distributions at time points 0 195 0 455 0 715 and 0 975 days and magnitudes 0 1 1 and 2 m were calculated using the proposed 2d analytical solution as shown in fig 4 a b c and d respectively as shown in fig 4a the concentration distribution at the simulation time of 0 195 days before the halfway point was skewed in the landward direction while that at the simulation time of 0 455 days after the halfway point was near the original initial location as shown in fig 4b after one cycle the plumes traveled landward again as shown in fig 4c where the variable boundary conditions applied were the cauchy boundary conditions with no mass flux lastly after one and a half periods the plumes traveled back in the seaward direction and the variable boundary conditions were replaced with the neumann boundary conditions as shown in fig 4d at 0 975 days with an amplitude of 2 m the plume hit the seaward boundary and the contaminant flowed out through the boundary the plume centroid along the x axis the remaining mass variance along the x axis variance along the y axis longitudinal macrodispersion and the transverse macrodispersion are shown in fig 5 a f respectively in this study the y directional velocity was assumed to be zero and thus the plume centroid along the y axis always had the same value not shown here as shown in fig 5a f the centroid displacement mass remaining in the aquifer variance and macrodispersion values changed periodically depending on the direction and magnitude of the groundwater velocity in fig 5a the plume centroid along the x axis indicated that the plume moved fastest at the highest amplitude of 2 m and slowest at the lowest amplitude of 0 1 m this trend arises because high amplitude induces a strong gradient and thus increases the advection velocity however after 0 975 days the plume centroid along the x axis at the highest amplitude of 2 m appeared to move inland with time the reason for this apparent landward movement is that after 0 975 days the plume reached the seaward boundary and left the aquifer causing plume mass around the seaward boundary to decrease over time by contrast no plume mass crossed the landward boundary and therefore the plume mass near the landward boundary did not decrease notably the plume did not reach the landward boundary within the simulation time and therefore no mass crossed the landward boundary therefore the plume with an amplitude of 2 m appeared to move landward according to the statistical calculation described by eq 30a as its center of mass moved landward in reality the plume itself did not move inland fig 5b shows the mass remaining in the aquifer the remaining mass decreased whenever groundwater was discharged into the sea while it was not reduced while groundwater moved landward accordingly the graph of the remaining mass takes the form of a staircase decreasing in steps over time furthermore the remaining mass decreased fastest at the highest amplitude of 2 m which had the highest advection velocity fig 5c and d show the increases in x and y directional variances with increased tidal amplitude respectively these increases occur because larger amplitude leads to a larger advection velocity and greater dispersion coefficient enhancing the spread of the plume accordingly as shown in fig 5c and d the tidal amplitude of 2 m exhibited the most plume spreading periodicity was apparent in the variances along both the x and y axes fig 5e and f show longitudinal and transverse macrodispersion respectively as shown in fig 5e longitudinal macrodispersion has negative values whereas fig 5f shows that transverse macrodispersion has no negative values negative longitudinal macrodispersion occurs due to the difference between the advection velocities at the leading and trailing edges especially when the advective velocity is directed landward in this case the velocity at the front of the plume is smaller than that at the tail of the plume according to eq 3a accordingly the plume shrinks leading to a decrease in variance and consequently negative dispersion elfeki et al 2007 elfeki et al 2012 on the other hand as the y directional advection velocities at the bottom and top of the plume are always zero in this case and the x directional advection velocities at the bottom and top of the plume that cause transverse dispersion are always the same the y directional variances cannot be negative but must always be positive or zero 4 1 2 effect of storage coefficient on plume behavior similar to the tidal amplitude the concentration distributions at 0 195 and 0 715 days skewed landward as shown in fig 6 a and c respectively while those at 0 455 and 0 975 days were near the original location as shown in fig 6b and d respectively the plume moved fastest with the largest storage coefficient of 0 065 and moved slowest with the smallest storage coefficient of 0 0013 as a larger storage coefficient caused β to increase according to eq 2 in turn increasing the advection velocity according to eq 3b as shown in fig 7 a the plume moved fastest with the largest storage coefficient of 0 065 and moved slowest with the smallest storage coefficient of 0 0013 in fig 7b the remaining mass is reduced fastest with the largest storage coefficient the pattern of decrease of the remaining mass over time takes the form of a staircase with periodic stepwise reductions fig 7c and d show the increases in the x and y directional variances respectively with an increasing storage coefficient a pattern similar to that of tidal amplitude is observed wherein a larger storage coefficient led to greater advection velocity and in turn a larger dispersion coefficient enhancing the spread of the plume as a larger storage coefficient increased β more sharply the advection velocity decreased more rapidly with landward distance from the shoreline at larger storage coefficients according to eq 3a thus as β increases the advection velocities at the landward and seaward edges of the concentration profiles have greater differences for example during the period from the initial time point to the halfway point when the advection velocity was directed landward as β increased the difference between the two velocities became larger and therefore the velocity at the seaward edge became much larger than that at the landward edge accordingly during this period the contaminant plume shrank more as β increased however from the half period to full period points the advection velocity switched to the seaward direction thus the leading edge of the concentration profile in the direction of the advection velocity was closer to the shoreline than was the trailing edge here in contrast to the period discussed above the advection velocity at the leading edge was greater than that at the trailing edge indicating that the plume was extended during this period moreover a larger β value caused greater expansion therefore as shown in fig 7c and d the minimum variances occurred at each half period and the maximum variances occurred at each full period in other words we observed periodicity furthermore as a larger β caused more shrinkage and expansion the variations in variance were greater as shown in fig 7c the oscillation magnitude of the variances increased over time as the plume spread over time and therefore the distance between the seaward and landward edges of the plume increased with time in turn causing an increase in the difference in advection velocity between the two edges a larger β value amplified this effect as the macrodispersion coefficient represents the spreading rate over time sharper oscillating variations in the variances i e larger storage coefficients led to greater oscillation of the macrodispersion coefficient as shown in fig 7e and f finally when the advective velocity was directed landward the plume shrank notably due to the seaward side of the plume moving faster than the landward side leading to decreased variances and consequently a negative x directional dispersion term the phenomenon of negative macrodispersion has been reported in studies of coastal waters elfeki et al 2007 elfeki et al 2012 4 1 3 effect of hydraulic conductivity on plume behavior to investigate the effects of hydraulic conductivity on plume behavior concentration distributions at four time points 0 195 0 455 0 715 and 0 975 days were calculated for three values of hydraulic conductivity 2 5 25 and 100 m day using the proposed 2d analytical solution as shown in fig 8 a d similar to the results described in previous sections the concentration distributions oscillated depending on the flow direction the plume centroids mass remaining in the aquifer variances and macrodispersion were calculated using eqs 30a 30h and were presented in fig 9 a f similar to the tidal amplitude and storage coefficient discussed in previous sections the plume moved fastest at the largest hydraulic conductivity of 100 m day and moved slowest at the smallest hydraulic conductivity of 2 5 m day as shown in fig 9a this trend was due to the larger hydraulic conductivity inducing lower β in eq 2 but greater v 0 x and v x x t in eqs 3b and 3a respectively in addition after 0 455 days the x directional plume centroid with the highest hydraulic conductivity of 100 m day showed an apparent tendency to move landward with time similar to the pattern described in section 4 1 1 the reason for this apparent movement is the same as that explained in section 4 1 1 fig 9b shows the mass remaining in the aquifer which decreased whenever groundwater was discharged into the sea however during periods in which groundwater moved landward the remaining mass did not decrease as no mass exited the aquifer the remaining mass shrank fastest at the highest hydraulic conductivity of 100 m day which was also associated with the highest advection velocity furthermore the mass remaining at a hydraulic conductivity of 100 m day fell periodically as shown in fig 9b fig 9c and d show the increase in variance with increasing hydraulic conductivity which causes the advection velocity and dispersion coefficient to increase thereby enhancing the spread of the plume accordingly as shown in fig 9c and d the largest hydraulic conductivity of 100 m day led to the most spreading the effects of hydraulic conductivity on plume behavior were very similar to those of tidal amplitude finally in accordance with the findings for tidal amplitude the longitudinal and transverse macrodispersion shown in fig 9e and f respectively were greater at higher hydraulic conductivities as greater hydraulic conductivity leads to more sudden changes in plume spread as shown in fig 9e longitudinal macrodispersion has negative values whereas transverse macrodispersion has no negative values as shown in fig 9f similar to the patterns described in section 4 1 2 the negative values of longitudinal macrodispersion appeared to be explained by the difference in advection velocities between the leading and trailing edges 4 2 effects of the distribution and location of the initial contaminant source in this section we focus on the effects of distribution and of the location of the initial contaminant on both contaminant transport and the contaminant amount m t remaining in the aquifer as shown in fig 10 the centers of the initial contaminant sources were located at two locations of l30 and l80 in fig 10 l represents the center of the x domain x 5 m with l30 and l80 indicating source locations centered at distances from the coast corresponding to 30 and 80 of l respectively in short l30 and l80 are x 1 5 m and x 4 m respectively we used l30 and l80 to analyze the effect of the location of the source center on contaminant migration behaviors in a tidally influenced aquifer in addition w is the width of the confined aquifer w 2 m and the initial contaminant source was assumed to follow two distributions w20 and w80 fig 10 w20 and w80 represent the widths of the source distributions from the center of the y axis corresponding to 20 and 80 of w respectively in other words w20 and w80 represent y directional source distributions of 0 8 m y 1 2 m and 0 2 m y 1 8 m respectively in this study we used w20 and w80 to test the effect of the initial source distribution in the y axis on contaminant migration behaviors in the tidally influenced aquifer the other input parameters used for these simulations are shown in table 5 as shown in table 5 four scenarios of locations and distributions were designed we assumed that the lengths of the source distributions were fixed at 1 m in all scenarios in scenario 1 the contaminant is initially located and distributed at l30 and w20 as shown in fig 10 and the distributions of the contaminant at 0 195 days and 0 455 days are shown in figs s2a and b in supplementary section f respectively in addition the contaminant distributions under scenarios 2 3 and 4 are shown in figs s3a b fig s4a b and fig s5a b in supplementary section f respectively based on the locations and distributions of the initial contaminant sources the mass remaining in the tidally influenced aquifer is shown in fig s6 in supplementary section f the remaining mass m t was calculated analytically using eq 30c and eq 29a or 29b depending on the direction of groundwater flow as shown in fig s6 the remaining masses under scenarios 1 and 2 at l30 decreased faster than those under scenarios 3 and 4 at l80 nearer to the sea the remaining mass was also reduced more rapidly however the changes in the remaining masses over time for scenarios 1 l30 and w20 and 2 l30 and w80 were almost equal in addition the changes in the remaining masses for scenarios 3 l80 and w20 and 4 l80 and w80 were almost equal therefore in this case the more sensitive factor determining the change in the mass remaining in the aquifer with time is the initial distance from the sea rather than the initial plume width along the y axis 4 3 comparison of two variable boundary condition types at the seaward boundary this section compares the results obtained using the dirichlet neumann variable boundary conditions at the seaward boundary with those obtained using the cauchy neumann variable boundary conditions to determine which setting best matches the real situation four cases were designed to compare the results for four péclet numbers defined in eq 12a 492 66 13 and 3 table 6 similar to the initial contaminant distribution in a prism shape shown in fig 1 above an initial contaminant distribution with a prism shape of 0 1 m x 7 9 m was applied across the whole length of the simulation domain in the y axis with the vertex of the triangle positioned 4 0 m from the seaward boundary and a concentration at the vertex of the prism shape of 1 ppm the seaward boundary was located at the left boundary and the landward boundary was at the right boundary the neumann boundary conditions were applied to the landward boundary and either the dirichlet neumann or the cauchy neumann variable boundary conditions were applied at the seaward boundary under dirichlet neumann variable boundary conditions the dirichlet concentration was set to zero while under the cauchy neumann conditions the total flux was set to zero the concentration distribution over time and the mass remaining in the aquifer over time were calculated using the proposed equations for the dirichlet neumann and cauchy neumann variable boundary conditions fig 11 shows that the mass remaining in the aquifer decreased over time under both the cauchy neumann and the dirichlet neumann variable boundary conditions however in the case of the former the mass remaining in the aquifer did not decrease during the period of seawater influx whereas with the latter the mass remaining in the aquifer decreased during that period this difference is because the dirichlet neumann variable boundary conditions have non zero dispersive flux in the seaward direction whereas the cauchy neumann variable boundary conditions have a total influx of zero as the péclet number decreased greater dispersive flux occurred under the dirichlet neumann variable boundary conditions accordingly as the péclet number decreased the difference in remaining mass between the dirichlet neumann and cauchy neumann variable boundary conditions grew as shown in fig 11a d however the reduction in the remaining mass during the seawater influx period is not justified based on the real situation accordingly the dirichlet neumann variable boundary conditions are inappropriate for describing the total mass remaining over time in a tidally influenced aquifer furthermore due to these differing effects of the cauchy neumann and dirichlet neumann variable boundary conditions on mass flux at the seaward boundary the concentration distributions under these two variable boundary condition settings differed as shown in fig 12 the difference between the concentration distributions was greatest near the seaward boundary in summary the cauchy neumann variable boundary conditions reflect the real situation better than do the dirichlet neumann variable boundary conditions 5 conclusions a two dimensional semi analytical solution for land derived solute transport was developed under variable boundary conditions at the seaward boundary with tidal fluctuations the proposed semi analytical solutions were obtained using the gitt technique and matrix exponential solution method here the variable boundary conditions switched between the cauchy and neumann types depending on flow direction at the seaward boundary in addition an arbitrary initial distribution can be considered with this method the proposed 2d semi analytical solution was verified through comparison with the 1d semi analytical solution reported by suk 2017 and a 2d numerical solution developed using the finite element method using the proposed analytical solution with variable boundary conditions we calculated the mass remaining in the aquifer over time as well as statistical moments representing the characteristics of contaminant transport behavior and changes in the concentration distribution over time we compared the results using the dirichlet neumann variable boundary conditions at the seaward boundary with those using the cauchy neumann variable boundary conditions to determine which conditions best aligned with the real situation we found that the cauchy neumann variable boundary conditions reflected observations than better did the dirichlet neumann variable boundary conditions when the péclet number decreased the calculated differences in the concentration distribution and the mass remaining in the aquifer were larger under both types of variable boundary conditions in other words the dirichlet neumann variable boundary conditions resulted in more errors as the péclet number decreased sensitivity analysis was performed to examine factors such as hydraulic properties tidal amplitude and the location and distribution of the initial contaminant that affect both the characteristics of land derived pollutant transport in coastal aquifers and the mass remaining in the aquifer over time the characteristics of plume migration were described by the x and y directional centroid displacements x and y directional variances longitudinal and transverse macrodispersion coefficients and mass remaining in the aquifer over time all of which can be determined analytically using the proposed solutions as the tidal amplitude increased the plume centroid variance and macrodispersion values increased and the remaining mass decreased as a larger amplitude led to greater advection velocity and in turn a larger dispersion coefficient causing more plume spreading similarly with increased hydraulic conductivity increases in the plume centroid variances and macrodispersion terms were observed the reason for these increases may be that higher hydraulic conductivity led to greater advection velocity and in turn a larger dispersion coefficient thereby increasing plume spread similar to the tidal amplitude and hydraulic conductivity a larger storage coefficient caused larger increases in the plume centroid variance and macrodispersion values notably more negative longitudinal macrodispersion and stronger periodicity were observed in the oscillations of tidally affected aquifers when the hydraulic conductivity storage coefficient and tidal amplitude increased finally this study builds on the methods of suk 2017 to include variable boundary conditions at the seaward boundary and extends the findings of that study by adding a two dimensional analytical solution to elucidate the multi dimensional movements of land derived solutes in a tidally influenced aquifer the analytical solution proposed here will provide a useful tool for exploring the mechanism of plume migration which drives the behavior of contaminants such as radionuclides and toxic chemicals released into coastal aquifers of tidally affected systems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was performed with the support of the korea institute of geosciences and mineral resources kigam we appreciate support by the project titled research on rock properties in deep environment for hlw geological disposal gp2020 002 21 3115 funded by the ministry of science and ict south korea in addition this work was partially supported by the institute for korea spent nuclear fuel iksnf and korea foundation of nuclear safety kofons grant funded by the korea government nuclear safety and security commission nssc no 2109092 appendix a constructing and solving ode when seawater enters the aquifer for the case when seawater enters the aquifer to construct and solve ode multiplying both sides of eq 13 by ψ i x 1 x ψ j y y and then integrating with respect to both y and x from 0 to 1 0 1 0 1 ψ i x 1 x ψ j y y c t d y d x 0 1 0 1 ψ i x 1 x ψ j y y x v x x t c d y d x 0 1 0 1 ψ i x 1 x ψ j y y x e xx x t c x d y d x 0 1 0 1 ψ i x 1 x ψ j y y e yy x t 2 c y 2 d y d x 0 1 0 1 ψ i x 1 x ψ j y y k c d y d x 0 i 1 2 m x j 0 1 m y a1 using green s theorem and the boundary conditions of eqs 14 16 and 17a 0 1 0 1 ψ i x 1 x ψ j y y c t d y d x 0 1 ψ j y y ψ i x 1 x v x x t c x 1 d y 0 1 0 1 d ψ i x 1 x dx ψ j y y v x x t c d y d x 0 1 0 1 d ψ i x 1 x dx ψ j y y e xx x t c x d y d x 0 1 0 1 ψ i x 1 x d ψ j y y dy e yy x t c y d y d x 0 1 0 1 ψ i x 1 x ψ j y y k c d y d x 0 i 1 2 m x j 0 1 m y a2 replacing c x y t in eq a2 with the inverse transform of gitt given by eq 22b m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x d x 0 1 ψ j y y ψ n y y d y d s mn 1 t dt m 1 m x n 0 m y ψ i x 1 1 ψ m x 1 1 v x 1 t 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 d ψ i x 1 x dx ψ m x 1 x v x x t d x 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 d ψ i x 1 x dx d ψ m x 1 x dx e xx x t d x 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y s mn 1 t k m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x d x 0 1 ψ j y y ψ n y y d y s mn 1 t 0 i 1 2 m x j 0 1 m y a3 based on the orthogonality condition this expression can be rearranged and made compact as m 1 m x n 0 m y δ im δ jn d s mn 1 t dt m 1 m x n 0 m y a 1 imjn t a 2 imjn t a 3 imjn t a 4 imjn t s mn 1 t 0 i 1 2 m x j 0 1 m y a4 where δ im and δ jn are the kronecker deltas and a 1 imjn t ψ i x 1 1 ψ m x 1 1 v x 1 t δ jn k δ im δ jn i m 1 2 m x j n 0 1 m y a5a a 2 imjn t 0 1 d ψ i x 1 x dx ψ m x 1 x v x x t d x δ jn i m 1 2 m x j n 0 1 m y a5b a 3 imjn t 0 1 d ψ i x 1 x dx d ψ m x 1 x dx e xx x t d x δ jn i m 1 2 m x j n 0 1 m y a5c a 4 imjn t 0 1 ψ i x 1 x ψ m x 1 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y i m 1 2 m x j n 0 1 m y a5d a semi analytical solution to eq a4 can be obtained using linear system theory suk 2016 2017 liu et al 2000 rugh 1996 as follows s 1 t exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ s 1 0 a6a where s mn 1 0 0 1 0 1 c x y 0 ψ m x 1 x ψ n y y d y d x m 1 2 m x n 0 1 2 m y a6b in eq a6a the expression exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ on the right side can be calculated via tedious complicated mathematical manipulations as shown in eq a7 details of the derivation of the matrix integral within the matrix exponential can be found in supplementary section b exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ exp b 1 t b 2 t b 3 t k 1 n p 0 b 4 k t k 1 n q t b 5 k t k 1 n p 0 1 1 1 k b 6 k t k 1 n q t 1 1 n max t k b 7 k t a7 where b 1 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x ψ i x 1 1 ψ m x 1 1 exp β cos β δ jn 1 ω sin ω t π 4 sin π 4 v 0 x ψ i x 1 1 ψ m x 1 1 exp β sin β δ jn t k δ im δ jn a8a b 2 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x λ i x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im 1 f 21 im 0 f 22 im 1 f 22 im 0 f 23 im 1 f 23 im 0 f 24 im 1 f 24 im 0 1 ω sin ω t π 4 sin π 4 v 0 x λ i x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im 1 f 11 im 0 f 12 im 1 f 12 im 0 f 13 im 1 f 13 im 0 f 14 im 1 f 14 im 0 a8b b 3 imjn t 1 ω n max t n q t e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im 1 f 31 im 0 f 32 im 1 f 32 im 0 1 ω n max t n q t e 0 y y 2 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 31 im 1 f 31 im 0 f 32 im 1 f 32 im 0 a8c b 4 imjn k t 1 ω e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im 1 f 31 im x p 0 k f 32 im 1 f 32 im x p 0 k 1 ω e 0 y y 2 n i x 1 1 2 n 1 m x 1 1 2 λ j y 2 n j y δ jn f 31 im 1 f 31 im x p 0 k f 32 im 1 f 32 im x p 0 k a8d b 5 imjn k t 1 ω e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im x q t k f 31 im 0 f 32 im x q t k f 32 im 0 1 ω e 0 y y 2 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 31 im x q t k f 31 im 0 f 32 im x q t k f 32 im 0 a8e b 6 imjn k t 1 ω cos π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im x p 0 k f 11 im x p 0 k 1 f 12 im x p 0 k f 12 im x p 0 k 1 f 13 im x p 0 k f 13 im x p 0 k 1 f 14 im x p 0 k f 14 im x p 0 k 1 1 ω sin π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im x p 0 k f 21 im x p 0 k 1 f 22 im x p 0 k f 22 im x p 0 k 1 f 23 im x p 0 k f 23 im x p 0 k 1 f 24 im x p 0 k f 24 im x p 0 k 1 1 ω cos π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 11 im x p 0 k f 11 im x p 0 k 1 f 12 im x p 0 k f 12 im x p 0 k 1 f 13 im x p 0 k f 13 im x p 0 k 1 f 14 im x p 0 k f 14 im x p 0 k 1 1 ω sin π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 21 im x p 0 k f 21 im x p 0 k 1 f 22 im x p 0 k f 22 im x p 0 k 1 f 23 im x p 0 k f 23 im x p 0 k 1 f 24 im x p 0 k f 24 im x p 0 k 1 a8f b 7 imjn k t 1 ω cos ω t π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im x q t k f 11 im x q t k 1 f 12 im x q t k f 12 im x q t k 1 f 13 im x q t k f 13 im x q t k 1 f 14 im x q t k f 14 im x q t k 1 1 ω sin ω t π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im x q t k f 21 im x q t k 1 f 22 im x q t k f 22 im x q t k 1 f 23 im x q t k f 23 im x q t k 1 f 24 im x q t k f 24 im x q t k 1 1 ω cos ω t π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 11 im x q t k f 11 im x q t k 1 f 12 im x q t k f 12 im x q t k 1 f 13 im x q t k f 13 im x q t k 1 f 14 im x q t k f 14 im x q t k 1 1 ω sin ω t π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 21 im x q t k f 21 im x q t k 1 f 22 im x q t k f 22 im x q t k 1 f 23 im x q t k f 23 im x q t k 1 f 24 im x q t k f 24 im x q t k 1 a8g where n p 0 int 1 4 int β π 1 4 a8h n q t int ω π t 1 4 int ω π t β π 1 4 a8i x p 0 k π β 3 4 k k 1 2 n p 0 a8j x q t k ω β t π β n max t 3 4 k k 1 2 n q t a8k n max t int ω π t 1 4 a8l f 11 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8m f 12 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8n f 13 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8o f 14 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8p f 21 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8q f 22 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8r f 23 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8s f 24 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8t f 31 im x exp β x β cos λ i x 1 λ m x 1 x 1 λ i x 1 λ m x 1 sin λ i x 1 λ m x 1 x 1 β 2 λ i x 1 λ m x 1 2 a8u f 32 im x exp β x β cos λ i x 1 λ m x 1 x 1 λ i x 1 λ m x 1 sin λ i x 1 λ m x 1 x 1 β 2 λ i x 1 λ m x 1 2 a8v after the set of coupled first order differential equations for s 1 t is solved using eq a6a the inverse gitt formula shown in eq 22b can be calculated to obtain c x y t appendix b constructing and solving ode when groundwater discharges into the sea for the case when groundwater discharges into the sea multiplying both sides of eq 13 by ψ i x 2 x ψ j y y and then integrating with respect to both y and x from 0 to 1 using green s theorem and the boundary conditions of eqs 14 16 and 17b replacing c x y t with the inverse transform of gitt given by eq 24b using the orthogonality condition and finally constructing a compact matrix form m 0 m x n 0 m y δ im δ jn d s mn 2 t dt m 0 m x n 0 m y c 1 imjn t c 2 imjn t c 3 imjn t c 4 imjn t s mn 2 t 0 i 0 1 m x j 0 1 m y b1 where c 1 imjn t ψ i x 2 1 ψ m x 2 1 v x 1 t δ jn ψ i x 2 0 ψ m x 2 0 v x 0 t δ jn k δ im δ jn i m 0 1 2 m x j n 0 1 m y b2a c 2 imjn t 0 1 d ψ i x 2 x dx ψ m x 2 x v x x t d x δ jn i m 0 1 2 m x j n 0 1 m y b2b c 3 imjn t 0 1 d ψ i x 2 x dx d ψ m x 2 x dx e xx x t d x δ jn i m 0 1 2 m x j n 0 1 m y b2c c 4 imjn t 0 1 ψ i x 2 x ψ m x 2 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y i m 0 1 2 m x j n 0 1 m y b2d as described in appendix b for the case when seawater enters the aquifer a semi analytical solution of eq b1 can be obtained via linear system theory as follows s 2 t exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ s 2 0 b3a where s mn 2 0 0 1 0 1 c x y 0 ψ m x 2 x ψ n y y d y d x m 0 1 2 m x n 0 1 2 m y b3b in eq b3a exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ on the right side can be calculated using eq b4 following procedures similar to those described in supplementary section c which involve the double integral of time and space including 1 n x t exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ exp d 1 t d 2 t d 3 t k 1 n p 0 d 4 k t k 1 n q t d 5 k t k 1 n p 0 1 1 1 k d 6 k t k 1 n q t 1 1 n max t k d 7 k t b4 where d 1 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x ψ i x 2 1 ψ m x 2 1 exp β cos β δ jn v 0 x ψ i x 2 0 ψ m x 2 0 δ jn 1 ω sin ω t π 4 sin π 4 v 0 x ψ i x 2 1 ψ m x 2 1 exp β sin β δ jn t k δ im δ jn b5a d 2 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x λ i x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im 1 g 21 im 0 g 22 im 1 g 22 im 0 g 23 im 1 g 23 im 0 g 24 im 1 g 24 im 0 1 ω sin ω t π 4 sin π 4 v 0 x λ i x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im 1 g 11 im 0 g 12 im 1 g 12 im 0 g 13 im 1 g 13 im 0 g 14 im 1 g 14 im 0 b5b d 3 imjn t 1 ω n max t n q t e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im 1 g 31 im 0 g 32 im 1 g 32 im 0 1 ω n max t n q t e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im 1 g 31 im 0 g 32 im 1 g 32 im 0 b5c d 4 imjn k t 1 ω e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im 1 g 31 im x p 0 k g 32 im 1 g 32 im x p 0 k 1 ω e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im 1 g 31 im x p 0 k g 32 im 1 g 32 im x p 0 k b5d d 5 imjn k t 1 ω e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im x q t k g 31 im 0 g 32 im x q t k g 32 im 0 1 ω e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im x q t k g 31 im 0 g 32 im x q t k g 32 im 0 b5e d 6 imjn k t 1 ω cos π 4 e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im x p 0 k g 11 im x p 0 k 1 g 12 im x p 0 k g 12 im x p 0 k 1 g 13 im x p 0 k g 13 im x p 0 k 1 g 14 im x p 0 k g 14 im x p 0 k 1 1 ω sin π 4 e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im x p 0 k g 21 im x p 0 k 1 g 22 im x p 0 k g 22 im x p 0 k 1 g 23 im x p 0 k g 23 im x p 0 k 1 g 24 im x p 0 k g 24 im x p 0 k 1 1 ω cos π 4 e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 11 im x p 0 k g 11 im x p 0 k 1 g 12 im x p 0 k g 12 im x p 0 k 1 g 13 im x p 0 k g 13 im x p 0 k 1 g 14 im x p 0 k g 14 im x p 0 k 1 1 ω sin π 4 e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 21 im x p 0 k g 21 im x p 0 k 1 g 22 im x p 0 k g 22 im x p 0 k 1 g 23 im x p 0 k g 23 im x p 0 k 1 g 24 im x p 0 k g 24 im x p 0 k 1 b5f d 7 imjn k t 1 ω cos ω t 1 4 π e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im x q t k g 11 im x q t k 1 g 12 im x q t k g 12 im x q t k 1 g 13 im x q t k g 13 im x q t k 1 g 14 im x q t k g 14 im x q t k 1 1 ω sin ω t 1 4 π e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im x q t k g 21 im x q t k 1 g 22 im x q t k g 22 im x q t k 1 g 23 im x q t k g 23 im x q t k 1 g 24 im x q t k g 24 im x q t k 1 1 ω cos ω t 1 4 π e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 11 im x q t k g 11 im x q t k 1 g 12 im x q t k g 12 im x q t k 1 g 13 im x q t k g 13 im x q t k 1 g 14 im x q t k g 14 im x q t k 1 1 ω sin ω t 1 4 π e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 21 im x q t k g 21 im x q t k 1 g 22 im x q t k g 22 im x q t t k 1 g 23 im x q t k g 23 im x q t k 1 g 24 im x q t k g 24 im x q t k 1 b5g where g 11 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5h g 12 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5i g 13 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5j g 14 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5k g 21 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5l g 22 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5m g 23 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5n g 24 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5o g 31 im x exp β x β cos λ i x 2 λ m x 2 x λ i x 2 λ m x 2 sin λ i x 2 λ m x 2 x β 2 λ i x 2 λ m x 2 2 b5p g 32 im x exp β x β cos λ i x 2 λ m x 2 x λ i x 2 λ m x 2 sin λ i x 2 λ m x 2 x β 2 λ i x 2 λ m x 2 2 b5q as described in appendix a for when seawater enters the aquifer after the set of coupled first order differential equations for s 2 t is solved using eq b3a the inverse gitt formula presented in eq 24b can be used to obtain c x y t appendix c supplementary data supplementary data associated with this article can be found in the attached files supplementary a docx supplementary b doc supplementary c doc supplementary d docx supplementary e docx and supplementary f docx appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127441 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 supplementary data 5 supplementary data 6 
3662,transport of contaminants in coastal aquifers subject to tidal fluctuations is an important topic and a growing problem due to increasing populations and development in coastal areas many studies have used variable boundary conditions to simulate transport behavior at the interface between seawater and groundwater however to the best of our knowledge no analytical solution accounting for variable concentration boundary conditions exists for plume migration of land derived contaminants passing through the inland zone of aquifers under tidally induced periodic flow here a two dimensional 2d semi analytical solution for land derived solute transport was developed with variable boundary conditions at the seaward boundary under tidal fluctuations the proposed 2d semi analytical solution was verified through comparison with an existing one dimensional semi analytical solution and a 2d numerical solution developed using the finite element method sensitivity analysis was performed to explore factors including hydraulic properties tidal amplitude and the location and distribution of initial contaminants which affect the characteristics of land derived pollutant transport in coastal aquifers through comparison of the calculated masses remaining over time in the aquifer using the proposed semi analytical solution under two types of variable boundary conditions dirichlet neumann and cauchy neumann variable boundary conditions we found that the cauchy neumann variable boundary conditions reflected reality better than did the dirichlet neumann variable boundary conditions the proposed analytical solution will be useful for obtaining insights into the mechanisms that drive the plume behavior of contaminants such as radionuclides or toxic chemicals released into coastal aquifers of tidally affected systems keywords cauchy neumann variable boundary conditions land derived solute transport proposed 2d semi analytical solution tidally induced variable boundary conditions 1 introduction transport of contaminants in coastal aquifers subject to tidal fluctuations is an important topic in addressing a growing problem caused by increasing population and development in coastal areas plume migration of land derived contaminants passing through the inland zone and discharging into the sea or estuaries can lead to significant degradation of the receiving coastal ecosystems however relatively little research has been done to investigate the fate of land derived contaminants subject to tidal fluctuations relative to the submarine groundwater discharge yim and mohsen 1992 developed a 1d numerical model to simulate mass transport from a contaminant plume to a tidal estuary in their study the oscillating velocity field induced by tides was determined by differentiating the 1d hydraulic head fluctuation equation which represents the response of the groundwater level to sinusoidal tidal fluctuations in a homogeneous and isotropic confined aquifer at the surface groundwater interface variable boundary conditions were imposed to account for the effects of tidal fluctuations on land derived contaminant transport when surface water enters the aquifer at this interface the dirichlet boundary condition of zero contaminant concentration is used to represent infiltration of uncontaminated surface water into the aquifer along with an assumption of zero concentration gradient otherwise when groundwater discharges into a tidal stream the concentration gradient is set equal to zero at the boundary between the surface and the groundwater at the landward boundary a concentration gradient equal to zero is imposed assuming that this boundary is sufficiently far from the land derived contaminant plume boufadel 2000 conducted two laboratory experiments to investigate the effects of tides and buoyancy on beach hydraulics and performed simulations using the marine unsaturated marun model in this simulation of transport water influx to the beach is assigned dirichlet boundary conditions with the seawater concentration at the beach surface while water leaving the beach is assigned the neumann boundary conditions with zero dispersive flux such boundary conditions are referred to as variable boundary conditions which switch between dirichlet and neumann boundary conditions depending on the flow direction at the boundary variable boundary conditions have been widely used in numerous studies galeati et al 1992 huyakorn et al 1987 sherif et al 1988 yim and mohsen 1992 geng and boufadel 2015 park and aral 2008 mulligan et al 2011 kolditz et al 2016 smith 2004 walther et al 2017 in particular park and aral 2008 found that submarine groundwater discharge may vary significantly depending on the type of boundary conditions used indicating that use of the appropriate variable boundary conditions at the seaward boundary is essential to prevent artificial accumulation of contaminant mass at the boundary however to our knowledge no analytical solutions that account for variable boundary conditions exist for investigating plume migration of land derived contaminants through the inland zone of aquifers adjacent to coastal areas under oscillating tidal flow conditions and discharge into seas or estuaries this study focused on contaminants of terrestrial origin that are either absent or extremely scarce in seawater such as an oil spill due to the failure of an inshore underground storage tank or radioactive contaminant leakage due to a nuclear power plant accident while most previous work has focused almost exclusively on describing and predicting saltwater distribution in aquifers here the tidally induced oscillating flow is periodic flow with exponentially decreasing amplitude of groundwater head changes with distance inland from the coast although suk 2017 derived a one dimensional analytical solution for land derived solute transport subject to tidal fluctuations in a homogeneous confined coastal aquifer that solution was limited to the neumann boundary condition with zero dispersive flux at the seaward boundary the neumann boundary conditions are applicable only when flow is directed seaward whereas for flow directed toward the aquifer from the sea and plumes that have already reached the seaward boundary the neumann boundary conditions are physically inappropriate this difference arises because dispersive flux never reaches zero under the assumption of strong flushing with seawater as strong dilution due to mixing with seawater of zero concentration occurs at the boundary and therefore the concentration gradient at the boundary is large in such cases the cauchy boundary conditions with zero mass flux are more physically appropriate than the neumann boundary conditions as in the real physical situation no mass is added to the aquifer through the seaward boundary notably in this study a semi analytical solution was developed under the assumption that contaminants discharging into the sea do not affect the concentration in seawater this assumption is logical as the sea is substantially larger than the pollutant mass flux discharging into it on the other hand even under weak or moderate flushing conditions the neumann boundary conditions violate the mass balance principle and are therefore inappropriate because advective flux at the boundary i e the boundary concentration multiplied by advective velocity will never be zero as noted above in reality no mass is added to the aquifer through the seaward boundary therefore if the neumann boundary conditions were applied quantification of the mass remaining within the aquifer would be erroneous in other words spurious mass influx into the aquifer and accumulation will occur at the seaward boundary the primary objective of this study was to obtain a two dimensional analytical solution for land derived solute transport subject to tidal fluctuations while accounting for variable boundary conditions at the seaward boundary in a homogeneous coastal confined aquifer here we did not consider the density difference between seawater and groundwater or forced convection of groundwater due to hydraulic head differences between groundwater and seawater because we did not account for the density difference between seawater and groundwater we did not consider the interface between saltwater and freshwater or density driven convection cells caused by seawater intrusion and hydrodynamic dispersion of salt within the coastal salt wedge this solution provides a useful mathematical tool for validating numerical models and elucidating the physical mechanism of plume discharge into seas or estuaries we also performed sensitivity analysis to examine the factors affecting land derived pollutant transport in coastal aquifers furthermore this study builds on the work of suk 2017 to include variable boundary conditions at the seaward boundary and extends that study to a two dimensional analytical solution to clarify the multi dimensional behaviors of land derived solute transport in complex hydrodynamics or locations as well as the two dimensional distribution of the initial contaminant load 2 problem formulation 2 1 governing equation and boundary conditions jacob 1950 analytically solved the response of groundwater head to a sinusoidal boundary condition in a homogeneous and isotropic semi infinite confined aquifer as follows 1 h x t h 0 exp β x sin 2 π t t 0 β x where h x t represents the rise and fall of the piezometric surface at a distance x inland of the shoreline with respect to the mean surface water level at time t h0 is the amplitude of the tide and t0 is the period of the tidal cycle the term β represents the physical properties of the aquifer and is defined as 2 β π s t 0 t xx π s t 0 k xx b where s is the storage coefficient t xx is the x directional transmissivity k xx is the x directional hydraulic conductivity and b is the thickness of the confined aquifer this solution essentially forms the shape of a landward traveling wave with an exponentially narrowing envelope for the purpose of deriving the semi analytical solution of solute transport with advection and dispersion subject to tidal fluctuations in a confined aquifer the tidally induced x directional velocity field v x x t can be obtained by differentiating eq 1 with respect to x as follows 3a v x x t v 0 x exp β x sin ω t β x π 4 where 3b v 0 x 2 k xx n e h 0 β 3c ω 2 π t 0 and where ne is the effective porosity of the aquifer here it is assumed that groundwater flow is directed only along the x axis and has no y directional velocity component accordingly the x and y directional dispersion coefficients d xx x t and d yy x t respectively can be obtained as the product of dispersivity and velocity as follows 4a d xx x t α l v x x t 4b d yy x t α t v x x t where α l and α t are the constant local longitudinal dispersivity and transverse dispersivity respectively furthermore the dispersion coefficient can be expressed using the groundwater velocity of eq 3a as follows 5a d xx x t d 0 x x exp β x sin ω t β x π 4 d 0 x x e x p β x 1 n x t s i n ω t β x π 4 5b d yy x t d 0 y y exp β x sin ω t β x π 4 d 0 y y e x p β x 1 n x t s i n ω t β x π 4 where 5c d 0 x x α l v 0 x 5d d 0 y y α t v 0 x 5e n x t int ω t π β x π 1 4 0 t t f a n d 0 x l x where int rounds a number down to the nearest integer l x is the x axis length and t f is the final simulation time notably the dispersion coefficient is always positive regardless of velocity therefore to make the dispersion coefficient positive n is calculated in eq 5e depending on both time and the x axis coordinate a detailed explanation of the derivation of n x t can be found in suk 2017 with the velocities and dispersion coefficients described above the concentration distribution of the contaminant plume can be obtained using the following two dimensional advection and dispersion equation elfeki et al 2007 bear 1979 6 r c t x v x x t c x d xx x t c x d yy x t 2 c y 2 k c where r is the retardation factor k is the first order decay rate constant and c is the concentration here the landward side is assumed to follow the zero dispersive flux boundary condition while the top and bottom of the domain use zero dispersive flux boundary conditions as shown in fig 1 the mathematical expression of the boundary conditions at the landward side are expressed as eq 7 and those of the bottom and top are eqs 8 and 9 respectively 7 d xx c x x l x 0 0 y l y a n d 0 t t f 8 d yy c y y 0 0 0 x l x a n d 0 t t f 9 d yy c y y l y 0 0 x l x a n d 0 t t f where l y is the y axis length and t f is the final simulation time in addition the seaward boundary conditions imposed are the variable boundary conditions described as follows 10a d xx c x v x c x 0 0 0 y l y a n d 0 t t f when s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 10b d xx c x x 0 0 0 y l y a n d 0 t t f when g r o u n d w a t e r d i s c h a r g e s i n t o t h e s e a v x 0 t 0 eqs 10a and 10b represent the cauchy and neumann boundary conditions respectively in contrast to previous studies galeati et al 1992 huyakorn et al 1987 sherif et al 1988 yim and mohsen 1992 geng and boufadel 2015 park and aral 2008 in which the variable boundary conditions switched between dirichlet and neumann depending on the flow direction at the boundary in this study the variable boundary conditions switch between cauchy and neumann boundary conditions in previous studies the neumann boundary conditions were prescribed with zero dispersive flux wherein the concentration at an infinitesimal distance inward from the seaward boundary is very close to the concentration in the seawater on the other hand in this study the cauchy boundary conditions are prescribed with zero total mass flux allowing no contaminants to enter the aquifer because seawater adjacent to the boundary is strongly mixed during the high tide cycle and seawater is nearly free of the contaminant in fact if the land derived contaminant concentration in seawater is assumed to always be zero and the concentration gradient adjacent to the seaward boundary is assumed to be negligible the dirichlet boundary conditions used in previous studies would mimic the cauchy boundary conditions note that jacob 1950 solved the groundwater head fluctuation for a semi infinite domain under the assumption that the tide has no effect far inland as x approaches infinity whereas in this study solute transport is solved for a finite domain with the neumann boundary condition to remain physically consistent in the boundary conditions between fluid flow and solute transport problems we assume that the finite region length l x is large enough to negate the tidal effect at the land boundary so that the tidal induced velocity is also negligible at the landward boundary therefore the neumann boundary of the landward boundary used here is equivalent to a cauchy boundary condition with zero mass flux and ensures that pollutants within the domain do not physically move through the landward boundary through dispersive or advective fluxes during the simulation period the initial conditions are assumed to have an arbitrary distribution as follows 11 c x y t 0 c 0 f x y 0 x l x a n d 0 y l y where c 0 is the maximum initial concentration and f x y is the initial concentration normalized by c 0 by defining the following dimensionless quantities 12a x x l x y y l y t t t f c c c 0 a l α l l x 1 p e a t l x l y 2 α t v 0 x 1 r t f l x v 0 x k 1 r k t f e 0 x x a l v 0 x e 0 y y a t v 0 x β β l x ω ω t f 12b v x x t v 0 x exp β x sin ω t β x π 4 12c e xx x t e 0 x x 1 n x t exp β x sin ω t β x π 4 12d e yy x t e 0 y y 1 n x t exp β x sin ω t β x π 4 12e n x t int ω π t β π x 1 4 where p e 1 a l l x α l is the péclet number eqs 6 11 can be rewritten with eq 12a 12d respectively as follows 13 c t x v x x t c x e xx x t c x e yy x t 2 c y 2 k c 14 e xx c x x 1 0 0 y 1 a n d 0 t 1 15 e yy c y y 0 0 0 x 1 a n d 0 t 1 16 e yy c y y 1 0 0 x 1 a n d 0 t 1 17a e xx c x v x c x 0 0 0 y 1 a n d 0 t 1 when s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 17b e xx c x x 0 0 0 y 1 a n d 0 t 1 when g r o u n d w a t e r d i s c h a r g e s i n t o t h e s e a v x 0 t 0 18 c x y t 0 f x y 2 2 analytical solution of the mathematical model to solve eq 13 using the general integral transformation technique gitt x and y directional eigenfunctions x and y directional eigenvalues and x and y directional norms are defined based on the imposed boundary conditions for the detailed derivations of these eigenfunctions eigenvalues and norms please refer to supplementary section a when seawater enters the aquifer v x 0 t 0 in the x direction that is when the cauchy boundary conditions with zero mass flux are imposed at the seaward boundary the x directional eigenfunctions are defined by eq 19a specifically the x directional eigenvalues λ i x 1 can be obtained through solution of nonlinear equation 19b then x directional norms are calculated with eq 19c using those eigenvalues 19a φ i x 1 x cos λ i x 1 1 x i 1 2 m x 19b cos λ i x 1 a l λ i x 1 sin λ i x 1 0 i 1 2 m x 19c n i x 1 1 2 1 4 λ i x 1 sin 2 λ i x 1 i 1 2 m x where m x is a value sufficiently large to produce the desired level of accuracy in the x axis on the other hand when groundwater is discharged into the sea in the x direction v x 0 t 0 i e under the neumann boundary conditions with zero dispersive flux at the seaward boundary the x directional eigenfunctions x directional eigenvalues and x directional norms are obtained using in eqs 20a 20b and 20c respectively 20a φ i x 2 x 1 i 0 cos λ i x 2 x i 1 2 m x 20b λ i x 2 0 i 0 i π i 1 2 m x 20c n i x 2 1 i 0 1 2 i 1 2 m x in addition y directional eigenfunctions y directional eigenvalues and y directional norms can be determined using eqs 21a 21b and 21c respectively 21a φ j y y 1 j 0 cos λ j y y j 1 2 m y 21b λ j y 0 j 0 j π j 1 2 m y 21c n j y 1 j 0 1 2 j 1 2 m y where m y is a value sufficiently large to produce the desired level of accuracy along the y axis following the procedures of the gitt the generalized integral transform pairs can be defined as follows when seawater enters the aquifer along the x axis v x 0 t 0 22a s ij 1 t 0 1 0 1 ψ i x 1 x ψ j y y c x y t d y d x i 1 2 m x j 0 1 m y 22b c x y t i 1 m x j 0 m y ψ i x 1 x ψ j y y s ij 1 t where s ij 1 t represents variables transformed in the gitt when seawater enters the aquifer ψ i x 1 x is the normalized x directional eigenfunction when seawater enters the aquifer along the x axis and ψ j y y is the normalized y directional eigenfunction here the normalized x directional eigenfunction and normalized y directional eigenfunction are described by eqs 23a and 23b respectively 23a ψ i x 1 x φ i x 1 x n i x 1 1 2 i 1 2 m x 23b ψ j y y φ j y y n j y 1 2 j 0 1 m y otherwise when groundwater discharges into the sea along the x axis v x 0 t 0 the generalized integral transform pair can be defined as follows 24a s ij 2 t 0 1 0 1 ψ i x 2 x ψ j y y c x y t d y d x i 0 1 m x j 0 1 m y 24b c x y t i 0 m x j 0 m y ψ i x 2 x ψ j y y s ij 2 t where s ij 2 t represents variables transformed in the gitt when groundwater discharges into the sea and ψ i x 2 x is the normalized x directional eigenfunction when groundwater discharges into the sea similarly the normalized x directional eigenfunctions are expressed as eq 25 25 ψ i x 2 x φ i x 2 x n i x 2 1 2 i 0 1 m x in the forward transform multiplying both sides of eq 13 by ψ i x 1 x ψ j y y and then integrating with respect to both y and x from 0 to 1 using green s theorem and the boundary conditions of eqs 14 16 and 17a and then finally replacing c x y t with the inverse transform of gitt given by eq 22b the truncated linear system of coupled first order ordinary differential equations ode can be constructed to solve for the transformed variable s 1 t in eq 22a the details of constructing the ode system and solving the transformed variables s 1 t are presented in appendix a after the set of coupled first order differential equations for s 1 t is solved the inverse gitt formula shown in eq 22b can be calculated to obtain c x y t the abovementioned derviation of c x y t corresponds to the case when seawater enters the aquifer in this case the analytical solution is derived with eigenfunctions φ i x 1 x eigenvalues λ i x 1 and norms n i x 1 obtained from the auxiliary equation that is compatible with the cauchy boundary condition as expressed in eq 17a similarly when groundwater discharges into the sea an analytical solution can be derived using eigenfunctions φ i x 2 x eigenvalues λ i x 2 and norms n i x 2 obtained from the auxiliary equation corresponding to the neumann boundary condition as shown in eq 17b similar to the derivation of c x y t for the case when seawater enters the aquifer shown in appendix a appendix b shows the mathematical derivation for when groundwater discharges to the sea as mentioned previously we have provided analytical solutions of land derived solute transport under tidal fluctuations in a confined aquifer under both cauchy and neumann boundary conditions at the seaward boundary however since most coastal areas have two high tides and two low tides each day and the flow direction between seawater and groundwater i e groundwater discharging to the sea or seawater influx to the aquifer changes almost regularly each day depending on the tide procedures are required to obtain an analytical solution describing land derived contaminant transport over time that reflects the regular reversal of flow direction the procedure for implementing a variable boundary condition that switches between the neumann discharge of groundwater into the sea and cauchy seawater flowing into the aquifer boundary conditions according to the flow direction is as follows for example we assume that the simulation time starts at zero and that at a simulation time of 0 t t 1 3 4 π ω the velocity at the seaward boundary directs flow from the sea into the aquifer for the sake of clarity the procedure of gitt considering such variable boundary conditions is systematically defined in table 1 according to table 1 we first obtain an analytical solution at simulation time 0 t t 1 using eq a6a in appendix a along with the initial condition at time zero 26a s 1 t exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ s 1 0 a t 0 t t 1 where 26b s mn 1 0 0 1 0 1 c x y 0 ψ m x 1 x ψ n y y d y d x m 1 2 m x n 1 2 m y then the concentration distribution c x y t at time 0 t t 1 is determined using the inverse transform described in eq 22b as follows 26c c x y t i 1 m x j 0 m y ψ i x 1 x ψ j y y s ij 1 t a t 0 t t 1 after we solve concentration distributions at simulation time 0 t t 1 using eq 26c the concentration distribution at time t t 1 t t 2 7 4 π ω can be determined using the concentration distribution at simulation time t 1 obtained from eq 26c in this case at simulation time t 1 t t 2 the velocity at the seaward boundary changes from flow into the aquifer to flow out of the aquifer and thus the boundary conditions switch from cauchy to neumann from simulation time t 1 to t 2 an analytical solution based on gitt can be obtained using eq b3a in appendix b as follows 27a s 2 t exp t 1 t c 1 σ c 2 σ c 3 σ c 4 σ d σ s 2 t 1 a t t 1 t t 2 where 27b s mn 2 t 1 0 1 0 1 c x y t 1 ψ m x 2 x ψ n y y d y d x m 0 1 2 m x n 0 1 2 m y after we solve eq 27a the inverse gitt formula in eq 24b can be used to obtain c x y t at time t 1 t t 2 as follows 27c c x y t i 0 m x j 0 m y ψ i x 2 x ψ j y y s ij 2 t a t t 1 t t 2 then after solving the concentration distribution c x y t 2 using eq 27c the concentration distribution c x y t at t 2 t t 3 11 4 π ω can be obtained from the concentration c x y t 2 in this case at a simulation time of t 2 t t 3 velocity at the seaward boundary changes from flow out of the aquifer to flow into the aquifer switching from the neumann to the cauchy boundary condition from the simulation time t 2 to t 3 the concentration distribution c x y t can be calculated using eqs 26a 26c again but with the starting time changed from 0 to t 2 and the ending time changed from t 1 to t 3 thus far we have developed an analytical solution for land derived solute transport under variable boundary conditions at the seaward boundary with a single switch from one boundary condition to another however under real conditions periodic flow due to tidal fluctuations causes repeated switches of the boundary conditions over time in this case an analytical solution can be easily obtained by sequential calculation through repetition of the processes described above 3 verification in this section the proposed two dimensional 2d analytical solution is verified through comparison with the one dimensional 1d semi analytical solution described previously by suk 2017 and the 2d numerical solution obtained using a finite element method for verification of the proposed 2d analytical solution against the existing 1d analytical solution of suk 2017 the initial plume of the 2d problem is located in the center of the domain away from the boundaries to avoid effects of the boundary conditions accordingly at the seaward boundary the neumann boundary conditions used for analytical solution of the 1d problem and the variable boundary conditions used for the 2d problem do not produce different simulation results as the plumes do not contact the seaward boundary and thus the solute concentration at the seaward boundary remains zero throughout the simulation if the initial contaminant distribution is assumed to be even across the whole domain of the y axis the 2d analytical solution will be identical to the 1d analytical solution furthermore to match the flow conditions of the 2d problem to those used in the 1d problem the x directional velocity is defined as equal to the velocity in the 1d problem in this study the y directional velocity component is assumed to be zero lastly to align the dispersion effect in the 2d problem with that in the 1d problem transverse dispersion effects in the 2d problem are suppressed by setting the transverse dispersivity α t to zero all input parameters are listed in table 2 as shown in table 2 all of the input parameters of the proposed 2d solution are the same as those used for the 1d semi analytical solution except d 0 y y transverse dispersivity α t and l y comparisons of the proposed 2d solutions against 1d semi analytical solutions at four time points are presented in fig 2 the proposed 2d solutions have identical results to the 1d solutions in the second verification example in contrast to the first problem two dimensional plume migration was simulated using the proposed analytical solution and in house code developed using the two dimensional finite element method fem in this study to compare our analytical solution from this study against numerical results the standard galerkin finite element method with the crank nicolson scheme was employed to obtain numerical code for simulating two dimensional solute transport subject to tidal fluctuations under variable boundary conditions as shown in fig 1 the initial plume concentration distribution had a prism shape with a width of 0 4 m along the x axis a length of 0 4 m along the y axis and maximum concentration of 1 ppm its center was located 1 m from the seaward boundary except for the seaward boundary where variable boundary conditions were prescribed all boundaries had zero dispersive flux boundary conditions the input parameters used for this simulation are summarized in table 3 the results of the proposed 2d analytical solution and numerical solutions at various times are shown in fig 3 and fig s1 in supplementary section f as shown in fig 3 the results aligned well at all times because the tidal period was 0 52 days flow direction changed every 0 26 days thus in fig 3a plumes migrate in the landward direction during the initial 0 26 days and then from 0 26 days to 0 52 days the plumes move in the seaward direction as shown in fig 3b where the neumann variable boundary conditions were applied at the seaward boundary in accordance with the seaward flow direction and the plumes hit the seaward boundary before the end of the first cycle after one cycle the plumes traveled landward again as shown in fig 3c and the cauchy variable boundary conditions were applied with no mass flux as flow was landward at the boundary lastly after one and a half periods the plumes traveled back in the seaward direction and the variable boundary conditions switched to the neumann boundary conditions in fig 3d to show that the numerical solutions obtained using the newly developed numerical code had negligible numerical errors various grid sizes were used to obtain concentration distributions at different times and the results were compared to the analytical solutions for clearer visualization of the comparison between numerical solutions at various grid sizes and analytical solutions only the concentration profiles at y 1 5 m and x 1 0 m are shown in figs s1a and b in supplementary section f respectively as shown in figs s1a and b at smaller grid sizes the numerical results are closer to the analytical solutions finally when the x and y directional grid sizes and time step size were 0 005 m 0 005 m and 0 001 days respectively the numerical solutions nearly matched the analytical solutions in this case the proposed 2d analytical solution had almost 74 fold faster performance in terms of cpu time compared to the fem data not shown although much smaller grid and time step sizes were tested the results did not change data not shown therefore we can conclude that the grid and time step sizes employed are sufficient to converge at an accurate solution 4 results and discussion 4 1 effects of tides and hydraulic properties this section focuses on the effects of the hydraulic properties of the confined aquifer and tides on contaminant transport near the seaward boundary using the proposed 2d analytical solution to study these effects an example was analyzed as shown in table 4 the domain was set to 10 m by 5 m and the source shape was a prism similar to fig 1 the initial source was located near the seaward boundary for analysis of the distribution of the contaminant over time and for exploring the influences of variable boundary conditions on x and y directional centroid displacements the mass remaining in the aquifer x y and xy directional variances and longitudinal and transverse macrodispersion sensitivity analysis of the tidal amplitude hydraulic conductivity and storage coefficient was conducted to investigate plume behavior near the boundary to determine the effects of tide and hydraulic properties on contaminant transport some plume characteristics such as centroid displacements variances and macrodispersion coefficients were derived analytically using the statistical moments of the plumes the x directional centroid displacement x t y directional centroid displacement y t mass remaining in the aquifer m t x directional variance σ xx 2 t y directional variance σ yy 2 t x y directional variance σ xy 2 t longitudinal macrodispersion d l t and transverse macrodispersion d t t can be readily and accurately calculated using gitt first we calculated the spatial moments at dimensionless time t using the following equation 28 m pq t 0 1 0 1 x p y q c x y t d y d x where p q is the order of the moment in eq 28 m pq t can be calculated as shown in eq 29a or 29b using eq 22b or eq 24b respectively depending on whether the direction of flow at the seaward boundary v x x 0 t is landward or seaward as follows 29a m pq t i 1 m x j 0 m y 0 1 x p ψ i x 1 x d x 0 1 y q ψ j y y d y s ij 1 t w h e n s e a w a t e r e n t e r s t h e a q u i f e r v x 0 t 0 29b m pq t i 0 m x j 0 m y 0 1 x p ψ i x 2 x d x 0 1 y q ψ j y y d y s ij 2 t when groundwater is discharged v x 0 t 0 using m pq t in eq 29a or 29b depending on the direction of groundwater velocity the x directional centroid displacement x t y directional centroid displacement y t remaining mass m t x directional variance σ xx 2 t y directional variance σ yy 2 t xy directional variance σ xy 2 t longitudinal macrodispersion d l t and transverse macrodispersion d t t can be calculated as follows 30a x t m 10 t m 00 t 30b y t m 01 t m 00 t 30c m t m 00 t 30d σ xx 2 t m 20 t m 00 t m 10 t m 00 t 2 30e σ yy 2 t m 02 t m 00 t m 01 t m 00 t 2 30f σ xy 2 t σ yx 2 t m 11 t m 00 t m 10 t m 00 t m 01 t m 00 t 30 g d l t 1 2 d σ xx 2 t dt 30 h d t t 1 2 d σ yy 2 t dt notably all statistical moments described above can be calculated analytically and the errors involved are negligible 4 1 1 effect of the magnitude of tidal amplitude on plume behavior to explore the effect of the magnitude of tidal amplitude concentration distributions at time points 0 195 0 455 0 715 and 0 975 days and magnitudes 0 1 1 and 2 m were calculated using the proposed 2d analytical solution as shown in fig 4 a b c and d respectively as shown in fig 4a the concentration distribution at the simulation time of 0 195 days before the halfway point was skewed in the landward direction while that at the simulation time of 0 455 days after the halfway point was near the original initial location as shown in fig 4b after one cycle the plumes traveled landward again as shown in fig 4c where the variable boundary conditions applied were the cauchy boundary conditions with no mass flux lastly after one and a half periods the plumes traveled back in the seaward direction and the variable boundary conditions were replaced with the neumann boundary conditions as shown in fig 4d at 0 975 days with an amplitude of 2 m the plume hit the seaward boundary and the contaminant flowed out through the boundary the plume centroid along the x axis the remaining mass variance along the x axis variance along the y axis longitudinal macrodispersion and the transverse macrodispersion are shown in fig 5 a f respectively in this study the y directional velocity was assumed to be zero and thus the plume centroid along the y axis always had the same value not shown here as shown in fig 5a f the centroid displacement mass remaining in the aquifer variance and macrodispersion values changed periodically depending on the direction and magnitude of the groundwater velocity in fig 5a the plume centroid along the x axis indicated that the plume moved fastest at the highest amplitude of 2 m and slowest at the lowest amplitude of 0 1 m this trend arises because high amplitude induces a strong gradient and thus increases the advection velocity however after 0 975 days the plume centroid along the x axis at the highest amplitude of 2 m appeared to move inland with time the reason for this apparent landward movement is that after 0 975 days the plume reached the seaward boundary and left the aquifer causing plume mass around the seaward boundary to decrease over time by contrast no plume mass crossed the landward boundary and therefore the plume mass near the landward boundary did not decrease notably the plume did not reach the landward boundary within the simulation time and therefore no mass crossed the landward boundary therefore the plume with an amplitude of 2 m appeared to move landward according to the statistical calculation described by eq 30a as its center of mass moved landward in reality the plume itself did not move inland fig 5b shows the mass remaining in the aquifer the remaining mass decreased whenever groundwater was discharged into the sea while it was not reduced while groundwater moved landward accordingly the graph of the remaining mass takes the form of a staircase decreasing in steps over time furthermore the remaining mass decreased fastest at the highest amplitude of 2 m which had the highest advection velocity fig 5c and d show the increases in x and y directional variances with increased tidal amplitude respectively these increases occur because larger amplitude leads to a larger advection velocity and greater dispersion coefficient enhancing the spread of the plume accordingly as shown in fig 5c and d the tidal amplitude of 2 m exhibited the most plume spreading periodicity was apparent in the variances along both the x and y axes fig 5e and f show longitudinal and transverse macrodispersion respectively as shown in fig 5e longitudinal macrodispersion has negative values whereas fig 5f shows that transverse macrodispersion has no negative values negative longitudinal macrodispersion occurs due to the difference between the advection velocities at the leading and trailing edges especially when the advective velocity is directed landward in this case the velocity at the front of the plume is smaller than that at the tail of the plume according to eq 3a accordingly the plume shrinks leading to a decrease in variance and consequently negative dispersion elfeki et al 2007 elfeki et al 2012 on the other hand as the y directional advection velocities at the bottom and top of the plume are always zero in this case and the x directional advection velocities at the bottom and top of the plume that cause transverse dispersion are always the same the y directional variances cannot be negative but must always be positive or zero 4 1 2 effect of storage coefficient on plume behavior similar to the tidal amplitude the concentration distributions at 0 195 and 0 715 days skewed landward as shown in fig 6 a and c respectively while those at 0 455 and 0 975 days were near the original location as shown in fig 6b and d respectively the plume moved fastest with the largest storage coefficient of 0 065 and moved slowest with the smallest storage coefficient of 0 0013 as a larger storage coefficient caused β to increase according to eq 2 in turn increasing the advection velocity according to eq 3b as shown in fig 7 a the plume moved fastest with the largest storage coefficient of 0 065 and moved slowest with the smallest storage coefficient of 0 0013 in fig 7b the remaining mass is reduced fastest with the largest storage coefficient the pattern of decrease of the remaining mass over time takes the form of a staircase with periodic stepwise reductions fig 7c and d show the increases in the x and y directional variances respectively with an increasing storage coefficient a pattern similar to that of tidal amplitude is observed wherein a larger storage coefficient led to greater advection velocity and in turn a larger dispersion coefficient enhancing the spread of the plume as a larger storage coefficient increased β more sharply the advection velocity decreased more rapidly with landward distance from the shoreline at larger storage coefficients according to eq 3a thus as β increases the advection velocities at the landward and seaward edges of the concentration profiles have greater differences for example during the period from the initial time point to the halfway point when the advection velocity was directed landward as β increased the difference between the two velocities became larger and therefore the velocity at the seaward edge became much larger than that at the landward edge accordingly during this period the contaminant plume shrank more as β increased however from the half period to full period points the advection velocity switched to the seaward direction thus the leading edge of the concentration profile in the direction of the advection velocity was closer to the shoreline than was the trailing edge here in contrast to the period discussed above the advection velocity at the leading edge was greater than that at the trailing edge indicating that the plume was extended during this period moreover a larger β value caused greater expansion therefore as shown in fig 7c and d the minimum variances occurred at each half period and the maximum variances occurred at each full period in other words we observed periodicity furthermore as a larger β caused more shrinkage and expansion the variations in variance were greater as shown in fig 7c the oscillation magnitude of the variances increased over time as the plume spread over time and therefore the distance between the seaward and landward edges of the plume increased with time in turn causing an increase in the difference in advection velocity between the two edges a larger β value amplified this effect as the macrodispersion coefficient represents the spreading rate over time sharper oscillating variations in the variances i e larger storage coefficients led to greater oscillation of the macrodispersion coefficient as shown in fig 7e and f finally when the advective velocity was directed landward the plume shrank notably due to the seaward side of the plume moving faster than the landward side leading to decreased variances and consequently a negative x directional dispersion term the phenomenon of negative macrodispersion has been reported in studies of coastal waters elfeki et al 2007 elfeki et al 2012 4 1 3 effect of hydraulic conductivity on plume behavior to investigate the effects of hydraulic conductivity on plume behavior concentration distributions at four time points 0 195 0 455 0 715 and 0 975 days were calculated for three values of hydraulic conductivity 2 5 25 and 100 m day using the proposed 2d analytical solution as shown in fig 8 a d similar to the results described in previous sections the concentration distributions oscillated depending on the flow direction the plume centroids mass remaining in the aquifer variances and macrodispersion were calculated using eqs 30a 30h and were presented in fig 9 a f similar to the tidal amplitude and storage coefficient discussed in previous sections the plume moved fastest at the largest hydraulic conductivity of 100 m day and moved slowest at the smallest hydraulic conductivity of 2 5 m day as shown in fig 9a this trend was due to the larger hydraulic conductivity inducing lower β in eq 2 but greater v 0 x and v x x t in eqs 3b and 3a respectively in addition after 0 455 days the x directional plume centroid with the highest hydraulic conductivity of 100 m day showed an apparent tendency to move landward with time similar to the pattern described in section 4 1 1 the reason for this apparent movement is the same as that explained in section 4 1 1 fig 9b shows the mass remaining in the aquifer which decreased whenever groundwater was discharged into the sea however during periods in which groundwater moved landward the remaining mass did not decrease as no mass exited the aquifer the remaining mass shrank fastest at the highest hydraulic conductivity of 100 m day which was also associated with the highest advection velocity furthermore the mass remaining at a hydraulic conductivity of 100 m day fell periodically as shown in fig 9b fig 9c and d show the increase in variance with increasing hydraulic conductivity which causes the advection velocity and dispersion coefficient to increase thereby enhancing the spread of the plume accordingly as shown in fig 9c and d the largest hydraulic conductivity of 100 m day led to the most spreading the effects of hydraulic conductivity on plume behavior were very similar to those of tidal amplitude finally in accordance with the findings for tidal amplitude the longitudinal and transverse macrodispersion shown in fig 9e and f respectively were greater at higher hydraulic conductivities as greater hydraulic conductivity leads to more sudden changes in plume spread as shown in fig 9e longitudinal macrodispersion has negative values whereas transverse macrodispersion has no negative values as shown in fig 9f similar to the patterns described in section 4 1 2 the negative values of longitudinal macrodispersion appeared to be explained by the difference in advection velocities between the leading and trailing edges 4 2 effects of the distribution and location of the initial contaminant source in this section we focus on the effects of distribution and of the location of the initial contaminant on both contaminant transport and the contaminant amount m t remaining in the aquifer as shown in fig 10 the centers of the initial contaminant sources were located at two locations of l30 and l80 in fig 10 l represents the center of the x domain x 5 m with l30 and l80 indicating source locations centered at distances from the coast corresponding to 30 and 80 of l respectively in short l30 and l80 are x 1 5 m and x 4 m respectively we used l30 and l80 to analyze the effect of the location of the source center on contaminant migration behaviors in a tidally influenced aquifer in addition w is the width of the confined aquifer w 2 m and the initial contaminant source was assumed to follow two distributions w20 and w80 fig 10 w20 and w80 represent the widths of the source distributions from the center of the y axis corresponding to 20 and 80 of w respectively in other words w20 and w80 represent y directional source distributions of 0 8 m y 1 2 m and 0 2 m y 1 8 m respectively in this study we used w20 and w80 to test the effect of the initial source distribution in the y axis on contaminant migration behaviors in the tidally influenced aquifer the other input parameters used for these simulations are shown in table 5 as shown in table 5 four scenarios of locations and distributions were designed we assumed that the lengths of the source distributions were fixed at 1 m in all scenarios in scenario 1 the contaminant is initially located and distributed at l30 and w20 as shown in fig 10 and the distributions of the contaminant at 0 195 days and 0 455 days are shown in figs s2a and b in supplementary section f respectively in addition the contaminant distributions under scenarios 2 3 and 4 are shown in figs s3a b fig s4a b and fig s5a b in supplementary section f respectively based on the locations and distributions of the initial contaminant sources the mass remaining in the tidally influenced aquifer is shown in fig s6 in supplementary section f the remaining mass m t was calculated analytically using eq 30c and eq 29a or 29b depending on the direction of groundwater flow as shown in fig s6 the remaining masses under scenarios 1 and 2 at l30 decreased faster than those under scenarios 3 and 4 at l80 nearer to the sea the remaining mass was also reduced more rapidly however the changes in the remaining masses over time for scenarios 1 l30 and w20 and 2 l30 and w80 were almost equal in addition the changes in the remaining masses for scenarios 3 l80 and w20 and 4 l80 and w80 were almost equal therefore in this case the more sensitive factor determining the change in the mass remaining in the aquifer with time is the initial distance from the sea rather than the initial plume width along the y axis 4 3 comparison of two variable boundary condition types at the seaward boundary this section compares the results obtained using the dirichlet neumann variable boundary conditions at the seaward boundary with those obtained using the cauchy neumann variable boundary conditions to determine which setting best matches the real situation four cases were designed to compare the results for four péclet numbers defined in eq 12a 492 66 13 and 3 table 6 similar to the initial contaminant distribution in a prism shape shown in fig 1 above an initial contaminant distribution with a prism shape of 0 1 m x 7 9 m was applied across the whole length of the simulation domain in the y axis with the vertex of the triangle positioned 4 0 m from the seaward boundary and a concentration at the vertex of the prism shape of 1 ppm the seaward boundary was located at the left boundary and the landward boundary was at the right boundary the neumann boundary conditions were applied to the landward boundary and either the dirichlet neumann or the cauchy neumann variable boundary conditions were applied at the seaward boundary under dirichlet neumann variable boundary conditions the dirichlet concentration was set to zero while under the cauchy neumann conditions the total flux was set to zero the concentration distribution over time and the mass remaining in the aquifer over time were calculated using the proposed equations for the dirichlet neumann and cauchy neumann variable boundary conditions fig 11 shows that the mass remaining in the aquifer decreased over time under both the cauchy neumann and the dirichlet neumann variable boundary conditions however in the case of the former the mass remaining in the aquifer did not decrease during the period of seawater influx whereas with the latter the mass remaining in the aquifer decreased during that period this difference is because the dirichlet neumann variable boundary conditions have non zero dispersive flux in the seaward direction whereas the cauchy neumann variable boundary conditions have a total influx of zero as the péclet number decreased greater dispersive flux occurred under the dirichlet neumann variable boundary conditions accordingly as the péclet number decreased the difference in remaining mass between the dirichlet neumann and cauchy neumann variable boundary conditions grew as shown in fig 11a d however the reduction in the remaining mass during the seawater influx period is not justified based on the real situation accordingly the dirichlet neumann variable boundary conditions are inappropriate for describing the total mass remaining over time in a tidally influenced aquifer furthermore due to these differing effects of the cauchy neumann and dirichlet neumann variable boundary conditions on mass flux at the seaward boundary the concentration distributions under these two variable boundary condition settings differed as shown in fig 12 the difference between the concentration distributions was greatest near the seaward boundary in summary the cauchy neumann variable boundary conditions reflect the real situation better than do the dirichlet neumann variable boundary conditions 5 conclusions a two dimensional semi analytical solution for land derived solute transport was developed under variable boundary conditions at the seaward boundary with tidal fluctuations the proposed semi analytical solutions were obtained using the gitt technique and matrix exponential solution method here the variable boundary conditions switched between the cauchy and neumann types depending on flow direction at the seaward boundary in addition an arbitrary initial distribution can be considered with this method the proposed 2d semi analytical solution was verified through comparison with the 1d semi analytical solution reported by suk 2017 and a 2d numerical solution developed using the finite element method using the proposed analytical solution with variable boundary conditions we calculated the mass remaining in the aquifer over time as well as statistical moments representing the characteristics of contaminant transport behavior and changes in the concentration distribution over time we compared the results using the dirichlet neumann variable boundary conditions at the seaward boundary with those using the cauchy neumann variable boundary conditions to determine which conditions best aligned with the real situation we found that the cauchy neumann variable boundary conditions reflected observations than better did the dirichlet neumann variable boundary conditions when the péclet number decreased the calculated differences in the concentration distribution and the mass remaining in the aquifer were larger under both types of variable boundary conditions in other words the dirichlet neumann variable boundary conditions resulted in more errors as the péclet number decreased sensitivity analysis was performed to examine factors such as hydraulic properties tidal amplitude and the location and distribution of the initial contaminant that affect both the characteristics of land derived pollutant transport in coastal aquifers and the mass remaining in the aquifer over time the characteristics of plume migration were described by the x and y directional centroid displacements x and y directional variances longitudinal and transverse macrodispersion coefficients and mass remaining in the aquifer over time all of which can be determined analytically using the proposed solutions as the tidal amplitude increased the plume centroid variance and macrodispersion values increased and the remaining mass decreased as a larger amplitude led to greater advection velocity and in turn a larger dispersion coefficient causing more plume spreading similarly with increased hydraulic conductivity increases in the plume centroid variances and macrodispersion terms were observed the reason for these increases may be that higher hydraulic conductivity led to greater advection velocity and in turn a larger dispersion coefficient thereby increasing plume spread similar to the tidal amplitude and hydraulic conductivity a larger storage coefficient caused larger increases in the plume centroid variance and macrodispersion values notably more negative longitudinal macrodispersion and stronger periodicity were observed in the oscillations of tidally affected aquifers when the hydraulic conductivity storage coefficient and tidal amplitude increased finally this study builds on the methods of suk 2017 to include variable boundary conditions at the seaward boundary and extends the findings of that study by adding a two dimensional analytical solution to elucidate the multi dimensional movements of land derived solutes in a tidally influenced aquifer the analytical solution proposed here will provide a useful tool for exploring the mechanism of plume migration which drives the behavior of contaminants such as radionuclides and toxic chemicals released into coastal aquifers of tidally affected systems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was performed with the support of the korea institute of geosciences and mineral resources kigam we appreciate support by the project titled research on rock properties in deep environment for hlw geological disposal gp2020 002 21 3115 funded by the ministry of science and ict south korea in addition this work was partially supported by the institute for korea spent nuclear fuel iksnf and korea foundation of nuclear safety kofons grant funded by the korea government nuclear safety and security commission nssc no 2109092 appendix a constructing and solving ode when seawater enters the aquifer for the case when seawater enters the aquifer to construct and solve ode multiplying both sides of eq 13 by ψ i x 1 x ψ j y y and then integrating with respect to both y and x from 0 to 1 0 1 0 1 ψ i x 1 x ψ j y y c t d y d x 0 1 0 1 ψ i x 1 x ψ j y y x v x x t c d y d x 0 1 0 1 ψ i x 1 x ψ j y y x e xx x t c x d y d x 0 1 0 1 ψ i x 1 x ψ j y y e yy x t 2 c y 2 d y d x 0 1 0 1 ψ i x 1 x ψ j y y k c d y d x 0 i 1 2 m x j 0 1 m y a1 using green s theorem and the boundary conditions of eqs 14 16 and 17a 0 1 0 1 ψ i x 1 x ψ j y y c t d y d x 0 1 ψ j y y ψ i x 1 x v x x t c x 1 d y 0 1 0 1 d ψ i x 1 x dx ψ j y y v x x t c d y d x 0 1 0 1 d ψ i x 1 x dx ψ j y y e xx x t c x d y d x 0 1 0 1 ψ i x 1 x d ψ j y y dy e yy x t c y d y d x 0 1 0 1 ψ i x 1 x ψ j y y k c d y d x 0 i 1 2 m x j 0 1 m y a2 replacing c x y t in eq a2 with the inverse transform of gitt given by eq 22b m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x d x 0 1 ψ j y y ψ n y y d y d s mn 1 t dt m 1 m x n 0 m y ψ i x 1 1 ψ m x 1 1 v x 1 t 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 d ψ i x 1 x dx ψ m x 1 x v x x t d x 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 d ψ i x 1 x dx d ψ m x 1 x dx e xx x t d x 0 1 ψ j y y ψ n y y d y s mn 1 t m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y s mn 1 t k m 1 m x n 0 m y 0 1 ψ i x 1 x ψ m x 1 x d x 0 1 ψ j y y ψ n y y d y s mn 1 t 0 i 1 2 m x j 0 1 m y a3 based on the orthogonality condition this expression can be rearranged and made compact as m 1 m x n 0 m y δ im δ jn d s mn 1 t dt m 1 m x n 0 m y a 1 imjn t a 2 imjn t a 3 imjn t a 4 imjn t s mn 1 t 0 i 1 2 m x j 0 1 m y a4 where δ im and δ jn are the kronecker deltas and a 1 imjn t ψ i x 1 1 ψ m x 1 1 v x 1 t δ jn k δ im δ jn i m 1 2 m x j n 0 1 m y a5a a 2 imjn t 0 1 d ψ i x 1 x dx ψ m x 1 x v x x t d x δ jn i m 1 2 m x j n 0 1 m y a5b a 3 imjn t 0 1 d ψ i x 1 x dx d ψ m x 1 x dx e xx x t d x δ jn i m 1 2 m x j n 0 1 m y a5c a 4 imjn t 0 1 ψ i x 1 x ψ m x 1 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y i m 1 2 m x j n 0 1 m y a5d a semi analytical solution to eq a4 can be obtained using linear system theory suk 2016 2017 liu et al 2000 rugh 1996 as follows s 1 t exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ s 1 0 a6a where s mn 1 0 0 1 0 1 c x y 0 ψ m x 1 x ψ n y y d y d x m 1 2 m x n 0 1 2 m y a6b in eq a6a the expression exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ on the right side can be calculated via tedious complicated mathematical manipulations as shown in eq a7 details of the derivation of the matrix integral within the matrix exponential can be found in supplementary section b exp 0 t a 1 σ a 2 σ a 3 σ a 4 σ d σ exp b 1 t b 2 t b 3 t k 1 n p 0 b 4 k t k 1 n q t b 5 k t k 1 n p 0 1 1 1 k b 6 k t k 1 n q t 1 1 n max t k b 7 k t a7 where b 1 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x ψ i x 1 1 ψ m x 1 1 exp β cos β δ jn 1 ω sin ω t π 4 sin π 4 v 0 x ψ i x 1 1 ψ m x 1 1 exp β sin β δ jn t k δ im δ jn a8a b 2 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x λ i x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im 1 f 21 im 0 f 22 im 1 f 22 im 0 f 23 im 1 f 23 im 0 f 24 im 1 f 24 im 0 1 ω sin ω t π 4 sin π 4 v 0 x λ i x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im 1 f 11 im 0 f 12 im 1 f 12 im 0 f 13 im 1 f 13 im 0 f 14 im 1 f 14 im 0 a8b b 3 imjn t 1 ω n max t n q t e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im 1 f 31 im 0 f 32 im 1 f 32 im 0 1 ω n max t n q t e 0 y y 2 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 31 im 1 f 31 im 0 f 32 im 1 f 32 im 0 a8c b 4 imjn k t 1 ω e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im 1 f 31 im x p 0 k f 32 im 1 f 32 im x p 0 k 1 ω e 0 y y 2 n i x 1 1 2 n 1 m x 1 1 2 λ j y 2 n j y δ jn f 31 im 1 f 31 im x p 0 k f 32 im 1 f 32 im x p 0 k a8d b 5 imjn k t 1 ω e 0 x x λ i x 1 λ m x 1 n i x 1 1 2 n m x 1 1 2 δ jn f 31 im x q t k f 31 im 0 f 32 im x q t k f 32 im 0 1 ω e 0 y y 2 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 31 im x q t k f 31 im 0 f 32 im x q t k f 32 im 0 a8e b 6 imjn k t 1 ω cos π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im x p 0 k f 11 im x p 0 k 1 f 12 im x p 0 k f 12 im x p 0 k 1 f 13 im x p 0 k f 13 im x p 0 k 1 f 14 im x p 0 k f 14 im x p 0 k 1 1 ω sin π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im x p 0 k f 21 im x p 0 k 1 f 22 im x p 0 k f 22 im x p 0 k 1 f 23 im x p 0 k f 23 im x p 0 k 1 f 24 im x p 0 k f 24 im x p 0 k 1 1 ω cos π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 11 im x p 0 k f 11 im x p 0 k 1 f 12 im x p 0 k f 12 im x p 0 k 1 f 13 im x p 0 k f 13 im x p 0 k 1 f 14 im x p 0 k f 14 im x p 0 k 1 1 ω sin π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 21 im x p 0 k f 21 im x p 0 k 1 f 22 im x p 0 k f 22 im x p 0 k 1 f 23 im x p 0 k f 23 im x p 0 k 1 f 24 im x p 0 k f 24 im x p 0 k 1 a8f b 7 imjn k t 1 ω cos ω t π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 11 im x q t k f 11 im x q t k 1 f 12 im x q t k f 12 im x q t k 1 f 13 im x q t k f 13 im x q t k 1 f 14 im x q t k f 14 im x q t k 1 1 ω sin ω t π 4 e 0 x x λ i x 1 λ m x 1 4 n i x 1 1 2 n m x 1 1 2 δ jn f 21 im x q t k f 21 im x q t k 1 f 22 im x q t k f 22 im x q t k 1 f 23 im x q t k f 23 im x q t k 1 f 24 im x q t k f 24 im x q t k 1 1 ω cos ω t π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 11 im x q t k f 11 im x q t k 1 f 12 im x q t k f 12 im x q t k 1 f 13 im x q t k f 13 im x q t k 1 f 14 im x q t k f 14 im x q t k 1 1 ω sin ω t π 4 e 0 y y 8 n i x 1 1 2 n m x 1 1 2 λ j y 2 n j y δ jn f 21 im x q t k f 21 im x q t k 1 f 22 im x q t k f 22 im x q t k 1 f 23 im x q t k f 23 im x q t k 1 f 24 im x q t k f 24 im x q t k 1 a8g where n p 0 int 1 4 int β π 1 4 a8h n q t int ω π t 1 4 int ω π t β π 1 4 a8i x p 0 k π β 3 4 k k 1 2 n p 0 a8j x q t k ω β t π β n max t 3 4 k k 1 2 n q t a8k n max t int ω π t 1 4 a8l f 11 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8m f 12 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8n f 13 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8o f 14 im x exp β x β cos λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β sin λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8p f 21 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8q f 22 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8r f 23 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8s f 24 im x exp β x β sin λ i x 1 λ m x 1 x 1 β x λ i x 1 λ m x 1 β cos λ i x 1 λ m x 1 x 1 β x β 2 λ i x 1 λ m x 1 β 2 a8t f 31 im x exp β x β cos λ i x 1 λ m x 1 x 1 λ i x 1 λ m x 1 sin λ i x 1 λ m x 1 x 1 β 2 λ i x 1 λ m x 1 2 a8u f 32 im x exp β x β cos λ i x 1 λ m x 1 x 1 λ i x 1 λ m x 1 sin λ i x 1 λ m x 1 x 1 β 2 λ i x 1 λ m x 1 2 a8v after the set of coupled first order differential equations for s 1 t is solved using eq a6a the inverse gitt formula shown in eq 22b can be calculated to obtain c x y t appendix b constructing and solving ode when groundwater discharges into the sea for the case when groundwater discharges into the sea multiplying both sides of eq 13 by ψ i x 2 x ψ j y y and then integrating with respect to both y and x from 0 to 1 using green s theorem and the boundary conditions of eqs 14 16 and 17b replacing c x y t with the inverse transform of gitt given by eq 24b using the orthogonality condition and finally constructing a compact matrix form m 0 m x n 0 m y δ im δ jn d s mn 2 t dt m 0 m x n 0 m y c 1 imjn t c 2 imjn t c 3 imjn t c 4 imjn t s mn 2 t 0 i 0 1 m x j 0 1 m y b1 where c 1 imjn t ψ i x 2 1 ψ m x 2 1 v x 1 t δ jn ψ i x 2 0 ψ m x 2 0 v x 0 t δ jn k δ im δ jn i m 0 1 2 m x j n 0 1 m y b2a c 2 imjn t 0 1 d ψ i x 2 x dx ψ m x 2 x v x x t d x δ jn i m 0 1 2 m x j n 0 1 m y b2b c 3 imjn t 0 1 d ψ i x 2 x dx d ψ m x 2 x dx e xx x t d x δ jn i m 0 1 2 m x j n 0 1 m y b2c c 4 imjn t 0 1 ψ i x 2 x ψ m x 2 x e yy x t d x 0 1 d ψ j y y dy d ψ n y y dy d y i m 0 1 2 m x j n 0 1 m y b2d as described in appendix b for the case when seawater enters the aquifer a semi analytical solution of eq b1 can be obtained via linear system theory as follows s 2 t exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ s 2 0 b3a where s mn 2 0 0 1 0 1 c x y 0 ψ m x 2 x ψ n y y d y d x m 0 1 2 m x n 0 1 2 m y b3b in eq b3a exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ on the right side can be calculated using eq b4 following procedures similar to those described in supplementary section c which involve the double integral of time and space including 1 n x t exp 0 t c 1 σ c 2 σ c 3 σ c 4 σ d σ exp d 1 t d 2 t d 3 t k 1 n p 0 d 4 k t k 1 n q t d 5 k t k 1 n p 0 1 1 1 k d 6 k t k 1 n q t 1 1 n max t k d 7 k t b4 where d 1 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x ψ i x 2 1 ψ m x 2 1 exp β cos β δ jn v 0 x ψ i x 2 0 ψ m x 2 0 δ jn 1 ω sin ω t π 4 sin π 4 v 0 x ψ i x 2 1 ψ m x 2 1 exp β sin β δ jn t k δ im δ jn b5a d 2 imjn t 1 ω cos ω t π 4 cos π 4 v 0 x λ i x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im 1 g 21 im 0 g 22 im 1 g 22 im 0 g 23 im 1 g 23 im 0 g 24 im 1 g 24 im 0 1 ω sin ω t π 4 sin π 4 v 0 x λ i x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im 1 g 11 im 0 g 12 im 1 g 12 im 0 g 13 im 1 g 13 im 0 g 14 im 1 g 14 im 0 b5b d 3 imjn t 1 ω n max t n q t e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im 1 g 31 im 0 g 32 im 1 g 32 im 0 1 ω n max t n q t e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im 1 g 31 im 0 g 32 im 1 g 32 im 0 b5c d 4 imjn k t 1 ω e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im 1 g 31 im x p 0 k g 32 im 1 g 32 im x p 0 k 1 ω e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im 1 g 31 im x p 0 k g 32 im 1 g 32 im x p 0 k b5d d 5 imjn k t 1 ω e 0 x x λ i x 2 λ m x 2 n i x 2 1 2 n m x 2 1 2 δ jn g 31 im x q t k g 31 im 0 g 32 im x q t k g 32 im 0 1 ω e 0 y y 2 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 31 im x q t k g 31 im 0 g 32 im x q t k g 32 im 0 b5e d 6 imjn k t 1 ω cos π 4 e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im x p 0 k g 11 im x p 0 k 1 g 12 im x p 0 k g 12 im x p 0 k 1 g 13 im x p 0 k g 13 im x p 0 k 1 g 14 im x p 0 k g 14 im x p 0 k 1 1 ω sin π 4 e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im x p 0 k g 21 im x p 0 k 1 g 22 im x p 0 k g 22 im x p 0 k 1 g 23 im x p 0 k g 23 im x p 0 k 1 g 24 im x p 0 k g 24 im x p 0 k 1 1 ω cos π 4 e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 11 im x p 0 k g 11 im x p 0 k 1 g 12 im x p 0 k g 12 im x p 0 k 1 g 13 im x p 0 k g 13 im x p 0 k 1 g 14 im x p 0 k g 14 im x p 0 k 1 1 ω sin π 4 e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 21 im x p 0 k g 21 im x p 0 k 1 g 22 im x p 0 k g 22 im x p 0 k 1 g 23 im x p 0 k g 23 im x p 0 k 1 g 24 im x p 0 k g 24 im x p 0 k 1 b5f d 7 imjn k t 1 ω cos ω t 1 4 π e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 11 im x q t k g 11 im x q t k 1 g 12 im x q t k g 12 im x q t k 1 g 13 im x q t k g 13 im x q t k 1 g 14 im x q t k g 14 im x q t k 1 1 ω sin ω t 1 4 π e 0 x x λ i x 2 λ m x 2 4 n i x 2 1 2 n m x 2 1 2 δ jn g 21 im x q t k g 21 im x q t k 1 g 22 im x q t k g 22 im x q t k 1 g 23 im x q t k g 23 im x q t k 1 g 24 im x q t k g 24 im x q t k 1 1 ω cos ω t 1 4 π e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 11 im x q t k g 11 im x q t k 1 g 12 im x q t k g 12 im x q t k 1 g 13 im x q t k g 13 im x q t k 1 g 14 im x q t k g 14 im x q t k 1 1 ω sin ω t 1 4 π e 0 y y 8 n i x 2 1 2 n m x 2 1 2 λ j y 2 n j y δ jn g 21 im x q t k g 21 im x q t k 1 g 22 im x q t k g 22 im x q t t k 1 g 23 im x q t k g 23 im x q t k 1 g 24 im x q t k g 24 im x q t k 1 b5g where g 11 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5h g 12 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5i g 13 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5j g 14 im x exp β x β cos λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β sin λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5k g 21 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5l g 22 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5m g 23 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5n g 24 im x exp β x β sin λ i x 2 λ m x 2 β x λ i x 2 λ m x 2 β cos λ i x 2 λ m x 2 β x β 2 λ i x 2 λ m x 2 β 2 b5o g 31 im x exp β x β cos λ i x 2 λ m x 2 x λ i x 2 λ m x 2 sin λ i x 2 λ m x 2 x β 2 λ i x 2 λ m x 2 2 b5p g 32 im x exp β x β cos λ i x 2 λ m x 2 x λ i x 2 λ m x 2 sin λ i x 2 λ m x 2 x β 2 λ i x 2 λ m x 2 2 b5q as described in appendix a for when seawater enters the aquifer after the set of coupled first order differential equations for s 2 t is solved using eq b3a the inverse gitt formula presented in eq 24b can be used to obtain c x y t appendix c supplementary data supplementary data associated with this article can be found in the attached files supplementary a docx supplementary b doc supplementary c doc supplementary d docx supplementary e docx and supplementary f docx appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127441 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 supplementary data 5 supplementary data 6 
3663,short term water demand forecast based on automatic feature extraction by one dimensional convolution lei chen conceptualization methodology software validation formal analysis writing original draft writing review editing a b hexiang yan validation formal analysis investigation a b jieru yan writing review editing data curation a b jiaying wang data curation funding acquisition a b tao tao resources data curation supervision project administration funding acquisition a b kunlun xin resources supervision funding acquisition a b shuping li resources supervision a b zhengheng pu visualization a b jian qiu funding acquisition c a college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china b smart water joint innovation r d center tongji university shanghai 200092 china smart water joint innovation r d center tongji university shanghai 200092 china smart water joint innovation r d center tongji university shanghai 200092 china c aliyun computing company limited hangzhou 310013 china aliyun computing company limited hangzhou 310013 china aliyun computing company limited hangzhou 310013 china corresponding author at college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china short term water demand forecast is one of the most important technology for urban water supply management the accuracy and timeliness of the forecast have an important impact most of the reported water demand forecast models based on deep learning methods apply a manual features extraction strategy resulting in incomplete mining of the data and weak model self adaptability capability to address these issues a new framework of short term water demand forecast is proposed in which a data preprocessing approach s h esd seasonal hybrid extreme student deviate and a forecasting model conv1d gru one dimensional convolution gated recurrent unit are mainly developed based on the historical monitoring data different hyper parameter settings and training strategies were carried out with the proposed models the results show that the data preprocessing model s h esd can effectively deal with a variety of abnormal values therefore significantly improving the accuracy of forecast when the training dataset length is 7 days the average accuracy of the three models is improved by1 23 when using s h esd method compared with z score method and the conv1d gru model shows better capability in forecast accuracy and self adaptability of data features extraction compared with other models in literature grun ann with the achieving optimal parameter setting and training strategy the developed methodology shows the best forecasted value of mape and nse indicator are 1 677 0 983 respectively keywords water distribution system water demand forecast deep learning automatic feature extraction one dimensional convolution gated recurrent unit 1 introduction freshwater is an irreplaceable resource for human survival and development and it is the foundation for the sustainable development of the global economy and society with the growth of the global population and the unreasonable use of water resources many countries in the world are facing severe water shortages there are many factors that affect water demand in addition to the seasonal strong signal and white noise of its main signal there are also such as population numbers and distribution quality of water technology economic conditions and environmental conditions groppo et al 2019 by analyzing and forecasting the urban water demand in the future according to these points we can produce and distribute water resources more reasonably brentan et al 2018 herrera et al 2010 rice et al 2018 wong et al 2010 brentan et al 2018 herrera et al 2010 rice et al 2018 wong et al 2010 water demand forecast can be divided into three categories according to different time horizons of the forecast donkor et al 2014 guo et al 2018 tiwari and adamowski 2013 gardiner and herrington 1986 long term forecast 20 30 years medium and long term forecast 1 10 years and short term forecast minutes hours days weeks the smart water platform uses the instrumentation interconnectedness and intelligence to effectively connect the water infrastructure to form a modern smart water distribution system mswds one manifestation of the wisdom of mswds is the real time detection and alarm of anomalies in a water distribution system for example using the residual relationship between the forecasted value and the monitored value to solve the hot issues of smart water affairs such as leakage and pipe burst zhou et al 2019 if the difference between these two values exceeds a certain threshold the system will issue alarm for anomaly this requires that mswds can realize real time forecast of water distribution state and the forecast accuracy is adequately high water demand is an important monitoring indicator in mswds when the observed value deviates significantly from the forecasted water demand it helps to identify the occurrence of leakage and other anomalies herrera et al 2010 along with the rapid development of the smart water platform the demand for accurate short term water demand forecasts is ever increasing this research proposes an approach for obtaining short term water demand forecast with high accuracy according to the existing research on short term water demand forecasting the research methods can be divided into linear mathematical methods and machine learning methods as mentioned above water demand is usually correlated with climate factors and social factors brentan et al 2018 ashu et al 2001 and howe and linaweaver 1967 tried to establish the relationship between each parameter and water demand by using a linear function method shvartser et al 1993 combined the pattern recognition technique with autoregressive integrated moving average arima to forecast water demand of israel braun et al 2014 proposed a forecasting model which combined an autoregressive approach with a regression model respecting additional parameters caiado 2010 proposed a double seasonal arima model to forecast daily water demand in spain wong et al 2010 analyzed a variety of factors that affect water demand and used multivariate linear regression mlr to achieve water demand forecast however the linear relationship usually cannot represent the complex relationships in between which results in inaccuracy in short term water demand forecasts braun et al 2014 wong et al 2010 with the development of science and technology computers can process a large amount of data with high efficiency thus data mining technology centered on machine learning has been rapidly improved alvisi et al 2007 arandia et al 2016 and brentan et al 2017 pointed out that the use of data driven methods to achieve short term water demand forecasts can effectively reduce energy costs making it a popular research area machine learning such as artificial neural network ann support vector regression svr random forest rf gradient boosting machine gbm were also used to obtain short term water demand forecasts a da mowski et al 2012 antunes et al 2018 pandey et al 2020 tiwari and adamowski 2015 xenochristou et al 2020 xenochristou and kapelan 2020 many researchers salloom et al 2019 have proved that these nonlinear machine learning models have made great improvement in water demand forecasting compared with the linear mathematical statistics methods but they still cannot meet the accuracy requirements under the development of smart water platform deep learning is a specific subfield of machine learning it has been widely used in many fields such as face recognition natural language processing and visual object detection glorot et al 2011 gouws 2012 schmidhuber 2015 yi et al 2014 compared with the traditional machine learning methods its advantage lies in the ability to extract input features at a deeper level which enables more complex problems to be solved historical water demand data implicitly include the influence of factors such as temperature humidity holidays and so on deep learning method can mine the implicit features in historical data well to a certain extent these factors do not need to be used as explicit input to the model guo et al 2018 successfully used a deep learning method gated recurrent unit network grun to obtain short term water demand forecasts compared with traditional machine learning methods grun obtained higher forecast accuracy mu et al 2020 studied the effect of the long short term memory lstm model in forecasting the water demand data at the inflection points i e abrupt changes relative to their corresponding neighboring and data with a relatively high uncertainty level hu et al 2019 used convolutional neural network cnn and bidirectional lstm bi lstm to forecast the daily water demand by considering temperature and other factors salloom et al 2021a salloom et al 2021 proposed a deep learning based model and a method to reduce the forecast error at extreme points and through the establishment of new features they solved the cumulative error problem in multi step forecast through the effort of many researchers deep learning has been steadily promoted in the application of water demand forecasting but there are still some issues that hinder the estimation accuracy of the deep learning based methods especially for short term water demand forecasting e g at a minute level 1 researchers have continued the relevant methods in machine learning by manually extracting features as input to the deep learning model for example guo et al 2018 manually extracted distant near and recent data as model input which compressed the data dimension to a certain extent and improved the efficiency of the model regardless of the tedious procedure manual feature extraction can result in loss of information and therefore impact model performance 2 for the forecast of minute level water demand the input of the model is often only the historical monitoring data of the water demand the quality of the input data largely affects the model performance however the importance of data cleaning is underestimated 3 the effectiveness of the water demand forecast model based on deep learning depends on the training effect of the model the existing researches focus more on the forecast accuracy of the model and ignore the factors that affect the training effect such as the length of training dataset training strategy and so on the length of training dataset and the input selection determine the extent to which the model can extract data features and affects the efficiency of training and the existing deep learning training strategies mostly adopt the fixed epoch training method which is simple and easy to implement however it is not realistic to set perfect training epochs for each training round because the optimal training effect may not be achieved after the set training epochs the optimal training effect may be achieved or not achieved within the training epochs 4 the input and parameters of the water demand forecast model are not static different inputs and the configuration of different parameters of the model will affect the whole process from model establishment to application therefore when establishing a water demand forecast model for specific data it is necessary to flexibly explore the characteristics of the data to configurate appropriate model inputs and model parameters for example in this research two days water demand data is used as the input of the model and the training dataset length of the model is configured to be 60 days in these aspects there are still research gaps in order to advance the progress of deep learning technology in water demand forecasting this research aims to 1 explore a method that can automatically extract features of water demand data 2 to explore a method for data cleaning and 3 to analyze the impact of length of training dataset training strategy and training success rate on model performance in this work s h esd method was used for data cleaning a model termed conv1d gru is proposes to demonstrate the capability of the proposed model the results are compared with those from grun and ann models 2 research data and equipment the research site is located in huzhou which is a prefecture level city in china with a population of approximately 3 37 million inhabitants and the total water demands are approximately 90 million m3 per year including 32 million m3 of residential water demand and 30 million m3 of commercial and industrial water demand the data in this research comes from sd water plant which mainly distribute water for a certain area in huzhou the data spans from january 1st 2017 to may 31st 2019 with a sampling interval of 15 min this research focuses on urban water demand forecasting so the data covers domestic water demand commercial water demand and industrial water demand in the area this research analyzes and extracts the features of the overall water demand data to forecast the future water demand of the region in other words this research is a forecast of the overall water demand of the region under regular scheduling therefore the forecast of such as industrial and commercial water demand with irregular change pattern is limited in this research the dataset contains abnormal data such as missing values too large or too small data values these abnormal values are mainly caused by sensor failures network interruptions or fluctuations the proportion of abnormal data in this dataset is about 5 the dataset contains 84 576 observations and table 1 shows the characteristics of this dataset with the resolution of 15 min after cleaning in this research s h esd method was implemented using python and the conv1d gru model grun model and ann model were implemented using keras keras is a deep learning api written in python running with tensorflow cntk or theano as the backend tensorflow backend was employed in this research 3 methodology 3 1 flowchart fig 1 shows the overall flow chart of this research the data used in the models comes from the monitoring data of a water plant as described in section 2 data cleaning and data processing of raw data are described in section 3 2 and section 3 3 s h esd method is used for data cleaning which is a method of mathematical statistic the random seed data division method ensures the efficient use of data and verifies the impact of different training dataset lengths on forecasting and the sliding window method is used for sample processing to construct the data of supervised learning that can be used by the deep learning models after that a deep learning forecast model is established that uses a one dimensional convolutional neural network to automatically extract features described in section 3 4 in addition the advanced grun model based on manual feature extraction and the widely used ann model are used to evaluate performance of the models one step forecast of water demand is realized by all three models different training strategies are used in the training process described in section 3 5 finally the performance of data cleaning forecasting stability and training strategies are evaluated in the test process the evaluation results and analysis are described in section 4 the indicators of rmse mae mape and nse are used in evaluation process described in section 3 5 2 3 2 data cleaning real time monitoring data often contains a lot of abnormal values many models often have simple assumptions about the scenarios that occur and therefore it requires experts to select the right detector for a given scenario and then to fine tune the parameters of the detector based on the training data chen et al 2013 he et al 2012 lee et al 2012 abnormal values can drastically impact the results of data analysis and modeling the sources of these abnormal values are complex in the mswds water demand data often come from the supervisory control and data acquisition scada system the data accuracy depends on the goodness of the sensors when they fail network interruption and fluctuation occur in the scada system monitoring data that are not in accordance with the actual condition of the system are then obtained e g monitoring values that are too large too small or invalid generally for small datasets abnormal values can be handled manually but for large datasets the possibility of identifying abnormal values manually becomes negligible thus we propose a method to identify abnormal values automatically 3 2 1 s h esd method generally speaking water distribution data have the characteristics of tendency seasonality and randomness normally the data are decomposed to eliminate the trend and seasonal effects the seasonal decomposition of time series by loess stl is a time series decomposition technique cleveland and cleveland 1990 which decomposes original time series o into three parts the trend component t seasonal component s and residual component r as a result the residual will be a stationary time series the residual is defined as eq 1 1 r o s t the s h esd can solve the problem of abnormal values on the residual component rosner 1983 this method assumes that the data is normally distributed it is an extension of grubbs method grubbs 1969 calculate k statistical values in turn the corresponding t distribution critical value is updated synchronously and the first k maximum minimum values are judged successively as abnormal values however the residual component obtained using the original stl technique might contain spurious anomalies therefore the stl method in s h esd method is improved by replacing the trend component with the median value and the new residual component is defined as eq 2 2 r o s m e d i a n o the statistics of first k maximum minimum values in the residual component are calculated as eq 3 3 c k max k x k m e d i a n x mad mad m e d i a n r i m e d i a n r where x k is the kth maximum minimum value after the data is arranged in order and the value of k can reach up to 49 9 of the total number of samples the calculated statistics are compared with the test critical value which is calculated as eq 4 4 λ k n k t p n k 1 n k 1 t p n k 1 2 n k 1 where n is the total number of samples t p n k 1 is the critical value of the t distribution when the degree of freedom is n k 1 and the significance level is p if c k λ k the value x k is judged as an abnormal value and it is removed from the dataset the critical value is recalculated from the remaining data until k epochs is reached 3 2 2 z score method z score thompson 2006 is a parameter anomaly detection method in one dimensional or low dimensional feature space it assumes that the data obeys a gaussian distribution and the outliers are data points at the tail of the distribution it can detect and repair abnormal values on the original data therefore in order to evaluate the impact of different cleaning methods on water demand forecast z score is also applied in this research the data are normalized by the eq 5 5 z i x i μ δ where μ and σ are the average and standard deviation of the dataset respectively then a threshold z thr is set if z i z thr the data point is considered an abnormal value z thr is generally set to 2 5 3 0 3 5 specifically z thr 3 0 was used in this research 3 3 data processing 3 3 1 method of dataset division a small amount of training data will make the model unable to learn the true characteristics of the data whereas excessive training data will make the training time too long this research explored the appropriate length of the training dataset for water demand forecast that is needed to achieve satisfactory accuracy based on deep learning in order to verify the robustness of the model and make full use of existing data this research did not simply divide the historical data into training dataset validation dataset and test dataset as fig 2 shown a random sampling method is adopted in this research first a random seed was generated which determined a certain time point in the data then the data of the 6 days after this time point was used as the validation dataset and the test dataset 3 days for the validation dataset and 3 days for the test dataset after the data of 7 30 60 90 120 180 365 days before and include this time point were used as the training dataset by the random seed respectively to verify the effect of different training dataset lengths on the same validation and test dataset finally such random seeds were generated 10 times so that the selection of data covered most of the historical data this sampling method can efficiently use the historical data and effectively evaluate the model in terms of forecast the strategy proposed in the section 3 3 2 is adopted taking the time point to be forecasted as the benchmark the data that two days before the time point to be forecasted were used as the model input to forecast the water demand 3 3 2 sample processing when training a deep learning model data cannot be directly used as the input it s the key to train deep learning models by using the supervised learning method to build the input and output relationship of data bandara et al 2020 used a sliding window scheme to feed the inputs and create the outputs for the stacking model and the sequence to sequence model with the dense layer it s an effective data augmentation mechanism as fig 3 shown in this way the deep learning model simultaneously produces a window of outputs corresponding to the time steps that immediately follow the fed inputs when accepting a window of inputs smyl 2016 the model accepts an input window of the same size as the previous step at the next consecutive time step shifted forward by one as mentioned above the data sampling interval is 15 min so 96 data can be obtained every day the forecasting horizon time is also 15 min in this research in other words this research is one step forecast of water demand then let the length of the whole data sequence be l the size of the input window be a the size of the output window be b and the size of the sliding window be t t a b water demand data is a seasonal timeseries data the most obvious is that the water demand data changes seasonally in days based on the above reasons and combined with the change pattern of water demand data the time step included in the input of the deep learning model is at least more than one change seasonality to ensure that the model can learn the seasonal change pattern of the data then the model takes the previous two days data 192 data as input for each step of forecasting to forecast the next data so a 192 b 1 t 193 by shifting the sliding window forward one by one the data sequence is broken down into blocks of size a b 193 forming the input output combination so input dataset and output dataset can be got and the number of samples in the input dataset and output data is l a b 1 l 191 and when the model continues to see new inputs the importance of the information from the distant time step tends to diminish and the trend change of the sequence is more focused on the recent time steps hewamalage et al 2021 3 4 model establishment after data processing a deep learning model is needed to establish a mapping between input and output to achieve water demand forecasting the accuracy of water demand forecasting mainly depends on the model structure and the parameter configuration of the model previous researches guo et al 2018 mu et al 2020 odan and reis 2012 often extract features during the data processing stage to ensure that the input data of the sample contains mapping features to output data so that the model can learn better forecasting parameters during model training in the model proposed by this research one dimensional convolutional neural layers conv1d are used to automatically extract data features and the extracted features are further used to achieve one step forecasting of water demand through gated recurrent unit gru layers and dense layers 3 4 1 one dimensional convolutional conv1d the convolutional neural network cnn is a feedforward neural network inspired by hubel and wiesel 1968 on the visual system in the cat brain cun et al 1990 and fukushima 1980 proposed and established the modern cnn framework which played a crucial role in the subsequent development of cnns traditional cnn takes two dimensional image data as input without complicated pre processing when dealing with this data type cnn usually uses two dimensional convolution kernel cnn maps the original image data to the feature space of the hidden layer through operations such as convolutional layers and pooling layers thereby avoiding the need to extract features explicitly then a fully connected layer is used at the end of the network to create the final non linear combination of features thus cnn is used for prediction and so on the advantage of cnn is that it can automatically extract features from complex data to avoid omissions and inaccuracies caused by manual feature extraction so as to achieve the tasks such as prediction and classification more accurately in the water distribution monitoring data the data transmitted by the sensors are all one dimensional time series data in order to extract data features more quickly and accurately for short term water demand forecast in this paper we introduce the one dimensional convolutional layer to process the input data the one dimensional convolutional layer is like the two dimensional convolutional layer the difference is that the one dimensional convolutional layer performs the convolution calculation of the one dimensional data by the one dimensional convolution kernel the convolutional neural network mainly includes three characteristics local perception spatial arrangement and parameter sharing cheng et al 2019 fig 4 shows the one dimensional convolution operation the convolution process involves multiplying each element in the convolution kernel with a corresponding element in a subregion of the input data and adding the products to obtain an element in the feature map teng et al 2021 after each calculation the sub region will move according to a specific step i e stride 1 until all the elements in the input data have been calculated finally the features of the input data through the one dimensional convolution operation can be obtained in addition the number of features obtained through convolution operations the size of output of feature map may also be different due to different convolution operations i e padding 0 1 2 during the convolution operation padding determines the start and end position of the convolution kernel in the input data the expressions of the one dimensional convolution operation are shown in eq 6 and eq 7 6 x out f c o n v 1 d w x in where x out is the output of the convolution operation x in is the input of the convolution operation f is the activation function and f x max 0 x conv1d is the one dimensional convolution operation w is the weight of the convolution kernel 7 s w out s w in 2 p a d d i n g s f stride 1 where s w out is the size of output of feature map s w in is the size of input feature map padding is the variable that determines the start and end positions of the convolution kernel and is set to be 1 in this research s f is the size of convolution kernel stride is the step that the convolution kernel traverses the input compared to two dimensional cnn one dimensional cnn is easier to train krizhevsky et al 2017 using fewer back propagation epochs to extract valid features and thus performs subsequent tasks faster 3 4 2 gated recurrent unit gru recurrent neural network rnn elman 1990 is a type of neural network dedicated to processing time series data it is proposed based on the viewpoint that human cognition is based on the past experience and memory it is different from other neural networks in that it not only considers the input of the previous moment but also gives the network a memory function of the previous moment however gradient explosion and vanishing are easy to occur in the process of training rnn resulting in gradients that cannot be transmitted in longer sequences during training which causes rnn to fail to detect the effects of long sequences to solve this problem gated recurrent unit gru was proposed its special control learning mechanism solves the gradient problem of rnn making it the most suitable sequence processing network structure at present gru is a kind of recurrent neural network cho et al 2014 it is proposed to solve the problems of long term memory and gradients in back propagation the parameters of gru are controlled by the forget gate and update gate in addition a linear dependency is added between the current state of the network h t and the state of the network at the previous time step h t 1 to solve the problem of gradient vanishing and explosion the update gate and reset gate are represented by z and r respectively and the principle of gru can be explained by eq 8 eq 11 8 z t δ g u z h t 1 w z x t b z 9 r t δ g u r h t 1 w r x r b r 10 h δ h u c r t h t 1 w c x t b c 11 h t 1 z t h t z t h t 1 where x t is the input vector u w and b are parameters for weights and bias δ g is the sigmoid function the values of z and r are both in the range 0 to 1 the update gate is used to control the retention of the historical state h t 1 and the candidate state of the current time step h t in the output state at the current time step so as to obtain the output of the final current time step h t the reset gate determines the degree of dependence of the candidate state at the current time step h t on the network state at the previous time step h t 1 the current candidate state and network output are shown as eq 10 and eq 11 3 4 3 conv1d gru model design this research focuses on the precise forecast of short term water demand thereby laying a foundation for the use of the residual relationship between the forecasted value and the monitored value to solve the hot issues of smart water affairs such as leakage and pipe burst in this research conv1d is used to automatically extract features from data to obtain local dependencies reflected in the time series then gru is used to extract the time dependence of the above mentioned features to achieve accurate forecast of water demand the conv1d gru model is shown in fig 5 the model takes two consecutive days of monitoring as input in general the model s conv1d layer captures the local dependency of the data while the gru layer captures the long term macroscopic dependency of the data specifically the model divides the input data into three parts data of the first day data of the second day and the overall data and extracts features from the three parts respectively when capturing short term local dependencies the conv1d layers with 64 filters and the length of 1 are used to enhance the data features to make up for the lack of input data features then the conv1d layers with different length are used to extract the features of different time scales on this basis the conv1d layers with 32 16 and 8 filters are used to refine the data features to obtain multi dimensional data representation finally the features extracted by the conv1d layers are used as the input of the gru layers when capturing long term macroscopic dependencies the gru layers with different output space dimensionality are used for feature extraction parameters of cw1 cw2 gn gd and dn are described in section 3 4 4 3 4 4 hyper parameter configuration whether a good forecast effect can be achieved depends not only on the establishment of the model but also on the configuration of hyper parameters a proper hyper parameter configuration enables the model to learn the deep characteristics of the data so as to achieve good forecast effect there are six hyper parameters to be configured in the conv1d gru model 1 the length of the conv1d window cw 2 the number of the gru layers gn 3 the dimensionality of the gru output space gd 4 the number of the dense layers dn 5 the learning rate of the model lr 6 the early stopping threshold of the training est the parameter of est is described in section 3 5 in order to find the optimal hyper parameter configuration we used random search and cross validation methods to optimize parameters random search is a more efficient hyper parameter optimization method than the traditional grid search and manual search bergstra and bengio 2012 in the search process for the parameter whose search range is continuously distributed random sampling is performed according to the given distribution for the parameter whose search range is a discrete distribution e g given as an array it performs equal probability sampling this method combined with cross validation can greatly reduce the time of hyper parameter optimization at the expense of a little accuracy thereby realizing the hyper parameter optimization of the deep learning model the hyper parameter search range and optimal configuration of the conv1d gru model are shown in table 2 it is worth noting that the number of units in the dense layer is in a 2dn 1 relationship with the search results of dn while the number of units in the dense layer is decreasing from top to bottom guo et al 2018 after the deep learning model is constructed by the above methods the model can be trained an applied after adopting appropriate training strategies and evaluation methods 3 5 model training and evaluating in addition to the configuration of hyper parameters the training strategy also affects the effect of model forecasting in this research the conv1d gru model grun model and ann model were trained on the same dataset the parameter configuration and training strategy of the conv1d gru model are described in detail in this paper which is also applicable to the ann model for the parameter configuration and training strategy of grun model please refer to guo et al 2018 3 5 1 training strategy how to avoid the neural network in the training process from over fitting and under fitting is a key issue in deep learning common approaches include using the dropout strategy regularization strategy and configuring the appropriate epochs dahl et al 2013 schölkopf and bernhard 2003 these strategies need to be set before the training starts but the training process is uncertain and random besides the changes in monitoring data in the mswds are also uncertain thus it is difficult to ensure that these strategies are consistent with each training process and for all training datasets in this research the early stop strategy was used for model training it is an adaptive training strategy the total epochs of model training were set to a large value e g 10000 and the model training was judged whether to be terminated by monitoring the effect of the model on the validation dataset when the effect of the model on the validation dataset is no longer improved for epochs of est times the model training is terminated and the optimal neural network parameters before the termination of the training are saved 3 5 2 performance indicators of forecast models the performance indicators used to assess model performance in this research are mean absolute error mae mean absolute percentage error mape root mean squared error rmse and nash sutcliffe model efficiency nse which are calculated according to eq 12 eq 15 respectively 12 mae 1 n i 1 n y i y i 13 mape 100 n i 1 n y i y i y i 14 rmse 1 n i 1 n y i y i 15 nse 1 i 1 n y i y i i 1 n y i y i where y i is the observed value y i is the forecasted value y i is the mean of the observed value mae and rmse are used to reflect the actual situation of the forecasted value error which range is 0 the larger the error the larger the value the range of mape is 0 the value of 0 indicates a perfect model nse is generally used to evaluate model fitting effect and stability the closer the value is to 1 the more stable the model is 4 results and discussion 4 1 procedures of experiments 4 1 1 procedure for evaluating of data cleaning in order to evaluate the performance of different data cleaning methods the following procedure was performed 1 randomly select five pieces of data with length of 7 days 2 the s h esd method and the z score method were used to clean the above dataset 3 the cleaned data was used to the conv1d gru model grun model and ann model respectively and each group of data was successfully trained for 10 times successful training refers to that the model after training has practical value specifically the nse indicator is used when the indicator is greater than 0 in this research the training is considered successful therefore a total of 5 10 50 successful experiment results were obtained specific results analysis can be seen in section 4 2 4 1 2 procedure for evaluating the effectiveness of different models in order to evaluate the impact of different models different lengths of training dataset and different training strategies on water demand forecasting the following procedure was performed 1 10 groups of data were randomly selected using the method described in the section 3 6 1 each group contains 7 datasets in which the length of the training dataset is 7 30 60 90 120 180 and 365 days 2 the above data was used to train the conv1d gru model grun model and ann model respectively and each set of data was successfully trained for 10 times therefore a total of 7 7 different lengths of training dataset 10 10 sets of data 10 10 successful training 700 successful experiment results were obtained 3 the experimental results of dimensions with different training dataset lengths and dimensions with different datasets were analyzed on average to explore the influence of different datasets and different lengths of training dataset on the forecast effect of water demand specific results analysis can be seen in section 4 3 and section 4 4 4 once the optimal length of training set has been determined the forecast effects of the three models in 10 successful experiments were analyzed to explore the stability of the forecast effects of different models specific results analysis can be seen in section 4 5 5 in addition the training success rate of different models on the dataset and the impact of different training strategies were also analyzed specific results analysis can be seen in section 4 6 4 2 performance of s h esd method this section mainly discusses the impact of using different data cleaning methods on water demand forecasting the length of training dataset is selected to be 7 days mainly considering the following aspects on the on hand this section mainly studies different data cleaning methods on the other hand the training dataset length of 7 days has basically covered a cycle of water demand change patterns and the model can be trained efficiently the specific methods and procedure can be seen in section 3 2 and section 4 1 1 fig 6 shows the processing effect of the two data preprocessing methods on five training datasets with the length of 7 days it can be seen from the figure that the overall data preprocessing effect of the s h esd method was better than that of the z score method regardless of whether the data is single point abnormality continuous abnormality or missing the data cleaned by the s h esd method is closer to the performance of the normal water use mode than that by z score method in order to further explore the impact of different preprocessing methods on water demand forecast three models were used to test on the datasets in fig 6 and the test results are shown in fig 7 to eliminate the contingency of experiments each point in the figure was the average of 10 successful experiments it can be seen that for the same model the forecast effect based on the data preprocessed by the s h esd method was better than that on the z score method at the same time under the same data cleaning method the forecast effect of conv1d gru model was better than those of grun model and ann model as shown in table 3 the conv1d gru model performed the best when using the data preprocessed by the s h esd method where the average values of the four indicators rmse mae mape nse for the five datasets were 94 10 61 67 4 38 and 0 942 respectively the s h esd method is better than the z score method in water demand forecasting in addition it can be preliminarily seen that the water demand forecast effect of the conv1d gru model with automatic feature extraction is better than those of the grun model and ann model 4 3 performance of different datasets in order to compare the overall forecast effects of different models the forecast effects on different training datasets were tested as shown in fig 8 the seeds represent different datasets selected and the specific methods and procedure can be seen in section 3 2 and section 4 1 2 the training datasets were preprocessed by the s h esd method each bar in the figure represents the average of the forecast effects with different training dataset lengths it can be seen from the figure that on average the forecast effects of conv1d gru model were better than those of grun and ann models and as shown in table 4 in terms of the mape indicator the average mape values of the three models conv1d gru grun ann are 2 498 3 243 and 4 853 respectively this indicates that in general whatever training dataset is used the conv1d gru model that performs feature extraction automatically can learn the latent features in historical data better and has wide application perspective in water demand forecast 4 4 performance of different lengths of training dataset the length of the training dataset not only affects the speed of training but also affects the forecast effect of the model fig 9 shows the forecast effects of the three models using 7 different training dataset lengths each point in the figure represents the average forecast effect of 7 training datasets after 10 trainings as can be seen from the figure with different lengths of training dataset the forecast effects of conv1d gru and grun models were significantly better than that of the ann model comparing the two deep learning models a similar trend was found when analyzing the forecast effects of both models the effect was increasing at first and then decreasing when the length of training dataset was 60 days the forecast effects of the conv1d gru and the grun models were the best and the average values of the mape indicator were 2 064 and 2 451 respectively it is worth mentioning that when the length of training dataset was less than 60 days the forecast effect of the grun model was far inferior to that of the conv1d gru model and when the length of training dataset was 7 days its forecast effect was even inferior to the ann model this is due to the fact that grun model adopts the manual feature extraction strategy while conv1d gru model adopts the automatic feature extraction strategy when the length of the training dataset is short the manually extracted feature cannot reflect the real pattern of water demand data whereas the automatic feature extraction strategy used by conv1d can effectively solve the problem it can be seen from the figure that even when the length of the training dataset is 7 days the conv1d gru model can still have a relatively excellent forecast effect when the length of training dataset reaches 365 days the forecast effect of the conv1d gru model appears to be slightly worse than that of grun model which is also due to the feature extraction strategy used when the length of the training dataset is long enough the features automatically extracted by conv1d contain too much redundant information which results in a poor forecast effect in general after repeating the experiment several times it can be seen that the conv1d gru model using the automatic feature extraction strategy can further improve the forecast effect of the manual feature extraction model and in terms of water demand forecast the forecast effect can be further improved by adopting an appropriate training dataset length 4 5 stability analysis using the optimal training dataset length 60 days the training stability and forecast stability of the three models will also be different using the same training datasets which will affect the accuracy and reliability of the forecast fig 10 shows the box plots of the three models successfully trained 10 times on 10 training datasets it can be seen that the forecast effects of conv1d gru and grun models were far better than ann model taking the mape indicator as an example the best results of the conv1d gru grun and ann models were 1 677 1 710 2 646 respectively although the optimal forecast effects that the three models can achieve are not much different the three models have a big difference in the worst forecast effects in the worst case the mape indicator test results of the three models were 2 606 4 732 11 696 respectively this indicates that to some extent the conv1d gru model is more robust in water demand forecasting the indicator of nse can evaluate the forecast stability of the model the average nse values of the three models conv1d gru grun ann after 100 rounds of successful trainings 10 training datasets were trained 10 times respectively were 0 963 0 955 0 864 respectively this indicates that for different training datasets with the optimal length of training dataset the forecast stability of the conv1d gru model is better than those of the grun and ann models furthermore the standard deviation of the nse values of the three model training can reflect the stability of the model training the average standard deviation of the nse values of the three models were 0 015 0 019 0 077 respectively this further indicates that the conv1d gru model is more stable during the training in addition the successful training rates of the conv1d gru and grun models were analyzed on different training datasets the two models were trained 50 times for each of the 10 training datasets fig 11 shows the comparison of the two models to be forecasted it can be seen from the figure that whatever training datasets were used the successful training rates of the conv1d gru model were significantly higher than that of the grun model this also demonstrates the stability of the conv1d gru model from another perspective compared with the manual feature extraction the automatic feature extraction facilitated by conv1d can make better use of historical data so as to establish a better relationship between the historical water demand data and the water demand data to be forecasted and to find the optimal gradient descent direction in the process of training as a result the success rate of the training is improved in summary the automatic feature extraction facilitated by conv1d makes the features diversified thereby ensuring that the model is more stable during the training and forecasting 4 6 performance of the training strategy of adaptive early stopping in order to evaluate the effects of different training strategies on water demand forecasting the early stopping training strategy and the fixed epoch training strategy were tested and the methods can be seen in section 3 5 1 table 5 shows the comparison of the mapes of the water demand forecasts obtained from the conv1d gru model using the two training methods on different training datasets with the optimal training length the number of epochs used in the fixed epoch training strategy was 25 it can be seen from the table that the forecast deviation of the model using the fixed epoch strategy is greater than that using the early stopping training strategy the average value of the mape indicator of the model using the fixed epoch training strategy was 2 416 and the average value of the indicator of the model using the early stopping training strategy was 2 079 although the number of fixed epoch is obtained from many experiments there is no guarantee that after the last training epoch the model can obtain the optimal parameter configuration whereas the early stopping training strategy can adaptively adjust the training epochs and save the optimal parameter configuration during the training process thereby ensuring the forecast accuracy of the model therefore the early stopping training strategy can further improve the forecast effect of the model 5 conclusions in order to obtain short term water demand forecasts with adequate accuracy we propose a deep learning model called conv1d gru compared with the state of the art grun model the conv1d gru model uses conv1d to automatically extract the features of water demand data thereby avoiding the necessity of manual feature extraction improving the intelligence of feature extraction and ensuring the diversity of feature in this research the impact of data cleaning strategies used on the accuracy of water demand forecasting is discussed for the first time and the s h esd method is used to preprocess the water demand data the experimental results show that the s h esd method is more effective than the z score method in removing various abnormalities in the data we also explore the effect of the length of training dataset on model forecasting when the length of the training dataset is short the manually extracted feature cannot reflect the real pattern of water demand data whereas the automatic feature extraction strategy can effectively solve the problem and when the length of the training dataset is long enough the features automatically extracted contain redundant information which leads to a decline in the forecast effect even so the forecast effect is almost same as the grun model experimental results show that when the length of the training dataset is 60 days in this research the comprehensive forecast effect of the model is the best and the average forecast errors of the conv1d gru and grun models are 2 064 and 2 451 respectively moreover with the optimal length of training dataset we explore the stability on model forecasting experimental results show that the average nse values of the conv1d gru model gurn model and ann model are 0 963 0 955 0 864 respectively and the average standard deviation of the nse values of the above models are 0 015 0 019 0 077 respectively which indicate that the stability in terms of the forecast and training of the conv1d gru model are better than that of the grun model and ann model and the average training success rate of the conv1d gru model and grun model are 94 8 and 78 4 respectively in addition an early stopping strategy that allows the model to obtain adaptively a better parameter configuration is proposed in this research which improves the forecast accuracy of the model further the average forecast errors of the conv1d gru model that employs the early stopping and fixed epoch strategies are 2 079 and 2 416 respectively nevertheless this research is based on a one step forecast of water demand and does not involve multi step forecasts of water demand therefore the effectiveness of the model and strategies mentioned in this research for the multi step forecasting of water demand needs to be further explored credit authorship contribution statement lei chen conceptualization methodology software validation formal analysis writing original draft writing review editing hexiang yan validation formal analysis investigation jieru yan writing review editing data curation jiaying wang data curation funding acquisition tao tao resources data curation supervision project administration funding acquisition kunlun xin resources supervision funding acquisition shuping li resources supervision zhengheng pu visualization jian qiu funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national key research and development plan grant 2019yfc0408801 the national natural science foundation of china nsfc grant 51978494 the major science and technology program for water pollution control and treatment grant 2017zx07201001 and the alibaba innovative research air 
3663,short term water demand forecast based on automatic feature extraction by one dimensional convolution lei chen conceptualization methodology software validation formal analysis writing original draft writing review editing a b hexiang yan validation formal analysis investigation a b jieru yan writing review editing data curation a b jiaying wang data curation funding acquisition a b tao tao resources data curation supervision project administration funding acquisition a b kunlun xin resources supervision funding acquisition a b shuping li resources supervision a b zhengheng pu visualization a b jian qiu funding acquisition c a college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china b smart water joint innovation r d center tongji university shanghai 200092 china smart water joint innovation r d center tongji university shanghai 200092 china smart water joint innovation r d center tongji university shanghai 200092 china c aliyun computing company limited hangzhou 310013 china aliyun computing company limited hangzhou 310013 china aliyun computing company limited hangzhou 310013 china corresponding author at college of environmental science and engineering tongji university shanghai 200092 china college of environmental science and engineering tongji university shanghai 200092 china short term water demand forecast is one of the most important technology for urban water supply management the accuracy and timeliness of the forecast have an important impact most of the reported water demand forecast models based on deep learning methods apply a manual features extraction strategy resulting in incomplete mining of the data and weak model self adaptability capability to address these issues a new framework of short term water demand forecast is proposed in which a data preprocessing approach s h esd seasonal hybrid extreme student deviate and a forecasting model conv1d gru one dimensional convolution gated recurrent unit are mainly developed based on the historical monitoring data different hyper parameter settings and training strategies were carried out with the proposed models the results show that the data preprocessing model s h esd can effectively deal with a variety of abnormal values therefore significantly improving the accuracy of forecast when the training dataset length is 7 days the average accuracy of the three models is improved by1 23 when using s h esd method compared with z score method and the conv1d gru model shows better capability in forecast accuracy and self adaptability of data features extraction compared with other models in literature grun ann with the achieving optimal parameter setting and training strategy the developed methodology shows the best forecasted value of mape and nse indicator are 1 677 0 983 respectively keywords water distribution system water demand forecast deep learning automatic feature extraction one dimensional convolution gated recurrent unit 1 introduction freshwater is an irreplaceable resource for human survival and development and it is the foundation for the sustainable development of the global economy and society with the growth of the global population and the unreasonable use of water resources many countries in the world are facing severe water shortages there are many factors that affect water demand in addition to the seasonal strong signal and white noise of its main signal there are also such as population numbers and distribution quality of water technology economic conditions and environmental conditions groppo et al 2019 by analyzing and forecasting the urban water demand in the future according to these points we can produce and distribute water resources more reasonably brentan et al 2018 herrera et al 2010 rice et al 2018 wong et al 2010 brentan et al 2018 herrera et al 2010 rice et al 2018 wong et al 2010 water demand forecast can be divided into three categories according to different time horizons of the forecast donkor et al 2014 guo et al 2018 tiwari and adamowski 2013 gardiner and herrington 1986 long term forecast 20 30 years medium and long term forecast 1 10 years and short term forecast minutes hours days weeks the smart water platform uses the instrumentation interconnectedness and intelligence to effectively connect the water infrastructure to form a modern smart water distribution system mswds one manifestation of the wisdom of mswds is the real time detection and alarm of anomalies in a water distribution system for example using the residual relationship between the forecasted value and the monitored value to solve the hot issues of smart water affairs such as leakage and pipe burst zhou et al 2019 if the difference between these two values exceeds a certain threshold the system will issue alarm for anomaly this requires that mswds can realize real time forecast of water distribution state and the forecast accuracy is adequately high water demand is an important monitoring indicator in mswds when the observed value deviates significantly from the forecasted water demand it helps to identify the occurrence of leakage and other anomalies herrera et al 2010 along with the rapid development of the smart water platform the demand for accurate short term water demand forecasts is ever increasing this research proposes an approach for obtaining short term water demand forecast with high accuracy according to the existing research on short term water demand forecasting the research methods can be divided into linear mathematical methods and machine learning methods as mentioned above water demand is usually correlated with climate factors and social factors brentan et al 2018 ashu et al 2001 and howe and linaweaver 1967 tried to establish the relationship between each parameter and water demand by using a linear function method shvartser et al 1993 combined the pattern recognition technique with autoregressive integrated moving average arima to forecast water demand of israel braun et al 2014 proposed a forecasting model which combined an autoregressive approach with a regression model respecting additional parameters caiado 2010 proposed a double seasonal arima model to forecast daily water demand in spain wong et al 2010 analyzed a variety of factors that affect water demand and used multivariate linear regression mlr to achieve water demand forecast however the linear relationship usually cannot represent the complex relationships in between which results in inaccuracy in short term water demand forecasts braun et al 2014 wong et al 2010 with the development of science and technology computers can process a large amount of data with high efficiency thus data mining technology centered on machine learning has been rapidly improved alvisi et al 2007 arandia et al 2016 and brentan et al 2017 pointed out that the use of data driven methods to achieve short term water demand forecasts can effectively reduce energy costs making it a popular research area machine learning such as artificial neural network ann support vector regression svr random forest rf gradient boosting machine gbm were also used to obtain short term water demand forecasts a da mowski et al 2012 antunes et al 2018 pandey et al 2020 tiwari and adamowski 2015 xenochristou et al 2020 xenochristou and kapelan 2020 many researchers salloom et al 2019 have proved that these nonlinear machine learning models have made great improvement in water demand forecasting compared with the linear mathematical statistics methods but they still cannot meet the accuracy requirements under the development of smart water platform deep learning is a specific subfield of machine learning it has been widely used in many fields such as face recognition natural language processing and visual object detection glorot et al 2011 gouws 2012 schmidhuber 2015 yi et al 2014 compared with the traditional machine learning methods its advantage lies in the ability to extract input features at a deeper level which enables more complex problems to be solved historical water demand data implicitly include the influence of factors such as temperature humidity holidays and so on deep learning method can mine the implicit features in historical data well to a certain extent these factors do not need to be used as explicit input to the model guo et al 2018 successfully used a deep learning method gated recurrent unit network grun to obtain short term water demand forecasts compared with traditional machine learning methods grun obtained higher forecast accuracy mu et al 2020 studied the effect of the long short term memory lstm model in forecasting the water demand data at the inflection points i e abrupt changes relative to their corresponding neighboring and data with a relatively high uncertainty level hu et al 2019 used convolutional neural network cnn and bidirectional lstm bi lstm to forecast the daily water demand by considering temperature and other factors salloom et al 2021a salloom et al 2021 proposed a deep learning based model and a method to reduce the forecast error at extreme points and through the establishment of new features they solved the cumulative error problem in multi step forecast through the effort of many researchers deep learning has been steadily promoted in the application of water demand forecasting but there are still some issues that hinder the estimation accuracy of the deep learning based methods especially for short term water demand forecasting e g at a minute level 1 researchers have continued the relevant methods in machine learning by manually extracting features as input to the deep learning model for example guo et al 2018 manually extracted distant near and recent data as model input which compressed the data dimension to a certain extent and improved the efficiency of the model regardless of the tedious procedure manual feature extraction can result in loss of information and therefore impact model performance 2 for the forecast of minute level water demand the input of the model is often only the historical monitoring data of the water demand the quality of the input data largely affects the model performance however the importance of data cleaning is underestimated 3 the effectiveness of the water demand forecast model based on deep learning depends on the training effect of the model the existing researches focus more on the forecast accuracy of the model and ignore the factors that affect the training effect such as the length of training dataset training strategy and so on the length of training dataset and the input selection determine the extent to which the model can extract data features and affects the efficiency of training and the existing deep learning training strategies mostly adopt the fixed epoch training method which is simple and easy to implement however it is not realistic to set perfect training epochs for each training round because the optimal training effect may not be achieved after the set training epochs the optimal training effect may be achieved or not achieved within the training epochs 4 the input and parameters of the water demand forecast model are not static different inputs and the configuration of different parameters of the model will affect the whole process from model establishment to application therefore when establishing a water demand forecast model for specific data it is necessary to flexibly explore the characteristics of the data to configurate appropriate model inputs and model parameters for example in this research two days water demand data is used as the input of the model and the training dataset length of the model is configured to be 60 days in these aspects there are still research gaps in order to advance the progress of deep learning technology in water demand forecasting this research aims to 1 explore a method that can automatically extract features of water demand data 2 to explore a method for data cleaning and 3 to analyze the impact of length of training dataset training strategy and training success rate on model performance in this work s h esd method was used for data cleaning a model termed conv1d gru is proposes to demonstrate the capability of the proposed model the results are compared with those from grun and ann models 2 research data and equipment the research site is located in huzhou which is a prefecture level city in china with a population of approximately 3 37 million inhabitants and the total water demands are approximately 90 million m3 per year including 32 million m3 of residential water demand and 30 million m3 of commercial and industrial water demand the data in this research comes from sd water plant which mainly distribute water for a certain area in huzhou the data spans from january 1st 2017 to may 31st 2019 with a sampling interval of 15 min this research focuses on urban water demand forecasting so the data covers domestic water demand commercial water demand and industrial water demand in the area this research analyzes and extracts the features of the overall water demand data to forecast the future water demand of the region in other words this research is a forecast of the overall water demand of the region under regular scheduling therefore the forecast of such as industrial and commercial water demand with irregular change pattern is limited in this research the dataset contains abnormal data such as missing values too large or too small data values these abnormal values are mainly caused by sensor failures network interruptions or fluctuations the proportion of abnormal data in this dataset is about 5 the dataset contains 84 576 observations and table 1 shows the characteristics of this dataset with the resolution of 15 min after cleaning in this research s h esd method was implemented using python and the conv1d gru model grun model and ann model were implemented using keras keras is a deep learning api written in python running with tensorflow cntk or theano as the backend tensorflow backend was employed in this research 3 methodology 3 1 flowchart fig 1 shows the overall flow chart of this research the data used in the models comes from the monitoring data of a water plant as described in section 2 data cleaning and data processing of raw data are described in section 3 2 and section 3 3 s h esd method is used for data cleaning which is a method of mathematical statistic the random seed data division method ensures the efficient use of data and verifies the impact of different training dataset lengths on forecasting and the sliding window method is used for sample processing to construct the data of supervised learning that can be used by the deep learning models after that a deep learning forecast model is established that uses a one dimensional convolutional neural network to automatically extract features described in section 3 4 in addition the advanced grun model based on manual feature extraction and the widely used ann model are used to evaluate performance of the models one step forecast of water demand is realized by all three models different training strategies are used in the training process described in section 3 5 finally the performance of data cleaning forecasting stability and training strategies are evaluated in the test process the evaluation results and analysis are described in section 4 the indicators of rmse mae mape and nse are used in evaluation process described in section 3 5 2 3 2 data cleaning real time monitoring data often contains a lot of abnormal values many models often have simple assumptions about the scenarios that occur and therefore it requires experts to select the right detector for a given scenario and then to fine tune the parameters of the detector based on the training data chen et al 2013 he et al 2012 lee et al 2012 abnormal values can drastically impact the results of data analysis and modeling the sources of these abnormal values are complex in the mswds water demand data often come from the supervisory control and data acquisition scada system the data accuracy depends on the goodness of the sensors when they fail network interruption and fluctuation occur in the scada system monitoring data that are not in accordance with the actual condition of the system are then obtained e g monitoring values that are too large too small or invalid generally for small datasets abnormal values can be handled manually but for large datasets the possibility of identifying abnormal values manually becomes negligible thus we propose a method to identify abnormal values automatically 3 2 1 s h esd method generally speaking water distribution data have the characteristics of tendency seasonality and randomness normally the data are decomposed to eliminate the trend and seasonal effects the seasonal decomposition of time series by loess stl is a time series decomposition technique cleveland and cleveland 1990 which decomposes original time series o into three parts the trend component t seasonal component s and residual component r as a result the residual will be a stationary time series the residual is defined as eq 1 1 r o s t the s h esd can solve the problem of abnormal values on the residual component rosner 1983 this method assumes that the data is normally distributed it is an extension of grubbs method grubbs 1969 calculate k statistical values in turn the corresponding t distribution critical value is updated synchronously and the first k maximum minimum values are judged successively as abnormal values however the residual component obtained using the original stl technique might contain spurious anomalies therefore the stl method in s h esd method is improved by replacing the trend component with the median value and the new residual component is defined as eq 2 2 r o s m e d i a n o the statistics of first k maximum minimum values in the residual component are calculated as eq 3 3 c k max k x k m e d i a n x mad mad m e d i a n r i m e d i a n r where x k is the kth maximum minimum value after the data is arranged in order and the value of k can reach up to 49 9 of the total number of samples the calculated statistics are compared with the test critical value which is calculated as eq 4 4 λ k n k t p n k 1 n k 1 t p n k 1 2 n k 1 where n is the total number of samples t p n k 1 is the critical value of the t distribution when the degree of freedom is n k 1 and the significance level is p if c k λ k the value x k is judged as an abnormal value and it is removed from the dataset the critical value is recalculated from the remaining data until k epochs is reached 3 2 2 z score method z score thompson 2006 is a parameter anomaly detection method in one dimensional or low dimensional feature space it assumes that the data obeys a gaussian distribution and the outliers are data points at the tail of the distribution it can detect and repair abnormal values on the original data therefore in order to evaluate the impact of different cleaning methods on water demand forecast z score is also applied in this research the data are normalized by the eq 5 5 z i x i μ δ where μ and σ are the average and standard deviation of the dataset respectively then a threshold z thr is set if z i z thr the data point is considered an abnormal value z thr is generally set to 2 5 3 0 3 5 specifically z thr 3 0 was used in this research 3 3 data processing 3 3 1 method of dataset division a small amount of training data will make the model unable to learn the true characteristics of the data whereas excessive training data will make the training time too long this research explored the appropriate length of the training dataset for water demand forecast that is needed to achieve satisfactory accuracy based on deep learning in order to verify the robustness of the model and make full use of existing data this research did not simply divide the historical data into training dataset validation dataset and test dataset as fig 2 shown a random sampling method is adopted in this research first a random seed was generated which determined a certain time point in the data then the data of the 6 days after this time point was used as the validation dataset and the test dataset 3 days for the validation dataset and 3 days for the test dataset after the data of 7 30 60 90 120 180 365 days before and include this time point were used as the training dataset by the random seed respectively to verify the effect of different training dataset lengths on the same validation and test dataset finally such random seeds were generated 10 times so that the selection of data covered most of the historical data this sampling method can efficiently use the historical data and effectively evaluate the model in terms of forecast the strategy proposed in the section 3 3 2 is adopted taking the time point to be forecasted as the benchmark the data that two days before the time point to be forecasted were used as the model input to forecast the water demand 3 3 2 sample processing when training a deep learning model data cannot be directly used as the input it s the key to train deep learning models by using the supervised learning method to build the input and output relationship of data bandara et al 2020 used a sliding window scheme to feed the inputs and create the outputs for the stacking model and the sequence to sequence model with the dense layer it s an effective data augmentation mechanism as fig 3 shown in this way the deep learning model simultaneously produces a window of outputs corresponding to the time steps that immediately follow the fed inputs when accepting a window of inputs smyl 2016 the model accepts an input window of the same size as the previous step at the next consecutive time step shifted forward by one as mentioned above the data sampling interval is 15 min so 96 data can be obtained every day the forecasting horizon time is also 15 min in this research in other words this research is one step forecast of water demand then let the length of the whole data sequence be l the size of the input window be a the size of the output window be b and the size of the sliding window be t t a b water demand data is a seasonal timeseries data the most obvious is that the water demand data changes seasonally in days based on the above reasons and combined with the change pattern of water demand data the time step included in the input of the deep learning model is at least more than one change seasonality to ensure that the model can learn the seasonal change pattern of the data then the model takes the previous two days data 192 data as input for each step of forecasting to forecast the next data so a 192 b 1 t 193 by shifting the sliding window forward one by one the data sequence is broken down into blocks of size a b 193 forming the input output combination so input dataset and output dataset can be got and the number of samples in the input dataset and output data is l a b 1 l 191 and when the model continues to see new inputs the importance of the information from the distant time step tends to diminish and the trend change of the sequence is more focused on the recent time steps hewamalage et al 2021 3 4 model establishment after data processing a deep learning model is needed to establish a mapping between input and output to achieve water demand forecasting the accuracy of water demand forecasting mainly depends on the model structure and the parameter configuration of the model previous researches guo et al 2018 mu et al 2020 odan and reis 2012 often extract features during the data processing stage to ensure that the input data of the sample contains mapping features to output data so that the model can learn better forecasting parameters during model training in the model proposed by this research one dimensional convolutional neural layers conv1d are used to automatically extract data features and the extracted features are further used to achieve one step forecasting of water demand through gated recurrent unit gru layers and dense layers 3 4 1 one dimensional convolutional conv1d the convolutional neural network cnn is a feedforward neural network inspired by hubel and wiesel 1968 on the visual system in the cat brain cun et al 1990 and fukushima 1980 proposed and established the modern cnn framework which played a crucial role in the subsequent development of cnns traditional cnn takes two dimensional image data as input without complicated pre processing when dealing with this data type cnn usually uses two dimensional convolution kernel cnn maps the original image data to the feature space of the hidden layer through operations such as convolutional layers and pooling layers thereby avoiding the need to extract features explicitly then a fully connected layer is used at the end of the network to create the final non linear combination of features thus cnn is used for prediction and so on the advantage of cnn is that it can automatically extract features from complex data to avoid omissions and inaccuracies caused by manual feature extraction so as to achieve the tasks such as prediction and classification more accurately in the water distribution monitoring data the data transmitted by the sensors are all one dimensional time series data in order to extract data features more quickly and accurately for short term water demand forecast in this paper we introduce the one dimensional convolutional layer to process the input data the one dimensional convolutional layer is like the two dimensional convolutional layer the difference is that the one dimensional convolutional layer performs the convolution calculation of the one dimensional data by the one dimensional convolution kernel the convolutional neural network mainly includes three characteristics local perception spatial arrangement and parameter sharing cheng et al 2019 fig 4 shows the one dimensional convolution operation the convolution process involves multiplying each element in the convolution kernel with a corresponding element in a subregion of the input data and adding the products to obtain an element in the feature map teng et al 2021 after each calculation the sub region will move according to a specific step i e stride 1 until all the elements in the input data have been calculated finally the features of the input data through the one dimensional convolution operation can be obtained in addition the number of features obtained through convolution operations the size of output of feature map may also be different due to different convolution operations i e padding 0 1 2 during the convolution operation padding determines the start and end position of the convolution kernel in the input data the expressions of the one dimensional convolution operation are shown in eq 6 and eq 7 6 x out f c o n v 1 d w x in where x out is the output of the convolution operation x in is the input of the convolution operation f is the activation function and f x max 0 x conv1d is the one dimensional convolution operation w is the weight of the convolution kernel 7 s w out s w in 2 p a d d i n g s f stride 1 where s w out is the size of output of feature map s w in is the size of input feature map padding is the variable that determines the start and end positions of the convolution kernel and is set to be 1 in this research s f is the size of convolution kernel stride is the step that the convolution kernel traverses the input compared to two dimensional cnn one dimensional cnn is easier to train krizhevsky et al 2017 using fewer back propagation epochs to extract valid features and thus performs subsequent tasks faster 3 4 2 gated recurrent unit gru recurrent neural network rnn elman 1990 is a type of neural network dedicated to processing time series data it is proposed based on the viewpoint that human cognition is based on the past experience and memory it is different from other neural networks in that it not only considers the input of the previous moment but also gives the network a memory function of the previous moment however gradient explosion and vanishing are easy to occur in the process of training rnn resulting in gradients that cannot be transmitted in longer sequences during training which causes rnn to fail to detect the effects of long sequences to solve this problem gated recurrent unit gru was proposed its special control learning mechanism solves the gradient problem of rnn making it the most suitable sequence processing network structure at present gru is a kind of recurrent neural network cho et al 2014 it is proposed to solve the problems of long term memory and gradients in back propagation the parameters of gru are controlled by the forget gate and update gate in addition a linear dependency is added between the current state of the network h t and the state of the network at the previous time step h t 1 to solve the problem of gradient vanishing and explosion the update gate and reset gate are represented by z and r respectively and the principle of gru can be explained by eq 8 eq 11 8 z t δ g u z h t 1 w z x t b z 9 r t δ g u r h t 1 w r x r b r 10 h δ h u c r t h t 1 w c x t b c 11 h t 1 z t h t z t h t 1 where x t is the input vector u w and b are parameters for weights and bias δ g is the sigmoid function the values of z and r are both in the range 0 to 1 the update gate is used to control the retention of the historical state h t 1 and the candidate state of the current time step h t in the output state at the current time step so as to obtain the output of the final current time step h t the reset gate determines the degree of dependence of the candidate state at the current time step h t on the network state at the previous time step h t 1 the current candidate state and network output are shown as eq 10 and eq 11 3 4 3 conv1d gru model design this research focuses on the precise forecast of short term water demand thereby laying a foundation for the use of the residual relationship between the forecasted value and the monitored value to solve the hot issues of smart water affairs such as leakage and pipe burst in this research conv1d is used to automatically extract features from data to obtain local dependencies reflected in the time series then gru is used to extract the time dependence of the above mentioned features to achieve accurate forecast of water demand the conv1d gru model is shown in fig 5 the model takes two consecutive days of monitoring as input in general the model s conv1d layer captures the local dependency of the data while the gru layer captures the long term macroscopic dependency of the data specifically the model divides the input data into three parts data of the first day data of the second day and the overall data and extracts features from the three parts respectively when capturing short term local dependencies the conv1d layers with 64 filters and the length of 1 are used to enhance the data features to make up for the lack of input data features then the conv1d layers with different length are used to extract the features of different time scales on this basis the conv1d layers with 32 16 and 8 filters are used to refine the data features to obtain multi dimensional data representation finally the features extracted by the conv1d layers are used as the input of the gru layers when capturing long term macroscopic dependencies the gru layers with different output space dimensionality are used for feature extraction parameters of cw1 cw2 gn gd and dn are described in section 3 4 4 3 4 4 hyper parameter configuration whether a good forecast effect can be achieved depends not only on the establishment of the model but also on the configuration of hyper parameters a proper hyper parameter configuration enables the model to learn the deep characteristics of the data so as to achieve good forecast effect there are six hyper parameters to be configured in the conv1d gru model 1 the length of the conv1d window cw 2 the number of the gru layers gn 3 the dimensionality of the gru output space gd 4 the number of the dense layers dn 5 the learning rate of the model lr 6 the early stopping threshold of the training est the parameter of est is described in section 3 5 in order to find the optimal hyper parameter configuration we used random search and cross validation methods to optimize parameters random search is a more efficient hyper parameter optimization method than the traditional grid search and manual search bergstra and bengio 2012 in the search process for the parameter whose search range is continuously distributed random sampling is performed according to the given distribution for the parameter whose search range is a discrete distribution e g given as an array it performs equal probability sampling this method combined with cross validation can greatly reduce the time of hyper parameter optimization at the expense of a little accuracy thereby realizing the hyper parameter optimization of the deep learning model the hyper parameter search range and optimal configuration of the conv1d gru model are shown in table 2 it is worth noting that the number of units in the dense layer is in a 2dn 1 relationship with the search results of dn while the number of units in the dense layer is decreasing from top to bottom guo et al 2018 after the deep learning model is constructed by the above methods the model can be trained an applied after adopting appropriate training strategies and evaluation methods 3 5 model training and evaluating in addition to the configuration of hyper parameters the training strategy also affects the effect of model forecasting in this research the conv1d gru model grun model and ann model were trained on the same dataset the parameter configuration and training strategy of the conv1d gru model are described in detail in this paper which is also applicable to the ann model for the parameter configuration and training strategy of grun model please refer to guo et al 2018 3 5 1 training strategy how to avoid the neural network in the training process from over fitting and under fitting is a key issue in deep learning common approaches include using the dropout strategy regularization strategy and configuring the appropriate epochs dahl et al 2013 schölkopf and bernhard 2003 these strategies need to be set before the training starts but the training process is uncertain and random besides the changes in monitoring data in the mswds are also uncertain thus it is difficult to ensure that these strategies are consistent with each training process and for all training datasets in this research the early stop strategy was used for model training it is an adaptive training strategy the total epochs of model training were set to a large value e g 10000 and the model training was judged whether to be terminated by monitoring the effect of the model on the validation dataset when the effect of the model on the validation dataset is no longer improved for epochs of est times the model training is terminated and the optimal neural network parameters before the termination of the training are saved 3 5 2 performance indicators of forecast models the performance indicators used to assess model performance in this research are mean absolute error mae mean absolute percentage error mape root mean squared error rmse and nash sutcliffe model efficiency nse which are calculated according to eq 12 eq 15 respectively 12 mae 1 n i 1 n y i y i 13 mape 100 n i 1 n y i y i y i 14 rmse 1 n i 1 n y i y i 15 nse 1 i 1 n y i y i i 1 n y i y i where y i is the observed value y i is the forecasted value y i is the mean of the observed value mae and rmse are used to reflect the actual situation of the forecasted value error which range is 0 the larger the error the larger the value the range of mape is 0 the value of 0 indicates a perfect model nse is generally used to evaluate model fitting effect and stability the closer the value is to 1 the more stable the model is 4 results and discussion 4 1 procedures of experiments 4 1 1 procedure for evaluating of data cleaning in order to evaluate the performance of different data cleaning methods the following procedure was performed 1 randomly select five pieces of data with length of 7 days 2 the s h esd method and the z score method were used to clean the above dataset 3 the cleaned data was used to the conv1d gru model grun model and ann model respectively and each group of data was successfully trained for 10 times successful training refers to that the model after training has practical value specifically the nse indicator is used when the indicator is greater than 0 in this research the training is considered successful therefore a total of 5 10 50 successful experiment results were obtained specific results analysis can be seen in section 4 2 4 1 2 procedure for evaluating the effectiveness of different models in order to evaluate the impact of different models different lengths of training dataset and different training strategies on water demand forecasting the following procedure was performed 1 10 groups of data were randomly selected using the method described in the section 3 6 1 each group contains 7 datasets in which the length of the training dataset is 7 30 60 90 120 180 and 365 days 2 the above data was used to train the conv1d gru model grun model and ann model respectively and each set of data was successfully trained for 10 times therefore a total of 7 7 different lengths of training dataset 10 10 sets of data 10 10 successful training 700 successful experiment results were obtained 3 the experimental results of dimensions with different training dataset lengths and dimensions with different datasets were analyzed on average to explore the influence of different datasets and different lengths of training dataset on the forecast effect of water demand specific results analysis can be seen in section 4 3 and section 4 4 4 once the optimal length of training set has been determined the forecast effects of the three models in 10 successful experiments were analyzed to explore the stability of the forecast effects of different models specific results analysis can be seen in section 4 5 5 in addition the training success rate of different models on the dataset and the impact of different training strategies were also analyzed specific results analysis can be seen in section 4 6 4 2 performance of s h esd method this section mainly discusses the impact of using different data cleaning methods on water demand forecasting the length of training dataset is selected to be 7 days mainly considering the following aspects on the on hand this section mainly studies different data cleaning methods on the other hand the training dataset length of 7 days has basically covered a cycle of water demand change patterns and the model can be trained efficiently the specific methods and procedure can be seen in section 3 2 and section 4 1 1 fig 6 shows the processing effect of the two data preprocessing methods on five training datasets with the length of 7 days it can be seen from the figure that the overall data preprocessing effect of the s h esd method was better than that of the z score method regardless of whether the data is single point abnormality continuous abnormality or missing the data cleaned by the s h esd method is closer to the performance of the normal water use mode than that by z score method in order to further explore the impact of different preprocessing methods on water demand forecast three models were used to test on the datasets in fig 6 and the test results are shown in fig 7 to eliminate the contingency of experiments each point in the figure was the average of 10 successful experiments it can be seen that for the same model the forecast effect based on the data preprocessed by the s h esd method was better than that on the z score method at the same time under the same data cleaning method the forecast effect of conv1d gru model was better than those of grun model and ann model as shown in table 3 the conv1d gru model performed the best when using the data preprocessed by the s h esd method where the average values of the four indicators rmse mae mape nse for the five datasets were 94 10 61 67 4 38 and 0 942 respectively the s h esd method is better than the z score method in water demand forecasting in addition it can be preliminarily seen that the water demand forecast effect of the conv1d gru model with automatic feature extraction is better than those of the grun model and ann model 4 3 performance of different datasets in order to compare the overall forecast effects of different models the forecast effects on different training datasets were tested as shown in fig 8 the seeds represent different datasets selected and the specific methods and procedure can be seen in section 3 2 and section 4 1 2 the training datasets were preprocessed by the s h esd method each bar in the figure represents the average of the forecast effects with different training dataset lengths it can be seen from the figure that on average the forecast effects of conv1d gru model were better than those of grun and ann models and as shown in table 4 in terms of the mape indicator the average mape values of the three models conv1d gru grun ann are 2 498 3 243 and 4 853 respectively this indicates that in general whatever training dataset is used the conv1d gru model that performs feature extraction automatically can learn the latent features in historical data better and has wide application perspective in water demand forecast 4 4 performance of different lengths of training dataset the length of the training dataset not only affects the speed of training but also affects the forecast effect of the model fig 9 shows the forecast effects of the three models using 7 different training dataset lengths each point in the figure represents the average forecast effect of 7 training datasets after 10 trainings as can be seen from the figure with different lengths of training dataset the forecast effects of conv1d gru and grun models were significantly better than that of the ann model comparing the two deep learning models a similar trend was found when analyzing the forecast effects of both models the effect was increasing at first and then decreasing when the length of training dataset was 60 days the forecast effects of the conv1d gru and the grun models were the best and the average values of the mape indicator were 2 064 and 2 451 respectively it is worth mentioning that when the length of training dataset was less than 60 days the forecast effect of the grun model was far inferior to that of the conv1d gru model and when the length of training dataset was 7 days its forecast effect was even inferior to the ann model this is due to the fact that grun model adopts the manual feature extraction strategy while conv1d gru model adopts the automatic feature extraction strategy when the length of the training dataset is short the manually extracted feature cannot reflect the real pattern of water demand data whereas the automatic feature extraction strategy used by conv1d can effectively solve the problem it can be seen from the figure that even when the length of the training dataset is 7 days the conv1d gru model can still have a relatively excellent forecast effect when the length of training dataset reaches 365 days the forecast effect of the conv1d gru model appears to be slightly worse than that of grun model which is also due to the feature extraction strategy used when the length of the training dataset is long enough the features automatically extracted by conv1d contain too much redundant information which results in a poor forecast effect in general after repeating the experiment several times it can be seen that the conv1d gru model using the automatic feature extraction strategy can further improve the forecast effect of the manual feature extraction model and in terms of water demand forecast the forecast effect can be further improved by adopting an appropriate training dataset length 4 5 stability analysis using the optimal training dataset length 60 days the training stability and forecast stability of the three models will also be different using the same training datasets which will affect the accuracy and reliability of the forecast fig 10 shows the box plots of the three models successfully trained 10 times on 10 training datasets it can be seen that the forecast effects of conv1d gru and grun models were far better than ann model taking the mape indicator as an example the best results of the conv1d gru grun and ann models were 1 677 1 710 2 646 respectively although the optimal forecast effects that the three models can achieve are not much different the three models have a big difference in the worst forecast effects in the worst case the mape indicator test results of the three models were 2 606 4 732 11 696 respectively this indicates that to some extent the conv1d gru model is more robust in water demand forecasting the indicator of nse can evaluate the forecast stability of the model the average nse values of the three models conv1d gru grun ann after 100 rounds of successful trainings 10 training datasets were trained 10 times respectively were 0 963 0 955 0 864 respectively this indicates that for different training datasets with the optimal length of training dataset the forecast stability of the conv1d gru model is better than those of the grun and ann models furthermore the standard deviation of the nse values of the three model training can reflect the stability of the model training the average standard deviation of the nse values of the three models were 0 015 0 019 0 077 respectively this further indicates that the conv1d gru model is more stable during the training in addition the successful training rates of the conv1d gru and grun models were analyzed on different training datasets the two models were trained 50 times for each of the 10 training datasets fig 11 shows the comparison of the two models to be forecasted it can be seen from the figure that whatever training datasets were used the successful training rates of the conv1d gru model were significantly higher than that of the grun model this also demonstrates the stability of the conv1d gru model from another perspective compared with the manual feature extraction the automatic feature extraction facilitated by conv1d can make better use of historical data so as to establish a better relationship between the historical water demand data and the water demand data to be forecasted and to find the optimal gradient descent direction in the process of training as a result the success rate of the training is improved in summary the automatic feature extraction facilitated by conv1d makes the features diversified thereby ensuring that the model is more stable during the training and forecasting 4 6 performance of the training strategy of adaptive early stopping in order to evaluate the effects of different training strategies on water demand forecasting the early stopping training strategy and the fixed epoch training strategy were tested and the methods can be seen in section 3 5 1 table 5 shows the comparison of the mapes of the water demand forecasts obtained from the conv1d gru model using the two training methods on different training datasets with the optimal training length the number of epochs used in the fixed epoch training strategy was 25 it can be seen from the table that the forecast deviation of the model using the fixed epoch strategy is greater than that using the early stopping training strategy the average value of the mape indicator of the model using the fixed epoch training strategy was 2 416 and the average value of the indicator of the model using the early stopping training strategy was 2 079 although the number of fixed epoch is obtained from many experiments there is no guarantee that after the last training epoch the model can obtain the optimal parameter configuration whereas the early stopping training strategy can adaptively adjust the training epochs and save the optimal parameter configuration during the training process thereby ensuring the forecast accuracy of the model therefore the early stopping training strategy can further improve the forecast effect of the model 5 conclusions in order to obtain short term water demand forecasts with adequate accuracy we propose a deep learning model called conv1d gru compared with the state of the art grun model the conv1d gru model uses conv1d to automatically extract the features of water demand data thereby avoiding the necessity of manual feature extraction improving the intelligence of feature extraction and ensuring the diversity of feature in this research the impact of data cleaning strategies used on the accuracy of water demand forecasting is discussed for the first time and the s h esd method is used to preprocess the water demand data the experimental results show that the s h esd method is more effective than the z score method in removing various abnormalities in the data we also explore the effect of the length of training dataset on model forecasting when the length of the training dataset is short the manually extracted feature cannot reflect the real pattern of water demand data whereas the automatic feature extraction strategy can effectively solve the problem and when the length of the training dataset is long enough the features automatically extracted contain redundant information which leads to a decline in the forecast effect even so the forecast effect is almost same as the grun model experimental results show that when the length of the training dataset is 60 days in this research the comprehensive forecast effect of the model is the best and the average forecast errors of the conv1d gru and grun models are 2 064 and 2 451 respectively moreover with the optimal length of training dataset we explore the stability on model forecasting experimental results show that the average nse values of the conv1d gru model gurn model and ann model are 0 963 0 955 0 864 respectively and the average standard deviation of the nse values of the above models are 0 015 0 019 0 077 respectively which indicate that the stability in terms of the forecast and training of the conv1d gru model are better than that of the grun model and ann model and the average training success rate of the conv1d gru model and grun model are 94 8 and 78 4 respectively in addition an early stopping strategy that allows the model to obtain adaptively a better parameter configuration is proposed in this research which improves the forecast accuracy of the model further the average forecast errors of the conv1d gru model that employs the early stopping and fixed epoch strategies are 2 079 and 2 416 respectively nevertheless this research is based on a one step forecast of water demand and does not involve multi step forecasts of water demand therefore the effectiveness of the model and strategies mentioned in this research for the multi step forecasting of water demand needs to be further explored credit authorship contribution statement lei chen conceptualization methodology software validation formal analysis writing original draft writing review editing hexiang yan validation formal analysis investigation jieru yan writing review editing data curation jiaying wang data curation funding acquisition tao tao resources data curation supervision project administration funding acquisition kunlun xin resources supervision funding acquisition shuping li resources supervision zhengheng pu visualization jian qiu funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national key research and development plan grant 2019yfc0408801 the national natural science foundation of china nsfc grant 51978494 the major science and technology program for water pollution control and treatment grant 2017zx07201001 and the alibaba innovative research air 
3664,rainfall across mountainous areas is vital for the water supply and ecosystem services of arid watersheds rain gauges are the most common method to measure rainfall but these are sparse in mountainous areas satellite and reanalysis products can provide rainfall information over a large area but often have large uncertainty in high elevation environments a recently developed bottom up approach sm2rain soil moisture to rain estimates rainfall from soil moisture dynamics and provides a novel method to estimate rainfall however the reliability and accuracy of this method in high altitude mountainous areas are currently not well understood this study evaluates the sm2rain method under different environmental conditions based on data from 9 in situ soil moisture and rainfall observation stations in the qilian mountains in northwest china subsequently we compare the rsim rainfall estimated using the sm2rain in situ the global sm2rain rainfall product sm2rain ascat and the reanalysis rainfall product china meteorological forcing dataset cmfd with the in situ rainfall observations results show that the performance of sm2rain decreases with increasing elevation sm2rain performs well in alpine meadows but underestimates rainfall in forestland due to strong interception and overestimates rainfall in farmland due to irrigation meanwhile sm2rain has the potential to evaluate the interception capacity of forestland and the irrigation of farmland the sm2rain ascat and cmfd have similar performances in estimating daily rainfall in the study area calibration of sm2rain using high spatio temporal resolution soil moisture products and an advanced bias correction method can significantly improve rainfall estimation performance in data scarce mountainous areas keywords mountainous areas rainfall estimation soil moisture sm2rain 1 introduction rainfall is a vital driving factor of the hydrological cycle and accurately quantifying the amount and distribution of rainfall plays a critical role in hydrological research flood forecasting ecological assessments agricultural production and drought detection michaelides et al 2009 vrochidou et al 2013 apurv et al 2015 song et al 2020b yuan et al 2021 methods to capture rainfall data include ground observation stations remote sensing rainfall products and reanalysis datasets michaelides et al 2009 brocca et al 2015 seo et al 2020 yuan et al 2020 with rainfall gauges and satellite based measurements being the main methods for rainfall acquisition rossi et al 2017 fereidoon and koch 2018 rainfall gauges measure rainfall with high accuracy but limited spatial coverage in situ rainfall measurements over a large area are more difficult and sparsely distributed especially in mountainous areas ahrens et al 2006 zhao et al 2015 herrnegger et al 2018 in addition the complex heterogeneity of rainfall in mountainous areas makes rainfall estimation over large areas more challenging yuan and quiring 2017 yu et al 2020 wu et al 2020 satellite products are the key method for large scale rainfall estimation at present rainfall estimating rainfall from satellites is challenging and performs poorly for the complex terrain of mountainous regions yang and luo 2014 lu and yong 2018 wang et al 2019b reanalysis datasets such as the china meteorological forcing dataset cmfd and the fifth generation of atmosphere reanalysis dataset released by the european center for medium term weather forecasting ecmwf era5 brocca et al 2019 xin et al 2021 have been developed and widely used at large spatial scales yang et al 2010 he et al 2020 yang et al 2020b pi et al 2021 however the precision of the reanalysis product relies on multi source data including in situ observations and satellite products which limits the potential applications in data scarce mountainous areas li et al 2020 as such the development of other methods to quantify rainfall in data scarce mountainous areas are urgently needed sm2rain is a method proposed by brocca et al 2013 that uses soil moisture to estimate rainfall this method considers the soil layer to be a natural rain gauge and provides a framework to capture rainfall information over large areas using soil moisture observations brocca et al 2014 the sm2rain method has been assessed and applied worldwide using both in situ and satellite soil moisture data at local and global scales for both in situ measurements and laboratory experiments the sm2rain can reproduce rainfall data well the pearson correlation coefficient r 0 76 0 95 brocca et al 2013 0 75 0 95 brocca et al 2015 0 5 0 97 song et al 2020a the sm2rain has also been applied to estimate global rainfall based on satellite soil moisture products such as the sm2rain cci the european space agency climate change initiative ciabatta et al 2018 and sm2rain ascat the advanced scatterometer brocca et al 2019 results show that sm2rain ascat performs better than the integrated multi satellite retrievals for global precipitation measurement imerg early run version hou et al 2014 and the gauge based global precipitation climatology centre gpcc full data reanalysis version 1 schamm et al 2015 products in data scarce mountainous regions brocca et al 2019 furthermore the data based on sm2rain could have potential applications for early landslide warning systems brunetti et al 2021 and drought monitoring koohi et al 2021 in the data scarce regions however the use of sm2rain ascat in mountainous areas remains challenging primarily due to the uncertainty of sm2rain parameters chiaravalloti et al 2018 brocca et al 2019 muhammad et al 2020 zhang et al 2020a hu and yuan 2021 furthermore sm2rain has hardly been evaluated using large scale in situ observations in mountainous areas with complex topography and landscapes leading to unknown model performance therefore it is critical to evaluate sm2rain in high altitude mountainous areas with variable environmental factors e g landscape and elevation using in situ soil moisture and rainfall observations the objectives of this study are 1 to evaluate the applicability of the sm2rain method for estimating rainfall from the surface 0 10 cm soil moisture in high mountainous areas 2 to analyze the impacts of environmental factors on the performance of sm2rain and 3 to compare and assess the application potential of the rainfall products the simulated rainfall by sm2rain rsim sm2rain ascat and cmfd in high mountainous areas 2 methodology and materials 2 1 study area the study area is in the upper reach of the heihe river basin uhrb which is the second largest inland river basin in china and discharges into a terminal lake the uhrb has an area of 2 7 104 km2 with an altitude ranging between 2000 and 5600 m above sea level masl yao et al 2017 tian et al 2019 su et al 2020 the uhrb has mean annual precipitation ranging from 200 to 700 mm and mean annual temperature varying from 3 1 to 3 6 c luo et al 2016 zhang et al 2016 he et al 2018 the main land cover types in the uhrb are grassland 49 forestland 17 barren land 27 and farmland 3 hu et al 2015 the main soil texture classes are loam sandy loam and silty loam lu et al 2017 the uhrb provides almost all water resources for the entire heihe river basin chen et al 2003 2 2 hydrometeorological observational data the hydrometeorological observation data are mostly from the heihe watershed allied telemetry experimental research hiwater dataset of hydrometeorological observation network liu et al 2011 li et al 2013 liu et al 2018 che et al 2019 was downloaded from the national tibetan plateau third pole environment data center https data tpdc ac cn en a total of 9 hydrometeorological observation stations were used in this study these stations are located in alpine meadows 7 stations farmland wheat 1 station and forestland qinghai spruce 1 station with elevations ranging from 2500 to 4500 masl fig 1 table 1 the information of the selected hydrometeorological observation stations are listed in table 1 the main hydrometeorological variables used in this study include observed rainfall measured by te525m texas electronics at 2 m height and the surface 0 10 cm soil volume water content measured by 5te sensor meter inc usa che et al 2019 the soil moisture and rainfall data of all the stations used in this study are shown in fig s1 the temporal resolution of rainfall and soil moisture observational data is 10 min however such high resolution observation data are difficult to obtain in high mountainous areas therefore the time interval of observation data was aggregated to 1 h to reduce noise and enhance the potential applications of this study gao et al 2019b as the 5te soil moisture is greatly affected by daily soil temperature variation the soil moisture was temperature corrected following kapilaratne and lu 2017 finally the soil moisture data were normalized to the range of 0 1 to estimate rainfall data using sm2rain following brocca et al 2015 in this study soil moisture data during the growing season may to october tian et al 2019 gao et al 2021 were used to avoid the effects of soil freeze thawing 2 3 sm2rain ascat and cmfd data the sm2rain ascat global terrestrial rainfall product was developed from the advanced scatterometer ascat onboard three meteorological operational metop satellites and soil moisture datasets from the sm2rain algorithm brocca et al 2019 the spatial resolution of the sm2rain ascat is 0 125 0 125 and the temporal resolution is 1 day muhammad et al 2020 brocca et al 2019 the sm2rain ascat data are freely available for the period 2007 2020 https zenodo org record 4507133 the cmfd is a high spatio temporal resolution gridded near surface meteorological and environmental dataset which has been widely used in china yang et al 2020b pi et al 2021 this dataset was developed through the fusion of the tropical rainfall measuring mission trmm kummerow et al 2000 global land data assimilation system gldas global energy and water exchanges surface radiation budget gewex srb existing princeton reanalysis data and in situ observational data the weather observation data of the china meteorological administration yang et al 2010 he et al 2020 the horizontal spatial resolution of cmfd is 0 1 and the temporal resolution is 3 h previous research has shown that the cmfd is currently the best product for rainfall estimation in the tibetan plateau wu et al 2019 wu et al 2021 the daily rainfall data of cmfd is used in this study 2 4 sm2rain algorithm the soil water balance equation at a certain depth z can be described as 1 zds t d t p t r t e t g t where s t p t r t e t and g t are soil moisture precipitation surface runoff evapotranspiration and drainage rate deep percolation plus subsurface runoff respectively brocca et al 2013 song et al 2020a z n z where n is the soil porosity z mm is the soil layer depth the rainfall can be estimated as 2 p t r t e t g t z d s t d t to facilitate the calculation the sm2rain algorithm proposes two assumptions 1 whenever it rains the evaporation rate is negligible so the evaporation term e t 0 and 2 all rainfall infiltrates into the soil meaning the surface runoff term r t 0 brocca et al 2013 in the study area previous research found that rainfall is more likely to form infiltration and subsurface runoff due to the strong water conservation function of alpine meadows wang et al 2003 kang et al 2008 wang et al 2009 chen et al 2014 and little rainfall 9 yang et al 2011 1 xiao et al 2020 is directly converted into the surface runoff in alpine meadows little to no surface runoff was observed in the forestland and farmland due to the strong infiltration ability of the forestland and farmland in the study area he et al 2012 therefore the assumptions are valid in our study area the drainage rate can be expressed as famiglietti and wood 1994 3 g t a s t b where a mm d is the saturated hydraulic conductivity b is exponent related to the pore size distribution index famiglietti and wood 1994 brocca et al 2019 finally rainfall can be estimated from 4 p t z d s t d t a s t b therefore three parameters z a and b need to be quantified to drive the sm2rain the study period was divided into the parameter calibration period and the validation period the optimal parameters were determined by optimization using the highest nash sutcliffe value ns between the observed rainfall and the estimated rainfall during the parameter calibration period for each station some data gaps occurred due to the harsh natural environment fig s2 battery or sensor malfunctions and damage by livestock sheep and yaks and rats the data gaps led to different observational periods for each station to derive accurate parameters for each station the calibration period was always longer than the validation period in addition the parameter calibration period included both the driest and wettest years for soil moisture the study period is shown in table 1 2 5 evaluation indicators to analyze the applicability of the sm2rain algorithm and assess the reliability of rainfall estimates in mountainous areas the estimated rainfall datasets rsim sm2rain ascat and cmfd were compared with the observed rainfall from rainfall gauges the nash sutcliffe efficiency ns the root mean square error rmse the pearson correlation coefficient r and percent bias pbias were used to evaluate the performance of the methods which are calculated as follows 5 ns 1 i 1 n ai b i 2 i 1 n ai a 2 6 rmse i 1 n ai b i 2 n 7 r i 1 n ai a bi b i 1 n ai a 2 i 1 n bi b 2 8 pbias 100 i 1 n bi a i i 1 n ai where ai is the observed value and a is the mean of the observed values bi is the estimated value and b is the mean value of the estimated values among these methods the ns represents the overall estimation performance with values ranging from to 1 the ns is close to 1 indicating that the model is accurate and reliable bajracharya et al 2017 the rmse is used to characterize the estimation error where the closer the value is to 0 the better the estimation muhammad et al 2020 the value of r represents the linear correlation between two datasets and ranges from 1 to 1 the pbias represents the deviation between the estimated value and the observed value which is classified into three types underestimation pbias 10 overestimation pbias 10 and nearly equal pbias from 10 to 10 yang and luo 2014 2 6 statistical analysis in this study the one way analysis of variance anova was used to test the differences between the estimated rainfall datasets rsim sm2rain ascat and cmfd and the evaluation indicators all satisfy the assumptions of one way analysis of the variance boxplots were used to show the distribution of the metrics ns rmse r and pbias 3 results 3 1 optimal time step for sm2rain 3 1 1 aggregation intervals of rainfall the sm2rain algorithm can estimate rainfall from soil moisture with different time steps so the optimal value needs to be determined in the study area first different aggregation intervals of rainfall from 1 to 72 h were analyzed using hourly observed soil moisture data at all the stations comparisons of estimated rainfall and observed rainfall are shown in fig 2 a b results indicate that the estimation reliability ns r improves with increasing aggregated time intervals the performance increases quickly with increasing aggregated time intervals from 0 to 12 h then increases slower for intervals of 24 h this trend is similar to previous research brocca et al 2013 these findings show that using estimated rainfall with an aggregation interval from 24 to 72 h has relatively high reliability as daily rainfall data are commonly used in hydrological research the optimal rainfall estimation time step was set as 24 h in this study 3 1 2 time intervals of soil moisture subsequently we analyzed the performance of the daily rainfall estimation using the soil moisture data with different time intervals from 1 to 24 h comparisons of the estimated and observed daily rainfall show that the performance of the daily rainfall estimation decreases with increasing time intervals of the soil moisture data from 1 to 24 h fig 2 c d the soil moisture data with a 1 h time interval had the best performance mean ns 0 71 r 0 86 and the soil moisture data with a 24 h time interval had the worst performance mean ns 0 57 r 0 78 therefore the soil moisture observation data with a 1 h time interval was used to estimate daily rainfall in this study 3 2 assessing the impacts of environmental factors we used surface soil moisture data from 9 hydrometeorological observation stations to estimate rainfall using sm2rain and compared the output with observed rainfall at each station due to data gaps the periods of calibration and validation of each station are different table 1 the performance of sm2rain was evaluated using ns r rmse and pbias and the results are summarized in table 2 and fig 3 the performance of the parameter calibration period is better than that of the parameter validation period table 2 fig 3 the mean ns r and rmse values in the parameter calibration period are 0 71 0 85 and 2 11 mm day respectively in contrast the mean ns r and rmse values in the parameter validation period are 0 54 0 81 and 2 59 mm day respectively this difference is mainly caused by the poor ability ns 0 60 r 0 38 of the sm2rain method to reproduce data from huangzangsi station in the parameter validation period in addition the duration of data used in this study is relatively short which may lead to differences in the parameter calibration and validation period in alpine meadow environments different stations behaved differently the ns decreased from the station with the lowest elevation dayekou station 2735 masl with ns of 0 78 and 0 80 during the calibration and validation period respectively to the station with the highest elevation yakou station 4148 masl with ns of 0 62 and 0 79 during the calibration and validation periods respectively furthermore the sm2rain algorithm had different performances for different landscapes fig 3 in alpine meadows the average ns values reached 0 74 and 0 71 during the calibration and validation period respectively which is better than that of forestland 0 39 and 0 53 and farmland 0 81 and 0 6 the pbias values for most stations are negative showing that the sm2rain underestimated rainfall table 2 fig 3 analyses of the specific performance of the sm2rain for different land cover types are described below 3 2 1 alpine meadows alpine meadows are the main land cover type in the study area zhang et al 2020b in this study the seven observation stations with different elevations were used to analyze the performance of the sm2rain in alpine meadow environments and investigate how the results varied with elevation the results are shown in fig 3 for the same landscape type alpine meadow the performances of the rainfall estimation using sm2rain are different at each station the comparisons of the rsim and the in situ observed rainfall robs of three representative stations with different elevations dayekou 2735 masl arou 3033 masl and dashalong 3739 masl illustrate the variation of the sm2rain performances with variable elevation fig 4 the fitted lines for the scatterplot between the rsim and robs at three stations are located below y x which means the sm2rain algorithm underestimated the rainfall the fitted line of dashalong station is the furthest away from y x with a slope of 0 83 p 0 001 followed by arou with a slope of 0 94 p 0 001 and dayekou with a slope of 0 95 p 0 001 and the ns values of the three stations decreased with the rising elevation 0 79 of dayekou 0 80 of arou and 0 70 of dashalong combined calibration and validation periods in general the performance of dayekou arou huangcaogou mean ns 0 80 and 0 79 in the calibration and validation periods respectively is better than that of e bao dashalong jingyangling and yakou mean ns 0 69 and 0 65 in the calibration and validation periods respectively it is worth noting that the elevation of dayekou arou huangcaogou 3300 masl is lower than that of e bao dashalong jingyangling and yakou station 3300 masl table 1 this result suggests that the performance of rainfall estimation using sm2rain is relatively poor for high elevation 3300 masl areas 3 2 2 farmland for the huangzangsi station where the main crop is wheat the soil moisture and rainfall data from 2013 were used to calculate parameters z a and b the soil moisture data from 2014 were then used in the sm2rain model with these calculated parameters z a and b to estimate rainfall in 2014 a comparison of the estimated rainfall rsim and the observed rainfall robs is shown in fig 3 the sm2rain model reliability at the huangzangsi station is relatively good in the calibration period ns 0 81 r 0 90 rmse 1 42 mm day and pbias 12 94 but worse in the validation period ns 0 6 r 0 38 rmse 4 46 mm day and pbias 25 7 3 2 3 forestland qinghai spruce is the typical forest type in the qilian mountains liu et al 2021 the surface soil moisture and rainfall above the canopy data from 2010 to 2011 at guantan station where qinghai spruce is the main vegetation was used to test the sm2rain method the year 2011 was used as the parameter calibration period and 2010 was used as the validation period the performances of the sm2rain during the calibration period ns 0 39 r 0 73 rmse 2 47 mm day and pbias 63 25 and validation period ns 0 53 r 0 78 rmse 2 08 mm day and pbias 56 68 are relatively low in addition the values of pbias indicate the sm2rain grossly underestimates the rainfall 3 3 comparison of different rainfall products to evaluate the potential applications of rainfall products based on the sm2rain algorithm in mountainous areas we compared the rsim sm2rain ascat and cmfd with the observed rainfall robs combing the calibration and validation period table 3 results are shown in table 3 and fig 5 the average values of ns and r between the rsim and robs can reach 0 70 and 0 85 respectively table 3 however they are only 0 20 and 0 50 for the sm2rain ascat and 0 15 and 0 55 for cmfd table 3 results of anova in fig 5 indicate that there are significant differences between the rsim and both the sm2rain ascat and cmfd rainfall products however there is a similar performance between the sm2rain ascat and cmfd considering that the cmfd is currently the best product for rainfall estimation in the tibetan plateau wu et al 2019 wu et al 2021 it is reasonable to conclude that the sm2rain ascat has greater application potential in high mountainous areas in addition there is a significant difference between rsim and sm2rain ascat rainfall data which is caused by differences between both localized parameters and soil moisture data these differences indicate that more accurate parameters and soil moisture datasets are needed to improve rainfall estimation using sm2rain 4 discussion 4 1 the discrepancy of rainfall estimation using sm2rain under different landscapes the average ns values of alpine meadows reach 0 74 and 0 71 during the calibration and validation periods respectively and is better than that of forestland 0 39 and 0 53 and farmland 0 81 and 0 6 fig 3 which indicated that the performance of rainfall estimation using sm2rain in alpine meadows is better than that in forestland and farmland however more in situ observations are needed to further conform it in huangzangsi farmland there was no irrigation activity in 2013 during the calibration period but two irrigation events in 2014 during the validation period the time series of soil moisture rsim and robs during the two irrigation events are shown in fig 6 the two irrigation events occurred on july 19 2014 and august 1 2014 and led to an erroneous estimation of the rainfall by about 30 mm the irrigation events caused a sudden increase in soil moisture and resulted in erroneous estimation of the rainfall by the sm2rain these errors indicate that irrigation has a significant impact and must be considered in the application of the sm2rain algorithm however this difference between the rsim and robs can be used for irrigation estimation dari et al 2020 combined the sm2rain and soil moisture products smos and smap to successfully reproduce the magnitude of irrigation in guantan forestland the sm2rain grossly underestimated rainfall the comparison of the estimated rainfall rsim and the observed rainfall robs is shown in fig 7 overall the surface soil moisture at the guantan station fluctuates little leading to a significant underestimation of the rainfall this result can be explained by the strong canopy interception capacity of qinghai spruce additionally it is worth noting that there are microbiotic soil crusts moss with a thickness of about 10 cm under the forestland which can store a large amount of the throughfall water carleton and dunham 2003 wang et al 2019a found that moss under qinghai spruce substantially reduced the fluctuation amplitude of soil moisture in the qilian mountains liu et al 2010 found that the surface soil moisture under the qinghai spruce forests with moss coverage had less fluctuation than the soil moisture without moss coverage in addition the scatter plots of rsim and robs show that when the robs value is greater than about 5 mm the value of rsim is above 0 fig 7 therefore the interception threshold of the qinghai spruce and moss layer for rainfall is about 5 mm which corresponds to the interception capacity of qinghai spruce in the qilian mountains tian et al 2012 wan et al 2017 the joint effects of both the strong canopy interception capacity of qinghai spruce and the water storage capacity of moss underneath the qinghai spruce led to the underestimation of the rainfall using the sm2rain thus the sm2rain algorithm has limited applicability in forestland environments in the study region due to the low surface soil moisture response to rainfall under qinghai spruce 4 2 the discrepancy of rainfall estimation using sm2rain at different elevations in section 3 2 1 we found that the performance of the sm2rain is relatively poor in high elevation 3300 masl areas to further analyze the relationship between the performance of rainfall estimation using sm2rain and elevation we calculated the average soil moisture average daily rainfall and statistical indicators ns r rmse at each alpine meadow station during the study period then we analyzed their relationships with both the elevation and statistical indicators ns r rmse fig 8 the average soil moisture and observed daily rainfall increase with rising elevation fig 8 a at the lowest altitude station dayekou station with an elevation of 2735 masl the average values of the soil moisture and observed daily rainfall are 17 93 vol and 1 96 mm day respectively at the highest altitude station yakou station with an elevation of 4148 masl their values reached 36 93 vol and 3 39 mm day respectively the increase of both rainfall and soil moisture with increasing elevation is agreement with previous research in the study area geng et al 2017 li et al 2019 linear regression analyses of the statistical indicators ns r rmse with both the average soil moisture and average daily rainfall are shown in fig 8 b and fig 8 c these results indicate that the performance of the sm2rain with lower ns and r and higher rmse decreased with increasing average soil moisture and rainfall with rising elevation the amount of rainfall and surface soil moisture increases leading to a greater underestimation of rainfall in high elevation areas using sm2rain fig 8 d the response of surface soil moisture to rainfall is the mechanism that determines the performance of the sm2rain method however soil water variability is a function of precipitation temperature and landscape type lv et al 2016 yang et al 2017 gao et al 2020 under the same landscape a higher rainfall and lower temperature lead to wetter soil moisture in high altitude areas meaning that surface runoff and deep infiltration will be more likely to develop when rainfall occurs previous research also found that regions with elevations higher than 3600 masl are the primary runoff generation areas in the uhrb kang et al 2008 wang et al 2009 in this study the performance of the sm2rain is worse when the elevation is higher than 3300 masl fig 8 table 1 the performance of the sm2rain in the stations above 3300 masl mean ns 0 68 r 0 84 rmse 2 57 mm day is significantly lower than those below 3300 masl mean ns 0 78 r 0 90 rmse 1 96 mm day combined calibration and validation periods the occurrence of surface runoff and deep infiltration results in an insufficient response of the surface soil moisture to rainfall all of these factors led to the declining performance of sm2rain for rainfall estimation with increasing elevation 4 3 the influence of sm2rain ascat s spurious rainfall events for rainfall estimation in high mountainous areas fig 5 shows that the pbias of the rsim is negative across almost all stations which indicates that sm2rain underestimates the rainfall however most of the pbias values of the sm2rain ascat are above zero as shown in fig 9 when the in situ observed rainfall robs at three representative stations is 0 mm the rainfall values of the sm2rain ascat are often above 0 mm this result suggests that there are spurious rainfall events in the sm2rain ascat rainfall product to further analyze the influence of the spurious rainfall events we used the observed rainfall data robs to correct the sm2rain ascat data by the following procedure 1 when the robs was 0 mm the rainfall data of the sm2rain ascat were also set to 0 mm 2 when the robs was not 0 mm the sm2rain ascat rainfall data were set to their original values the evaluation indicators ns r rmse and pbias of the sm2rain ascat before and after correction are shown in table 4 and fig 10 these results indicate that the correction can significantly improve the performance of the sm2rain algorithm and that spurious rainfall events have an important impact on the performance of the sm2rain ascat the high frequency fluctuations of soil moisture data from the advanced scatterometer ascat lead to rainfall noise in the sm2rain ascat brocca et al 2019 due to the large spatio temporal variability of soil moisture in complex mountainous terrain zhu et al 2017 gao et al 2019a yang et al 2020a liao et al 2020 rainfall noise exists when estimating rainfall based on the satellite soil moisture products with coarse spatial resolution therefore both soil moisture data products with higher spatio temporal resolution and advanced bias correction methods are needed to further improve the ability of rainfall estimation using sm2rain in high mountainous areas 4 4 the influence of increased soil moisture caused by the melting of snow and frozen soil in spring on rainfall estimation using sm2rain sm2rain assumes that increases in soil moisture are caused by rainfall however many other factors can cause soil moisture to increase such as irrigation temperature variation snow melting and frozen soil melting liu et al 2015 kapilaratne and lu 2017 dari et al 2020 tian et al 2020 among these processes the melting of snow and frozen soil is a common phenomenon in cold mountainous regions liu et al 2015 tian et al 2020 due to the low temperature 0 of mountainous regions in the study area in winter the precipitation mainly reaches the ground as snow and the soil will freeze in the spring of the next year as the temperature rises the melting of both snow and frozen soils leads to an increase in soil moisture this soil moisture is not due to rainfall and will cause the sm2rain to estimate rainfall incorrectly therefore when estimating rainfall in cold mountainous areas the increase in soil moisture caused by the melting of both the snow and frozen soil should be excluded 5 conclusion this study analyzed the performance and potential applications of the sm2rain and compared the estimated rainfall by the sm2rain rsim the rainfall products based on the sm2rain sm2rain ascat and reanalyzed rainfall products cmfd in high mountainous areas of northwest china the main findings are as follows 1 the soil moisture observation data with 1 h interval can be used to estimate daily rainfall in the study area 2 the sm2rain algorithm behaves differently for different landscapes in high mountainous areas in general the performance of the sm2rain in alpine meadows is better than in forest where there is strong interception and farmland where there is irrigation 3 in alpine meadows the performance of the sm2rain decreases with rising elevation both the rainfall and soil moisture increase with increasing elevation and rainfall is not accurately captured by soil moisture dynamics which leads to an underestimation of rainfall by sm2rain 4 the rainfall product based on sm2rain sm2rain ascat has a greater potential for rainfall estimation in high mountainous areas the performance of sm2rain could be improved through parameter localization 5 soil moisture products with high spatio temporal resolution and advanced bias correction methods can reduce the noise of sm2rain estimated rainfall and improve the applicability of the sm2rain credit authorship contribution statement yao lai conceptualization formal analysis methodology writing review editing investigation jie tian conceptualization data curation project administration supervision writing review editing weiming kang software investigation validation visualization chao gao validation supervision writing review editing weijie hong software supervision validation chansheng he project administration supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially funded by the national natural science foundation of china grants 42030501 41530752 and 91125010 most of the observed data are from the hiwater dataset of hydrometeorological observation network https data tpdc ac cn en we are grateful for their support we thank the editor and anonymous reviewers for their constructive comments and suggestions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127430 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3664,rainfall across mountainous areas is vital for the water supply and ecosystem services of arid watersheds rain gauges are the most common method to measure rainfall but these are sparse in mountainous areas satellite and reanalysis products can provide rainfall information over a large area but often have large uncertainty in high elevation environments a recently developed bottom up approach sm2rain soil moisture to rain estimates rainfall from soil moisture dynamics and provides a novel method to estimate rainfall however the reliability and accuracy of this method in high altitude mountainous areas are currently not well understood this study evaluates the sm2rain method under different environmental conditions based on data from 9 in situ soil moisture and rainfall observation stations in the qilian mountains in northwest china subsequently we compare the rsim rainfall estimated using the sm2rain in situ the global sm2rain rainfall product sm2rain ascat and the reanalysis rainfall product china meteorological forcing dataset cmfd with the in situ rainfall observations results show that the performance of sm2rain decreases with increasing elevation sm2rain performs well in alpine meadows but underestimates rainfall in forestland due to strong interception and overestimates rainfall in farmland due to irrigation meanwhile sm2rain has the potential to evaluate the interception capacity of forestland and the irrigation of farmland the sm2rain ascat and cmfd have similar performances in estimating daily rainfall in the study area calibration of sm2rain using high spatio temporal resolution soil moisture products and an advanced bias correction method can significantly improve rainfall estimation performance in data scarce mountainous areas keywords mountainous areas rainfall estimation soil moisture sm2rain 1 introduction rainfall is a vital driving factor of the hydrological cycle and accurately quantifying the amount and distribution of rainfall plays a critical role in hydrological research flood forecasting ecological assessments agricultural production and drought detection michaelides et al 2009 vrochidou et al 2013 apurv et al 2015 song et al 2020b yuan et al 2021 methods to capture rainfall data include ground observation stations remote sensing rainfall products and reanalysis datasets michaelides et al 2009 brocca et al 2015 seo et al 2020 yuan et al 2020 with rainfall gauges and satellite based measurements being the main methods for rainfall acquisition rossi et al 2017 fereidoon and koch 2018 rainfall gauges measure rainfall with high accuracy but limited spatial coverage in situ rainfall measurements over a large area are more difficult and sparsely distributed especially in mountainous areas ahrens et al 2006 zhao et al 2015 herrnegger et al 2018 in addition the complex heterogeneity of rainfall in mountainous areas makes rainfall estimation over large areas more challenging yuan and quiring 2017 yu et al 2020 wu et al 2020 satellite products are the key method for large scale rainfall estimation at present rainfall estimating rainfall from satellites is challenging and performs poorly for the complex terrain of mountainous regions yang and luo 2014 lu and yong 2018 wang et al 2019b reanalysis datasets such as the china meteorological forcing dataset cmfd and the fifth generation of atmosphere reanalysis dataset released by the european center for medium term weather forecasting ecmwf era5 brocca et al 2019 xin et al 2021 have been developed and widely used at large spatial scales yang et al 2010 he et al 2020 yang et al 2020b pi et al 2021 however the precision of the reanalysis product relies on multi source data including in situ observations and satellite products which limits the potential applications in data scarce mountainous areas li et al 2020 as such the development of other methods to quantify rainfall in data scarce mountainous areas are urgently needed sm2rain is a method proposed by brocca et al 2013 that uses soil moisture to estimate rainfall this method considers the soil layer to be a natural rain gauge and provides a framework to capture rainfall information over large areas using soil moisture observations brocca et al 2014 the sm2rain method has been assessed and applied worldwide using both in situ and satellite soil moisture data at local and global scales for both in situ measurements and laboratory experiments the sm2rain can reproduce rainfall data well the pearson correlation coefficient r 0 76 0 95 brocca et al 2013 0 75 0 95 brocca et al 2015 0 5 0 97 song et al 2020a the sm2rain has also been applied to estimate global rainfall based on satellite soil moisture products such as the sm2rain cci the european space agency climate change initiative ciabatta et al 2018 and sm2rain ascat the advanced scatterometer brocca et al 2019 results show that sm2rain ascat performs better than the integrated multi satellite retrievals for global precipitation measurement imerg early run version hou et al 2014 and the gauge based global precipitation climatology centre gpcc full data reanalysis version 1 schamm et al 2015 products in data scarce mountainous regions brocca et al 2019 furthermore the data based on sm2rain could have potential applications for early landslide warning systems brunetti et al 2021 and drought monitoring koohi et al 2021 in the data scarce regions however the use of sm2rain ascat in mountainous areas remains challenging primarily due to the uncertainty of sm2rain parameters chiaravalloti et al 2018 brocca et al 2019 muhammad et al 2020 zhang et al 2020a hu and yuan 2021 furthermore sm2rain has hardly been evaluated using large scale in situ observations in mountainous areas with complex topography and landscapes leading to unknown model performance therefore it is critical to evaluate sm2rain in high altitude mountainous areas with variable environmental factors e g landscape and elevation using in situ soil moisture and rainfall observations the objectives of this study are 1 to evaluate the applicability of the sm2rain method for estimating rainfall from the surface 0 10 cm soil moisture in high mountainous areas 2 to analyze the impacts of environmental factors on the performance of sm2rain and 3 to compare and assess the application potential of the rainfall products the simulated rainfall by sm2rain rsim sm2rain ascat and cmfd in high mountainous areas 2 methodology and materials 2 1 study area the study area is in the upper reach of the heihe river basin uhrb which is the second largest inland river basin in china and discharges into a terminal lake the uhrb has an area of 2 7 104 km2 with an altitude ranging between 2000 and 5600 m above sea level masl yao et al 2017 tian et al 2019 su et al 2020 the uhrb has mean annual precipitation ranging from 200 to 700 mm and mean annual temperature varying from 3 1 to 3 6 c luo et al 2016 zhang et al 2016 he et al 2018 the main land cover types in the uhrb are grassland 49 forestland 17 barren land 27 and farmland 3 hu et al 2015 the main soil texture classes are loam sandy loam and silty loam lu et al 2017 the uhrb provides almost all water resources for the entire heihe river basin chen et al 2003 2 2 hydrometeorological observational data the hydrometeorological observation data are mostly from the heihe watershed allied telemetry experimental research hiwater dataset of hydrometeorological observation network liu et al 2011 li et al 2013 liu et al 2018 che et al 2019 was downloaded from the national tibetan plateau third pole environment data center https data tpdc ac cn en a total of 9 hydrometeorological observation stations were used in this study these stations are located in alpine meadows 7 stations farmland wheat 1 station and forestland qinghai spruce 1 station with elevations ranging from 2500 to 4500 masl fig 1 table 1 the information of the selected hydrometeorological observation stations are listed in table 1 the main hydrometeorological variables used in this study include observed rainfall measured by te525m texas electronics at 2 m height and the surface 0 10 cm soil volume water content measured by 5te sensor meter inc usa che et al 2019 the soil moisture and rainfall data of all the stations used in this study are shown in fig s1 the temporal resolution of rainfall and soil moisture observational data is 10 min however such high resolution observation data are difficult to obtain in high mountainous areas therefore the time interval of observation data was aggregated to 1 h to reduce noise and enhance the potential applications of this study gao et al 2019b as the 5te soil moisture is greatly affected by daily soil temperature variation the soil moisture was temperature corrected following kapilaratne and lu 2017 finally the soil moisture data were normalized to the range of 0 1 to estimate rainfall data using sm2rain following brocca et al 2015 in this study soil moisture data during the growing season may to october tian et al 2019 gao et al 2021 were used to avoid the effects of soil freeze thawing 2 3 sm2rain ascat and cmfd data the sm2rain ascat global terrestrial rainfall product was developed from the advanced scatterometer ascat onboard three meteorological operational metop satellites and soil moisture datasets from the sm2rain algorithm brocca et al 2019 the spatial resolution of the sm2rain ascat is 0 125 0 125 and the temporal resolution is 1 day muhammad et al 2020 brocca et al 2019 the sm2rain ascat data are freely available for the period 2007 2020 https zenodo org record 4507133 the cmfd is a high spatio temporal resolution gridded near surface meteorological and environmental dataset which has been widely used in china yang et al 2020b pi et al 2021 this dataset was developed through the fusion of the tropical rainfall measuring mission trmm kummerow et al 2000 global land data assimilation system gldas global energy and water exchanges surface radiation budget gewex srb existing princeton reanalysis data and in situ observational data the weather observation data of the china meteorological administration yang et al 2010 he et al 2020 the horizontal spatial resolution of cmfd is 0 1 and the temporal resolution is 3 h previous research has shown that the cmfd is currently the best product for rainfall estimation in the tibetan plateau wu et al 2019 wu et al 2021 the daily rainfall data of cmfd is used in this study 2 4 sm2rain algorithm the soil water balance equation at a certain depth z can be described as 1 zds t d t p t r t e t g t where s t p t r t e t and g t are soil moisture precipitation surface runoff evapotranspiration and drainage rate deep percolation plus subsurface runoff respectively brocca et al 2013 song et al 2020a z n z where n is the soil porosity z mm is the soil layer depth the rainfall can be estimated as 2 p t r t e t g t z d s t d t to facilitate the calculation the sm2rain algorithm proposes two assumptions 1 whenever it rains the evaporation rate is negligible so the evaporation term e t 0 and 2 all rainfall infiltrates into the soil meaning the surface runoff term r t 0 brocca et al 2013 in the study area previous research found that rainfall is more likely to form infiltration and subsurface runoff due to the strong water conservation function of alpine meadows wang et al 2003 kang et al 2008 wang et al 2009 chen et al 2014 and little rainfall 9 yang et al 2011 1 xiao et al 2020 is directly converted into the surface runoff in alpine meadows little to no surface runoff was observed in the forestland and farmland due to the strong infiltration ability of the forestland and farmland in the study area he et al 2012 therefore the assumptions are valid in our study area the drainage rate can be expressed as famiglietti and wood 1994 3 g t a s t b where a mm d is the saturated hydraulic conductivity b is exponent related to the pore size distribution index famiglietti and wood 1994 brocca et al 2019 finally rainfall can be estimated from 4 p t z d s t d t a s t b therefore three parameters z a and b need to be quantified to drive the sm2rain the study period was divided into the parameter calibration period and the validation period the optimal parameters were determined by optimization using the highest nash sutcliffe value ns between the observed rainfall and the estimated rainfall during the parameter calibration period for each station some data gaps occurred due to the harsh natural environment fig s2 battery or sensor malfunctions and damage by livestock sheep and yaks and rats the data gaps led to different observational periods for each station to derive accurate parameters for each station the calibration period was always longer than the validation period in addition the parameter calibration period included both the driest and wettest years for soil moisture the study period is shown in table 1 2 5 evaluation indicators to analyze the applicability of the sm2rain algorithm and assess the reliability of rainfall estimates in mountainous areas the estimated rainfall datasets rsim sm2rain ascat and cmfd were compared with the observed rainfall from rainfall gauges the nash sutcliffe efficiency ns the root mean square error rmse the pearson correlation coefficient r and percent bias pbias were used to evaluate the performance of the methods which are calculated as follows 5 ns 1 i 1 n ai b i 2 i 1 n ai a 2 6 rmse i 1 n ai b i 2 n 7 r i 1 n ai a bi b i 1 n ai a 2 i 1 n bi b 2 8 pbias 100 i 1 n bi a i i 1 n ai where ai is the observed value and a is the mean of the observed values bi is the estimated value and b is the mean value of the estimated values among these methods the ns represents the overall estimation performance with values ranging from to 1 the ns is close to 1 indicating that the model is accurate and reliable bajracharya et al 2017 the rmse is used to characterize the estimation error where the closer the value is to 0 the better the estimation muhammad et al 2020 the value of r represents the linear correlation between two datasets and ranges from 1 to 1 the pbias represents the deviation between the estimated value and the observed value which is classified into three types underestimation pbias 10 overestimation pbias 10 and nearly equal pbias from 10 to 10 yang and luo 2014 2 6 statistical analysis in this study the one way analysis of variance anova was used to test the differences between the estimated rainfall datasets rsim sm2rain ascat and cmfd and the evaluation indicators all satisfy the assumptions of one way analysis of the variance boxplots were used to show the distribution of the metrics ns rmse r and pbias 3 results 3 1 optimal time step for sm2rain 3 1 1 aggregation intervals of rainfall the sm2rain algorithm can estimate rainfall from soil moisture with different time steps so the optimal value needs to be determined in the study area first different aggregation intervals of rainfall from 1 to 72 h were analyzed using hourly observed soil moisture data at all the stations comparisons of estimated rainfall and observed rainfall are shown in fig 2 a b results indicate that the estimation reliability ns r improves with increasing aggregated time intervals the performance increases quickly with increasing aggregated time intervals from 0 to 12 h then increases slower for intervals of 24 h this trend is similar to previous research brocca et al 2013 these findings show that using estimated rainfall with an aggregation interval from 24 to 72 h has relatively high reliability as daily rainfall data are commonly used in hydrological research the optimal rainfall estimation time step was set as 24 h in this study 3 1 2 time intervals of soil moisture subsequently we analyzed the performance of the daily rainfall estimation using the soil moisture data with different time intervals from 1 to 24 h comparisons of the estimated and observed daily rainfall show that the performance of the daily rainfall estimation decreases with increasing time intervals of the soil moisture data from 1 to 24 h fig 2 c d the soil moisture data with a 1 h time interval had the best performance mean ns 0 71 r 0 86 and the soil moisture data with a 24 h time interval had the worst performance mean ns 0 57 r 0 78 therefore the soil moisture observation data with a 1 h time interval was used to estimate daily rainfall in this study 3 2 assessing the impacts of environmental factors we used surface soil moisture data from 9 hydrometeorological observation stations to estimate rainfall using sm2rain and compared the output with observed rainfall at each station due to data gaps the periods of calibration and validation of each station are different table 1 the performance of sm2rain was evaluated using ns r rmse and pbias and the results are summarized in table 2 and fig 3 the performance of the parameter calibration period is better than that of the parameter validation period table 2 fig 3 the mean ns r and rmse values in the parameter calibration period are 0 71 0 85 and 2 11 mm day respectively in contrast the mean ns r and rmse values in the parameter validation period are 0 54 0 81 and 2 59 mm day respectively this difference is mainly caused by the poor ability ns 0 60 r 0 38 of the sm2rain method to reproduce data from huangzangsi station in the parameter validation period in addition the duration of data used in this study is relatively short which may lead to differences in the parameter calibration and validation period in alpine meadow environments different stations behaved differently the ns decreased from the station with the lowest elevation dayekou station 2735 masl with ns of 0 78 and 0 80 during the calibration and validation period respectively to the station with the highest elevation yakou station 4148 masl with ns of 0 62 and 0 79 during the calibration and validation periods respectively furthermore the sm2rain algorithm had different performances for different landscapes fig 3 in alpine meadows the average ns values reached 0 74 and 0 71 during the calibration and validation period respectively which is better than that of forestland 0 39 and 0 53 and farmland 0 81 and 0 6 the pbias values for most stations are negative showing that the sm2rain underestimated rainfall table 2 fig 3 analyses of the specific performance of the sm2rain for different land cover types are described below 3 2 1 alpine meadows alpine meadows are the main land cover type in the study area zhang et al 2020b in this study the seven observation stations with different elevations were used to analyze the performance of the sm2rain in alpine meadow environments and investigate how the results varied with elevation the results are shown in fig 3 for the same landscape type alpine meadow the performances of the rainfall estimation using sm2rain are different at each station the comparisons of the rsim and the in situ observed rainfall robs of three representative stations with different elevations dayekou 2735 masl arou 3033 masl and dashalong 3739 masl illustrate the variation of the sm2rain performances with variable elevation fig 4 the fitted lines for the scatterplot between the rsim and robs at three stations are located below y x which means the sm2rain algorithm underestimated the rainfall the fitted line of dashalong station is the furthest away from y x with a slope of 0 83 p 0 001 followed by arou with a slope of 0 94 p 0 001 and dayekou with a slope of 0 95 p 0 001 and the ns values of the three stations decreased with the rising elevation 0 79 of dayekou 0 80 of arou and 0 70 of dashalong combined calibration and validation periods in general the performance of dayekou arou huangcaogou mean ns 0 80 and 0 79 in the calibration and validation periods respectively is better than that of e bao dashalong jingyangling and yakou mean ns 0 69 and 0 65 in the calibration and validation periods respectively it is worth noting that the elevation of dayekou arou huangcaogou 3300 masl is lower than that of e bao dashalong jingyangling and yakou station 3300 masl table 1 this result suggests that the performance of rainfall estimation using sm2rain is relatively poor for high elevation 3300 masl areas 3 2 2 farmland for the huangzangsi station where the main crop is wheat the soil moisture and rainfall data from 2013 were used to calculate parameters z a and b the soil moisture data from 2014 were then used in the sm2rain model with these calculated parameters z a and b to estimate rainfall in 2014 a comparison of the estimated rainfall rsim and the observed rainfall robs is shown in fig 3 the sm2rain model reliability at the huangzangsi station is relatively good in the calibration period ns 0 81 r 0 90 rmse 1 42 mm day and pbias 12 94 but worse in the validation period ns 0 6 r 0 38 rmse 4 46 mm day and pbias 25 7 3 2 3 forestland qinghai spruce is the typical forest type in the qilian mountains liu et al 2021 the surface soil moisture and rainfall above the canopy data from 2010 to 2011 at guantan station where qinghai spruce is the main vegetation was used to test the sm2rain method the year 2011 was used as the parameter calibration period and 2010 was used as the validation period the performances of the sm2rain during the calibration period ns 0 39 r 0 73 rmse 2 47 mm day and pbias 63 25 and validation period ns 0 53 r 0 78 rmse 2 08 mm day and pbias 56 68 are relatively low in addition the values of pbias indicate the sm2rain grossly underestimates the rainfall 3 3 comparison of different rainfall products to evaluate the potential applications of rainfall products based on the sm2rain algorithm in mountainous areas we compared the rsim sm2rain ascat and cmfd with the observed rainfall robs combing the calibration and validation period table 3 results are shown in table 3 and fig 5 the average values of ns and r between the rsim and robs can reach 0 70 and 0 85 respectively table 3 however they are only 0 20 and 0 50 for the sm2rain ascat and 0 15 and 0 55 for cmfd table 3 results of anova in fig 5 indicate that there are significant differences between the rsim and both the sm2rain ascat and cmfd rainfall products however there is a similar performance between the sm2rain ascat and cmfd considering that the cmfd is currently the best product for rainfall estimation in the tibetan plateau wu et al 2019 wu et al 2021 it is reasonable to conclude that the sm2rain ascat has greater application potential in high mountainous areas in addition there is a significant difference between rsim and sm2rain ascat rainfall data which is caused by differences between both localized parameters and soil moisture data these differences indicate that more accurate parameters and soil moisture datasets are needed to improve rainfall estimation using sm2rain 4 discussion 4 1 the discrepancy of rainfall estimation using sm2rain under different landscapes the average ns values of alpine meadows reach 0 74 and 0 71 during the calibration and validation periods respectively and is better than that of forestland 0 39 and 0 53 and farmland 0 81 and 0 6 fig 3 which indicated that the performance of rainfall estimation using sm2rain in alpine meadows is better than that in forestland and farmland however more in situ observations are needed to further conform it in huangzangsi farmland there was no irrigation activity in 2013 during the calibration period but two irrigation events in 2014 during the validation period the time series of soil moisture rsim and robs during the two irrigation events are shown in fig 6 the two irrigation events occurred on july 19 2014 and august 1 2014 and led to an erroneous estimation of the rainfall by about 30 mm the irrigation events caused a sudden increase in soil moisture and resulted in erroneous estimation of the rainfall by the sm2rain these errors indicate that irrigation has a significant impact and must be considered in the application of the sm2rain algorithm however this difference between the rsim and robs can be used for irrigation estimation dari et al 2020 combined the sm2rain and soil moisture products smos and smap to successfully reproduce the magnitude of irrigation in guantan forestland the sm2rain grossly underestimated rainfall the comparison of the estimated rainfall rsim and the observed rainfall robs is shown in fig 7 overall the surface soil moisture at the guantan station fluctuates little leading to a significant underestimation of the rainfall this result can be explained by the strong canopy interception capacity of qinghai spruce additionally it is worth noting that there are microbiotic soil crusts moss with a thickness of about 10 cm under the forestland which can store a large amount of the throughfall water carleton and dunham 2003 wang et al 2019a found that moss under qinghai spruce substantially reduced the fluctuation amplitude of soil moisture in the qilian mountains liu et al 2010 found that the surface soil moisture under the qinghai spruce forests with moss coverage had less fluctuation than the soil moisture without moss coverage in addition the scatter plots of rsim and robs show that when the robs value is greater than about 5 mm the value of rsim is above 0 fig 7 therefore the interception threshold of the qinghai spruce and moss layer for rainfall is about 5 mm which corresponds to the interception capacity of qinghai spruce in the qilian mountains tian et al 2012 wan et al 2017 the joint effects of both the strong canopy interception capacity of qinghai spruce and the water storage capacity of moss underneath the qinghai spruce led to the underestimation of the rainfall using the sm2rain thus the sm2rain algorithm has limited applicability in forestland environments in the study region due to the low surface soil moisture response to rainfall under qinghai spruce 4 2 the discrepancy of rainfall estimation using sm2rain at different elevations in section 3 2 1 we found that the performance of the sm2rain is relatively poor in high elevation 3300 masl areas to further analyze the relationship between the performance of rainfall estimation using sm2rain and elevation we calculated the average soil moisture average daily rainfall and statistical indicators ns r rmse at each alpine meadow station during the study period then we analyzed their relationships with both the elevation and statistical indicators ns r rmse fig 8 the average soil moisture and observed daily rainfall increase with rising elevation fig 8 a at the lowest altitude station dayekou station with an elevation of 2735 masl the average values of the soil moisture and observed daily rainfall are 17 93 vol and 1 96 mm day respectively at the highest altitude station yakou station with an elevation of 4148 masl their values reached 36 93 vol and 3 39 mm day respectively the increase of both rainfall and soil moisture with increasing elevation is agreement with previous research in the study area geng et al 2017 li et al 2019 linear regression analyses of the statistical indicators ns r rmse with both the average soil moisture and average daily rainfall are shown in fig 8 b and fig 8 c these results indicate that the performance of the sm2rain with lower ns and r and higher rmse decreased with increasing average soil moisture and rainfall with rising elevation the amount of rainfall and surface soil moisture increases leading to a greater underestimation of rainfall in high elevation areas using sm2rain fig 8 d the response of surface soil moisture to rainfall is the mechanism that determines the performance of the sm2rain method however soil water variability is a function of precipitation temperature and landscape type lv et al 2016 yang et al 2017 gao et al 2020 under the same landscape a higher rainfall and lower temperature lead to wetter soil moisture in high altitude areas meaning that surface runoff and deep infiltration will be more likely to develop when rainfall occurs previous research also found that regions with elevations higher than 3600 masl are the primary runoff generation areas in the uhrb kang et al 2008 wang et al 2009 in this study the performance of the sm2rain is worse when the elevation is higher than 3300 masl fig 8 table 1 the performance of the sm2rain in the stations above 3300 masl mean ns 0 68 r 0 84 rmse 2 57 mm day is significantly lower than those below 3300 masl mean ns 0 78 r 0 90 rmse 1 96 mm day combined calibration and validation periods the occurrence of surface runoff and deep infiltration results in an insufficient response of the surface soil moisture to rainfall all of these factors led to the declining performance of sm2rain for rainfall estimation with increasing elevation 4 3 the influence of sm2rain ascat s spurious rainfall events for rainfall estimation in high mountainous areas fig 5 shows that the pbias of the rsim is negative across almost all stations which indicates that sm2rain underestimates the rainfall however most of the pbias values of the sm2rain ascat are above zero as shown in fig 9 when the in situ observed rainfall robs at three representative stations is 0 mm the rainfall values of the sm2rain ascat are often above 0 mm this result suggests that there are spurious rainfall events in the sm2rain ascat rainfall product to further analyze the influence of the spurious rainfall events we used the observed rainfall data robs to correct the sm2rain ascat data by the following procedure 1 when the robs was 0 mm the rainfall data of the sm2rain ascat were also set to 0 mm 2 when the robs was not 0 mm the sm2rain ascat rainfall data were set to their original values the evaluation indicators ns r rmse and pbias of the sm2rain ascat before and after correction are shown in table 4 and fig 10 these results indicate that the correction can significantly improve the performance of the sm2rain algorithm and that spurious rainfall events have an important impact on the performance of the sm2rain ascat the high frequency fluctuations of soil moisture data from the advanced scatterometer ascat lead to rainfall noise in the sm2rain ascat brocca et al 2019 due to the large spatio temporal variability of soil moisture in complex mountainous terrain zhu et al 2017 gao et al 2019a yang et al 2020a liao et al 2020 rainfall noise exists when estimating rainfall based on the satellite soil moisture products with coarse spatial resolution therefore both soil moisture data products with higher spatio temporal resolution and advanced bias correction methods are needed to further improve the ability of rainfall estimation using sm2rain in high mountainous areas 4 4 the influence of increased soil moisture caused by the melting of snow and frozen soil in spring on rainfall estimation using sm2rain sm2rain assumes that increases in soil moisture are caused by rainfall however many other factors can cause soil moisture to increase such as irrigation temperature variation snow melting and frozen soil melting liu et al 2015 kapilaratne and lu 2017 dari et al 2020 tian et al 2020 among these processes the melting of snow and frozen soil is a common phenomenon in cold mountainous regions liu et al 2015 tian et al 2020 due to the low temperature 0 of mountainous regions in the study area in winter the precipitation mainly reaches the ground as snow and the soil will freeze in the spring of the next year as the temperature rises the melting of both snow and frozen soils leads to an increase in soil moisture this soil moisture is not due to rainfall and will cause the sm2rain to estimate rainfall incorrectly therefore when estimating rainfall in cold mountainous areas the increase in soil moisture caused by the melting of both the snow and frozen soil should be excluded 5 conclusion this study analyzed the performance and potential applications of the sm2rain and compared the estimated rainfall by the sm2rain rsim the rainfall products based on the sm2rain sm2rain ascat and reanalyzed rainfall products cmfd in high mountainous areas of northwest china the main findings are as follows 1 the soil moisture observation data with 1 h interval can be used to estimate daily rainfall in the study area 2 the sm2rain algorithm behaves differently for different landscapes in high mountainous areas in general the performance of the sm2rain in alpine meadows is better than in forest where there is strong interception and farmland where there is irrigation 3 in alpine meadows the performance of the sm2rain decreases with rising elevation both the rainfall and soil moisture increase with increasing elevation and rainfall is not accurately captured by soil moisture dynamics which leads to an underestimation of rainfall by sm2rain 4 the rainfall product based on sm2rain sm2rain ascat has a greater potential for rainfall estimation in high mountainous areas the performance of sm2rain could be improved through parameter localization 5 soil moisture products with high spatio temporal resolution and advanced bias correction methods can reduce the noise of sm2rain estimated rainfall and improve the applicability of the sm2rain credit authorship contribution statement yao lai conceptualization formal analysis methodology writing review editing investigation jie tian conceptualization data curation project administration supervision writing review editing weiming kang software investigation validation visualization chao gao validation supervision writing review editing weijie hong software supervision validation chansheng he project administration supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is partially funded by the national natural science foundation of china grants 42030501 41530752 and 91125010 most of the observed data are from the hiwater dataset of hydrometeorological observation network https data tpdc ac cn en we are grateful for their support we thank the editor and anonymous reviewers for their constructive comments and suggestions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127430 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
