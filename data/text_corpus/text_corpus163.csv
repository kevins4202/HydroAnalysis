index,text
815,this study defines the optimal operating envelope of the digital rock technology from the perspective of imaging and numerical simulations of transport properties imaging larger volumes of rocks for digital rock physics drp analysis improves the chances of achieving a representative elementary volume rev at which flow based simulations 1 do not vary with change in rock volume and 2 is insensitive to the choice of boundary conditions however this often comes at the expense of image resolution this trade off exists due to the finiteness of current state of the art imaging detectors imaging and analyzing digital rocks that sample the rev and still sufficiently resolve pore throats is critical to ensure simulation quality and robustness of rock property trends for further analysis we find that at least 10 voxels are needed to sufficiently resolve pore throats for single phase fluid flow simulations if this condition is not met additional analyses and corrections may allow for meaningful comparisons between simulation results and laboratory measurements of permeability but some cases may fall outside the current technical feasibility of drp on the other hand we find that the ratio of field of view and effective grain size provides a reliable measure of the rev for siliciclastic rocks if this ratio is greater than 5 the coefficient of variation for single phase permeability simulations drops below 15 these imaging considerations are crucial when comparing digitally computed rock flow properties with those measured in the laboratory we find that the current imaging methods are sufficient to achieve both rev with respect to numerical boundary conditions and required image resolution to perform digital core analysis for coarse to fine grained sandstones keywords digital rock permeability petrology numerical solutions rev 1 introduction digital rock physics drp analyses include image based computation of flow properties of reservoir rocks subsurface hydrogeological properties mechanical properties such as elastic moduli electromagnetic properties thermal properties and other averaged quantities of porous media drp also aims to improve our understanding of how multiphysics evolves from pore scale to meso scale drp complements and in some cases replaces the need for relatively slow laboratory based measurements and empirical rock property models drp can lead to more faster and cheaper core analysis and generate early data for project acceleration furthermore in the last decade or so drp has evolved into an active field of multidisciplinary research adler et al 1990 andrä et al 2013a b arns et al 2005 2002 berryman and blair 1986 blunt et al 2013 dvorkin et al 2011 2008 kanckstedt et al 2001 knackstedt et al 2008 knackstedt et al 2009 øren et al 2006 saenger 2008 saenger et al 2011 sain et al 2014 saxena and mavko 2016 saxena et al 2017b saxena et al 2017c we discuss imaging considerations of rocks to compute transport properties in terms of two fundamental quantities 1 the ratio of dominant pore throat size to voxel size and 2 the ratio of field of view of the acquired image and a measure of grain size the first constraint is linked to quality of image resolution whereas the second constraint is related to achieving the representative elementary volume rev for numerical simulations of flow properties due to the finiteness of modern imaging detectors e g x ray micro computed tomography there exists a tradeoff between achieving rev and resolving pore throats as an illustration of this tradeoff consider the example in fig 1 the same rock is imaged with different voxel sizes e g 0 3 2 4 and 9 80 µm such that all acquired images have 1024 voxels on each side these are transmitted light optical microscope from a thin section that has 30 µm thickness also shown are the corresponding segmented images we note that the pores in the fine resolution i e smaller voxel size image are very well resolved but the image is unlikely to be large enough physically to achieve the rev on the other hand the coarse resolution image is probably the rev but the pores are not resolved to this end we first analyze imaging considerations to sufficiently resolve pore throats subsequently we establish constraints for the rev by analyzing the variation in various rock properties calculated using pore morphology based methods with increasing rock volume furthermore we analyze the variation in computed permeability for volumes of various sizes using four different numerical flow simulation approaches with multiple boundary conditions based on our findings we discuss the minimum considerations for imaging rocks to calculate reliable digital rock properties estimations 2 limits imposed due to imaging image quality voxel size and limited field of view all put constraints on flow properties that can be calculated using the digital rock technology two dimensionless parameters that describe these effects are 1 the ratio of dominant pore throat size to voxel size ni and 2 the ratio of field of view of the acquired image and effective grain size nrev we define these two parameters as follows 1 n i d d δ x 2 n r e v l d e f f in eqs 1 and 2 δx is image voxel size l is the field of view or length of the digital rock in any direction dd is the pore throat size corresponding to the so called mercury entry pressure denoted here by pd parameters pd and dd are related by pd 2σcos θ dd where σ is mercury air surface tension 480 dyne cm and θ is the contact angle 40 if pd is expressed in psi and dd is expressed µm then 2σcos θ 213 the entry pressure pd can be directly measured in a mercury injection capillary pressure micp experiment swanson 1981a thomeer 1983 1960 alternatively pd and dd can also be inferred using image based simulations hilpert and miller 2001 many rocks exhibit dual pore structures desbois et al 2011 hemes et al 2015 houben et al 2013 and cannot be sufficiently described by a single dominant pore throat in such cases multiple ni parameters must be used deff is the effective grain diameter for permeability rumpf and gupte 1971 defined as 3 d e f f d 2 n d d d d 3 n d d d where n d is the number distribution of each grain diameter the effective grain diameter deff can be calculated using grain size distribution measured in a laboratory e g sieve analysis and can also be inferred using image based algorithms therefore both parameters ni and nrev can be estimated directly using a 3d digital rock image the effective grain diameter deff is a complicated function of the entry pore throat size dd such a relationship also depends on many other textural parameters including porosity coordination number rock type and grain shape the parameter ni describes the quality of image resolution whereas the parameter nrev describes the number of grains captured in an image to sample the desired heterogeneity in an ideal scenario we would like to image as fine and as large as possible i e ni and nrev but this is simply not possible due to limitations of imaging techniques most imaging devices e g x ray micro computed tomography micro ct can accommodate only a predefined number of voxels m 3 even through the micro ct detectors are rapidly improving the current detectors capture fewer than 20003 voxels i e m 2000 in the lateral direction therefore the rev can be achieved by sampling larger rock volumes but only at the expense of coarser image resolution one can choose to image a larger field of view i e physical dimension at coarse resolution or image a smaller piece of rock at higher resolution thus there is a tradeoff between sampling sufficiently many grains pores to achieve the rev and still resolve pore throats to maintain quality of numerical simulations on images given this trade off we will now illustrate how the two imaging parameters ni and nrev impact the computed permeability using simple empirical permeability relation the minimum value of parameter ni that is needed to capture sufficient structural complexity of rock microstructure and maintain simulation quality puts a loose lower bound on permeability that can be reliably calculated using an image this is because permeability depends on physical dimensions of pore throat which must be larger than the voxel size to be visible in an image using an empirical relation between pore throat size and permeability we will now illustrate how the parameter ni that depends on both voxel size δx and pore throat size dd controls the lowest permeability that can be reliably calculated using a digital rock image thomeer 1983 proposed the following empirical relation that relates brine permeability to entry pressure pd from a micp measurement 4 k 38 068 g 4 3 ϕ p d 2 in eq 4 k is absolute permeability in mdarcy ϕ is total rock porosity in fraction pd is the entry pressure for mercury injection in psi and g is a dimensionless pore shape parameter g varies between 0 1 0 2 for siliciclastic rocks and 0 2 0 3 for carbonates rocks eq 4 can also be written in terms of diameter of the entry pore throat dd in µm as 5 k 38 068 g 4 3 ϕ d d 213 2 substituting eq 1 in eq 5 we obtain 6 k 38068 g 4 3 ϕ δ x n i 213 2 the smallest possible value of parameter ni is simply 1 when pore throat size is same as the voxel size such a case would correspond to a heavily pixelated digital rock image substituting ni 1 in eq 6 2 µm voxel size i e δx 2 µm and 20 porosity i e ϕ 0 2 we calculate a permeability of 1 mdarcy that is the smallest permeability that can be calculated for such a digital image which still somehow contains a network of connected pores for this analysis we assume g 0 2 assuming a minimum value of ni 10 an image of voxel size δx 2 µm and ϕ 0 2 yields k 100 mdarcy as the smallest permeability that can be reliably calculated using an image of 2 µm voxel size if the actual permeability of the rock in question is lower than 100 mdarcy then an image of higher resolution should be acquired any computation carried out on an image or below the total porosity and permeability trend defined by eq 6 will need to be corrected here we assumed a minimum value of ni 10 however in practice the required minimum value of ni will increase with complexity of the pore shape this will be addressed in a future study we must note that although thomeer s permeability relation in eq 4 is an empirical relation this relation has been extensively calibrated using laboratory measured data micp and brine permeability and petrographic interpretations from many reservoir sandstone rocks it yields results that agree with laboratory measured brine permeability within a factor of 2 similar analysis can be performed using other empirical models e g swanson 1981b similar to the analysis above the minimum required value of parameter nrev imposes a loose upper bound on image computed permeability this is because there is an upper limit on the size of grains that can be fit in an image which naturally translates to an upper bound on permeability to illustrate this we again use thomeer s permeability relation in order to use the same permeability relation in eq 5 for convenience we consider the following relation between dd and deff 7 d e f f d d a ϕ b the relation in eq 7 is motivated by observations from analyzing an internal shell database of laboratory measurements of micp and laboratory measured effective grain size in siliciclastic rocks fig 2 the relevance of the red line corresponding to deff dd 40 is discussed in a later section it is important to note that the empirical relation in eq 7 is not universal and is only used here for the sake of illustration substituting eq 7 into eq 5 we obtain a loose upper bound on permeability 8 k 38068 g 4 3 ϕ m δ x 213 a ϕ b n r e v 2 assuming nrev 5 m 1400 g 0 2 a 0 5 b 2 δx 2 µm and ϕ 0 2 yields k 570 mdarcy as the largest permeability that can be reliably calculated using an image of 2 µm voxel size so that rev requirements are satisfied therefore the range of reliable permeability that can be calculated using an image of 2 µm voxel size for a 20 porosity rock is 100 570 mdarcy assuming the parameters described above this range is only a rough guide but represents the optimum working range for drp simulations fig 3 shows the region defined by eqs 6 and 8 of permeability that can be calculated using images of voxel sizes 1 2 and 4 µm as a function of porosity assuming m 1400 nrev 5 and ni 10 also shown in fig 3 is the region spanned by high resolution 2 dimensional colored thin sections that often have a voxel size of 0 1 µm and m 30 000 in the subsequent sections we seek to establish the minimum requirements for parameters nrev and ni 3 resolving pore throats we now estimate the minimum value of ni needed to resolve pore throats and compute properties that are nearly independent of how an image is discretized to establish the variation of porosity and permeability for rocks with a change in voxel size we down sample a high resolution rock originally acquired with voxel size of 0 3 µm using bi cubic interpolation all images were then segmented using a thresholding method saxena et al 2017b next we simulate flow using a lattice boltzmann lbm solver described in alpak et al 2018 saxena et al 2017b and also simulate micp curve hilpert and miller 2001 to calculate pd dd and ni we subsequently normalize all permeability values with that computed for the original high resolution image fig 4 we note that coarsening of the voxel size leads to an increase in permeability up to 30 40 and at least 10 voxels i e ni 10 are needed to divide the pore diameter finely enough to achieve a stable solution of permeability for a more quantitative analysis we imaged a rock at two different resolutions voxel size of 4 µm and 8 µm using a state of the art micro ct detector the two images were processed for noise removal and then segmented with a thresholding algorithm next permeability was computed for the same field of view using the two images acquired at two resolutions we find that computed permeability systematically increases with coarsening of voxels and conclude that at least 10 voxels are needed to achieve numerical solutions that are accurate up to a factor of 2 fig 5 4 representative elementary volume rev one of the most important steps in drp is to identify the smallest field of view at random that can be used for a morphology based or physics based simulation so as to be representative of the whole rock for a given property bear 1975 hill 1963 torquato 1991 rev is a function of parameter nrev this volume is also commonly referred to as the representative elementary volume rev or the representative volume element rve a reliable estimate of the rev can help optimize imaging and computational effort as well as help mitigate situations where erroneous computational findings are overanalyzed as actual macroscale physics the rev of periodic materials e g cubic packing is relatively straightforward as one can simply analyze a periodic unit cell which can be defined only if one is supplied with prior knowledge of the type of periodicity involved to simulate properties for the entire media with appropriate boundary conditions e g periodic symmetric however when dealing with random heterogenous media e g natural rocks defining the rev is considerably more complicated kanit et al 2003 gitman et al 2007 pelissou et al 2009 costanza robinson et al 2011 in treatment of elasticity problems hill 1963 proposed two somewhat interrelated measures of the rev 1 volume that is entirely typical of the whole mixture on average and 2 volume that contains enough inclusions for the apparent properties to be independent of the surface values of traction and displacement so long as these values are macroscopically uniform huet 1990 sab 1992 both statements 1 and 2 are also applicable for other properties and not just elasticity and it is well known that such a measure of the rev depends on the effective property in question kanit et al 2003 statement 1 refers to homogeneity of a material s statistics for a specific property while statement 2 alludes to the independence of the effective constitutive response with respect to the applied boundary conditions rock porosity at the grain scale fluctuates between 0 i e 100 grain and 1 i e 100 pore but as the rock volume approaches the rev porosity attains a stable value until the lithology changes therefore numerical calculation of porosity does not involve any boundary conditions because it is simply the ratio between the number of pore voxels and the total number of voxels the term voxel size refers to physical dimensions of image pixel similarly the rev of other rock properties that are calculated using pore morphology based methods e g estimating pore size distribution using inscribed spheres is also independent of boundary conditions however rock properties calculated using a physics based simulation e g stokes flow depend not only on pore morphology but also on the choice of boundary conditions and thus must satisfy both statements 1 and 2 this naturally implies larger rev for a specific rock property calculated using physics based simulations then those estimated using morphology based methods for rocks arns et al 2002 defined the rev of a digital sample as the smallest volume that has minimal variability in the geometric descriptors such as porosity and specific surface area kanit et al 2003 provide a comprehensive study of statistical measures of rev keehm 2003 and richa 2010 used the length scale associated with autocorrelation and variograms to define the rev mu et al 2016 discussed pore morphology based method to estimate rev although there are many definitions of rev for natural rocks the issue of rev is still very much in dispute for analysis of the rev we consider a sphere pack and five rock samples discussed in saxena et al 2017a b these rocks span a range of grain sizes from 0 05 to 0 5 mm and range in porosity from 5 to 25 these rocks are named b1 b5 fb24 fb33 and cg1 mini plugs of 5 mm diameter cylindrical cores were extracted from these formations and were subsequently imaged using the micro ct technique computerized tomography fig 6 the acquired image size for each micro ct gray scale image is 1992 2032 1992 voxels from each gray scale image a digital rock cube of 14003 voxels was extracted these samples were selected because they cover a range of compositions and textures that might be encountered in siliciclastic reservoirs the sphere packs and rock images segmented using otsu s method otsu 1979 are shown in fig 7 these segmented images were further subjected to watershed segmentation that separates individual grains so that the grain size distribution for each microstructure can be calculated fig 8 for these microstructures image size voxel size porosity autocorrelation length acl equation a 1 and effective grain diameter are listed in table 1 for these samples deff is slightly less the mean grain size shown in the histograms in fig 8 more detailed descriptions of these samples are included in appendix a 4 1 rev analysis using morphology based pore scale methods we first apply a morphology based pore scale method hilpert and miller 2001 mu et al 2016 to analyze the rev we define the rev as the smallest sample volume at which statistical variation of a specific rock property drops sharply morphology based methods analyze pore shapes and sizes instead of results from complete physics simulations using this approach we can analyze entrapment of a wetting phase during drainage and a non wetting phase during imbibition without simulation of multiphase flow therefore morphology based methods operate directly on the microstructures and are not impacted by boundary conditions using this methodology we can also analyze within a reasonable time frame the evolution of various rock properties with increasing sample length physical length of a digital cube in one dimension to perform the rev analysis we begin by calculating a given rock property e g total porosity for sub cubes extracted from a digital rock fig 9 next using the property value distribution we calculate the coefficient of variation cov 100x standard deviation mean a sharp decline in the cov allows us to analyze the rev for a given rock property the same approach is implemented to analyze the rev of various rock properties including total porosity connected porosity swanson permeability swanson 1981a trapped water saturation saturation of oil at breakthrough during drainage trapped oil and water saturations and surface to volume ratio we find that swanson permeability exhibits much larger variations or cov values when compared to total porosity fig 10 for all microstructures the cov for connected porosity is also generally larger than that for total porosity indicating a larger rev for the percolation threshold the covs for different rock properties decline at different rates with increasing sample length indicating a complex behavior for the determination of the rev for different rock properties therefore realistically no single threshold of the cov can be used to describe all rock properties the most complicated behavior is exhibited by oil saturation at breakthrough during drainage indicating that for relative permeability simulation even larger rev sizes are needed these observations are consistent with the findings of mu et al 2016 interestingly at a specific sample length the sphere pack shows the largest variations for any property fig 10 clearly physical sample length in mm or µm is not a good indicator of stability in rock properties or rev this is not surprising because the sphere pack has a much larger grain size plotting the variations with nrev sample length normalized with deff leads to a better indicator of rock property fluctuations i e cov moreover the trends for various rocks and sphere pack overlay fig 11 this allows us to describe property fluctuations or cov with a single trend for a specific rock property fig 12 4 2 rev analysis for flow based permeability we calculate single phase absolute permeability of the microstructures using various numerical solvers that simulate disparate boundary conditions in a flow unit the details of the numerical engines are presented separately in appendix b these numerical approaches can be broadly grouped into two categories the first category is of lattice boltzmann method lbm solvers which are fast and efficient ladd 1994 ladd and verberg 2001 the solvers in the second category are the so called voxel based solvers vbs that solve the stokes equation using the so called finite volume approach patankar 1980 van doormaal and raithby 1984 wiegmann 2007 a comprehensive review of these numerical solvers for digital rock analysis can be found in saxena et al 2017a using the simulated fluid flow results we now analyze the evolution of rev for the same digital rocks studied in the previous sections however unlike our analysis of the rev for rock properties calculated using morphology based methods it is not feasible to calculate permeability using flow simulations for every rock sub cube to analyze the associated statistical distribution instead we analyze the evolution of permeability computed for concentric rock sub cubes that have increasing volume fig 13 we begin with segmented rock images of volume 14003 i e m 1400 and subsequently remove the outer layers by 50 voxels from each side to reduce the cube length by 100 voxels such that the generated sub cubes share the same center we use five numerical approaches lbm 1 with open boundary condition in tangential direction and periodic condition in flow direction lbm 1 with closed boundary condition and periodic condition in flow direction lbm 2 with halfway bounce back boundary condition and periodic condition in flow direction vbs with periodic boundary conditions in both flow and tangential directions vbs with symmetric boundary condition in tangential direction and periodic boundary in flow direction consistent with our findings of variations in rock properties calculated using the morphology based method permeability computed for rocks b1 and fb24 show somewhat more complicated behavior among all microstructures fig 14 for all rocks the numerically computed permeability using the five approaches disagree by up to 200 for sample length 500 µm but the disagreement decreases to 20 as sample length approaches 2500 µm fig 14 moreover the mean permeability also attains a stable value with increase in rock volume variations in computed permeability occur due to both the choice of the numerical approach or boundary conditions and changes in rock volume to analyze further the influence of boundary conditions we compare the extracted flow fields for the same center 2563 sub cube using simulations computed for 10243 7683 5123 and 2563 concentric sub cubes we compare the extracted velocity fields computed using lbm 1 with open and closed boundary conditions in the tangential directions for the same concentric 2563 sub cube figs 15 18 again we see large changes in flow fields for rocks due to both changes in rock volume and the choice of boundary condition clearly permeability values that are calculated using flow simulations are impacted by both boundary conditions and changes in rock volume to quantify the effects of boundary conditions and sample volume we analyze statistics of computed results for sub cubes whose side length in voxels fall within 200 voxels for the rock in question we calculate the coefficient of variation cov 100x ratio of standard deviation and mean for the calculated permeability within a running window this process is described in fig 19 consistent with our findings of variations in morphology based rock properties with sample length we find that sample length is also not a good indicator of variations in flow based permeability fig 20 because the cov trends for rocks and a sphere pack are quite distinct the cov for rocks of side length of 2500 µm is 10 whereas for the sphere pack this value is much higher at 15 all curves for covs overlay if the results are plotted against nrev fig 21 this suggests that the ratio of sample length and dominant grain size nrev is a good indicator of numerical spread due to the choice of boundary condition and sample volume for all microstructures the cov in permeability drops below 15 when nrev becomes larger than 5 fig 21 this curve can be used to estimate the expected cov in computed permeability if sub rev size rock volumes are used for drp analysis the estimated cov for flow simulation based permeability is naturally larger than that estimated using the morphology based method 5 imaging requirements to resolve pore throats and achieve rev we now discuss the voxel size at which a rock should be imaged to 1 sufficiently resolve dominant pore throats for fluid flow and then 2 achieve rev because a micro ct detector can acquire only a limited number of voxels it is not guaranteed that a voxel size always exists that satisfies constraints of both pore throat resolution ni 10 and rev nrev 5 therefore we also discuss cases when it is not possible to achieve both constraints simultaneously due to the intrinsic rock properties for some of these cases additional analyses and corrections may allow for meaningful comparisons between simulation results and laboratory measurements of permeability but other cases may fall outside the current technical feasibility of drp this will be the topic of a future study a lower limit on voxel size δxmin is imposed by the requirement to achieve rev and is a function of deff nrev 5 and m eq 9 9 δ x m i n d e f f n r e v m minimizing the voxel size while maximizing the field of view current equipment capacity of m 2000 voxels results in the highest resolution of the pore throats ni for fluid flow while satisfying the minimum requirements for rev this is optimal for rocks with complex pore structures the plot on the left in fig 22 illustrates this concept using the cg1 microstructure fig 6 table 1 as an example this plot shows dd versus deff color coded by δxmin the dashed lines are different values of ni that can be achieved by imaging at δxmin in the case of cg1 for which dd 27 µm and deff 308 µm an ni 35 white dashed line can be imaged with δxmin 0 77 µm while still achieving the minimum requirement for rev i e nrev 5 note that for rocks with large effective grain size relative to small pore throats deff dd 40 it is not possible to achieve both rev and sufficiently resolve the pore throats even at the upper technical limit of m 2000 voxels on the other hand an upper limit on voxel size δxmax is imposed by the physical dimensions of the pore throat dd so a sufficient number of voxels are present to resolve it ni 10 10 δ x m a x d d n i maximizing the voxel size while achieving the minimum requirements for pore throat resolution i e ni 10 and rev i e nrev 5 defines the field of view that can be used to minimize computation time this is illustrated in the plot on the right in fig 22 using the cg1 microstructure fig 6 table 1 as an example this plot of dd versus deff is color coded by δxmax the dashed lines are different values of m that correspond to the fewest number of voxels per side required to meet both constraints in the case of cg1 the sample could be imaged with δxmax 2 7 µm and sub sampled such that m 570 and still achieve the minimum requirements for the rev and ni however the rev can be increased by maximizing both the voxel size and the image size this is optimal for heterogeneous and poorly sorted rocks with a broad distribution of grain sizes note that while most current micro ct detectors can capture images with m 2000 the image quality at the boundaries may be poor and an extraction of the image is often used for drp if for example if an image of only m 1000 voxels of sufficient image quality can be captured for segmentation and simulation then it is not possible to achieve both the rev and to resolve the pore throats for rocks with deff dd 20 the range of recommended voxel sizes for imaging cg1 and the other microstructures previously discussed are reported in table 1 these values assume values of m 700 for the sphere pack and m 1400 for the rocks the sphere pack cg1 and b5 were imaged within their recommended ranges for samples b1 and fb24 the recommendation is to image at a smaller voxel size than the 2 1 µm that was used to better resolve the pore throats sample fb33 which is very low porosity but with large grains falls outside the current technical feasibility of drp 6 conclusions imaging larger volumes of rocks for digital rock physics drp analysis improves the chances of achieving the representative elementary volume rev but often at the expense of image resolution this trade off exists due to finiteness of modern imaging detectors imaging and analyzing digital rocks that sample the rev but still sufficiently resolve pore throats is critical to ensure simulation quality and robustness of rock property trends for further analysis we find that typically 10 voxels are needed to sufficiently resolve pore throats for flow simulations rock properties calculated using digital rocks must 1 not change with change in rock volume and 2 must be insensitive to the choice of boundary conditions the rock volume for which both 1 and 2 are satisfied can be referred as the rev rock properties calculated using the pore morphology based methods are independent of boundary conditions and thus show lower variations with change in rock volume when compared to physics based simulations that are sensitive to the choice of boundary conditions variations in disparate rock properties decline at different rates indicating a complex behavior for the determination of the rev for rock properties no single threshold of the cov can be used to describe all rock properties for siliciclastic rocks swanson permeability calculated using pore morphology based method exhibit less variability when compared to flow based permeability effective grain diameter provides a robust estimate of rev we find that digital rocks with sample lengths greater than five times effective grain diameter exhibit relatively low variations cov 15 regardless of the method used to compute the rock properties moreover we define a range of reliable permeability that can be calculated using drp as a function of rock porosity and properties of the acquired image this work can also be used to select the appropriate voxel size at which a rock must be imaged to achieve rev and still resolve pores acknowledgments we thank nattavadee srisutthiyakorn saad saleh detlef holf hilko de jong jesse dietderich umang agarwal steffen berg dirk smit and nitish nair for discussions special thanks to jonas tolke for sharing the morphological workflow thanks to janos l urai and another anonymous reviewer for their comments and suggestions appendix a digital rocks sphere pack we describe each set of digital rock samples to provide geologic context to the segmentation and modeling this description validates comparisons between the samples and provides guidance for automatic segmentation rocks b1 and b5 are from the berea formation which is a sub angular to sub rounded mississippian age sandstone that has a mean grain size of approximately 350 µm and is moderately well sorted with a trask sorting coefficient of 1 40 x ray diffraction xrd analysis suggests that these rocks consist mainly of quartz but contain some dolomite in addition to clay minerals petrologic assessment of the samples indicates the presence of approximately 10 cement comprised of quartz and carbonates and macro porosity of roughly 20 in the quartz feldspar rock fragment qfr space both samples are sub litharenite meaning that they have more quartz grains and fewer rock fragments than the castlegate sample rocks fb24 and fb33 are from the fontainebleau formation which is a sub rounded to rounded oligocene age sandstone that has a mean grain size of approximately 450 µm and is moderately well sorted with a trask coefficient of 1 43 no xrd analysis of these sandstones was undertaken because petrographic assessment of the samples that they are nearly pure quartz roughly 20 of the samples is quartz cement resulting in relatively low porosity of approximately 8 12 fb33 when segmented does not have any connected porosity cg1 is from the castlegate formation of utah which is a sub angular to sub rounded mesozoic sandstone that has a mean grainsize of approximately 350 µm and is moderately sorted with a trask sorting coefficient of 1 69 xrd analysis indicates that the castlegate sandstone sample consists mainly of quartz grains petrologic assessment of the sample indicates a minimal quartz cement volume of between 2 and 3 with similar amounts of carbonate cement and approximately 19 macro porosity minor amounts of micas and clay minerals including muscovite kaolinite and mixed layer illite smectite were also documented in qfr space commonly used to categorize such rocks by their constituents the castlegate is a feldspathic litharenite with rock fragments dominantly being altered and unaltered volcanic rock fragments it is within these rock fragments that most the clays reside the synthetic sphere pack is taken from andrä et al 2013b each grain has a diameter of 700 µm for calculating the grain size distributions we approximate each grain as a sphere such that the sphere diameter is equal to the grain s major axis length we note a fair agreement between petrologically estimated grain size and that estimated numerically it must be noted that petrological analysis was performed on 2d thin sections whereas the digital grain size distributions were generated using 3d digital rocks in addition to the grain size we also calculate the autocorrelation length acl for the digital rocks and sphere pack acl is often defined as the lag at which the value of the autocorrelation function is 1 e of its original value zhang and sundararajan 2005 it is known that for segmented digital rocks the autocorrelation function a x at zero lag i e x 0 is equal to rock porosity and at infinite lag approaches square of porosity i e a 0 ϕ and a ϕ2 keehm 2003 keehm et al 2001 therefore we fit the following expression to obtain acl a 1 a x ϕ ϕ 2 e x a c l ϕ 2 in equation a 1 x is the lag φ is porosity and a x is the autocorrelation function appendix b flow solvers darcy s law states that the volume flux q of a viscous fluid per unit time through a sample of porous material is linearly proportional to the pressure difference δp applied to the opposite faces of the porous sample and the cross section area a and inversely proportional to the fluid viscosity η and sample length l b 1 q k a η δ p l the proportionality constant k is a fundamental property of the porous medium referred to as the absolute permeability which has units of length squared the most common permeability unit is darcy or mdarcy mdarcy such that 1 darcy 10 12 m2 and 1 mdarcy 10 15 m2 lbm 1 solver this solver type is an implementation of the lattice boltzmann method lbm using the d3q19 model ladd 1994 ladd and verberg 2001 the lbm solves a discrete meso scale form of the boltzmann equation he and luo 1997 which reduces to the incompressible navier stokes equation in the low mach number limit ladd 1994 ladd and verberg 2001 the lattice boltzmann method is a numerical scheme for solving transport equations the lbm approach is commonly used to study of flow in porous media at the pore scale cancelliere et al 1990 ferréol and rothman 1995 martys and chen 1996 sukop and thorne 2006 because of its computational efficiency and simplicity it is very well suited to solve for the flow in complex geometries for a general introduction to the lattice boltzmann theory we refer to benzi et al 1992 succi 2001 and keehm et al 2001 most lbm implementations for pore scale simulation utilize the bhatnagar gross krook collision operator bgk bhatnagar et al 1954 for halfway bounce back scheme at solid fluid boundaries however the bgk approach suffers from deficiencies such as viscosity dependent slip at the walls he et al 2008 and numerical instabilities on the other hand the multiple relaxation time mrt technique provides an effective cure to these deficiencies and offers greater flexibility for capturing complex flow physics lallemand et al 2003 lallemand and luo 2000 thus the mrt technique is implemented to the computational engine of the lbm based code for permeability estimation used in this study in the mrt technique different relaxation parameters are utilized for different linear combinations of the distribution functions the mrt method is described in detail in d humières et al 2002 and premnath and abraham 2007 a recent development in scientific computing is the so called general purpose computing on graphics processing units gpus gpus were developed in the 1990s to accelerate the rendering of images for output to a display since then the stream processing capabilities of gpus have been focused on scientific computing and the application to scientific computing has led to commercial lines of gpus that have thousands of double precision computation cores with error checking gpu computation can be even faster if a problem or computation lends itself to many lightweight computation threads such as lbm an implementation of the above discussed mrt lbm algorithm is specially made for nvidia gpu cards by use of the compute unified device architecture cuda programming language which is a variant of the c programming language with extra functions to control the device gpu from the host cpu in addition the mrt lbm code utilizes a one dimensional domain decomposition scheme with a single ghost layer communicating the solutions along domain boundaries the domain decomposition communications are managed by use of message passing interface mpi flow simulations were performed with mrt lbm on a large linux based cpu gpu hpc cluster to minimize the impact on other users all simulations were conducted using only four cluster nodes each with two tesla k80 gpu cards it is important to note that each tesla k80 has 5000 cuda cores and 24 gb of ram therefore the compute resource dedicated to each run can be summarized with 40 000 cuda cores and 200 gb of ram on average the mrt lbm code required 60 gb of ram for a given simulation the simulations utilized 100 of the gpu nodes processing potential in other words no two simultaneous simulation jobs were submitted to the same gpu nodes at the same time in the flow direction the loop boundary condition was enforced which acts like the periodic boundary condition simulations were run with both open with respect to flow and closed no flow in the tangential directions i e normal to the main flow direction lbm 2 solver this solver type is also an implementation of the lattice boltzmann method lbm for the incompressible stokes equation we use a d3q13 model with thirteen speeds as described in tölke and krafczyk 2008 without the nonlinear terms in the incompressible stokes equation tölke et al 2013 for this approach constant pressure boundary conditions are implemented at the inlet and outlet along with no slip boundary condition at the side walls once the numerical parameters in the scheme are chosen in a suitable manner the scheme has proven to be very competitive to state of the art solvers geller et al 2006 also complex multiscale problems can be addressed in an efficient manner with this method silva and ginzburg 2016 grid refinement with isotropic elements is efficient but when anisotropic elongated elements cells on an unstructured grid are needed the lbm approach is of limited use flow simulations using lbm 2 were performed on a large linux based cpu gpu hpc cluster as for the boundary conditions standard halfway bounce back scheme for lbm was implemented with inlet outlet boundaries the pressure is set such that flow is in laminar regime vbs solver the vbs solver is the simple fft solver in the geodict 2015 software offered by math2market gmbh the vbs solver is a fft accelerated variant of the semi implicit method for pressure linked equations or simple algorithm patankar 1980 van doormaal and raithby 1984 the vbs solver is also a finite volume method that operates on a staggered grid the method approximates the flow field by solving the momentum equation in which the pressure gradient term is set from an initial guess or calculated using the pressure distribution from the previous iteration the pressure correction equation is formulated and solved to obtain a new pressure distribution that is then used to correct the velocities the iterations continue until they reach a certain stopping criterion for porous media due to their complex connectivity the simple algorithm has difficulty converging to the solution of the steady state stokes equations solving the pressure correction equation was identified as the bottleneck of convergence because the inaccuracy of the pressure correction step requires excessively many iterations the fft is then used to solve the pressure correction poisson equation instead of just taking a step wiegmann 2007 this reduces the iterations and computation times dramatically even though the cost of an individual iteration rises significantly vbs allows us to model a variety of boundary conditions including periodic in flow direction with an implicitly added inflow outflow region and symmetric boundary conditions in flow direction similarly in tangential direction the solver supports periodic symmetric and no slip domain boundary conditions vbs computes on the uniform cartesian grid of a 3d image the variables inside the solid are enforced to zero vbs has its advantages when solving structures with low porosity since pressure correction can be propagated to the velocity correction quickly on the other hand when porosity is higher there are more unknowns and the momentum equations need lots of iterations to solve the velocity field even though the pressure correction can be easily found with fft algorithm the memory consumption of vbs is decided by the grid size regardless of the porosity simulations with vbs were run with periodic and symmetric boundary conditions in the flow direction whereas periodic boundary conditions were enforced in the tangential direction pressure difference mean velocity and flowrate were chosen to maintain laminar flow supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 001 appendix c supplementary materials image application 1 adler et al 1990 p m adler c g jacquin j a quiblier flow in simulated porous media int j multiph flow 16 1990 691 712 10 1016 0301 9322 90 90025 e alpak et al 2018 f o alpak f gray n saxena j dietderich r hofmann s berg a distributed parallel multiple relaxation time lattice boltzmann method on general purpose graphics processing units for the rapid and scalable computation of absolute permeability from high resolution 3d micro ct images comput geosci 2018 10 1007 s10596 018 9727 7 andrä et al 2013a h andrä n combaret j dvorkin e glatt han j m kabel y keehm f krzikalla lee m c madonna m marsh t mukerji e h saenger r sain n saxena s ricker a wiegmann zhan x digital rock physics benchmarks part ii computing effective properties comput geosci 50 2013 33 43 10 1016 j cageo 2012 09 008 andrä et al 2013b h andrä n combaret j dvorkin e glatt han j m kabel y keehm f krzikalla lee m c madonna m marsh t mukerji e h saenger r sain n saxena s ricker a wiegmann zhan x digital rock physics benchmarks part i imaging and segmentation comput geosci 50 2013 25 32 10 1016 j cageo 2012 09 005 arns et al 2005 c h arns f bauget a limaye a sakellariou t senden a sheppard r m sok v pinczewski s bakke l i berge p oren m knackstedt pore scale characterization of carbonates using x ray microtomography spe j 10 2005 26 29 10 2118 90368 pa arns et al 2002 c h arns m a knackstedt w v pinczewski e j garboczi computation of linear elastic properties from microtomographic images methodology and agreement between theory and experiment geophysics 67 2002 1396 10 1190 1 1512785 bear 1975 j bear dynamics of fluids in porous media soil sci 1975 10 1097 00010694 197508000 00022 benzi et al 1992 r benzi s succi m vergassola the lattice boltzmann equation theory and applications phys rep 1992 10 1016 0370 1573 92 90090 m berryman and blair 1986 j g berryman s c blair use of digital image analysis to estimate fluid permeability of porous materials application of two point correlation functions j appl phys 60 1986 1930 1938 10 1063 1 337245 bhatnagar et al 1954 p l bhatnagar e p gross m krook a model for collision processes in gases i small amplitude processes in charged and neutral one component systems phys rev 94 1954 511 525 10 1103 physrev 94 511 blunt et al 2013 m j blunt b bijeljic dong h o gharbi s iglauer p mostaghimi a paluszny c pentland pore scale imaging and modelling adv water resour 51 2013 197 216 10 1016 j advwatres 2012 03 003 cancelliere et al 1990 a cancelliere chang c e foti d h rothman s succi the permeability of a random medium comparison of simulation with theory phys fluids a fluid dyn 2 1990 2085 2088 10 1063 1 857793 costanza robinson et al 2011 m s costanza robinson b d estabrook d f fouhey representative elementary volume estimation for porosity moisture saturation and air water interfacial areas in unsaturated porous media data quality implications water resour res 47 2011 10 1029 2010wr009655 n a n a d humières et al 2002 d d humières i ginzburg m krafczyk p lallemand luo l s multiple relaxation time lattice boltzmann models in three dimensions philos trans a math phys eng sci 360 2002 437 451 10 1098 rsta 2001 0955 desbois et al 2011 g desbois j l urai p a kukla j konstanty c baerle high resolution 3d fabric and porosity model in a tight gas sandstone reservoir a new approach to investigate microstructures from mm to nm scale combining argon beam cross sectioning and sem imaging j pet sci eng 78 2011 243 257 10 1016 j petrol 2011 06 004 dvorkin et al 2008 j dvorkin m armbruster c baldwin fang q n derzhi c gomez nur b nur a mu y the future of rock physics computational methods vs lab testing first break 26 2008 63 68 dvorkin et al 2011 j dvorkin n derzhi e diaz fang q relevance of computational rock physics geophysics 76 2011 e141 e153 10 1190 geo2010 0352 1 ferréol and rothman 1995 b ferréol d h rothman lattice boltzmann simulations of flow through fontainebleau sandstone transp porous media 20 1995 3 20 10 1007 bf00616923 geller et al 2006 s geller m krafczyk j tölke s turek j hron benchmark computations based on lattice boltzmann finite element and finite volume methods for laminar flows comput fluids 35 2006 888 897 10 1016 j compfluid 2005 08 009 gitman et al 2007 i m gitman h askes l j sluys representative volume existence and size determination eng fract mech 74 2007 2518 2534 10 1016 j engfracmech 2006 12 021 he et al 2008 he s c ariyaratne a e vardy a computational study of wall friction and turbulence dynamics in accelerating pipe flows comput fluids 37 2008 674 689 10 1016 j compfluid 2007 09 001 he and luo 1997 he x luo l s theory of the lattice boltzmann method from the boltzmann equation to the lattice boltzmann equation phys rev e 56 1997 6811 6817 10 1103 physreve 56 6811 hemes et al 2015 s hemes g desbois j l urai b schröppel j o schwarz multi scale characterization of porosity in boom clay hades level mol belgium using a combination of x ray μ ct 2d bib sem and fib sem tomography microporous mesoporous mater 208 2015 1 20 10 1016 j micromeso 2015 01 022 hill 1963 r hill elastic properties of reinforced solids some theoretical principles j mech phys solids 11 1963 357 372 10 1016 0022 5096 63 90036 x hilpert and miller 2001 m hilpert c t miller pore morphology based simulation of drainage in totally wetting porous media adv water resour 24 2001 243 255 10 1016 s0309 1708 00 00056 7 houben et al 2013 m e houben g desbois j l urai pore morphology and distribution in the shaly facies of opalinus clay mont terri switzerland insights from representative 2d bib sem investigations on mm to nm scale appl clay sci 71 2013 82 97 10 1016 j clay 2012 11 006 huet 1990 c huet application of variational concepts to size effects in elastic heterogeneous bodies j mech phys solids 38 1990 813 841 10 1016 0022 5096 90 90041 2 kanckstedt et al 2001 m a kanckstedt a p sheppard m sahimi pore network modelling of two phase flow in porous rock the effect of correlated heterogeneity adv water resour 24 2001 257 277 10 1016 s0309 1708 00 00057 9 kanit et al 2003 t kanit s forest i galliet v mounoury d jeulin determination of the size of the representative volume element for random composites statistical and numerical approach int j solids struct 40 2003 3647 3679 10 1016 s0020 7683 03 00143 4 keehm 2003 y keehm computational rock physics transport properties in porous media and applications 2003 stanford university keehm et al 2001 y keehm t mukerji a nur computational rock physics at the pore scale transport properties and diagenesis in realistic pore geometries lead edge 2001 10 1190 1 1438904 knackstedt et al 2008 m a knackstedt c arns m madadi a p sheppard s latham r sok g bächle g eberli elastic and flow properties of carbonate core derived from 3d x ray ct images seg tech progr expand abstr 27 2008 1804 1809 10 1190 1 3059394 knackstedt et al 2009 m knackstedt s latham m madadi a sheppard t varslot c arns digital rock physics 3d imaging of core material and correlations to acoustic and flow properties lead edge 28 2009 28 33 10 1190 1 3064143 ladd 1994 a j c ladd numerical simulations of particulate suspensions via a discretized boltzmann equation part i theoretical foundation j fluid mech 271 1994 285 309 10 1017 s0022112094001771 ladd and verberg 2001 a j c ladd r verberg lattice boltzmann simulations of particle fluid suspensions j stat phys 2001 10 1023 a 1010414013942 lallemand et al 2003 p lallemand d d humières luo l s r rubinstein theory of the lattice boltzmann method three dimensional model for linear viscoelastic fluids phys rev e 67 2003 21203 10 1103 physreve 67 021203 lallemand and luo 2000 p lallemand luo l s theory of the lattice boltzmann method dispersion dissipation isotropy galilean invariance and stability phys rev e 61 2000 6546 6562 10 1103 physreve 61 6546 martys and chen 1996 n martys chen h simulation of multicomponent fluids in complex three dimensional geometries by the lattice boltzmann method phys rev e 53 1996 743 750 10 1103 physreve 53 743 mu et al 2016 mu y r sungkorn j toelke identifying the representative flow unit for capillary dominated two phase flow in porous media using morphology based pore scale modeling adv water resour 95 2016 16 28 10 1016 j advwatres 2016 02 004 øren et al 2006 p øren s bakke h rueslåtten digital core laboratory rock and flow properties derived from computer generated rocks proceedings of the international symposium of the society of core analysts 2006 1 12 otsu 1979 otsu n a threshold selection method from gray level histograms ieee trans syst man cybern 9 1979 62 66 10 1109 tsmc 1979 4310076 patankar 1980 patankar s v 1980 numerical heat transfer and fluid flow series in computational methods in mechanics and thermal sciences doi 10 1017 s0022112086212148 pelissou et al 2009 c pelissou j baccou y monerie f perales determination of the size of the representative volume element for random quasi brittle composites int j solids struct 46 2009 2842 2855 10 1016 j ijsolstr 2009 03 015 premnath and abraham 2007 k n premnath j abraham three dimensional multi relaxation time mrt lattice boltzmann models for multiphase flow j comput phys 224 2007 539 559 10 1016 j jcp 2006 10 023 richa 2010 r richa preservation of transport properties trends computational rock physics approach 2010 stanford university rumpf and gupte 1971 h c h rumpf a r gupte einflüsse der porosität und korngrößenverteilung im widerstandsgesetz der porenströmung chem ing tech 43 1971 367 375 10 1002 cite 330430610 cit sab 1992 k sab on the homogenization and the simulation of random materials eur j mech a solids 11 1992 585 607 saenger 2008 e h saenger numerical methods to determine effective elastic properties int j eng sci 46 2008 598 605 10 1016 j ijengsci 2008 01 005 saenger et al 2011 e h saenger f enzmann y keehm h steeb digital rock physics effect of fluid viscosity on effective elastic properties j appl geophys 74 2011 236 241 10 1016 j jappgeo 2011 06 001 sain et al 2014 r sain t mukerji g mavko how computational rock physics tools can be used to simulate geologic processes understand pore scale heterogeneity and refine theoretical models lead edge 33 2014 324 334 10 1190 tle33030324 1 saxena et al 2017a n saxena r hofmann f o alpak s berg j dietderich u agarwal k tandon s hunter j freeman o wilson and benchmarks for pore scale flow simulated using micro ct images of porous media and digital rocks adv water resour 109 2017 211 235 10 1016 j advwatres 2017 09 007 saxena et al 2017b n saxena r hofmann f o alpak s berg j dietderich u agarwal k tandon s hunter j freeman o b wilson 
815,this study defines the optimal operating envelope of the digital rock technology from the perspective of imaging and numerical simulations of transport properties imaging larger volumes of rocks for digital rock physics drp analysis improves the chances of achieving a representative elementary volume rev at which flow based simulations 1 do not vary with change in rock volume and 2 is insensitive to the choice of boundary conditions however this often comes at the expense of image resolution this trade off exists due to the finiteness of current state of the art imaging detectors imaging and analyzing digital rocks that sample the rev and still sufficiently resolve pore throats is critical to ensure simulation quality and robustness of rock property trends for further analysis we find that at least 10 voxels are needed to sufficiently resolve pore throats for single phase fluid flow simulations if this condition is not met additional analyses and corrections may allow for meaningful comparisons between simulation results and laboratory measurements of permeability but some cases may fall outside the current technical feasibility of drp on the other hand we find that the ratio of field of view and effective grain size provides a reliable measure of the rev for siliciclastic rocks if this ratio is greater than 5 the coefficient of variation for single phase permeability simulations drops below 15 these imaging considerations are crucial when comparing digitally computed rock flow properties with those measured in the laboratory we find that the current imaging methods are sufficient to achieve both rev with respect to numerical boundary conditions and required image resolution to perform digital core analysis for coarse to fine grained sandstones keywords digital rock permeability petrology numerical solutions rev 1 introduction digital rock physics drp analyses include image based computation of flow properties of reservoir rocks subsurface hydrogeological properties mechanical properties such as elastic moduli electromagnetic properties thermal properties and other averaged quantities of porous media drp also aims to improve our understanding of how multiphysics evolves from pore scale to meso scale drp complements and in some cases replaces the need for relatively slow laboratory based measurements and empirical rock property models drp can lead to more faster and cheaper core analysis and generate early data for project acceleration furthermore in the last decade or so drp has evolved into an active field of multidisciplinary research adler et al 1990 andrä et al 2013a b arns et al 2005 2002 berryman and blair 1986 blunt et al 2013 dvorkin et al 2011 2008 kanckstedt et al 2001 knackstedt et al 2008 knackstedt et al 2009 øren et al 2006 saenger 2008 saenger et al 2011 sain et al 2014 saxena and mavko 2016 saxena et al 2017b saxena et al 2017c we discuss imaging considerations of rocks to compute transport properties in terms of two fundamental quantities 1 the ratio of dominant pore throat size to voxel size and 2 the ratio of field of view of the acquired image and a measure of grain size the first constraint is linked to quality of image resolution whereas the second constraint is related to achieving the representative elementary volume rev for numerical simulations of flow properties due to the finiteness of modern imaging detectors e g x ray micro computed tomography there exists a tradeoff between achieving rev and resolving pore throats as an illustration of this tradeoff consider the example in fig 1 the same rock is imaged with different voxel sizes e g 0 3 2 4 and 9 80 µm such that all acquired images have 1024 voxels on each side these are transmitted light optical microscope from a thin section that has 30 µm thickness also shown are the corresponding segmented images we note that the pores in the fine resolution i e smaller voxel size image are very well resolved but the image is unlikely to be large enough physically to achieve the rev on the other hand the coarse resolution image is probably the rev but the pores are not resolved to this end we first analyze imaging considerations to sufficiently resolve pore throats subsequently we establish constraints for the rev by analyzing the variation in various rock properties calculated using pore morphology based methods with increasing rock volume furthermore we analyze the variation in computed permeability for volumes of various sizes using four different numerical flow simulation approaches with multiple boundary conditions based on our findings we discuss the minimum considerations for imaging rocks to calculate reliable digital rock properties estimations 2 limits imposed due to imaging image quality voxel size and limited field of view all put constraints on flow properties that can be calculated using the digital rock technology two dimensionless parameters that describe these effects are 1 the ratio of dominant pore throat size to voxel size ni and 2 the ratio of field of view of the acquired image and effective grain size nrev we define these two parameters as follows 1 n i d d δ x 2 n r e v l d e f f in eqs 1 and 2 δx is image voxel size l is the field of view or length of the digital rock in any direction dd is the pore throat size corresponding to the so called mercury entry pressure denoted here by pd parameters pd and dd are related by pd 2σcos θ dd where σ is mercury air surface tension 480 dyne cm and θ is the contact angle 40 if pd is expressed in psi and dd is expressed µm then 2σcos θ 213 the entry pressure pd can be directly measured in a mercury injection capillary pressure micp experiment swanson 1981a thomeer 1983 1960 alternatively pd and dd can also be inferred using image based simulations hilpert and miller 2001 many rocks exhibit dual pore structures desbois et al 2011 hemes et al 2015 houben et al 2013 and cannot be sufficiently described by a single dominant pore throat in such cases multiple ni parameters must be used deff is the effective grain diameter for permeability rumpf and gupte 1971 defined as 3 d e f f d 2 n d d d d 3 n d d d where n d is the number distribution of each grain diameter the effective grain diameter deff can be calculated using grain size distribution measured in a laboratory e g sieve analysis and can also be inferred using image based algorithms therefore both parameters ni and nrev can be estimated directly using a 3d digital rock image the effective grain diameter deff is a complicated function of the entry pore throat size dd such a relationship also depends on many other textural parameters including porosity coordination number rock type and grain shape the parameter ni describes the quality of image resolution whereas the parameter nrev describes the number of grains captured in an image to sample the desired heterogeneity in an ideal scenario we would like to image as fine and as large as possible i e ni and nrev but this is simply not possible due to limitations of imaging techniques most imaging devices e g x ray micro computed tomography micro ct can accommodate only a predefined number of voxels m 3 even through the micro ct detectors are rapidly improving the current detectors capture fewer than 20003 voxels i e m 2000 in the lateral direction therefore the rev can be achieved by sampling larger rock volumes but only at the expense of coarser image resolution one can choose to image a larger field of view i e physical dimension at coarse resolution or image a smaller piece of rock at higher resolution thus there is a tradeoff between sampling sufficiently many grains pores to achieve the rev and still resolve pore throats to maintain quality of numerical simulations on images given this trade off we will now illustrate how the two imaging parameters ni and nrev impact the computed permeability using simple empirical permeability relation the minimum value of parameter ni that is needed to capture sufficient structural complexity of rock microstructure and maintain simulation quality puts a loose lower bound on permeability that can be reliably calculated using an image this is because permeability depends on physical dimensions of pore throat which must be larger than the voxel size to be visible in an image using an empirical relation between pore throat size and permeability we will now illustrate how the parameter ni that depends on both voxel size δx and pore throat size dd controls the lowest permeability that can be reliably calculated using a digital rock image thomeer 1983 proposed the following empirical relation that relates brine permeability to entry pressure pd from a micp measurement 4 k 38 068 g 4 3 ϕ p d 2 in eq 4 k is absolute permeability in mdarcy ϕ is total rock porosity in fraction pd is the entry pressure for mercury injection in psi and g is a dimensionless pore shape parameter g varies between 0 1 0 2 for siliciclastic rocks and 0 2 0 3 for carbonates rocks eq 4 can also be written in terms of diameter of the entry pore throat dd in µm as 5 k 38 068 g 4 3 ϕ d d 213 2 substituting eq 1 in eq 5 we obtain 6 k 38068 g 4 3 ϕ δ x n i 213 2 the smallest possible value of parameter ni is simply 1 when pore throat size is same as the voxel size such a case would correspond to a heavily pixelated digital rock image substituting ni 1 in eq 6 2 µm voxel size i e δx 2 µm and 20 porosity i e ϕ 0 2 we calculate a permeability of 1 mdarcy that is the smallest permeability that can be calculated for such a digital image which still somehow contains a network of connected pores for this analysis we assume g 0 2 assuming a minimum value of ni 10 an image of voxel size δx 2 µm and ϕ 0 2 yields k 100 mdarcy as the smallest permeability that can be reliably calculated using an image of 2 µm voxel size if the actual permeability of the rock in question is lower than 100 mdarcy then an image of higher resolution should be acquired any computation carried out on an image or below the total porosity and permeability trend defined by eq 6 will need to be corrected here we assumed a minimum value of ni 10 however in practice the required minimum value of ni will increase with complexity of the pore shape this will be addressed in a future study we must note that although thomeer s permeability relation in eq 4 is an empirical relation this relation has been extensively calibrated using laboratory measured data micp and brine permeability and petrographic interpretations from many reservoir sandstone rocks it yields results that agree with laboratory measured brine permeability within a factor of 2 similar analysis can be performed using other empirical models e g swanson 1981b similar to the analysis above the minimum required value of parameter nrev imposes a loose upper bound on image computed permeability this is because there is an upper limit on the size of grains that can be fit in an image which naturally translates to an upper bound on permeability to illustrate this we again use thomeer s permeability relation in order to use the same permeability relation in eq 5 for convenience we consider the following relation between dd and deff 7 d e f f d d a ϕ b the relation in eq 7 is motivated by observations from analyzing an internal shell database of laboratory measurements of micp and laboratory measured effective grain size in siliciclastic rocks fig 2 the relevance of the red line corresponding to deff dd 40 is discussed in a later section it is important to note that the empirical relation in eq 7 is not universal and is only used here for the sake of illustration substituting eq 7 into eq 5 we obtain a loose upper bound on permeability 8 k 38068 g 4 3 ϕ m δ x 213 a ϕ b n r e v 2 assuming nrev 5 m 1400 g 0 2 a 0 5 b 2 δx 2 µm and ϕ 0 2 yields k 570 mdarcy as the largest permeability that can be reliably calculated using an image of 2 µm voxel size so that rev requirements are satisfied therefore the range of reliable permeability that can be calculated using an image of 2 µm voxel size for a 20 porosity rock is 100 570 mdarcy assuming the parameters described above this range is only a rough guide but represents the optimum working range for drp simulations fig 3 shows the region defined by eqs 6 and 8 of permeability that can be calculated using images of voxel sizes 1 2 and 4 µm as a function of porosity assuming m 1400 nrev 5 and ni 10 also shown in fig 3 is the region spanned by high resolution 2 dimensional colored thin sections that often have a voxel size of 0 1 µm and m 30 000 in the subsequent sections we seek to establish the minimum requirements for parameters nrev and ni 3 resolving pore throats we now estimate the minimum value of ni needed to resolve pore throats and compute properties that are nearly independent of how an image is discretized to establish the variation of porosity and permeability for rocks with a change in voxel size we down sample a high resolution rock originally acquired with voxel size of 0 3 µm using bi cubic interpolation all images were then segmented using a thresholding method saxena et al 2017b next we simulate flow using a lattice boltzmann lbm solver described in alpak et al 2018 saxena et al 2017b and also simulate micp curve hilpert and miller 2001 to calculate pd dd and ni we subsequently normalize all permeability values with that computed for the original high resolution image fig 4 we note that coarsening of the voxel size leads to an increase in permeability up to 30 40 and at least 10 voxels i e ni 10 are needed to divide the pore diameter finely enough to achieve a stable solution of permeability for a more quantitative analysis we imaged a rock at two different resolutions voxel size of 4 µm and 8 µm using a state of the art micro ct detector the two images were processed for noise removal and then segmented with a thresholding algorithm next permeability was computed for the same field of view using the two images acquired at two resolutions we find that computed permeability systematically increases with coarsening of voxels and conclude that at least 10 voxels are needed to achieve numerical solutions that are accurate up to a factor of 2 fig 5 4 representative elementary volume rev one of the most important steps in drp is to identify the smallest field of view at random that can be used for a morphology based or physics based simulation so as to be representative of the whole rock for a given property bear 1975 hill 1963 torquato 1991 rev is a function of parameter nrev this volume is also commonly referred to as the representative elementary volume rev or the representative volume element rve a reliable estimate of the rev can help optimize imaging and computational effort as well as help mitigate situations where erroneous computational findings are overanalyzed as actual macroscale physics the rev of periodic materials e g cubic packing is relatively straightforward as one can simply analyze a periodic unit cell which can be defined only if one is supplied with prior knowledge of the type of periodicity involved to simulate properties for the entire media with appropriate boundary conditions e g periodic symmetric however when dealing with random heterogenous media e g natural rocks defining the rev is considerably more complicated kanit et al 2003 gitman et al 2007 pelissou et al 2009 costanza robinson et al 2011 in treatment of elasticity problems hill 1963 proposed two somewhat interrelated measures of the rev 1 volume that is entirely typical of the whole mixture on average and 2 volume that contains enough inclusions for the apparent properties to be independent of the surface values of traction and displacement so long as these values are macroscopically uniform huet 1990 sab 1992 both statements 1 and 2 are also applicable for other properties and not just elasticity and it is well known that such a measure of the rev depends on the effective property in question kanit et al 2003 statement 1 refers to homogeneity of a material s statistics for a specific property while statement 2 alludes to the independence of the effective constitutive response with respect to the applied boundary conditions rock porosity at the grain scale fluctuates between 0 i e 100 grain and 1 i e 100 pore but as the rock volume approaches the rev porosity attains a stable value until the lithology changes therefore numerical calculation of porosity does not involve any boundary conditions because it is simply the ratio between the number of pore voxels and the total number of voxels the term voxel size refers to physical dimensions of image pixel similarly the rev of other rock properties that are calculated using pore morphology based methods e g estimating pore size distribution using inscribed spheres is also independent of boundary conditions however rock properties calculated using a physics based simulation e g stokes flow depend not only on pore morphology but also on the choice of boundary conditions and thus must satisfy both statements 1 and 2 this naturally implies larger rev for a specific rock property calculated using physics based simulations then those estimated using morphology based methods for rocks arns et al 2002 defined the rev of a digital sample as the smallest volume that has minimal variability in the geometric descriptors such as porosity and specific surface area kanit et al 2003 provide a comprehensive study of statistical measures of rev keehm 2003 and richa 2010 used the length scale associated with autocorrelation and variograms to define the rev mu et al 2016 discussed pore morphology based method to estimate rev although there are many definitions of rev for natural rocks the issue of rev is still very much in dispute for analysis of the rev we consider a sphere pack and five rock samples discussed in saxena et al 2017a b these rocks span a range of grain sizes from 0 05 to 0 5 mm and range in porosity from 5 to 25 these rocks are named b1 b5 fb24 fb33 and cg1 mini plugs of 5 mm diameter cylindrical cores were extracted from these formations and were subsequently imaged using the micro ct technique computerized tomography fig 6 the acquired image size for each micro ct gray scale image is 1992 2032 1992 voxels from each gray scale image a digital rock cube of 14003 voxels was extracted these samples were selected because they cover a range of compositions and textures that might be encountered in siliciclastic reservoirs the sphere packs and rock images segmented using otsu s method otsu 1979 are shown in fig 7 these segmented images were further subjected to watershed segmentation that separates individual grains so that the grain size distribution for each microstructure can be calculated fig 8 for these microstructures image size voxel size porosity autocorrelation length acl equation a 1 and effective grain diameter are listed in table 1 for these samples deff is slightly less the mean grain size shown in the histograms in fig 8 more detailed descriptions of these samples are included in appendix a 4 1 rev analysis using morphology based pore scale methods we first apply a morphology based pore scale method hilpert and miller 2001 mu et al 2016 to analyze the rev we define the rev as the smallest sample volume at which statistical variation of a specific rock property drops sharply morphology based methods analyze pore shapes and sizes instead of results from complete physics simulations using this approach we can analyze entrapment of a wetting phase during drainage and a non wetting phase during imbibition without simulation of multiphase flow therefore morphology based methods operate directly on the microstructures and are not impacted by boundary conditions using this methodology we can also analyze within a reasonable time frame the evolution of various rock properties with increasing sample length physical length of a digital cube in one dimension to perform the rev analysis we begin by calculating a given rock property e g total porosity for sub cubes extracted from a digital rock fig 9 next using the property value distribution we calculate the coefficient of variation cov 100x standard deviation mean a sharp decline in the cov allows us to analyze the rev for a given rock property the same approach is implemented to analyze the rev of various rock properties including total porosity connected porosity swanson permeability swanson 1981a trapped water saturation saturation of oil at breakthrough during drainage trapped oil and water saturations and surface to volume ratio we find that swanson permeability exhibits much larger variations or cov values when compared to total porosity fig 10 for all microstructures the cov for connected porosity is also generally larger than that for total porosity indicating a larger rev for the percolation threshold the covs for different rock properties decline at different rates with increasing sample length indicating a complex behavior for the determination of the rev for different rock properties therefore realistically no single threshold of the cov can be used to describe all rock properties the most complicated behavior is exhibited by oil saturation at breakthrough during drainage indicating that for relative permeability simulation even larger rev sizes are needed these observations are consistent with the findings of mu et al 2016 interestingly at a specific sample length the sphere pack shows the largest variations for any property fig 10 clearly physical sample length in mm or µm is not a good indicator of stability in rock properties or rev this is not surprising because the sphere pack has a much larger grain size plotting the variations with nrev sample length normalized with deff leads to a better indicator of rock property fluctuations i e cov moreover the trends for various rocks and sphere pack overlay fig 11 this allows us to describe property fluctuations or cov with a single trend for a specific rock property fig 12 4 2 rev analysis for flow based permeability we calculate single phase absolute permeability of the microstructures using various numerical solvers that simulate disparate boundary conditions in a flow unit the details of the numerical engines are presented separately in appendix b these numerical approaches can be broadly grouped into two categories the first category is of lattice boltzmann method lbm solvers which are fast and efficient ladd 1994 ladd and verberg 2001 the solvers in the second category are the so called voxel based solvers vbs that solve the stokes equation using the so called finite volume approach patankar 1980 van doormaal and raithby 1984 wiegmann 2007 a comprehensive review of these numerical solvers for digital rock analysis can be found in saxena et al 2017a using the simulated fluid flow results we now analyze the evolution of rev for the same digital rocks studied in the previous sections however unlike our analysis of the rev for rock properties calculated using morphology based methods it is not feasible to calculate permeability using flow simulations for every rock sub cube to analyze the associated statistical distribution instead we analyze the evolution of permeability computed for concentric rock sub cubes that have increasing volume fig 13 we begin with segmented rock images of volume 14003 i e m 1400 and subsequently remove the outer layers by 50 voxels from each side to reduce the cube length by 100 voxels such that the generated sub cubes share the same center we use five numerical approaches lbm 1 with open boundary condition in tangential direction and periodic condition in flow direction lbm 1 with closed boundary condition and periodic condition in flow direction lbm 2 with halfway bounce back boundary condition and periodic condition in flow direction vbs with periodic boundary conditions in both flow and tangential directions vbs with symmetric boundary condition in tangential direction and periodic boundary in flow direction consistent with our findings of variations in rock properties calculated using the morphology based method permeability computed for rocks b1 and fb24 show somewhat more complicated behavior among all microstructures fig 14 for all rocks the numerically computed permeability using the five approaches disagree by up to 200 for sample length 500 µm but the disagreement decreases to 20 as sample length approaches 2500 µm fig 14 moreover the mean permeability also attains a stable value with increase in rock volume variations in computed permeability occur due to both the choice of the numerical approach or boundary conditions and changes in rock volume to analyze further the influence of boundary conditions we compare the extracted flow fields for the same center 2563 sub cube using simulations computed for 10243 7683 5123 and 2563 concentric sub cubes we compare the extracted velocity fields computed using lbm 1 with open and closed boundary conditions in the tangential directions for the same concentric 2563 sub cube figs 15 18 again we see large changes in flow fields for rocks due to both changes in rock volume and the choice of boundary condition clearly permeability values that are calculated using flow simulations are impacted by both boundary conditions and changes in rock volume to quantify the effects of boundary conditions and sample volume we analyze statistics of computed results for sub cubes whose side length in voxels fall within 200 voxels for the rock in question we calculate the coefficient of variation cov 100x ratio of standard deviation and mean for the calculated permeability within a running window this process is described in fig 19 consistent with our findings of variations in morphology based rock properties with sample length we find that sample length is also not a good indicator of variations in flow based permeability fig 20 because the cov trends for rocks and a sphere pack are quite distinct the cov for rocks of side length of 2500 µm is 10 whereas for the sphere pack this value is much higher at 15 all curves for covs overlay if the results are plotted against nrev fig 21 this suggests that the ratio of sample length and dominant grain size nrev is a good indicator of numerical spread due to the choice of boundary condition and sample volume for all microstructures the cov in permeability drops below 15 when nrev becomes larger than 5 fig 21 this curve can be used to estimate the expected cov in computed permeability if sub rev size rock volumes are used for drp analysis the estimated cov for flow simulation based permeability is naturally larger than that estimated using the morphology based method 5 imaging requirements to resolve pore throats and achieve rev we now discuss the voxel size at which a rock should be imaged to 1 sufficiently resolve dominant pore throats for fluid flow and then 2 achieve rev because a micro ct detector can acquire only a limited number of voxels it is not guaranteed that a voxel size always exists that satisfies constraints of both pore throat resolution ni 10 and rev nrev 5 therefore we also discuss cases when it is not possible to achieve both constraints simultaneously due to the intrinsic rock properties for some of these cases additional analyses and corrections may allow for meaningful comparisons between simulation results and laboratory measurements of permeability but other cases may fall outside the current technical feasibility of drp this will be the topic of a future study a lower limit on voxel size δxmin is imposed by the requirement to achieve rev and is a function of deff nrev 5 and m eq 9 9 δ x m i n d e f f n r e v m minimizing the voxel size while maximizing the field of view current equipment capacity of m 2000 voxels results in the highest resolution of the pore throats ni for fluid flow while satisfying the minimum requirements for rev this is optimal for rocks with complex pore structures the plot on the left in fig 22 illustrates this concept using the cg1 microstructure fig 6 table 1 as an example this plot shows dd versus deff color coded by δxmin the dashed lines are different values of ni that can be achieved by imaging at δxmin in the case of cg1 for which dd 27 µm and deff 308 µm an ni 35 white dashed line can be imaged with δxmin 0 77 µm while still achieving the minimum requirement for rev i e nrev 5 note that for rocks with large effective grain size relative to small pore throats deff dd 40 it is not possible to achieve both rev and sufficiently resolve the pore throats even at the upper technical limit of m 2000 voxels on the other hand an upper limit on voxel size δxmax is imposed by the physical dimensions of the pore throat dd so a sufficient number of voxels are present to resolve it ni 10 10 δ x m a x d d n i maximizing the voxel size while achieving the minimum requirements for pore throat resolution i e ni 10 and rev i e nrev 5 defines the field of view that can be used to minimize computation time this is illustrated in the plot on the right in fig 22 using the cg1 microstructure fig 6 table 1 as an example this plot of dd versus deff is color coded by δxmax the dashed lines are different values of m that correspond to the fewest number of voxels per side required to meet both constraints in the case of cg1 the sample could be imaged with δxmax 2 7 µm and sub sampled such that m 570 and still achieve the minimum requirements for the rev and ni however the rev can be increased by maximizing both the voxel size and the image size this is optimal for heterogeneous and poorly sorted rocks with a broad distribution of grain sizes note that while most current micro ct detectors can capture images with m 2000 the image quality at the boundaries may be poor and an extraction of the image is often used for drp if for example if an image of only m 1000 voxels of sufficient image quality can be captured for segmentation and simulation then it is not possible to achieve both the rev and to resolve the pore throats for rocks with deff dd 20 the range of recommended voxel sizes for imaging cg1 and the other microstructures previously discussed are reported in table 1 these values assume values of m 700 for the sphere pack and m 1400 for the rocks the sphere pack cg1 and b5 were imaged within their recommended ranges for samples b1 and fb24 the recommendation is to image at a smaller voxel size than the 2 1 µm that was used to better resolve the pore throats sample fb33 which is very low porosity but with large grains falls outside the current technical feasibility of drp 6 conclusions imaging larger volumes of rocks for digital rock physics drp analysis improves the chances of achieving the representative elementary volume rev but often at the expense of image resolution this trade off exists due to finiteness of modern imaging detectors imaging and analyzing digital rocks that sample the rev but still sufficiently resolve pore throats is critical to ensure simulation quality and robustness of rock property trends for further analysis we find that typically 10 voxels are needed to sufficiently resolve pore throats for flow simulations rock properties calculated using digital rocks must 1 not change with change in rock volume and 2 must be insensitive to the choice of boundary conditions the rock volume for which both 1 and 2 are satisfied can be referred as the rev rock properties calculated using the pore morphology based methods are independent of boundary conditions and thus show lower variations with change in rock volume when compared to physics based simulations that are sensitive to the choice of boundary conditions variations in disparate rock properties decline at different rates indicating a complex behavior for the determination of the rev for rock properties no single threshold of the cov can be used to describe all rock properties for siliciclastic rocks swanson permeability calculated using pore morphology based method exhibit less variability when compared to flow based permeability effective grain diameter provides a robust estimate of rev we find that digital rocks with sample lengths greater than five times effective grain diameter exhibit relatively low variations cov 15 regardless of the method used to compute the rock properties moreover we define a range of reliable permeability that can be calculated using drp as a function of rock porosity and properties of the acquired image this work can also be used to select the appropriate voxel size at which a rock must be imaged to achieve rev and still resolve pores acknowledgments we thank nattavadee srisutthiyakorn saad saleh detlef holf hilko de jong jesse dietderich umang agarwal steffen berg dirk smit and nitish nair for discussions special thanks to jonas tolke for sharing the morphological workflow thanks to janos l urai and another anonymous reviewer for their comments and suggestions appendix a digital rocks sphere pack we describe each set of digital rock samples to provide geologic context to the segmentation and modeling this description validates comparisons between the samples and provides guidance for automatic segmentation rocks b1 and b5 are from the berea formation which is a sub angular to sub rounded mississippian age sandstone that has a mean grain size of approximately 350 µm and is moderately well sorted with a trask sorting coefficient of 1 40 x ray diffraction xrd analysis suggests that these rocks consist mainly of quartz but contain some dolomite in addition to clay minerals petrologic assessment of the samples indicates the presence of approximately 10 cement comprised of quartz and carbonates and macro porosity of roughly 20 in the quartz feldspar rock fragment qfr space both samples are sub litharenite meaning that they have more quartz grains and fewer rock fragments than the castlegate sample rocks fb24 and fb33 are from the fontainebleau formation which is a sub rounded to rounded oligocene age sandstone that has a mean grain size of approximately 450 µm and is moderately well sorted with a trask coefficient of 1 43 no xrd analysis of these sandstones was undertaken because petrographic assessment of the samples that they are nearly pure quartz roughly 20 of the samples is quartz cement resulting in relatively low porosity of approximately 8 12 fb33 when segmented does not have any connected porosity cg1 is from the castlegate formation of utah which is a sub angular to sub rounded mesozoic sandstone that has a mean grainsize of approximately 350 µm and is moderately sorted with a trask sorting coefficient of 1 69 xrd analysis indicates that the castlegate sandstone sample consists mainly of quartz grains petrologic assessment of the sample indicates a minimal quartz cement volume of between 2 and 3 with similar amounts of carbonate cement and approximately 19 macro porosity minor amounts of micas and clay minerals including muscovite kaolinite and mixed layer illite smectite were also documented in qfr space commonly used to categorize such rocks by their constituents the castlegate is a feldspathic litharenite with rock fragments dominantly being altered and unaltered volcanic rock fragments it is within these rock fragments that most the clays reside the synthetic sphere pack is taken from andrä et al 2013b each grain has a diameter of 700 µm for calculating the grain size distributions we approximate each grain as a sphere such that the sphere diameter is equal to the grain s major axis length we note a fair agreement between petrologically estimated grain size and that estimated numerically it must be noted that petrological analysis was performed on 2d thin sections whereas the digital grain size distributions were generated using 3d digital rocks in addition to the grain size we also calculate the autocorrelation length acl for the digital rocks and sphere pack acl is often defined as the lag at which the value of the autocorrelation function is 1 e of its original value zhang and sundararajan 2005 it is known that for segmented digital rocks the autocorrelation function a x at zero lag i e x 0 is equal to rock porosity and at infinite lag approaches square of porosity i e a 0 ϕ and a ϕ2 keehm 2003 keehm et al 2001 therefore we fit the following expression to obtain acl a 1 a x ϕ ϕ 2 e x a c l ϕ 2 in equation a 1 x is the lag φ is porosity and a x is the autocorrelation function appendix b flow solvers darcy s law states that the volume flux q of a viscous fluid per unit time through a sample of porous material is linearly proportional to the pressure difference δp applied to the opposite faces of the porous sample and the cross section area a and inversely proportional to the fluid viscosity η and sample length l b 1 q k a η δ p l the proportionality constant k is a fundamental property of the porous medium referred to as the absolute permeability which has units of length squared the most common permeability unit is darcy or mdarcy mdarcy such that 1 darcy 10 12 m2 and 1 mdarcy 10 15 m2 lbm 1 solver this solver type is an implementation of the lattice boltzmann method lbm using the d3q19 model ladd 1994 ladd and verberg 2001 the lbm solves a discrete meso scale form of the boltzmann equation he and luo 1997 which reduces to the incompressible navier stokes equation in the low mach number limit ladd 1994 ladd and verberg 2001 the lattice boltzmann method is a numerical scheme for solving transport equations the lbm approach is commonly used to study of flow in porous media at the pore scale cancelliere et al 1990 ferréol and rothman 1995 martys and chen 1996 sukop and thorne 2006 because of its computational efficiency and simplicity it is very well suited to solve for the flow in complex geometries for a general introduction to the lattice boltzmann theory we refer to benzi et al 1992 succi 2001 and keehm et al 2001 most lbm implementations for pore scale simulation utilize the bhatnagar gross krook collision operator bgk bhatnagar et al 1954 for halfway bounce back scheme at solid fluid boundaries however the bgk approach suffers from deficiencies such as viscosity dependent slip at the walls he et al 2008 and numerical instabilities on the other hand the multiple relaxation time mrt technique provides an effective cure to these deficiencies and offers greater flexibility for capturing complex flow physics lallemand et al 2003 lallemand and luo 2000 thus the mrt technique is implemented to the computational engine of the lbm based code for permeability estimation used in this study in the mrt technique different relaxation parameters are utilized for different linear combinations of the distribution functions the mrt method is described in detail in d humières et al 2002 and premnath and abraham 2007 a recent development in scientific computing is the so called general purpose computing on graphics processing units gpus gpus were developed in the 1990s to accelerate the rendering of images for output to a display since then the stream processing capabilities of gpus have been focused on scientific computing and the application to scientific computing has led to commercial lines of gpus that have thousands of double precision computation cores with error checking gpu computation can be even faster if a problem or computation lends itself to many lightweight computation threads such as lbm an implementation of the above discussed mrt lbm algorithm is specially made for nvidia gpu cards by use of the compute unified device architecture cuda programming language which is a variant of the c programming language with extra functions to control the device gpu from the host cpu in addition the mrt lbm code utilizes a one dimensional domain decomposition scheme with a single ghost layer communicating the solutions along domain boundaries the domain decomposition communications are managed by use of message passing interface mpi flow simulations were performed with mrt lbm on a large linux based cpu gpu hpc cluster to minimize the impact on other users all simulations were conducted using only four cluster nodes each with two tesla k80 gpu cards it is important to note that each tesla k80 has 5000 cuda cores and 24 gb of ram therefore the compute resource dedicated to each run can be summarized with 40 000 cuda cores and 200 gb of ram on average the mrt lbm code required 60 gb of ram for a given simulation the simulations utilized 100 of the gpu nodes processing potential in other words no two simultaneous simulation jobs were submitted to the same gpu nodes at the same time in the flow direction the loop boundary condition was enforced which acts like the periodic boundary condition simulations were run with both open with respect to flow and closed no flow in the tangential directions i e normal to the main flow direction lbm 2 solver this solver type is also an implementation of the lattice boltzmann method lbm for the incompressible stokes equation we use a d3q13 model with thirteen speeds as described in tölke and krafczyk 2008 without the nonlinear terms in the incompressible stokes equation tölke et al 2013 for this approach constant pressure boundary conditions are implemented at the inlet and outlet along with no slip boundary condition at the side walls once the numerical parameters in the scheme are chosen in a suitable manner the scheme has proven to be very competitive to state of the art solvers geller et al 2006 also complex multiscale problems can be addressed in an efficient manner with this method silva and ginzburg 2016 grid refinement with isotropic elements is efficient but when anisotropic elongated elements cells on an unstructured grid are needed the lbm approach is of limited use flow simulations using lbm 2 were performed on a large linux based cpu gpu hpc cluster as for the boundary conditions standard halfway bounce back scheme for lbm was implemented with inlet outlet boundaries the pressure is set such that flow is in laminar regime vbs solver the vbs solver is the simple fft solver in the geodict 2015 software offered by math2market gmbh the vbs solver is a fft accelerated variant of the semi implicit method for pressure linked equations or simple algorithm patankar 1980 van doormaal and raithby 1984 the vbs solver is also a finite volume method that operates on a staggered grid the method approximates the flow field by solving the momentum equation in which the pressure gradient term is set from an initial guess or calculated using the pressure distribution from the previous iteration the pressure correction equation is formulated and solved to obtain a new pressure distribution that is then used to correct the velocities the iterations continue until they reach a certain stopping criterion for porous media due to their complex connectivity the simple algorithm has difficulty converging to the solution of the steady state stokes equations solving the pressure correction equation was identified as the bottleneck of convergence because the inaccuracy of the pressure correction step requires excessively many iterations the fft is then used to solve the pressure correction poisson equation instead of just taking a step wiegmann 2007 this reduces the iterations and computation times dramatically even though the cost of an individual iteration rises significantly vbs allows us to model a variety of boundary conditions including periodic in flow direction with an implicitly added inflow outflow region and symmetric boundary conditions in flow direction similarly in tangential direction the solver supports periodic symmetric and no slip domain boundary conditions vbs computes on the uniform cartesian grid of a 3d image the variables inside the solid are enforced to zero vbs has its advantages when solving structures with low porosity since pressure correction can be propagated to the velocity correction quickly on the other hand when porosity is higher there are more unknowns and the momentum equations need lots of iterations to solve the velocity field even though the pressure correction can be easily found with fft algorithm the memory consumption of vbs is decided by the grid size regardless of the porosity simulations with vbs were run with periodic and symmetric boundary conditions in the flow direction whereas periodic boundary conditions were enforced in the tangential direction pressure difference mean velocity and flowrate were chosen to maintain laminar flow supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 001 appendix c supplementary materials image application 1 adler et al 1990 p m adler c g jacquin j a quiblier flow in simulated porous media int j multiph flow 16 1990 691 712 10 1016 0301 9322 90 90025 e alpak et al 2018 f o alpak f gray n saxena j dietderich r hofmann s berg a distributed parallel multiple relaxation time lattice boltzmann method on general purpose graphics processing units for the rapid and scalable computation of absolute permeability from high resolution 3d micro ct images comput geosci 2018 10 1007 s10596 018 9727 7 andrä et al 2013a h andrä n combaret j dvorkin e glatt han j m kabel y keehm f krzikalla lee m c madonna m marsh t mukerji e h saenger r sain n saxena s ricker a wiegmann zhan x digital rock physics benchmarks part ii computing effective properties comput geosci 50 2013 33 43 10 1016 j cageo 2012 09 008 andrä et al 2013b h andrä n combaret j dvorkin e glatt han j m kabel y keehm f krzikalla lee m c madonna m marsh t mukerji e h saenger r sain n saxena s ricker a wiegmann zhan x digital rock physics benchmarks part i imaging and segmentation comput geosci 50 2013 25 32 10 1016 j cageo 2012 09 005 arns et al 2005 c h arns f bauget a limaye a sakellariou t senden a sheppard r m sok v pinczewski s bakke l i berge p oren m knackstedt pore scale characterization of carbonates using x ray microtomography spe j 10 2005 26 29 10 2118 90368 pa arns et al 2002 c h arns m a knackstedt w v pinczewski e j garboczi computation of linear elastic properties from microtomographic images methodology and agreement between theory and experiment geophysics 67 2002 1396 10 1190 1 1512785 bear 1975 j bear dynamics of fluids in porous media soil sci 1975 10 1097 00010694 197508000 00022 benzi et al 1992 r benzi s succi m vergassola the lattice boltzmann equation theory and applications phys rep 1992 10 1016 0370 1573 92 90090 m berryman and blair 1986 j g berryman s c blair use of digital image analysis to estimate fluid permeability of porous materials application of two point correlation functions j appl phys 60 1986 1930 1938 10 1063 1 337245 bhatnagar et al 1954 p l bhatnagar e p gross m krook a model for collision processes in gases i small amplitude processes in charged and neutral one component systems phys rev 94 1954 511 525 10 1103 physrev 94 511 blunt et al 2013 m j blunt b bijeljic dong h o gharbi s iglauer p mostaghimi a paluszny c pentland pore scale imaging and modelling adv water resour 51 2013 197 216 10 1016 j advwatres 2012 03 003 cancelliere et al 1990 a cancelliere chang c e foti d h rothman s succi the permeability of a random medium comparison of simulation with theory phys fluids a fluid dyn 2 1990 2085 2088 10 1063 1 857793 costanza robinson et al 2011 m s costanza robinson b d estabrook d f fouhey representative elementary volume estimation for porosity moisture saturation and air water interfacial areas in unsaturated porous media data quality implications water resour res 47 2011 10 1029 2010wr009655 n a n a d humières et al 2002 d d humières i ginzburg m krafczyk p lallemand luo l s multiple relaxation time lattice boltzmann models in three dimensions philos trans a math phys eng sci 360 2002 437 451 10 1098 rsta 2001 0955 desbois et al 2011 g desbois j l urai p a kukla j konstanty c baerle high resolution 3d fabric and porosity model in a tight gas sandstone reservoir a new approach to investigate microstructures from mm to nm scale combining argon beam cross sectioning and sem imaging j pet sci eng 78 2011 243 257 10 1016 j petrol 2011 06 004 dvorkin et al 2008 j dvorkin m armbruster c baldwin fang q n derzhi c gomez nur b nur a mu y the future of rock physics computational methods vs lab testing first break 26 2008 63 68 dvorkin et al 2011 j dvorkin n derzhi e diaz fang q relevance of computational rock physics geophysics 76 2011 e141 e153 10 1190 geo2010 0352 1 ferréol and rothman 1995 b ferréol d h rothman lattice boltzmann simulations of flow through fontainebleau sandstone transp porous media 20 1995 3 20 10 1007 bf00616923 geller et al 2006 s geller m krafczyk j tölke s turek j hron benchmark computations based on lattice boltzmann finite element and finite volume methods for laminar flows comput fluids 35 2006 888 897 10 1016 j compfluid 2005 08 009 gitman et al 2007 i m gitman h askes l j sluys representative volume existence and size determination eng fract mech 74 2007 2518 2534 10 1016 j engfracmech 2006 12 021 he et al 2008 he s c ariyaratne a e vardy a computational study of wall friction and turbulence dynamics in accelerating pipe flows comput fluids 37 2008 674 689 10 1016 j compfluid 2007 09 001 he and luo 1997 he x luo l s theory of the lattice boltzmann method from the boltzmann equation to the lattice boltzmann equation phys rev e 56 1997 6811 6817 10 1103 physreve 56 6811 hemes et al 2015 s hemes g desbois j l urai b schröppel j o schwarz multi scale characterization of porosity in boom clay hades level mol belgium using a combination of x ray μ ct 2d bib sem and fib sem tomography microporous mesoporous mater 208 2015 1 20 10 1016 j micromeso 2015 01 022 hill 1963 r hill elastic properties of reinforced solids some theoretical principles j mech phys solids 11 1963 357 372 10 1016 0022 5096 63 90036 x hilpert and miller 2001 m hilpert c t miller pore morphology based simulation of drainage in totally wetting porous media adv water resour 24 2001 243 255 10 1016 s0309 1708 00 00056 7 houben et al 2013 m e houben g desbois j l urai pore morphology and distribution in the shaly facies of opalinus clay mont terri switzerland insights from representative 2d bib sem investigations on mm to nm scale appl clay sci 71 2013 82 97 10 1016 j clay 2012 11 006 huet 1990 c huet application of variational concepts to size effects in elastic heterogeneous bodies j mech phys solids 38 1990 813 841 10 1016 0022 5096 90 90041 2 kanckstedt et al 2001 m a kanckstedt a p sheppard m sahimi pore network modelling of two phase flow in porous rock the effect of correlated heterogeneity adv water resour 24 2001 257 277 10 1016 s0309 1708 00 00057 9 kanit et al 2003 t kanit s forest i galliet v mounoury d jeulin determination of the size of the representative volume element for random composites statistical and numerical approach int j solids struct 40 2003 3647 3679 10 1016 s0020 7683 03 00143 4 keehm 2003 y keehm computational rock physics transport properties in porous media and applications 2003 stanford university keehm et al 2001 y keehm t mukerji a nur computational rock physics at the pore scale transport properties and diagenesis in realistic pore geometries lead edge 2001 10 1190 1 1438904 knackstedt et al 2008 m a knackstedt c arns m madadi a p sheppard s latham r sok g bächle g eberli elastic and flow properties of carbonate core derived from 3d x ray ct images seg tech progr expand abstr 27 2008 1804 1809 10 1190 1 3059394 knackstedt et al 2009 m knackstedt s latham m madadi a sheppard t varslot c arns digital rock physics 3d imaging of core material and correlations to acoustic and flow properties lead edge 28 2009 28 33 10 1190 1 3064143 ladd 1994 a j c ladd numerical simulations of particulate suspensions via a discretized boltzmann equation part i theoretical foundation j fluid mech 271 1994 285 309 10 1017 s0022112094001771 ladd and verberg 2001 a j c ladd r verberg lattice boltzmann simulations of particle fluid suspensions j stat phys 2001 10 1023 a 1010414013942 lallemand et al 2003 p lallemand d d humières luo l s r rubinstein theory of the lattice boltzmann method three dimensional model for linear viscoelastic fluids phys rev e 67 2003 21203 10 1103 physreve 67 021203 lallemand and luo 2000 p lallemand luo l s theory of the lattice boltzmann method dispersion dissipation isotropy galilean invariance and stability phys rev e 61 2000 6546 6562 10 1103 physreve 61 6546 martys and chen 1996 n martys chen h simulation of multicomponent fluids in complex three dimensional geometries by the lattice boltzmann method phys rev e 53 1996 743 750 10 1103 physreve 53 743 mu et al 2016 mu y r sungkorn j toelke identifying the representative flow unit for capillary dominated two phase flow in porous media using morphology based pore scale modeling adv water resour 95 2016 16 28 10 1016 j advwatres 2016 02 004 øren et al 2006 p øren s bakke h rueslåtten digital core laboratory rock and flow properties derived from computer generated rocks proceedings of the international symposium of the society of core analysts 2006 1 12 otsu 1979 otsu n a threshold selection method from gray level histograms ieee trans syst man cybern 9 1979 62 66 10 1109 tsmc 1979 4310076 patankar 1980 patankar s v 1980 numerical heat transfer and fluid flow series in computational methods in mechanics and thermal sciences doi 10 1017 s0022112086212148 pelissou et al 2009 c pelissou j baccou y monerie f perales determination of the size of the representative volume element for random quasi brittle composites int j solids struct 46 2009 2842 2855 10 1016 j ijsolstr 2009 03 015 premnath and abraham 2007 k n premnath j abraham three dimensional multi relaxation time mrt lattice boltzmann models for multiphase flow j comput phys 224 2007 539 559 10 1016 j jcp 2006 10 023 richa 2010 r richa preservation of transport properties trends computational rock physics approach 2010 stanford university rumpf and gupte 1971 h c h rumpf a r gupte einflüsse der porosität und korngrößenverteilung im widerstandsgesetz der porenströmung chem ing tech 43 1971 367 375 10 1002 cite 330430610 cit sab 1992 k sab on the homogenization and the simulation of random materials eur j mech a solids 11 1992 585 607 saenger 2008 e h saenger numerical methods to determine effective elastic properties int j eng sci 46 2008 598 605 10 1016 j ijengsci 2008 01 005 saenger et al 2011 e h saenger f enzmann y keehm h steeb digital rock physics effect of fluid viscosity on effective elastic properties j appl geophys 74 2011 236 241 10 1016 j jappgeo 2011 06 001 sain et al 2014 r sain t mukerji g mavko how computational rock physics tools can be used to simulate geologic processes understand pore scale heterogeneity and refine theoretical models lead edge 33 2014 324 334 10 1190 tle33030324 1 saxena et al 2017a n saxena r hofmann f o alpak s berg j dietderich u agarwal k tandon s hunter j freeman o wilson and benchmarks for pore scale flow simulated using micro ct images of porous media and digital rocks adv water resour 109 2017 211 235 10 1016 j advwatres 2017 09 007 saxena et al 2017b n saxena r hofmann f o alpak s berg j dietderich u agarwal k tandon s hunter j freeman o b wilson 
816,the porous medium equation pme is a generalization of the traditional boussinesq equation for hydraulic conductivity as a power law function of height we analyze the horizontal recharge of an initially dry unconfined aquifer of semi infinite extent as would be found in an aquifer adjacent a rising river if the water level can be modeled as a power law function of time similarity variables can be introduced and the original problem can be reduced to a boundary value problem for a nonlinear ordinary differential equation the position of the advancing front is not known ahead of time and must be found in the process of solution we present an analytical solution in the form of a power series with the coefficients of the series given by a recurrence relation the analytical solution compares favorably with a highly accurate numerical solution and only a small number of terms of the series are needed to achieve high accuracy in the scenarios considered here we also conduct a series of physical experiments in an initially dry wedged hele shaw cell where flow is modeled by a special form of the pme our analytical solution closely matches the hydraulic head profiles in the hele shaw cell experiment keywords porous medium equation series solution groundwater wedged hele shaw cell shampine s method 1 introduction groundwater flow is considered to be unconfined when it has a free upper surface in contact with a gas phase i e air and water vapor usually at atmospheric pressure unconfined flows are driven primarily by gravity acting on the density difference between the two phases and are considered to be a subset of a larger class of flows known as gravity driven flows if the slope of the free surface is small the hydraulic head can be considered constant everywhere along the vertical this is known as the dupuit forchheimer df assumption in the case of primarily horizontal flow in a porous medium the df assumption can be used to write an expression for discharge through a control volume as a function of hydraulic head only depending on the properties of the porous medium substitution of this discharge function into the continuity equation results in the porous medium equation pme with the boussinesq equation being a special case of particular interest to hydrologists these equations apply to domains in which the characteristic thickness of the saturated media is much greater than that of the overlying unsaturated zone under these conditions capillarity can safely be dismissed and the water saturated part of the system can be modeled independently of the overlying unsaturated zone since the aqueous phase invades and under rides a less dense gas phase a counter flow of gas exists in the unsaturated zone although its effect on the flow of water is usually negligible due to the nearly three order of magnitude difference in density between liquid water and the overlying gaseous phase closed form analytical solutions for infiltration governed by the boussinesq equation exist for a certain class of geometries and boundary conditions bear 1988 polubarinova kochina 1962 tolikas et al 1984 for one dimensional horizontal flow described by the boussinesq equation in an initially dry aquifer lockington et al 2000 derived a solution in which one boundary is a power law function of time by introducing similarity variables the problem was reduced to a free boundary value problem for a nonlinear ordinary differential equation ode and an approximate solution in the form of a quadratic polynomial was constructed olsen and telyakovskiy 2013 extended the approach of lockington et al 2000 to flows governed by the generalized boussinesq equation for the same initial and boundary conditions rupp and selker 2005 examined boussinesq style drainage from a fully saturated aquifer with hydraulic conductivity taken as a power law function of height one wall of the aquifer considered is an impermeable vertical boundary while the other vertical boundary allows instantaneous drawdown from a horizontal non zero initial condition it was shown that the pme results from solving the flow equation with hydraulic conductivity given as a power law function of height zheng et al 2013 derived equations for the same problem in a wedged hele shaw cell ciriello et al 2013 investigated special cases of permeability varying in both the vertical and horizontal directions with boundary conditions determined by injection rates zheng et al 2014 modeled and ran an experiment for the spreading of a mound of fluid where permeability varied as a power law in the horizontal direction longo et al 2015 also investigated the case of a spreading mound but for a non newtonian fluid barenblatt 1952 solved the pme in the context of gas flow through porous media a zero initial condition was used for both power law hydraulic head and power law volumetric flux inlet boundary conditions planar cylindrical and spherical symmetries were considered it is shown that weak solutions to this class of problems possess advancing fronts which propagate with finite speed the solutions are obtained by the introduction of dimensionless similarity variables which reduce the partial differential equation pde to an ode the first few terms of a power series solution are explicitly given but the approach undertaken requires significant effort to generate further terms no term generating algorithm is provided and the powers in the series are non integer song et al 2007 applied the approach of barenblatt 1952 to investigate the boussinesq equation with a power law hydraulic head inlet boundary condition for an initially dry aquifer in addition song et al 2007 obtained a recursion relation for the coefficients of the power series terms greatly simplifying the process of approximating the solution with arbitrary accuracy this solution was extended to a power law volumetric flux at the boundary by telyakovskiy et al 2010 we approach the problem of flow in an initially dry unconfined aquifer in a semi infinite space where the hydraulic head at the upstream boundary is a power law function of time and the hydraulic conductivity diminishes with depth such flows may occur in shallow systems where saturated groundwater invades a partially saturated zone with soil bulk density increasing with depth we solve a class of problems similar to barenblatt 1952 and song et al 2007 and provide an easy way to generate terms for the series solution the series solution is compared to a numerical solution developed by shampine 1973 results are also compared to an experiment similar to those performed in zheng et al 2013 ciriello et al 2016 and the theoretical setting presented by rupp and selker 2005 2 problem statement we provide a brief derivation of the pme in the context of one dimensional groundwater flow in the x direction over a horizontal impervious base we define h to be the height of the phreatic surface as measured vertically from the base of the aquifer under the hydrostatic assumption velocity v is given by darcy s law 1 v ρ g k μ h x t x where k is the intrinsic permeability and μ the viscosity mass conservation represents a rate of change of the amount of fluid in the elementary volume it is compensated by the fluxes through the left and right vertical faces giving the continuity equation 2 t x x dx 0 h x t ϵ dydx 0 h x t vdy 0 h x dx t vdy we assume power law expressions for porosity ϵ 1 r 1 y ϕ and permeability k c 1 y n neglecting higher order terms 2 becomes 3 t h ϕ 1 x t r 1 ϕ 1 ρ g c 1 μ n 1 n 2 2 x 2 h n 2 x t performing a change of variables for h ϕ 1 h 3 takes the typical form 4 t h a 2 x 2 h m where a r 1 ϕ 1 ρ g c 1 μ n 1 n 2 and m n 2 ϕ 1 the power law parameters ϕ and n are chosen such that the limiting case of the heat equation is avoided 5 n 2 ϕ 1 1 it is easily verified that for constant permeability n 0 and porosity ϕ 0 this expression reduces to the traditional case of the boussinesq equation for a detailed derivation and bounds on the parameters ϕ and n see the supplementary materials we consider 4 as the governing equation for flow from a source such as a river or ditch into an initially dry aquifer with an impermeable horizontal base as shown in fig 1 the domain of this problem is semi infinite and the boundary and initial conditions are specified as 6 h 0 t σ t α σ 0 1 m 1 α 7 lim x h x t 0 t 0 8 h x 0 0 x 0 the parameters σ and α are chosen to control the height of the invading fluid at the x 0 inlet boundary the water level of the fluid reservoir adjacent the aquifer is controlled by the exponent α the value of the exponent α 1 m 1 corresponds to the free spreading of a mound of groundwater while the case of α 0 corresponds to a rising water level at the boundary x 0 the case of α 1 represents a linearly rising water level at the boundary while the case of α 0 corresponds to the important practical application of a constant water level in the fluid reservoir if α 1 m 1 then the water level at x 0 drops faster than it does in the porous medium due to gravity this results in back seepage at x 0 requiring a different analysis than the one presented here depending on the properties of the fluid and porous media the exponent m takes different values the value m 5 can be used to model flow through concretes lockington et al 1999 forest soils may have values ranging from m 2 2 to m 8 9 beven 1982 flow of air at atmospheric conditions through soils can be modeled with m 2 405 vazquez 2007 classical groundwater flow can be modeled with the boussinesq equation where m 2 which is the case that we generalize in this paper the zero initial condition given by eq 8 represents an initially dry aquifer such a situation can occur when a dry river bed is suddenly flooded after a dry season and the water level rises with α 0 another important situation is the case of a river rising rapidly to a constant stage possible during flash flooding and irrigation for modeling purposes this scenario can be modeled with the constant boundary condition h 0 t σ α 0 lockington 1997 to date multiple studies have analyzed these problems e g prasad and salomon 2005 lockington et al 2000 and srivastava et al 2006 similarly the case of filtration through concretes with a zero initial saturation was considered by lockington et al 1999 if the aquifer is partially filled with water initially then the solutions to the pme propagate with infinite speed see e g polubarinova kochina 1962 in practical applications we expect a finite speed of propagation for the infiltration of water when the initial condition 8 is zero a finite speed of propagation is guaranteed barenblatt and vishik 1956 3 analytical solution using dimensional analysis the pme problem is reduced to an ode problem with a similarity variable transformation following barenblatt 1952 1954 we introduce two dimensionless variables ξ and h as 9 ξ x 1 α m 1 1 2 a σ m 1 t 1 α m 1 1 2 and 10 h σ t α h ξ where ξ x t is the similarity variable and h ξ is a scaling function the factor 1 α m 1 1 2 is introduced to 9 to simplify later expressions substitution of 9 and 10 into 4 results in the ode 11 d 2 h m ξ d ξ 2 ξ 2 d h ξ d ξ λ h ξ 0 where λ α 1 α m 1 in this expression λ takes on values in the finite interval 1 2 1 m 1 simplifying the problem solutions to 4 8 propagate with finite speed barenblatt and vishik 1956 guaranteeing that there is a position ξ 0 ξ beyond which the scaling function h ξ is identically zero the boundary and initial conditions reduce to 12 h 0 1 and 13 h ξ 0 0 where ξ 0 is defined as the position of the advancing front and should be found in the process of solution in the physical plane 13 represents a moving point on the base of the aquifer where there is a sharp transition from the invading water to air in general the ode 11 contains terms with non integer values of m 1 we obtain an ode with integer powers using the substitution 14 h u 1 m 1 where u is often referred to as mathematician s pressure vazquez 2007 eqs 11 13 then become 15 m m 1 u d 2 u d ξ 2 m m 1 m m 1 1 d u d ξ 2 ξ 2 1 m 1 d u d ξ λ u 0 with 16 u 0 1 and 17 u ξ 0 0 in 15 17 the function u and its derivatives have integer powers following barenblatt 1952 and song et al 2007 we seek the solution to 15 using a power series of the form 18 u ξ n 0 a n 1 ξ ξ 0 n using the boundary condition 16 we obtain the condition 19 n 0 a n 1 while 17 gives 20 a 0 0 substituting 18 into 15 and simplifying we obtain an expression for the coefficients of the power series 0 m m 1 1 ξ 0 2 k 0 n a n k a 2 k 2 k 1 k m m 1 m m 1 1 1 ξ 0 2 k 0 n a k 1 a n 1 k k 1 n 1 k 1 2 1 m 1 n λ a n 1 2 1 m 1 a n 1 n 1 evaluating the above when n 0 together with a 0 defined by eq 20 we find the following expression for a 1 a 1 ξ 0 2 m 1 2 m performing one more evaluation for the n 1 case we find that a 2 ξ 0 2 2 λ 1 2 m 1 m 1 m 2 we can obtain an explicit formula for a n 1 by rearranging terms in the above sums after algebraic manipulation we obtain a recurrence relation for n 2 21 a n 1 2 n 1 m n m 1 1 1 ξ 0 2 k 0 n 2 a n k a 2 k 2 k 1 k 2 n 1 m n m 1 1 1 m 1 1 ξ 0 2 k 1 n 1 a k 1 a n 1 k k 1 n 1 k 2 n 1 m 1 n m 1 1 λ 1 2 1 m 1 n a n this formal series solution generalizes the series solution for the case of the boussinesq equation m 2 produced by song et al 2007 their paper has shown that the coefficients an of the power series 18 are bounded by a convergent number series of the form an c n 2 which justifies convergence when m 2 likely a similar convergence result would hold when an is defined by 21 the series solution presented here is an exact analytical solution of the problem and can serve as a benchmark to test numerical codes or quickly obtain an analytical form of a phreatic surface profile moreover the series converges very quickly and a small number of terms can be used to approximate the solution as further results in this paper illustrate the location of the advancing front ξ 0 can be found using the coefficients of the power series using eq 21 and the values for a 0 and a 1 found earlier it can be shown that every coefficient an contains the factor ξ 0 2 factoring ξ 0 2 the condition 19 gives n 0 ξ 0 2 a n 1 where a n a n ξ 0 2 solving for ξ 0 we have 22 ξ 0 n 0 a n 1 2 it is now possible to construct an arbitrarily accurate solution to the problem 11 13 if we take a sufficiently large number of terms in the power series 18 and use the change of variables 14 using the definitions of the dimensionless variables ξ and h given by eqs 9 and 10 we can obtain a highly accurate solution to the original problem 4 8 the numerical results presented in the next section show that the power series 18 converges rapidly 3 1 numerical solution of the ode to solve 11 13 numerically we apply the method of shampine 1973 to 15 17 followed by the transformation 14 this numerical procedure is performed without pre determining the position of the wetting front ξ 0 a solution is achieved with a runge kutta solver by setting ξ 0 1 and solving backward toward ξ 0 the solution is then rescaled to satisfy the boundary condition 12 for a detailed explanation we refer the reader to shampine 1973 defining w d u d ξ we can write 15 as the first order system 23 d u d ξ w u ξ 0 0 d w d ξ 1 u m m 1 1 w 2 1 m u ξ 2 w λ m 1 m w ξ 0 ξ 0 m 1 2 m the boundary condition u ξ 0 0 creates undefined terms in the system 23 this issue is alleviated by using taylor expansions to generate starting values in the vicinity of ξ 0 1 the taylor series for u and its first derivative are u ξ ξ 0 m 1 2 m ξ ξ 0 1 2 m 1 1 2 m 1 λ 2 m 2 ξ ξ 0 2 1 3 2 m 1 1 2 m 1 λ 6 m 1 λ 3 ξ 0 2 m 1 4 m 3 ξ ξ 0 3 and d u ξ d ξ ξ 0 m 1 2 m m 1 1 2 m 1 λ 2 m 2 ξ ξ 0 1 2 2 m 1 1 2 m 1 λ 6 m 1 λ 3 ξ 0 2 m 1 4 m 3 ξ ξ 0 2 a runge kutta solver can be used to solve this system from the vicinity of ξ 0 1 to ξ 0 so we step away from ξ 0 using the above taylor expansions to start calculations eqs 11 and 15 are invariant under the scaling 24 h ξ μ f μ m 1 2 ξ where μ is an arbitrary positive constant and f ξ is a solution of 11 or 15 barenblatt 1952 this can be verified by substituting 24 into 11 and 15 and differentiating to solve 15 we choose the scaling 25 u ξ 1 f 0 λ f f 0 λ m 1 2 ξ where f ξ is a solution to 15 such that ξ 0 1 i e f 1 0 the solution to 11 is obtained by reversing the substitution 14 numerical solutions in the similarity variable space for representative values of m 1 5 and m 4 are presented in fig 2 4 laboratory experiment a wedged hele shaw cell experiment was constructed to compare solutions of the pme to lab scale simulations of subsurface flow the wedge configuration is formed from two flat plates in contact at their base to form a v liquid flows between the plates with permeability simulated as a result of viscous drag the distance between the plates varies as a linear function of height y only resulting in a permeability profile k k y that depends on the vertical coordinate only the combination of viscosity and distance between the plates can be adjusted to ensure that the flow is sufficiently slow and laminar thus the flow at any height can be approximated by poiseuille flow between parallel plates for a given width b y this is a common assumption that leads to reasonable results and greatly simplifies analysis e g zheng et al 2014 ciriello et al 2013 4 1 derivation of the governing equation flow in a wedged hele shaw cell with the above poiseuille flow assumption represents a special form of the pme 4 we derive a governing flow equation in a manner similar to zheng et al 2013 or longo et al 2015 but in a different setting the triangular cross section of the wedge with thickness dx is taken as an elementary fluid element thickness is taken in the fluid flow direction as shown in fig 3 conservation of mass dictates that the rate of change of fluid in the elementary volume is equal to the difference in volumetric fluxes through the faces at x and x d x 26 t 0 h v x t b y d y d x 0 h v x t b y u v x y t d y 0 h v x d x t b y u v x d x y t d y where the width of the wedge for height y is given by b y uv is the fluid speed in the x direction and hv x t is the height of the free surface full saturation within the fluid element implies a porosity of 1 though mass does vary in the vertical direction we consider only the flux of an incompressible fluid and disregard the movement of the gaseous phase neglecting the higher order terms of the taylor expansion in the second term on the right hand side of 26 we obtain 27 t 0 h v x t b y d y d x x 0 h v x t b y u v x y t d y d x darcy s law is used for the velocity uv 28 u v x y t b 1 2 y 2 ρ g 12 μ h v x t x here we have used the poiseuille flow approximation to calculate the permeability 29 k y b 1 2 y 2 12 where b y b 1 y the constant b 1 has been derived using similar triangles in a vertical cross section of the wedge the outer triangle is defined by the dimensions of the experiment and the inner is defined by the fluid saturated zone the total height and maximum width of the cell are known and we can calculate the width at any given height as a function of vertical location thus given an arbitrary elevation y within the wedge multiplying by b 1 returns the corresponding width between the plates at that height performing these substitutions and integrating yields 30 t h v 2 b 1 2 δ ρ g 24 μ x h v 4 h v x here δ ρ ρ f l u i d ρ a i r ρ f l u i d the change of variables h h v 2 results in an equation that can be solved with the same process as presented for 4 4 2 experiment design and results our wedged hele shaw cell is constructed from two glass plates forming a v held in place by an aluminum t slot frame and two acrylic sheets the glass plates are held together tightly at the bottom of the v leading to a zero permeability base in the context of porous media flows a pvc pipe with a vertical slit depicted in fig 4 provides a constant boundary condition up to a height of 0 155 m glycerol was chosen as the liquid due to its high viscosity allowing the experiment to be run slowly enough to ease challenges associated with data collection and maintaining boundary conditions for less viscous liquids it is difficult to simultaneously provide enough liquid to the boundary maintain a constant height and keep flow in the boundary tube laminar parameters for the three experimental trials performed are given in table 1 mathematically changes in the parameter a from eq 4 represents a dilation or contraction of the similarity variable ξ as any value of a can be obtained with non unique parameter combinations we have chosen to vary only the gap widths given in table 1 this approach offers the greatest consistency across trials fluid properties that are not accounted for in the model such as surface tension remain unchanged a small pump was used to supply glycerol to the boundary reservoir a constant boundary condition was chosen as an important special practical case of the power law boundary solution when α 0 and σ 0 155 m to maintain a constant boundary height glycerol is allowed to overflow out of the experiment through the back of the boundary condition the dynamic viscosity of glycerol was measured using a ball drop viscometer at a room temperature of 20 c the average value was measured to be μ 1 4092 0 0281 pa s density was found to be ρ 1263 2230 kg m 3 results were recorded by hand and with a camera set on a timer the form of the pme used to model flow in the hele shaw wedge is 31 t h b 1 2 δ ρ g 120 μ 2 x 2 h 5 2 where h h v 2 and b 1 is given by the ratio of gap width to 0 155 m propagation distances for the three experiments performed are plotted in fig 5 experimental results consistently under perform as compared to the similarity variables for early time where flow has not yet transitioned into a similarity regime straight lines represent the analytical solution given by 9 when α 0 and ξ 0 is obtained from 22 values of a are produced by non unique parameter combinations so varying the gap can be mathematically interpreted as variations in ρ or μ as well dashed error bars are calculated using the errors associated with the viscometer scale and caliper used for each the maximum deviations were added and subtracted to the associated measurements used to compute a in the similarity variable ξ addition or subtraction on each parameter was chosen based on which would slow or increase the propagation distance ξ the trial with the smallest gap shows the greatest possible error as the gap size is smaller relative to the precision of the caliper used comparisons of the series solution with the experimental results for the three experimental trials are given in fig 6 results displayed correspond to times where the flow was transitioning or had entered a similarity regime of well developed flow there is a consistent match in profile shape and time evolution disagreement between the model and experiment is expected in the lower section of the experiment where the plates converge to zero permeability the curves specifying the analytic solution in fig 6 can be thought of as the exact analytical solution of the problems 4 8 since they have been obtained with a large number of terms in the power series 18 these results are achieved with no modification to the pme solution though we expect a disagreement between the physical flow and theory at the base of the wedge 5 discussion we observed good agreement between the series solution and numerical results in the similarity variable space multiple values of m were investigated and in all cases the series solution converged very quickly to accuracy levels required for hydrology applications fig 7 shows a comparison of the partial sums of the series and the numerical solution for m 4 we believe that the coefficients an of the power series decay very quickly and we have not only an c n 2 but an cn n 2 where cn 0 as n this allows us to take a small number of terms in the series and obtain very accurate results for m 2 solutions to the pme are characterized by steep phreatic surfaces near the advancing front this can be seen in the comparison of the m 1 5 and m 4 cases in fig 2 numerical error can become significant because we used a taylor series to approximate the slope at the advancing front this can be alleviated by switching the independent and dependent variables as outlined in shampine 1973 fig 8 shows the first experimental trial at an early time of t 9 min the governing equations were derived under the assumption of a nearly horizontal phreatic surface in fig 8 there is a 0 16 m change in the phreatic surface height over approximately 0 2 m of horizontal distance consequently the df assumption is inadequate and early time results can not be modeled by the pme it is likely that the undercutting observed is a combined effect of steep phreatic surface permeability profile and strong capillary forces at the bottom of the wedge this early time behavior was observed across all experiments performed to determine when the experiment reaches a flow regime applicable to our model assumptions we plot the height of the undercutting observed in fig 8 as a function of elapsed time for the first trial fig 9 depicts the evolution of this phenomenon for trial 1 with a constant height reached after approximately 60 min after this time undercutting persists at a height of approximately 1 cm to 1 5 cm we refer to flows where the undercutting has reached a steady state as being well developed because the flow has transitioned to a similarity flow regime though the early time results of the experiment are not represented by the governing assumptions of the pme good agreement was reached at later times fig 9 indicates that the bottom 1 cm to 1 5 cm of the experiment can not be modeled by the pme for the gap used in the first trial however this represents such a small volume of fluid flow that the solution curves are minimally affected this phenomenon is likely due to capillary forces which are not accounted for in our derivation of the pme the early time concavity change in the undercutting height observed in fig 9 is likely due to a confluence of dynamic factors including vertical motions caused by the steep free surface at early times because we employed the df assumption in our derivation of the pme an explanation of this interesting behavior is not provided by the equation governing flow we note that the method of determining when the flow is well developed in fig 9 is motivated entirely by empirical evidence and that the effects of vertical velocity and capillarity could not be measured independently the proper use of the df assumption is to some degree arbitrary and application dependent we employed the height of undercutting as the only observable quantity available and it provided us with a match between the modeled and experimental phreatic surfaces these empirical results provide guidelines for when capillary forces can safely be disregarded and modeling flow with the pme is appropriate the complex role of capillary in the experiment warrants further investigation but is outside the scope of this paper a simple analysis can be conducted to define the average free surface slope as the flow transitions to a constant height of profile undercutting we calculated the average free surface angle β 32 tan β h 0 l as diagrammed in fig 10 for our experiment we calculate the average angle β 17 occurring after the glycerol has propagated a length of approximately 52 cm into the experiment this calculation can be applied to the design of further experiments that use the same permeability profile for a different boundary height h 0 the approximate characteristic length l required to obtain minimal undercutting is simply 33 l h 0 tan β for the purposes of designing experiments with other permeability profiles we suggest generating solutions to the associated pme and choosing the time that gives the same average free surface angle we note that as the pme exponent m increases the average angle β will be increasingly less representative of the free surface solution curves for experiments with m much larger than what is presented here we expect this method to underestimate the distance at which undercutting will reach its lower limit 6 conclusion we constructed a solution to the pme that models horizontal infiltration in an unconfined aquifer the aquifer was assumed to be initially dry and the water level varied at the inlet as a power law function of time this problem allows the introduction of similarity variables and the reduction of the initial boundary value problem for a pde to a free boundary value problem for an ode a solution in the form of a power series was constructed for the ode moreover a recursion relation for the coefficients of the series was obtained as a result arbitrarily accurate solutions can be constructed to serve as a benchmark for numerical codes our comparison of the series solution to a highly accurate numerical solution shows that the power series converges quickly and a small number of terms is sufficient to obtain highly accurate analytical results in addition to the series solution flow was modeled experimentally in a wedged hele shaw cell under the lubrication or poiseuille flow assumption the governing flow equation represents a special type of the porous medium equation other forms of the pme modeling fluid flow may be obtained when more complicated hele shaw cell configurations are used we compared the theoretically predicted and experimentally observed phreatic surface profiles the pme solutions agree well with the wedged hele shaw cell observations when the flow is well developed and the phreatic surface is not steep acknowledgments we thank john selker for the suggestion to perform the experiment using a wedged hele shaw cell a t thanks jean yves parlange and tammo steenhuis for the discussions related to the behavior near the propagation front we thank john selker and two anonymous reviewers for providing useful comments that improved the quality of this paper supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 005 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
816,the porous medium equation pme is a generalization of the traditional boussinesq equation for hydraulic conductivity as a power law function of height we analyze the horizontal recharge of an initially dry unconfined aquifer of semi infinite extent as would be found in an aquifer adjacent a rising river if the water level can be modeled as a power law function of time similarity variables can be introduced and the original problem can be reduced to a boundary value problem for a nonlinear ordinary differential equation the position of the advancing front is not known ahead of time and must be found in the process of solution we present an analytical solution in the form of a power series with the coefficients of the series given by a recurrence relation the analytical solution compares favorably with a highly accurate numerical solution and only a small number of terms of the series are needed to achieve high accuracy in the scenarios considered here we also conduct a series of physical experiments in an initially dry wedged hele shaw cell where flow is modeled by a special form of the pme our analytical solution closely matches the hydraulic head profiles in the hele shaw cell experiment keywords porous medium equation series solution groundwater wedged hele shaw cell shampine s method 1 introduction groundwater flow is considered to be unconfined when it has a free upper surface in contact with a gas phase i e air and water vapor usually at atmospheric pressure unconfined flows are driven primarily by gravity acting on the density difference between the two phases and are considered to be a subset of a larger class of flows known as gravity driven flows if the slope of the free surface is small the hydraulic head can be considered constant everywhere along the vertical this is known as the dupuit forchheimer df assumption in the case of primarily horizontal flow in a porous medium the df assumption can be used to write an expression for discharge through a control volume as a function of hydraulic head only depending on the properties of the porous medium substitution of this discharge function into the continuity equation results in the porous medium equation pme with the boussinesq equation being a special case of particular interest to hydrologists these equations apply to domains in which the characteristic thickness of the saturated media is much greater than that of the overlying unsaturated zone under these conditions capillarity can safely be dismissed and the water saturated part of the system can be modeled independently of the overlying unsaturated zone since the aqueous phase invades and under rides a less dense gas phase a counter flow of gas exists in the unsaturated zone although its effect on the flow of water is usually negligible due to the nearly three order of magnitude difference in density between liquid water and the overlying gaseous phase closed form analytical solutions for infiltration governed by the boussinesq equation exist for a certain class of geometries and boundary conditions bear 1988 polubarinova kochina 1962 tolikas et al 1984 for one dimensional horizontal flow described by the boussinesq equation in an initially dry aquifer lockington et al 2000 derived a solution in which one boundary is a power law function of time by introducing similarity variables the problem was reduced to a free boundary value problem for a nonlinear ordinary differential equation ode and an approximate solution in the form of a quadratic polynomial was constructed olsen and telyakovskiy 2013 extended the approach of lockington et al 2000 to flows governed by the generalized boussinesq equation for the same initial and boundary conditions rupp and selker 2005 examined boussinesq style drainage from a fully saturated aquifer with hydraulic conductivity taken as a power law function of height one wall of the aquifer considered is an impermeable vertical boundary while the other vertical boundary allows instantaneous drawdown from a horizontal non zero initial condition it was shown that the pme results from solving the flow equation with hydraulic conductivity given as a power law function of height zheng et al 2013 derived equations for the same problem in a wedged hele shaw cell ciriello et al 2013 investigated special cases of permeability varying in both the vertical and horizontal directions with boundary conditions determined by injection rates zheng et al 2014 modeled and ran an experiment for the spreading of a mound of fluid where permeability varied as a power law in the horizontal direction longo et al 2015 also investigated the case of a spreading mound but for a non newtonian fluid barenblatt 1952 solved the pme in the context of gas flow through porous media a zero initial condition was used for both power law hydraulic head and power law volumetric flux inlet boundary conditions planar cylindrical and spherical symmetries were considered it is shown that weak solutions to this class of problems possess advancing fronts which propagate with finite speed the solutions are obtained by the introduction of dimensionless similarity variables which reduce the partial differential equation pde to an ode the first few terms of a power series solution are explicitly given but the approach undertaken requires significant effort to generate further terms no term generating algorithm is provided and the powers in the series are non integer song et al 2007 applied the approach of barenblatt 1952 to investigate the boussinesq equation with a power law hydraulic head inlet boundary condition for an initially dry aquifer in addition song et al 2007 obtained a recursion relation for the coefficients of the power series terms greatly simplifying the process of approximating the solution with arbitrary accuracy this solution was extended to a power law volumetric flux at the boundary by telyakovskiy et al 2010 we approach the problem of flow in an initially dry unconfined aquifer in a semi infinite space where the hydraulic head at the upstream boundary is a power law function of time and the hydraulic conductivity diminishes with depth such flows may occur in shallow systems where saturated groundwater invades a partially saturated zone with soil bulk density increasing with depth we solve a class of problems similar to barenblatt 1952 and song et al 2007 and provide an easy way to generate terms for the series solution the series solution is compared to a numerical solution developed by shampine 1973 results are also compared to an experiment similar to those performed in zheng et al 2013 ciriello et al 2016 and the theoretical setting presented by rupp and selker 2005 2 problem statement we provide a brief derivation of the pme in the context of one dimensional groundwater flow in the x direction over a horizontal impervious base we define h to be the height of the phreatic surface as measured vertically from the base of the aquifer under the hydrostatic assumption velocity v is given by darcy s law 1 v ρ g k μ h x t x where k is the intrinsic permeability and μ the viscosity mass conservation represents a rate of change of the amount of fluid in the elementary volume it is compensated by the fluxes through the left and right vertical faces giving the continuity equation 2 t x x dx 0 h x t ϵ dydx 0 h x t vdy 0 h x dx t vdy we assume power law expressions for porosity ϵ 1 r 1 y ϕ and permeability k c 1 y n neglecting higher order terms 2 becomes 3 t h ϕ 1 x t r 1 ϕ 1 ρ g c 1 μ n 1 n 2 2 x 2 h n 2 x t performing a change of variables for h ϕ 1 h 3 takes the typical form 4 t h a 2 x 2 h m where a r 1 ϕ 1 ρ g c 1 μ n 1 n 2 and m n 2 ϕ 1 the power law parameters ϕ and n are chosen such that the limiting case of the heat equation is avoided 5 n 2 ϕ 1 1 it is easily verified that for constant permeability n 0 and porosity ϕ 0 this expression reduces to the traditional case of the boussinesq equation for a detailed derivation and bounds on the parameters ϕ and n see the supplementary materials we consider 4 as the governing equation for flow from a source such as a river or ditch into an initially dry aquifer with an impermeable horizontal base as shown in fig 1 the domain of this problem is semi infinite and the boundary and initial conditions are specified as 6 h 0 t σ t α σ 0 1 m 1 α 7 lim x h x t 0 t 0 8 h x 0 0 x 0 the parameters σ and α are chosen to control the height of the invading fluid at the x 0 inlet boundary the water level of the fluid reservoir adjacent the aquifer is controlled by the exponent α the value of the exponent α 1 m 1 corresponds to the free spreading of a mound of groundwater while the case of α 0 corresponds to a rising water level at the boundary x 0 the case of α 1 represents a linearly rising water level at the boundary while the case of α 0 corresponds to the important practical application of a constant water level in the fluid reservoir if α 1 m 1 then the water level at x 0 drops faster than it does in the porous medium due to gravity this results in back seepage at x 0 requiring a different analysis than the one presented here depending on the properties of the fluid and porous media the exponent m takes different values the value m 5 can be used to model flow through concretes lockington et al 1999 forest soils may have values ranging from m 2 2 to m 8 9 beven 1982 flow of air at atmospheric conditions through soils can be modeled with m 2 405 vazquez 2007 classical groundwater flow can be modeled with the boussinesq equation where m 2 which is the case that we generalize in this paper the zero initial condition given by eq 8 represents an initially dry aquifer such a situation can occur when a dry river bed is suddenly flooded after a dry season and the water level rises with α 0 another important situation is the case of a river rising rapidly to a constant stage possible during flash flooding and irrigation for modeling purposes this scenario can be modeled with the constant boundary condition h 0 t σ α 0 lockington 1997 to date multiple studies have analyzed these problems e g prasad and salomon 2005 lockington et al 2000 and srivastava et al 2006 similarly the case of filtration through concretes with a zero initial saturation was considered by lockington et al 1999 if the aquifer is partially filled with water initially then the solutions to the pme propagate with infinite speed see e g polubarinova kochina 1962 in practical applications we expect a finite speed of propagation for the infiltration of water when the initial condition 8 is zero a finite speed of propagation is guaranteed barenblatt and vishik 1956 3 analytical solution using dimensional analysis the pme problem is reduced to an ode problem with a similarity variable transformation following barenblatt 1952 1954 we introduce two dimensionless variables ξ and h as 9 ξ x 1 α m 1 1 2 a σ m 1 t 1 α m 1 1 2 and 10 h σ t α h ξ where ξ x t is the similarity variable and h ξ is a scaling function the factor 1 α m 1 1 2 is introduced to 9 to simplify later expressions substitution of 9 and 10 into 4 results in the ode 11 d 2 h m ξ d ξ 2 ξ 2 d h ξ d ξ λ h ξ 0 where λ α 1 α m 1 in this expression λ takes on values in the finite interval 1 2 1 m 1 simplifying the problem solutions to 4 8 propagate with finite speed barenblatt and vishik 1956 guaranteeing that there is a position ξ 0 ξ beyond which the scaling function h ξ is identically zero the boundary and initial conditions reduce to 12 h 0 1 and 13 h ξ 0 0 where ξ 0 is defined as the position of the advancing front and should be found in the process of solution in the physical plane 13 represents a moving point on the base of the aquifer where there is a sharp transition from the invading water to air in general the ode 11 contains terms with non integer values of m 1 we obtain an ode with integer powers using the substitution 14 h u 1 m 1 where u is often referred to as mathematician s pressure vazquez 2007 eqs 11 13 then become 15 m m 1 u d 2 u d ξ 2 m m 1 m m 1 1 d u d ξ 2 ξ 2 1 m 1 d u d ξ λ u 0 with 16 u 0 1 and 17 u ξ 0 0 in 15 17 the function u and its derivatives have integer powers following barenblatt 1952 and song et al 2007 we seek the solution to 15 using a power series of the form 18 u ξ n 0 a n 1 ξ ξ 0 n using the boundary condition 16 we obtain the condition 19 n 0 a n 1 while 17 gives 20 a 0 0 substituting 18 into 15 and simplifying we obtain an expression for the coefficients of the power series 0 m m 1 1 ξ 0 2 k 0 n a n k a 2 k 2 k 1 k m m 1 m m 1 1 1 ξ 0 2 k 0 n a k 1 a n 1 k k 1 n 1 k 1 2 1 m 1 n λ a n 1 2 1 m 1 a n 1 n 1 evaluating the above when n 0 together with a 0 defined by eq 20 we find the following expression for a 1 a 1 ξ 0 2 m 1 2 m performing one more evaluation for the n 1 case we find that a 2 ξ 0 2 2 λ 1 2 m 1 m 1 m 2 we can obtain an explicit formula for a n 1 by rearranging terms in the above sums after algebraic manipulation we obtain a recurrence relation for n 2 21 a n 1 2 n 1 m n m 1 1 1 ξ 0 2 k 0 n 2 a n k a 2 k 2 k 1 k 2 n 1 m n m 1 1 1 m 1 1 ξ 0 2 k 1 n 1 a k 1 a n 1 k k 1 n 1 k 2 n 1 m 1 n m 1 1 λ 1 2 1 m 1 n a n this formal series solution generalizes the series solution for the case of the boussinesq equation m 2 produced by song et al 2007 their paper has shown that the coefficients an of the power series 18 are bounded by a convergent number series of the form an c n 2 which justifies convergence when m 2 likely a similar convergence result would hold when an is defined by 21 the series solution presented here is an exact analytical solution of the problem and can serve as a benchmark to test numerical codes or quickly obtain an analytical form of a phreatic surface profile moreover the series converges very quickly and a small number of terms can be used to approximate the solution as further results in this paper illustrate the location of the advancing front ξ 0 can be found using the coefficients of the power series using eq 21 and the values for a 0 and a 1 found earlier it can be shown that every coefficient an contains the factor ξ 0 2 factoring ξ 0 2 the condition 19 gives n 0 ξ 0 2 a n 1 where a n a n ξ 0 2 solving for ξ 0 we have 22 ξ 0 n 0 a n 1 2 it is now possible to construct an arbitrarily accurate solution to the problem 11 13 if we take a sufficiently large number of terms in the power series 18 and use the change of variables 14 using the definitions of the dimensionless variables ξ and h given by eqs 9 and 10 we can obtain a highly accurate solution to the original problem 4 8 the numerical results presented in the next section show that the power series 18 converges rapidly 3 1 numerical solution of the ode to solve 11 13 numerically we apply the method of shampine 1973 to 15 17 followed by the transformation 14 this numerical procedure is performed without pre determining the position of the wetting front ξ 0 a solution is achieved with a runge kutta solver by setting ξ 0 1 and solving backward toward ξ 0 the solution is then rescaled to satisfy the boundary condition 12 for a detailed explanation we refer the reader to shampine 1973 defining w d u d ξ we can write 15 as the first order system 23 d u d ξ w u ξ 0 0 d w d ξ 1 u m m 1 1 w 2 1 m u ξ 2 w λ m 1 m w ξ 0 ξ 0 m 1 2 m the boundary condition u ξ 0 0 creates undefined terms in the system 23 this issue is alleviated by using taylor expansions to generate starting values in the vicinity of ξ 0 1 the taylor series for u and its first derivative are u ξ ξ 0 m 1 2 m ξ ξ 0 1 2 m 1 1 2 m 1 λ 2 m 2 ξ ξ 0 2 1 3 2 m 1 1 2 m 1 λ 6 m 1 λ 3 ξ 0 2 m 1 4 m 3 ξ ξ 0 3 and d u ξ d ξ ξ 0 m 1 2 m m 1 1 2 m 1 λ 2 m 2 ξ ξ 0 1 2 2 m 1 1 2 m 1 λ 6 m 1 λ 3 ξ 0 2 m 1 4 m 3 ξ ξ 0 2 a runge kutta solver can be used to solve this system from the vicinity of ξ 0 1 to ξ 0 so we step away from ξ 0 using the above taylor expansions to start calculations eqs 11 and 15 are invariant under the scaling 24 h ξ μ f μ m 1 2 ξ where μ is an arbitrary positive constant and f ξ is a solution of 11 or 15 barenblatt 1952 this can be verified by substituting 24 into 11 and 15 and differentiating to solve 15 we choose the scaling 25 u ξ 1 f 0 λ f f 0 λ m 1 2 ξ where f ξ is a solution to 15 such that ξ 0 1 i e f 1 0 the solution to 11 is obtained by reversing the substitution 14 numerical solutions in the similarity variable space for representative values of m 1 5 and m 4 are presented in fig 2 4 laboratory experiment a wedged hele shaw cell experiment was constructed to compare solutions of the pme to lab scale simulations of subsurface flow the wedge configuration is formed from two flat plates in contact at their base to form a v liquid flows between the plates with permeability simulated as a result of viscous drag the distance between the plates varies as a linear function of height y only resulting in a permeability profile k k y that depends on the vertical coordinate only the combination of viscosity and distance between the plates can be adjusted to ensure that the flow is sufficiently slow and laminar thus the flow at any height can be approximated by poiseuille flow between parallel plates for a given width b y this is a common assumption that leads to reasonable results and greatly simplifies analysis e g zheng et al 2014 ciriello et al 2013 4 1 derivation of the governing equation flow in a wedged hele shaw cell with the above poiseuille flow assumption represents a special form of the pme 4 we derive a governing flow equation in a manner similar to zheng et al 2013 or longo et al 2015 but in a different setting the triangular cross section of the wedge with thickness dx is taken as an elementary fluid element thickness is taken in the fluid flow direction as shown in fig 3 conservation of mass dictates that the rate of change of fluid in the elementary volume is equal to the difference in volumetric fluxes through the faces at x and x d x 26 t 0 h v x t b y d y d x 0 h v x t b y u v x y t d y 0 h v x d x t b y u v x d x y t d y where the width of the wedge for height y is given by b y uv is the fluid speed in the x direction and hv x t is the height of the free surface full saturation within the fluid element implies a porosity of 1 though mass does vary in the vertical direction we consider only the flux of an incompressible fluid and disregard the movement of the gaseous phase neglecting the higher order terms of the taylor expansion in the second term on the right hand side of 26 we obtain 27 t 0 h v x t b y d y d x x 0 h v x t b y u v x y t d y d x darcy s law is used for the velocity uv 28 u v x y t b 1 2 y 2 ρ g 12 μ h v x t x here we have used the poiseuille flow approximation to calculate the permeability 29 k y b 1 2 y 2 12 where b y b 1 y the constant b 1 has been derived using similar triangles in a vertical cross section of the wedge the outer triangle is defined by the dimensions of the experiment and the inner is defined by the fluid saturated zone the total height and maximum width of the cell are known and we can calculate the width at any given height as a function of vertical location thus given an arbitrary elevation y within the wedge multiplying by b 1 returns the corresponding width between the plates at that height performing these substitutions and integrating yields 30 t h v 2 b 1 2 δ ρ g 24 μ x h v 4 h v x here δ ρ ρ f l u i d ρ a i r ρ f l u i d the change of variables h h v 2 results in an equation that can be solved with the same process as presented for 4 4 2 experiment design and results our wedged hele shaw cell is constructed from two glass plates forming a v held in place by an aluminum t slot frame and two acrylic sheets the glass plates are held together tightly at the bottom of the v leading to a zero permeability base in the context of porous media flows a pvc pipe with a vertical slit depicted in fig 4 provides a constant boundary condition up to a height of 0 155 m glycerol was chosen as the liquid due to its high viscosity allowing the experiment to be run slowly enough to ease challenges associated with data collection and maintaining boundary conditions for less viscous liquids it is difficult to simultaneously provide enough liquid to the boundary maintain a constant height and keep flow in the boundary tube laminar parameters for the three experimental trials performed are given in table 1 mathematically changes in the parameter a from eq 4 represents a dilation or contraction of the similarity variable ξ as any value of a can be obtained with non unique parameter combinations we have chosen to vary only the gap widths given in table 1 this approach offers the greatest consistency across trials fluid properties that are not accounted for in the model such as surface tension remain unchanged a small pump was used to supply glycerol to the boundary reservoir a constant boundary condition was chosen as an important special practical case of the power law boundary solution when α 0 and σ 0 155 m to maintain a constant boundary height glycerol is allowed to overflow out of the experiment through the back of the boundary condition the dynamic viscosity of glycerol was measured using a ball drop viscometer at a room temperature of 20 c the average value was measured to be μ 1 4092 0 0281 pa s density was found to be ρ 1263 2230 kg m 3 results were recorded by hand and with a camera set on a timer the form of the pme used to model flow in the hele shaw wedge is 31 t h b 1 2 δ ρ g 120 μ 2 x 2 h 5 2 where h h v 2 and b 1 is given by the ratio of gap width to 0 155 m propagation distances for the three experiments performed are plotted in fig 5 experimental results consistently under perform as compared to the similarity variables for early time where flow has not yet transitioned into a similarity regime straight lines represent the analytical solution given by 9 when α 0 and ξ 0 is obtained from 22 values of a are produced by non unique parameter combinations so varying the gap can be mathematically interpreted as variations in ρ or μ as well dashed error bars are calculated using the errors associated with the viscometer scale and caliper used for each the maximum deviations were added and subtracted to the associated measurements used to compute a in the similarity variable ξ addition or subtraction on each parameter was chosen based on which would slow or increase the propagation distance ξ the trial with the smallest gap shows the greatest possible error as the gap size is smaller relative to the precision of the caliper used comparisons of the series solution with the experimental results for the three experimental trials are given in fig 6 results displayed correspond to times where the flow was transitioning or had entered a similarity regime of well developed flow there is a consistent match in profile shape and time evolution disagreement between the model and experiment is expected in the lower section of the experiment where the plates converge to zero permeability the curves specifying the analytic solution in fig 6 can be thought of as the exact analytical solution of the problems 4 8 since they have been obtained with a large number of terms in the power series 18 these results are achieved with no modification to the pme solution though we expect a disagreement between the physical flow and theory at the base of the wedge 5 discussion we observed good agreement between the series solution and numerical results in the similarity variable space multiple values of m were investigated and in all cases the series solution converged very quickly to accuracy levels required for hydrology applications fig 7 shows a comparison of the partial sums of the series and the numerical solution for m 4 we believe that the coefficients an of the power series decay very quickly and we have not only an c n 2 but an cn n 2 where cn 0 as n this allows us to take a small number of terms in the series and obtain very accurate results for m 2 solutions to the pme are characterized by steep phreatic surfaces near the advancing front this can be seen in the comparison of the m 1 5 and m 4 cases in fig 2 numerical error can become significant because we used a taylor series to approximate the slope at the advancing front this can be alleviated by switching the independent and dependent variables as outlined in shampine 1973 fig 8 shows the first experimental trial at an early time of t 9 min the governing equations were derived under the assumption of a nearly horizontal phreatic surface in fig 8 there is a 0 16 m change in the phreatic surface height over approximately 0 2 m of horizontal distance consequently the df assumption is inadequate and early time results can not be modeled by the pme it is likely that the undercutting observed is a combined effect of steep phreatic surface permeability profile and strong capillary forces at the bottom of the wedge this early time behavior was observed across all experiments performed to determine when the experiment reaches a flow regime applicable to our model assumptions we plot the height of the undercutting observed in fig 8 as a function of elapsed time for the first trial fig 9 depicts the evolution of this phenomenon for trial 1 with a constant height reached after approximately 60 min after this time undercutting persists at a height of approximately 1 cm to 1 5 cm we refer to flows where the undercutting has reached a steady state as being well developed because the flow has transitioned to a similarity flow regime though the early time results of the experiment are not represented by the governing assumptions of the pme good agreement was reached at later times fig 9 indicates that the bottom 1 cm to 1 5 cm of the experiment can not be modeled by the pme for the gap used in the first trial however this represents such a small volume of fluid flow that the solution curves are minimally affected this phenomenon is likely due to capillary forces which are not accounted for in our derivation of the pme the early time concavity change in the undercutting height observed in fig 9 is likely due to a confluence of dynamic factors including vertical motions caused by the steep free surface at early times because we employed the df assumption in our derivation of the pme an explanation of this interesting behavior is not provided by the equation governing flow we note that the method of determining when the flow is well developed in fig 9 is motivated entirely by empirical evidence and that the effects of vertical velocity and capillarity could not be measured independently the proper use of the df assumption is to some degree arbitrary and application dependent we employed the height of undercutting as the only observable quantity available and it provided us with a match between the modeled and experimental phreatic surfaces these empirical results provide guidelines for when capillary forces can safely be disregarded and modeling flow with the pme is appropriate the complex role of capillary in the experiment warrants further investigation but is outside the scope of this paper a simple analysis can be conducted to define the average free surface slope as the flow transitions to a constant height of profile undercutting we calculated the average free surface angle β 32 tan β h 0 l as diagrammed in fig 10 for our experiment we calculate the average angle β 17 occurring after the glycerol has propagated a length of approximately 52 cm into the experiment this calculation can be applied to the design of further experiments that use the same permeability profile for a different boundary height h 0 the approximate characteristic length l required to obtain minimal undercutting is simply 33 l h 0 tan β for the purposes of designing experiments with other permeability profiles we suggest generating solutions to the associated pme and choosing the time that gives the same average free surface angle we note that as the pme exponent m increases the average angle β will be increasingly less representative of the free surface solution curves for experiments with m much larger than what is presented here we expect this method to underestimate the distance at which undercutting will reach its lower limit 6 conclusion we constructed a solution to the pme that models horizontal infiltration in an unconfined aquifer the aquifer was assumed to be initially dry and the water level varied at the inlet as a power law function of time this problem allows the introduction of similarity variables and the reduction of the initial boundary value problem for a pde to a free boundary value problem for an ode a solution in the form of a power series was constructed for the ode moreover a recursion relation for the coefficients of the series was obtained as a result arbitrarily accurate solutions can be constructed to serve as a benchmark for numerical codes our comparison of the series solution to a highly accurate numerical solution shows that the power series converges quickly and a small number of terms is sufficient to obtain highly accurate analytical results in addition to the series solution flow was modeled experimentally in a wedged hele shaw cell under the lubrication or poiseuille flow assumption the governing flow equation represents a special type of the porous medium equation other forms of the pme modeling fluid flow may be obtained when more complicated hele shaw cell configurations are used we compared the theoretically predicted and experimentally observed phreatic surface profiles the pme solutions agree well with the wedged hele shaw cell observations when the flow is well developed and the phreatic surface is not steep acknowledgments we thank john selker for the suggestion to perform the experiment using a wedged hele shaw cell a t thanks jean yves parlange and tammo steenhuis for the discussions related to the behavior near the propagation front we thank john selker and two anonymous reviewers for providing useful comments that improved the quality of this paper supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 005 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
817,simulations of simultaneous steady state two phase flow in the capillary force dominated regime were conducted using the state of the art shan chen multi component lattice boltzmann model scmc lbm based on two dimensional porous media we focused on analyzing the fluid distribution i e wp fluid solid np fluid solid and fluid fluid interfacial areas as well as the capillary pressure versus saturation curve which was affected by fluid and geometrical properties i e wettability adhesive strength pore size distribution and specific surface area how these properties influenced the relative permeability versus saturation relation through apparent effective permeability and threshold pressure gradient was also explored the scmc lbm simulations showed that a thin wp fluid film formed around the solid surface due to the adhesive fluid solid interaction resulting in discrete wp fluid distributions and reduction of the wp fluid mobility also the adhesive interaction provided another source of capillary pressure in addition to capillary force which however did not affect the mobility of the np fluid the film fluid effect could be enhanced by large adhesive strength and fine pores in heterogeneous porous media in the steady state infiltration not only the np fluid but also the wp fluid were subjected to the capillary resistance the capillary pressure effect could be alleviated by decreased wettability large average pore radius and improved fluid connectivity in heterogeneous porous media the present work based on the scmc lbm investigations elucidated the role of film fluid as well as capillary pressure in the two phase flow system the findings have implications for ways to improve the macroscopic flow equation based on balance of force for the steady state infiltration keywords steady state fluid distribution capillary pressure relative permeability lattice boltzmann model 1 introduction the steady state infiltration through porous media i e the simultaneous flow of two immiscible fluids at the dynamic equilibrium is commonly encountered in natural and industrial processes such as non aqueous phase liquid napl migration oostrom and lenhard 1998 fagerlund et al 2006 and enhanced oil recovery liu and zhang 2015 yu et al 2015 the flow pattern features the competition between local drainage and local imbibition associated with breakdown and coalesce of fragmented fluid clusters and the spatiotemporally invariant fluid saturation fluid flux capillary pressure and interfacial area at the statistical equilibrium avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 modelling of such two phase flow process at the macroscale relies on the typical constitutive relationships including relative permeability k rσ and capillary pressure p c as function of fluid saturation s w as defined below li et al 2017b bear and cheng 2010 1 k r σ s w k σ k sat 2 p c s w p n p w where σ w n denotes wetting phase wp or non wetting phase np fluid and k σ k sat and p σ are effective permeability in the extended two phase darcy equation intrinsic permeability and fluid pressure respectively these two equations provide an averaged representation of fluid and geometrical properties inside a representative elementary volume rev of the given solid wp fluid np fluid system however they are not truly constitutive in the sense that k rσ s w relation and p c s w curve are both strongly hysteretic with respect to the flow conditions i e steady state infiltration or transient displacement li et al 2017b dana and skoczylas 2002 tsakiroglou et al 2007 ramstad et al 2012 and the capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 in practice it is questionable either to apply the k rσ s w relation measured in the steady state infiltration to predict the transient displacement behavior or to utilize the p c s w curve acquired from the displacement experiment for the steady state flow analysis li et al 2017b film fluid around the solid surface and capillary pressure have been identified as important factors in controlling the k rσ s w relation in the capillary force dominated regime hao et al 2008 dou et al 2014 as the focus of this study both factors are intrinsic to the two phase flow system in the coupled thermo hydrodynamic steady state infiltration longmuir 2004 suggested that the adhesive interaction between fluid molecules in the pore and solid particles at the surface is capable of generating a wp fluid film around the solid surface which reduces the wp fluid mobility the degree of easiness for the fluid movement and makes the fluid behave in a non newtonian way at the macroscale benzi et al 2006 observed that the repulsive fluid solid interaction compelled the fluid particles to be away from the solid surface and the fluid density and viscosity drop rapidly near the solid wall causing the apparent slippage behavior to account for the macroscale effects of capillary force on the two phase fluid flow hassanizadeh and gray 1993a b proposed an advanced two phase flow theory by introducing the fluid fluid interfacial area as a new independent state variable the proposed darcy equation included gradients of fluid saturation and fluid fluid interfacial area as the driving forces the interfacial areas can be determined through the image analysis technique and calculated as follows chen et al 2007 porter et al 2010 3 a nw s w a n a w a s 2 a ws s w a w a nw a ns s w a n a nw where a s a w and a n denote the specific surface areas of solid grains wp fluid and np fluid respectively and a nw a ws and a ns represent the fluid fluid wp fluid solid and np fluid solid interfacial areas respectively the two phase flow process during the steady state infiltration can be supposed to be the result of an interplay between gravity and adhesive capillary and viscous forces at the pore scale as shown in fig 1 the individual wp and np fluid packets in the two phase flow system may form connected pathways or isolated in the form of bridges or ganglion as given by the extended two phase darcy equation bear and cheng 2010 the stationary solid exerts viscous force on the two flowing fluids tangentially on the fluid solid interfacial area adhesive or repulsive force is imposed by the solid surface to the adjacent fluids normally longmuir 2004 benzi et al 2006 on the fluid fluid interfacial area both normal capillary resistance to the flow of two neighboring fluid packets hassanizadeh and gray 1993a b and tangential viscous coupling between the two flowing fluids occur in the capillary force dominated regime viscous coupling process is not significant and hence adhesive capillary and viscous forces dissipate almost all the input energy through the interfacial areas at the dynamic equilibrium where the macroscopic state variables reach the steady state bear and cheng 2010 benzi et al 2006 berga et al 2013 chen et al 2007 2017 constantinides and payatakes 1996 a new macroscopic flow equation based on balance of force with consideration of the interfacial areas and the local parametrized pore scale forces can be potentially established nevertheless so far attention has rarely been paid to how fluid and geometrical properties determine the interfacial areas the film fluid and the capillary pressure at the steady state on the other hand a large volume of literature concerned with the steady state relative permeability subject to these properties have been published in the past few decades as the wettability increased the wp relative permeability at each saturation decreased li et al 2005 hao and cheng 2010 landry et al 2014 due to the wp fluid in contact with more solid surface while the np relative permeability increased for the sphere pack porous medium li et al 2005 and carbon paper gas diffusion layer hao and cheng 2010 but decreased for the bead pack system landry et al 2014 the different behaviors of the np relative permeability under the varying wettability could be attributed to two opposing mechanisms with increased wettability less np fluid solid interfacial area with less viscous resistance dominated the packing spheres li et al 2005 and gas diffusion layer hao and cheng 2010 whereas more disconnected np fluid with larger capillary resistance was dominant in the packing beads landry et al 2014 furthermore the rock wettability can be altered by the distribution of brine and oil as a result the effect of mixed wettability on the relative permeabilities of two immiscible fluids becomes more complex landry et al 2014 when evaluating the data of fluid flux versus pressure gradient for saturated clays swartzendruber 1962 was surprised to find a few positive pressure gradient intercepts of the fitted lines for the soils with more clay content subsequently miller and low 1963 and prada and civan 1999 observed the threshold pressure gradient in clay and sandstone respectively below which the fluid could not flow the nonlinear flow phenomenon was supposed to be due to reduced film fluid mobility and macroscale non newtonian fluid flow behavior caused by the adhesive fluid solid interaction longmuir 2004 further hao et al 2008 and dou et al 2014 suggested that the threshold pressure gradient phenomenon in the two phase flow process resulted from two aspects film fluid effect and capillary resistance offering a complete interpretation for the dependence of the k rσ s w relation on capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 studies have been carried out on various pore size distributions generated in homogeneous and heterogeneous porous media dou and zhou 2013 it was demonstrated that the np fluid in heterogeneous porous media could more readily become continuous experiencing less capillary trapping and thus the np relative permeability in heterogeneous porous media was significantly higher than that in homogeneous porous media dou and zhou 2013 in contrast the wp fluid in heterogeneous porous media was more discretely distributed with more extensive contacts with solid surface and hence the wp relative permeability in heterogeneous porous media was slightly lower dou and zhou 2013 with increasing specific solid surface area ghassemi and pak 2011 gao et al 2015 the np relative permeability decreased significantly while the wp relative permeability remained almost invariant this was because the wp fluid became more connected to not only itself but also solid surface and the resulting effects cancelled each other to a large extent causing little change in the wp relative permeability also a higher pressure gradient was needed for the fully connected np fluid flow to reach the linear flow regime due to higher fraction of small pore sizes zhang et al 2016 the effects of fluid and geometrical properties on the fluid flow behavior were found to be strongly coupled hao et al 2008 dou et al 2014 for example a high fraction of fine pores in heterogeneous porous media facilitated the generation of film fluid and the small pore radius in homogeneous porous media favored the capillary resistance compared with the constitutive relationships the pore scale configuration of two immiscible fluids would provide fundamental understandings of the macroscopic transport behavior avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 in addition to x ray micro computed tomography chen et al 2007 porter et al 2010 and microscopic piv measurements kazemifar et al 2016 li et al 2017a simulations using the lattice boltzmann models reveal the pore scale information of high temporal resolution regarding interfacial areas and cluster sizes in these models the desired fluid and geometrical properties can be designed with powerful parallel computations and complex pore space geometry so far lattice boltzmann models have been widely applied in the two phase porous media flow simulation to address the problems of p c s w curve pan et al 2004 schaap et al 2007 p c s w a nw surface k rσ s w relation li et al 2005 hao and cheng 2010 landry et al 2014 dou and zhou 2013 ghassemi and pak 2011 gao et al 2015 zhang et al 2016 fluid distribution and fluid displacement pattern liu et al 2014 2015 tsuji et al 2016 xu et al 2017 zhang et al 2011 berga et al 2013 zhao et al 2016 chen et al 2017 the readers can refer to huang et al 2015 and liu et al 2016 for a review of various multiphase lattice boltzmann models among which the shan chen multi component lattice boltzmann model scmc lbm based on the interaction between particles shan and chen 1993 shan and doolen 1995 martys and chen 1996 is rather efficient and versatile in the present work the state of the art scmc lbm model is used to conduct the simultaneous steady state two phase flow simulation based on two dimensional porous media compared with previous studies li et al 2005 hao and cheng 2010 landry et al 2014 dou and zhou 2013 ghassemi and pak 2011 gao et al 2015 zhang et al 2016 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 this study focuses on exploring the role of film fluid and capillary pressure in the non uniqueness of k rσ s w relation which has not been well understood so far in the capillary force dominated regime the fluid distribution as well as the capillary pressure versus saturation curve subject to the influence of fluid and geometrical properties is characterized how these factors are linked with the relative permeability versus saturation relation through the apparent effective permeability and the threshold pressure gradient is also investigated simulations were carried out including effects of fluid wettability adhesive strength pore size distribution and specific surface area which are all important for fluid film formation and capillary pressure the fluid fluid wp fluid solid and np fluid solid interfacial areas serve as the fluid distribution descriptors the following section will briefly describe the principle of scmc lbm model setup of the fixed flow condition and the varying fluid and geometrical properties for the steady state two phase flow simulation as well as the procedure for post processing simulation data the scmc lbm simulation results will be discussed in section 3 and conclusions drawn in the last section 2 scmc lbm model 2 1 model principle over the last two decades the lattice boltzmann models on the basis of mesoscopic kinetic theory he and luo 1997 have been widely applied in simulating the two phase porous media flow among them the scmc lbm model based on the interaction between particles shan and chen 1993 shan and doolen 1995 martys and chen 1996 is chosen in this study because of its efficiency and versatility this model has also been well validated against measured p c s w curves pan et al 2004 schaap et al 2007 and k rσ s w relations ramstad et al 2012 ghassemi and pak 2011 in the following we briefly describe the basic model formulations the particle distribution function f i σ related to the ith discrete velocity direction at position x at time t is assigned at each lattice node for each of the two fluid components which evolves according to the lattice boltzmann equation with the bhatnagar gross krook bgk approximation as follows he and luo 1997 4 f i σ x e i δ t t δ t f i σ x t δ t τ σ f i σ x t f i σ eq x t where e i is the discrete velocity δt the time step τσ the relaxation time and f i σ eq the maxwell boltzmann equilibrium distribution function both of the two fluid components occupy each lattice node in the domain simultaneously and the minor component can be considered as being dissolved within the major component the left hand side is a streaming process passing the particle distribution to the neighboring nodes while the right hand side is a collision process partially relaxing the particle distribution to the equilibrium distribution this discrete velocity model is commonly referred to as d d q m model where d and m are the number of dimensionalities and discrete velocities the macroscopic fluid density ρσ can be thought of as a series of direction specific fluid densities and the macroscopic flow velocity u σ is referred to as an average of the microscopic velocities weighted by the directional densities he and luo 1997 5 ρ σ i 0 m 1 f i σ u σ 1 ρ σ i 0 m 1 f i σ e i the equilibrium distribution function can be calculated by he and luo 1997 6 f i σ eq ρ σ w i 1 e i u σ eq c s 2 e i u σ eq 2 2 c s 4 u σ eq u σ eq 2 c s 2 where wi are the weight coefficients cs the sound speed and u σ eq the equilibrium velocity if the external force f σ is considered the equilibrium velocity is expressed by he and luo 1997 7 u σ eq u τ σ f σ ρ σ where u is the common velocity of the two fluid components to obtain the equilibrium velocity the density ρ and velocity u of the whole fluid are defined by martys and chen 1996 8 ρ ρ σ ρ σ u σ σ i 0 m 1 f i σ e i τ σ σ σ ρ σ τ σ the external force includes the body force g σ ρσ g if specified as well as the interaction forces f r σ between fluid and fluid and f s σ between fluid and solid as follows martys and chen 1996 9 f σ g σ f r σ f s σ the repulsive interaction between σth and σ th fluid component leading to phase separation and interface maintenance is realized by the inter particle force given by shan and doolen 1995 10 f r σ x t g r ρ σ x t i 0 m 1 w i ρ σ x e i t t e i where g r is the repulsion parameter which is positive and controls the strength of repulsive interaction the repulsion strength determines the interfacial tension and the thickness of fluid fluid interfacial layer the phase separation for the uniformly mixing two fluid components can take place for g rρ 1 0 yielding the interfacial layer while the interfacial layer thickness reaches convergence for g rρ 1 6 but the fluid compressibility begins to take effect for g rρ 2 0 huang et al 2007 the proper range for stable simulations is therefore 1 6 g rρ 2 0 huang et al 2007 for the bgk d2q9 lattice boltzmann model the fluid pressure can be determined by pan et al 2004 11 p c s 2 ρ g r ρ σ ρ σ when the solid boundary is present each fluid component may interact with the solid boundary independently the adhesive interaction between σth fluid component and the solid particles can be achieved by the inter particle force as follows he and luo 1997 12 f s σ x t g s σ ρ σ x t i 0 m 1 w i s x e i δ t t e i where s x e i δt t is an indicator function that equals 0 1 for the σth fluid component solid particles and g s σ is the adhesion parameter which is positive negative for the np wp fluid huang et al 2007 sukop and thorne 2006 the difference in adhesion strengths for the wp and np fluids determines the contact angle θ two well known approximations to the contact angle are expressed by 13 cos θ g s n g s w g r ρ w ρ n 2 59 cos θ g s n g s w g r 60 for the bgk d2q9 lattice boltzmann model used in this study the nine discrete velocities a zero velocity and eight velocities pointing to the neighboring nodes and the weight coefficients are given as below he and luo 1997 14 e 0 e 1 e 2 e 3 e 4 e 5 e 6 e 7 e 8 c 0 1 0 1 0 1 1 1 1 0 0 1 0 1 1 1 1 1 15 w 0 w 1 w 2 w 3 w 4 w 5 w 6 w 7 w 8 4 9 1 9 1 9 1 9 1 9 1 36 1 36 1 36 1 36 to recover the macroscopic navier stokes equations from the bgk d2q9 lattice boltzmann equation the kinematic viscosity νσ related to the relaxation time and the sound speed related to the basic speed c should be formulated as he and luo 1997 16 ν σ c s 2 τ σ 1 2 δ t 17 c s 2 c 2 3 in order to circumvent the numerical difficulties he and luo 1997 τσ 1 is the safest value far away from 0 5 and also the mach number has to satisfy 18 m a u σ max c s 1 the basic speed is always taken as the ratio of lattice distance δx 1 lu to the time step δt 1 ts i e c δx δt 1 lu ts the simulation procedure during the time interval t n 1 t n follows a few successive steps first f i σ eq n 1 are calculated from ρσ n 1 and u σ n 1 using eq 6 and then f i σ n 1 are collided following the rule of the bgk approximation in eq 4 second f i σ n 1 are streamed to the neighbouring nodes over t n 1 t n with the boundary condition implemented where needed f i σ n on the solid boundaries are obtained using the bounce back boundary condition sukop and thorne 2006 such that f i σ n f i σ n 1 where ith represents the opposite direction to ith and f i σ n on the domain boundaries are treated as the periodic boundary condition sukop and thorne 2006 if the body force is specified as the driving force thirdly ρσ n and u σ n are computed using f i σ n based on eq 5 the simulation ends if the steady state criterion is reached and ρσ n and u σ n are then stored visualized and post processed the discretization effect is an important aspect of the numerical solution in the scmc lbm simulations of real flow systems pan et al 2004 examined the minimum lattice resolution required for the simulation based on the three dimensional packings of spheres with uniform size distributions and found that the simulated intrinsic permeability and primary drainage p c s w curve became essentially lattice resolution independent if the mean pore throat radius was larger than 3 lattice units the convergence of the numerical solution was also supported by good agreements with the experimental data pan et al 2004 sukop and thorne 2006 proposed a similar rule of thumb that 4 or 5 lattice units were the minimum width of an open flow channel for converged solutions in the simulation of realistic hydrodynamics 2 2 model setup in the fractional flow experiments avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 the porous sample is mounted onto a flow cell with two series of syringe pumps that control the flux of individual fluids the pressure drops measured by pressure sensors at the inlet and outlet of the cell are used for checking if the statistical equilibrium is reached in similar manners the steady state two phase flow simulation is conducted using the scmc lbm model based on two dimensional porous media in this study the units of distance time and mass in the model are lu ts and mu respectively following the rule of conversion i e 1 lu 1 0 10 5m 1 ts 5 0 10 6s and 1 mu 5 0 10 13 kg input properties and output variables of the model can be expressed in physical units in order to link mesoscopic simulations with engineering practices in real world 2 2 1 initial and boundary conditions the present work focuses on the effect of varying fluid and geometrical properties on the macroscopic state variables thus all the simulations will be carried out under the fixed flow condition initially the wp fluid is positioned in the center of the upper and lower half regions with the remaining region occupied by the np fluid fig 2 as such the horizontal homogeneity of fluid distribution can be guaranteed when there is no external force to distribute the fluids horizontally the width of wp fluid regions can be changed to adjust the overall wp fluid saturation in the whole simulation domain the body force can be relatively easily implemented in the scmc lbm model thus the two phase flow is driven by gravity vertically with the periodic boundary conditions sukop and thorne 2006 fig 2 the outflowing fluids reenter the porous medium from the top inlet boundary periodically in this way capillary end effect can be accordingly avoided and the saturation keeps invariant during the flowing process to ensure the capillary force dominated regime both fluids are subjected to the same gravity g σ 6 0 10 5 as expressed in terms of the magnitude of pressure gradient p 24 kpa m for convenience in interpretation the flow simulations start with a zero velocity field 2 2 2 fluid and geometrical properties in the capillary force dominated regime buoyancy effect and viscous coupling process are not significant valavanides et al 1998 valavanides and payatakes 2001 thus the wp and np fluids with equivalent densities and viscosities are adequate for approximating the oil water or napl water system with densities and viscosities of the same order of magnitude in the scmc lbm model each fluid phase consists of two fluid components the density ratio of major component to minor one is set to be 999 fig 2 and the physical density of each fluid phase is ρ w ρ w 1 0 103 kg m3 with the relaxation time 0 95 for stable numerical solutions sukop and thorne 2006 the physical dynamic viscosity of each fluid phase is taken as μw μn 3 0 10 3 pa s a segment of the randomly packed system with unequal grains is chosen to represent the rev of a two dimensional porous medium the lattice pixel number m n 800 800 is sufficient for a visualization of interfacial areas and fluid clusters thus dimension of the segment is 8 0mm 8 0mm fig 3 b a benchmark case is established to illustrate the steady state fluid distribution interfacial areas capillary pressure and relative permeability as presented in section 3 1 the repulsive adhesive strength for fluid fluid fluid solid interaction in the model is taken to be g r g s 1 0 0 5 the fluid configuration in a tube at the capillary equilibrium fig 3 a shows that the wp fluid has a strong wettability and a thin film forms near the solid wall the resulted interfacial tension and contact angle are computed using the laplace equation relating the pressure difference to the bubble curvature bear and cheng 2010 and the fluid interface based formula huang et al 2007 respectively an array of 300 unequal grains is initially deployed in contact with each other in a way that the solid grains with a pre defined radius distribution occupy the maximum volume within the given domain in order to allow the two phase fluid flow through the connected pore space grain radii have to be shrunk while keeping the grain center locations unchanged fig 3 b the resulting minimum lattice pixel number of pore radius should obey the guidelines of the minimum pore throat radius required by the scmc lbm model for lattice resolution independent simulation results pan et al 2004 sukop and thorne 2006 using the coupled image processing algorithms rabbani et al 2014 the throats and pores inside the rev can be separately detected and the radii of realistic pores and grains are assumed to be equal to the radii of circular pores and grains with the same volume they occupy then specific grain surface area average pore radius and porosity can be readily obtained the distribution of pore sizes is fairly uniform fig 5 in the sense that the pore uniformity coefficient r 60 r 10 1 5 is less than 2 r 60 and r 10 are the radii which 60 or 10 of the total pores are smaller than and thus it can be considered as a less heterogeneous porous medium the intrinsic permeability and tortuosity of packed grains are determined from the single phase flow simulation the values of all fluid and geometrical properties are summarized in table 1 to study the sensitivity of macroscopic state variables to changes of fluid properties under the fixed flow condition the fluid property of interest in the benchmark case is varied with the geometrical property invariant and vice versa four groups of test cases are designed where the effects of wettability adhesive strength pore size distribution and specific surface area are examined separately the benchmark case is referred to differently as θ 0 g s 0 5 0 5 psd1 and grain 300 in the corresponding group in group 1 with the constant interfacial tension the repulsive adhesive strengths are specified by g r g s 1 0 0 25 and 1 0 0 to produce the weak wettability and the neutral wettability fig 4 a in group 2 the interfacial tension and the wettability are kept the same the adhesive strengths g s 1 5 5 5 generate a thin wp fluid film but the interactions become repulsive while g s 2 5 1 5 results in a significant layer of wp fluid film fig 4 b the following groups will adjust the number size and position of grain array to achieve the desired characteristic in group 3 the porous media have equal grain number and porosity but different pore size distributions fig 5 a there are a larger fraction of macropores and fine pores for more heterogeneous psd2 and psd3 media than the benchmark medium the average pore radii and the specific surface areas are almost same in group 4 the porous media with the same porosity feature different specific surface areas fig 5 b grain178 and grain452 media are filled with 178 and 452 unequal grains respectively the average pore radius for grain178 grain452 media is larger smaller than that for the benchmark medium the values of varied fluid and geometrical properties in each test case are listed in table 1 2 3 data post processing the scmc lbm model exports a series of density field and velocity field with time thus a post processing procedure li et al 2017b is applied to transform the available outputs into the desired variables i e fluid saturation interfacial areas capillary pressure relative permeability and capillary number 2 3 1 fluid saturation to calculate the fluid saturation in addition to the solid phase sp media the wp and np fluids need to be identified based on which kind of fluid particle dominates the lattice node the simulated fluid fluid interfacial area incurs spurious velocity sukop and thorne 2006 and thus has to be noted as the interphase ip fluid for special treatments in the calculation of fluid flux in section 2 3 3 each fluid phase can be identified individually based on density ρn of the np fluid component at each lattice node and the empirical threshold densities table 2 for example the lattice nodes with density of 0 ρn 0 2 in the domain are considered as the wp fluid the number of which is counted as n w and the position of which is labelled as 10 likewise the np fluid the sp media and the ip fluid can be identified with the number and position of corresponding lattice nodes the ip fluid with a few lattices thickness occupies very slight fluid saturation but it is still taken into account here and thus assigned to the wp and np fluid saturations equally thus the saturation in terms of the wp fluid is expressed as the following 19 s w n w 0 5 n i m n n s 2 3 2 interfacial areas and capillary pressure the fluid fluid and fluid solid interfacial areas are used in this study to describe the fluid distribution the boundary of wp fluid region is identified as the contour line with density of ρn 0 2 using the contour function in matlab software then a number of wp fluid boundary segments with length l wi can be extracted the sum l wi of disconnected boundaries can be used to represent the total surface area of wp fluid in the domain likewise the boundaries of np fluid and sp media can be identified as the contour line with density ρn 1 2 and ρn 0 individually and the total surface area of np fluid and sp media l ni and l si can then be obtained subsequently the fluid fluid and fluid solid interfacial areas defined in eq 3 can be computed as follows chen et al 2007 porter et al 2010 20 a nw l ni l wi l si 2 m n a ws l wi l ni l si 2 m n a ns l ni l wi l si 2 m n the lattice nodes at the first layer of solid surface always have spurious density thus they are filtered out from wp and np fluids when calculating the pressure of each fluid phase the wp and np fluid pressures are calculated by averaging fluid pressure p wi and p ni obtained from eq 11 over the domain and the capillary pressure defined in eq 2 is then computed by 21 p c 1 n n 1 3 ρ wi ρ ni g r ρ wi ρ ni 1 n w 1 3 ρ wi ρ ni g r ρ wi ρ ni 2 3 3 relative permeability and capillary number the spurious velocity occurs to the lattice nodes in the ip fluid as identified in section 2 3 1 as well as at the first layer of solid surface these nodes are thus excluded when calculating the flux since the gravity is imposed vertically as setup in section 2 2 1 the fluid flux only in the y axis are computed the fluxes of wp and np fluids are the average flow velocities u ywi and u yni as given by eq 5 over the volume of the whole domain as follows 22 q w 1 m n u ywi q n 1 m n u yni then the relative permeabilities of wp and np fluids defined in eq 1 can be expressed based on the extended two phase darcy equation bear and cheng 2010 as below 23 k rw q w ν w g w k sat k rn q n ν n g n k sat to describe the regime of steady state two phase flow the capillary number ca is computed based on the wp fluid flux as follows 24 c a 1 ϕ s w cos θ q w μ w γ the quantities calculated from eq 19 24 fluctuate significantly with time because of the dynamic nature of the flow bear and cheng 2010 benzi et al 2006 berga et al 2013 chen et al 2007 2017 constantinides and payatakes 1996 thus a time averaging procedure li et al 2017b is applied to avoid uncertainties in the simulation results in this study 2 0 105 time steps are sufficient to reach the statistical equilibrium at which the mean values of these quantities maintain quite stable 3 results and discussions 3 1 benchmark case at s w 0 102 and 0 862 the major fluids are connected pathways but the minor fluids are isolated in the form of bridges or ganglion fig 6 a meanwhile at s w 0 478 both of the wp and np fluid packets are continuous in combination with several wp pendular rings and np bubbles fig 6 a under the applied magnitude of pressure gradient p 24 kpa m the advancing fluid interface at s w 0 478 occupies the whole pore throats extends toward the pores perpendicular to the flow direction and even backward relative to the flow direction and also elongates in the flow direction these interfacial features indicate that capillary force dominates the two phase fluid flow with ca 0 00597 where viscous coupling process is not significant the flow diagram of huang et al 2014 also shows that with the given capillary number and the unit viscosity ratio the flow pattern is close to the regime of capillary fingering each fluid occupies more solid surface as its saturation increases but the fluid interface regulated by saturation of the minor fluid peaks at the intermediate saturation fig 6 b moreover the wp fluid is more likely to contact the solid surface than the np fluid for the specified strong wettability table 1 and thus a ws s w and a ns s w curves intersect at s w 0 5 near which a nw s w curve attains the maximum fig 6 b the wp pendular rings at s w 0 102 and 0 478 tend to fill the narrow pore throats with the fluid interface that has larger curvature the np bubbles at s w 0 862 and 0 478 prefer to stay in the large pore spaces with less curvy fluid interface and the fluid interface of connected packets at s w 0 478 elongating in the flow direction contributes slightly to capillary pressure therefore the capillary pressure decreases with the increase in saturation fig 6 b furthermore the p c s w curve is quite flat without a droopy tail near s w 1 0 fig 6 b which typically occurs in drainage this is because the fluid saturation is independent of the applied magnitude of pressure gradient in the steady state infiltration li et al 2017b while in drainage the np fluid has to overcome the threshold pressure to enter the porous medium to reduce the wp fluid saturation li et al 2017b also the p c s w curve is observed to be unique in the steady state infiltration in the sense of no dependence on the saturation history markedly different from the p c s w curve behaviors in drainage and imbibition li et al 2017b the data of fluid flux versus pressure gradient are evaluated using the linear regression approach as performed in previous studies swartzendruber 1962 miller and low 1963 prada and civan 1999 within the given range of magnitude of pressure gradient at s w 0 102 0 478 and 0 862 the flux of wp and np fluids vary linearly with the pressure gradient fig 6 c indicating laminar two phase fluids flow but the fitted lines have positive pressure gradient intercepts fig 6 c below which the fluids cannot flow as a result k rσ s w relation shows a significant dependency on capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 although it is unclear why there is a linear region for the data of fluid flux versus pressure gradient at the presence of film fluid and capillary pressure hao et al 2008 dou et al 2014 which are both intrinsic to the two phase flow system the linear relation has been widely observed li et al 2017b and implicitly assumed in the extended two phase darcy equation bear and cheng 2010 in this study the slope and intercept of the fitted line of fluid flux versus pressure gradient are termed as apparent effective permeability k σ and threshold pressure gradient p cσ respectively if the effect of threshold pressure gradient is excluded the computed effective permeabilities under the different magnitudes of pressure gradient collapse to apparent effective permeability li et al 2017b by an analogy to the kozeny carman equation bear and cheng 2010 the apparent effective permeability is expected to be determined by saturation tortuosity of flow path and fluid solid interfacial area the threshold pressure gradient is supposed to be caused by the film fluid induced by adhesive fluid solid interaction and the capillary pressure including its constituents hao et al 2008 dou et al 2014 on the other hand when fluid and geometrical properties are varied simultaneous k σ decrease and p cσ increase result in the decrease in the effective permeability while in the case of k σ decrease but p cσ decrease how the effective permeability is affected depends on whether k σ including its constituents or p cσ including its constituents dominates the two phase flow process therefore apparent effective permeability and threshold pressure gradient are able to link the fluid distribution as well as the capillary pressure as determined by fluid and geometrical properties with the relative permeability in a meaningful way saturation is the dominated factor for k σ and also controls the magnitude of p cσ k σ increases sharply but p cσ decreases rapidly with the increase in saturation of the corresponding fluid fig 6 c and table 3 with the magnitude of pressure gradient invariant the permeability of unsaturated porous media for a particular fluid is dominated by its amount in small amount the fluid can get easily entrapped in the narrow pore throats by adhesive and capillary forces but at the presence of more fluid in porous media the redundant fraction of fluid occupying large pore space becomes easily mobile contributing to the total flux it is interesting to note that both fluids have positive threshold pressure gradients fig 6 c and table 3 this indicates that the flows of not only the np fluid but also the wp fluid are subjected to capillary resistance which is different from the spontaneous imbibition case where the capillary force facilitates the wp fluid flow this is due to the special flow pattern of the steady state infiltration that features the competition between local drainage and local imbibition and can be validated by the fact that the receding fluid interface is more curvy than the advancing fluid interface at s w 0 102 when the fluids flow towards the bottom outlet boundary fig 6 a also the wp pendular rings at s w 0 102 have to be stagnant in the narrow pore throats while the np bubbles at s w 0 862 keep flowing through the porous media fig 6 a it can be demonstrated by the magnitude of p cw at s w 0 102 table 3 which is close to the applied pressure gradient in addition to larger capillary pressure s w 0 102 the adhesive interaction may resist the wp fluid flow in the narrow pore throats as the saturation of each fluid increases simultaneous k σ increase and p cσ decrease lead to the nonlinear increase in the relative permeabilities fig 6 d in addition k rw s w and k rn s w relations intersect at s w 0 5 fig 6 d showing that the wp relative permeability is smaller than the np relative permeability at the same saturation of corresponding fluid both k rw s w and k rn s w relations are concave fig 6 d compared with the diagonal straight lines as expected for the zero interfacial tension showing the loss of total permeability of the porous media when transmitting the two immiscible fluids the irreducible saturation of the wp fluid as large as s w 0 228 is observed but there is no residual saturation of the np fluid fig 6 d these features are attributed to the fact that both fluids in the two phase flow system are resisted by the same capillary force at any saturation while the wp np fluid is subjected to the strong weak adhesive interaction with the solid surface as revealed by k w k n at s w 0 478 fig 6 c and table 3 the value of k rw k rn attains the minimum at s w 0 350 and 0 478 where the largest fluid fluid interfacial area occurs producing the largest capillary resistance 3 2 effect of wettability with the constant interfacial tension at s w 0 478 figs 3 a and 4 a and table 1 the fluid interface is rather curvy for the strong wettability fig 6 a there exists a significant fraction of the wp fluid in the form of film fluid attaching to the back solid surface relative to the flow direction and the wp fluid clusters are very discrete in terms of the fluid distribution however for the weak and neutral wettability the fluid interface becomes quite flat fig 7 a the wp fluid film starts to disappear and becomes connected thus as the wettability weakens the fluid interface has less fluid fluid interfacial area the wp fluid releases more solid surface for the np fluid to occupy fig 7 b for the neutral wettability both a ws s w and a ns s w curves become straight lines and intercross at s w 0 5 fig 7 b indicating that both fluids attach to the same area of solid surface at the equivalent saturation of each fluid meanwhile the capillary pressure drops across the whole range of saturation fig 7 b as indicated by the laplace equation bear and cheng 2010 relating the capillary pressure to the wettability for the wp np fluid the decrease increase in fluid solid interfacial area results in significant k w increase k n decrease on the other hand both the fluid fluid interfacial area reduction and the capillary pressure decrease lead to a marked drop in p cσ of both fluids fig 7 c and table 3 consistent with the conjecture hao et al 2008 dou et al 2014 that the threshold pressure gradient partly results from the capillary force it is interesting to note that for the neutral wettability the values of k σ and p cσ of the two immiscible fluids are very close to each other table 3 in the sense that the fitted flux versus pressure gradient lines almost overlap each other fig 7 c but the values of p cσ of the two immiscible fluids are not equal to zero table 3 as validated by the slight curvature of the fluid interface fig 7 a contributing to the capillary resistance thus the contact angle is hysteretic with respect to whether the fluid interface is at the static equilibrium receding or advancing bear and cheng 2010 moreover for all the given wettability the difference between p cw and p cn is very slight table 3 showing the weak adhesive fluid solid interactions because of the uniform distribution of pore size both k w increase and p cw decrease trigger a rise in the wp fluid relative permeability but k n decrease dominating p cn decrease causes a reduction in the np fluid relative permeability fig 7 d which is consistent with the results of previous studies li et al 2005 hao and cheng 2010 however there is no much difference in k rn s w relation for the weak and neutral wettability at s w 0 350 and s w 0 729 fig 7 d as a result of the two opposing mechanisms for the neutral wettability k rw s w and k rn s w relations intercross at s w 0 5 and are both still concave fig 7 d showing that the relative permeabilities of both fluids are very close to each other at the equivalent saturation of each fluid and the slightly curvy fluid interface still contributes to the capillary resistance 3 3 effect of adhesive strength when the interfacial tension and the wettability remain the same at s w 0 478 figs 3 a and 4 b and table 1 more wp fluid film is generated to coat the arbitrary side of the solid surface under stronger adhesive strength fig 8 a as a result the wp fluid is distributed very discretely and more fluid interface is produced fig 8 b the wp fluid takes up more solid surface and the np fluid has to be detached from more solid surface fig 8 b for the adhesive strength g s 2 5 1 5 the wp fluid takes up almost 90 of the solid surface at s w 0 478 and the crossover of a ws s w and a ns s w curves appears at s w 0 2 in contrast for the interaction strength g s 1 5 5 5 which are both repulsive the wp fluid occupies about 55 of the solid surface and a ws s w and a ns s w curves intercross at s w 0 45 fig 8 b also stronger adhesive strength induces greater capillary pressure across the whole range of saturation fig 8 b in addition to capillary force the adhesive fluid solid interaction itself provides another source of capillary pressure bear and cheng 2010 because of which the film fluid is formed with the wp fluid mobility reduced longmuir 2004 the viscosity of the wp fluid near the solid surface and the bulk fluid would be affected benzi et al 2006 both the strong adhesive strength on the wp fluid solid interfacial area and the increased wp fluid solid interfacial area give rise to k w decrease while the strong adhesive strength on the np fluid solid interfacial area exceeding the decreased np fluid solid interfacial area brings about k n decrease fig 8 c and table 3 for the adhesive strength g s 2 5 1 5 k w decrease is particularly significant fig 8 c and table 3 as a result of the large increase in the solid surface covered by the wp fluid film and in the viscosity of the fluid near the solid surface it can be seen that k w k n at the equivalent saturation of each fluid due to larger wp fluid solid interfacial area and strengthened adhesive wp fluid solid interaction greater capillary pressure and larger fluid interface almost do not affect p cw for g s 1 5 5 5 and 0 5 0 5 or p cn for all the given adhesive strengths fig 8 c and table 3 indicating that the slight amount of wp fluid film does not dominate the wp fluid mobility compared with capillary force for g s 1 5 5 5 and 0 5 0 5 the capillary pressure induced by adhesive fluid solid interaction and the fluid fluid interfacial area resulting from the wp fluid film do not influence the mobility of np fluid significantly for the adhesive strength g s 2 5 1 5 a marked p cw increase occurs fig 8 c and table 3 due to the large portion of wp fluid film with reduced mobility consistent with the conjecture hao et al 2008 dou et al 2014 that the threshold pressure gradient partly results from the film fluid stronger adhesive wp fluid solid interaction also leads to p cw p cn the slight k w decrease and the almost invariant p cw do not trigger a notable decrease in the wp relative permeability for g s 1 5 5 5 and 0 5 0 5 at s w 0 729 but the decrease in the wp relative permeability is significant for g s 2 5 1 5 at any saturation fig 8 d as a result of significant k w decrease and p cw increase in addition the irreducible wp fluid saturation in the form of film fluid is raised from 0 228 for g s 0 5 0 5 to 0 420 for g s 2 5 1 5 on the other hand k n decrease and almost invariant p cn cause the decrease in the np relative permeability for all the given adhesive strengths fig 8 d the most loss in the total permeability of porous media at s w 0 478 occurs for g s 2 5 1 5 table 3 3 4 effect of pore size distribution the specified porous media with equal porosities but different pore size distributions possess different intrinsic permeabilities because of different tortuosities of the flow path figs 3 b and 5 a and table 1 for the heterogeneous psd3 medium with quite non uniform pore sizes the flow path is most tortuous table 1 and there are large fractions of macropores and fine pores fig 5 a at s w 0 478 more wp fluid fills the narrow pore throats and more np fluid occupies the large pore space making both fluids more connected fig 9 a in the middle region of the psd3 medium the np fluid forms a connected pathway region a and another two large fluid clusters regions b and c which take up the major fraction of np fluid meanwhile some macro pores region d are impossible for the np fluid to enter because they are segregated by the fine pores relative to the flow direction thus a few small clusters as a minor part of the np fluid are distributed discretely due to the initial distribution all the wp fluid is divided into only two large fluid packets by the np connected pathway the improved fluid connectivity causes less fluid fluid interfacial area more solid surface contacted with the wp fluid and less solid surface in touch with the np fluid fig 9 b the larger fraction of fine pores enhances the adhesive wp fluid solid interaction hao et al 2008 dou et al 2014 and thus capillary pressure is larger at each saturation fig 9 b due to the heterogeneity of the psd3 medium it is easier for the wp fluid clusters to get trapped at some saturations the immobile bubbles with curvy interfacial area contribute to larger capillary pressure and thus p c s w curve for the psd3 medium experiences greater fluctuations fig 9 b compared with the one for the psd1 medium both the high tortuosity and the increased wp fluid solid interfacial area lead to k w decrease but the high tortuosity overwhelming the decreased np fluid solid interfacial area is manifested in k n decrease fig 9 c and table 3 the enhanced adhesive wp fluid solid interaction causes p cw to increase and the more connected np fluid distribution renders p cn to decrease fig 9 c and table 3 these results show again that the adhesive interaction induced capillary pressure does not affect the mobility of np fluid also for psd2 and psd3 media p cw p cn is table 3 due to the adhesive wp fluid solid interaction raised by the fine pores it is interesting to note that k n decrease and p cn decrease result in a crossover of the fitted flux versus pressure gradient lines for the given porous media at p 32 kpa m fig 9 c below which p cn capillary force dominates the np fluid flow and above which the np fluid flow is dominated by k n viscous force both k w decrease and p cw increase suggest a reduction in the wp relative permeability fig 9 d while k n decrease and p cn decrease make the situation complicated under the applied pressure gradient p 24 kpa m where the np fluid flows in the capillary force dominated regime the np effective permeability slightly increases as the heterogeneity of porous media strengthens fig 9 c it should be also mentioned that the given porous media possess different intrinsic permeabilities and thus the slight increase in the np effective permeability is enlarged by the decreased intrinsic permeability in terms of the np relative permeability fig 9 d and table 1 the responses of the relative permeabilities of both fluids agree with the observations made in previous studies dou and zhou 2013 3 5 effect of specific surface area the given porous media with equivalent porosity feature different specific surface areas figs 3 b and 5 b for the grain452 medium with larger specific surface area the average pore radius and the intrinsic permeability are both smaller figs 3 b and 5 b and table 1 the wp fluid preferring to stay in the fine pores becomes more continuous resulting in less fluid fluid interfacial area fig 10 a and b however for the grain178 medium the np fluid tending to stay in the macro pores may dominate the fluid connectivity thus there is no much difference in the fluid fluid interfacial area between the grain178 and grain300 media figs 6 a and 10 a b as the specific surface area increases more solid surface becomes available for both fluids and therefore the wp fluid and np fluid solid interfacial areas increase at the same saturation of each fluid fig 10 b the capillary pressure is larger at any saturation fig 10 b as indicated by the laplace equation bear and cheng 2010 relating the capillary pressure to the pore radius for both fluids the increase in fluid solid interfacial area signifies k σ decrease and the capillary pressure increase dominating the fluid fluid interfacial area decrease suggests a rise in p cσ fig 10 c and table 3 for the grain452 medium there is a slight trend of p cw p cn table 3 due to the enhanced adhesive wp fluid solid interaction because of the smallest pore radius both k σ decrease and p cσ increase indicate a reduction in the effective permeabilities of both fluids it should be noted that as the specific surface area rise the intrinsic permeability of porous media drops as well table 1 however the relative permeabilities of both fluids still decrease significantly fig 10 d showing the nonlinear response of the effective permeability to the specific surface area which is different from the effect on the wp relative permeability observed in previous studies ghassemi and pak 2011 gao et al 2015 this difference may reflect different conditions where the increased connectivity as demonstrated by the decreased fluid fluid interfacial area or the increased capillary pressure as a result of the narrowed pore radius dominates the capillary resistance and depends on the fraction of the effective fluid interface that contributes to the capillary resistance relative to the flow direction the maximum loss in the total permeability at s w 0 478 takes place for the grain452 medium table 3 because of the enhanced adhesive wp fluid solid interaction and the increased capillary resistance 4 conclusions this study has been performed to explore the roles of the film fluid as a result of the adhesive fluid solid interaction and the capillary pressure hao et al 2008 dou et al 2014 in the non uniqueness of k rσ s w relation it is found that the apparent effective permeability and the threshold pressure gradient can be used to link the fluid distribution as well as the capillary pressure as determined by fluid and geometrical properties with the relative permeability meaningfully the sensitivity of fluid distribution and constitutive relationships to wettability adhesive strength pore size distribution and specific surface area is tested using the state of the art scmc lbm model on two dimensional simultaneous flow cell key findings are summarized as the following 1 each fluid occupies more solid surface as the saturation and the available solid surface increase and the wp fluid tends to take up more solid surface than the np fluid at the same saturation of each fluid once the thin wp fluid film is formed it can coat the solid surface with a slight saturation which repels the np fluid in the heterogeneous porous media the wp np fluid filling the fine pores macropores seizes more less solid surface 2 the fluid interface regulated by the saturation of the minor fluid peaks at the intermediate saturation in the form of film fluid the wp fluid is very discretely distributed resulting in the significantly increased fluid fluid interfacial area in the heterogeneous porous media the wp np fluid tending to fill the narrow large pore space makes both fluids more connected on the other hand for the small large average pore radius the wp np fluid becomes more continuous in the less heterogeneous porous media the fluid fluid interfacial area is a good parameter for describing the fluid connectivity 3 the capillary pressure decreases with the increase in saturation and p c s w curve is relatively flat without a droopy tail at s w 1 0 in the steady state infiltration the effect of wettability and average pore radius on the capillary pressure follows the indications by the laplace equation bear and cheng 2010 in addition to the capillary force the adhesive fluid solid interaction provides another source of capillary pressure which can be enhanced by the large adhesive strength and the fine pores in the heterogeneous porous media 4 the apparent effective permeability of each fluid increases with the increase in its saturation but decreases with the increase in tortuosity of flow path and fluid solid interfacial area which is consistent with the kozeny carman equation bear and cheng 2010 also it maintains a negative correlation with the adhesive strength on the fluid solid interfacial area at the equivalent saturation k w is smaller than k n 5 the threshold pressure gradient is dominated by the saturation of each fluid small amount of one fluid gets easily entrapped in the narrow pore space p cw originates from the film fluid with the reduced mobility and the capillary resistance as well in the steady state infiltration on the other hand p cn is due to the capillary resistance but the adhesive interaction induced capillary pressure does not affect the mobility of np fluid at the same saturation p cw can exceed p cn when the film fluid effect is significant for the strong adhesive strength or for the heterogeneous porous media with fine pores 6 simultaneous k σ decrease and p cσ increase result in the decrease in the effective permeability while in the case of k σ decrease but p cσ decrease how the effective permeability varies depends on whether k σ or p cσ dominates the two phase flow process under the applied pressure gradient k σ p cσ is expected to play a dominant role under the large small applied pressure gradient the effect on the effective permeability may be enlarged by decreased intrinsic permeability in terms of the relative permeability the effective permeability is nonlinearly correlated with saturation and specific solid surface the two phase flow system in the steady state infiltration is a coupled thermo hydrodynamic process as revealed by the effect of film fluid and capillary pressure on the relative permeabilities of both fluids the strong wettability of wp fluid and the increased adhesive wp fluid solid strength reflect the introduction of more surface energy into the flow system and thus both the capillary pressure and the fluid fluid interfacial area rise at all saturations meanwhile when the geometrical property is varied the capillary pressure responds reversely relative to the fluid fluid interfacial area at each saturation implying the conservation of surface energy in the flow system the findings from this study elucidating the roles of film fluid and capillary pressure in the two phase flow system have implications for improving the macroscopic flow equation through balance of force for the steady state infiltration acknowledgments the primary data of grain sizes and packing are downloaded from the packomania webpage http www packomania com all the simulations were executed using the mechsys open source library http mechsys nongnu org and the goliath high performance computing cluster of the university of queensland the first author would like to acknowledge the support of international postgraduate research scholarship iprs and university of queensland centennial scholarship uqcent the authors also thank the three anonymous reviewers for their thorough reviews and constructive comments supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 009 appendix supplementary materials image application 1 
817,simulations of simultaneous steady state two phase flow in the capillary force dominated regime were conducted using the state of the art shan chen multi component lattice boltzmann model scmc lbm based on two dimensional porous media we focused on analyzing the fluid distribution i e wp fluid solid np fluid solid and fluid fluid interfacial areas as well as the capillary pressure versus saturation curve which was affected by fluid and geometrical properties i e wettability adhesive strength pore size distribution and specific surface area how these properties influenced the relative permeability versus saturation relation through apparent effective permeability and threshold pressure gradient was also explored the scmc lbm simulations showed that a thin wp fluid film formed around the solid surface due to the adhesive fluid solid interaction resulting in discrete wp fluid distributions and reduction of the wp fluid mobility also the adhesive interaction provided another source of capillary pressure in addition to capillary force which however did not affect the mobility of the np fluid the film fluid effect could be enhanced by large adhesive strength and fine pores in heterogeneous porous media in the steady state infiltration not only the np fluid but also the wp fluid were subjected to the capillary resistance the capillary pressure effect could be alleviated by decreased wettability large average pore radius and improved fluid connectivity in heterogeneous porous media the present work based on the scmc lbm investigations elucidated the role of film fluid as well as capillary pressure in the two phase flow system the findings have implications for ways to improve the macroscopic flow equation based on balance of force for the steady state infiltration keywords steady state fluid distribution capillary pressure relative permeability lattice boltzmann model 1 introduction the steady state infiltration through porous media i e the simultaneous flow of two immiscible fluids at the dynamic equilibrium is commonly encountered in natural and industrial processes such as non aqueous phase liquid napl migration oostrom and lenhard 1998 fagerlund et al 2006 and enhanced oil recovery liu and zhang 2015 yu et al 2015 the flow pattern features the competition between local drainage and local imbibition associated with breakdown and coalesce of fragmented fluid clusters and the spatiotemporally invariant fluid saturation fluid flux capillary pressure and interfacial area at the statistical equilibrium avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 modelling of such two phase flow process at the macroscale relies on the typical constitutive relationships including relative permeability k rσ and capillary pressure p c as function of fluid saturation s w as defined below li et al 2017b bear and cheng 2010 1 k r σ s w k σ k sat 2 p c s w p n p w where σ w n denotes wetting phase wp or non wetting phase np fluid and k σ k sat and p σ are effective permeability in the extended two phase darcy equation intrinsic permeability and fluid pressure respectively these two equations provide an averaged representation of fluid and geometrical properties inside a representative elementary volume rev of the given solid wp fluid np fluid system however they are not truly constitutive in the sense that k rσ s w relation and p c s w curve are both strongly hysteretic with respect to the flow conditions i e steady state infiltration or transient displacement li et al 2017b dana and skoczylas 2002 tsakiroglou et al 2007 ramstad et al 2012 and the capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 in practice it is questionable either to apply the k rσ s w relation measured in the steady state infiltration to predict the transient displacement behavior or to utilize the p c s w curve acquired from the displacement experiment for the steady state flow analysis li et al 2017b film fluid around the solid surface and capillary pressure have been identified as important factors in controlling the k rσ s w relation in the capillary force dominated regime hao et al 2008 dou et al 2014 as the focus of this study both factors are intrinsic to the two phase flow system in the coupled thermo hydrodynamic steady state infiltration longmuir 2004 suggested that the adhesive interaction between fluid molecules in the pore and solid particles at the surface is capable of generating a wp fluid film around the solid surface which reduces the wp fluid mobility the degree of easiness for the fluid movement and makes the fluid behave in a non newtonian way at the macroscale benzi et al 2006 observed that the repulsive fluid solid interaction compelled the fluid particles to be away from the solid surface and the fluid density and viscosity drop rapidly near the solid wall causing the apparent slippage behavior to account for the macroscale effects of capillary force on the two phase fluid flow hassanizadeh and gray 1993a b proposed an advanced two phase flow theory by introducing the fluid fluid interfacial area as a new independent state variable the proposed darcy equation included gradients of fluid saturation and fluid fluid interfacial area as the driving forces the interfacial areas can be determined through the image analysis technique and calculated as follows chen et al 2007 porter et al 2010 3 a nw s w a n a w a s 2 a ws s w a w a nw a ns s w a n a nw where a s a w and a n denote the specific surface areas of solid grains wp fluid and np fluid respectively and a nw a ws and a ns represent the fluid fluid wp fluid solid and np fluid solid interfacial areas respectively the two phase flow process during the steady state infiltration can be supposed to be the result of an interplay between gravity and adhesive capillary and viscous forces at the pore scale as shown in fig 1 the individual wp and np fluid packets in the two phase flow system may form connected pathways or isolated in the form of bridges or ganglion as given by the extended two phase darcy equation bear and cheng 2010 the stationary solid exerts viscous force on the two flowing fluids tangentially on the fluid solid interfacial area adhesive or repulsive force is imposed by the solid surface to the adjacent fluids normally longmuir 2004 benzi et al 2006 on the fluid fluid interfacial area both normal capillary resistance to the flow of two neighboring fluid packets hassanizadeh and gray 1993a b and tangential viscous coupling between the two flowing fluids occur in the capillary force dominated regime viscous coupling process is not significant and hence adhesive capillary and viscous forces dissipate almost all the input energy through the interfacial areas at the dynamic equilibrium where the macroscopic state variables reach the steady state bear and cheng 2010 benzi et al 2006 berga et al 2013 chen et al 2007 2017 constantinides and payatakes 1996 a new macroscopic flow equation based on balance of force with consideration of the interfacial areas and the local parametrized pore scale forces can be potentially established nevertheless so far attention has rarely been paid to how fluid and geometrical properties determine the interfacial areas the film fluid and the capillary pressure at the steady state on the other hand a large volume of literature concerned with the steady state relative permeability subject to these properties have been published in the past few decades as the wettability increased the wp relative permeability at each saturation decreased li et al 2005 hao and cheng 2010 landry et al 2014 due to the wp fluid in contact with more solid surface while the np relative permeability increased for the sphere pack porous medium li et al 2005 and carbon paper gas diffusion layer hao and cheng 2010 but decreased for the bead pack system landry et al 2014 the different behaviors of the np relative permeability under the varying wettability could be attributed to two opposing mechanisms with increased wettability less np fluid solid interfacial area with less viscous resistance dominated the packing spheres li et al 2005 and gas diffusion layer hao and cheng 2010 whereas more disconnected np fluid with larger capillary resistance was dominant in the packing beads landry et al 2014 furthermore the rock wettability can be altered by the distribution of brine and oil as a result the effect of mixed wettability on the relative permeabilities of two immiscible fluids becomes more complex landry et al 2014 when evaluating the data of fluid flux versus pressure gradient for saturated clays swartzendruber 1962 was surprised to find a few positive pressure gradient intercepts of the fitted lines for the soils with more clay content subsequently miller and low 1963 and prada and civan 1999 observed the threshold pressure gradient in clay and sandstone respectively below which the fluid could not flow the nonlinear flow phenomenon was supposed to be due to reduced film fluid mobility and macroscale non newtonian fluid flow behavior caused by the adhesive fluid solid interaction longmuir 2004 further hao et al 2008 and dou et al 2014 suggested that the threshold pressure gradient phenomenon in the two phase flow process resulted from two aspects film fluid effect and capillary resistance offering a complete interpretation for the dependence of the k rσ s w relation on capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 studies have been carried out on various pore size distributions generated in homogeneous and heterogeneous porous media dou and zhou 2013 it was demonstrated that the np fluid in heterogeneous porous media could more readily become continuous experiencing less capillary trapping and thus the np relative permeability in heterogeneous porous media was significantly higher than that in homogeneous porous media dou and zhou 2013 in contrast the wp fluid in heterogeneous porous media was more discretely distributed with more extensive contacts with solid surface and hence the wp relative permeability in heterogeneous porous media was slightly lower dou and zhou 2013 with increasing specific solid surface area ghassemi and pak 2011 gao et al 2015 the np relative permeability decreased significantly while the wp relative permeability remained almost invariant this was because the wp fluid became more connected to not only itself but also solid surface and the resulting effects cancelled each other to a large extent causing little change in the wp relative permeability also a higher pressure gradient was needed for the fully connected np fluid flow to reach the linear flow regime due to higher fraction of small pore sizes zhang et al 2016 the effects of fluid and geometrical properties on the fluid flow behavior were found to be strongly coupled hao et al 2008 dou et al 2014 for example a high fraction of fine pores in heterogeneous porous media facilitated the generation of film fluid and the small pore radius in homogeneous porous media favored the capillary resistance compared with the constitutive relationships the pore scale configuration of two immiscible fluids would provide fundamental understandings of the macroscopic transport behavior avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 in addition to x ray micro computed tomography chen et al 2007 porter et al 2010 and microscopic piv measurements kazemifar et al 2016 li et al 2017a simulations using the lattice boltzmann models reveal the pore scale information of high temporal resolution regarding interfacial areas and cluster sizes in these models the desired fluid and geometrical properties can be designed with powerful parallel computations and complex pore space geometry so far lattice boltzmann models have been widely applied in the two phase porous media flow simulation to address the problems of p c s w curve pan et al 2004 schaap et al 2007 p c s w a nw surface k rσ s w relation li et al 2005 hao and cheng 2010 landry et al 2014 dou and zhou 2013 ghassemi and pak 2011 gao et al 2015 zhang et al 2016 fluid distribution and fluid displacement pattern liu et al 2014 2015 tsuji et al 2016 xu et al 2017 zhang et al 2011 berga et al 2013 zhao et al 2016 chen et al 2017 the readers can refer to huang et al 2015 and liu et al 2016 for a review of various multiphase lattice boltzmann models among which the shan chen multi component lattice boltzmann model scmc lbm based on the interaction between particles shan and chen 1993 shan and doolen 1995 martys and chen 1996 is rather efficient and versatile in the present work the state of the art scmc lbm model is used to conduct the simultaneous steady state two phase flow simulation based on two dimensional porous media compared with previous studies li et al 2005 hao and cheng 2010 landry et al 2014 dou and zhou 2013 ghassemi and pak 2011 gao et al 2015 zhang et al 2016 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 this study focuses on exploring the role of film fluid and capillary pressure in the non uniqueness of k rσ s w relation which has not been well understood so far in the capillary force dominated regime the fluid distribution as well as the capillary pressure versus saturation curve subject to the influence of fluid and geometrical properties is characterized how these factors are linked with the relative permeability versus saturation relation through the apparent effective permeability and the threshold pressure gradient is also investigated simulations were carried out including effects of fluid wettability adhesive strength pore size distribution and specific surface area which are all important for fluid film formation and capillary pressure the fluid fluid wp fluid solid and np fluid solid interfacial areas serve as the fluid distribution descriptors the following section will briefly describe the principle of scmc lbm model setup of the fixed flow condition and the varying fluid and geometrical properties for the steady state two phase flow simulation as well as the procedure for post processing simulation data the scmc lbm simulation results will be discussed in section 3 and conclusions drawn in the last section 2 scmc lbm model 2 1 model principle over the last two decades the lattice boltzmann models on the basis of mesoscopic kinetic theory he and luo 1997 have been widely applied in simulating the two phase porous media flow among them the scmc lbm model based on the interaction between particles shan and chen 1993 shan and doolen 1995 martys and chen 1996 is chosen in this study because of its efficiency and versatility this model has also been well validated against measured p c s w curves pan et al 2004 schaap et al 2007 and k rσ s w relations ramstad et al 2012 ghassemi and pak 2011 in the following we briefly describe the basic model formulations the particle distribution function f i σ related to the ith discrete velocity direction at position x at time t is assigned at each lattice node for each of the two fluid components which evolves according to the lattice boltzmann equation with the bhatnagar gross krook bgk approximation as follows he and luo 1997 4 f i σ x e i δ t t δ t f i σ x t δ t τ σ f i σ x t f i σ eq x t where e i is the discrete velocity δt the time step τσ the relaxation time and f i σ eq the maxwell boltzmann equilibrium distribution function both of the two fluid components occupy each lattice node in the domain simultaneously and the minor component can be considered as being dissolved within the major component the left hand side is a streaming process passing the particle distribution to the neighboring nodes while the right hand side is a collision process partially relaxing the particle distribution to the equilibrium distribution this discrete velocity model is commonly referred to as d d q m model where d and m are the number of dimensionalities and discrete velocities the macroscopic fluid density ρσ can be thought of as a series of direction specific fluid densities and the macroscopic flow velocity u σ is referred to as an average of the microscopic velocities weighted by the directional densities he and luo 1997 5 ρ σ i 0 m 1 f i σ u σ 1 ρ σ i 0 m 1 f i σ e i the equilibrium distribution function can be calculated by he and luo 1997 6 f i σ eq ρ σ w i 1 e i u σ eq c s 2 e i u σ eq 2 2 c s 4 u σ eq u σ eq 2 c s 2 where wi are the weight coefficients cs the sound speed and u σ eq the equilibrium velocity if the external force f σ is considered the equilibrium velocity is expressed by he and luo 1997 7 u σ eq u τ σ f σ ρ σ where u is the common velocity of the two fluid components to obtain the equilibrium velocity the density ρ and velocity u of the whole fluid are defined by martys and chen 1996 8 ρ ρ σ ρ σ u σ σ i 0 m 1 f i σ e i τ σ σ σ ρ σ τ σ the external force includes the body force g σ ρσ g if specified as well as the interaction forces f r σ between fluid and fluid and f s σ between fluid and solid as follows martys and chen 1996 9 f σ g σ f r σ f s σ the repulsive interaction between σth and σ th fluid component leading to phase separation and interface maintenance is realized by the inter particle force given by shan and doolen 1995 10 f r σ x t g r ρ σ x t i 0 m 1 w i ρ σ x e i t t e i where g r is the repulsion parameter which is positive and controls the strength of repulsive interaction the repulsion strength determines the interfacial tension and the thickness of fluid fluid interfacial layer the phase separation for the uniformly mixing two fluid components can take place for g rρ 1 0 yielding the interfacial layer while the interfacial layer thickness reaches convergence for g rρ 1 6 but the fluid compressibility begins to take effect for g rρ 2 0 huang et al 2007 the proper range for stable simulations is therefore 1 6 g rρ 2 0 huang et al 2007 for the bgk d2q9 lattice boltzmann model the fluid pressure can be determined by pan et al 2004 11 p c s 2 ρ g r ρ σ ρ σ when the solid boundary is present each fluid component may interact with the solid boundary independently the adhesive interaction between σth fluid component and the solid particles can be achieved by the inter particle force as follows he and luo 1997 12 f s σ x t g s σ ρ σ x t i 0 m 1 w i s x e i δ t t e i where s x e i δt t is an indicator function that equals 0 1 for the σth fluid component solid particles and g s σ is the adhesion parameter which is positive negative for the np wp fluid huang et al 2007 sukop and thorne 2006 the difference in adhesion strengths for the wp and np fluids determines the contact angle θ two well known approximations to the contact angle are expressed by 13 cos θ g s n g s w g r ρ w ρ n 2 59 cos θ g s n g s w g r 60 for the bgk d2q9 lattice boltzmann model used in this study the nine discrete velocities a zero velocity and eight velocities pointing to the neighboring nodes and the weight coefficients are given as below he and luo 1997 14 e 0 e 1 e 2 e 3 e 4 e 5 e 6 e 7 e 8 c 0 1 0 1 0 1 1 1 1 0 0 1 0 1 1 1 1 1 15 w 0 w 1 w 2 w 3 w 4 w 5 w 6 w 7 w 8 4 9 1 9 1 9 1 9 1 9 1 36 1 36 1 36 1 36 to recover the macroscopic navier stokes equations from the bgk d2q9 lattice boltzmann equation the kinematic viscosity νσ related to the relaxation time and the sound speed related to the basic speed c should be formulated as he and luo 1997 16 ν σ c s 2 τ σ 1 2 δ t 17 c s 2 c 2 3 in order to circumvent the numerical difficulties he and luo 1997 τσ 1 is the safest value far away from 0 5 and also the mach number has to satisfy 18 m a u σ max c s 1 the basic speed is always taken as the ratio of lattice distance δx 1 lu to the time step δt 1 ts i e c δx δt 1 lu ts the simulation procedure during the time interval t n 1 t n follows a few successive steps first f i σ eq n 1 are calculated from ρσ n 1 and u σ n 1 using eq 6 and then f i σ n 1 are collided following the rule of the bgk approximation in eq 4 second f i σ n 1 are streamed to the neighbouring nodes over t n 1 t n with the boundary condition implemented where needed f i σ n on the solid boundaries are obtained using the bounce back boundary condition sukop and thorne 2006 such that f i σ n f i σ n 1 where ith represents the opposite direction to ith and f i σ n on the domain boundaries are treated as the periodic boundary condition sukop and thorne 2006 if the body force is specified as the driving force thirdly ρσ n and u σ n are computed using f i σ n based on eq 5 the simulation ends if the steady state criterion is reached and ρσ n and u σ n are then stored visualized and post processed the discretization effect is an important aspect of the numerical solution in the scmc lbm simulations of real flow systems pan et al 2004 examined the minimum lattice resolution required for the simulation based on the three dimensional packings of spheres with uniform size distributions and found that the simulated intrinsic permeability and primary drainage p c s w curve became essentially lattice resolution independent if the mean pore throat radius was larger than 3 lattice units the convergence of the numerical solution was also supported by good agreements with the experimental data pan et al 2004 sukop and thorne 2006 proposed a similar rule of thumb that 4 or 5 lattice units were the minimum width of an open flow channel for converged solutions in the simulation of realistic hydrodynamics 2 2 model setup in the fractional flow experiments avraam and payatakes 1995a b 1999 tallakstad et al 2009a b erpelding et al 2013 valavanides et al 1998 valavanides and payatakes 2001 yiotis et al 2013 armstrong et al 2016 the porous sample is mounted onto a flow cell with two series of syringe pumps that control the flux of individual fluids the pressure drops measured by pressure sensors at the inlet and outlet of the cell are used for checking if the statistical equilibrium is reached in similar manners the steady state two phase flow simulation is conducted using the scmc lbm model based on two dimensional porous media in this study the units of distance time and mass in the model are lu ts and mu respectively following the rule of conversion i e 1 lu 1 0 10 5m 1 ts 5 0 10 6s and 1 mu 5 0 10 13 kg input properties and output variables of the model can be expressed in physical units in order to link mesoscopic simulations with engineering practices in real world 2 2 1 initial and boundary conditions the present work focuses on the effect of varying fluid and geometrical properties on the macroscopic state variables thus all the simulations will be carried out under the fixed flow condition initially the wp fluid is positioned in the center of the upper and lower half regions with the remaining region occupied by the np fluid fig 2 as such the horizontal homogeneity of fluid distribution can be guaranteed when there is no external force to distribute the fluids horizontally the width of wp fluid regions can be changed to adjust the overall wp fluid saturation in the whole simulation domain the body force can be relatively easily implemented in the scmc lbm model thus the two phase flow is driven by gravity vertically with the periodic boundary conditions sukop and thorne 2006 fig 2 the outflowing fluids reenter the porous medium from the top inlet boundary periodically in this way capillary end effect can be accordingly avoided and the saturation keeps invariant during the flowing process to ensure the capillary force dominated regime both fluids are subjected to the same gravity g σ 6 0 10 5 as expressed in terms of the magnitude of pressure gradient p 24 kpa m for convenience in interpretation the flow simulations start with a zero velocity field 2 2 2 fluid and geometrical properties in the capillary force dominated regime buoyancy effect and viscous coupling process are not significant valavanides et al 1998 valavanides and payatakes 2001 thus the wp and np fluids with equivalent densities and viscosities are adequate for approximating the oil water or napl water system with densities and viscosities of the same order of magnitude in the scmc lbm model each fluid phase consists of two fluid components the density ratio of major component to minor one is set to be 999 fig 2 and the physical density of each fluid phase is ρ w ρ w 1 0 103 kg m3 with the relaxation time 0 95 for stable numerical solutions sukop and thorne 2006 the physical dynamic viscosity of each fluid phase is taken as μw μn 3 0 10 3 pa s a segment of the randomly packed system with unequal grains is chosen to represent the rev of a two dimensional porous medium the lattice pixel number m n 800 800 is sufficient for a visualization of interfacial areas and fluid clusters thus dimension of the segment is 8 0mm 8 0mm fig 3 b a benchmark case is established to illustrate the steady state fluid distribution interfacial areas capillary pressure and relative permeability as presented in section 3 1 the repulsive adhesive strength for fluid fluid fluid solid interaction in the model is taken to be g r g s 1 0 0 5 the fluid configuration in a tube at the capillary equilibrium fig 3 a shows that the wp fluid has a strong wettability and a thin film forms near the solid wall the resulted interfacial tension and contact angle are computed using the laplace equation relating the pressure difference to the bubble curvature bear and cheng 2010 and the fluid interface based formula huang et al 2007 respectively an array of 300 unequal grains is initially deployed in contact with each other in a way that the solid grains with a pre defined radius distribution occupy the maximum volume within the given domain in order to allow the two phase fluid flow through the connected pore space grain radii have to be shrunk while keeping the grain center locations unchanged fig 3 b the resulting minimum lattice pixel number of pore radius should obey the guidelines of the minimum pore throat radius required by the scmc lbm model for lattice resolution independent simulation results pan et al 2004 sukop and thorne 2006 using the coupled image processing algorithms rabbani et al 2014 the throats and pores inside the rev can be separately detected and the radii of realistic pores and grains are assumed to be equal to the radii of circular pores and grains with the same volume they occupy then specific grain surface area average pore radius and porosity can be readily obtained the distribution of pore sizes is fairly uniform fig 5 in the sense that the pore uniformity coefficient r 60 r 10 1 5 is less than 2 r 60 and r 10 are the radii which 60 or 10 of the total pores are smaller than and thus it can be considered as a less heterogeneous porous medium the intrinsic permeability and tortuosity of packed grains are determined from the single phase flow simulation the values of all fluid and geometrical properties are summarized in table 1 to study the sensitivity of macroscopic state variables to changes of fluid properties under the fixed flow condition the fluid property of interest in the benchmark case is varied with the geometrical property invariant and vice versa four groups of test cases are designed where the effects of wettability adhesive strength pore size distribution and specific surface area are examined separately the benchmark case is referred to differently as θ 0 g s 0 5 0 5 psd1 and grain 300 in the corresponding group in group 1 with the constant interfacial tension the repulsive adhesive strengths are specified by g r g s 1 0 0 25 and 1 0 0 to produce the weak wettability and the neutral wettability fig 4 a in group 2 the interfacial tension and the wettability are kept the same the adhesive strengths g s 1 5 5 5 generate a thin wp fluid film but the interactions become repulsive while g s 2 5 1 5 results in a significant layer of wp fluid film fig 4 b the following groups will adjust the number size and position of grain array to achieve the desired characteristic in group 3 the porous media have equal grain number and porosity but different pore size distributions fig 5 a there are a larger fraction of macropores and fine pores for more heterogeneous psd2 and psd3 media than the benchmark medium the average pore radii and the specific surface areas are almost same in group 4 the porous media with the same porosity feature different specific surface areas fig 5 b grain178 and grain452 media are filled with 178 and 452 unequal grains respectively the average pore radius for grain178 grain452 media is larger smaller than that for the benchmark medium the values of varied fluid and geometrical properties in each test case are listed in table 1 2 3 data post processing the scmc lbm model exports a series of density field and velocity field with time thus a post processing procedure li et al 2017b is applied to transform the available outputs into the desired variables i e fluid saturation interfacial areas capillary pressure relative permeability and capillary number 2 3 1 fluid saturation to calculate the fluid saturation in addition to the solid phase sp media the wp and np fluids need to be identified based on which kind of fluid particle dominates the lattice node the simulated fluid fluid interfacial area incurs spurious velocity sukop and thorne 2006 and thus has to be noted as the interphase ip fluid for special treatments in the calculation of fluid flux in section 2 3 3 each fluid phase can be identified individually based on density ρn of the np fluid component at each lattice node and the empirical threshold densities table 2 for example the lattice nodes with density of 0 ρn 0 2 in the domain are considered as the wp fluid the number of which is counted as n w and the position of which is labelled as 10 likewise the np fluid the sp media and the ip fluid can be identified with the number and position of corresponding lattice nodes the ip fluid with a few lattices thickness occupies very slight fluid saturation but it is still taken into account here and thus assigned to the wp and np fluid saturations equally thus the saturation in terms of the wp fluid is expressed as the following 19 s w n w 0 5 n i m n n s 2 3 2 interfacial areas and capillary pressure the fluid fluid and fluid solid interfacial areas are used in this study to describe the fluid distribution the boundary of wp fluid region is identified as the contour line with density of ρn 0 2 using the contour function in matlab software then a number of wp fluid boundary segments with length l wi can be extracted the sum l wi of disconnected boundaries can be used to represent the total surface area of wp fluid in the domain likewise the boundaries of np fluid and sp media can be identified as the contour line with density ρn 1 2 and ρn 0 individually and the total surface area of np fluid and sp media l ni and l si can then be obtained subsequently the fluid fluid and fluid solid interfacial areas defined in eq 3 can be computed as follows chen et al 2007 porter et al 2010 20 a nw l ni l wi l si 2 m n a ws l wi l ni l si 2 m n a ns l ni l wi l si 2 m n the lattice nodes at the first layer of solid surface always have spurious density thus they are filtered out from wp and np fluids when calculating the pressure of each fluid phase the wp and np fluid pressures are calculated by averaging fluid pressure p wi and p ni obtained from eq 11 over the domain and the capillary pressure defined in eq 2 is then computed by 21 p c 1 n n 1 3 ρ wi ρ ni g r ρ wi ρ ni 1 n w 1 3 ρ wi ρ ni g r ρ wi ρ ni 2 3 3 relative permeability and capillary number the spurious velocity occurs to the lattice nodes in the ip fluid as identified in section 2 3 1 as well as at the first layer of solid surface these nodes are thus excluded when calculating the flux since the gravity is imposed vertically as setup in section 2 2 1 the fluid flux only in the y axis are computed the fluxes of wp and np fluids are the average flow velocities u ywi and u yni as given by eq 5 over the volume of the whole domain as follows 22 q w 1 m n u ywi q n 1 m n u yni then the relative permeabilities of wp and np fluids defined in eq 1 can be expressed based on the extended two phase darcy equation bear and cheng 2010 as below 23 k rw q w ν w g w k sat k rn q n ν n g n k sat to describe the regime of steady state two phase flow the capillary number ca is computed based on the wp fluid flux as follows 24 c a 1 ϕ s w cos θ q w μ w γ the quantities calculated from eq 19 24 fluctuate significantly with time because of the dynamic nature of the flow bear and cheng 2010 benzi et al 2006 berga et al 2013 chen et al 2007 2017 constantinides and payatakes 1996 thus a time averaging procedure li et al 2017b is applied to avoid uncertainties in the simulation results in this study 2 0 105 time steps are sufficient to reach the statistical equilibrium at which the mean values of these quantities maintain quite stable 3 results and discussions 3 1 benchmark case at s w 0 102 and 0 862 the major fluids are connected pathways but the minor fluids are isolated in the form of bridges or ganglion fig 6 a meanwhile at s w 0 478 both of the wp and np fluid packets are continuous in combination with several wp pendular rings and np bubbles fig 6 a under the applied magnitude of pressure gradient p 24 kpa m the advancing fluid interface at s w 0 478 occupies the whole pore throats extends toward the pores perpendicular to the flow direction and even backward relative to the flow direction and also elongates in the flow direction these interfacial features indicate that capillary force dominates the two phase fluid flow with ca 0 00597 where viscous coupling process is not significant the flow diagram of huang et al 2014 also shows that with the given capillary number and the unit viscosity ratio the flow pattern is close to the regime of capillary fingering each fluid occupies more solid surface as its saturation increases but the fluid interface regulated by saturation of the minor fluid peaks at the intermediate saturation fig 6 b moreover the wp fluid is more likely to contact the solid surface than the np fluid for the specified strong wettability table 1 and thus a ws s w and a ns s w curves intersect at s w 0 5 near which a nw s w curve attains the maximum fig 6 b the wp pendular rings at s w 0 102 and 0 478 tend to fill the narrow pore throats with the fluid interface that has larger curvature the np bubbles at s w 0 862 and 0 478 prefer to stay in the large pore spaces with less curvy fluid interface and the fluid interface of connected packets at s w 0 478 elongating in the flow direction contributes slightly to capillary pressure therefore the capillary pressure decreases with the increase in saturation fig 6 b furthermore the p c s w curve is quite flat without a droopy tail near s w 1 0 fig 6 b which typically occurs in drainage this is because the fluid saturation is independent of the applied magnitude of pressure gradient in the steady state infiltration li et al 2017b while in drainage the np fluid has to overcome the threshold pressure to enter the porous medium to reduce the wp fluid saturation li et al 2017b also the p c s w curve is observed to be unique in the steady state infiltration in the sense of no dependence on the saturation history markedly different from the p c s w curve behaviors in drainage and imbibition li et al 2017b the data of fluid flux versus pressure gradient are evaluated using the linear regression approach as performed in previous studies swartzendruber 1962 miller and low 1963 prada and civan 1999 within the given range of magnitude of pressure gradient at s w 0 102 0 478 and 0 862 the flux of wp and np fluids vary linearly with the pressure gradient fig 6 c indicating laminar two phase fluids flow but the fitted lines have positive pressure gradient intercepts fig 6 c below which the fluids cannot flow as a result k rσ s w relation shows a significant dependency on capillary number li et al 2017b constantinides and payatakes 1996 henderson et al 1997 huang and lu 2009 although it is unclear why there is a linear region for the data of fluid flux versus pressure gradient at the presence of film fluid and capillary pressure hao et al 2008 dou et al 2014 which are both intrinsic to the two phase flow system the linear relation has been widely observed li et al 2017b and implicitly assumed in the extended two phase darcy equation bear and cheng 2010 in this study the slope and intercept of the fitted line of fluid flux versus pressure gradient are termed as apparent effective permeability k σ and threshold pressure gradient p cσ respectively if the effect of threshold pressure gradient is excluded the computed effective permeabilities under the different magnitudes of pressure gradient collapse to apparent effective permeability li et al 2017b by an analogy to the kozeny carman equation bear and cheng 2010 the apparent effective permeability is expected to be determined by saturation tortuosity of flow path and fluid solid interfacial area the threshold pressure gradient is supposed to be caused by the film fluid induced by adhesive fluid solid interaction and the capillary pressure including its constituents hao et al 2008 dou et al 2014 on the other hand when fluid and geometrical properties are varied simultaneous k σ decrease and p cσ increase result in the decrease in the effective permeability while in the case of k σ decrease but p cσ decrease how the effective permeability is affected depends on whether k σ including its constituents or p cσ including its constituents dominates the two phase flow process therefore apparent effective permeability and threshold pressure gradient are able to link the fluid distribution as well as the capillary pressure as determined by fluid and geometrical properties with the relative permeability in a meaningful way saturation is the dominated factor for k σ and also controls the magnitude of p cσ k σ increases sharply but p cσ decreases rapidly with the increase in saturation of the corresponding fluid fig 6 c and table 3 with the magnitude of pressure gradient invariant the permeability of unsaturated porous media for a particular fluid is dominated by its amount in small amount the fluid can get easily entrapped in the narrow pore throats by adhesive and capillary forces but at the presence of more fluid in porous media the redundant fraction of fluid occupying large pore space becomes easily mobile contributing to the total flux it is interesting to note that both fluids have positive threshold pressure gradients fig 6 c and table 3 this indicates that the flows of not only the np fluid but also the wp fluid are subjected to capillary resistance which is different from the spontaneous imbibition case where the capillary force facilitates the wp fluid flow this is due to the special flow pattern of the steady state infiltration that features the competition between local drainage and local imbibition and can be validated by the fact that the receding fluid interface is more curvy than the advancing fluid interface at s w 0 102 when the fluids flow towards the bottom outlet boundary fig 6 a also the wp pendular rings at s w 0 102 have to be stagnant in the narrow pore throats while the np bubbles at s w 0 862 keep flowing through the porous media fig 6 a it can be demonstrated by the magnitude of p cw at s w 0 102 table 3 which is close to the applied pressure gradient in addition to larger capillary pressure s w 0 102 the adhesive interaction may resist the wp fluid flow in the narrow pore throats as the saturation of each fluid increases simultaneous k σ increase and p cσ decrease lead to the nonlinear increase in the relative permeabilities fig 6 d in addition k rw s w and k rn s w relations intersect at s w 0 5 fig 6 d showing that the wp relative permeability is smaller than the np relative permeability at the same saturation of corresponding fluid both k rw s w and k rn s w relations are concave fig 6 d compared with the diagonal straight lines as expected for the zero interfacial tension showing the loss of total permeability of the porous media when transmitting the two immiscible fluids the irreducible saturation of the wp fluid as large as s w 0 228 is observed but there is no residual saturation of the np fluid fig 6 d these features are attributed to the fact that both fluids in the two phase flow system are resisted by the same capillary force at any saturation while the wp np fluid is subjected to the strong weak adhesive interaction with the solid surface as revealed by k w k n at s w 0 478 fig 6 c and table 3 the value of k rw k rn attains the minimum at s w 0 350 and 0 478 where the largest fluid fluid interfacial area occurs producing the largest capillary resistance 3 2 effect of wettability with the constant interfacial tension at s w 0 478 figs 3 a and 4 a and table 1 the fluid interface is rather curvy for the strong wettability fig 6 a there exists a significant fraction of the wp fluid in the form of film fluid attaching to the back solid surface relative to the flow direction and the wp fluid clusters are very discrete in terms of the fluid distribution however for the weak and neutral wettability the fluid interface becomes quite flat fig 7 a the wp fluid film starts to disappear and becomes connected thus as the wettability weakens the fluid interface has less fluid fluid interfacial area the wp fluid releases more solid surface for the np fluid to occupy fig 7 b for the neutral wettability both a ws s w and a ns s w curves become straight lines and intercross at s w 0 5 fig 7 b indicating that both fluids attach to the same area of solid surface at the equivalent saturation of each fluid meanwhile the capillary pressure drops across the whole range of saturation fig 7 b as indicated by the laplace equation bear and cheng 2010 relating the capillary pressure to the wettability for the wp np fluid the decrease increase in fluid solid interfacial area results in significant k w increase k n decrease on the other hand both the fluid fluid interfacial area reduction and the capillary pressure decrease lead to a marked drop in p cσ of both fluids fig 7 c and table 3 consistent with the conjecture hao et al 2008 dou et al 2014 that the threshold pressure gradient partly results from the capillary force it is interesting to note that for the neutral wettability the values of k σ and p cσ of the two immiscible fluids are very close to each other table 3 in the sense that the fitted flux versus pressure gradient lines almost overlap each other fig 7 c but the values of p cσ of the two immiscible fluids are not equal to zero table 3 as validated by the slight curvature of the fluid interface fig 7 a contributing to the capillary resistance thus the contact angle is hysteretic with respect to whether the fluid interface is at the static equilibrium receding or advancing bear and cheng 2010 moreover for all the given wettability the difference between p cw and p cn is very slight table 3 showing the weak adhesive fluid solid interactions because of the uniform distribution of pore size both k w increase and p cw decrease trigger a rise in the wp fluid relative permeability but k n decrease dominating p cn decrease causes a reduction in the np fluid relative permeability fig 7 d which is consistent with the results of previous studies li et al 2005 hao and cheng 2010 however there is no much difference in k rn s w relation for the weak and neutral wettability at s w 0 350 and s w 0 729 fig 7 d as a result of the two opposing mechanisms for the neutral wettability k rw s w and k rn s w relations intercross at s w 0 5 and are both still concave fig 7 d showing that the relative permeabilities of both fluids are very close to each other at the equivalent saturation of each fluid and the slightly curvy fluid interface still contributes to the capillary resistance 3 3 effect of adhesive strength when the interfacial tension and the wettability remain the same at s w 0 478 figs 3 a and 4 b and table 1 more wp fluid film is generated to coat the arbitrary side of the solid surface under stronger adhesive strength fig 8 a as a result the wp fluid is distributed very discretely and more fluid interface is produced fig 8 b the wp fluid takes up more solid surface and the np fluid has to be detached from more solid surface fig 8 b for the adhesive strength g s 2 5 1 5 the wp fluid takes up almost 90 of the solid surface at s w 0 478 and the crossover of a ws s w and a ns s w curves appears at s w 0 2 in contrast for the interaction strength g s 1 5 5 5 which are both repulsive the wp fluid occupies about 55 of the solid surface and a ws s w and a ns s w curves intercross at s w 0 45 fig 8 b also stronger adhesive strength induces greater capillary pressure across the whole range of saturation fig 8 b in addition to capillary force the adhesive fluid solid interaction itself provides another source of capillary pressure bear and cheng 2010 because of which the film fluid is formed with the wp fluid mobility reduced longmuir 2004 the viscosity of the wp fluid near the solid surface and the bulk fluid would be affected benzi et al 2006 both the strong adhesive strength on the wp fluid solid interfacial area and the increased wp fluid solid interfacial area give rise to k w decrease while the strong adhesive strength on the np fluid solid interfacial area exceeding the decreased np fluid solid interfacial area brings about k n decrease fig 8 c and table 3 for the adhesive strength g s 2 5 1 5 k w decrease is particularly significant fig 8 c and table 3 as a result of the large increase in the solid surface covered by the wp fluid film and in the viscosity of the fluid near the solid surface it can be seen that k w k n at the equivalent saturation of each fluid due to larger wp fluid solid interfacial area and strengthened adhesive wp fluid solid interaction greater capillary pressure and larger fluid interface almost do not affect p cw for g s 1 5 5 5 and 0 5 0 5 or p cn for all the given adhesive strengths fig 8 c and table 3 indicating that the slight amount of wp fluid film does not dominate the wp fluid mobility compared with capillary force for g s 1 5 5 5 and 0 5 0 5 the capillary pressure induced by adhesive fluid solid interaction and the fluid fluid interfacial area resulting from the wp fluid film do not influence the mobility of np fluid significantly for the adhesive strength g s 2 5 1 5 a marked p cw increase occurs fig 8 c and table 3 due to the large portion of wp fluid film with reduced mobility consistent with the conjecture hao et al 2008 dou et al 2014 that the threshold pressure gradient partly results from the film fluid stronger adhesive wp fluid solid interaction also leads to p cw p cn the slight k w decrease and the almost invariant p cw do not trigger a notable decrease in the wp relative permeability for g s 1 5 5 5 and 0 5 0 5 at s w 0 729 but the decrease in the wp relative permeability is significant for g s 2 5 1 5 at any saturation fig 8 d as a result of significant k w decrease and p cw increase in addition the irreducible wp fluid saturation in the form of film fluid is raised from 0 228 for g s 0 5 0 5 to 0 420 for g s 2 5 1 5 on the other hand k n decrease and almost invariant p cn cause the decrease in the np relative permeability for all the given adhesive strengths fig 8 d the most loss in the total permeability of porous media at s w 0 478 occurs for g s 2 5 1 5 table 3 3 4 effect of pore size distribution the specified porous media with equal porosities but different pore size distributions possess different intrinsic permeabilities because of different tortuosities of the flow path figs 3 b and 5 a and table 1 for the heterogeneous psd3 medium with quite non uniform pore sizes the flow path is most tortuous table 1 and there are large fractions of macropores and fine pores fig 5 a at s w 0 478 more wp fluid fills the narrow pore throats and more np fluid occupies the large pore space making both fluids more connected fig 9 a in the middle region of the psd3 medium the np fluid forms a connected pathway region a and another two large fluid clusters regions b and c which take up the major fraction of np fluid meanwhile some macro pores region d are impossible for the np fluid to enter because they are segregated by the fine pores relative to the flow direction thus a few small clusters as a minor part of the np fluid are distributed discretely due to the initial distribution all the wp fluid is divided into only two large fluid packets by the np connected pathway the improved fluid connectivity causes less fluid fluid interfacial area more solid surface contacted with the wp fluid and less solid surface in touch with the np fluid fig 9 b the larger fraction of fine pores enhances the adhesive wp fluid solid interaction hao et al 2008 dou et al 2014 and thus capillary pressure is larger at each saturation fig 9 b due to the heterogeneity of the psd3 medium it is easier for the wp fluid clusters to get trapped at some saturations the immobile bubbles with curvy interfacial area contribute to larger capillary pressure and thus p c s w curve for the psd3 medium experiences greater fluctuations fig 9 b compared with the one for the psd1 medium both the high tortuosity and the increased wp fluid solid interfacial area lead to k w decrease but the high tortuosity overwhelming the decreased np fluid solid interfacial area is manifested in k n decrease fig 9 c and table 3 the enhanced adhesive wp fluid solid interaction causes p cw to increase and the more connected np fluid distribution renders p cn to decrease fig 9 c and table 3 these results show again that the adhesive interaction induced capillary pressure does not affect the mobility of np fluid also for psd2 and psd3 media p cw p cn is table 3 due to the adhesive wp fluid solid interaction raised by the fine pores it is interesting to note that k n decrease and p cn decrease result in a crossover of the fitted flux versus pressure gradient lines for the given porous media at p 32 kpa m fig 9 c below which p cn capillary force dominates the np fluid flow and above which the np fluid flow is dominated by k n viscous force both k w decrease and p cw increase suggest a reduction in the wp relative permeability fig 9 d while k n decrease and p cn decrease make the situation complicated under the applied pressure gradient p 24 kpa m where the np fluid flows in the capillary force dominated regime the np effective permeability slightly increases as the heterogeneity of porous media strengthens fig 9 c it should be also mentioned that the given porous media possess different intrinsic permeabilities and thus the slight increase in the np effective permeability is enlarged by the decreased intrinsic permeability in terms of the np relative permeability fig 9 d and table 1 the responses of the relative permeabilities of both fluids agree with the observations made in previous studies dou and zhou 2013 3 5 effect of specific surface area the given porous media with equivalent porosity feature different specific surface areas figs 3 b and 5 b for the grain452 medium with larger specific surface area the average pore radius and the intrinsic permeability are both smaller figs 3 b and 5 b and table 1 the wp fluid preferring to stay in the fine pores becomes more continuous resulting in less fluid fluid interfacial area fig 10 a and b however for the grain178 medium the np fluid tending to stay in the macro pores may dominate the fluid connectivity thus there is no much difference in the fluid fluid interfacial area between the grain178 and grain300 media figs 6 a and 10 a b as the specific surface area increases more solid surface becomes available for both fluids and therefore the wp fluid and np fluid solid interfacial areas increase at the same saturation of each fluid fig 10 b the capillary pressure is larger at any saturation fig 10 b as indicated by the laplace equation bear and cheng 2010 relating the capillary pressure to the pore radius for both fluids the increase in fluid solid interfacial area signifies k σ decrease and the capillary pressure increase dominating the fluid fluid interfacial area decrease suggests a rise in p cσ fig 10 c and table 3 for the grain452 medium there is a slight trend of p cw p cn table 3 due to the enhanced adhesive wp fluid solid interaction because of the smallest pore radius both k σ decrease and p cσ increase indicate a reduction in the effective permeabilities of both fluids it should be noted that as the specific surface area rise the intrinsic permeability of porous media drops as well table 1 however the relative permeabilities of both fluids still decrease significantly fig 10 d showing the nonlinear response of the effective permeability to the specific surface area which is different from the effect on the wp relative permeability observed in previous studies ghassemi and pak 2011 gao et al 2015 this difference may reflect different conditions where the increased connectivity as demonstrated by the decreased fluid fluid interfacial area or the increased capillary pressure as a result of the narrowed pore radius dominates the capillary resistance and depends on the fraction of the effective fluid interface that contributes to the capillary resistance relative to the flow direction the maximum loss in the total permeability at s w 0 478 takes place for the grain452 medium table 3 because of the enhanced adhesive wp fluid solid interaction and the increased capillary resistance 4 conclusions this study has been performed to explore the roles of the film fluid as a result of the adhesive fluid solid interaction and the capillary pressure hao et al 2008 dou et al 2014 in the non uniqueness of k rσ s w relation it is found that the apparent effective permeability and the threshold pressure gradient can be used to link the fluid distribution as well as the capillary pressure as determined by fluid and geometrical properties with the relative permeability meaningfully the sensitivity of fluid distribution and constitutive relationships to wettability adhesive strength pore size distribution and specific surface area is tested using the state of the art scmc lbm model on two dimensional simultaneous flow cell key findings are summarized as the following 1 each fluid occupies more solid surface as the saturation and the available solid surface increase and the wp fluid tends to take up more solid surface than the np fluid at the same saturation of each fluid once the thin wp fluid film is formed it can coat the solid surface with a slight saturation which repels the np fluid in the heterogeneous porous media the wp np fluid filling the fine pores macropores seizes more less solid surface 2 the fluid interface regulated by the saturation of the minor fluid peaks at the intermediate saturation in the form of film fluid the wp fluid is very discretely distributed resulting in the significantly increased fluid fluid interfacial area in the heterogeneous porous media the wp np fluid tending to fill the narrow large pore space makes both fluids more connected on the other hand for the small large average pore radius the wp np fluid becomes more continuous in the less heterogeneous porous media the fluid fluid interfacial area is a good parameter for describing the fluid connectivity 3 the capillary pressure decreases with the increase in saturation and p c s w curve is relatively flat without a droopy tail at s w 1 0 in the steady state infiltration the effect of wettability and average pore radius on the capillary pressure follows the indications by the laplace equation bear and cheng 2010 in addition to the capillary force the adhesive fluid solid interaction provides another source of capillary pressure which can be enhanced by the large adhesive strength and the fine pores in the heterogeneous porous media 4 the apparent effective permeability of each fluid increases with the increase in its saturation but decreases with the increase in tortuosity of flow path and fluid solid interfacial area which is consistent with the kozeny carman equation bear and cheng 2010 also it maintains a negative correlation with the adhesive strength on the fluid solid interfacial area at the equivalent saturation k w is smaller than k n 5 the threshold pressure gradient is dominated by the saturation of each fluid small amount of one fluid gets easily entrapped in the narrow pore space p cw originates from the film fluid with the reduced mobility and the capillary resistance as well in the steady state infiltration on the other hand p cn is due to the capillary resistance but the adhesive interaction induced capillary pressure does not affect the mobility of np fluid at the same saturation p cw can exceed p cn when the film fluid effect is significant for the strong adhesive strength or for the heterogeneous porous media with fine pores 6 simultaneous k σ decrease and p cσ increase result in the decrease in the effective permeability while in the case of k σ decrease but p cσ decrease how the effective permeability varies depends on whether k σ or p cσ dominates the two phase flow process under the applied pressure gradient k σ p cσ is expected to play a dominant role under the large small applied pressure gradient the effect on the effective permeability may be enlarged by decreased intrinsic permeability in terms of the relative permeability the effective permeability is nonlinearly correlated with saturation and specific solid surface the two phase flow system in the steady state infiltration is a coupled thermo hydrodynamic process as revealed by the effect of film fluid and capillary pressure on the relative permeabilities of both fluids the strong wettability of wp fluid and the increased adhesive wp fluid solid strength reflect the introduction of more surface energy into the flow system and thus both the capillary pressure and the fluid fluid interfacial area rise at all saturations meanwhile when the geometrical property is varied the capillary pressure responds reversely relative to the fluid fluid interfacial area at each saturation implying the conservation of surface energy in the flow system the findings from this study elucidating the roles of film fluid and capillary pressure in the two phase flow system have implications for improving the macroscopic flow equation through balance of force for the steady state infiltration acknowledgments the primary data of grain sizes and packing are downloaded from the packomania webpage http www packomania com all the simulations were executed using the mechsys open source library http mechsys nongnu org and the goliath high performance computing cluster of the university of queensland the first author would like to acknowledge the support of international postgraduate research scholarship iprs and university of queensland centennial scholarship uqcent the authors also thank the three anonymous reviewers for their thorough reviews and constructive comments supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 009 appendix supplementary materials image application 1 
818,drywells are increasingly used for stormwater management and enhanced aquifer recharge but only limited research has quantitatively determined the performance of drywells numerical and field scale experiments were therefore conducted to improve our understanding and ability to characterize the drywell behavior in particular hydrus 2d 3d was modified to simulate transient head boundary conditions for the complex geometry of the maxwell type iv drywell i e a sediment chamber an overflow pipe and the variable geometry and storage of the drywell system with depth falling head infiltration experiments were conducted on drywells located at the national training center in fort irwin california ca and a commercial complex in torrance ca to determine in situ soil hydraulic properties the saturated hydraulic conductivity ks and the retention curve shape parameter α for an equivalent uniform soil profile by inverse parameter optimization a good agreement between the observed and simulated water heights in wells was obtained for both sites as indicated by the coefficient of determination 0 95 0 99 unique parameter fits and small standard errors fort irwin and torrance drywells had very distinctive soil hydraulic characteristics the fitted value of ks 1 01 10 3 m min 1 at the torrance drywell was consistent with the sandy soil texture at this site and the default value for sand in the hydrus soil catalog the drywell with this ks 1 01 10 3 m min 1 could easily infiltrate predicted surface runoff from a design rain event 51 3 m3 within 5760 min 4 d in contrast the fitted value of ks 2 25 10 6 m min 1 at fort irwin was very low compared to the torrance drywell and more than an order of magnitude smaller than the default value reported in the hydrus soil catalog for sandy clay loam at this site likely due to clogging these experiments and simulations provide useful information to characterize effective soil hydraulic properties in situ and to improve the design of drywells for enhanced recharge graphical abstarct image graphical abstract keywords drywell hydrus 2d 3d falling head inverse simulation hydraulic properties in situ 1 introduction water has a strong influence on food and energy production industrial and agriculture output and population and economic growth of nations gleick 1993 shannon et al 2008 the availability of high quality water resources is rapidly decreasing especially in arid and semi arid regions of the world due to the demographic shift and the subsequent increase in demand and overuse of freshwater and contamination of aquifers and lakes shannon et al 2008 koehler 2008 climate variability has further increased the vulnerability of water resources and it is estimated that around 5 billion people will be living in countries under water stress by 2025 treidel et al 2011 vorosmarty et al 2000 arnell 1999 in addition urban development with paved and impermeable surfaces has had a profound impact on the hydrologic cycle by altering drainage patterns reducing infiltration and water storage and increasing the volume of surface runoff dunne and leopold 1978 mount 1995 this can contribute to a decline in natural groundwater recharge long term and short term drought an increase in water pollution levels and flooding caused by surface runoff weng 2001 arnold and gibbons 1996 many arid and semi arid urban regions of the world face serious challenges in maintaining water quality and quantity to meet its growing population demand for example around 60 of the water supply in southern california is imported from the colorado river basin and northern california and the rest is withdrawn from its local aquifers freeman 2008 even though los angeles la county collects stormwater runoff from its urban surfaces and uses it for artificial recharge more than 680 mm3 of its urban runoff equivalent to half of its imported water reaches the ocean annually dwr 2009 however local groundwater basins in la county have more than 1480 mm3 of unused storage capacity that could be used to store this untapped freshwater resource furthermore capturing and recharging stormwater into the aquifers will reduce la county s dependence on imported water energy needs for pumping and improve its management of flooding and contaminant loads from surface runoff dallman and spongberg 2012 mwd 2007 davis and mccuen 2005 consequently implementation of management practices to capture stormwater and enhance its recharge into aquifers can have a large influence on many water quality and quantity aspects lacdpw 2014 engineering systems which manage surface water and infiltrate it into aquifers are classified as surface vadose zone and direct injection infiltration systems bouwer 2002 edwards et al 2016 surface infiltration systems e g infiltration basins detention basins vegetated swales and managed aquifer recharge ponds place stormwater directly on the ground surface they require highly permeable sediment and a large surface area for rapid infiltration to occur but can lose water due to evapotranspiration bouwer 2002 most of the surface area of vadose zone infiltration systems e g recharge trenches and drywells extends either vertically or horizontally under the ground surface bouwer 2002 dillon and pavelic 1996 injection wells e g managed aquifer recharge are used to transmit water directly into aquifers bouwer 2002 dillon 2005 both injection and vadose zone infiltration systems have no or only minimal evapotranspiration losses do not require large installation area and may employ large water ponding depths to facilitate rapid infiltration these various engineering systems also offer different potentials for reactive contamination transport and attenuation in the vadose zone direct injection wells provide no chance for contaminant attenuation in the vadose zone bouwer 2002 whereas vadose zone and especially surface infiltration systems provide opportunities of contaminant removal in the vadose zone bouwer 2002 edwards et al 2016 dillon and pavelic 1996 only vadose zone infiltration systems offer potential advantages of minimal evapotranspiration small installation area large ponding depths and vadose zone treatment one vadose zone infiltration system that has gained a lot of recent attention in the united states and around the world is a drywell drywells are subsurface storage facilities that receive temporarily store and infiltrate stormwater into the vadose zone edwards et al 2016 modern drywell designs include a fully permeable well that is located above the water table and may have pretreatment systems such as single double sedimentation chambers to remove sediments and sponges to adsorb hydrocarbons in stormwater edwards et al 2016 in addition to the advantages noted above drywells are also popular because they have a relatively low installation and maintenance cost in comparison to other engineered infiltration systems however drywells are not well suited for areas with low permeability soils high water tables steep slopes or contaminated soils landfills and industrial complexes due to the potential risks of groundwater pollution lacdpw 2014 furthermore drywell failure may occur due to clogging if pretreatments are inadequate or in situ clays are mobilized in this case a complete reconstruction or a new drywell may be required limited published research has examined the performance of drywells edwards et al 2016 jurgens et al 2008 izuka 2011 snyder et al 1994 reported on a drywell recharge study in the portland basin in oregon usa and found that 5700 drywells in urban areas contributed 38 of the total recharge to groundwater within the basin wilson et al 1990 analyzed the impact of drywells on recharge groundwater pollution and urban runoff at three sites in arizona results indicated that recharge from drywells created a transmission zone for water movement with minimal impacts on groundwater quality in contrast field and numerical modeling studies in washington and arizona usa demonstrated that pollutant attenuation was related to the soil particle size and recommended that drywells be located in soil profiles with a clay layer to enhance contaminant adsorption adolfson associates 1995 bandeen 1984 the above considerations suggest that even if previous results are encouraging more research is needed to better understand the impact of drywells on groundwater recharge and quality knowledge of the soil profile hydraulic properties is essential for the successful design execution and long term operation of a potential drywell location bandeen 1987 simulated the variably saturated subsurface flow from a drywell using an axísymmetric flow domain and the galerkin finite element method that was implemented in the unsat2 program water flow from the drywell was represented as a gravel filled borehole the soil hydraulic properties were determined from a constant borehole infiltration test and empirical formula bandeen 1984 bandeen 1987 however existing numerical models have not yet accurately represented the complex geometry of modern drywell designs like maxwell type iv torrent resources which includes an upper sedimentation chamber an overflow pipe and a bottom chamber packed with gravel that determine the total volume and the maximum head of the drywell consequently these models will not accurately simulate the filling and falling head cycle within a modern drywell subsequent infiltration into the vadose zone and determination of the effective soil hydraulic properties via inverse optimization to our knowledge there is no existing literature or numerical modeling on determining average soil hydraulic properties using the inverse optimization of field scale falling head data in a modern drywell system the main objective of this study was to improve our understanding and ability to characterize the drywell behavior by conducting systematic numerical and field scale experiments the hydrus 2d 3d computer software was modified to simulate transient head boundary conditions for the complex geometry of a modern drywell i e a sediment chamber an overflow pipe and the variable geometry and storage of the drywell system with depth falling head experiments were conducted at drywells maxwell iv model torrents resources arizona usa located in the national training center in fort irwin california and a commercial complex in torrance california the effective soil hydraulic parameters with the saturated hydraulic conductivity ks and the retention curve shape parameter α for an equivalent uniform soil system representative of both sites were determined by inverse parameter optimization of the observed falling head data comparison of the fitted ks and α parameters from these two distinctive sites provide useful information to characterize and improve the design of the drywells 2 materials and methods 2 1 field sites the drywell in the first study june 2017 is situated at the sleepy hollow military housing within the fort irwin national training center ntc in the mojave desert california ca fig 1 a the fort irwin base climate is typical of the mojave desert with low precipitation hot summers and cool winters densmore and londquist 1997 it has an annual precipitation of roughly 0 13 mm summer monsoon thunderstorms may bring heavy intensity and depth rainfall over a small area which can cause localized flooding higdon 2004 hubbard 2013 the ntc receives its water from local aquifers including the irwin basin that is underneath the cantonment area the army net zero water program has a long term goal to balance water pumping with aquifer recharge a drywell was installed on a portion of the cantonment area of fort irwin adjacent to four softball fields referred to as the four plex site see fig 1 a in 2007 urban runoff generated from housing developments upstream of the four plex site is directed into a detention pond where the drywell is located the drywell in the second study september 2017 is situated in a commercial complex in torrance the los angeles county california fig 1 b the tested drywell was part of a four drywell system installed in may 2013 at this site as a standard urban stormwater mitigation plan requirement susmp the susmp was developed as part of the municipal stormwater program to address stormwater pollution from development projects la stromwater 2000 the site drainage area is about 3 21 acres with 90 impervious surface and the drywell receives pre treated stormfilter contech engineered solutions water from subsurface piping dejong 2017 2 2 drywell engineering design the maxwell iv model torrents resources phoenix arizona usa drywell was installed at fort irwin and torrance figs s1a and s1b show the engineering designs for the fort irwin and torrance drywells respectively the fort irwin and torrance drywells receive inflow water into an upper sediment chamber through a grated opening on top and subsurface detention pipes respectively this upper sediment chamber has an impermeable chamber side a concrete base seal and a floating hydrocarbon capture pillow which removes a wide range of hydrocarbons silt sediment and debris settle out of the water by gravity inside the upper chamber incoming water rises inside the upper sediment chamber and then enters an overflow intake pipe which is connected to a lower chamber the overflow inlet is equipped with a debris screen which blocks the passage of suspended matter and other floating debris water from the overflow pipe enters a lower chamber which is filled with clean rocks 0 9 3 8 cm the entire gravel pack is surrounded by a fully permeable needle punched non woven geotextile polypropylene or polyester fabric sleeve to prevent the migration of fines into the gravel pack water in the gravel pack infiltrates into the vadose zone soil envelope and eventually recharges groundwater aquifers torrentresources 2012 2 3 falling head infiltration experiment a fire hydrant was used to flood the detention pond to fill the fort irwin drywell a vacuum pump truck was used to remove excess water from the detention pond until the water level just reached the top of the grate covering the entrance to the drywell the detention pond was partially filled for 163 min at this point a calibrated pressure transducer decagon ctd 10 sensor 40683 usa was lowered into the bottom of the upper sediment chamber and used to measure the water depth in the drywell every minute with an accuracy of 0 05 and resolution of 2 mm this pressure transducer was connected to a data logger decagon em50 series and then to a laptop computer via a usb cable when the water level reached the inlet of the overflow pipe at 60 min the pressure transducer was moved into the overflow pipe and lowered to a depth of 10 m from the surface and the water level was monitored for 1098 min according to the engineering design the sediment chamber wall the bottom section of the concrete liner with a small number of side perforations and the base solid concrete slurry are impermeable and should thus allow infiltration at a much smaller rate than the bottom of the well however we observed that the entire drywell system i e the sedimentation chamber and the well bottom acted like a single system and drained at the same rate this indicates that the base concrete slurry seal might have broken and allowed water to flow directly into the bottom chamber the final water level measurement was taken at 1481 min using a model 102 water level meter solinst canada ltd canada with a resolution of 1 mm solinst 2017 a small amount of water was released into the drywell during the night hours from sprinkler irrigation runoff and the resultant change in pressure head was recorded by the pressure transducer table s4 a calibrated pressure transducer decagon ctd 10 sensor 40683 usa was placed at the bottom of the torrance ca drywell via the overflow pipe the experiment was conducted in three phases in phase i 0 74 min a fire hydrant outlet that was connected directly to the upper sediment chamber was used to fill this shallow drywell system 0 7 min only 10 67 m depth in a controlled manner falling head measurements 7 74 min were recorded using the pressure transducer every minute and a datalogger decagon em50 series until the water level in the well reached a steady state in phase ii 75 98 min a constant head test was conducted by refilling the drywell and then maintaining the head by adjusting the inflow using a flowmeter connected to the fire hydrant outlet in phase iii 99 154 min the drywell was completely refilled and a second falling head test was conducted table s4 during our site visits we have measured the dimensions of the fort irwin and torrance drywells and this information is given in figs s1a and s1b 3 numerical modeling the hydrus 2d 3d software package is a finite element model for simulating the two or three dimensional movement of water heat and multiple solutes in variably saturated media simunek et al 2016 water flow is described in hydrus 2d 3d using the richards equation 1 θ t x i k k i j a h x j k i z a where θ l3 l 3 dimensionless l denotes units of length is the volumetric water content h l is the pressure head xi i 1 2 l are spatial coordinates t t t is unit of time is time k i j a are components of a dimensionless hydraulic conductivity anisotropy tensor ka and k l t 1 is the unsaturated hydraulic conductivity function given as the product of the relative kr and saturated hydraulic conductivity ks l t 1 the unsaturated soil hydraulic conductivity k h and water retention θ h functions are needed to solve eq 1 the unsaturated soil hydraulic property models of van genuchten 1980 and mualem 1976 were employed for this purpose 2 θ h θ r θ s θ r 1 α h n m h 0 3 θ h θ s h 0 4 k h k s s e l 1 1 s e 1 2 m 2 where θ r and θ s l3l3 denotes the residual and saturated water contents respectively α l 1 is the shape parameter in the soil water retention function l is the pore connectivity parameter and n and m 1 1 n are empirical parameters related to the pore size distribution the effective saturation se is defined as 5 s e θ h θ r θ s θ r fig 2 presents a schematic of the simulation domain boundary conditions and initial conditions that were considered for the fort irwin and torrance drywell sites a 2 dimensional axisymmetrical flow domain was employed in both cases the fort irwin site geometry had a 3 m width and a 35 m depth whereas the torrance site had a 5 m width and a 15 m depth the specified radial dimensions were chosen to best capture the infiltration radius of the drywell based on the soil log information and the vertical dimensions were chosen based on the depth of the drywell a no flux boundary condition was assigned to the upper boundary the nodes representing the right and lower left the boundary between the drywell and the bottom boundary sides of the flow domain were set to no flux boundaries the nodes at the bottom boundary z 35 m and z 15 m for the fort irwin and torrance drywell simulations respectively were assigned a free drainage boundary condition because the groundwater table was deep and below the bottom of the transport domain along the left at z 2 to 29 4 for fort irwin and z 7 36 to 11 2 for torrance and bottom boundary a reservoir boundary condition was specified to allow for a seepage face šimůnek et al 2018 for this boundary condition parts of the boundary that are below and above the water level in the well are internally assigned time variable pressure head dirichlet and seepage face boundary conditions respectively hydrus 2d 3d calculates which part of the seepage face boundary is active with prescribed zero pressure head and which is inactive with prescribed zero flux depending on whether the boundary nodes are saturated or unsaturated respectively šimůnek et al 2018 details pertaining to this so called reservoir boundary condition are provided in the next section the water table at the fort irwin and torrance study site is at approximately 61 and 21 m below the soil surface respectively hence the distance between the bottom of the drywell and the water table is approximately 34 and 10 m for the fort irwin and torrance drywells respectively therefore the soil moisture is uniform throughout the domain the capillary fringe is well below the bottom of the well and the soil domain surrounding the drywell installation is an unsaturated zone hence the initial condition was specified in terms of the soil water pressure head h x z and was set to a constant pressure head of 0 5 m for the entire domain fig 2 the simulation domain was discretized into two dimensional triangular finite element mesh using the meshgen tool available within the hydrus 2d 3d the mesh was refined at the left part of the domain where infiltration from the drywell was simulated to reduce the mass balance error the finite element grid was adjusted such that the size of elements was smaller 0 05 m near the well where large water fluxes were expected the grid size was gradually increased with a radial distance from the drywell with a maximum element size of 0 75 m and 0 5 m for the fort irwin and torrance domain respectively the quality of the finite element mesh was assessed by checking the mass balance error reported by hydrus 2d 3d at the end of the simulation mass balance errors were always below 1 and these values are generally considered acceptable brunetti et al 2017 hydrus 2d 3d includes a parameter estimation procedure based on the levenberg marquardt nonlinear least squares optimization method marquardt 1963 this procedure was employed to estimate several unknown parameters in the unsaturated soil hydraulic functions from measurements of the total water height in the drywells over time by the numerical inversion of the richards equation in the absence of detailed information on soil profile heterogeneity e g the soil log does not provide information about the lateral extension of layers only effective soil hydraulic parameters were obtained for an equivalent uniform soil profile in particular the values of α and ks were determined for the homogeneous soil profile by inverse optimization other soil hydraulic parameters n l θ r and θ s were set equal to default values from the hydrus soil catalog for homogeneous sandy clay loam at the fort irwin site and sand at the torrance site table 1 these soil textural classes were chosen based on available soil log information from these sites additional research is needed to fully characterize hysteretic hydraulic properties for the heterogeneous soil profiles but this is beyond the scope of this study 3 1 reservoir boundary condition the drywell has a very complex geometry with multiple compartments to accurately determine the ponded water height and water flux in the drywell during filling and drainage cycles the drywell geometry was subdivided into 6 different reservoirs fig 3 a and b for fort irwin and torrance respectively reservoirs 1 5 mimic the drywell design figs s1a and s1b whereas reservoir 6 is used to account for external ponding geometry parameters for these reservoirs are read into the modified version of hydrus from an input file well in cross sectional areas and volumes for each reservoir are subsequently calculated from this information and are provided in tables s1 s2 and s3 it should be mentioned that the design of drywells at torrance and fort irwin is somewhat different for example the sedimentation chamber is much bigger at torrance 6 9 m than at fort irwin 4 6 m and reservoir 2 is much bigger at fort irwin 22 2 m than at torrance 3 2 m furthermore at torrance the gravel pack surrounding the upper sediment chamber was replaced by an impermeable concrete slurry fig s1b that does not contribute to the volume of reservoirs 4 and 5 a zero porosity was assigned to this shaded region in fig 3 b in contrast to the fort irwin drywell s engineering design we observed that the upper sedimentation chamber had 1 m thick layer of sediments and the entire drywell system acted like a single system and drained at the same rate therefore additional numerical simulations were conducted by employing the well dimensions obtained from site measurements tables s2 and s4 fig 3 indicates that the drywell was subdivided into two main domains domain 1 comprises reservoirs 1 4 5 and 6 whereas domain 2 consists of reservoirs 2 3 4 5 and 6 the drywell fills from reservoir 1 to 6 drainage from reservoir 1 was not considered since its bottom is covered with an impermeable concrete slurry drainage from domain 2 occurs in the reverse sequence to filling e g reservoirs 6 5 4 3 and 2 the total water levels a sum of water levels from reservoirs in domains 1 and 2 denoted as h w1 and h w2 determine which reservoir is actively filling or draining logical statements in conjunction with well geometry information were used to determine which reservoir was active at any given time the initial values of h w1 and h w2 at the beginning of the simulation h w1 and h w2 respectively and the water inflow as a function of time qin t l3 t 1 are also input parameters in the well in file the change in the water volume within an active reservoir with respect to time can be calculated using the following mass balance condition 6 d v w i d t a i d h w i d t q i n t q o u t t where vwi l3 is the volume of water in the reservoir ai l2 is the cross sectional area of the reservoir hwi l is the water level in the reservoir qout t l3 t 1 is the total water outflow to the soil surrounding the drywell and the subscript i indicates the reservoir number in its finite difference discretization eq 6 becomes 7 h w i j 1 h w i j δ t a i q i n q o u t where δt t is the time step and h w i j 1 l and h w i j l are water levels in the reservoir at current and previous time steps respectively eq 7 is used to determine the water level in an active reservoir at the current time step the values of h w1 and h w2 are updated based on this information and the boundary conditions in the hydrus domain are dynamically adjusted values of qout used for the next time step and the total drywell water volume are subsequently calculated in hydrus and printed to new output text files well out and wellvolume out respectively the value of h w1 and h w2 and the time variable boundary conditions used in the inverse simulation for the fort irwin and torrance drywells are given in table s4 in addition numerical experiments were conducted with hypothetical conditions the first experiments were conducted to understand the dynamics of the drywell and the functioning of the new reservoir boundary condition in this case simulations for a complete filling and drainage cycle were conducted for the fort irwin drywell geometry an engineering design over 100 000 min figs 4 and s2 table s5 other simulations were conducted to compare the cumulative infiltration volume between the fort irwin and torrance drywells over 1100 min for a complete drainage cycle and multiple filling and drainage cycles respectively fig 8 the time variable boundary conditions used in these experiments are given in table s5 4 results and discussion 4 1 dynamics of a drywell the functioning of the newly developed drywell reservoir boundary condition module and its coupling with the hydrus 2d 3d model during one complete filling and drainage cycle was evaluated using the fort irwin drywell geometry a time variable boundary condition was employed in the simulation as follows hypothetical water inflow was 0 23 m3 min 1 for 0 to 100 min and 0 m3 min 1 for 100 10 000 min table s5 fig 4 a shows the change in h w1 and h w2 fig 4 b shows the sequence of filling and draining of reservoirs 1 6 and the corresponding change in the total water volume in the drywell system vwell these figures show that vwell increased as the injection continued at a slow pace until reservoirs 1 through 6 were full at the beginning of the simulation the water volume in reservoir 1 v 1 as well as the corresponding value of h w1 increased until it reached the maximum volume of 3 185 m3 during the next stage water overflowed through the overflow pipe fig s1 and filled sequentially reservoirs 2 and 3 v 2 and v 3 while h w1 stayed constant and h w2 increased in the next phase reservoirs 4 5 and 6 v 4 v 5 and v 6 were filled and the corresponding water levels h w1 and h w2 increased once all 6 reservoirs were full they started draining in the order of v 6 v 5 v 4 v 3 and v 2 fig 4 b and the corresponding water levels h w1 and h w2 decreased with time fig 4 a note that we do not consider draining of v 1 since the sedimentary chamber is surrounded by an impermeable wall and a base seal concrete slurry fig 4 shows that vwell h w1 and h w2 increased and reached the maximum during the filling cycle and then started decreasing to a constant value of v 1 and h w1 whereas h w2 went down to zero during the draining cycle figures s2a in a normal scale and s2b in a log scale present the change in the well water volume cumulative infiltration and the mass balance for the well water volume during one complete filling injection and emptying infiltration falling head cycle for the entire drywell 4 2 inverse estimation of soil hydraulic properties fig 5 shows the observed and inversely simulated values of h w2 over time at the torrance site fig 5 a d consider phases i initial filling of the entire drywell and then draining of reservoirs 5 4 3 and 2 ii refilling of the drywell and the constant head test iii refilling of the entire drywell and then draining of reservoirs 5 4 3 and 2 and the entire experiment phases i ii and iii respectively a sudden decrease in h w2 occurs during draining of reservoir 4 during phases i and iii because it holds a very small volume of water 0 1 m3 compared to the other reservoirs fig 3 b and table s1 table 1 shows the corresponding fitted values of ks and α the standard error coefficient 95 upper and lower confidence interval limits the coefficient of determination r 2 and the mass balance errors for each simulation period fig 5 and the table 1 show a very good agreement between the observed and simulated values with r 2 values of 0 96 0 99 and the mass balance error less than 0 3 based on these simulations the value of α ranged from 0 52 2 80 m 1 and the value of ks ranged from 1 01 10 3 1 89 10 3 m min 1 table 1 shows that all fitted parameters were unique with a very small standard error and a narrow 95 confidence interval during the simulation for each phase the initial condition was imported from the last time step of the previous phase and the observed difference in the fitted ks and α value can be suggested by the variations in the initial condition pressure head this result shows that conducting multiple filling and drainage cycle experiment will help for the accurate estimation of effective hydraulic properties in addition we acknowledge that there is a slight deviation in the slope at phase i and phase iii during emptying of reservoir 2 we have tried our best to incorporate the engineering design and onsite measurements to describe the drywell s geometry however we believe that this discrepancy in the simulated value of h w2 is due to variations in the volume of the actual well e g slight variations in the well geometry and or the porosity of the packing material soil log information collected from 4 drywells at the torrance site showed the presence of a silty clay layer in a depth of 0 7 m a silty sand layer in 4 87 9 7 m a sand layer in 5 4 11 6 m and a silty sand layer in 10 1 14 93 m however the lateral continuity of these layers is not known fitted values of high ks were consistent with previously reported values for sandy soils van genuchten mt and yates 1991 carsel and parrish 1988 rawls et al 1982 and were therefore assumed to be controlled by coarse textured soils at this site however fitted values of α were much smaller than the values reported for sandy soils indeed the fitted value of α 0 85 m 1 was much closer to the value reported for silt and clay van genuchten mt and yates 1991 carsel and parrish 1988 rawls et al 1982 and was therefore assumed to be controlled by fine textured silt and clay layers at this site in comparison to ks the fitted value of α exhibited much greater standard error coefficients table 1 this uncertainty likely reflects differences in the actual and simulated initial conditions soil heterogeneity and or the influence of hysteresis on hydraulic properties which were not accounted for this simulation fig 6 a compares the measured and simulated based on the drywell dimensions from the engineering design values of h w2 with respect to time at the fort irwin drywell site table s4 in comparison to the torrance drywell results fort irwin falling head data show a very slow decrease in h w2 with time during the experiment very good agreement between the observed and simulated falling head data was observed including the change in h w2 due to irrigation runoff 821 919 min the total mass balance error was very small 0 0098 and a high r 2 value of 0 96 was obtained between observed and simulated values table 1 presents the fitted hydraulic parameters a very small value of ks 2 25 10 6 m min 1 was obtained the fitted value for α was 2 63 m 1 fig 6 b compares the measured and simulated based on the drywell dimensions from onsite measurement values of h w2 with respect to time at the fort irwin drywell site very good agreement between the observed and simulated falling head data was observed with a total mass balance error of 0 01 and a high r 2 value of 0 95 table 1 presents the fitted parameters the fitted values of ks 3 07 10 6 m min 1 and the value of α 2 42 m 1 were very close to the ks and α values obtained by the previous engineering design dimensions simulation based on the soil log information this site contains 90 sandy clay which has a reported ks value in the range from 2 10 5 to 8 46 10 5 m min 1 van genuchten mt and yates 1991 carsel and parrish 1988 pachepsky and park 2015 this observation suggests that other factors e g clogging may have contributed to the fitted ks value for this site which is more than an order of magnitude lower than the default value for sandy clay loam in the hydrus soil catalog soil log information collected from the fort irwin site showed the presence of a sandy clay layer in a depth of 0 5 2 m a sandy loam layer in 5 2 7 6 m a sandy clay layer 7 6 20 7 m a sand layer in 20 7 21 6 m and a sandy clay layer in 21 6 33 m however the lateral extension of these highly permeable sand and sandy loam layers is not known and we assume that it must be very small based on the observed falling head data and the fitted ks value the fitted value of α falls in the range of reported values for sandy clay loam 2 7 m 1 van genuchten mt and yates 1991 carsel and parrish 1988 therefore the increased exposure of the fort irwin drywell to more sandy clay layers explains the value of α our results show that the new reservoir boundary condition implemented in the hydrus 2d 3d model is very flexible and can account for various drywell designs 4 3 predicted h and θ distributions figs 7 and s3 show simulated spatial h and θ distributions respectively in the model domain for the torrance and fort irwin drywell sites after 154 and 1481 min respectively a very significant change in h and θ occurs over a large area in the model domain for the torrance drywell site after 154 min in particular the wetting front reached 3 3 m in the vertical direction and 15 m in the lateral direction i e the maximum vertical and lateral extensions of the domain from the bottom point of the well in contrast spatial changes in h and θ occur over a much smaller region at the fort irwin drywell site after 1481 min the wetting front reached a depth of 1 m in the vertical direction and 1 19 m in the lateral direction 4 4 cumulative infiltration behavior at drywell sites additional simulations were conducted to better understand the cumulative infiltration behavior at drywell sites fig 8 shows cumulative infiltration at the torrance and fort irwin drywell sites when using calibrated unsaturated soil hydraulic parameters table 1 and time variable input boundary conditions from table s5 the total simulation time was 1100 min multiple filling and draining cycles using a hypothetical water inflow rate of 1 6 m3 min 1 were considered at the torrance site 5 of them table s5 whereas only a single cycle falling head was employed at the fort irwin site due to its much lower value of ks tables 1 and s5 fig 8 indicates that the torrance drywell manages to infiltrate 53 2 m3 of water within 1100 min the los angeles county low impact development standard for drywells indicates that there should be no standing water within 5760 min 4 days of a design rain event lacdpw 2014 a design rain event of 1 9 cm h 1 for one hour an average recurrence interval of 5 years atlas 2018 on 3 21 acres with a 90 impervious surface at the torrance site will contribute 205 m3 of water to 4 drywells present at this site or 51 3 m3 drywell lacdpw 2014 thus the torrance drywell site can easily infiltrate the expected incoming volume of water from a design rain event within the required time the fort irwin drywell can only infiltrate 12 6 m3 of water within 1100 min fig 8 this infiltrated water volume is much smaller than that for the torrance site even though the infiltration area and a ponding depth for the fort irwin drywell are much larger fig s1 a design rain event of 2 cm h 1 an average recurrence interval of 10 years atlas 2018 on 56 9 acres with a 44 impervious surface will contribute 3643 1 m3 to the fort irwin drywell a simple calculation using the simulated infiltration volume i e 12 6 m3 1100 min from fig 8 indicates that it will take 220 days to infiltrate this design rain event volume 3643 1m3 not surprisingly maintenance contractors at fort irwin have reported ponding at the drywell site for several months after a storm event personal communication this observation confirms that the drywell site has a very small hydraulic conductivity and the well is likely clogged and damaged a number of factors provide convincing evidence that clogging has significantly contributed to the low saturated hydraulic conductivity at the fort irwin site for example sediment and floating objects such as plastics and leaves entered the sediment chamber via the lid and passed through the open overflow pipe into the bottom well during the infiltration experiment which mimics a natural storm event the debris shield that goes on top of the overflow pipe was found on the upper sediment chamber floor at the start of the infiltration experiment fig s4 finally a comparison of the drywell dimensions using engineering design and our direct measurements shows that there is at least 1 2 m of sediment at the bottom of the upper sediment chamber reservoir 1 and the well reservoir 2 5 summary and conclusions field scale falling head and infiltration experiments were conducted at the torrance and fort irwin drywell locations these two drywells encompass very different characteristics the torrance drywell was much smaller in depth the soil was highly permeable the drywell was situated in an urban setting with mainly impervious surfaces covering the soil incoming water was pretreated via a stormwater filter and large sediment chamber and the drywell was routinely maintained and functioning according to design standards in contrast the fort irwin drywell was much larger the soil had low permeability and was likely clogged the drywell was situated in a rural setting and it received little or no maintenance and was not functioning within design specifications the hydrus 2d 3d model was modified to simulate the complex geometry of the drywell and a new reservoir boundary condition was implemented to account for time variable pressure heads and seepage faces in the drywell that are coupled with the vadose zone the modified hydrus 2d 3d code was run in an inverse mode to estimate the soil hydraulic properties for an equivalent uniform soil profile at the torrance and fort irwin drywell sites and to successfully simulate temporal changes in the infiltration behavior of two completely different drywells furthermore model simulations predicted the spatial and temporal behavior of subsurface water flow at these drywell sites additional information regarding different drywell sizes depths locations soil heterogeneity engineering designs and various contaminant and sediment loadings during individual storms and for a long term multiple years data series are important design considerations to evaluate the effectiveness of drywells in comparison other infiltration systems future research activities will therefore focus on infiltration from a drywell in heterogeneous soil systems changes in water quality during transport through the vadose zone the impact of infiltrated water on groundwater quantity and quality identification of conditions that pose a risk of clogging a potential reduction in the infiltration capacity and a reduction in overall drywell performance and designs that improve the long term management and sustainability of drywell injection competing financial interest none acknowledgment funding for this research was provided by the u s environmental protection agency us epa through an interagency agreement with the united states department of agriculture epa dw 012 92465401 ars 60 2022 7 002 the views expressed in this article are those of the authors and do not necessarily represent the views or policies of the u s environmental protection agency mention of commercial products does not constitute an endorsement the data supporting the conclusions can be obtained in the tables and the figures available in the supporting information supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 003 appendix supplementary materials image application 1 image application 2 
818,drywells are increasingly used for stormwater management and enhanced aquifer recharge but only limited research has quantitatively determined the performance of drywells numerical and field scale experiments were therefore conducted to improve our understanding and ability to characterize the drywell behavior in particular hydrus 2d 3d was modified to simulate transient head boundary conditions for the complex geometry of the maxwell type iv drywell i e a sediment chamber an overflow pipe and the variable geometry and storage of the drywell system with depth falling head infiltration experiments were conducted on drywells located at the national training center in fort irwin california ca and a commercial complex in torrance ca to determine in situ soil hydraulic properties the saturated hydraulic conductivity ks and the retention curve shape parameter α for an equivalent uniform soil profile by inverse parameter optimization a good agreement between the observed and simulated water heights in wells was obtained for both sites as indicated by the coefficient of determination 0 95 0 99 unique parameter fits and small standard errors fort irwin and torrance drywells had very distinctive soil hydraulic characteristics the fitted value of ks 1 01 10 3 m min 1 at the torrance drywell was consistent with the sandy soil texture at this site and the default value for sand in the hydrus soil catalog the drywell with this ks 1 01 10 3 m min 1 could easily infiltrate predicted surface runoff from a design rain event 51 3 m3 within 5760 min 4 d in contrast the fitted value of ks 2 25 10 6 m min 1 at fort irwin was very low compared to the torrance drywell and more than an order of magnitude smaller than the default value reported in the hydrus soil catalog for sandy clay loam at this site likely due to clogging these experiments and simulations provide useful information to characterize effective soil hydraulic properties in situ and to improve the design of drywells for enhanced recharge graphical abstarct image graphical abstract keywords drywell hydrus 2d 3d falling head inverse simulation hydraulic properties in situ 1 introduction water has a strong influence on food and energy production industrial and agriculture output and population and economic growth of nations gleick 1993 shannon et al 2008 the availability of high quality water resources is rapidly decreasing especially in arid and semi arid regions of the world due to the demographic shift and the subsequent increase in demand and overuse of freshwater and contamination of aquifers and lakes shannon et al 2008 koehler 2008 climate variability has further increased the vulnerability of water resources and it is estimated that around 5 billion people will be living in countries under water stress by 2025 treidel et al 2011 vorosmarty et al 2000 arnell 1999 in addition urban development with paved and impermeable surfaces has had a profound impact on the hydrologic cycle by altering drainage patterns reducing infiltration and water storage and increasing the volume of surface runoff dunne and leopold 1978 mount 1995 this can contribute to a decline in natural groundwater recharge long term and short term drought an increase in water pollution levels and flooding caused by surface runoff weng 2001 arnold and gibbons 1996 many arid and semi arid urban regions of the world face serious challenges in maintaining water quality and quantity to meet its growing population demand for example around 60 of the water supply in southern california is imported from the colorado river basin and northern california and the rest is withdrawn from its local aquifers freeman 2008 even though los angeles la county collects stormwater runoff from its urban surfaces and uses it for artificial recharge more than 680 mm3 of its urban runoff equivalent to half of its imported water reaches the ocean annually dwr 2009 however local groundwater basins in la county have more than 1480 mm3 of unused storage capacity that could be used to store this untapped freshwater resource furthermore capturing and recharging stormwater into the aquifers will reduce la county s dependence on imported water energy needs for pumping and improve its management of flooding and contaminant loads from surface runoff dallman and spongberg 2012 mwd 2007 davis and mccuen 2005 consequently implementation of management practices to capture stormwater and enhance its recharge into aquifers can have a large influence on many water quality and quantity aspects lacdpw 2014 engineering systems which manage surface water and infiltrate it into aquifers are classified as surface vadose zone and direct injection infiltration systems bouwer 2002 edwards et al 2016 surface infiltration systems e g infiltration basins detention basins vegetated swales and managed aquifer recharge ponds place stormwater directly on the ground surface they require highly permeable sediment and a large surface area for rapid infiltration to occur but can lose water due to evapotranspiration bouwer 2002 most of the surface area of vadose zone infiltration systems e g recharge trenches and drywells extends either vertically or horizontally under the ground surface bouwer 2002 dillon and pavelic 1996 injection wells e g managed aquifer recharge are used to transmit water directly into aquifers bouwer 2002 dillon 2005 both injection and vadose zone infiltration systems have no or only minimal evapotranspiration losses do not require large installation area and may employ large water ponding depths to facilitate rapid infiltration these various engineering systems also offer different potentials for reactive contamination transport and attenuation in the vadose zone direct injection wells provide no chance for contaminant attenuation in the vadose zone bouwer 2002 whereas vadose zone and especially surface infiltration systems provide opportunities of contaminant removal in the vadose zone bouwer 2002 edwards et al 2016 dillon and pavelic 1996 only vadose zone infiltration systems offer potential advantages of minimal evapotranspiration small installation area large ponding depths and vadose zone treatment one vadose zone infiltration system that has gained a lot of recent attention in the united states and around the world is a drywell drywells are subsurface storage facilities that receive temporarily store and infiltrate stormwater into the vadose zone edwards et al 2016 modern drywell designs include a fully permeable well that is located above the water table and may have pretreatment systems such as single double sedimentation chambers to remove sediments and sponges to adsorb hydrocarbons in stormwater edwards et al 2016 in addition to the advantages noted above drywells are also popular because they have a relatively low installation and maintenance cost in comparison to other engineered infiltration systems however drywells are not well suited for areas with low permeability soils high water tables steep slopes or contaminated soils landfills and industrial complexes due to the potential risks of groundwater pollution lacdpw 2014 furthermore drywell failure may occur due to clogging if pretreatments are inadequate or in situ clays are mobilized in this case a complete reconstruction or a new drywell may be required limited published research has examined the performance of drywells edwards et al 2016 jurgens et al 2008 izuka 2011 snyder et al 1994 reported on a drywell recharge study in the portland basin in oregon usa and found that 5700 drywells in urban areas contributed 38 of the total recharge to groundwater within the basin wilson et al 1990 analyzed the impact of drywells on recharge groundwater pollution and urban runoff at three sites in arizona results indicated that recharge from drywells created a transmission zone for water movement with minimal impacts on groundwater quality in contrast field and numerical modeling studies in washington and arizona usa demonstrated that pollutant attenuation was related to the soil particle size and recommended that drywells be located in soil profiles with a clay layer to enhance contaminant adsorption adolfson associates 1995 bandeen 1984 the above considerations suggest that even if previous results are encouraging more research is needed to better understand the impact of drywells on groundwater recharge and quality knowledge of the soil profile hydraulic properties is essential for the successful design execution and long term operation of a potential drywell location bandeen 1987 simulated the variably saturated subsurface flow from a drywell using an axísymmetric flow domain and the galerkin finite element method that was implemented in the unsat2 program water flow from the drywell was represented as a gravel filled borehole the soil hydraulic properties were determined from a constant borehole infiltration test and empirical formula bandeen 1984 bandeen 1987 however existing numerical models have not yet accurately represented the complex geometry of modern drywell designs like maxwell type iv torrent resources which includes an upper sedimentation chamber an overflow pipe and a bottom chamber packed with gravel that determine the total volume and the maximum head of the drywell consequently these models will not accurately simulate the filling and falling head cycle within a modern drywell subsequent infiltration into the vadose zone and determination of the effective soil hydraulic properties via inverse optimization to our knowledge there is no existing literature or numerical modeling on determining average soil hydraulic properties using the inverse optimization of field scale falling head data in a modern drywell system the main objective of this study was to improve our understanding and ability to characterize the drywell behavior by conducting systematic numerical and field scale experiments the hydrus 2d 3d computer software was modified to simulate transient head boundary conditions for the complex geometry of a modern drywell i e a sediment chamber an overflow pipe and the variable geometry and storage of the drywell system with depth falling head experiments were conducted at drywells maxwell iv model torrents resources arizona usa located in the national training center in fort irwin california and a commercial complex in torrance california the effective soil hydraulic parameters with the saturated hydraulic conductivity ks and the retention curve shape parameter α for an equivalent uniform soil system representative of both sites were determined by inverse parameter optimization of the observed falling head data comparison of the fitted ks and α parameters from these two distinctive sites provide useful information to characterize and improve the design of the drywells 2 materials and methods 2 1 field sites the drywell in the first study june 2017 is situated at the sleepy hollow military housing within the fort irwin national training center ntc in the mojave desert california ca fig 1 a the fort irwin base climate is typical of the mojave desert with low precipitation hot summers and cool winters densmore and londquist 1997 it has an annual precipitation of roughly 0 13 mm summer monsoon thunderstorms may bring heavy intensity and depth rainfall over a small area which can cause localized flooding higdon 2004 hubbard 2013 the ntc receives its water from local aquifers including the irwin basin that is underneath the cantonment area the army net zero water program has a long term goal to balance water pumping with aquifer recharge a drywell was installed on a portion of the cantonment area of fort irwin adjacent to four softball fields referred to as the four plex site see fig 1 a in 2007 urban runoff generated from housing developments upstream of the four plex site is directed into a detention pond where the drywell is located the drywell in the second study september 2017 is situated in a commercial complex in torrance the los angeles county california fig 1 b the tested drywell was part of a four drywell system installed in may 2013 at this site as a standard urban stormwater mitigation plan requirement susmp the susmp was developed as part of the municipal stormwater program to address stormwater pollution from development projects la stromwater 2000 the site drainage area is about 3 21 acres with 90 impervious surface and the drywell receives pre treated stormfilter contech engineered solutions water from subsurface piping dejong 2017 2 2 drywell engineering design the maxwell iv model torrents resources phoenix arizona usa drywell was installed at fort irwin and torrance figs s1a and s1b show the engineering designs for the fort irwin and torrance drywells respectively the fort irwin and torrance drywells receive inflow water into an upper sediment chamber through a grated opening on top and subsurface detention pipes respectively this upper sediment chamber has an impermeable chamber side a concrete base seal and a floating hydrocarbon capture pillow which removes a wide range of hydrocarbons silt sediment and debris settle out of the water by gravity inside the upper chamber incoming water rises inside the upper sediment chamber and then enters an overflow intake pipe which is connected to a lower chamber the overflow inlet is equipped with a debris screen which blocks the passage of suspended matter and other floating debris water from the overflow pipe enters a lower chamber which is filled with clean rocks 0 9 3 8 cm the entire gravel pack is surrounded by a fully permeable needle punched non woven geotextile polypropylene or polyester fabric sleeve to prevent the migration of fines into the gravel pack water in the gravel pack infiltrates into the vadose zone soil envelope and eventually recharges groundwater aquifers torrentresources 2012 2 3 falling head infiltration experiment a fire hydrant was used to flood the detention pond to fill the fort irwin drywell a vacuum pump truck was used to remove excess water from the detention pond until the water level just reached the top of the grate covering the entrance to the drywell the detention pond was partially filled for 163 min at this point a calibrated pressure transducer decagon ctd 10 sensor 40683 usa was lowered into the bottom of the upper sediment chamber and used to measure the water depth in the drywell every minute with an accuracy of 0 05 and resolution of 2 mm this pressure transducer was connected to a data logger decagon em50 series and then to a laptop computer via a usb cable when the water level reached the inlet of the overflow pipe at 60 min the pressure transducer was moved into the overflow pipe and lowered to a depth of 10 m from the surface and the water level was monitored for 1098 min according to the engineering design the sediment chamber wall the bottom section of the concrete liner with a small number of side perforations and the base solid concrete slurry are impermeable and should thus allow infiltration at a much smaller rate than the bottom of the well however we observed that the entire drywell system i e the sedimentation chamber and the well bottom acted like a single system and drained at the same rate this indicates that the base concrete slurry seal might have broken and allowed water to flow directly into the bottom chamber the final water level measurement was taken at 1481 min using a model 102 water level meter solinst canada ltd canada with a resolution of 1 mm solinst 2017 a small amount of water was released into the drywell during the night hours from sprinkler irrigation runoff and the resultant change in pressure head was recorded by the pressure transducer table s4 a calibrated pressure transducer decagon ctd 10 sensor 40683 usa was placed at the bottom of the torrance ca drywell via the overflow pipe the experiment was conducted in three phases in phase i 0 74 min a fire hydrant outlet that was connected directly to the upper sediment chamber was used to fill this shallow drywell system 0 7 min only 10 67 m depth in a controlled manner falling head measurements 7 74 min were recorded using the pressure transducer every minute and a datalogger decagon em50 series until the water level in the well reached a steady state in phase ii 75 98 min a constant head test was conducted by refilling the drywell and then maintaining the head by adjusting the inflow using a flowmeter connected to the fire hydrant outlet in phase iii 99 154 min the drywell was completely refilled and a second falling head test was conducted table s4 during our site visits we have measured the dimensions of the fort irwin and torrance drywells and this information is given in figs s1a and s1b 3 numerical modeling the hydrus 2d 3d software package is a finite element model for simulating the two or three dimensional movement of water heat and multiple solutes in variably saturated media simunek et al 2016 water flow is described in hydrus 2d 3d using the richards equation 1 θ t x i k k i j a h x j k i z a where θ l3 l 3 dimensionless l denotes units of length is the volumetric water content h l is the pressure head xi i 1 2 l are spatial coordinates t t t is unit of time is time k i j a are components of a dimensionless hydraulic conductivity anisotropy tensor ka and k l t 1 is the unsaturated hydraulic conductivity function given as the product of the relative kr and saturated hydraulic conductivity ks l t 1 the unsaturated soil hydraulic conductivity k h and water retention θ h functions are needed to solve eq 1 the unsaturated soil hydraulic property models of van genuchten 1980 and mualem 1976 were employed for this purpose 2 θ h θ r θ s θ r 1 α h n m h 0 3 θ h θ s h 0 4 k h k s s e l 1 1 s e 1 2 m 2 where θ r and θ s l3l3 denotes the residual and saturated water contents respectively α l 1 is the shape parameter in the soil water retention function l is the pore connectivity parameter and n and m 1 1 n are empirical parameters related to the pore size distribution the effective saturation se is defined as 5 s e θ h θ r θ s θ r fig 2 presents a schematic of the simulation domain boundary conditions and initial conditions that were considered for the fort irwin and torrance drywell sites a 2 dimensional axisymmetrical flow domain was employed in both cases the fort irwin site geometry had a 3 m width and a 35 m depth whereas the torrance site had a 5 m width and a 15 m depth the specified radial dimensions were chosen to best capture the infiltration radius of the drywell based on the soil log information and the vertical dimensions were chosen based on the depth of the drywell a no flux boundary condition was assigned to the upper boundary the nodes representing the right and lower left the boundary between the drywell and the bottom boundary sides of the flow domain were set to no flux boundaries the nodes at the bottom boundary z 35 m and z 15 m for the fort irwin and torrance drywell simulations respectively were assigned a free drainage boundary condition because the groundwater table was deep and below the bottom of the transport domain along the left at z 2 to 29 4 for fort irwin and z 7 36 to 11 2 for torrance and bottom boundary a reservoir boundary condition was specified to allow for a seepage face šimůnek et al 2018 for this boundary condition parts of the boundary that are below and above the water level in the well are internally assigned time variable pressure head dirichlet and seepage face boundary conditions respectively hydrus 2d 3d calculates which part of the seepage face boundary is active with prescribed zero pressure head and which is inactive with prescribed zero flux depending on whether the boundary nodes are saturated or unsaturated respectively šimůnek et al 2018 details pertaining to this so called reservoir boundary condition are provided in the next section the water table at the fort irwin and torrance study site is at approximately 61 and 21 m below the soil surface respectively hence the distance between the bottom of the drywell and the water table is approximately 34 and 10 m for the fort irwin and torrance drywells respectively therefore the soil moisture is uniform throughout the domain the capillary fringe is well below the bottom of the well and the soil domain surrounding the drywell installation is an unsaturated zone hence the initial condition was specified in terms of the soil water pressure head h x z and was set to a constant pressure head of 0 5 m for the entire domain fig 2 the simulation domain was discretized into two dimensional triangular finite element mesh using the meshgen tool available within the hydrus 2d 3d the mesh was refined at the left part of the domain where infiltration from the drywell was simulated to reduce the mass balance error the finite element grid was adjusted such that the size of elements was smaller 0 05 m near the well where large water fluxes were expected the grid size was gradually increased with a radial distance from the drywell with a maximum element size of 0 75 m and 0 5 m for the fort irwin and torrance domain respectively the quality of the finite element mesh was assessed by checking the mass balance error reported by hydrus 2d 3d at the end of the simulation mass balance errors were always below 1 and these values are generally considered acceptable brunetti et al 2017 hydrus 2d 3d includes a parameter estimation procedure based on the levenberg marquardt nonlinear least squares optimization method marquardt 1963 this procedure was employed to estimate several unknown parameters in the unsaturated soil hydraulic functions from measurements of the total water height in the drywells over time by the numerical inversion of the richards equation in the absence of detailed information on soil profile heterogeneity e g the soil log does not provide information about the lateral extension of layers only effective soil hydraulic parameters were obtained for an equivalent uniform soil profile in particular the values of α and ks were determined for the homogeneous soil profile by inverse optimization other soil hydraulic parameters n l θ r and θ s were set equal to default values from the hydrus soil catalog for homogeneous sandy clay loam at the fort irwin site and sand at the torrance site table 1 these soil textural classes were chosen based on available soil log information from these sites additional research is needed to fully characterize hysteretic hydraulic properties for the heterogeneous soil profiles but this is beyond the scope of this study 3 1 reservoir boundary condition the drywell has a very complex geometry with multiple compartments to accurately determine the ponded water height and water flux in the drywell during filling and drainage cycles the drywell geometry was subdivided into 6 different reservoirs fig 3 a and b for fort irwin and torrance respectively reservoirs 1 5 mimic the drywell design figs s1a and s1b whereas reservoir 6 is used to account for external ponding geometry parameters for these reservoirs are read into the modified version of hydrus from an input file well in cross sectional areas and volumes for each reservoir are subsequently calculated from this information and are provided in tables s1 s2 and s3 it should be mentioned that the design of drywells at torrance and fort irwin is somewhat different for example the sedimentation chamber is much bigger at torrance 6 9 m than at fort irwin 4 6 m and reservoir 2 is much bigger at fort irwin 22 2 m than at torrance 3 2 m furthermore at torrance the gravel pack surrounding the upper sediment chamber was replaced by an impermeable concrete slurry fig s1b that does not contribute to the volume of reservoirs 4 and 5 a zero porosity was assigned to this shaded region in fig 3 b in contrast to the fort irwin drywell s engineering design we observed that the upper sedimentation chamber had 1 m thick layer of sediments and the entire drywell system acted like a single system and drained at the same rate therefore additional numerical simulations were conducted by employing the well dimensions obtained from site measurements tables s2 and s4 fig 3 indicates that the drywell was subdivided into two main domains domain 1 comprises reservoirs 1 4 5 and 6 whereas domain 2 consists of reservoirs 2 3 4 5 and 6 the drywell fills from reservoir 1 to 6 drainage from reservoir 1 was not considered since its bottom is covered with an impermeable concrete slurry drainage from domain 2 occurs in the reverse sequence to filling e g reservoirs 6 5 4 3 and 2 the total water levels a sum of water levels from reservoirs in domains 1 and 2 denoted as h w1 and h w2 determine which reservoir is actively filling or draining logical statements in conjunction with well geometry information were used to determine which reservoir was active at any given time the initial values of h w1 and h w2 at the beginning of the simulation h w1 and h w2 respectively and the water inflow as a function of time qin t l3 t 1 are also input parameters in the well in file the change in the water volume within an active reservoir with respect to time can be calculated using the following mass balance condition 6 d v w i d t a i d h w i d t q i n t q o u t t where vwi l3 is the volume of water in the reservoir ai l2 is the cross sectional area of the reservoir hwi l is the water level in the reservoir qout t l3 t 1 is the total water outflow to the soil surrounding the drywell and the subscript i indicates the reservoir number in its finite difference discretization eq 6 becomes 7 h w i j 1 h w i j δ t a i q i n q o u t where δt t is the time step and h w i j 1 l and h w i j l are water levels in the reservoir at current and previous time steps respectively eq 7 is used to determine the water level in an active reservoir at the current time step the values of h w1 and h w2 are updated based on this information and the boundary conditions in the hydrus domain are dynamically adjusted values of qout used for the next time step and the total drywell water volume are subsequently calculated in hydrus and printed to new output text files well out and wellvolume out respectively the value of h w1 and h w2 and the time variable boundary conditions used in the inverse simulation for the fort irwin and torrance drywells are given in table s4 in addition numerical experiments were conducted with hypothetical conditions the first experiments were conducted to understand the dynamics of the drywell and the functioning of the new reservoir boundary condition in this case simulations for a complete filling and drainage cycle were conducted for the fort irwin drywell geometry an engineering design over 100 000 min figs 4 and s2 table s5 other simulations were conducted to compare the cumulative infiltration volume between the fort irwin and torrance drywells over 1100 min for a complete drainage cycle and multiple filling and drainage cycles respectively fig 8 the time variable boundary conditions used in these experiments are given in table s5 4 results and discussion 4 1 dynamics of a drywell the functioning of the newly developed drywell reservoir boundary condition module and its coupling with the hydrus 2d 3d model during one complete filling and drainage cycle was evaluated using the fort irwin drywell geometry a time variable boundary condition was employed in the simulation as follows hypothetical water inflow was 0 23 m3 min 1 for 0 to 100 min and 0 m3 min 1 for 100 10 000 min table s5 fig 4 a shows the change in h w1 and h w2 fig 4 b shows the sequence of filling and draining of reservoirs 1 6 and the corresponding change in the total water volume in the drywell system vwell these figures show that vwell increased as the injection continued at a slow pace until reservoirs 1 through 6 were full at the beginning of the simulation the water volume in reservoir 1 v 1 as well as the corresponding value of h w1 increased until it reached the maximum volume of 3 185 m3 during the next stage water overflowed through the overflow pipe fig s1 and filled sequentially reservoirs 2 and 3 v 2 and v 3 while h w1 stayed constant and h w2 increased in the next phase reservoirs 4 5 and 6 v 4 v 5 and v 6 were filled and the corresponding water levels h w1 and h w2 increased once all 6 reservoirs were full they started draining in the order of v 6 v 5 v 4 v 3 and v 2 fig 4 b and the corresponding water levels h w1 and h w2 decreased with time fig 4 a note that we do not consider draining of v 1 since the sedimentary chamber is surrounded by an impermeable wall and a base seal concrete slurry fig 4 shows that vwell h w1 and h w2 increased and reached the maximum during the filling cycle and then started decreasing to a constant value of v 1 and h w1 whereas h w2 went down to zero during the draining cycle figures s2a in a normal scale and s2b in a log scale present the change in the well water volume cumulative infiltration and the mass balance for the well water volume during one complete filling injection and emptying infiltration falling head cycle for the entire drywell 4 2 inverse estimation of soil hydraulic properties fig 5 shows the observed and inversely simulated values of h w2 over time at the torrance site fig 5 a d consider phases i initial filling of the entire drywell and then draining of reservoirs 5 4 3 and 2 ii refilling of the drywell and the constant head test iii refilling of the entire drywell and then draining of reservoirs 5 4 3 and 2 and the entire experiment phases i ii and iii respectively a sudden decrease in h w2 occurs during draining of reservoir 4 during phases i and iii because it holds a very small volume of water 0 1 m3 compared to the other reservoirs fig 3 b and table s1 table 1 shows the corresponding fitted values of ks and α the standard error coefficient 95 upper and lower confidence interval limits the coefficient of determination r 2 and the mass balance errors for each simulation period fig 5 and the table 1 show a very good agreement between the observed and simulated values with r 2 values of 0 96 0 99 and the mass balance error less than 0 3 based on these simulations the value of α ranged from 0 52 2 80 m 1 and the value of ks ranged from 1 01 10 3 1 89 10 3 m min 1 table 1 shows that all fitted parameters were unique with a very small standard error and a narrow 95 confidence interval during the simulation for each phase the initial condition was imported from the last time step of the previous phase and the observed difference in the fitted ks and α value can be suggested by the variations in the initial condition pressure head this result shows that conducting multiple filling and drainage cycle experiment will help for the accurate estimation of effective hydraulic properties in addition we acknowledge that there is a slight deviation in the slope at phase i and phase iii during emptying of reservoir 2 we have tried our best to incorporate the engineering design and onsite measurements to describe the drywell s geometry however we believe that this discrepancy in the simulated value of h w2 is due to variations in the volume of the actual well e g slight variations in the well geometry and or the porosity of the packing material soil log information collected from 4 drywells at the torrance site showed the presence of a silty clay layer in a depth of 0 7 m a silty sand layer in 4 87 9 7 m a sand layer in 5 4 11 6 m and a silty sand layer in 10 1 14 93 m however the lateral continuity of these layers is not known fitted values of high ks were consistent with previously reported values for sandy soils van genuchten mt and yates 1991 carsel and parrish 1988 rawls et al 1982 and were therefore assumed to be controlled by coarse textured soils at this site however fitted values of α were much smaller than the values reported for sandy soils indeed the fitted value of α 0 85 m 1 was much closer to the value reported for silt and clay van genuchten mt and yates 1991 carsel and parrish 1988 rawls et al 1982 and was therefore assumed to be controlled by fine textured silt and clay layers at this site in comparison to ks the fitted value of α exhibited much greater standard error coefficients table 1 this uncertainty likely reflects differences in the actual and simulated initial conditions soil heterogeneity and or the influence of hysteresis on hydraulic properties which were not accounted for this simulation fig 6 a compares the measured and simulated based on the drywell dimensions from the engineering design values of h w2 with respect to time at the fort irwin drywell site table s4 in comparison to the torrance drywell results fort irwin falling head data show a very slow decrease in h w2 with time during the experiment very good agreement between the observed and simulated falling head data was observed including the change in h w2 due to irrigation runoff 821 919 min the total mass balance error was very small 0 0098 and a high r 2 value of 0 96 was obtained between observed and simulated values table 1 presents the fitted hydraulic parameters a very small value of ks 2 25 10 6 m min 1 was obtained the fitted value for α was 2 63 m 1 fig 6 b compares the measured and simulated based on the drywell dimensions from onsite measurement values of h w2 with respect to time at the fort irwin drywell site very good agreement between the observed and simulated falling head data was observed with a total mass balance error of 0 01 and a high r 2 value of 0 95 table 1 presents the fitted parameters the fitted values of ks 3 07 10 6 m min 1 and the value of α 2 42 m 1 were very close to the ks and α values obtained by the previous engineering design dimensions simulation based on the soil log information this site contains 90 sandy clay which has a reported ks value in the range from 2 10 5 to 8 46 10 5 m min 1 van genuchten mt and yates 1991 carsel and parrish 1988 pachepsky and park 2015 this observation suggests that other factors e g clogging may have contributed to the fitted ks value for this site which is more than an order of magnitude lower than the default value for sandy clay loam in the hydrus soil catalog soil log information collected from the fort irwin site showed the presence of a sandy clay layer in a depth of 0 5 2 m a sandy loam layer in 5 2 7 6 m a sandy clay layer 7 6 20 7 m a sand layer in 20 7 21 6 m and a sandy clay layer in 21 6 33 m however the lateral extension of these highly permeable sand and sandy loam layers is not known and we assume that it must be very small based on the observed falling head data and the fitted ks value the fitted value of α falls in the range of reported values for sandy clay loam 2 7 m 1 van genuchten mt and yates 1991 carsel and parrish 1988 therefore the increased exposure of the fort irwin drywell to more sandy clay layers explains the value of α our results show that the new reservoir boundary condition implemented in the hydrus 2d 3d model is very flexible and can account for various drywell designs 4 3 predicted h and θ distributions figs 7 and s3 show simulated spatial h and θ distributions respectively in the model domain for the torrance and fort irwin drywell sites after 154 and 1481 min respectively a very significant change in h and θ occurs over a large area in the model domain for the torrance drywell site after 154 min in particular the wetting front reached 3 3 m in the vertical direction and 15 m in the lateral direction i e the maximum vertical and lateral extensions of the domain from the bottom point of the well in contrast spatial changes in h and θ occur over a much smaller region at the fort irwin drywell site after 1481 min the wetting front reached a depth of 1 m in the vertical direction and 1 19 m in the lateral direction 4 4 cumulative infiltration behavior at drywell sites additional simulations were conducted to better understand the cumulative infiltration behavior at drywell sites fig 8 shows cumulative infiltration at the torrance and fort irwin drywell sites when using calibrated unsaturated soil hydraulic parameters table 1 and time variable input boundary conditions from table s5 the total simulation time was 1100 min multiple filling and draining cycles using a hypothetical water inflow rate of 1 6 m3 min 1 were considered at the torrance site 5 of them table s5 whereas only a single cycle falling head was employed at the fort irwin site due to its much lower value of ks tables 1 and s5 fig 8 indicates that the torrance drywell manages to infiltrate 53 2 m3 of water within 1100 min the los angeles county low impact development standard for drywells indicates that there should be no standing water within 5760 min 4 days of a design rain event lacdpw 2014 a design rain event of 1 9 cm h 1 for one hour an average recurrence interval of 5 years atlas 2018 on 3 21 acres with a 90 impervious surface at the torrance site will contribute 205 m3 of water to 4 drywells present at this site or 51 3 m3 drywell lacdpw 2014 thus the torrance drywell site can easily infiltrate the expected incoming volume of water from a design rain event within the required time the fort irwin drywell can only infiltrate 12 6 m3 of water within 1100 min fig 8 this infiltrated water volume is much smaller than that for the torrance site even though the infiltration area and a ponding depth for the fort irwin drywell are much larger fig s1 a design rain event of 2 cm h 1 an average recurrence interval of 10 years atlas 2018 on 56 9 acres with a 44 impervious surface will contribute 3643 1 m3 to the fort irwin drywell a simple calculation using the simulated infiltration volume i e 12 6 m3 1100 min from fig 8 indicates that it will take 220 days to infiltrate this design rain event volume 3643 1m3 not surprisingly maintenance contractors at fort irwin have reported ponding at the drywell site for several months after a storm event personal communication this observation confirms that the drywell site has a very small hydraulic conductivity and the well is likely clogged and damaged a number of factors provide convincing evidence that clogging has significantly contributed to the low saturated hydraulic conductivity at the fort irwin site for example sediment and floating objects such as plastics and leaves entered the sediment chamber via the lid and passed through the open overflow pipe into the bottom well during the infiltration experiment which mimics a natural storm event the debris shield that goes on top of the overflow pipe was found on the upper sediment chamber floor at the start of the infiltration experiment fig s4 finally a comparison of the drywell dimensions using engineering design and our direct measurements shows that there is at least 1 2 m of sediment at the bottom of the upper sediment chamber reservoir 1 and the well reservoir 2 5 summary and conclusions field scale falling head and infiltration experiments were conducted at the torrance and fort irwin drywell locations these two drywells encompass very different characteristics the torrance drywell was much smaller in depth the soil was highly permeable the drywell was situated in an urban setting with mainly impervious surfaces covering the soil incoming water was pretreated via a stormwater filter and large sediment chamber and the drywell was routinely maintained and functioning according to design standards in contrast the fort irwin drywell was much larger the soil had low permeability and was likely clogged the drywell was situated in a rural setting and it received little or no maintenance and was not functioning within design specifications the hydrus 2d 3d model was modified to simulate the complex geometry of the drywell and a new reservoir boundary condition was implemented to account for time variable pressure heads and seepage faces in the drywell that are coupled with the vadose zone the modified hydrus 2d 3d code was run in an inverse mode to estimate the soil hydraulic properties for an equivalent uniform soil profile at the torrance and fort irwin drywell sites and to successfully simulate temporal changes in the infiltration behavior of two completely different drywells furthermore model simulations predicted the spatial and temporal behavior of subsurface water flow at these drywell sites additional information regarding different drywell sizes depths locations soil heterogeneity engineering designs and various contaminant and sediment loadings during individual storms and for a long term multiple years data series are important design considerations to evaluate the effectiveness of drywells in comparison other infiltration systems future research activities will therefore focus on infiltration from a drywell in heterogeneous soil systems changes in water quality during transport through the vadose zone the impact of infiltrated water on groundwater quantity and quality identification of conditions that pose a risk of clogging a potential reduction in the infiltration capacity and a reduction in overall drywell performance and designs that improve the long term management and sustainability of drywell injection competing financial interest none acknowledgment funding for this research was provided by the u s environmental protection agency us epa through an interagency agreement with the united states department of agriculture epa dw 012 92465401 ars 60 2022 7 002 the views expressed in this article are those of the authors and do not necessarily represent the views or policies of the u s environmental protection agency mention of commercial products does not constitute an endorsement the data supporting the conclusions can be obtained in the tables and the figures available in the supporting information supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 04 003 appendix supplementary materials image application 1 image application 2 
819,bayesian solutions to geophysical and hydrological inverse problems are dependent upon a forward model linking subsurface physical properties to measured data which is typically assumed to be perfectly known in the inversion procedure however to make the stochastic solution of the inverse problem computationally tractable using methods such as markov chain monte carlo mcmc fast approximations of the forward model are commonly employed this gives rise to model error which has the potential to significantly bias posterior statistics if not properly accounted for here we present a new methodology for dealing with the model error arising from the use of approximate forward solvers in bayesian solutions to hydrogeophysical inverse problems our approach is geared towards the common case where this error cannot be i effectively characterized through some parametric statistical distribution or ii estimated by interpolating between a small number of computed model error realizations to this end we focus on identification and removal of the model error component of the residual during mcmc using a projection based approach whereby the orthogonal basis employed for the projection is derived in each iteration from the k nearest neighboring entries in a model error dictionary the latter is constructed during the inversion and grows at a specified rate as the iterations proceed we demonstrate the performance of our technique on the inversion of synthetic crosshole ground penetrating radar travel time data considering three different subsurface parameterizations of varying complexity synthetic data are generated using the eikonal equation whereas a straight ray forward model is assumed for their inversion in each case our developed approach enables us to remove posterior bias and obtain a more realistic characterization of uncertainty keywords model error bayesian inference mcmc proxy model 1 introduction bayesian inversion of hydrological and geophysical data using markov chain monte carlo mcmc methods has become increasingly popular over the past decade key advantages of this approach are that i it allows for more comprehensive quantification of posterior parameter uncertainty when compared to traditional linearized uncertainty estimates ii it is extremely flexible in the sense that any information that can be expressed probabilistically e g model prior information data measurement errors can be incorporated into the inverse problem and iii it provides a natural framework within which to perform data integration the bayesian mcmc approach does however have the notable disadvantage of being limited by its high computational cost which results from the typically large numbers of model parameters in geophysical and hydrological problems combined with the need for small model perturbations along the markov chain in order to ensure reasonable rates of proposal acceptance that is millions of forward model runs are commonly required to obtain meaningful posterior statistics which is computationally prohibitive for many real world applications e g ruggeri et al 2015 a variety of techniques exist for reducing the computational load of bayesian mcmc inversions recent algorithmic developments for mcmc methods which take advantage of parallel architectures and incorporate chain history and posterior gradient information into the proposal distribution have been shown to significantly improve computational efficiency past the standard metropolis hastings approach e g haario et al 2001 marshall and roberts 2012 neal 2011 sambridge 2013 stuart et al 2004 vrugt 2016 model reduction through the use of basis functions that exploit the spatial correlation naturally present in subsurface properties e g davis and li 2011 jafarpour et al 2009 linde and vrugt 2013 oware et al 2013 can also be performed to reduce the dimensionality and thus the numerical complexity of the inverse problem yet another means of reducing the computational load of bayesian mcmc inversions and arguably the most intuitive and commonly employed approach is to use a fast approximation of the forward solver in place of the slower full numerical solution this can be accomplished via simplification of the physics of the problem e g josset et al 2015b scholer et al 2012 reduction of the numerical accuracy of the solution by coarsening the model discretization e g arridge et al 2006 calvetti et al 2014 or the construction of response surface proxies based on for example polynomial chaos expansion artificial neural networks or gaussian processes e g goh et al 2013 khu and werner 2003 marzouk and xiu 2009 rasmussen and williams 2006 while the use of approximate forward solvers in this manner can be highly effective it can lead to strongly biased and overconfident posterior statistics if the discrepancies between the approximate and detailed solutions are not taken into account e g brynjarsdóttir and o hagan 2014 indeed such model errors have the potential to overwhelm the effects of data measurement uncertainties and may have a controlling influence on posterior inference despite this fact the issue of model error has been largely ignored in the vast majority of geophysical and hydrological studies to date where bayesian mcmc methods have been employed in recent years a number of techniques have appeared in the scientific and engineering literature to address the model error problem thus allowing for more effective use of approximate forward solvers in bayesian stochastic inversions one popular avenue of research focuses on the overall or global statistical characterization of these errors whereby a small number of stochastic model error realizations generated by running the approximate and detailed forward solvers on random parameter sets drawn from the prior distribution are used to develop likelihood functions that better reflect the combined nature of all error sources to this end by far the most straightforward and common approach is to assume that the model errors are gaussian distributed and thus characterized by some mean vector and covariance matrix both of which are estimated from the realizations e g arridge et al 2006 hansen et al 2014 kaipio and somersalo 2007 lehikoinen et al 2010 stephen 2007 alternatively customized parametric likelihood functions have been developed most notably in the fields of catchment and urban hydrology to reflect the non gaussian strongly correlated and often heteroscedastic nature of residuals in some problems e g del giudice et al 2013 schoups and vrugt 2010 smith et al 2010 2015 in all of these studies it has been shown that inclusion of model error statistical characteristics into the bayesian likelihood function results in a broadening of posterior distributions along with in many cases a reduction in posterior bias a key concern however is the validity of the assumption that the errors can be adequately described by the specified parametric distribution indeed our own experience with high dimensional spatially distributed inverse problems in geophysics and hydrology suggests that it is more often the case that model errors exhibit highly complex statistics and correlations that change significantly not only over the data space but also as a function of the input model parameters note that this in part has led to greatly increased interest in alternative likelihood methods such as generalized likelihood uncertainty estimation glue e g beven and binley 1992 and approximate bayesian computation abc e g vrugt and sadegh 2013 another avenue of research to account for the discrepancy between approximate and detailed forward solvers in bayesian stochastic inversions which addresses the latter point above focuses on the development of local error models that describe either statistically or deterministically the discrepancy between the approximate and detailed forward solutions over the model parameter space o sullivan and christie 2006 for example use a small number of coarse grid versus fine grid model error realizations computed over a low dimensional model parameter space to characterize through interpolation how the model error mean and covariance matrix change as a function of the input parameters kennedy and o hagan 2001 present a comprehensive theoretical framework for dealing with model errors where the error statistics are described by a gaussian process conditioned to the points in the parameter space where the model error is known xu and valocchi 2015 also represent the model error as a gaussian process that is trained during the bayesian inversion with spatially and temporally distributed observations doherty and christensen 2011 and josset et al 2015b propose the use of regression models to predict the results of the detailed solver from the approximate solution with the latter study making use of functional principal components analysis and dimension reduction to facilitate the analysis finally cui et al 2011 assume that the model error obtained from the last detailed forward simulation during two stage mcmc discussed below is a valid approximation of the model error for the current set of input parameters and use it to correct the approximate solution before computing the likelihood in all of this work local error models are effectively constructed by interpolating between a limited number of model error realizations under the implicit assumptions that the model response surface is smooth enough to do so and that the parameter space has been adequately sampled while this may be perfectly valid for low dimensional inverse problems it becomes extremely difficult in high dimensions yet another means of addressing the issue of model error when using approximate forward solvers in bayesian stochastic inversions is the two stage mcmc approach with this method model errors are not explicitly accounted for but instead are avoided altogether because the approximate solver is used only in a first accept reject stage to prevent unpromising sets of model parameters from being tested with the computationally expensive detailed solution e g christen and fox 2005 efendiev et al 2009 laloy et al 2013 ma et al 2008 in order to realize computational gains with this technique the approximate solver needs to be a good approximation in the sense that it provides results that are relatively close to the detailed one christen and fox 2005 for this reason a number of researchers have paired the approximate solver with a local error model to improve its accuracy cui et al 2011 josset et al 2015a laloy et al 2013 the advantage of two stage mcmc is that the effects of model errors in the bayesian posterior distribution can be avoided the significant disadvantage however is that the computational gains of the approach may still not be enough to render the inverse problem computationally tractable since each posterior realization must still pass through the detailed forward solver in addition to other parameter sets that have passed the first stage but are later rejected in this paper we attempt to address the above mentioned challenges and present a new methodology for dealing with the model error arising from the use of approximate forward solvers in bayesian solutions to hydrogeophysical inverse problems our approach is geared towards the common case where this error cannot be effectively characterized globally through some parametric statistical distribution or locally based on interpolation between a small number of computed realizations rather than focusing on the construction of a global or local error model we instead work towards identification of the model error component of the residual through a projection based approach in this regard pairs of approximate and detailed model runs are stored in a dictionary that grows at a specified rate during the mcmc inversion procedure at each iteration a local model error basis is constructed for the current test set of model parameters using the k nearest neighbor knn entries in the dictionary which is then used to separate the model error from the other error sources we begin in section 2 with a brief review of bayesian mcmc methods followed by development of our modified approach to account for model error we then show in section 3 the application of our methodology to three example inversions involving crosshole ground penetrating radar gpr travel time tomography where in each case different subsurface model parameterizations apply in each example posterior parameter distributions are compared for the cases where i there is no model error present ii model error is present but not accounted for and iii model error is accounted for using our developed approach 2 methodology 2 1 bayesian inversion using mcmc consider the general forward problem linking a set of observed geophysical or hydrological data d obs to a set of subsurface model parameters of interest m true 1 d o b s f m t r u e e d where forward operator f contains the physics and geometry of the measurements and e d is a vector of data measurement errors the corresponding inverse problem involves estimating m true given d obs which requires knowledge of f along with prior information about the model parameters within a probabilistic framework this can be formulated using bayes theorem whereby an initial prior model parameter distribution p m is updated into a more refined posterior parameter distribution p m d obs taking into account the observed data e g tarantola 2005 that is 2 p m d o b s p d o b s m p m p d o b s where p d obs m is the likelihood function and p d obs which does not depend on the model parameters acts as a normalization constant assuming that the data measurement errors are independent and identically normally distributed with mean zero and standard deviation σd the likelihood is multi gaussian and can be expressed as 3 p d o b s m 1 2 π σ d 2 n 2 exp r m 2 2 σ d 2 where denotes the ℓ2 norm n is the number of data and 4 r m f m d o b s f m f m t r u e parameter error component e d is the residual vector which describes the misfit between the observed data and those predicted by applying the forward operator to parameter set m we see that the likelihood will be maximized for a particular set of model parameters when the ℓ2 norm of the residual is minimized which corresponds to the case where m m t r u e and the parameter error component defined in eq 4 is equal to zero eqs 2 through 4 together provide a means of calculating the posterior probability of a particular set of model parameters m this is commonly used within mcmc sampling procedures to quantify posterior uncertainty and thus solve the inverse problem since performing the multi dimensional integrations necessary to obtain the statistical moments of p m d obs is generally not possible in this regard algorithm 1 describes a basic metropolis hastings mcmc code hastings 1970 metropolis et al 1953 that is guaranteed after burn in to generate a markov chain of samples m 1 m k from the bayesian posterior distribution starting from an initial parameter set m 1 drawn from the prior distribution in each iteration a new parameter set m is drawn from the proposal distribution q m m i the likelihood of the proposed parameter set p d obs m is computed using eq 3 and the probability of accepting it is evaluated using 5 p a c c min 1 p m d o b s q m i m p m i d o b s q m m i if the new parameter set is probabilistically accepted it becomes the new state of the chain otherwise if it is rejected the chain remains at the last accepted parameter set 2 2 accounting for model error employing approximate forward solvers f in bayesian mcmc inversions in place of the true or detailed forward operator f introduces model error which as mentioned earlier has the potential to strongly bias posterior statistics if not accounted for in this case the residual is given by the following equation 6 r m f m d o b s f m f m t r u e e d f m f m model error component f m f m t r u e parameter error component e d where we see that the additional model error component means that r m will not necessarily be minimized when m m t r u e and that feasible sets of model parameters may be mapped to extremely low likelihoods if eq 3 is directly employed to address this issue researchers have typically used small numbers of detailed and approximate model pairs to develop global or local error models as described previously however for many inverse problems in geophysics and hydrology involving spatially distributed model parameters non linear forward solvers and or large numbers of data i the model error distribution will be too complex to characterize globally in a meaningful way using parametric statistical distributions and ii the size of the model parameter space combined with the variability of the response surface will not be conducive to effective error model development based on regression interpolation techniques to overcome these challenges we seek in this work to develop a strategy for dealing with the model errors that does not depend on their accurate statistical characterization or the construction of an error model but rather focuses on identification of the model error component of the residual during mcmc such that it can be subtracted prior to calculation of the likelihood using eq 3 to this end in each mcmc iteration we use a small number of model error realizations all corresponding to points in the model parameter space that are close to the parameter set being tested m to build an orthogonal basis for the model error the model error realizations come from a dictionary that is constructed during the inversion procedure and grows over time at a specified rate as the iterations proceed we assume that this basis which is local as it represents the span of the knn points to m can be used to approximate the model error at m at the same time we assume that the other components of the residual at m namely the parameter error and data measurement error components cannot be well represented by the model error basis and lie largely orthogonal to it as a result under these assumptions projection of the residual onto the basis yields an estimate of the model error algorithm 2 shows the steps involved in our modified mcmc procedure to generate samples from the bayesian posterior distribution in the presence of model error coming from the use of an approximate forward solver the algorithm is the same as the standard metropolis hastings approach presented in algorithm 1 with the exception of two important additions i a new function likelihood on lines 25 33 to compute the likelihood of the proposed set of model parameters m with a correction for model error which replaces its direct computation on line 6 using eq 3 and ii code on lines 15 23 to build and grow the model parameter and corresponding model error dictionaries m δ and e δ respectively which are used by function likelihood to construct the local model error basis to reflect these additions new inputs required by the code are k the number of nearest neighbor points to consider when creating the basis and pdict the probability during each mcmc iteration of running the detailed forward solver and adding the model parameter set and corresponding model error realization to m δ and e δ with respect to addition i above the modified likelihood computation for some generic model parameter set m proceeds as follows first the current model parameter dictionary m δ is searched for the knn parameter sets to m which are determined using a standard euclidean distance measure e g hastie et al 2009 next the k corresponding entries from the model error realization dictionary e δ are placed into the set e k m and used to build an orthonormal basis b for the model error at m such that span b span e k m we accomplish this using the gram schmidt procedure assuming that the data measurement error and parameter error components of the residual at m cannot be represented by and indeed lie orthogonal to this basis the model error e m can then be estimated by projecting r m from eq 6 onto b that is 7 e m b b t r m finally the estimated model error is subtracted from the residual to yield remainder 8 r m r m e m which is now largely suitable for calculation of the likelihood using eq 3 assuming independent and identically normally distributed data measurement errors with respect to addition ii on lines 15 23 of algorithm 2 parameter pdict controls how often the detailed forward solver is run during mcmc in order to grow the model parameter and model error dictionaries m δ and e δ where δ denotes the current number of entries before starting the inversion procedure these dictionaries are set to contain k entries consisting of unrealistically large values for the model parameters and values close to zero for the model error realizations this ensures that the knn search in function likelihood can be performed however it means that the estimated model error in the first few iterations of our procedure will be zero and thus that the returned likelihood is given by eq 3 as the mcmc iterations continue the option to perform a dictionary update will be periodically accepted whereby the detailed forward solver will be run alongside the approximate solver and m δ and e δ will be augmented with entries around the current state of the markov chain as a result these dictionaries will become increasingly representative of the local model error and the capacity of the computed orthogonal basis to identify the model error component of the residual will improve over time it is important to note that a critical step in the dictionary enrichment part of algorithm 2 is line 22 where after a dictionary update is performed the likelihood is recomputed for the current state of the markov chain this step is necessary to maintain consistent use of the same dictionary while estimating the acceptance probability at subsequent steps that is we must ensure that the likelihoods for the last accepted parameter set and the proposed transition are determined using the same model error basis which means that the likelihood for the current state of the markov chain must be recalculated if the decision is made to update the dictionary following the procedure described above we are able to effectively reduce posterior bias due to model error using a limited number of detailed forward solver runs in the initial stages of our algorithm when there exist only a small number of dictionary entries a relatively large portion of the data mismatch tends to be removed from the residual by the projection procedure because the knn derived basis is more diverse as the markov chain moves around the model parameter space in other words the basis is potentially able to represent a significant portion of the residual including both the model error and parameter error components because its entries exhibit greater variability this encourages exploration and avoids early convergence to a biased posterior distribution as the mcmc iterations proceed and the dictionaries grow the knn derived basis becomes more focused and local and is thus better at representing only the model error component as a result the algorithm gradually begins to sample from the bias free posterior distribution it is important to emphasize that the success of our procedure depends strongly on the validity of the assumptions that i the model error component of the residual can be eventually well represented by the knn derived basis and ii the parameter and data measurement error components lie orthogonal to this basis with regard to i it is reasonable to think that a basis derived from nearest neighbor model error realizations should include in its span the model error at the current point with regard to ii it is highly unlikely that the model error basis functions which tend to possess a high degree of spatial correlation are capable of representing random data measurement errors and thus these errors tend to be largely attenuated through projection of the residual onto b in the case of parameter errors our experience with the algorithm suggests that although it cannot be proven that this component of the residual should lie orthogonal to the model error component it will usually possess vastly different spatial characteristics and is thus not well captured by the basis nevertheless there may exist situations where some or all of the effects of parameter error strongly resemble those of model error and thus may be identified as such in projecting onto b in these cases both the model and parameter error components will be subtracted from the residual before computing the likelihood meaning that the corresponding parameter set being tested will be more likely to be accepted in mcmc the algorithm will therefore deliver broadened posterior distributions to reflect the fact that the effects of model error cannot be distinguished from those of parameter error 3 application to crosshole gpr tomography 3 1 experimental setup and forward solvers to demonstrate the above presented model error approach we now apply it to several crosshole gpr tomographic examples crosshole gpr travel time tomography is a popular technique in near surface geophysical and hydrological studies whereby the travel times of radar energy between a transmitter and receiver antenna located at various depths in two adjacent boreholes are used to estimate the spatial distribution of radar wave velocity between the holes the latter quantity is strongly related to soil water content meaning that the method provides estimates of porosity below the water table and information on soil texture and water retention characteristics in the unsaturated zone because the crosshole gpr travel time inverse problem is relatively straightforward but at the same time represents a challenging test case involving spatial distributions of subsurface model parameters it has been popular in previous stochastic inverse studies e g hansen et al 2014 linde and vrugt 2013 looms et al 2008 scholer et al 2012 here it is of particular interest because of the variety of methods with which the forward problem can be solved each representing a different degree of accuracy and computational speed the most precise and computationally expensive method of determining the travel time of radar energy between the transmitter and receiver antennas for example involves wave propagation modelling based on maxwell s equations where the first arrival times are picked from the output waveforms assuming that wave propagation can be adequately described by ray theory the eikonal equation e g nowack 1992 delivers a less accurate but orders of magnitude cheaper solution to the travel time computation problem whereby the path of the first arriving energy depends on the subsurface gpr velocity distribution but the effects of frequency are ignored going even further we can also assume that the ray paths are straight lines connecting the transmitter and receiver antennas e g cordua et al 2008 the latter straight ray approximation is strictly valid only in the case of a homogeneous subsurface however it is commonly employed when velocity contrasts are less than 10 for all of the inversions considered in this paper we consider an experimental configuration involving two boreholes 4 m apart and 8 m deep with transmitter and receiver positions distributed equally every 0 2 m in the left and right boreholes respectively consideration of energy traveling between every combination of transmitter and receiver location leads to 1600 travel time data to keep the inverse problem as straightforward as possible we focus on the estimation of subsurface slowness inverse of velocity rather than velocity itself meaning that the straight ray problem is linear the eikonal equation serves as our detailed forward solver f and is used to generate the true travel time data for each considered example gaussian random noise with a standard deviation equal to σ d 0 2 ns is added to these data to simulate the effects of measurement errors the straight ray solution serves as our approximate forward model f which is utilized as a cheap alternative to the eikonal equation in the mcmc inversion procedure note that our choice of detailed and approximate solvers in this paper was made primarily to keep computational costs reasonable for testing purposes and importantly to allow results to be obtained for the case where there is no model error that is had we chosen full waveform simulation as the detailed forward model in our examples it would not have been possible to compare the results of our algorithm with those for the case where this forward simulator is used within standard metropolis hastings mcmc fig 1 a shows an example subsurface slowness field for which the corresponding first arrival gpr travel time data calculated using the approximate straight ray solution and detailed eikonal equation solution are shown in fig 1b and 1c respectively the latter are visualized as a function of the transmitter and receiver antenna depths the model error being defined as the discrepancy between the approximate and detailed solutions f m f m is shown in fig 1d note that although the simulated data corresponding to each solver are visually similar the differences between them which in this case are on the order of 5 of the magnitude of the gpr travel times can lead to significant posterior parameter bias in a bayesian stochastic inversion as the slowness field in fig 1a has a greater correlation length in the horizontal than in the vertical direction the largest errors are seen to occur for horizontal raypaths corresponding to the main diagonal in fig 1d 3 2 model parameterization and priors for our example inversions we consider three different means of parameterizing the gpr slowness field between the boreholes which leads to inverse problems of varying degrees of field complexity with different numbers of model parameters to be estimated in the first example we consider a simple subsurface environment consisting of 5 homogeneous horizontal layers with layer interface positions fixed at 1 4 5 and 7 m the inverse problem consists of estimating the 5 layer slowness values with the interface positions assumed known flat priors between 5 ns m and 15 ns m are prescribed for each slowness value fig 2 a shows three random slowness realizations that were generated from the prior for this example in fig 3 a the corresponding model error realizations are shown we see that overall the model error is close to zero with the exception of a few large errors located near the main diagonal of each image the latter of which correspond to transmitter and receiver positions at approximately the same depth and located close to layer interfaces across which there is a large change in slowness this is to be expected because at these locations the eikonal equation will allow first arriving energy to do most of its travel through low slowness high velocity layers whereas the straight ray solution forces this energy to pass through high slowness low velocity layers in the second example inversion we allow for variability in both the horizontal and vertical directions by considering that the gpr slowness field is parameterized using a truncated karhunen loève expansion kle the truncated kle has been utilized extensively in stochastic inverse studies to efficiently represent gaussian random fields using a small number of parameters e g dostert et al 2006 efendiev et al 2009 elsheikh et al 2012 laloy et al 2013 zhang and lu 2004 in two spatial dimensions it can be expressed as 9 s x z μ x z i 1 m m i λ i φ i x z where s x z is the random field μ x z is its mean function mi are a series of independent standard normal variables and λi and φ i x z are the eigenvalues and eigenfunctions of the field s autocovariance kernel respectively which have been sorted in decreasing order according to the eigenvalues only the first m terms of the infinite kle sum are retained in eq 9 meaning that s x z provides a smooth approximation to the underlying gaussian random field that improves as the dimension m increases in our case the truncation limit is set to m 20 meaning that 20 coefficients m 1 m 20 parameterize the slowness distribution and represent the target of the inversion procedure the prior distribution for these coefficients is gaussian with mean zero and covariance equal to the identity matrix for the autocovariance kernel a squared exponential model is assumed having standard deviation equal to 4 ns m and horizontal and vertical correlation lengths equal to 0 8 m and 0 3 m respectively the mean slowness value is set equal to 10 ns m the domain between the boreholes is discretized using δ x δ z 0 2 m fig 2b shows three random subsurface slowness fields that were generated from the prior for this example whereas fig 3b shows the corresponding model error realizations again we see that large model errors predominantly occur close to the main diagonal in each image where the transmitter and receiver are located at the same depth and close to regions having a strong slowness contrast in comparison with fig 3a however note that the lack of interface constraints in this case means that the errors can occur anywhere along this diagonal the 2 d nature of the heterogeneity also means that model errors are possible in other parts of the image space as well although the truncated kle allows for efficient parameterization of gaussian random fields it leads to overly smooth representations that are still far from reality to incorporate more realism into our final inversion example we consider a pixel based parameterization of the subsurface whereby the domain between the boreholes is discretized into 20 40 constant slowness square cells having side length 0 2 m yielding 800 model parameters to be estimated for this example an exponential autocovariance kernel is assumed having standard deviation equal to 1 7 ns m and horizontal and vertical correlation lengths equal to 6 m and 1 5 m respectively the mean slowness is again set to 10 ns m fig 2c shows three random slowness fields generated from the gaussian prior for the pixel based parameterization case using the sequential gaussian simulation code from the gslib software package deutsch and journel 1992 the fields show many small scale heterogeneities compared with those generated using the truncated kle in fig 2b and are clearly more geologically plausible subsurface representations in the corresponding model error realizations in fig 3c we observe a correspondingly greater amount of small scale variation compared to figs 3a and b again however the model errors tend to be concentrated near the diagonal of these images all of the model error realizations presented in fig 3 exhibit structures that are highly correlated in the data space quite importantly the error realizations are also non gaussian distributed meaning that attempts to deal with these errors as gaussian in the inversion procedure will lead to an incorrect quantification of posterior uncertainty to see this latter point we generated 10 000 model error realizations for each parameterization example for each combination of transmitter and receiver position a quantile quantile q q plot was created comparing the model error distribution at that location with a standard normal distribution fig 4 shows the q q plots for five data locations chosen completely at random we observe that for each example parameterization the model error is strongly non gaussian and cannot even be roughly approximated using simple gaussian statistics 3 3 inversion settings and results we present below the results of mcmc inversions for the three previously described slowness model parameterizations for each parameterization inversions were performed for i the case of no model error where the synthetic data were generated and inverted using the same detailed eikonal equation solver and standard metropolis hastings was employed ii the case where model error is present but not accounted for through the use of the standard metropolis hastings approach and iii the case where model error is present and accounted for using our proposed methodology in each case σd in eq 3 was set to a value of 0 5 ns which represents the expected level of error in the residual burn in as well as the number of iterations to run for each inversion were assessed through visual inspection of the mean and variance as a function of iteration for each parameter e g hassan et al 2009 with regard to our method 20 nearest neighbors were considered in every inversion to generate the model error basis this number was found to offer a good balance between having enough knn to allow for flexibility in the basis to accurately represent the model error for the proposed set of parameters in mcmc and not having too many knn such that the basis was capable of representing other error sources in the residual parameter pdict which again controls the frequency with which the detailed forward solver is run to augment the model error dictionary was set in each inversion to 0 1 for the first 40 000 iterations after which it was gradually reduced to a value of 0 005 after 100 000 iterations this ensured that at the beginning of the algorithm focus was placed on building the model error dictionary whereas in later iterations the detailed forward model was run less frequently to minimize computational costs for an inversion involving 600 000 iterations this meant that only approximately 100 complex model runs were required each example parameterization outlined in section 3 2 requires a specific proposal mechanism in mcmc which is presented in the following subsections along with the inversion results 3 3 1 layered parameterization for the layered subsurface example a simple uniform proposal mechanism was used to generate new models to be tested in each mcmc iteration this is given by 10 m m i β ξ where m is the proposed set of model parameters m i is the current state of the markov chain β is a scaling coefficient that determines the proposal width and ξ is a vector of independent uniform random numbers drawn from u 0 5 0 5 we chose β 0 05 for each inversion which provided a model acceptance rate of approximately 30 a total of 600 000 iterations were run in each case from which the first 50 000 iterations were discarded as burn in and the remaining samples were used to generate the posterior results fig 5 a shows the true subsurface slowness field that was used to generate the synthetic travel time data for the 5 layer parameterization case in fig 5b d the most probable slowness fields obtained from the suite of posterior mcmc realizations are shown for the cases where i there is no model error ii model error is present but not accounted for and iii model error is present and accounted for respectively fig 6 on the other hand shows the marginal posterior parameter distributions obtained from the mcmc results for these three cases along with the flat prior distributions for reference we observe in figs 5 and 6 that in the case where model error is not present and the only contribution to the residual is therefore data measurement error the most probable slowness field resembles the truth and the posterior distributions are focused on the true parameter set as could be expected conversely when model error is present but disregarded the posterior distributions are biased and overconfident and the most probable slowness field deviates significantly from the truth in this latter case the inverted model parameters are compensating for the model error and conclusions based on the results will be misleading employing the model error approach presented in section 2 2 we see that the bias is reduced significantly and the most probable slowness field is again close to the true configuration note however that the posterior distributions are slightly broader than in the case when there is no model error which is not surprising as some amount of parameter error may be captured by the model error basis during the inversion procedure 3 3 2 kle parameterization the increased dimensionality in representing the subsurface with a series of truncated kle coefficients instead of layer slowness values requires in general more iterations in order to obtain independent samples in mcmc the preconditioned crank nicolson pcn technique beskos et al 2017 cotter et al 2013 allows for sampling that is robust with respect to dimension and can make mcmc considerably more efficient another approach for increasing efficiency is the adaptive mcmc technique haario et al 2001 whereby posterior information gained from previous mcmc iterations is gradually introduced into the proposal mechanism for the kle parameterization example we implemented the dimension independent adaptive metropolis diam mcmc algorithm proposed by chen et al 2016 where the proposal mechanism is described by 11 m m 1 β 2 m i m β ξ where β is again a scaling coefficient that determines the proposal width ξ is a vector of normally distributed random numbers drawn from n 0 c and m and c are the proposal mean and covariance matrix respectively defined as 12 m 1 ϵ m p o s t ϵ m p r i o r 13 c 1 ϵ c p o s t ϵ c p r i o r here m p r i o r and c prior represent the prior mean and covariance and m p o s t and c post are the corresponding posterior quantities that are estimated from the sample history the latter were updated in our inversions every 1000 iterations as suggested by haario et al 2001 we set factor ϵ to gradually decrease after 10 000 iterations from 1 to 0 5 in order to lead the proposal distribution from the prior towards the posterior the proposal width was chosen to be β 0 01 which yielded a model acceptance rate of around 30 employing the diam approach resulted in an order of magnitude decrease in the autocorrelation of the parameter history compared to standard metropolis hastings a total of 700 000 iterations were carried out for each inversion with the first 100 000 iterations discarded as burn in fig 7 a shows the subsurface slowness field that was used to generate the synthetic travel time data for the 20 kle coefficient parameterization example whereas fig 7b d present the most probable slowness fields for the three different inversion cases in fig 8 we show the corresponding marginal posterior parameter distributions in accordance with what was observed previously we see that for the case of no model error the most probable slowness field and posterior distributions reflect very well the truth when model error is present but disregarded however the posterior distributions become strongly biased and the most probable slowness field deviates significantly from the true configuration applying the model error approach developed in this paper we are able to remove this bias and better identify the true slowness configuration again at the expense of slightly broadened distributions 3 3 3 pixel based parameterization pixel based parameterizations introduce additional complications into the inversion process as the dimension of the problem can be extremely large depending on the chosen discretization one means of alleviating this issue involves introducing geostatistical prior information into the mcmc proposal mechanism thereby reducing the number of potential model configurations to be tested in this regard sequential geostatistical resampling sgr operates by perturbing a small number of randomly chosen pixels at each mcmc iteration where the pixel values are simulated conditional to the values at the surrounding fixed points assuming a prior geostatistical model sgr has been successfully employed in a variety of spatially distributed geophysical and hydrological inverse problems to date e g cordua et al 2012 fu and gómez hernández 2009 hansen et al 2012 irving and singha 2010 ruggeri et al 2015 for further theoretical details and practical information on its implementation please refer to these references here we chose to resample a randomly selected block of 2 2 pixels in each mcmc iteration which again yielded a model acceptance rate of approximately 30 a total of 100 000 iterations were run in each inversion for this example note that although this number is certainly not enough to provide a sufficient number of independent samples for accurate posterior inference e g ruggeri et al 2015 it importantly allows us to evaluate whether our model error approach can be effectively employed in such a high dimensional inverse problem because of the high dimension of the model parameter space it is not practical to present posterior distributions for this example as a result in fig 9 we show only the true subsurface slowness field along with the three best fitting slowness fields obtained from the posterior mcmc realizations for the cases of i no model error ii model error present but disregarded and ii model error present and accounted for using our approach again we see that the presence of model error leads to significant errors in the identified subsurface structures as the model parameters are attempting to account for the model error through their spatial distribution applying the developed model error approach reduces the posterior bias and the subsurface slowness field is again seen to resemble the true configuration 4 conclusions we have presented in this paper a new methodology for addressing the issue of model error in bayesian stochastic inversions that allows for a significant reduction in posterior parameter bias when using approximate forward solvers quite importantly our approach is based on identification of the model error component of the residual during mcmc rather than on the construction of a global or local error model the latter of which can be tremendously difficult if not impossible when dealing with high dimensional model parameter spaces and non linear forward problems with our method the discrepancy between the approximate and detailed forward solvers is periodically computed during the inversion procedure and the results stored in a dictionary a local orthonormal basis is then generated in each mcmc iteration using a specified number of knn dictionary entries which allows us to identify and subtract the model error from the residual before computing the likelihood the proposed methodology is highly flexible and does not depend on the model error having well defined statistical characteristics or smooth variation as a function of the input model parameters further no prior information about the model error is required before running the algorithm indeed pre computing in parallel multiple model error realizations to build an initial dictionary before running our procedure was found to offer no improvement in its performance for the considered examples suggesting that for many problems an effective characterization of the model error in advance of running mcmc will not be possible it is important to point out that the term model error as utilized in this paper refers to the discrepancy between an approximate and detailed forward solution the latter of which is assumed to be fully known and implementable as a numerical model and the former of which is used to improve computational efficiency in the stochastic inversion procedure in reality however the detailed solution itself will be often prone to model errors because of missing elements in its description of the underlying physical process some of which may be unknown the approach presented here cannot deal with these kinds of additional model errors in the sense that they cannot be simulated as stochastic realizations in order to develop an appropriate basis in cases where such errors exist application of our procedure can be expected to reduce the bias associated with the discrepancy between the detailed and approximate solutions but not that related to deficiencies in the detailed solution we applied our approach to the crosshole gpr travel time tomography problem in this paper where synthetic data were computed using the eikonal equation detailed model and a straight ray assumption was made in the inversion procedure approximate model using only roughly 100 detailed model calculations the method allowed for a considerable reduction in posterior parameter bias for three different parameterizations of the subsurface slowness field i 5 homogeneous horizontal layers ii 20 kle coefficients and iii a grid of 20 40 pixels for low dimensional problems it may be possible to even further reduce the computational cost of the procedure by reducing the probability of enriching the model error dictionary note that in all of our inversions the number of knn used to generate the basis and the rate at which we updated the model error dictionary were kept the same despite the fact that the corresponding examples varied considerably in terms of the dimension of the model parameter space this was possible and led to a good result in each case because i the dimension of the data space was the same for the three different parameterizations and ii the effective dimension of the model parameter space in the pixel based example is significantly lower than the number of pixels due to spatial correlations coming from the imposed geostatistical constraints nonetheless one important topic of future research is a detailed analysis of the best choice of the number of knn utilized in our algorithm this is expected to be highly problem dependent being a function of the specific forward solvers involved the data considered and the assumed model parameterization finally it should be again emphasized that in order to identify the model error component in the residual with our method we make the important assumption that it lies largely orthogonal to both data measurement noise and errors related to the wrong choice of model parameters although the latter condition is unlikely to be fully satisfied in every iteration experience suggests that the model and parameter error related structures are typically distinct enough such that the model error can be adequately identified in the worst case where this is not possible the consequence is broadened posterior distributions that include sets of model parameters whose discrepancies cannot be distinguished from model error future work will include application and testing of this methodology on other inverse problems as well as in the context of other iterative inversion techniques such as ensemble kalman smoothing acknowledgements this work was supported by a grant to j irving from the swiss national science foundation grant number 200021 140864 we also wish to thank the three anonymous reviewers for their constructive feedback that helped to greatly improve this manuscript 
819,bayesian solutions to geophysical and hydrological inverse problems are dependent upon a forward model linking subsurface physical properties to measured data which is typically assumed to be perfectly known in the inversion procedure however to make the stochastic solution of the inverse problem computationally tractable using methods such as markov chain monte carlo mcmc fast approximations of the forward model are commonly employed this gives rise to model error which has the potential to significantly bias posterior statistics if not properly accounted for here we present a new methodology for dealing with the model error arising from the use of approximate forward solvers in bayesian solutions to hydrogeophysical inverse problems our approach is geared towards the common case where this error cannot be i effectively characterized through some parametric statistical distribution or ii estimated by interpolating between a small number of computed model error realizations to this end we focus on identification and removal of the model error component of the residual during mcmc using a projection based approach whereby the orthogonal basis employed for the projection is derived in each iteration from the k nearest neighboring entries in a model error dictionary the latter is constructed during the inversion and grows at a specified rate as the iterations proceed we demonstrate the performance of our technique on the inversion of synthetic crosshole ground penetrating radar travel time data considering three different subsurface parameterizations of varying complexity synthetic data are generated using the eikonal equation whereas a straight ray forward model is assumed for their inversion in each case our developed approach enables us to remove posterior bias and obtain a more realistic characterization of uncertainty keywords model error bayesian inference mcmc proxy model 1 introduction bayesian inversion of hydrological and geophysical data using markov chain monte carlo mcmc methods has become increasingly popular over the past decade key advantages of this approach are that i it allows for more comprehensive quantification of posterior parameter uncertainty when compared to traditional linearized uncertainty estimates ii it is extremely flexible in the sense that any information that can be expressed probabilistically e g model prior information data measurement errors can be incorporated into the inverse problem and iii it provides a natural framework within which to perform data integration the bayesian mcmc approach does however have the notable disadvantage of being limited by its high computational cost which results from the typically large numbers of model parameters in geophysical and hydrological problems combined with the need for small model perturbations along the markov chain in order to ensure reasonable rates of proposal acceptance that is millions of forward model runs are commonly required to obtain meaningful posterior statistics which is computationally prohibitive for many real world applications e g ruggeri et al 2015 a variety of techniques exist for reducing the computational load of bayesian mcmc inversions recent algorithmic developments for mcmc methods which take advantage of parallel architectures and incorporate chain history and posterior gradient information into the proposal distribution have been shown to significantly improve computational efficiency past the standard metropolis hastings approach e g haario et al 2001 marshall and roberts 2012 neal 2011 sambridge 2013 stuart et al 2004 vrugt 2016 model reduction through the use of basis functions that exploit the spatial correlation naturally present in subsurface properties e g davis and li 2011 jafarpour et al 2009 linde and vrugt 2013 oware et al 2013 can also be performed to reduce the dimensionality and thus the numerical complexity of the inverse problem yet another means of reducing the computational load of bayesian mcmc inversions and arguably the most intuitive and commonly employed approach is to use a fast approximation of the forward solver in place of the slower full numerical solution this can be accomplished via simplification of the physics of the problem e g josset et al 2015b scholer et al 2012 reduction of the numerical accuracy of the solution by coarsening the model discretization e g arridge et al 2006 calvetti et al 2014 or the construction of response surface proxies based on for example polynomial chaos expansion artificial neural networks or gaussian processes e g goh et al 2013 khu and werner 2003 marzouk and xiu 2009 rasmussen and williams 2006 while the use of approximate forward solvers in this manner can be highly effective it can lead to strongly biased and overconfident posterior statistics if the discrepancies between the approximate and detailed solutions are not taken into account e g brynjarsdóttir and o hagan 2014 indeed such model errors have the potential to overwhelm the effects of data measurement uncertainties and may have a controlling influence on posterior inference despite this fact the issue of model error has been largely ignored in the vast majority of geophysical and hydrological studies to date where bayesian mcmc methods have been employed in recent years a number of techniques have appeared in the scientific and engineering literature to address the model error problem thus allowing for more effective use of approximate forward solvers in bayesian stochastic inversions one popular avenue of research focuses on the overall or global statistical characterization of these errors whereby a small number of stochastic model error realizations generated by running the approximate and detailed forward solvers on random parameter sets drawn from the prior distribution are used to develop likelihood functions that better reflect the combined nature of all error sources to this end by far the most straightforward and common approach is to assume that the model errors are gaussian distributed and thus characterized by some mean vector and covariance matrix both of which are estimated from the realizations e g arridge et al 2006 hansen et al 2014 kaipio and somersalo 2007 lehikoinen et al 2010 stephen 2007 alternatively customized parametric likelihood functions have been developed most notably in the fields of catchment and urban hydrology to reflect the non gaussian strongly correlated and often heteroscedastic nature of residuals in some problems e g del giudice et al 2013 schoups and vrugt 2010 smith et al 2010 2015 in all of these studies it has been shown that inclusion of model error statistical characteristics into the bayesian likelihood function results in a broadening of posterior distributions along with in many cases a reduction in posterior bias a key concern however is the validity of the assumption that the errors can be adequately described by the specified parametric distribution indeed our own experience with high dimensional spatially distributed inverse problems in geophysics and hydrology suggests that it is more often the case that model errors exhibit highly complex statistics and correlations that change significantly not only over the data space but also as a function of the input model parameters note that this in part has led to greatly increased interest in alternative likelihood methods such as generalized likelihood uncertainty estimation glue e g beven and binley 1992 and approximate bayesian computation abc e g vrugt and sadegh 2013 another avenue of research to account for the discrepancy between approximate and detailed forward solvers in bayesian stochastic inversions which addresses the latter point above focuses on the development of local error models that describe either statistically or deterministically the discrepancy between the approximate and detailed forward solutions over the model parameter space o sullivan and christie 2006 for example use a small number of coarse grid versus fine grid model error realizations computed over a low dimensional model parameter space to characterize through interpolation how the model error mean and covariance matrix change as a function of the input parameters kennedy and o hagan 2001 present a comprehensive theoretical framework for dealing with model errors where the error statistics are described by a gaussian process conditioned to the points in the parameter space where the model error is known xu and valocchi 2015 also represent the model error as a gaussian process that is trained during the bayesian inversion with spatially and temporally distributed observations doherty and christensen 2011 and josset et al 2015b propose the use of regression models to predict the results of the detailed solver from the approximate solution with the latter study making use of functional principal components analysis and dimension reduction to facilitate the analysis finally cui et al 2011 assume that the model error obtained from the last detailed forward simulation during two stage mcmc discussed below is a valid approximation of the model error for the current set of input parameters and use it to correct the approximate solution before computing the likelihood in all of this work local error models are effectively constructed by interpolating between a limited number of model error realizations under the implicit assumptions that the model response surface is smooth enough to do so and that the parameter space has been adequately sampled while this may be perfectly valid for low dimensional inverse problems it becomes extremely difficult in high dimensions yet another means of addressing the issue of model error when using approximate forward solvers in bayesian stochastic inversions is the two stage mcmc approach with this method model errors are not explicitly accounted for but instead are avoided altogether because the approximate solver is used only in a first accept reject stage to prevent unpromising sets of model parameters from being tested with the computationally expensive detailed solution e g christen and fox 2005 efendiev et al 2009 laloy et al 2013 ma et al 2008 in order to realize computational gains with this technique the approximate solver needs to be a good approximation in the sense that it provides results that are relatively close to the detailed one christen and fox 2005 for this reason a number of researchers have paired the approximate solver with a local error model to improve its accuracy cui et al 2011 josset et al 2015a laloy et al 2013 the advantage of two stage mcmc is that the effects of model errors in the bayesian posterior distribution can be avoided the significant disadvantage however is that the computational gains of the approach may still not be enough to render the inverse problem computationally tractable since each posterior realization must still pass through the detailed forward solver in addition to other parameter sets that have passed the first stage but are later rejected in this paper we attempt to address the above mentioned challenges and present a new methodology for dealing with the model error arising from the use of approximate forward solvers in bayesian solutions to hydrogeophysical inverse problems our approach is geared towards the common case where this error cannot be effectively characterized globally through some parametric statistical distribution or locally based on interpolation between a small number of computed realizations rather than focusing on the construction of a global or local error model we instead work towards identification of the model error component of the residual through a projection based approach in this regard pairs of approximate and detailed model runs are stored in a dictionary that grows at a specified rate during the mcmc inversion procedure at each iteration a local model error basis is constructed for the current test set of model parameters using the k nearest neighbor knn entries in the dictionary which is then used to separate the model error from the other error sources we begin in section 2 with a brief review of bayesian mcmc methods followed by development of our modified approach to account for model error we then show in section 3 the application of our methodology to three example inversions involving crosshole ground penetrating radar gpr travel time tomography where in each case different subsurface model parameterizations apply in each example posterior parameter distributions are compared for the cases where i there is no model error present ii model error is present but not accounted for and iii model error is accounted for using our developed approach 2 methodology 2 1 bayesian inversion using mcmc consider the general forward problem linking a set of observed geophysical or hydrological data d obs to a set of subsurface model parameters of interest m true 1 d o b s f m t r u e e d where forward operator f contains the physics and geometry of the measurements and e d is a vector of data measurement errors the corresponding inverse problem involves estimating m true given d obs which requires knowledge of f along with prior information about the model parameters within a probabilistic framework this can be formulated using bayes theorem whereby an initial prior model parameter distribution p m is updated into a more refined posterior parameter distribution p m d obs taking into account the observed data e g tarantola 2005 that is 2 p m d o b s p d o b s m p m p d o b s where p d obs m is the likelihood function and p d obs which does not depend on the model parameters acts as a normalization constant assuming that the data measurement errors are independent and identically normally distributed with mean zero and standard deviation σd the likelihood is multi gaussian and can be expressed as 3 p d o b s m 1 2 π σ d 2 n 2 exp r m 2 2 σ d 2 where denotes the ℓ2 norm n is the number of data and 4 r m f m d o b s f m f m t r u e parameter error component e d is the residual vector which describes the misfit between the observed data and those predicted by applying the forward operator to parameter set m we see that the likelihood will be maximized for a particular set of model parameters when the ℓ2 norm of the residual is minimized which corresponds to the case where m m t r u e and the parameter error component defined in eq 4 is equal to zero eqs 2 through 4 together provide a means of calculating the posterior probability of a particular set of model parameters m this is commonly used within mcmc sampling procedures to quantify posterior uncertainty and thus solve the inverse problem since performing the multi dimensional integrations necessary to obtain the statistical moments of p m d obs is generally not possible in this regard algorithm 1 describes a basic metropolis hastings mcmc code hastings 1970 metropolis et al 1953 that is guaranteed after burn in to generate a markov chain of samples m 1 m k from the bayesian posterior distribution starting from an initial parameter set m 1 drawn from the prior distribution in each iteration a new parameter set m is drawn from the proposal distribution q m m i the likelihood of the proposed parameter set p d obs m is computed using eq 3 and the probability of accepting it is evaluated using 5 p a c c min 1 p m d o b s q m i m p m i d o b s q m m i if the new parameter set is probabilistically accepted it becomes the new state of the chain otherwise if it is rejected the chain remains at the last accepted parameter set 2 2 accounting for model error employing approximate forward solvers f in bayesian mcmc inversions in place of the true or detailed forward operator f introduces model error which as mentioned earlier has the potential to strongly bias posterior statistics if not accounted for in this case the residual is given by the following equation 6 r m f m d o b s f m f m t r u e e d f m f m model error component f m f m t r u e parameter error component e d where we see that the additional model error component means that r m will not necessarily be minimized when m m t r u e and that feasible sets of model parameters may be mapped to extremely low likelihoods if eq 3 is directly employed to address this issue researchers have typically used small numbers of detailed and approximate model pairs to develop global or local error models as described previously however for many inverse problems in geophysics and hydrology involving spatially distributed model parameters non linear forward solvers and or large numbers of data i the model error distribution will be too complex to characterize globally in a meaningful way using parametric statistical distributions and ii the size of the model parameter space combined with the variability of the response surface will not be conducive to effective error model development based on regression interpolation techniques to overcome these challenges we seek in this work to develop a strategy for dealing with the model errors that does not depend on their accurate statistical characterization or the construction of an error model but rather focuses on identification of the model error component of the residual during mcmc such that it can be subtracted prior to calculation of the likelihood using eq 3 to this end in each mcmc iteration we use a small number of model error realizations all corresponding to points in the model parameter space that are close to the parameter set being tested m to build an orthogonal basis for the model error the model error realizations come from a dictionary that is constructed during the inversion procedure and grows over time at a specified rate as the iterations proceed we assume that this basis which is local as it represents the span of the knn points to m can be used to approximate the model error at m at the same time we assume that the other components of the residual at m namely the parameter error and data measurement error components cannot be well represented by the model error basis and lie largely orthogonal to it as a result under these assumptions projection of the residual onto the basis yields an estimate of the model error algorithm 2 shows the steps involved in our modified mcmc procedure to generate samples from the bayesian posterior distribution in the presence of model error coming from the use of an approximate forward solver the algorithm is the same as the standard metropolis hastings approach presented in algorithm 1 with the exception of two important additions i a new function likelihood on lines 25 33 to compute the likelihood of the proposed set of model parameters m with a correction for model error which replaces its direct computation on line 6 using eq 3 and ii code on lines 15 23 to build and grow the model parameter and corresponding model error dictionaries m δ and e δ respectively which are used by function likelihood to construct the local model error basis to reflect these additions new inputs required by the code are k the number of nearest neighbor points to consider when creating the basis and pdict the probability during each mcmc iteration of running the detailed forward solver and adding the model parameter set and corresponding model error realization to m δ and e δ with respect to addition i above the modified likelihood computation for some generic model parameter set m proceeds as follows first the current model parameter dictionary m δ is searched for the knn parameter sets to m which are determined using a standard euclidean distance measure e g hastie et al 2009 next the k corresponding entries from the model error realization dictionary e δ are placed into the set e k m and used to build an orthonormal basis b for the model error at m such that span b span e k m we accomplish this using the gram schmidt procedure assuming that the data measurement error and parameter error components of the residual at m cannot be represented by and indeed lie orthogonal to this basis the model error e m can then be estimated by projecting r m from eq 6 onto b that is 7 e m b b t r m finally the estimated model error is subtracted from the residual to yield remainder 8 r m r m e m which is now largely suitable for calculation of the likelihood using eq 3 assuming independent and identically normally distributed data measurement errors with respect to addition ii on lines 15 23 of algorithm 2 parameter pdict controls how often the detailed forward solver is run during mcmc in order to grow the model parameter and model error dictionaries m δ and e δ where δ denotes the current number of entries before starting the inversion procedure these dictionaries are set to contain k entries consisting of unrealistically large values for the model parameters and values close to zero for the model error realizations this ensures that the knn search in function likelihood can be performed however it means that the estimated model error in the first few iterations of our procedure will be zero and thus that the returned likelihood is given by eq 3 as the mcmc iterations continue the option to perform a dictionary update will be periodically accepted whereby the detailed forward solver will be run alongside the approximate solver and m δ and e δ will be augmented with entries around the current state of the markov chain as a result these dictionaries will become increasingly representative of the local model error and the capacity of the computed orthogonal basis to identify the model error component of the residual will improve over time it is important to note that a critical step in the dictionary enrichment part of algorithm 2 is line 22 where after a dictionary update is performed the likelihood is recomputed for the current state of the markov chain this step is necessary to maintain consistent use of the same dictionary while estimating the acceptance probability at subsequent steps that is we must ensure that the likelihoods for the last accepted parameter set and the proposed transition are determined using the same model error basis which means that the likelihood for the current state of the markov chain must be recalculated if the decision is made to update the dictionary following the procedure described above we are able to effectively reduce posterior bias due to model error using a limited number of detailed forward solver runs in the initial stages of our algorithm when there exist only a small number of dictionary entries a relatively large portion of the data mismatch tends to be removed from the residual by the projection procedure because the knn derived basis is more diverse as the markov chain moves around the model parameter space in other words the basis is potentially able to represent a significant portion of the residual including both the model error and parameter error components because its entries exhibit greater variability this encourages exploration and avoids early convergence to a biased posterior distribution as the mcmc iterations proceed and the dictionaries grow the knn derived basis becomes more focused and local and is thus better at representing only the model error component as a result the algorithm gradually begins to sample from the bias free posterior distribution it is important to emphasize that the success of our procedure depends strongly on the validity of the assumptions that i the model error component of the residual can be eventually well represented by the knn derived basis and ii the parameter and data measurement error components lie orthogonal to this basis with regard to i it is reasonable to think that a basis derived from nearest neighbor model error realizations should include in its span the model error at the current point with regard to ii it is highly unlikely that the model error basis functions which tend to possess a high degree of spatial correlation are capable of representing random data measurement errors and thus these errors tend to be largely attenuated through projection of the residual onto b in the case of parameter errors our experience with the algorithm suggests that although it cannot be proven that this component of the residual should lie orthogonal to the model error component it will usually possess vastly different spatial characteristics and is thus not well captured by the basis nevertheless there may exist situations where some or all of the effects of parameter error strongly resemble those of model error and thus may be identified as such in projecting onto b in these cases both the model and parameter error components will be subtracted from the residual before computing the likelihood meaning that the corresponding parameter set being tested will be more likely to be accepted in mcmc the algorithm will therefore deliver broadened posterior distributions to reflect the fact that the effects of model error cannot be distinguished from those of parameter error 3 application to crosshole gpr tomography 3 1 experimental setup and forward solvers to demonstrate the above presented model error approach we now apply it to several crosshole gpr tomographic examples crosshole gpr travel time tomography is a popular technique in near surface geophysical and hydrological studies whereby the travel times of radar energy between a transmitter and receiver antenna located at various depths in two adjacent boreholes are used to estimate the spatial distribution of radar wave velocity between the holes the latter quantity is strongly related to soil water content meaning that the method provides estimates of porosity below the water table and information on soil texture and water retention characteristics in the unsaturated zone because the crosshole gpr travel time inverse problem is relatively straightforward but at the same time represents a challenging test case involving spatial distributions of subsurface model parameters it has been popular in previous stochastic inverse studies e g hansen et al 2014 linde and vrugt 2013 looms et al 2008 scholer et al 2012 here it is of particular interest because of the variety of methods with which the forward problem can be solved each representing a different degree of accuracy and computational speed the most precise and computationally expensive method of determining the travel time of radar energy between the transmitter and receiver antennas for example involves wave propagation modelling based on maxwell s equations where the first arrival times are picked from the output waveforms assuming that wave propagation can be adequately described by ray theory the eikonal equation e g nowack 1992 delivers a less accurate but orders of magnitude cheaper solution to the travel time computation problem whereby the path of the first arriving energy depends on the subsurface gpr velocity distribution but the effects of frequency are ignored going even further we can also assume that the ray paths are straight lines connecting the transmitter and receiver antennas e g cordua et al 2008 the latter straight ray approximation is strictly valid only in the case of a homogeneous subsurface however it is commonly employed when velocity contrasts are less than 10 for all of the inversions considered in this paper we consider an experimental configuration involving two boreholes 4 m apart and 8 m deep with transmitter and receiver positions distributed equally every 0 2 m in the left and right boreholes respectively consideration of energy traveling between every combination of transmitter and receiver location leads to 1600 travel time data to keep the inverse problem as straightforward as possible we focus on the estimation of subsurface slowness inverse of velocity rather than velocity itself meaning that the straight ray problem is linear the eikonal equation serves as our detailed forward solver f and is used to generate the true travel time data for each considered example gaussian random noise with a standard deviation equal to σ d 0 2 ns is added to these data to simulate the effects of measurement errors the straight ray solution serves as our approximate forward model f which is utilized as a cheap alternative to the eikonal equation in the mcmc inversion procedure note that our choice of detailed and approximate solvers in this paper was made primarily to keep computational costs reasonable for testing purposes and importantly to allow results to be obtained for the case where there is no model error that is had we chosen full waveform simulation as the detailed forward model in our examples it would not have been possible to compare the results of our algorithm with those for the case where this forward simulator is used within standard metropolis hastings mcmc fig 1 a shows an example subsurface slowness field for which the corresponding first arrival gpr travel time data calculated using the approximate straight ray solution and detailed eikonal equation solution are shown in fig 1b and 1c respectively the latter are visualized as a function of the transmitter and receiver antenna depths the model error being defined as the discrepancy between the approximate and detailed solutions f m f m is shown in fig 1d note that although the simulated data corresponding to each solver are visually similar the differences between them which in this case are on the order of 5 of the magnitude of the gpr travel times can lead to significant posterior parameter bias in a bayesian stochastic inversion as the slowness field in fig 1a has a greater correlation length in the horizontal than in the vertical direction the largest errors are seen to occur for horizontal raypaths corresponding to the main diagonal in fig 1d 3 2 model parameterization and priors for our example inversions we consider three different means of parameterizing the gpr slowness field between the boreholes which leads to inverse problems of varying degrees of field complexity with different numbers of model parameters to be estimated in the first example we consider a simple subsurface environment consisting of 5 homogeneous horizontal layers with layer interface positions fixed at 1 4 5 and 7 m the inverse problem consists of estimating the 5 layer slowness values with the interface positions assumed known flat priors between 5 ns m and 15 ns m are prescribed for each slowness value fig 2 a shows three random slowness realizations that were generated from the prior for this example in fig 3 a the corresponding model error realizations are shown we see that overall the model error is close to zero with the exception of a few large errors located near the main diagonal of each image the latter of which correspond to transmitter and receiver positions at approximately the same depth and located close to layer interfaces across which there is a large change in slowness this is to be expected because at these locations the eikonal equation will allow first arriving energy to do most of its travel through low slowness high velocity layers whereas the straight ray solution forces this energy to pass through high slowness low velocity layers in the second example inversion we allow for variability in both the horizontal and vertical directions by considering that the gpr slowness field is parameterized using a truncated karhunen loève expansion kle the truncated kle has been utilized extensively in stochastic inverse studies to efficiently represent gaussian random fields using a small number of parameters e g dostert et al 2006 efendiev et al 2009 elsheikh et al 2012 laloy et al 2013 zhang and lu 2004 in two spatial dimensions it can be expressed as 9 s x z μ x z i 1 m m i λ i φ i x z where s x z is the random field μ x z is its mean function mi are a series of independent standard normal variables and λi and φ i x z are the eigenvalues and eigenfunctions of the field s autocovariance kernel respectively which have been sorted in decreasing order according to the eigenvalues only the first m terms of the infinite kle sum are retained in eq 9 meaning that s x z provides a smooth approximation to the underlying gaussian random field that improves as the dimension m increases in our case the truncation limit is set to m 20 meaning that 20 coefficients m 1 m 20 parameterize the slowness distribution and represent the target of the inversion procedure the prior distribution for these coefficients is gaussian with mean zero and covariance equal to the identity matrix for the autocovariance kernel a squared exponential model is assumed having standard deviation equal to 4 ns m and horizontal and vertical correlation lengths equal to 0 8 m and 0 3 m respectively the mean slowness value is set equal to 10 ns m the domain between the boreholes is discretized using δ x δ z 0 2 m fig 2b shows three random subsurface slowness fields that were generated from the prior for this example whereas fig 3b shows the corresponding model error realizations again we see that large model errors predominantly occur close to the main diagonal in each image where the transmitter and receiver are located at the same depth and close to regions having a strong slowness contrast in comparison with fig 3a however note that the lack of interface constraints in this case means that the errors can occur anywhere along this diagonal the 2 d nature of the heterogeneity also means that model errors are possible in other parts of the image space as well although the truncated kle allows for efficient parameterization of gaussian random fields it leads to overly smooth representations that are still far from reality to incorporate more realism into our final inversion example we consider a pixel based parameterization of the subsurface whereby the domain between the boreholes is discretized into 20 40 constant slowness square cells having side length 0 2 m yielding 800 model parameters to be estimated for this example an exponential autocovariance kernel is assumed having standard deviation equal to 1 7 ns m and horizontal and vertical correlation lengths equal to 6 m and 1 5 m respectively the mean slowness is again set to 10 ns m fig 2c shows three random slowness fields generated from the gaussian prior for the pixel based parameterization case using the sequential gaussian simulation code from the gslib software package deutsch and journel 1992 the fields show many small scale heterogeneities compared with those generated using the truncated kle in fig 2b and are clearly more geologically plausible subsurface representations in the corresponding model error realizations in fig 3c we observe a correspondingly greater amount of small scale variation compared to figs 3a and b again however the model errors tend to be concentrated near the diagonal of these images all of the model error realizations presented in fig 3 exhibit structures that are highly correlated in the data space quite importantly the error realizations are also non gaussian distributed meaning that attempts to deal with these errors as gaussian in the inversion procedure will lead to an incorrect quantification of posterior uncertainty to see this latter point we generated 10 000 model error realizations for each parameterization example for each combination of transmitter and receiver position a quantile quantile q q plot was created comparing the model error distribution at that location with a standard normal distribution fig 4 shows the q q plots for five data locations chosen completely at random we observe that for each example parameterization the model error is strongly non gaussian and cannot even be roughly approximated using simple gaussian statistics 3 3 inversion settings and results we present below the results of mcmc inversions for the three previously described slowness model parameterizations for each parameterization inversions were performed for i the case of no model error where the synthetic data were generated and inverted using the same detailed eikonal equation solver and standard metropolis hastings was employed ii the case where model error is present but not accounted for through the use of the standard metropolis hastings approach and iii the case where model error is present and accounted for using our proposed methodology in each case σd in eq 3 was set to a value of 0 5 ns which represents the expected level of error in the residual burn in as well as the number of iterations to run for each inversion were assessed through visual inspection of the mean and variance as a function of iteration for each parameter e g hassan et al 2009 with regard to our method 20 nearest neighbors were considered in every inversion to generate the model error basis this number was found to offer a good balance between having enough knn to allow for flexibility in the basis to accurately represent the model error for the proposed set of parameters in mcmc and not having too many knn such that the basis was capable of representing other error sources in the residual parameter pdict which again controls the frequency with which the detailed forward solver is run to augment the model error dictionary was set in each inversion to 0 1 for the first 40 000 iterations after which it was gradually reduced to a value of 0 005 after 100 000 iterations this ensured that at the beginning of the algorithm focus was placed on building the model error dictionary whereas in later iterations the detailed forward model was run less frequently to minimize computational costs for an inversion involving 600 000 iterations this meant that only approximately 100 complex model runs were required each example parameterization outlined in section 3 2 requires a specific proposal mechanism in mcmc which is presented in the following subsections along with the inversion results 3 3 1 layered parameterization for the layered subsurface example a simple uniform proposal mechanism was used to generate new models to be tested in each mcmc iteration this is given by 10 m m i β ξ where m is the proposed set of model parameters m i is the current state of the markov chain β is a scaling coefficient that determines the proposal width and ξ is a vector of independent uniform random numbers drawn from u 0 5 0 5 we chose β 0 05 for each inversion which provided a model acceptance rate of approximately 30 a total of 600 000 iterations were run in each case from which the first 50 000 iterations were discarded as burn in and the remaining samples were used to generate the posterior results fig 5 a shows the true subsurface slowness field that was used to generate the synthetic travel time data for the 5 layer parameterization case in fig 5b d the most probable slowness fields obtained from the suite of posterior mcmc realizations are shown for the cases where i there is no model error ii model error is present but not accounted for and iii model error is present and accounted for respectively fig 6 on the other hand shows the marginal posterior parameter distributions obtained from the mcmc results for these three cases along with the flat prior distributions for reference we observe in figs 5 and 6 that in the case where model error is not present and the only contribution to the residual is therefore data measurement error the most probable slowness field resembles the truth and the posterior distributions are focused on the true parameter set as could be expected conversely when model error is present but disregarded the posterior distributions are biased and overconfident and the most probable slowness field deviates significantly from the truth in this latter case the inverted model parameters are compensating for the model error and conclusions based on the results will be misleading employing the model error approach presented in section 2 2 we see that the bias is reduced significantly and the most probable slowness field is again close to the true configuration note however that the posterior distributions are slightly broader than in the case when there is no model error which is not surprising as some amount of parameter error may be captured by the model error basis during the inversion procedure 3 3 2 kle parameterization the increased dimensionality in representing the subsurface with a series of truncated kle coefficients instead of layer slowness values requires in general more iterations in order to obtain independent samples in mcmc the preconditioned crank nicolson pcn technique beskos et al 2017 cotter et al 2013 allows for sampling that is robust with respect to dimension and can make mcmc considerably more efficient another approach for increasing efficiency is the adaptive mcmc technique haario et al 2001 whereby posterior information gained from previous mcmc iterations is gradually introduced into the proposal mechanism for the kle parameterization example we implemented the dimension independent adaptive metropolis diam mcmc algorithm proposed by chen et al 2016 where the proposal mechanism is described by 11 m m 1 β 2 m i m β ξ where β is again a scaling coefficient that determines the proposal width ξ is a vector of normally distributed random numbers drawn from n 0 c and m and c are the proposal mean and covariance matrix respectively defined as 12 m 1 ϵ m p o s t ϵ m p r i o r 13 c 1 ϵ c p o s t ϵ c p r i o r here m p r i o r and c prior represent the prior mean and covariance and m p o s t and c post are the corresponding posterior quantities that are estimated from the sample history the latter were updated in our inversions every 1000 iterations as suggested by haario et al 2001 we set factor ϵ to gradually decrease after 10 000 iterations from 1 to 0 5 in order to lead the proposal distribution from the prior towards the posterior the proposal width was chosen to be β 0 01 which yielded a model acceptance rate of around 30 employing the diam approach resulted in an order of magnitude decrease in the autocorrelation of the parameter history compared to standard metropolis hastings a total of 700 000 iterations were carried out for each inversion with the first 100 000 iterations discarded as burn in fig 7 a shows the subsurface slowness field that was used to generate the synthetic travel time data for the 20 kle coefficient parameterization example whereas fig 7b d present the most probable slowness fields for the three different inversion cases in fig 8 we show the corresponding marginal posterior parameter distributions in accordance with what was observed previously we see that for the case of no model error the most probable slowness field and posterior distributions reflect very well the truth when model error is present but disregarded however the posterior distributions become strongly biased and the most probable slowness field deviates significantly from the true configuration applying the model error approach developed in this paper we are able to remove this bias and better identify the true slowness configuration again at the expense of slightly broadened distributions 3 3 3 pixel based parameterization pixel based parameterizations introduce additional complications into the inversion process as the dimension of the problem can be extremely large depending on the chosen discretization one means of alleviating this issue involves introducing geostatistical prior information into the mcmc proposal mechanism thereby reducing the number of potential model configurations to be tested in this regard sequential geostatistical resampling sgr operates by perturbing a small number of randomly chosen pixels at each mcmc iteration where the pixel values are simulated conditional to the values at the surrounding fixed points assuming a prior geostatistical model sgr has been successfully employed in a variety of spatially distributed geophysical and hydrological inverse problems to date e g cordua et al 2012 fu and gómez hernández 2009 hansen et al 2012 irving and singha 2010 ruggeri et al 2015 for further theoretical details and practical information on its implementation please refer to these references here we chose to resample a randomly selected block of 2 2 pixels in each mcmc iteration which again yielded a model acceptance rate of approximately 30 a total of 100 000 iterations were run in each inversion for this example note that although this number is certainly not enough to provide a sufficient number of independent samples for accurate posterior inference e g ruggeri et al 2015 it importantly allows us to evaluate whether our model error approach can be effectively employed in such a high dimensional inverse problem because of the high dimension of the model parameter space it is not practical to present posterior distributions for this example as a result in fig 9 we show only the true subsurface slowness field along with the three best fitting slowness fields obtained from the posterior mcmc realizations for the cases of i no model error ii model error present but disregarded and ii model error present and accounted for using our approach again we see that the presence of model error leads to significant errors in the identified subsurface structures as the model parameters are attempting to account for the model error through their spatial distribution applying the developed model error approach reduces the posterior bias and the subsurface slowness field is again seen to resemble the true configuration 4 conclusions we have presented in this paper a new methodology for addressing the issue of model error in bayesian stochastic inversions that allows for a significant reduction in posterior parameter bias when using approximate forward solvers quite importantly our approach is based on identification of the model error component of the residual during mcmc rather than on the construction of a global or local error model the latter of which can be tremendously difficult if not impossible when dealing with high dimensional model parameter spaces and non linear forward problems with our method the discrepancy between the approximate and detailed forward solvers is periodically computed during the inversion procedure and the results stored in a dictionary a local orthonormal basis is then generated in each mcmc iteration using a specified number of knn dictionary entries which allows us to identify and subtract the model error from the residual before computing the likelihood the proposed methodology is highly flexible and does not depend on the model error having well defined statistical characteristics or smooth variation as a function of the input model parameters further no prior information about the model error is required before running the algorithm indeed pre computing in parallel multiple model error realizations to build an initial dictionary before running our procedure was found to offer no improvement in its performance for the considered examples suggesting that for many problems an effective characterization of the model error in advance of running mcmc will not be possible it is important to point out that the term model error as utilized in this paper refers to the discrepancy between an approximate and detailed forward solution the latter of which is assumed to be fully known and implementable as a numerical model and the former of which is used to improve computational efficiency in the stochastic inversion procedure in reality however the detailed solution itself will be often prone to model errors because of missing elements in its description of the underlying physical process some of which may be unknown the approach presented here cannot deal with these kinds of additional model errors in the sense that they cannot be simulated as stochastic realizations in order to develop an appropriate basis in cases where such errors exist application of our procedure can be expected to reduce the bias associated with the discrepancy between the detailed and approximate solutions but not that related to deficiencies in the detailed solution we applied our approach to the crosshole gpr travel time tomography problem in this paper where synthetic data were computed using the eikonal equation detailed model and a straight ray assumption was made in the inversion procedure approximate model using only roughly 100 detailed model calculations the method allowed for a considerable reduction in posterior parameter bias for three different parameterizations of the subsurface slowness field i 5 homogeneous horizontal layers ii 20 kle coefficients and iii a grid of 20 40 pixels for low dimensional problems it may be possible to even further reduce the computational cost of the procedure by reducing the probability of enriching the model error dictionary note that in all of our inversions the number of knn used to generate the basis and the rate at which we updated the model error dictionary were kept the same despite the fact that the corresponding examples varied considerably in terms of the dimension of the model parameter space this was possible and led to a good result in each case because i the dimension of the data space was the same for the three different parameterizations and ii the effective dimension of the model parameter space in the pixel based example is significantly lower than the number of pixels due to spatial correlations coming from the imposed geostatistical constraints nonetheless one important topic of future research is a detailed analysis of the best choice of the number of knn utilized in our algorithm this is expected to be highly problem dependent being a function of the specific forward solvers involved the data considered and the assumed model parameterization finally it should be again emphasized that in order to identify the model error component in the residual with our method we make the important assumption that it lies largely orthogonal to both data measurement noise and errors related to the wrong choice of model parameters although the latter condition is unlikely to be fully satisfied in every iteration experience suggests that the model and parameter error related structures are typically distinct enough such that the model error can be adequately identified in the worst case where this is not possible the consequence is broadened posterior distributions that include sets of model parameters whose discrepancies cannot be distinguished from model error future work will include application and testing of this methodology on other inverse problems as well as in the context of other iterative inversion techniques such as ensemble kalman smoothing acknowledgements this work was supported by a grant to j irving from the swiss national science foundation grant number 200021 140864 we also wish to thank the three anonymous reviewers for their constructive feedback that helped to greatly improve this manuscript 
