index,text
23005,in the present paper the effects of three different pre swirl ducts on propulsion performance of a series 60 ship in comparison to the case with no duct are explored experimentally by self propulsion test measurements and cfd analysis to this accomplishment mewis duct becker twisted fins and unconventional half circular ducts are considered for investigating the propulsion performance thrust and torque coefficients efficiency components of the intended propulsion system wake and pressure distributions are evaluated based on our tests the highest thrust and torque coefficients are achieved at lower advance ratios for becker twisted fins while mewis ducts provided the highest value of thrust and torque coefficients at higher advance ratios maximum value for propeller behind hull efficiency relative rotative efficiency and propulsive efficiency are obtained with respect to unconventional half circular duct mewis duct and the case with no pre swirl duct based on the wake distribution analysis local deformation on the upstream wake induced by pre swirl ducts is detected moreover it is found that the vortex shedding from trailing edges of the propeller blades has led to a defection on the downstream wake field keywords pre swirl duct self propulsion test propulsion performance cfd 1 introduction due to recent regulations such as imo tier iii marine industries paid specific attention to ship emission reduction and increase in energy efficiency energy saving devices esds are one of the fundamental answers to address this challenge the main goal of esds is reduction in energy loss during sailing or recovery of some parts of the energy lost indeed some esds such as pre or post swirl devices recover the rotational losses in the propeller by fins while other esds including wake equalizing systems regain the resistance losses i e viscous term and improve the thrust via using ducts or fins improving the inflow on the propeller plane is the main objective of the embedded esds before the marine propellers while esds after the propellers are impressive in the rotational flow of the propeller slipstream the esds before the propeller e g pre swirl ducts are in interaction with the final stage of the boundary layer and non uniform wake field around the ship hull which will lead to energy loss so far several esds are proposed whereas only the cost effective simple structured and user friendly ones have been employed among different typical esds mewis duct and becker twisted fins mewis 2008 2009 as pre swirl ducts are among the most effective and interested esds where the number of their orders was about 1000 in 2015 mewis and zimmermann 2016 generally pre swirl ducts are used as one of the main esds to remove the mean tangential flow of the propeller slipstream with the aim of reducing the rotational and wake losses in fig 1 background history of mewis duct and becker twisted fins is presented as can be seen in fig 1 the idea behind two esds categories including rotational losses and wake losses resulted in the innovation of mewis duct one of the first attempts to reduce the rotational losses returns to the invention of contra propeller in 1836 by erikson kravitz 2011 in 1929 wagner 1929 reported on 25 years experience with the contra rotating propeller principle afterwards mewis and peters 1986 offered a novel fin system sva fin system to decrease the rotation losses in 1992 lee et al 1992 developed the daewoo pre swirl system pss to improve the propulsion efficiency on the other hand the first attempt to reduce the wake losses goes back to the invention of ducted propeller in 1927 by kort sacks and burnell 1962 in 1949 a pre ducted propeller was invented by lammeren which is known as lammeren duct van lammeren 1949 in 1986 a well known device for decreasing the wake losses is introduced by schneekluth 1986 he offered wake equalizing duct wed in order to increase the entire propulsive performance of the considered vessel by diminishing the amount of separation over the after body of the vessel indeed weds provide more uniform inflow into the propeller by minimizing the tangential velocity i e accelerate of flow upper zone of the propeller carlton 2012 in 1997 sasaki and aono 1997a 1997b invented the sumitomo integrated lammeren duct sild for a very large crude carriers in sild twisted stators are embedded in the ducts to produce a swirling flow of opposite direction to the propeller rotation using the concept of esds for reducing the rotational and wake losses in 2008 the mewis duct mewis 2008 2009 was originally developed for container ships and bulk carriers mewis duct is a combination of a wake equalizing duct and pre swirl fins this esd indicates an average energy savings of 6 3 guiard and leonard 2013 the mewis duct has a number of pre swirl fins which are embedded in orientation of shaft s centerline the mewis ducts equalize and accelerate the ship hulls wake into the propeller and also generate net forward thrust in addition pre swirl fins reduce the rotational losses and also bring about the recovery of the rotational energy in the slipstream of the propeller moreover an improved slipstream behind the duct significantly reduces the hub vortex which will lead to improving the thrust and flow into the rudder in 2012 the concept of mewis duct was extended for using in faster ship with lower block coefficient and a new esds called the becker twisted fins was invented guiard and leonard 2013 becker twisted fins have similar design idea in comparison with mewis duct likewise becker twisted fins has a radial series of pre swirl fins encased with a pre duct it also has a series of radial outer pre swirl fins fitted with winglet type end plates it is notable that all fins are twisted for optimal pre swirl generation marine propellers operate under different environmental conditions which result in induce of loads on propulsive system which are in turn effective on the parameter of the propeller wake that causes energy loss several researchers have investigated the physical phenomenon with experiments and computations dubbioso et al 2014 mahmoodi et al 2018 shora et al 2018 recently several researches have also studied the propulsion performance of ships equipped by esds with experimental and computational tests mizzi et al 2014 2017 park et al 2015 kim et al 2015 coache and fernández 2016 sasaki et al 2016 go et al 2017 for example a new technique for developing the model scale results into the full scale results for a ship equipped with esds is suggested by park et al 2015 they analyzed this method to predict the propulsive performance of kvlcc2 which is equipped by pss kim et al 2015 studied a new esd in combination with duct and controllable fins for 317 kvlcc their study indicated that using this esd results in improving the propulsive efficiency by recovering the wake fraction coache and fernández 2016 designed and studied different esds i e pss pre duct and rudder bulb for bulk carrier they indicted that pss has superior effects on propulsion efficiency compared to two other esds in this regard the capability of twin rudder with unsymmetrical wing for bulk carrier is studied by sasaki et al 2016 via both cfd and experimental analysis their tested esd provided about 7 8 recovery of energy loss the effects of duct before the marine propeller are also investigated by go et al 2017 this study is conducted at different duct diameter and fluid flow angle of attack in 2017 esd of propeller boss cap fins pbcf is also optimized using cfd analysis by mizzi et al 2017 they found about 1 3 of energy saving by pbcf moreover various researchers have further investigated the effects of esds on propeller performance for example dang et al 2012 conducted phenomenological investigations on the fundamental working procedure and the effects of three different esds of pre duct equipped by interior stator pds pss and hub fines on propeller performance using cfd and particle image velocimetry piv tests mechanism and impression of duct on the propeller performance vlcc is numerically studied by yuhai et al 2013 martinas 2015 numerically studied the effects of weds on marine propeller cavitation and they came to this conclusion that weds have no significant effects on the cavitation of the propeller shin et al 2013 studied two kinds of pre swirl duct i e unconventional half circular duct and conventional circular pre swirl duct for vlcc ship with large block coefficients using experiment and cfd study they proved that using the pre swirl duct will lead to a reduction in blade surface and tip vortex cavitation hanaoka et al 2016 predicted the open water thrust and torque of propellers equipped by pres swirl ducts with different positions of the propeller and duct using the quasi continuous method qcm their study indicated that different positioning of duct in front of the propeller has insignificant improvement on open water characteristics of the propeller recently gaggero 2018 optimized pbcf to reduce the hub vortex by cfd analysis using openfoam he found an improvement about 1 up to 4 on propulsion efficiency by using this energy saving device in another study gaggero et al 2017 optimized the nozzle of ducted propeller using ranse based method contra rotating propellers set is also optimized using cfd analysis genetic algorithm and kriging approach by nouri et al 2018 in 2018 owen et al 2018 investigated the influence of bio fouling on the efficiency loss of potsdam propeller test case the results indicated that as the advance ratio increases about 11 9 up to 30 3 loss is obtained for bio fouling propeller compared to the smooth propeller to our best of knowledge the effects of different pre swirl ducts i e mewis duct becker twisted fins and unconventional half circular duct on propulsion performance of conventional ship have not been studied so far moreover the study gap related to phenomenological investigation on fluid flow behavior i e the wake distribution under different types of pre swirl ducts is detectable in addition one can conclude that the performance of mewis duct becker twisted fins and unconventional half circular duct are depended on the ship hull form ship velocity etc therefore the main purpose of the present study is to evaluate the influences of three various pre swirl ducts i e mewis duct becker twisted fins and unconventional half circular duct by self propulsion experimental test and cfd simulations in the current investigation the performances of the intended pre swirl ducts are experimentally studied via assessing the propeller thrust and torque efficiency components of intended propulsion system under various hull velocities i e froude number and rotational velocities of the propellers then for a better investigation generated vortex pressure distribution on propellers and ducts surfaces as well as the wake distribution are studied by cfd analysis this paper is organized as follows the experimental setup is presented in section 2 then the numerical procedure and cfd simulation details are described in section 3 in section 4 the experimental results of the thrust and torque efficiency components of the intended propulsion system cfd results of the generated vortex pressure distribution on propeller and pre swirl ducts along with the wakes distributions are all presented and discussed section 5 is dedicated to the conclusions 2 experimental setup self propulsion experimental measurements are conducted in the towing tank of national iranian marine laboratory nimala tehran iran based on ittc 2002 guidelines propulsion committee 2002 the main characteristics of nimala towing tank are presented in table 1 najafi et al 2018 in the present study we have used a series 60 ship as the standard conventional ship series in the considered hull model dynamic and geometrical similarities are also justified for hull model we fabricated the hull model by fiberglass composite besides the maximum of froude number flow reynolds number and blockage factor are considered to determine the proper dimensions of hull model for this purpose froude number is used in dynamic similarity as follows by geometrical scale factor of 27 09 where the maximum full scale hull velocity is 13 06 m s and minimum full scale hull velocity is considered to be 4 184 m s 1 f r m f r s v m 2 l m v s 2 l s l s l m λ v s v m 2 v m 1 λ v s f o r max i m u m v e l o c i t y λ 27 09 v s 13 06 v m 2 151 f o r min i m u m v e l o c i t y λ 27 09 v s 4 184 v m 0 804 based on eq 1 the intended hull model has a scale ratio of 1 27 09 the maximum test speed in towing tank is also obtained i e 2 151 m s equal to fr 0 321 moreover to prevent the blockage effects testing and extrapolation methods are conducted based on ittc guidelines resistance committee 2011 indeed the dimensions of the towing tank should be large enough to prevent wall and blockage impressions according to ittc guidelines resistance committee 2011 in order to evaluate the blockage effects the ratio between the maximum cross sectional area of the model ax and the sectional area of the tanks a is calculated in the present study by geometrical scale factor of 27 09 as follows 2 m a x a 0 504 24 0 021 generally the blockage effect is negligible for m 0 1 therefore the blockage effect factor is m 0 021 0 1 that shows insignificant effect of blockage on our experimental results on the other hand the flow around the full scale ships is fully turbulent where re v s l s ν 5 17 10 8 while for the lowest tested velocity we have re v m l m ν 3 67 10 6 since the model test reynolds number for the lowest tested velocity is lower than 5 10 6 according to ittc recommendation resistance committee 2011 copper string with size of 500 μm is used as the turbulence stimulator at the bow to ensure flow instability and turbulence around the hull model the main hull and the model dimensions are tabulated as can be seen in table 2 moreover the model of the intended pre swirl ducts and propeller are made of plastic material using 3d scanned printer the main specifications of the basic model of ducts and selected propeller are also tabulated in table 3 fig 2 shows the fabricated hull model and b series propeller in the case with no pre swirl duct also the 3d schematic and fabricated model of pre swirl ducts are presented in fig 3 3 numerical procedure for 3d cfd simulations the navier stokes and the continuity equations are used by applying the reynolds averaging approach for the turbulence modeling the navier stokes equations can be expressed in cartesian tensor form as follows 3 u i x i 0 4 t ρ u i x j ρ u i u j p x i x j μ u i x j u j x i x j ρ u i u j x i and x j are cartesian coordinates u i and u j are the corresponding velocity components while p ρ and μ are pressure density and viscosity respectively moreover steady state solution of governing eqs 3 and 4 are also considered i e t ρ u i 0 in the present study star ccm commercial software is implemented which discretized the continuous equations using the finite volume method fvm further details of the implementation may be found in the star ccm manuals cd adapco 2014 the selected time step has been calculated in such a way that the propeller rotates between 0 5 and 2 per time step according to international towing tank conference ittc recommendation ittc 2014 ittc 2014 accordingly for all the simulations in the present study 1 per time step is selected that is equal to 1 0e 4s in addition the pressure velocity coupling and the overall solution procedure based on the semi implicit method is used in pressure linked equation simple algorithm also the simple second order scheme was used in pressure and convection terms and second order central difference scheme is applied in diffusion terms the free surface was simulated using the vof volume of fluid multiphase model based on the high resolution interface capturing hric in the present study the k ω sst turbulence model is implemented which is the adopted model for simulating the flow around a propeller baek et al 2015 moreover a second order fully implicit scheme is used for time discretization in our computational domain velocity inlet outlet associated with hydrostatic pressure condition and hull body with wall free slip boundary condition is implemented this computational domain is large enough to avoid boundary impression on our solutions the schematic of the computational domain boundary conditions and domain extent are illustrated in fig 4 as can be seen in fig 4 according to the physical nature of our problem inlet velocity i e spatially uniform velocity as inflow is used equal to hull velocity moreover as suggest in the literature yousefi et al 2014 veysi et al 2015 hydrostatic pressure is considered for the outflow where the details of fluid flow properties aren t specified and only the hydrostatic pressure according to depth of water is known it s notable that we considered computational domain large enough to avoid the effects of outflow on the upstream fluid flow yousefi et al 2014 jiang et al 2016 rigid walls with free slip boundary condition are also used for hull body and other boundaries for evaluating the efficiency of the considered propulsive system five different efficiency factors are investigated as follows 5 η o t o v a 2 π n q o η h r t v t v a η r t t o q o q η b η o η r η d η o η h η r where η o η h η r η b and η d are open water hull relative rotative propeller behind of hull and propulsive efficiencies respectively moreover t and q are thrust and torque in which the sub index of o shows the open water condition in addition v a v and r t are advanced velocity hull velocity and the total resistance respectively 3 1 mesh sensitivity analysis accurate cfd results are depended to generated meshes for this purpose in the current study cut cell grids with prismatic layer meshes are used local high mesh resolution is also applied to the blades of the considered propeller as well as the edges of pre swirl ducts convergence analysis is also performed to achieve mesh independent results to this accomplishment an extensive mesh sensitivity analysis is conducted to investigate the grid independency of our computed results under different propeller rotational and hull velocities as an example for the higher tested rotational velocity n 1050 rpm i e 17 5 rps and hull velocity of 2 151 m s i e fr 0 321 the results obtained from the four mesh sizes i e coarse medium fine and finer resolutions are presented in fig 5 compared to the experimental data as can be seen in fig 5 we compared cfd results of kt and kq for mewis duct becker twisted fins and unconventional half circular duct to one another and the case with no duct is compared to the experimental data thus an approximately monotonic trend without any oscillation is achieved based on fig 5 the fine mesh is selected as the considered mesh resolution details of which are tabulated in table 4 along with the calculated errors on kt and kq compared to experimental data and computational costs the current simulation was performed using a supercomputer each node of this supercomputer has 16 cores of 2 55 ghz amd processor with 32 gb of ram the selected unstructured mesh on the ship hull and considered pre swirl ducts are also illustrated in fig 6 as can be seen in fig 6 a sliding block surrounding the propeller as the unstructured girds is used to apply the influences of the propeller rotation the unstructured fixed grids are also implemented to the surface of pre swirl ducts and hull of the considered ship on the other hand the structured girds are utilized in other parts of our computational domain continued based on grid convergence method cgi proposed by celik et al 2008 a formal verification are conducted on our grid sensitivity analysis in this method the average of p as the apparent order of method is celik et al 2008 6 p a v g 1 ln r 21 ln ε 32 ε 21 q p a v g where 7 q p a v g ln r 21 p a v g s r 32 p a v g s here the refinement factor for three different meshes i e 1 coarse 2 medium and 3 fine are r 21 n c 2 n c 1 and r 32 n c 3 n c 2 nci is the i th number of cells moreover for intended parameter of φ in the current study kt and kq we have ε 21 φ 2 φ 1 and ε 32 φ 3 φ 2 in this case the extrapolated value is 8 φ e x t 32 r 32 p a v g φ 2 φ 3 r 32 p a v g 1 now we can define the approximated relative error eq 9 extrapolated relative error eq 10 and fine grid convergence index eq 11 as follows 9 e a 32 φ 2 φ 3 φ 2 10 e e x t 32 φ e x t 23 φ 2 φ e x t 23 11 g c i f i n e 32 1 25 e a 32 r 32 p a v g 1 in tables 5 and 6 these parameters are computed for considered variables of kt and kq respectively as can be seen in tables 5 and 6 the maximum uncertainties are obtained g c i f i n e 32 6 60 for kt and g c i f i n e 32 6 73 for kq finally based on fig 5 and tables 4 6 we selected the fine mesh from our mesh sensitivity analysis for our further cfd simulations 4 results and discussions in this section preliminary experimental results of thrust and torque coefficients and efficiency components of the intended propulsion system equipped with pre swirl ducts under different hull velocity and rotational velocity of the considered propeller are evaluated then for better phenomenology the results achieved from cfd simulations are presented and discussed it is also notable that propulsion performance of a conventional series 60 ship is evaluated by some criteria such as thrust coefficient kt torque coefficient kq and different components of the propulsion system efficiencies i e hull efficiency ηh relative rotative efficiency ηr propeller behind the hull efficiency ηb and propulsive efficiency ηd indeed for better phenomenology on hydrodynamic behavior of the considered propeller under the cases with no duct compared to the cases of propulsion system equipped with different pre swirl ducts kt and kq are evaluated as the effective parameters on the propulsive performance then the considered different components of propulsion efficiencies are also computed and discussed under the experimental self propulsion tests thrust and torque of the intended propeller are measured using propeller dynamometer at different revolution rates moreover thrust and torque of the propeller and the force applied to the model ship are measured via resistance dynamometer as stated before all the measurements recording rates and data analyses are handled according to ittc guidelines and procedures ittc 2002 propulsion committee 2002 moreover the propulsive performances for different pre swirl ducts are evaluated under the same condition i e model point for each tested velocity froude number indeed under the experimental self propulsion tests at each tested velocity froude number we changed the revolution rates of the propeller via electromotor up to the self propulsion point of the model towing force is zero i e rt t then at the interpolated revolution rate at a fixed propeller diameter d 0 15 m and tested velocity we obtained a special value for the advance ratio j at this j value t and q are measured by interpolation thus kt and kq are achieved afterwards based on the thrust identity method and according to open water thrust and torque diagram of the intended propeller the j value and kq0 are achieved and consequently t0 and q0 are calculated finally by using t0 q0 n t and rt measured by dynamometers five different efficiency factors of the considered propulsive systems equipped by pre swirl duct are calculated according to eq 3 at the same condition based on the above methodology in the next sub section the resistance of the bare hull of the series 60 model and open water hydrodynamic characteristics of the intended propeller is measured preliminarily then the measured thrust and torque for each tested velocity are presented under some revolution rates as examples of different tested revolution rates see tables 7 and 8 subsequently kt kq ηb ηr ηh and ηd vs special value for advance ratios j found based on thrust identity method are presented for the cases of with no duct mewis duct becker twisted fins and unconventional half circular duct see figs 9 14 finally for a better evaluation of different considered pre swirl ducts at the same tested velocities the propulsive efficiency vs tested froude numbers i e as the representative for each tested velocities is illustrated in fig 15 for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct 4 1 experimental results we measured the resistance for the bare hull of the series 60 model as illustrated in fig 7 in addition according to the open water test conducted on the considered b series propeller open water hydrodynamic characteristics under different advance ratios are extracted as can be seen in fig 8 after the open water test self propulsion tests are conducted in cases of with no duct mewis duct becker twisted fins and unconventional half circular duct under different hull model velocities i e froude number fr and rotational velocities of the propellers as illustrated in table 7 experimental and numerical thrust and torque results for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct under different hull model velocities and rotational velocities of the propellers are tabulated in detail in tables 8 and 9 respectively as can be seen in table 8 an appropriate accordance is achieved between our cfd results of thrust value compared to the experimental data with 6 72 maximum error in addition according to table 9 the 9 14 maximum error is obtained for cfd results of torque value compared to the experimental data moreover the thrust and torque coefficients for different pre swirl ducts in comparison to the case with no duct are depicted in figs 9 and 10 respectively in addition the self propulsion conditions for each presented data in figs 9 15 are tabulated in table 10 as can be seen in figs 9 and 10 the thrust and torque coefficients for all pre swirl ducts decrease as the advance ratio value increases up to 1 and later they increase linearly however in the case with no duct the thrust and torque coefficients decrease as the advance ratio increases up to 0 97 and later they increase to the point that the advance ratio becomes 1 05 and afterwards they decrease again based on the comparison between different pre swirl ducts one can conclude that for lower advance ratios becker twisted fins shows higher thrust and torque coefficient whereas for higher advance ratios mewis ducts provide larger thrust and torque coefficients the thrust reflects the total drag force which is composed of the drag forces of the pre swirl duct and hub as well as the blades of the propeller the reason behind this fact may be related to an improvement in the wake achieved by the pre swirl mewis duct and the reduction of the rotational losses acquired by the pre fin system in becker twisted fins on the other hand as can be seen in fig 9 similar trend reduction of kt with the increase of j value on kt value compared to fig 8 is detectable for j up to 0 97 however for j 0 97 the trend of kt is changed and it is increased by the enhancement of j value especially for cases of pre swirl ducts the reason behind this fact may be related to the origin of the wake resulted from wave field indeed the wave crest and trough at the propeller location are effective on the wave wake which is impressive in the value and angle of the resulted velocity vr i e resultant velocity of va and 2πnr at the propeller plane as a result changes of the value and angle of the vr directly change the value and trend of the thrust and torque coefficient therefore in our test cases the reason for changing kt and kq trend at the higher j value i e corresponding to a particular fr may be related to the wave wake field the crest and trough of the generated waves by the ship hull at the location of the propeller for a better study on the effects of different pre swirl ducts on the efficiency components of the propulsion system propellers behind the hull efficiency and relative rotative efficiency for different considered pre swirl ducts are presented in figs 11 and 12 respectively as can be seen in fig 11 cases of with no duct and unconventional half circular duct have higher propeller behind the hull efficiency compared to the other cases however in some advance ratios i e j 1 05 becker twisted fins has the highest open water efficiency while in more advance ratios the case of mewis duct has the lowest propeller behind the hull efficiency fig 12also shows that mewis duct has the higher relative rotative efficiency particularly for the advance ratios between 0 85 up to 1 moreover hull efficiency ηh and propulsive efficiency ηd for different pre swirl ducts are presented in figs 13 and 14 respectively as may be seen in figs 13 and 14 ηh and ηd in case with no duct is greater than the other cases afterwards greater hull efficiency is achieved for becker twisted fins and unconventional half circular duct while the lower one is obtained for mewis duct it is notable that when open water efficiency see fig 8 hull efficiency as η h r t v t v a see fig 13 and relative rotative efficiency η r t t o q o q see fig 12 are available the propulsive efficiency η d can be calculated without the information about thrust deduction factor i e t via the governing equation η d η o η h η r we also presented the ηd in case of with no duct compared to the case of using pre swirl ducts at different froude number fr as can be seen in fig 15 according to the comparison between the results achieved from fig 14 and fig 15 it should be noted that the advance velocity va increases by an enhancement in froude number moreover the revolution rate rps of the propeller should also be increased by an enhancement in froude number i e to arrive the ship to the considered velocity corresponding to the intended froude number which leads to a reduction in the j value based on figs 9 15 regardless of type of the pre swirl duct the values of kt 10kq and η show the same tendency to increase or decrease the patterns under different advance ratios moreover the improvement in the performance of the propulsive system using pre swirl ducts may be related to the enhancement of mass flow rate passing the propeller disk the diminishment of the slipstream rotation and the reduction of the drag force on the blades of the propeller according to figs 11 14 one can conclude that using the pre swirl ducts does not necessarily result in greater value in all the considered hydrodynamics efficiencies moreover according to fig 15 it is found that for lower froude number using pre swirl duct leads to the decrease in the propulsive efficiency while for higher froude numbers which are more compatible with the operational speed of the ship pre swirl ducts results in the increase in the propulsive efficiency since the efficiencies of the propulsive system will face large losses by a decrease in the ratio of the considered propeller thrust per the summation of the propeller thrust and duct from a certain limit also the geometry factors of the pre swirl duct such as the type of the hydrofoil the length of the chord the distance between the pre swirl duct and the propeller etc are significantly impressive in the efficiency of the propulsive system 4 2 cfd results for better phenomenology on fluid flow behavior around different considered pre swirl ducts cfd results of the generated vortex pressure distribution on propeller and intended pre swirl duct surfaces as well as axial radial and tangential wake distributions are presented and discussed for this purpose four measurement planes are selected as can be seen infig 16 likewise cfd results are computed at the model point condition where the model hull velocity is 2 151 m s equivalent to fr 0 321 with propeller rotational velocity n 1050 rpm i e n 17 5 rps according to j 0 821 vortexes are swirling flow regions at hub and propeller tips which are impressive inflow behavior while due to their low pressure they are prone to noise and cavitation generation to capture the hub and blade vortexes iso contours of the deformation tensor based on the mean rate of the strain velocity distribution and vorticity magnitude i e vorticity is calculated according to curl of the velocity field ω v are calculated and plotted the morphology of the generated propeller vortex for considered cases are depicted in fig 17 furthermore fig 17 shows that larger hub vortex is generated in case with no duct while smaller hub vortex is visible in case of mewis duct as can be seen in fig 17 vortex sheets are extended from the trailing edges and they merged to one another which form a hub vortex sheet vortexes will make a complex far filed wake by an interaction with tip vortexes it is notable that the hub vortex will lead to energy loss i e an unstable slipstream tube and rudder erosion on one hand due to low pressure region at the center of a hub vortex a force on the surface of the hub cap will be generated that is in the reverse direction of the thrust so as the intensity of the hub vortex increases more reduction in the efficiency of marine propulsion system is predicted on the other hand pressure induced force i e pressure reduction on the surface of the hub cap will lead to inducing a force on the rudder surface in the direction of the thrust moreover cavitations generated by hub vortex will collapse on the surface of the rudder and cause erosion especially at the leading edge of the rudder one can also conclude that the intensity of the tip vortex and the suction peak at the rudder leading edge are significant parameters in determining whether rudder erosion will occurred or not druckenbrod et al 2015 carlton et al 2009 boorsma and whitworth 2011 moreover it is detectable in fig 16 that in the cases of mewis duct and unconventional half circular duct the radii of blade vortexes are decreased compared to the cases of with no duct and becker twisted fins pressure distributions on face and back of the considered b series propeller are illustrated in figs 18 and 19 respectively based on figs 18 and 19 the value of pressure on face and back of the propeller is decreased by using mewis duct and becker twisted fins compared to the cases of with no duct and unconventional half circular duct since the pressure contours on the blade of the propellers show the intensity of the sheet vortex it can be concluded that the lower value of the pressure on face and back of the propeller in cases of mewis duct and becker twisted fins compared to two other cases indicates the lower possibility of sheet vortex generation for mewis duct and becker twisted fins pressure distribution on the face and back of the pre swirl duct is shown in fig 20 as can be seen in fig 20 the very high pressure is concentrated on the outer edge of the pres swirl ducts especially from back view on one hand hydrodynamic performances and efficiency of pre swirl ducts are directly related to the axial radial and tangential components of the advanced velocity and the kind of the fluid flow pattern i e flow uniformity indeed greater advanced velocity and uniform flow provide higher efficiency for ships equipped with pre swirl ducts in addition the components of the advanced velocity and uniformity of inflow are naturally depended on the ship s hull form and the geometrical structure of the pre swirl ducts on the other hand the wake parameter is an efficient factor to investigate the distribution rate of advanced velocity components and fluid flow pattern morphology given this fact axial radial and tangential wake distribution are analyzed to study the performance of different intended pre swirls ducts axial radial and tangential wake distribution on measurement planes for mewis duct becker twisted fins and unconventional half circular duct are illustrated in figs 21 23 respectively for more details about the tangential velocity on the measurement planes for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct fig 24 is also presented as can be seen in figs 21 23 upstream wake on measurement planes p1 and p2 shows the local deformation on the wakes induced by pre swirl duct on axial radial and tangential wake fields as can be seen in fig 21 for mewis duct wake field on propeller plane i e p3 shows that the angular evolution and effects of the propeller blades suction is visible as five lobe structures especially for axial wake distribution in addition on p3 radial distribution of cross flow is directed to the left side of the measurement plane and the peak of tangential wake field is concentrated approximately on the upward and toward the hull center in addition according to p3 in fig 22 for becker twisted fins radial and tangential distributions of cross flow is directed toward the hull center and the peak of radial and tangential wake field are concentrated approximately on the upward and downward the hull center moreover according to p3 in fig 23 for unconventional half circular duct the peak of tangential wake field is concentrated to the right half of the outer ring of the measurement plane as can be seen in figs 21 23 the downstream wake field on p4 shows no ax symmetrical morphology for axial and tangential distributions and the maximum of the axial wake is located in the right part of the center of the measurement plane also the maximum of the tangential wake is located in the right half of the measurement plane in which the hydrodynamic loads of the propeller blades is greater than that of the other parts also on p4 the wake fields are defected by shed of vortex from trailing edges of the propeller blades as can be seen in fig 24 tangential velocities have greater value on the left half of the measurement planes upstream tangential velocities on p1 indicate that more uniform distribution is visible for case with no duct however local defects on tangential velocity pattern induced by pre swirl duct and the hull boundary layer is achieved especially for case of mewis duct this velocity defection is more detectable on p2 that is related to pre swirl ducts geometrical structure where the induced effects of the propeller is only visible in case of with no duct in addition on p2 more local perturbation of velocity field is visible in case of becker twisted fins that are related to radial outer pre swirl fins it is also notable that upstream tangential velocity distribution is directly effective on thrust force and loading of the propeller blades local variation on tangential velocity of propeller plane i e p3 is achieved according to angular evolution and influences of the propeller blades suction it is notable that detached blade vortex is another reason for non uniformity of tangential velocity on p3 it is also visible that the value of tangential velocity is reduced in case of pre swirl ducts compared to with no duct in the downstream flow on p4 that is representative of a reduction in transverse losses transverse losses is directly depended on tangential velocity this reduction of transverse losses on p4 is also related to the variation of upstream tangential velocity distribution using pre swirl ducts consequently the reduction of transverse losses related to a change of cross flow using pre swirl duct is significantly impressive on the performance of the considered propulsion system see fig 15 for more details on the effects of pre swirl ducts on propulsive performance 5 conclusion in the current study the influences of three different pre swirl ducts on propulsion performance of series 60 ship are investigated to this accomplishment experimental self propulsion tests and numerical cfd analysis on mewis duct becker twisted fins and unconventional half circular duct are conducted compared to the case with no pre swirl duct among the most important findings from experimental and cfd study of the present paper the following can be referred to 1 thrust and torque coefficients for all the tested pre swirl ducts are decreased by an increase in the advance ratio up to 1 while in case of with no duct thrust and torque coefficients are decreased by up to 0 97 increase in the advance ratio in addition becker twisted fins show supreme thrust and torque coefficient at the lower value of advance ratio whereas for higher advance ratios mewis ducts provide the biggest thrust and torque coefficients compared to the other cases 2 the highest propeller behind hull efficiency is achieved for cases of with no duct and unconventional half circular duct however the highest relative rotative efficiency is detected for mewis duct especially for advance ratios between 0 85 up to 1 moreover the highest hull and propulsive efficiencies are obtained for cases of with no pre swirl duct and becker twisted fins 3 the pressure difference on face and back of the propeller is decreased by using mewis duct and becker twisted fins and the highest concentrated pressure is obtained on back of the outer edge of the pres swirl ducts 4 the upstream axial radial and tangential wake fields show the local deformation of the wakes induced by pre swirl duct axial and tangential downstream wake field also show no ax symmetrical morphology and defection of wake field by vortex shedding from the trailing edges of the propeller blades is also visible 5 the largest hub vortex and smaller one is also generated in respect of cases of with no duct and mewis duct finally it can be concluded that using the pre swirl ducts does not necessarily result in higher value in all different hydrodynamics efficiencies the inflow of the pre swirl duct is significantly dependent on the ship s hull form i e especially stern form of the ship thus it is difficult to establish a guideline to design the geometrical parameters and position of the pre swirl ducts independent of the inflow pattern therefore future investigations are needed to be conducted on the effects of geometry factors of the pre swirl duct such as the type of the hydrofoil length of the chord the distance between the pre swirl duct and the propeller on the hydrodynamic performance of these esds assessing the interaction of pre swirl ducts as efficient esds with different types of rudders on the propulsion performance of conventional and unconventional ships can also be considered in future works acknowledgment cfd computations presented in this paper have been performed on the parallel machines of the high performance computing research center hpcrc of amirkabir university of technology aut their supports are gratefully acknowledged appendix 1 detailed coordinates of the selected hydrofoils in the intended pre swirl ducts are presented in tables a1 and a 2 table a 1 detailed of x y coordinates of selected hydrofoils for ducts table a 1 row x y row x y 1 1 0 25 0 5 0 10538 2 0 99893 0 00039 26 0 4673 0 10837 3 0 99572 0 00156 27 0 43474 0 11076 4 0 99039 0 00349 28 0 40245 0 11248 5 0 98296 0 0061 29 0 37059 0 11345 6 0 97347 0 00932 30 0 33928 0 11361 7 0 96194 0 01303 31 0 30866 0 11294 8 0 94844 0 01716 32 0 27886 0 11141 9 0 93301 0 02166 33 0 25 0 10903 10 0 91573 0 02652 34 0 22221 0 10584 11 0 89668 0 03171 35 0 19562 0 1019 12 0 87592 0 03717 36 0 17033 0 09726 13 0 85355 0 04283 37 0 14645 0 09195 14 0 82967 0 04863 38 0 12408 0 08607 15 0 80438 0 05453 39 0 10332 0 0797 16 0 77779 0 06048 40 0 08427 0 07283 17 0 75 0 06642 41 0 06699 0 06541 18 0 72114 0 07227 42 0 05156 0 05753 19 0 69134 0 07795 43 0 03806 0 04937 20 0 66072 0 08341 44 0 02653 0 04118 21 0 62941 0 08858 45 0 01704 0 03303 22 0 59755 0 09341 46 0 00961 0 02489 23 0 56526 0 09785 47 0 00428 0 01654 24 0 5327 0 10185 48 0 00107 0 00825 table a 2 detailed x y coordinates of selected hydrofoils for fins table a 2 row x y row x y 1 1 0 0012 17 0 0 2 0 95 0 01027 18 0 0125 0 01813 3 0 9 0 01867 19 0 025 0 02453 4 0 8 0 0332 20 0 05 0 03267 5 0 7 0 0448 21 0 075 0 03813 6 0 6 0 0532 22 0 1 0 0424 7 0 5 0 05827 23 0 15 0 04867 8 0 4 0 06 24 0 2 0 05293 9 0 3 0 05827 25 0 3 0 05827 10 0 2 0 05293 26 0 4 0 06 11 0 15 0 04867 27 0 5 0 05827 12 0 1 0 0424 28 0 6 0 0532 13 0 075 0 03813 29 0 7 0 0448 14 0 05 0 03267 30 0 8 0 0332 15 0 025 0 02453 31 0 9 0 01867 16 0 0125 0 01813 32 1 0 0012 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 01 007 
23005,in the present paper the effects of three different pre swirl ducts on propulsion performance of a series 60 ship in comparison to the case with no duct are explored experimentally by self propulsion test measurements and cfd analysis to this accomplishment mewis duct becker twisted fins and unconventional half circular ducts are considered for investigating the propulsion performance thrust and torque coefficients efficiency components of the intended propulsion system wake and pressure distributions are evaluated based on our tests the highest thrust and torque coefficients are achieved at lower advance ratios for becker twisted fins while mewis ducts provided the highest value of thrust and torque coefficients at higher advance ratios maximum value for propeller behind hull efficiency relative rotative efficiency and propulsive efficiency are obtained with respect to unconventional half circular duct mewis duct and the case with no pre swirl duct based on the wake distribution analysis local deformation on the upstream wake induced by pre swirl ducts is detected moreover it is found that the vortex shedding from trailing edges of the propeller blades has led to a defection on the downstream wake field keywords pre swirl duct self propulsion test propulsion performance cfd 1 introduction due to recent regulations such as imo tier iii marine industries paid specific attention to ship emission reduction and increase in energy efficiency energy saving devices esds are one of the fundamental answers to address this challenge the main goal of esds is reduction in energy loss during sailing or recovery of some parts of the energy lost indeed some esds such as pre or post swirl devices recover the rotational losses in the propeller by fins while other esds including wake equalizing systems regain the resistance losses i e viscous term and improve the thrust via using ducts or fins improving the inflow on the propeller plane is the main objective of the embedded esds before the marine propellers while esds after the propellers are impressive in the rotational flow of the propeller slipstream the esds before the propeller e g pre swirl ducts are in interaction with the final stage of the boundary layer and non uniform wake field around the ship hull which will lead to energy loss so far several esds are proposed whereas only the cost effective simple structured and user friendly ones have been employed among different typical esds mewis duct and becker twisted fins mewis 2008 2009 as pre swirl ducts are among the most effective and interested esds where the number of their orders was about 1000 in 2015 mewis and zimmermann 2016 generally pre swirl ducts are used as one of the main esds to remove the mean tangential flow of the propeller slipstream with the aim of reducing the rotational and wake losses in fig 1 background history of mewis duct and becker twisted fins is presented as can be seen in fig 1 the idea behind two esds categories including rotational losses and wake losses resulted in the innovation of mewis duct one of the first attempts to reduce the rotational losses returns to the invention of contra propeller in 1836 by erikson kravitz 2011 in 1929 wagner 1929 reported on 25 years experience with the contra rotating propeller principle afterwards mewis and peters 1986 offered a novel fin system sva fin system to decrease the rotation losses in 1992 lee et al 1992 developed the daewoo pre swirl system pss to improve the propulsion efficiency on the other hand the first attempt to reduce the wake losses goes back to the invention of ducted propeller in 1927 by kort sacks and burnell 1962 in 1949 a pre ducted propeller was invented by lammeren which is known as lammeren duct van lammeren 1949 in 1986 a well known device for decreasing the wake losses is introduced by schneekluth 1986 he offered wake equalizing duct wed in order to increase the entire propulsive performance of the considered vessel by diminishing the amount of separation over the after body of the vessel indeed weds provide more uniform inflow into the propeller by minimizing the tangential velocity i e accelerate of flow upper zone of the propeller carlton 2012 in 1997 sasaki and aono 1997a 1997b invented the sumitomo integrated lammeren duct sild for a very large crude carriers in sild twisted stators are embedded in the ducts to produce a swirling flow of opposite direction to the propeller rotation using the concept of esds for reducing the rotational and wake losses in 2008 the mewis duct mewis 2008 2009 was originally developed for container ships and bulk carriers mewis duct is a combination of a wake equalizing duct and pre swirl fins this esd indicates an average energy savings of 6 3 guiard and leonard 2013 the mewis duct has a number of pre swirl fins which are embedded in orientation of shaft s centerline the mewis ducts equalize and accelerate the ship hulls wake into the propeller and also generate net forward thrust in addition pre swirl fins reduce the rotational losses and also bring about the recovery of the rotational energy in the slipstream of the propeller moreover an improved slipstream behind the duct significantly reduces the hub vortex which will lead to improving the thrust and flow into the rudder in 2012 the concept of mewis duct was extended for using in faster ship with lower block coefficient and a new esds called the becker twisted fins was invented guiard and leonard 2013 becker twisted fins have similar design idea in comparison with mewis duct likewise becker twisted fins has a radial series of pre swirl fins encased with a pre duct it also has a series of radial outer pre swirl fins fitted with winglet type end plates it is notable that all fins are twisted for optimal pre swirl generation marine propellers operate under different environmental conditions which result in induce of loads on propulsive system which are in turn effective on the parameter of the propeller wake that causes energy loss several researchers have investigated the physical phenomenon with experiments and computations dubbioso et al 2014 mahmoodi et al 2018 shora et al 2018 recently several researches have also studied the propulsion performance of ships equipped by esds with experimental and computational tests mizzi et al 2014 2017 park et al 2015 kim et al 2015 coache and fernández 2016 sasaki et al 2016 go et al 2017 for example a new technique for developing the model scale results into the full scale results for a ship equipped with esds is suggested by park et al 2015 they analyzed this method to predict the propulsive performance of kvlcc2 which is equipped by pss kim et al 2015 studied a new esd in combination with duct and controllable fins for 317 kvlcc their study indicated that using this esd results in improving the propulsive efficiency by recovering the wake fraction coache and fernández 2016 designed and studied different esds i e pss pre duct and rudder bulb for bulk carrier they indicted that pss has superior effects on propulsion efficiency compared to two other esds in this regard the capability of twin rudder with unsymmetrical wing for bulk carrier is studied by sasaki et al 2016 via both cfd and experimental analysis their tested esd provided about 7 8 recovery of energy loss the effects of duct before the marine propeller are also investigated by go et al 2017 this study is conducted at different duct diameter and fluid flow angle of attack in 2017 esd of propeller boss cap fins pbcf is also optimized using cfd analysis by mizzi et al 2017 they found about 1 3 of energy saving by pbcf moreover various researchers have further investigated the effects of esds on propeller performance for example dang et al 2012 conducted phenomenological investigations on the fundamental working procedure and the effects of three different esds of pre duct equipped by interior stator pds pss and hub fines on propeller performance using cfd and particle image velocimetry piv tests mechanism and impression of duct on the propeller performance vlcc is numerically studied by yuhai et al 2013 martinas 2015 numerically studied the effects of weds on marine propeller cavitation and they came to this conclusion that weds have no significant effects on the cavitation of the propeller shin et al 2013 studied two kinds of pre swirl duct i e unconventional half circular duct and conventional circular pre swirl duct for vlcc ship with large block coefficients using experiment and cfd study they proved that using the pre swirl duct will lead to a reduction in blade surface and tip vortex cavitation hanaoka et al 2016 predicted the open water thrust and torque of propellers equipped by pres swirl ducts with different positions of the propeller and duct using the quasi continuous method qcm their study indicated that different positioning of duct in front of the propeller has insignificant improvement on open water characteristics of the propeller recently gaggero 2018 optimized pbcf to reduce the hub vortex by cfd analysis using openfoam he found an improvement about 1 up to 4 on propulsion efficiency by using this energy saving device in another study gaggero et al 2017 optimized the nozzle of ducted propeller using ranse based method contra rotating propellers set is also optimized using cfd analysis genetic algorithm and kriging approach by nouri et al 2018 in 2018 owen et al 2018 investigated the influence of bio fouling on the efficiency loss of potsdam propeller test case the results indicated that as the advance ratio increases about 11 9 up to 30 3 loss is obtained for bio fouling propeller compared to the smooth propeller to our best of knowledge the effects of different pre swirl ducts i e mewis duct becker twisted fins and unconventional half circular duct on propulsion performance of conventional ship have not been studied so far moreover the study gap related to phenomenological investigation on fluid flow behavior i e the wake distribution under different types of pre swirl ducts is detectable in addition one can conclude that the performance of mewis duct becker twisted fins and unconventional half circular duct are depended on the ship hull form ship velocity etc therefore the main purpose of the present study is to evaluate the influences of three various pre swirl ducts i e mewis duct becker twisted fins and unconventional half circular duct by self propulsion experimental test and cfd simulations in the current investigation the performances of the intended pre swirl ducts are experimentally studied via assessing the propeller thrust and torque efficiency components of intended propulsion system under various hull velocities i e froude number and rotational velocities of the propellers then for a better investigation generated vortex pressure distribution on propellers and ducts surfaces as well as the wake distribution are studied by cfd analysis this paper is organized as follows the experimental setup is presented in section 2 then the numerical procedure and cfd simulation details are described in section 3 in section 4 the experimental results of the thrust and torque efficiency components of the intended propulsion system cfd results of the generated vortex pressure distribution on propeller and pre swirl ducts along with the wakes distributions are all presented and discussed section 5 is dedicated to the conclusions 2 experimental setup self propulsion experimental measurements are conducted in the towing tank of national iranian marine laboratory nimala tehran iran based on ittc 2002 guidelines propulsion committee 2002 the main characteristics of nimala towing tank are presented in table 1 najafi et al 2018 in the present study we have used a series 60 ship as the standard conventional ship series in the considered hull model dynamic and geometrical similarities are also justified for hull model we fabricated the hull model by fiberglass composite besides the maximum of froude number flow reynolds number and blockage factor are considered to determine the proper dimensions of hull model for this purpose froude number is used in dynamic similarity as follows by geometrical scale factor of 27 09 where the maximum full scale hull velocity is 13 06 m s and minimum full scale hull velocity is considered to be 4 184 m s 1 f r m f r s v m 2 l m v s 2 l s l s l m λ v s v m 2 v m 1 λ v s f o r max i m u m v e l o c i t y λ 27 09 v s 13 06 v m 2 151 f o r min i m u m v e l o c i t y λ 27 09 v s 4 184 v m 0 804 based on eq 1 the intended hull model has a scale ratio of 1 27 09 the maximum test speed in towing tank is also obtained i e 2 151 m s equal to fr 0 321 moreover to prevent the blockage effects testing and extrapolation methods are conducted based on ittc guidelines resistance committee 2011 indeed the dimensions of the towing tank should be large enough to prevent wall and blockage impressions according to ittc guidelines resistance committee 2011 in order to evaluate the blockage effects the ratio between the maximum cross sectional area of the model ax and the sectional area of the tanks a is calculated in the present study by geometrical scale factor of 27 09 as follows 2 m a x a 0 504 24 0 021 generally the blockage effect is negligible for m 0 1 therefore the blockage effect factor is m 0 021 0 1 that shows insignificant effect of blockage on our experimental results on the other hand the flow around the full scale ships is fully turbulent where re v s l s ν 5 17 10 8 while for the lowest tested velocity we have re v m l m ν 3 67 10 6 since the model test reynolds number for the lowest tested velocity is lower than 5 10 6 according to ittc recommendation resistance committee 2011 copper string with size of 500 μm is used as the turbulence stimulator at the bow to ensure flow instability and turbulence around the hull model the main hull and the model dimensions are tabulated as can be seen in table 2 moreover the model of the intended pre swirl ducts and propeller are made of plastic material using 3d scanned printer the main specifications of the basic model of ducts and selected propeller are also tabulated in table 3 fig 2 shows the fabricated hull model and b series propeller in the case with no pre swirl duct also the 3d schematic and fabricated model of pre swirl ducts are presented in fig 3 3 numerical procedure for 3d cfd simulations the navier stokes and the continuity equations are used by applying the reynolds averaging approach for the turbulence modeling the navier stokes equations can be expressed in cartesian tensor form as follows 3 u i x i 0 4 t ρ u i x j ρ u i u j p x i x j μ u i x j u j x i x j ρ u i u j x i and x j are cartesian coordinates u i and u j are the corresponding velocity components while p ρ and μ are pressure density and viscosity respectively moreover steady state solution of governing eqs 3 and 4 are also considered i e t ρ u i 0 in the present study star ccm commercial software is implemented which discretized the continuous equations using the finite volume method fvm further details of the implementation may be found in the star ccm manuals cd adapco 2014 the selected time step has been calculated in such a way that the propeller rotates between 0 5 and 2 per time step according to international towing tank conference ittc recommendation ittc 2014 ittc 2014 accordingly for all the simulations in the present study 1 per time step is selected that is equal to 1 0e 4s in addition the pressure velocity coupling and the overall solution procedure based on the semi implicit method is used in pressure linked equation simple algorithm also the simple second order scheme was used in pressure and convection terms and second order central difference scheme is applied in diffusion terms the free surface was simulated using the vof volume of fluid multiphase model based on the high resolution interface capturing hric in the present study the k ω sst turbulence model is implemented which is the adopted model for simulating the flow around a propeller baek et al 2015 moreover a second order fully implicit scheme is used for time discretization in our computational domain velocity inlet outlet associated with hydrostatic pressure condition and hull body with wall free slip boundary condition is implemented this computational domain is large enough to avoid boundary impression on our solutions the schematic of the computational domain boundary conditions and domain extent are illustrated in fig 4 as can be seen in fig 4 according to the physical nature of our problem inlet velocity i e spatially uniform velocity as inflow is used equal to hull velocity moreover as suggest in the literature yousefi et al 2014 veysi et al 2015 hydrostatic pressure is considered for the outflow where the details of fluid flow properties aren t specified and only the hydrostatic pressure according to depth of water is known it s notable that we considered computational domain large enough to avoid the effects of outflow on the upstream fluid flow yousefi et al 2014 jiang et al 2016 rigid walls with free slip boundary condition are also used for hull body and other boundaries for evaluating the efficiency of the considered propulsive system five different efficiency factors are investigated as follows 5 η o t o v a 2 π n q o η h r t v t v a η r t t o q o q η b η o η r η d η o η h η r where η o η h η r η b and η d are open water hull relative rotative propeller behind of hull and propulsive efficiencies respectively moreover t and q are thrust and torque in which the sub index of o shows the open water condition in addition v a v and r t are advanced velocity hull velocity and the total resistance respectively 3 1 mesh sensitivity analysis accurate cfd results are depended to generated meshes for this purpose in the current study cut cell grids with prismatic layer meshes are used local high mesh resolution is also applied to the blades of the considered propeller as well as the edges of pre swirl ducts convergence analysis is also performed to achieve mesh independent results to this accomplishment an extensive mesh sensitivity analysis is conducted to investigate the grid independency of our computed results under different propeller rotational and hull velocities as an example for the higher tested rotational velocity n 1050 rpm i e 17 5 rps and hull velocity of 2 151 m s i e fr 0 321 the results obtained from the four mesh sizes i e coarse medium fine and finer resolutions are presented in fig 5 compared to the experimental data as can be seen in fig 5 we compared cfd results of kt and kq for mewis duct becker twisted fins and unconventional half circular duct to one another and the case with no duct is compared to the experimental data thus an approximately monotonic trend without any oscillation is achieved based on fig 5 the fine mesh is selected as the considered mesh resolution details of which are tabulated in table 4 along with the calculated errors on kt and kq compared to experimental data and computational costs the current simulation was performed using a supercomputer each node of this supercomputer has 16 cores of 2 55 ghz amd processor with 32 gb of ram the selected unstructured mesh on the ship hull and considered pre swirl ducts are also illustrated in fig 6 as can be seen in fig 6 a sliding block surrounding the propeller as the unstructured girds is used to apply the influences of the propeller rotation the unstructured fixed grids are also implemented to the surface of pre swirl ducts and hull of the considered ship on the other hand the structured girds are utilized in other parts of our computational domain continued based on grid convergence method cgi proposed by celik et al 2008 a formal verification are conducted on our grid sensitivity analysis in this method the average of p as the apparent order of method is celik et al 2008 6 p a v g 1 ln r 21 ln ε 32 ε 21 q p a v g where 7 q p a v g ln r 21 p a v g s r 32 p a v g s here the refinement factor for three different meshes i e 1 coarse 2 medium and 3 fine are r 21 n c 2 n c 1 and r 32 n c 3 n c 2 nci is the i th number of cells moreover for intended parameter of φ in the current study kt and kq we have ε 21 φ 2 φ 1 and ε 32 φ 3 φ 2 in this case the extrapolated value is 8 φ e x t 32 r 32 p a v g φ 2 φ 3 r 32 p a v g 1 now we can define the approximated relative error eq 9 extrapolated relative error eq 10 and fine grid convergence index eq 11 as follows 9 e a 32 φ 2 φ 3 φ 2 10 e e x t 32 φ e x t 23 φ 2 φ e x t 23 11 g c i f i n e 32 1 25 e a 32 r 32 p a v g 1 in tables 5 and 6 these parameters are computed for considered variables of kt and kq respectively as can be seen in tables 5 and 6 the maximum uncertainties are obtained g c i f i n e 32 6 60 for kt and g c i f i n e 32 6 73 for kq finally based on fig 5 and tables 4 6 we selected the fine mesh from our mesh sensitivity analysis for our further cfd simulations 4 results and discussions in this section preliminary experimental results of thrust and torque coefficients and efficiency components of the intended propulsion system equipped with pre swirl ducts under different hull velocity and rotational velocity of the considered propeller are evaluated then for better phenomenology the results achieved from cfd simulations are presented and discussed it is also notable that propulsion performance of a conventional series 60 ship is evaluated by some criteria such as thrust coefficient kt torque coefficient kq and different components of the propulsion system efficiencies i e hull efficiency ηh relative rotative efficiency ηr propeller behind the hull efficiency ηb and propulsive efficiency ηd indeed for better phenomenology on hydrodynamic behavior of the considered propeller under the cases with no duct compared to the cases of propulsion system equipped with different pre swirl ducts kt and kq are evaluated as the effective parameters on the propulsive performance then the considered different components of propulsion efficiencies are also computed and discussed under the experimental self propulsion tests thrust and torque of the intended propeller are measured using propeller dynamometer at different revolution rates moreover thrust and torque of the propeller and the force applied to the model ship are measured via resistance dynamometer as stated before all the measurements recording rates and data analyses are handled according to ittc guidelines and procedures ittc 2002 propulsion committee 2002 moreover the propulsive performances for different pre swirl ducts are evaluated under the same condition i e model point for each tested velocity froude number indeed under the experimental self propulsion tests at each tested velocity froude number we changed the revolution rates of the propeller via electromotor up to the self propulsion point of the model towing force is zero i e rt t then at the interpolated revolution rate at a fixed propeller diameter d 0 15 m and tested velocity we obtained a special value for the advance ratio j at this j value t and q are measured by interpolation thus kt and kq are achieved afterwards based on the thrust identity method and according to open water thrust and torque diagram of the intended propeller the j value and kq0 are achieved and consequently t0 and q0 are calculated finally by using t0 q0 n t and rt measured by dynamometers five different efficiency factors of the considered propulsive systems equipped by pre swirl duct are calculated according to eq 3 at the same condition based on the above methodology in the next sub section the resistance of the bare hull of the series 60 model and open water hydrodynamic characteristics of the intended propeller is measured preliminarily then the measured thrust and torque for each tested velocity are presented under some revolution rates as examples of different tested revolution rates see tables 7 and 8 subsequently kt kq ηb ηr ηh and ηd vs special value for advance ratios j found based on thrust identity method are presented for the cases of with no duct mewis duct becker twisted fins and unconventional half circular duct see figs 9 14 finally for a better evaluation of different considered pre swirl ducts at the same tested velocities the propulsive efficiency vs tested froude numbers i e as the representative for each tested velocities is illustrated in fig 15 for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct 4 1 experimental results we measured the resistance for the bare hull of the series 60 model as illustrated in fig 7 in addition according to the open water test conducted on the considered b series propeller open water hydrodynamic characteristics under different advance ratios are extracted as can be seen in fig 8 after the open water test self propulsion tests are conducted in cases of with no duct mewis duct becker twisted fins and unconventional half circular duct under different hull model velocities i e froude number fr and rotational velocities of the propellers as illustrated in table 7 experimental and numerical thrust and torque results for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct under different hull model velocities and rotational velocities of the propellers are tabulated in detail in tables 8 and 9 respectively as can be seen in table 8 an appropriate accordance is achieved between our cfd results of thrust value compared to the experimental data with 6 72 maximum error in addition according to table 9 the 9 14 maximum error is obtained for cfd results of torque value compared to the experimental data moreover the thrust and torque coefficients for different pre swirl ducts in comparison to the case with no duct are depicted in figs 9 and 10 respectively in addition the self propulsion conditions for each presented data in figs 9 15 are tabulated in table 10 as can be seen in figs 9 and 10 the thrust and torque coefficients for all pre swirl ducts decrease as the advance ratio value increases up to 1 and later they increase linearly however in the case with no duct the thrust and torque coefficients decrease as the advance ratio increases up to 0 97 and later they increase to the point that the advance ratio becomes 1 05 and afterwards they decrease again based on the comparison between different pre swirl ducts one can conclude that for lower advance ratios becker twisted fins shows higher thrust and torque coefficient whereas for higher advance ratios mewis ducts provide larger thrust and torque coefficients the thrust reflects the total drag force which is composed of the drag forces of the pre swirl duct and hub as well as the blades of the propeller the reason behind this fact may be related to an improvement in the wake achieved by the pre swirl mewis duct and the reduction of the rotational losses acquired by the pre fin system in becker twisted fins on the other hand as can be seen in fig 9 similar trend reduction of kt with the increase of j value on kt value compared to fig 8 is detectable for j up to 0 97 however for j 0 97 the trend of kt is changed and it is increased by the enhancement of j value especially for cases of pre swirl ducts the reason behind this fact may be related to the origin of the wake resulted from wave field indeed the wave crest and trough at the propeller location are effective on the wave wake which is impressive in the value and angle of the resulted velocity vr i e resultant velocity of va and 2πnr at the propeller plane as a result changes of the value and angle of the vr directly change the value and trend of the thrust and torque coefficient therefore in our test cases the reason for changing kt and kq trend at the higher j value i e corresponding to a particular fr may be related to the wave wake field the crest and trough of the generated waves by the ship hull at the location of the propeller for a better study on the effects of different pre swirl ducts on the efficiency components of the propulsion system propellers behind the hull efficiency and relative rotative efficiency for different considered pre swirl ducts are presented in figs 11 and 12 respectively as can be seen in fig 11 cases of with no duct and unconventional half circular duct have higher propeller behind the hull efficiency compared to the other cases however in some advance ratios i e j 1 05 becker twisted fins has the highest open water efficiency while in more advance ratios the case of mewis duct has the lowest propeller behind the hull efficiency fig 12also shows that mewis duct has the higher relative rotative efficiency particularly for the advance ratios between 0 85 up to 1 moreover hull efficiency ηh and propulsive efficiency ηd for different pre swirl ducts are presented in figs 13 and 14 respectively as may be seen in figs 13 and 14 ηh and ηd in case with no duct is greater than the other cases afterwards greater hull efficiency is achieved for becker twisted fins and unconventional half circular duct while the lower one is obtained for mewis duct it is notable that when open water efficiency see fig 8 hull efficiency as η h r t v t v a see fig 13 and relative rotative efficiency η r t t o q o q see fig 12 are available the propulsive efficiency η d can be calculated without the information about thrust deduction factor i e t via the governing equation η d η o η h η r we also presented the ηd in case of with no duct compared to the case of using pre swirl ducts at different froude number fr as can be seen in fig 15 according to the comparison between the results achieved from fig 14 and fig 15 it should be noted that the advance velocity va increases by an enhancement in froude number moreover the revolution rate rps of the propeller should also be increased by an enhancement in froude number i e to arrive the ship to the considered velocity corresponding to the intended froude number which leads to a reduction in the j value based on figs 9 15 regardless of type of the pre swirl duct the values of kt 10kq and η show the same tendency to increase or decrease the patterns under different advance ratios moreover the improvement in the performance of the propulsive system using pre swirl ducts may be related to the enhancement of mass flow rate passing the propeller disk the diminishment of the slipstream rotation and the reduction of the drag force on the blades of the propeller according to figs 11 14 one can conclude that using the pre swirl ducts does not necessarily result in greater value in all the considered hydrodynamics efficiencies moreover according to fig 15 it is found that for lower froude number using pre swirl duct leads to the decrease in the propulsive efficiency while for higher froude numbers which are more compatible with the operational speed of the ship pre swirl ducts results in the increase in the propulsive efficiency since the efficiencies of the propulsive system will face large losses by a decrease in the ratio of the considered propeller thrust per the summation of the propeller thrust and duct from a certain limit also the geometry factors of the pre swirl duct such as the type of the hydrofoil the length of the chord the distance between the pre swirl duct and the propeller etc are significantly impressive in the efficiency of the propulsive system 4 2 cfd results for better phenomenology on fluid flow behavior around different considered pre swirl ducts cfd results of the generated vortex pressure distribution on propeller and intended pre swirl duct surfaces as well as axial radial and tangential wake distributions are presented and discussed for this purpose four measurement planes are selected as can be seen infig 16 likewise cfd results are computed at the model point condition where the model hull velocity is 2 151 m s equivalent to fr 0 321 with propeller rotational velocity n 1050 rpm i e n 17 5 rps according to j 0 821 vortexes are swirling flow regions at hub and propeller tips which are impressive inflow behavior while due to their low pressure they are prone to noise and cavitation generation to capture the hub and blade vortexes iso contours of the deformation tensor based on the mean rate of the strain velocity distribution and vorticity magnitude i e vorticity is calculated according to curl of the velocity field ω v are calculated and plotted the morphology of the generated propeller vortex for considered cases are depicted in fig 17 furthermore fig 17 shows that larger hub vortex is generated in case with no duct while smaller hub vortex is visible in case of mewis duct as can be seen in fig 17 vortex sheets are extended from the trailing edges and they merged to one another which form a hub vortex sheet vortexes will make a complex far filed wake by an interaction with tip vortexes it is notable that the hub vortex will lead to energy loss i e an unstable slipstream tube and rudder erosion on one hand due to low pressure region at the center of a hub vortex a force on the surface of the hub cap will be generated that is in the reverse direction of the thrust so as the intensity of the hub vortex increases more reduction in the efficiency of marine propulsion system is predicted on the other hand pressure induced force i e pressure reduction on the surface of the hub cap will lead to inducing a force on the rudder surface in the direction of the thrust moreover cavitations generated by hub vortex will collapse on the surface of the rudder and cause erosion especially at the leading edge of the rudder one can also conclude that the intensity of the tip vortex and the suction peak at the rudder leading edge are significant parameters in determining whether rudder erosion will occurred or not druckenbrod et al 2015 carlton et al 2009 boorsma and whitworth 2011 moreover it is detectable in fig 16 that in the cases of mewis duct and unconventional half circular duct the radii of blade vortexes are decreased compared to the cases of with no duct and becker twisted fins pressure distributions on face and back of the considered b series propeller are illustrated in figs 18 and 19 respectively based on figs 18 and 19 the value of pressure on face and back of the propeller is decreased by using mewis duct and becker twisted fins compared to the cases of with no duct and unconventional half circular duct since the pressure contours on the blade of the propellers show the intensity of the sheet vortex it can be concluded that the lower value of the pressure on face and back of the propeller in cases of mewis duct and becker twisted fins compared to two other cases indicates the lower possibility of sheet vortex generation for mewis duct and becker twisted fins pressure distribution on the face and back of the pre swirl duct is shown in fig 20 as can be seen in fig 20 the very high pressure is concentrated on the outer edge of the pres swirl ducts especially from back view on one hand hydrodynamic performances and efficiency of pre swirl ducts are directly related to the axial radial and tangential components of the advanced velocity and the kind of the fluid flow pattern i e flow uniformity indeed greater advanced velocity and uniform flow provide higher efficiency for ships equipped with pre swirl ducts in addition the components of the advanced velocity and uniformity of inflow are naturally depended on the ship s hull form and the geometrical structure of the pre swirl ducts on the other hand the wake parameter is an efficient factor to investigate the distribution rate of advanced velocity components and fluid flow pattern morphology given this fact axial radial and tangential wake distribution are analyzed to study the performance of different intended pre swirls ducts axial radial and tangential wake distribution on measurement planes for mewis duct becker twisted fins and unconventional half circular duct are illustrated in figs 21 23 respectively for more details about the tangential velocity on the measurement planes for cases of with no duct mewis duct becker twisted fins and unconventional half circular duct fig 24 is also presented as can be seen in figs 21 23 upstream wake on measurement planes p1 and p2 shows the local deformation on the wakes induced by pre swirl duct on axial radial and tangential wake fields as can be seen in fig 21 for mewis duct wake field on propeller plane i e p3 shows that the angular evolution and effects of the propeller blades suction is visible as five lobe structures especially for axial wake distribution in addition on p3 radial distribution of cross flow is directed to the left side of the measurement plane and the peak of tangential wake field is concentrated approximately on the upward and toward the hull center in addition according to p3 in fig 22 for becker twisted fins radial and tangential distributions of cross flow is directed toward the hull center and the peak of radial and tangential wake field are concentrated approximately on the upward and downward the hull center moreover according to p3 in fig 23 for unconventional half circular duct the peak of tangential wake field is concentrated to the right half of the outer ring of the measurement plane as can be seen in figs 21 23 the downstream wake field on p4 shows no ax symmetrical morphology for axial and tangential distributions and the maximum of the axial wake is located in the right part of the center of the measurement plane also the maximum of the tangential wake is located in the right half of the measurement plane in which the hydrodynamic loads of the propeller blades is greater than that of the other parts also on p4 the wake fields are defected by shed of vortex from trailing edges of the propeller blades as can be seen in fig 24 tangential velocities have greater value on the left half of the measurement planes upstream tangential velocities on p1 indicate that more uniform distribution is visible for case with no duct however local defects on tangential velocity pattern induced by pre swirl duct and the hull boundary layer is achieved especially for case of mewis duct this velocity defection is more detectable on p2 that is related to pre swirl ducts geometrical structure where the induced effects of the propeller is only visible in case of with no duct in addition on p2 more local perturbation of velocity field is visible in case of becker twisted fins that are related to radial outer pre swirl fins it is also notable that upstream tangential velocity distribution is directly effective on thrust force and loading of the propeller blades local variation on tangential velocity of propeller plane i e p3 is achieved according to angular evolution and influences of the propeller blades suction it is notable that detached blade vortex is another reason for non uniformity of tangential velocity on p3 it is also visible that the value of tangential velocity is reduced in case of pre swirl ducts compared to with no duct in the downstream flow on p4 that is representative of a reduction in transverse losses transverse losses is directly depended on tangential velocity this reduction of transverse losses on p4 is also related to the variation of upstream tangential velocity distribution using pre swirl ducts consequently the reduction of transverse losses related to a change of cross flow using pre swirl duct is significantly impressive on the performance of the considered propulsion system see fig 15 for more details on the effects of pre swirl ducts on propulsive performance 5 conclusion in the current study the influences of three different pre swirl ducts on propulsion performance of series 60 ship are investigated to this accomplishment experimental self propulsion tests and numerical cfd analysis on mewis duct becker twisted fins and unconventional half circular duct are conducted compared to the case with no pre swirl duct among the most important findings from experimental and cfd study of the present paper the following can be referred to 1 thrust and torque coefficients for all the tested pre swirl ducts are decreased by an increase in the advance ratio up to 1 while in case of with no duct thrust and torque coefficients are decreased by up to 0 97 increase in the advance ratio in addition becker twisted fins show supreme thrust and torque coefficient at the lower value of advance ratio whereas for higher advance ratios mewis ducts provide the biggest thrust and torque coefficients compared to the other cases 2 the highest propeller behind hull efficiency is achieved for cases of with no duct and unconventional half circular duct however the highest relative rotative efficiency is detected for mewis duct especially for advance ratios between 0 85 up to 1 moreover the highest hull and propulsive efficiencies are obtained for cases of with no pre swirl duct and becker twisted fins 3 the pressure difference on face and back of the propeller is decreased by using mewis duct and becker twisted fins and the highest concentrated pressure is obtained on back of the outer edge of the pres swirl ducts 4 the upstream axial radial and tangential wake fields show the local deformation of the wakes induced by pre swirl duct axial and tangential downstream wake field also show no ax symmetrical morphology and defection of wake field by vortex shedding from the trailing edges of the propeller blades is also visible 5 the largest hub vortex and smaller one is also generated in respect of cases of with no duct and mewis duct finally it can be concluded that using the pre swirl ducts does not necessarily result in higher value in all different hydrodynamics efficiencies the inflow of the pre swirl duct is significantly dependent on the ship s hull form i e especially stern form of the ship thus it is difficult to establish a guideline to design the geometrical parameters and position of the pre swirl ducts independent of the inflow pattern therefore future investigations are needed to be conducted on the effects of geometry factors of the pre swirl duct such as the type of the hydrofoil length of the chord the distance between the pre swirl duct and the propeller on the hydrodynamic performance of these esds assessing the interaction of pre swirl ducts as efficient esds with different types of rudders on the propulsion performance of conventional and unconventional ships can also be considered in future works acknowledgment cfd computations presented in this paper have been performed on the parallel machines of the high performance computing research center hpcrc of amirkabir university of technology aut their supports are gratefully acknowledged appendix 1 detailed coordinates of the selected hydrofoils in the intended pre swirl ducts are presented in tables a1 and a 2 table a 1 detailed of x y coordinates of selected hydrofoils for ducts table a 1 row x y row x y 1 1 0 25 0 5 0 10538 2 0 99893 0 00039 26 0 4673 0 10837 3 0 99572 0 00156 27 0 43474 0 11076 4 0 99039 0 00349 28 0 40245 0 11248 5 0 98296 0 0061 29 0 37059 0 11345 6 0 97347 0 00932 30 0 33928 0 11361 7 0 96194 0 01303 31 0 30866 0 11294 8 0 94844 0 01716 32 0 27886 0 11141 9 0 93301 0 02166 33 0 25 0 10903 10 0 91573 0 02652 34 0 22221 0 10584 11 0 89668 0 03171 35 0 19562 0 1019 12 0 87592 0 03717 36 0 17033 0 09726 13 0 85355 0 04283 37 0 14645 0 09195 14 0 82967 0 04863 38 0 12408 0 08607 15 0 80438 0 05453 39 0 10332 0 0797 16 0 77779 0 06048 40 0 08427 0 07283 17 0 75 0 06642 41 0 06699 0 06541 18 0 72114 0 07227 42 0 05156 0 05753 19 0 69134 0 07795 43 0 03806 0 04937 20 0 66072 0 08341 44 0 02653 0 04118 21 0 62941 0 08858 45 0 01704 0 03303 22 0 59755 0 09341 46 0 00961 0 02489 23 0 56526 0 09785 47 0 00428 0 01654 24 0 5327 0 10185 48 0 00107 0 00825 table a 2 detailed x y coordinates of selected hydrofoils for fins table a 2 row x y row x y 1 1 0 0012 17 0 0 2 0 95 0 01027 18 0 0125 0 01813 3 0 9 0 01867 19 0 025 0 02453 4 0 8 0 0332 20 0 05 0 03267 5 0 7 0 0448 21 0 075 0 03813 6 0 6 0 0532 22 0 1 0 0424 7 0 5 0 05827 23 0 15 0 04867 8 0 4 0 06 24 0 2 0 05293 9 0 3 0 05827 25 0 3 0 05827 10 0 2 0 05293 26 0 4 0 06 11 0 15 0 04867 27 0 5 0 05827 12 0 1 0 0424 28 0 6 0 0532 13 0 075 0 03813 29 0 7 0 0448 14 0 05 0 03267 30 0 8 0 0332 15 0 025 0 02453 31 0 9 0 01867 16 0 0125 0 01813 32 1 0 0012 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 01 007 
23006,in the side by side offloading problem the gap resonance is usually overestimated by the potential theory bas ed methods this article reviews the up to date research on this topic and discusses the existing methods to modify the potential method in order to obtain a reasonable estimate of the wave elevation then a wall damping method is proposed to damp out the wave elevation this method models the energy loss on the ship hull surface thus a lid is no longer needed the validity of the method is established through comparisons against the experimental data consistent results are obtained for the wave gauge in the middle of the gap this method is the first step to develop the categories of methods without lid the motivation is to use the small amount of measured data and a simplified model to generate engineering acceptable results given more data more improvements can be made upon this method and a more general and powerful model can be developed in the future keywords potential theory side by side offloading gap resonance artificial damping wave elevation 1 introduction the side by side offloading is one type of configurations when the flng offloads the liquefied natural gas to the lngc nearby it is very challenging because the two ships stay closely to each other forming a narrow gap between the two giant floaters inaccurate estimation of the interaction effects may lead to unexpected damage or collision of the ships in the theoretical research and experimental study it is observed that the wave resonance will happen inside the gap at some incident wave frequencies it is unclear how much effect the wave resonance will cause to the two body system that is the reason why it is of growing interest to understand the phenomenon happening inside the gap and how to estimate the effects from the wave resonance on the two body system this problem arises when the researchers were studying the interactions of multiple floaters using the panel method based on the potential theory an unphysical resonance was observed inside the gap between the two large floaters as a result the wave elevation and the interaction force predicted by the panel method are too high based on one s physical intuitive thus researchers began to investigate the phenomenon and to seek for an approach to damp out the energy which results in unreasonable wave elevation in the study of the 2d problem miao et al 2001 investigated the problem using the linear potential theory they identified the strong interactions between the two floaters close by and recommended more study for 3d cases saitoh et al 2006 investigated the problem in 2d through the series of experiments they studied the effects of gap width draft on the wave height inside the gap faltinsen et al 2007 proposed the domain decomposition method breaking down the problem into several domains meanwhile more unknowns and more equations about the boundaries of the different domains are introduced singular characters of the traces are considered in formulating the local solutions of the complex velocities at edges finally the analytically oriented solution is obtained to predict the piston like sloshing in a moonpool kristiansen and faltinsen 2008 tried the vortex tracking method and concluded that the vortex shedding inside the gap may lead to part of the energy loss later as the twin paper with faltinsen et al 2007 faltinsen and timokha 2015 introduced a dynamic boundary condition inside the gap and resolve the potential problem the dynamic boundary condition is based on the pressure drop estimation and empirical formulas on some coefficients by modeling the dynamic free surface it becomes unnecessary to model the complex phenomenon happening inside the fluid domain the results of such methods show a good agreement with the experimental data liu et al 2012 added a damping free surface near the floater and also decomposed the domain into several parts with damped boundary condition on the vertical surfaces damping happens on the gap free surface and the interface of the boundaries by matching the experimental data the author proposed a linear model to fit the damping coefficient against characteristics of the box and fluid domain in the study of 3d problems buchner et al 2004 proposed the lid method inside the gap they enforced the no penetration condition on the lid and found this method can suppress the resonance later chen 2005 proposed the damping lid method they added a dissipative term in the free surface boundary condition inside the gap chen and malenica 2005 discussed the damping method applied in the multi body problem the authors introduced damping coefficients for the free surface boundary condition and the body boundary conditions the method basically reduced the source strength by adjusting the terms associated with the damping effects however one needs to tune the damping coefficients on the free surface and body boundary by comparison against the experimental data meanwhile by modifying the equations of the system it is likely that the resonance frequency will have a tiny shift with a nonzero damping coefficient this method was used by pauw et al 2007 bunnik et al 2009 and lu et al 2011 they all reported satisfactory results can be obtained by this method zhu et al 2005 treated the 3d side by side problem by the linear potential method in frequency domain investigated the effect of the gap width on the resonant frequency and amplitude teigen and niedzwecki 2006 applied the panel method up to second order to investigate the problem they concluded that the wave amplification inside the gap is sensitive to the wave frequency and wave heading the surprising second order effect is observed around the two barges zhu et al 2006 studied the effect of gap in the multiple boxbarge problems only the radiation potential was considered herein they concluded that the sway motion showed a strong interaction effect at certain wave number sun et al 2010 applied 1st and 2nd order panel method to investigate the dependency of the wave elevation on box motion spacing wave direction draft they observed a similar behavior in 1st order and 2nd order potential along the gap markeng 2017 investigated pressure damping method and newtonian cooling damping model in 2d cases and implemented the latter one in the 3d potential flow solver the authors concluded the newtonian cooling damping model is relatively more effective to model the resonance the damping coefficient still needs to be tuned against the experimental data zhao et al 2016 conducted the experiment to study two identical box barges side by side the two boxbarges are fixed in the experiments different modes of gap resonance have been observed this is a very good resource to study the side by side problems because the experiment has eliminated the effects of the ship motion and focuses on the diffraction effects it will be helpful to understand the physical mechanism zhao et al 2017b discussed about the damping effects and mentioned that for the round bilge cases the viscous effects from the hull surface seem to be more significant than the flow separation effects zhao et al 2017a pointed out that the viscosity mainly leads to the discrepancy between linear potential theory and the experimental data the authors compared the results from different commercial software and benchmarked against the experimental data in this paper we categorize the existing artificial damping methods into two types the domain decomposition method and the lid method we review the two types of methods first inspired by the researchers we propose the wall damping method to model the energy loss on the ship hull surface in order to obtain a reasonable prediction of wave elevation inside the gap finally the results are benchmarked against the experimental data the achieved consistency shows that our method is effective the proposed wall damping method considers the physical effects which is the significant difference from the lid method applied directly on the free surface inside the gap it can evolve into a more advanced and robust method given more experimental data 2 review of artificial damping methods in this section we discuss the previous works on artificial damping methods and also describe our proposed method before proceeding to the derivation we review the formulas for the 1st order seakeeping problem which is the basis of the damping methods the nonlinear kinematic and dynamic boundary conditions of the hydrodynamic problem are 1 ζ t φ x ζ x φ y ζ y φ z a t z ζ x y t 2 φ t 1 2 φ φ g ζ c p a ρ a t z ζ x y t after applying the perturbation technique and taylor expansion we obtain the 1st order equation as below 3 ζ 1 t φ 1 z a t z 0 4 φ 1 t g ζ 1 0 a t z 0 in solving for the green function we usually merge the two equations to get the combined free surface boundary condition 5 1 g 2 φ 1 t 2 φ 1 z 0 a t z 0 with the green function we solve for the source strength using the body boundary condition 6 n φ 1 n v 1 a t b o d y s u r f a c e by assuming steady state we can apply the following equations and make the equations independent of time t φ 1 r e ϕ 1 e i ω t v n r e v n e i ω t ζ 1 r e ζ a 1 e i ω t then the body boundary condition becomes 7 ϕ 1 n x 1 2 σ x 1 4 π s b σ ξ g x ξ n x d s ξ v n afterwards substituting the source strength on the body into the following equation we obtain the potential at any point inside or on the boundary of the fluid domain 8 4 π ϕ 1 x s b σ ξ g x ξ d s ξ x s b v using equation 4 we will be able to find the wave elevation on the linearized free surface the equation for the complex amplitude is as below 9 ζ a 1 i ω ϕ 1 g the nondimensional form is 10 ζ a 1 ζ a 1 a i ω ϕ 1 a g where a is the wave amplitude when we observe a very high wave elevation the potential value at the point of interest is naturally large to reduce the wave elevation it is straightforward to put a rigid lid on the gap as discussed in buchner et al 2001 a rigid lid may be too strong a restriction on the gap free surface later the damping lid method was proposed in chen 2005 the wave elevation along the gap is reduced especially at resonant frequencies when we add damping terms on the gap free surface we are changing the source strength on the body panels and then the potentials throughout the domain if we can decompose the domain into several parts and control the interfaces of the subdomains we may also achieve a reduced wave elevation different types of the domain decomposition methods were discussed in faltinsen et al 2007 liu et al 2012 etc in the following two sections we discuss the mathematical concepts of the lid method and the domain decomposition method 2 1 the domain decomposition method the domain decomposition method breaks down the original solution domain fluid domain herein into several parts it leads to a system of integral equations on the interfaces of the domains also known as the transmission interfaces the concept can be illustrated in fig 1 fig 1 is to illustrate the idea of the method it may have some differences from the discussions in different papers f 1 f 2 f 3 stand for the free surfaces around the floaters i i i i i i i v v are the subdomains b 1 b 2 b 3 b 4 are the interfaces between the subdomains proper transmission conditions need to be specified on the interfaces b 1 b 2 b 3 b 4 in faltinsen et al 2007 the authors introduced admissible functions on the interfaces then they solved the problem in different domains separately in liu et al 2012 a dissipation boundary condition is introduced in the gap free surface f 2 and also on b 1 b 4 the boundary condition restricted the transmission of energy from domain to domain in order to ensure a reasonable wave elevation inside the gap the change in the solution system can be illustrated as in fig 2 this method is mainly applied in the 2d problem if considering the 3d case one may need to decide where to place the interfaces of the domains and also tune the unknown damping coefficients on the transmission boundary conditions to make the simulated wave elevation consistent with the experimental data 2 2 the lid method the lid method is also an effective method to damp out the wave elevation of the gap free surface it can be applied in 2d and 3d problem the methods are already included in some commercial software for example wadam and hydrostar this method modifies the boundary condition on part of the free surface to consider the change in the equation system the part of the free surface needs to be panelized and the source strength on the panels need to be solved that may be the reason why it is called lid method the concept can be shown in fig 3 in fig 3 f 1 stands for the part of the free surface without damping f 2 f 3 f 4 are the parts on which the damping terms may be included typically only f 2 is panelized sometimes f 3 f 4 or some places inside the fluid domain is also panelized to incorporate the damping effect the mathematical essence of this method is to introduce more unknowns constructing a bigger matrix it is similar to the irregular frequency removal method discussed in liu and falzarano 2016a and liu and falzarano 2017a the concept can be shown in fig 4 2 2 1 the newtonian damping method there are two similar techniques belonging to this category one is the newtonian cooling method this method was discussed in kim 2003 markeng 2017 the damping effect is enforced on the first order kinematic free surface condition we have the modified kinematic free surface boundary condition 11 ζ 1 t φ 1 z a t z 0 12 φ 1 t g ζ 1 0 a t z 0 13 ζ 1 t φ 1 z a ζ 1 b g φ 1 a t z 0 where a b are the coefficients to denote the linear relationship according to markeng 2017 we can select a b so that the dispersion relationship remains the same herein we will explore the process to decide on the value or the relationship between a b the coefficients in equation 13 if using the original dynamic boundary condition and the modified kinematic free surface boundary condition 13 we get the modified combined free surface boundary condition 14 2 φ 1 t 2 g φ 1 z a φ 1 t b φ 1 0 in deriving the dispersion relationship we assume φ 1 satisfies φ 1 x z t x x z z t t substituting the equation into the combined free surface boundary condition we have 15 t g z z t a t b t 0 from wave potential for the deep water condition we know z satisfies z k z where k is the wave number the above equation becomes 16 t g k t a t b t 0 mathematically we need to solve for this equation to find the solution for t here we are reverse engineering the previous references thus we may introduce some assumptions to explore the relationship if t satisfies t i ω t t ω 2 t we obtain the equation about the wave frequency ω 17 ω 2 g k i ω a b 0 then we have 18 ω 2 i ω a a 2 4 g k b a 2 4 ω g k b a 2 4 i a 2 if b a 2 4 ω g k i a 2 where the real part of ω is g k if we take a 2 μ b μ 2 we get the exactly same equations as in markeng 2017 as below 19 ζ 1 t φ 1 z 2 μ ζ 1 μ 2 g φ 1 a t z 0 when calculating the wave elevation the dynamic free surface boundary condition may be applied to calculate the wave elevation 20 ζ 1 1 g φ 1 t i ω g φ 1 if we take the ω g k i a 2 the wave elevation becomes 21 ζ 1 i g k g φ 1 μ g φ 1 when tuning the value of μ against the experimental data we are almost directly changing value of wave elevation additionally the combined free surface boundary condition becomes 22 φ 1 z 1 g ω 2 2 i ω μ μ 2 φ 1 ω i μ 2 g φ 1 to consider the change of the free surface boundary condition the gap surface needs to be panelized the above formula will be applied in the surface integral to solve for the source strength to conclude the newtonian damping method provides an approach to adjust the wave elevation inside the gap a different free surface boundary condition is applied inside the gap if applying the same green function a lid is needed along the gap free surface the introduction of the damping terms will affect both the equation system to solve for the potential value or the source strength and the calculation of the wave elevation to decide on a reasonable damping coefficient one needs to tune it against the experimental data this is a mathematical way to modify the method based on potential theory the process to derive the revised dispersion relationship may not be strictly accurate additionally if the wave frequency has an imaginary part and we continue using the formula φ 1 r e ϕ 1 e i ω t the term ϕ 1 may not be independent of time 2 2 2 xb chen s damping method another very promising approach is the method proposed by chen and malenica 2005 the damping force is applied in the dynamic free surface boundary condition the amplitude of the force is proportional to the amplitude of the velocity on the free surface the formula is as below 23 f μ v in the dynamic free surface boundary condition if we apply the damping force the equation becomes 24 t v v p ρ g z μ v o n z ζ x y t if assuming ideal flow the velocity can be expressed in terms of the potential as v φ then the equation is 25 t φ φ p ρ g z μ φ 26 φ t 1 2 φ φ p ρ g ζ μ φ c t o n z ζ x y t making the same choice for pressure p and the constant c t we can extract the first order o ε part of the dynamic free surface boundary condition 27 φ 1 t g ζ 1 μ φ 1 0 o n z 0 the wave elevation becomes 28 ζ 1 1 g μ φ 1 φ 1 t μ i ω g φ 1 i ω g φ 1 μ g φ 1 if substituting the wave elevation into the kinematic free surface boundary condition we obtain a combined formula 29 1 g t μ φ 1 φ 1 t φ 1 z rearranging the terms we obtain 30 φ 1 z ω 2 g 1 i μ ω φ 1 ω 2 g φ 1 i ω μ g φ 1 applying the similar technique we can get the relationship that ω and k satisfy 31 ω 2 g k i ω μ 0 solving for ω we get 32 ω g k μ 2 4 i μ 2 the real part of the wave frequency is no longer g k and ω contains an imaginary part as well in this method the free surface boundary condition inside the gap is also changed thus the gap surface needs to be panelized the damping coefficient has changed the matrix to solve for the potential value or the source strength it also appears in formula 28 to calculate the wave elevation intuitively speaking when we want to consider the damping effect we deduct a portion from the original wave elevation however if we consider the term related to damping effect we have also changed the value of the potential it is indicating that we probably need to tune the damping coefficient for several rounds to make the simulation results match the experimental data this method is an alternative approach to modify the wave elevation mathematically it has changed the dispersion relationship inside the gap surface and the dynamic free surface boundary condition when applying this method one needs to decide where is the damping zone and how large it is the choices may depend on the experience of the user 3 wall damping method 3 1 motivation considering the disadvantages of the above methods two questions come can we develop a method which does not require the user to specify where the damping zone or damping lid is can we use the information of the potential method without damping to identify the damping coefficients let s review the physical processes first in the potential method the fluid is assumed to be ideal flow which is inviscid and irrotational the energy dissipation caused by the viscous effect is neglected in the results generated by the potential method however in reality the fluid is viscous and rotational when comparing the results by potential method and the experimental data we may attribute the discrepancies to the differences in the assumptions of the fluid property therefore we say that it may be the viscous effects that damps out the wave elevation in the damping lid method the free surface boundary condition inside the gap is directly controlled to ensure a reasonable wave elevation it is a straight forward approach to adjust the wave elevation in this way the distribution of the potential value will be affected by the change in the free surface boundary condition in the domain decomposition method the fluid domain is broken down into several parts the transmission of the energy is controlled on the interfaces of the subdomains and the damping condition is also enforced on the free surface inside the gap as a result the wave elevation is ensured to be reasonable and the potential throughout the domain is likely to be altered the two types of approaches provide feasible ways to modify the matrix structure to solve for the source strength of the potential value on the ship hull through the modifications a reasonable wave elevation can be obtained in the potential method without damping the body boundary condition will determine the source strength or the potential value on the ship hull in chen and malenica 2005 the authors discuss the damping condition on the ship hull near the gap the damping condition was also adopted in coastal engineering to model the partial reflection of a wall in the sloshing problem a uniform damping effect is applied on the tank surface to adjust the motion rao of the floater as discussed in zalar et al 2007 the partial reflection is an alternative way to incorporate the damping effect of the system inspired by the discussion of the partial reflection in chen and malenica 2005 we introduce damping effects of different intensities on the ship hull surface the intensity is determined by the activity level of the fluid nearby enlightened by the domain decomposition method and based on the observation of the contour plots through the potential method we break the ship hull surface into three parts the side shell next to the gap the hull bottom and the side shell away from the gap it can be shown in fig 5 in fig 5 the green part stands for the side shell next to the gap the yellow part is the side shell far away from the gap the red part indicates the rest part of the ship in 2d the red part only includes the hull bottom in 3d cases it also includes the stern and bow in the middle region to conclude the wall damping method directly introduces the damping effect on the ship hull instead of on the free surface inside the gap this is more physical because the energy loss may mainly happen on the ship hull rather than the free surface inside the gap as discussed in the introduction part to distinguish the damping effects on different sections of the ship hull we assume different damping coefficient on different parts of the ship hull which is inspired by the domain decomposition method however instead of decomposing the fluid domain we split the ship hull into different parts 3 2 wall damping method 3 2 1 formula we incorporate the damping term into the body boundary condition by using this formula following chen and malenica 2005 33 ϕ 1 n x v n i μ ω 2 g ϕ a t b o d y s u r f a c e if we include the damping term in the body boundary condition the formula changes into 34 ϕ 1 n x 1 2 σ x 1 4 π s b σ ξ g x ξ n x i μ ω 2 g g x ξ d s ξ v n the damping term is introduced to model the partial reflection of the wall boundaries it essentially affects the value of the source strength which is used to calculate the potential value and the wave elevation inside the gap if the wave elevation without damping is too high we hope to damp out the wave elevation by tuning the damping term introduced here in our case we assume the damping coefficient μ is a function of location y and the incident wave frequency ω μ μ y ω y is adopted to decompose the ship hull into 3 parts and μ will stay constant on each of the three parts of the ship hull given the frequency we decide which region a panel falls into based on the location of its centroid the values of μ on different regions can be different 3 2 2 determination of ratios therefore to consider the different damping effects on the three sections of the ships we assume the damping coefficients satisfy a ratio of a b c to decide the damping coefficients in the equation we multiply a constant μ to the ratio then the damping coefficients are a μ b μ c μ consequently we need to decide the value of μ and the ratio of the damping coefficients a b c in this method we assume that the panels belonging to one section share the same damping coefficient it is similar to adding an average damping to the section if we assume the damping effect is positively correlated to the prediction through the potential method we may use the ratio of the potential values to help decide the ratio of the damping coefficients in generating the results for wave frequencies ranging from 6 01 9 91 rad s we can obtain the potential value for each panel at each frequency herein we assume the average effect can be achieved by two types of ratios one ratio is obtained in this way first summing up the potential value at each section for all frequencies then find the mean value of the potential for each section and finally calculate the ratio we may name it as ratio of the mean the other ratio can be named as ratio of the max mean firstly we compute the mean of the potential values for each section at a certain frequency then we find the ratio for each frequency if we denote the ratio as the format 1 x y and y x 1 we can eventually find the ratio with the largest value of y that ratio is our final selection please note that we will always divide each number in a ratio by the smallest number so that the ratio has 1 as the minimum value this is a rule of notation to describe the possible relationship between the damping effects on different sections herein we provide two possible types of ratios for reference the ratios reflect the difference in the average potential value in practice other types of ratios can be defined as well the values in the ratios will affect the amplitudes of the kernel functions discussed below the bigger number inside a ratio will lead to a smaller amplitude of the kernel function 3 2 3 kernel function the ratios of the potential values on the 3 sections indicate the average activity level of the fluid close to the different sections however based on the observations the activity level is frequency dependent in other words at some frequencies especially the resonant frequencies the amplitude of the wave elevation or the velocity of fluid inside the gap is relatively larger we may assume when the fluid has a relatively larger velocity the friction effect can cause more energy loss to the system in other words the damping effect is positively correlated with the activity of the system generally the damping effect becomes significant when reaching the resonant frequencies and it may also grow with the increasing wave radian frequency because the velocity amplitude of the fluid particles is growing as the frequency increases to consider the resonance effects we propose to apply the gaussian kernel function in the function of the damping coefficient μ the formula of μ is expressed as 35 μ i r e s a i e x p k ω ω i r e s where res stands for resonance the number of the terms is equal to the number of resonant frequencies observed a i is the amplitude of the kernel functions k is the decay ratio and ω i r e s is the resonant frequencies in this equation ω i r e s is determined from the results of the mdlmultidyn without the non potential flow damping effect the unknowns are all the a i and the decaying factor k additionally the in house program mdlmultidyn is developed by liu and falzarano 2016b to study the hydrodynamic problems of multiple floaters it has the module to remove irregular frequency effects liu and falzarano 2017e has two options to evaluate the mean drift forces in liu and falzarano 2017d liu and falzarano 2018 and is able to perform analysis for low speed cases liu and falzarano 2017c liu and falzarano 2017b the program mdlmultidyn can be used for generating the input of the evaluation of wave energy converter discussed in wang et al 2017 wang et al 2017 wang and falzarano 2013 mdlmultidyn is currently for the study of the cases in deep water only the module of finite depth green function is under development by xie et al 2017 and will be incorporated into the main program which can be applied to numerically simulate the offshore applications in frequency domain for example the problem discussed in xie et al 2015 the module of quadratic transfer function is completed by xie et al 2019 given the experimental data we may adjust the value of a i and k to make sure the results from the wall damping methods are consistent we can first tune the amplitude of the kernel function for the result of each resonant frequency separately more specifically we tried different values of a i at a certain frequency then we chose the a i which makes the wave elevation from simulation close to the experimental data and repeat the steps for other resonant frequencies in this way we can find proper values of a i afterwards by adjusting the value of k we make the results at other frequencies approximately consistent more specifically we tried different values of k after we decided the values of a i until the results are close to the experimental data the value of k decides how fast the damping coefficient will decay from a certain resonant frequency if the k is zero the damping coefficient will be a constant for all frequencies if the k is very small it decays slowly when the frequency of interest is away from the resonant frequencies when k is large it decays relatively fast when the frequency of interest is shifted away from a certain resonant frequency when k is approaching infinity the damping coefficient will be approximately zero at all frequencies except for the resonant frequencies if enforcing too much damping effect the wave elevation will be relatively smaller the objective of the tuning process is to find a proper value of k which introduces a proper amount of damping at all frequencies in the next section we will demonstrate the effectiveness of the wall damping method 3 2 4 discussion on wall damping method up till this step we have finished the discussion of the motivation of the wall damping method the formula and the tuning process we discuss the advantages and possible limitations of the method in this section the wall damping method directly models the energy loss on the ship hull which is more physical compared against the lid method applied on the free surface inside the gap it does not change the dispersion relationship when enforcing the damping effects more importantly this method may prove that we are able to dig out more information on the damping effects based on the results from the linear potential method without damping the model discussed here is one possible guess of the relationship between the output of the potential theory method and the experimental data if obtaining more experimental data we will find a better model which may be better generalized however this proposed method has more free parameters to be determined than the damping lid method the user may spend more efforts in tuning the parameters by assuming the linear relationship of the amplitudes at the resonant frequencies we can decrease the number of free parameters to mitigate the drawback more details will be provided in the next section 4 results herein we will mainly study the wave elevation at the wave gauge 4 which is located at the center of the gap we apply the methods to the cases in both head sea and beam sea conditions to prove the effectiveness herein we choose the ratio of the max mean as an example it is equivalent to choose the other ratio the steps remain the same the difference may lie in the expressions of the kernel functions to evaluate the methods we developed the program in matlab using the output of intermediate steps from mdlmultidyn in the comparison the results from the matlab code is always on top of those from the multidyn when there is no damping effect which is to validate the correctness of the matlab code 4 1 head sea condition after running the case using our in house program mdlmultidyn the ratios are obtained as in the table table 1 below by tuning the parameters we find the values of a are 0 0005 0 0010 0 0016 0 0026 0 0032 and the value of k is 26 the damping constant curve of μ is shown in fig 6 the circles on the curve indicate the values we selected at each frequency which is adopted in the simulation of the mdlmultidyn while plotting the curve we find that the amplitudes at or near the resonant frequencies almost follow a linear relationship on top of the curve we also plot the fitted curve of the amplitudes it shows that the linear curve fits well applying the damping constants we find the damping coefficient on each section at each frequency after incorporating the damping effects we can obtain the damped curve in fig 7 from the comparisons we can observe that the damped curve is consistent with the experimental data the method is effective in generating a reasonable wave elevation in the method we have to choose 6 parameters based on the linear relationship of the amplitudes at the resonant frequencies we may just need to tune 3 parameters the amplitudes at 2 resonant frequencies and the parameter k thus we select the amplitudes at the minimum and maximum resonant frequencies to tune and apply the fitted curve to obtain the damping constant for other amplitudes fig 8 shows the difference between tuning 5 points and 2 points applying the fitted curve we obtain the curve using the modified potential method as shown in fig 9 it is approximately the same with that when adjusting the five amplitudes independently 4 2 beam sea condition similarly we can obtain the ratios based on the results from the potential method table 2 by tuning the parameters we find the values of a are 0 0014 0 0020 0 0032 0 0042 0 0054 and the value of k is 15 the damping constant curve of μ is shown in fig 10 considering the damping effects we can obtain the results for the modified potential method as shown in fig 11 if we choose the 3 parameters to tune we obtain the curves of the damping coefficients as shown in fig 12 applying the damping constants by fitting the 3 parameters we obtain the results from the modified potential method as shown in fig 13 not surprisingly the results are almost the same with those by fitting 5 parameters 5 conclusion we discuss the proposed method to damp out the wave elevation inside the gap the method is a significant improvement based on the damping method applied in the sloshing problem and the coastal engineering problems in this method we introduce damping effect only on the ship hull the damping effect differs by the location relative to the gap the assumption is that the damping coefficient is positively correlated with the activity level of the fluid domain if the velocity of the fluid field is large then the damping effect is also significant the method does not require the user to choose a damping domain or change the dispersion relationship the information from the results without damping is helpful to choose the parameters of the method we use the resonant frequencies from the linear potential method to decide the centers of the gaussian kernel functions the amplitudes of the gaussian kernel functions are initially found by tuning against the experimental data afterwards we find the amplitudes are approximately linear in wave frequency therefore the function a ω assumes a linear function in ω alternatively if we find the amplitude for the minimum and maximum resonant frequencies by tuning against the experiment we can find the amplitudes of the gaussian kernel function at other resonant frequencies in this way the shortcomings of the method is minimized this method is our first trial on the damping problem if obtaining more experimental data of various floaters or different conditions in the future we will extend the concept of the method and improve this method using advanced techniques acknowledgments the authors would like to thank dr wenhua zhao for providing the experimental data for analysis also partial support was provided by office of naval research under onr grant n000 14 16 1 2281 and society of naval architects and marine engineers 
23006,in the side by side offloading problem the gap resonance is usually overestimated by the potential theory bas ed methods this article reviews the up to date research on this topic and discusses the existing methods to modify the potential method in order to obtain a reasonable estimate of the wave elevation then a wall damping method is proposed to damp out the wave elevation this method models the energy loss on the ship hull surface thus a lid is no longer needed the validity of the method is established through comparisons against the experimental data consistent results are obtained for the wave gauge in the middle of the gap this method is the first step to develop the categories of methods without lid the motivation is to use the small amount of measured data and a simplified model to generate engineering acceptable results given more data more improvements can be made upon this method and a more general and powerful model can be developed in the future keywords potential theory side by side offloading gap resonance artificial damping wave elevation 1 introduction the side by side offloading is one type of configurations when the flng offloads the liquefied natural gas to the lngc nearby it is very challenging because the two ships stay closely to each other forming a narrow gap between the two giant floaters inaccurate estimation of the interaction effects may lead to unexpected damage or collision of the ships in the theoretical research and experimental study it is observed that the wave resonance will happen inside the gap at some incident wave frequencies it is unclear how much effect the wave resonance will cause to the two body system that is the reason why it is of growing interest to understand the phenomenon happening inside the gap and how to estimate the effects from the wave resonance on the two body system this problem arises when the researchers were studying the interactions of multiple floaters using the panel method based on the potential theory an unphysical resonance was observed inside the gap between the two large floaters as a result the wave elevation and the interaction force predicted by the panel method are too high based on one s physical intuitive thus researchers began to investigate the phenomenon and to seek for an approach to damp out the energy which results in unreasonable wave elevation in the study of the 2d problem miao et al 2001 investigated the problem using the linear potential theory they identified the strong interactions between the two floaters close by and recommended more study for 3d cases saitoh et al 2006 investigated the problem in 2d through the series of experiments they studied the effects of gap width draft on the wave height inside the gap faltinsen et al 2007 proposed the domain decomposition method breaking down the problem into several domains meanwhile more unknowns and more equations about the boundaries of the different domains are introduced singular characters of the traces are considered in formulating the local solutions of the complex velocities at edges finally the analytically oriented solution is obtained to predict the piston like sloshing in a moonpool kristiansen and faltinsen 2008 tried the vortex tracking method and concluded that the vortex shedding inside the gap may lead to part of the energy loss later as the twin paper with faltinsen et al 2007 faltinsen and timokha 2015 introduced a dynamic boundary condition inside the gap and resolve the potential problem the dynamic boundary condition is based on the pressure drop estimation and empirical formulas on some coefficients by modeling the dynamic free surface it becomes unnecessary to model the complex phenomenon happening inside the fluid domain the results of such methods show a good agreement with the experimental data liu et al 2012 added a damping free surface near the floater and also decomposed the domain into several parts with damped boundary condition on the vertical surfaces damping happens on the gap free surface and the interface of the boundaries by matching the experimental data the author proposed a linear model to fit the damping coefficient against characteristics of the box and fluid domain in the study of 3d problems buchner et al 2004 proposed the lid method inside the gap they enforced the no penetration condition on the lid and found this method can suppress the resonance later chen 2005 proposed the damping lid method they added a dissipative term in the free surface boundary condition inside the gap chen and malenica 2005 discussed the damping method applied in the multi body problem the authors introduced damping coefficients for the free surface boundary condition and the body boundary conditions the method basically reduced the source strength by adjusting the terms associated with the damping effects however one needs to tune the damping coefficients on the free surface and body boundary by comparison against the experimental data meanwhile by modifying the equations of the system it is likely that the resonance frequency will have a tiny shift with a nonzero damping coefficient this method was used by pauw et al 2007 bunnik et al 2009 and lu et al 2011 they all reported satisfactory results can be obtained by this method zhu et al 2005 treated the 3d side by side problem by the linear potential method in frequency domain investigated the effect of the gap width on the resonant frequency and amplitude teigen and niedzwecki 2006 applied the panel method up to second order to investigate the problem they concluded that the wave amplification inside the gap is sensitive to the wave frequency and wave heading the surprising second order effect is observed around the two barges zhu et al 2006 studied the effect of gap in the multiple boxbarge problems only the radiation potential was considered herein they concluded that the sway motion showed a strong interaction effect at certain wave number sun et al 2010 applied 1st and 2nd order panel method to investigate the dependency of the wave elevation on box motion spacing wave direction draft they observed a similar behavior in 1st order and 2nd order potential along the gap markeng 2017 investigated pressure damping method and newtonian cooling damping model in 2d cases and implemented the latter one in the 3d potential flow solver the authors concluded the newtonian cooling damping model is relatively more effective to model the resonance the damping coefficient still needs to be tuned against the experimental data zhao et al 2016 conducted the experiment to study two identical box barges side by side the two boxbarges are fixed in the experiments different modes of gap resonance have been observed this is a very good resource to study the side by side problems because the experiment has eliminated the effects of the ship motion and focuses on the diffraction effects it will be helpful to understand the physical mechanism zhao et al 2017b discussed about the damping effects and mentioned that for the round bilge cases the viscous effects from the hull surface seem to be more significant than the flow separation effects zhao et al 2017a pointed out that the viscosity mainly leads to the discrepancy between linear potential theory and the experimental data the authors compared the results from different commercial software and benchmarked against the experimental data in this paper we categorize the existing artificial damping methods into two types the domain decomposition method and the lid method we review the two types of methods first inspired by the researchers we propose the wall damping method to model the energy loss on the ship hull surface in order to obtain a reasonable prediction of wave elevation inside the gap finally the results are benchmarked against the experimental data the achieved consistency shows that our method is effective the proposed wall damping method considers the physical effects which is the significant difference from the lid method applied directly on the free surface inside the gap it can evolve into a more advanced and robust method given more experimental data 2 review of artificial damping methods in this section we discuss the previous works on artificial damping methods and also describe our proposed method before proceeding to the derivation we review the formulas for the 1st order seakeeping problem which is the basis of the damping methods the nonlinear kinematic and dynamic boundary conditions of the hydrodynamic problem are 1 ζ t φ x ζ x φ y ζ y φ z a t z ζ x y t 2 φ t 1 2 φ φ g ζ c p a ρ a t z ζ x y t after applying the perturbation technique and taylor expansion we obtain the 1st order equation as below 3 ζ 1 t φ 1 z a t z 0 4 φ 1 t g ζ 1 0 a t z 0 in solving for the green function we usually merge the two equations to get the combined free surface boundary condition 5 1 g 2 φ 1 t 2 φ 1 z 0 a t z 0 with the green function we solve for the source strength using the body boundary condition 6 n φ 1 n v 1 a t b o d y s u r f a c e by assuming steady state we can apply the following equations and make the equations independent of time t φ 1 r e ϕ 1 e i ω t v n r e v n e i ω t ζ 1 r e ζ a 1 e i ω t then the body boundary condition becomes 7 ϕ 1 n x 1 2 σ x 1 4 π s b σ ξ g x ξ n x d s ξ v n afterwards substituting the source strength on the body into the following equation we obtain the potential at any point inside or on the boundary of the fluid domain 8 4 π ϕ 1 x s b σ ξ g x ξ d s ξ x s b v using equation 4 we will be able to find the wave elevation on the linearized free surface the equation for the complex amplitude is as below 9 ζ a 1 i ω ϕ 1 g the nondimensional form is 10 ζ a 1 ζ a 1 a i ω ϕ 1 a g where a is the wave amplitude when we observe a very high wave elevation the potential value at the point of interest is naturally large to reduce the wave elevation it is straightforward to put a rigid lid on the gap as discussed in buchner et al 2001 a rigid lid may be too strong a restriction on the gap free surface later the damping lid method was proposed in chen 2005 the wave elevation along the gap is reduced especially at resonant frequencies when we add damping terms on the gap free surface we are changing the source strength on the body panels and then the potentials throughout the domain if we can decompose the domain into several parts and control the interfaces of the subdomains we may also achieve a reduced wave elevation different types of the domain decomposition methods were discussed in faltinsen et al 2007 liu et al 2012 etc in the following two sections we discuss the mathematical concepts of the lid method and the domain decomposition method 2 1 the domain decomposition method the domain decomposition method breaks down the original solution domain fluid domain herein into several parts it leads to a system of integral equations on the interfaces of the domains also known as the transmission interfaces the concept can be illustrated in fig 1 fig 1 is to illustrate the idea of the method it may have some differences from the discussions in different papers f 1 f 2 f 3 stand for the free surfaces around the floaters i i i i i i i v v are the subdomains b 1 b 2 b 3 b 4 are the interfaces between the subdomains proper transmission conditions need to be specified on the interfaces b 1 b 2 b 3 b 4 in faltinsen et al 2007 the authors introduced admissible functions on the interfaces then they solved the problem in different domains separately in liu et al 2012 a dissipation boundary condition is introduced in the gap free surface f 2 and also on b 1 b 4 the boundary condition restricted the transmission of energy from domain to domain in order to ensure a reasonable wave elevation inside the gap the change in the solution system can be illustrated as in fig 2 this method is mainly applied in the 2d problem if considering the 3d case one may need to decide where to place the interfaces of the domains and also tune the unknown damping coefficients on the transmission boundary conditions to make the simulated wave elevation consistent with the experimental data 2 2 the lid method the lid method is also an effective method to damp out the wave elevation of the gap free surface it can be applied in 2d and 3d problem the methods are already included in some commercial software for example wadam and hydrostar this method modifies the boundary condition on part of the free surface to consider the change in the equation system the part of the free surface needs to be panelized and the source strength on the panels need to be solved that may be the reason why it is called lid method the concept can be shown in fig 3 in fig 3 f 1 stands for the part of the free surface without damping f 2 f 3 f 4 are the parts on which the damping terms may be included typically only f 2 is panelized sometimes f 3 f 4 or some places inside the fluid domain is also panelized to incorporate the damping effect the mathematical essence of this method is to introduce more unknowns constructing a bigger matrix it is similar to the irregular frequency removal method discussed in liu and falzarano 2016a and liu and falzarano 2017a the concept can be shown in fig 4 2 2 1 the newtonian damping method there are two similar techniques belonging to this category one is the newtonian cooling method this method was discussed in kim 2003 markeng 2017 the damping effect is enforced on the first order kinematic free surface condition we have the modified kinematic free surface boundary condition 11 ζ 1 t φ 1 z a t z 0 12 φ 1 t g ζ 1 0 a t z 0 13 ζ 1 t φ 1 z a ζ 1 b g φ 1 a t z 0 where a b are the coefficients to denote the linear relationship according to markeng 2017 we can select a b so that the dispersion relationship remains the same herein we will explore the process to decide on the value or the relationship between a b the coefficients in equation 13 if using the original dynamic boundary condition and the modified kinematic free surface boundary condition 13 we get the modified combined free surface boundary condition 14 2 φ 1 t 2 g φ 1 z a φ 1 t b φ 1 0 in deriving the dispersion relationship we assume φ 1 satisfies φ 1 x z t x x z z t t substituting the equation into the combined free surface boundary condition we have 15 t g z z t a t b t 0 from wave potential for the deep water condition we know z satisfies z k z where k is the wave number the above equation becomes 16 t g k t a t b t 0 mathematically we need to solve for this equation to find the solution for t here we are reverse engineering the previous references thus we may introduce some assumptions to explore the relationship if t satisfies t i ω t t ω 2 t we obtain the equation about the wave frequency ω 17 ω 2 g k i ω a b 0 then we have 18 ω 2 i ω a a 2 4 g k b a 2 4 ω g k b a 2 4 i a 2 if b a 2 4 ω g k i a 2 where the real part of ω is g k if we take a 2 μ b μ 2 we get the exactly same equations as in markeng 2017 as below 19 ζ 1 t φ 1 z 2 μ ζ 1 μ 2 g φ 1 a t z 0 when calculating the wave elevation the dynamic free surface boundary condition may be applied to calculate the wave elevation 20 ζ 1 1 g φ 1 t i ω g φ 1 if we take the ω g k i a 2 the wave elevation becomes 21 ζ 1 i g k g φ 1 μ g φ 1 when tuning the value of μ against the experimental data we are almost directly changing value of wave elevation additionally the combined free surface boundary condition becomes 22 φ 1 z 1 g ω 2 2 i ω μ μ 2 φ 1 ω i μ 2 g φ 1 to consider the change of the free surface boundary condition the gap surface needs to be panelized the above formula will be applied in the surface integral to solve for the source strength to conclude the newtonian damping method provides an approach to adjust the wave elevation inside the gap a different free surface boundary condition is applied inside the gap if applying the same green function a lid is needed along the gap free surface the introduction of the damping terms will affect both the equation system to solve for the potential value or the source strength and the calculation of the wave elevation to decide on a reasonable damping coefficient one needs to tune it against the experimental data this is a mathematical way to modify the method based on potential theory the process to derive the revised dispersion relationship may not be strictly accurate additionally if the wave frequency has an imaginary part and we continue using the formula φ 1 r e ϕ 1 e i ω t the term ϕ 1 may not be independent of time 2 2 2 xb chen s damping method another very promising approach is the method proposed by chen and malenica 2005 the damping force is applied in the dynamic free surface boundary condition the amplitude of the force is proportional to the amplitude of the velocity on the free surface the formula is as below 23 f μ v in the dynamic free surface boundary condition if we apply the damping force the equation becomes 24 t v v p ρ g z μ v o n z ζ x y t if assuming ideal flow the velocity can be expressed in terms of the potential as v φ then the equation is 25 t φ φ p ρ g z μ φ 26 φ t 1 2 φ φ p ρ g ζ μ φ c t o n z ζ x y t making the same choice for pressure p and the constant c t we can extract the first order o ε part of the dynamic free surface boundary condition 27 φ 1 t g ζ 1 μ φ 1 0 o n z 0 the wave elevation becomes 28 ζ 1 1 g μ φ 1 φ 1 t μ i ω g φ 1 i ω g φ 1 μ g φ 1 if substituting the wave elevation into the kinematic free surface boundary condition we obtain a combined formula 29 1 g t μ φ 1 φ 1 t φ 1 z rearranging the terms we obtain 30 φ 1 z ω 2 g 1 i μ ω φ 1 ω 2 g φ 1 i ω μ g φ 1 applying the similar technique we can get the relationship that ω and k satisfy 31 ω 2 g k i ω μ 0 solving for ω we get 32 ω g k μ 2 4 i μ 2 the real part of the wave frequency is no longer g k and ω contains an imaginary part as well in this method the free surface boundary condition inside the gap is also changed thus the gap surface needs to be panelized the damping coefficient has changed the matrix to solve for the potential value or the source strength it also appears in formula 28 to calculate the wave elevation intuitively speaking when we want to consider the damping effect we deduct a portion from the original wave elevation however if we consider the term related to damping effect we have also changed the value of the potential it is indicating that we probably need to tune the damping coefficient for several rounds to make the simulation results match the experimental data this method is an alternative approach to modify the wave elevation mathematically it has changed the dispersion relationship inside the gap surface and the dynamic free surface boundary condition when applying this method one needs to decide where is the damping zone and how large it is the choices may depend on the experience of the user 3 wall damping method 3 1 motivation considering the disadvantages of the above methods two questions come can we develop a method which does not require the user to specify where the damping zone or damping lid is can we use the information of the potential method without damping to identify the damping coefficients let s review the physical processes first in the potential method the fluid is assumed to be ideal flow which is inviscid and irrotational the energy dissipation caused by the viscous effect is neglected in the results generated by the potential method however in reality the fluid is viscous and rotational when comparing the results by potential method and the experimental data we may attribute the discrepancies to the differences in the assumptions of the fluid property therefore we say that it may be the viscous effects that damps out the wave elevation in the damping lid method the free surface boundary condition inside the gap is directly controlled to ensure a reasonable wave elevation it is a straight forward approach to adjust the wave elevation in this way the distribution of the potential value will be affected by the change in the free surface boundary condition in the domain decomposition method the fluid domain is broken down into several parts the transmission of the energy is controlled on the interfaces of the subdomains and the damping condition is also enforced on the free surface inside the gap as a result the wave elevation is ensured to be reasonable and the potential throughout the domain is likely to be altered the two types of approaches provide feasible ways to modify the matrix structure to solve for the source strength of the potential value on the ship hull through the modifications a reasonable wave elevation can be obtained in the potential method without damping the body boundary condition will determine the source strength or the potential value on the ship hull in chen and malenica 2005 the authors discuss the damping condition on the ship hull near the gap the damping condition was also adopted in coastal engineering to model the partial reflection of a wall in the sloshing problem a uniform damping effect is applied on the tank surface to adjust the motion rao of the floater as discussed in zalar et al 2007 the partial reflection is an alternative way to incorporate the damping effect of the system inspired by the discussion of the partial reflection in chen and malenica 2005 we introduce damping effects of different intensities on the ship hull surface the intensity is determined by the activity level of the fluid nearby enlightened by the domain decomposition method and based on the observation of the contour plots through the potential method we break the ship hull surface into three parts the side shell next to the gap the hull bottom and the side shell away from the gap it can be shown in fig 5 in fig 5 the green part stands for the side shell next to the gap the yellow part is the side shell far away from the gap the red part indicates the rest part of the ship in 2d the red part only includes the hull bottom in 3d cases it also includes the stern and bow in the middle region to conclude the wall damping method directly introduces the damping effect on the ship hull instead of on the free surface inside the gap this is more physical because the energy loss may mainly happen on the ship hull rather than the free surface inside the gap as discussed in the introduction part to distinguish the damping effects on different sections of the ship hull we assume different damping coefficient on different parts of the ship hull which is inspired by the domain decomposition method however instead of decomposing the fluid domain we split the ship hull into different parts 3 2 wall damping method 3 2 1 formula we incorporate the damping term into the body boundary condition by using this formula following chen and malenica 2005 33 ϕ 1 n x v n i μ ω 2 g ϕ a t b o d y s u r f a c e if we include the damping term in the body boundary condition the formula changes into 34 ϕ 1 n x 1 2 σ x 1 4 π s b σ ξ g x ξ n x i μ ω 2 g g x ξ d s ξ v n the damping term is introduced to model the partial reflection of the wall boundaries it essentially affects the value of the source strength which is used to calculate the potential value and the wave elevation inside the gap if the wave elevation without damping is too high we hope to damp out the wave elevation by tuning the damping term introduced here in our case we assume the damping coefficient μ is a function of location y and the incident wave frequency ω μ μ y ω y is adopted to decompose the ship hull into 3 parts and μ will stay constant on each of the three parts of the ship hull given the frequency we decide which region a panel falls into based on the location of its centroid the values of μ on different regions can be different 3 2 2 determination of ratios therefore to consider the different damping effects on the three sections of the ships we assume the damping coefficients satisfy a ratio of a b c to decide the damping coefficients in the equation we multiply a constant μ to the ratio then the damping coefficients are a μ b μ c μ consequently we need to decide the value of μ and the ratio of the damping coefficients a b c in this method we assume that the panels belonging to one section share the same damping coefficient it is similar to adding an average damping to the section if we assume the damping effect is positively correlated to the prediction through the potential method we may use the ratio of the potential values to help decide the ratio of the damping coefficients in generating the results for wave frequencies ranging from 6 01 9 91 rad s we can obtain the potential value for each panel at each frequency herein we assume the average effect can be achieved by two types of ratios one ratio is obtained in this way first summing up the potential value at each section for all frequencies then find the mean value of the potential for each section and finally calculate the ratio we may name it as ratio of the mean the other ratio can be named as ratio of the max mean firstly we compute the mean of the potential values for each section at a certain frequency then we find the ratio for each frequency if we denote the ratio as the format 1 x y and y x 1 we can eventually find the ratio with the largest value of y that ratio is our final selection please note that we will always divide each number in a ratio by the smallest number so that the ratio has 1 as the minimum value this is a rule of notation to describe the possible relationship between the damping effects on different sections herein we provide two possible types of ratios for reference the ratios reflect the difference in the average potential value in practice other types of ratios can be defined as well the values in the ratios will affect the amplitudes of the kernel functions discussed below the bigger number inside a ratio will lead to a smaller amplitude of the kernel function 3 2 3 kernel function the ratios of the potential values on the 3 sections indicate the average activity level of the fluid close to the different sections however based on the observations the activity level is frequency dependent in other words at some frequencies especially the resonant frequencies the amplitude of the wave elevation or the velocity of fluid inside the gap is relatively larger we may assume when the fluid has a relatively larger velocity the friction effect can cause more energy loss to the system in other words the damping effect is positively correlated with the activity of the system generally the damping effect becomes significant when reaching the resonant frequencies and it may also grow with the increasing wave radian frequency because the velocity amplitude of the fluid particles is growing as the frequency increases to consider the resonance effects we propose to apply the gaussian kernel function in the function of the damping coefficient μ the formula of μ is expressed as 35 μ i r e s a i e x p k ω ω i r e s where res stands for resonance the number of the terms is equal to the number of resonant frequencies observed a i is the amplitude of the kernel functions k is the decay ratio and ω i r e s is the resonant frequencies in this equation ω i r e s is determined from the results of the mdlmultidyn without the non potential flow damping effect the unknowns are all the a i and the decaying factor k additionally the in house program mdlmultidyn is developed by liu and falzarano 2016b to study the hydrodynamic problems of multiple floaters it has the module to remove irregular frequency effects liu and falzarano 2017e has two options to evaluate the mean drift forces in liu and falzarano 2017d liu and falzarano 2018 and is able to perform analysis for low speed cases liu and falzarano 2017c liu and falzarano 2017b the program mdlmultidyn can be used for generating the input of the evaluation of wave energy converter discussed in wang et al 2017 wang et al 2017 wang and falzarano 2013 mdlmultidyn is currently for the study of the cases in deep water only the module of finite depth green function is under development by xie et al 2017 and will be incorporated into the main program which can be applied to numerically simulate the offshore applications in frequency domain for example the problem discussed in xie et al 2015 the module of quadratic transfer function is completed by xie et al 2019 given the experimental data we may adjust the value of a i and k to make sure the results from the wall damping methods are consistent we can first tune the amplitude of the kernel function for the result of each resonant frequency separately more specifically we tried different values of a i at a certain frequency then we chose the a i which makes the wave elevation from simulation close to the experimental data and repeat the steps for other resonant frequencies in this way we can find proper values of a i afterwards by adjusting the value of k we make the results at other frequencies approximately consistent more specifically we tried different values of k after we decided the values of a i until the results are close to the experimental data the value of k decides how fast the damping coefficient will decay from a certain resonant frequency if the k is zero the damping coefficient will be a constant for all frequencies if the k is very small it decays slowly when the frequency of interest is away from the resonant frequencies when k is large it decays relatively fast when the frequency of interest is shifted away from a certain resonant frequency when k is approaching infinity the damping coefficient will be approximately zero at all frequencies except for the resonant frequencies if enforcing too much damping effect the wave elevation will be relatively smaller the objective of the tuning process is to find a proper value of k which introduces a proper amount of damping at all frequencies in the next section we will demonstrate the effectiveness of the wall damping method 3 2 4 discussion on wall damping method up till this step we have finished the discussion of the motivation of the wall damping method the formula and the tuning process we discuss the advantages and possible limitations of the method in this section the wall damping method directly models the energy loss on the ship hull which is more physical compared against the lid method applied on the free surface inside the gap it does not change the dispersion relationship when enforcing the damping effects more importantly this method may prove that we are able to dig out more information on the damping effects based on the results from the linear potential method without damping the model discussed here is one possible guess of the relationship between the output of the potential theory method and the experimental data if obtaining more experimental data we will find a better model which may be better generalized however this proposed method has more free parameters to be determined than the damping lid method the user may spend more efforts in tuning the parameters by assuming the linear relationship of the amplitudes at the resonant frequencies we can decrease the number of free parameters to mitigate the drawback more details will be provided in the next section 4 results herein we will mainly study the wave elevation at the wave gauge 4 which is located at the center of the gap we apply the methods to the cases in both head sea and beam sea conditions to prove the effectiveness herein we choose the ratio of the max mean as an example it is equivalent to choose the other ratio the steps remain the same the difference may lie in the expressions of the kernel functions to evaluate the methods we developed the program in matlab using the output of intermediate steps from mdlmultidyn in the comparison the results from the matlab code is always on top of those from the multidyn when there is no damping effect which is to validate the correctness of the matlab code 4 1 head sea condition after running the case using our in house program mdlmultidyn the ratios are obtained as in the table table 1 below by tuning the parameters we find the values of a are 0 0005 0 0010 0 0016 0 0026 0 0032 and the value of k is 26 the damping constant curve of μ is shown in fig 6 the circles on the curve indicate the values we selected at each frequency which is adopted in the simulation of the mdlmultidyn while plotting the curve we find that the amplitudes at or near the resonant frequencies almost follow a linear relationship on top of the curve we also plot the fitted curve of the amplitudes it shows that the linear curve fits well applying the damping constants we find the damping coefficient on each section at each frequency after incorporating the damping effects we can obtain the damped curve in fig 7 from the comparisons we can observe that the damped curve is consistent with the experimental data the method is effective in generating a reasonable wave elevation in the method we have to choose 6 parameters based on the linear relationship of the amplitudes at the resonant frequencies we may just need to tune 3 parameters the amplitudes at 2 resonant frequencies and the parameter k thus we select the amplitudes at the minimum and maximum resonant frequencies to tune and apply the fitted curve to obtain the damping constant for other amplitudes fig 8 shows the difference between tuning 5 points and 2 points applying the fitted curve we obtain the curve using the modified potential method as shown in fig 9 it is approximately the same with that when adjusting the five amplitudes independently 4 2 beam sea condition similarly we can obtain the ratios based on the results from the potential method table 2 by tuning the parameters we find the values of a are 0 0014 0 0020 0 0032 0 0042 0 0054 and the value of k is 15 the damping constant curve of μ is shown in fig 10 considering the damping effects we can obtain the results for the modified potential method as shown in fig 11 if we choose the 3 parameters to tune we obtain the curves of the damping coefficients as shown in fig 12 applying the damping constants by fitting the 3 parameters we obtain the results from the modified potential method as shown in fig 13 not surprisingly the results are almost the same with those by fitting 5 parameters 5 conclusion we discuss the proposed method to damp out the wave elevation inside the gap the method is a significant improvement based on the damping method applied in the sloshing problem and the coastal engineering problems in this method we introduce damping effect only on the ship hull the damping effect differs by the location relative to the gap the assumption is that the damping coefficient is positively correlated with the activity level of the fluid domain if the velocity of the fluid field is large then the damping effect is also significant the method does not require the user to choose a damping domain or change the dispersion relationship the information from the results without damping is helpful to choose the parameters of the method we use the resonant frequencies from the linear potential method to decide the centers of the gaussian kernel functions the amplitudes of the gaussian kernel functions are initially found by tuning against the experimental data afterwards we find the amplitudes are approximately linear in wave frequency therefore the function a ω assumes a linear function in ω alternatively if we find the amplitude for the minimum and maximum resonant frequencies by tuning against the experiment we can find the amplitudes of the gaussian kernel function at other resonant frequencies in this way the shortcomings of the method is minimized this method is our first trial on the damping problem if obtaining more experimental data of various floaters or different conditions in the future we will extend the concept of the method and improve this method using advanced techniques acknowledgments the authors would like to thank dr wenhua zhao for providing the experimental data for analysis also partial support was provided by office of naval research under onr grant n000 14 16 1 2281 and society of naval architects and marine engineers 
23007,the calculation of hydrodynamic lifting forces sustained by a sailing yacht s hull performing maneuvers in regular incident waves is reported the mathematical model involves the application of the lifting surface theory for transient flows implemented through the numerical scheme of the vortex lattice method and corrected for linear thickness effects of the simulated body geometry the mathematical influence of the waves appears through the derivation of the wave potential and it is employed in a kinematic sense via the introduction of an additional inflow velocity component on the lifting surface validation with data derived from experiments in calm water showed very good agreement additionally the variation of the side force coefficient while sailing in waves has been quantified in terms of the amplitude of oscillation due to the wave orbital velocities the formulation is intended to upgrade the respective computational component in a mathematical model previously developed by the authors for the maneuvering motions of sailing yachts parametric studies of maneuvering and course keeping demonstrate a sensitivity of the yacht to wave steepness and heading angles with a deficit in sustaining capacity appearing for lower wind speed keywords sailing yachts hydrodynamic lift yacht maneuvering in waves abbreviations nomenclature dof degrees of freedom crd chordwise direction dsyhs delft systematic yacht hull series lst lifting surface theory spn spanwise direction vlm vortex lattice method vpp velocity prediction program a i j matrix of influence coefficients a m ordinates transformation matrix b max maximum breadth m b wl breadth of waterline m c m mollifier constant c d drag force coefficient c l lift force coefficient c p prismatic coefficient c s side force coefficient c x sail driving coefficient on surge mode c y sail driving coefficient on sway mode c sw amplitude of oscillating side force coefficient c t total resistance coefficient d s differential surface m2 d total drag force n e s horizontal dimension of main sail m f total force or moment n or nm f hs hydrostatic excitation force or moment n or nm f mhr maneuvering hydrodynamics excitation force or moment n or nm f w waves excitation force or moment n or nm f s sails excitation force or moment n or nm g gravity acceleration m s2 h critical critical wave steepness h steep wave steepness i evaluated panel i x roll moment of inertia kg m2 i y pitch moment of inertia kg m2 i z yaw moment of inertia kg m2 i s vertical dimension of jib sail m j inducing panel due to vortex singularity j s horizontal dimension of jib sail m k wave number rad m k total moment in roll mode nm k i j velocity coefficient of panel j to panel i k p proportional gain k d differential gain s l vortex segment length l lift force direction vector normal to inflow velocity l total lift force n l per l cb longitudinal center of buoyancy m l per perimeter of vortex ring m l wl length of waterline m m yacht mass kg m total moment in pitch mode nm m l velocity mollifier n total moment in yaw mode nm n c number of panels of mean camber surface n i normal vector of panel i n k number of panels of first wake strip n w number of panels on wake surface p evaluation reference point p s vertical dimension of main sail m p roll velocity degrees s p l pressure on lower side of camber surface pa p m mollifier coefficient p u pressure on upper side of camber surface pa q pitch velocity degrees s r yaw velocity degrees s r m mollifier distance m r mollifier regularization core radius m r p distance vector to point p m r t upright viscous and wave making resistance kn s surface m2 s c mean camber surface m2 s k wake spanwise first strip s w wake surface m2 s wet wetted surface of hull including canoe body and appendages m2 t time s t drag force direction vector parallel to inflow velocity t deviation from design draft m t c canoe body draft m u surge velocity m s v sway velocity m s v c velocity due to body thickness effects m s c canoe body volume m3 v b body velocity m s v a effective velocity m s v free stream velocity m s φ perturbation velocity m φ w b wave induced velocity body fixed system m s v p vortex induced velocity at point p m s v w p velocity at wake point w p m s w heave velocity m s x body fixed system longitudinal ordinate x total force in surge mode n x b body fixed system longitudinal axis x cg longitudinal position of center of gravity m x cs longitudinal position of sails center of effort m y body fixed system transverse ordinate y cg transverse position of center of gravity m y cs transverse position of sails center of effort m y total force in sway mode n y b body fixed system transverse axis z body fixed system vertical ordinate z total force in heave mode n z b body fixed system vertical axis z cg vertical position of center of gravity m z cs vertical position of sails center of effort m w p wake point α angle of attack degrees γ surface vorticity 1 s γ vortex strength m2 s γ x chordwise surface vorticity 1 s γ z spanwise surface vorticity 1 s ε wave phase degrees ε csw side force comparison percentage difference ζ earth fixed system vertical ordinate ζ amp wave amplitude m η earth fixed system transverse ordinate θ pitch angle degrees λ wave wave length m μ wave heading angle degrees μ y y sectional sway added mass in the limit of zero frequency kg m ξ earth fixed system longitudinal ordinate ρ fluid density kg m3 τ thickness m φ heel angle degrees φ w wave potential ψ heading angle degrees ψ r desired heading angle degrees ω wave frequency hz 1 introduction to maintain a good level of rolling and course keeping capability a yacht needs to have its underwater components designed to counteract the aerodynamic excitations incurred by the large offsets of the sail forces centers of action these large aerodynamic roll and yaw moments are counteracted through suitably designed hull appendages keel and rudder and to a lesser extent canoe body in sailing yachts terminology the matter is often addressed in terms of the side force i e the projection on the horizontal plane of the hydrodynamic lift force developing on the yacht in the past this force has been successfully determined experimentally e g gerritsma and keuning 1990 and computationally e g keuning and verwerft 2009 however mostly for calm sea and in a steady state sense there has not yet been much attention on the actually transient nature of this force and whether this can affect the assessment of a sailing yacht s maneuvering performance moreover when a yacht operates in waves the lift force will vary as yachts are usually characterized by a shallow draft and consequently they have both their canoe body and their appendages operating in close proximity to the free surface they are subjected to orbital water velocity perturbations induced by the waves in the present paper is proposed a computational model for the calculation of the hydrodynamic lift forces arising due to transient flow considering also the effect of regular incident waves this model is incorporated into a broader mathematical model of yacht maneuvering motions in waves which was recently developed by the authors the maneuvering model is intended to offer capability for addressing phenomena of course instability that could be experienced during operation in waves angelou and spyrou 2017 its strength lies in the integration in a modular sense of several aerodynamic and hydrodynamic solutions that in their majority are able to account for the exact form of any investigated yacht hull except of course for any loss of detail due to geometrical approximations however in terms of the model s overall completeness a few components such as the one handling the hydrodynamic lift have been limited to steady state modeling a numerical method is proposed in the current paper which is intended to improve the hydrodynamic lift calculation of the maneuvering model it is based on the application of the well known lifting surface theory with a linearized kutta condition for transient flows modified to account for the thickness effects of the simulated bodies the modification of hydrodynamic lift due to the encounter of harmonic incident waves from any direction is also addressed it is attacked via enriching the neumann boundary condition with a term related to wave orbital velocities maneuvering models of sailing yachts have a long history gerritsma 1971 investigated the wave making effects on the maneuvering derivatives by comparing a lifting line numerical model of a yacht against planar motion mechanism experimental results in a follow up study was assessed the impact of the helmsman s performance on directional stability through bode diagrams gerritsma and moyes 1973 nomoto and tatano 1979 discussed the rudder effects on the yaw balance of a yacht by performing related experiments and by modifying the numerical model of gerritsma 1971 the forces on the appendages were provided by the lifting surface theory for steady flows while the hull was modeled using the slender body approximation letcher 1976 constructed a linearized model for the maneuvering motions of a yacht supplemented by a windvane steering mechanism he tackled the dependence of the dynamic behavior of the system on the values of maneuvering derivatives wind operating conditions and control parameters masuyama 1987 employed a surge sway roll yaw model to study the effects of a windvane mechanism on a yacht equipped with a lifting hydrofoil additionally he performed directional stability simulations under fixed rudder condition while having the wind speed and direction and the sails angle of trim as varying parameters he then identified that the necessary gains of a simple pd proportional differential controller for sufficient course keeping are extremely low the method was based on the derivation of maneuvering derivatives from forces retrieved from steady state simulations more recently battistin and ledri 2007 developed a model for the optimization of tacking maneuvers while verwerft and keuning 2008 incorporated the lift calculations from the extended keel method to a time domain maneuvering model for the creation of a dynamic velocity prediction program vpp in the next will be outlined first the method of lift calculation for steady flows and then will be introduced the proposed improvements accounting for transient flow and harmonic waves the computational framework will be evaluated through application to a well known test case the sysser 26 belonging to the delft systematic yacht hull series in the second part of the paper will be briefly outlined our yacht maneuvering model after incorporating the transient lift calculation this model will be used for assessing the capability of the sysser 26 in tack maneuvers and also in course keeping scenarios 2 numerical formulation 2 1 lifting surface theory lst for steady flows the lst is one of the oldest and yet very useful methods to address potential flow effects on a thin body in the absence of flow separation as well known the basis of its formulation can be traced back to lanchester 1907 and prandtl 1918 the method exploits the convenience that flow perturbations could be represented by continuous vortex sheets and that these sheets themselves may in turn be replaced by lines of concentrated vorticity the introduction of vorticity allows the modeling of flow discontinuities that appear due to adjoining materials of different density e g solid fluid interface or even of a kinematic disturbance inside a volume of homogeneous fluid e g trailing wake in terms of a body moving with a velocity v b inside a fluid domain characterized by a steady velocity v moving thus with respect to the fluid with v a eq 1 vorticity is created in the body fluid interface i e bound vorticity and is then shed to form the wake s from one or many separation lines i e shed vorticity 1 v a v v b the body fluid interface is ideally an equivalent to the real surface i e the zero thickness mean camber surface of the thin body it is noteworthy that the bound vorticity is not literally bounded on the body but it is continually created on it and is shed likewise into the wake however the term bounded is often used for referring to newly generated vorticity in any specific time step additionally it is important to mention something often overlooked in the literature i e that the formulation of lst neither ignores nor disregards the effects induced by the thickness of the body but it rather allows the contributions from camber and thickness to be mathematically decoupled from each other and be treated separately e g thwaites 1960 the lst is usually applied through the numerical scheme based of the vortex lattice method vlm i e the discretization of a surface into a series of rectangular panels on which the discretized vortex entities are placed the utilization of lst through the numerical scheme of vlm is widely published in the literature e g katz and plotkin 2001 in our previous work the lst had been employed by using the vlm for steady flows angelou and spyrou 2017 the mean camber surface s c was discretized to numerical rectangle panels on which horseshoe vortices of constant strength were distributed the inducing velocity of any horseshoe of vortex strength γ at any point p in the domain was dictated by the biot savart type integral overall the induced velocity of every horseshoe vortex j to every panel point i was represented by a matrix of influence coefficients and the no entrance boundary condition reduced to a system of linear equations a i j γ j v a i n i the unknown vortex strengths were obtained by the solution of this linear system the wake vortex lines initially dictated by the undisturbed flow frozen wake propagating aft towards the direction of the free stream were then rotated in order to become aligned with the local total velocity vector and provide so the roll up of the wake 2 2 modification of the model to treat transient flows in the updated model the surfaces of both the body s c and the wake s w are discretized using rectangular panels on which vortex rings are placed instead of horseshoe vortices the formulation is based mainly on katz and plotkin 2001 each ring characterized by a vortex strength γ and a perimeter l per induces at any point p in the domain a velocity expressed as 2 v p γ 1 4 π l p e r d l r p r p 3 γ k i j as in the previous model for steady flows the neumann boundary condition is enforced in order to create the linear matrix of coefficients and solve for the unknown vortex strengths however to ensure the satisfaction of the physical requirement of p u p l no pressure discontinuity at the body s trailing edge an additional spanwise strip of panels s k is employed and it is placed between the trailing edge panels and the first strip of the wake panels 3 j 1 n c k i j γ j j 1 n k k i j γ j j 1 n w k i j γ j v p the equation for the total vortex induced velocity at any point p eq 3 is now subjected to the application of the neumann boundary condition on each ring center in a time marching scheme the strengths of the wake s w vortex rings are initially zero and they are successively updated on the basis of the previous time steps to reflect this the respective term is moved to the right hand side additionally by including the effective inflow velocity the neumann boundary condition equation becomes 4 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a j 1 n w k i j γ j the influence of the free surface is treated using the mirror body technique e g katz and plotkin 2001 αlternatively free surface panels could have been used however as the number of these panels would be large the formulation would be less attractive for investigating course instability phenomena where usually a large number of simulations is required and for this reason at this stage it was avoided lastly and considering the aforementioned trailing edge pressure equality necessity the linear system is supplemented by a kutta type condition for s k politis 2016 discusses the usefulness of the linearization of the unsteady pressure kutta equation either as a sufficient approximation in order to satisfy the trailing edge pressure equality during quasi steady flows or as a first step for solving the full non linear equation then the pressure type kutta equation would become 5 p u p l ρ n φ v a γ ϑ γ ϑ t and since p u p l 6 n φ v a γ ϑ γ ϑ t solving the linear system of equations 4 and 6 provides for the unknown vortex strengths the vortex rings that lay on the strip s k are allowed to shed in order to form the wake and in fact their values as they occurred from the solution of the linear system of equations 4 and 6 at the n time step are assigned to the rings of the first spanwise wake strip of s w at time step n 1 concurrently the vortex values of the first spanwise strip of s w at time step n are assigned to the rings of the second spanwise strip at n 1 and so forth additionally during every time step n the vortex rings located at s c s k and s w all participate in the calculation of the induced velocity on the wake rings corner points this velocity is vectorially added to the free stream velocity to provide the total velocity v w p eq 7 for the displacements of ring corner point w p by multiplication with the set time step 7 v w p φ w p v however the reforming of the wake strictly speaking in terms of curvature as the connectivity and the vortex strength of the rings remain unchanged entails the roll up procedure which can induce numerical instabilities regarding the inducing velocities among the vortex rings this is most probable when the latter are located in very close proximity of each other or in case where the collocation point of any ring is concentric with a vortex segment of any other ring causing a singular behavior of the kernel of equation 3 this may be treated by employing mollifying functions so as to provide the vortex segments with a finite core r and smooth the wake s shape these functions have been widely used in studies involving lagrangian representations of vorticity and are often introduced in the form of a simple algebraic form as in shankar and van dommelen 1996 or as a gaussian distribution equipped with a cut off parameter as in barba et al 2004 in the current study the mollifying function is treated as in politis 2016 and the integral k i j in equation 2 is supplemented by 8 m l c m p m r m r 1 exp c m r m r p m where p m 3 and c m 0 69314718 so the integral k i j now becomes 9 k i j 1 4 π l p e r m l c m p m r p r d l r p r p 3 where in this case r p denotes the distance from the core of each vortex segment to the velocity evaluation point lastly since there is no modeling of vortex diffusion the vortex strength of each shed wake panel remains constant throughout the calculations according with helmholtz s theorems additionally vortex dependence on time in this formulation is only implicit the wake of a lifting surface is characterized by a maximum length starting from the trailing edge and extending abaft the authors have observed that for bodies of large aspect ratio as yacht appendages calculations converge when the wake length is about 6 or 7 chord lengths the vorticity of each shed wake is traversed backwards until it reaches the limiting distance 2 3 modification for harmonic incident waves being wind assisted a sailing yacht hardly operates in an environment free of wind generated waves whatever the development of the sea state might be additionally the body itself produces wave disturbances as it translates rotates and oscillates due to its course propagation or as a reaction to the incoming waves all these perturbations induce orbital velocities to the water particles the yacht is immersed into it is common in terms of the linear wave theory to decompose the aforementioned waves into incident radiated and diffracted components represented in turn by respective potentials for the time being for the calculation of hydrodynamic lift only the incident wave potential is considered inclusion of the radiation and diffraction potentials in the case of a yacht with forward speed is expected to have an impact especially on rudder response as the wave field is propagating abaft however employment of these potentials would require the solution of the full body in waves problem which is currently out of the scope of this work in mathematical terms the waves are involved here by introducing the influence of a single harmonic enabling so the incident wave potential in any point in space time with respect to an earth fixed system fig 1 to be expressed as 10 φ w ξ η ζ t g ω ζ amp exp k ζ cos k ξ cos μ k η sin μ ω t ε while φ w provides the wave orbital velocities as 11 ϑ φ w ϑ ξ ω ζ amp exp k ζ sin k ξ cos μ k η sin μ ω t ε cos μ 12 ϑ φ w ϑ η ω ζ amp exp k ζ sin k ξ cos μ k η sin μ ω t ε sin μ 13 ϑ φ w ϑ ζ ω ζ amp exp k ζ cos k ξ cos μ k η sin μ ω t ε and their expression in the body fixed system is 14 φ w b ϑ φ w ϑ ξ b ϑ φ w ϑ η b ϑ φ w ϑ ζ b a m ϑ φ w ϑ ξ ϑ φ w ϑ η ϑ φ w ϑ ζ where 15 a m cos θ cos ψ cos θ sin ψ sin θ cos ψ sin θ sin φ cos φ s i n ψ cos φ cos ψ sin θ sin φ sin ψ cos θ sin φ cos ψ sin θ cos φ sin φ s i n ψ cos φ sinθ sin ψ sin φ cos ψ cos θ cos φ the influence of the wave induced velocity perturbations can now be accounted for by enriching the neumann boundary condition eq 4 with an additional term e g φ w b n as 16 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a φ w b j 1 n w k i j γ j 2 4 correction for linear thickness effects regarding the thickness distribution that characterizes a thin body and the aforementioned implementation of the associated effects in the vlm kinnas 1992 offered a formulation that introduces the thickness influence in terms of a distribution of additional vorticity by modifying the neumann boundary condition for bodies with zero camber the right hand side of equation 16 is enriched with an additional term v c that depends on the vorticity obtained by the zero thickness formulation equation 18 17 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a φ w b j 1 n w k i j γ j v c where 18 v c s γ n 4 1 4 ϑ γ z τ ϑ x ϑ γ x τ ϑ z this computational procedure is adopted and the vorticity that is predicted from the solution of the zero thickness formulation described in sections 2 2 2 3 is interpolated spanwise and chordwise across the lifting surface in order to obtain γ x γ z and then v c subsequently the linear system is solved again using the modified boundary condition finally the force on a differential area equation 19 is analyzed to lift and drag components by using the respective inflow angle 19 d f ρ d s φ v a γ n ϑ γ ϑ t concluding the lift and drag coefficients are obtained from equations 20 in terms of the vortex lattice a series of verifications and validations on the formulation presented in section 2 are contained in appendices a to c 20a c l l 0 5 ρ v a 2 s where l i s p n j c r d l d f j i 20b c d d 0 5 ρ v a 2 s where d i s p n j c r d t d f j i 3 case study sysser 26 of dsyhs 3 1 side force calculations in calm water the method is applied on a sailing yacht hull the sysser 26 which belongs to the delft systematic yacht hull series gerritsma and keuning 1992 and has been tested in upright and in heeled conditions for the evaluation of the lift force that is developed from the system of hull keel rudder the geometry tested earlier in the towing tank of delft is that of a scaled model with l wl 2 0 m and the form parameters of the canoe body of the hull and the dimensions of the appendages are given in table 1 gerritsma and keuning 1992 for validation of the responses in calm water the yacht is modeled numerically in the same scale i e l wl 2 0 m and as a combination of three lifting surfaces i e a keel a rudder and a low aspect ratio surface that resembles the canoe body the three lifting surfaces are in very close proximity to each other but do not share common boundaries the panels on each lifting surface are created using a cosine spacing scheme on both chordwise and spanwise directions fig 2 crude paneling for illustrative clarity while the wall influence of the sea free surface is involved using the mirror body approximation the number of the panels used in the simulations were 10 21 chordwise x spanwise for the keel and the rudder whereas for the hull they were 21 10 the yacht appendages have had their thickness contribution on the developing lifting forces evaluated using the formulation of kinnas 1992 however this was not the case for the canoe body whilst the maximum breadth of the latter satisfies the maximum thickness limit suggested in kinnas 1992 its actual shape is discouraging in waterlines context a typical yacht waterline in the vicinity of the free surface bears strong resemblance with a foil subjected to reverse flow i e with a thin leading edge and a blunt trailing edge moving deeper towards the bottom of the hull a waterline is often widened to an ellipse both of these kinds of shapes are prone to the occurrence of flow separation from both edges even at low inflow angles stall of an airfoil in reverse flow will appear at lower inflow angles than what would have been in the case of forward flow but still in larger angles of attack i e on or beyond the upper limit of operational drift angles of sailing yachts in fact and for reynolds number of order 10 6 stall would appear at around 14 o for a 24 thick symmetrical ellipse and 10 o for a naca 0024 lind 2015 however before stalling flow separation would have started and the slope of the lift curve is decreased compared to forward flow the thickness formulation of kinnas assumes attached flow and provides for a growth in circulation around the lifting surface including the thickness effects for the canoe body would then increase the obtained lift instead of decreasing it however the canoe body is modeled as a zero thickness wing of very low aspect ratio and it has comparatively very low lift loading omitting the aforementioned decrease in the lift slope and for the small range of operating drift angles is not expected to induce major differences in the obtained responses concluding the canoe body was modeled as a lifting surface without the correction for the thickness effects neither separation effects have been implemented additionally as the wake of the hull is propagating aft it pierces the vortex lattice panels of the rudder causing numerical instabilities in the computations in order to overcome this hull s wake is forced to sustain a trailing angle of at least 1 o until it is clear off the rudder panels subjecting the system in various angles of heel and inflow angles produces the side force coefficient c s i e the lift coefficient projected in the horizontal earth reference plane c s c l cos φ the drag force contribution has been neglected as the calculated values are of insignificant magnitude in general good agreement is found fig 3 with the experimental values of gerritsma and keuning 1992 note that the wetted part of a heeled hull will act as an asymmetric foil but since any thickness effects have been omitted this is not captured by the current implementation 3 2 side force in harmonic waves an insight on the effect of the waves onto the developing hydrodynamic lifting forces of a sailing yacht can be obtained by subjecting the lifting surfaces of the examined yacht sysser 26 to the orbital velocities of harmonic waves we should note that in all simulations from now on the yacht has been modeled in full scale l wl 10 0 m while the panel density for the lifting surfaces remains as in the previous section the simulations involve waves with length λ wave 2 0 l wl and steepness h steep 1 150 in general long waves relatively to the yacht will be used as these are believed to incur course stability problems the obtained values of the side force coefficient exhibit oscillatory behavior around the respective converged calm water value in fig 4 is plotted the side force coefficient for head or following waves in comparison to the one for calm sea the heel angle was set at 10 o and the inflow angle of attack leeway or drift angle at 6 o the difference between the wavy and calm sea scenarios is up to 20 of the converged value the frequency of the variation of the side force coefficient is the frequency of encounter of the yacht with the waves another view of waves influence is obtained by performing a computational sweep for several scenarios where the wave direction μ ranges in the earth fixed system from purely following 0 o to head waves 180 o the angle of attack α from 0 o to 10 o and the heel angle φ from 0 o to 25 o the calculations are performed using incremental angle changes of 10 o 0 5 o and 5 o for heading angle of attack α and heel respectively after each simulation reaches a periodic state the amplitude of the oscillating side force coefficient c sw μ α φ can be identified and all amplitudes are presented in fig 5 it is noteworthy that for beam waves i e μ angle in the range of 90 o the orbital velocities can become significant enough so that the side force coefficient c s might even be led to a change of sign compared to the respective calm water case however in reality separation effects would have appeared and the amplitude of oscillation would have been smaller notice also the slope of the area that the high amplitude values appear i e with a slight offset before pure beam waves this is attributed to the prescribed angle of attack drift angle α and in fact maximum amplitudes are obtained when the relative angle of incoming waves on the yacht becomes 90 o additionally the reverse analogy of the occurrence of larger c sw for smaller heel angles is coherent with the physical reality in the upright position the yacht spans a larger vertical area in the water and it is subjected to larger deviations of the orbital velocities whereas when the yacht adopts a heel angle its geometry is contained in a smaller vertical extent and consequently the orbital velocities vary less lastly the vertical position of the yacht was considered fixed and unaffected by the waves in order to evaluate this a parametric study is carried out for the ratio of wave steepness to canoe body draft h steep t c and the result is compared with the case where the yacht is allowed to heave and pitch adjusting to the wave contour the yacht is considered maintaining a heel angle of φ 5 o and it encounters bow quartering waves with μ 135 o the percentage ε csw of the difference between the two cases is shown in fig 6 and it appears negligible 21 ε csw c sw cont c sw fixed c sw fixed 100 it should be noted that in the proposed formulation and considering the inflow velocity all lifting surface panels up to the design waterline are continually considered immersed in the water however by checking at each time step the panel and free surface relative positions only those panels that are actually submerged are subjected to the wave orbital velocity it is noted however that literature exists in bem e g young and kinnas 2003 targeting surface piercing propellers where are introduced additional kinematic and dynamic boundary conditions for the ventilated panels however considering the already high complexity of the presented model such matters are left for a possible investigation in the future 4 impact of transient hydrodynamic forces on maneuvering 4 1 upgrading the existing maneuvering model our maneuvering model is a 6 dof mathematical model incorporating hydrodynamic and aerodynamic excitations in modular form the general form of the equations is given below surge 22 m u q w r v x cg q 2 r 2 z cg p r q x m g sin θ sway 23 m v r u p w z cg q r p x cg q p r y m g sin φ cos θ heave 24 m w p v q u z cg p 2 q 2 x cg p r q z m g cos φ cos θ roll 25 i x p m z cg v r u p w m x cg z cg q p r k m g sin φ cos θ z cg pitch 26 i y q i x i z r p m z cg u q w r v m x cg w p v q u m x cg z cg p 2 r 2 m m g x cg cos φ cos θ yaw 27 i z r i y i x p q m x cg v r u p w m x cg z cg r q p n also 28 f f hs f mhr f w f s where f represents any force or moment component of the vector x y z k m n and the subscripts in equation 28 indicate contributions from hydrostatics hs maneuvering hull reaction and resistance mhr wave w and sails s respectively in accordance with the excitation being of hydrodynamic or aerodynamic origin the equations of motion are additionally supplemented by a simple pd controller 29 δ ψ r k p ψ ψ r k d r and the following kinematic relations between the body fixed and earth coordinate systems that are presented here in terms of completeness the velocities in the earth fixed system can be obtained by 30 ξ η ζ a m 1 u v w where a m was defined in equation 15 and 31 φ θ ψ 1 sin φ tan θ cos φ tan θ 0 cos φ sin φ 0 sin φ cos θ cos φ cos θ p q r while tracking of the yacht s origin in the earth fixed system is provided by numerical integration of the above the detailed form of our model without the new aspects was presented earlier in angelou and spyrou 2017 for readers convenience is outlined below the content of its modules also data relating to the hydrodynamic modeling of the sysser 26 hull as also the kinematic relations between body fixed and earth coordinate systems are collected in appendix d for the representation of hull s geometry flat triangular panels or transverse sections are used at every time step the actual wetted surface is calculated by accounting for the instantaneous position of the hull considering the incoming waves the heave and the angles of heel pitch and yaw the hydrostatic loads hs are calculated by integrating numerically the static pressure at the centers of the wetted panels of the hull the module for resistance and maneuvering hull reaction mhr contains the components regarding the forward resistance of the yacht the hydrodynamic derivatives the cross flow effects and also the maneuvering lift effects of the canoe body and the appendages the resistance of the yacht is decomposed to viscous induced and wave making parts where the induced terms are actually the components of the forces that this paper addresses and it accounts for the canoe body and the appendages the viscous terms are based on the method of van oossanen 1993 and the wave making resistance contributions are obtained by evaluating the khaskind s integral for the area of certain transverse sections in the hull as in pascual 2007 the hydrodynamic derivatives are based on an integration across the length of the hull of the 2 d sway added mass of certain transverse sections yuanxie 1986 including the canoe body and the appendages this was calculated by formulating a low order boundary element method and each section was evaluated for a range of drafts by accounting for the instantaneous draft of each section due to the waves variation of the hydrodynamic derivatives according to hull s position is allowed cross flow effects are implemented as in söding 1982 by accounting for a sway force and a yaw moment that are based on a cross flow drag coefficient retrieved from data concerning 2 d bodies of similar shapes hoerner 1965 additionally the roll damping is calculated using the method of schmitke 1978 considering the forces on the appendages incorporated through f mhr in the previous version of the model their calculation was limited to steady flow cases also lift s contribution did not account for the hydrodynamic interference of neighboring or adjacent bodies additionally the influence of wave orbital velocities was not included these issues have all been accounted through the presented method moreover the canoe body was approximated by employing the lift characteristics of a flat plate of very low aspect ratio whilst a crude assumption this was not necessarily a weak approach because ellipsoidal shapes like a canoe body experience flow separation effects that cannot be handled by the new formulation either however the latter was chosen as it offers the option to include in the computations the influence that the vorticity of the canoe body s lifting surface holds onto the respective vorticity of the appendages the geometric centers of the lifting surfaces in the presented study were considered as centers of effort in order to define moment arms additionally all related inflow velocities are transformed appropriately to the body fixed system and are used as input to the lifting surface solver the sails s driving coefficients were pre calculated by a fluid structure interaction scheme for steady flows upwind cases or retrieved from published values of driving coefficients downwind cases however for the former the structural solver was based on a theoretical model capable of sufficiently handling geometry displacements that were ideally significantly smaller than those encountered during the simulations additionally the absence of flow separation effects led to an over prediction of the propulsive power available by the sails that being so the sails in this study are modeled using the driving coefficients for a jib and main as presented in de ridder et al 2004 and the sail area was retrieved from gerritsma and keuning 1990 the moment arms for the sails were estimated based on the dimensions of the sails and the principal dimensions of the hull the wave loads included incident and radiation waves the former froude krylov forces and moments were calculated by numerical integration of the wave unit potential e g newman and grue 2018 on the same panels that were identified as submerged on the module of the hydrostatic loads the radiation loads were based on the frequency dependent 2 d sectional added mass and damping terms in sway heave roll and sway into roll modes these were retrieved by implementing the method of frank 1967 and the corrections of bedel and lee 1971 consequently the radiation terms for the hull were obtained using the method of salvensen et al 1970 i e by involving integration of kernels equipped with sectional added mass and damping terms while fluid memory effects have been treated using the convolution integrals of cummins 1962 and the formulation of armesto et al 2015 concluding our earlier model is now upgraded through transient hydrodynamic flow solvers and simulations will be performed for evaluating the differences between the two models 4 2 tack maneuver in waves comparison of obtained heading angles sailing yachts cannot move directly against the wind as the produced thrust is diminished analogously to the reducing wind inflow angle thus in order to reach a destination that is towards the general direction of the incoming wind a yacht has to perform certain zigzag type maneuvers known as tacking or beating maneuvers each leg of which includes a turn of the bow against the wind initially fig 7 the sysser 26 is ordered to perform tacking maneuvers while sailing upwind between the ordered headings of 120 o degrees with intermediate values of 140 o 160 o and sustaining a wind characterized by a speed of 15 knots and an angle of 180 o head wind additionally it encounters head waves μ 180 o of length equal to λ wave 1 75 l wl and steepness h steep 1 225 the first simulation is performed using the steady flow hydrodynamic lift coefficients as calculated in angelou and spyrou 2017 and the second by employing the presented transient flow solver the autopilot a simple pd controller not tuned in terms of optimized autopilot performance was set for both simulations with proportional and differential gains equal to 1 0 and to 0 75 respectively the transient solver has provided some difference in the predicted response compared to the steady model however as we realized for lower wind speeds and increased wave steepness the yacht can no longer perform the desired maneuver as it suffers from complete thrust loss in detail fig 8 we perform the previous maneuver for a longer time range and a true wind speed of 12 5 knots at the left column of fig 8 are shown from top to bottom the time records of the surge u yaw r and roll p velocities and also the track of the origin of the yacht at the right column appear the respective records for sway velocity v the heading ψ the roll angle φ and the rudder angle δ there is an evident high frequency trend in the yacht response this was expected due to the small draft and depth of the sysser 26 hull her light weight her very high gm of 2 39 m and also the considered head wave excitation additionally the effect of the pd controller with no time lag is obvious and the implementation of a more sophisticated autopilot will be necessary in the future while during the initial stage of each leg of the maneuver the drift angle has a considerable value it however reduces significantly when the yacht is in an almost periodic state this is strongly related to the fact that the hull is theoretical and it was chosen because it provided capability for validation tests considering its steady state characteristics additionally the acting points for the sail forces defining the moments could only been assumed for the defined wave steepness h steep 1 275 the yacht is experiencing considerable high frequency oscillations and the surge speed drops significantly in order to investigate this further we carried out extensive simulations of tacking maneuvers involving 3 varying parameters a considering the ordered heading the extreme leg of each maneuver is in the range between 120 o and 140 o 40 o to 60 o the wind with an increment of 1 o between successive simulations b the direction of the true wind is fixed at 180 o pure head wind but the wind speed is in the range of 10 to 20 knots successively varied with an increment of 1 25 knots and c the wave steepness is set in the range of 0 001 to 0 04 with increments of 0 000175 the wave length ratio was fixed at λ wave l wl 1 75 by employing the surge velocity as the monitoring variable and by setting a limit of 0 3 m s as the defining thrust loss value we simulate every combination of the aforementioned parameters and we seek the critical minimum wave steepness beyond of which the yacht practically loses thrust for tighter headings towards the wind i e smaller apparent wind angles and higher wind velocities the yacht is capable of maintaining a sufficient speed even for increased wave steepness fig 9 however such capabilty is diminished as the apparent wind angle is increased 4 3 course keeping investigation in head waves fixed rudder the course keeping capability of the yacht is additionally evaluated by performing another group of simulations where the yacht is set on some initial heading between 120 o and 140 o using a 1 o step while the rudder remains inactive and is locked at 0 o the environmental parameters regarding wind speed wave length and steepness as also their incremental variations are retained as in section 4 2 while the yacht is able to maintain a course that oscillates around the initial heading when it encounters waves of low steepness by gradually increasing the steepness there is a value where the yacht suffers a widening of the heading angle an example of the onset of this behavior appears in fig 10 for vtw 10 knots λ wave l wl 1 75 and initial heading of 135 o in a similar fashion to section 4 2 we define the occurrence of such widening of the heading as failure and identify as critical the corresponding value of wave steepness in order to create the instability chart of fig 11 likewise to the thrust loss behavior the yacht is capable of sustaining the increased wave steepness for small apparent wind angles but it seems to lose this capability as the latter increase and for lower wind speeds however higher wind speeds generate a stabilizing behavior 5 conclusions a numerical model of sailing yacht maneuvering in waves has been updated in order to include the transient hydrodynamic lifting forces developing on sailings yachts moving in waves the model consists of potential flow solutions i e the formulation of the lifting surface theory lst enriched with a linearized kutta condition for transient flows and the implicit linear effects of thickness of the yacht appendages while the wave excitation is implemented through the associated potential for the case of harmonic waves the credibility of the model for calm water cases has been established by performing a series of validations using the hull of the sysser 26 yacht of the dsyhs as a case study additionally the amplitude of the side force oscillation when operating in waves has been calculated the current model enables the evaluation of a sailing yacht s course keeping capability in terms of the combinations of environmental parameters that lead to maneuvering failures in detail by investigating two types of maneuvering simulations i e 1 tacking maneuvers and 2 course keeping with fixed rudder angle and for several ordered heading angles a vast computational set of simulations was performed where the wave length and steepness and wind velocity varied incrementally and their limiting values corresponding to the appearance of course instabilities were located these instabilities were defined as thrust loss and as failure to keep the ordered heading angle for high wind speeds the stabilizing effects of the lifting surfaces increase significantly and this incapacity is reduced further improvement of the model is intended in the near future by implementing a transient solver for the sail forces as well appendix a unsteady lifting surface verification the credibility of the transient solver is evaluated by performing comparisons against published computational results the test involves zero thickness rectangle wings of various aspect ratios that are subjected suddenly to wind flow katz and plotkin 2001 fig a 1 the wind vector is characterized by a magnitude of 1 m s and an angle of attack equal to 5 o while the time step is set on 1 16 s the responses are different during the first seconds and converge to the same values as the simulation progresses it should be noted that the results of katz and plotkin are obtained by a formulation that does not include the unsteady kutta boundary condition but retain the simplistic steady case version of the latter fig a 1 sudden start of zero thickness square flat wing of various aspect ratios points katz and plotkin 2001 lines current implementation fig a 1 appendix b verification of the correct modeling of thickness effects on steady flight the proper implementation of kinnas 1992 equations in this study is confirmed by evaluating the spanwise circulation on a 45 o backwards swept wing of span to chord ratio equal to 5 9 that carries the thickness distribution of a modified naca 66 airfoil data retrieved from brockett 1966 and by discretizing it fig b1 using a full cosine paneling scheme 20 20 per half wing the pink panels represent the body lifting surface while the blue panels represent the frozen wake i e the wake considered as a fixed geometry that starts from the trailing edge of the body and extends very far abaft the spanwise circulation on the half wing as calculated by the model of this study is compared to the respective results contained in kinnas 1992 both for zero thickness and for the linear thickness effects with very good agreement fig b2 note that regarding the modified naca 66 airfoil we used linear interpolation instead of spline interpolation for γ on the wing moreover kinnas introduced the thickness distribution on its whole up to the 70 of the span of each half wing while further towards the tips he applied a reduction of parabolic type on the thickness distribution however the authors were uncertain on the exact function that kinnas 1992 used so in their verification process and for the same spanwise range the applied function was x y 2 this created a knuckle on the point that the thickness transition initiates fig b3 it is possible that kinnas 1992 used a smoother thickness transition scheme no matter this uncertainty the comparison of the results is satisfying fig b 1 wing panelization left body only right body and frozen wake fig b 1 fig b 2 spanwise vorticity on half wing fig b 2 fig b 3 thickness distribution on half wing in front view fig b 3 appendix c simulation of pitching airfoil in the final scenario a naca 0012 airfoil is considered pitching inside a numerical wind tunnel the axis of rotation is located at the quarter chord and the imposed rotation is a 5 o 5 o sin 0 2 t as in the experiments conducted by mccroskey et al 1982 and presented in mcalister et al 1982 the small range of pitching angles is associated with negligible flow separation effects hence this scenario appears suitable for applying the presented mathematical model the span and chord of the airfoil are 2 3 m and 0 61 m respectively and the influence of the walls is included by incorporating the mirror body technique using two additional bodies with a transverse offset of 1 0 m from the airfoil wake s length is set to 5 chords and the time step is 1 8 s the initially stationary airfoil is suddenly set in motion and at the same time the inflow is applied fig c 1 arrow indicates open leg of curve after a transient period where the airfoil rotates towards the maximum pitch angle the response of the calculated lift coefficient enters a steady cycle in general very good agreement is found with the data derived from the experiment fig c 1 numerical and experimental lift coefficients of a pitching naca 0012 airfoil fig c 1 appendix d hydrodynamic data of the sysser 26 hull this appendix summarizes essential data concerning the modeling of the sysser 26 hull the geometry of the hull is shown in figs d1 and d2 the calculated curve of the total viscous and wavemaking resistance of the sysser 26 hull in the upright condition is shown in fig d3 satisfactory agreement is revealed compared to the respective dsyhs curve gerritsma and keuning 1992 the effect of heel angle can be assessed from fig d4 fig d5 highlights three sections of representative shape that had their sectional sway added mass calculated these added masses are shown in fig d6 zero draft corresponds to canoe s design draft while positive and negative draft values denote submergence and emergence of the hull respectively fig d7 presents the sectional sway added mass in the limit of zero frequency μ y y for all sections of the hull the instant values of the added mass of each section corresponding to the instant draft of the section equip the kernels in the integrals of yuanxie 1986 for the calculation of the hydrodynamic derivatives fig d8 contains the upwind sailing driving coefficients from de ridder et al 2004 and they are expressed with respect to the apparent wind angle the figure is accordance with the wind angle convention of de ridder et al where 0 o marks heading towards the wind the sail area that was retrieved from gerritsma and keuning 1990 was equal to 35 1 sq m fig d9 shows the frequency dependent sectional added mass and damping terms for a representative midship section and for the modes of sway a22 b22 heave a33 b33 sway into roll a24 b24 and roll a44 b44 as they are found with the method of frank 1967 and after applying the correction of bedel and lee 1971 fig d10 shows the same frequency dependent terms but in this case for the entire hull as obtained by the formulation of salvesen et al 1970 appropriate memory effects have been implemented for all modes by employing impulse response functions as in armesto et al 2015 where cummins terms were decomposed into a definite and an indefinite integral e g fig d11 fig d 1 representation of sysser 26 hull using flat triangular panels fig d 1 fig d 2 representation of sysser 26 hull using transverse sections fig d 2 fig d 3 upright total resistance of sysser 26 fig d 3 fig d 4 total resistance coefficient of sysser 26 with respect to froude number and heel fig d 4 figure d 5 sample sections used for calculation of sectional sway added mass figure d 5 fig d 6 sectional sway added mass for sample sections appearing in fig d5 fig d 6 fig d 7 sectional sway added mass in the limit of zero frequency for all transverse sections of sysser 26 fig d 7 fig d 8 driving coefficients for sails reproduced by values from de ridder et al 2004 the wind angle convention of the source is retained i e where 0 o marks heading directly towards the wind fig d 8 fig d 9 frequency dependent sectional added mass top left sway top right heave bottom left sway into roll bottom right roll fig d 9 fig d 10 frequency dependent hull added masses top left sway top right heave bottom left sway into roll bottom right roll fig d 10 fig d 11 heave kernel function for fluid memory effects fig d 11 table d 1 additional characteristics of sysser 26 table d 1 natural period t0 s heave 2 37 roll 2 33 pitch 2 25 moments of inertia kg m 2 i x 8100 i y 15000 i z 15000 assumed position of x c g y c g z c g m 0 0 0 assumed position of x c s y c s z c s m 2 5 1 0 sb 1 0 ps 6 0 
23007,the calculation of hydrodynamic lifting forces sustained by a sailing yacht s hull performing maneuvers in regular incident waves is reported the mathematical model involves the application of the lifting surface theory for transient flows implemented through the numerical scheme of the vortex lattice method and corrected for linear thickness effects of the simulated body geometry the mathematical influence of the waves appears through the derivation of the wave potential and it is employed in a kinematic sense via the introduction of an additional inflow velocity component on the lifting surface validation with data derived from experiments in calm water showed very good agreement additionally the variation of the side force coefficient while sailing in waves has been quantified in terms of the amplitude of oscillation due to the wave orbital velocities the formulation is intended to upgrade the respective computational component in a mathematical model previously developed by the authors for the maneuvering motions of sailing yachts parametric studies of maneuvering and course keeping demonstrate a sensitivity of the yacht to wave steepness and heading angles with a deficit in sustaining capacity appearing for lower wind speed keywords sailing yachts hydrodynamic lift yacht maneuvering in waves abbreviations nomenclature dof degrees of freedom crd chordwise direction dsyhs delft systematic yacht hull series lst lifting surface theory spn spanwise direction vlm vortex lattice method vpp velocity prediction program a i j matrix of influence coefficients a m ordinates transformation matrix b max maximum breadth m b wl breadth of waterline m c m mollifier constant c d drag force coefficient c l lift force coefficient c p prismatic coefficient c s side force coefficient c x sail driving coefficient on surge mode c y sail driving coefficient on sway mode c sw amplitude of oscillating side force coefficient c t total resistance coefficient d s differential surface m2 d total drag force n e s horizontal dimension of main sail m f total force or moment n or nm f hs hydrostatic excitation force or moment n or nm f mhr maneuvering hydrodynamics excitation force or moment n or nm f w waves excitation force or moment n or nm f s sails excitation force or moment n or nm g gravity acceleration m s2 h critical critical wave steepness h steep wave steepness i evaluated panel i x roll moment of inertia kg m2 i y pitch moment of inertia kg m2 i z yaw moment of inertia kg m2 i s vertical dimension of jib sail m j inducing panel due to vortex singularity j s horizontal dimension of jib sail m k wave number rad m k total moment in roll mode nm k i j velocity coefficient of panel j to panel i k p proportional gain k d differential gain s l vortex segment length l lift force direction vector normal to inflow velocity l total lift force n l per l cb longitudinal center of buoyancy m l per perimeter of vortex ring m l wl length of waterline m m yacht mass kg m total moment in pitch mode nm m l velocity mollifier n total moment in yaw mode nm n c number of panels of mean camber surface n i normal vector of panel i n k number of panels of first wake strip n w number of panels on wake surface p evaluation reference point p s vertical dimension of main sail m p roll velocity degrees s p l pressure on lower side of camber surface pa p m mollifier coefficient p u pressure on upper side of camber surface pa q pitch velocity degrees s r yaw velocity degrees s r m mollifier distance m r mollifier regularization core radius m r p distance vector to point p m r t upright viscous and wave making resistance kn s surface m2 s c mean camber surface m2 s k wake spanwise first strip s w wake surface m2 s wet wetted surface of hull including canoe body and appendages m2 t time s t drag force direction vector parallel to inflow velocity t deviation from design draft m t c canoe body draft m u surge velocity m s v sway velocity m s v c velocity due to body thickness effects m s c canoe body volume m3 v b body velocity m s v a effective velocity m s v free stream velocity m s φ perturbation velocity m φ w b wave induced velocity body fixed system m s v p vortex induced velocity at point p m s v w p velocity at wake point w p m s w heave velocity m s x body fixed system longitudinal ordinate x total force in surge mode n x b body fixed system longitudinal axis x cg longitudinal position of center of gravity m x cs longitudinal position of sails center of effort m y body fixed system transverse ordinate y cg transverse position of center of gravity m y cs transverse position of sails center of effort m y total force in sway mode n y b body fixed system transverse axis z body fixed system vertical ordinate z total force in heave mode n z b body fixed system vertical axis z cg vertical position of center of gravity m z cs vertical position of sails center of effort m w p wake point α angle of attack degrees γ surface vorticity 1 s γ vortex strength m2 s γ x chordwise surface vorticity 1 s γ z spanwise surface vorticity 1 s ε wave phase degrees ε csw side force comparison percentage difference ζ earth fixed system vertical ordinate ζ amp wave amplitude m η earth fixed system transverse ordinate θ pitch angle degrees λ wave wave length m μ wave heading angle degrees μ y y sectional sway added mass in the limit of zero frequency kg m ξ earth fixed system longitudinal ordinate ρ fluid density kg m3 τ thickness m φ heel angle degrees φ w wave potential ψ heading angle degrees ψ r desired heading angle degrees ω wave frequency hz 1 introduction to maintain a good level of rolling and course keeping capability a yacht needs to have its underwater components designed to counteract the aerodynamic excitations incurred by the large offsets of the sail forces centers of action these large aerodynamic roll and yaw moments are counteracted through suitably designed hull appendages keel and rudder and to a lesser extent canoe body in sailing yachts terminology the matter is often addressed in terms of the side force i e the projection on the horizontal plane of the hydrodynamic lift force developing on the yacht in the past this force has been successfully determined experimentally e g gerritsma and keuning 1990 and computationally e g keuning and verwerft 2009 however mostly for calm sea and in a steady state sense there has not yet been much attention on the actually transient nature of this force and whether this can affect the assessment of a sailing yacht s maneuvering performance moreover when a yacht operates in waves the lift force will vary as yachts are usually characterized by a shallow draft and consequently they have both their canoe body and their appendages operating in close proximity to the free surface they are subjected to orbital water velocity perturbations induced by the waves in the present paper is proposed a computational model for the calculation of the hydrodynamic lift forces arising due to transient flow considering also the effect of regular incident waves this model is incorporated into a broader mathematical model of yacht maneuvering motions in waves which was recently developed by the authors the maneuvering model is intended to offer capability for addressing phenomena of course instability that could be experienced during operation in waves angelou and spyrou 2017 its strength lies in the integration in a modular sense of several aerodynamic and hydrodynamic solutions that in their majority are able to account for the exact form of any investigated yacht hull except of course for any loss of detail due to geometrical approximations however in terms of the model s overall completeness a few components such as the one handling the hydrodynamic lift have been limited to steady state modeling a numerical method is proposed in the current paper which is intended to improve the hydrodynamic lift calculation of the maneuvering model it is based on the application of the well known lifting surface theory with a linearized kutta condition for transient flows modified to account for the thickness effects of the simulated bodies the modification of hydrodynamic lift due to the encounter of harmonic incident waves from any direction is also addressed it is attacked via enriching the neumann boundary condition with a term related to wave orbital velocities maneuvering models of sailing yachts have a long history gerritsma 1971 investigated the wave making effects on the maneuvering derivatives by comparing a lifting line numerical model of a yacht against planar motion mechanism experimental results in a follow up study was assessed the impact of the helmsman s performance on directional stability through bode diagrams gerritsma and moyes 1973 nomoto and tatano 1979 discussed the rudder effects on the yaw balance of a yacht by performing related experiments and by modifying the numerical model of gerritsma 1971 the forces on the appendages were provided by the lifting surface theory for steady flows while the hull was modeled using the slender body approximation letcher 1976 constructed a linearized model for the maneuvering motions of a yacht supplemented by a windvane steering mechanism he tackled the dependence of the dynamic behavior of the system on the values of maneuvering derivatives wind operating conditions and control parameters masuyama 1987 employed a surge sway roll yaw model to study the effects of a windvane mechanism on a yacht equipped with a lifting hydrofoil additionally he performed directional stability simulations under fixed rudder condition while having the wind speed and direction and the sails angle of trim as varying parameters he then identified that the necessary gains of a simple pd proportional differential controller for sufficient course keeping are extremely low the method was based on the derivation of maneuvering derivatives from forces retrieved from steady state simulations more recently battistin and ledri 2007 developed a model for the optimization of tacking maneuvers while verwerft and keuning 2008 incorporated the lift calculations from the extended keel method to a time domain maneuvering model for the creation of a dynamic velocity prediction program vpp in the next will be outlined first the method of lift calculation for steady flows and then will be introduced the proposed improvements accounting for transient flow and harmonic waves the computational framework will be evaluated through application to a well known test case the sysser 26 belonging to the delft systematic yacht hull series in the second part of the paper will be briefly outlined our yacht maneuvering model after incorporating the transient lift calculation this model will be used for assessing the capability of the sysser 26 in tack maneuvers and also in course keeping scenarios 2 numerical formulation 2 1 lifting surface theory lst for steady flows the lst is one of the oldest and yet very useful methods to address potential flow effects on a thin body in the absence of flow separation as well known the basis of its formulation can be traced back to lanchester 1907 and prandtl 1918 the method exploits the convenience that flow perturbations could be represented by continuous vortex sheets and that these sheets themselves may in turn be replaced by lines of concentrated vorticity the introduction of vorticity allows the modeling of flow discontinuities that appear due to adjoining materials of different density e g solid fluid interface or even of a kinematic disturbance inside a volume of homogeneous fluid e g trailing wake in terms of a body moving with a velocity v b inside a fluid domain characterized by a steady velocity v moving thus with respect to the fluid with v a eq 1 vorticity is created in the body fluid interface i e bound vorticity and is then shed to form the wake s from one or many separation lines i e shed vorticity 1 v a v v b the body fluid interface is ideally an equivalent to the real surface i e the zero thickness mean camber surface of the thin body it is noteworthy that the bound vorticity is not literally bounded on the body but it is continually created on it and is shed likewise into the wake however the term bounded is often used for referring to newly generated vorticity in any specific time step additionally it is important to mention something often overlooked in the literature i e that the formulation of lst neither ignores nor disregards the effects induced by the thickness of the body but it rather allows the contributions from camber and thickness to be mathematically decoupled from each other and be treated separately e g thwaites 1960 the lst is usually applied through the numerical scheme based of the vortex lattice method vlm i e the discretization of a surface into a series of rectangular panels on which the discretized vortex entities are placed the utilization of lst through the numerical scheme of vlm is widely published in the literature e g katz and plotkin 2001 in our previous work the lst had been employed by using the vlm for steady flows angelou and spyrou 2017 the mean camber surface s c was discretized to numerical rectangle panels on which horseshoe vortices of constant strength were distributed the inducing velocity of any horseshoe of vortex strength γ at any point p in the domain was dictated by the biot savart type integral overall the induced velocity of every horseshoe vortex j to every panel point i was represented by a matrix of influence coefficients and the no entrance boundary condition reduced to a system of linear equations a i j γ j v a i n i the unknown vortex strengths were obtained by the solution of this linear system the wake vortex lines initially dictated by the undisturbed flow frozen wake propagating aft towards the direction of the free stream were then rotated in order to become aligned with the local total velocity vector and provide so the roll up of the wake 2 2 modification of the model to treat transient flows in the updated model the surfaces of both the body s c and the wake s w are discretized using rectangular panels on which vortex rings are placed instead of horseshoe vortices the formulation is based mainly on katz and plotkin 2001 each ring characterized by a vortex strength γ and a perimeter l per induces at any point p in the domain a velocity expressed as 2 v p γ 1 4 π l p e r d l r p r p 3 γ k i j as in the previous model for steady flows the neumann boundary condition is enforced in order to create the linear matrix of coefficients and solve for the unknown vortex strengths however to ensure the satisfaction of the physical requirement of p u p l no pressure discontinuity at the body s trailing edge an additional spanwise strip of panels s k is employed and it is placed between the trailing edge panels and the first strip of the wake panels 3 j 1 n c k i j γ j j 1 n k k i j γ j j 1 n w k i j γ j v p the equation for the total vortex induced velocity at any point p eq 3 is now subjected to the application of the neumann boundary condition on each ring center in a time marching scheme the strengths of the wake s w vortex rings are initially zero and they are successively updated on the basis of the previous time steps to reflect this the respective term is moved to the right hand side additionally by including the effective inflow velocity the neumann boundary condition equation becomes 4 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a j 1 n w k i j γ j the influence of the free surface is treated using the mirror body technique e g katz and plotkin 2001 αlternatively free surface panels could have been used however as the number of these panels would be large the formulation would be less attractive for investigating course instability phenomena where usually a large number of simulations is required and for this reason at this stage it was avoided lastly and considering the aforementioned trailing edge pressure equality necessity the linear system is supplemented by a kutta type condition for s k politis 2016 discusses the usefulness of the linearization of the unsteady pressure kutta equation either as a sufficient approximation in order to satisfy the trailing edge pressure equality during quasi steady flows or as a first step for solving the full non linear equation then the pressure type kutta equation would become 5 p u p l ρ n φ v a γ ϑ γ ϑ t and since p u p l 6 n φ v a γ ϑ γ ϑ t solving the linear system of equations 4 and 6 provides for the unknown vortex strengths the vortex rings that lay on the strip s k are allowed to shed in order to form the wake and in fact their values as they occurred from the solution of the linear system of equations 4 and 6 at the n time step are assigned to the rings of the first spanwise wake strip of s w at time step n 1 concurrently the vortex values of the first spanwise strip of s w at time step n are assigned to the rings of the second spanwise strip at n 1 and so forth additionally during every time step n the vortex rings located at s c s k and s w all participate in the calculation of the induced velocity on the wake rings corner points this velocity is vectorially added to the free stream velocity to provide the total velocity v w p eq 7 for the displacements of ring corner point w p by multiplication with the set time step 7 v w p φ w p v however the reforming of the wake strictly speaking in terms of curvature as the connectivity and the vortex strength of the rings remain unchanged entails the roll up procedure which can induce numerical instabilities regarding the inducing velocities among the vortex rings this is most probable when the latter are located in very close proximity of each other or in case where the collocation point of any ring is concentric with a vortex segment of any other ring causing a singular behavior of the kernel of equation 3 this may be treated by employing mollifying functions so as to provide the vortex segments with a finite core r and smooth the wake s shape these functions have been widely used in studies involving lagrangian representations of vorticity and are often introduced in the form of a simple algebraic form as in shankar and van dommelen 1996 or as a gaussian distribution equipped with a cut off parameter as in barba et al 2004 in the current study the mollifying function is treated as in politis 2016 and the integral k i j in equation 2 is supplemented by 8 m l c m p m r m r 1 exp c m r m r p m where p m 3 and c m 0 69314718 so the integral k i j now becomes 9 k i j 1 4 π l p e r m l c m p m r p r d l r p r p 3 where in this case r p denotes the distance from the core of each vortex segment to the velocity evaluation point lastly since there is no modeling of vortex diffusion the vortex strength of each shed wake panel remains constant throughout the calculations according with helmholtz s theorems additionally vortex dependence on time in this formulation is only implicit the wake of a lifting surface is characterized by a maximum length starting from the trailing edge and extending abaft the authors have observed that for bodies of large aspect ratio as yacht appendages calculations converge when the wake length is about 6 or 7 chord lengths the vorticity of each shed wake is traversed backwards until it reaches the limiting distance 2 3 modification for harmonic incident waves being wind assisted a sailing yacht hardly operates in an environment free of wind generated waves whatever the development of the sea state might be additionally the body itself produces wave disturbances as it translates rotates and oscillates due to its course propagation or as a reaction to the incoming waves all these perturbations induce orbital velocities to the water particles the yacht is immersed into it is common in terms of the linear wave theory to decompose the aforementioned waves into incident radiated and diffracted components represented in turn by respective potentials for the time being for the calculation of hydrodynamic lift only the incident wave potential is considered inclusion of the radiation and diffraction potentials in the case of a yacht with forward speed is expected to have an impact especially on rudder response as the wave field is propagating abaft however employment of these potentials would require the solution of the full body in waves problem which is currently out of the scope of this work in mathematical terms the waves are involved here by introducing the influence of a single harmonic enabling so the incident wave potential in any point in space time with respect to an earth fixed system fig 1 to be expressed as 10 φ w ξ η ζ t g ω ζ amp exp k ζ cos k ξ cos μ k η sin μ ω t ε while φ w provides the wave orbital velocities as 11 ϑ φ w ϑ ξ ω ζ amp exp k ζ sin k ξ cos μ k η sin μ ω t ε cos μ 12 ϑ φ w ϑ η ω ζ amp exp k ζ sin k ξ cos μ k η sin μ ω t ε sin μ 13 ϑ φ w ϑ ζ ω ζ amp exp k ζ cos k ξ cos μ k η sin μ ω t ε and their expression in the body fixed system is 14 φ w b ϑ φ w ϑ ξ b ϑ φ w ϑ η b ϑ φ w ϑ ζ b a m ϑ φ w ϑ ξ ϑ φ w ϑ η ϑ φ w ϑ ζ where 15 a m cos θ cos ψ cos θ sin ψ sin θ cos ψ sin θ sin φ cos φ s i n ψ cos φ cos ψ sin θ sin φ sin ψ cos θ sin φ cos ψ sin θ cos φ sin φ s i n ψ cos φ sinθ sin ψ sin φ cos ψ cos θ cos φ the influence of the wave induced velocity perturbations can now be accounted for by enriching the neumann boundary condition eq 4 with an additional term e g φ w b n as 16 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a φ w b j 1 n w k i j γ j 2 4 correction for linear thickness effects regarding the thickness distribution that characterizes a thin body and the aforementioned implementation of the associated effects in the vlm kinnas 1992 offered a formulation that introduces the thickness influence in terms of a distribution of additional vorticity by modifying the neumann boundary condition for bodies with zero camber the right hand side of equation 16 is enriched with an additional term v c that depends on the vorticity obtained by the zero thickness formulation equation 18 17 n i j 1 n c k i j γ j j 1 n k k i j γ j n i v a φ w b j 1 n w k i j γ j v c where 18 v c s γ n 4 1 4 ϑ γ z τ ϑ x ϑ γ x τ ϑ z this computational procedure is adopted and the vorticity that is predicted from the solution of the zero thickness formulation described in sections 2 2 2 3 is interpolated spanwise and chordwise across the lifting surface in order to obtain γ x γ z and then v c subsequently the linear system is solved again using the modified boundary condition finally the force on a differential area equation 19 is analyzed to lift and drag components by using the respective inflow angle 19 d f ρ d s φ v a γ n ϑ γ ϑ t concluding the lift and drag coefficients are obtained from equations 20 in terms of the vortex lattice a series of verifications and validations on the formulation presented in section 2 are contained in appendices a to c 20a c l l 0 5 ρ v a 2 s where l i s p n j c r d l d f j i 20b c d d 0 5 ρ v a 2 s where d i s p n j c r d t d f j i 3 case study sysser 26 of dsyhs 3 1 side force calculations in calm water the method is applied on a sailing yacht hull the sysser 26 which belongs to the delft systematic yacht hull series gerritsma and keuning 1992 and has been tested in upright and in heeled conditions for the evaluation of the lift force that is developed from the system of hull keel rudder the geometry tested earlier in the towing tank of delft is that of a scaled model with l wl 2 0 m and the form parameters of the canoe body of the hull and the dimensions of the appendages are given in table 1 gerritsma and keuning 1992 for validation of the responses in calm water the yacht is modeled numerically in the same scale i e l wl 2 0 m and as a combination of three lifting surfaces i e a keel a rudder and a low aspect ratio surface that resembles the canoe body the three lifting surfaces are in very close proximity to each other but do not share common boundaries the panels on each lifting surface are created using a cosine spacing scheme on both chordwise and spanwise directions fig 2 crude paneling for illustrative clarity while the wall influence of the sea free surface is involved using the mirror body approximation the number of the panels used in the simulations were 10 21 chordwise x spanwise for the keel and the rudder whereas for the hull they were 21 10 the yacht appendages have had their thickness contribution on the developing lifting forces evaluated using the formulation of kinnas 1992 however this was not the case for the canoe body whilst the maximum breadth of the latter satisfies the maximum thickness limit suggested in kinnas 1992 its actual shape is discouraging in waterlines context a typical yacht waterline in the vicinity of the free surface bears strong resemblance with a foil subjected to reverse flow i e with a thin leading edge and a blunt trailing edge moving deeper towards the bottom of the hull a waterline is often widened to an ellipse both of these kinds of shapes are prone to the occurrence of flow separation from both edges even at low inflow angles stall of an airfoil in reverse flow will appear at lower inflow angles than what would have been in the case of forward flow but still in larger angles of attack i e on or beyond the upper limit of operational drift angles of sailing yachts in fact and for reynolds number of order 10 6 stall would appear at around 14 o for a 24 thick symmetrical ellipse and 10 o for a naca 0024 lind 2015 however before stalling flow separation would have started and the slope of the lift curve is decreased compared to forward flow the thickness formulation of kinnas assumes attached flow and provides for a growth in circulation around the lifting surface including the thickness effects for the canoe body would then increase the obtained lift instead of decreasing it however the canoe body is modeled as a zero thickness wing of very low aspect ratio and it has comparatively very low lift loading omitting the aforementioned decrease in the lift slope and for the small range of operating drift angles is not expected to induce major differences in the obtained responses concluding the canoe body was modeled as a lifting surface without the correction for the thickness effects neither separation effects have been implemented additionally as the wake of the hull is propagating aft it pierces the vortex lattice panels of the rudder causing numerical instabilities in the computations in order to overcome this hull s wake is forced to sustain a trailing angle of at least 1 o until it is clear off the rudder panels subjecting the system in various angles of heel and inflow angles produces the side force coefficient c s i e the lift coefficient projected in the horizontal earth reference plane c s c l cos φ the drag force contribution has been neglected as the calculated values are of insignificant magnitude in general good agreement is found fig 3 with the experimental values of gerritsma and keuning 1992 note that the wetted part of a heeled hull will act as an asymmetric foil but since any thickness effects have been omitted this is not captured by the current implementation 3 2 side force in harmonic waves an insight on the effect of the waves onto the developing hydrodynamic lifting forces of a sailing yacht can be obtained by subjecting the lifting surfaces of the examined yacht sysser 26 to the orbital velocities of harmonic waves we should note that in all simulations from now on the yacht has been modeled in full scale l wl 10 0 m while the panel density for the lifting surfaces remains as in the previous section the simulations involve waves with length λ wave 2 0 l wl and steepness h steep 1 150 in general long waves relatively to the yacht will be used as these are believed to incur course stability problems the obtained values of the side force coefficient exhibit oscillatory behavior around the respective converged calm water value in fig 4 is plotted the side force coefficient for head or following waves in comparison to the one for calm sea the heel angle was set at 10 o and the inflow angle of attack leeway or drift angle at 6 o the difference between the wavy and calm sea scenarios is up to 20 of the converged value the frequency of the variation of the side force coefficient is the frequency of encounter of the yacht with the waves another view of waves influence is obtained by performing a computational sweep for several scenarios where the wave direction μ ranges in the earth fixed system from purely following 0 o to head waves 180 o the angle of attack α from 0 o to 10 o and the heel angle φ from 0 o to 25 o the calculations are performed using incremental angle changes of 10 o 0 5 o and 5 o for heading angle of attack α and heel respectively after each simulation reaches a periodic state the amplitude of the oscillating side force coefficient c sw μ α φ can be identified and all amplitudes are presented in fig 5 it is noteworthy that for beam waves i e μ angle in the range of 90 o the orbital velocities can become significant enough so that the side force coefficient c s might even be led to a change of sign compared to the respective calm water case however in reality separation effects would have appeared and the amplitude of oscillation would have been smaller notice also the slope of the area that the high amplitude values appear i e with a slight offset before pure beam waves this is attributed to the prescribed angle of attack drift angle α and in fact maximum amplitudes are obtained when the relative angle of incoming waves on the yacht becomes 90 o additionally the reverse analogy of the occurrence of larger c sw for smaller heel angles is coherent with the physical reality in the upright position the yacht spans a larger vertical area in the water and it is subjected to larger deviations of the orbital velocities whereas when the yacht adopts a heel angle its geometry is contained in a smaller vertical extent and consequently the orbital velocities vary less lastly the vertical position of the yacht was considered fixed and unaffected by the waves in order to evaluate this a parametric study is carried out for the ratio of wave steepness to canoe body draft h steep t c and the result is compared with the case where the yacht is allowed to heave and pitch adjusting to the wave contour the yacht is considered maintaining a heel angle of φ 5 o and it encounters bow quartering waves with μ 135 o the percentage ε csw of the difference between the two cases is shown in fig 6 and it appears negligible 21 ε csw c sw cont c sw fixed c sw fixed 100 it should be noted that in the proposed formulation and considering the inflow velocity all lifting surface panels up to the design waterline are continually considered immersed in the water however by checking at each time step the panel and free surface relative positions only those panels that are actually submerged are subjected to the wave orbital velocity it is noted however that literature exists in bem e g young and kinnas 2003 targeting surface piercing propellers where are introduced additional kinematic and dynamic boundary conditions for the ventilated panels however considering the already high complexity of the presented model such matters are left for a possible investigation in the future 4 impact of transient hydrodynamic forces on maneuvering 4 1 upgrading the existing maneuvering model our maneuvering model is a 6 dof mathematical model incorporating hydrodynamic and aerodynamic excitations in modular form the general form of the equations is given below surge 22 m u q w r v x cg q 2 r 2 z cg p r q x m g sin θ sway 23 m v r u p w z cg q r p x cg q p r y m g sin φ cos θ heave 24 m w p v q u z cg p 2 q 2 x cg p r q z m g cos φ cos θ roll 25 i x p m z cg v r u p w m x cg z cg q p r k m g sin φ cos θ z cg pitch 26 i y q i x i z r p m z cg u q w r v m x cg w p v q u m x cg z cg p 2 r 2 m m g x cg cos φ cos θ yaw 27 i z r i y i x p q m x cg v r u p w m x cg z cg r q p n also 28 f f hs f mhr f w f s where f represents any force or moment component of the vector x y z k m n and the subscripts in equation 28 indicate contributions from hydrostatics hs maneuvering hull reaction and resistance mhr wave w and sails s respectively in accordance with the excitation being of hydrodynamic or aerodynamic origin the equations of motion are additionally supplemented by a simple pd controller 29 δ ψ r k p ψ ψ r k d r and the following kinematic relations between the body fixed and earth coordinate systems that are presented here in terms of completeness the velocities in the earth fixed system can be obtained by 30 ξ η ζ a m 1 u v w where a m was defined in equation 15 and 31 φ θ ψ 1 sin φ tan θ cos φ tan θ 0 cos φ sin φ 0 sin φ cos θ cos φ cos θ p q r while tracking of the yacht s origin in the earth fixed system is provided by numerical integration of the above the detailed form of our model without the new aspects was presented earlier in angelou and spyrou 2017 for readers convenience is outlined below the content of its modules also data relating to the hydrodynamic modeling of the sysser 26 hull as also the kinematic relations between body fixed and earth coordinate systems are collected in appendix d for the representation of hull s geometry flat triangular panels or transverse sections are used at every time step the actual wetted surface is calculated by accounting for the instantaneous position of the hull considering the incoming waves the heave and the angles of heel pitch and yaw the hydrostatic loads hs are calculated by integrating numerically the static pressure at the centers of the wetted panels of the hull the module for resistance and maneuvering hull reaction mhr contains the components regarding the forward resistance of the yacht the hydrodynamic derivatives the cross flow effects and also the maneuvering lift effects of the canoe body and the appendages the resistance of the yacht is decomposed to viscous induced and wave making parts where the induced terms are actually the components of the forces that this paper addresses and it accounts for the canoe body and the appendages the viscous terms are based on the method of van oossanen 1993 and the wave making resistance contributions are obtained by evaluating the khaskind s integral for the area of certain transverse sections in the hull as in pascual 2007 the hydrodynamic derivatives are based on an integration across the length of the hull of the 2 d sway added mass of certain transverse sections yuanxie 1986 including the canoe body and the appendages this was calculated by formulating a low order boundary element method and each section was evaluated for a range of drafts by accounting for the instantaneous draft of each section due to the waves variation of the hydrodynamic derivatives according to hull s position is allowed cross flow effects are implemented as in söding 1982 by accounting for a sway force and a yaw moment that are based on a cross flow drag coefficient retrieved from data concerning 2 d bodies of similar shapes hoerner 1965 additionally the roll damping is calculated using the method of schmitke 1978 considering the forces on the appendages incorporated through f mhr in the previous version of the model their calculation was limited to steady flow cases also lift s contribution did not account for the hydrodynamic interference of neighboring or adjacent bodies additionally the influence of wave orbital velocities was not included these issues have all been accounted through the presented method moreover the canoe body was approximated by employing the lift characteristics of a flat plate of very low aspect ratio whilst a crude assumption this was not necessarily a weak approach because ellipsoidal shapes like a canoe body experience flow separation effects that cannot be handled by the new formulation either however the latter was chosen as it offers the option to include in the computations the influence that the vorticity of the canoe body s lifting surface holds onto the respective vorticity of the appendages the geometric centers of the lifting surfaces in the presented study were considered as centers of effort in order to define moment arms additionally all related inflow velocities are transformed appropriately to the body fixed system and are used as input to the lifting surface solver the sails s driving coefficients were pre calculated by a fluid structure interaction scheme for steady flows upwind cases or retrieved from published values of driving coefficients downwind cases however for the former the structural solver was based on a theoretical model capable of sufficiently handling geometry displacements that were ideally significantly smaller than those encountered during the simulations additionally the absence of flow separation effects led to an over prediction of the propulsive power available by the sails that being so the sails in this study are modeled using the driving coefficients for a jib and main as presented in de ridder et al 2004 and the sail area was retrieved from gerritsma and keuning 1990 the moment arms for the sails were estimated based on the dimensions of the sails and the principal dimensions of the hull the wave loads included incident and radiation waves the former froude krylov forces and moments were calculated by numerical integration of the wave unit potential e g newman and grue 2018 on the same panels that were identified as submerged on the module of the hydrostatic loads the radiation loads were based on the frequency dependent 2 d sectional added mass and damping terms in sway heave roll and sway into roll modes these were retrieved by implementing the method of frank 1967 and the corrections of bedel and lee 1971 consequently the radiation terms for the hull were obtained using the method of salvensen et al 1970 i e by involving integration of kernels equipped with sectional added mass and damping terms while fluid memory effects have been treated using the convolution integrals of cummins 1962 and the formulation of armesto et al 2015 concluding our earlier model is now upgraded through transient hydrodynamic flow solvers and simulations will be performed for evaluating the differences between the two models 4 2 tack maneuver in waves comparison of obtained heading angles sailing yachts cannot move directly against the wind as the produced thrust is diminished analogously to the reducing wind inflow angle thus in order to reach a destination that is towards the general direction of the incoming wind a yacht has to perform certain zigzag type maneuvers known as tacking or beating maneuvers each leg of which includes a turn of the bow against the wind initially fig 7 the sysser 26 is ordered to perform tacking maneuvers while sailing upwind between the ordered headings of 120 o degrees with intermediate values of 140 o 160 o and sustaining a wind characterized by a speed of 15 knots and an angle of 180 o head wind additionally it encounters head waves μ 180 o of length equal to λ wave 1 75 l wl and steepness h steep 1 225 the first simulation is performed using the steady flow hydrodynamic lift coefficients as calculated in angelou and spyrou 2017 and the second by employing the presented transient flow solver the autopilot a simple pd controller not tuned in terms of optimized autopilot performance was set for both simulations with proportional and differential gains equal to 1 0 and to 0 75 respectively the transient solver has provided some difference in the predicted response compared to the steady model however as we realized for lower wind speeds and increased wave steepness the yacht can no longer perform the desired maneuver as it suffers from complete thrust loss in detail fig 8 we perform the previous maneuver for a longer time range and a true wind speed of 12 5 knots at the left column of fig 8 are shown from top to bottom the time records of the surge u yaw r and roll p velocities and also the track of the origin of the yacht at the right column appear the respective records for sway velocity v the heading ψ the roll angle φ and the rudder angle δ there is an evident high frequency trend in the yacht response this was expected due to the small draft and depth of the sysser 26 hull her light weight her very high gm of 2 39 m and also the considered head wave excitation additionally the effect of the pd controller with no time lag is obvious and the implementation of a more sophisticated autopilot will be necessary in the future while during the initial stage of each leg of the maneuver the drift angle has a considerable value it however reduces significantly when the yacht is in an almost periodic state this is strongly related to the fact that the hull is theoretical and it was chosen because it provided capability for validation tests considering its steady state characteristics additionally the acting points for the sail forces defining the moments could only been assumed for the defined wave steepness h steep 1 275 the yacht is experiencing considerable high frequency oscillations and the surge speed drops significantly in order to investigate this further we carried out extensive simulations of tacking maneuvers involving 3 varying parameters a considering the ordered heading the extreme leg of each maneuver is in the range between 120 o and 140 o 40 o to 60 o the wind with an increment of 1 o between successive simulations b the direction of the true wind is fixed at 180 o pure head wind but the wind speed is in the range of 10 to 20 knots successively varied with an increment of 1 25 knots and c the wave steepness is set in the range of 0 001 to 0 04 with increments of 0 000175 the wave length ratio was fixed at λ wave l wl 1 75 by employing the surge velocity as the monitoring variable and by setting a limit of 0 3 m s as the defining thrust loss value we simulate every combination of the aforementioned parameters and we seek the critical minimum wave steepness beyond of which the yacht practically loses thrust for tighter headings towards the wind i e smaller apparent wind angles and higher wind velocities the yacht is capable of maintaining a sufficient speed even for increased wave steepness fig 9 however such capabilty is diminished as the apparent wind angle is increased 4 3 course keeping investigation in head waves fixed rudder the course keeping capability of the yacht is additionally evaluated by performing another group of simulations where the yacht is set on some initial heading between 120 o and 140 o using a 1 o step while the rudder remains inactive and is locked at 0 o the environmental parameters regarding wind speed wave length and steepness as also their incremental variations are retained as in section 4 2 while the yacht is able to maintain a course that oscillates around the initial heading when it encounters waves of low steepness by gradually increasing the steepness there is a value where the yacht suffers a widening of the heading angle an example of the onset of this behavior appears in fig 10 for vtw 10 knots λ wave l wl 1 75 and initial heading of 135 o in a similar fashion to section 4 2 we define the occurrence of such widening of the heading as failure and identify as critical the corresponding value of wave steepness in order to create the instability chart of fig 11 likewise to the thrust loss behavior the yacht is capable of sustaining the increased wave steepness for small apparent wind angles but it seems to lose this capability as the latter increase and for lower wind speeds however higher wind speeds generate a stabilizing behavior 5 conclusions a numerical model of sailing yacht maneuvering in waves has been updated in order to include the transient hydrodynamic lifting forces developing on sailings yachts moving in waves the model consists of potential flow solutions i e the formulation of the lifting surface theory lst enriched with a linearized kutta condition for transient flows and the implicit linear effects of thickness of the yacht appendages while the wave excitation is implemented through the associated potential for the case of harmonic waves the credibility of the model for calm water cases has been established by performing a series of validations using the hull of the sysser 26 yacht of the dsyhs as a case study additionally the amplitude of the side force oscillation when operating in waves has been calculated the current model enables the evaluation of a sailing yacht s course keeping capability in terms of the combinations of environmental parameters that lead to maneuvering failures in detail by investigating two types of maneuvering simulations i e 1 tacking maneuvers and 2 course keeping with fixed rudder angle and for several ordered heading angles a vast computational set of simulations was performed where the wave length and steepness and wind velocity varied incrementally and their limiting values corresponding to the appearance of course instabilities were located these instabilities were defined as thrust loss and as failure to keep the ordered heading angle for high wind speeds the stabilizing effects of the lifting surfaces increase significantly and this incapacity is reduced further improvement of the model is intended in the near future by implementing a transient solver for the sail forces as well appendix a unsteady lifting surface verification the credibility of the transient solver is evaluated by performing comparisons against published computational results the test involves zero thickness rectangle wings of various aspect ratios that are subjected suddenly to wind flow katz and plotkin 2001 fig a 1 the wind vector is characterized by a magnitude of 1 m s and an angle of attack equal to 5 o while the time step is set on 1 16 s the responses are different during the first seconds and converge to the same values as the simulation progresses it should be noted that the results of katz and plotkin are obtained by a formulation that does not include the unsteady kutta boundary condition but retain the simplistic steady case version of the latter fig a 1 sudden start of zero thickness square flat wing of various aspect ratios points katz and plotkin 2001 lines current implementation fig a 1 appendix b verification of the correct modeling of thickness effects on steady flight the proper implementation of kinnas 1992 equations in this study is confirmed by evaluating the spanwise circulation on a 45 o backwards swept wing of span to chord ratio equal to 5 9 that carries the thickness distribution of a modified naca 66 airfoil data retrieved from brockett 1966 and by discretizing it fig b1 using a full cosine paneling scheme 20 20 per half wing the pink panels represent the body lifting surface while the blue panels represent the frozen wake i e the wake considered as a fixed geometry that starts from the trailing edge of the body and extends very far abaft the spanwise circulation on the half wing as calculated by the model of this study is compared to the respective results contained in kinnas 1992 both for zero thickness and for the linear thickness effects with very good agreement fig b2 note that regarding the modified naca 66 airfoil we used linear interpolation instead of spline interpolation for γ on the wing moreover kinnas introduced the thickness distribution on its whole up to the 70 of the span of each half wing while further towards the tips he applied a reduction of parabolic type on the thickness distribution however the authors were uncertain on the exact function that kinnas 1992 used so in their verification process and for the same spanwise range the applied function was x y 2 this created a knuckle on the point that the thickness transition initiates fig b3 it is possible that kinnas 1992 used a smoother thickness transition scheme no matter this uncertainty the comparison of the results is satisfying fig b 1 wing panelization left body only right body and frozen wake fig b 1 fig b 2 spanwise vorticity on half wing fig b 2 fig b 3 thickness distribution on half wing in front view fig b 3 appendix c simulation of pitching airfoil in the final scenario a naca 0012 airfoil is considered pitching inside a numerical wind tunnel the axis of rotation is located at the quarter chord and the imposed rotation is a 5 o 5 o sin 0 2 t as in the experiments conducted by mccroskey et al 1982 and presented in mcalister et al 1982 the small range of pitching angles is associated with negligible flow separation effects hence this scenario appears suitable for applying the presented mathematical model the span and chord of the airfoil are 2 3 m and 0 61 m respectively and the influence of the walls is included by incorporating the mirror body technique using two additional bodies with a transverse offset of 1 0 m from the airfoil wake s length is set to 5 chords and the time step is 1 8 s the initially stationary airfoil is suddenly set in motion and at the same time the inflow is applied fig c 1 arrow indicates open leg of curve after a transient period where the airfoil rotates towards the maximum pitch angle the response of the calculated lift coefficient enters a steady cycle in general very good agreement is found with the data derived from the experiment fig c 1 numerical and experimental lift coefficients of a pitching naca 0012 airfoil fig c 1 appendix d hydrodynamic data of the sysser 26 hull this appendix summarizes essential data concerning the modeling of the sysser 26 hull the geometry of the hull is shown in figs d1 and d2 the calculated curve of the total viscous and wavemaking resistance of the sysser 26 hull in the upright condition is shown in fig d3 satisfactory agreement is revealed compared to the respective dsyhs curve gerritsma and keuning 1992 the effect of heel angle can be assessed from fig d4 fig d5 highlights three sections of representative shape that had their sectional sway added mass calculated these added masses are shown in fig d6 zero draft corresponds to canoe s design draft while positive and negative draft values denote submergence and emergence of the hull respectively fig d7 presents the sectional sway added mass in the limit of zero frequency μ y y for all sections of the hull the instant values of the added mass of each section corresponding to the instant draft of the section equip the kernels in the integrals of yuanxie 1986 for the calculation of the hydrodynamic derivatives fig d8 contains the upwind sailing driving coefficients from de ridder et al 2004 and they are expressed with respect to the apparent wind angle the figure is accordance with the wind angle convention of de ridder et al where 0 o marks heading towards the wind the sail area that was retrieved from gerritsma and keuning 1990 was equal to 35 1 sq m fig d9 shows the frequency dependent sectional added mass and damping terms for a representative midship section and for the modes of sway a22 b22 heave a33 b33 sway into roll a24 b24 and roll a44 b44 as they are found with the method of frank 1967 and after applying the correction of bedel and lee 1971 fig d10 shows the same frequency dependent terms but in this case for the entire hull as obtained by the formulation of salvesen et al 1970 appropriate memory effects have been implemented for all modes by employing impulse response functions as in armesto et al 2015 where cummins terms were decomposed into a definite and an indefinite integral e g fig d11 fig d 1 representation of sysser 26 hull using flat triangular panels fig d 1 fig d 2 representation of sysser 26 hull using transverse sections fig d 2 fig d 3 upright total resistance of sysser 26 fig d 3 fig d 4 total resistance coefficient of sysser 26 with respect to froude number and heel fig d 4 figure d 5 sample sections used for calculation of sectional sway added mass figure d 5 fig d 6 sectional sway added mass for sample sections appearing in fig d5 fig d 6 fig d 7 sectional sway added mass in the limit of zero frequency for all transverse sections of sysser 26 fig d 7 fig d 8 driving coefficients for sails reproduced by values from de ridder et al 2004 the wind angle convention of the source is retained i e where 0 o marks heading directly towards the wind fig d 8 fig d 9 frequency dependent sectional added mass top left sway top right heave bottom left sway into roll bottom right roll fig d 9 fig d 10 frequency dependent hull added masses top left sway top right heave bottom left sway into roll bottom right roll fig d 10 fig d 11 heave kernel function for fluid memory effects fig d 11 table d 1 additional characteristics of sysser 26 table d 1 natural period t0 s heave 2 37 roll 2 33 pitch 2 25 moments of inertia kg m 2 i x 8100 i y 15000 i z 15000 assumed position of x c g y c g z c g m 0 0 0 assumed position of x c s y c s z c s m 2 5 1 0 sb 1 0 ps 6 0 
23008,in this work novel multiresolution random field models are integrated with coupled hydromechanical finite element simulations to model dynamic responses of heterogeneous seabed with embedded pipeline subjected to nonlinear wave induced loadings the heterogeneous properties of the seabed are characterized and modeled as spatially correlated random variables a conditional sequential simulation technique is implemented and multiresolution random field realizations of heterogeneous properties are generated the effects of spatially correlated seabed properties on the characteristic hydromechanical responses are analyzed in details through validated hydromechanical finite element simulations statistics and associated uncertainties of system response are obtained with recourse to monte carlo simulations the relations between the inherent heterogeneities and uncertainties in the system responses are derived findings of this study are shown to have important implications for probabilistic engineering designs keywords hydromechanical coupling random field models porous seabed spatial variability wave seabed pipeline interaction 1 introduction design of submarine infrastructure such as embedded pipelines require the understanding and the ability to predict the behavior of submarine infrastructure and the surrounding seabed subjected to wave induced loadings the influence of the wave loading on embedded pipelines is mainly characterized by two aspects first the dynamic wave loading induces oscillatory excess pore pressure within the porous seabed which directly results in oscillatory stresses and deformations within the embedded pipeline second the excess pore pressure built up during the propagation of dynamic waves may lead to transient liquefaction of the seabed soil tsui and helfrich 1983 ye 2012 which causes the loss of loading bearing capacity of the soil around the pipeline therefore when it comes for an engineer to design the pipeline it is of particular importance to predict the wave induced dynamic responses and quantities of interest such as the excess pore pressure the stress and deformation in the pipeline and the extent of liquefaction modeling the wave induced hydromechanical responses of the seabed pipeline system necessitates the integration of multiple models that account for the nonlinear wave induced loading the inherent heterogeneities of the seabed the interaction between fluid diffusion and solid deformation within the porous seabed and the stresses and deformations within the pipeline in simplified models the pipeline was treated as a rigid body or elastic solid while the surrounding seabed was assumed to be a homogeneous isotropic and elastic media cheng and liu 1986 magda 1997 jeng and cheng 2000 jeng et al 2001 zhao et al 2016a however natural seabed sediments are usually formed from a vertical consolidation process under overburden pressure coming from self weight and wave loading this process may result in significant cross anisotropy and depth dependency in seabed properties for example the permeability of seabed is found to decrease with depth as a result of decreasing porosity of the seabed due to the consolidation process seymour et al 1996 the seabed cross anisotropy can be described by assuming different material properties along the vertical and horizontal directions gatmiri 1992 jeng 1997 kitano and mase 1999 jeng and lin 1999 2000a wang et al 2000 zhou et al 2014 zhao et al 2016b some early work used the finite element method or developed analytical solutions to study the effects of cross anisotropy on the wave induced seabed response gatmiri 1992 jeng 1997 kitano and mase 1999 jeng and lin 2000a later the wave induced soil response around a buried pipeline was investigated in jeng and lin 1999 wang et al 2000 using two dimensional finite element models the wave seabed pipeline framework is then extended to a dynamic hydromechanical problem by zhou et al 2014 with the consideration of soil skeleton accelerations and zhao et al 2016b further elaborated this framework by incorporating an elasto plastic seabed model among these works on studying wave seabed pipeline behavior it is found that the effect of anisotropic soil behavior was more apparent near the bottom of the pipe than at the top of the pipe wang et al 2000 and liquefaction was more likely to occur in anisotropic soils than in isotropic soils especially in the vicinity of a pipeline zhao et al 2016b to consider the depth dependent seabed parameters one approach is to divide the seabed into a number of sub layers with finite thickness and assign uniform permeability porosity and shear modulus for each sub layer hsu et al 1995 zhou et al 2011 2013 ulker 2012 another approach is to describe the seabed parameters using continuous depth dependent functions jeng and seymour 1997 jeng and lin 2000b jeng 2001 gao et al 2003 for instance four different types of analytical function for depth dependent hydraulic conductivity were proposed in jeng and seymour 1997 the effects of depth dependent seabed parameters on the wave seabed pipeline behavior were analyzed through analytical and numerical models in recent works zhou et al 2011 2013 jeng and lin 2000b jeng 2001 gao et al 2003 in addition to the cross anisotropy and depth dependency characteristics of the seabed inherent heterogeneities also exist in the seabed due to its deposition processes goff et al 2004 2008 veloso et al 2016 the previously mentioned models for anisotropy or depth dependency may not necessarily capture the effects of seabed heterogeneities and the modeling results are only deterministic in nature though without consideration of any submarine structure the work of zhang et al 2016 is among the first efforts to consider the omnidirectional spatial variability of the seabed where the soil properties in the field were considered to consist of two parts a trend component and a residual term that exhibits spatial correlation random fields of seabed properties were generated and coupled with finite element models to simulate responses of the seabed in a recent work by peng et al 2017 the effects of cross correlation of the seabed soil properties on wave induced oscillatory seabed response were studied and it was found that multiple correlated random properties would lead to greater uncertainties in the excess pore pressure while the effects of spatial variability on seabed response have been studied previously its effects on the embedded pipeline and implications on probabilistic engineering design have not been addressed yet in this work a framework accounting for the inherent heterogeneities of a porous seabed and the coupled hydromechanical behavior is presented to model the wave induced dynamic responses of a heterogeneous seabed pipeline system details of the dynamic hydromechanical problem formulation are presented in section 2 a multiresolution random field model is developed in section 3 to characterize and generate spatially correlated heterogeneous and anisotropic seabed fields which will be coupled and implemented into a multiphysics finite element model section 4 in section 5 monte carlo simulations will be performed to investigate the impact of heterogeneous seabed on the hydromechanical responses of the system and the implications on probabilistic engineering design 1 1 formulation of the dynamic hydromechanical coupled problem the problem considered in this work is a dynamic hydromechanical problem where the wave propagates over a heterogeneous porous seabed with an embedded submarine pipeline fig 1 the problem is treated as a plane strain problem where the dimension of the pipeline in the y direction is much larger and its deformation along y direction is neglected the seabed is modeled as a poroelastic material while the embedded pipeline is modeled as an elastic solid 2 1 balance laws the balance laws of porous seabed consist of two sets of partial differential equations pdes i e the balance of mass equation and the balance of linear momentum equation in deriving the balance of mass equation both the compressibility of the pore fluid and the degree of saturation of the porous seabed are accounted for the final form of the balance of mass equation is written as 1 k p ϕ f ρ f g β p t ρ f k a ρ f g v 0 where k is the hydraulic conductivity tensor of the seabed p is the excess pore pressure ϕ s and ϕ f are the volume fractions of the solid skeleton and void including gas and fluid respectively ρ f is the intrinsic mass density of the fluid g is the gravitational acceleration a and v are the acceleration and velocity respectively the parameter β accounts for both the compressibility of the pore fluid and the degree of saturation of the porous seabed and is given as 2 β 1 k f 1 s r p f 0 where s r is the degree of saturation k f is the bulk modulus of the fluid and p f 0 is the static pore pressure the balance of linear momentum equation of the porous seabed is given as 3 σ p ρ b ρ a where σ is the effective stress of the porous seabed p is the excess pore pressure b is the body force ρ ϕ s ρ s ϕ f ρ f is the equivalent density of the porous seabed with ρ s and ρ f being the intrinsic mass density of the fluid and solid respectively for the embedded pipeline the balance of linear momentum equation is given as 4 σ ρ p b ρ p a where σ is the total stress of the pipeline and for single phase solid material σ σ with σ being the effective stress ρ p is the mass density of the pipeline perfect bonding is assumed between the pipeline and seabed 2 2 constitutive relations elastic constitutive relations are assumed for both the seabed solid skeleton and the pipeline based on the generalized hooke s law 5 σ c ε where for the plane strain problem considered the effective stress in voigt notation is given as σ σ x x σ z z σ x z t and the strain is given as ε ε x x ε z z ε x z t it should be emphasized that for the porous seabed σ σ p δ and for the solid pipeline σ σ c is the elastic modulus given as 6 c s p 2 g s p 1 2 ν s p 1 ν s p ν s p 0 ν s p 1 ν s p 0 0 0 1 2 ν s p where g is the shear modulus and ν is the poisson s ratio the subscript s corresponds to the seabed skeleton and p corresponds to the pipeline while elastic constitutive relations assumed for its simplicity and computational efficiency their limitations should also be noted the elastic models cannot capture permanent deformations of the marine soils or the pipeline more advanced elastoplasticity model would need to be implemented for this purpose which typically involves additional model parameters that need to be calibrated and is generally computational expensive 2 3 wave induced nonlinear loading on the seabed in general the wave characteristic will be changed due to the interaction between the wave and the seabed for deeper water however such interaction can be neglected in this work the change of wave characteristics is assumed to be negligible therefore the vertical effective stress σ z z and the shear stress σ z x induced by the wave on the seabed boundary can be neglected yamamoto and suzuki 1980 the wave induced loading is applied on the seabed boundary as a time varying pore pressure function p b t with t being time as follows 7 σ z z σ z x 0 p p b t at z 0 the cyclic variation of pore pressure is estimated by an analytic formulation of wave pressure on the seabed surface zhou et al 2013 generally stokes wave theory is of direct practical use for waves on intermediate and deep water according to the first order stokes wave the dynamic variation of wave pressure p b t is zhou et al 2013 8 p b t p 0 cos 2 π x l ω t 1 2 ρ f g cosh 1 2 π d l cos 2 π x l ω t where d is the water depth l and h are the wavelength and height respectively ω is the angular frequency of the wave and p 0 denotes the amplitude of the wave pressure at the seabed surface 2 4 transient liquefaction criteria dynamic loading of ocean wave could induce oscillatory excess pore pressure within the porous seabed which leads to oscillatory effective stress and liquefaction of the seabed when the marine soil liquefies it loses its load bearing capacity and behaves as a viscous liquid potentially causing damages to the embedded infrastructure therefore liquefaction of seabed under dynamic wave loading is an important aspect that will be analyzed in this work the transient liquefaction criterion is adopted as follows zen and yamazaki 1990a 1990b 9 γ s γ f z p b t p 0 where p b t is the dynamic wave pressure defined in eq 8 and p is the excess pore pressure in the seabed this criterion is simple in form and has a direct physical interpretation that the seabed will liquefy if the upward seepage force can overcome the effective self weight of the overburdened soil to quantify and compare the extent of liquefaction previous works have recourse to the maximum depth of liquefaction jeng and cheng 2000 zhou et al 2013 however the maximum depth of liquefaction gives only limited information regarding the extent of liquefaction moreover when heterogeneity of seabed is accounted for the liquefaction area boundary profile can be tortuous in this work a new parameter indicating the area ratio of liquefaction is proposed to quantify and compare the liquefaction extent the parameter is defined as the ratio of the area of liquefaction to the total area of the domain of influence which is taken as five times the diameter of the pipeline and is illustrated in fig 2 the choice of five times is based on a preliminary investigation of the excess pore pressure built up around the pipeline when the wave propagates and it was found that the domain of five times the diameter approximately covers the area of the most excess pore pressure built up especially in the vertical direction 3 multiresolution random field characterization of the heterogeneous seabed inherent heterogeneities i e those resulting from fluctuations in material properties such as hydraulic conductivity or shear modulus exist in natural geological materials including the marine soil in this section a multiresolution random field is presented to characterize and model the inherent heterogeneities in the porous seabed the random field model will then be coupled with multiphysics finite element model section 4 and monte carlo simulations to analyze the impact of inherent heterogeneities on the seabed pipeline system response 3 1 characterization of anisotropic spatial dependency seabed properties generally exhibit variation with space and such variation is spatially correlated or dependent which is typically attributed to the deposition process of the seabed in this study the spatial dependency is described using a form of covariance known as the semivariogram γ h which is equal to half the variance of the difference of two random variables separated by a vector distance h 10 γ h 1 2 var z x z x h where z x is a gaussian random variable at location x with x u w being the location vector the vector h accounts for both the separation distance and the orientation of two points in the random field in the actual implementation a simplified scalar measure h is typically defined 11 h h x θ x 2 h z θ z 2 where h x and h z are the scalar component of the vector h along the field s principal axes x and z respectively scalar quantities θ x and θ z specify how quickly spatial dependence decreases along those axes by skewing the ratio of θ x and θ z anisotropic random fields can be generated which is particularly useful for modeling heterogeneous seabed properties that typically exhibit anisotropy as will be shown in the example section in practice various analytical semivariogram models and their linear combinations are typically fitted to an empirical semivariogram that is calculated from field data examples of commonly used analytical semivariogram models include the nugget effect model the linear model the spherical model the exponential model and the gaussian model goovaerts 1997 the specific model form can be inferred from available field data or assumed based on expert knowledge for marine deposit studies and data on the spatial variability of its properties are relatively limited in valdez llamas et al 2003 the spatial variability of the cohesive soft soil thickness and the water content of a marine soil are found to be exponential in several other studies that consider the randomness of marine soils the exponential correlation structure is also used e g zhang et al 2016 peng et al 2017 lloret cabot et al 2014 while there lacks sufficient data or clear evidence pointing to a specific spatial structure an exponential model is assumed in this work to illustrate the proposed framework it should be noted that whenever there are sufficient field data the specific spatial correlation structure can always be inferred the expression of the adopted exponential model is 12 γ h 1 exp h 3 2 multiresolution random field and conditional simulation algorithm given the spatial correlation model and a specified or inferred probability distribution function for the random variable a conditional sequential simulation algorithm is implemented in this work to generate random field realizations of material properties this algorithm is particularly valuable for the multiresolution random field utilized in this study where a higher resolution field is desired around the area adjacent to the embedded pipeline see illustration in fig 3 with this algorithm one can simply add additional random field data points wherever and whenever is necessary during the simulation process conditional upon all previously simulated data and as the need arises an additional advantage of this algorithm is that it allows real data points to be incorporated and preserved in the generated random field e g chen et al 2015 liu et al 2017 denote z p as a vector of all known and previously simulated points in the random field and denote z n as the next point to be simulated the sequential simulation process can be illustrated by the joint distribution chen et al 2012 13 z n z p n μ σ n 2 σ n p σ p n σ p p where n μ σ denotes the vector of random variables following a joint normal distribution with the mean vector μ and the covariance matrix σ σ n 2 is the prior variance of the next simulated point σ n p σ p n and σ p p are the covariance matrices where the subscripts n and p represent next as in next point to be simulated and previous as in all previously simulated points respectively the covariance matrices are obtained by 14 cov z i z j ρ i j σ i σ j where ρ i j is the correlation between random variables z i and z j with standard deviations of σ i and σ j respectively the correlation ρ is related to the semivariogram defined in eq 10 through 15 ρ h 1 γ h where h is the scalar distance given in eq 11 using the joint distribution eq 13 the distribution of z n conditional upon all previously simulated data is given by a univariate normal distribution with the updated mean and variance as chen et al 2012 16 z n z p z n σ n p σ p p 1 z σ n 2 σ n p σ p p 1 σ p n where the lowercase z represents the vector of simulated values other terms have been defined after eq 13 the conditional simulation starts with a single realization of a standard normal variable then all subsequent realizations are conditional upon all previous simulations following eq 16 once simulated z n becomes a data point in the vector z p to be conditioned upon by all subsequent data locations this process is repeated by following a random path to each unknown location until all the values in the field have been simulated it should be noted that the spatial dependence and the conditional simulation algorithm introduced above are for variables having a gaussian distribution for non gaussian distributions the inference of spatial structure is recommended to be performed on transformed data using a normal score mapping goovaerts 1997 such normal score mapping is a common practice in many applications of geostatistics and has previously been shown to preserve the prescribed spatial structure for lognormally distributed variables in various applications chen et al 2012 baker et al 2011 wang et al 2017 wang and chen 2017 the above described random field models are implemented in matlab and will be coupled with the multiphysics finite element model described in section 4 to simulate dynamic responses of the heterogeneous seabed with an embedded pipeline fig 3 is a schematic illustration of the multiresolution random field where higher resolution random field is generated around the embedded pipeline 3 3 statistical and spatial characteristics of seabed properties in the context of the hydromechanical coupled problem formulated in section 2 seabed properties of interest include hydraulic conductivity porosity density elastic properties e g shear modulus young s modulus among them hydraulic conductivity porosity and shear modulus are often considered as the primary parameters influencing the hydromechanical responses of the seabed zhang et al 2016 jeng 2012 hydraulic conductivity and porosity can be considered dependent on each other e g through the kozeny carman relationship and the fact that hydraulic conductivity can be related to the intrinsic permeability of the porous media hence in this study only hydraulic conductivity and shear modulus will be treated as spatially correlated random variables impact of the heterogeneous hydraulic conductivity and shear modulus fields will be analyzed through multiphysics finite element simulations statistical and spatial characterizations of seabed properties are difficult to obtain due to very limited field data of marine soil table 1 summarizes some examples of seabed properties from previous research on marine soils in this work statistical and spatial characteristics of the random field variables in particular the coefficient of variation cov and the correlation length parameters θ x θ z are chosen based on prior researches and parametric studies will also be conducted to evaluate the influence of statistical and spatial parameters both the shear modulus and hydraulic conductivity are assumed to follow lognormal distributions in this work while there lacks clear evidence pointing to a specific probability distribution of seabed properties one condition that has to be satisfied is for the probability density function to have a non negative lower bound to this end the lognormal distribution is widely used to describe soil properties experimental data for shear modulus and hydraulic conductivity are usually found to follow a lognormal distribution e g phoon and kulhawy 1999b baecher and christian 2005 carsel and parrish 1988 the lognormal distribution was also used for seabed properties in a recent study zhang et al 2016 anisotropy of the random field will be realized by skewing the ratio of the scalar parameter θ x and θ z in eq 11 4 multiphysics finite element model in this section details of the multiphysics finite element implementation are presented the finite element model will be coupled with the multiresolution random field model described in section 3 to simulate the dynamic response of a heterogeneous seabed pipeline system 4 1 numerical implementation the comsol multiphysics software is used to implement the hydromechanical problem formulated in section 2 and to simulate dynamic responses of a heterogeneous seabed pipeline system one advantage of using comsol in this study is that through its livelink for matlab interface the comsol solver can be integrated with the random field code implemented in matlab this convenient interface between multiphysics finite element solver and random field code allows running many instances of monte carlo simulations needed to study the impact of heterogeneous seabed on the system responses the governing equations i e pdes are implemented in comsol through its general form pde mode substituting the constitutive laws eqs 5 and 6 for porous seabed and solid pipeline into their corresponding balance laws eqs 1 3 and 4 and using small strain displacement relations the implemented governing equations for the porous seabed are written as 17 k x 2 p 2 x k z 2 p 2 z ϕ f ρ f g β p t ρ f 2 2 t k x u x k z w z ρ f g t u x w z 18 p x ρ 2 u 2 t g s 2 u 2 x 2 u 2 z 1 1 2 ν s g s x u x w z ρ b x 19 p z ρ 2 w 2 t g s 2 w 2 x 2 w 2 z 1 1 2 ν s g s z u x w z ρ b z where u and w are the horizontal x and vertical z component of the displacement vector p is the excess pore pressure k x and k z are the x and z components of the hydraulic conductivity tensor g s is the shear modulus of the seabed ν s is the poisson s ratio ϕ f is the volume fraction of the void ρ f is the intrinsic mass density of the fluid ρ is the equivalent density of the porous seabed g is the gravitational acceleration β is given in eq 2 b x and b z are the x and z components of the body force similarly the governing equations for the pipeline can be derived and are written as 20 ρ p 2 u 2 t g p 2 u 2 x 2 u 2 z 1 1 2 ν p g p x u x w z ρ p b x 0 21 ρ p 2 w 2 t g p 2 w 2 x 2 w 2 z 1 1 2 ν p g p z u x w z ρ p b z 0 where g p is the shear modulus of the pipeline ν p is the poisson s ratio ρ p is the density of the pipeline in addition to governing equations the dynamic wave pressure equation eq 8 is also implemented in comsol as a user defined boundary condition once the governing equations and boundary conditions are implemented solutions u w and p will be obtained through the comsol multiphysics solver 4 2 model validation pipeline in a homogeneous seabed before coupling the implemented comsol multiphysics model with the multiresolution random field model the multiphysics model is first validated using experimental data reported in turcotte et al 1984 the experiments have a similar setup to the schematic diagram shown in fig 1 the seabed is simulated using a sediment bay with a pvc pipe inside it simulating the buried pipeline the seabed pipeline system is then placed in a large wave tank which can stimulate waves of specific characteristics most of the material properties of the seabed have been previously calibrated and reported in cheng and liu 1986 except water characteristics and mass density of seabed which are reported in zhou et al 2013 the properties of the pvc pipe from rajani et al 1996 are used in the validation model geometry wave seabed and pipeline characteristic are all summarized in table 2 numerical solutions of the normalized excess pore pressure around the pipeline are obtained using the multiphysics model and then compared against the data measured in physical experiments from turcotte et al 1984 the comparisons are plotted in fig 4 it can be seen that results from numerical simulations and physical experiments are in reasonable agreements the numerical model is able to correctly capture the response of the seabed pipeline system 4 3 model setup pipeline in a heterogeneous seabed in this section the multiphysics model is coupled with the multiresolution random field model to simulate the response of a pipeline embedded in a heterogeneous seabed the model domain fig 5 is 100 m wide and 30 m deep a pipeline 2 0 m in diameter and 0 2 m in thickness is horizontally centered in the seabed and buried 4 0 m below the seabed surface a wave with 6 0 m in height h and 70 93 m in length l is generated following eq 8 the seabed domain is set to be slightly wider than one full wavelength so that a full wave induced loading can be modeled the depth of the seabed 30 m is about five times the wave height where the wave induced effects on the seabed become negligible boundary conditions of the model problem are summarized in table 3 the input model parameters and material properties are summarized in table 4 those parameters are chosen based on prior knowledge from literature table 1 and the author s previous experience zhou et al 2013 2014 in jeng and cheng 1999 pipeline diameters ranging from 1 to 3 m and burial depths ranging from 1 5 to 4 m were investigated in the case study the geometry and burial depth are known to significantly influence the distribution of the pore pressure jeng and lin 1999 jeng and cheng 1999 the choice of pipeline geometry and burial depth will depend on specific applications the water depth and wave characteristic values are taken from a previous study zhou et al 2013 and correspond to the case of waves in shallow water for the hydraulic conductivity k and shear modulus g s of the porous seabed as discussed in section 3 they are treated as spatially correlated random variables and modeled through multiresolution random field models 4 4 mesh sensitivity analysis the implemented multiphysics finite element will be coupled with random field models to study responses and associated uncertainties of a heterogeneous seabed pipeline system using monte carlo simulations this requires a large number of simulations an extremely fine finite element though more accurate may be computationally too expensive for such purpose to this end a mesh sensitivity analysis is first carried out to obtain an optimal mesh to be used for the following monte carlo simulations to ensure sufficient resolution and accuracy of solutions around the embedded pipeline a relatively fine discretization is used by enforcing 80 nodes around the pipeline circumference the mesh sensitivity analysis is carried out by changing the maximum element size h e in the domain as h e increases the total number of elements in the domain decreases note that when the maximum element size h e is sufficiently large the total number of elements will not change as much due to the fact that an extremely fine resolution is enforced around the pipeline fig 6 shows four different finite element meshes and table 5 summarizes the total number of elements and runtime for each mesh the performance of different meshes is evaluated by extracting and comparing quantities of interest in particular the excess pore pressure in the seabed the von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of transient liquefaction fig 7 summarizes the mesh sensitivity study results based on the mesh sensitivity results and considering the trade off between runtime and accuracy the mesh with h e 5 is selected for the following monte carlo simulations and the results will be presented and discussed in section 5 4 5 convergence of monte carlo simulations to study the impact of material heterogeneities and associated uncertainties on the seabed pipeline system a sufficient number of monte carlo simulations is needed fig 8 shows the variations of mean and coefficient of variation cov of displacement at the top of the pipeline and the maximum von mises stress in the pipeline with the number of monte carlo simulations it can be observed that 1000 monte carlo simulations are sufficient for the given example problem and will be used in the numerical analysis and discussions 5 numerical results and discussions in this section numerical results of the coupled multiresolution random field and multiphysics finite element simulations are presented effects of heterogeneous seabed properties and wave induced loading on the dynamic responses of the system will be analyzed in details the hydraulic conductivity and shear modulus of the seabed are treated as spatially correlated but statistically independent random variables three parameters i e the coefficient of variance cov the horizontal and vertical correlation length parameters θ x θ z are the three main random field parameters controlling the heterogeneous attributes of the seabed parametric studies of these parameters will also be conducted to understand and quantify their influence on system responses other input parameters for the model have been summarized in table 4 5 1 effects of spatially correlated hydraulic conductivity fields for the heterogeneous spatially correlated hydraulic conductivity fields the three main random parameters are set at cov 2 5 θ x 20 m and θ z 1 m considering ranges summarized in table 1 the mean of the hydraulic conductivity field is 5 10 4 m s and a lognormal distribution is assumed 1000 monte carlo simulations are performed to assess the effects and the associated uncertainties a typical realization of the heterogeneous hydraulic conductivity field and the corresponding hydromechanical responses i e displacements and excess pore pressure distribution at a particular time t 4 s are shown in fig 9 the random field realization clearly shows layered profiles in the horizontal direction consistent with the high ratio of θ x θ z the excess pore pressure peaks near the surface and decreases with depth as expected displacement profiles show that there is not much horizontal displacement around the pipeline but the vertical displacement is relatively large as for the response of the pipeline a particular quantity of interest is the stress in the pipeline fig 10 shows the von mises stress in the pipeline at time t 2 4 s corresponding to the heterogeneous hydraulic conductivity field shown in fig 9 a it can be seen that the maximum von mises stress is located around the inner surface of the pipeline and the distribution is not symmetric due to the heterogeneous nature of the surrounding seabed to quantify the effects and associated uncertainties of the heterogeneous hydraulic conductivity fields on the hydromechanical responses of the seabed pipeline system characteristic responses of the system are extracted and calculated based on 1000 monte carlo simulations these responses include the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline the excess pore pressure along a vertical line cut through the center of the pipeline and the area ratio of liquefaction defined by eq 9 for comparison results of a homogeneous field with a hydraulic conductivity value equal to the mean of the heterogeneous field are also included the results are plotted and grouped in fig 11 it is interesting to see that even with a very large cov in the hydraulic conductivity field the quantities evaluated from heterogeneous model do not deviate as much from the corresponding homogeneous model for instance the vertical displacement curves shown in fig 11 b almost coincide with each other the influences of the heterogeneous hydraulic conductivity fields on the maximum von mises stress in the pipeline and the area ratio of liquefaction are more noticeable but still relatively insignificant similar observations have been made in a previous study zhang et al 2016 that the spatially varying hydraulic conductivity fields do not significantly affect the hydromechanical response of the seabed though no embedded pipeline was included in the previous study 5 2 sensitivity analysis of hydraulic conductivity to gain more insights into the effects of hydraulic conductivity on the hydromechanical response of the seabed pipeline system a sensitivity analysis is conducted the sensitivity analysis is carried out using homogeneous models each with a constant hydraulic conductivity field a wider range of hydraulic conductivity values ranging from 5 10 6 m s to 5 10 2 m s is considered the characteristic responses in terms of the maximum von mises stress in the pipeline the maximum vertical displacement in the seabed and the area ratio of liquefaction are summarized in fig 12 all these responses exhibit no noticeable variations at low hydraulic conductivity from 5 10 6 to 5 10 4 m s in particular the maximum von mises stress in the pipeline and the maximum vertical displacement at the top of the pipeline are insensitive to varying hydraulic conductivity values for hydraulic conductivity higher than 5 10 4 m s the area ratio of liquefaction reduces significantly with the increasing hydraulic conductivity due to the fact that a higher hydraulic conductivity increases the dissipation rate of excess pore pressure when heterogeneous hydraulic conductivity fields are introduced a certain area in the seabed would possess high hydraulic conductivity which would affect the pore pressure and furthermore the area ratio of liquefaction in that local area however the global effects of the heterogeneous hydraulic conductivity fields would be relatively small due to space averaging effect it is consistent with the aforementioned discussion that the influences of the heterogeneous hydraulic conductivity fields on the area ratio of liquefaction is more noticeable but still relatively insignificant overall in the example problem where an average value 5 10 4 m s of the hydraulic conductivity is considered its spatial variability effects on hydromechanical response are relatively insignificant 5 3 effects of spatially correlated shear modulus fields for the heterogeneous spatially correlated shear modulus field the following parameters are used considering ranges of those parameters summarized in table 1 the three main random parameters are set at cov 0 3 θ x 20 m and θ z 1 m parametric studies on these parameters will be presented in a subsequent section the mean of the shear modulus is 10 mpa and a lognormal distribution is assumed as in the case of the heterogeneous hydraulic conductivity fields a total of 1000 monte carlo simulations are performed to assess the impacts of the heterogeneous shear modulus fields and the associated uncertainties a typical realization of the heterogeneous shear modulus field and the corresponding hydromechanical responses i e displacements and excess pore pressure distribution at a particular time t 4 s are shown in fig 13 as in the previous hydraulic conductivity case the random field shows layered profiles due to the specified anisotropy by skewing the ratio of θ x and θ z in eq 11 fig 14 shows the von mises stress in the pipeline at time t 2 4 s corresponding to the heterogeneous shear modulus field the inner surface of the pipeline is predicted to experience the maximum von mises stress the locations of the maximum von mises stress are further away from the vertical and horizontal symmetric lines due to the influence of surrounding heterogeneous soils based on the results of 1000 monte carlo simulations characteristic responses of the system are shown in fig 15 it can be seen that even with a smaller cov 0 3 in the shear modulus compared to 2 5 in the hydraulic conductivity case responses of the system are greatly affected for instance fig 15 c shows that even at a deep depth z 30 m the excess pore pressure generated by the heterogeneous fields is almost twice of the homogeneous counterpart as for the von mises stresses and vertical displacement impacts of heterogeneous shear modulus fields are also more significant compared to the hydraulic conductivity fields 5 4 parametric study of the shear modulus coefficient of variation in the first parametric study the random parameter cov of the shear modulus field is set with the following values 0 15 0 3 0 45 0 6 0 75 and the other two random parameters θ x 20 m θ z 1 m are kept constant the mean of the shear modulus field is 10 mpa for each set of random parameters 1000 monte carlo simulations are performed resulting in a total of 5000 monte carlo simulations fig 16 shows the statistics of the characteristic hydromechanical responses including the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of liquefaction around the pipeline the uncertainties of these characteristic responses quantified in terms of their cov are all observed to be increasing with the increasing coefficient of variance of the shear moduli as shown in fig 16 d e and f it is consistent to common engineering perception that if considering hydromechanical responses as model outputs and the shear moduli property as model inputs the uncertainty of the model outputs would be positively correlated to the uncertainty of the model inputs a similar phenomenon was observed in griffiths and fenton 2001 griffiths et al 2002 where the uncertainty of the bearing capacity increases with the increasing uncertainty in input soil parameters it is interesting to note that within the examined range of covs in the shear modulus field the uncertainties of the characteristic responses of the system increase monotonously and almost linearly with the increasing uncertainty of the shear modulus field the relations between the mean of the characteristic responses and the covs in shear modulus field are shown in fig 16 a b and c it is observed that the mean von mises stress and the mean vertical displacement are increasing with the increasing uncertainty of the shear moduli but the area ratio of liquefaction around the pipeline actually decreases with the increasing uncertainty in the shear modulus field 5 5 parametric study of the shear modulus spatial correlations in the second parametric study the shear modulus horizontal spatial correlation length θ x is set with the following values 2 4 10 20 40 100 m the vertical spatial correlation length is varied accordingly by keeping a constant ratio of θ x θ z 20 the cov of the shear modulus field is kept constant at 0 3 the mean of the shear modulus field is 10 mpa example realizations of shear modulus fields with different horizontal spatial correlation lengths are shown in fig 17 as expected when the spatial correlation length approaches zero the soil property tends to be spatially independent i e the soil property at any position is a random variable itself and will not be affected by the value of its neighboring position as the correlation length approaches a very large value compared to the domain size the seabed becomes more of a multi layered field where the seabed properties vary as random variables within each layer again 1000 monte carlo simulations are performed for each set of random field parameters characteristic hydromechanical responses of the seabed pipeline system i e the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of liquefaction are evaluated and examined the statistics of these responses are summarized in fig 18 it can be seen that there are no significant changes in the mean of these responses within the considered wide range of the horizontal spatial correlation length as shown in fig 18 a b and fig 18 c this indicates that for the given example problem the spatial correlation length has a negligible influence on the mean values of the hydromechanical response the uncertainties of these responses are observed to increase and then reach a plateau with the increasing spatial correlation length as can be observed in fig 18 d e and fig 18 f as discussed at the beginning of this subsection a spatially independent field of the shear moduli would evolve as the spatial correlation length approaches zero due to space averaging effect the characteristic responses of such heterogeneous model would eventually approximate to that of a homogeneous model 5 6 implications of the inherent seabed heterogeneities on engineering design findings from the above analysis using the proposed framework have significant implications for the engineering design of submarine pipelines the dynamic responses of the seabed pipeline system are probabilistic in nature due to the inherent heterogeneities the traditional design based on a homogeneous model of seabed could lead to unsafe designs the obtained statistics of the characteristic hydromechanical responses can be utilized to inform and improve engineering design to illustrate this point the probability of insufficient design will be calculated based on monte carlo simulations here an insufficient design is defined as a design case when the maximum von mises stress in the pipeline evaluated from a heterogeneous model is higher than its value evaluated from a corresponding homogeneous model multiplied by a factor of safety the probability of insufficient design is calculated as 22 p f p σ v h e t σ v h o m f s where p f denotes the probability of insufficient design σ v h e t and σ v h o m are the maximum von mises stress in the pipeline evaluated from the heterogeneous model and the homogeneous model respectively fs is the factor of safety in design this definition of insufficient design is motivated by the consideration that if an engineer refers to the maximum von mises stress evaluated from a homogeneous model as the basis pipeline design there is a probability that such design is insufficient to carry the actual load even with a chosen factor of safety fig 19 summarizes the probability of insufficient design with different factors of safety fs for a range of shear modulus cov and spatial correlation length values based on the definition in eq 22 the probability of insufficient design is a fixed number for a given set of monte carlo simulations 1000 in this study for each set of cov in shear modulus or spatial correlation length this probability value may vary for a different number of monte carlo simulations since in this study the number of monte carlo simulations are set to 1000 based on the convergence results shown in fig 8 the covs of the insufficient design probabilities do not need to be calculated similar trends are observed in fig 19 a for all fs 1 0 i e the probability of insufficient design increases with the increasing cov take the case of fs 1 4 as an example the probability of insufficient design is close to zero for low cov of shear modulus field and it rises up to almost 12 if the cov increases to 0 75 the results indicate that a higher safety factor would be required if the seabed shear modulus is of high spatial variability the relation between the probability of insufficient design and the spatial correlation length in fig 19 b shows a similar trend however for the given factor of safety fs 1 4 the probability of insufficient design remains relatively small within the wide ranges of spatial correlation length considered 6 conclusion in this paper the wave induced dynamic responses of the seabed and embedded pipeline system are modeled with the consideration of multiresolution heterogeneous seabed property fields and coupled hydromechanical simulations the analysis model is first validated with experimental data of a pipeline embedded in homogeneous seabed sediment the numerical model is able to correctly capture the response of the seabed pipeline system then the effects of heterogeneous hydraulic conductivity fields and heterogeneous shear moduli fields on the characteristic responses of the system are analyzed in details parametric studies on the effect of varying random parameters are also conducted the statistics of the characteristic system responses are obtained from monte carlo simulations which could be further utilized in informing engineering design the main findings of this work are concluded as follows 1 the characteristic responses of the pipeline including the von mises stress and displacement at the top are found to be insensitive to the spatially correlated hydraulic conductivity fields the effects of hydraulic conductivity variability on the area ratio of liquefaction is more noticeable 2 the spatial variability of seabed shear moduli has significant effects on the characteristic responses of the seabed pipeline system the von mises stress and displacement in the pipeline and the area ratio of liquefaction area around the pipeline can be significantly underestimated if a homogeneous model is used 3 the uncertainty of the characteristic responses monotonously and almost linearly increases with the increasing cov of shear modulus field and uncertainty of the characteristic responses firstly increases and then reaches to plateau with the increasing spatial correlation length of shear modulus field 4 the statistics of the characteristic responses obtained from monte carlo simulations can be further utilized to inform probabilistic engineering design for a given factor of safety the probability of insufficient design increases with the increasing variability in the seabed properties acknowledgment this research is financially supported in part by the shrikhande family foundation through the shrikhande graduate fellowship and by the national natural science foundation of china project no 41572243 and 41372286 clemson university is acknowledged for the generous allotment of computer time on the palmetto high performance computing facility 
23008,in this work novel multiresolution random field models are integrated with coupled hydromechanical finite element simulations to model dynamic responses of heterogeneous seabed with embedded pipeline subjected to nonlinear wave induced loadings the heterogeneous properties of the seabed are characterized and modeled as spatially correlated random variables a conditional sequential simulation technique is implemented and multiresolution random field realizations of heterogeneous properties are generated the effects of spatially correlated seabed properties on the characteristic hydromechanical responses are analyzed in details through validated hydromechanical finite element simulations statistics and associated uncertainties of system response are obtained with recourse to monte carlo simulations the relations between the inherent heterogeneities and uncertainties in the system responses are derived findings of this study are shown to have important implications for probabilistic engineering designs keywords hydromechanical coupling random field models porous seabed spatial variability wave seabed pipeline interaction 1 introduction design of submarine infrastructure such as embedded pipelines require the understanding and the ability to predict the behavior of submarine infrastructure and the surrounding seabed subjected to wave induced loadings the influence of the wave loading on embedded pipelines is mainly characterized by two aspects first the dynamic wave loading induces oscillatory excess pore pressure within the porous seabed which directly results in oscillatory stresses and deformations within the embedded pipeline second the excess pore pressure built up during the propagation of dynamic waves may lead to transient liquefaction of the seabed soil tsui and helfrich 1983 ye 2012 which causes the loss of loading bearing capacity of the soil around the pipeline therefore when it comes for an engineer to design the pipeline it is of particular importance to predict the wave induced dynamic responses and quantities of interest such as the excess pore pressure the stress and deformation in the pipeline and the extent of liquefaction modeling the wave induced hydromechanical responses of the seabed pipeline system necessitates the integration of multiple models that account for the nonlinear wave induced loading the inherent heterogeneities of the seabed the interaction between fluid diffusion and solid deformation within the porous seabed and the stresses and deformations within the pipeline in simplified models the pipeline was treated as a rigid body or elastic solid while the surrounding seabed was assumed to be a homogeneous isotropic and elastic media cheng and liu 1986 magda 1997 jeng and cheng 2000 jeng et al 2001 zhao et al 2016a however natural seabed sediments are usually formed from a vertical consolidation process under overburden pressure coming from self weight and wave loading this process may result in significant cross anisotropy and depth dependency in seabed properties for example the permeability of seabed is found to decrease with depth as a result of decreasing porosity of the seabed due to the consolidation process seymour et al 1996 the seabed cross anisotropy can be described by assuming different material properties along the vertical and horizontal directions gatmiri 1992 jeng 1997 kitano and mase 1999 jeng and lin 1999 2000a wang et al 2000 zhou et al 2014 zhao et al 2016b some early work used the finite element method or developed analytical solutions to study the effects of cross anisotropy on the wave induced seabed response gatmiri 1992 jeng 1997 kitano and mase 1999 jeng and lin 2000a later the wave induced soil response around a buried pipeline was investigated in jeng and lin 1999 wang et al 2000 using two dimensional finite element models the wave seabed pipeline framework is then extended to a dynamic hydromechanical problem by zhou et al 2014 with the consideration of soil skeleton accelerations and zhao et al 2016b further elaborated this framework by incorporating an elasto plastic seabed model among these works on studying wave seabed pipeline behavior it is found that the effect of anisotropic soil behavior was more apparent near the bottom of the pipe than at the top of the pipe wang et al 2000 and liquefaction was more likely to occur in anisotropic soils than in isotropic soils especially in the vicinity of a pipeline zhao et al 2016b to consider the depth dependent seabed parameters one approach is to divide the seabed into a number of sub layers with finite thickness and assign uniform permeability porosity and shear modulus for each sub layer hsu et al 1995 zhou et al 2011 2013 ulker 2012 another approach is to describe the seabed parameters using continuous depth dependent functions jeng and seymour 1997 jeng and lin 2000b jeng 2001 gao et al 2003 for instance four different types of analytical function for depth dependent hydraulic conductivity were proposed in jeng and seymour 1997 the effects of depth dependent seabed parameters on the wave seabed pipeline behavior were analyzed through analytical and numerical models in recent works zhou et al 2011 2013 jeng and lin 2000b jeng 2001 gao et al 2003 in addition to the cross anisotropy and depth dependency characteristics of the seabed inherent heterogeneities also exist in the seabed due to its deposition processes goff et al 2004 2008 veloso et al 2016 the previously mentioned models for anisotropy or depth dependency may not necessarily capture the effects of seabed heterogeneities and the modeling results are only deterministic in nature though without consideration of any submarine structure the work of zhang et al 2016 is among the first efforts to consider the omnidirectional spatial variability of the seabed where the soil properties in the field were considered to consist of two parts a trend component and a residual term that exhibits spatial correlation random fields of seabed properties were generated and coupled with finite element models to simulate responses of the seabed in a recent work by peng et al 2017 the effects of cross correlation of the seabed soil properties on wave induced oscillatory seabed response were studied and it was found that multiple correlated random properties would lead to greater uncertainties in the excess pore pressure while the effects of spatial variability on seabed response have been studied previously its effects on the embedded pipeline and implications on probabilistic engineering design have not been addressed yet in this work a framework accounting for the inherent heterogeneities of a porous seabed and the coupled hydromechanical behavior is presented to model the wave induced dynamic responses of a heterogeneous seabed pipeline system details of the dynamic hydromechanical problem formulation are presented in section 2 a multiresolution random field model is developed in section 3 to characterize and generate spatially correlated heterogeneous and anisotropic seabed fields which will be coupled and implemented into a multiphysics finite element model section 4 in section 5 monte carlo simulations will be performed to investigate the impact of heterogeneous seabed on the hydromechanical responses of the system and the implications on probabilistic engineering design 1 1 formulation of the dynamic hydromechanical coupled problem the problem considered in this work is a dynamic hydromechanical problem where the wave propagates over a heterogeneous porous seabed with an embedded submarine pipeline fig 1 the problem is treated as a plane strain problem where the dimension of the pipeline in the y direction is much larger and its deformation along y direction is neglected the seabed is modeled as a poroelastic material while the embedded pipeline is modeled as an elastic solid 2 1 balance laws the balance laws of porous seabed consist of two sets of partial differential equations pdes i e the balance of mass equation and the balance of linear momentum equation in deriving the balance of mass equation both the compressibility of the pore fluid and the degree of saturation of the porous seabed are accounted for the final form of the balance of mass equation is written as 1 k p ϕ f ρ f g β p t ρ f k a ρ f g v 0 where k is the hydraulic conductivity tensor of the seabed p is the excess pore pressure ϕ s and ϕ f are the volume fractions of the solid skeleton and void including gas and fluid respectively ρ f is the intrinsic mass density of the fluid g is the gravitational acceleration a and v are the acceleration and velocity respectively the parameter β accounts for both the compressibility of the pore fluid and the degree of saturation of the porous seabed and is given as 2 β 1 k f 1 s r p f 0 where s r is the degree of saturation k f is the bulk modulus of the fluid and p f 0 is the static pore pressure the balance of linear momentum equation of the porous seabed is given as 3 σ p ρ b ρ a where σ is the effective stress of the porous seabed p is the excess pore pressure b is the body force ρ ϕ s ρ s ϕ f ρ f is the equivalent density of the porous seabed with ρ s and ρ f being the intrinsic mass density of the fluid and solid respectively for the embedded pipeline the balance of linear momentum equation is given as 4 σ ρ p b ρ p a where σ is the total stress of the pipeline and for single phase solid material σ σ with σ being the effective stress ρ p is the mass density of the pipeline perfect bonding is assumed between the pipeline and seabed 2 2 constitutive relations elastic constitutive relations are assumed for both the seabed solid skeleton and the pipeline based on the generalized hooke s law 5 σ c ε where for the plane strain problem considered the effective stress in voigt notation is given as σ σ x x σ z z σ x z t and the strain is given as ε ε x x ε z z ε x z t it should be emphasized that for the porous seabed σ σ p δ and for the solid pipeline σ σ c is the elastic modulus given as 6 c s p 2 g s p 1 2 ν s p 1 ν s p ν s p 0 ν s p 1 ν s p 0 0 0 1 2 ν s p where g is the shear modulus and ν is the poisson s ratio the subscript s corresponds to the seabed skeleton and p corresponds to the pipeline while elastic constitutive relations assumed for its simplicity and computational efficiency their limitations should also be noted the elastic models cannot capture permanent deformations of the marine soils or the pipeline more advanced elastoplasticity model would need to be implemented for this purpose which typically involves additional model parameters that need to be calibrated and is generally computational expensive 2 3 wave induced nonlinear loading on the seabed in general the wave characteristic will be changed due to the interaction between the wave and the seabed for deeper water however such interaction can be neglected in this work the change of wave characteristics is assumed to be negligible therefore the vertical effective stress σ z z and the shear stress σ z x induced by the wave on the seabed boundary can be neglected yamamoto and suzuki 1980 the wave induced loading is applied on the seabed boundary as a time varying pore pressure function p b t with t being time as follows 7 σ z z σ z x 0 p p b t at z 0 the cyclic variation of pore pressure is estimated by an analytic formulation of wave pressure on the seabed surface zhou et al 2013 generally stokes wave theory is of direct practical use for waves on intermediate and deep water according to the first order stokes wave the dynamic variation of wave pressure p b t is zhou et al 2013 8 p b t p 0 cos 2 π x l ω t 1 2 ρ f g cosh 1 2 π d l cos 2 π x l ω t where d is the water depth l and h are the wavelength and height respectively ω is the angular frequency of the wave and p 0 denotes the amplitude of the wave pressure at the seabed surface 2 4 transient liquefaction criteria dynamic loading of ocean wave could induce oscillatory excess pore pressure within the porous seabed which leads to oscillatory effective stress and liquefaction of the seabed when the marine soil liquefies it loses its load bearing capacity and behaves as a viscous liquid potentially causing damages to the embedded infrastructure therefore liquefaction of seabed under dynamic wave loading is an important aspect that will be analyzed in this work the transient liquefaction criterion is adopted as follows zen and yamazaki 1990a 1990b 9 γ s γ f z p b t p 0 where p b t is the dynamic wave pressure defined in eq 8 and p is the excess pore pressure in the seabed this criterion is simple in form and has a direct physical interpretation that the seabed will liquefy if the upward seepage force can overcome the effective self weight of the overburdened soil to quantify and compare the extent of liquefaction previous works have recourse to the maximum depth of liquefaction jeng and cheng 2000 zhou et al 2013 however the maximum depth of liquefaction gives only limited information regarding the extent of liquefaction moreover when heterogeneity of seabed is accounted for the liquefaction area boundary profile can be tortuous in this work a new parameter indicating the area ratio of liquefaction is proposed to quantify and compare the liquefaction extent the parameter is defined as the ratio of the area of liquefaction to the total area of the domain of influence which is taken as five times the diameter of the pipeline and is illustrated in fig 2 the choice of five times is based on a preliminary investigation of the excess pore pressure built up around the pipeline when the wave propagates and it was found that the domain of five times the diameter approximately covers the area of the most excess pore pressure built up especially in the vertical direction 3 multiresolution random field characterization of the heterogeneous seabed inherent heterogeneities i e those resulting from fluctuations in material properties such as hydraulic conductivity or shear modulus exist in natural geological materials including the marine soil in this section a multiresolution random field is presented to characterize and model the inherent heterogeneities in the porous seabed the random field model will then be coupled with multiphysics finite element model section 4 and monte carlo simulations to analyze the impact of inherent heterogeneities on the seabed pipeline system response 3 1 characterization of anisotropic spatial dependency seabed properties generally exhibit variation with space and such variation is spatially correlated or dependent which is typically attributed to the deposition process of the seabed in this study the spatial dependency is described using a form of covariance known as the semivariogram γ h which is equal to half the variance of the difference of two random variables separated by a vector distance h 10 γ h 1 2 var z x z x h where z x is a gaussian random variable at location x with x u w being the location vector the vector h accounts for both the separation distance and the orientation of two points in the random field in the actual implementation a simplified scalar measure h is typically defined 11 h h x θ x 2 h z θ z 2 where h x and h z are the scalar component of the vector h along the field s principal axes x and z respectively scalar quantities θ x and θ z specify how quickly spatial dependence decreases along those axes by skewing the ratio of θ x and θ z anisotropic random fields can be generated which is particularly useful for modeling heterogeneous seabed properties that typically exhibit anisotropy as will be shown in the example section in practice various analytical semivariogram models and their linear combinations are typically fitted to an empirical semivariogram that is calculated from field data examples of commonly used analytical semivariogram models include the nugget effect model the linear model the spherical model the exponential model and the gaussian model goovaerts 1997 the specific model form can be inferred from available field data or assumed based on expert knowledge for marine deposit studies and data on the spatial variability of its properties are relatively limited in valdez llamas et al 2003 the spatial variability of the cohesive soft soil thickness and the water content of a marine soil are found to be exponential in several other studies that consider the randomness of marine soils the exponential correlation structure is also used e g zhang et al 2016 peng et al 2017 lloret cabot et al 2014 while there lacks sufficient data or clear evidence pointing to a specific spatial structure an exponential model is assumed in this work to illustrate the proposed framework it should be noted that whenever there are sufficient field data the specific spatial correlation structure can always be inferred the expression of the adopted exponential model is 12 γ h 1 exp h 3 2 multiresolution random field and conditional simulation algorithm given the spatial correlation model and a specified or inferred probability distribution function for the random variable a conditional sequential simulation algorithm is implemented in this work to generate random field realizations of material properties this algorithm is particularly valuable for the multiresolution random field utilized in this study where a higher resolution field is desired around the area adjacent to the embedded pipeline see illustration in fig 3 with this algorithm one can simply add additional random field data points wherever and whenever is necessary during the simulation process conditional upon all previously simulated data and as the need arises an additional advantage of this algorithm is that it allows real data points to be incorporated and preserved in the generated random field e g chen et al 2015 liu et al 2017 denote z p as a vector of all known and previously simulated points in the random field and denote z n as the next point to be simulated the sequential simulation process can be illustrated by the joint distribution chen et al 2012 13 z n z p n μ σ n 2 σ n p σ p n σ p p where n μ σ denotes the vector of random variables following a joint normal distribution with the mean vector μ and the covariance matrix σ σ n 2 is the prior variance of the next simulated point σ n p σ p n and σ p p are the covariance matrices where the subscripts n and p represent next as in next point to be simulated and previous as in all previously simulated points respectively the covariance matrices are obtained by 14 cov z i z j ρ i j σ i σ j where ρ i j is the correlation between random variables z i and z j with standard deviations of σ i and σ j respectively the correlation ρ is related to the semivariogram defined in eq 10 through 15 ρ h 1 γ h where h is the scalar distance given in eq 11 using the joint distribution eq 13 the distribution of z n conditional upon all previously simulated data is given by a univariate normal distribution with the updated mean and variance as chen et al 2012 16 z n z p z n σ n p σ p p 1 z σ n 2 σ n p σ p p 1 σ p n where the lowercase z represents the vector of simulated values other terms have been defined after eq 13 the conditional simulation starts with a single realization of a standard normal variable then all subsequent realizations are conditional upon all previous simulations following eq 16 once simulated z n becomes a data point in the vector z p to be conditioned upon by all subsequent data locations this process is repeated by following a random path to each unknown location until all the values in the field have been simulated it should be noted that the spatial dependence and the conditional simulation algorithm introduced above are for variables having a gaussian distribution for non gaussian distributions the inference of spatial structure is recommended to be performed on transformed data using a normal score mapping goovaerts 1997 such normal score mapping is a common practice in many applications of geostatistics and has previously been shown to preserve the prescribed spatial structure for lognormally distributed variables in various applications chen et al 2012 baker et al 2011 wang et al 2017 wang and chen 2017 the above described random field models are implemented in matlab and will be coupled with the multiphysics finite element model described in section 4 to simulate dynamic responses of the heterogeneous seabed with an embedded pipeline fig 3 is a schematic illustration of the multiresolution random field where higher resolution random field is generated around the embedded pipeline 3 3 statistical and spatial characteristics of seabed properties in the context of the hydromechanical coupled problem formulated in section 2 seabed properties of interest include hydraulic conductivity porosity density elastic properties e g shear modulus young s modulus among them hydraulic conductivity porosity and shear modulus are often considered as the primary parameters influencing the hydromechanical responses of the seabed zhang et al 2016 jeng 2012 hydraulic conductivity and porosity can be considered dependent on each other e g through the kozeny carman relationship and the fact that hydraulic conductivity can be related to the intrinsic permeability of the porous media hence in this study only hydraulic conductivity and shear modulus will be treated as spatially correlated random variables impact of the heterogeneous hydraulic conductivity and shear modulus fields will be analyzed through multiphysics finite element simulations statistical and spatial characterizations of seabed properties are difficult to obtain due to very limited field data of marine soil table 1 summarizes some examples of seabed properties from previous research on marine soils in this work statistical and spatial characteristics of the random field variables in particular the coefficient of variation cov and the correlation length parameters θ x θ z are chosen based on prior researches and parametric studies will also be conducted to evaluate the influence of statistical and spatial parameters both the shear modulus and hydraulic conductivity are assumed to follow lognormal distributions in this work while there lacks clear evidence pointing to a specific probability distribution of seabed properties one condition that has to be satisfied is for the probability density function to have a non negative lower bound to this end the lognormal distribution is widely used to describe soil properties experimental data for shear modulus and hydraulic conductivity are usually found to follow a lognormal distribution e g phoon and kulhawy 1999b baecher and christian 2005 carsel and parrish 1988 the lognormal distribution was also used for seabed properties in a recent study zhang et al 2016 anisotropy of the random field will be realized by skewing the ratio of the scalar parameter θ x and θ z in eq 11 4 multiphysics finite element model in this section details of the multiphysics finite element implementation are presented the finite element model will be coupled with the multiresolution random field model described in section 3 to simulate the dynamic response of a heterogeneous seabed pipeline system 4 1 numerical implementation the comsol multiphysics software is used to implement the hydromechanical problem formulated in section 2 and to simulate dynamic responses of a heterogeneous seabed pipeline system one advantage of using comsol in this study is that through its livelink for matlab interface the comsol solver can be integrated with the random field code implemented in matlab this convenient interface between multiphysics finite element solver and random field code allows running many instances of monte carlo simulations needed to study the impact of heterogeneous seabed on the system responses the governing equations i e pdes are implemented in comsol through its general form pde mode substituting the constitutive laws eqs 5 and 6 for porous seabed and solid pipeline into their corresponding balance laws eqs 1 3 and 4 and using small strain displacement relations the implemented governing equations for the porous seabed are written as 17 k x 2 p 2 x k z 2 p 2 z ϕ f ρ f g β p t ρ f 2 2 t k x u x k z w z ρ f g t u x w z 18 p x ρ 2 u 2 t g s 2 u 2 x 2 u 2 z 1 1 2 ν s g s x u x w z ρ b x 19 p z ρ 2 w 2 t g s 2 w 2 x 2 w 2 z 1 1 2 ν s g s z u x w z ρ b z where u and w are the horizontal x and vertical z component of the displacement vector p is the excess pore pressure k x and k z are the x and z components of the hydraulic conductivity tensor g s is the shear modulus of the seabed ν s is the poisson s ratio ϕ f is the volume fraction of the void ρ f is the intrinsic mass density of the fluid ρ is the equivalent density of the porous seabed g is the gravitational acceleration β is given in eq 2 b x and b z are the x and z components of the body force similarly the governing equations for the pipeline can be derived and are written as 20 ρ p 2 u 2 t g p 2 u 2 x 2 u 2 z 1 1 2 ν p g p x u x w z ρ p b x 0 21 ρ p 2 w 2 t g p 2 w 2 x 2 w 2 z 1 1 2 ν p g p z u x w z ρ p b z 0 where g p is the shear modulus of the pipeline ν p is the poisson s ratio ρ p is the density of the pipeline in addition to governing equations the dynamic wave pressure equation eq 8 is also implemented in comsol as a user defined boundary condition once the governing equations and boundary conditions are implemented solutions u w and p will be obtained through the comsol multiphysics solver 4 2 model validation pipeline in a homogeneous seabed before coupling the implemented comsol multiphysics model with the multiresolution random field model the multiphysics model is first validated using experimental data reported in turcotte et al 1984 the experiments have a similar setup to the schematic diagram shown in fig 1 the seabed is simulated using a sediment bay with a pvc pipe inside it simulating the buried pipeline the seabed pipeline system is then placed in a large wave tank which can stimulate waves of specific characteristics most of the material properties of the seabed have been previously calibrated and reported in cheng and liu 1986 except water characteristics and mass density of seabed which are reported in zhou et al 2013 the properties of the pvc pipe from rajani et al 1996 are used in the validation model geometry wave seabed and pipeline characteristic are all summarized in table 2 numerical solutions of the normalized excess pore pressure around the pipeline are obtained using the multiphysics model and then compared against the data measured in physical experiments from turcotte et al 1984 the comparisons are plotted in fig 4 it can be seen that results from numerical simulations and physical experiments are in reasonable agreements the numerical model is able to correctly capture the response of the seabed pipeline system 4 3 model setup pipeline in a heterogeneous seabed in this section the multiphysics model is coupled with the multiresolution random field model to simulate the response of a pipeline embedded in a heterogeneous seabed the model domain fig 5 is 100 m wide and 30 m deep a pipeline 2 0 m in diameter and 0 2 m in thickness is horizontally centered in the seabed and buried 4 0 m below the seabed surface a wave with 6 0 m in height h and 70 93 m in length l is generated following eq 8 the seabed domain is set to be slightly wider than one full wavelength so that a full wave induced loading can be modeled the depth of the seabed 30 m is about five times the wave height where the wave induced effects on the seabed become negligible boundary conditions of the model problem are summarized in table 3 the input model parameters and material properties are summarized in table 4 those parameters are chosen based on prior knowledge from literature table 1 and the author s previous experience zhou et al 2013 2014 in jeng and cheng 1999 pipeline diameters ranging from 1 to 3 m and burial depths ranging from 1 5 to 4 m were investigated in the case study the geometry and burial depth are known to significantly influence the distribution of the pore pressure jeng and lin 1999 jeng and cheng 1999 the choice of pipeline geometry and burial depth will depend on specific applications the water depth and wave characteristic values are taken from a previous study zhou et al 2013 and correspond to the case of waves in shallow water for the hydraulic conductivity k and shear modulus g s of the porous seabed as discussed in section 3 they are treated as spatially correlated random variables and modeled through multiresolution random field models 4 4 mesh sensitivity analysis the implemented multiphysics finite element will be coupled with random field models to study responses and associated uncertainties of a heterogeneous seabed pipeline system using monte carlo simulations this requires a large number of simulations an extremely fine finite element though more accurate may be computationally too expensive for such purpose to this end a mesh sensitivity analysis is first carried out to obtain an optimal mesh to be used for the following monte carlo simulations to ensure sufficient resolution and accuracy of solutions around the embedded pipeline a relatively fine discretization is used by enforcing 80 nodes around the pipeline circumference the mesh sensitivity analysis is carried out by changing the maximum element size h e in the domain as h e increases the total number of elements in the domain decreases note that when the maximum element size h e is sufficiently large the total number of elements will not change as much due to the fact that an extremely fine resolution is enforced around the pipeline fig 6 shows four different finite element meshes and table 5 summarizes the total number of elements and runtime for each mesh the performance of different meshes is evaluated by extracting and comparing quantities of interest in particular the excess pore pressure in the seabed the von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of transient liquefaction fig 7 summarizes the mesh sensitivity study results based on the mesh sensitivity results and considering the trade off between runtime and accuracy the mesh with h e 5 is selected for the following monte carlo simulations and the results will be presented and discussed in section 5 4 5 convergence of monte carlo simulations to study the impact of material heterogeneities and associated uncertainties on the seabed pipeline system a sufficient number of monte carlo simulations is needed fig 8 shows the variations of mean and coefficient of variation cov of displacement at the top of the pipeline and the maximum von mises stress in the pipeline with the number of monte carlo simulations it can be observed that 1000 monte carlo simulations are sufficient for the given example problem and will be used in the numerical analysis and discussions 5 numerical results and discussions in this section numerical results of the coupled multiresolution random field and multiphysics finite element simulations are presented effects of heterogeneous seabed properties and wave induced loading on the dynamic responses of the system will be analyzed in details the hydraulic conductivity and shear modulus of the seabed are treated as spatially correlated but statistically independent random variables three parameters i e the coefficient of variance cov the horizontal and vertical correlation length parameters θ x θ z are the three main random field parameters controlling the heterogeneous attributes of the seabed parametric studies of these parameters will also be conducted to understand and quantify their influence on system responses other input parameters for the model have been summarized in table 4 5 1 effects of spatially correlated hydraulic conductivity fields for the heterogeneous spatially correlated hydraulic conductivity fields the three main random parameters are set at cov 2 5 θ x 20 m and θ z 1 m considering ranges summarized in table 1 the mean of the hydraulic conductivity field is 5 10 4 m s and a lognormal distribution is assumed 1000 monte carlo simulations are performed to assess the effects and the associated uncertainties a typical realization of the heterogeneous hydraulic conductivity field and the corresponding hydromechanical responses i e displacements and excess pore pressure distribution at a particular time t 4 s are shown in fig 9 the random field realization clearly shows layered profiles in the horizontal direction consistent with the high ratio of θ x θ z the excess pore pressure peaks near the surface and decreases with depth as expected displacement profiles show that there is not much horizontal displacement around the pipeline but the vertical displacement is relatively large as for the response of the pipeline a particular quantity of interest is the stress in the pipeline fig 10 shows the von mises stress in the pipeline at time t 2 4 s corresponding to the heterogeneous hydraulic conductivity field shown in fig 9 a it can be seen that the maximum von mises stress is located around the inner surface of the pipeline and the distribution is not symmetric due to the heterogeneous nature of the surrounding seabed to quantify the effects and associated uncertainties of the heterogeneous hydraulic conductivity fields on the hydromechanical responses of the seabed pipeline system characteristic responses of the system are extracted and calculated based on 1000 monte carlo simulations these responses include the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline the excess pore pressure along a vertical line cut through the center of the pipeline and the area ratio of liquefaction defined by eq 9 for comparison results of a homogeneous field with a hydraulic conductivity value equal to the mean of the heterogeneous field are also included the results are plotted and grouped in fig 11 it is interesting to see that even with a very large cov in the hydraulic conductivity field the quantities evaluated from heterogeneous model do not deviate as much from the corresponding homogeneous model for instance the vertical displacement curves shown in fig 11 b almost coincide with each other the influences of the heterogeneous hydraulic conductivity fields on the maximum von mises stress in the pipeline and the area ratio of liquefaction are more noticeable but still relatively insignificant similar observations have been made in a previous study zhang et al 2016 that the spatially varying hydraulic conductivity fields do not significantly affect the hydromechanical response of the seabed though no embedded pipeline was included in the previous study 5 2 sensitivity analysis of hydraulic conductivity to gain more insights into the effects of hydraulic conductivity on the hydromechanical response of the seabed pipeline system a sensitivity analysis is conducted the sensitivity analysis is carried out using homogeneous models each with a constant hydraulic conductivity field a wider range of hydraulic conductivity values ranging from 5 10 6 m s to 5 10 2 m s is considered the characteristic responses in terms of the maximum von mises stress in the pipeline the maximum vertical displacement in the seabed and the area ratio of liquefaction are summarized in fig 12 all these responses exhibit no noticeable variations at low hydraulic conductivity from 5 10 6 to 5 10 4 m s in particular the maximum von mises stress in the pipeline and the maximum vertical displacement at the top of the pipeline are insensitive to varying hydraulic conductivity values for hydraulic conductivity higher than 5 10 4 m s the area ratio of liquefaction reduces significantly with the increasing hydraulic conductivity due to the fact that a higher hydraulic conductivity increases the dissipation rate of excess pore pressure when heterogeneous hydraulic conductivity fields are introduced a certain area in the seabed would possess high hydraulic conductivity which would affect the pore pressure and furthermore the area ratio of liquefaction in that local area however the global effects of the heterogeneous hydraulic conductivity fields would be relatively small due to space averaging effect it is consistent with the aforementioned discussion that the influences of the heterogeneous hydraulic conductivity fields on the area ratio of liquefaction is more noticeable but still relatively insignificant overall in the example problem where an average value 5 10 4 m s of the hydraulic conductivity is considered its spatial variability effects on hydromechanical response are relatively insignificant 5 3 effects of spatially correlated shear modulus fields for the heterogeneous spatially correlated shear modulus field the following parameters are used considering ranges of those parameters summarized in table 1 the three main random parameters are set at cov 0 3 θ x 20 m and θ z 1 m parametric studies on these parameters will be presented in a subsequent section the mean of the shear modulus is 10 mpa and a lognormal distribution is assumed as in the case of the heterogeneous hydraulic conductivity fields a total of 1000 monte carlo simulations are performed to assess the impacts of the heterogeneous shear modulus fields and the associated uncertainties a typical realization of the heterogeneous shear modulus field and the corresponding hydromechanical responses i e displacements and excess pore pressure distribution at a particular time t 4 s are shown in fig 13 as in the previous hydraulic conductivity case the random field shows layered profiles due to the specified anisotropy by skewing the ratio of θ x and θ z in eq 11 fig 14 shows the von mises stress in the pipeline at time t 2 4 s corresponding to the heterogeneous shear modulus field the inner surface of the pipeline is predicted to experience the maximum von mises stress the locations of the maximum von mises stress are further away from the vertical and horizontal symmetric lines due to the influence of surrounding heterogeneous soils based on the results of 1000 monte carlo simulations characteristic responses of the system are shown in fig 15 it can be seen that even with a smaller cov 0 3 in the shear modulus compared to 2 5 in the hydraulic conductivity case responses of the system are greatly affected for instance fig 15 c shows that even at a deep depth z 30 m the excess pore pressure generated by the heterogeneous fields is almost twice of the homogeneous counterpart as for the von mises stresses and vertical displacement impacts of heterogeneous shear modulus fields are also more significant compared to the hydraulic conductivity fields 5 4 parametric study of the shear modulus coefficient of variation in the first parametric study the random parameter cov of the shear modulus field is set with the following values 0 15 0 3 0 45 0 6 0 75 and the other two random parameters θ x 20 m θ z 1 m are kept constant the mean of the shear modulus field is 10 mpa for each set of random parameters 1000 monte carlo simulations are performed resulting in a total of 5000 monte carlo simulations fig 16 shows the statistics of the characteristic hydromechanical responses including the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of liquefaction around the pipeline the uncertainties of these characteristic responses quantified in terms of their cov are all observed to be increasing with the increasing coefficient of variance of the shear moduli as shown in fig 16 d e and f it is consistent to common engineering perception that if considering hydromechanical responses as model outputs and the shear moduli property as model inputs the uncertainty of the model outputs would be positively correlated to the uncertainty of the model inputs a similar phenomenon was observed in griffiths and fenton 2001 griffiths et al 2002 where the uncertainty of the bearing capacity increases with the increasing uncertainty in input soil parameters it is interesting to note that within the examined range of covs in the shear modulus field the uncertainties of the characteristic responses of the system increase monotonously and almost linearly with the increasing uncertainty of the shear modulus field the relations between the mean of the characteristic responses and the covs in shear modulus field are shown in fig 16 a b and c it is observed that the mean von mises stress and the mean vertical displacement are increasing with the increasing uncertainty of the shear moduli but the area ratio of liquefaction around the pipeline actually decreases with the increasing uncertainty in the shear modulus field 5 5 parametric study of the shear modulus spatial correlations in the second parametric study the shear modulus horizontal spatial correlation length θ x is set with the following values 2 4 10 20 40 100 m the vertical spatial correlation length is varied accordingly by keeping a constant ratio of θ x θ z 20 the cov of the shear modulus field is kept constant at 0 3 the mean of the shear modulus field is 10 mpa example realizations of shear modulus fields with different horizontal spatial correlation lengths are shown in fig 17 as expected when the spatial correlation length approaches zero the soil property tends to be spatially independent i e the soil property at any position is a random variable itself and will not be affected by the value of its neighboring position as the correlation length approaches a very large value compared to the domain size the seabed becomes more of a multi layered field where the seabed properties vary as random variables within each layer again 1000 monte carlo simulations are performed for each set of random field parameters characteristic hydromechanical responses of the seabed pipeline system i e the maximum von mises stress in the pipeline the vertical displacement at the top of the pipeline and the area ratio of liquefaction are evaluated and examined the statistics of these responses are summarized in fig 18 it can be seen that there are no significant changes in the mean of these responses within the considered wide range of the horizontal spatial correlation length as shown in fig 18 a b and fig 18 c this indicates that for the given example problem the spatial correlation length has a negligible influence on the mean values of the hydromechanical response the uncertainties of these responses are observed to increase and then reach a plateau with the increasing spatial correlation length as can be observed in fig 18 d e and fig 18 f as discussed at the beginning of this subsection a spatially independent field of the shear moduli would evolve as the spatial correlation length approaches zero due to space averaging effect the characteristic responses of such heterogeneous model would eventually approximate to that of a homogeneous model 5 6 implications of the inherent seabed heterogeneities on engineering design findings from the above analysis using the proposed framework have significant implications for the engineering design of submarine pipelines the dynamic responses of the seabed pipeline system are probabilistic in nature due to the inherent heterogeneities the traditional design based on a homogeneous model of seabed could lead to unsafe designs the obtained statistics of the characteristic hydromechanical responses can be utilized to inform and improve engineering design to illustrate this point the probability of insufficient design will be calculated based on monte carlo simulations here an insufficient design is defined as a design case when the maximum von mises stress in the pipeline evaluated from a heterogeneous model is higher than its value evaluated from a corresponding homogeneous model multiplied by a factor of safety the probability of insufficient design is calculated as 22 p f p σ v h e t σ v h o m f s where p f denotes the probability of insufficient design σ v h e t and σ v h o m are the maximum von mises stress in the pipeline evaluated from the heterogeneous model and the homogeneous model respectively fs is the factor of safety in design this definition of insufficient design is motivated by the consideration that if an engineer refers to the maximum von mises stress evaluated from a homogeneous model as the basis pipeline design there is a probability that such design is insufficient to carry the actual load even with a chosen factor of safety fig 19 summarizes the probability of insufficient design with different factors of safety fs for a range of shear modulus cov and spatial correlation length values based on the definition in eq 22 the probability of insufficient design is a fixed number for a given set of monte carlo simulations 1000 in this study for each set of cov in shear modulus or spatial correlation length this probability value may vary for a different number of monte carlo simulations since in this study the number of monte carlo simulations are set to 1000 based on the convergence results shown in fig 8 the covs of the insufficient design probabilities do not need to be calculated similar trends are observed in fig 19 a for all fs 1 0 i e the probability of insufficient design increases with the increasing cov take the case of fs 1 4 as an example the probability of insufficient design is close to zero for low cov of shear modulus field and it rises up to almost 12 if the cov increases to 0 75 the results indicate that a higher safety factor would be required if the seabed shear modulus is of high spatial variability the relation between the probability of insufficient design and the spatial correlation length in fig 19 b shows a similar trend however for the given factor of safety fs 1 4 the probability of insufficient design remains relatively small within the wide ranges of spatial correlation length considered 6 conclusion in this paper the wave induced dynamic responses of the seabed and embedded pipeline system are modeled with the consideration of multiresolution heterogeneous seabed property fields and coupled hydromechanical simulations the analysis model is first validated with experimental data of a pipeline embedded in homogeneous seabed sediment the numerical model is able to correctly capture the response of the seabed pipeline system then the effects of heterogeneous hydraulic conductivity fields and heterogeneous shear moduli fields on the characteristic responses of the system are analyzed in details parametric studies on the effect of varying random parameters are also conducted the statistics of the characteristic system responses are obtained from monte carlo simulations which could be further utilized in informing engineering design the main findings of this work are concluded as follows 1 the characteristic responses of the pipeline including the von mises stress and displacement at the top are found to be insensitive to the spatially correlated hydraulic conductivity fields the effects of hydraulic conductivity variability on the area ratio of liquefaction is more noticeable 2 the spatial variability of seabed shear moduli has significant effects on the characteristic responses of the seabed pipeline system the von mises stress and displacement in the pipeline and the area ratio of liquefaction area around the pipeline can be significantly underestimated if a homogeneous model is used 3 the uncertainty of the characteristic responses monotonously and almost linearly increases with the increasing cov of shear modulus field and uncertainty of the characteristic responses firstly increases and then reaches to plateau with the increasing spatial correlation length of shear modulus field 4 the statistics of the characteristic responses obtained from monte carlo simulations can be further utilized to inform probabilistic engineering design for a given factor of safety the probability of insufficient design increases with the increasing variability in the seabed properties acknowledgment this research is financially supported in part by the shrikhande family foundation through the shrikhande graduate fellowship and by the national natural science foundation of china project no 41572243 and 41372286 clemson university is acknowledged for the generous allotment of computer time on the palmetto high performance computing facility 
23009,this paper first investigates the trajectory tracking problem of an underactuated underwater vehicle based on control moment gyros cmgs in the three dimensional 3d space the controller designing process consists of three parts to form a transformed cascade nonlinear system subject to internal disturbances and input saturation by introducing virtual control laws to simplify the position error in kinematic layer and tracking errors can be guaranteed to converge to zero on condition that the error dynamics are stabilized moreover anti windup compensators are taken in order to deal with the problem of input saturation and backstepping methods are exploited to construct the dynamic controller to force the error signals converge to the neighborhood of origin furthermore note that attitude control torques generated by the proposed controller are actual control input for cmgs therefore constrained steering law is utilized to achieve the global tracking control finally numerical simulation studies are carried out to illustrate the effectiveness of the developed control framework keywords underactuated underwater vehicle trajectory tracking control moment gyros backstepping 1 introduction it seems verbose to mention the substantial value and prospects of cmgs in aerospace engineering in fact over the past several decades as the angular momentum exchange devices and attitude control actuators cmgs have been successfully applied in large space platforms and small agile satellites because of their large and precise output torque coon and irby 1976 charles et al 2012 by contrast reports of its application in the field of marine engineering are numbered thornton et al 2005 2007 2008 it should be emphasized that an autonomous underwater vehicle auv actuated by internal cmg system is free from relative fluid motion compared with thrusters and fans which means that its actuator performance is independent of external conditions whether in low or zero speed thornton et al 2007 as far as the class of hybrid auvs concerned internal actuators combined with propeller units can overcome the effects of strong ocean currents and shallow waters with great efficiency internal movable mass has been recommended as the actuators for remus auvs which shows its high maneuverability in heading control zhao and song 2012 li and su 2016 by comparison cmg systems can control three axis attitude of the auv even in a stationary state it s predictable that cmg actuated auvs have bright prospects when facing with more diverse underwater tasks and complex working environments such as observation and operation in a narrow space operation under the complex hydrological condition and attitude control with accuracy and speed in the military field however researches on the tracking control problem of an auv using cmgs are comparatively uncommon in comparison with studies of its attitude control performance actually inertial navigation sensor applied to the virtual submerged floating operational system vsfos which is introduced in zhang et al 2018 can be used to monitor its attitude change for providing instructions for the auv in the task of trajectory tracking auv must track the expected time varying position and velocity at a pre specified time instant as a result study of this control objective is necessary and significant for the cmg based auv to inspect its motion performance based on the previous research of planar trajectory tracking control for this vehicle xu et al 2018 this paper embarks on addressing the control problem of trajectory tracking in 3d space in the presence of internal singularities and input saturation in the literature about tracking control techniques for auvs there is no doubt that the way point tracking is the foundation of trajectory tracking for a class of underactuated mechanical systems with movement in six degree of freedom dof satisfying the developed dynamical constraints borhaug and pettersen have innovatively proposed a global k exponential tracking control strategy with cascaded approach borhaug and pettersen 2005 in the study of trajectory tracking control of underactuated auvs li et al have improved this method by introducing virtual control signals into the error kinematics within an admissible error radius of the longitudinal direction li et al 2015 nevertheless control input saturation and external disturbances are not considered to make the system globally uniformly exponentially stability to realize the finite time planar trajectory tracking adaptive neural network and sliding mode state observer are proposed by chu et al to formulate the tracking control law for a full actuated remotely operated vehicle rov chu et al 2017 many researchers have imposed different approaches for tracking control of full actuated auvs in 3d space sun et al 2014 wang et al 2015 gao et al 2015 however these controllers cannot be used in underactuated ones based on lyapunov s direct method and backstepping techniques rezazadegan et al 2015 have presented an adaptive controller for the trajectory tracking control of an underactuated auv in 6 dofs actuator saturation and parametric uncertainties are addressed by taken account of introducing virtual control laws and the hyperbolic tangent function though the control scheme is rather complicated with a simple dynamical model karkoub et al 2017 have proposed a hierarchical robust nonlinear hrn trajectory tracking controller for a 6 dof auv system subject to uncertainties for the subsystem of kinematics and dynamics backstepping techniques and sliding mode control method are employed in the proposed controller respectively for the line of sight target tracking control of auvs in the presence of model uncertainties and perturbations shojaei and dolatshahi have designed the controller based on dynamic surface control neural networks and adaptive control techniques shojaei and dolatshahi 2017 yet the roll motion and hydrodynamic coupling effects caused by the off diagonal terms in the drag matrices are both neglected in these literature as a supplement there exists some other motion control for auvs in 3d space such as target tracking path following and formation control shojaei 2017 xiang et al 2017 qi 2015 qi and cai 2018 whereas among the aforementioned discussion there are few works relevant to internal coupling effects generated by the dynamics and heading control under the input saturation nonlinearity indeed prevention of saturation nonlinearity has been the concerns of many researchers karason and annaswamy 1994 ma et al 2015 zheng et al 2017 huang et al 2015 meanwhile it ought to be highlighted that the effect of input saturation should be taken into account to improve the system s performance during the controller design ma et al 2015 for instance input saturation constraint of rudder angle is considered in chu et al 2018 for the diving control of auv to be stabilized in the saturation region for a long time actuator saturation may cause the performance degradation or even instability in the closed loop system and thus this paper focus on the input saturation problem to incorporate practical considerations with respect to the capability of output torque generated from cmg systems in this paper 3d trajectory tracking control scheme is addressed for an underactuated auv using cmgs in the presence of internal disturbances and input saturation first based on the virtual control laws and an admissible error radius with an exponentially decline tendency error kinematics are converging to the neighborhood of origin when the error dynamics are stabilized second backstepping techniques are utilized to design the tracking controller meanwhile to deal with the input saturation problem of the cmg actuated auv anti windup compensators are employed to compensate the control input errors subsequently noting that control torque produced by the controller is the input signal of cmg systems in particular it should be pointed out that the singularity problem of the pyramid type cmg system always hinders its global and real time attitude control thornton et al 2007 kurokawa 1997 1998 hence constrained steering law is activated to accomplish the mission of trajectory tracking without introducing new torque errors and to avoid the singularity problem accordingly simulation results are presented to demonstrate the effectiveness and performance of the control strategy the contributions of this paper are as follows i to the best of author s knowledge this paper first investigates the tracking problem of the cmg based auv subject to input saturation in 3d space ii utilizing the error radius with exponentially decline trend in the kinematic layer tracking error signals of the closed loop cascade system are rendered to be uniformly ultimately bounded uub based on backstepping techniques iii roll motion control and effects of off diagonal terms in the inertia matrix are taken into consideration and numerical simulation validates the rationality of the proposed control strategy in the tracking mission the remainder of the paper is structured as follows mathematical models and problem formulation of 3d trajectory tracking for the cmg based auv are presented in section 2 in section 3 stability of the proposed control strategy is obtained on the basis of the lyapunov theory and backstepping procedure in section 4 numerical simulation studies are performed on the cmg based auv to evaluate its tracking and motion performance based on the designed controller finally conclusions of this paper are drawn in section 5 2 mathematical model and problem formulation in this part modelling of an cmg based auv is presented in 6 dofs and the trajectory tracking control problem is formulated 2 1 kinematic model fig 1 shows the motion of marine vehicles in 6 dofs including surge sway heave roll pitch and yaw directions b and e represent the body fixed and earth fixed reference frames respectively centers of gravity and buoyancy are assumed to be the same as the origin of the reference frame b in the frame e η 1 x y z t denotes the location of the auv and vector η 2 ϕ θ ψ t denotes its orientation υ 1 u v w t and υ 2 p q r t represent the vector of linear and angular velocities in the frame b respectively according to fossen 1994 the kinematic equations can be described as 1 η 1 j 1 η 2 υ 1 η 2 j 2 η 2 υ 2 where the transformation matrices j 1 η 2 and j 2 η 2 are expanded in the following forms 2 j 1 η 2 c ψ c θ c ψ s θ s ϕ s ψ c ϕ c ψ s θ c ϕ s ψ s ϕ s ψ c θ s ψ s θ s ϕ c ψ c ϕ s ψ s θ c ϕ c ψ s ϕ s θ c θ s ϕ c θ c ϕ j 2 η 2 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ where s sin c cos and t tan here because of the fact that matrix j 1 η 2 represents the rotation sequence of the body fixed frame with respect to earth fixed frame which implies that j 1 1 η 2 j 1 t η 2 notice that υ 2 denotes the angular velocity vector of the vehicle the following equality holds 3 j 1 η 2 s υ 2 j 1 η 2 0 where s υ 2 is a skew symmetric matrix which can be expressed as 4 s υ 2 0 r q r 0 p q p 0 2 2 pyramid type cmg system fig 2 depicts the pyramid type cmg system which will generate three axis attitude control torques for the auv in the configuration skew angle β is set as β cos 1 1 3 g i denotes the i th fixed gimbal axis with its rotational angle δ i for each gimbal unit and h i represents the initial momentum axis due to the limitation of its internal space four single gimbal cmgs are considered to form this configuration which has the minimal redundancy to control the attitude in three directions thornton et al 2007 assume that each gyro has the same magnitude of angular speed and inertia and correspondingly the whole angular momentum of this cmg system is calculated as follow kurokawa 1997 5 h j 0 c β s δ 1 c δ 2 c β s δ 3 c δ 4 c δ 1 c β s δ 2 c δ 3 c β s δ 4 s β s δ 1 s δ 2 s δ 3 s δ 4 where j 0 denotes the constant of nominal momentum magnitude for each cmg if the gimbal driving its gyro rotates with angular velocity δ direction of the angular momentum will change then the cmg system produces the gyroscopic moment τ c m g which can be written as 6 τ c m g h j 0 c δ δ where δ δ 1 δ 2 δ 3 δ 4 t c δ named as the jacobian matrix is expressed in the following form 7 c δ c β c δ 1 s δ 2 c β c δ 3 s δ 4 s δ 1 c β c δ 2 s δ 3 c β c δ 4 s β c δ 1 s β c δ 2 s β c δ 3 s β c δ 4 it can be deduced that actual input signals for the cmg system are gimbal rates however they may not be available because of the fact that the jacobian matrix c δ is time varying and may not be of full rank which will cause the singularity problem thereby singular value d d e t c δ c t δ is exploited to evaluate the performance of steering law for the cmg system d 0 indicates that the cmg system is at a singular state and it may not generate the expected torque d 0 means that the cmg system is working normally and it can produce the moment in three axis remark 1 for this type of cmg configuration it should be reminded that the singularity problem is inherent and inevitable in fact a cmg system with no less than six gyros would provide an adequately sized workspace and generate the desired torque with an appropriate steering logic tokar and platonov 1979 remark 2 constrained steering law proposed in kurokawa 1997 will be used to realize the global and real time trajectory tracking for the cmg based auv based on an algebraic constraint condition angular momentum space of the cmg system is limited with one third size of the original unconstrained system in the x and y direction while workspace of the z direction is preserved remark 3 from the practical perspective internal cmg systems using as the actuators for the auv will accomplish the task of attitude control in 3d space combined with its application performance in aerospace engineering and its actual control objective control input saturation is necessary to be considered in the tracking control strategy 2 3 dynamic model denote υ υ 1 t υ 2 t t and refer to thornton et al 2007 xu 2014 then dynamic equations of the cmg based auv in 6 dofs can be simplified as the following matrix form 8 m υ c υ υ d υ υ τ τ d i s where m is the whole inertia matrix of the cmg based auv including off diagonal terms c υ represents the matrix of coriolis and centripetal forces which is a skew symmetrical matrix d υ is the hydrodynamic damping matrix τ describes the internal disturbance generated from the cmg system and τ c m g τ p τ q τ r t represents its expected output torque denote τ u as the control force produced by propeller τ s a t τ d τ d τ u d 0 0 τ p d τ q d τ r d t denotes the expected control inputs which will be designed later from zhou et al 2017 ni et al 2018 the components of vector sat τ d s a t τ u d 0 0 s a t τ p d s a t τ q d s a t τ r d t can be presented as follows 9 s a t τ κ d s i g n τ κ d τ κ τ κ d τ κ τ κ d τ κ d τ κ where κ ξ u p q r s i g n denotes the standard sign function and τ κ is the known bound of τ κ d more specifically non zero components of the matrix m are given as m 11 m x u m 22 m y v m 33 m z w m 44 i x k p m 55 i y m q m 66 i z n r m 26 y r m 35 z q m 53 m w m 62 n v where m denotes the total mass x y z k m and n represent the hydrodynamic coefficients i x i y and iz denote the components of inertia of this vehicle denote h h x h y h z t and it will bring disturbances to the auv in 3d rotation motion that is τ d i s 0 1 3 h t s υ 2 t where 0 1 3 denotes the zero matrix with dimension 1 3 define f υ δ c υ υ d υ υ τ d i s and its six components are listed in turn as follows 10 f u x u u u u x q q q 2 x r r r 2 x v r m v r x w q m w q f v y v v v v y r r r r y u v u v y p q p q y u r m u r y w p m w p f w z w w w w z q q q q z u q m u q z v p m v p z r p r p z u w u w f p k p p p p i y y i z z q r q h z r h y f q m w w w w m q q q q m u q u q m v p v p m u w u w m r p i z z i x x r p r h x p h z f r n v v v v n r r r r n u r u r n u v u v n w p w p i x x i y y p q p h y q h x observed from the dynamics of the cmg based auv it s a coupling nonlinear control system subject to input saturation and internal disturbances also roll motion control and off diagonal terms of the inertia matrix are considered 2 4 problem formulation for a 3d smooth desired trajectory which is noted as η d x d y d z d t with the desired velocity υ d assume that there exists an admissible error in the longitudinal direction which means that the position error space defined as ρ ρ 0 0 t is fixed in the frame b therefore errors of the trajectory tracking and velocity control are described in the frame b as follows 11 z 1 e η ρ z 2 υ υ d where e η j 1 t η 2 η e e x e y e z t represents the position error in b η e η 1 η d x e y e z e t denotes the error in e as a consequence control objective of this paper is to design a tracking controller to stabilize position error signal z 1 and velocity error signal z 2 it can be found that the tracking errors form a cascade system by introducing the virtual control law meanwhile the control strategy needs to be considered in two steps first is the tracking controller for the whole closed loop system and second is the steering law for the pyramid type cmg system to produce precise and real time control torque satisfying the requirement of tracking mission 3 controller design for 3d trajectory tracking motivated by the methods proposed in li et al 2015 kurokawa 1997 ni et al 2018 the tracking controller for the cmg based auv will be introduced in this section as depicted in fig 3 the virtual control law is explored in the error kinematics to stabilize the position errors and generate the cascade subsystem anti windup compensator and constrained steering law are utilized to design the dynamic controller based on backstepping techniques and stability of the resulting closed loop control system is summarized 3 1 kinematic controller denote ν u q r t as the virtual control input and its desired value and error are defined as ν d u d q d r d t and ν e ν ν d u e q e r e t respectively differentiating the position error vector presented in 11 yields 12 z 1 j 1 t η 2 η e j 1 t η 2 η e ρ s υ 2 z 1 ρ υ 2 j 1 t η 2 η d ρ s υ 2 z 1 p ν e ν d ν j 1 t η 2 η d ρ where property of the transformation matrix j 1 η 2 shown in 3 is applied to deduce the above equation matrix p and vector ν are expressed as follows 13 p 1 0 0 0 0 ρ 0 ρ 0 ν 0 v w note that p is of full rank and time varying and then existence of the virtual control law will make sense in this condition desired value of the virtual control input ν is selected as 14 ν d p 1 k 1 z 1 ν j 1 t η 2 η d where k 1 is a symmetric positive definite matrix and then 12 reduces to 15 z 1 s υ 2 k 1 z 1 p ν e ρ if the lyapunov function candidate of the error kinematics is chosen as 16 v 1 1 2 z 1 t z 1 since that s υ 2 is a skew symmetric matrix one can obtain z t s υ 2 z 1 0 therefore the time derivative of v 1 can be written as 17 v 1 z 1 t k 1 z 1 z 1 t p ν e z 1 t ρ in order to alleviate effects of the admissible error in the longitudinal direction we assume that ρ r 1 r 2 exp t where r 1 r 2 are positive constants hence ρ goes down to zero with exponentially decline trend for this improved virtual kinematic controller and different from li et al 2015 it takes account of the fact that motion of an underactuated auv is a gradual process to execute the capability of control inputs when the facultative virtual velocity control law given in 14 is utilized to attain the goal of guidance meanwhile this modification will not affect the design of dynamic controller and it will be instrumental for dealing with the problem of input saturation the dynamic controller is inspired from borhaug and pettersen 2005 however considering the resulting position errors existing in the z 1 subsystem are not stabilized we will make a change 3 2 dynamic controller notice that control system of the cmg based auv is subject to input saturation and the control error between τ and τ d is defined as δ τ τ τ d with τ d τ u d 0 0 τ p d τ q d τ r d t and δ τ δ τ u 0 0 δ τ p δ τ q δ τ r t the desired velocity signal in 11 is defined to be υ d u d α 2 α 3 p d q d r d t where p d is the desired roll angular velocity and we assume it s zero that is p e p p d p α 2 and α 3 will be determined later hence taking the time derivative of velocity error in 11 combined with the dynamics yields 18 m z 2 f υ δ m υ d τ d δ τ based on the backstepping approach the desired control input signals are selected as follows 19 τ u d k 1 z 2 1 f u e 1 m υ d e x ρ τ p d k 4 z 2 4 f p e 4 m υ d τ q d k 5 z 2 5 f q e 5 m υ d ρ e z τ r d k 6 z 2 6 f r e 6 m υ d ρ e y where z 2 i denotes the i th component of vector z 2 e i is the i th row vector of six dimensional identity matrix i 6 and k i is a positive constant i 1 4 5 6 meanwhile α 2 and α 3 are selected by the method of adaptive i e 20 m 22 α 2 k 2 z 2 2 f v m 26 r d m 33 α 3 k 3 z 2 3 f w m 35 q d where k 2 and k 3 are positive parameters similar to ni et al 2018 the anti windup compensator is utilized to handle the issue of input saturation 21 ϖ κ λ κ ϖ κ μ κ s i g 1 2 ϖ κ κ e 2 δ τ κ 2 ϖ κ κ e 2 δ τ κ 2 γ κ 2 ϖ κ σ κ 0 ϖ κ σ κ where s i g 1 2 1 2 s i g n λ κ μ κ γ κ and σ κ are positive constants remark 4 in fact the defined anti windup compensator ϖ ϖ u ϖ p ϖ q ϖ r t is an auxiliary design system used to reduce effects of the input saturation only when ϖ κ σ κ the compensator is activated to compensate the input error δ τ κ 3 3 constrained steering law for the cmg system as mentioned above cmg systems are attitude control actuators in this vehicle hence control torque vector τ c m g designed in the controller of dynamics is the expected control output and the actual input is the gimbal rate for the cmg system based on constrained steering law proposed for the pyramid cmg configuration kurokawa 1997 this section will accomplish the whole design of the tracking controller assume that gimbal angles are satisfied by the following algebraic constraint 22 δ 1 δ 2 δ 3 δ 4 0 using vector φ φ 1 φ 2 φ 3 t to simplify the constraint condition and then the gimbal angle vector can be expressed in the form 23 δ φ 1 φ 2 φ 1 φ 3 φ 1 φ 2 φ 1 φ 3 t thus three independent parameters φ 1 φ 2 φ 3 make the pyramid type cmg system non redundant correspondingly angular momentum of the cmg system 5 is rewritten as 24 h j 0 s φ 1 s φ 3 c β c φ 1 s φ 2 s φ 1 s φ 2 c β c φ 1 s φ 3 s β s φ 1 c φ 2 c φ 3 the original jacobian matrix c δ in 7 turns to be 25 c c β s φ 1 s φ 2 c φ 2 s φ 3 c β c φ 1 c φ 2 s φ 1 c φ 3 c β s φ 1 s φ 3 c φ 1 s φ 2 s φ 1 c φ 2 c β c φ 1 c φ 3 s β c φ 1 c φ 2 c φ 3 s β s φ 1 s φ 2 s β s φ 1 s φ 3 therefore for the expected torque output τ c m g one can obtain the time derivative of vector φ 26 φ j 0 c 1 τ c m g however the constraint condition 22 may not be guaranteed in actual implementation in a finite sampling time values of the gimbal rate are derived from 6 and will not renew continuously kurokawa 1997 to deal with this problem null motion bedrossian et al 1990 which doesn t change the angular momentum and output moment are used to make it hold denote c i as the i th column vector of the original jacobian matrix and null motion vector δ n is be expressed in the form 27 δ n t c 2 c 3 c 4 c 3 c 4 c 1 c 4 c 1 c 2 c 1 c 2 c 3 where a b c represents the box product of the three vector a b and c then rate of the gimbal can be defined as 28 δ q φ k n δ n where the matrix q and k n are given as follows 29 q 1 1 0 1 0 1 1 1 0 1 0 1 30 k n l δ n δ n 2 δ 1 δ 2 δ 3 δ 4 where δ n δ n 1 δ n 2 δ n 3 δ n 4 denotes the 2 norm in euclid space and l is a feedback gain control parameter hence control inputs for the cmg system can be obtained from 28 and combined with its jacobian matrix in 7 we will get its actual torque output from 6 in addition it should be highlighted that all internal singularities are eliminated within the restricted workspace then the global steering solution for real time and exact torque output can be achieved 3 4 stability analysis based on the above analysis stability of the overall closed loop system is discussed in this section first lemma 1 is introduced to complete the proof lemma 1 wang and lin 2015 for any constant γ 0 and any real number κ the following inequality holds 31 0 κ κ 2 κ 2 γ 2 γ denote k 2 d i a g k 1 k 2 k 3 k 4 k 5 k 6 then by combining with 19 and 20 18 can be rewritten as 32 m z 2 k 2 z 2 δ τ ϱ where ϱ ρ e x 0 0 0 ρ e z ρ e y t thus combined with the virtual control law of error kinematics feedback controller of the error dynamics and steering law the whole tracking error system for the cmg based auv can be finally described in 15 and 32 and from the two equations we know the closed loop system is a simplified cascade system considering the bad situation namely there exists ϖ κ such that ϖ κ σ κ κ ξ when the control system is subject to input saturation the anti windup compensator will have an effect in this case the lyapunov function is defined as 33 v v 1 1 2 z 2 t m z 2 1 2 κ ξ ϖ κ 2 differentiating v along 19 20 21 and substituting 17 into its time derivative yield 34 v v 1 z 2 t m z 2 κ ξ ϖ κ ϖ κ z 1 t k 1 z 1 z 2 t k 2 z 2 z 1 t ρ κ ξ λ κ ϖ κ 2 μ κ ϖ κ 3 2 κ ξ κ e δ τ κ κ e 2 δ τ κ 2 κ e 2 δ τ κ 2 γ κ 2 z 1 t k 1 z 1 z 2 t k 2 z 2 κ ξ λ κ ϖ κ 2 κ ξ γ κ z 1 t ρ in fact based on lemma 1 the following inequality is used above 35 κ e δ τ κ κ e δ τ κ γ κ κ e 2 δ τ κ 2 κ e 2 δ τ κ 2 γ κ 2 to facilitate the stability analysis we consider that z 1 t ρ r 2 ρ e x exp t can be neglected because the feature of ρ make it converge to zero at an exponential rate and other variables are bounded in real situations matrix k 1 and k 2 are assumed to be k 1 σ 1 i 3 and k 2 σ 2 i 6 respectively σ 1 and σ 2 are positive design parameters denote the maximum eigenvalue of matrix m is λ m and we have 36 v 1 2 λ m z 1 t z 1 z 2 t z 2 κ ξ ϖ κ 2 thus 36 can be rewritten as 37 v σ v c where σ 2 λ m 1 σ 3 σ 3 m i n σ 1 σ 2 λ u λ p λ q λ r and c κ ξ γ κ by solving 37 we have 38 0 v t c σ v 0 c σ exp σ t t 0 from the above inequality we can deduce that v t is eventually bounded by max v 0 c σ hence all the error signals defined in 11 are uub moreover by adjusting the value of σ 3 the tracking errors can be made arbitrarily small now we consider the good situation i e ϖ κ σ κ and the compensators will not work then the lyapunov function candidate can be chosen as follow 39 v v 1 1 2 z 2 t m z 2 follow the above procedure and time derivative of 39 can be obtained as 40 v z 1 t k 1 z 1 z 2 t k 2 z 2 z 1 t ρ according to the definition of ρ we know that v 0 holds from a time t 0 therefore based on the discussion in the first case the error signals presented in 11 will exponentially converge to the neighborhood of the origin theorem 1 consider the kinematic and dynamic equations of the cmg based auv which are presented in 1 and 8 based on the controller shown in 14 19 20 the anti windup compensator in 21 and constrained steering law in 29 the tracking error signals in 11 can be guaranteed uniformly ultimately bounded uub in the presence of input saturation and the errors will converge to the origin at an exponential convergence rate when the system is not subject to input saturation proof of theorem 1 can be found in the controller design and stability analysis remark 5 since constrained steering law for the pyramid type cmg system can assure exact and real time attitude control the torque error between the desired moment and actual one is ignored in the stability analysis by contrast the numerical calculation errors will be shown in the simulation results 4 numerical simulations in this section numerical simulations are performed to validate the tracking performance of the cmg based auv based on the proposed controller hydrodynamic parameters of this vehicle are mainly from prestero 2001 and the modelling parameters are presented in table 1 in this simulation the initial position and orientation vector and velocity vector are chosen as η 0 5 5 0 0 0 0 t υ 0 0 r 6 respectively in order to track the expected trajectory namely a spiral line which is given by 41 x d 40 c o s 0 02 t y d 40 s i n 0 02 t z d 0 2 t the controller design parameters are set as r 1 0 1 r 2 10 σ 1 0 1 σ 2 12 l 1 λ κ 5 μ κ 5 γ κ 0 1 σ κ 0 1 where κ ξ the input saturation performed on this simulation is set to τ u 500 n and τ 50 nm where p q r as presented in fig 4 the cmg based auv has a good tracking performance in the presence of internal disturbances and input saturation nevertheless there exists a turn in the primary stage of tracking the reference trajectory also time response curves of position errors presented in fig 5 reflect this variation which is characterized by the fluctuation with small amplitude in the preliminary stage by noting the fact that this vehicle is underactuated in sway and heave directions the corresponding velocities limited by the unactuated dynamics will converge to a non zero constant which can be observed from fig 7 therefore based on the virtual velocity control generated from the error kinematics and definition of error radius to consider the active process in controller design with input saturation there may exist a turn in the initial tracking stage fig 6 presents the performance of velocities for tracking the designed virtual control input signals and fig 7 shows the performance of velocities in sway heave and roll directions although a minor change exists in the sway and roll motion in the primary stage the speeds will eventually converge to their own equilibrium points correspondingly fig 8 gives time response curves of velocity errors from the unactuated dynamics using constrained steering law for the cmg system this vehicle can realize the global and real time torque output in the 3d trajectory tracking as illustrated in fig 9 the singular value d is always positive which shows the pyramid type cmg system is working normally time response of angular momentum of the cmg system is presented in fig 10 which demonstrate the conclusion of remark 3 that is in the z direction the angular momentum space is preserved one third size of the space is limited while in the x and y direction nevertheless it can be found that there exists a second peak in figs 9 and 10 which are presented in the variables of the cmg system also the response curves of anti windup compensating error and numerical simulation error of the output torque show a second peak in figs 13 and 14 as a matter of fact though constrained steering logic is employed to realize the task of global trajectory tracking for this cmg based underwater vehicle numerical simulation errors are inescapable in the finite sampling time as shown in fig 14 however this transformation of the moment in the cmg system is neglected in the dynamic controller to indicate that the closed loop system has robustness against the torque error meanwhile the error will cause the variation of the index for evaluating a cmg system such as the singular value and the angular momentum gimbal rates shown in fig 11 illustrate that four single gimbal cmgs can generate the expected torque under an acceptable working condition fig 12 gives the time response curve of the control input signal and it manifests that the tracking control system is subject to input saturation in surge pitch and yaw directions from the above simulation results and analysis it can be summarized that the designed tracking controller can make errors of the position and velocity converge to the neighborhood of origin in less than 50s when the cmg based auv is subject to input saturation and internal disturbances evidently figures show that all signals are bounded and this vehicle has a good tracking performance with the usage of the proposed control strategy 5 conclusions in this paper trajectory tracking control for a cmg based auv is addressed in 3d space noting that the pyramid type cmg configuration is the attitude control system to provide the torque in three axis therefore motions of this vehicle in 6 dofs are discussed by dint of the virtual velocity control laws in kinematic layer position tracking errors are simplified within an admissible error space with a radius of the exponential convergence rate considering the coupling effects from off diagonal terms and cmg system backstepping techniques are exploited to design the dynamic controller for handling this issue together with the resulting error terms in the control layer of kinematics moreover anti windup compensator is employed to deal with the matter of input saturation and constrained steering law is used to guarantee the cmg system to generate the expected torque to realize the trajectory tracking the tracking error signals are demonstrated to be uub based on the lyapunov stability theory finally simulation results indicate that the tracking performance and effectiveness of this vehicle with the control scheme future work can consider 3d trajectory tracking and motion planning in the presence of external disturbances with the help of guidance law and neural networks acknowledgements this work is supported by the hust interdisciplinary innovation team project the fundamental research funds for the central universities no 2018kfyyxjj012 the second ship design and research institute of wuhan the national key research and development program of china no 2016yfc031700 and the natural science foundation of hubei province no 2016cfb305 ministry of science and technology of the people s republic of china and the innovation foundation of maritime defense technologies innovation center appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2018 12 069 
23009,this paper first investigates the trajectory tracking problem of an underactuated underwater vehicle based on control moment gyros cmgs in the three dimensional 3d space the controller designing process consists of three parts to form a transformed cascade nonlinear system subject to internal disturbances and input saturation by introducing virtual control laws to simplify the position error in kinematic layer and tracking errors can be guaranteed to converge to zero on condition that the error dynamics are stabilized moreover anti windup compensators are taken in order to deal with the problem of input saturation and backstepping methods are exploited to construct the dynamic controller to force the error signals converge to the neighborhood of origin furthermore note that attitude control torques generated by the proposed controller are actual control input for cmgs therefore constrained steering law is utilized to achieve the global tracking control finally numerical simulation studies are carried out to illustrate the effectiveness of the developed control framework keywords underactuated underwater vehicle trajectory tracking control moment gyros backstepping 1 introduction it seems verbose to mention the substantial value and prospects of cmgs in aerospace engineering in fact over the past several decades as the angular momentum exchange devices and attitude control actuators cmgs have been successfully applied in large space platforms and small agile satellites because of their large and precise output torque coon and irby 1976 charles et al 2012 by contrast reports of its application in the field of marine engineering are numbered thornton et al 2005 2007 2008 it should be emphasized that an autonomous underwater vehicle auv actuated by internal cmg system is free from relative fluid motion compared with thrusters and fans which means that its actuator performance is independent of external conditions whether in low or zero speed thornton et al 2007 as far as the class of hybrid auvs concerned internal actuators combined with propeller units can overcome the effects of strong ocean currents and shallow waters with great efficiency internal movable mass has been recommended as the actuators for remus auvs which shows its high maneuverability in heading control zhao and song 2012 li and su 2016 by comparison cmg systems can control three axis attitude of the auv even in a stationary state it s predictable that cmg actuated auvs have bright prospects when facing with more diverse underwater tasks and complex working environments such as observation and operation in a narrow space operation under the complex hydrological condition and attitude control with accuracy and speed in the military field however researches on the tracking control problem of an auv using cmgs are comparatively uncommon in comparison with studies of its attitude control performance actually inertial navigation sensor applied to the virtual submerged floating operational system vsfos which is introduced in zhang et al 2018 can be used to monitor its attitude change for providing instructions for the auv in the task of trajectory tracking auv must track the expected time varying position and velocity at a pre specified time instant as a result study of this control objective is necessary and significant for the cmg based auv to inspect its motion performance based on the previous research of planar trajectory tracking control for this vehicle xu et al 2018 this paper embarks on addressing the control problem of trajectory tracking in 3d space in the presence of internal singularities and input saturation in the literature about tracking control techniques for auvs there is no doubt that the way point tracking is the foundation of trajectory tracking for a class of underactuated mechanical systems with movement in six degree of freedom dof satisfying the developed dynamical constraints borhaug and pettersen have innovatively proposed a global k exponential tracking control strategy with cascaded approach borhaug and pettersen 2005 in the study of trajectory tracking control of underactuated auvs li et al have improved this method by introducing virtual control signals into the error kinematics within an admissible error radius of the longitudinal direction li et al 2015 nevertheless control input saturation and external disturbances are not considered to make the system globally uniformly exponentially stability to realize the finite time planar trajectory tracking adaptive neural network and sliding mode state observer are proposed by chu et al to formulate the tracking control law for a full actuated remotely operated vehicle rov chu et al 2017 many researchers have imposed different approaches for tracking control of full actuated auvs in 3d space sun et al 2014 wang et al 2015 gao et al 2015 however these controllers cannot be used in underactuated ones based on lyapunov s direct method and backstepping techniques rezazadegan et al 2015 have presented an adaptive controller for the trajectory tracking control of an underactuated auv in 6 dofs actuator saturation and parametric uncertainties are addressed by taken account of introducing virtual control laws and the hyperbolic tangent function though the control scheme is rather complicated with a simple dynamical model karkoub et al 2017 have proposed a hierarchical robust nonlinear hrn trajectory tracking controller for a 6 dof auv system subject to uncertainties for the subsystem of kinematics and dynamics backstepping techniques and sliding mode control method are employed in the proposed controller respectively for the line of sight target tracking control of auvs in the presence of model uncertainties and perturbations shojaei and dolatshahi have designed the controller based on dynamic surface control neural networks and adaptive control techniques shojaei and dolatshahi 2017 yet the roll motion and hydrodynamic coupling effects caused by the off diagonal terms in the drag matrices are both neglected in these literature as a supplement there exists some other motion control for auvs in 3d space such as target tracking path following and formation control shojaei 2017 xiang et al 2017 qi 2015 qi and cai 2018 whereas among the aforementioned discussion there are few works relevant to internal coupling effects generated by the dynamics and heading control under the input saturation nonlinearity indeed prevention of saturation nonlinearity has been the concerns of many researchers karason and annaswamy 1994 ma et al 2015 zheng et al 2017 huang et al 2015 meanwhile it ought to be highlighted that the effect of input saturation should be taken into account to improve the system s performance during the controller design ma et al 2015 for instance input saturation constraint of rudder angle is considered in chu et al 2018 for the diving control of auv to be stabilized in the saturation region for a long time actuator saturation may cause the performance degradation or even instability in the closed loop system and thus this paper focus on the input saturation problem to incorporate practical considerations with respect to the capability of output torque generated from cmg systems in this paper 3d trajectory tracking control scheme is addressed for an underactuated auv using cmgs in the presence of internal disturbances and input saturation first based on the virtual control laws and an admissible error radius with an exponentially decline tendency error kinematics are converging to the neighborhood of origin when the error dynamics are stabilized second backstepping techniques are utilized to design the tracking controller meanwhile to deal with the input saturation problem of the cmg actuated auv anti windup compensators are employed to compensate the control input errors subsequently noting that control torque produced by the controller is the input signal of cmg systems in particular it should be pointed out that the singularity problem of the pyramid type cmg system always hinders its global and real time attitude control thornton et al 2007 kurokawa 1997 1998 hence constrained steering law is activated to accomplish the mission of trajectory tracking without introducing new torque errors and to avoid the singularity problem accordingly simulation results are presented to demonstrate the effectiveness and performance of the control strategy the contributions of this paper are as follows i to the best of author s knowledge this paper first investigates the tracking problem of the cmg based auv subject to input saturation in 3d space ii utilizing the error radius with exponentially decline trend in the kinematic layer tracking error signals of the closed loop cascade system are rendered to be uniformly ultimately bounded uub based on backstepping techniques iii roll motion control and effects of off diagonal terms in the inertia matrix are taken into consideration and numerical simulation validates the rationality of the proposed control strategy in the tracking mission the remainder of the paper is structured as follows mathematical models and problem formulation of 3d trajectory tracking for the cmg based auv are presented in section 2 in section 3 stability of the proposed control strategy is obtained on the basis of the lyapunov theory and backstepping procedure in section 4 numerical simulation studies are performed on the cmg based auv to evaluate its tracking and motion performance based on the designed controller finally conclusions of this paper are drawn in section 5 2 mathematical model and problem formulation in this part modelling of an cmg based auv is presented in 6 dofs and the trajectory tracking control problem is formulated 2 1 kinematic model fig 1 shows the motion of marine vehicles in 6 dofs including surge sway heave roll pitch and yaw directions b and e represent the body fixed and earth fixed reference frames respectively centers of gravity and buoyancy are assumed to be the same as the origin of the reference frame b in the frame e η 1 x y z t denotes the location of the auv and vector η 2 ϕ θ ψ t denotes its orientation υ 1 u v w t and υ 2 p q r t represent the vector of linear and angular velocities in the frame b respectively according to fossen 1994 the kinematic equations can be described as 1 η 1 j 1 η 2 υ 1 η 2 j 2 η 2 υ 2 where the transformation matrices j 1 η 2 and j 2 η 2 are expanded in the following forms 2 j 1 η 2 c ψ c θ c ψ s θ s ϕ s ψ c ϕ c ψ s θ c ϕ s ψ s ϕ s ψ c θ s ψ s θ s ϕ c ψ c ϕ s ψ s θ c ϕ c ψ s ϕ s θ c θ s ϕ c θ c ϕ j 2 η 2 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ where s sin c cos and t tan here because of the fact that matrix j 1 η 2 represents the rotation sequence of the body fixed frame with respect to earth fixed frame which implies that j 1 1 η 2 j 1 t η 2 notice that υ 2 denotes the angular velocity vector of the vehicle the following equality holds 3 j 1 η 2 s υ 2 j 1 η 2 0 where s υ 2 is a skew symmetric matrix which can be expressed as 4 s υ 2 0 r q r 0 p q p 0 2 2 pyramid type cmg system fig 2 depicts the pyramid type cmg system which will generate three axis attitude control torques for the auv in the configuration skew angle β is set as β cos 1 1 3 g i denotes the i th fixed gimbal axis with its rotational angle δ i for each gimbal unit and h i represents the initial momentum axis due to the limitation of its internal space four single gimbal cmgs are considered to form this configuration which has the minimal redundancy to control the attitude in three directions thornton et al 2007 assume that each gyro has the same magnitude of angular speed and inertia and correspondingly the whole angular momentum of this cmg system is calculated as follow kurokawa 1997 5 h j 0 c β s δ 1 c δ 2 c β s δ 3 c δ 4 c δ 1 c β s δ 2 c δ 3 c β s δ 4 s β s δ 1 s δ 2 s δ 3 s δ 4 where j 0 denotes the constant of nominal momentum magnitude for each cmg if the gimbal driving its gyro rotates with angular velocity δ direction of the angular momentum will change then the cmg system produces the gyroscopic moment τ c m g which can be written as 6 τ c m g h j 0 c δ δ where δ δ 1 δ 2 δ 3 δ 4 t c δ named as the jacobian matrix is expressed in the following form 7 c δ c β c δ 1 s δ 2 c β c δ 3 s δ 4 s δ 1 c β c δ 2 s δ 3 c β c δ 4 s β c δ 1 s β c δ 2 s β c δ 3 s β c δ 4 it can be deduced that actual input signals for the cmg system are gimbal rates however they may not be available because of the fact that the jacobian matrix c δ is time varying and may not be of full rank which will cause the singularity problem thereby singular value d d e t c δ c t δ is exploited to evaluate the performance of steering law for the cmg system d 0 indicates that the cmg system is at a singular state and it may not generate the expected torque d 0 means that the cmg system is working normally and it can produce the moment in three axis remark 1 for this type of cmg configuration it should be reminded that the singularity problem is inherent and inevitable in fact a cmg system with no less than six gyros would provide an adequately sized workspace and generate the desired torque with an appropriate steering logic tokar and platonov 1979 remark 2 constrained steering law proposed in kurokawa 1997 will be used to realize the global and real time trajectory tracking for the cmg based auv based on an algebraic constraint condition angular momentum space of the cmg system is limited with one third size of the original unconstrained system in the x and y direction while workspace of the z direction is preserved remark 3 from the practical perspective internal cmg systems using as the actuators for the auv will accomplish the task of attitude control in 3d space combined with its application performance in aerospace engineering and its actual control objective control input saturation is necessary to be considered in the tracking control strategy 2 3 dynamic model denote υ υ 1 t υ 2 t t and refer to thornton et al 2007 xu 2014 then dynamic equations of the cmg based auv in 6 dofs can be simplified as the following matrix form 8 m υ c υ υ d υ υ τ τ d i s where m is the whole inertia matrix of the cmg based auv including off diagonal terms c υ represents the matrix of coriolis and centripetal forces which is a skew symmetrical matrix d υ is the hydrodynamic damping matrix τ describes the internal disturbance generated from the cmg system and τ c m g τ p τ q τ r t represents its expected output torque denote τ u as the control force produced by propeller τ s a t τ d τ d τ u d 0 0 τ p d τ q d τ r d t denotes the expected control inputs which will be designed later from zhou et al 2017 ni et al 2018 the components of vector sat τ d s a t τ u d 0 0 s a t τ p d s a t τ q d s a t τ r d t can be presented as follows 9 s a t τ κ d s i g n τ κ d τ κ τ κ d τ κ τ κ d τ κ d τ κ where κ ξ u p q r s i g n denotes the standard sign function and τ κ is the known bound of τ κ d more specifically non zero components of the matrix m are given as m 11 m x u m 22 m y v m 33 m z w m 44 i x k p m 55 i y m q m 66 i z n r m 26 y r m 35 z q m 53 m w m 62 n v where m denotes the total mass x y z k m and n represent the hydrodynamic coefficients i x i y and iz denote the components of inertia of this vehicle denote h h x h y h z t and it will bring disturbances to the auv in 3d rotation motion that is τ d i s 0 1 3 h t s υ 2 t where 0 1 3 denotes the zero matrix with dimension 1 3 define f υ δ c υ υ d υ υ τ d i s and its six components are listed in turn as follows 10 f u x u u u u x q q q 2 x r r r 2 x v r m v r x w q m w q f v y v v v v y r r r r y u v u v y p q p q y u r m u r y w p m w p f w z w w w w z q q q q z u q m u q z v p m v p z r p r p z u w u w f p k p p p p i y y i z z q r q h z r h y f q m w w w w m q q q q m u q u q m v p v p m u w u w m r p i z z i x x r p r h x p h z f r n v v v v n r r r r n u r u r n u v u v n w p w p i x x i y y p q p h y q h x observed from the dynamics of the cmg based auv it s a coupling nonlinear control system subject to input saturation and internal disturbances also roll motion control and off diagonal terms of the inertia matrix are considered 2 4 problem formulation for a 3d smooth desired trajectory which is noted as η d x d y d z d t with the desired velocity υ d assume that there exists an admissible error in the longitudinal direction which means that the position error space defined as ρ ρ 0 0 t is fixed in the frame b therefore errors of the trajectory tracking and velocity control are described in the frame b as follows 11 z 1 e η ρ z 2 υ υ d where e η j 1 t η 2 η e e x e y e z t represents the position error in b η e η 1 η d x e y e z e t denotes the error in e as a consequence control objective of this paper is to design a tracking controller to stabilize position error signal z 1 and velocity error signal z 2 it can be found that the tracking errors form a cascade system by introducing the virtual control law meanwhile the control strategy needs to be considered in two steps first is the tracking controller for the whole closed loop system and second is the steering law for the pyramid type cmg system to produce precise and real time control torque satisfying the requirement of tracking mission 3 controller design for 3d trajectory tracking motivated by the methods proposed in li et al 2015 kurokawa 1997 ni et al 2018 the tracking controller for the cmg based auv will be introduced in this section as depicted in fig 3 the virtual control law is explored in the error kinematics to stabilize the position errors and generate the cascade subsystem anti windup compensator and constrained steering law are utilized to design the dynamic controller based on backstepping techniques and stability of the resulting closed loop control system is summarized 3 1 kinematic controller denote ν u q r t as the virtual control input and its desired value and error are defined as ν d u d q d r d t and ν e ν ν d u e q e r e t respectively differentiating the position error vector presented in 11 yields 12 z 1 j 1 t η 2 η e j 1 t η 2 η e ρ s υ 2 z 1 ρ υ 2 j 1 t η 2 η d ρ s υ 2 z 1 p ν e ν d ν j 1 t η 2 η d ρ where property of the transformation matrix j 1 η 2 shown in 3 is applied to deduce the above equation matrix p and vector ν are expressed as follows 13 p 1 0 0 0 0 ρ 0 ρ 0 ν 0 v w note that p is of full rank and time varying and then existence of the virtual control law will make sense in this condition desired value of the virtual control input ν is selected as 14 ν d p 1 k 1 z 1 ν j 1 t η 2 η d where k 1 is a symmetric positive definite matrix and then 12 reduces to 15 z 1 s υ 2 k 1 z 1 p ν e ρ if the lyapunov function candidate of the error kinematics is chosen as 16 v 1 1 2 z 1 t z 1 since that s υ 2 is a skew symmetric matrix one can obtain z t s υ 2 z 1 0 therefore the time derivative of v 1 can be written as 17 v 1 z 1 t k 1 z 1 z 1 t p ν e z 1 t ρ in order to alleviate effects of the admissible error in the longitudinal direction we assume that ρ r 1 r 2 exp t where r 1 r 2 are positive constants hence ρ goes down to zero with exponentially decline trend for this improved virtual kinematic controller and different from li et al 2015 it takes account of the fact that motion of an underactuated auv is a gradual process to execute the capability of control inputs when the facultative virtual velocity control law given in 14 is utilized to attain the goal of guidance meanwhile this modification will not affect the design of dynamic controller and it will be instrumental for dealing with the problem of input saturation the dynamic controller is inspired from borhaug and pettersen 2005 however considering the resulting position errors existing in the z 1 subsystem are not stabilized we will make a change 3 2 dynamic controller notice that control system of the cmg based auv is subject to input saturation and the control error between τ and τ d is defined as δ τ τ τ d with τ d τ u d 0 0 τ p d τ q d τ r d t and δ τ δ τ u 0 0 δ τ p δ τ q δ τ r t the desired velocity signal in 11 is defined to be υ d u d α 2 α 3 p d q d r d t where p d is the desired roll angular velocity and we assume it s zero that is p e p p d p α 2 and α 3 will be determined later hence taking the time derivative of velocity error in 11 combined with the dynamics yields 18 m z 2 f υ δ m υ d τ d δ τ based on the backstepping approach the desired control input signals are selected as follows 19 τ u d k 1 z 2 1 f u e 1 m υ d e x ρ τ p d k 4 z 2 4 f p e 4 m υ d τ q d k 5 z 2 5 f q e 5 m υ d ρ e z τ r d k 6 z 2 6 f r e 6 m υ d ρ e y where z 2 i denotes the i th component of vector z 2 e i is the i th row vector of six dimensional identity matrix i 6 and k i is a positive constant i 1 4 5 6 meanwhile α 2 and α 3 are selected by the method of adaptive i e 20 m 22 α 2 k 2 z 2 2 f v m 26 r d m 33 α 3 k 3 z 2 3 f w m 35 q d where k 2 and k 3 are positive parameters similar to ni et al 2018 the anti windup compensator is utilized to handle the issue of input saturation 21 ϖ κ λ κ ϖ κ μ κ s i g 1 2 ϖ κ κ e 2 δ τ κ 2 ϖ κ κ e 2 δ τ κ 2 γ κ 2 ϖ κ σ κ 0 ϖ κ σ κ where s i g 1 2 1 2 s i g n λ κ μ κ γ κ and σ κ are positive constants remark 4 in fact the defined anti windup compensator ϖ ϖ u ϖ p ϖ q ϖ r t is an auxiliary design system used to reduce effects of the input saturation only when ϖ κ σ κ the compensator is activated to compensate the input error δ τ κ 3 3 constrained steering law for the cmg system as mentioned above cmg systems are attitude control actuators in this vehicle hence control torque vector τ c m g designed in the controller of dynamics is the expected control output and the actual input is the gimbal rate for the cmg system based on constrained steering law proposed for the pyramid cmg configuration kurokawa 1997 this section will accomplish the whole design of the tracking controller assume that gimbal angles are satisfied by the following algebraic constraint 22 δ 1 δ 2 δ 3 δ 4 0 using vector φ φ 1 φ 2 φ 3 t to simplify the constraint condition and then the gimbal angle vector can be expressed in the form 23 δ φ 1 φ 2 φ 1 φ 3 φ 1 φ 2 φ 1 φ 3 t thus three independent parameters φ 1 φ 2 φ 3 make the pyramid type cmg system non redundant correspondingly angular momentum of the cmg system 5 is rewritten as 24 h j 0 s φ 1 s φ 3 c β c φ 1 s φ 2 s φ 1 s φ 2 c β c φ 1 s φ 3 s β s φ 1 c φ 2 c φ 3 the original jacobian matrix c δ in 7 turns to be 25 c c β s φ 1 s φ 2 c φ 2 s φ 3 c β c φ 1 c φ 2 s φ 1 c φ 3 c β s φ 1 s φ 3 c φ 1 s φ 2 s φ 1 c φ 2 c β c φ 1 c φ 3 s β c φ 1 c φ 2 c φ 3 s β s φ 1 s φ 2 s β s φ 1 s φ 3 therefore for the expected torque output τ c m g one can obtain the time derivative of vector φ 26 φ j 0 c 1 τ c m g however the constraint condition 22 may not be guaranteed in actual implementation in a finite sampling time values of the gimbal rate are derived from 6 and will not renew continuously kurokawa 1997 to deal with this problem null motion bedrossian et al 1990 which doesn t change the angular momentum and output moment are used to make it hold denote c i as the i th column vector of the original jacobian matrix and null motion vector δ n is be expressed in the form 27 δ n t c 2 c 3 c 4 c 3 c 4 c 1 c 4 c 1 c 2 c 1 c 2 c 3 where a b c represents the box product of the three vector a b and c then rate of the gimbal can be defined as 28 δ q φ k n δ n where the matrix q and k n are given as follows 29 q 1 1 0 1 0 1 1 1 0 1 0 1 30 k n l δ n δ n 2 δ 1 δ 2 δ 3 δ 4 where δ n δ n 1 δ n 2 δ n 3 δ n 4 denotes the 2 norm in euclid space and l is a feedback gain control parameter hence control inputs for the cmg system can be obtained from 28 and combined with its jacobian matrix in 7 we will get its actual torque output from 6 in addition it should be highlighted that all internal singularities are eliminated within the restricted workspace then the global steering solution for real time and exact torque output can be achieved 3 4 stability analysis based on the above analysis stability of the overall closed loop system is discussed in this section first lemma 1 is introduced to complete the proof lemma 1 wang and lin 2015 for any constant γ 0 and any real number κ the following inequality holds 31 0 κ κ 2 κ 2 γ 2 γ denote k 2 d i a g k 1 k 2 k 3 k 4 k 5 k 6 then by combining with 19 and 20 18 can be rewritten as 32 m z 2 k 2 z 2 δ τ ϱ where ϱ ρ e x 0 0 0 ρ e z ρ e y t thus combined with the virtual control law of error kinematics feedback controller of the error dynamics and steering law the whole tracking error system for the cmg based auv can be finally described in 15 and 32 and from the two equations we know the closed loop system is a simplified cascade system considering the bad situation namely there exists ϖ κ such that ϖ κ σ κ κ ξ when the control system is subject to input saturation the anti windup compensator will have an effect in this case the lyapunov function is defined as 33 v v 1 1 2 z 2 t m z 2 1 2 κ ξ ϖ κ 2 differentiating v along 19 20 21 and substituting 17 into its time derivative yield 34 v v 1 z 2 t m z 2 κ ξ ϖ κ ϖ κ z 1 t k 1 z 1 z 2 t k 2 z 2 z 1 t ρ κ ξ λ κ ϖ κ 2 μ κ ϖ κ 3 2 κ ξ κ e δ τ κ κ e 2 δ τ κ 2 κ e 2 δ τ κ 2 γ κ 2 z 1 t k 1 z 1 z 2 t k 2 z 2 κ ξ λ κ ϖ κ 2 κ ξ γ κ z 1 t ρ in fact based on lemma 1 the following inequality is used above 35 κ e δ τ κ κ e δ τ κ γ κ κ e 2 δ τ κ 2 κ e 2 δ τ κ 2 γ κ 2 to facilitate the stability analysis we consider that z 1 t ρ r 2 ρ e x exp t can be neglected because the feature of ρ make it converge to zero at an exponential rate and other variables are bounded in real situations matrix k 1 and k 2 are assumed to be k 1 σ 1 i 3 and k 2 σ 2 i 6 respectively σ 1 and σ 2 are positive design parameters denote the maximum eigenvalue of matrix m is λ m and we have 36 v 1 2 λ m z 1 t z 1 z 2 t z 2 κ ξ ϖ κ 2 thus 36 can be rewritten as 37 v σ v c where σ 2 λ m 1 σ 3 σ 3 m i n σ 1 σ 2 λ u λ p λ q λ r and c κ ξ γ κ by solving 37 we have 38 0 v t c σ v 0 c σ exp σ t t 0 from the above inequality we can deduce that v t is eventually bounded by max v 0 c σ hence all the error signals defined in 11 are uub moreover by adjusting the value of σ 3 the tracking errors can be made arbitrarily small now we consider the good situation i e ϖ κ σ κ and the compensators will not work then the lyapunov function candidate can be chosen as follow 39 v v 1 1 2 z 2 t m z 2 follow the above procedure and time derivative of 39 can be obtained as 40 v z 1 t k 1 z 1 z 2 t k 2 z 2 z 1 t ρ according to the definition of ρ we know that v 0 holds from a time t 0 therefore based on the discussion in the first case the error signals presented in 11 will exponentially converge to the neighborhood of the origin theorem 1 consider the kinematic and dynamic equations of the cmg based auv which are presented in 1 and 8 based on the controller shown in 14 19 20 the anti windup compensator in 21 and constrained steering law in 29 the tracking error signals in 11 can be guaranteed uniformly ultimately bounded uub in the presence of input saturation and the errors will converge to the origin at an exponential convergence rate when the system is not subject to input saturation proof of theorem 1 can be found in the controller design and stability analysis remark 5 since constrained steering law for the pyramid type cmg system can assure exact and real time attitude control the torque error between the desired moment and actual one is ignored in the stability analysis by contrast the numerical calculation errors will be shown in the simulation results 4 numerical simulations in this section numerical simulations are performed to validate the tracking performance of the cmg based auv based on the proposed controller hydrodynamic parameters of this vehicle are mainly from prestero 2001 and the modelling parameters are presented in table 1 in this simulation the initial position and orientation vector and velocity vector are chosen as η 0 5 5 0 0 0 0 t υ 0 0 r 6 respectively in order to track the expected trajectory namely a spiral line which is given by 41 x d 40 c o s 0 02 t y d 40 s i n 0 02 t z d 0 2 t the controller design parameters are set as r 1 0 1 r 2 10 σ 1 0 1 σ 2 12 l 1 λ κ 5 μ κ 5 γ κ 0 1 σ κ 0 1 where κ ξ the input saturation performed on this simulation is set to τ u 500 n and τ 50 nm where p q r as presented in fig 4 the cmg based auv has a good tracking performance in the presence of internal disturbances and input saturation nevertheless there exists a turn in the primary stage of tracking the reference trajectory also time response curves of position errors presented in fig 5 reflect this variation which is characterized by the fluctuation with small amplitude in the preliminary stage by noting the fact that this vehicle is underactuated in sway and heave directions the corresponding velocities limited by the unactuated dynamics will converge to a non zero constant which can be observed from fig 7 therefore based on the virtual velocity control generated from the error kinematics and definition of error radius to consider the active process in controller design with input saturation there may exist a turn in the initial tracking stage fig 6 presents the performance of velocities for tracking the designed virtual control input signals and fig 7 shows the performance of velocities in sway heave and roll directions although a minor change exists in the sway and roll motion in the primary stage the speeds will eventually converge to their own equilibrium points correspondingly fig 8 gives time response curves of velocity errors from the unactuated dynamics using constrained steering law for the cmg system this vehicle can realize the global and real time torque output in the 3d trajectory tracking as illustrated in fig 9 the singular value d is always positive which shows the pyramid type cmg system is working normally time response of angular momentum of the cmg system is presented in fig 10 which demonstrate the conclusion of remark 3 that is in the z direction the angular momentum space is preserved one third size of the space is limited while in the x and y direction nevertheless it can be found that there exists a second peak in figs 9 and 10 which are presented in the variables of the cmg system also the response curves of anti windup compensating error and numerical simulation error of the output torque show a second peak in figs 13 and 14 as a matter of fact though constrained steering logic is employed to realize the task of global trajectory tracking for this cmg based underwater vehicle numerical simulation errors are inescapable in the finite sampling time as shown in fig 14 however this transformation of the moment in the cmg system is neglected in the dynamic controller to indicate that the closed loop system has robustness against the torque error meanwhile the error will cause the variation of the index for evaluating a cmg system such as the singular value and the angular momentum gimbal rates shown in fig 11 illustrate that four single gimbal cmgs can generate the expected torque under an acceptable working condition fig 12 gives the time response curve of the control input signal and it manifests that the tracking control system is subject to input saturation in surge pitch and yaw directions from the above simulation results and analysis it can be summarized that the designed tracking controller can make errors of the position and velocity converge to the neighborhood of origin in less than 50s when the cmg based auv is subject to input saturation and internal disturbances evidently figures show that all signals are bounded and this vehicle has a good tracking performance with the usage of the proposed control strategy 5 conclusions in this paper trajectory tracking control for a cmg based auv is addressed in 3d space noting that the pyramid type cmg configuration is the attitude control system to provide the torque in three axis therefore motions of this vehicle in 6 dofs are discussed by dint of the virtual velocity control laws in kinematic layer position tracking errors are simplified within an admissible error space with a radius of the exponential convergence rate considering the coupling effects from off diagonal terms and cmg system backstepping techniques are exploited to design the dynamic controller for handling this issue together with the resulting error terms in the control layer of kinematics moreover anti windup compensator is employed to deal with the matter of input saturation and constrained steering law is used to guarantee the cmg system to generate the expected torque to realize the trajectory tracking the tracking error signals are demonstrated to be uub based on the lyapunov stability theory finally simulation results indicate that the tracking performance and effectiveness of this vehicle with the control scheme future work can consider 3d trajectory tracking and motion planning in the presence of external disturbances with the help of guidance law and neural networks acknowledgements this work is supported by the hust interdisciplinary innovation team project the fundamental research funds for the central universities no 2018kfyyxjj012 the second ship design and research institute of wuhan the national key research and development program of china no 2016yfc031700 and the natural science foundation of hubei province no 2016cfb305 ministry of science and technology of the people s republic of china and the innovation foundation of maritime defense technologies innovation center appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2018 12 069 
