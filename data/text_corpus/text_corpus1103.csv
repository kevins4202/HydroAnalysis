index,text
5515,utilizing ground based measurements to obtain water budget components especially in large scale basins is challenging due to the limitation in the spatiotemporal availability of in situ data in this paper we propose a probabilistic framework for estimating water budgets in low runoff regions using remote sensing products by studying water budgets in the central basin of iran cbi over 8 years period 2009 2016 we investigate the locations and time scales at which the water budget calculated from satellite products provides most closure to this end we use precipitation from the tropical rainfall measuring mission trmm evapotranspiration from the water productivity open access portal wapor and terrestrial water storage change from the gravity recovery and climate experiment grace the results show better closure and consistency of water budget in the center and south east of the basin at seasonal and annual time scales due to the uncertainty initiated from different data sources as well as the mismatch between the spatiotemporal resolutions of various satellite products the validity of the results is examined through an innovative application of the first order reliability method form furthermore the reliability sensitivity analysis also reveals that the failure probability of water budge closure is chiefly dependent on the accuracy of evapotranspiration estimations than the other components involved in the water budget equation keywords remote sensing water budget central basin of iran reliability sensitivity analysis 1 introduction although water has been almost free for human use throughout the millennia it is no longer an abundant commodity as more parts of the world are struggling with water scarcity predictions witness that by 2025 1 7 billion people will live in water scarce locations while clean water supply will not be available to the two thirds of the world s population nations 2015 groundwater stores a vast amount of global freshwater resources accounting for 96 of unfrozen freshwater reserves shiklomanov and rodda 2003 lee et al 2018 estimated that 42 of irrigation water 36 of drinking water and 24 of industrial water worldwide are supplied from groundwater accordingly 20 of the aquifers globally have been overexploited in recent decades which has been exacerbated under drought conditions gleeson et al 2012 water consumption above its sustainable extraction limit has pushed the environment to the extreme leading to unforeseen outcomes such as subsidence intrusion of saline water and loss of environmental habitats gleeson et al 2012 asia is a large groundwater consumer i e 72 of its water needs due to intensive agricultural water demand and population growth in china bangladesh india pakistan and iran fao 2016 in iran for instance with most of the country having an arid and semi arid climate i e 90 relies on groundwater withdrawal due to limited surface water resources the total available water resources per capita has dropped by 65 in iran since 1960 sarraf et al 2005 which is expected to drop by a further 16 by 2025 recent investigations on 609 study areas across iran indicate that almost half of the country suffers high stress condition while groundwater levels have been falling at remarkably high rates hosseini et al 2019 the above pieces of evidence highlight that groundwater depletion has imposed a serious challenge for managing water resources across the globe requiring continuous monitoring as frequently and accurately as possible quantifying water budgets in a region is one reliable approach to determine the availability and assess the sustainability of water resources under the current imbalance between supply and demand however limited instrumentation and low quality ground based measurements impede a reliable closure of a water budget especially in large scale and less developed regions alternatively remote sensing has played a key role in providing data relevant to the physical processes controlling the water budget in the form of products individual quantities or aggregated estimates with varying degrees of spatial and temporal resolution at both global and regional scales mccabe et al 2008 in particular the grace products have been successfully utilized since 2003 to estimate changes in terrestrial water storage tws that includes ice snow surface water soil moisture and groundwater storages tapley et al 2004 chen et al 2009 for instance voss et al 2013 showed that freshwater sources have diminished by 143 6 km3 of water in the north central region of the middle east covering vast portions of tigris euphrates basin between 2003 and 2009 also forootan et al 2014 reported that water storage has been reduced by approximately 15 mm year between 2002 and 2011 across iran in this study we propose a remotely sensed based approach to estimate water budget elements in low runoff regions with limited climatologic and hydrometric data in particular the objectives of this study are to 1 investigate closure and consistency of the water budget using satellite products 2 explore the correlation between non closure and other water budget components to decipher the mutual causes and effects 3 find the most reliable time scale for water budget closure while leveraging remotely sensed products and 4 examine the sensitivity of the results to the uncertainty involved in each of the components closing the water budget to this end we use the satellite products of precipitation p evapotranspiration et and tws to estimate the spatial distribution of groundwater depletion in the central basin of iran cbi at monthly seasonal and annual time scales where there is a mismatch between the spatial and temporal resolutions of the aforementioned satellite products we propose and implement a novel application of the first order reliability method form to examine the failure probability of a limit state function lsf as a criterion to validate the reliability of the water budget closure form has been proved to be a simple and efficient tool for such purposes particularly in problems with small probabilities of failure lopez et al 2015 the rest of this paper is organized as follows in section 2 we describe the geographical location of the case study with an emphasis on the long term climatic condition and the availability of water resources against water consumption in section 3 we provide detailed information on the satellite products used to estimate the water budget components also details on the implementation of the form frameworks are represented section 4 presents the results of the water budget estimation and discusses their validity using the reliability metrics computed from the form method finally concluding remarks are summarized in section 5 2 case study iran is located in the southwest of asia 25 40 n and 44 64 e fig 1 with an area of more than 1 6 million km2 making it the second largest country in the middle east recognized by a semi arid and arid climate the average annual rainfall in iran is 250 mm ranging from 50 mm in the dry parts of the central basin to 2275 mm in the northern regions near the caspian sea which is considerably smaller than the global annual average rainfall of 830 mm fao 2009 a relatively small percentage of the country receives enough rainfall to allow unirrigated agriculture in other regions groundwater has been largely depleted over the past decades mainly for irrigation purposes analysis of groundwater consumption data separately from wells springs and qanats results not shown here indicates that total groundwater consumption volume constituted 30 of total precipitation in 2011 iwrmc 2011 fig 2 indicates that a remarkable portion of groundwater withdrawal i e 90 is used for agriculture as compared to industrial and drinking purposes iran encompasses six first order major basins fig 1 namely the 52 000 km2 lake urmia basin located in the northwest of iran the 424 000 km2 gulf of oman and persian gulf basin located in the south and west of iran the 825 000 km2 cbi located in the center of iran the 44 000 km2 kara kum or sarakhs basin located in the northeast of iran the 103 000 km2 lake hamoon basin located in the east of iran and the 175 000 km2 caspian sea khazar basin located in the north of iran in contrast to the gulf of oman and persian gulf basin which covers 25 and 50 of the country s area and renewable water resources respectively nations 2004 cbi encompasses more than 50 of the area and population of the country while containing only 28 of renewable water resources nations 2004 the cbi water budget in the 2010 2011 water year indicates that precipitation as the only input is approximately partitioned between evaporation and infiltration by 54 and 23 respectively iwrmc 2011 cbi shares boundaries with the zagros mountain range in the west and south as well as the alborz mountains range in the north fig 1 these chains of mountains form a rain shadow in the so called regions making the cbi very dry the central and southeast regions of cbi are mainly comprised of gypsum and limestone derived soils with high porosity causing high infiltration rates and the absence of permanent flows in this basin water withdrawn for agricultural purposes is mostly supplied by groundwater due to the very limited surface water resources in this basin 3 methods and data 3 1 water budget estimation in a simplified form water budget equation can be written as 1 δ s p e t where δs is the change in water storage l p is precipitation l et is evapotranspiration l this simplified equation holds if water transfer in the horizontal direction through runoff is relatively small rodell et al 2004 2011 under this assumption the right and left side eq 1 can be estimated utilizing ground measurements and satellite products depending on the availability of such data for each term in the water budget equation due to the lack of et and δs data and disqualified p data concerning the disperse distribution of gauging stations across the cbi remote sensing data are merely used for the objectives of this study 3 2 remote sensing data several satellite data sources are available for obtaining various components of the water budget equation mccabe et al 2008 for p these sources include gridded global rain gauge product supplied by the global precipitation climatology center gpcc and the climate anomaly monitoring system cams produced by national oceanic and atmospheric administration noaa these independent estimates are incorporated in the tropical rainfall measuring mission trmm multi satellite precipitation analysis tmpa 3b43 huffman et al 1997 2007 here we use tmpa 3b43 version 7 to retrieve data for p at 0 25 0 25 spatial resolution and monthly temporal resolution tmpa products have been validated in many places around the world such as greece feidas 2010 africa adeyewa and nakamura 2003 australia ebert et al 2007 fleming et al 2011 and iran katiraie boroujerdy et al 2013 javanmard et al 2010 for et estimates we use the water productivity openaccess portal wapor with 10 days and 250 m temporal and spatial resolution respectively wapor products aggregate all data relevant to agricultural water in near east and africa and have have been validated in some countries such as iran rahimpour et al 2018 we obtain δs from the grace data with 1 spatial and monthly temporal resolution which have been successfully applied in large scale hydrologic modeling awange et al 2009 van dijk et al 2011 rodell and famiglietti 2001 e g for monitoring groundwater fluctuations henry et al 2011 and to tracking soil moisture dynamics niu et al 2007 forootan et al 2017 the gravity recovery and climate experiment grace mission which has been active since 2002 has an important role in representing surface and sub surface physical processes related to water redistribution in the earth system e g kusche et al 2012 forootan et al 2014 the satellite products for tmpa 3b43 wapor and grace were used from december 2008 to january 2017 due to the availability of wapor evapotranspiration and grace data in this period the gap in the grace data in a given month was filled with the average value of the previous and the following months we obtain et data with 10 days temporal resolution and aggregate them into monthly seasonal and annual datasets resulting in 96 months 32 seasons and 8 years about p and δs we aggregate monthly data into seasonal and annual datasets fig 3 shows the procedure of convereting different temporal and spatial resolutions of water budget components together 3 3 water budget implementation at different time scales if a grid water storage thickness in a given month is denoted by m and m is the average thickness over the whole study period i e between january 2009 to december 2016 grace gives the difference between these two quantities g that is expressed as 2 g j m j m where the index j refers to a month number by subtracting g values of two consecutive months δs is obtained as 3 δ s j m j 1 m j g j 1 g j since g is not given at a definite time from one month to another p and et values in month j and j 1 are averaged and is expressed as 4 δ w j 1 2 p j p j 1 1 2 e t j e t j 1 the inconsistency between different remote sensing products water budget residual in terms of the mismatch between their spatiotemporal resolutions contributes to the uncertainty in the water budget closure as 5 δ it δ w it δ s it where i is a pixel number t is the tth month season year and n is the total number of months seasons years also possible considerable runoff during heavy rain events might impose errors in the water budget expressed as eq 1 to evaulate the bias in the water budget equation we estimate the relative residual of the water budget equation rit as 6 r it t 1 n δ it 1 n t 1 n p it 3 4 probabilistic assessment of the water budget closure 3 4 1 first order reliability method form in this approach a limit state function lsf is defined as the mathematical expression of a system state limit beyond which the criteria determining system reliability is no longer met abdelkhalak and bouchaïb 2013 in analogy to the water budget of a hydrologic system rij can be considered as the criterion to examine the reliability of the water budget closure by defining rij less than 30 as the state limit since the renewable water share of precipitation is 30 in cbi nations 2004 rij is considered to be maximum 30 as the state limit based on the assumption that lsf is continuous and first order differentiable form uses a linear approximation i e first order taylor expansion expressed as 7 g y l y g y m g y m t y y m where l y is the linearization of the lsf y y 1 y 2 y n is the vector of n variables defining the g function y m is the expansion point and g y is the first order gradient vector of g y in order to implement form none normally distributed variables should be transformed into standard normal variables madsen et al 2006 via e g the nataf transformation nataf 1962 to minimize the loss of accuracy lsf is expanded at a point which has the highest contribution to the probability of failure this is equivalent to finding a point on the transformed lsf with the shortest distance to the origin in the uncorrelated standard normal space shinozuka 1983 this point is called the design point or the most probable point that can be obtained by solving the following constrained optimization problem 8 y arg m i n y g y 0 various approaches have been developed during the past decades to solve the constrained optimization problem described in eq 8 the ihlrf zhang and der kiureghian 1997 is a state of the art method which can be used to obtain the point on the failure surface that is closest to the origin in this approach the design point is found by a generic search algorithm via the following iterative equation 9 y m 1 y m s m d m where m is the iteration number s is the step length and d is the direction of the search details on the method of determining dm and sm are described in sudret and der kiureghian 2002 and der kiureghian 2005 given y the reliability index β is computed as 10 β y and the failure probability of β is given by 11 p f φ β where φ is the cumulative probability distribution function of β fig 4 shows the general procedure of the form implementation 3 4 2 sensitivity measures of the reliability analysis the sensitivity analysis discussed here yields the sensitivity of the reliability analysis to the changes in the input random variables i e how sensitive g in eq 7 is with respect to the uncertainty involved in the p et and δs this analysis also determines the relative degree of influence on g of the above random variables which help understand how reliable each remote sensing product is for the estimation of water budget at the basin scale to this end importance vectors are employed to determine which variables should be modeled more accurately or are least effective on uncertainty in problems with a large number of stochastic variables this information helps to reduce the dimensions of the problem by disregarding the least effective variables one importance vector is the alpha vector α expressed as 12 α y y whose components indicate the relative contribution of each random variable to the total variance of the g function in eq 7 der kiureghian 2005 the positive and negative sign of each component recognize it as the load and resistance variable respectively a larger absolute magnitude of a component in α implies a largest interference in the failure probability of the g function in case the involving random variables of the g function are correlated another importance measure γ is computed as eq 13 to rank the random variables in the original space der kiureghian 2005 13 γ α t j y x d α t j y x d where j y x is the jacobian matrix and d is a matrix wherein the diagonal elements are equal to the standard deviation of the input random variables that is equivalent normal 4 results and discussions 4 1 estimation of water budget fig 5 depicts the spatial mapping of average annual p et δs and δ from january 2009 to december 2016 in the cbi p is seen to have a larger magnitude in the northern and western part of the cbi which appears to be similar to δ while et does not show a considerable spatial variation across the cbi the northern boundary as well as the western regions indicate higher et rates in comparison to the eastern and central parts the partitioning of p can be determined by the competition between available water and the available energy approximated by the potential evapotranspiration pet budyko 1958 fig 6 depicts the index et p and the index pet p based on long term 10 years average of pet p and et data which was obtained from available iwrmc data source online http wrbs wrm ir trmm and wapor remote sensing data respectively two points are noteworthy based on fig 6 to provide a reference condition for the cbi first pet p 1 shows very dry conditions in the cbi which it is indicated on the available energy greatly exceeds the amount required to evaporate the entire annual precipitation this evidence also illustrates which the assumption of negligible runoff in eq 1 the cbi is quite logical second fig 6 shows the major variations of pet p index across the cbi the index pet p is higher in central and eastern regions with low elevation see fig 1 and less precipitation see fig 5 since the temperature is too high for generating higher pet p conversely pet p is lower in western regions with more precipitation fig 7 shows the annual time series of p et δs and δ from 2009 to 2016 the mann kendall trend analysis at the 0 05 significance level shows no significant trend in any of the above time series three points are noteworthy here first the retrieved δs of 6 5 mm from grace in 2011 is in a close agreement with the results of former studies in this basin at the same year i e 6 1 mm iwrmc 2011 second the estimated δ at the same year from the water budget eq 5 shows an acceptable difference from precipitation data highlighting that the applied remote sensing products for the water budget components are accurate enough to close the water budget appropriately third the strong correlation between p and δ time series indicates a tight dependency of water budget closure on p also the ratio between δs and p does not significantly change over the whole study period pointing out that even in years with increased p as compared to other water years the same percentage of storage had taken place in the cbi which highlights uncontrolled management of water resources fig 5 shows δ in northern and western regions of the cbi is greater than that in the eastern and central regions we note that δ values are the byproducts of error integration of the three remote sensing products used in eq 1 to estimate the water budget it should be noted that it is not necessarily true that the three datasets are inconsistent and inappropriate for water budget studies for areas with large residuals because the non closure may be ascribed to runoff due to a large amount of rainfall in those areas fig 8 shows the spatial distribution of δ p in the cbi on the seasonal time scale it also shows that δ p in summer and spring is greater than compared to autumn and winter in fig 8 red pixels with a negative value have a significant difference in value with their adjacent pixels and indicate that these regions receive water from neighboring cells these pixels are assumed net water consumption regions which are generally the irrigated areas lakes and reservoirs fig 9 depicts differences in p and et δw at the annual time scale it shows regions with net water production δ w 0 and regions with net water consumption δ w 0 the pixels that produce water δ w 0 are discharge regions responsible for streamflow and groundwater recharge these regions are located on the north and western regions of cbi areas with sparse vegetation and low et also have higher p than et and are water producing areas 40 of the cbi comprise such areas 4 2 the relationship between residual and different water budget components to examine the relationship between residual and each water budget components we calculated each of these at monthly and seasonal and annual time scales across cbi fig 10 depicts the relationship between residual and p et and δs at the annual time scale table 1 represents the correlation coefficient between δ and other components at monthly and seasonal time scale results show the correlation coefficient between δ and p is higher than other components such as et and δs which is consistent with previous studies e g wang et al 2014 sheffield et al 2009 also the results reveal that the correlation coefficient of δ with p et and δs increase from monthly to annual time scales to find the best time scale at which the estimated water budget from applied satellite remote sensing provides most closure we investigated the relationship between δw and δs at monthly seasonal and annual time scales across cbi table 2 shows the correlation coefficient between δw and δs consequently the estimation of water budget using applied remote sensing data is more consistent and provides better closure in terms of correlation coefficient on seasonal and annual time scales however whilst technical results are more reliable on seasonal and annual time scales some of the water budget terms have high seasonal variations and this makes the annual time scale too long to be useful for water resources management therefore the results show the seasonal scale is better for decision making on water resources management which is analogues with pearson 2008 4 3 evaluating of uncertainty in water budget estimation a novel application of the first order reliability method form is implemented to investigate the lsf failure probability as a criterion to validate the reliability of the water budget closure in the water budget estimation of a hydrologic system rij can be considered as the criterion to examine the reliability of the water budget closure by defining rij less than the renewable water share of precipitation to this end the first order reliability method finds the reliability index β and failure probability p f of water budget closure results of the form implementation show that β and p f are 1 02035 and 0 153782 respectively since pf is low closure and consistency of water budget using applied remote sensing data is acceptable a sensitivity analysis is also implemented to measure the sensitivity of the reliability to changes in the input random variables and rank the importance order of the random variables of the water budget equation the results of sensitivity analysis implementation are given in table 3 the absolute magnitude of α importance vector shows that et and then p are the most important parameters that are most likely to interfere with the failure of the lsf in this study according to α importance vector et is considered as a resistance variable and p and δs are considered as load variables this means that increasing value of et will increase the reliability index and decrease the lsf failure probability although α is considered as a good importance vector for the random variables in the standard normal space it may not be an accurate importance measure for the random variables in the original space when a correlation between different random variables is exist therefore γ is employed to rank the importance of the random variables in the original space der kiureghian 2005 γ importance vector shows that et is the most important variable which influences greatly on the failure of the lsf see table 3 as a result accurate modeling of et increases the accuracy of water budget estimation 5 conclusions application of the satellite products for the water budget components estimation in the cbi gives a reasonable estimation of the maximum possible integrated error δ of the three commonly used satellite products p et δs since the uncertainty in satellite data sources as well as the mismatch in the spatiotemporal resolution and time steps of various satellite products may influence the accuracy of water budget estimation this assessment needs further verification with other methods therefore the closure and consistency of applied satellite products defining the simplified water budget equation were examined over the cbi using defining the mathematical expression of a system state limit beyond which the criteria determining system reliability is no longer met our results show that depending on the time scale as well as the hydro climatology patterns of large regions using only satellite products has the potential to close the water budget this has been better demonstrated in some regions of the cbi e g the central southern and eastern parts of the cbi having low latitude little annual rainfall 50 150 mm and high ratio of pet to p 30 as these conditions hold the assumption of negligible runoff in the water budget calculation although the coarse temporal and spatial resolution monthly and 1 makes the data less informative for water resources management in small regions the evaluation of consistency between the datasets using a novel and strong probabilistic framework e g form can give us useful information for the analysis of hydrologic variations and modeling validation using these satellite products at large scales since the application of form to validate is not limited to specific research fields it is implemented in all research fields by defining a suitable lsf this probabilistic method is particularly useful for cases where statistical information tends to be incomplete such as in some water budget components where only first and second statistical moments and marginal probability distributions are available or can be assumed with confidence it is also worthy to mention that limited instrumentation and low quality ground based measurements of climate input data impede a reliable result of a water budget estimation especially in large scale and less developed regions remote sensing technology as a cost effective tool aids in obtaining hydrological parameters therefore the application of remotely sensed datasets and proposing of a reliable method to validate our estimation due to their uncertainty is very valuable in large scale and less developed regions since considering remote sensing data particularly grace along with hydrological models shows a promising potential in assessing the water storage at large scale the assimilation of grace data into hydrological models e g w3ra van dijk and warren 2010 or parflow maxwell and miller 2005 for storage components estimation e g groundwater or soil moisture and implementing the reliability method e g form and sorm depending on lsf condition linear or non linear for validation purposes is strongly recommended credit authorship contribution statement samira sadat soltani data curation methodology formal analysis writing original draft behzad ataie ashtiani supervision conceptualization writing review editing mohammad danesh yazdi formal analysis writing review editing craig t simmons writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements behzad ataie ashtiani and mohammad danesh yazdi acknowledge supports from the research office of the sharif university of technology iran behzad ataie ashtiani also acknowledges supports from and the national centre for groundwater research and training australia 
5515,utilizing ground based measurements to obtain water budget components especially in large scale basins is challenging due to the limitation in the spatiotemporal availability of in situ data in this paper we propose a probabilistic framework for estimating water budgets in low runoff regions using remote sensing products by studying water budgets in the central basin of iran cbi over 8 years period 2009 2016 we investigate the locations and time scales at which the water budget calculated from satellite products provides most closure to this end we use precipitation from the tropical rainfall measuring mission trmm evapotranspiration from the water productivity open access portal wapor and terrestrial water storage change from the gravity recovery and climate experiment grace the results show better closure and consistency of water budget in the center and south east of the basin at seasonal and annual time scales due to the uncertainty initiated from different data sources as well as the mismatch between the spatiotemporal resolutions of various satellite products the validity of the results is examined through an innovative application of the first order reliability method form furthermore the reliability sensitivity analysis also reveals that the failure probability of water budge closure is chiefly dependent on the accuracy of evapotranspiration estimations than the other components involved in the water budget equation keywords remote sensing water budget central basin of iran reliability sensitivity analysis 1 introduction although water has been almost free for human use throughout the millennia it is no longer an abundant commodity as more parts of the world are struggling with water scarcity predictions witness that by 2025 1 7 billion people will live in water scarce locations while clean water supply will not be available to the two thirds of the world s population nations 2015 groundwater stores a vast amount of global freshwater resources accounting for 96 of unfrozen freshwater reserves shiklomanov and rodda 2003 lee et al 2018 estimated that 42 of irrigation water 36 of drinking water and 24 of industrial water worldwide are supplied from groundwater accordingly 20 of the aquifers globally have been overexploited in recent decades which has been exacerbated under drought conditions gleeson et al 2012 water consumption above its sustainable extraction limit has pushed the environment to the extreme leading to unforeseen outcomes such as subsidence intrusion of saline water and loss of environmental habitats gleeson et al 2012 asia is a large groundwater consumer i e 72 of its water needs due to intensive agricultural water demand and population growth in china bangladesh india pakistan and iran fao 2016 in iran for instance with most of the country having an arid and semi arid climate i e 90 relies on groundwater withdrawal due to limited surface water resources the total available water resources per capita has dropped by 65 in iran since 1960 sarraf et al 2005 which is expected to drop by a further 16 by 2025 recent investigations on 609 study areas across iran indicate that almost half of the country suffers high stress condition while groundwater levels have been falling at remarkably high rates hosseini et al 2019 the above pieces of evidence highlight that groundwater depletion has imposed a serious challenge for managing water resources across the globe requiring continuous monitoring as frequently and accurately as possible quantifying water budgets in a region is one reliable approach to determine the availability and assess the sustainability of water resources under the current imbalance between supply and demand however limited instrumentation and low quality ground based measurements impede a reliable closure of a water budget especially in large scale and less developed regions alternatively remote sensing has played a key role in providing data relevant to the physical processes controlling the water budget in the form of products individual quantities or aggregated estimates with varying degrees of spatial and temporal resolution at both global and regional scales mccabe et al 2008 in particular the grace products have been successfully utilized since 2003 to estimate changes in terrestrial water storage tws that includes ice snow surface water soil moisture and groundwater storages tapley et al 2004 chen et al 2009 for instance voss et al 2013 showed that freshwater sources have diminished by 143 6 km3 of water in the north central region of the middle east covering vast portions of tigris euphrates basin between 2003 and 2009 also forootan et al 2014 reported that water storage has been reduced by approximately 15 mm year between 2002 and 2011 across iran in this study we propose a remotely sensed based approach to estimate water budget elements in low runoff regions with limited climatologic and hydrometric data in particular the objectives of this study are to 1 investigate closure and consistency of the water budget using satellite products 2 explore the correlation between non closure and other water budget components to decipher the mutual causes and effects 3 find the most reliable time scale for water budget closure while leveraging remotely sensed products and 4 examine the sensitivity of the results to the uncertainty involved in each of the components closing the water budget to this end we use the satellite products of precipitation p evapotranspiration et and tws to estimate the spatial distribution of groundwater depletion in the central basin of iran cbi at monthly seasonal and annual time scales where there is a mismatch between the spatial and temporal resolutions of the aforementioned satellite products we propose and implement a novel application of the first order reliability method form to examine the failure probability of a limit state function lsf as a criterion to validate the reliability of the water budget closure form has been proved to be a simple and efficient tool for such purposes particularly in problems with small probabilities of failure lopez et al 2015 the rest of this paper is organized as follows in section 2 we describe the geographical location of the case study with an emphasis on the long term climatic condition and the availability of water resources against water consumption in section 3 we provide detailed information on the satellite products used to estimate the water budget components also details on the implementation of the form frameworks are represented section 4 presents the results of the water budget estimation and discusses their validity using the reliability metrics computed from the form method finally concluding remarks are summarized in section 5 2 case study iran is located in the southwest of asia 25 40 n and 44 64 e fig 1 with an area of more than 1 6 million km2 making it the second largest country in the middle east recognized by a semi arid and arid climate the average annual rainfall in iran is 250 mm ranging from 50 mm in the dry parts of the central basin to 2275 mm in the northern regions near the caspian sea which is considerably smaller than the global annual average rainfall of 830 mm fao 2009 a relatively small percentage of the country receives enough rainfall to allow unirrigated agriculture in other regions groundwater has been largely depleted over the past decades mainly for irrigation purposes analysis of groundwater consumption data separately from wells springs and qanats results not shown here indicates that total groundwater consumption volume constituted 30 of total precipitation in 2011 iwrmc 2011 fig 2 indicates that a remarkable portion of groundwater withdrawal i e 90 is used for agriculture as compared to industrial and drinking purposes iran encompasses six first order major basins fig 1 namely the 52 000 km2 lake urmia basin located in the northwest of iran the 424 000 km2 gulf of oman and persian gulf basin located in the south and west of iran the 825 000 km2 cbi located in the center of iran the 44 000 km2 kara kum or sarakhs basin located in the northeast of iran the 103 000 km2 lake hamoon basin located in the east of iran and the 175 000 km2 caspian sea khazar basin located in the north of iran in contrast to the gulf of oman and persian gulf basin which covers 25 and 50 of the country s area and renewable water resources respectively nations 2004 cbi encompasses more than 50 of the area and population of the country while containing only 28 of renewable water resources nations 2004 the cbi water budget in the 2010 2011 water year indicates that precipitation as the only input is approximately partitioned between evaporation and infiltration by 54 and 23 respectively iwrmc 2011 cbi shares boundaries with the zagros mountain range in the west and south as well as the alborz mountains range in the north fig 1 these chains of mountains form a rain shadow in the so called regions making the cbi very dry the central and southeast regions of cbi are mainly comprised of gypsum and limestone derived soils with high porosity causing high infiltration rates and the absence of permanent flows in this basin water withdrawn for agricultural purposes is mostly supplied by groundwater due to the very limited surface water resources in this basin 3 methods and data 3 1 water budget estimation in a simplified form water budget equation can be written as 1 δ s p e t where δs is the change in water storage l p is precipitation l et is evapotranspiration l this simplified equation holds if water transfer in the horizontal direction through runoff is relatively small rodell et al 2004 2011 under this assumption the right and left side eq 1 can be estimated utilizing ground measurements and satellite products depending on the availability of such data for each term in the water budget equation due to the lack of et and δs data and disqualified p data concerning the disperse distribution of gauging stations across the cbi remote sensing data are merely used for the objectives of this study 3 2 remote sensing data several satellite data sources are available for obtaining various components of the water budget equation mccabe et al 2008 for p these sources include gridded global rain gauge product supplied by the global precipitation climatology center gpcc and the climate anomaly monitoring system cams produced by national oceanic and atmospheric administration noaa these independent estimates are incorporated in the tropical rainfall measuring mission trmm multi satellite precipitation analysis tmpa 3b43 huffman et al 1997 2007 here we use tmpa 3b43 version 7 to retrieve data for p at 0 25 0 25 spatial resolution and monthly temporal resolution tmpa products have been validated in many places around the world such as greece feidas 2010 africa adeyewa and nakamura 2003 australia ebert et al 2007 fleming et al 2011 and iran katiraie boroujerdy et al 2013 javanmard et al 2010 for et estimates we use the water productivity openaccess portal wapor with 10 days and 250 m temporal and spatial resolution respectively wapor products aggregate all data relevant to agricultural water in near east and africa and have have been validated in some countries such as iran rahimpour et al 2018 we obtain δs from the grace data with 1 spatial and monthly temporal resolution which have been successfully applied in large scale hydrologic modeling awange et al 2009 van dijk et al 2011 rodell and famiglietti 2001 e g for monitoring groundwater fluctuations henry et al 2011 and to tracking soil moisture dynamics niu et al 2007 forootan et al 2017 the gravity recovery and climate experiment grace mission which has been active since 2002 has an important role in representing surface and sub surface physical processes related to water redistribution in the earth system e g kusche et al 2012 forootan et al 2014 the satellite products for tmpa 3b43 wapor and grace were used from december 2008 to january 2017 due to the availability of wapor evapotranspiration and grace data in this period the gap in the grace data in a given month was filled with the average value of the previous and the following months we obtain et data with 10 days temporal resolution and aggregate them into monthly seasonal and annual datasets resulting in 96 months 32 seasons and 8 years about p and δs we aggregate monthly data into seasonal and annual datasets fig 3 shows the procedure of convereting different temporal and spatial resolutions of water budget components together 3 3 water budget implementation at different time scales if a grid water storage thickness in a given month is denoted by m and m is the average thickness over the whole study period i e between january 2009 to december 2016 grace gives the difference between these two quantities g that is expressed as 2 g j m j m where the index j refers to a month number by subtracting g values of two consecutive months δs is obtained as 3 δ s j m j 1 m j g j 1 g j since g is not given at a definite time from one month to another p and et values in month j and j 1 are averaged and is expressed as 4 δ w j 1 2 p j p j 1 1 2 e t j e t j 1 the inconsistency between different remote sensing products water budget residual in terms of the mismatch between their spatiotemporal resolutions contributes to the uncertainty in the water budget closure as 5 δ it δ w it δ s it where i is a pixel number t is the tth month season year and n is the total number of months seasons years also possible considerable runoff during heavy rain events might impose errors in the water budget expressed as eq 1 to evaulate the bias in the water budget equation we estimate the relative residual of the water budget equation rit as 6 r it t 1 n δ it 1 n t 1 n p it 3 4 probabilistic assessment of the water budget closure 3 4 1 first order reliability method form in this approach a limit state function lsf is defined as the mathematical expression of a system state limit beyond which the criteria determining system reliability is no longer met abdelkhalak and bouchaïb 2013 in analogy to the water budget of a hydrologic system rij can be considered as the criterion to examine the reliability of the water budget closure by defining rij less than 30 as the state limit since the renewable water share of precipitation is 30 in cbi nations 2004 rij is considered to be maximum 30 as the state limit based on the assumption that lsf is continuous and first order differentiable form uses a linear approximation i e first order taylor expansion expressed as 7 g y l y g y m g y m t y y m where l y is the linearization of the lsf y y 1 y 2 y n is the vector of n variables defining the g function y m is the expansion point and g y is the first order gradient vector of g y in order to implement form none normally distributed variables should be transformed into standard normal variables madsen et al 2006 via e g the nataf transformation nataf 1962 to minimize the loss of accuracy lsf is expanded at a point which has the highest contribution to the probability of failure this is equivalent to finding a point on the transformed lsf with the shortest distance to the origin in the uncorrelated standard normal space shinozuka 1983 this point is called the design point or the most probable point that can be obtained by solving the following constrained optimization problem 8 y arg m i n y g y 0 various approaches have been developed during the past decades to solve the constrained optimization problem described in eq 8 the ihlrf zhang and der kiureghian 1997 is a state of the art method which can be used to obtain the point on the failure surface that is closest to the origin in this approach the design point is found by a generic search algorithm via the following iterative equation 9 y m 1 y m s m d m where m is the iteration number s is the step length and d is the direction of the search details on the method of determining dm and sm are described in sudret and der kiureghian 2002 and der kiureghian 2005 given y the reliability index β is computed as 10 β y and the failure probability of β is given by 11 p f φ β where φ is the cumulative probability distribution function of β fig 4 shows the general procedure of the form implementation 3 4 2 sensitivity measures of the reliability analysis the sensitivity analysis discussed here yields the sensitivity of the reliability analysis to the changes in the input random variables i e how sensitive g in eq 7 is with respect to the uncertainty involved in the p et and δs this analysis also determines the relative degree of influence on g of the above random variables which help understand how reliable each remote sensing product is for the estimation of water budget at the basin scale to this end importance vectors are employed to determine which variables should be modeled more accurately or are least effective on uncertainty in problems with a large number of stochastic variables this information helps to reduce the dimensions of the problem by disregarding the least effective variables one importance vector is the alpha vector α expressed as 12 α y y whose components indicate the relative contribution of each random variable to the total variance of the g function in eq 7 der kiureghian 2005 the positive and negative sign of each component recognize it as the load and resistance variable respectively a larger absolute magnitude of a component in α implies a largest interference in the failure probability of the g function in case the involving random variables of the g function are correlated another importance measure γ is computed as eq 13 to rank the random variables in the original space der kiureghian 2005 13 γ α t j y x d α t j y x d where j y x is the jacobian matrix and d is a matrix wherein the diagonal elements are equal to the standard deviation of the input random variables that is equivalent normal 4 results and discussions 4 1 estimation of water budget fig 5 depicts the spatial mapping of average annual p et δs and δ from january 2009 to december 2016 in the cbi p is seen to have a larger magnitude in the northern and western part of the cbi which appears to be similar to δ while et does not show a considerable spatial variation across the cbi the northern boundary as well as the western regions indicate higher et rates in comparison to the eastern and central parts the partitioning of p can be determined by the competition between available water and the available energy approximated by the potential evapotranspiration pet budyko 1958 fig 6 depicts the index et p and the index pet p based on long term 10 years average of pet p and et data which was obtained from available iwrmc data source online http wrbs wrm ir trmm and wapor remote sensing data respectively two points are noteworthy based on fig 6 to provide a reference condition for the cbi first pet p 1 shows very dry conditions in the cbi which it is indicated on the available energy greatly exceeds the amount required to evaporate the entire annual precipitation this evidence also illustrates which the assumption of negligible runoff in eq 1 the cbi is quite logical second fig 6 shows the major variations of pet p index across the cbi the index pet p is higher in central and eastern regions with low elevation see fig 1 and less precipitation see fig 5 since the temperature is too high for generating higher pet p conversely pet p is lower in western regions with more precipitation fig 7 shows the annual time series of p et δs and δ from 2009 to 2016 the mann kendall trend analysis at the 0 05 significance level shows no significant trend in any of the above time series three points are noteworthy here first the retrieved δs of 6 5 mm from grace in 2011 is in a close agreement with the results of former studies in this basin at the same year i e 6 1 mm iwrmc 2011 second the estimated δ at the same year from the water budget eq 5 shows an acceptable difference from precipitation data highlighting that the applied remote sensing products for the water budget components are accurate enough to close the water budget appropriately third the strong correlation between p and δ time series indicates a tight dependency of water budget closure on p also the ratio between δs and p does not significantly change over the whole study period pointing out that even in years with increased p as compared to other water years the same percentage of storage had taken place in the cbi which highlights uncontrolled management of water resources fig 5 shows δ in northern and western regions of the cbi is greater than that in the eastern and central regions we note that δ values are the byproducts of error integration of the three remote sensing products used in eq 1 to estimate the water budget it should be noted that it is not necessarily true that the three datasets are inconsistent and inappropriate for water budget studies for areas with large residuals because the non closure may be ascribed to runoff due to a large amount of rainfall in those areas fig 8 shows the spatial distribution of δ p in the cbi on the seasonal time scale it also shows that δ p in summer and spring is greater than compared to autumn and winter in fig 8 red pixels with a negative value have a significant difference in value with their adjacent pixels and indicate that these regions receive water from neighboring cells these pixels are assumed net water consumption regions which are generally the irrigated areas lakes and reservoirs fig 9 depicts differences in p and et δw at the annual time scale it shows regions with net water production δ w 0 and regions with net water consumption δ w 0 the pixels that produce water δ w 0 are discharge regions responsible for streamflow and groundwater recharge these regions are located on the north and western regions of cbi areas with sparse vegetation and low et also have higher p than et and are water producing areas 40 of the cbi comprise such areas 4 2 the relationship between residual and different water budget components to examine the relationship between residual and each water budget components we calculated each of these at monthly and seasonal and annual time scales across cbi fig 10 depicts the relationship between residual and p et and δs at the annual time scale table 1 represents the correlation coefficient between δ and other components at monthly and seasonal time scale results show the correlation coefficient between δ and p is higher than other components such as et and δs which is consistent with previous studies e g wang et al 2014 sheffield et al 2009 also the results reveal that the correlation coefficient of δ with p et and δs increase from monthly to annual time scales to find the best time scale at which the estimated water budget from applied satellite remote sensing provides most closure we investigated the relationship between δw and δs at monthly seasonal and annual time scales across cbi table 2 shows the correlation coefficient between δw and δs consequently the estimation of water budget using applied remote sensing data is more consistent and provides better closure in terms of correlation coefficient on seasonal and annual time scales however whilst technical results are more reliable on seasonal and annual time scales some of the water budget terms have high seasonal variations and this makes the annual time scale too long to be useful for water resources management therefore the results show the seasonal scale is better for decision making on water resources management which is analogues with pearson 2008 4 3 evaluating of uncertainty in water budget estimation a novel application of the first order reliability method form is implemented to investigate the lsf failure probability as a criterion to validate the reliability of the water budget closure in the water budget estimation of a hydrologic system rij can be considered as the criterion to examine the reliability of the water budget closure by defining rij less than the renewable water share of precipitation to this end the first order reliability method finds the reliability index β and failure probability p f of water budget closure results of the form implementation show that β and p f are 1 02035 and 0 153782 respectively since pf is low closure and consistency of water budget using applied remote sensing data is acceptable a sensitivity analysis is also implemented to measure the sensitivity of the reliability to changes in the input random variables and rank the importance order of the random variables of the water budget equation the results of sensitivity analysis implementation are given in table 3 the absolute magnitude of α importance vector shows that et and then p are the most important parameters that are most likely to interfere with the failure of the lsf in this study according to α importance vector et is considered as a resistance variable and p and δs are considered as load variables this means that increasing value of et will increase the reliability index and decrease the lsf failure probability although α is considered as a good importance vector for the random variables in the standard normal space it may not be an accurate importance measure for the random variables in the original space when a correlation between different random variables is exist therefore γ is employed to rank the importance of the random variables in the original space der kiureghian 2005 γ importance vector shows that et is the most important variable which influences greatly on the failure of the lsf see table 3 as a result accurate modeling of et increases the accuracy of water budget estimation 5 conclusions application of the satellite products for the water budget components estimation in the cbi gives a reasonable estimation of the maximum possible integrated error δ of the three commonly used satellite products p et δs since the uncertainty in satellite data sources as well as the mismatch in the spatiotemporal resolution and time steps of various satellite products may influence the accuracy of water budget estimation this assessment needs further verification with other methods therefore the closure and consistency of applied satellite products defining the simplified water budget equation were examined over the cbi using defining the mathematical expression of a system state limit beyond which the criteria determining system reliability is no longer met our results show that depending on the time scale as well as the hydro climatology patterns of large regions using only satellite products has the potential to close the water budget this has been better demonstrated in some regions of the cbi e g the central southern and eastern parts of the cbi having low latitude little annual rainfall 50 150 mm and high ratio of pet to p 30 as these conditions hold the assumption of negligible runoff in the water budget calculation although the coarse temporal and spatial resolution monthly and 1 makes the data less informative for water resources management in small regions the evaluation of consistency between the datasets using a novel and strong probabilistic framework e g form can give us useful information for the analysis of hydrologic variations and modeling validation using these satellite products at large scales since the application of form to validate is not limited to specific research fields it is implemented in all research fields by defining a suitable lsf this probabilistic method is particularly useful for cases where statistical information tends to be incomplete such as in some water budget components where only first and second statistical moments and marginal probability distributions are available or can be assumed with confidence it is also worthy to mention that limited instrumentation and low quality ground based measurements of climate input data impede a reliable result of a water budget estimation especially in large scale and less developed regions remote sensing technology as a cost effective tool aids in obtaining hydrological parameters therefore the application of remotely sensed datasets and proposing of a reliable method to validate our estimation due to their uncertainty is very valuable in large scale and less developed regions since considering remote sensing data particularly grace along with hydrological models shows a promising potential in assessing the water storage at large scale the assimilation of grace data into hydrological models e g w3ra van dijk and warren 2010 or parflow maxwell and miller 2005 for storage components estimation e g groundwater or soil moisture and implementing the reliability method e g form and sorm depending on lsf condition linear or non linear for validation purposes is strongly recommended credit authorship contribution statement samira sadat soltani data curation methodology formal analysis writing original draft behzad ataie ashtiani supervision conceptualization writing review editing mohammad danesh yazdi formal analysis writing review editing craig t simmons writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements behzad ataie ashtiani and mohammad danesh yazdi acknowledge supports from the research office of the sharif university of technology iran behzad ataie ashtiani also acknowledges supports from and the national centre for groundwater research and training australia 
5516,wedge shaped aquifers are sometimes cut by crossing streams so that the areal geometry can be delineated by an annular wedge of infinite radial extent despite their worldwide spread the problem of groundwater flow in such geometrical entities has not received much attention in analytical studies this paper presents a closed form analytical solution for the aquifer head distribution in response to a system of multiwells superimposed on a background regional flow the aquifer is isotropic homogeneous and in prefect hydraulic connection with the surrounding streams a steady state green s function is constructed for this laterally bounded aquifer system the formulation is general in the sense that the aquifer vertex angle as well as number of wells and their positions can be arbitrary chosen closed form expression for the stream function is obtained by integration of the cauchy riemann equations three types of hydrogeological boundary conditions are considered combining streams of constant and linearly varying head and no flow barrier the results are applicable to both confined and unconfined flows extremely simple expressions are derived to quantify the amount of water exchange across stream aquifer interfaces flow nets are given for a number of hypothetical test cases demonstrating different aspects of the generated flow field sensitivity maps are prepared for the stream depletion rates due to a single pumping well and the role of aquifer vertex angle on the model response is investigated multiple stagnation points in the flow field are identified on a semi analytical basis this helps to assess how the position of a single stagnation point is affected by changes in the gradient of regional flow for relatively high gradients it is observed that the radial position of the stagnation point coincides with that of the well itself finally the formulation is extended to account for rainfall recharge over an unconfined aquifer having the same areal extent the aquifer response is found to agree well with other analytical and numerical results keywords multiwells regional flow stream depletion rate stream function stagnation point green s function 1 introduction multiple river basins often draw irregularly shaped aquifers between intersecting streams lakes and alluvial fans the flow topology is affected not only by the aquifer geometry but also by the way that the components of stream aquifer system are interconnected such geometrical entities are diverse worldwide the mekong and red river deltas asadi aghbolaghi and seyyedian 2010 mahdavi and seyyedian 2013 the trapezoidal region formed by intersection of karun and bahmanshir rivers north west of persian gulf iran mahdavi and seyyedian 2014 the u shaped aquifer bounded by three water land boundaries linyuan district taiwan huang et al 2015 the wedge shaped beach promontory near bol croatia kacimov et al 2016 and the l shaped aquifer formed by poonggye stream and bedrock outcrops gyeonggi do korea kihm et al 2007 lin et al 2018 the tendency of stream aquifer system to maintain ecological equilibrium may be disrupted by human activities for example by urbanization with groundwater being increasingly considered a source of potable water besides extraction injection systems implemented for groundwater clean up locally disturb the pattern of background regional flow across the aquifer groundwater pumping suffers from cumulative and irreversible impacts whereas excessive groundwater recharge may cause water logging if pumping continues long enough the cone of depression may intersect lateral boundaries of the aquifer and pattern of stream depletion rates is drastically altered when steady state is reached depletion of adjacent streams becomes the only source to supply the pumped water these illustrate the invalidity of assuming an infinite extent aquifer as it neglects water exchange across interfaces with adjacent water bodies moreover mutual interaction of multiwells and regional flow should be taken into account in groundwater budget all depending upon the boundary type and its orientation among the other mechanisms complexities inherent in hydrogeological processes are often addressed numerically by finite deference and finite element methods these appear to be computationally expensive in dealing with realistic conditions and require comprehensive databases to attain reliable predictions zlotnik and tartakovsky 2008 alternatively analytical or semi analytical techniques can be preferred over numerical counterparts due to ease of implementation and less data requirements such solutions have been extensively developed for intended boundary value problems bvps under various types of hydrogeological boundary conditions reflecting zero drawdown streams impervious barriers and tidal head fluctuations among others yeh and chang 2006 huang et al 2015 the method of green s function is an example which can efficiently reproduce the aquifer response to extraction injection wells mahdavi 2019a and accounting for localized or regional recharge events is straightforward mahdavi 2015 semi analytical solution strategies are widely available for groundwater flow problems and some illustrative examples include the analytic element method strack 2003 and adomian s decomposition method patel and serrano 2011 for irregularly shaped heterogeneous aquifer with multiple straight or curved boundaries the variational method of kantorovich for trapezoidal and triangular shaped anisotropic aquifers subject to diffusive recharge of rainfall mahdavi and seyyedian 2014 grid free series solution for geometrically complex stratified aquifers interacting with streams or lakes ameli and craig 2014 the method of image wells for aquifer with a meandering stream huang and yeh 2015 laplace hankel transforms for unconfined fractured and leaky wedge shaped aquifer system sedghi and zhan 2018 fourier laplace transforms for l shaped domains composed of two rectangular subregions lin et al 2018 multi zone wedge shaped domains samani and sedghi 2015 and infinite aquifer domains overlying fractured bedrock sedghi and zhan 2019 in most cases laplace domain head distributions are obtained analytically and inverted by a numerical algorithm hence the name semi analytical relatively few analytical studies have been devoted to non rectangular aquifer domains for bvps associated with triangular shaped aquifers green s functions can be obtained by repeating the image wells infinitely to fill entire 2d space all arranged in square shaped mahdavi and seyyedian 2013 or honey comb lattices mahdavi 2019b the boundary conditions determine the type of image wells extraction or injection operating in each lattice for wedge shaped aquifer domains formed by intersection of two linear streams the method of image wells samani and zarei doudeji 2012 and finite fourier hankel transforms yeh and chang 2006 are well suited the former benefits from simple mathematical structure but the applicability is restricted to certain values of wedge angles conversely the latter allows for arbitrary angles but evaluating infinite series of bessel functions requires substantial effort and convergence accelerating techniques such as shanks method are inevitable when a stream crosses the wedge shaped aquifer the geometry formed by intersection of borderlines can roughly resemble an annular wedge this can be observed in various regions of the world and fig 1 shows an example ideally the lateral extent of the aquifer is bounded by finite arc of the crossing stream in one side and by straight streams in other two sides fig 2 this study aims to derive closed form analytical expressions for potential and stream function in such hydrogeological settings combined effects of multiwells and background regional flow are addressed under steady state condition first a closed form green s function is constructed for the associated bvp allowing for annular wedge of arbitrary vertex angle penetrated by wells of different extraction injection rates the resulting expressions are easy to compute and free from infinite series it is to be noted that the analysis of groundwater flow in annular wedges has not been received much attention in analytical studies in the wedge with no inner arc called wedge shaped aquifer chan et al 1978 obtained a series representation for both the transient and steady state drawdown distributions in finite domains as well as in infinite domains but in the finite wedge with inner arc called annular wedge shaped aquifer only steady state drawdown distributions were first solved by chan et al 1978 thanks to its simple structure the present solution is found to be more accurate and computationally efficient than that of chan et al 1978 which require high order partial sums to attain reasonable results except for samani and zarei doudeji 2012 none of the references cited above have reported stream function for the wedge shaped aquifers and only potential fields were accounted for in the present framework the stream function immediately follows from integration of the cauchy riemann equations and streamlines are simply its contour lines by comparing with samani and zarei doudeji 2012 the stream lines calculated by both methods appear to be indistinguishable from each other next hypothetical test cases are presented to assess different aspects of groundwater flow in such geometrical entities finally interaction of a single pumping well with uniform rainfall recharge is analyzed and the aquifer response is tested against its numerical counterpart from adaptive finite element method 2 mathematical model 2 1 potential field some simplifying assumptions are made in the development of mathematical formulation i the flow of groundwater is essentially two dimensional in the horizontal plane ii the aquifer is isotropic homogenous and of constant transmissivity t and hydraulic conductivity k iii the intersection of three fully penetrating streams delineates an annular wedge shaped domain for the aquifer that extends to infinity along radial direction fig 2 iv the aquifer is fully penetrated by a set of n arbitrarily located multiwells each of which having infinitesimal radius and constant injection rejection rate and v the well flow is superimposed on a background regional flow whose intensity is proportional to the potential difference in the surrounding streams adopting polar coordinates r θ the potential field φ in this stream aquifer system is governed by 1 2 φ i 1 n q i r δ r r 0 i δ θ θ 0 i where the laplacian is defined by 2 φ 1 r r r φ r 1 r 2 2 φ θ 2 eq 1 can be switched to either confined or unconfined flows by defining the state variable as φ t h or φ k h 2 2 respectively with h h r θ being the hydraulic head the dirac delta functions δ appearing on the right hand side of 1 indicate local mass exchange at the well positions r 0 i θ 0 i with the well discharges q i being positive for pumping and negative for injection if there is only a single well n 1 its position and discharge are denoted respectively by r 0 θ 0 and q for notational convenience for mathematical well posedness of bvp the boundary conditions are defined in terms of potential reflecting the physical reality as follows 2 φ r 0 φ 1 s t r e a m s 1 φ r ϕ φ 2 s t r e a m s 2 φ a θ φ 1 φ 2 φ 1 θ ϕ s t r e a m s 3 the first two conditions in 2 imply streams of constant potential while the last corresponds to linearly varying potential along the stream bank lin et al 2018 no flow condition is imposed at large distances from the well system implying remote boundary condition in the limit when r approaches infinity huang et al 2015 3 lim r φ r 0 a closed form solution to the above bvp is obtained relying on the technique of green s function in conjunction with the principle of superposition detailed derivation is given in appendix a and the result may be written in compact form as 4 φ r θ φ 1 φ 2 φ 1 θ ϕ i 1 n q i 4 π l n w η i w λ i w λ i w η i where w λ 1 2 λ cos ω θ θ 0 i λ 2 ω π ϕ η i a 2 r 0 i r ω and λ i r r 0 i r r 0 i r r 0 i r r 0 i ω the first term on the right hand side of 4 represents the contribution from regional flow φ s and the summation term is that of the multiwells φ w the latter is invariant under interchanging the role of head observation point r θ and well position r 0 i θ 0 i it is easy to verify that the potential field expressed by 4 obeys the intended boundary conditions there is no regional flow if streams preserve zero head gradient across the aquifer domain and this occurs when φ 1 φ 2 2 2 stream function the cauchy riemann equations construct a bridge connecting the potential and stream function these represent a system of two partial differential equations written in the polar form as strack 2017 5 ψ r 1 r φ θ 6 ψ θ r φ r where ψ ψ r θ refers to the stream function since the potential is known from 4 the cauchy riemann equations can be integrated analytically to arrive at the following closed form solution for the stream function appendix b 7 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i q i 2 π f λ i f λ i f o r a r r 0 i q i 2 π f λ i f λ i f o r a r 0 i r where f λ tan 1 λ s i n ω θ θ 0 i 1 λ c o s ω θ θ 0 i the first term on the right hand side of 7 is due to the regional flow ψ s and the summation term is that of the multiwells ψ w it is apparent from 7 that the lines of ψ s ϑ ϑ constant form a family of concentric circles expressed by the equation r exp ϑ ϕ φ 1 φ 2 perpendicular to these circles are the lines of constant φ s which emanate radially from the origin in a fan like form it is common practice to contour stream function for visualizing the pattern of streamlines strack 2017 2 3 stream aquifer water exchange the well field induces water exchange across the common interfaces between the lateral streams and the aquifer media this can be computed for each of the surrounding streams in terms of volumetric rates q s as follows 8 q s 1 a 1 r φ w θ θ 0 d r 9 q s 2 a 1 r φ w θ θ ϕ d r 10 q s 3 0 ϕ r φ w r r a d θ the above integrals fall in the generic category of b 1 and b 2 discussed in appendix b and the following closed form expressions can be obtained for the stream aquifer water exchange due to multiwells 11 q s 1 i 1 n q i 1 θ 0 i ϕ 2 π tan 1 a r 0 i ω s i n ω θ 0 i 1 a r 0 i ω c o s ω θ 0 i 12 q s 2 i 1 n q i θ 0 i ϕ 1 π tan 1 a r 0 i ω sin ω ϕ θ 0 i 1 a r 0 i ω cos ω ϕ θ 0 i 1 π tan 1 a r 0 i ω sin ω ϕ θ 0 i 1 a r 0 i ω cos ω ϕ θ 0 i 13 q s 3 i 1 n q i π tan 1 a 2 ω r 0 i 2 ω cos ω θ 0 i 2 r 0 i a ω a 2 ω r 0 i 2 ω sin ω θ 0 i tan 1 a 2 ω r 0 i 2 ω cos ω θ 0 i 2 r 0 i a ω a 2 ω r 0 i 2 ω sin ω θ 0 i in deriving the above formulas some trigonometric identities like 1 θ 0 i ϕ 2 π t a n 1 s i n ω θ 0 i 1 c o s ω θ 0 i have been adopted gradshteyn and ryzhik 1980 positive values of q s indicate net inflow from the stream into the aquifer and it is commonly referred to as stream depletion rate sdr conversely negative values identify groundwater outflow to the stream sdrs for a single pumping well can be normalized as q s q s q which quantifies the fraction of water contributed by each stream to the well moreover the aquifer can be either recharged or discharged along the stream banks depending on the direction of the regional flow this causes water exchange through the common interfaces with s 1 and s 2 the volumetric rate q s that is exchanged over the finite segment of the interface a r b is given by q s 1 a b r 1 φ s θ θ 0 d r φ 1 φ 2 ln b a ϕ and q s 2 a b r 1 φ s θ θ ϕ d r q s 1 for s 1 and s 2 respectively it is to be noted that since φ s is linear in θ therefore φ s θ θ 0 φ s θ θ ϕ φ 2 φ 1 ϕ and the integrands do not vary with angular coordinate indeed the volumetric rates q s 1 and q s 2 are proportional to the difference in the potentials φ 2 and φ 1 and grow logarithmic along the stream bank these quantities approach infinity as b while their sum remains zero to maintain steady state mass balance for the regional flow for example when φ 2 φ 1 the amount of water that enters the aquifer from s 2 leaves it from s 1 2 4 stagnation points a stagnation point can be identified as a point where local flow velocity vanishes in all directions and it may be detected on a semi analytical basis in groundwater hydraulics ataie ashtiani et al 2012 referring to 4 the gradient of potential in the angular and radial directions can be computed analytically as r 1 φ θ and φ r the resulting expressions are then set equal to zero to form a system of two nonlinear algebraic equations for the coordinates of stagnation point s as follows 14 i 1 n q i sin ω θ θ 0 i λ i w λ i η i w η i sin ω θ θ 0 i λ i w λ i η i w η i 2 φ 2 φ 1 i 1 n q i sin ω θ 0 i η i η i 2 1 w η i w η i r r 0 i r r 0 i λ i λ i 2 1 w λ i w λ i 0 the above equations are handled numerically by the root finding maple function fsolve and roots are denoted by r r s p and θ θ s p hereafter multiple solutions are feasible for a multiwell aquifer system as it will be clarified in what follows if there is no regional flow and n 2 the coordinates of stagnation point s is independent of t and k 3 results and discussion 3 1 comparison with existing solutions the steady state sdrs derived by yeh et al 2008 for wedge shaped aquifer domains may be considered as a special case of the present solution if the effect of stream s 3 is omitted by setting a 0 for the case of a single pumping well in confined aquifer eqs 11 and 12 reduce to q s 1 1 θ 0 ϕ and q s 2 θ 0 ϕ respectively eq 4 can be further simplified in the absence of regional flow leading to 15 s r θ q 4 π t l n w λ w λ where λ r r 0 r r 0 r r 0 r r 0 ω and s r θ h 1 h r θ is drawdown chan et al 1978 obtained the same solution via mellin transform under a slightly different notation they also accounted for bounding streams along the arcs r a and r b a b and expressed drawdown in the finite domain as 16 s r θ q π t n 1 sin ω n ln r a sin ω n ln r 0 a cosh ω n ϕ θ θ 0 cosh ω n ϕ θ θ 0 n sinh ω n ϕ where ω n n π l n b a in practical implementation however the infinite series in 16 should be truncated to its m th partial sum where m 1 is a positive integer boyce et al 2017 a numerical example is conducted to illustrate the accuracy level achievable in a direct assessment of 16 the ratio b a is set to 10 6 which seems large enough to mimic the condition of infinite radial extent other parameters are chosen as ϕ 3 θ 0 60 a 1000 m r 0 1500 m and q t 1 m for comparison purposes two drawdown maps are prepared in fig 4 one by retaining one hundred terms in the partial sum m 100 and the other by evaluating eq 4 obviously the former suffers from spurious distortions in the immediate neighborhood of the angular position of the well fig 4a but the latter reveals oscillation free contour lines fig 4b the drawback of eq 16 is further explored by increasing the order of the partial sum and its effect on the series convergence is studied fig 5 shows the drawdown profile along a radial line passing through the well position as computed for m 100 200 and 1000 it is observed that a tenfold increase in the order of the partial sum fairly improves the accuracy level but the logarithmic singularity associated with the well is still poorly estimated and high frequency oscillations persist around the well position zoom in view in fig 5 this drastically reduces the practicality of eq 16 versus the series free solution derived in the present study which guarantees smooth drawdown profile fig 5 at a very low computational cost although not shown here the oscillations manifest themselves even for m 3000 the accuracy of eq 16 would be even lower when computing the gradient of the potential field as noted by melnikov and melnikov 2012 in a similar context of green s function samani and zarei doudeji 2012 derived complex potential and stream function associated with multi well system in wedge shaped aquifers the formulation can account for arbitrary directed regional flow due to some features at far field but its applicability is restricted to certain wedge configurations for which the ratio 180 ϕ with the vertex angle ϕ measured in degree takes an integer number as shown in fig 6 the streamlines calculated by eq 7 are exactly coincident with those of samani and zarei doudeji 2012 for an infinite wedge with ϕ 3 θ 0 60 it is to be emphasized again that the present approach has no limitation with regard to aquifer vertex angle 3 2 flow nets and boundary effects various scenarios can be investigated for multiwell induced head variation by changing the hydrogeological parameters involved in the mathematical model e g aquifer geometry number and location of wells injection extraction rates and difference in the stream heads key aspects of the proposed solution are highlighted through a set of hypothetical test cases default parameters chosen for confined flow are a 1000 m t 20 m 2 day and h 1 13 m case 1 examines aquifer response to a system of two extraction wells labeled 1 and 2 of equal discharge q 1 q 2 40 m 3 day which are located at r 01 θ 01 3600 m 20 and r 02 θ 02 7000 m 20 the aquifer geometry is delineated by ϕ 37 the head distribution is assumed initially flat throughout the aquifer by setting h 1 h 2 13 m flow net is shown in fig 7 where solid lines are head contours and arrow heads are streamlines the pattern of streamlines indicates formation of a saddle stagnation point roughly midway between the well sites at the intersection of four dividing streamlines point a with r spa 5020 m and θ spa 19 1 two streamlines originate from and two merge at this point in case 2 the foregoing formulation is extended to aquifer domains involving an impervious barrier instead of s 2 this type of boundary may hydraulically reproduce the effects of water divide or impervious bedrock outcrop the analysis is accomplished by evaluating 4 for ω 2 with a system of image wells which are mirror reflections of the real wells about the boundary line θ ϕ the angular position of image wells is set to 2 ϕ θ 0 i whereas the radial positions are kept same as the real wells to ensure no flow across the impervious boundary both the image and real wells should be of the same type and operate at equal rates the stream function is treated likewise fig 8 repeats the previous one except that an impervious barrier lies along θ 37 it is observed that the boundary effects completely alter the flow pattern and there exists three stagnation points on the impervious barrier at radial distances r spa 3963 m r spb 5013 2 m and r spc 6369 4 m pairs of two convergent streamlines run tangential to the boundary merge at the stagnation points a and c and originate streamlines toward the wells a streamline coming from s 1 stagnates and splits at point b it divides the aquifer area into two subregions on the left zone water is fully captured by well 1 and on the right zone by well 2 sdr values computed for case 1 are q s 1 36 71 q s 2 43 19 and q s 3 0 1 m 3 day similarly one obtains q s 1 77 97 and q s 3 2 03 m 3 day for case 2 compared to case 1 more water is depleted from s 1 and s 3 in case 2 due to the absence of s 2 in each case the total sdr is equal to the sum of steady state well discharges q 1 q 2 80 m 3 day and this result is consistent with groundwater budget for the stream aquifer systems under consideration in case 3 a hypothetical remediation scheme is planned to contain a contaminant plume by a system of three wells in a stream aquifer system having the vertex angle ϕ 65 and h 2 15 m water is injected upgradient of the plume at the rate of q 1 35 m 3 day and then extracted by two downgradient wells at equal rates of q 2 q 3 40 m 3 day the well positions are r 01 θ 01 1900 m 43 r 02 θ 02 1600 m 20 and r 03 θ 03 2400 m 20 two stagnation points are identified on the bounding streamlines at r spa θ spa 1894 6 m 49 7 and r spb θ spb 1938 1 m 10 5 with this well configuration and injection extraction rates adopted all of the streamlines emanating from the injection site converge towards the extraction points fig 9 the total amount of injected water is thus captured and contaminant plume is contained zarei doudeji and samani 2018 the volumetric rates of stream aquifer water exchange are evaluated as q s 1 38 02 q s 2 1 62 and q s 3 8 61 m 3 day therefore the system of three wells receives water from streams s 1 and s 3 whereas s 2 has a net inflow from the aquifer this analysis excludes the amount of water exchange caused by regional flow again the volumetric rates mentioned above sum to that of the wells q 1 q 2 q 3 45 m 3 day 3 3 sdr maps sdr maps can help to assess the sensitivity of stream depletion rates in response to variations in the location of a single pumping well these can be prepared by continuously changing the well position within the aquifer area and calculating eqs 11 to 13 at those positions mahdavi 2019b a number of observations can be made from sdr maps of case 1 fig 10 and case 2 fig 11 i the boundary type constant head and no flow remarkably influences sdr map the closer the distance to s 1 in case 1 the larger the value of q s 1 will be however wells located even far away from s 1 in case 2 may significantly deplete water from it such trends may be identified by tracking any contour line e g q s 1 0 9 in fig 10a and fig 11a ii sdr maps of q s 1 and q s 2 in case 1 fig 10a are mirror reflections of each other with respect to the bisector of the wedge θ ϕ 2 the curves exhibit large variations prior to r 1400 m but become lines of constant θ as radial distance further increases ultimately a contour line labeled q s 1 β 0 β 1 will be asymptotic to the one labeled q s 2 1 β and so on iii in both cases sdr map of q s 3 is more sensitive to the well position in the vicinity of s 3 where contour lines are closely spaced fig 10b fig 11b the effect of q s 3 is diminishing over radial distance and in the limit when r goes to infinity the total amount of pumped water is supplied by depletion of other boundary stream s iv since the sum of q s 1 and q s 3 remains unity throughout the aquifer domain in case 2 a contour line labeled q s 1 β must coincide with the one labeled q s 3 1 β therefore one may conclude that sdr maps of q s 1 and q s 3 are geometrically the same and only differ in contour values fig 11 v interestingly a well located on the contour line q s 1 q s 3 0 5 will receive an equal contribution from each boundary stream in case 2 the area outside the contour line q s 1 0 9 in fig 11a is slightly influenced by s 3 and more than 90 of the pumped water comes from s 1 3 4 effects of regional flow gradient fig 12 demonstrates how the position of stagnation point associated with a single pumping well is affected by the gradient of regional flow in a confined aquifer the simulations are carried out by solving 14 for the specified values of ϕ 54 θ 0 27 r 0 1100 m and q t 1 m normalized parameters r r s p r 0 r 0 and θ θ 0 θ s p θ 0 are defined in fig 12 to better quantify the model response these measure respectively the radial and angular deviation of stagnation point from the well position the head remains fixed at h 1 13 m along the stream s 1 but h 2 is varied incrementally to induce regional flow proportional to the head difference between s 1 and s 2 from a 13 the gradient of regional flow i r 1 φ s θ at the well position is calculated as φ 2 φ 1 r 0 ϕ a lower bound must be specified for h 2 hence i so that generation of one stagnation point is ensured in each case below this limit the intensity of regional flow is not large enough to locally vanish flow velocities and there would be no root for 14 to fall within the aquifer domain by trial and error it is found that the above criterion is met if h 2 13 16 m the associated gradient is denoted by i min from fig 12 it is evident that the curves of r and θ reveal monotonic declining trends with steeper slopes prior to i 20 i min the position of stagnation point is thus more sensitive to the changes in the gradient of regional flow for relatively small values of i as i further increases one may conclude that the radial position of the stagnation point is approximately same as that of the well itself notice the negligibly small values of r indicating that r 0 r s p in practice although not shown here similar behavior was observed for different well positions 3 5 effects of wedge angle fig 13 explores the role of vertex angle of the aquifer domain on stream aquifer water exchange for 10 ϕ 70 the aquifer geometry is altered by increasing ϕ in 5 intervals and eqs 11 to 13 are evaluated accordingly for normalized radial position r 0 a 1 1 and θ 0 ϕ 2 so as to get q s 1 q s 2 in each case as fig 13 shows the aquifer domains characterized by larger values of ϕ produce smaller amounts of q s 1 due to increased distance between the well and s 1 the same applies to q s 2 too conversely the curve of q s 3 appears to rise consistently because the length of the aquifer interface with s 3 has increased proportional to ϕ while the well distance to this stream is fixed it is expected that the normalized rates sum to unity as confirmed by dashed line in fig 13 it is beneficial to assess the conditions under which the surrounding streams contribute equally to a single pumping well so that q s 1 q s 2 q s 3 1 3 e g point a in fig 13 where curves intersect at ϕ 13 03 equating 11 with 12 confirms that the well should lie along the bisector of the wedge θ 0 ϕ 2 substituting this in 13 after simplification gives the radial position of the well as being governed by a r 0 ω r 0 a ω 2 3 0 for q s 3 1 3 the equation is solved numerically for the normalized parameter r 0 a and results are shown in fig 14 for the range of aquifer angles mentioned earlier as ϕ increases the well should operate at a larger distance from stream s 3 to fulfill the condition of equal stream depletion rates 3 6 rainfall induced recharge the method of green s function enables handling bvps related to groundwater recharge in unconfined aquifers this allows recharge patterns to be distributed locally by artificial basins mahdavi and seyyedian 2013 mahdavi 2015 or globally by rainfall mahdavi 2019a case 4 addresses the effects of rainfall alone whereas a pumping well is added in case 5 initially the stream aquifer system is in hydraulic equilibrium maintaining a constant potential at φ 0 deviation from this may occur due to rainfall and the following bvp governs the aquifer response in terms of rainfall potential φ r 17 2 φ r r 0 where r 0 0 is the constant rate of infiltration strack 2017 in the present analysis the above bvp is subject to zero drawdown boundary streams the aquifer is naturally replenished by rainfall over the finite subregion a r b and 0 θ ϕ which defines the solution domain for the bvp the associated green s function g has a structure similar to that of a single well and is obtained by replacing q with r 0 in a 11 the potential field for case 4 is computed by integrating the green s function over the recharge area φ r 0 ϕ a b g r 0 d r 0 d θ 0 and then adding the contribution from streams φ s φ 0 to the result yielding 18 φ r θ φ 0 2 r 0 b 2 ϕ π 2 n 1 3 5 s i n n ω θ n 2 n ω 2 a 2 rb n ω r b n ω 2 n ω n ω 2 r b 2 a b 2 a r n ω note that the above summation runs over odd integers and denominator becomes singular if n ω 2 therefore the aquifer domains having vertex angles ϕ π 2 or ϕ 3 π 2 are excluded by 18 it is worth mentioning that the integral representation leading to 18 effectively suppressed the oscillatory nature of a 11 and improved the series convergence as well a similar smoothing effect in the context of artificial recharge problems has been reported by mahdavi and seyyedian 2013 in case 4 and case 5 a rainfall recharge of the intensity r 0 0 05 c m d a y is received by an unconfined aquifer having k 3 m d a y and ϕ 25 the recharge area extends radially between a 1000 m and b 2000 m eq 18 is evaluated for this stream aquifer setting where stream heads are all kept at h 0 10 m φ 0 k h 0 2 2 case 5 also incorporates a pumping well of the discharge rate q 100 m 3 day at θ 0 ϕ 4 and r 0 1200 m the potential for unconfined flow to the well is calculated from 4 and superimposed on 18 the flow net for case 4 and case 5 are depicted in fig 15 a and fig 15b respectively both cases reveal formation of a high stagnation point corresponding to the maximum head level point a in fig 15 streamlines disperse outwardly from this point in all directions in case 4 the contour map demonstrates an overall increase of head gradient hence velocities toward the boundary streams where consecutive equipotentials become closer to each other fig 15a this pattern helps to spread out an amount of recharge which gradually rises toward boundary streams since eq 18 has the property that φ r θ φ r ϕ θ the flow net obeys symmetrical aquifer domain in case 4 in case 5 however the well has a position offset from the bisector of the wedge so that the flow net loses its symmetry a well capture zone is delineated whose boundary consists of two streamlines passing through the points ab and ac inside the capture zone the pumped water is partially supplied by depletion of the stream segment between points b and c and partially by the rainfall recharge the latter is driven by a bundle of streamlines coming from point a which bend towards the well outside the capture zone the streamlines eventually become perpendicular to the streams s 1 and s 2 fig 15b the present solution is validated numerically against matlab finite element toolbox pdetool which offers a flexible environment for dealing with 2 d problems of groundwater hydraulics herckenrath et al 2013 mahdavi and seyyedian 2013 kacimov et al 2017 mahdavi 2019a b comparisons include head distribution along the radial lines θ ϕ 6 ϕ 4 and ϕ 2 in case 4 fig 16 a and θ θ 0 in case 5 fig 16b the numerical analysis is accomplished by defining an initial mesh of triangular elements for the domain discretization to achieve desired level of accuracy finite elements are adaptively refined to yield smaller triangles in close proximity of the well where heads drop abruptly in response to pumping the adaptive mesh refinement not only improves numerical convergence but also ensures mesh independency of the fem results yang et al 2005 fig 16 indicates that both the analytical and numerical methods are in strictly close agreement 4 conclusions a steady state analytical solution was derived for multiwell induced head variation in annular wedge shaped aquifers subject to uniform regional flow the solution removed the limitations regarding the aquifer vertex angle and wells can be of any numbers types positions and extraction injection rates the associated green s function benefits from an extremely simple mathematical structure and requires only a small number of function evaluations to arrive at flow nets the bvp was defined by three types of boundary configurations reflecting the physical reality of the borderlines it was shown that some existing solutions may be regarded as a special case of the present result qualitative assessment of the flow nets confirmed the validity of the solution in the test cases studied a layout of injection extraction wells was designed to hydraulically contain a contaminant plume in a hypothetical remediation scheme the pertinent property of green s function allowed dealing with the case of areal recharge due to rainfall in an inverse modeling framework this solution may serve to estimate the ratio r 0 k by fitting the computed equipotentials to those plotted from observed heads in the field the following conclusions can be drawn i if aquifer is surrounded only by streams along the borderlines the closer the well distance to the stream the larger will be the value of sdr for that stream conversely in presence of an impervious barrier the stream may significantly contribute to the pumping well located even far away from it ii for a single pumping well subject to relatively high gradient of the regional flow the radial position of the stagnation point is practically same as that of the well iii by an increase in the aquifer vertex angle ϕ the sdr values q s 1 and q s 2 decline but q s 3 rises so that the sum of these quantities remains unity in each case iv a single pumping well is allocated in such way that the surrounding streams contribute equally to the amount of pumped water at its position the well lies along the bisector of the wedge and by increasing ϕ it should be located further away from s 3 in order to satisfy the condition of equal sdrs however there is no unique solution in the presence of impervious barrier rather a locus of the points exists as indicated by contour lines q s 1 q s 3 0 5 in fig 11 credit authorship contribution statement ali mahdavi conceptualization methodology validation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a derivation of 4 since the bvp is subject to nonhomogeneous boundary conditions 2 the aquifer response is decomposed into separate components reflecting the contribution from multiwells φ w and the regional flow due to difference in the potential of boundary streams φ s the bvps associated with φ w and φ s are illustrated in fig 3 the multiwell induced head distribution is constrained by homogeneous boundary conditions fig 3b while the regional flow is derived by nonhomogeneous boundary conditions fig 3c for the former subproblem the method of eigenfunction expansion constructs a series solution containing products of radial and angular components as given by a1 φ w r θ n 1 u n r sin n ω θ similarly the dirac delta function is expanded into a fourier trigonometric series a2 δ θ θ 0 i 2 ϕ n 1 sin n ω θ sin n ω θ 0 i given the uniqueness of the fourier series coefficients and substituting a 1 and a 2 into the bvp of fig 3b one derives a nonhomogeneous ode for the radial component a3 d 2 u n r d r 2 1 r d u n r d r n ω r 2 u n r 2 r ϕ i 1 n q i δ r r 0 i sin n ω θ 0 i the solution of which reads a4 u n r c 1 r n ω c 2 r n ω 1 n π i 1 n q i h r r 0 i r r 0 i n ω r 0 i r n ω sin n ω θ 0 i with h being the heaviside function the first two terms on the right hand side of a 4 represent complementary solution consisting of fundamental set r n ω and r n ω with non zero wronskian the last term containing finite series is the particular solution associated with the fundamental set and it is obtained by the method of variation of parameters boyce et al 2017 to determine the unknown coefficients c 1 and c 2 the homogenous boundary conditions in terms of the radial component are imposed on a 4 the two conditions read u n a 0 and lim r d u n r d r 0 since r 0 i a the heaviside function vanishes for r a simplifying the first condition to a5 c 1 a n ω c 2 a n ω 0 differentiating a 4 term by term in r the second condition converts to a6 l i m r r n ω 1 c 1 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i r n ω 1 c 2 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i 0 the second term identically vanishes because l i m r r n ω 1 0 in the first term however the magnitude of r n ω 1 grows unbounded if n ω 1 otherwise it becomes unity for a 6 to hold in either case the factor of r n ω 1 must be equal to zero resulting in a7 c 1 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i inserting the above coefficient in a 5 gives a8 c 2 1 n π i 1 n q i a 2 r 0 i n ω s i n n ω θ 0 i the radial component thus takes the following form a9 u n r 1 n π i 1 n q i a 2 r 0 i r n ω r r 0 i n ω r r 0 i n ω r 0 i r n ω h r r 0 i s i n n ω θ 0 i the heaviside function splits a 9 into two branches depending on the relative position of the head observation point with respect to the well substituting these in a 1 leads to the following expression for the potential distribution due to multiwells a10 φ w r θ i 1 n n 1 q i n π a 2 r 0 i r n ω r r 0 i n ω sin n ω θ 0 i sin n ω θ f o r a r r 0 i a 2 r 0 i r n ω r 0 i r n ω sin n ω θ 0 i sin n ω θ f o r a r 0 i r where 0 θ ϕ both branches can be rendered in a single form valid over the entire solution domain a11 φ w r θ i 1 n n 1 q i η i n λ i n 2 n π cos n ω θ θ 0 i cos n ω θ θ 0 i the interior series is manipulated according to the following summation formula gradshteyn and ryzhik 1980 melnikov and melnikov 2012 a12 n 1 λ n n cos n χ 1 2 l n 1 2 λ c o s χ λ 2 it is to be noted that the constrains λ 1 and 0 χ 2 π required for the convergence of above formula are met because η i 1 λ i 1 and 0 ω θ θ 0 i 2 π in the present setting this converts a 11 to a compact and easily computable form which is free from infinite series as appears on the right hand side of 4 eq a 13 expresses potential distribution induced by regional flow satisfying the bvp in fig 3c a13 φ s φ 1 φ 2 φ 1 θ ϕ similar solutions for the regional flow in rectangular shaped aquifers can be found in the literature yeo and lee 2003 the principle of superposition φ φ w φ s completes the desired solution for the bvp in fig 3a leading to 4 appendix b derivation of 7 manipulation of the cauchy riemann equations 5 and 6 involves indefinite integrals of the generic form given by b1 i 1 1 2 λ l n 1 2 λ c o s χ λ 2 χ d λ and b2 i 2 λ 2 l n 1 2 λ c o s χ λ 2 λ d χ by introducing the change of variable γ λ s i n χ 1 λ c o s χ and substituting d γ s i n χ 1 λ c o s χ 2 d λ in b 1 and d γ λ c o s χ λ 1 λ c o s χ 2 d χ in b 2 the integrals convert after straightforward algebra to b3 i 2 i 1 d γ 1 γ 2 tan 1 γ eq 5 is integrated term by term in r with the potential field coming from 4 as follows b4 ψ r θ φ 1 φ 2 r ϕ d r i 1 n q i 4 π θ ln w η i ln w η i l n w λ i l n w λ i d r r the first integral is φ 1 φ 2 ϕ ln r note that λ i r r 0 i ω for r r 0 i and consider the first integral in the summation term b5 ln w η i θ d r r θ ln 1 2 a 2 r 0 i r ω cos ω θ θ 0 i a 2 r 0 i r 2 ω d r r if λ a 2 r 0 i r ω and χ ω θ θ 0 i then d r r 1 ω d λ λ and θ ω χ therefore the above integral can be written according to b 1 as b6 l n 1 2 λ c o s χ λ 2 χ d λ λ 2 t a n 1 a 2 r 0 i r ω sin ω θ θ 0 i 1 a 2 r 0 i r ω cos ω θ θ 0 i 2 f η i the other integrals are treated likewise converting b 4 to b7 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i f λ i f λ i f 1 θ the expression for f was already defined in connection with 7 similarly if r 0 i r then λ i r 0 i r ω and b8 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i f λ i f λ i f 2 θ the sole functions of angular coordinates f 1 θ and f 2 θ arise as constant of integration since they are not varying with r to determine these functions eq 6 is integrated in θ according to b 2 one obtains for r r 0 i b9 ψ r θ i 1 n q i 2 π f η i f η i f λ i f λ i f 3 r and for r 0 i r b10 ψ r θ i 1 n q i 2 π f η i f η i f λ i f λ i f 4 r where f 3 r and f 4 r are constant of integration in a fashion similar to those mentioned above by equating b 7 with b 9 and b 8 with b 10 it immediately follows that f 3 r φ 1 φ 2 ϕ ln r f 1 θ and f 4 r φ 1 φ 2 ϕ ln r f 2 θ for these relations to hold both of the functions f 1 θ and f 2 θ must be constant chosen arbitrarily equal to zero without loss of generality the solution can be recast in a more compact form appeared in 7 
5516,wedge shaped aquifers are sometimes cut by crossing streams so that the areal geometry can be delineated by an annular wedge of infinite radial extent despite their worldwide spread the problem of groundwater flow in such geometrical entities has not received much attention in analytical studies this paper presents a closed form analytical solution for the aquifer head distribution in response to a system of multiwells superimposed on a background regional flow the aquifer is isotropic homogeneous and in prefect hydraulic connection with the surrounding streams a steady state green s function is constructed for this laterally bounded aquifer system the formulation is general in the sense that the aquifer vertex angle as well as number of wells and their positions can be arbitrary chosen closed form expression for the stream function is obtained by integration of the cauchy riemann equations three types of hydrogeological boundary conditions are considered combining streams of constant and linearly varying head and no flow barrier the results are applicable to both confined and unconfined flows extremely simple expressions are derived to quantify the amount of water exchange across stream aquifer interfaces flow nets are given for a number of hypothetical test cases demonstrating different aspects of the generated flow field sensitivity maps are prepared for the stream depletion rates due to a single pumping well and the role of aquifer vertex angle on the model response is investigated multiple stagnation points in the flow field are identified on a semi analytical basis this helps to assess how the position of a single stagnation point is affected by changes in the gradient of regional flow for relatively high gradients it is observed that the radial position of the stagnation point coincides with that of the well itself finally the formulation is extended to account for rainfall recharge over an unconfined aquifer having the same areal extent the aquifer response is found to agree well with other analytical and numerical results keywords multiwells regional flow stream depletion rate stream function stagnation point green s function 1 introduction multiple river basins often draw irregularly shaped aquifers between intersecting streams lakes and alluvial fans the flow topology is affected not only by the aquifer geometry but also by the way that the components of stream aquifer system are interconnected such geometrical entities are diverse worldwide the mekong and red river deltas asadi aghbolaghi and seyyedian 2010 mahdavi and seyyedian 2013 the trapezoidal region formed by intersection of karun and bahmanshir rivers north west of persian gulf iran mahdavi and seyyedian 2014 the u shaped aquifer bounded by three water land boundaries linyuan district taiwan huang et al 2015 the wedge shaped beach promontory near bol croatia kacimov et al 2016 and the l shaped aquifer formed by poonggye stream and bedrock outcrops gyeonggi do korea kihm et al 2007 lin et al 2018 the tendency of stream aquifer system to maintain ecological equilibrium may be disrupted by human activities for example by urbanization with groundwater being increasingly considered a source of potable water besides extraction injection systems implemented for groundwater clean up locally disturb the pattern of background regional flow across the aquifer groundwater pumping suffers from cumulative and irreversible impacts whereas excessive groundwater recharge may cause water logging if pumping continues long enough the cone of depression may intersect lateral boundaries of the aquifer and pattern of stream depletion rates is drastically altered when steady state is reached depletion of adjacent streams becomes the only source to supply the pumped water these illustrate the invalidity of assuming an infinite extent aquifer as it neglects water exchange across interfaces with adjacent water bodies moreover mutual interaction of multiwells and regional flow should be taken into account in groundwater budget all depending upon the boundary type and its orientation among the other mechanisms complexities inherent in hydrogeological processes are often addressed numerically by finite deference and finite element methods these appear to be computationally expensive in dealing with realistic conditions and require comprehensive databases to attain reliable predictions zlotnik and tartakovsky 2008 alternatively analytical or semi analytical techniques can be preferred over numerical counterparts due to ease of implementation and less data requirements such solutions have been extensively developed for intended boundary value problems bvps under various types of hydrogeological boundary conditions reflecting zero drawdown streams impervious barriers and tidal head fluctuations among others yeh and chang 2006 huang et al 2015 the method of green s function is an example which can efficiently reproduce the aquifer response to extraction injection wells mahdavi 2019a and accounting for localized or regional recharge events is straightforward mahdavi 2015 semi analytical solution strategies are widely available for groundwater flow problems and some illustrative examples include the analytic element method strack 2003 and adomian s decomposition method patel and serrano 2011 for irregularly shaped heterogeneous aquifer with multiple straight or curved boundaries the variational method of kantorovich for trapezoidal and triangular shaped anisotropic aquifers subject to diffusive recharge of rainfall mahdavi and seyyedian 2014 grid free series solution for geometrically complex stratified aquifers interacting with streams or lakes ameli and craig 2014 the method of image wells for aquifer with a meandering stream huang and yeh 2015 laplace hankel transforms for unconfined fractured and leaky wedge shaped aquifer system sedghi and zhan 2018 fourier laplace transforms for l shaped domains composed of two rectangular subregions lin et al 2018 multi zone wedge shaped domains samani and sedghi 2015 and infinite aquifer domains overlying fractured bedrock sedghi and zhan 2019 in most cases laplace domain head distributions are obtained analytically and inverted by a numerical algorithm hence the name semi analytical relatively few analytical studies have been devoted to non rectangular aquifer domains for bvps associated with triangular shaped aquifers green s functions can be obtained by repeating the image wells infinitely to fill entire 2d space all arranged in square shaped mahdavi and seyyedian 2013 or honey comb lattices mahdavi 2019b the boundary conditions determine the type of image wells extraction or injection operating in each lattice for wedge shaped aquifer domains formed by intersection of two linear streams the method of image wells samani and zarei doudeji 2012 and finite fourier hankel transforms yeh and chang 2006 are well suited the former benefits from simple mathematical structure but the applicability is restricted to certain values of wedge angles conversely the latter allows for arbitrary angles but evaluating infinite series of bessel functions requires substantial effort and convergence accelerating techniques such as shanks method are inevitable when a stream crosses the wedge shaped aquifer the geometry formed by intersection of borderlines can roughly resemble an annular wedge this can be observed in various regions of the world and fig 1 shows an example ideally the lateral extent of the aquifer is bounded by finite arc of the crossing stream in one side and by straight streams in other two sides fig 2 this study aims to derive closed form analytical expressions for potential and stream function in such hydrogeological settings combined effects of multiwells and background regional flow are addressed under steady state condition first a closed form green s function is constructed for the associated bvp allowing for annular wedge of arbitrary vertex angle penetrated by wells of different extraction injection rates the resulting expressions are easy to compute and free from infinite series it is to be noted that the analysis of groundwater flow in annular wedges has not been received much attention in analytical studies in the wedge with no inner arc called wedge shaped aquifer chan et al 1978 obtained a series representation for both the transient and steady state drawdown distributions in finite domains as well as in infinite domains but in the finite wedge with inner arc called annular wedge shaped aquifer only steady state drawdown distributions were first solved by chan et al 1978 thanks to its simple structure the present solution is found to be more accurate and computationally efficient than that of chan et al 1978 which require high order partial sums to attain reasonable results except for samani and zarei doudeji 2012 none of the references cited above have reported stream function for the wedge shaped aquifers and only potential fields were accounted for in the present framework the stream function immediately follows from integration of the cauchy riemann equations and streamlines are simply its contour lines by comparing with samani and zarei doudeji 2012 the stream lines calculated by both methods appear to be indistinguishable from each other next hypothetical test cases are presented to assess different aspects of groundwater flow in such geometrical entities finally interaction of a single pumping well with uniform rainfall recharge is analyzed and the aquifer response is tested against its numerical counterpart from adaptive finite element method 2 mathematical model 2 1 potential field some simplifying assumptions are made in the development of mathematical formulation i the flow of groundwater is essentially two dimensional in the horizontal plane ii the aquifer is isotropic homogenous and of constant transmissivity t and hydraulic conductivity k iii the intersection of three fully penetrating streams delineates an annular wedge shaped domain for the aquifer that extends to infinity along radial direction fig 2 iv the aquifer is fully penetrated by a set of n arbitrarily located multiwells each of which having infinitesimal radius and constant injection rejection rate and v the well flow is superimposed on a background regional flow whose intensity is proportional to the potential difference in the surrounding streams adopting polar coordinates r θ the potential field φ in this stream aquifer system is governed by 1 2 φ i 1 n q i r δ r r 0 i δ θ θ 0 i where the laplacian is defined by 2 φ 1 r r r φ r 1 r 2 2 φ θ 2 eq 1 can be switched to either confined or unconfined flows by defining the state variable as φ t h or φ k h 2 2 respectively with h h r θ being the hydraulic head the dirac delta functions δ appearing on the right hand side of 1 indicate local mass exchange at the well positions r 0 i θ 0 i with the well discharges q i being positive for pumping and negative for injection if there is only a single well n 1 its position and discharge are denoted respectively by r 0 θ 0 and q for notational convenience for mathematical well posedness of bvp the boundary conditions are defined in terms of potential reflecting the physical reality as follows 2 φ r 0 φ 1 s t r e a m s 1 φ r ϕ φ 2 s t r e a m s 2 φ a θ φ 1 φ 2 φ 1 θ ϕ s t r e a m s 3 the first two conditions in 2 imply streams of constant potential while the last corresponds to linearly varying potential along the stream bank lin et al 2018 no flow condition is imposed at large distances from the well system implying remote boundary condition in the limit when r approaches infinity huang et al 2015 3 lim r φ r 0 a closed form solution to the above bvp is obtained relying on the technique of green s function in conjunction with the principle of superposition detailed derivation is given in appendix a and the result may be written in compact form as 4 φ r θ φ 1 φ 2 φ 1 θ ϕ i 1 n q i 4 π l n w η i w λ i w λ i w η i where w λ 1 2 λ cos ω θ θ 0 i λ 2 ω π ϕ η i a 2 r 0 i r ω and λ i r r 0 i r r 0 i r r 0 i r r 0 i ω the first term on the right hand side of 4 represents the contribution from regional flow φ s and the summation term is that of the multiwells φ w the latter is invariant under interchanging the role of head observation point r θ and well position r 0 i θ 0 i it is easy to verify that the potential field expressed by 4 obeys the intended boundary conditions there is no regional flow if streams preserve zero head gradient across the aquifer domain and this occurs when φ 1 φ 2 2 2 stream function the cauchy riemann equations construct a bridge connecting the potential and stream function these represent a system of two partial differential equations written in the polar form as strack 2017 5 ψ r 1 r φ θ 6 ψ θ r φ r where ψ ψ r θ refers to the stream function since the potential is known from 4 the cauchy riemann equations can be integrated analytically to arrive at the following closed form solution for the stream function appendix b 7 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i q i 2 π f λ i f λ i f o r a r r 0 i q i 2 π f λ i f λ i f o r a r 0 i r where f λ tan 1 λ s i n ω θ θ 0 i 1 λ c o s ω θ θ 0 i the first term on the right hand side of 7 is due to the regional flow ψ s and the summation term is that of the multiwells ψ w it is apparent from 7 that the lines of ψ s ϑ ϑ constant form a family of concentric circles expressed by the equation r exp ϑ ϕ φ 1 φ 2 perpendicular to these circles are the lines of constant φ s which emanate radially from the origin in a fan like form it is common practice to contour stream function for visualizing the pattern of streamlines strack 2017 2 3 stream aquifer water exchange the well field induces water exchange across the common interfaces between the lateral streams and the aquifer media this can be computed for each of the surrounding streams in terms of volumetric rates q s as follows 8 q s 1 a 1 r φ w θ θ 0 d r 9 q s 2 a 1 r φ w θ θ ϕ d r 10 q s 3 0 ϕ r φ w r r a d θ the above integrals fall in the generic category of b 1 and b 2 discussed in appendix b and the following closed form expressions can be obtained for the stream aquifer water exchange due to multiwells 11 q s 1 i 1 n q i 1 θ 0 i ϕ 2 π tan 1 a r 0 i ω s i n ω θ 0 i 1 a r 0 i ω c o s ω θ 0 i 12 q s 2 i 1 n q i θ 0 i ϕ 1 π tan 1 a r 0 i ω sin ω ϕ θ 0 i 1 a r 0 i ω cos ω ϕ θ 0 i 1 π tan 1 a r 0 i ω sin ω ϕ θ 0 i 1 a r 0 i ω cos ω ϕ θ 0 i 13 q s 3 i 1 n q i π tan 1 a 2 ω r 0 i 2 ω cos ω θ 0 i 2 r 0 i a ω a 2 ω r 0 i 2 ω sin ω θ 0 i tan 1 a 2 ω r 0 i 2 ω cos ω θ 0 i 2 r 0 i a ω a 2 ω r 0 i 2 ω sin ω θ 0 i in deriving the above formulas some trigonometric identities like 1 θ 0 i ϕ 2 π t a n 1 s i n ω θ 0 i 1 c o s ω θ 0 i have been adopted gradshteyn and ryzhik 1980 positive values of q s indicate net inflow from the stream into the aquifer and it is commonly referred to as stream depletion rate sdr conversely negative values identify groundwater outflow to the stream sdrs for a single pumping well can be normalized as q s q s q which quantifies the fraction of water contributed by each stream to the well moreover the aquifer can be either recharged or discharged along the stream banks depending on the direction of the regional flow this causes water exchange through the common interfaces with s 1 and s 2 the volumetric rate q s that is exchanged over the finite segment of the interface a r b is given by q s 1 a b r 1 φ s θ θ 0 d r φ 1 φ 2 ln b a ϕ and q s 2 a b r 1 φ s θ θ ϕ d r q s 1 for s 1 and s 2 respectively it is to be noted that since φ s is linear in θ therefore φ s θ θ 0 φ s θ θ ϕ φ 2 φ 1 ϕ and the integrands do not vary with angular coordinate indeed the volumetric rates q s 1 and q s 2 are proportional to the difference in the potentials φ 2 and φ 1 and grow logarithmic along the stream bank these quantities approach infinity as b while their sum remains zero to maintain steady state mass balance for the regional flow for example when φ 2 φ 1 the amount of water that enters the aquifer from s 2 leaves it from s 1 2 4 stagnation points a stagnation point can be identified as a point where local flow velocity vanishes in all directions and it may be detected on a semi analytical basis in groundwater hydraulics ataie ashtiani et al 2012 referring to 4 the gradient of potential in the angular and radial directions can be computed analytically as r 1 φ θ and φ r the resulting expressions are then set equal to zero to form a system of two nonlinear algebraic equations for the coordinates of stagnation point s as follows 14 i 1 n q i sin ω θ θ 0 i λ i w λ i η i w η i sin ω θ θ 0 i λ i w λ i η i w η i 2 φ 2 φ 1 i 1 n q i sin ω θ 0 i η i η i 2 1 w η i w η i r r 0 i r r 0 i λ i λ i 2 1 w λ i w λ i 0 the above equations are handled numerically by the root finding maple function fsolve and roots are denoted by r r s p and θ θ s p hereafter multiple solutions are feasible for a multiwell aquifer system as it will be clarified in what follows if there is no regional flow and n 2 the coordinates of stagnation point s is independent of t and k 3 results and discussion 3 1 comparison with existing solutions the steady state sdrs derived by yeh et al 2008 for wedge shaped aquifer domains may be considered as a special case of the present solution if the effect of stream s 3 is omitted by setting a 0 for the case of a single pumping well in confined aquifer eqs 11 and 12 reduce to q s 1 1 θ 0 ϕ and q s 2 θ 0 ϕ respectively eq 4 can be further simplified in the absence of regional flow leading to 15 s r θ q 4 π t l n w λ w λ where λ r r 0 r r 0 r r 0 r r 0 ω and s r θ h 1 h r θ is drawdown chan et al 1978 obtained the same solution via mellin transform under a slightly different notation they also accounted for bounding streams along the arcs r a and r b a b and expressed drawdown in the finite domain as 16 s r θ q π t n 1 sin ω n ln r a sin ω n ln r 0 a cosh ω n ϕ θ θ 0 cosh ω n ϕ θ θ 0 n sinh ω n ϕ where ω n n π l n b a in practical implementation however the infinite series in 16 should be truncated to its m th partial sum where m 1 is a positive integer boyce et al 2017 a numerical example is conducted to illustrate the accuracy level achievable in a direct assessment of 16 the ratio b a is set to 10 6 which seems large enough to mimic the condition of infinite radial extent other parameters are chosen as ϕ 3 θ 0 60 a 1000 m r 0 1500 m and q t 1 m for comparison purposes two drawdown maps are prepared in fig 4 one by retaining one hundred terms in the partial sum m 100 and the other by evaluating eq 4 obviously the former suffers from spurious distortions in the immediate neighborhood of the angular position of the well fig 4a but the latter reveals oscillation free contour lines fig 4b the drawback of eq 16 is further explored by increasing the order of the partial sum and its effect on the series convergence is studied fig 5 shows the drawdown profile along a radial line passing through the well position as computed for m 100 200 and 1000 it is observed that a tenfold increase in the order of the partial sum fairly improves the accuracy level but the logarithmic singularity associated with the well is still poorly estimated and high frequency oscillations persist around the well position zoom in view in fig 5 this drastically reduces the practicality of eq 16 versus the series free solution derived in the present study which guarantees smooth drawdown profile fig 5 at a very low computational cost although not shown here the oscillations manifest themselves even for m 3000 the accuracy of eq 16 would be even lower when computing the gradient of the potential field as noted by melnikov and melnikov 2012 in a similar context of green s function samani and zarei doudeji 2012 derived complex potential and stream function associated with multi well system in wedge shaped aquifers the formulation can account for arbitrary directed regional flow due to some features at far field but its applicability is restricted to certain wedge configurations for which the ratio 180 ϕ with the vertex angle ϕ measured in degree takes an integer number as shown in fig 6 the streamlines calculated by eq 7 are exactly coincident with those of samani and zarei doudeji 2012 for an infinite wedge with ϕ 3 θ 0 60 it is to be emphasized again that the present approach has no limitation with regard to aquifer vertex angle 3 2 flow nets and boundary effects various scenarios can be investigated for multiwell induced head variation by changing the hydrogeological parameters involved in the mathematical model e g aquifer geometry number and location of wells injection extraction rates and difference in the stream heads key aspects of the proposed solution are highlighted through a set of hypothetical test cases default parameters chosen for confined flow are a 1000 m t 20 m 2 day and h 1 13 m case 1 examines aquifer response to a system of two extraction wells labeled 1 and 2 of equal discharge q 1 q 2 40 m 3 day which are located at r 01 θ 01 3600 m 20 and r 02 θ 02 7000 m 20 the aquifer geometry is delineated by ϕ 37 the head distribution is assumed initially flat throughout the aquifer by setting h 1 h 2 13 m flow net is shown in fig 7 where solid lines are head contours and arrow heads are streamlines the pattern of streamlines indicates formation of a saddle stagnation point roughly midway between the well sites at the intersection of four dividing streamlines point a with r spa 5020 m and θ spa 19 1 two streamlines originate from and two merge at this point in case 2 the foregoing formulation is extended to aquifer domains involving an impervious barrier instead of s 2 this type of boundary may hydraulically reproduce the effects of water divide or impervious bedrock outcrop the analysis is accomplished by evaluating 4 for ω 2 with a system of image wells which are mirror reflections of the real wells about the boundary line θ ϕ the angular position of image wells is set to 2 ϕ θ 0 i whereas the radial positions are kept same as the real wells to ensure no flow across the impervious boundary both the image and real wells should be of the same type and operate at equal rates the stream function is treated likewise fig 8 repeats the previous one except that an impervious barrier lies along θ 37 it is observed that the boundary effects completely alter the flow pattern and there exists three stagnation points on the impervious barrier at radial distances r spa 3963 m r spb 5013 2 m and r spc 6369 4 m pairs of two convergent streamlines run tangential to the boundary merge at the stagnation points a and c and originate streamlines toward the wells a streamline coming from s 1 stagnates and splits at point b it divides the aquifer area into two subregions on the left zone water is fully captured by well 1 and on the right zone by well 2 sdr values computed for case 1 are q s 1 36 71 q s 2 43 19 and q s 3 0 1 m 3 day similarly one obtains q s 1 77 97 and q s 3 2 03 m 3 day for case 2 compared to case 1 more water is depleted from s 1 and s 3 in case 2 due to the absence of s 2 in each case the total sdr is equal to the sum of steady state well discharges q 1 q 2 80 m 3 day and this result is consistent with groundwater budget for the stream aquifer systems under consideration in case 3 a hypothetical remediation scheme is planned to contain a contaminant plume by a system of three wells in a stream aquifer system having the vertex angle ϕ 65 and h 2 15 m water is injected upgradient of the plume at the rate of q 1 35 m 3 day and then extracted by two downgradient wells at equal rates of q 2 q 3 40 m 3 day the well positions are r 01 θ 01 1900 m 43 r 02 θ 02 1600 m 20 and r 03 θ 03 2400 m 20 two stagnation points are identified on the bounding streamlines at r spa θ spa 1894 6 m 49 7 and r spb θ spb 1938 1 m 10 5 with this well configuration and injection extraction rates adopted all of the streamlines emanating from the injection site converge towards the extraction points fig 9 the total amount of injected water is thus captured and contaminant plume is contained zarei doudeji and samani 2018 the volumetric rates of stream aquifer water exchange are evaluated as q s 1 38 02 q s 2 1 62 and q s 3 8 61 m 3 day therefore the system of three wells receives water from streams s 1 and s 3 whereas s 2 has a net inflow from the aquifer this analysis excludes the amount of water exchange caused by regional flow again the volumetric rates mentioned above sum to that of the wells q 1 q 2 q 3 45 m 3 day 3 3 sdr maps sdr maps can help to assess the sensitivity of stream depletion rates in response to variations in the location of a single pumping well these can be prepared by continuously changing the well position within the aquifer area and calculating eqs 11 to 13 at those positions mahdavi 2019b a number of observations can be made from sdr maps of case 1 fig 10 and case 2 fig 11 i the boundary type constant head and no flow remarkably influences sdr map the closer the distance to s 1 in case 1 the larger the value of q s 1 will be however wells located even far away from s 1 in case 2 may significantly deplete water from it such trends may be identified by tracking any contour line e g q s 1 0 9 in fig 10a and fig 11a ii sdr maps of q s 1 and q s 2 in case 1 fig 10a are mirror reflections of each other with respect to the bisector of the wedge θ ϕ 2 the curves exhibit large variations prior to r 1400 m but become lines of constant θ as radial distance further increases ultimately a contour line labeled q s 1 β 0 β 1 will be asymptotic to the one labeled q s 2 1 β and so on iii in both cases sdr map of q s 3 is more sensitive to the well position in the vicinity of s 3 where contour lines are closely spaced fig 10b fig 11b the effect of q s 3 is diminishing over radial distance and in the limit when r goes to infinity the total amount of pumped water is supplied by depletion of other boundary stream s iv since the sum of q s 1 and q s 3 remains unity throughout the aquifer domain in case 2 a contour line labeled q s 1 β must coincide with the one labeled q s 3 1 β therefore one may conclude that sdr maps of q s 1 and q s 3 are geometrically the same and only differ in contour values fig 11 v interestingly a well located on the contour line q s 1 q s 3 0 5 will receive an equal contribution from each boundary stream in case 2 the area outside the contour line q s 1 0 9 in fig 11a is slightly influenced by s 3 and more than 90 of the pumped water comes from s 1 3 4 effects of regional flow gradient fig 12 demonstrates how the position of stagnation point associated with a single pumping well is affected by the gradient of regional flow in a confined aquifer the simulations are carried out by solving 14 for the specified values of ϕ 54 θ 0 27 r 0 1100 m and q t 1 m normalized parameters r r s p r 0 r 0 and θ θ 0 θ s p θ 0 are defined in fig 12 to better quantify the model response these measure respectively the radial and angular deviation of stagnation point from the well position the head remains fixed at h 1 13 m along the stream s 1 but h 2 is varied incrementally to induce regional flow proportional to the head difference between s 1 and s 2 from a 13 the gradient of regional flow i r 1 φ s θ at the well position is calculated as φ 2 φ 1 r 0 ϕ a lower bound must be specified for h 2 hence i so that generation of one stagnation point is ensured in each case below this limit the intensity of regional flow is not large enough to locally vanish flow velocities and there would be no root for 14 to fall within the aquifer domain by trial and error it is found that the above criterion is met if h 2 13 16 m the associated gradient is denoted by i min from fig 12 it is evident that the curves of r and θ reveal monotonic declining trends with steeper slopes prior to i 20 i min the position of stagnation point is thus more sensitive to the changes in the gradient of regional flow for relatively small values of i as i further increases one may conclude that the radial position of the stagnation point is approximately same as that of the well itself notice the negligibly small values of r indicating that r 0 r s p in practice although not shown here similar behavior was observed for different well positions 3 5 effects of wedge angle fig 13 explores the role of vertex angle of the aquifer domain on stream aquifer water exchange for 10 ϕ 70 the aquifer geometry is altered by increasing ϕ in 5 intervals and eqs 11 to 13 are evaluated accordingly for normalized radial position r 0 a 1 1 and θ 0 ϕ 2 so as to get q s 1 q s 2 in each case as fig 13 shows the aquifer domains characterized by larger values of ϕ produce smaller amounts of q s 1 due to increased distance between the well and s 1 the same applies to q s 2 too conversely the curve of q s 3 appears to rise consistently because the length of the aquifer interface with s 3 has increased proportional to ϕ while the well distance to this stream is fixed it is expected that the normalized rates sum to unity as confirmed by dashed line in fig 13 it is beneficial to assess the conditions under which the surrounding streams contribute equally to a single pumping well so that q s 1 q s 2 q s 3 1 3 e g point a in fig 13 where curves intersect at ϕ 13 03 equating 11 with 12 confirms that the well should lie along the bisector of the wedge θ 0 ϕ 2 substituting this in 13 after simplification gives the radial position of the well as being governed by a r 0 ω r 0 a ω 2 3 0 for q s 3 1 3 the equation is solved numerically for the normalized parameter r 0 a and results are shown in fig 14 for the range of aquifer angles mentioned earlier as ϕ increases the well should operate at a larger distance from stream s 3 to fulfill the condition of equal stream depletion rates 3 6 rainfall induced recharge the method of green s function enables handling bvps related to groundwater recharge in unconfined aquifers this allows recharge patterns to be distributed locally by artificial basins mahdavi and seyyedian 2013 mahdavi 2015 or globally by rainfall mahdavi 2019a case 4 addresses the effects of rainfall alone whereas a pumping well is added in case 5 initially the stream aquifer system is in hydraulic equilibrium maintaining a constant potential at φ 0 deviation from this may occur due to rainfall and the following bvp governs the aquifer response in terms of rainfall potential φ r 17 2 φ r r 0 where r 0 0 is the constant rate of infiltration strack 2017 in the present analysis the above bvp is subject to zero drawdown boundary streams the aquifer is naturally replenished by rainfall over the finite subregion a r b and 0 θ ϕ which defines the solution domain for the bvp the associated green s function g has a structure similar to that of a single well and is obtained by replacing q with r 0 in a 11 the potential field for case 4 is computed by integrating the green s function over the recharge area φ r 0 ϕ a b g r 0 d r 0 d θ 0 and then adding the contribution from streams φ s φ 0 to the result yielding 18 φ r θ φ 0 2 r 0 b 2 ϕ π 2 n 1 3 5 s i n n ω θ n 2 n ω 2 a 2 rb n ω r b n ω 2 n ω n ω 2 r b 2 a b 2 a r n ω note that the above summation runs over odd integers and denominator becomes singular if n ω 2 therefore the aquifer domains having vertex angles ϕ π 2 or ϕ 3 π 2 are excluded by 18 it is worth mentioning that the integral representation leading to 18 effectively suppressed the oscillatory nature of a 11 and improved the series convergence as well a similar smoothing effect in the context of artificial recharge problems has been reported by mahdavi and seyyedian 2013 in case 4 and case 5 a rainfall recharge of the intensity r 0 0 05 c m d a y is received by an unconfined aquifer having k 3 m d a y and ϕ 25 the recharge area extends radially between a 1000 m and b 2000 m eq 18 is evaluated for this stream aquifer setting where stream heads are all kept at h 0 10 m φ 0 k h 0 2 2 case 5 also incorporates a pumping well of the discharge rate q 100 m 3 day at θ 0 ϕ 4 and r 0 1200 m the potential for unconfined flow to the well is calculated from 4 and superimposed on 18 the flow net for case 4 and case 5 are depicted in fig 15 a and fig 15b respectively both cases reveal formation of a high stagnation point corresponding to the maximum head level point a in fig 15 streamlines disperse outwardly from this point in all directions in case 4 the contour map demonstrates an overall increase of head gradient hence velocities toward the boundary streams where consecutive equipotentials become closer to each other fig 15a this pattern helps to spread out an amount of recharge which gradually rises toward boundary streams since eq 18 has the property that φ r θ φ r ϕ θ the flow net obeys symmetrical aquifer domain in case 4 in case 5 however the well has a position offset from the bisector of the wedge so that the flow net loses its symmetry a well capture zone is delineated whose boundary consists of two streamlines passing through the points ab and ac inside the capture zone the pumped water is partially supplied by depletion of the stream segment between points b and c and partially by the rainfall recharge the latter is driven by a bundle of streamlines coming from point a which bend towards the well outside the capture zone the streamlines eventually become perpendicular to the streams s 1 and s 2 fig 15b the present solution is validated numerically against matlab finite element toolbox pdetool which offers a flexible environment for dealing with 2 d problems of groundwater hydraulics herckenrath et al 2013 mahdavi and seyyedian 2013 kacimov et al 2017 mahdavi 2019a b comparisons include head distribution along the radial lines θ ϕ 6 ϕ 4 and ϕ 2 in case 4 fig 16 a and θ θ 0 in case 5 fig 16b the numerical analysis is accomplished by defining an initial mesh of triangular elements for the domain discretization to achieve desired level of accuracy finite elements are adaptively refined to yield smaller triangles in close proximity of the well where heads drop abruptly in response to pumping the adaptive mesh refinement not only improves numerical convergence but also ensures mesh independency of the fem results yang et al 2005 fig 16 indicates that both the analytical and numerical methods are in strictly close agreement 4 conclusions a steady state analytical solution was derived for multiwell induced head variation in annular wedge shaped aquifers subject to uniform regional flow the solution removed the limitations regarding the aquifer vertex angle and wells can be of any numbers types positions and extraction injection rates the associated green s function benefits from an extremely simple mathematical structure and requires only a small number of function evaluations to arrive at flow nets the bvp was defined by three types of boundary configurations reflecting the physical reality of the borderlines it was shown that some existing solutions may be regarded as a special case of the present result qualitative assessment of the flow nets confirmed the validity of the solution in the test cases studied a layout of injection extraction wells was designed to hydraulically contain a contaminant plume in a hypothetical remediation scheme the pertinent property of green s function allowed dealing with the case of areal recharge due to rainfall in an inverse modeling framework this solution may serve to estimate the ratio r 0 k by fitting the computed equipotentials to those plotted from observed heads in the field the following conclusions can be drawn i if aquifer is surrounded only by streams along the borderlines the closer the well distance to the stream the larger will be the value of sdr for that stream conversely in presence of an impervious barrier the stream may significantly contribute to the pumping well located even far away from it ii for a single pumping well subject to relatively high gradient of the regional flow the radial position of the stagnation point is practically same as that of the well iii by an increase in the aquifer vertex angle ϕ the sdr values q s 1 and q s 2 decline but q s 3 rises so that the sum of these quantities remains unity in each case iv a single pumping well is allocated in such way that the surrounding streams contribute equally to the amount of pumped water at its position the well lies along the bisector of the wedge and by increasing ϕ it should be located further away from s 3 in order to satisfy the condition of equal sdrs however there is no unique solution in the presence of impervious barrier rather a locus of the points exists as indicated by contour lines q s 1 q s 3 0 5 in fig 11 credit authorship contribution statement ali mahdavi conceptualization methodology validation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a derivation of 4 since the bvp is subject to nonhomogeneous boundary conditions 2 the aquifer response is decomposed into separate components reflecting the contribution from multiwells φ w and the regional flow due to difference in the potential of boundary streams φ s the bvps associated with φ w and φ s are illustrated in fig 3 the multiwell induced head distribution is constrained by homogeneous boundary conditions fig 3b while the regional flow is derived by nonhomogeneous boundary conditions fig 3c for the former subproblem the method of eigenfunction expansion constructs a series solution containing products of radial and angular components as given by a1 φ w r θ n 1 u n r sin n ω θ similarly the dirac delta function is expanded into a fourier trigonometric series a2 δ θ θ 0 i 2 ϕ n 1 sin n ω θ sin n ω θ 0 i given the uniqueness of the fourier series coefficients and substituting a 1 and a 2 into the bvp of fig 3b one derives a nonhomogeneous ode for the radial component a3 d 2 u n r d r 2 1 r d u n r d r n ω r 2 u n r 2 r ϕ i 1 n q i δ r r 0 i sin n ω θ 0 i the solution of which reads a4 u n r c 1 r n ω c 2 r n ω 1 n π i 1 n q i h r r 0 i r r 0 i n ω r 0 i r n ω sin n ω θ 0 i with h being the heaviside function the first two terms on the right hand side of a 4 represent complementary solution consisting of fundamental set r n ω and r n ω with non zero wronskian the last term containing finite series is the particular solution associated with the fundamental set and it is obtained by the method of variation of parameters boyce et al 2017 to determine the unknown coefficients c 1 and c 2 the homogenous boundary conditions in terms of the radial component are imposed on a 4 the two conditions read u n a 0 and lim r d u n r d r 0 since r 0 i a the heaviside function vanishes for r a simplifying the first condition to a5 c 1 a n ω c 2 a n ω 0 differentiating a 4 term by term in r the second condition converts to a6 l i m r r n ω 1 c 1 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i r n ω 1 c 2 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i 0 the second term identically vanishes because l i m r r n ω 1 0 in the first term however the magnitude of r n ω 1 grows unbounded if n ω 1 otherwise it becomes unity for a 6 to hold in either case the factor of r n ω 1 must be equal to zero resulting in a7 c 1 1 n π i 1 n q i r 0 i n ω sin n ω θ 0 i inserting the above coefficient in a 5 gives a8 c 2 1 n π i 1 n q i a 2 r 0 i n ω s i n n ω θ 0 i the radial component thus takes the following form a9 u n r 1 n π i 1 n q i a 2 r 0 i r n ω r r 0 i n ω r r 0 i n ω r 0 i r n ω h r r 0 i s i n n ω θ 0 i the heaviside function splits a 9 into two branches depending on the relative position of the head observation point with respect to the well substituting these in a 1 leads to the following expression for the potential distribution due to multiwells a10 φ w r θ i 1 n n 1 q i n π a 2 r 0 i r n ω r r 0 i n ω sin n ω θ 0 i sin n ω θ f o r a r r 0 i a 2 r 0 i r n ω r 0 i r n ω sin n ω θ 0 i sin n ω θ f o r a r 0 i r where 0 θ ϕ both branches can be rendered in a single form valid over the entire solution domain a11 φ w r θ i 1 n n 1 q i η i n λ i n 2 n π cos n ω θ θ 0 i cos n ω θ θ 0 i the interior series is manipulated according to the following summation formula gradshteyn and ryzhik 1980 melnikov and melnikov 2012 a12 n 1 λ n n cos n χ 1 2 l n 1 2 λ c o s χ λ 2 it is to be noted that the constrains λ 1 and 0 χ 2 π required for the convergence of above formula are met because η i 1 λ i 1 and 0 ω θ θ 0 i 2 π in the present setting this converts a 11 to a compact and easily computable form which is free from infinite series as appears on the right hand side of 4 eq a 13 expresses potential distribution induced by regional flow satisfying the bvp in fig 3c a13 φ s φ 1 φ 2 φ 1 θ ϕ similar solutions for the regional flow in rectangular shaped aquifers can be found in the literature yeo and lee 2003 the principle of superposition φ φ w φ s completes the desired solution for the bvp in fig 3a leading to 4 appendix b derivation of 7 manipulation of the cauchy riemann equations 5 and 6 involves indefinite integrals of the generic form given by b1 i 1 1 2 λ l n 1 2 λ c o s χ λ 2 χ d λ and b2 i 2 λ 2 l n 1 2 λ c o s χ λ 2 λ d χ by introducing the change of variable γ λ s i n χ 1 λ c o s χ and substituting d γ s i n χ 1 λ c o s χ 2 d λ in b 1 and d γ λ c o s χ λ 1 λ c o s χ 2 d χ in b 2 the integrals convert after straightforward algebra to b3 i 2 i 1 d γ 1 γ 2 tan 1 γ eq 5 is integrated term by term in r with the potential field coming from 4 as follows b4 ψ r θ φ 1 φ 2 r ϕ d r i 1 n q i 4 π θ ln w η i ln w η i l n w λ i l n w λ i d r r the first integral is φ 1 φ 2 ϕ ln r note that λ i r r 0 i ω for r r 0 i and consider the first integral in the summation term b5 ln w η i θ d r r θ ln 1 2 a 2 r 0 i r ω cos ω θ θ 0 i a 2 r 0 i r 2 ω d r r if λ a 2 r 0 i r ω and χ ω θ θ 0 i then d r r 1 ω d λ λ and θ ω χ therefore the above integral can be written according to b 1 as b6 l n 1 2 λ c o s χ λ 2 χ d λ λ 2 t a n 1 a 2 r 0 i r ω sin ω θ θ 0 i 1 a 2 r 0 i r ω cos ω θ θ 0 i 2 f η i the other integrals are treated likewise converting b 4 to b7 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i f λ i f λ i f 1 θ the expression for f was already defined in connection with 7 similarly if r 0 i r then λ i r 0 i r ω and b8 ψ r θ φ 1 φ 2 ϕ ln r i 1 n q i 2 π f η i f η i f λ i f λ i f 2 θ the sole functions of angular coordinates f 1 θ and f 2 θ arise as constant of integration since they are not varying with r to determine these functions eq 6 is integrated in θ according to b 2 one obtains for r r 0 i b9 ψ r θ i 1 n q i 2 π f η i f η i f λ i f λ i f 3 r and for r 0 i r b10 ψ r θ i 1 n q i 2 π f η i f η i f λ i f λ i f 4 r where f 3 r and f 4 r are constant of integration in a fashion similar to those mentioned above by equating b 7 with b 9 and b 8 with b 10 it immediately follows that f 3 r φ 1 φ 2 ϕ ln r f 1 θ and f 4 r φ 1 φ 2 ϕ ln r f 2 θ for these relations to hold both of the functions f 1 θ and f 2 θ must be constant chosen arbitrarily equal to zero without loss of generality the solution can be recast in a more compact form appeared in 7 
5517,errors from hydrological simulations have substantial influence on hydrological applications there are increasing interests to incorporate statistical models of the errors error models into hydrological applications to improve simulations however conventional error models are usually temporally unvaried and may be inadequate to handle model simulation errors when the underlying error statistics are strongly seasonal to overcome this problem the use of temporally varied error models in both prediction and forecasting applications are investigated we analyze different levels of temporal granularity to identify the optimal temporally varied error model to best improve simulations and to quantify uncertainty the error reduction and representation in stages erris model is adapted in this study to improve streamflow simulations produced by the variable infiltration capacity model for the yarlung tsangbo river basin well marked seasonal and sub seasonal variations in error statistics are found accordingly three temporally varied erris models are constructed at semi annual erris h seasonal erris s and monthly erris m temporal granularity and compared with a benchmark model the temporally unvaried model erris a results show that the temporally varied erris models are considerably more effective than the temporally unvaried one with 34 reduction in continuous ranked probability score crps and 23 increase in nash sutcliffe efficiency nse for prediction applications with respect to forecasting applications improvements of about 7 in crps are achieved by the temporally varied models the performance of different temporally varied error models roughly follows the same order as the level of temporal granularity generally erris s and erris m are similarly effective with erris m providing additional improvement by more than 15 in crps for the spring season and by at least 30 for the autumn season it is concluded that the consistency of temporal granularity between error models and variations of error statistics is the key to effective error reduction and uncertainty quantification when complicated hydrological processes exist hydrological model tends to produce seasonally and even sub seasonally varied error statistics consequently temporally finer error models are expected to lead to higher accuracy and reliability keywords temporal variation in error statistics statistical models of the errors uncertainty quantification hydrological ensemble prediction 1 introduction hydrological models are commonly used to aid planning and operations of water resources jin et al 2010 li et al 2013 abbaspour et al 2015 model simulations need to be sufficiently accurate for practical applications faramarzi et al 2015 lievens et al 2015 fan et al 2015 model simulation errors may arise from three sources of uncertainty model initial condition e g soil moisture model external forcing e g precipitation and model structure and parameters xu et al 2007 tian et al 2015 liu et al 2016a b liu et al 2017a wang et al 2018 careful analyses of model simulation errors are valuable for identifying ways to improve the modelling and for developing practical tools to make better use of model outputs dogulu et al 2015 evin et al 2014 smith et al 2015 wang et al 2018 model simulation errors can be analyzed in many ways in this study we focus on characterizing how model simulation error statistics change with the time of year this is particularly useful if the underlying hydrological processes are strongly seasonal for many mountainous catchments snow glacier meltwater and rainfall induced runoffs coexist the dominant processes may be snow ablation in spring rainfall runoff and glacier melting in summer and snow glacier accumulation in autumn and winter changes in error statistics with the time of year reflect the varying degree of success of a model in simulating these processes information on the changes may help constructing hypotheses on ways to improve the model a more immediate benefit of characterizing model simulation errors is the possibility to reduce the errors through bias correction and simulation updating and to quantify any remaining uncertainty to this end statistical models of the errors hereinafter referred to as error models can be constructed and used as a tool to post process model simulations ye et al 2014 2015 roulin and vannitsem 2015 lucatero et al 2018 bogner et al 2017 error models used in past hydrological studies are mostly temporally unvaried lucatero et al 2018 bogner et al 2017 and they may not work effectively if the error statistics are found to change with the time of year in this study we investigate the use of temporally varied error models with different levels of temporal granularity to improve simulations and to quantify uncertainty post processing hydrological model simulations has two broad categories of applications the first is for prediction when real time observations of the model output variables are not available to update the model simulations the second is for forecasting when real time observations of the model output variables are available to update the model simulations however as forecast lead time increases the effect of updating will diminish and the second category will approach the first category examples of prediction applications of post processing can be found in climate change impact studies errors introduced by hydrological models can be substantial even as great as climate change steinschneider et al 2015 troin et al 2018 vetter et al 2017 post processing of model simulations has been demonstrated effective in removing the biases brown and seo 2013 pagano et al 2013 cannon et al 2015 zhang et al 2015 the most well known post processing approach is quantile mapping qm cannon et al 2015 zhang et al 2015 lucatero et al 2018 which matches the cumulative distribution function cdf of model simulations to the cdf of observations although qm is effective in reducing biases zhao et al 2017 it does not quantify simulation uncertainty for forecasting applications updating methods are often used to reduce forecast errors chen et al 2015 gragne et al 2015 si et al 2015 liu et al 2017b meng et al 2017 updating can be achieved by post processing simulation outputs gragne et al 2015 or by changing model states si et al 2015 in the operational forecasting post processing simulation outputs is widely adopted due to its simplicity and effectiveness liu et al 2016a the most commonly used error models are autoregressive models ar under the assumption that the forecast errors are sequentially related liu et al 2016b wu et al 2012 in most cases ar updating is performed deterministically without quantifying uncertainty chen et al 2015 gragne et al 2015 wu et al 2012 in this study we adapt an error model called error reduction and representation in stages erris introduced by li et al 2016 2017 the staged approach of this error model addresses both the prediction and forecasting applications it is also capable of quantifying remaining uncertainty of the model simulations in the study by li et al 2017 the erris error model was applied to rising and falling limbs of hydrograph respectively in this study we investigate how to best vary this error model to deal with model simulation errors that temporally change in characteristics more specifically we want to identify the level of temporal granularity of the error model at which the temporally varied erris error model is the most effective in improving simulations and quantifying uncertainty the rest of this paper is organized as follows section 2 provides a brief introduction to the study area and datasets involved section 3 introduces temporally varied erris models and evaluation methods section 4 provides analysis and evaluation results discussions and conclusions are presented in section 5 and 6 2 study basin and data 2 1 study basin the study basin is the yarlung tsangpo river ytr basin the upper reach of brahmaputra located in the southern tibetan plateau fig 1 a the ytr basin is one of the highest basins in the world with an average elevation over 4000 m above sea level the hydrological station used in this study is nuxia station with a drainage area of about 2 1 10 5 km 2 the ytr basin is part of the indian ocean water system exhibiting obvious variation in climate from upstream to downstream regions liu et al 2014 from west to east the climate undergoes a series of regimes cold and dry temperate steppe climate temperate forest grassland climate and subtropical humid and warm climate shen et al 2012 the rainy season usually begins from may or june and ends at the end of september or october capturing 60 80 of the annual precipitation you et al 2007 the average annual precipitation is about 560 m m and the average annual temperature is about 6 27 c liu et al 2019 previous studies reported that the meltwater induced streamflow accounted for 38 of the total streamflow in 1969 at nuxia station liu 1999 cuo et al 2014 more recently chen et al 2017 found that during the study period from 2003 to 2015 snow and glacier runoffs contributed 10 6 and 9 9 to the total runoff respectively snow distribution is shown in fig 1 b snow is present in most parts of the basin especially for the upper lower reach and the southern region where the himalayas mountain is located similar distribution can be found for glacier in fig 1 c 2 2 data description the precipitation data used in this study is the rain gauge based product cgdpa shen and xiong 2016 which has been successfully applied in the ytr basin chen et al 2017 cgdpa is a gridded daily precipitation analysis product over mainland china with a resolution of 0 25 0 25 it was developed by the china national meteorological information center for the china meteorological administration cma based on the climatological optimal interpolation algorithm xie et al 2007 the minimum and maximum temperatures wind speed and relative humidity from 1997 to 2015 were collected and interpolated from 27 national meteorological observatory stations located in and around the ytr basin as shown in fig 1 a observed daily streamflow for the same time period at nuxia station was obtained from hydrology and water resource bureau of tibet the data of 1997 was used for warming up data from 1998 to 2008 and 2010 to 2015 were adopted for calibration and validation due to the data missing in 2009 snow depth data was downloaded from the cold and arid regions science data center at lanzhou http westdc westgis ac cn the data was derived from passive microwave remote sensing at a resolution of 0 25 0 25 che et al 2008 glacier area and location were obtained from the second glacier inventory dataset of china liu et al 2014 the digital elevation model dem data used in hydrological modelling was downloaded from geospatial data cloud http www gscloud cn at a resolution of 90 m 90 m the vegetation and soil parameter in the model were defined according to 1 k m china soil map based on harmonized world soil database fischer et al 2008 and 1 k m land cover products of china ran et al 2010 3 methodology 3 1 hydrological model and glacier module the variable infiltration capacity vic macroscale hydrologic model liang et al 1994 was adopted in this study various features in vic such as two layer energy balance snow model andreadis et al 2009 snow elevation bands scheme and frozen soil permafrost algorithm cherkauer and lettenmaier 1999 make it tailored for applications in high mountain basins like the ytr one deficiency of the model is that no glacier process is considered in the current model version 4 2 we note there are two different ways to simulate glacier melting the energy balance model and the temperature index model shrestha et al 2015 given the limited observations in the study area the temperature index model was selected and added to the original model according to zhang et al 2013 and su et al 2016 the total runoff from each grid cell is calculated through the formula 1 q i f i g i 1 f i r vic i in which q i is the total runoff in grid i f i is the glacier area fraction within grid i which is computed from the ratio of glacier area and total gird cell area r vic i is the original total runoff from vic g i is calculated as 2 g i ddf temp i if temp i 0 0 if temp i 0 where ddf is the degree day factor for glacier mm c 1day 1 and is calibrated with a prescribed range from 0 to 10 as suggested by chen et al 2017 temp i is the daily mean air temperature it is assumed that the glacier melting is late to snow melting indicating that the glacier will not melt until the snowpack becomes zero in a grid hydrological model was calibrated based on a composed objective function the simulated snow depth was introduced together with streamflow to calibrate parameters by model efficiency indicator 3 obj 0 5 1 q o t q s t q o q s t 0 5 1 n i 1 n 1 d o i t d s i t d o i d s i t wherein q o and q s are observed and simulated streamflow d o i and d s i are observed and simulated snow depth at i th grid n is the total number of grids in the ytr superscript bar means average value snow depth and streamflow are given the same weight during calibration the absolute error rather than squared error is adopted to give importance to the fitting of both low and high values 3 2 erris model the error reduction and representation in stages erris method was originally proposed by li et al 2016 to deal with the overall simulation errors of streamflow from hydrological models for short term streamflow forecasting the method is performed in multiple stages to progressively improve the simulations of streamflow and the estimates of remaining uncertainty to induce normally distributed and homoscedastic residuals erris applies to the observed streamflow q t the log sinh transformation wang et al 2012 4 z t b 1 log sinh a b q t in which a and b are transformation parameters the same transformation is also applied to model streamflow simulation q t to give z t in stage 1 the error model is defined as 5 z t n z 1 t σ 1 2 where the subscript 1 indicates stage 1 and n denotes a gaussian distribution of the observed streamflow with mean z 1 t and standard deviation σ 1 in stage 2 we make a bias correction to the model simulation from stage 1 to give 6 z 2 t c z 1 t where c is the correction amount the error model becomes 7 z t n z 2 t σ 2 2 where σ 2 represents the standard deviation of the residual as shown the bias correction in eq 6 is not conditional on z 1 t the original erris applies in stage 2 a bias correction that is conditional on z 1 t as 8 z 2 t c d z 1 t where d is a slope parameter as the magnitude of z 1 t can vary with the time of year for highly seasonal rivers the effect of the conditional bias correction cbc of eq 8 can be seasonal too this will interfere with the function of temporal variation of error models to be introduced in the next subsection which is intentionally to deal with the problem that error characteristics can vary with the time of year for this reason we use unconditional bias correction ubc of eq 6 in stage 2 for this study in stage 3 a restricted autoregressive updating is applied to use the information from the latest available observations of streamflow given by 9 z 3 t z 2 t ρ z t 1 z 2 t 1 i f q 3 t q 2 t q t 1 q 2 t 1 f q 2 t q t 1 q 2 t 1 o t h e r w i s e in which q 3 t f 1 z 2 t ρ z t 1 z 2 t 1 and q 2 t f 1 z 2 t f 1 is the back transformation of log sinh transformation in eq 4 ρ is the lag 1 autocorrelation parameter then the error model in this stage is expressed as 10 z t n z 3 t σ 3 2 the rationale for using the restricted autoregressive updating can be found in li et al 2015 in stage 4 a two component gaussian mixture distribution is adopted to refine the residual distribution after autoregressive updating at stage 3 detailed mathematical expressions are as follows 11 z 4 t z 3 t 12 z t m n z 4 t σ 4 1 2 σ 4 2 2 ω where m n z 4 t σ 4 1 2 σ 4 2 2 ω indicates a mixture gaussian distribution of n z 4 t σ 4 1 2 and n z 4 t σ 4 2 2 with weights ω and 1 ω assumption is made that σ 4 1 is smaller than σ 4 2 to identify the two components all the parameters including c ρ ω and standard deviation σ i of residuals at each stage are calibrated using the shuffled complex evolution sce algorithm duan et al 1994 by maximizing the log likelihood functions in this study our evaluation focuses on stage 2 and 4 the error model established at stage 2 is used to evaluate model performance for post processing streamflow in prediction applications where no real time observations are required and error model established during training period can be directly used for testing period the final error model constructed at stage 4 uses observations in the previous time step to updating streamflow this is the case for forecasting applications with a lead time of 1 day 3 3 analysis of temporal variation in error statistics analyzing how error statistics vary with time of the year is a key component in this study error statistics are calculated from model residuals which are the differences between observed and simulated values after the log sinh data transformation positive residuals mean underestimation and negative residuals indicate overestimation to investigate variations of error statistics between different seasons of the year the density distribution of the residuals is constructed for each season by pooling data for individual season from all years the residual distributions are expected to be normally distributed because of the transformation applied the distributions for the four seasons are inspected for differences in means and spreads this analysis is further refined to investigate variations of error statistics between different months of the year when error statistics are obtained we make speculative hypothesis from indirect observation in attempt to interpret the possible cause for the temporal variation in error statistics in this regard a reasonable interpretation can be deduced based on existing meteorological data it is well acknowledged that streamflow in the ytr basin is mainly composed of rainfall snowmelt and glaciermelt chen et al 2017 zhang et al 2013 the rainfall induced and snow induced streamflow can be deduced by the analysis of rainfall and snow depth since the glacier melting amount in this study is calculated by the temperature index model positive temperature plays an important role according to eq 2 to this end an analysis of monthly rainfall snow depth and positive temperature changing in a year is conducted 3 4 temporally varied error models once temporal variation in error statistics is found to be prevalent the next step is to construct temporally varied error models to address the variation the question is what level of temporal granularity is appropriate for these models we use the term temporal granularity to describe the temporal scale below which the error distributions are treated as homogeneous conceptually models of finer granularity are more flexible for describing temporal variation however the finer models require more model parameters and may suffer model overfitting in this study we investigate four levels of temporal granularity the corresponding error models are listed in table 1 the annual model erris a is temporally unvaried and serves as a benchmark the other three models erris h erris s and erris m correspond to semi annual seasonal and monthly scales the details of the generic erris model are already given in section 3 2 the generic erris model is applied here to different temporal scales to give rise to the three sets of temporally varied error models the performances of these models are evaluated through cross validation the leave two year out cross validation is undertaken from 2010 to 2015 only results for the first year of the two year validation period is used to avoid artificially gained performance for clear and logical presentation the results in this study are displayed for all the four stages of erris but results at stage 2 and stage 4 are our foci performances of the erris a erris h erris s and erris m models are evaluated 3 5 evaluation methods multiple metrics are used to evaluate model performances including accuracy and reliability firstly the overall performance is quantified using the continuous ranked probability score crps eq 13 hersbach 2000 crps has a range from 0 to infinity smaller crps is preferable 13 crps 1 k i 1 k p q h q q a 2 d q where p q is the cumulative distribution function of variable q h q q a is the heaviside function which is 1 when q q a 0 and 0 otherwise q and q a are forecasted and observed variable respectively k is the length of time series consistent with the objective function used to calibrate vic the model efficiency eq 3 but leaving the snow depth components out is employed together with nash sutcliffe efficiency nse eq 12 to depict model accuracy a greater value of model efficiency or nse indicates more accurate mean forecasts and thus better forecast skill 14 nse 1 t 1 k q t q t 2 t 1 k q t q 2 where q t and q t are observed and simulated streamflow q is the mean value of observations the indicator used to describe reliability is based on the forecast probability integral transform pit π t schepen et al 2018 which should follow a uniform distribution if forecasts are perfectly reliable for graphical comparison pit values are displayed on a uniform probability plot pit plot perfectly reliable forecasts should show up as points placed onto the 1 1 line a kolmogorov confidence band is shown in the pit plot to provide a formal test of uniformity points remaining inside these confidence bands indicates the test is passed laio and tamea 2007 additionally α index is used to summarize the deviations of the actual pit values from the 1 1 line renard et al 2010 15 α 1 2 n t 1 n π t t n 1 where π t is the sorted π t in increasing order n is the sample size α index ranges from 0 to 1 1 indicate perfect reliability 4 results 4 1 temporal variation in error statistics the seasonal and monthly distributions of errors in simulated streamflow are presented in figs 2 and 3 it is noticeable that error distributions present well marked seasonal variations a gradual change from overestimation to underestimation can be seen from spring to winter in spring there is a large variance in model residuals a smaller variance can be found for summer monthly error distributions also exhibit changes from underestimation to overestimation and back to underestimation streamflow from april to september has the tendency to be over simulated especially for april and may underestimation can be found in remaining months remarkably from november to february streamflow in september has the smallest mean bias the variance of model residual distribution varies with month being the largest from december to march in summer and winter the error distributions are steady with streamflow consistently overestimated or underestimated in spring and autumn the error distributions are more transitional in spring bias pattern transits into overestimation from underestimation and in autumn the overestimation bias is gradually replaced by underestimation bias to interpret variation in error distributions the distribution of snow depth in a year is plotted together with precipitation and positive temperature in fig 4 the error distributions in spring are speculated to be mainly caused by varying degree of success of vic simulating snow melting and in autumn by snow accumulating fig 4 a rainfall and glacier meltwater are the two dominant factors for errors in summer the relatively large variance in error distributions of spring is possibly due to the imperfect modeling of the cooccurrence of snowmelt rainfall and glacier melt in this period in winter frozen soil modelling in vic plays an important role in simulation errors 4 2 overall evaluation of the temporally varied error models figs 5 7 show performance for the entire streamflow time series it is noticeable that different erriss vary substantially and the general performance roughly but not always follows the same order as the level of temporal granularity considerable improvements are observed from temporally unvaried erris erris a to temporally varied ones the performance for prediction stage 2 and forecasting stage 4 applications are markedly improved with much preferable results for forecasting applications for prediction applications stage 2 erris a is found to have a negative effect on raw simulations increasing crps by 20 and decreasing accuracy by about 15 compared to raw results at stage 1 improvements from erris a to erris h amount to 34 in crps 14 in model efficiency and 23 in nse erris m performs the best according to crps and accuracy metrics more specifically crps of erris m is about 229 m 3 s amounting to only half of erris a difference between erris h and erris s is negligible in terms of crps and α index for accuracy higher nse is obtained compared with model efficiency indicating generally better results in high flows erris based on finer temporal granularity tends to improve accuracy more efficiently the exception is that semi annual model is better than seasonal model in terms of nse fig 5 c erris m is able to improve accuracy by more than 4 compared to erris h s and by at least 20 to erris a for reliability fig 5 d erris h and erris s are found to produce more reliable predictions however pit plot shows that predictions by erris s are somewhat over predicted with pit points in fig 6 c scattered above the diagonal laio and tamea 2007 erris m is not as effective as erris h and erris s but the improvement is still impressive compared to erris a moreover erris m and erris h are the only two models completely pass the uniformity test fig 6 pit plot by erris a deviates substantially from the 1 1 line with a clear s shape pattern indicating too narrow predictions with regard to forecasting applications all models are similarly effective generally slightly better forecasts are provided by erris s closely followed by erris h or erris m erris s is able to provide additional improvements by about 7 compared to erris a and by 5 to erris m and erris h the performance of forecasts from erris h and erris m do not differ much indicated by similar crps model efficiency and nse in the evaluation of reliability erris m fails to retain the advantages providing smaller α index than others erris a turns out to be the worst updating method with greater crps and lower accuracy all four models perfectly pass the uniformity test as shown by grey points in pit plot fig 6 hydrographs in fig 7 demonstrate increasing agreement between observations and predictions with increasing level of temporal granularity the overestimation of raw high flows seems to be exaggerated by erris a the possible reason is that the overall error distributions are opposite to those for high flows making erris a sacrifice the improvement in high flows to achieve overall improvement in entire flows those results are consistent with fig 5 b c as the agreement between forecasts and observations can be denoted by model efficiency and nse erris h fails to post process the high flows during falling limbs erris m is superior than erris s with high agreement in both high and low flows hydrograph at stage 4 are omitted as the results are extremely similar and the differences in plots are minor 4 3 performance by season further performance is analyzed for each of the seasons in terms of prediction applications it is noticeable that effects of temporally varied erriss are similar in summer and winter with slightly superior performance by erris s fig 8 in spring and autumn erriss behave highly differently erris m is detected to provide the best results with additional improvements in crps by more than 15 in spring and by at least 30 in autumn in autumn erris m is the exclusive post processing approach producing improved flows compared with raw simulations stage 1 this is perhaps attributed to the transitional error distribution in spring and autumn fig 3 erris at larger temporal granularity has difficulty in reducing bias and in improving simulations erris a is the poorest post processing approach in all four seasons at stage 4 the values of crps are dramatically reduced in low flow period spring and winter crps becomes smaller than 20 of raw crps particularly in winter crps is smaller than 20 m 3 s flows from four erriss are similarly good and those form erris s are preferable with crps further improved by about 15 in spring with regarding to accuracy a deterioration from raw simulation can be seen at stage 2 for both erris a and erris h fig 9 analogous to fig 5 b the negative effects of those two error models mainly take place in spring and autumn erris m is the only model producing continuous improvement compared with raw simulations in all seasons predictions by erris s are equally matched to erris m in spring and summer in winter erris s outperforms erris m erris a exhibits fairly poor performance in most seasons after autoregressive updating stage 4 substantial improvements are present in spring and winter model efficiency in spring are improved to be greater than 0 8 and in winter the value increases from 0 1 to near 0 75 all four erriss perform similarly with slightly better agreement with observations by erris s reliability for prediction application stage 2 is relatively consistent for various erriss in autumn fig 10 c erris a is proved to be the worst with the smallest α index in all four seasons erris a tends to deteriorate raw simulations in spring by 24 and by 17 6 in summer erris s and erris m are consistently the best models in all four seasons as for performance in forecasting stage 4 erris m produces the highest reliability in most seasons followed by erris s as a supplement pit diagrams in spring and winter are plotted in fig 11 to show more details it is shown that at stage 2 only erris m passes the test of uniformity in these bias transitional seasons with scatters within the kolmogorov confidence bands flows by erris a and erris h are obviously over predicted in spring and under predicted in winter at stage 4 the over prediction under prediction by erris a persists 4 4 performance by month performance at monthly scales is displayed in fig 12 to avoid redundant figures only results at stages of interest stage 2 and 4 are shown for prediction applications it is clear that erris m provides the overall best fig 12 a the most accurate fig 12 c and the most reliable fig 12 e results in most months combining information in figs 2 and 3 better results are detected in erris s when error statistics in a month are consistent with those in the season where the month belongs to for example flows in october are more preferable than those in september fig 12 a c and e it is caused by the similarity between the means of error statistics in october fig 3 and in autumn fig 2 c the overestimation bias in september is opposite to the overall underestimation bias in autumn making erris s fail to effectively correct the error in this month this is also the reason why erris a fails to improve flows compared with raw simulations black lines during months from april to september means of error statistics in those months are broadly deviated from the overall underestimation bias the inferiority of erris h mainly occurs from september to october consistent with the results in fig 7 b where erris h fails to correct errors in falling limbs for forecasting applications erris s is proved to be the best updating method in terms of crps especially during high flow period according to model efficiency all four erriss behave similarly except in march in march snow begins to melt and rainfall and temperature start to increase fig 4 complicated hydrological processes are highly likely to cause complicated error statistics resulting in widely varied performance by different temporally varied erriss erris m gives the highest reliability producing the best α index during most months 5 discussion this study presents a comparison between different levels of temporally varied error models in the comparison of streamflow time series erris a is found to have inferior performance in post processing high flows fig 7 a as evaluation of erris models is largely reflected from the calculated distribution of model residuals in each stage relevant parameters are indicative for the model performance according to the constant and positive parameter c value at stage 2 in erris a see s1 a in supporting information erris a tends to force the mean of error statistics to add a positive value consequently better correction in underestimated streamflow is expected while the overestimation in high flow become exaggerated parameter c is dedicated to correcting the mean of distribution of error models as shown in eq 6 overestimation bias is corrected by negative c value and vice versa therefore the identical parameter c in erris s and erris m models and means of seasonal monthly error statistics figs 2 and 3 explains superior improvements from these two models figs 5 7 in fig 7 it is difficult to detect the prediction uncertainties due to the narrow ensemble spread compared with the streamflow analyzing standard deviation is another direct way to depict uncertainties standard deviation in gaussian distribution is a scale parameter determining the statistical dispersion of the probability distribution the larger the scale parameter the wider the distribution and thus greater uncertainty sharp but unreliable forecasts usually result in risky decisions due to the overconfidence erris a has the lowest reliability during winter time fig 10 d and the smallest scale parameter s1 b making the forecasts fairly overconfident and thus untrustworthy on the contrary the other three erriss especially erris m provide more appropriate predictions in which high reliability is accompanied with smaller standard deviation flows in summer are highly reliable and simultaneously sharp by all erriss another advantage of the temporally varied error models is the ability to utilize information from the previous day in a more rational way the lag 1 autocorrelation parameter ρ quantifies the influence of errors from the day before as erris a is set up based on all data without considering sub annual error statistics model treats errors from lag 1 day with the same weight for the entire year however during the low flow period of actual hydrological regime streamflow is dominated by baseflow or other slowly evolved hydrological process the errors in consecutive days tend to be similar consequently higher ρ value is derived when it comes to the wet season the streamflow becomes changeful due to the fickle weather rain and temperature which makes errors vary significantly hence information from the day before becomes less important and smaller ρ value is present from this point of view the way in which erris h erris s and erris m treat errors from the day before is more reasonable s1 c and thus higher efficiency is found for these three erriss compared with erris a the purpose of this study is to find the most appropriate temporal granularity to establish effective enough error model according to the computed statistical metrics the performance is not linearly correlated with temporal granularity the improvements from erris a to erris h are substantial and gradually diminish when it moves to further finer erris models figs 5 11 the difference becomes minor for erris s and erris m especially when no sub seasonal error statistics exists in one season as shown in figs 8 10 but for spring and autumn when the streamflow is generated by complicated hydrological processes the error distribution tends to be transitional making the erris at seasonal temporal granularity fail to correct the bias and to reduce uncertainty effectively this is also the reason why erris h produced similarly good even better results than erris s according to averaged metrics from entire streamflow timeseries fig 5 c although coarser temporal granularity is used for erris h the key point is that erris h separates the varied error statistics into two homogenous parts while for erris m the performance during spring and autumn transitional error distribution is present and lumped to some degree undermines the overall quality therefore when conducting either post processing or updating one should keep in mind that when error statistics in a targeted temporal granularity are transitional it will be better to set up the error models based on dataset at a finer time scale so as to address bias and to quantify uncertainty more effectively when the bias is consistently negative or positive the post processing based on coarser temporal granularity is recommended for time saving and lower computation cost certainly if the training data are long enough one could always go with finer temporal granularity however when there is not enough data for estimating parameters of a finer model the problem of overfitting could occur 6 conclusion strongly seasonal hydrological processes in mountainous basins are likely to cause error statistics to change with the time of year thus the conventional temporally unvaried error models are inefficient in reducing errors over such regions in this study several temporally varied errors models are constructed at semi annual seasonal and monthly temporal granularity based on the analysis of temporal variation in error statistics the results are compared to identify the optimal level of temporally varied error model we conduct our study in the yarlung tsangbo river basin southern tibetan plateau china the error models are used to improve streamflow simulated by vic model performance is evaluated for both prediction and forecasting applications for prediction applications the observations are unavailable and the error models are used as post processing approaches for forecasting applications the error model is more like an updating method using available observations the major findings of this study are summarized as follows 1 simulations in the study area present remarkable seasonal and sub seasonal variations in error statistics error distributions in spring and autumn are obviously transitional with means of error distribution shifting from underestimation or overestimation to the opposite one reason is the varied degree of success of vic in simulating the cooccurrence of snow rainfall and glacier in these periods during other seasons error statistics are more homogeneous consistently underestimated in summer and overestimated in winter 2 temporally varied erris models are far more effective than temporally unvaried one for prediction applications improvements from erris a to erris h are substantial up to 34 in crps and 23 in nse erris a is found to negatively affect raw simulations deteriorating crps by 20 and by about 15 for accuracy with regard to forecasting applications slightly better forecasts are still produced by temporally varied models with improvements of about 7 by erris s and of 3 by erris m and erris h achieved 3 the general performance of different temporally varied error models approximately aligns with the level of temporal granularity in most cases erris s and erris m perform fairly similarly error model at seasonal temporal granularity is thus fine enough to address bias and to reduce uncertainty whilst during spring erris m is able to provide additional improvements by more than 15 according to crps and by at least 30 in autumn for prediction applications therefore further finer model erris m is recommended with higher accuracy and reliability during these error transitional periods 4 temporally varied erris models is more effective in correcting bias and in quantifying uncertainty because they treat error information in a time varied way particularly erris s and erris m the effect of previous error distribution in the erris model is beneficial to generate more reasonable results for avoiding overconfidence overall this study presents a basis for understanding how simulation errors may change with the time of year when underlying hydrological processes are strongly seasonal it is considerably necessary to construct temporally varied error models to improve simulations for better use of the model outputs more researches will be done in the future to improve forecasts with longer lead times credit authorship contribution statement li liu conceptualization methodology formal analysis software writing original draft q j wang methodology validation writing review editing supervision yue ping xu resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partly supported by national natural science foundation of china 91547106 and national key research and development plan inter governmental cooperation in international scientific and technological innovation 2016yfe0122100 national climate center of china meteorological administration and hydrology and water resource bureau of tibet are greatly acknowledged for providing meteorological and hydrological data used in the study area thanks are also given to cold and arid regions science data center at lanzhou for the archives of snow depth and glacier dataset appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124914 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
5517,errors from hydrological simulations have substantial influence on hydrological applications there are increasing interests to incorporate statistical models of the errors error models into hydrological applications to improve simulations however conventional error models are usually temporally unvaried and may be inadequate to handle model simulation errors when the underlying error statistics are strongly seasonal to overcome this problem the use of temporally varied error models in both prediction and forecasting applications are investigated we analyze different levels of temporal granularity to identify the optimal temporally varied error model to best improve simulations and to quantify uncertainty the error reduction and representation in stages erris model is adapted in this study to improve streamflow simulations produced by the variable infiltration capacity model for the yarlung tsangbo river basin well marked seasonal and sub seasonal variations in error statistics are found accordingly three temporally varied erris models are constructed at semi annual erris h seasonal erris s and monthly erris m temporal granularity and compared with a benchmark model the temporally unvaried model erris a results show that the temporally varied erris models are considerably more effective than the temporally unvaried one with 34 reduction in continuous ranked probability score crps and 23 increase in nash sutcliffe efficiency nse for prediction applications with respect to forecasting applications improvements of about 7 in crps are achieved by the temporally varied models the performance of different temporally varied error models roughly follows the same order as the level of temporal granularity generally erris s and erris m are similarly effective with erris m providing additional improvement by more than 15 in crps for the spring season and by at least 30 for the autumn season it is concluded that the consistency of temporal granularity between error models and variations of error statistics is the key to effective error reduction and uncertainty quantification when complicated hydrological processes exist hydrological model tends to produce seasonally and even sub seasonally varied error statistics consequently temporally finer error models are expected to lead to higher accuracy and reliability keywords temporal variation in error statistics statistical models of the errors uncertainty quantification hydrological ensemble prediction 1 introduction hydrological models are commonly used to aid planning and operations of water resources jin et al 2010 li et al 2013 abbaspour et al 2015 model simulations need to be sufficiently accurate for practical applications faramarzi et al 2015 lievens et al 2015 fan et al 2015 model simulation errors may arise from three sources of uncertainty model initial condition e g soil moisture model external forcing e g precipitation and model structure and parameters xu et al 2007 tian et al 2015 liu et al 2016a b liu et al 2017a wang et al 2018 careful analyses of model simulation errors are valuable for identifying ways to improve the modelling and for developing practical tools to make better use of model outputs dogulu et al 2015 evin et al 2014 smith et al 2015 wang et al 2018 model simulation errors can be analyzed in many ways in this study we focus on characterizing how model simulation error statistics change with the time of year this is particularly useful if the underlying hydrological processes are strongly seasonal for many mountainous catchments snow glacier meltwater and rainfall induced runoffs coexist the dominant processes may be snow ablation in spring rainfall runoff and glacier melting in summer and snow glacier accumulation in autumn and winter changes in error statistics with the time of year reflect the varying degree of success of a model in simulating these processes information on the changes may help constructing hypotheses on ways to improve the model a more immediate benefit of characterizing model simulation errors is the possibility to reduce the errors through bias correction and simulation updating and to quantify any remaining uncertainty to this end statistical models of the errors hereinafter referred to as error models can be constructed and used as a tool to post process model simulations ye et al 2014 2015 roulin and vannitsem 2015 lucatero et al 2018 bogner et al 2017 error models used in past hydrological studies are mostly temporally unvaried lucatero et al 2018 bogner et al 2017 and they may not work effectively if the error statistics are found to change with the time of year in this study we investigate the use of temporally varied error models with different levels of temporal granularity to improve simulations and to quantify uncertainty post processing hydrological model simulations has two broad categories of applications the first is for prediction when real time observations of the model output variables are not available to update the model simulations the second is for forecasting when real time observations of the model output variables are available to update the model simulations however as forecast lead time increases the effect of updating will diminish and the second category will approach the first category examples of prediction applications of post processing can be found in climate change impact studies errors introduced by hydrological models can be substantial even as great as climate change steinschneider et al 2015 troin et al 2018 vetter et al 2017 post processing of model simulations has been demonstrated effective in removing the biases brown and seo 2013 pagano et al 2013 cannon et al 2015 zhang et al 2015 the most well known post processing approach is quantile mapping qm cannon et al 2015 zhang et al 2015 lucatero et al 2018 which matches the cumulative distribution function cdf of model simulations to the cdf of observations although qm is effective in reducing biases zhao et al 2017 it does not quantify simulation uncertainty for forecasting applications updating methods are often used to reduce forecast errors chen et al 2015 gragne et al 2015 si et al 2015 liu et al 2017b meng et al 2017 updating can be achieved by post processing simulation outputs gragne et al 2015 or by changing model states si et al 2015 in the operational forecasting post processing simulation outputs is widely adopted due to its simplicity and effectiveness liu et al 2016a the most commonly used error models are autoregressive models ar under the assumption that the forecast errors are sequentially related liu et al 2016b wu et al 2012 in most cases ar updating is performed deterministically without quantifying uncertainty chen et al 2015 gragne et al 2015 wu et al 2012 in this study we adapt an error model called error reduction and representation in stages erris introduced by li et al 2016 2017 the staged approach of this error model addresses both the prediction and forecasting applications it is also capable of quantifying remaining uncertainty of the model simulations in the study by li et al 2017 the erris error model was applied to rising and falling limbs of hydrograph respectively in this study we investigate how to best vary this error model to deal with model simulation errors that temporally change in characteristics more specifically we want to identify the level of temporal granularity of the error model at which the temporally varied erris error model is the most effective in improving simulations and quantifying uncertainty the rest of this paper is organized as follows section 2 provides a brief introduction to the study area and datasets involved section 3 introduces temporally varied erris models and evaluation methods section 4 provides analysis and evaluation results discussions and conclusions are presented in section 5 and 6 2 study basin and data 2 1 study basin the study basin is the yarlung tsangpo river ytr basin the upper reach of brahmaputra located in the southern tibetan plateau fig 1 a the ytr basin is one of the highest basins in the world with an average elevation over 4000 m above sea level the hydrological station used in this study is nuxia station with a drainage area of about 2 1 10 5 km 2 the ytr basin is part of the indian ocean water system exhibiting obvious variation in climate from upstream to downstream regions liu et al 2014 from west to east the climate undergoes a series of regimes cold and dry temperate steppe climate temperate forest grassland climate and subtropical humid and warm climate shen et al 2012 the rainy season usually begins from may or june and ends at the end of september or october capturing 60 80 of the annual precipitation you et al 2007 the average annual precipitation is about 560 m m and the average annual temperature is about 6 27 c liu et al 2019 previous studies reported that the meltwater induced streamflow accounted for 38 of the total streamflow in 1969 at nuxia station liu 1999 cuo et al 2014 more recently chen et al 2017 found that during the study period from 2003 to 2015 snow and glacier runoffs contributed 10 6 and 9 9 to the total runoff respectively snow distribution is shown in fig 1 b snow is present in most parts of the basin especially for the upper lower reach and the southern region where the himalayas mountain is located similar distribution can be found for glacier in fig 1 c 2 2 data description the precipitation data used in this study is the rain gauge based product cgdpa shen and xiong 2016 which has been successfully applied in the ytr basin chen et al 2017 cgdpa is a gridded daily precipitation analysis product over mainland china with a resolution of 0 25 0 25 it was developed by the china national meteorological information center for the china meteorological administration cma based on the climatological optimal interpolation algorithm xie et al 2007 the minimum and maximum temperatures wind speed and relative humidity from 1997 to 2015 were collected and interpolated from 27 national meteorological observatory stations located in and around the ytr basin as shown in fig 1 a observed daily streamflow for the same time period at nuxia station was obtained from hydrology and water resource bureau of tibet the data of 1997 was used for warming up data from 1998 to 2008 and 2010 to 2015 were adopted for calibration and validation due to the data missing in 2009 snow depth data was downloaded from the cold and arid regions science data center at lanzhou http westdc westgis ac cn the data was derived from passive microwave remote sensing at a resolution of 0 25 0 25 che et al 2008 glacier area and location were obtained from the second glacier inventory dataset of china liu et al 2014 the digital elevation model dem data used in hydrological modelling was downloaded from geospatial data cloud http www gscloud cn at a resolution of 90 m 90 m the vegetation and soil parameter in the model were defined according to 1 k m china soil map based on harmonized world soil database fischer et al 2008 and 1 k m land cover products of china ran et al 2010 3 methodology 3 1 hydrological model and glacier module the variable infiltration capacity vic macroscale hydrologic model liang et al 1994 was adopted in this study various features in vic such as two layer energy balance snow model andreadis et al 2009 snow elevation bands scheme and frozen soil permafrost algorithm cherkauer and lettenmaier 1999 make it tailored for applications in high mountain basins like the ytr one deficiency of the model is that no glacier process is considered in the current model version 4 2 we note there are two different ways to simulate glacier melting the energy balance model and the temperature index model shrestha et al 2015 given the limited observations in the study area the temperature index model was selected and added to the original model according to zhang et al 2013 and su et al 2016 the total runoff from each grid cell is calculated through the formula 1 q i f i g i 1 f i r vic i in which q i is the total runoff in grid i f i is the glacier area fraction within grid i which is computed from the ratio of glacier area and total gird cell area r vic i is the original total runoff from vic g i is calculated as 2 g i ddf temp i if temp i 0 0 if temp i 0 where ddf is the degree day factor for glacier mm c 1day 1 and is calibrated with a prescribed range from 0 to 10 as suggested by chen et al 2017 temp i is the daily mean air temperature it is assumed that the glacier melting is late to snow melting indicating that the glacier will not melt until the snowpack becomes zero in a grid hydrological model was calibrated based on a composed objective function the simulated snow depth was introduced together with streamflow to calibrate parameters by model efficiency indicator 3 obj 0 5 1 q o t q s t q o q s t 0 5 1 n i 1 n 1 d o i t d s i t d o i d s i t wherein q o and q s are observed and simulated streamflow d o i and d s i are observed and simulated snow depth at i th grid n is the total number of grids in the ytr superscript bar means average value snow depth and streamflow are given the same weight during calibration the absolute error rather than squared error is adopted to give importance to the fitting of both low and high values 3 2 erris model the error reduction and representation in stages erris method was originally proposed by li et al 2016 to deal with the overall simulation errors of streamflow from hydrological models for short term streamflow forecasting the method is performed in multiple stages to progressively improve the simulations of streamflow and the estimates of remaining uncertainty to induce normally distributed and homoscedastic residuals erris applies to the observed streamflow q t the log sinh transformation wang et al 2012 4 z t b 1 log sinh a b q t in which a and b are transformation parameters the same transformation is also applied to model streamflow simulation q t to give z t in stage 1 the error model is defined as 5 z t n z 1 t σ 1 2 where the subscript 1 indicates stage 1 and n denotes a gaussian distribution of the observed streamflow with mean z 1 t and standard deviation σ 1 in stage 2 we make a bias correction to the model simulation from stage 1 to give 6 z 2 t c z 1 t where c is the correction amount the error model becomes 7 z t n z 2 t σ 2 2 where σ 2 represents the standard deviation of the residual as shown the bias correction in eq 6 is not conditional on z 1 t the original erris applies in stage 2 a bias correction that is conditional on z 1 t as 8 z 2 t c d z 1 t where d is a slope parameter as the magnitude of z 1 t can vary with the time of year for highly seasonal rivers the effect of the conditional bias correction cbc of eq 8 can be seasonal too this will interfere with the function of temporal variation of error models to be introduced in the next subsection which is intentionally to deal with the problem that error characteristics can vary with the time of year for this reason we use unconditional bias correction ubc of eq 6 in stage 2 for this study in stage 3 a restricted autoregressive updating is applied to use the information from the latest available observations of streamflow given by 9 z 3 t z 2 t ρ z t 1 z 2 t 1 i f q 3 t q 2 t q t 1 q 2 t 1 f q 2 t q t 1 q 2 t 1 o t h e r w i s e in which q 3 t f 1 z 2 t ρ z t 1 z 2 t 1 and q 2 t f 1 z 2 t f 1 is the back transformation of log sinh transformation in eq 4 ρ is the lag 1 autocorrelation parameter then the error model in this stage is expressed as 10 z t n z 3 t σ 3 2 the rationale for using the restricted autoregressive updating can be found in li et al 2015 in stage 4 a two component gaussian mixture distribution is adopted to refine the residual distribution after autoregressive updating at stage 3 detailed mathematical expressions are as follows 11 z 4 t z 3 t 12 z t m n z 4 t σ 4 1 2 σ 4 2 2 ω where m n z 4 t σ 4 1 2 σ 4 2 2 ω indicates a mixture gaussian distribution of n z 4 t σ 4 1 2 and n z 4 t σ 4 2 2 with weights ω and 1 ω assumption is made that σ 4 1 is smaller than σ 4 2 to identify the two components all the parameters including c ρ ω and standard deviation σ i of residuals at each stage are calibrated using the shuffled complex evolution sce algorithm duan et al 1994 by maximizing the log likelihood functions in this study our evaluation focuses on stage 2 and 4 the error model established at stage 2 is used to evaluate model performance for post processing streamflow in prediction applications where no real time observations are required and error model established during training period can be directly used for testing period the final error model constructed at stage 4 uses observations in the previous time step to updating streamflow this is the case for forecasting applications with a lead time of 1 day 3 3 analysis of temporal variation in error statistics analyzing how error statistics vary with time of the year is a key component in this study error statistics are calculated from model residuals which are the differences between observed and simulated values after the log sinh data transformation positive residuals mean underestimation and negative residuals indicate overestimation to investigate variations of error statistics between different seasons of the year the density distribution of the residuals is constructed for each season by pooling data for individual season from all years the residual distributions are expected to be normally distributed because of the transformation applied the distributions for the four seasons are inspected for differences in means and spreads this analysis is further refined to investigate variations of error statistics between different months of the year when error statistics are obtained we make speculative hypothesis from indirect observation in attempt to interpret the possible cause for the temporal variation in error statistics in this regard a reasonable interpretation can be deduced based on existing meteorological data it is well acknowledged that streamflow in the ytr basin is mainly composed of rainfall snowmelt and glaciermelt chen et al 2017 zhang et al 2013 the rainfall induced and snow induced streamflow can be deduced by the analysis of rainfall and snow depth since the glacier melting amount in this study is calculated by the temperature index model positive temperature plays an important role according to eq 2 to this end an analysis of monthly rainfall snow depth and positive temperature changing in a year is conducted 3 4 temporally varied error models once temporal variation in error statistics is found to be prevalent the next step is to construct temporally varied error models to address the variation the question is what level of temporal granularity is appropriate for these models we use the term temporal granularity to describe the temporal scale below which the error distributions are treated as homogeneous conceptually models of finer granularity are more flexible for describing temporal variation however the finer models require more model parameters and may suffer model overfitting in this study we investigate four levels of temporal granularity the corresponding error models are listed in table 1 the annual model erris a is temporally unvaried and serves as a benchmark the other three models erris h erris s and erris m correspond to semi annual seasonal and monthly scales the details of the generic erris model are already given in section 3 2 the generic erris model is applied here to different temporal scales to give rise to the three sets of temporally varied error models the performances of these models are evaluated through cross validation the leave two year out cross validation is undertaken from 2010 to 2015 only results for the first year of the two year validation period is used to avoid artificially gained performance for clear and logical presentation the results in this study are displayed for all the four stages of erris but results at stage 2 and stage 4 are our foci performances of the erris a erris h erris s and erris m models are evaluated 3 5 evaluation methods multiple metrics are used to evaluate model performances including accuracy and reliability firstly the overall performance is quantified using the continuous ranked probability score crps eq 13 hersbach 2000 crps has a range from 0 to infinity smaller crps is preferable 13 crps 1 k i 1 k p q h q q a 2 d q where p q is the cumulative distribution function of variable q h q q a is the heaviside function which is 1 when q q a 0 and 0 otherwise q and q a are forecasted and observed variable respectively k is the length of time series consistent with the objective function used to calibrate vic the model efficiency eq 3 but leaving the snow depth components out is employed together with nash sutcliffe efficiency nse eq 12 to depict model accuracy a greater value of model efficiency or nse indicates more accurate mean forecasts and thus better forecast skill 14 nse 1 t 1 k q t q t 2 t 1 k q t q 2 where q t and q t are observed and simulated streamflow q is the mean value of observations the indicator used to describe reliability is based on the forecast probability integral transform pit π t schepen et al 2018 which should follow a uniform distribution if forecasts are perfectly reliable for graphical comparison pit values are displayed on a uniform probability plot pit plot perfectly reliable forecasts should show up as points placed onto the 1 1 line a kolmogorov confidence band is shown in the pit plot to provide a formal test of uniformity points remaining inside these confidence bands indicates the test is passed laio and tamea 2007 additionally α index is used to summarize the deviations of the actual pit values from the 1 1 line renard et al 2010 15 α 1 2 n t 1 n π t t n 1 where π t is the sorted π t in increasing order n is the sample size α index ranges from 0 to 1 1 indicate perfect reliability 4 results 4 1 temporal variation in error statistics the seasonal and monthly distributions of errors in simulated streamflow are presented in figs 2 and 3 it is noticeable that error distributions present well marked seasonal variations a gradual change from overestimation to underestimation can be seen from spring to winter in spring there is a large variance in model residuals a smaller variance can be found for summer monthly error distributions also exhibit changes from underestimation to overestimation and back to underestimation streamflow from april to september has the tendency to be over simulated especially for april and may underestimation can be found in remaining months remarkably from november to february streamflow in september has the smallest mean bias the variance of model residual distribution varies with month being the largest from december to march in summer and winter the error distributions are steady with streamflow consistently overestimated or underestimated in spring and autumn the error distributions are more transitional in spring bias pattern transits into overestimation from underestimation and in autumn the overestimation bias is gradually replaced by underestimation bias to interpret variation in error distributions the distribution of snow depth in a year is plotted together with precipitation and positive temperature in fig 4 the error distributions in spring are speculated to be mainly caused by varying degree of success of vic simulating snow melting and in autumn by snow accumulating fig 4 a rainfall and glacier meltwater are the two dominant factors for errors in summer the relatively large variance in error distributions of spring is possibly due to the imperfect modeling of the cooccurrence of snowmelt rainfall and glacier melt in this period in winter frozen soil modelling in vic plays an important role in simulation errors 4 2 overall evaluation of the temporally varied error models figs 5 7 show performance for the entire streamflow time series it is noticeable that different erriss vary substantially and the general performance roughly but not always follows the same order as the level of temporal granularity considerable improvements are observed from temporally unvaried erris erris a to temporally varied ones the performance for prediction stage 2 and forecasting stage 4 applications are markedly improved with much preferable results for forecasting applications for prediction applications stage 2 erris a is found to have a negative effect on raw simulations increasing crps by 20 and decreasing accuracy by about 15 compared to raw results at stage 1 improvements from erris a to erris h amount to 34 in crps 14 in model efficiency and 23 in nse erris m performs the best according to crps and accuracy metrics more specifically crps of erris m is about 229 m 3 s amounting to only half of erris a difference between erris h and erris s is negligible in terms of crps and α index for accuracy higher nse is obtained compared with model efficiency indicating generally better results in high flows erris based on finer temporal granularity tends to improve accuracy more efficiently the exception is that semi annual model is better than seasonal model in terms of nse fig 5 c erris m is able to improve accuracy by more than 4 compared to erris h s and by at least 20 to erris a for reliability fig 5 d erris h and erris s are found to produce more reliable predictions however pit plot shows that predictions by erris s are somewhat over predicted with pit points in fig 6 c scattered above the diagonal laio and tamea 2007 erris m is not as effective as erris h and erris s but the improvement is still impressive compared to erris a moreover erris m and erris h are the only two models completely pass the uniformity test fig 6 pit plot by erris a deviates substantially from the 1 1 line with a clear s shape pattern indicating too narrow predictions with regard to forecasting applications all models are similarly effective generally slightly better forecasts are provided by erris s closely followed by erris h or erris m erris s is able to provide additional improvements by about 7 compared to erris a and by 5 to erris m and erris h the performance of forecasts from erris h and erris m do not differ much indicated by similar crps model efficiency and nse in the evaluation of reliability erris m fails to retain the advantages providing smaller α index than others erris a turns out to be the worst updating method with greater crps and lower accuracy all four models perfectly pass the uniformity test as shown by grey points in pit plot fig 6 hydrographs in fig 7 demonstrate increasing agreement between observations and predictions with increasing level of temporal granularity the overestimation of raw high flows seems to be exaggerated by erris a the possible reason is that the overall error distributions are opposite to those for high flows making erris a sacrifice the improvement in high flows to achieve overall improvement in entire flows those results are consistent with fig 5 b c as the agreement between forecasts and observations can be denoted by model efficiency and nse erris h fails to post process the high flows during falling limbs erris m is superior than erris s with high agreement in both high and low flows hydrograph at stage 4 are omitted as the results are extremely similar and the differences in plots are minor 4 3 performance by season further performance is analyzed for each of the seasons in terms of prediction applications it is noticeable that effects of temporally varied erriss are similar in summer and winter with slightly superior performance by erris s fig 8 in spring and autumn erriss behave highly differently erris m is detected to provide the best results with additional improvements in crps by more than 15 in spring and by at least 30 in autumn in autumn erris m is the exclusive post processing approach producing improved flows compared with raw simulations stage 1 this is perhaps attributed to the transitional error distribution in spring and autumn fig 3 erris at larger temporal granularity has difficulty in reducing bias and in improving simulations erris a is the poorest post processing approach in all four seasons at stage 4 the values of crps are dramatically reduced in low flow period spring and winter crps becomes smaller than 20 of raw crps particularly in winter crps is smaller than 20 m 3 s flows from four erriss are similarly good and those form erris s are preferable with crps further improved by about 15 in spring with regarding to accuracy a deterioration from raw simulation can be seen at stage 2 for both erris a and erris h fig 9 analogous to fig 5 b the negative effects of those two error models mainly take place in spring and autumn erris m is the only model producing continuous improvement compared with raw simulations in all seasons predictions by erris s are equally matched to erris m in spring and summer in winter erris s outperforms erris m erris a exhibits fairly poor performance in most seasons after autoregressive updating stage 4 substantial improvements are present in spring and winter model efficiency in spring are improved to be greater than 0 8 and in winter the value increases from 0 1 to near 0 75 all four erriss perform similarly with slightly better agreement with observations by erris s reliability for prediction application stage 2 is relatively consistent for various erriss in autumn fig 10 c erris a is proved to be the worst with the smallest α index in all four seasons erris a tends to deteriorate raw simulations in spring by 24 and by 17 6 in summer erris s and erris m are consistently the best models in all four seasons as for performance in forecasting stage 4 erris m produces the highest reliability in most seasons followed by erris s as a supplement pit diagrams in spring and winter are plotted in fig 11 to show more details it is shown that at stage 2 only erris m passes the test of uniformity in these bias transitional seasons with scatters within the kolmogorov confidence bands flows by erris a and erris h are obviously over predicted in spring and under predicted in winter at stage 4 the over prediction under prediction by erris a persists 4 4 performance by month performance at monthly scales is displayed in fig 12 to avoid redundant figures only results at stages of interest stage 2 and 4 are shown for prediction applications it is clear that erris m provides the overall best fig 12 a the most accurate fig 12 c and the most reliable fig 12 e results in most months combining information in figs 2 and 3 better results are detected in erris s when error statistics in a month are consistent with those in the season where the month belongs to for example flows in october are more preferable than those in september fig 12 a c and e it is caused by the similarity between the means of error statistics in october fig 3 and in autumn fig 2 c the overestimation bias in september is opposite to the overall underestimation bias in autumn making erris s fail to effectively correct the error in this month this is also the reason why erris a fails to improve flows compared with raw simulations black lines during months from april to september means of error statistics in those months are broadly deviated from the overall underestimation bias the inferiority of erris h mainly occurs from september to october consistent with the results in fig 7 b where erris h fails to correct errors in falling limbs for forecasting applications erris s is proved to be the best updating method in terms of crps especially during high flow period according to model efficiency all four erriss behave similarly except in march in march snow begins to melt and rainfall and temperature start to increase fig 4 complicated hydrological processes are highly likely to cause complicated error statistics resulting in widely varied performance by different temporally varied erriss erris m gives the highest reliability producing the best α index during most months 5 discussion this study presents a comparison between different levels of temporally varied error models in the comparison of streamflow time series erris a is found to have inferior performance in post processing high flows fig 7 a as evaluation of erris models is largely reflected from the calculated distribution of model residuals in each stage relevant parameters are indicative for the model performance according to the constant and positive parameter c value at stage 2 in erris a see s1 a in supporting information erris a tends to force the mean of error statistics to add a positive value consequently better correction in underestimated streamflow is expected while the overestimation in high flow become exaggerated parameter c is dedicated to correcting the mean of distribution of error models as shown in eq 6 overestimation bias is corrected by negative c value and vice versa therefore the identical parameter c in erris s and erris m models and means of seasonal monthly error statistics figs 2 and 3 explains superior improvements from these two models figs 5 7 in fig 7 it is difficult to detect the prediction uncertainties due to the narrow ensemble spread compared with the streamflow analyzing standard deviation is another direct way to depict uncertainties standard deviation in gaussian distribution is a scale parameter determining the statistical dispersion of the probability distribution the larger the scale parameter the wider the distribution and thus greater uncertainty sharp but unreliable forecasts usually result in risky decisions due to the overconfidence erris a has the lowest reliability during winter time fig 10 d and the smallest scale parameter s1 b making the forecasts fairly overconfident and thus untrustworthy on the contrary the other three erriss especially erris m provide more appropriate predictions in which high reliability is accompanied with smaller standard deviation flows in summer are highly reliable and simultaneously sharp by all erriss another advantage of the temporally varied error models is the ability to utilize information from the previous day in a more rational way the lag 1 autocorrelation parameter ρ quantifies the influence of errors from the day before as erris a is set up based on all data without considering sub annual error statistics model treats errors from lag 1 day with the same weight for the entire year however during the low flow period of actual hydrological regime streamflow is dominated by baseflow or other slowly evolved hydrological process the errors in consecutive days tend to be similar consequently higher ρ value is derived when it comes to the wet season the streamflow becomes changeful due to the fickle weather rain and temperature which makes errors vary significantly hence information from the day before becomes less important and smaller ρ value is present from this point of view the way in which erris h erris s and erris m treat errors from the day before is more reasonable s1 c and thus higher efficiency is found for these three erriss compared with erris a the purpose of this study is to find the most appropriate temporal granularity to establish effective enough error model according to the computed statistical metrics the performance is not linearly correlated with temporal granularity the improvements from erris a to erris h are substantial and gradually diminish when it moves to further finer erris models figs 5 11 the difference becomes minor for erris s and erris m especially when no sub seasonal error statistics exists in one season as shown in figs 8 10 but for spring and autumn when the streamflow is generated by complicated hydrological processes the error distribution tends to be transitional making the erris at seasonal temporal granularity fail to correct the bias and to reduce uncertainty effectively this is also the reason why erris h produced similarly good even better results than erris s according to averaged metrics from entire streamflow timeseries fig 5 c although coarser temporal granularity is used for erris h the key point is that erris h separates the varied error statistics into two homogenous parts while for erris m the performance during spring and autumn transitional error distribution is present and lumped to some degree undermines the overall quality therefore when conducting either post processing or updating one should keep in mind that when error statistics in a targeted temporal granularity are transitional it will be better to set up the error models based on dataset at a finer time scale so as to address bias and to quantify uncertainty more effectively when the bias is consistently negative or positive the post processing based on coarser temporal granularity is recommended for time saving and lower computation cost certainly if the training data are long enough one could always go with finer temporal granularity however when there is not enough data for estimating parameters of a finer model the problem of overfitting could occur 6 conclusion strongly seasonal hydrological processes in mountainous basins are likely to cause error statistics to change with the time of year thus the conventional temporally unvaried error models are inefficient in reducing errors over such regions in this study several temporally varied errors models are constructed at semi annual seasonal and monthly temporal granularity based on the analysis of temporal variation in error statistics the results are compared to identify the optimal level of temporally varied error model we conduct our study in the yarlung tsangbo river basin southern tibetan plateau china the error models are used to improve streamflow simulated by vic model performance is evaluated for both prediction and forecasting applications for prediction applications the observations are unavailable and the error models are used as post processing approaches for forecasting applications the error model is more like an updating method using available observations the major findings of this study are summarized as follows 1 simulations in the study area present remarkable seasonal and sub seasonal variations in error statistics error distributions in spring and autumn are obviously transitional with means of error distribution shifting from underestimation or overestimation to the opposite one reason is the varied degree of success of vic in simulating the cooccurrence of snow rainfall and glacier in these periods during other seasons error statistics are more homogeneous consistently underestimated in summer and overestimated in winter 2 temporally varied erris models are far more effective than temporally unvaried one for prediction applications improvements from erris a to erris h are substantial up to 34 in crps and 23 in nse erris a is found to negatively affect raw simulations deteriorating crps by 20 and by about 15 for accuracy with regard to forecasting applications slightly better forecasts are still produced by temporally varied models with improvements of about 7 by erris s and of 3 by erris m and erris h achieved 3 the general performance of different temporally varied error models approximately aligns with the level of temporal granularity in most cases erris s and erris m perform fairly similarly error model at seasonal temporal granularity is thus fine enough to address bias and to reduce uncertainty whilst during spring erris m is able to provide additional improvements by more than 15 according to crps and by at least 30 in autumn for prediction applications therefore further finer model erris m is recommended with higher accuracy and reliability during these error transitional periods 4 temporally varied erris models is more effective in correcting bias and in quantifying uncertainty because they treat error information in a time varied way particularly erris s and erris m the effect of previous error distribution in the erris model is beneficial to generate more reasonable results for avoiding overconfidence overall this study presents a basis for understanding how simulation errors may change with the time of year when underlying hydrological processes are strongly seasonal it is considerably necessary to construct temporally varied error models to improve simulations for better use of the model outputs more researches will be done in the future to improve forecasts with longer lead times credit authorship contribution statement li liu conceptualization methodology formal analysis software writing original draft q j wang methodology validation writing review editing supervision yue ping xu resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partly supported by national natural science foundation of china 91547106 and national key research and development plan inter governmental cooperation in international scientific and technological innovation 2016yfe0122100 national climate center of china meteorological administration and hydrology and water resource bureau of tibet are greatly acknowledged for providing meteorological and hydrological data used in the study area thanks are also given to cold and arid regions science data center at lanzhou for the archives of snow depth and glacier dataset appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124914 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
5518,free convection limit fcl approaches to estimate surface fluxes are of interest given the evidence that they may extend up to near neutral stability conditions for measurements taken in the inertial sublayer the formulation based on surface renewal theory and the analysis of small eddies srse to estimate the sensible heat flux h was extended to latent heat flux le with the aim to derive their fcl approaches for sensible heat flux hfcl the input requirements are traces of the fast response such as 10 20 hz air temperature and the zero plane displacement for latent heat flux lefcl input requirements are fast response traces of water vapor density mean temperature of the air the available net surface energy rn g where rn and g are the net radiation and soil heat flux respectively and the zero plane displacement taking eddy covariance ec as a reference method the performance of the fcl method was tested over a growing cotton field that involved three contrasting surfaces partly mulched bare soil a sparse canopy and a homogeneous canopy using traces at 10 hz and 20 hz hfcl overestimated and underestimated the ec sensible heat flux hec respectively in general lefcl tended to slightly underestimate leec the surface energy balance closure show that hec leec underestimated rn g in a range of 19 homogeneous canopy and 8 sparse canopy given that in general hfcl lefcl was closer to rn g than hec leec the fcl method may be recommended for field applications especially when the wind speed is not available keywords sensible heat flux latent heat flux surface energy balance ec method free convection limit 1 introduction the latent heat flux le is involved in two fundamental equations the surface energy balance equation and the water balance equation given that the main drivers for le are the supply of water including water content in topsoil and the available net surface energy rn g where rn is the net radiation and g is the soil heat flux it links hydrological agricultural and climatological features dominguez et al 2008 li and wang 2019 robles morua et al 2012 stagl et al 2014 yang and wang 2014 in particular its knowledge is crucial for irrigation planning to perform weather forecasting climate modelling to determine the risk of fire among others brutsaert 1982 fang et al 2018 silva et al 2010 direct measurements of le by means of the eddy covariance ec method and large weighing lysimeters are preferred for scientific studies in agricultural landscapes however the required instrumentation and maintenance are expensive when the sensible heat flux h le and the available net surface energy are measured independently they allow calculating the simplified surface energy balance rn g h le which can be used as a conventional quality control to indirectly check the measurement reliability of h and le aubinet et al 2000 in general the instrumentation required for monitoring le over large areas involving different surfaces is not always affordable or applicable haymann et al 2019 and on the other hand flow distortion and windy conditions among others are problems when using respectively the ec method and a weighing lysimeter alfieri et al 2012 brutsaert 1982 burba 2013 noltz et al 2013 thus techniques and approaches to estimate le are of interest to overcome some shortcomings in measurement scaling and cost that are inherent in the ec method and weighing lysimeters albertson et al 1995 castellví 2004 drexler et al 2004 2008 french et al 2012 haymann et al 2019 li and wang 2019 paw et al 1995 snyder et al 1996 suvočarev et al 2019 yang and wang 2014 zhao et al 2010 to minimize costs in moderately tall canopies le has often been estimated indirectly using the simplified energy balance residual method i e le rn g h because the instrumentation required to estimate h g and rn is more affordable a major potential issue involved in the residual method to estimate le half hourly is that accurate measurements of all the energy terms involved in the surface energy balance seb equation do not guarantee its closure on a half hourly basis in general even on extended homogeneous surfaces the sum of turbulent fluxes is smaller than the available net surface energy foken 2008 foken et al 2011 twine et al 2000 wilson et al 2002 thus often the residual method adds unexplained energy to le there is an ongoing scientific debate about the role of low frequency circulations in the lack of closure of the seb equation cuxart et al 2015 eder et al 2014 foken 2008 huang et al 2008 kanda et al 2004 stoy et al 2013 steinfeld et al 2007 while some studies have suggested that large circulations appear to be more efficient in transporting sensible heat than latent heat charuchittipan et al 2014 stoy et al 2006 2013 other studies have shown that this role depends on the surface heterogeneity type of terrain and its uses brunsell et al 2011 cuxart et al 2015 these issues may affect the uncertainty when the residual method to estimate le is used in fact at some sites the residual method may be preferred to estimate h i e h rn g le than le castellví and oliphant 2017 when the monin obukhov similarity theory most is used through the stability parameter the friction velocity u and the sensible heat flux are required as input to estimate the latent heat flux traditionally to avoid measurement of the wind field the wind log law is implemented to estimate u h and le castellví and snyder 2010 de bruin et al 1993 hsieh and katul 1996 suvočarev et al 2019 when convection dominates the turbulence in the atmospheric surface boundary layer most similarity relationships were redone to best fit this limit case termed free convection limit fcl approaches stull 1988 implementing the fcl formulation surface eddy flux estimates of scalars become independent of the friction velocity consequently fcl approaches become simpler and surprisingly there is evidence that they performed rather reliably up to near neutral conditions albertson et al 1995 högström 1988 kohsiek 1982 monin and yaglom 1971 wang and brass 2010 for field applications minimization of input requirements has special interest when surface flux estimates are desired at multiple sites such as in the framework of remote sensing and estimation of crop coefficients drexler et al 2008 french et al 2012 zapata and martínez cob 2001 zhao et al 2010 the framework of surface renewal sr theory danckwerts 1951 harriott 1962 higbie 1935 seo and lee 1988 combined with the analysis of small eddies srse aminzadeh et al 2017 castellví 2018 haghighi and or 2013 2015 has shown potential to open new perspectives in micrometeorology for instance an srse approach was proposed to estimate u alternative to the wind log law and h requiring as input measurements of the mean wind speed and the high frequency trace of the air or virtual temperature in the roughness and inertial sub layers castellví 2018 castellví et al 2020 in the following the srse formulation will refer to applications requiring measurements taken in the inertial sub layer as input and it will be used to estimate le to our knowledge the srse approach to estimate fluxes of scalars other than temperature has never been tested here given the benefits of developing approaches requiring minimum inputs an srse fcl expression was derived for estimating h and le it was shown that the inputs required to determine h as hfcl are fast response traces of air temperature and the zero plane displacement similarly for le lefcl may be determined using fast response traces of water vapor concentration the zero plane displacement the mean temperature of the air and the available net surface energy as input therefore hfcl and lefcl do not share instrumentation this separation minimizes the probability to have simultaneous gaps in h and le in addition hfcl and lefcl are estimated independently which allows testing closure of the surface energy balance for an integral quality check here the performance of hfcl and lefcl were tested for a growing cotton field which involved surfaces with different roughness 2 theoretical considerations 2 1 the srse method with measurements in the inertial sub layer srse is a semi empirical method fully described in castellví 2018 to estimate the friction velocity and eddy fluxes to estimate the surface flux of a scalar srse considers that downward flows i e descending macro parcels of air following a coherent motion generate a narrow highly turbulent shear layer containing multiple small scale vortices zhu et al 2007 srse assumes 1 the population of small eddies which in the following are termed fluid elements generated in the volume within the canopy of the macro parcel are randomly distributed 2 during the time that a fluid element remains close to the viscous sub layer of a source exposure time mass and heat transfers through and the fluid element increases or depletes its scalar concentration until it is randomly replaced by another fluid element 3 by continuity following the coherent motion the macro parcel remains in contact with the surface for a given period though it depends on the wind speed surface roughness and stability conditions this period is on the order of a few tens of seconds until it ejects being renewed by a new sweep katul et al 1996 paw et al 1995 zhu et al 2007 during ejection most fluid elements located in the upper part of the canopy remain attached to the macro parcel of air zhu et al 2007 as a consequence regularly i e at the sweep ejection frequency a large number of fluid elements are broadly spread above the canopy in the surface boundary layer katul et al 1996 zhu et al 2007 additionally srse assumes 4 the coherent motion transports fluid elements across finite distances before they have a chance to be dissipated or become significantly diluted thus a transilient turbulence mixing concept is adopted stull 1988 for an unstable case fig 1 depicts the formation and identification of the fluid elements it shows a macro parcel of air defined as a parcel of air whose volume covers most sinks and sources following a coherent motion fig 1 panel a the actual trace of the sonic temperature and water vapor concentration of the air measured at 20 hz on may 5 at 17 5 h for a short interval is shown in fig 1 panel b which was composed by small fluctuations signatures of fluid elements embedded in the scalar change of a macro parcel of air over time t signature of a coherent structure in fig 1 panel b the signature of the coherent structure was assumed to follow the generalized ramp like shape fig 1 panel b proposed in chen et al 1997 which is composed by three phases quiescent enriching and ejection regardless the composition shown in fig 1 admits any ramp model to identify coherent motions chen et al 1997 paw et al 1995 shapland et al 2012 van atta 1977 because in the srse method the analysis to identify coherent motions is bypassed the srse method focuses on the fluid elements attached to macro parcels of air whose frequencies are in the order of tenths of a second for a given trace of scalar s where in the following s may refer either to virtual temperature or temperature of the air t and to water vapor concentration w the exposure time for an ith fluid element τ is was estimated as the time between two consecutive valleys in the trace and its net scalar increase ais as the difference between the value achieved at the peak and at the first valley as an example fig 1 panel c shows two fluctuations for sonic temperature and one for water vapor concentration for the latter the time exposure and amplitude were 0 2 s and 0 3 g m 3 respectively to estimate the sensible heat flux carried out by a fluid element srse assumes castellví 2018 1 a fluctuation follows a ramp like shape whose quiescent period can be neglected because the mass of a fluid element is small fig 1 panel c and 2 the eddy diffusivity for heat k hi where i denotes the i th fluid element is mainly driven by shear and can be parameterized as k hi k τ it u i w i where u i and w i denote fluctuation reynolds decomposition of the horizontal and vertical wind speed respectively given that u i w i represents a portion of the mean friction velocity which weight is expected to depend on the size of the fluctuation a semi empirical relationship for k hi τ it was proposed weighting each fluctuation by the ratio of the time exposure over the mean time exposure of fluid elements as k hi τ it k τ it τ t ϕ h ς 1 u 2 where k is the von kármán constant τ t is the averaged time exposure of all fluid elements in half an hour temperature trace ϕ h is the stability function for the heat transfer and ς z d l is the stability parameter z is the measurement height d is the zero plane displacement and l is the obukhov length here to estimate the latent heat flux carried out by a fluid element it was assumed that the eddy diffusivity for water vapor of the i th fluid element k wi over its time exposure follows the same analytical form as for temperature therefore k wi was parameterized as k wi τ iw k τ iw τ ϕ w ς 1 u 2 where ϕ w ς 1 is the stability function for the transfer of water vapor for the i th fluid element k hi and k wi are expected to be different because time exposures for air temperature and water vapor are different i e the flux footprint area of each source such as a leaf is different for a given scalar an example of this difference is in fig 1 panel c 2 2 sensible heat flux when the turbulent diffusion equation is solved for the ith fluid element with an eddy diffusivity for heat over time exposure k hi τ it k τ it τ t ϕ h ς 1 u 2 its sensible heat flux density hi can be expressed as castellví 2018 1 h i ρ c p k π ϕ h ς 1 2 u τ it τ 1 2 a it where ρ and c p are the density and isobaric specific heat capacity of the air respectively here we note that because eq 1 refers to a fluid element the small volume of the parcel δvi to consider for this eddy may be written as δvi s dz i where s denotes a unit area and dzi represents a small part of the total vertical extent of fluid elements ejected up to the measurement height to determine the total sensible heat flux the sensible heat flux carried out by the fluid element obtained after averaging eq 1 for all the time exposures i e a representative fluid element of the population must be integrated to account for all the volume per unit area containing fluid elements hence the mean flux of sensible heat injected to the surface sub layer by the macro parcel of air can be estimated as 2 h est z v n τ i 1 i n h i τ it z v ρ c p k π n τ ϕ h ς 1 2 u i 1 i n τ it τ 1 2 τ it a it where z v dimensionless accounts for the volume of air containing fluid elements vc per unit volume i e z v v c 1 m 3 represents the total vertical extend of fluid elements ejected up to the measurement height per unit height and n is the total number of fluid elements observed in half an hour thus n τ 1800 s the theoretical probability distribution function pdf of time exposures proposed in seo and lee 1988 involves a coefficient α that accounts for the spectra of fluid elements it was found that the theoretical pdf can explain the actual pdf observed within and above the canopy castellví 2018 and that from the top of a canopy down to a height of about 2 3 the canopy height the profile of α showed a decay similar to the mean wind speed from the ground up to about 2 3 the canopy height the α profile was unpredictable therefore by assuming codependence between the distinct turbulent flows near and far from the surface haghighi and or 2013 the predictable α dependence on height was interpreted as representing that the majority of fluid elements sampled at the measurement height were placed above the zero plane displacement during the ejection phase this assumption was partly supported by zhu et al 2007 who showed for a homogeneous canopy that most of the fluid elements that spread above the canopy during the ejection phase originated in the upper part of the canopy additionally sensible heat fluxes estimated setting z v p v z d in eq 2 with p v 1 m 1 and p v f c m 1 where f c is the fraction of ground canopy cover for homogeneous and sparse canopies respectively compared close to hec the reference for completeness i e to include bare soil or surfaces where bare soil dominates over sparse short vegetation here it is proposed to estimate z v setting p v 0 5 m 1 which is empirical supported in sect 4 1 2 this case assumes that the fluid elements mainly originated in the bottom part of the macro parcel therefore z v is expressed as 3 z v p v z d homogenous c a n o p y z d f c sparse c a n o p y 0 5 z bare s o i l where here pv is set to 1 m 1 for dimensional homogeneity the bare soil case seems to introduce a discontinuity in z v but it does not because the bare soil must be interpreted as a different interface i e coherent structures penetrate into the canopy but the ground acts as a wall 2 3 latent heat flux on the basis of the k hi and k wi parameterization section 2 1 and assuming that the stability functions are similar regardless of the scalar i e ϕ w ς 1 ϕ h ς 1 1 16 ς 0 5 dyer 1974 the analytical form for the sensible heat flux is valid for any scalar castellví 2004 2013 therefore the latent heat flux can be estimated as 4 le est z v l v n τ k π ϕ h ς 1 2 u i 1 i n τ iw τ 1 2 a iw τ iw where lv is the heat of vaporization and z v is estimated by eq 3 2 4 free convection approaches 2 4 1 sensible heat flux for unstable cases the stability function for the transfer of momentum ϕ m ς and heat are related as ϕ h ς ϕ m ς 2 the free convection form for ϕ m ς is ϕ m ς 0 42 ς 1 3 for ς 0 16 högström 1988 which can be combined with eq 2 and the obukhov length l u 3 kg t h ρ c p 1 where g is the acceleration of gravity and t the mean air temperature to estimate the half hourly free convection limit sensible heat flux as 5 h fcl z v 3 2 ρ c p k π 3 4 1 0 42 3 2 k g z d t 1 2 1 n τ i 1 i n τ it τ 1 2 τ it a it 3 2 2 4 2 latent heat flux combining eq 4 the fcl form for ϕ h ς the obukhov length and the seb equation to estimate h i e h rn g le the following 3rd order equation involving the free convection limit approach for the latent heat flux is obtained 6 l e fcl 3 b u l e fcl b u r n g 0 where the coefficient b u is positive b u z v 3 l v 0 42 3 k π 3 2 k g z d ρ c p t 1 n τ i 1 i n τ iw τ 1 2 τ iw a iw 3 3 materials and methods 3 1 the field campaign from 13 may to 30 september 2016 an experiment was carried out on a cotton field in manila ar us 35 53 14 90 8 15 suvočarev et al 2019 fong et al 2020 the field was on a flat terrain 0 1 slope the crop was sprinkler irrigated and the fetch in practice may be considered unlimited regardless of the wind direction because the flux tower was deployed between two fields of the same cotton crop 63 104 and 45 104 m2 from the beginning of the campaign up to 22 june bare soil dominated the field sparse mulches made of the cover crop residues about 0 1 m thick remained and the fraction of ground cover was about 30 sparse vegetation predominated from 22 june to 18 july and during this period the canopy height h c and the fraction of ground cover varied from about h c 0 25 m and f c 30 up to about h c 0 90 m and f c 85 respectively after 18 july the crop was considered homogeneous f c remained about 85 and the maximum canopy height h c 1 10 m was reached around 28 july a three dimensional 3 d sonic anemometer csat3 and a gas analyzer licor 7500a operating at 20 hz were deployed at z 3 m the net radiation cnr4 kipp and zonen was measured at 2 m above the ground and other conventional measurements were performed to estimate the soil heat flux at three points located about 8 m into the north field at each point g was determined summing the heat flux at 0 08 m below the ground and the ground heat storage above the soil heat flux plate fuchs and tanner 1968 sauer and horton 2005 the heat flux was measured with a flux plate hfp01sc hukseflux placed 0 08 m below the ground the change in heat storage in the soil above the plate was estimated using the calorimetric method fuchs and tanner 1968 changes in soil temperature were measured using a temperature probe 107 campbell scientific placed above the soil heat flux plate at 0 06 m below the ground surface and the volumetric water content was measured with a digital time domain transmissometer digital tdt soil moisture sensor acclima adjacent to the flux plate for water the specific heat capacity and density were set to 4 19 kj kg 1 k 1 and 1 kg m 3 respectively for dry soil the specific heat capacity was 0 9 kj kg 1 k 1 and the bulk density was 1470 kg m 3 3 2 method and performance evaluation 3 2 1 database the entire dataset was split into three sub datasets referred to as bare soil sparse canopy and homogeneous canopy datasets with samples collected from the beginning of the experiment up to 22 june from 23 june up to 18 july and from 19 july up to the end of the experiment respectively for each half an hour regardless of the dataset two traces were formed one sampling the measurements at a frequency of 10 hz and another at 20 hz the former was obtained by down sampling i e skipping every other 0 05 s sample in the original 20 hz series therefore the impact in h and le estimates when different sizes of fluid elements are resolved was compared for field applications this is of main interest with regard to using thicker fine wire thermocouples i e that are more robust to measure the temperature of the air and saving space in memory cards for the bare soil dataset rn g was available for a total of 117 half hourly samples due to damage and power issues at the beginning of the campaign 3 2 2 canopy parameters the zero plane displacement was neglected for the bare soil dataset because the fraction of canopy cover was small and the mulch and vegetation at tillering were short and sparse for the other two datasets it was estimated as d 2 3h c brutsaert 1982 the sparse canopy dataset was split in three sub periods of about 10 days each because the crop was growing intermediate values for the pair h c f c for each sub period were 0 4 m 0 4 0 6 m 0 6 and 0 8 m 0 8 respectively for the homogeneous dataset the intermediate pair was 1 05 m 0 85 3 2 3 post field flux processing and performance evaluation after correcting the wind field for flow distortion due to transducer shadowing horst et al 2015 and removing samples where mean streamwise directions approached the back of the sonic anemometer by 30 to avoid flow distortion by the tower mounting ec sensible and latent heat fluxes hec and leec respectively were determined using the package eddypro 6 2 li cor biosciences lincoln ne with time series at 20 hz samples were filtered for positive hec and those that accomplished 90 fetch from the observed field regardless of the scalar time exposures and amplitudes for each fluid element in a 30 min scalar trace were determined analyzing the fluctuations observed fig 1 panel c thus for a given fluctuation signature of a fluid element in sonic temperature or water vapor concentration traces the time exposure and amplitude was determined as the time between two consecutive valleys and the difference between the peak and the first valley respectively castellví 2018 according to the seb equation for unstable cases lefcl was solved by minimizing eq 6 with boundaries 0 lefcl rn g once le fcl was obtained the traces of sonic temperature were used to estimate the buoyant heat flux using eq 5 and the final h fcl was determined after humidity correction schotanus et al 1983 the performance of h fcl and l e fcl was compared against the ec method and discussed in relation to their capability in closing the seb equation h le versus rn g comparisons were performed by calculating the slope the intercept the coefficient of determination r2 of the linear regression analysis a normalized root mean square error nrmse which was calculated as the rmse over the mean flux taken as a reference i e the corresponding ec flux in this case and the mean bias error mbe which is defined as mbe 1 n i 1 i n y iest y i where y est and y denote the estimated and the measured reference variable respectively moreover h est and l e est were included in the comparison which involve the stability parameter here approaches to estimate the stability parameter when the sonic anemometer is not available were omitted i e the focus is the fcl formulation which does not involve the stability parameter and in a straightforward manner it was determined using as input the friction velocity and the buoyant heat flux from the sonic anemometer high frequency measurements 4 results and discussion 4 1 results for each dataset table 1 shows the regression characteristics and model error terms to compare h and le determined using traces of scalars sampled at 10 hz against the corresponding ec reference fluxes and h le against rn g the results obtained for h and le determined using the sampling frequency of 20 hz differed from the results obtained at 10 hz are shown in parentheses though not shown in table 1 for each half hour scalar trace the number of fluid elements resolved at 20 hz nearly doubled those resolved at 10 hz thus the different performance shown in table 1 would partly be related to the amount of small eddies resolved as an example of an indirect quality control for eddy fluxes determined using the ec and fcl methods fig 2 shows a comparison between hec leec and h fcl l e fcl determined using scalar traces sampled at 10 hz versus rn g for each dataset 4 1 1 sensible heat and latent heat fluxes regardless of the dataset sampling frequency and method to estimate h and le table 1 shows that the intercepts int were small and that the mbe values nearly fall within the accuracy of determining hec and leec using different brands of sonic anemometers foken 2008 foken and oncley 1995 regardless of the dataset and the method to estimate h and le the estimates determined using traces at 10 hz were in general slightly better correlated with the ec method than using traces at 20 hz in any case i e regardless of the frequency the coefficients r2 for h and le were high the minimum r2 was 0 80 the slopes obtained show that the h and le estimates determined using traces at 10 hz consistently overestimated those calculated using traces at 20 hz for sensible heat flux the overestimation was about 30 for latent heat flux the overestimation depended slightly on the surface regardless of the method it was about 18 and 15 for the bare soil and the sparse canopy datasets respectively for the homogeneous dataset l e est compared higher about 25 than using l e fcl about 10 given the generalized small intercepts and mbe values and the high coefficients r2 the performance in the slopes lead in general to higher nrmse values at 10 hz than at 20 hz regardless of the dataset and the sampling frequency the main difference between the srse methods to estimate the sensible heat flux was that hfcl correlated slightly better to the ec method than hest and the intercepts were slightly smaller using hfcl than hest hfcl also generated smaller nrmse values than hest and in general to slightly smaller mbe values for latent heat flux the only one clear pattern observed comparing the two srse methods was that the nrmse values obtained using lefcl were smaller than using leest the other statistics were similar 4 1 2 surface energy balance regardless of the dataset and the srse method the slopes comparing the total turbulent flux to the available net surface energy estimated using scalar traces at 10 hz were slightly closer one than using scalar traces at 20 hz the intercepts were in general closest to zero at 20 hz than at 10 hz coefficients r2 nrmse and mbe values did not show dependency on the sampling frequency in general the srse and ec methods generated a similar surface energy balance closure in fact the ec method was not consistently superior to srse and on the basis of nrmse the fcl method operating at 10 hz was the best for each surface fig 2 shows that h fcl l e fcl and h ec l e ec scattered around rn g similarly including in near neutral cases thus the extension of the fcl approach to small values of the stability parameter leads to a performance similar to the ec surface energy balance closure for bare soil h est l e est and h fcl l e fcl were highly correlated with rn g which suggests that for this surface a refinement of the parameter pv or coefficient 0 5 in eq 3 would close the surface energy balance better especially for the fcl method in practice a coefficient obtained by forcing closure of surface energy balance could be interpreted as the factor instead of 0 5 required in eq 3 however it is not clear how to refine eq 3 because the reasons for the ec method s lack of closure about 14 of the available net surface energy are unknown provided that all the unexplained energy by the ec method in the surface energy balance arise from issues inherent in the ec method that are bypassed by the srse method e g the need to account for detrending shadowing tilt correction sensor separation and reynolds decomposition among others a refinement of eq 3 could be obtained by forcing closure of surface energy balance in practice however the latter likely would account for a portion of the available net surface energy balance that neither the ec nor the srse method can explain e g fluxes associated to mean convection and mesoscale circulations further experiments are required to refine eq 3 over surfaces dominated by bare soil however here the ec and srse methods performed comparably 4 2 discussion by defining as a rule of thumb windy conditions as when the mean half hourly wind speed observed at z 3 m was in general higher than 1 m s over a given period i e u σ u 1 m s where the overbar denotes an average and σ u is the standard deviation of the mean wind speed it was observed throughout the campaign that windy conditions prevailed for the bare dataset and for the first 20 days of the sparse canopy dataset lighter winds i e u σ u 1 m s and clear sky days were the prevailing atmospheric conditions for the last 10 days of the sparse canopy dataset and for the entire homogeneous canopy dataset calm conditions imply a lack of good ramp formation by shear in the traces and that the scalar exchange around midday under clear skies is dominated by large convective eddies both atmospheric conditions are compromising because a regular and well defined canopy scale coherent motions are crucial for the srse method and large eddies are poorly sampled within a half hourly basis these factors may explain the higher portion of the unexplained available net surface energy by the ec method in the homogeneous dataset sakai et al 2001 given the challenge for any approach to surface flux estimation to perform better than the ec method the performance obtained by the fcl approach should be highlighted across the dataset the fcl method had excellent closure in fact even slightly better than for the ec method throughout the campaign the ec method was able to explain between 81 and 92 of the available net surface energy for the different surface types and for all the data it was unable to explain 18 of the available net surface energy consistently i e regardless of the surface energy balance closure tests show that the r2 coefficient for the ec method was between the values obtained with the two srse methods the amounts of unexplained energy by the ec method may be split into two distinct general source of errors one related to the ec method that are bypassed using the srse method i e srse does not require measurement of the wind field and the other related to common issues that are not accounted for by both ec and srse methods currently it is unknown how to quantify the portion of the total unexplained energy corresponding to each error s source consequently it is difficult to assure that the sampling frequency really played a role in the srse method s results and therefore future research is required to confirm these findings the post field ec data requirements may play a role in its performance and energy balance closure regardless the fcl approach does not share instrumentation to estimate h and le and so it may be used to fill gaps in series of ec derived flux estimates in practice the results in table 1 allow recommending the fcl method using a sampling frequency of 10 hz because the mean wind speed is not required as an input and it is convenient to use thicker thermocouples because they are more affordable and less prone to damage 5 conclusions combining the frameworks of transilient and surface renewal theories with the analysis of small fluctuations in scalar traces eddies the srse method the free convection limit fcl approach for estimating the sensible and latent heat fluxes was derived to avoid measurement of the wind speed along a full cotton growing season and taking as a reference the ec method operating at 20 hz it was found that the ec and fcl methods performed similarly when taking measurements in the inertial sub layer performance was especially strong during periods where the mean half hour wind speeds measured at 3 m above the ground were about 1 m s 1 or higher if stable conditions are not met this study corroborates that fcl approaches may extend up to near neutral stability conditions for surface types commonly encountered in croplands the srse method did not show a dependency on the sampling frequency therefore in practice sensible heat flux estimates using the fcl approach operating at 10 hz appear convenient to apply at the farm level and for studies involving large spatial scales such as in the framework of remote sensing because the use of thick thermocouples allow denser spatial coverage and low cost monitoring though further research is required especially over surfaces with a high portion of bare soil and light winds given that this study involved different surface types here it is concluded that 1 the fcl approach for the srse method can be recommended for unstable cases to perform sensible heat flux and latent heat flux model calibration when the wind speed is not available 2 it may be considered to fill gaps in half hourly ec flux series and 3 appears to be a convenient approach to estimate the sensible heat flux credit authorship contribution statement francesc castellví conceptualization methodology funding acquisition visualization writing original draft kosana suvočarev data curation methodology writing review editing michele l reba resources investigation funding acquisition writing review editing benjamin r k runkle resources investigation funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported under project rti2018 098693 b c31 ministerio de ciencia economía y universidades of spain data collection and analysis was partially funded through the u s geological survey usgs under cooperative agreements g11ap20066 and g16ap00040 administered by the arkansas water resources center at the university of arkansas the united states department of agriculture usda natural resources conservation service under cooperative agreement 68 7103 17 119 and the united states national science foundation nsf under award 1752083 we acknowledge the assistance of yin lin jack chiu and bryant fong in data collection and analysis the views and conclusions contained in this document are those of the authors and do not represent the opinions or policies of the usgs nsf or usda mention of trade names or commercial products does not constitute endorsement by any entity 
5518,free convection limit fcl approaches to estimate surface fluxes are of interest given the evidence that they may extend up to near neutral stability conditions for measurements taken in the inertial sublayer the formulation based on surface renewal theory and the analysis of small eddies srse to estimate the sensible heat flux h was extended to latent heat flux le with the aim to derive their fcl approaches for sensible heat flux hfcl the input requirements are traces of the fast response such as 10 20 hz air temperature and the zero plane displacement for latent heat flux lefcl input requirements are fast response traces of water vapor density mean temperature of the air the available net surface energy rn g where rn and g are the net radiation and soil heat flux respectively and the zero plane displacement taking eddy covariance ec as a reference method the performance of the fcl method was tested over a growing cotton field that involved three contrasting surfaces partly mulched bare soil a sparse canopy and a homogeneous canopy using traces at 10 hz and 20 hz hfcl overestimated and underestimated the ec sensible heat flux hec respectively in general lefcl tended to slightly underestimate leec the surface energy balance closure show that hec leec underestimated rn g in a range of 19 homogeneous canopy and 8 sparse canopy given that in general hfcl lefcl was closer to rn g than hec leec the fcl method may be recommended for field applications especially when the wind speed is not available keywords sensible heat flux latent heat flux surface energy balance ec method free convection limit 1 introduction the latent heat flux le is involved in two fundamental equations the surface energy balance equation and the water balance equation given that the main drivers for le are the supply of water including water content in topsoil and the available net surface energy rn g where rn is the net radiation and g is the soil heat flux it links hydrological agricultural and climatological features dominguez et al 2008 li and wang 2019 robles morua et al 2012 stagl et al 2014 yang and wang 2014 in particular its knowledge is crucial for irrigation planning to perform weather forecasting climate modelling to determine the risk of fire among others brutsaert 1982 fang et al 2018 silva et al 2010 direct measurements of le by means of the eddy covariance ec method and large weighing lysimeters are preferred for scientific studies in agricultural landscapes however the required instrumentation and maintenance are expensive when the sensible heat flux h le and the available net surface energy are measured independently they allow calculating the simplified surface energy balance rn g h le which can be used as a conventional quality control to indirectly check the measurement reliability of h and le aubinet et al 2000 in general the instrumentation required for monitoring le over large areas involving different surfaces is not always affordable or applicable haymann et al 2019 and on the other hand flow distortion and windy conditions among others are problems when using respectively the ec method and a weighing lysimeter alfieri et al 2012 brutsaert 1982 burba 2013 noltz et al 2013 thus techniques and approaches to estimate le are of interest to overcome some shortcomings in measurement scaling and cost that are inherent in the ec method and weighing lysimeters albertson et al 1995 castellví 2004 drexler et al 2004 2008 french et al 2012 haymann et al 2019 li and wang 2019 paw et al 1995 snyder et al 1996 suvočarev et al 2019 yang and wang 2014 zhao et al 2010 to minimize costs in moderately tall canopies le has often been estimated indirectly using the simplified energy balance residual method i e le rn g h because the instrumentation required to estimate h g and rn is more affordable a major potential issue involved in the residual method to estimate le half hourly is that accurate measurements of all the energy terms involved in the surface energy balance seb equation do not guarantee its closure on a half hourly basis in general even on extended homogeneous surfaces the sum of turbulent fluxes is smaller than the available net surface energy foken 2008 foken et al 2011 twine et al 2000 wilson et al 2002 thus often the residual method adds unexplained energy to le there is an ongoing scientific debate about the role of low frequency circulations in the lack of closure of the seb equation cuxart et al 2015 eder et al 2014 foken 2008 huang et al 2008 kanda et al 2004 stoy et al 2013 steinfeld et al 2007 while some studies have suggested that large circulations appear to be more efficient in transporting sensible heat than latent heat charuchittipan et al 2014 stoy et al 2006 2013 other studies have shown that this role depends on the surface heterogeneity type of terrain and its uses brunsell et al 2011 cuxart et al 2015 these issues may affect the uncertainty when the residual method to estimate le is used in fact at some sites the residual method may be preferred to estimate h i e h rn g le than le castellví and oliphant 2017 when the monin obukhov similarity theory most is used through the stability parameter the friction velocity u and the sensible heat flux are required as input to estimate the latent heat flux traditionally to avoid measurement of the wind field the wind log law is implemented to estimate u h and le castellví and snyder 2010 de bruin et al 1993 hsieh and katul 1996 suvočarev et al 2019 when convection dominates the turbulence in the atmospheric surface boundary layer most similarity relationships were redone to best fit this limit case termed free convection limit fcl approaches stull 1988 implementing the fcl formulation surface eddy flux estimates of scalars become independent of the friction velocity consequently fcl approaches become simpler and surprisingly there is evidence that they performed rather reliably up to near neutral conditions albertson et al 1995 högström 1988 kohsiek 1982 monin and yaglom 1971 wang and brass 2010 for field applications minimization of input requirements has special interest when surface flux estimates are desired at multiple sites such as in the framework of remote sensing and estimation of crop coefficients drexler et al 2008 french et al 2012 zapata and martínez cob 2001 zhao et al 2010 the framework of surface renewal sr theory danckwerts 1951 harriott 1962 higbie 1935 seo and lee 1988 combined with the analysis of small eddies srse aminzadeh et al 2017 castellví 2018 haghighi and or 2013 2015 has shown potential to open new perspectives in micrometeorology for instance an srse approach was proposed to estimate u alternative to the wind log law and h requiring as input measurements of the mean wind speed and the high frequency trace of the air or virtual temperature in the roughness and inertial sub layers castellví 2018 castellví et al 2020 in the following the srse formulation will refer to applications requiring measurements taken in the inertial sub layer as input and it will be used to estimate le to our knowledge the srse approach to estimate fluxes of scalars other than temperature has never been tested here given the benefits of developing approaches requiring minimum inputs an srse fcl expression was derived for estimating h and le it was shown that the inputs required to determine h as hfcl are fast response traces of air temperature and the zero plane displacement similarly for le lefcl may be determined using fast response traces of water vapor concentration the zero plane displacement the mean temperature of the air and the available net surface energy as input therefore hfcl and lefcl do not share instrumentation this separation minimizes the probability to have simultaneous gaps in h and le in addition hfcl and lefcl are estimated independently which allows testing closure of the surface energy balance for an integral quality check here the performance of hfcl and lefcl were tested for a growing cotton field which involved surfaces with different roughness 2 theoretical considerations 2 1 the srse method with measurements in the inertial sub layer srse is a semi empirical method fully described in castellví 2018 to estimate the friction velocity and eddy fluxes to estimate the surface flux of a scalar srse considers that downward flows i e descending macro parcels of air following a coherent motion generate a narrow highly turbulent shear layer containing multiple small scale vortices zhu et al 2007 srse assumes 1 the population of small eddies which in the following are termed fluid elements generated in the volume within the canopy of the macro parcel are randomly distributed 2 during the time that a fluid element remains close to the viscous sub layer of a source exposure time mass and heat transfers through and the fluid element increases or depletes its scalar concentration until it is randomly replaced by another fluid element 3 by continuity following the coherent motion the macro parcel remains in contact with the surface for a given period though it depends on the wind speed surface roughness and stability conditions this period is on the order of a few tens of seconds until it ejects being renewed by a new sweep katul et al 1996 paw et al 1995 zhu et al 2007 during ejection most fluid elements located in the upper part of the canopy remain attached to the macro parcel of air zhu et al 2007 as a consequence regularly i e at the sweep ejection frequency a large number of fluid elements are broadly spread above the canopy in the surface boundary layer katul et al 1996 zhu et al 2007 additionally srse assumes 4 the coherent motion transports fluid elements across finite distances before they have a chance to be dissipated or become significantly diluted thus a transilient turbulence mixing concept is adopted stull 1988 for an unstable case fig 1 depicts the formation and identification of the fluid elements it shows a macro parcel of air defined as a parcel of air whose volume covers most sinks and sources following a coherent motion fig 1 panel a the actual trace of the sonic temperature and water vapor concentration of the air measured at 20 hz on may 5 at 17 5 h for a short interval is shown in fig 1 panel b which was composed by small fluctuations signatures of fluid elements embedded in the scalar change of a macro parcel of air over time t signature of a coherent structure in fig 1 panel b the signature of the coherent structure was assumed to follow the generalized ramp like shape fig 1 panel b proposed in chen et al 1997 which is composed by three phases quiescent enriching and ejection regardless the composition shown in fig 1 admits any ramp model to identify coherent motions chen et al 1997 paw et al 1995 shapland et al 2012 van atta 1977 because in the srse method the analysis to identify coherent motions is bypassed the srse method focuses on the fluid elements attached to macro parcels of air whose frequencies are in the order of tenths of a second for a given trace of scalar s where in the following s may refer either to virtual temperature or temperature of the air t and to water vapor concentration w the exposure time for an ith fluid element τ is was estimated as the time between two consecutive valleys in the trace and its net scalar increase ais as the difference between the value achieved at the peak and at the first valley as an example fig 1 panel c shows two fluctuations for sonic temperature and one for water vapor concentration for the latter the time exposure and amplitude were 0 2 s and 0 3 g m 3 respectively to estimate the sensible heat flux carried out by a fluid element srse assumes castellví 2018 1 a fluctuation follows a ramp like shape whose quiescent period can be neglected because the mass of a fluid element is small fig 1 panel c and 2 the eddy diffusivity for heat k hi where i denotes the i th fluid element is mainly driven by shear and can be parameterized as k hi k τ it u i w i where u i and w i denote fluctuation reynolds decomposition of the horizontal and vertical wind speed respectively given that u i w i represents a portion of the mean friction velocity which weight is expected to depend on the size of the fluctuation a semi empirical relationship for k hi τ it was proposed weighting each fluctuation by the ratio of the time exposure over the mean time exposure of fluid elements as k hi τ it k τ it τ t ϕ h ς 1 u 2 where k is the von kármán constant τ t is the averaged time exposure of all fluid elements in half an hour temperature trace ϕ h is the stability function for the heat transfer and ς z d l is the stability parameter z is the measurement height d is the zero plane displacement and l is the obukhov length here to estimate the latent heat flux carried out by a fluid element it was assumed that the eddy diffusivity for water vapor of the i th fluid element k wi over its time exposure follows the same analytical form as for temperature therefore k wi was parameterized as k wi τ iw k τ iw τ ϕ w ς 1 u 2 where ϕ w ς 1 is the stability function for the transfer of water vapor for the i th fluid element k hi and k wi are expected to be different because time exposures for air temperature and water vapor are different i e the flux footprint area of each source such as a leaf is different for a given scalar an example of this difference is in fig 1 panel c 2 2 sensible heat flux when the turbulent diffusion equation is solved for the ith fluid element with an eddy diffusivity for heat over time exposure k hi τ it k τ it τ t ϕ h ς 1 u 2 its sensible heat flux density hi can be expressed as castellví 2018 1 h i ρ c p k π ϕ h ς 1 2 u τ it τ 1 2 a it where ρ and c p are the density and isobaric specific heat capacity of the air respectively here we note that because eq 1 refers to a fluid element the small volume of the parcel δvi to consider for this eddy may be written as δvi s dz i where s denotes a unit area and dzi represents a small part of the total vertical extent of fluid elements ejected up to the measurement height to determine the total sensible heat flux the sensible heat flux carried out by the fluid element obtained after averaging eq 1 for all the time exposures i e a representative fluid element of the population must be integrated to account for all the volume per unit area containing fluid elements hence the mean flux of sensible heat injected to the surface sub layer by the macro parcel of air can be estimated as 2 h est z v n τ i 1 i n h i τ it z v ρ c p k π n τ ϕ h ς 1 2 u i 1 i n τ it τ 1 2 τ it a it where z v dimensionless accounts for the volume of air containing fluid elements vc per unit volume i e z v v c 1 m 3 represents the total vertical extend of fluid elements ejected up to the measurement height per unit height and n is the total number of fluid elements observed in half an hour thus n τ 1800 s the theoretical probability distribution function pdf of time exposures proposed in seo and lee 1988 involves a coefficient α that accounts for the spectra of fluid elements it was found that the theoretical pdf can explain the actual pdf observed within and above the canopy castellví 2018 and that from the top of a canopy down to a height of about 2 3 the canopy height the profile of α showed a decay similar to the mean wind speed from the ground up to about 2 3 the canopy height the α profile was unpredictable therefore by assuming codependence between the distinct turbulent flows near and far from the surface haghighi and or 2013 the predictable α dependence on height was interpreted as representing that the majority of fluid elements sampled at the measurement height were placed above the zero plane displacement during the ejection phase this assumption was partly supported by zhu et al 2007 who showed for a homogeneous canopy that most of the fluid elements that spread above the canopy during the ejection phase originated in the upper part of the canopy additionally sensible heat fluxes estimated setting z v p v z d in eq 2 with p v 1 m 1 and p v f c m 1 where f c is the fraction of ground canopy cover for homogeneous and sparse canopies respectively compared close to hec the reference for completeness i e to include bare soil or surfaces where bare soil dominates over sparse short vegetation here it is proposed to estimate z v setting p v 0 5 m 1 which is empirical supported in sect 4 1 2 this case assumes that the fluid elements mainly originated in the bottom part of the macro parcel therefore z v is expressed as 3 z v p v z d homogenous c a n o p y z d f c sparse c a n o p y 0 5 z bare s o i l where here pv is set to 1 m 1 for dimensional homogeneity the bare soil case seems to introduce a discontinuity in z v but it does not because the bare soil must be interpreted as a different interface i e coherent structures penetrate into the canopy but the ground acts as a wall 2 3 latent heat flux on the basis of the k hi and k wi parameterization section 2 1 and assuming that the stability functions are similar regardless of the scalar i e ϕ w ς 1 ϕ h ς 1 1 16 ς 0 5 dyer 1974 the analytical form for the sensible heat flux is valid for any scalar castellví 2004 2013 therefore the latent heat flux can be estimated as 4 le est z v l v n τ k π ϕ h ς 1 2 u i 1 i n τ iw τ 1 2 a iw τ iw where lv is the heat of vaporization and z v is estimated by eq 3 2 4 free convection approaches 2 4 1 sensible heat flux for unstable cases the stability function for the transfer of momentum ϕ m ς and heat are related as ϕ h ς ϕ m ς 2 the free convection form for ϕ m ς is ϕ m ς 0 42 ς 1 3 for ς 0 16 högström 1988 which can be combined with eq 2 and the obukhov length l u 3 kg t h ρ c p 1 where g is the acceleration of gravity and t the mean air temperature to estimate the half hourly free convection limit sensible heat flux as 5 h fcl z v 3 2 ρ c p k π 3 4 1 0 42 3 2 k g z d t 1 2 1 n τ i 1 i n τ it τ 1 2 τ it a it 3 2 2 4 2 latent heat flux combining eq 4 the fcl form for ϕ h ς the obukhov length and the seb equation to estimate h i e h rn g le the following 3rd order equation involving the free convection limit approach for the latent heat flux is obtained 6 l e fcl 3 b u l e fcl b u r n g 0 where the coefficient b u is positive b u z v 3 l v 0 42 3 k π 3 2 k g z d ρ c p t 1 n τ i 1 i n τ iw τ 1 2 τ iw a iw 3 3 materials and methods 3 1 the field campaign from 13 may to 30 september 2016 an experiment was carried out on a cotton field in manila ar us 35 53 14 90 8 15 suvočarev et al 2019 fong et al 2020 the field was on a flat terrain 0 1 slope the crop was sprinkler irrigated and the fetch in practice may be considered unlimited regardless of the wind direction because the flux tower was deployed between two fields of the same cotton crop 63 104 and 45 104 m2 from the beginning of the campaign up to 22 june bare soil dominated the field sparse mulches made of the cover crop residues about 0 1 m thick remained and the fraction of ground cover was about 30 sparse vegetation predominated from 22 june to 18 july and during this period the canopy height h c and the fraction of ground cover varied from about h c 0 25 m and f c 30 up to about h c 0 90 m and f c 85 respectively after 18 july the crop was considered homogeneous f c remained about 85 and the maximum canopy height h c 1 10 m was reached around 28 july a three dimensional 3 d sonic anemometer csat3 and a gas analyzer licor 7500a operating at 20 hz were deployed at z 3 m the net radiation cnr4 kipp and zonen was measured at 2 m above the ground and other conventional measurements were performed to estimate the soil heat flux at three points located about 8 m into the north field at each point g was determined summing the heat flux at 0 08 m below the ground and the ground heat storage above the soil heat flux plate fuchs and tanner 1968 sauer and horton 2005 the heat flux was measured with a flux plate hfp01sc hukseflux placed 0 08 m below the ground the change in heat storage in the soil above the plate was estimated using the calorimetric method fuchs and tanner 1968 changes in soil temperature were measured using a temperature probe 107 campbell scientific placed above the soil heat flux plate at 0 06 m below the ground surface and the volumetric water content was measured with a digital time domain transmissometer digital tdt soil moisture sensor acclima adjacent to the flux plate for water the specific heat capacity and density were set to 4 19 kj kg 1 k 1 and 1 kg m 3 respectively for dry soil the specific heat capacity was 0 9 kj kg 1 k 1 and the bulk density was 1470 kg m 3 3 2 method and performance evaluation 3 2 1 database the entire dataset was split into three sub datasets referred to as bare soil sparse canopy and homogeneous canopy datasets with samples collected from the beginning of the experiment up to 22 june from 23 june up to 18 july and from 19 july up to the end of the experiment respectively for each half an hour regardless of the dataset two traces were formed one sampling the measurements at a frequency of 10 hz and another at 20 hz the former was obtained by down sampling i e skipping every other 0 05 s sample in the original 20 hz series therefore the impact in h and le estimates when different sizes of fluid elements are resolved was compared for field applications this is of main interest with regard to using thicker fine wire thermocouples i e that are more robust to measure the temperature of the air and saving space in memory cards for the bare soil dataset rn g was available for a total of 117 half hourly samples due to damage and power issues at the beginning of the campaign 3 2 2 canopy parameters the zero plane displacement was neglected for the bare soil dataset because the fraction of canopy cover was small and the mulch and vegetation at tillering were short and sparse for the other two datasets it was estimated as d 2 3h c brutsaert 1982 the sparse canopy dataset was split in three sub periods of about 10 days each because the crop was growing intermediate values for the pair h c f c for each sub period were 0 4 m 0 4 0 6 m 0 6 and 0 8 m 0 8 respectively for the homogeneous dataset the intermediate pair was 1 05 m 0 85 3 2 3 post field flux processing and performance evaluation after correcting the wind field for flow distortion due to transducer shadowing horst et al 2015 and removing samples where mean streamwise directions approached the back of the sonic anemometer by 30 to avoid flow distortion by the tower mounting ec sensible and latent heat fluxes hec and leec respectively were determined using the package eddypro 6 2 li cor biosciences lincoln ne with time series at 20 hz samples were filtered for positive hec and those that accomplished 90 fetch from the observed field regardless of the scalar time exposures and amplitudes for each fluid element in a 30 min scalar trace were determined analyzing the fluctuations observed fig 1 panel c thus for a given fluctuation signature of a fluid element in sonic temperature or water vapor concentration traces the time exposure and amplitude was determined as the time between two consecutive valleys and the difference between the peak and the first valley respectively castellví 2018 according to the seb equation for unstable cases lefcl was solved by minimizing eq 6 with boundaries 0 lefcl rn g once le fcl was obtained the traces of sonic temperature were used to estimate the buoyant heat flux using eq 5 and the final h fcl was determined after humidity correction schotanus et al 1983 the performance of h fcl and l e fcl was compared against the ec method and discussed in relation to their capability in closing the seb equation h le versus rn g comparisons were performed by calculating the slope the intercept the coefficient of determination r2 of the linear regression analysis a normalized root mean square error nrmse which was calculated as the rmse over the mean flux taken as a reference i e the corresponding ec flux in this case and the mean bias error mbe which is defined as mbe 1 n i 1 i n y iest y i where y est and y denote the estimated and the measured reference variable respectively moreover h est and l e est were included in the comparison which involve the stability parameter here approaches to estimate the stability parameter when the sonic anemometer is not available were omitted i e the focus is the fcl formulation which does not involve the stability parameter and in a straightforward manner it was determined using as input the friction velocity and the buoyant heat flux from the sonic anemometer high frequency measurements 4 results and discussion 4 1 results for each dataset table 1 shows the regression characteristics and model error terms to compare h and le determined using traces of scalars sampled at 10 hz against the corresponding ec reference fluxes and h le against rn g the results obtained for h and le determined using the sampling frequency of 20 hz differed from the results obtained at 10 hz are shown in parentheses though not shown in table 1 for each half hour scalar trace the number of fluid elements resolved at 20 hz nearly doubled those resolved at 10 hz thus the different performance shown in table 1 would partly be related to the amount of small eddies resolved as an example of an indirect quality control for eddy fluxes determined using the ec and fcl methods fig 2 shows a comparison between hec leec and h fcl l e fcl determined using scalar traces sampled at 10 hz versus rn g for each dataset 4 1 1 sensible heat and latent heat fluxes regardless of the dataset sampling frequency and method to estimate h and le table 1 shows that the intercepts int were small and that the mbe values nearly fall within the accuracy of determining hec and leec using different brands of sonic anemometers foken 2008 foken and oncley 1995 regardless of the dataset and the method to estimate h and le the estimates determined using traces at 10 hz were in general slightly better correlated with the ec method than using traces at 20 hz in any case i e regardless of the frequency the coefficients r2 for h and le were high the minimum r2 was 0 80 the slopes obtained show that the h and le estimates determined using traces at 10 hz consistently overestimated those calculated using traces at 20 hz for sensible heat flux the overestimation was about 30 for latent heat flux the overestimation depended slightly on the surface regardless of the method it was about 18 and 15 for the bare soil and the sparse canopy datasets respectively for the homogeneous dataset l e est compared higher about 25 than using l e fcl about 10 given the generalized small intercepts and mbe values and the high coefficients r2 the performance in the slopes lead in general to higher nrmse values at 10 hz than at 20 hz regardless of the dataset and the sampling frequency the main difference between the srse methods to estimate the sensible heat flux was that hfcl correlated slightly better to the ec method than hest and the intercepts were slightly smaller using hfcl than hest hfcl also generated smaller nrmse values than hest and in general to slightly smaller mbe values for latent heat flux the only one clear pattern observed comparing the two srse methods was that the nrmse values obtained using lefcl were smaller than using leest the other statistics were similar 4 1 2 surface energy balance regardless of the dataset and the srse method the slopes comparing the total turbulent flux to the available net surface energy estimated using scalar traces at 10 hz were slightly closer one than using scalar traces at 20 hz the intercepts were in general closest to zero at 20 hz than at 10 hz coefficients r2 nrmse and mbe values did not show dependency on the sampling frequency in general the srse and ec methods generated a similar surface energy balance closure in fact the ec method was not consistently superior to srse and on the basis of nrmse the fcl method operating at 10 hz was the best for each surface fig 2 shows that h fcl l e fcl and h ec l e ec scattered around rn g similarly including in near neutral cases thus the extension of the fcl approach to small values of the stability parameter leads to a performance similar to the ec surface energy balance closure for bare soil h est l e est and h fcl l e fcl were highly correlated with rn g which suggests that for this surface a refinement of the parameter pv or coefficient 0 5 in eq 3 would close the surface energy balance better especially for the fcl method in practice a coefficient obtained by forcing closure of surface energy balance could be interpreted as the factor instead of 0 5 required in eq 3 however it is not clear how to refine eq 3 because the reasons for the ec method s lack of closure about 14 of the available net surface energy are unknown provided that all the unexplained energy by the ec method in the surface energy balance arise from issues inherent in the ec method that are bypassed by the srse method e g the need to account for detrending shadowing tilt correction sensor separation and reynolds decomposition among others a refinement of eq 3 could be obtained by forcing closure of surface energy balance in practice however the latter likely would account for a portion of the available net surface energy balance that neither the ec nor the srse method can explain e g fluxes associated to mean convection and mesoscale circulations further experiments are required to refine eq 3 over surfaces dominated by bare soil however here the ec and srse methods performed comparably 4 2 discussion by defining as a rule of thumb windy conditions as when the mean half hourly wind speed observed at z 3 m was in general higher than 1 m s over a given period i e u σ u 1 m s where the overbar denotes an average and σ u is the standard deviation of the mean wind speed it was observed throughout the campaign that windy conditions prevailed for the bare dataset and for the first 20 days of the sparse canopy dataset lighter winds i e u σ u 1 m s and clear sky days were the prevailing atmospheric conditions for the last 10 days of the sparse canopy dataset and for the entire homogeneous canopy dataset calm conditions imply a lack of good ramp formation by shear in the traces and that the scalar exchange around midday under clear skies is dominated by large convective eddies both atmospheric conditions are compromising because a regular and well defined canopy scale coherent motions are crucial for the srse method and large eddies are poorly sampled within a half hourly basis these factors may explain the higher portion of the unexplained available net surface energy by the ec method in the homogeneous dataset sakai et al 2001 given the challenge for any approach to surface flux estimation to perform better than the ec method the performance obtained by the fcl approach should be highlighted across the dataset the fcl method had excellent closure in fact even slightly better than for the ec method throughout the campaign the ec method was able to explain between 81 and 92 of the available net surface energy for the different surface types and for all the data it was unable to explain 18 of the available net surface energy consistently i e regardless of the surface energy balance closure tests show that the r2 coefficient for the ec method was between the values obtained with the two srse methods the amounts of unexplained energy by the ec method may be split into two distinct general source of errors one related to the ec method that are bypassed using the srse method i e srse does not require measurement of the wind field and the other related to common issues that are not accounted for by both ec and srse methods currently it is unknown how to quantify the portion of the total unexplained energy corresponding to each error s source consequently it is difficult to assure that the sampling frequency really played a role in the srse method s results and therefore future research is required to confirm these findings the post field ec data requirements may play a role in its performance and energy balance closure regardless the fcl approach does not share instrumentation to estimate h and le and so it may be used to fill gaps in series of ec derived flux estimates in practice the results in table 1 allow recommending the fcl method using a sampling frequency of 10 hz because the mean wind speed is not required as an input and it is convenient to use thicker thermocouples because they are more affordable and less prone to damage 5 conclusions combining the frameworks of transilient and surface renewal theories with the analysis of small fluctuations in scalar traces eddies the srse method the free convection limit fcl approach for estimating the sensible and latent heat fluxes was derived to avoid measurement of the wind speed along a full cotton growing season and taking as a reference the ec method operating at 20 hz it was found that the ec and fcl methods performed similarly when taking measurements in the inertial sub layer performance was especially strong during periods where the mean half hour wind speeds measured at 3 m above the ground were about 1 m s 1 or higher if stable conditions are not met this study corroborates that fcl approaches may extend up to near neutral stability conditions for surface types commonly encountered in croplands the srse method did not show a dependency on the sampling frequency therefore in practice sensible heat flux estimates using the fcl approach operating at 10 hz appear convenient to apply at the farm level and for studies involving large spatial scales such as in the framework of remote sensing because the use of thick thermocouples allow denser spatial coverage and low cost monitoring though further research is required especially over surfaces with a high portion of bare soil and light winds given that this study involved different surface types here it is concluded that 1 the fcl approach for the srse method can be recommended for unstable cases to perform sensible heat flux and latent heat flux model calibration when the wind speed is not available 2 it may be considered to fill gaps in half hourly ec flux series and 3 appears to be a convenient approach to estimate the sensible heat flux credit authorship contribution statement francesc castellví conceptualization methodology funding acquisition visualization writing original draft kosana suvočarev data curation methodology writing review editing michele l reba resources investigation funding acquisition writing review editing benjamin r k runkle resources investigation funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported under project rti2018 098693 b c31 ministerio de ciencia economía y universidades of spain data collection and analysis was partially funded through the u s geological survey usgs under cooperative agreements g11ap20066 and g16ap00040 administered by the arkansas water resources center at the university of arkansas the united states department of agriculture usda natural resources conservation service under cooperative agreement 68 7103 17 119 and the united states national science foundation nsf under award 1752083 we acknowledge the assistance of yin lin jack chiu and bryant fong in data collection and analysis the views and conclusions contained in this document are those of the authors and do not represent the opinions or policies of the usgs nsf or usda mention of trade names or commercial products does not constitute endorsement by any entity 
5519,monthly streamflow prediction is very important for many hydrological applications in providing information for optimal use of water resources in this study the prediction accuracy of new heuristic methods optimally pruned extreme learning machine op elm least square support vector machine lssvm multivariate adaptive regression splines mars and m5 model tree m5tree is examined in modeling monthly streamflows using precipitation and temperature inputs data collected from kalam and chakdara stations at a mountainous basin swat river basin pakistan are utilized as case study the prediction accuracy of all four methods are validated and tested using four different input scenarios and evaluated using combined accuracy ca a newly used criterion in addition to root mean square error rmse normalized rmse mean absolute error mae and nash sutcliffe efficiency nse the test results of both stations show that the lssvm and mars based models provide more accurate prediction results compared to op elm and m5tree models lssvm decreases the rmse of the mars op elm and m5tree by 9 12 25 64 and 35 15 for the kalam station while the rmses of the lssvm op elm and m5tree is decreased by 2 12 34 81 and 32 52 using mars for the chakdara station respectively it is observed that the monthly streamflows of kalam station can be successfully predicted using only temperature data only precipitation inputs also provide good accuracy for kalam station while they produce inaccurate predictions for the chakdara station the prediction capabilities of the applied methods are also examined in estimating streamflow of downstream station using upstream data the results prove the dominancy of lssvm and mars based models over op elm and m5tree in prediction streamflow data without local input data heuristic methods are also compared with stochastic method of seasonal auto regressive moving average sarima the op elm lssvm mars perform superior to the sarima in monthly streamflow prediction based on the overall results the lssvm and mars are recommended for monthly streamflow prediction with or without local data keywords streamflow forecasting swat river lssvm mars op elm m5 model tree 1 introduction streamflow is a fundamental part of terrestrial water cycle and has a critical importance in wide range of applications predicting streamflow has several benefits and would help to provide reliable useful and significant information in large domains such as water resources management over the years it has been demonstrated that streamflow can be predicted and forecasted at different timescales using artificial intelligence ai based models and the number of published papers has been increased in recent years araghinejad et al 2018 kisi et al 2018 yuan et al 2018 artificial neural network ann based models have long been recognized as the accurate ai based models for providing robust and accurate estimation of the streamflow ghumman et al 2018 several types of ai based models have been widely developed and applied to estimate streamflow from meteorological data in different regions over the world i the multilayer perceptron neural networks mlpnn tongal and booij 2018 ii radial basis neural network rbnn muhammad et al 2017 iii generalized regression neural network grnn diop et al 2018 iv support vector machines svm and least square support vector machines lssvm luo et al 2019 modaresi et al 2018 v multivariate adaptive regression splines model mars yin et al 2018 vi m5 model tree m5tree nourani et al 2019 vii gaussian process regression zhu et al 2018 and viii adaptive neuro fuzzy inference system anfis hadi and tombul 2018a tongal and booij 2018 compared the mlpnn svm and random forest rf using precipitation p temperature te and evapotranspiration et in streamflow forecasting using data from four rivers in usa in overall the results obtained demonstrated that the mlpnn performed better than the svm and rf muhammad adnan et al 2017 compared the rbnn grnn and anfis based models in monthly streamflow forecasting results indicated that the rbnn was more accurate than the grnn model while the anfis based models provided the best accuracy luo et al 2019 proposed a hybrid svm based model for monthly streamflow in iran compared to the grnn the hybrid svm performed better modaresi et al 2018 compared lssvm grnn mlpnn and k nearest neighbor regression knn in monthly streamflow forecasting and the lssvm performed the best using data from china yin et al 2018 applied mars m5tree and svm for forecasting daily streamflow in one two and three day in advance the authors reported that the m5tree was more accurate than the svm and mars based models nourani et al 2019 utilized the hybrid wavelet m5tree model and compared with the ann model in forecasting river runoff on both daily and monthly basis according to the obtained results the authors demonstrated that the hybrid wavelet m5tree was more accurate than the ann model zhu et al 2018 introduced the gaussian process regression gpr as a new ai based model for forecasting streamflow gpr was more accurate compared to the grnn based model hadi and tombul 2018a compared the anfis mlpnn and svm based models in forecasting daily streamflow using data from three stations in turkey in overall the authors reported that the anfis and mlpnn based models worked with relatively similar accuracy and they outperformed the svm based model in the last decade several evolutionary models which use both ai and evolutionary algorithms e g genetic algorithm have been proposed for streamflow prediction adnan et al 2018 azad et al 2018 danandeh mehr 2018 mirabbasi et al 2019 ghorbani et al 2018 hadi and tombul 2018b adnan et al 2017 ravansalar et al 2017 sanikhani and kisi 2012 kisi 2015a b kisi 2015a b investigated prediction accuracy of the lssvm based models with anfis based models and superior results were gotten from the lssvm compared to anfis based models azad et al 2018 compared three evolutionary neuro fuzzy enf based methods in river flow prediction and enf based model based on pso significantly improved the accuracy of classical neuro fuzzy model adnan et al 2018 developed three ai models namely lssvm fuzzy genetic approach fga and m5tree for daily and monthly streamflow forecasting using data collected from two stations in pakistan the authors compared several scenarios having different input combinations of streamflow q te and p data according to the obtained results they have demonstrated that i using only previous record of precipitation does not provide high accuracy and all the employed models work the worst with the highest error indices and the lowest r2 ii combining previous monthly values of te significantly improved the models accuracies during the validation phase respectively adnan et al 2017 applied a new hybrid evolutionary data driven model hlgsa using the gravitational search algorithm gsa with lssvm for forecasting monthly streamflows at astore and shyok rivers pakistan the hlgsa based model provided the best accuracy compared to mars and m5tree based models in another study ravansalar et al 2017 proposed a new hybrid data driven model called wavelet linear genetic programming wlgp for predicting monthly streamflow at two stations in iran the proposed model was compared to the original lgp mlpnn wavelet mlpnn wmlpnn and standard mlr from the obtained results the authors demonstrated that by using three previous values of streamflow qt qt 1 and qt 2 the wlgp outperformed all other methods karimi et al 2018 applied gep and svm based models for predicting daily streamflow using data from four stations in china the authors demonstrated that the gep outperforms the svm based model all the studies above indicated that the ai based models successfully applied for predicting streamflow extreme learning machine elm has been introduced during the last decade as a training algorithm for the single layer neural networks and it has been shown to be useful in predicting and forecasting streamflow a large number of models can be found related to this issue in the literature adnan et al 2019 lima et al 2017 taormina and chau 2015 wang et al 2019 yadav et al 2016 yaseen et al 2016 2018b 2019 lima et al 2016 rezaie balf and kisi 2018 yaseen et al 2018a taormina and chau 2015 used elm and binary coded discrete fully informed particle swarm optimization in streamflow prediction using benchmark datasets from kentucky river basin wang et al 2019 proposed a double processing strategy for elm based models for forecasting monthly streamflow in gulang river basin compared to the single processing elm and without processing elm models the double processing elm models performed better lima et al 2016 applied a modified version of the original elm called the online sequential extreme learning machine oselm for forecasting daily streamflow using data collected at two stations in southern british columbia canada as a result of the investigation the authors recommended the use of large data set for the training phase in order to obtain a model with high accuracy in another study lima et al 2017 proposed an improved version of the first oselm based model applied in lima et al 2016 for forecasting daily streamflow the proposed model called as variable complexity oselm vc oselm which outperformed the oselm in terms of accuracy during the testing phase in order to forecast discharge in river measured at hourly time step yadav et al 2016 applied the oselm based model using data collected at the neckar river germany the results obtained using oselm based model were compared to those provided by gp mlpnn and svm it was demonstrated that the oselm was more accurate and outperformed the gp svm and mlpnn based models rezaie balf and kisi 2018 introduced an improved version of the original elm called optimally pruned extreme learning machine op elm for forecasting daily streamflow using data from three stations in iran they used previous streamflow values as inputs to the models in their study the op elm was compared to the mlpnn and the evolutionary polynomial regression epr by comparing several input combinations of the previous daily q the authors demonstrated that the epr worked the best at two stations while the mlpnn was the most accurate model at the third station yaseen et al 2016b compared the elm grnn and svm for forecasting monthly streamflow in the arid region of iraq results obtained from the investigation demonstrated that the elm outperformed the svm and grnn based models and the elm decreased the rmse of the svm and the grnn by 21 3 and 44 7 respectively wavelet analysis wa is used to decompose an original nonlinear and nonstationary signal into sub signals and a conjunction model can be established between wavelet coefficients and the streamflow data hadi and tombul 2018c yaseen et al 2018a have already demonstrated the benefits of wa combined with the elm model for streamflow forecasting wa elm using data at monthly time step in a semi arid region of iraq the authors demonstrated that the wa elm having three previous records of q outperformed the elm based model significantly in another study conducted by yaseen et al 2018b daily weekly and monthly streamflow in malaysia were predicted using the elm model compared to the mlpnn based model the elm outperformed the other models for daily weekly and monthly time steps recently in a study conducted by yaseen et al 2019 an enhanced version of extreme learning machine eelm model was utilized in streamflow prediction results obtained from the investigation demonstrated that the eelm outperformed the svm and elm models all the studies above showed that the improved versions of elm method could be successfully applied for prediction of streamflow and it can be considered as good alternative to mlpnn or ann grnn svm and gp to the best of our knowledge there is no study that applies the op elm method for predicting monthly streamflow even though both long term and short term streamflow predictions are important operation of reservoirs is generally planned dependent on monthly time scale therefore prediction of monthly streamflows has an important role in management of water resources honorato et al 2018 especially for the mountainous basins with high altitudes where sufficient meteorological data are generally not available and or not feasible to record the main contributions of this study are i to investigate the potential of new heuristic methods op elm lssvm mars and m5tree based for improving monthly streamflow prediction in mountainous basin ii to compare the accuracy of op elm with the lssvm mars and m5tree based models in this study four heuristic methods were selected for comparison in estimating streamflow lssvm has some advantages over the standard svm method as also mentioned in the methods section lssvm can be considered as the improved version of the svm and it has less computational time and less complexity compared to svm op elm is also improved version of standard elm method and it has some advantages over the ann method for example the elm is faster than the ann and can meet better generalization performance and because it can determine the output weights analytically on the other hand in op elm more robust model can be obtained compared to standard elm due to the pruning procedure of the neurons th main advantages of the mars which is a nonlinear and non parametric regression apporach are its robustness and efficiency in exploring a large number of intricate nonlinear relations and rapid detection of interactions between them despite their complexity the main advantages of the m5tree model which is a binary decision tree with a series of functions of linear regression are its simple geometric structure and the capability to efficiently handle a large number of datasets with different attributes therefore the lssvm op elm mars and m5tree were selected to be compared in streamflow prediction in the presented study 2 materials and methods 2 1 case study in order to examine the prediction accuracy of the implemented methods the swat river basin located at complex topography of hindukush mountains of pakistan was selected as the case study site the geographical location of swat river basin is approximately between longitudes 70 59 to 72 47 e and latitudes 34 20 to 35 56 n the river lies in northern part of pakistan and covers a catchment area of about 14 039 km2 with mean elevation of 2 180 m the river receives average precipitation over the entire basin ranging from 375 mm to 1 250 mm annually streamflow modeling of this river is very vital for the economic development of the country due to a proposed hydropower project on this river namely mohmand dam hydropower project with an estimated installed capacity of 740 megawatts mw anjum et al 2016 in this study hydro meteorological data streamflow precipitation and temperature of two hydrometric stations on swat river basin namely kalam and chakdara were used for prediction streamflow see fig 1 the monthly data of streamflows of both stations were obtained from water and power development authority wapda pakistan for the duration of 1964 2008 45 years 540 months before models applications the data were divided into three phases approximately 50 276 months of the datasets was used for training phase while the remaining 50 of the datasets was equally divided for validation and testing purposes brief statistical properties of the applied data can be observed from table 1 precipitation variable has high skewness especially for the chakdara station validation data range is higher than that of the training data in both stations and extrapolation difficulties models cannot estimate the data beyond the training range may be expected from the employed models kisi and aytek 2013 kisi and parmar 2016 kalam and chakdara stations were chosen in this study due to their hydrologically distinct nature from each other and due to importance of hydropower generation capabilities of the basin the swat river is important for the future economic development of pakistan kalam station is located at upstream section of basin kalam and surrounding areas comprise very rugged mountain topography with temperature variation of 22 6 c to 2 2 with elevation range of 2000 5808 m a s l and with a mean precipitation of 76 1 mm the precipitation in the upper section is dominated by the winter rainfall mainly received from the western disturbances most of the winter precipitation is received in the form of snow on the other hand chakdara station is located at the downstream of the basin i e called lower swat basin area this area comprises relatively flat with elevation range of 500 2000 m a s l with temperature variation of 30 7 c to 1 1 and with a mean precipitation of 11 3 mm the precipitation pattern in the lower part is influenced by the summer monsoon rainfall on an average 75 of the total discharge is contributed by snowmelt in the swat watershed in such mountainous basins with high altitude sufficient meteorological data and snow data are not available or not feasible to record therefore this study caries much importance for a developing country such as pakistan 2 2 op elm the extreme learning machine elm is known as one of the most effective optimization algorithms in soft computing areas the elm uses a trial and error process for determining the number of random hidden nodes it can be used to train a single hidden layer feed forward artificial neural network slfn in other words in the elm the parameters associated with the hidden neurons are randomly assigned while the output weights will be analytically determined rong et al 2008 pouzols and lendasse 2010 consider a dataset of m observation samples x i y i with x i r d 1 and y i r d 2 an slfn with n hidden neurons can be defined by the following sum 1 i 1 n β i f x j c i a i 1 j m where a i c i are the learning parameters the biases and weights of the hidden nodes f is considered as the activation function and β i are the output weights of the output node utilizing the radial basis function for hidden nodes the form of f x j c i a i activation function can be applied where c i are the centers and a i are the spreads or radii of the ith rbf nodes in case of having a perfect fit of the data and the sfln the difference between the estimated outputs y i and the target variable would be zero and thus the following relation can be written 2 i 1 n β i f x j c i a i y j 1 j m the above relation can be rewritten as 3 h β y with 4 h c 1 c n a 1 a n x 1 x n f x 1 c 1 a 1 f x 1 c n a n f x m c 1 a 1 f x m c n a n β β 1 t β n t and y y 1 t y m t β represents the output weights of the slfn and h is the hidden layer output matrix which is generated in a random way the output weights can be estimated as 5 β h y where h stands for the moore penrose inverse of the h matrix rong et al 2008 miche et al 2010 unlike the other learning methods which require several parameters to be tuned in the elm solely the number of neurons in the hidden layer for specific types of activation functions has to be determined therefore in the standard version of the elm too small or too large number of hidden nodes might lead to overfitting of the learning process consequently utilizing a pruning procedure would enhance the performance of the standard elm in this regard rong et al 2008 proposed the pruned elm p elm algorithm which is an upgraded architectural design of the elm classifier network later the p elm was upgraded to the optimally pruned extreme learning machine op elm by miche et al 2010 the main idea of the op elm lies in selecting the subset of best hidden nodes using some statistical measures afterwards the less low prevalent nodes would be removed and the hence would be pruned in general the op elm can be introduced in three main steps the first step is the construction of the neural network using lots of initial hidden neurons in the second step the best neurons in the hidden layer are ranked this can be done by using different techniques such as multi response sparse regression mrsr or least angle regression lars the third step is devoted to selecting the optimal number of neurons and pruning the potential irrelevant neurons of the slfn using methods such as the leave one out validation technique similä and tikka 2005 miche et al 2010 2 3 lssvm the original support vector machine svm algorithm was introduced by vapnik 1995 on the basis of statistical learning theory the svm utilizes quadratic programming in order to formulate the training process of modeling procedure suykens and vandewalle 1999 proposed a novel svm for reducing the computational time of the svm known as the least squares svm lssvm let s consider a given training set of m datasets with input data x t r m and output f x r r m is the m dimensional vector space and r is the one dimensional vector space in feature space the lssvm based models for regression problems can be defined as samui and kothari 2011 6 f x w t φ x b where φ denotes the mapping functions which transfer the input data into a higher dimensional feature space w is an adjustable weight vector and b stands for the scalar threshold also known as bias the following optimization problem can be formulated for function estimation 7 minimize 1 2 w t w 1 2 γ t 1 m e t 2 subjected to f x w t φ x b e t t 1 m where e is the error variable and γ is the regulative constant the final form of the lssvm is obtained by solving the above optimization problem as 8 f x t 1 m α t k x x t b k x x t is called as kernel function rbf kernel function has been used in this study following the previous study baesens et al 2000 which rbf and polynomial kernels were compared using different data sets and first kernel was found to be better than the latter the formulation of rbf kernel is 9 k x x t exp x x t 2 2 σ 2 2 4 mars multivariate adaptive regression splines mars was proposed as a non linear and non parametric method to predict forecast a continuous dependent parameter friedman 1991 in the mars based model piecewise basis functions are used to define complex non linear relationships between the continuous parameter and input vector parameters set of predictors this process is done by taking a forward backward procedure kisi and parmar 2016 in the forward stepwise stage a large number of basis functions bfs are added to the model which makes the model overfit the data initially bfs of the mars based model are dependent on a segment spline functions which divide the dataset into separate piecewise linear segments spline functions are joined at knots fixed point in general the mars based model can be described as the following structure 10 f x δ 0 m 1 m δ m h m x where h m x are spline functions δ are coefficients that can be calculated through the minimum sum of squared errors from splines functions m is the number of functions in the mars based model in the backward stage pruning stage unnecessary basis functions are eliminated using the generalized cross validation criterion to improve the forecasting accuracy and hence the final number of functions m is determined kisi and parmar 2016 roy et al 2018 2 5 m5 model tree model trees generalize the concept of regression trees which comprise constant values in their leaves accordingly they are analogous to piece wise linear functions and hence nonlinear constructing an m5 model tree m5tree consists of two stages of 1 creating decision tree using a split criterion and 2 designing the model tree by pruning the overgrown tree singh et al 2010 the splitting in the m5tree approach applies the idea of a decision tree but instead of the class labels it is composed of linear regression functions at the leaves which can estimate continuous numerical attributes let consider a set of m training examples with independent parameters as the input and associated target as the output value parameters can be either associated with a leaf or they can be split into subsets by the aid of a splitting criterion in the m5tree criterion the standard deviation sd of the class values that reach a node as a measure of the error at that node is allocated as the splitting criterion hence the standard deviation reduction sdr is used for calculating the expected reduction in the sd 11 sdr s d m m i m s d m i where m represents the training examples that reach the node and mi denotes the subset of examples with the ith outcome of the potential set the m5tree will choose the structure associated with the maximized sdr this might lead to constructing a large tree which may cause overfitting to cope with this drawback in the second stage the possible overgrown tree will be pruned pal and deswal 2009 kisi 2015a b 2 6 evaluation statistics the models accuracy was evaluated using the following statistics which are commonly applied in the related literature the statistics include nash efficiency nse root mean square error rmse normalized rmse nrmse mean absolute error mae and combined error ca 12 nrmse i 1 n q io q im 2 n sd 13 rmse i 1 n q io q im 2 n 14 mae i 1 n q io q im n 15 nse 1 i 1 n q io q im 2 i 1 n q io q o 2 16 ca 0 33 rmse m a e 1 r 2 where n is data number q o is observed mean streamflow q im is modeled streamflow q io is observed streamflow r2 is determination coefficient sd is standard deviation of observed streamflow ca is the combined accuracy which has been recently used by eray et al 2018 in literature many studies have showed that the prediction accuracy of a model cannot be examined well using a single statistical indicator liu et al 2014 yuan et al 2016 meng et al 2019 zhou et al 2019 rmse and mae both error statistics are more useful when the error distribution of the models are normal and uniform respectively the main limitation of the both statistics is that they represent the overall error in the testing phase of the model therefore in this study two additional error statistics nrmse and ca have utilized together with the mae and rmse the nrmse statistic is more demonstrative than the rmse statistics as it normalizes the rmse and helps comparison between data sets unlike rmse nrmse is not sensitive to the order of magnitude and therefore it was also used in this study to evaluate the applied methods sachindra et al 2018a b similarly ca is also more representative than other statistics as it provides the general evaluation of the model by combining the rmse mae and r2 statistics it should be noted that for an ideal model the values of rmse and mae should equal to zero while the nse should equal to 1 the indication of best model is that having relatively small values of mae nrmse ca and rmse in comparison to the other models according to moriasi et al 2007 models accuracy can be assessed based on nse as unsatisfactory nse 0 4 acceptable 0 40 nse 0 50 satisfactory 0 50 nse 0 65 good 0 65 nse 0 75 and very good 0 75 nse 1 00 2 7 determination of input combinations various input combinations were applied considering correlation analysis cross correlation and partial auto correlation graphs in which training data 276 monthly streamflow values were used can be seen from fig 2 blue lines in this figure indicate 95 confidence bands it is seen from the cross correlation graphs in the 1st row of the figure that precipitation data up to 5 lags and temperature up to 2 lags have significant effect on kalam streamflow the other lags are beyond the confidence bands partial auto correlation graph shows that the streamflow of two previous periods are effective on current streamflow first scenario s1 is composed of precipitation inputs pt pt 1 pt 2 pt 3 pt 4 pt 5 while the 2nd scenario s2 and 3rd scenario s3 consist of temperature tt tt 1 tt 2 and streamflow qt 1 qt 2 inputs respectively fourth scenario s4 was produced by combining three scenarios s1 s2 s3 see table 2 similarly the input variable combinations of chakdara station were also determined as the optimal precipitation input s1 pt pt 1 pt 2 pt 3 pt 4 pt 5 the optimal temperature input s2 tt tt 1 tt 2 the optimal streamflow input s3 qt 1 qt 2 and combination input s4 pt pt 1 pt 2 pt 3 pt 4 pt 5 tt tt 1 tt 2 qt 1 qt 2 3 results and discussion in this study the accuracy of four data driven methods op elm lssvm mars and m5tree was evaluated in prediction of monthly streamflow of swat river basin using hydro meteorological inputs various input combinations derived from the correlation analysis were applied the validation and test statistics of the op elm lssvm mars and m5tree based models are reported in table 2 for the kalam station it is apparent from the table that three methods lssvm mars and m5tree respectively provided the best predictions for the fourth scenario s4 with the lowest nrmse 0 309 0 340 and 0 477 rmse 24 9 m3 s 27 4 m3 s and 38 4 m3 s mae 15 2 m3 s 17 5 m3 s and 23 m3 s ca 13 2 m3 s 14 9 m3 s and 20 4 m3 s and the highest nse 0 904 0 883 and 0 771 in the test period while the op elm had a slightly better accuracy nrmse 0 415 rmse 33 5 m3 s mae 19 7 m3 s ca 17 6 m3 s nse 0 826 in s3 compared to s4 nrmse 0 440 rmse 35 4 m3 s mae 25 9 m3 s ca 20 3 m3 s nse 0 805 even though s4 has much more variables the main reason for this maybe the fact that each method has its own assumptions and increasing input variables can deteriorate its accuracy some of previous literature reported that increasing input number does not guarantee better prediction accuracy e g shi et al 2012 zhang et al 2019 high number of inputs may negatively affect variance and cause more complex model which leads poor prediction accuracy lssvm based model with full inputs has the lowest nrmse 0 309 rmse 24 9 m3 s mae 15 2 m3 s and ca 13 2 m3 s and the highest nse 0 904 closely followed by the mars based model with the same inputs with respect to rmse mae nse and ca criteria the worst predictions were produced by the m5tree based model which means that it has the highest nrmse 0 477 rmse 38 4 m3 s mae 23 m3 s and ca 20 4 m3 s and the lowest nse 0 771 linear nature of this model might be the main reason of this it is worthy to note that the monthly streamflows of kalam station could be successfully predicted using only temperature variable which can be easily measured only precipitation inputs also provided good accuracy in some cases there is a high difference between the validation and test accuracies of the models for example the rmse differences between the s1 and s2 in validation stage are 38 4 32 8 38 2 and 41 4 m3 s for the op elm lssvm mars and m5tree respectively while the corresponding values in test stage are 5 4 3 3 0 3 and 5 m3 s the optimal models with full inputs s4 are graphically compared in figs 3 4 in the forms of hydrograph and scatterplot it is obviously seen from the time variation graphs that the lssvm is capable of capturing monthly streamflows better than the other models the underestimations of some peaks are clearly seen for the op elm mars and m5tree based models the models generally well simulate the rising and recession limbs of the hydrographs while extreme values low or peak streamflows cannot be captured by the applied methods the main reason of this is the unavailability of the high number of extreme values in the data and ai methods or data driven techniques cannot adequately learn the phenomenon in respect of extremes according to the scatter plots we can say that the least scattered estimates belong to the lssvm the slope and bias of the fit line equation of this model are respectively closer to the 1 and 0 with a higher determination coefficient r2 0 9181 compared to the other three models prediction accuracies of the four methods are compared in table 3 for the chakdara station in this station also s4 scenario which has information of precipitation temperature and discharge provided the best accuracy in the test stage mars and lssvm with all inputs almost have the same accuracy with respect to nrmse rmse mae nse and ca and they perform superior to the op elm and m5tree based models in s4 scenario as observed from table 3 the mars has the lowest nrmse 0 337 rmse 51 3 m3 s mae 35 4 m3 s and ca 28 6 m3 s and the highest nse 0 886 which has been closely followed by the mars based model in s4 scenario the models with only precipitation input are not accurate in prediction of monthly streamflows in the test stage nse ranges from 0 411 to 0 463 one main reason of this may be the lower correlation between the precipitation and streamflow data in chakdara compared to kalam see fig 2 the other reason of this might be the fact that precipitation data of chakdara station have more skewed distribution see table 1 than the kalam station there is no criterion in the literature for skewed distribution however it is evident from the previous studies e g kisi and aytek 2013 kisi and parmar 2016 that data having high skewness e g 3 negatively affects the accuracy of the ai methods in prediction figs 5 6 give the time variation graphs and scatter plots of the observed and predicted streamflows by the optimal models s4 in the test period it is evident from the error variations and hydrographs in fig 5 that the predictions of mars and lssvm are closer to the corresponding observed values than the op elm and m5tree based models all the methods underestimate overestimate some peak low streamflows as also observed in kalam station one of the main reasons of this may be the fact that the ranges of the extremes in training data are more than those of the validation and or testing data in the both stations see table 1 this causes extrapolation difficulties in data driven models kisi and aytek 2013 kisi and parmar 2016 the other main reason might be the smaller number of extreme values in the whole data and thus the applied models could not adequately learn the process it is obviously seen from fig 6 that the mars and lssvm have less scattered streamflow estimates and their fit lines are closer to the exact line 1 1 line compared to op elm and m5tree based models the accuracy of data driven methods were compared with sarima model arima model is the combination of auto regressive ar and moving average ma models with addition of difference term seasonal arima sarima model was preferred over usual arima models due to having both non seasonal ns and seasonal parameters these seasonal parameters would help in capturing the seasonality in data sarima model can be written as 17 sarima arima p d q p d q s where p and p parameters represent the order of the ns and seasonal ar model q and q parameters represent the order of the ns and seasonal ma model d and d parameters represent the ns and seasonal differences and s is the seasonality term table 4 summarizes the test statistics of the data driven and sarima models as clearly observed from the table op elm lssvm and mars models perform superior to the sarima while m5tree provides inferior results in both stations the linear structure of m5tree might be the reason of less accuracy compared to sarima model the implemented models were further compared in prediction peak streamflow values in tables 5 and 6 for the kalam and chakdara stations respectively in kalam station the lssvm model has the lowest relative error 121 followed by the op elm 136 mars 140 m5tree 160 and sarima 173 in chakdara station the lowest relative error belongs to the mars model 209 closely followed by the lssvm model 213 in this station however sarima model 282 has better accuracy than the op elm 326 and m5tree 315 in peak streamflow prediction table 6 the validation and test statistics of the employed models in prediction of monthly streamflow of chakdara station using data from upstream stations are summed up in table 7 as seen from the table five different scenarios were considered in the first scenario the precipitation data of kalam and chakdara were used as inputs to the models in the second scenario the temperature data of both stations were utilized as inputs and vice versa as expected all the methods provide worse statistics in test period compared to validation because they didn t see the test data in the model development stage this also shows the necessity of three data division rule in data driven modeling the op elm mars and m5tree has the best streamflow predictions for the 3rd scenario s3 which includes previous streamflows of the both stations while the lssvm provided the best predictions in the s4 which is composed of all data of both stations table 7 clearly shows that the mars and lssvm s4 have similar accuracy and they perform superior to the other models similar to the previous applications the m5tree produces the worst estimates with respect to nrmse rmse mae nse and ca criteria it is obvious from the last scenario s5 that the lssvm and mars are capable of estimating streamflows of chakdara using only upstream data without local data however including upstream data in model inputs considerably improves their accuracy the estimates of the best models are compared in figs 7 8 for the test period it is obviously seen from the error and time variation graphs that the lssvm and mars estimates closely follow the corresponding observed values while the op elm and m5tree considerably over underestimate low high streamflow values in the test period scatter plots clearly demonstrate that the lssvm and mars have less scattered estimates compared to op elm and m5tree based models streamflow prediction is very important for planning and management of water resources monthly streamflow prediction is particularly useful in operation of reservoirs and irrigation management as well as institutional and legal aspects of water resources management and planning e g management of extreme events such as droughts and floods optimal design of drainage network and water storage structures wang 2006 the developed models could be integrated as a module in general hydrological analysis models 4 conclusion the prediction capability of newly used data driven model op elm for predicting monthly streamflow of kalam and chakdara stations at swat river basin was examined and compared with other soft computing models i e lssvm mars and m5tree and sarima in this study ca a newly used statistical parameter was adopted in addition to nrmse rmse mae and nse to determine the performance of these models the op elm lssvm mars and m5tree based models were tested by using four different input scenarios including various combinations of precipitation temperature and previous streamflow values for monthly streamflow prediction the prediction results of kalam station showed that the lssvm mars and m5tree based models provided the best accuracy for the fourth scenario s4 in the test period except the op elm which had a slightly better accuracy in s3 compared to s4 model m5tree model provided the lowest accuracy for prediction of monthly streamflows of kalam station in comparison to other models due to its linear nature in case of chakdara station it was found that all the models provided the best accuracy with input scenario 4 s4 in both stations op elm lssvm mars based models were found to be better than the sarima in monthly streamflow prediction data driven models were also compared with sarima model in prediction of peak streamflows lssvm and mars based models indicated a superior accuracy compared to statistical model the estimation of downstream station s streamflows using data from upstream station was also investigated in this study and results showed that including upstream data in model inputs considerably improves their accuracy in this case all models provided better accuracy for scenario 3 except the lssvm in all cases it was also found that the lssvm and mars estimates closely follow the corresponding observed values while the op elm and m5tree considerably over underestimate low high streamflow values in the test period thus it can be concluded that the lssvm and mars are capable of providing more accurate streamflows predictions in comparison to op elm and m5tree based models with and or without local data the main limitation of this study is the use of two stations located in mountainous basins of pakistan sufficient meteorological data are generally not available and or not feasible to record in such basins therefore investigating alternative methods to improve prediction accuracy in modeling streamflows caries much more importance compared to other basins the presented methods may be tested by different data from different mountainous basins all over the world the methods can be compared with other data driven methods using different input scenarios of hydro climatic data declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key r d program of china 2016yfc0402706 and national natural science foundation of china 41730750 
5519,monthly streamflow prediction is very important for many hydrological applications in providing information for optimal use of water resources in this study the prediction accuracy of new heuristic methods optimally pruned extreme learning machine op elm least square support vector machine lssvm multivariate adaptive regression splines mars and m5 model tree m5tree is examined in modeling monthly streamflows using precipitation and temperature inputs data collected from kalam and chakdara stations at a mountainous basin swat river basin pakistan are utilized as case study the prediction accuracy of all four methods are validated and tested using four different input scenarios and evaluated using combined accuracy ca a newly used criterion in addition to root mean square error rmse normalized rmse mean absolute error mae and nash sutcliffe efficiency nse the test results of both stations show that the lssvm and mars based models provide more accurate prediction results compared to op elm and m5tree models lssvm decreases the rmse of the mars op elm and m5tree by 9 12 25 64 and 35 15 for the kalam station while the rmses of the lssvm op elm and m5tree is decreased by 2 12 34 81 and 32 52 using mars for the chakdara station respectively it is observed that the monthly streamflows of kalam station can be successfully predicted using only temperature data only precipitation inputs also provide good accuracy for kalam station while they produce inaccurate predictions for the chakdara station the prediction capabilities of the applied methods are also examined in estimating streamflow of downstream station using upstream data the results prove the dominancy of lssvm and mars based models over op elm and m5tree in prediction streamflow data without local input data heuristic methods are also compared with stochastic method of seasonal auto regressive moving average sarima the op elm lssvm mars perform superior to the sarima in monthly streamflow prediction based on the overall results the lssvm and mars are recommended for monthly streamflow prediction with or without local data keywords streamflow forecasting swat river lssvm mars op elm m5 model tree 1 introduction streamflow is a fundamental part of terrestrial water cycle and has a critical importance in wide range of applications predicting streamflow has several benefits and would help to provide reliable useful and significant information in large domains such as water resources management over the years it has been demonstrated that streamflow can be predicted and forecasted at different timescales using artificial intelligence ai based models and the number of published papers has been increased in recent years araghinejad et al 2018 kisi et al 2018 yuan et al 2018 artificial neural network ann based models have long been recognized as the accurate ai based models for providing robust and accurate estimation of the streamflow ghumman et al 2018 several types of ai based models have been widely developed and applied to estimate streamflow from meteorological data in different regions over the world i the multilayer perceptron neural networks mlpnn tongal and booij 2018 ii radial basis neural network rbnn muhammad et al 2017 iii generalized regression neural network grnn diop et al 2018 iv support vector machines svm and least square support vector machines lssvm luo et al 2019 modaresi et al 2018 v multivariate adaptive regression splines model mars yin et al 2018 vi m5 model tree m5tree nourani et al 2019 vii gaussian process regression zhu et al 2018 and viii adaptive neuro fuzzy inference system anfis hadi and tombul 2018a tongal and booij 2018 compared the mlpnn svm and random forest rf using precipitation p temperature te and evapotranspiration et in streamflow forecasting using data from four rivers in usa in overall the results obtained demonstrated that the mlpnn performed better than the svm and rf muhammad adnan et al 2017 compared the rbnn grnn and anfis based models in monthly streamflow forecasting results indicated that the rbnn was more accurate than the grnn model while the anfis based models provided the best accuracy luo et al 2019 proposed a hybrid svm based model for monthly streamflow in iran compared to the grnn the hybrid svm performed better modaresi et al 2018 compared lssvm grnn mlpnn and k nearest neighbor regression knn in monthly streamflow forecasting and the lssvm performed the best using data from china yin et al 2018 applied mars m5tree and svm for forecasting daily streamflow in one two and three day in advance the authors reported that the m5tree was more accurate than the svm and mars based models nourani et al 2019 utilized the hybrid wavelet m5tree model and compared with the ann model in forecasting river runoff on both daily and monthly basis according to the obtained results the authors demonstrated that the hybrid wavelet m5tree was more accurate than the ann model zhu et al 2018 introduced the gaussian process regression gpr as a new ai based model for forecasting streamflow gpr was more accurate compared to the grnn based model hadi and tombul 2018a compared the anfis mlpnn and svm based models in forecasting daily streamflow using data from three stations in turkey in overall the authors reported that the anfis and mlpnn based models worked with relatively similar accuracy and they outperformed the svm based model in the last decade several evolutionary models which use both ai and evolutionary algorithms e g genetic algorithm have been proposed for streamflow prediction adnan et al 2018 azad et al 2018 danandeh mehr 2018 mirabbasi et al 2019 ghorbani et al 2018 hadi and tombul 2018b adnan et al 2017 ravansalar et al 2017 sanikhani and kisi 2012 kisi 2015a b kisi 2015a b investigated prediction accuracy of the lssvm based models with anfis based models and superior results were gotten from the lssvm compared to anfis based models azad et al 2018 compared three evolutionary neuro fuzzy enf based methods in river flow prediction and enf based model based on pso significantly improved the accuracy of classical neuro fuzzy model adnan et al 2018 developed three ai models namely lssvm fuzzy genetic approach fga and m5tree for daily and monthly streamflow forecasting using data collected from two stations in pakistan the authors compared several scenarios having different input combinations of streamflow q te and p data according to the obtained results they have demonstrated that i using only previous record of precipitation does not provide high accuracy and all the employed models work the worst with the highest error indices and the lowest r2 ii combining previous monthly values of te significantly improved the models accuracies during the validation phase respectively adnan et al 2017 applied a new hybrid evolutionary data driven model hlgsa using the gravitational search algorithm gsa with lssvm for forecasting monthly streamflows at astore and shyok rivers pakistan the hlgsa based model provided the best accuracy compared to mars and m5tree based models in another study ravansalar et al 2017 proposed a new hybrid data driven model called wavelet linear genetic programming wlgp for predicting monthly streamflow at two stations in iran the proposed model was compared to the original lgp mlpnn wavelet mlpnn wmlpnn and standard mlr from the obtained results the authors demonstrated that by using three previous values of streamflow qt qt 1 and qt 2 the wlgp outperformed all other methods karimi et al 2018 applied gep and svm based models for predicting daily streamflow using data from four stations in china the authors demonstrated that the gep outperforms the svm based model all the studies above indicated that the ai based models successfully applied for predicting streamflow extreme learning machine elm has been introduced during the last decade as a training algorithm for the single layer neural networks and it has been shown to be useful in predicting and forecasting streamflow a large number of models can be found related to this issue in the literature adnan et al 2019 lima et al 2017 taormina and chau 2015 wang et al 2019 yadav et al 2016 yaseen et al 2016 2018b 2019 lima et al 2016 rezaie balf and kisi 2018 yaseen et al 2018a taormina and chau 2015 used elm and binary coded discrete fully informed particle swarm optimization in streamflow prediction using benchmark datasets from kentucky river basin wang et al 2019 proposed a double processing strategy for elm based models for forecasting monthly streamflow in gulang river basin compared to the single processing elm and without processing elm models the double processing elm models performed better lima et al 2016 applied a modified version of the original elm called the online sequential extreme learning machine oselm for forecasting daily streamflow using data collected at two stations in southern british columbia canada as a result of the investigation the authors recommended the use of large data set for the training phase in order to obtain a model with high accuracy in another study lima et al 2017 proposed an improved version of the first oselm based model applied in lima et al 2016 for forecasting daily streamflow the proposed model called as variable complexity oselm vc oselm which outperformed the oselm in terms of accuracy during the testing phase in order to forecast discharge in river measured at hourly time step yadav et al 2016 applied the oselm based model using data collected at the neckar river germany the results obtained using oselm based model were compared to those provided by gp mlpnn and svm it was demonstrated that the oselm was more accurate and outperformed the gp svm and mlpnn based models rezaie balf and kisi 2018 introduced an improved version of the original elm called optimally pruned extreme learning machine op elm for forecasting daily streamflow using data from three stations in iran they used previous streamflow values as inputs to the models in their study the op elm was compared to the mlpnn and the evolutionary polynomial regression epr by comparing several input combinations of the previous daily q the authors demonstrated that the epr worked the best at two stations while the mlpnn was the most accurate model at the third station yaseen et al 2016b compared the elm grnn and svm for forecasting monthly streamflow in the arid region of iraq results obtained from the investigation demonstrated that the elm outperformed the svm and grnn based models and the elm decreased the rmse of the svm and the grnn by 21 3 and 44 7 respectively wavelet analysis wa is used to decompose an original nonlinear and nonstationary signal into sub signals and a conjunction model can be established between wavelet coefficients and the streamflow data hadi and tombul 2018c yaseen et al 2018a have already demonstrated the benefits of wa combined with the elm model for streamflow forecasting wa elm using data at monthly time step in a semi arid region of iraq the authors demonstrated that the wa elm having three previous records of q outperformed the elm based model significantly in another study conducted by yaseen et al 2018b daily weekly and monthly streamflow in malaysia were predicted using the elm model compared to the mlpnn based model the elm outperformed the other models for daily weekly and monthly time steps recently in a study conducted by yaseen et al 2019 an enhanced version of extreme learning machine eelm model was utilized in streamflow prediction results obtained from the investigation demonstrated that the eelm outperformed the svm and elm models all the studies above showed that the improved versions of elm method could be successfully applied for prediction of streamflow and it can be considered as good alternative to mlpnn or ann grnn svm and gp to the best of our knowledge there is no study that applies the op elm method for predicting monthly streamflow even though both long term and short term streamflow predictions are important operation of reservoirs is generally planned dependent on monthly time scale therefore prediction of monthly streamflows has an important role in management of water resources honorato et al 2018 especially for the mountainous basins with high altitudes where sufficient meteorological data are generally not available and or not feasible to record the main contributions of this study are i to investigate the potential of new heuristic methods op elm lssvm mars and m5tree based for improving monthly streamflow prediction in mountainous basin ii to compare the accuracy of op elm with the lssvm mars and m5tree based models in this study four heuristic methods were selected for comparison in estimating streamflow lssvm has some advantages over the standard svm method as also mentioned in the methods section lssvm can be considered as the improved version of the svm and it has less computational time and less complexity compared to svm op elm is also improved version of standard elm method and it has some advantages over the ann method for example the elm is faster than the ann and can meet better generalization performance and because it can determine the output weights analytically on the other hand in op elm more robust model can be obtained compared to standard elm due to the pruning procedure of the neurons th main advantages of the mars which is a nonlinear and non parametric regression apporach are its robustness and efficiency in exploring a large number of intricate nonlinear relations and rapid detection of interactions between them despite their complexity the main advantages of the m5tree model which is a binary decision tree with a series of functions of linear regression are its simple geometric structure and the capability to efficiently handle a large number of datasets with different attributes therefore the lssvm op elm mars and m5tree were selected to be compared in streamflow prediction in the presented study 2 materials and methods 2 1 case study in order to examine the prediction accuracy of the implemented methods the swat river basin located at complex topography of hindukush mountains of pakistan was selected as the case study site the geographical location of swat river basin is approximately between longitudes 70 59 to 72 47 e and latitudes 34 20 to 35 56 n the river lies in northern part of pakistan and covers a catchment area of about 14 039 km2 with mean elevation of 2 180 m the river receives average precipitation over the entire basin ranging from 375 mm to 1 250 mm annually streamflow modeling of this river is very vital for the economic development of the country due to a proposed hydropower project on this river namely mohmand dam hydropower project with an estimated installed capacity of 740 megawatts mw anjum et al 2016 in this study hydro meteorological data streamflow precipitation and temperature of two hydrometric stations on swat river basin namely kalam and chakdara were used for prediction streamflow see fig 1 the monthly data of streamflows of both stations were obtained from water and power development authority wapda pakistan for the duration of 1964 2008 45 years 540 months before models applications the data were divided into three phases approximately 50 276 months of the datasets was used for training phase while the remaining 50 of the datasets was equally divided for validation and testing purposes brief statistical properties of the applied data can be observed from table 1 precipitation variable has high skewness especially for the chakdara station validation data range is higher than that of the training data in both stations and extrapolation difficulties models cannot estimate the data beyond the training range may be expected from the employed models kisi and aytek 2013 kisi and parmar 2016 kalam and chakdara stations were chosen in this study due to their hydrologically distinct nature from each other and due to importance of hydropower generation capabilities of the basin the swat river is important for the future economic development of pakistan kalam station is located at upstream section of basin kalam and surrounding areas comprise very rugged mountain topography with temperature variation of 22 6 c to 2 2 with elevation range of 2000 5808 m a s l and with a mean precipitation of 76 1 mm the precipitation in the upper section is dominated by the winter rainfall mainly received from the western disturbances most of the winter precipitation is received in the form of snow on the other hand chakdara station is located at the downstream of the basin i e called lower swat basin area this area comprises relatively flat with elevation range of 500 2000 m a s l with temperature variation of 30 7 c to 1 1 and with a mean precipitation of 11 3 mm the precipitation pattern in the lower part is influenced by the summer monsoon rainfall on an average 75 of the total discharge is contributed by snowmelt in the swat watershed in such mountainous basins with high altitude sufficient meteorological data and snow data are not available or not feasible to record therefore this study caries much importance for a developing country such as pakistan 2 2 op elm the extreme learning machine elm is known as one of the most effective optimization algorithms in soft computing areas the elm uses a trial and error process for determining the number of random hidden nodes it can be used to train a single hidden layer feed forward artificial neural network slfn in other words in the elm the parameters associated with the hidden neurons are randomly assigned while the output weights will be analytically determined rong et al 2008 pouzols and lendasse 2010 consider a dataset of m observation samples x i y i with x i r d 1 and y i r d 2 an slfn with n hidden neurons can be defined by the following sum 1 i 1 n β i f x j c i a i 1 j m where a i c i are the learning parameters the biases and weights of the hidden nodes f is considered as the activation function and β i are the output weights of the output node utilizing the radial basis function for hidden nodes the form of f x j c i a i activation function can be applied where c i are the centers and a i are the spreads or radii of the ith rbf nodes in case of having a perfect fit of the data and the sfln the difference between the estimated outputs y i and the target variable would be zero and thus the following relation can be written 2 i 1 n β i f x j c i a i y j 1 j m the above relation can be rewritten as 3 h β y with 4 h c 1 c n a 1 a n x 1 x n f x 1 c 1 a 1 f x 1 c n a n f x m c 1 a 1 f x m c n a n β β 1 t β n t and y y 1 t y m t β represents the output weights of the slfn and h is the hidden layer output matrix which is generated in a random way the output weights can be estimated as 5 β h y where h stands for the moore penrose inverse of the h matrix rong et al 2008 miche et al 2010 unlike the other learning methods which require several parameters to be tuned in the elm solely the number of neurons in the hidden layer for specific types of activation functions has to be determined therefore in the standard version of the elm too small or too large number of hidden nodes might lead to overfitting of the learning process consequently utilizing a pruning procedure would enhance the performance of the standard elm in this regard rong et al 2008 proposed the pruned elm p elm algorithm which is an upgraded architectural design of the elm classifier network later the p elm was upgraded to the optimally pruned extreme learning machine op elm by miche et al 2010 the main idea of the op elm lies in selecting the subset of best hidden nodes using some statistical measures afterwards the less low prevalent nodes would be removed and the hence would be pruned in general the op elm can be introduced in three main steps the first step is the construction of the neural network using lots of initial hidden neurons in the second step the best neurons in the hidden layer are ranked this can be done by using different techniques such as multi response sparse regression mrsr or least angle regression lars the third step is devoted to selecting the optimal number of neurons and pruning the potential irrelevant neurons of the slfn using methods such as the leave one out validation technique similä and tikka 2005 miche et al 2010 2 3 lssvm the original support vector machine svm algorithm was introduced by vapnik 1995 on the basis of statistical learning theory the svm utilizes quadratic programming in order to formulate the training process of modeling procedure suykens and vandewalle 1999 proposed a novel svm for reducing the computational time of the svm known as the least squares svm lssvm let s consider a given training set of m datasets with input data x t r m and output f x r r m is the m dimensional vector space and r is the one dimensional vector space in feature space the lssvm based models for regression problems can be defined as samui and kothari 2011 6 f x w t φ x b where φ denotes the mapping functions which transfer the input data into a higher dimensional feature space w is an adjustable weight vector and b stands for the scalar threshold also known as bias the following optimization problem can be formulated for function estimation 7 minimize 1 2 w t w 1 2 γ t 1 m e t 2 subjected to f x w t φ x b e t t 1 m where e is the error variable and γ is the regulative constant the final form of the lssvm is obtained by solving the above optimization problem as 8 f x t 1 m α t k x x t b k x x t is called as kernel function rbf kernel function has been used in this study following the previous study baesens et al 2000 which rbf and polynomial kernels were compared using different data sets and first kernel was found to be better than the latter the formulation of rbf kernel is 9 k x x t exp x x t 2 2 σ 2 2 4 mars multivariate adaptive regression splines mars was proposed as a non linear and non parametric method to predict forecast a continuous dependent parameter friedman 1991 in the mars based model piecewise basis functions are used to define complex non linear relationships between the continuous parameter and input vector parameters set of predictors this process is done by taking a forward backward procedure kisi and parmar 2016 in the forward stepwise stage a large number of basis functions bfs are added to the model which makes the model overfit the data initially bfs of the mars based model are dependent on a segment spline functions which divide the dataset into separate piecewise linear segments spline functions are joined at knots fixed point in general the mars based model can be described as the following structure 10 f x δ 0 m 1 m δ m h m x where h m x are spline functions δ are coefficients that can be calculated through the minimum sum of squared errors from splines functions m is the number of functions in the mars based model in the backward stage pruning stage unnecessary basis functions are eliminated using the generalized cross validation criterion to improve the forecasting accuracy and hence the final number of functions m is determined kisi and parmar 2016 roy et al 2018 2 5 m5 model tree model trees generalize the concept of regression trees which comprise constant values in their leaves accordingly they are analogous to piece wise linear functions and hence nonlinear constructing an m5 model tree m5tree consists of two stages of 1 creating decision tree using a split criterion and 2 designing the model tree by pruning the overgrown tree singh et al 2010 the splitting in the m5tree approach applies the idea of a decision tree but instead of the class labels it is composed of linear regression functions at the leaves which can estimate continuous numerical attributes let consider a set of m training examples with independent parameters as the input and associated target as the output value parameters can be either associated with a leaf or they can be split into subsets by the aid of a splitting criterion in the m5tree criterion the standard deviation sd of the class values that reach a node as a measure of the error at that node is allocated as the splitting criterion hence the standard deviation reduction sdr is used for calculating the expected reduction in the sd 11 sdr s d m m i m s d m i where m represents the training examples that reach the node and mi denotes the subset of examples with the ith outcome of the potential set the m5tree will choose the structure associated with the maximized sdr this might lead to constructing a large tree which may cause overfitting to cope with this drawback in the second stage the possible overgrown tree will be pruned pal and deswal 2009 kisi 2015a b 2 6 evaluation statistics the models accuracy was evaluated using the following statistics which are commonly applied in the related literature the statistics include nash efficiency nse root mean square error rmse normalized rmse nrmse mean absolute error mae and combined error ca 12 nrmse i 1 n q io q im 2 n sd 13 rmse i 1 n q io q im 2 n 14 mae i 1 n q io q im n 15 nse 1 i 1 n q io q im 2 i 1 n q io q o 2 16 ca 0 33 rmse m a e 1 r 2 where n is data number q o is observed mean streamflow q im is modeled streamflow q io is observed streamflow r2 is determination coefficient sd is standard deviation of observed streamflow ca is the combined accuracy which has been recently used by eray et al 2018 in literature many studies have showed that the prediction accuracy of a model cannot be examined well using a single statistical indicator liu et al 2014 yuan et al 2016 meng et al 2019 zhou et al 2019 rmse and mae both error statistics are more useful when the error distribution of the models are normal and uniform respectively the main limitation of the both statistics is that they represent the overall error in the testing phase of the model therefore in this study two additional error statistics nrmse and ca have utilized together with the mae and rmse the nrmse statistic is more demonstrative than the rmse statistics as it normalizes the rmse and helps comparison between data sets unlike rmse nrmse is not sensitive to the order of magnitude and therefore it was also used in this study to evaluate the applied methods sachindra et al 2018a b similarly ca is also more representative than other statistics as it provides the general evaluation of the model by combining the rmse mae and r2 statistics it should be noted that for an ideal model the values of rmse and mae should equal to zero while the nse should equal to 1 the indication of best model is that having relatively small values of mae nrmse ca and rmse in comparison to the other models according to moriasi et al 2007 models accuracy can be assessed based on nse as unsatisfactory nse 0 4 acceptable 0 40 nse 0 50 satisfactory 0 50 nse 0 65 good 0 65 nse 0 75 and very good 0 75 nse 1 00 2 7 determination of input combinations various input combinations were applied considering correlation analysis cross correlation and partial auto correlation graphs in which training data 276 monthly streamflow values were used can be seen from fig 2 blue lines in this figure indicate 95 confidence bands it is seen from the cross correlation graphs in the 1st row of the figure that precipitation data up to 5 lags and temperature up to 2 lags have significant effect on kalam streamflow the other lags are beyond the confidence bands partial auto correlation graph shows that the streamflow of two previous periods are effective on current streamflow first scenario s1 is composed of precipitation inputs pt pt 1 pt 2 pt 3 pt 4 pt 5 while the 2nd scenario s2 and 3rd scenario s3 consist of temperature tt tt 1 tt 2 and streamflow qt 1 qt 2 inputs respectively fourth scenario s4 was produced by combining three scenarios s1 s2 s3 see table 2 similarly the input variable combinations of chakdara station were also determined as the optimal precipitation input s1 pt pt 1 pt 2 pt 3 pt 4 pt 5 the optimal temperature input s2 tt tt 1 tt 2 the optimal streamflow input s3 qt 1 qt 2 and combination input s4 pt pt 1 pt 2 pt 3 pt 4 pt 5 tt tt 1 tt 2 qt 1 qt 2 3 results and discussion in this study the accuracy of four data driven methods op elm lssvm mars and m5tree was evaluated in prediction of monthly streamflow of swat river basin using hydro meteorological inputs various input combinations derived from the correlation analysis were applied the validation and test statistics of the op elm lssvm mars and m5tree based models are reported in table 2 for the kalam station it is apparent from the table that three methods lssvm mars and m5tree respectively provided the best predictions for the fourth scenario s4 with the lowest nrmse 0 309 0 340 and 0 477 rmse 24 9 m3 s 27 4 m3 s and 38 4 m3 s mae 15 2 m3 s 17 5 m3 s and 23 m3 s ca 13 2 m3 s 14 9 m3 s and 20 4 m3 s and the highest nse 0 904 0 883 and 0 771 in the test period while the op elm had a slightly better accuracy nrmse 0 415 rmse 33 5 m3 s mae 19 7 m3 s ca 17 6 m3 s nse 0 826 in s3 compared to s4 nrmse 0 440 rmse 35 4 m3 s mae 25 9 m3 s ca 20 3 m3 s nse 0 805 even though s4 has much more variables the main reason for this maybe the fact that each method has its own assumptions and increasing input variables can deteriorate its accuracy some of previous literature reported that increasing input number does not guarantee better prediction accuracy e g shi et al 2012 zhang et al 2019 high number of inputs may negatively affect variance and cause more complex model which leads poor prediction accuracy lssvm based model with full inputs has the lowest nrmse 0 309 rmse 24 9 m3 s mae 15 2 m3 s and ca 13 2 m3 s and the highest nse 0 904 closely followed by the mars based model with the same inputs with respect to rmse mae nse and ca criteria the worst predictions were produced by the m5tree based model which means that it has the highest nrmse 0 477 rmse 38 4 m3 s mae 23 m3 s and ca 20 4 m3 s and the lowest nse 0 771 linear nature of this model might be the main reason of this it is worthy to note that the monthly streamflows of kalam station could be successfully predicted using only temperature variable which can be easily measured only precipitation inputs also provided good accuracy in some cases there is a high difference between the validation and test accuracies of the models for example the rmse differences between the s1 and s2 in validation stage are 38 4 32 8 38 2 and 41 4 m3 s for the op elm lssvm mars and m5tree respectively while the corresponding values in test stage are 5 4 3 3 0 3 and 5 m3 s the optimal models with full inputs s4 are graphically compared in figs 3 4 in the forms of hydrograph and scatterplot it is obviously seen from the time variation graphs that the lssvm is capable of capturing monthly streamflows better than the other models the underestimations of some peaks are clearly seen for the op elm mars and m5tree based models the models generally well simulate the rising and recession limbs of the hydrographs while extreme values low or peak streamflows cannot be captured by the applied methods the main reason of this is the unavailability of the high number of extreme values in the data and ai methods or data driven techniques cannot adequately learn the phenomenon in respect of extremes according to the scatter plots we can say that the least scattered estimates belong to the lssvm the slope and bias of the fit line equation of this model are respectively closer to the 1 and 0 with a higher determination coefficient r2 0 9181 compared to the other three models prediction accuracies of the four methods are compared in table 3 for the chakdara station in this station also s4 scenario which has information of precipitation temperature and discharge provided the best accuracy in the test stage mars and lssvm with all inputs almost have the same accuracy with respect to nrmse rmse mae nse and ca and they perform superior to the op elm and m5tree based models in s4 scenario as observed from table 3 the mars has the lowest nrmse 0 337 rmse 51 3 m3 s mae 35 4 m3 s and ca 28 6 m3 s and the highest nse 0 886 which has been closely followed by the mars based model in s4 scenario the models with only precipitation input are not accurate in prediction of monthly streamflows in the test stage nse ranges from 0 411 to 0 463 one main reason of this may be the lower correlation between the precipitation and streamflow data in chakdara compared to kalam see fig 2 the other reason of this might be the fact that precipitation data of chakdara station have more skewed distribution see table 1 than the kalam station there is no criterion in the literature for skewed distribution however it is evident from the previous studies e g kisi and aytek 2013 kisi and parmar 2016 that data having high skewness e g 3 negatively affects the accuracy of the ai methods in prediction figs 5 6 give the time variation graphs and scatter plots of the observed and predicted streamflows by the optimal models s4 in the test period it is evident from the error variations and hydrographs in fig 5 that the predictions of mars and lssvm are closer to the corresponding observed values than the op elm and m5tree based models all the methods underestimate overestimate some peak low streamflows as also observed in kalam station one of the main reasons of this may be the fact that the ranges of the extremes in training data are more than those of the validation and or testing data in the both stations see table 1 this causes extrapolation difficulties in data driven models kisi and aytek 2013 kisi and parmar 2016 the other main reason might be the smaller number of extreme values in the whole data and thus the applied models could not adequately learn the process it is obviously seen from fig 6 that the mars and lssvm have less scattered streamflow estimates and their fit lines are closer to the exact line 1 1 line compared to op elm and m5tree based models the accuracy of data driven methods were compared with sarima model arima model is the combination of auto regressive ar and moving average ma models with addition of difference term seasonal arima sarima model was preferred over usual arima models due to having both non seasonal ns and seasonal parameters these seasonal parameters would help in capturing the seasonality in data sarima model can be written as 17 sarima arima p d q p d q s where p and p parameters represent the order of the ns and seasonal ar model q and q parameters represent the order of the ns and seasonal ma model d and d parameters represent the ns and seasonal differences and s is the seasonality term table 4 summarizes the test statistics of the data driven and sarima models as clearly observed from the table op elm lssvm and mars models perform superior to the sarima while m5tree provides inferior results in both stations the linear structure of m5tree might be the reason of less accuracy compared to sarima model the implemented models were further compared in prediction peak streamflow values in tables 5 and 6 for the kalam and chakdara stations respectively in kalam station the lssvm model has the lowest relative error 121 followed by the op elm 136 mars 140 m5tree 160 and sarima 173 in chakdara station the lowest relative error belongs to the mars model 209 closely followed by the lssvm model 213 in this station however sarima model 282 has better accuracy than the op elm 326 and m5tree 315 in peak streamflow prediction table 6 the validation and test statistics of the employed models in prediction of monthly streamflow of chakdara station using data from upstream stations are summed up in table 7 as seen from the table five different scenarios were considered in the first scenario the precipitation data of kalam and chakdara were used as inputs to the models in the second scenario the temperature data of both stations were utilized as inputs and vice versa as expected all the methods provide worse statistics in test period compared to validation because they didn t see the test data in the model development stage this also shows the necessity of three data division rule in data driven modeling the op elm mars and m5tree has the best streamflow predictions for the 3rd scenario s3 which includes previous streamflows of the both stations while the lssvm provided the best predictions in the s4 which is composed of all data of both stations table 7 clearly shows that the mars and lssvm s4 have similar accuracy and they perform superior to the other models similar to the previous applications the m5tree produces the worst estimates with respect to nrmse rmse mae nse and ca criteria it is obvious from the last scenario s5 that the lssvm and mars are capable of estimating streamflows of chakdara using only upstream data without local data however including upstream data in model inputs considerably improves their accuracy the estimates of the best models are compared in figs 7 8 for the test period it is obviously seen from the error and time variation graphs that the lssvm and mars estimates closely follow the corresponding observed values while the op elm and m5tree considerably over underestimate low high streamflow values in the test period scatter plots clearly demonstrate that the lssvm and mars have less scattered estimates compared to op elm and m5tree based models streamflow prediction is very important for planning and management of water resources monthly streamflow prediction is particularly useful in operation of reservoirs and irrigation management as well as institutional and legal aspects of water resources management and planning e g management of extreme events such as droughts and floods optimal design of drainage network and water storage structures wang 2006 the developed models could be integrated as a module in general hydrological analysis models 4 conclusion the prediction capability of newly used data driven model op elm for predicting monthly streamflow of kalam and chakdara stations at swat river basin was examined and compared with other soft computing models i e lssvm mars and m5tree and sarima in this study ca a newly used statistical parameter was adopted in addition to nrmse rmse mae and nse to determine the performance of these models the op elm lssvm mars and m5tree based models were tested by using four different input scenarios including various combinations of precipitation temperature and previous streamflow values for monthly streamflow prediction the prediction results of kalam station showed that the lssvm mars and m5tree based models provided the best accuracy for the fourth scenario s4 in the test period except the op elm which had a slightly better accuracy in s3 compared to s4 model m5tree model provided the lowest accuracy for prediction of monthly streamflows of kalam station in comparison to other models due to its linear nature in case of chakdara station it was found that all the models provided the best accuracy with input scenario 4 s4 in both stations op elm lssvm mars based models were found to be better than the sarima in monthly streamflow prediction data driven models were also compared with sarima model in prediction of peak streamflows lssvm and mars based models indicated a superior accuracy compared to statistical model the estimation of downstream station s streamflows using data from upstream station was also investigated in this study and results showed that including upstream data in model inputs considerably improves their accuracy in this case all models provided better accuracy for scenario 3 except the lssvm in all cases it was also found that the lssvm and mars estimates closely follow the corresponding observed values while the op elm and m5tree considerably over underestimate low high streamflow values in the test period thus it can be concluded that the lssvm and mars are capable of providing more accurate streamflows predictions in comparison to op elm and m5tree based models with and or without local data the main limitation of this study is the use of two stations located in mountainous basins of pakistan sufficient meteorological data are generally not available and or not feasible to record in such basins therefore investigating alternative methods to improve prediction accuracy in modeling streamflows caries much more importance compared to other basins the presented methods may be tested by different data from different mountainous basins all over the world the methods can be compared with other data driven methods using different input scenarios of hydro climatic data declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key r d program of china 2016yfc0402706 and national natural science foundation of china 41730750 
