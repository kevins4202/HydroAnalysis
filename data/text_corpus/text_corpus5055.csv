index,text
25275,although numerous studies have shown disease prevalence to be influenced by changes in biodiversity few studies have explored which factors affect the relationship between biodiversity and disease when species richness increases the abundance of host species decreases due to the limited available resources low population density may yield a low population growth rate and a high chance of extinction caused by a variety of mechanisms such as mate limitation and inefficient cooperative defense breeding i e the allee effect however few studies investigating the diversity disease relationship have taken the allee effect into account here using a multi host parasitoid model we found that the allee effect can weaken the host dilution effect to a degree that depended on the strength of the allee effect and the aggregation of parasitoid attack the allee effect within hosts can protect them from being parasitized and increase the risk of host parasitoid system collapse these results may provide an alternative explanation for non linear relationships between biodiversity and parasitic disease prevalence and therefore can contribute to reconciliation of current disputes over dilution effects keywords aggregation intensity diversity disease relationship host parasitoid system simulation 1 introduction accumulated evidences have suggested that the emergence and prevalence of an infectious disease may relate to the level of host biodiversity i e biodiversity disease relationship keesing et al 2006 cardinale et al 2012 johnson et al 2013 some studies have proposed that a high species diversity may buffer the emergence and transmission of infectious diseases via a hypothesized dilution effect i e high host species diversity can reduce disease risk huang et al 2015 johnson et al 2013 keesing et al 2010 ostfeld and keesing 2012 the dilution effect which merges public health and conservation interests cardinale et al 2012 schmidt and ostfeld 2001 has attracted much attention to the identification of ecosystem services and functions the dilution effect can operate through several mechanisms 1 susceptible host regulation where the low quality host species in a diverse community can reduce the abundance of competent hosts and therefore reduce the disease risk 2 encounter reduction where the low quality host species can reduce the encounter rates between ideal hosts or between competent hosts and vectors 3 transmission interference where the addition of a new host species can reduce the transmission rate among competent hosts keesing et al 2006 evidence supporting the dilution effect mechanism has been provided through studies on a wide range of diseases including both plant and animal disease systems such as west nile virus allan et al 2009 lyme disease logiudice et al 2008 trematode parasites johnson et al 2013 and four barley and cereal yellow dwarf viruses lacroix et al 2014 however some researchers argue that the dilution effect is likely an atypical response which only applies under very specific circumstances randolph and dobson 2012 salkeld et al 2013 wood et al 2014 it is also suggested from some recent studies that diversity can sometimes amplify a disease chen and zhou 2015 lafferty and kuris 1999 and in other circumstances diveristy can have no influence on the outcome of a disease salkeld et al 2013 for instance wood et al 2014 argued that biodiversity has little effect on most infectious diseases and when it does influence diseases biodiversity seems most likely to facilitate the transmission of an infectious disease given the ambiguous nature of the biodiversity disease relationship this debate may be partially due to failure to consider some important ecological factors that can affect the dynamics of the host community and disease transmission the allee effect described as a decrease in the per capita growth rate at low densities can be caused by a number of mechanisms such as mating limitations inbreeding depression anti predator defenses and dispersal costs davis et al 2004 lamont et al 1993 the allee effect has been detected in diverse animal taxa mollusca arthropoda and chordata kramer et al 2009 on one hand with increases in species richness the abundance of each species usually decreases because of the fixed total resources available within the habitat the phenomenon that is termed as density compensation after macarthur et al 1972 thus the number of rare species may increase with species richness the allee effect which is termed as the decrease in the per capita growth rate at low densities may cause the extinction of these rare species in this sense the allee effect may have a negative impact on diversity roques et al 2012 on the other hand theoretical and field studies have shown the allee effect to affect disease transmission deredec and courchamp 2006 liu et al 2009 for instance the presence of a strong allee effect within hosts can even in simple epidemic models lead to surprisingly diverse dynamics including sustained oscillations multiple stable states and catastrophic collapse of an endemic equilibrium hilker et al 2009 however almost all the studies along this line are aimed at dynamical complexity the stability of the system and the prevalence of the parasitism bompard et al 2013 briggs and hoopes 2004 hilker et al 2009 jang and diamond 2007 to sum up the allee effect may not only affect the diversity of host communities but also disease prevalence therefore it may potentially modify the diversity disease relationship up to now however there has been no study exploring the roles of the allee effect on the diversity disease relationship most experimental studies have found a dilution effect of host diversity on parasitism in host parasite systems for example trematodes can parasitize the body surface body cavities and various organs of amphibians causing mortality and severe malformations johnson et al 2012 a field study in 345 wetlands showed a high diversity of amphibians can inhibit the prevalence of malformations and infections within the amphibian populations johnson et al 2013 additionally heterogeneity of parasitoid attack can also affect parasitic disease dynamics liu et al 2009 may 1978 rohani et al 1994 in the real natural communities parasitism is often found to be aggregated in patches with high host density may 1978 with many hosts sharing a low parasite load and a few hosts bearing a very high burden of parasitism begon et al 1996 for instance shaw et al 1998 showed that 45 out of 49 published wildlife host macroparasite systems exhibited some degree of aggregation of parasite attack and 43 systems supported a high intensity of aggregation aggregation index k 1 here by incorporating the allee effect and parasitism aggregation in hosts into a multi host parasitoid model we examined the influences of a host allee effect on the diversity disease relationship at different levels of parasitism aggregation we first investigated the life history trade off between investment into growth and defense against parasitism existed for the host species i e fast lived species generally invest more energy in growth and simultaneously less in defense against diseases then relaxed to simulate the random case i e no trade off between investment into growth and defense against parasitism to get a more general conclusion 2 materials and methods 2 1 multi host parasitoid model a modelling tradition initiated mainly by entomologists with insect hosts and their parasitoids in mind assumes that populations have discrete and synchronized generations may et al 1981 the usual framework for discrete generation host parasitoid models is given by hassell 2000 h t 1 λ h t f h t p t p t 1 β h t 1 f h t p t this model is widely used to describe the dynamics of hosts and parasitoids jang 2006 may et al 1981 we extended the above usual framework to describe the dynamics of multiple host species 1 h i t 1 λ i t h i t f h i t p i t p i t 1 β h i t 1 f h i t p i t where hi t is the population size of the susceptible host species i at time t and pi t denotes the number of parasitoid individuals on host species i at time t the parameter λi t is the net growth rate of host i at time t in the absence of parasites β is the average number of parasitoid progeny per attacked host hassell 2000 the function f hi t pi t defines the fractional survival of hosts from being parasitized and therefore 1 f hi t pi t gives the probability of host species i being parasitized 2 2 host species growth under the allee effect we assumed the growth rate of the host species to follow an over compensatory density dependence due to intra and inter specific competition pattern 2 λ i t e r i 1 j h j t c h i t h i t m where c is the carrying capacity for host in the absence of parasitoid and ri is the intrinsic growth rate for species i liu et al 2009 we incorporated the allee effect into host population growth by adding the term hi t hi t m berec et al 2007 where the parameter m is the allee effect constant and a large value for m reflects a strong allee effect regardless of parasitism 2 3 parasitoid attack aggregation in the classic host parasitoid model it assumes the parasitoids search independently and randomly nicholson and bailey 1935 thence the proportion of hosts escaping from parasitism f can be calculated by the zero term of a poisson distribution i e f e a p t where a p t are the mean encounters per host however may 1978 pointed out that random parasitism is less likely to occur in the real world where host individuals are bound to vary in their spatial location phenotype and stage of development extensive series of experiments showed that the distribution of attacks per host is well described by a negative binomial distribution as is the number of eggs laid in hosts griffiths and holling 1969 kfir et al 1976 the probability of escaping parasitism is the zero term of negative binomial that is f 1 a p t k k where k is the clumping parameter which defines the degree to which parasitism among hosts is aggregated the smaller k is the stronger the aggregated parasitism will be k when parasitoid host interactions are random i e poisson distribution and k 0 for extreme aggregation of parasitism liu et al 2009 may 1978 rohani et al 1994 in our multi host parasitoid model f can be rewirtten as 3 f h i t p i t 1 e i k k ei measures the mean encounter rate of the parasitoids with the host species i 4 e i h i t l h i t j α i j p j t here h i t l h i t is the proportion of host species i in the total community αij is the searching efficiency of parasitoid on host species j for host species i i e the interspecific searching efficiency the eq 4 implies that the parasitoid species dedicates a lot for foraging time or egg supply to an alternative host species or ignores rare host species in favor of more abundant hosts we first applied a methodologically simple method that αij was the mean of the intraspecific searching efficiency modified by a constant scaling factor i e αij cij αii αjj 2 then we performed a sensitivity analysis by randomly drawing αij from a normal distribution irrespective of the identity of the two host species i and j involved thus eqs 1 4 forms the whole simulation models in this study details for all parameters involved in the analysis are provided in table 1 2 4 community assemblage and initial conditions since our model is highly non linear with a large set of differential equations i 1 2 3 it is difficult to solve the equations explicitly therefore we investigated influences of the allee effect on the diversity disease relationship through numerical simulations we carried out the analyses in two kinds of communities non neutral host communities and neutral communities the non neutral host communities meant that different species might have different demographic rates however in neutral host communities we ignored the differences among species and assumed that different species were ecologically the same on the per capita base for the non neutral host community analyses we first considered the scenario that the host species with higher intrinsic growth rates greater ri suffered from higher probabilities of being parasitized higher searching efficiency αii hassell and rogers 1972 according to the principle of allocation in life history stearns 1992 due to a fixed resource budget increased investment in reproduction can only come at the cost of investment into defense lee et al 2008 martin ii et al 2006 therefore we expected that a trade off between the intrinsic growth rate and the parasitoid attack rate should be held among a variety of organisms we assumed the intrinsic growth rate for each host species ri were drew from the normal distribution of n 0 5 0 02 2 or n 0 5 0 1 2 just to test the robustness the same below and the searching efficiency αii from the normal distribution of n 0 5 0 1 2 or from the uniform distribution of u 0 5 0 1 we then sorted these values of ri and αii in descending order and assigned them to each species so that a host species with a higher intrinsic growth rate also suffered from higher risk of being located by a parasitoid the carrying capacity c of the host community was assumed to be 1000 the allee effect constant m values of 0 0 4 and 0 8 were matched with the aggregation index k values of 0 1 0 3 and 0 5 respectively for each parameter combination the species richness varies from 1 to 50 we assumed that the initial total host community size was 300 and the initial total parasitoid size was 50 for each species richness scenario then the realized initial abundance of each host species equaled the total community size divided by host species richness each single simulation involved 1000 generations to reach quasi equilibrium and only the last 50 generations were used in analyses of results for each parameter set we carried out 30 replicates for each species richness level and averaged them to obtain mean values the risk of disease was measured using two different indicators the infection rate the proportion of parasitized hosts within the whole community and the number of parasitoids in order to verify the results are generally independent of the life history trade off we also randomized the relationship between ri and αii to create a null model besides considering that the interspecific searching efficiency αij might vary among different species pairs we performed a sensitivity analysis by randomly drawing αij from a normal distribution n 0 5 0 1 2 irrespective of the identity of the two host species i and j involved for the neutral host community analysis we assumed different host species shared the same demographic rates e g intrinsic growth rate parasitoid competence f hi t pi t etc this creates a special non neutral host community with the variance of all parameters equal to zero details for all parameters are provided in table 1 we repeated the above simulation process in neutral host parasitoid system the only difference was that we only repeated once not 30 replicates since all parameters were deterministic in the neutral case 3 results according to eq 3 adding species into the host community increased the probability of hosts escaping from parasitism f hi t pi t fig 1 therefore increasing species richness can reduce the parasitism risks via the mechanism of encounter interference i e non host species reduce the probability of encounter between hosts therefore interfere the effective transmission of pathogens keesing et al 2006 furthermore a decrease in k i e increase in aggregation intensity of parasitoid attack led to an increase in the probability of avoiding parasitism under the same species richness level fig 1 3 1 results for non neutral host communities first we show the results under the case that the intrinsic growth rate ri was positively related to the probability of being parasitized αii in the absence of the allee effect there was a clear dilution effect of species richness on the mean infection rate and the lower the aggregation of parasitoid attack the weaker the dilution effect the first row in fig 2 the influence of the allee effect on the diversity disease relationship largely depended on the intensity of parasitoid aggregation fig 2 with a combination of the allee effect and strong aggregation intensity k 0 1 the dilution effect occurs up to a threshold level of species richness but attenuated with further increases in species richness the first column in fig 2 when the allee effect was combined with moderate aggregation intensity increases in host species richness slightly reduced the infection rate i e the dilution effect is weakened under a strong allee effect and high k the infection rate initially increased with species richness up to a very low threshold level of species richness then decreased at a very slow rate fig 2 these results were robust when change the value of the intrinsic growth rate ri and the searching efficiency αii for example ri was drawn from a normal distribution with a higher standard deviation of n 0 5 0 02 2 and αii was randomly drawn from a uniform distribution of u 0 5 0 1 fig a1 secondly in the null model the intrinsic growth rate ri was randomly related to the probability of being parasitized αii the main results remain unchanged fig a2 furthermore the sensitivity analysis showed that when the interspecific searching efficiency αij was drew from a normal distribution n 0 5 0 1 2 rather than depending on the intraspecific searching efficiency of αii and αjj trends remains unchanged fig a3 contrary to the mean per capita infection rate the total abundance of parasitoids within the whole community almost always increased with species richness i e amplification effect which means that disease risk increases with host species richness keesing et al 2006 especially for small host diversity values fig 3 however when the allee effect was high and the aggregation intensity was low the combined effect of parasitism and the allee effect restricted the densities of both host species and parasitoids to very low levels therefore the diversity disease relationship is very weak under these conditions fig 3 3 2 results for neutral host communities similar to the non neutral case the dilution effect of host species richness on infection rate was obvious when the aggregation intensity was high k 0 1 fig 4 however with an increase of the allee effect constant m and aggregation index k the decline in infection rate with increased host species richness attenuated further increases to m and k resulted in almost no significant relationship between biodiversity and infection rate fig 4 furthermore when the total abundance of parasitoids was used as an indicator of disease risk the amplification effect was identical to that of the non neutral case fig 5 4 discussion due to limited resources increasing species diversity within a host community inevitably results in reductions to the abundance of most host species leading to the action of an allee effect which can drastically influence the persistence of hosts and modify disease transmission deredec and courchamp 2006 roques et al 2012 therefore the allee effect may potentially affect the diversity disease relationship here using a multi host parasitoid model we demonstrate for the first time that the allee effect can weaken the dilution effect figs 2 and 3 fig a1 a3 and the magnitude of the effect largely depends on the intensity of parasitism aggregation all of the predicted trends in the diversity disease relationships from the models applied in this study may be explained by three factors or processes the first one is the transmission interference between competent hosts and parasitoids at higher species richness levels in our model the realized per capita infection rate decreased with increasing host species richness because our simulations assumed that the interspecific infection rate was lower than the intraspecific infection rate dobson 2004 secondly with a high parasitism aggregation a great number of parasitoids are gathered in certain hosts resulting in a refuge from parasitism for other hosts may et al 1981 thus parasitism aggregation was predicted to reduce the average probability of host species being attacked fig 1 this can result in decreased host abundance as aggregation decreased at the same host species richness levels fig 3 the third factor likely driving the predicted trends is a depressed growth rate of each host species due to the allee effect which would keep the entire host community at low numbers especially at high species richness levels when the abundance of each species is likely to be small for example a dilution effect is always expected under the combination of high parasitoid aggregation intensity and low allee effect figs 2 and 4 this may be because when parasitoid attack is highly aggregated the average low probability of host species being attacked i e the refuge effect mentioned above can offset some of the negative influence of the allee effect on host survival and growth which makes host diversity become the primary factor influencing the total infection rate therefore transmission interference between competent hosts and parasitoids could be the main mechanism driving the dilution effect under the case of high allee effect and low parasitism aggregation intensity e g m 0 8 k 0 5 in fig 2 and m 0 8 k 0 3 in fig 4 the infection rate peaked at a low species richness this phenomenon may be due to the combination of the allee effect and transmission interference with increasing host diversity resulting in the maximum infection rate occurring at a low host diversity we also found that in the neutral model a chaos emerged and the dilution effect almost disappeared when k and m became higher this was because higher k and m lead to very low host species population densities fig 5 where small amounts of demographic stochasticity or noise can push the system to a chaotic state liu et al 2009 we found the allee effect to play a dual role in regulating multi host parasitoid systems on the one hand as illustrated in previous studies deredec and courchamp 2006 the presence of the allee effect in hosts may protect host species from parasitism by reducing the density of host species at the community level on the other hand the abundance of either hosts or parasitoids could be keep at very low levels enlarging the risk of system collapse due to demographic stochasticity consistent with previous studies hassell and may 1974 1973 rohani et al 1994 our results also showed parasitism aggregation can stabilize the host parasitoid system aggregation of attack can stabilize the host parasitoid system by introducing a temporal density dependence into the per capita searching efficiency of the parasitoid may et al 1981 rohani et al 1994 individual parasitoids compete for competent hosts leading to a reduction in parasitism efficiency as species richness increases fig 1 our results showed that within a whole community a decrease in parasitism prevalence and an increase in the total number of parasitoids can be observed simultaneously figs 2 5 suggesting that different indicators of disease risk relative and absolute indicators may bring out different conclusions on one hand high host species richness led to high abundance of hosts and parasitoids within a community but the total abundance of parasitoids increased more slowly than the host species abundance therefore the overall infection rate decreased as species richness increased on the other hand when disease risk was measured by the total number of parasitoids a weak amplification effect occurs this result is consistent with previous studies that the dilution effect to be more easily detected when using infection rate instead of the abundance of infected agents as a disease risk indicator huang et al 2015 roche et al 2012 despite a large number of studies of the relationship between diversity and diseases the question of whether biodiversity has a dilution or amplification effect on disease risk remains highly disputed investigating which factors may affect biodiversity disease relationships and predicting when the dilution effect will be expected is critical for evaluating the consequences of biodiversity loss on the emergence and transmission of diseases however research in this area is still relatively scarce in this study our results showed that the allee effect can weaken the dilution effect and the degree of weakness was affected by aggregation of parasitoid attack the diversity disease relationship was significant when parasitism aggregation intensity is low and no obvious relationship when parasitism aggregation intensity is high furthermore different indicators of disease risk may lead to totally different conclusions these findings may provide an alternative explanation for the non linear relationship between biodiversity and disease risk and at least partly reconcile current disputes over the mechanisms driving the dilution effect it must be noted that real biological systems are complex so we made several simplifying assumptions to render the analysis tractable for example we ignored seasonality and parasitic stages which can strongly influence parasitism prevalence shaw et al 1998 one previous study found parasitism infection occurrences to be highly seasonal in aquatic systems keymer 1982 furthermore our models considered only homogeneous environments and did not account for variation in spatial distribution of host species which can also affect parasite transmission dynamics neri et al 2011 in fact the interplay between hosts and parasitoids is very complex and spatially explicit models are probably required to adequately describe parasitoid transmission keeling and grenfell 2000 nonetheless there is much to be gain from using models to assess the generalities of the influences of the allee effect on biodiversity disease relationship and to continue to develop a sound theoretical framework for future research acknowledgements this work was supported by national natural science foundation of china 31700466 31470563 31500383 the research project of chinese ministry of education no 113021a and the fund of changzhou institute of technology yn1619 we would also like to thank christine verhille at the university of british columbia for her assistance with english language and grammatical editing of the manuscript appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 05 001 appendix a supplementary data the following is supplementary data to this article 
25275,although numerous studies have shown disease prevalence to be influenced by changes in biodiversity few studies have explored which factors affect the relationship between biodiversity and disease when species richness increases the abundance of host species decreases due to the limited available resources low population density may yield a low population growth rate and a high chance of extinction caused by a variety of mechanisms such as mate limitation and inefficient cooperative defense breeding i e the allee effect however few studies investigating the diversity disease relationship have taken the allee effect into account here using a multi host parasitoid model we found that the allee effect can weaken the host dilution effect to a degree that depended on the strength of the allee effect and the aggregation of parasitoid attack the allee effect within hosts can protect them from being parasitized and increase the risk of host parasitoid system collapse these results may provide an alternative explanation for non linear relationships between biodiversity and parasitic disease prevalence and therefore can contribute to reconciliation of current disputes over dilution effects keywords aggregation intensity diversity disease relationship host parasitoid system simulation 1 introduction accumulated evidences have suggested that the emergence and prevalence of an infectious disease may relate to the level of host biodiversity i e biodiversity disease relationship keesing et al 2006 cardinale et al 2012 johnson et al 2013 some studies have proposed that a high species diversity may buffer the emergence and transmission of infectious diseases via a hypothesized dilution effect i e high host species diversity can reduce disease risk huang et al 2015 johnson et al 2013 keesing et al 2010 ostfeld and keesing 2012 the dilution effect which merges public health and conservation interests cardinale et al 2012 schmidt and ostfeld 2001 has attracted much attention to the identification of ecosystem services and functions the dilution effect can operate through several mechanisms 1 susceptible host regulation where the low quality host species in a diverse community can reduce the abundance of competent hosts and therefore reduce the disease risk 2 encounter reduction where the low quality host species can reduce the encounter rates between ideal hosts or between competent hosts and vectors 3 transmission interference where the addition of a new host species can reduce the transmission rate among competent hosts keesing et al 2006 evidence supporting the dilution effect mechanism has been provided through studies on a wide range of diseases including both plant and animal disease systems such as west nile virus allan et al 2009 lyme disease logiudice et al 2008 trematode parasites johnson et al 2013 and four barley and cereal yellow dwarf viruses lacroix et al 2014 however some researchers argue that the dilution effect is likely an atypical response which only applies under very specific circumstances randolph and dobson 2012 salkeld et al 2013 wood et al 2014 it is also suggested from some recent studies that diversity can sometimes amplify a disease chen and zhou 2015 lafferty and kuris 1999 and in other circumstances diveristy can have no influence on the outcome of a disease salkeld et al 2013 for instance wood et al 2014 argued that biodiversity has little effect on most infectious diseases and when it does influence diseases biodiversity seems most likely to facilitate the transmission of an infectious disease given the ambiguous nature of the biodiversity disease relationship this debate may be partially due to failure to consider some important ecological factors that can affect the dynamics of the host community and disease transmission the allee effect described as a decrease in the per capita growth rate at low densities can be caused by a number of mechanisms such as mating limitations inbreeding depression anti predator defenses and dispersal costs davis et al 2004 lamont et al 1993 the allee effect has been detected in diverse animal taxa mollusca arthropoda and chordata kramer et al 2009 on one hand with increases in species richness the abundance of each species usually decreases because of the fixed total resources available within the habitat the phenomenon that is termed as density compensation after macarthur et al 1972 thus the number of rare species may increase with species richness the allee effect which is termed as the decrease in the per capita growth rate at low densities may cause the extinction of these rare species in this sense the allee effect may have a negative impact on diversity roques et al 2012 on the other hand theoretical and field studies have shown the allee effect to affect disease transmission deredec and courchamp 2006 liu et al 2009 for instance the presence of a strong allee effect within hosts can even in simple epidemic models lead to surprisingly diverse dynamics including sustained oscillations multiple stable states and catastrophic collapse of an endemic equilibrium hilker et al 2009 however almost all the studies along this line are aimed at dynamical complexity the stability of the system and the prevalence of the parasitism bompard et al 2013 briggs and hoopes 2004 hilker et al 2009 jang and diamond 2007 to sum up the allee effect may not only affect the diversity of host communities but also disease prevalence therefore it may potentially modify the diversity disease relationship up to now however there has been no study exploring the roles of the allee effect on the diversity disease relationship most experimental studies have found a dilution effect of host diversity on parasitism in host parasite systems for example trematodes can parasitize the body surface body cavities and various organs of amphibians causing mortality and severe malformations johnson et al 2012 a field study in 345 wetlands showed a high diversity of amphibians can inhibit the prevalence of malformations and infections within the amphibian populations johnson et al 2013 additionally heterogeneity of parasitoid attack can also affect parasitic disease dynamics liu et al 2009 may 1978 rohani et al 1994 in the real natural communities parasitism is often found to be aggregated in patches with high host density may 1978 with many hosts sharing a low parasite load and a few hosts bearing a very high burden of parasitism begon et al 1996 for instance shaw et al 1998 showed that 45 out of 49 published wildlife host macroparasite systems exhibited some degree of aggregation of parasite attack and 43 systems supported a high intensity of aggregation aggregation index k 1 here by incorporating the allee effect and parasitism aggregation in hosts into a multi host parasitoid model we examined the influences of a host allee effect on the diversity disease relationship at different levels of parasitism aggregation we first investigated the life history trade off between investment into growth and defense against parasitism existed for the host species i e fast lived species generally invest more energy in growth and simultaneously less in defense against diseases then relaxed to simulate the random case i e no trade off between investment into growth and defense against parasitism to get a more general conclusion 2 materials and methods 2 1 multi host parasitoid model a modelling tradition initiated mainly by entomologists with insect hosts and their parasitoids in mind assumes that populations have discrete and synchronized generations may et al 1981 the usual framework for discrete generation host parasitoid models is given by hassell 2000 h t 1 λ h t f h t p t p t 1 β h t 1 f h t p t this model is widely used to describe the dynamics of hosts and parasitoids jang 2006 may et al 1981 we extended the above usual framework to describe the dynamics of multiple host species 1 h i t 1 λ i t h i t f h i t p i t p i t 1 β h i t 1 f h i t p i t where hi t is the population size of the susceptible host species i at time t and pi t denotes the number of parasitoid individuals on host species i at time t the parameter λi t is the net growth rate of host i at time t in the absence of parasites β is the average number of parasitoid progeny per attacked host hassell 2000 the function f hi t pi t defines the fractional survival of hosts from being parasitized and therefore 1 f hi t pi t gives the probability of host species i being parasitized 2 2 host species growth under the allee effect we assumed the growth rate of the host species to follow an over compensatory density dependence due to intra and inter specific competition pattern 2 λ i t e r i 1 j h j t c h i t h i t m where c is the carrying capacity for host in the absence of parasitoid and ri is the intrinsic growth rate for species i liu et al 2009 we incorporated the allee effect into host population growth by adding the term hi t hi t m berec et al 2007 where the parameter m is the allee effect constant and a large value for m reflects a strong allee effect regardless of parasitism 2 3 parasitoid attack aggregation in the classic host parasitoid model it assumes the parasitoids search independently and randomly nicholson and bailey 1935 thence the proportion of hosts escaping from parasitism f can be calculated by the zero term of a poisson distribution i e f e a p t where a p t are the mean encounters per host however may 1978 pointed out that random parasitism is less likely to occur in the real world where host individuals are bound to vary in their spatial location phenotype and stage of development extensive series of experiments showed that the distribution of attacks per host is well described by a negative binomial distribution as is the number of eggs laid in hosts griffiths and holling 1969 kfir et al 1976 the probability of escaping parasitism is the zero term of negative binomial that is f 1 a p t k k where k is the clumping parameter which defines the degree to which parasitism among hosts is aggregated the smaller k is the stronger the aggregated parasitism will be k when parasitoid host interactions are random i e poisson distribution and k 0 for extreme aggregation of parasitism liu et al 2009 may 1978 rohani et al 1994 in our multi host parasitoid model f can be rewirtten as 3 f h i t p i t 1 e i k k ei measures the mean encounter rate of the parasitoids with the host species i 4 e i h i t l h i t j α i j p j t here h i t l h i t is the proportion of host species i in the total community αij is the searching efficiency of parasitoid on host species j for host species i i e the interspecific searching efficiency the eq 4 implies that the parasitoid species dedicates a lot for foraging time or egg supply to an alternative host species or ignores rare host species in favor of more abundant hosts we first applied a methodologically simple method that αij was the mean of the intraspecific searching efficiency modified by a constant scaling factor i e αij cij αii αjj 2 then we performed a sensitivity analysis by randomly drawing αij from a normal distribution irrespective of the identity of the two host species i and j involved thus eqs 1 4 forms the whole simulation models in this study details for all parameters involved in the analysis are provided in table 1 2 4 community assemblage and initial conditions since our model is highly non linear with a large set of differential equations i 1 2 3 it is difficult to solve the equations explicitly therefore we investigated influences of the allee effect on the diversity disease relationship through numerical simulations we carried out the analyses in two kinds of communities non neutral host communities and neutral communities the non neutral host communities meant that different species might have different demographic rates however in neutral host communities we ignored the differences among species and assumed that different species were ecologically the same on the per capita base for the non neutral host community analyses we first considered the scenario that the host species with higher intrinsic growth rates greater ri suffered from higher probabilities of being parasitized higher searching efficiency αii hassell and rogers 1972 according to the principle of allocation in life history stearns 1992 due to a fixed resource budget increased investment in reproduction can only come at the cost of investment into defense lee et al 2008 martin ii et al 2006 therefore we expected that a trade off between the intrinsic growth rate and the parasitoid attack rate should be held among a variety of organisms we assumed the intrinsic growth rate for each host species ri were drew from the normal distribution of n 0 5 0 02 2 or n 0 5 0 1 2 just to test the robustness the same below and the searching efficiency αii from the normal distribution of n 0 5 0 1 2 or from the uniform distribution of u 0 5 0 1 we then sorted these values of ri and αii in descending order and assigned them to each species so that a host species with a higher intrinsic growth rate also suffered from higher risk of being located by a parasitoid the carrying capacity c of the host community was assumed to be 1000 the allee effect constant m values of 0 0 4 and 0 8 were matched with the aggregation index k values of 0 1 0 3 and 0 5 respectively for each parameter combination the species richness varies from 1 to 50 we assumed that the initial total host community size was 300 and the initial total parasitoid size was 50 for each species richness scenario then the realized initial abundance of each host species equaled the total community size divided by host species richness each single simulation involved 1000 generations to reach quasi equilibrium and only the last 50 generations were used in analyses of results for each parameter set we carried out 30 replicates for each species richness level and averaged them to obtain mean values the risk of disease was measured using two different indicators the infection rate the proportion of parasitized hosts within the whole community and the number of parasitoids in order to verify the results are generally independent of the life history trade off we also randomized the relationship between ri and αii to create a null model besides considering that the interspecific searching efficiency αij might vary among different species pairs we performed a sensitivity analysis by randomly drawing αij from a normal distribution n 0 5 0 1 2 irrespective of the identity of the two host species i and j involved for the neutral host community analysis we assumed different host species shared the same demographic rates e g intrinsic growth rate parasitoid competence f hi t pi t etc this creates a special non neutral host community with the variance of all parameters equal to zero details for all parameters are provided in table 1 we repeated the above simulation process in neutral host parasitoid system the only difference was that we only repeated once not 30 replicates since all parameters were deterministic in the neutral case 3 results according to eq 3 adding species into the host community increased the probability of hosts escaping from parasitism f hi t pi t fig 1 therefore increasing species richness can reduce the parasitism risks via the mechanism of encounter interference i e non host species reduce the probability of encounter between hosts therefore interfere the effective transmission of pathogens keesing et al 2006 furthermore a decrease in k i e increase in aggregation intensity of parasitoid attack led to an increase in the probability of avoiding parasitism under the same species richness level fig 1 3 1 results for non neutral host communities first we show the results under the case that the intrinsic growth rate ri was positively related to the probability of being parasitized αii in the absence of the allee effect there was a clear dilution effect of species richness on the mean infection rate and the lower the aggregation of parasitoid attack the weaker the dilution effect the first row in fig 2 the influence of the allee effect on the diversity disease relationship largely depended on the intensity of parasitoid aggregation fig 2 with a combination of the allee effect and strong aggregation intensity k 0 1 the dilution effect occurs up to a threshold level of species richness but attenuated with further increases in species richness the first column in fig 2 when the allee effect was combined with moderate aggregation intensity increases in host species richness slightly reduced the infection rate i e the dilution effect is weakened under a strong allee effect and high k the infection rate initially increased with species richness up to a very low threshold level of species richness then decreased at a very slow rate fig 2 these results were robust when change the value of the intrinsic growth rate ri and the searching efficiency αii for example ri was drawn from a normal distribution with a higher standard deviation of n 0 5 0 02 2 and αii was randomly drawn from a uniform distribution of u 0 5 0 1 fig a1 secondly in the null model the intrinsic growth rate ri was randomly related to the probability of being parasitized αii the main results remain unchanged fig a2 furthermore the sensitivity analysis showed that when the interspecific searching efficiency αij was drew from a normal distribution n 0 5 0 1 2 rather than depending on the intraspecific searching efficiency of αii and αjj trends remains unchanged fig a3 contrary to the mean per capita infection rate the total abundance of parasitoids within the whole community almost always increased with species richness i e amplification effect which means that disease risk increases with host species richness keesing et al 2006 especially for small host diversity values fig 3 however when the allee effect was high and the aggregation intensity was low the combined effect of parasitism and the allee effect restricted the densities of both host species and parasitoids to very low levels therefore the diversity disease relationship is very weak under these conditions fig 3 3 2 results for neutral host communities similar to the non neutral case the dilution effect of host species richness on infection rate was obvious when the aggregation intensity was high k 0 1 fig 4 however with an increase of the allee effect constant m and aggregation index k the decline in infection rate with increased host species richness attenuated further increases to m and k resulted in almost no significant relationship between biodiversity and infection rate fig 4 furthermore when the total abundance of parasitoids was used as an indicator of disease risk the amplification effect was identical to that of the non neutral case fig 5 4 discussion due to limited resources increasing species diversity within a host community inevitably results in reductions to the abundance of most host species leading to the action of an allee effect which can drastically influence the persistence of hosts and modify disease transmission deredec and courchamp 2006 roques et al 2012 therefore the allee effect may potentially affect the diversity disease relationship here using a multi host parasitoid model we demonstrate for the first time that the allee effect can weaken the dilution effect figs 2 and 3 fig a1 a3 and the magnitude of the effect largely depends on the intensity of parasitism aggregation all of the predicted trends in the diversity disease relationships from the models applied in this study may be explained by three factors or processes the first one is the transmission interference between competent hosts and parasitoids at higher species richness levels in our model the realized per capita infection rate decreased with increasing host species richness because our simulations assumed that the interspecific infection rate was lower than the intraspecific infection rate dobson 2004 secondly with a high parasitism aggregation a great number of parasitoids are gathered in certain hosts resulting in a refuge from parasitism for other hosts may et al 1981 thus parasitism aggregation was predicted to reduce the average probability of host species being attacked fig 1 this can result in decreased host abundance as aggregation decreased at the same host species richness levels fig 3 the third factor likely driving the predicted trends is a depressed growth rate of each host species due to the allee effect which would keep the entire host community at low numbers especially at high species richness levels when the abundance of each species is likely to be small for example a dilution effect is always expected under the combination of high parasitoid aggregation intensity and low allee effect figs 2 and 4 this may be because when parasitoid attack is highly aggregated the average low probability of host species being attacked i e the refuge effect mentioned above can offset some of the negative influence of the allee effect on host survival and growth which makes host diversity become the primary factor influencing the total infection rate therefore transmission interference between competent hosts and parasitoids could be the main mechanism driving the dilution effect under the case of high allee effect and low parasitism aggregation intensity e g m 0 8 k 0 5 in fig 2 and m 0 8 k 0 3 in fig 4 the infection rate peaked at a low species richness this phenomenon may be due to the combination of the allee effect and transmission interference with increasing host diversity resulting in the maximum infection rate occurring at a low host diversity we also found that in the neutral model a chaos emerged and the dilution effect almost disappeared when k and m became higher this was because higher k and m lead to very low host species population densities fig 5 where small amounts of demographic stochasticity or noise can push the system to a chaotic state liu et al 2009 we found the allee effect to play a dual role in regulating multi host parasitoid systems on the one hand as illustrated in previous studies deredec and courchamp 2006 the presence of the allee effect in hosts may protect host species from parasitism by reducing the density of host species at the community level on the other hand the abundance of either hosts or parasitoids could be keep at very low levels enlarging the risk of system collapse due to demographic stochasticity consistent with previous studies hassell and may 1974 1973 rohani et al 1994 our results also showed parasitism aggregation can stabilize the host parasitoid system aggregation of attack can stabilize the host parasitoid system by introducing a temporal density dependence into the per capita searching efficiency of the parasitoid may et al 1981 rohani et al 1994 individual parasitoids compete for competent hosts leading to a reduction in parasitism efficiency as species richness increases fig 1 our results showed that within a whole community a decrease in parasitism prevalence and an increase in the total number of parasitoids can be observed simultaneously figs 2 5 suggesting that different indicators of disease risk relative and absolute indicators may bring out different conclusions on one hand high host species richness led to high abundance of hosts and parasitoids within a community but the total abundance of parasitoids increased more slowly than the host species abundance therefore the overall infection rate decreased as species richness increased on the other hand when disease risk was measured by the total number of parasitoids a weak amplification effect occurs this result is consistent with previous studies that the dilution effect to be more easily detected when using infection rate instead of the abundance of infected agents as a disease risk indicator huang et al 2015 roche et al 2012 despite a large number of studies of the relationship between diversity and diseases the question of whether biodiversity has a dilution or amplification effect on disease risk remains highly disputed investigating which factors may affect biodiversity disease relationships and predicting when the dilution effect will be expected is critical for evaluating the consequences of biodiversity loss on the emergence and transmission of diseases however research in this area is still relatively scarce in this study our results showed that the allee effect can weaken the dilution effect and the degree of weakness was affected by aggregation of parasitoid attack the diversity disease relationship was significant when parasitism aggregation intensity is low and no obvious relationship when parasitism aggregation intensity is high furthermore different indicators of disease risk may lead to totally different conclusions these findings may provide an alternative explanation for the non linear relationship between biodiversity and disease risk and at least partly reconcile current disputes over the mechanisms driving the dilution effect it must be noted that real biological systems are complex so we made several simplifying assumptions to render the analysis tractable for example we ignored seasonality and parasitic stages which can strongly influence parasitism prevalence shaw et al 1998 one previous study found parasitism infection occurrences to be highly seasonal in aquatic systems keymer 1982 furthermore our models considered only homogeneous environments and did not account for variation in spatial distribution of host species which can also affect parasite transmission dynamics neri et al 2011 in fact the interplay between hosts and parasitoids is very complex and spatially explicit models are probably required to adequately describe parasitoid transmission keeling and grenfell 2000 nonetheless there is much to be gain from using models to assess the generalities of the influences of the allee effect on biodiversity disease relationship and to continue to develop a sound theoretical framework for future research acknowledgements this work was supported by national natural science foundation of china 31700466 31470563 31500383 the research project of chinese ministry of education no 113021a and the fund of changzhou institute of technology yn1619 we would also like to thank christine verhille at the university of british columbia for her assistance with english language and grammatical editing of the manuscript appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 05 001 appendix a supplementary data the following is supplementary data to this article 
25276,marine phytoplankton primary production is an extremely important process and its estimates play a major role not only in biological oceanography but also in a broader context due to its relationship with oceanic food webs energy fluxes carbon cycle and earth s climate the measurement of this process is both expensive and time consuming therefore indirect methods which can estimate phytoplankton primary production using only remotely sensed predictive information have many advantages we describe the development of a depth resolved model based on an artificial neural network for estimating global phytoplankton primary production furthermore we applied two different approaches based on input perturbation analysis and on connection weights to assess the relative importance of the predictive variables finally we compared the results of our depth resolved model with a previous depth integrated solution showing that through the depth resolution we gained not only useful information on the vertical distribution of the estimated primary production but also an enhanced accuracy in its depth integrated estimates keywords marine phytoplankton primary production artificial neural networks depth resolved model 1 introduction phytoplankton primary production is a fundamental process due to its intimate relationship with oceanic biotic and abiotic processes including biogeochemical cycles especially the carbon one and earth s climate hattam et al 2015 furthermore it represents the bulk of the whole oceanic autotrophic production duarte and cebrián 1996 which contributes roughly one third of the global primary production for these reasons the assessment of phytoplankton primary production and the study of its variability both from a spatial and a temporal perspective plays a fundamental role in marine ecological studies from food webs richardson and schoeman 2004 to fisheries nixon 1988 holmlund and hammer 1999 and from large marine ecosystems to a better understanding of the relationships between fundamental and demand derived ecosystem services costanza et al 1997 cloern et al 2014 hattam et al 2015 as the direct measurement of this biological process is not only difficult but also expensive and time consuming the need for methods aimed at its indirect evaluation is evident this is especially true if the space and or time scale of a study is too large for direct measurements and obviously when the main objective is a global assessment in fact many models have been developed for the estimation of phytoplankton primary production and several among them are based on an empirical approach i e they assume that primary production can be estimated as a function of other variables platt and sathyendranath 1988 scardi 1996 morin et al 1999 some of these models are based on predictive variables that can be obtained from remote sensing of the ocean colour which is a relatively cheap source of information on a global scale while others combine information obtained from ocean circulation and biogeochemistry aumont et al 2003 buitenhuis et al 2006 these approaches provide a way to avoid long and expensive sampling procedures that would otherwise impose strict limits to the practical applications of primary production estimates clark et al 2001 low décarie et al 2014 the structure of these indirect methods widely varies in complexity also depending on the required input variables and on the nature of the relationships between those variables and the desired output for example the empirical models proposed by ryther and yentsch 1957 and smith and baker 1978 took into account only chlorophyll concentrations and irradiance while the model developed by behrenfeld and falkowski 1997 used a larger set of predictive variables although derived from chlorophyll concentration temperature and photosynthetically active radiation par the broad variety of these techniques and their utility in different fields have led to various comparisons between models over the years especially thanks to the primary productivity algorithm round robin pparr campbell et al 2002 carr et al 2006 saba et al 2011 lee et al 2015 the pparr has been useful in order to assess and compare the accuracy of different models furthermore comparisons have laid the basis for substantial improvements in this field providing a common context in which a wide range of methods has been tested in this way the main differences among models have been outlined among the various models tested in the pparr framework only one was based on an artificial neural network ann which was used to develop a depth integrated model for the evaluation of the phytoplankton primary production scardi 2001 as the ann approach to the estimation of the primary production has shown good results in comparisons with other models friedrich et al 2009 saba et al 2011 lee et al 2015 moreover if compared to other techniques anns can be easily re calibrated as soon as new data become available in fact empirical models built through this machine learning approach if correctly trained are able to reproduce the complex non linear relations that underpin most natural processes and phytoplankton primary production is no exception moreover this method does not trade generality for simplicity as it can involve complex calculations during its development training in ann jargon scardi 1996 lek et al 1996b scardi and harding 1999 scardi 2001 olden et al 2008 while the computational burden needed to develop a model is not light it only requires computational resources that are no longer a limiting factor because of advances in computing power once developed an ann model is as fast and easy to run as most other models the structure of an ann model is not defined a priori but it is determined during the training procedure in fact other types of methods try to describe analytically the major processes the primary production depends on although this can be a very difficult task especially if the objective is to build a model that is both general and accurate on the contrary the ann approach tries to learn the relationships between the input variables and the primary production directly from the available data this is a benefit not to be underestimated while dealing with natural processes that involve complex relationships which in most cases are unknown or difficult to parameterize especially on a global scale maier and dandy 2000 moreover a model based on anns or other machine learning approaches can be easily updated without rebuilding it from scratch in fact if a new data set becomes available at a later stage relative to the development of an ann model it can be easily exploited simply by performing a new training procedure for the ann without having to reinterpret the relationship between the variables given the empirical nature of the approach the advantage in using an ann as a tool for ecological modelling becomes more evident if both the heterogeneity of remote sensing information and the incomplete understanding of the causal relationships between the variables of interest are taken into account in fact this methodology does not need any a priori knowledge in order to exploit the information contained in the input variables and at the same time it is robust enough with respect to a few redundant inputs if any these properties allow the use of a wide range of predictive variables with no need for a priori knowledge about the nature of the relationship with the output of the model i e with primary production thus enhancing the potential value of any data source including remotely sensed data indeed the possibility to explore a wider range of information looking for potential input variables is a major advantage in ecological modelling especially in the light of the lack of large data set and of the difficulties in obtaining some of the desired measures from which an ann model can learn in fact primary production data sets are often incomplete especially in terms of spatial coverage some regions of the world are over represented while others are under represented or even worse not represented at all these issues may affect the model capability of generalisation and thus interfere with the modelling accuracy on a broad spatial scale lek et al 1996b maier and dandy 2000 recknagel 2001 in this context it is important to note that the performance of any kind of model is highly dependent on both the quality and the amount of available data however this is especially true for machine learning approaches in which the data drive the training procedure without any explicit mathematical formulation between the predictive variables and the targets as the phytoplankton primary production estimates are useful in several research fields such as the management of fishery resources nixon 1988 1992 conti and scardi 2010 the assessment of the ocean oxygen production reuer et al 2007 the study of climate change influences on the oceanic primary production behrenfeld et al 2006 and both the understanding and the evaluation of various ecosystem services cloern et al 2014 hattam et al 2015 holmlund and hammer 1999 richardson and schoeman 2004 melaku canu et al 2015 any improvement in the accuracy of these appraisals could be a very important achievement anns have proved to be valuable tools providing good results with respect to the modelling of biological processes and they are widely open to experimentation and optimization in data preprocessing and in model fine tuning scardi 1996 lek et al 1996b maier and dandy 2000 olden et al 2008 in this framework our main goal was the development of a model which could use the available information more efficiently to improve both the accuracy and the granularity of the primary production estimates we decided to opt for a depth resolved solution using an empirical approach based on an ann with the aim to describe not only the vertically integrated magnitude of the phytoplankton production but also its distribution along the water column we also decided to rely upon surface data only as predictive information thus assuring the widest applicability of the resulting model in fact although a depth resolved approach to the primary production evaluation using an ann was already presented by scardi 2003 that model was strictly local and mainly aimed at demonstrating the potential of the method therefore it was developed and tested on a rather limited data set thus embedding a small amount of heterogeneity and a limited set of structures of the primary production profiles on the contrary a much wider variability in vertical production profiles is one of the most challenging elements for the global phytoplankton primary production models the results of the depth resolved model we present here were compared to those of the depth integrated ann model developed by scardi 2001 the two models share the same computational method and the same spatial scale while the data set upon which they were trained coincide almost completely therefore their comparison can show if an enhancement in the accuracy of primary production estimates can be achieved through a depth resolved approach and appropriate data management and preprocessing 2 materials and methods 2 1 data preprocessing and partitioning the data set used in this study includes 3304 vertical profiles of phytoplankton primary production that were acquired during oceanographic cruises carried out from 1954 to 1994 which have been obtained from http www science oregonstate edu ocean productivity field data c14 online php the bulk of the sampling stations was located in three regions the first one and the most represented corresponds to the north western atlantic off the coast of the united states while the second one is situated in the eastern equatorial pacific off the western coast of south america and the last one is off the west coast of the united states the remaining part of the world oceans hosts only a few sparse stations but their scarcity makes the information obtained from them even more relevant since anns are strongly empirical tools it is important to note that the model presented in this work was validated only within regions where enough data were available fig 1 and therefore it is not meant to be used elsewhere although the spatial coverage of the data set was not uniform at global scale and consequently some regions of the ocean are either underrepresented or missing these data were chosen because they have been used in the development of most primary production models thus favouring comparisons between them this allowed to highlight their properties rather than the quality and quantity of the data that supported them moreover this data set is undoubtedly the most complete among the ones freely accessible from the scientific community in spite of the fact that autotrophic production measurements are expensive and rarely available since the aim of our work was the estimation of daily phytoplankton primary production our attention was focused on the primary production data measured using 14c assimilation in simulated in situ sunlight incubations and expressed as mg c m 3 day 1 in fact this type of measurements represents the bulk of the available data about the marine primary production process furthermore among the variables collected during the cruises we also used the surface chlorophyll a concentration obtained by standard fluorometric methods the surface downwelling irradiance determined by mean of a quantum sensor and the sea surface temperature evaluated by an immersion probe those surface variables in addition to date as well as latitude and longitude of the sampling stations were selected as inputs i e as predictive variables to an ann aimed at predicting primary production in order to make the information conveyed by sampling date and station longitude directly exploitable by the ann a trigonometric transformation was applied generating four derived variables two for the date and two for the longitude using sine and cosine components for those variables allowed to map date and longitude on a circle where the difference between january 1st and december 31st for instance is not 365 days but only one all the requested information excluding primary production which is the variable to be modelled can be easily obtained from remote sensing thus allowing the model to be used with no need for expensive and time consuming field data acquisition the choice of the predictive variables was obviously supported by theoretical knowledge about the modelled biological process by the results presented in previous studies on the same topic and by the need to build a model on the basis of remotely sensed variables only maier and dandy 2000 as for the quality of the data set it has not been taken for granted that all data were unbiased and or already screened for biologically inconsistent profiles kaastra and boyd 1995 accordingly all the phytoplankton primary production profiles passed through a preprocessing stage in order to assess their ecological soundness and to filter out those showing an erratic structure or too many missing data the production to biomass ratio p b was one of the main features that were examined using the chlorophyll a concentration as a measure for biomass in fact we only selected vertical profiles that were consistent with a plausible range of this ratio roughly from 30 to 60 while extremely low or high values were assumed to be incorrect or exceptionally rare and therefore to be excluded from the data set as anns learn from examples data patterns too unlikely to be found in real world conditions could mislead the learning procedure especially in an ann based model that aimed at the maximum degree of generalization i e to be applied at global scale moreover the vertical distribution of phytoplankton production values along the water column was also checked from an ecological perspective for instance profiles that showed more than a single maximum e g two spikes were excluded the rationale behind this exclusion was the assumption that such profiles were either the result of sampling error or represented a transition phase in the water column from a stable state to a different one and in both cases they would not be useful to support the development of a general model furthermore the values of variables that drive the primary production were carefully validated especially surface sea temperature and surface irradiance all the above mentioned features were obviously evaluated while taking into account the spatio temporal context in which they were measured as for the missing data a significant effort has been devoted to the problem accordingly external data sets regarding sea surface temperature were accessed in order to fill the information gaps or check questionable values for consistency data retrieved from http neo sci gsfc nasa gov view php datasetid myd28m interpolation of existing data has been carried out whenever possible in order to fill the gaps by recovering information from the same profile or from a set of related profiles this was the only approach we used for missing irradiance data the preprocessing procedure played a fundamental role because of two reasons the first one was related to the ecological soundness of the model output in fact if biased profiles had not been excluded from the data set used for model development the training procedure would have been negatively affected by them the second reason was related to the scarcity of data supporting modelling activities efforts were made to recover missing information e g surface temperature from external sources or to assess missing data e g by interpolation whenever possible production profiles in the original data set were all based on discrete measurements performed at optical depths i e at depths that changed from profile to profile in order to adapt those data to the structure of the ann where each output corresponded to the primary production estimate at a fixed depth the observed primary production profiles were modified to be represented by the same depths along the water column accordingly the primary production values at six fixed depths namely 0 m 5 m 10 m 20 m 40 m and 60 m were obtained by computing the weighted average between the immediately upper and lower sampling points with respect to the desired depth obviously the weight of each sampling point in determining the fixed depth value was the depth difference between the sampling point and the desired fixed depth it is important to note that when a fixed depth was deeper than the last sampling point in the production profile i e to the deepest optical depth null production was assumed the rationale behind this choice was that the last value in each profile was associated with the 1 of the surface irradiance then no net production was expected below this threshold the last data preprocessing stage was aimed at balancing the information provided by the data set in fact most data were collected in the north western atlantic and therefore the majority of the examples available to the ann came from a rather homogenous region several virtual observations n 888 have been therefore added to the data set simply by duplicating profiles in underrepresented regions and perturbing them with a small amount of gaussian noise i e 0 05 0 05 to avoid exact duplicates thanks to this procedure the amount of information coming from regions where data are scanty has been artificially increased thus improving the efficiency of the ann learning scardi and tancioni 2007 after the preprocessing stage the final data set comprised of 3087 profiles 28 of which were the abovementioned virtual observations with six fixed depths was split into three subsets the first one included the majority of the data n 1852 i e about 60 and was aimed at training the ann while the second and third ones respectively the validation set and the test set accounted for about 20 of the data each nval 618 ntest 617 the training set contained the examples to be passed to the ann during the training procedure which allowed the ann to learn the scheme underlying the modelled process thus implicitly embedding all the relevant relationships between predictive variables and primary production the validation set controlled the duration of the training phase stopping it as soon as the validation error started increasing i e as soon as the ann was not able to learn the general scheme and showed the first signs of overfitting thus losing generality the test set which obviously was never passed to the ann during the training phase was used to evaluate the performance of the trained ann and to compare its results with those provided by a previous ann model scardi 2001 the three data subsets were not obtained by random selection of the primary production profiles in order to obtained balanced subsets the available profiles were sorted according to their geographic position date and magnitude of the vertically integrated primary production subsequently the second record in each group of five was assigned to the validation set whereas the fourth record was assigned to the test set and the remaining ones to the training set this way we obtained three data subsets sharing as much variability as possible finally the whole data set was normalized by scaling it into the 0 03 0 97 interval values too close to 0 or 1 were excluded to speed up the learning process by avoiding the tails of the sigmoid activation function moreover primary production data have been log transformed in order to reduce the relative importance of the largest primary production values in the training procedure such transformation was not strictly needed as the ann can learn and mimic any non linear relationship but it helped to compute the ann error relative to a log scale thus reducing the weight of the error associated with the highest production values in fact the results of empirical tests confirmed those reported by scardi harding 1999 and scardi 2001 supporting the need for log transformation of the primary production values because anns trained with raw data for primary production did not perform as well as those trained with log transformed data 2 2 artificial neural network training we developed all the software needed for training and testing the ann in fortran 90 and compiled the source code with the gfortran 4 10 0 compiler the abovementioned programs are available on request the ann we trained was a multilayer perceptron with eight input neurons a single hidden layer and six output neurons which returned primary production estimates at six fixed depths the main reason for the choice of this kind of neural network were the good results showed in previous studies e g scardi 1996 2003 moreover it grants a valuable level of flexibility especially when non linear but continuous relationships are to be modelled the sigmoid activation function f a 1 1 e a was chosen both for the hidden and the output layer while the error back propagation algorithm rumelhart et al 1986 has been used to optimize the synaptic weights as the model was aimed at global scale applications the maximum degree of generalisation was certainly the most important feature to be optimized smith 1994 therefore several techniques have been applied to achieve this goal accordingly a small amount of gaussian noise μ 0 σ 0 01 has been added to each input variable before its values were passed to the neural network during the training phase györgyi 1990 this useful method known as jittering helped by creating an infinite number of patterns very similar albeit not equal to the original ones all associated with the same biological response this way the training is focused on the learning of general relationships rather than on the memorization of patterns moreover only a randomly chosen subset including 50 of the patterns in the whole training set has been passed to the ann at each training epoch in order to minimise the probability of memorization of the training patterns depending on their order furthermore an early stopping strategy has been used to stop the training procedure the criterion used for the early stopping was the minimization of the mean square error mse relative to the validation set the validation set mse has been computed simultaneously with the training set one initially both the types of error decrease until the validation set mse starts to increase while the training set mse keeps decreasing this procedure allows stopping the training before the ann configuration becomes too specifically tailored on the training patterns thus losing the needed generality the ann training was repeated several times trying different values for learning rate and momentum and selecting the set of synaptic weights that allowed obtaining the smallest mse relative to the validation set the number of neurons in the ann hidden layer was determined according to several evaluation criteria empirical tests have been carried out trying different solutions i e by varying the number of hidden neurons from a half to the double of the input neurons number i e from 4 to 16 and by evaluating the ann performance relative to both the vertically resolved and the vertically integrated primary production estimates moreover the error distributions obtained from each ann architecture were analysed to find out whether they were affected by systematic bias the architecture with 11 nodes in the hidden layer was eventually chosen as the most performing it is important to note that as long as we used at least 11 neurons in the hidden layer the differences between different ann architectures were negligible this outcome was certainly favoured by the integration of a validation routine in the training procedure and by the relatively small number of synaptic weights to be optimized if compared to the large number of available training patterns smith 1994 lek and guégan 1999 olden et al 2004 2 3 model performance assessment once the training procedure was completed the ann performance was evaluated using the test set the primary production values predicted at each depth were compared to the known target values and mse and the determination coefficient r2 were computed as for the mse it could be compared across different anns because it was computed on normalized data deviations from target values were also analysed to check whether the ann estimates were unbiased i e symmetrically distributed around the zero finally the akaike information criterion aic akaike 1973 and the total root mean square difference rmsd were computed to compare the vertically resolved ann model to a vertically integrated ann model scardi 2001 while the first two indices were adequate to compare outputs from the same model aic allowed taking into account model complexity while comparing the results provided by different models 3 results discussion as previously stated the choice of an ann approach has been mainly guided by the desire to develop an empirical model and by the good results already obtained using this machine learning technique in phytoplankton primary production modelling scardi 1996 2001 scardi and harding 1999 the performance of the ann model was analysed both at each modelled depth and after vertical integration moreover we explored the behaviour of the ann model and the role each predictive variable played by means of both the perturbation analysis scardi and harding 1999 and the connection weights approach olden et al 2004 finally we compared the depth resolved ann model with the older depth integrated model based on the same type of ann and on a similar set of predictive variables scardi 2001 3 1 model performance the overall performance of the ann model in estimating the primary production was assessed in relation to the test set only i e to data that were never used to train or validate the ann as showed in fig 2 a the major axis of the cloud of points representing the overall comparison between observed and predicted values closely matched the unit slope line thus indicating a very good agreement fig 2a furthermore deviations from the unit slope line were symmetrically distributed around the zero the overall mse for the test set was quite small mse 0 008 while the ann model was able to explain more than 80 of the primary production variance r2 0 819 while the overall agreement between observed and modelled values was very good the error distribution of the modelled values was also taken into account to fully evaluate the quality of the estimates as expected from the scatter plot in fig 2a the mean of the deviations from the observed values was close to zero 0 002 mg c m 3 day 1 the resulting error distribution was therefore unbiased and clearly symmetrical fig 2b finally the 5th and the 95th percentiles were computed in order to highlight the range in which 90 of the errors was found the range was 0 46 0 46 in log units which corresponded to 40 8 16 4 mg c m 3 day 1 in raw data units although it might sound obvious it should be stressed that a depth resolved model can provide more information than a vertically integrated one as it allows to get an insight into the distribution of the production along the water column while our depth resolved model was actually a partly resolved model as it only took into account six fixed depths we analysed the model performance at each one of those depths we found that the model performance expressed as determination coefficient was not homogeneous along the water column the maximum level of explained variance r2 0 816 was achieved at 5 m the observed vs modelled plot showed only a limited scattering around the unit slope line and the associated histogram of the error distribution was the most symmetrical and leptokurtic among all the modelled depths fig 3c d on the contrary the minimum value r2 0 331 was associated with the 20 m depth in fact the dispersion around the unit slope line in the scatter plot showing modelled vs observed data at 20 m was wider than in those for all the others depths fig 4a at this depth the model seemed to slightly underestimate the observed production as clearly shown in the histogram in fig 4b from a more general perspective all the depth specific error distributions were nearly symmetrical and their means fell in the 0 028 0 03 interval thus showing that even the largest deviation i e potentially systematic bias was still negligible i e not exceeding 3 of the normalized output range while histograms were certainly useful to show how the errors are distributed the observed vs modelled values scatterplots conveyed more information about the concordance between the neural network output and the target i e observed values in particular they showed very clearly how the range of observed primary production values became narrower as depth increased the modelled values obviously followed the same trend while the dispersion around the unit slope lines became wider and less symmetrical with a tendency to underestimation not only at 20 m but also at deeper depths as the ann learned from the available data patterns the reduced variability in primary production made the learning process harder more or less in the same way it would have affected the fitting of a line to a set of data points arranged in a quasi circular pattern the same amount of uncertainty in data values if associated with a wider range of values would have certainly allowed a better fit independently of the modelling method the reduction in accuracy of the estimates with depth had also other explanations from a general perspective by using only remotely sensed and therefore quasi surface predictors the deeper estimates were inherently less reliable than the shallower ones this feature was certainly due to the weakened causal or correlational link between the input values and the model output saba et al 2010 on the other hand it is important to stress that the neural network training was driven by mse optimisation consequently the largest primary production values superficial and obviously associated with potentially larger errors had certainly a larger influence on the training procedure while the logarithmic transformation to the target values helped to reduce the effects of this problem the resulting bias could not be completely removed however it is important to note that the higher accuracy with respect to the shallower depths i e 0 m 10 m is an important feature in fact in the utilized data set on average the 49 of the production in each profile was confined within the very upper part of the water column this is not surprising as shallower depths receive a higher level of irradiance which is a strong driver of primary production and in coastal zones the upper layers are also richer in nutrients while the efficiency of a depth resolved ann model was already demonstrated at local spatial scale by scardi 2003 our results showed that the same approach could be successfully applied at global spatial scale 3 2 sensitivity analysis in order to gain a deeper insight into the ann model we chose two among the most reliable techniques to assess the relative importance of the predictive variables in anns dimopoulos et al 1995 lek et al 1996a scardi and harding 1999 olden and jackson 2002 gevrey et al 2003 the first method was the input perturbation analysis scardi and harding 1999 which was used in previous ann models of phytoplankton primary production scardi 2001 2003 the second assessment was performed by the connection weight approach olden and jackson 2002 olden et al 2004 which is not to be regarded as a true sensitivity analysis although it gained an increasing popularity in the ecological modelling field as a method for analysing the relative importance of input variables in anns according to the perturbation procedure an increasing amount of white noise was added to the values of each predictive variable while those of the other variables were not altered the resulting changes in mse were then plotted against the perturbation level fig 5 the chlorophyll surface concentration proved to be the most important predictive variable producing relatively large changes in mse even at low perturbation levels this was not a surprising result because of the very strong link between this pigment and the phytoplankton biomass which in turn is both the cause and the effect of phytoplankton primary production the second variable in terms of importance was the longitude which played an important role as a proxy for the complex oceanographic differences between large marine ecosystems for instance longitude could be used by the ann model to trigger different behaviours in different oceans or in different regions of the same basin latitude and surface temperature played similar roles since as they are strong drivers of seasonality this was not surprising as they were both related to climate and conveyed information about the potential structure and dynamics of the water column from a more general perspective the geographic position had an important role as a proxy for variables that were possibly relevant but which were not available or not accessible through remote sensing and consequently not used by the ann model e g nutrient availability the low overall weight of the irradiance could seem unnatural in relation to its importance in the photosynthetic process however only surface values for this variable were available to the ann and they were synchronous with those for other variables while light attenuation with depth could be implicitly considered by the ann the lack of information about short term changes in irradiance probably weakened the relationship between irradiance and the primary production measured at the sampling time because photoadaptation was not taken into account in fact the phytoplankton production at a given time might be affected by the irradiance level to which the organisms were exposed before the measurement moreover the neural network could indirectly obtain information about the available irradiance levels also from other predictors such as date and latitude while some predictive variables might seem to play a very minor role in our sensitivity analysis they still contribute to the overall model performance in fact the exclusion of surface irradiance and date from model inputs caused a 2 overall reduction in explained variance and as much as 10 in the 20 m predictions it is important to note that the most interesting portion of the sensitivity analysis graph was the one that showed the effects of intermediate levels of noise addition while the largest perturbation level might have induced values that would be very unlikely to be found in conjunction with the real values of the unperturbed variables the lowest perturbation levels acted in the same range as all the intrinsic sources of error associated with field measurements and with the estimation process consequently intermediate levels of perturbation more closely matched the true sensitivity of the model to ecologically sound changes in its inputs which could actually occur in real world conditions additionally a noteworthy feature of the sensitivity graph was the quasi linearity of the mse response to increasing levels of noise and the robustness of the model to low levels of noise which are certainly to be regarded as a strength of the ann model in fact the uncertainty in field measurements of primary production is a major issue in the development of a good estimator friedrich et al 2009 saba et al 2010 2011 in this context we believe that empirical models including anns should not be too sensitive with respect to small changes in the input values in order to avoid erratic behaviours or overreactions to small changes in their inputs as the latter could be affected by substantial errors accordingly several techniques were used to maximize the generalization capabilities of the model i e jittering early stopping and training for patterns in order to develop a model which can be both general and robust at a global scale as to the connection weight approach olden et al 2004 its results seem to be consistent with those obtained from the input perturbation analysis fig 6 in fact the chlorophyll surface concentration remains the most important variable moreover the additional information provided by this method through the sign of the relation between the chlorophyll surface concentration and the outputs seems to be consistent from an ecological perspective indeed the inhibitory effect showed by this variable on deep primary production i e on the last two outputs of the model namely 40 and 60 m can mirror a lower water column transparency caused by higher values of chlorophyll at shallower depths which cause the light profile to decay more rapidly however we had several reservations with regard to this approach as its results in some cases did not seem fully consistent with each other the first doubt arose from the significant differences in terms of sign and magnitude showed by the two variables obtained by trigonometric transformation of both date and longitude in fact we expected that the two inputs obtained by transforming the same variable had a similar importance in determining the ann output as in the perturbation analysis a second problem emerged in relation to the peculiar nature of our data set since several cruises were carried out in the same areas but at different times therefore they present similar if not identical geographical coordinates associated with a large variability in both the inputs and outputs of the model consequently evaluating the importance of the geographic position by relying only on the information conveyed by the ann weights could be misleading therefore the input perturbation method which assessed the role of each ann input variable in the context of the observed values of the other ones seemed more reliable from an ecological viewpoint 3 3 comparison with a depth integrated model the benefits of a depth resolved modelling strategy are twofold in fact it could provide not only an insight into the primary production distribution along the water column but also an enhancement in the accuracy of the estimates for this process when they are integrated vertically while depth resolved models have obvious practical advantages depth integrated primary production estimates are relevant to a wide range of applications and play a fundamental role in the study of marine ecosystem functioning in order to verify the above mentioned improvement in the assessment of the depth integrated primary production through a depth resolved approach a comparison between the ann model we developed and the one presented by scardi 2001 was carried out the latter model was depth integrated but largely based on the same data set although with a slightly different preprocessing and therefore it could be regarded as the most appropriate benchmark the comparison was obviously carried out on the test set only and the estimates for the depth integrated primary production values were obtained from both models and transformed from log to raw units before any further data processing the older ann model directly returned the depth integrated value for any input vector of predictive variables while as already mentioned the ann model presented here returned six values corresponding to the primary production estimates at six fixed depths therefore a trapezoidal integration had to be applied to each set of output values in order to obtain depth integrated production estimates subsequently the outputs from both models were compared to the observed values from the test set and the agreement between them was analysed accordingly r2 mse and rmsd were computed in order to assess the performance of each model and to compare the quality of their respective results the latter performance indicator which was the only one computed on a logarithmic scale was used to compare the performance of our model to others tested in the pparr framework e g in the model comparison presented by saba et al 2011 in addition the aic was also computed in order to take explicitly into account the model complexity in the comparison the depth resolved ann model proved to be a more accurate estimator showing better performance indicators than its vertically integrated counterpart fig 7 r2 0 617 mse 247775 rmsd 0 254 aic 3664 and r2 0 494 mse 418719 rmsd 0 323 aic 3832 respectively in fact the cloud of points in the observed vs estimated scatter plot for the depth resolved model was more concentrated around the unit slope line compared to the depth integrated one this feature was the visual representation of the accuracy gain expressed by the higher determination coefficient associated with the depth resolved ann model which explained almost 12 more variance the error distributions associated with the two models were plotted side by side in fig 8 in order to highlight the differences between them even though both error distributions were symmetrical a larger share of errors was associated with the two central bins from 150 to 150 mg c m 2 day 1 in the depth resolved model relative to the depth integrated one and they included 48 and 36 of the cases respectively moreover the slight tendency to underestimate the primary production showed by the larger number of negative differences was less pronounced in the depth resolved model accordingly the mean depth resolved error was closer to zero than the depth integrated one 55 48 mg c m 2 day 1 vs 176 92 mg c m 2 day 1 furthermore the 5th and 95th percentiles values showed that 90 errors were in the 946 2 410 2 mg c m 2 day 1 range for the depth resolved model while the depth integrated one showed a wider range 1102 1 575 6 the comparison between the two models showed that the depth resolved approach allowed to obtain better depth integrated phytoplankton estimates of primary production than the vertically integrated ann model presented by scardi 2001 in fact not only it granted deeper insights into the distribution of the autotrophic production along the water column but it also allowed using a larger number of data patterns for the model development i e for training the ann while both types of model only used predictive data obtained from surface measurements a depth integrated approach relied on a single primary production value for the whole water column whereas a depth resolved approach relied upon every bit of primary production information available along the water column it is worth stressing that a further gain in accuracy could have been achieved by using data about the predictive variables collected at all the sampling depths instead of surface data only however we decided to use exclusively surface data as predictors even at the cost of some accuracy in order to make the model compatible with applications based on remotely sensed data only thus enhancing its practical value moreover the vertical resolution of the model although discrete i e based on six fixed depths allowed to compute separate errors at each depth while the integrated model only provided an overall error relative to the whole water column as for the vertical resolution it also allowed the training of the ann model to take advantage of the non independence caused by spatial autocorrelation between primary production values at different fixed depths in fact the different shapes of phytoplankton production profiles are not infinite and therefore by associating six outputs i e different depths to each set of input values we tried to embed functional constraints into the ann model in other words we obtained an ann model with a more complex output relative to a vertically integrated solution supported by the implicit autocorrelation in primary production values along the water column this solution led to a reduced variability in the modelled process based on features captured from the data during the training phase however it is important to note that the majority of the phytoplankton primary production models involved in comparisons was developed following a mechanistic approach campbell et al 2002 carr et al 2006 friedrich et al 2009 saba et al 2010 saba et al 2011 lee et al 2015 consequently their purpose is twofold the first one is obviously the estimation of primary production while the second is related to the understanding of the modelled process which relies upon its translation into several explicit and adequately parameterized relationships it should be pointed out that aiming at two goals at the same time can lead to either a loss in accuracy of the model or to inconsistencies between the real processes and their translation into model subcomponents on the other hand an empiric modelling approach is less ambitious in terms of comprehension of the modelled process as its only purpose is to achieve the maximum accuracy in the estimates maier and dandy 2000 from this viewpoint it can be proved that an ann with only one hidden layer comprised of enough nodes and given an adequate data set can approximate any function with an arbitrary level of accuracy hornik et al 1989 while anns may appear as black boxes from the modeler s viewpoint many efforts have been made to get useful insights into them i e to retrieve at least part of what they learned from the data several post training analyses were proposed to tackle the previously mentioned problem and some of them showed good results thus improving the potentiality of this machine learning approach olden and jackson 2002 olden et al 2004 gevrey et al 2003 the sensitivity analysis based on input perturbation although not the most popular is certainly the most straightforward and the only one that was already applied to ann models of phytoplankton primary production according to olden et al 2004 it can be regarded as second best relative to the method they proposed based on ann weights but the problem we mentioned about partly invariant data patterns in our opinion limited its reliability finally it ought to be noted that the integrated model used as a benchmark for this study has already been part of the above mentioned comparisons between models performing fairly well therefore on the basis of the results we obtained we are confident that the depth resolved ann model can outperform its integrated counterpart also in a wider comparison framework 4 conclusions our results showed that a depth resolved ann model can be very useful not only to predict vertical profiles of phytoplankton primary production but also to obtain better depth integrated estimates in fact it explained roughly 12 more variance than its vertically integrated counterpart and the increase in complexity of the ann structure was justified by the gain in accuracy as shown by the aic the main reason for the improvement in primary production estimates was a more efficient exploitation of the available data brought firstly by the increase in the number of useful training data patterns and secondly by an indirect exploitation of the autocorrelation between primary production values at different depths i e by the fact that they are obviously not entirely independent from each other better primary production estimates are of paramount importance not only to pure oceanographic research but also to other applications as for instance those relating primary production to fundamental and demand derived ecosystem services or to climate change holmlund and hammer 1999 richardson and schoeman 2004 moreover our work is another example of the potential of anns and from a more general viewpoint of machine learning methods in ecological modelling as a matter of fact these approaches do not require an explicit formulation of the relationships between the available variables as they are able to learn them directly from the data this is a key feature in modelling complex natural processes because it allows using a wide array of predictive variables including all those that are available through remote sensing even in case theoretical knowledge is uncertain or incomplete i e even in case the mechanistic relationships underlying the modelled process are not fully understood the strict dependence of an ann model on both the amount and quality of available information can be limiting in data poor situations but it definitely leaves extensive room for improvement as soon as new data are acquired it is not surprising therefore that the application of anns and other machine learning techniques to ecological modelling has gained significant momentum in the last two decades appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 05 003 appendix a supplementary data the following are supplementary data to this article 
25276,marine phytoplankton primary production is an extremely important process and its estimates play a major role not only in biological oceanography but also in a broader context due to its relationship with oceanic food webs energy fluxes carbon cycle and earth s climate the measurement of this process is both expensive and time consuming therefore indirect methods which can estimate phytoplankton primary production using only remotely sensed predictive information have many advantages we describe the development of a depth resolved model based on an artificial neural network for estimating global phytoplankton primary production furthermore we applied two different approaches based on input perturbation analysis and on connection weights to assess the relative importance of the predictive variables finally we compared the results of our depth resolved model with a previous depth integrated solution showing that through the depth resolution we gained not only useful information on the vertical distribution of the estimated primary production but also an enhanced accuracy in its depth integrated estimates keywords marine phytoplankton primary production artificial neural networks depth resolved model 1 introduction phytoplankton primary production is a fundamental process due to its intimate relationship with oceanic biotic and abiotic processes including biogeochemical cycles especially the carbon one and earth s climate hattam et al 2015 furthermore it represents the bulk of the whole oceanic autotrophic production duarte and cebrián 1996 which contributes roughly one third of the global primary production for these reasons the assessment of phytoplankton primary production and the study of its variability both from a spatial and a temporal perspective plays a fundamental role in marine ecological studies from food webs richardson and schoeman 2004 to fisheries nixon 1988 holmlund and hammer 1999 and from large marine ecosystems to a better understanding of the relationships between fundamental and demand derived ecosystem services costanza et al 1997 cloern et al 2014 hattam et al 2015 as the direct measurement of this biological process is not only difficult but also expensive and time consuming the need for methods aimed at its indirect evaluation is evident this is especially true if the space and or time scale of a study is too large for direct measurements and obviously when the main objective is a global assessment in fact many models have been developed for the estimation of phytoplankton primary production and several among them are based on an empirical approach i e they assume that primary production can be estimated as a function of other variables platt and sathyendranath 1988 scardi 1996 morin et al 1999 some of these models are based on predictive variables that can be obtained from remote sensing of the ocean colour which is a relatively cheap source of information on a global scale while others combine information obtained from ocean circulation and biogeochemistry aumont et al 2003 buitenhuis et al 2006 these approaches provide a way to avoid long and expensive sampling procedures that would otherwise impose strict limits to the practical applications of primary production estimates clark et al 2001 low décarie et al 2014 the structure of these indirect methods widely varies in complexity also depending on the required input variables and on the nature of the relationships between those variables and the desired output for example the empirical models proposed by ryther and yentsch 1957 and smith and baker 1978 took into account only chlorophyll concentrations and irradiance while the model developed by behrenfeld and falkowski 1997 used a larger set of predictive variables although derived from chlorophyll concentration temperature and photosynthetically active radiation par the broad variety of these techniques and their utility in different fields have led to various comparisons between models over the years especially thanks to the primary productivity algorithm round robin pparr campbell et al 2002 carr et al 2006 saba et al 2011 lee et al 2015 the pparr has been useful in order to assess and compare the accuracy of different models furthermore comparisons have laid the basis for substantial improvements in this field providing a common context in which a wide range of methods has been tested in this way the main differences among models have been outlined among the various models tested in the pparr framework only one was based on an artificial neural network ann which was used to develop a depth integrated model for the evaluation of the phytoplankton primary production scardi 2001 as the ann approach to the estimation of the primary production has shown good results in comparisons with other models friedrich et al 2009 saba et al 2011 lee et al 2015 moreover if compared to other techniques anns can be easily re calibrated as soon as new data become available in fact empirical models built through this machine learning approach if correctly trained are able to reproduce the complex non linear relations that underpin most natural processes and phytoplankton primary production is no exception moreover this method does not trade generality for simplicity as it can involve complex calculations during its development training in ann jargon scardi 1996 lek et al 1996b scardi and harding 1999 scardi 2001 olden et al 2008 while the computational burden needed to develop a model is not light it only requires computational resources that are no longer a limiting factor because of advances in computing power once developed an ann model is as fast and easy to run as most other models the structure of an ann model is not defined a priori but it is determined during the training procedure in fact other types of methods try to describe analytically the major processes the primary production depends on although this can be a very difficult task especially if the objective is to build a model that is both general and accurate on the contrary the ann approach tries to learn the relationships between the input variables and the primary production directly from the available data this is a benefit not to be underestimated while dealing with natural processes that involve complex relationships which in most cases are unknown or difficult to parameterize especially on a global scale maier and dandy 2000 moreover a model based on anns or other machine learning approaches can be easily updated without rebuilding it from scratch in fact if a new data set becomes available at a later stage relative to the development of an ann model it can be easily exploited simply by performing a new training procedure for the ann without having to reinterpret the relationship between the variables given the empirical nature of the approach the advantage in using an ann as a tool for ecological modelling becomes more evident if both the heterogeneity of remote sensing information and the incomplete understanding of the causal relationships between the variables of interest are taken into account in fact this methodology does not need any a priori knowledge in order to exploit the information contained in the input variables and at the same time it is robust enough with respect to a few redundant inputs if any these properties allow the use of a wide range of predictive variables with no need for a priori knowledge about the nature of the relationship with the output of the model i e with primary production thus enhancing the potential value of any data source including remotely sensed data indeed the possibility to explore a wider range of information looking for potential input variables is a major advantage in ecological modelling especially in the light of the lack of large data set and of the difficulties in obtaining some of the desired measures from which an ann model can learn in fact primary production data sets are often incomplete especially in terms of spatial coverage some regions of the world are over represented while others are under represented or even worse not represented at all these issues may affect the model capability of generalisation and thus interfere with the modelling accuracy on a broad spatial scale lek et al 1996b maier and dandy 2000 recknagel 2001 in this context it is important to note that the performance of any kind of model is highly dependent on both the quality and the amount of available data however this is especially true for machine learning approaches in which the data drive the training procedure without any explicit mathematical formulation between the predictive variables and the targets as the phytoplankton primary production estimates are useful in several research fields such as the management of fishery resources nixon 1988 1992 conti and scardi 2010 the assessment of the ocean oxygen production reuer et al 2007 the study of climate change influences on the oceanic primary production behrenfeld et al 2006 and both the understanding and the evaluation of various ecosystem services cloern et al 2014 hattam et al 2015 holmlund and hammer 1999 richardson and schoeman 2004 melaku canu et al 2015 any improvement in the accuracy of these appraisals could be a very important achievement anns have proved to be valuable tools providing good results with respect to the modelling of biological processes and they are widely open to experimentation and optimization in data preprocessing and in model fine tuning scardi 1996 lek et al 1996b maier and dandy 2000 olden et al 2008 in this framework our main goal was the development of a model which could use the available information more efficiently to improve both the accuracy and the granularity of the primary production estimates we decided to opt for a depth resolved solution using an empirical approach based on an ann with the aim to describe not only the vertically integrated magnitude of the phytoplankton production but also its distribution along the water column we also decided to rely upon surface data only as predictive information thus assuring the widest applicability of the resulting model in fact although a depth resolved approach to the primary production evaluation using an ann was already presented by scardi 2003 that model was strictly local and mainly aimed at demonstrating the potential of the method therefore it was developed and tested on a rather limited data set thus embedding a small amount of heterogeneity and a limited set of structures of the primary production profiles on the contrary a much wider variability in vertical production profiles is one of the most challenging elements for the global phytoplankton primary production models the results of the depth resolved model we present here were compared to those of the depth integrated ann model developed by scardi 2001 the two models share the same computational method and the same spatial scale while the data set upon which they were trained coincide almost completely therefore their comparison can show if an enhancement in the accuracy of primary production estimates can be achieved through a depth resolved approach and appropriate data management and preprocessing 2 materials and methods 2 1 data preprocessing and partitioning the data set used in this study includes 3304 vertical profiles of phytoplankton primary production that were acquired during oceanographic cruises carried out from 1954 to 1994 which have been obtained from http www science oregonstate edu ocean productivity field data c14 online php the bulk of the sampling stations was located in three regions the first one and the most represented corresponds to the north western atlantic off the coast of the united states while the second one is situated in the eastern equatorial pacific off the western coast of south america and the last one is off the west coast of the united states the remaining part of the world oceans hosts only a few sparse stations but their scarcity makes the information obtained from them even more relevant since anns are strongly empirical tools it is important to note that the model presented in this work was validated only within regions where enough data were available fig 1 and therefore it is not meant to be used elsewhere although the spatial coverage of the data set was not uniform at global scale and consequently some regions of the ocean are either underrepresented or missing these data were chosen because they have been used in the development of most primary production models thus favouring comparisons between them this allowed to highlight their properties rather than the quality and quantity of the data that supported them moreover this data set is undoubtedly the most complete among the ones freely accessible from the scientific community in spite of the fact that autotrophic production measurements are expensive and rarely available since the aim of our work was the estimation of daily phytoplankton primary production our attention was focused on the primary production data measured using 14c assimilation in simulated in situ sunlight incubations and expressed as mg c m 3 day 1 in fact this type of measurements represents the bulk of the available data about the marine primary production process furthermore among the variables collected during the cruises we also used the surface chlorophyll a concentration obtained by standard fluorometric methods the surface downwelling irradiance determined by mean of a quantum sensor and the sea surface temperature evaluated by an immersion probe those surface variables in addition to date as well as latitude and longitude of the sampling stations were selected as inputs i e as predictive variables to an ann aimed at predicting primary production in order to make the information conveyed by sampling date and station longitude directly exploitable by the ann a trigonometric transformation was applied generating four derived variables two for the date and two for the longitude using sine and cosine components for those variables allowed to map date and longitude on a circle where the difference between january 1st and december 31st for instance is not 365 days but only one all the requested information excluding primary production which is the variable to be modelled can be easily obtained from remote sensing thus allowing the model to be used with no need for expensive and time consuming field data acquisition the choice of the predictive variables was obviously supported by theoretical knowledge about the modelled biological process by the results presented in previous studies on the same topic and by the need to build a model on the basis of remotely sensed variables only maier and dandy 2000 as for the quality of the data set it has not been taken for granted that all data were unbiased and or already screened for biologically inconsistent profiles kaastra and boyd 1995 accordingly all the phytoplankton primary production profiles passed through a preprocessing stage in order to assess their ecological soundness and to filter out those showing an erratic structure or too many missing data the production to biomass ratio p b was one of the main features that were examined using the chlorophyll a concentration as a measure for biomass in fact we only selected vertical profiles that were consistent with a plausible range of this ratio roughly from 30 to 60 while extremely low or high values were assumed to be incorrect or exceptionally rare and therefore to be excluded from the data set as anns learn from examples data patterns too unlikely to be found in real world conditions could mislead the learning procedure especially in an ann based model that aimed at the maximum degree of generalization i e to be applied at global scale moreover the vertical distribution of phytoplankton production values along the water column was also checked from an ecological perspective for instance profiles that showed more than a single maximum e g two spikes were excluded the rationale behind this exclusion was the assumption that such profiles were either the result of sampling error or represented a transition phase in the water column from a stable state to a different one and in both cases they would not be useful to support the development of a general model furthermore the values of variables that drive the primary production were carefully validated especially surface sea temperature and surface irradiance all the above mentioned features were obviously evaluated while taking into account the spatio temporal context in which they were measured as for the missing data a significant effort has been devoted to the problem accordingly external data sets regarding sea surface temperature were accessed in order to fill the information gaps or check questionable values for consistency data retrieved from http neo sci gsfc nasa gov view php datasetid myd28m interpolation of existing data has been carried out whenever possible in order to fill the gaps by recovering information from the same profile or from a set of related profiles this was the only approach we used for missing irradiance data the preprocessing procedure played a fundamental role because of two reasons the first one was related to the ecological soundness of the model output in fact if biased profiles had not been excluded from the data set used for model development the training procedure would have been negatively affected by them the second reason was related to the scarcity of data supporting modelling activities efforts were made to recover missing information e g surface temperature from external sources or to assess missing data e g by interpolation whenever possible production profiles in the original data set were all based on discrete measurements performed at optical depths i e at depths that changed from profile to profile in order to adapt those data to the structure of the ann where each output corresponded to the primary production estimate at a fixed depth the observed primary production profiles were modified to be represented by the same depths along the water column accordingly the primary production values at six fixed depths namely 0 m 5 m 10 m 20 m 40 m and 60 m were obtained by computing the weighted average between the immediately upper and lower sampling points with respect to the desired depth obviously the weight of each sampling point in determining the fixed depth value was the depth difference between the sampling point and the desired fixed depth it is important to note that when a fixed depth was deeper than the last sampling point in the production profile i e to the deepest optical depth null production was assumed the rationale behind this choice was that the last value in each profile was associated with the 1 of the surface irradiance then no net production was expected below this threshold the last data preprocessing stage was aimed at balancing the information provided by the data set in fact most data were collected in the north western atlantic and therefore the majority of the examples available to the ann came from a rather homogenous region several virtual observations n 888 have been therefore added to the data set simply by duplicating profiles in underrepresented regions and perturbing them with a small amount of gaussian noise i e 0 05 0 05 to avoid exact duplicates thanks to this procedure the amount of information coming from regions where data are scanty has been artificially increased thus improving the efficiency of the ann learning scardi and tancioni 2007 after the preprocessing stage the final data set comprised of 3087 profiles 28 of which were the abovementioned virtual observations with six fixed depths was split into three subsets the first one included the majority of the data n 1852 i e about 60 and was aimed at training the ann while the second and third ones respectively the validation set and the test set accounted for about 20 of the data each nval 618 ntest 617 the training set contained the examples to be passed to the ann during the training procedure which allowed the ann to learn the scheme underlying the modelled process thus implicitly embedding all the relevant relationships between predictive variables and primary production the validation set controlled the duration of the training phase stopping it as soon as the validation error started increasing i e as soon as the ann was not able to learn the general scheme and showed the first signs of overfitting thus losing generality the test set which obviously was never passed to the ann during the training phase was used to evaluate the performance of the trained ann and to compare its results with those provided by a previous ann model scardi 2001 the three data subsets were not obtained by random selection of the primary production profiles in order to obtained balanced subsets the available profiles were sorted according to their geographic position date and magnitude of the vertically integrated primary production subsequently the second record in each group of five was assigned to the validation set whereas the fourth record was assigned to the test set and the remaining ones to the training set this way we obtained three data subsets sharing as much variability as possible finally the whole data set was normalized by scaling it into the 0 03 0 97 interval values too close to 0 or 1 were excluded to speed up the learning process by avoiding the tails of the sigmoid activation function moreover primary production data have been log transformed in order to reduce the relative importance of the largest primary production values in the training procedure such transformation was not strictly needed as the ann can learn and mimic any non linear relationship but it helped to compute the ann error relative to a log scale thus reducing the weight of the error associated with the highest production values in fact the results of empirical tests confirmed those reported by scardi harding 1999 and scardi 2001 supporting the need for log transformation of the primary production values because anns trained with raw data for primary production did not perform as well as those trained with log transformed data 2 2 artificial neural network training we developed all the software needed for training and testing the ann in fortran 90 and compiled the source code with the gfortran 4 10 0 compiler the abovementioned programs are available on request the ann we trained was a multilayer perceptron with eight input neurons a single hidden layer and six output neurons which returned primary production estimates at six fixed depths the main reason for the choice of this kind of neural network were the good results showed in previous studies e g scardi 1996 2003 moreover it grants a valuable level of flexibility especially when non linear but continuous relationships are to be modelled the sigmoid activation function f a 1 1 e a was chosen both for the hidden and the output layer while the error back propagation algorithm rumelhart et al 1986 has been used to optimize the synaptic weights as the model was aimed at global scale applications the maximum degree of generalisation was certainly the most important feature to be optimized smith 1994 therefore several techniques have been applied to achieve this goal accordingly a small amount of gaussian noise μ 0 σ 0 01 has been added to each input variable before its values were passed to the neural network during the training phase györgyi 1990 this useful method known as jittering helped by creating an infinite number of patterns very similar albeit not equal to the original ones all associated with the same biological response this way the training is focused on the learning of general relationships rather than on the memorization of patterns moreover only a randomly chosen subset including 50 of the patterns in the whole training set has been passed to the ann at each training epoch in order to minimise the probability of memorization of the training patterns depending on their order furthermore an early stopping strategy has been used to stop the training procedure the criterion used for the early stopping was the minimization of the mean square error mse relative to the validation set the validation set mse has been computed simultaneously with the training set one initially both the types of error decrease until the validation set mse starts to increase while the training set mse keeps decreasing this procedure allows stopping the training before the ann configuration becomes too specifically tailored on the training patterns thus losing the needed generality the ann training was repeated several times trying different values for learning rate and momentum and selecting the set of synaptic weights that allowed obtaining the smallest mse relative to the validation set the number of neurons in the ann hidden layer was determined according to several evaluation criteria empirical tests have been carried out trying different solutions i e by varying the number of hidden neurons from a half to the double of the input neurons number i e from 4 to 16 and by evaluating the ann performance relative to both the vertically resolved and the vertically integrated primary production estimates moreover the error distributions obtained from each ann architecture were analysed to find out whether they were affected by systematic bias the architecture with 11 nodes in the hidden layer was eventually chosen as the most performing it is important to note that as long as we used at least 11 neurons in the hidden layer the differences between different ann architectures were negligible this outcome was certainly favoured by the integration of a validation routine in the training procedure and by the relatively small number of synaptic weights to be optimized if compared to the large number of available training patterns smith 1994 lek and guégan 1999 olden et al 2004 2 3 model performance assessment once the training procedure was completed the ann performance was evaluated using the test set the primary production values predicted at each depth were compared to the known target values and mse and the determination coefficient r2 were computed as for the mse it could be compared across different anns because it was computed on normalized data deviations from target values were also analysed to check whether the ann estimates were unbiased i e symmetrically distributed around the zero finally the akaike information criterion aic akaike 1973 and the total root mean square difference rmsd were computed to compare the vertically resolved ann model to a vertically integrated ann model scardi 2001 while the first two indices were adequate to compare outputs from the same model aic allowed taking into account model complexity while comparing the results provided by different models 3 results discussion as previously stated the choice of an ann approach has been mainly guided by the desire to develop an empirical model and by the good results already obtained using this machine learning technique in phytoplankton primary production modelling scardi 1996 2001 scardi and harding 1999 the performance of the ann model was analysed both at each modelled depth and after vertical integration moreover we explored the behaviour of the ann model and the role each predictive variable played by means of both the perturbation analysis scardi and harding 1999 and the connection weights approach olden et al 2004 finally we compared the depth resolved ann model with the older depth integrated model based on the same type of ann and on a similar set of predictive variables scardi 2001 3 1 model performance the overall performance of the ann model in estimating the primary production was assessed in relation to the test set only i e to data that were never used to train or validate the ann as showed in fig 2 a the major axis of the cloud of points representing the overall comparison between observed and predicted values closely matched the unit slope line thus indicating a very good agreement fig 2a furthermore deviations from the unit slope line were symmetrically distributed around the zero the overall mse for the test set was quite small mse 0 008 while the ann model was able to explain more than 80 of the primary production variance r2 0 819 while the overall agreement between observed and modelled values was very good the error distribution of the modelled values was also taken into account to fully evaluate the quality of the estimates as expected from the scatter plot in fig 2a the mean of the deviations from the observed values was close to zero 0 002 mg c m 3 day 1 the resulting error distribution was therefore unbiased and clearly symmetrical fig 2b finally the 5th and the 95th percentiles were computed in order to highlight the range in which 90 of the errors was found the range was 0 46 0 46 in log units which corresponded to 40 8 16 4 mg c m 3 day 1 in raw data units although it might sound obvious it should be stressed that a depth resolved model can provide more information than a vertically integrated one as it allows to get an insight into the distribution of the production along the water column while our depth resolved model was actually a partly resolved model as it only took into account six fixed depths we analysed the model performance at each one of those depths we found that the model performance expressed as determination coefficient was not homogeneous along the water column the maximum level of explained variance r2 0 816 was achieved at 5 m the observed vs modelled plot showed only a limited scattering around the unit slope line and the associated histogram of the error distribution was the most symmetrical and leptokurtic among all the modelled depths fig 3c d on the contrary the minimum value r2 0 331 was associated with the 20 m depth in fact the dispersion around the unit slope line in the scatter plot showing modelled vs observed data at 20 m was wider than in those for all the others depths fig 4a at this depth the model seemed to slightly underestimate the observed production as clearly shown in the histogram in fig 4b from a more general perspective all the depth specific error distributions were nearly symmetrical and their means fell in the 0 028 0 03 interval thus showing that even the largest deviation i e potentially systematic bias was still negligible i e not exceeding 3 of the normalized output range while histograms were certainly useful to show how the errors are distributed the observed vs modelled values scatterplots conveyed more information about the concordance between the neural network output and the target i e observed values in particular they showed very clearly how the range of observed primary production values became narrower as depth increased the modelled values obviously followed the same trend while the dispersion around the unit slope lines became wider and less symmetrical with a tendency to underestimation not only at 20 m but also at deeper depths as the ann learned from the available data patterns the reduced variability in primary production made the learning process harder more or less in the same way it would have affected the fitting of a line to a set of data points arranged in a quasi circular pattern the same amount of uncertainty in data values if associated with a wider range of values would have certainly allowed a better fit independently of the modelling method the reduction in accuracy of the estimates with depth had also other explanations from a general perspective by using only remotely sensed and therefore quasi surface predictors the deeper estimates were inherently less reliable than the shallower ones this feature was certainly due to the weakened causal or correlational link between the input values and the model output saba et al 2010 on the other hand it is important to stress that the neural network training was driven by mse optimisation consequently the largest primary production values superficial and obviously associated with potentially larger errors had certainly a larger influence on the training procedure while the logarithmic transformation to the target values helped to reduce the effects of this problem the resulting bias could not be completely removed however it is important to note that the higher accuracy with respect to the shallower depths i e 0 m 10 m is an important feature in fact in the utilized data set on average the 49 of the production in each profile was confined within the very upper part of the water column this is not surprising as shallower depths receive a higher level of irradiance which is a strong driver of primary production and in coastal zones the upper layers are also richer in nutrients while the efficiency of a depth resolved ann model was already demonstrated at local spatial scale by scardi 2003 our results showed that the same approach could be successfully applied at global spatial scale 3 2 sensitivity analysis in order to gain a deeper insight into the ann model we chose two among the most reliable techniques to assess the relative importance of the predictive variables in anns dimopoulos et al 1995 lek et al 1996a scardi and harding 1999 olden and jackson 2002 gevrey et al 2003 the first method was the input perturbation analysis scardi and harding 1999 which was used in previous ann models of phytoplankton primary production scardi 2001 2003 the second assessment was performed by the connection weight approach olden and jackson 2002 olden et al 2004 which is not to be regarded as a true sensitivity analysis although it gained an increasing popularity in the ecological modelling field as a method for analysing the relative importance of input variables in anns according to the perturbation procedure an increasing amount of white noise was added to the values of each predictive variable while those of the other variables were not altered the resulting changes in mse were then plotted against the perturbation level fig 5 the chlorophyll surface concentration proved to be the most important predictive variable producing relatively large changes in mse even at low perturbation levels this was not a surprising result because of the very strong link between this pigment and the phytoplankton biomass which in turn is both the cause and the effect of phytoplankton primary production the second variable in terms of importance was the longitude which played an important role as a proxy for the complex oceanographic differences between large marine ecosystems for instance longitude could be used by the ann model to trigger different behaviours in different oceans or in different regions of the same basin latitude and surface temperature played similar roles since as they are strong drivers of seasonality this was not surprising as they were both related to climate and conveyed information about the potential structure and dynamics of the water column from a more general perspective the geographic position had an important role as a proxy for variables that were possibly relevant but which were not available or not accessible through remote sensing and consequently not used by the ann model e g nutrient availability the low overall weight of the irradiance could seem unnatural in relation to its importance in the photosynthetic process however only surface values for this variable were available to the ann and they were synchronous with those for other variables while light attenuation with depth could be implicitly considered by the ann the lack of information about short term changes in irradiance probably weakened the relationship between irradiance and the primary production measured at the sampling time because photoadaptation was not taken into account in fact the phytoplankton production at a given time might be affected by the irradiance level to which the organisms were exposed before the measurement moreover the neural network could indirectly obtain information about the available irradiance levels also from other predictors such as date and latitude while some predictive variables might seem to play a very minor role in our sensitivity analysis they still contribute to the overall model performance in fact the exclusion of surface irradiance and date from model inputs caused a 2 overall reduction in explained variance and as much as 10 in the 20 m predictions it is important to note that the most interesting portion of the sensitivity analysis graph was the one that showed the effects of intermediate levels of noise addition while the largest perturbation level might have induced values that would be very unlikely to be found in conjunction with the real values of the unperturbed variables the lowest perturbation levels acted in the same range as all the intrinsic sources of error associated with field measurements and with the estimation process consequently intermediate levels of perturbation more closely matched the true sensitivity of the model to ecologically sound changes in its inputs which could actually occur in real world conditions additionally a noteworthy feature of the sensitivity graph was the quasi linearity of the mse response to increasing levels of noise and the robustness of the model to low levels of noise which are certainly to be regarded as a strength of the ann model in fact the uncertainty in field measurements of primary production is a major issue in the development of a good estimator friedrich et al 2009 saba et al 2010 2011 in this context we believe that empirical models including anns should not be too sensitive with respect to small changes in the input values in order to avoid erratic behaviours or overreactions to small changes in their inputs as the latter could be affected by substantial errors accordingly several techniques were used to maximize the generalization capabilities of the model i e jittering early stopping and training for patterns in order to develop a model which can be both general and robust at a global scale as to the connection weight approach olden et al 2004 its results seem to be consistent with those obtained from the input perturbation analysis fig 6 in fact the chlorophyll surface concentration remains the most important variable moreover the additional information provided by this method through the sign of the relation between the chlorophyll surface concentration and the outputs seems to be consistent from an ecological perspective indeed the inhibitory effect showed by this variable on deep primary production i e on the last two outputs of the model namely 40 and 60 m can mirror a lower water column transparency caused by higher values of chlorophyll at shallower depths which cause the light profile to decay more rapidly however we had several reservations with regard to this approach as its results in some cases did not seem fully consistent with each other the first doubt arose from the significant differences in terms of sign and magnitude showed by the two variables obtained by trigonometric transformation of both date and longitude in fact we expected that the two inputs obtained by transforming the same variable had a similar importance in determining the ann output as in the perturbation analysis a second problem emerged in relation to the peculiar nature of our data set since several cruises were carried out in the same areas but at different times therefore they present similar if not identical geographical coordinates associated with a large variability in both the inputs and outputs of the model consequently evaluating the importance of the geographic position by relying only on the information conveyed by the ann weights could be misleading therefore the input perturbation method which assessed the role of each ann input variable in the context of the observed values of the other ones seemed more reliable from an ecological viewpoint 3 3 comparison with a depth integrated model the benefits of a depth resolved modelling strategy are twofold in fact it could provide not only an insight into the primary production distribution along the water column but also an enhancement in the accuracy of the estimates for this process when they are integrated vertically while depth resolved models have obvious practical advantages depth integrated primary production estimates are relevant to a wide range of applications and play a fundamental role in the study of marine ecosystem functioning in order to verify the above mentioned improvement in the assessment of the depth integrated primary production through a depth resolved approach a comparison between the ann model we developed and the one presented by scardi 2001 was carried out the latter model was depth integrated but largely based on the same data set although with a slightly different preprocessing and therefore it could be regarded as the most appropriate benchmark the comparison was obviously carried out on the test set only and the estimates for the depth integrated primary production values were obtained from both models and transformed from log to raw units before any further data processing the older ann model directly returned the depth integrated value for any input vector of predictive variables while as already mentioned the ann model presented here returned six values corresponding to the primary production estimates at six fixed depths therefore a trapezoidal integration had to be applied to each set of output values in order to obtain depth integrated production estimates subsequently the outputs from both models were compared to the observed values from the test set and the agreement between them was analysed accordingly r2 mse and rmsd were computed in order to assess the performance of each model and to compare the quality of their respective results the latter performance indicator which was the only one computed on a logarithmic scale was used to compare the performance of our model to others tested in the pparr framework e g in the model comparison presented by saba et al 2011 in addition the aic was also computed in order to take explicitly into account the model complexity in the comparison the depth resolved ann model proved to be a more accurate estimator showing better performance indicators than its vertically integrated counterpart fig 7 r2 0 617 mse 247775 rmsd 0 254 aic 3664 and r2 0 494 mse 418719 rmsd 0 323 aic 3832 respectively in fact the cloud of points in the observed vs estimated scatter plot for the depth resolved model was more concentrated around the unit slope line compared to the depth integrated one this feature was the visual representation of the accuracy gain expressed by the higher determination coefficient associated with the depth resolved ann model which explained almost 12 more variance the error distributions associated with the two models were plotted side by side in fig 8 in order to highlight the differences between them even though both error distributions were symmetrical a larger share of errors was associated with the two central bins from 150 to 150 mg c m 2 day 1 in the depth resolved model relative to the depth integrated one and they included 48 and 36 of the cases respectively moreover the slight tendency to underestimate the primary production showed by the larger number of negative differences was less pronounced in the depth resolved model accordingly the mean depth resolved error was closer to zero than the depth integrated one 55 48 mg c m 2 day 1 vs 176 92 mg c m 2 day 1 furthermore the 5th and 95th percentiles values showed that 90 errors were in the 946 2 410 2 mg c m 2 day 1 range for the depth resolved model while the depth integrated one showed a wider range 1102 1 575 6 the comparison between the two models showed that the depth resolved approach allowed to obtain better depth integrated phytoplankton estimates of primary production than the vertically integrated ann model presented by scardi 2001 in fact not only it granted deeper insights into the distribution of the autotrophic production along the water column but it also allowed using a larger number of data patterns for the model development i e for training the ann while both types of model only used predictive data obtained from surface measurements a depth integrated approach relied on a single primary production value for the whole water column whereas a depth resolved approach relied upon every bit of primary production information available along the water column it is worth stressing that a further gain in accuracy could have been achieved by using data about the predictive variables collected at all the sampling depths instead of surface data only however we decided to use exclusively surface data as predictors even at the cost of some accuracy in order to make the model compatible with applications based on remotely sensed data only thus enhancing its practical value moreover the vertical resolution of the model although discrete i e based on six fixed depths allowed to compute separate errors at each depth while the integrated model only provided an overall error relative to the whole water column as for the vertical resolution it also allowed the training of the ann model to take advantage of the non independence caused by spatial autocorrelation between primary production values at different fixed depths in fact the different shapes of phytoplankton production profiles are not infinite and therefore by associating six outputs i e different depths to each set of input values we tried to embed functional constraints into the ann model in other words we obtained an ann model with a more complex output relative to a vertically integrated solution supported by the implicit autocorrelation in primary production values along the water column this solution led to a reduced variability in the modelled process based on features captured from the data during the training phase however it is important to note that the majority of the phytoplankton primary production models involved in comparisons was developed following a mechanistic approach campbell et al 2002 carr et al 2006 friedrich et al 2009 saba et al 2010 saba et al 2011 lee et al 2015 consequently their purpose is twofold the first one is obviously the estimation of primary production while the second is related to the understanding of the modelled process which relies upon its translation into several explicit and adequately parameterized relationships it should be pointed out that aiming at two goals at the same time can lead to either a loss in accuracy of the model or to inconsistencies between the real processes and their translation into model subcomponents on the other hand an empiric modelling approach is less ambitious in terms of comprehension of the modelled process as its only purpose is to achieve the maximum accuracy in the estimates maier and dandy 2000 from this viewpoint it can be proved that an ann with only one hidden layer comprised of enough nodes and given an adequate data set can approximate any function with an arbitrary level of accuracy hornik et al 1989 while anns may appear as black boxes from the modeler s viewpoint many efforts have been made to get useful insights into them i e to retrieve at least part of what they learned from the data several post training analyses were proposed to tackle the previously mentioned problem and some of them showed good results thus improving the potentiality of this machine learning approach olden and jackson 2002 olden et al 2004 gevrey et al 2003 the sensitivity analysis based on input perturbation although not the most popular is certainly the most straightforward and the only one that was already applied to ann models of phytoplankton primary production according to olden et al 2004 it can be regarded as second best relative to the method they proposed based on ann weights but the problem we mentioned about partly invariant data patterns in our opinion limited its reliability finally it ought to be noted that the integrated model used as a benchmark for this study has already been part of the above mentioned comparisons between models performing fairly well therefore on the basis of the results we obtained we are confident that the depth resolved ann model can outperform its integrated counterpart also in a wider comparison framework 4 conclusions our results showed that a depth resolved ann model can be very useful not only to predict vertical profiles of phytoplankton primary production but also to obtain better depth integrated estimates in fact it explained roughly 12 more variance than its vertically integrated counterpart and the increase in complexity of the ann structure was justified by the gain in accuracy as shown by the aic the main reason for the improvement in primary production estimates was a more efficient exploitation of the available data brought firstly by the increase in the number of useful training data patterns and secondly by an indirect exploitation of the autocorrelation between primary production values at different depths i e by the fact that they are obviously not entirely independent from each other better primary production estimates are of paramount importance not only to pure oceanographic research but also to other applications as for instance those relating primary production to fundamental and demand derived ecosystem services or to climate change holmlund and hammer 1999 richardson and schoeman 2004 moreover our work is another example of the potential of anns and from a more general viewpoint of machine learning methods in ecological modelling as a matter of fact these approaches do not require an explicit formulation of the relationships between the available variables as they are able to learn them directly from the data this is a key feature in modelling complex natural processes because it allows using a wide array of predictive variables including all those that are available through remote sensing even in case theoretical knowledge is uncertain or incomplete i e even in case the mechanistic relationships underlying the modelled process are not fully understood the strict dependence of an ann model on both the amount and quality of available information can be limiting in data poor situations but it definitely leaves extensive room for improvement as soon as new data are acquired it is not surprising therefore that the application of anns and other machine learning techniques to ecological modelling has gained significant momentum in the last two decades appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 05 003 appendix a supplementary data the following are supplementary data to this article 
25277,ecological network analysis williams and crouthamel unpublished here the model is shown in both its diagram redrawn from ulanowicz 1986 a and matrix b representations the flow matrix f nxn is oriented from row to column i j the inputs z exports e respirations r and storage or biomass x values are shown as separate vectors the living vector has logical values true or false that indicted whether the corresponding node is living which is an important distinction for some ena algorithms such as mixed trophic impacts fig 1 fig 2 organizing framework for ecological network analyses the core analyses can be grouped into three related areas based on their emphasis structure topology flow geometry and storage i e biomass analyses each of which includes both input and output oriented methods three groups of analyses build on the core analyses including the environ control and impact analyses encompassing both utility analysis and mixed trophic analysis fig 2 fig 3 information flow for ena publication identification and selection adapted from the preferred reporting items for systematic reviews and meta analyses prisma guidelines fig 3 fig 4 publication a and source b frequency in the 2010 2016 corpus of ecological network analysis publications fig 4 fig 5 contour plot of the topic network in which nodes are papers and network edges indicate a co term similarity peaks indicate topic clusters which are labeled with cluster numbers and descriptive terms selected author names were placed at the centroid of the papers they authored greater detail about each cluster can be found in tables 1 and 2 fig 5 fig 6 coauthorship network for the ecological network analysis publications from 2010 through 2016 in this network model nodes are authors and edges indicate the number of coauthored publications fig 6 fig 7 geography of ecological network analysis publications from 2010 to 2016 showing the number of publications by authors in each country along with the number of collaborations fig 7 fig 8 number of ecological network analysis papers that introduced a new model each year classified by system type fig 8 table 1 most common authors in eight topic clusters of ecological network analysis inferred from 186 publications from 2010 through 2016 table 1 author cluster total 1 food webs ecosystems 2 species loss 3 flow sustainability 4 security 5 systems ecology ecosystems 6 risk assessment 7 energy urban metabolism 8 wetland water systems bin chen 5 x x x x x brian fath 5 x x x x x meirong su 4 x x x x zhifeng yang 4 x x x x yan zhang 3 x x x shaoquing chen 3 x x x gengyuan liu 2 x x stuart borrett 2 x x aurelie chaalali 1 x blanche saint béat 1 x daniel baird 1 x geraldine lassalle 1 x harald asmus 1 x jeremy lobry 1 x johanna jacomina heymans 1 x nathalie niquil 1 x ragnhild asmus 1 x samuele tecchio 1 x gaston e small 1 x jacques c finlay 1 x jiang zhang 1 x lingfei wu 1 x robert w sterner 1 x ali zharrazi 1 x antonio bodini 1 x mingqi zhang 1 x weiwei lu 1 x yan hao 1 x ying fan 1 x andria salas 1 x bernard patten 1 x caner kazanci 1 x david hines 1 x ge ying 1 x michael freeze 1 x jie chang 1 x qianqian ma 1 x stuart whipple 1 x guillaume junqua 1 x roux philippe 1 x loiseau eleonore 1 x veronique bellon maurel 1 x hong liu 1 x hongmei zheng 1 x shengsheng li 1 x yanxian li 1 x delin fang 1 x he chen 1 x honghan chen 1 x lijuan cui 1 x ursula m scharler 1 x xufeng mao 1 x total 10 5 10 10 10 8 9 10 unique 100 100 20 40 90 50 44 60 table 2 commonly cited references in eight ecological network analysis topic clusters discovered in 186 publications from 2010 through 2016 table 2 title citation total 1 food webs ecosystems 2 species loss 3 flow sustainability 4 security 5 systems ecology ecosystems 6 risk assessment 7 energy urban metabolism 8 wetland water systems review of the foundations of network environ analysis fath and patten 1999 6 x x x x x x growth and development ecosystems phenomenology ulanowicz 1986 3 x x x ecological network analysis network construction fath et al 2007 3 x x x ecological network analysis of an urban water metabolic system model development and a case study for beijing zhang et al 2010a 3 x x x the strategy of ecosystem development odum 1969 2 x x quantitative methods for ecological network analysis ulanowicz 2004 2 x x the comparative ecology of six marine ecosystems baird et al 1991 2 x x measures of ecosystem structure and function derived from analysis of flows finn 1976 2 x x ecological network analysis of an urban energy metabolic system model development and a case study of four chinese cities zhang et al 2010b 2 x x a matlab function for network environ analysis fath and borrett 2006 2 x x the structure of ecosystems hannon 1973 2 x x towards a sustainable use of water resources a whole ecosystem approach using network analysis bodini and bondavalli 2002 2 x x comparative study on the trophic structure cycling and ecosystem properties of four tidal estuaries baird and ulanowicz 1993 1 x ecopath ii a software for balancing steady state ecosystem models and calculating network characteristics christensen and pauly 1992 1 x ecosystem maturity towards quantification christensen 1995 1 x ecopath with ecosim methods capabilities and limitations christensen and walters 2004 1 x food web dynamics in the ocean i best estimates of flow networks using inverse methods vézina and platt 1988 1 x wand an ecological network analysis user friendly tool allesina and bondavalli 2004 1 x quantifying the sustainability of economic resource networks an ecological information based approach ulanowicz et al 2009 1 x an hypothesis on the development of natural communities ulanowicz 1980 1 x quantifying sustainability resilience efficiency and the return of information theory ulanowicz et al 2009 1 x civil unrest in north africa risks for natural gas supply lochner and dieckhöner 2012 1 x symmetrical overhead in flow networks ulanowicz and norden 1990 1 x liberalisation and the security of gas supply in the uk wright 2005 1 x the seasonal dynamics of the chesapeake bay ecosystem baird and ulanowicz 1989 1 x analysis of energy flows in an intertidal oyster reef dame and patten 1981 1 x flow analysis of models of the hubbard brook ecosystem finn 1980 1 x dominance of indirect causality in ecosystems higashi and patten 1989 1 x systems approach to the concept of environment patten 1978 1 x an ecosystem model for assessing ecological risks in québec rivers lakes and reservoirs bartell et al 1999 1 x ecological network analyses and their use for establishing reference domain in functional assessment of an estuary christian et al 2009 1 x effects of nutrient recycling and food chain length on resilience deangelis et al 1989 1 x network analysis in perspective comments on wand an ecological network analysis user friendly tool fath 2004b 1 x estimating ecosystem risks using cross validated multiple regression and cross validated holographic neural networks findlay and zheng 1999 1 x risk uncertainty in risk and the epa release limits for radioactive waste disposal helton 1993 1 x application of bayesian network to the probabilistic risk assessment of nuclear waste disposal lee and lee 2006 1 x probe into the method of regional ecological risk assessment a case study of wetland in the yellow river delta in china xu et al 2004 1 x applying ecological input output flow analysis to material flows in industrial systems part i tracing flows bailey et al 2004 1 x network synergism emergence of positive relations in ecological systems fath and patten 1998 1 x the metabolism of cities wolman 1965 1 x ecological network and emergy analysis of urban metabolic systems model development and a case study of four chinese cities zhang et al 2009 1 x network mutualism positive community level relations in ecosystems fath 2007 1 x ecological network analysis for water use systems a case study of the yellow river basin li et al 2009 1 x quantifying the sustainability of water use systems calculating the balance between network efficiency and resilience li and yang 2011 1 x the water environs of okefenokee swamp an application of static linear environ analysis patten and matis 1982 1 x indirect effects and distributed control in ecosystems distributed control in the environ networks of a seven compartment model of nitrogen flow in the neuse river estuary usa steady state analysis schramski et al 2006 1 x indirect effects and distributed control in ecosystems distributed control in the environ networks of a seven compartment model of nitrogen flow in the neuse river estuary usa time series analysis schramski et al 2007 1 x 9 0 10 7 10 10 10 10 56 40 43 50 80 40 60 table 3 number of publications that performed selected categories of ecological network analyses by system category table 3 ena type food web biogeochemical cycling urban industrial economic hydrologic agroecosystem other total n 71 n 63 n 7 n 2 n 43 n 186 structure 50 70 43 68 7 100 1 50 5 12 106 57 flow input output 58 82 26 41 4 57 2 100 8 19 98 53 flow information a 42 59 14 22 5 71 2 100 4 9 67 36 storage 8 11 1 14 2 5 11 6 utility or mixed trophic impacts 12 17 35 56 3 43 2 5 49 26 control 1 1 10 16 2 29 13 7 environ 7 10 1 2 1 14 9 5 sensitivity or uncertainty analysis 25 35 4 6 4 9 33 18 a includes calculation of information based metrics like ascendency overhead capacity derived ratios and robustness review bibliometric review of ecological network analysis 2010 2016 stuart r borrett a b laura sheble b c james moody b d evan c anway a a department of biology and marine biology and center for marine science university of north carolina wilmington wilmington nc 28403 united states department of biology and marine biology and center for marine science university of north carolina wilmington wilmington nc 28403 united states b duke network analysis center social science research institute duke university durham nc 27708 united states duke network analysis center social science research institute duke university durham nc 27708 united states c school of information sciences wayne state university detroit mi 48202 united states school of information sciences wayne state university detroit mi 48202 united states d department of sociology duke university durham nc 27708 united states department of sociology duke university durham nc 27708 united states corresponding author at department of biology and marine biology university of north carolina wilmington wilmington nc 28403 united states department of biology and marine biology university of north carolina wilmington wilmington nc 28403 united states ecological network analysis ena combines modeling and analysis used to investigate the structure function and evolution of ecosystems and other complex systems ena is applied to network models that trace the movement of thermodynamically conserved energy or matter through the system investigators use ena to answer a range of questions such as the following what is the impact of fishing on the marine food web which species control the flux of nitrogen in an estuary what is the ecological relationship among species in the food web when direct and indirect influences are considered would a proposed regulation make a city more sustainable the field has grown since its inception in the 1970s but it has rarely been systematically reviewed this absence of reviews likely hinders the development of the field as a whole obscures the diversity of its applications and makes it difficult for new investigators to learn develop and apply the techniques the objective of the work presented in this paper was to systematically review ena research published in 2010 through 2016 to 1 identify the topic diversity 2 expose methodological development 3 highlight applications and 4 assess collaboration among ena scholars to accomplish this we used a combination of bibliometric network e g social network and feature analyses our search identified 186 records a topic network built from the bibliographic records revealed eight major topic clusters the largest groups centered on food webs urban metabolism and ecosystem theory co author analysis identified 387 authors in a collaboration network with eight larger components the largest component contained 56 of the authors this review shows ena to be a topically diverse and collaborative science domain and suggests opportunities to further develop ena to better address issues in theoretical ecology and for environmental impact assessment and management keywords ecosystem social network analysis scientometrics food web biogeochemical cycling urban metabolism network science materials flow analysis 1 introduction ecological network analysis ena is used to investigate ecosystem structure and functioning hannon 1973 jørgensen 2007 patten et al 1976 ulanowicz 1986 and is one component of the broader field of network ecology borrett et al 2014 proulx et al 2005 ena techniques have been applied to characterize food web organization baird et al 1998 bondavalli and ulanowicz 1999 pezy et al 2017 rakshit et al 2017 assess ecosystem maturity or status christensen 1995 ulanowicz 1980 trace biogeochemical cycling in ecosystems christian and thomas 2003 small et al 2014 and characterize the sustainability of urban metabolisms and other socio ecological systems fan et al 2017 zhang 2013 zhang et al 2009 responding to the need for ecosystem based management and recognizing the ability of ena to characterize the whole ecosystem multiple papers have called for the increased use of ena to guide ecosystem assessment and management dame and christian 2006 de jonge et al 2012 longo et al 2015 zhang 2013 this push includes the use of ena system metrics as indicators of good environmental status in the eu marine strategy framework directive european parliament and council of the european union 2008 to prepare for this anticipated increase in ena applications for environmental decision making to help advance the field and to better enable new investigators to learn develop and apply the ena approach we reviewed publications in the field between 2010 and 2016 ena studies are distinguished from other types of network analyses in ecology by both the type of network model used and the collection of analyses applied to interrogate the system in ena the network model follows the flow of energy or nutrients through the ecosystem fath et al 2007 hannon 1973 wulff et al 1989 these models use a single thermodynamically conserved tracer so that the networks function like resource distribution maps network nodes represent species functional groups or non living resource pools and the directed edges indicate the transfer of the resources between nodes e g eating excretion death the cone spring model of energy flow through the aquatic ecosystem williams and crouthamel unpublished ulanowicz 1986 is a frequently used example due to its simplicity fig 1 multiple methods exist to build this type of model including a phenomenological energy or nutrient budget approach ulanowicz 1986 the use of linear inverse modeling methods saint béat et al 2013b van oevelen et al 2010 vézina and pace 1994 vézina and platt 1988 bioenergetics modeling as implemented in the ecopath software christensen and walters 2004 polovina 1984 and the construction of dynamic simulation models fath et al 2007 kazanci 2007 moore and de ruiter 2012 patten et al 1976 given this type of energy or material flow model ena scientists then apply a distinctive set of network analyses to these models building on previous work borrett and lau 2014 fath and borrett 2006 fath and patten 1999 ulanowicz and wolff 1991 we have categorized the analyses into six related groups based on their analytic goals and underlying mathematics fig 2 structure flow storage environ control and impact analyses for example the structural analyses focus on the binary network topology and often count the number of different types of pathways e g walks among the nodes borrett et al 2007 borrett and patten 2003 patten 1985a the flow and storage analyses include approaches built directly on economic input output analyses barber et al 1979 finn 1976 hannon 1973 latham 2006 matis and patten 1981 szyrmer and ulanowicz 1987 as well as an information diversity framework macarthur 1955 rutledge et al 1976 ulanowicz 1986 1980 the environ control and impact analyses are derived from the flow and storage analyses often leveraging the input and output perspectives most of these analyses generate whole network descriptors of the system organization and function borrett and lau 2014 kazanci and ma 2015 such as cycling finn 1980 1976 and flow efficiency and system robustness fath 2015 goerner et al 2009 patricio et al 2004 ulanowicz et al 2014 while the analyses can be applied to a single model it is often effective to use the networks as a response variable christian et al 2005 memmott 2009 to compare two or more models of different systems baird et al 1991 borrett et al 2016 christensen 1995 or the same system at different times or under different conditions christian and luczkovich 1999 heymans et al 2002 ray 2008 whipple et al 2014 ena has a long history of development fasham 1985 hannon 1973 patten et al 1976 platt et al 1981 ulanowicz 1980 wulff et al 1989 pinpointing a specific origin point for what we call ena is difficult because network ideas have been used in ecology for many years macarthur 1955 margalef 1963 patten and witcamp 1967 summerhayes and elton 1923 however the introduction of macroeconomic input output analysis methods is a clear transition point hannon 1973 despite this history there are few systematic reviews of ena related research most previous reviews focused on ena methods tracing the derivation from flow analyses input output analyses and information theory allesina and ulanowicz 2004 barber et al 1979 fath and borrett 2006 kay et al 1989 latham 2006 ulanowicz 2005 this focus was necessary because of the large number and complexity of different analyses that are part of ena fig 2 fath and patten 1999 include a review of the methodologies and embedded it in a description of the intellectual development of the core ideas from the environ theory perspective originated by patten 1981 1978 the most comprehensive explanation of the core ena ideas for the development and use of ena to characterize ecosystems from a food web perspective were presented by ulanowicz 1997 1986 several collections present illustrations of applying ena to investigate aquatic ecosystems belgrano 2005 wulff et al 1989 given the importance of reviews to advance a field leitch 1959 noguchi 2006 sheble 2017 this lack of recent and comprehensive reviews may be an impedance to the development and application of ena it also likely makes it more difficult for new investigators to quickly learn the approach and apply it the goal of the work presented here was to provide a high level systematic review and assessment of the state of ecological network analysis for the 2010 2016 period to accomplish this we used a bibliometric approach borrett et al 2014 edelmann et al 2017 moody and light 2006 specifically our objectives were to 1 identify major topics in ena both in terms of theoretical developments and practical applications 2 characterize the collaboration networks of teams working on science related to ena 3 determine the key references used by the community for this work and 4 summarize key features of the analyses given the historical development and use of ena we expected to find a large number of investigations of aquatic primarily marine ecosystems with a strong food web component dame and patten 1981 hannon 1973 wulff et al 1989 however we also anticipated finding an increasing use of ena to investigate urban metabolism and industrial systems kennedy et al 2011 zhang 2013 we also suspected that the collaboration networks would have distinct clusters based on research topics or methodological approaches 2 methods 2 1 corpus selection to identify recent ena publications we searched the web of science wos and elsevier scopus scopus databases for relevant publications between 2010 and 2016 ending on november 17 2016 our search focused on three key terms ecological network analysis network environ analysis and ecosystem network analysis we excluded articles discovered only due to the terms business ecosystems network analysis and molecular ecological network analysis because preliminary screening indicated that articles identified by these terms did not match the target literature fig 3 publications were identified if our key terms occurred in the record title abstract or keywords following the initial identification step we scanned the resultant titles and abstracts for relevance to the targeted ena literature and eligibility for this study for each eligible article we collected the available bibliographic information including title authors abstract keywords publication year source i e the journal conference or book of publication and sources cited we included search results from both wos and scopus to increase the likelihood of detecting the relevant literature and reduce known individual database biases and issues calver et al 2017 pautasso 2014 we selected not to use google scholar due to its tendency to include less relevant items for our study e g r help files course documents challenge of cleaning the data and other known database issues calver et al 2017 jasco 2009 meho and yang 2007 2 2 network models analyses to investigate the literature identified we constructed two different bibliographic network models borgatti et al 2018 börner 2010 edelmann et al 2017 moody and light 2006 van eck and waltman 2011 and manually categorized important features of each paper first we constructed a co term network to identify the key topics in this literature second we built a coauthorship network to characterize the collaborating teams of scientists conducting this work third we reviewed the papers for select key features including the system of interest whether a new model was presented and the methods of network construction and analysis 2 2 1 topics to identify the topic structure of the corpus we built a similarity network of the publications based on co word frequency nodes in this network are the papers and edges indicate a similarity in words used in the title abstract and keywords edges are weighted by the similarity of their term co occurrence using the standard tf idf formulation börner et al 2003 which discounts the similarity of common terms and favors more rare terms to help clarify the strongest relations we retained only those edges that were in the top 10 of the similarity value distribution we then exported this network to pajek batagelj and mrvar 1998 for layout and clustering network layout was done using the fruchterman reingold fr algorithm that aims to maximize the correlation between network geodesic distance shortest path between nodes and point distance in the layout space i e physical distance between each pair in the figure thereby highlighting the natural clusters and contours of the topic space fruchterman and reingold 1991 we fed the resulting coordinates from the network layout to a two dimensional kernel density smoothing procedure to generate the contours the topics that label the contour map were identified by network clustering using the louvain method blondel et al 2008 after a search of the parameter space we determined that a resolution parameter of 1 75 provided a balance between solution stability and detail we also examined a coarser solution with broadly similar results we then identified the 5 most heavily tf idf weighted terms with which to label the cluster centroids in the figure we placed authors at the centroid of the papers they have authored to characterize the shared knowledge foundations we also determined the common citations in each topic cluster common citations were defined as one of the top 10 publications most frequently cited in each cluster with a minimum requirement of at least 5 citations from within the cluster 2 2 2 collaboration we investigated the collaboration structure among ena researchers through a co authorship network built from the identified publications in this network nodes represent individual investigators and the edges are weighted by the number of works co authored as with topics we used pajek to generate a layout with the figure restricted to those with at least 2 publications for clarity we used the kamada kawai layout algorithm kamada and kawai 1989 which like the fr layout used in the term network seeks to minimize the distance between screen distance and geodesic distance but unlike the fr layout adds a node overlap restriction to avoid overlap this layout is adjusted by hand to array disconnected components in a compact manner nodes are sized proportional to the sum of their ties to other nodes i e weighted degree and color represents connected component membership 2 3 feature analysis to further describe the state of ena we conducted a more detailed feature analysis of the corpus each paper was inspected to determine 1 if the paper introduced a new model of a system or analyzed previously published models and then 2 classified the type of ecosystem considered food web biogeochemical cycling agroecosystem hydrologic and urban industrial economic we then considered the ena methods we categorized the network construction methods as being primarily based on a phenomenological or budgeting approach more specifically using the ecopath modeling technique linear inverse modelling or other methods like simulation models we also counted the number of papers that applied the general categories of ena methods fig 2 as well as whether or not the study included sensitivity or uncertainty analyses to support their results 3 results 3 1 publication volume sources our search of the wos and scopus databases yielded 215 unique records fig 3 we excluded 29 of these publications because an initial review of the title and abstracts indicated that the authors used the key terms in ways other than to indicate the type of ecological network modeling and analyses desired for example ivens et al 2016 used the term ecological network analysis to refer to their network study of ant community co occurrence and ant plant interactions this use of the term is more general than the historic focus on ecosystems that we targeted for this corpus we discovered and excluded several papers that used this more general meaning e g tu et al 2015 valverde et al 2015 zhao et al 2016 which has alternatively been referred to as network ecology borrett et al 2014 and ecological networks ings et al 2009 after this initial screening process 186 unique records remained listed in appendix a in supplementary material the publication rate appears to be fairly steady with an average of 26 publications per year 7 5 sd between 2010 and 2016 fig 4 a including 3 papers accepted for publication in 2016 but published in 2017 these records included 144 journal articles 10 book chapters 22 conference papers and 10 journal articles marked as reviews by wos or scopus the reviews were typically focused on other domains and included ena techniques in their consideration chen et al 2013 loiseau et al 2012 longo et al 2015 zhang 2013 the records were published in 60 distinct sources including high impact journals such as applied energy ecological indicators ecology letters environmental modeling software environmental science technology functional ecology marine ecology progress series and methods in ecology and evolution the majority of papers were published in the international journal ecological modelling 22 with the second most common outlet being ecological indicators 5 fig 4b these publication outlets represent a diverse set of wos categories including ecology environmental engineering environmental science marine and freshwater ecology and oceanography 3 2 topics analysis of the co term network revealed eight main topic clusters fig 5 the largest cluster n 55 focused on food webs and general ecosystem analysis cluster 1 frequently used terms include food web ecosystem trophic estuary biomass impact and flow the most common authors in the cluster include d baird b saint béat h asmus r asmus j heymans n niquil and s tecchio table 1 in this cluster the set of common authors was identified as 100 unique because they don t appear as common authors in the other topic clusters while not part of the set of most common authors the centroid of u scharler and r ulanowicz s publications appear on the edge of this cluster fig 5 a scan of the papers included in this cluster showed that many are focused on assessing coastal and marine food webs including the sylt romo bight baird 2012 baird et al 2012 2011 the baltic sea tomczak et al 2013 the humboldt current neira et al 2014 the seine estuary tecchio et al 2015 the nador lagoon in morocco bocci et al 2016 temporarily open estuaries in south africa scharler 2012 and the intertidal brouage mudflat saint béat et al 2014 part of the work in this cluster is motivated by efforts to apply ena indicators to determine good ecological status for management as defined in the eu marine strategy framework directive bocci et al 2016 brigolin et al 2014 chaalali et al 2015 there is a general sense that the results of ena can be used for ecosystem and fisheries management longo et al 2015 and efforts are underway to identify the best whole network metrics to summarize the ecosystem status there are also a number of papers in this cluster focused on improving and extending ena techniques for example lee et al 2012 2011 showed how to combine ena modeling and analysis with other techniques such as stable isotope enrichment and structural population models to enhance the model construction processes and strengthen the scientific discoveries chiu and gould 2010 suggested the use of baysean inference to improve the network model construction and chaalali et al 2016 developed a method to combine ecological niche modeling with lim network construction techniques further work investigated how the physical characteristics of an ecosystem may influence ena results niquil et al 2012 and showed how to use ena to trace and assess the negative impacts of a toxin as opposed to the more common use for the positive impacts of energy and nutrients taffi et al 2015 2014 the second largest cluster of papers n 46 is focused on urban metabolism and the interaction of socio economic and natural ecosystems cluster 7 terms such as energy metabolism utility economic sectors beijing and relationship are common authors with large contributions to this cluster include b chen b fath z yang y zhang table 1 papers in this cluster investigate alternative aspects of the urban metabolism of cities like beijing chen and chen 2015 liu et al 2010 b zhang et al 2016a b compare socio economic regions zhang et al 2016d and evaluate the effective integration and pollution reduction of eco industrial parks lu et al 2015 2012 zhang et al 2015a b several papers in this cluster apply the ena utility analyses fig 2 to determine the net or integral relationships among the socio economic sectors and control analyses to determine which sectors exert the most control on the system dynamics chen et al 2015 guo et al 2016 liu et al 2011a lu et al 2015 xia et al 2016 zhifeng et al 2014 there are also comparisons of ena results to other analytical tools such as energy or material flow analysis and more traditional input output analyses chen and chen 2015 liu et al 2010 the third largest cluster n 26 includes a set of papers that focused on systems theory general ecosystem properties and the ena methods cluster 5 common authors include s borrett b patten c kazanci d hines s whipple and q ma several papers in this cluster investigate evidence for hypothesized general properties of ecosystems borrett 2013 borrett and salas 2010 such as the dominance of indirect effects in ecosystems borrett et al 2010 fann and borrett 2012 ma and kazanci 2013 min et al 2011b salas and borrett 2011 this cluster also includes several papers focused on the development of methods and software these papers include a software tool ncna for constructing and analyzing network models focused on human dominated nitrogen biogeochemical networks min et al 2011a updates to the web based econet software schramski et al 2011 and the introduction of a new r package for ena called enar borrett and lau 2014 this cluster also has a clear connection to the environ concept and theory patten 1978 as a formal approach to studying environments kaufman and borrett 2010 schramski et al 2011 whipple et al 2014 while most of the papers in this cluster analyze previously published models there are two new models presented a ukranian pastoral food web buzhdygan et al 2012 and a pair of models for nitrogen biogeochemistry in the cape fear river estuary hines et al 2015 2012 papers in the fourth largest cluster cluster 3 n 22 exhibited a mix of theory method development and applications but there was a general theme of assessing system sustainability from the perspective of the energy or matter flows terms that link papers in this cluster include sustainability performance indicator information diversity and robustness examples of work in this cluster include an assessment of the resiliency of the heiha river basin and the trade offs it experienced between system efficiency and redundancy kharrazi et al 2016 and an assessment of the success of mixed crop and livestock systems that from a nitrogen flow perspective found a low degree of integration in the systems stark et al 2016 there are also a number of ena applications to urban bodini 2012 bodini et al 2012 chen et al 2010a industrial layton et al 2016a and economic systems huang and ulanowicz 2014 there are again papers to improve the ena methods including work to revise some analyses so as not to require a steady state assumption schaubroeck et al 2012 and to better understand the sensitivity of the whole network metrics to model perturbations mukherjee et al 2015 both of which remain important issues for the field the remaining four clusters in the co term network range in size from 19 to 4 papers cluster 8 n 19 is built around terms such as water wetland basin control utility and management research in this cluster includes the trace of physical water exchanges in wetlands such as the baiyangdian basin mao et al 2015 2010 yang and mao 2011 analyses of virtual water trade when considering the water embedded in economic products such as agricultural crops fang and chen 2015 mao and yang 2012 yang et al 2012 and investigations of the energy water nexus duan and chen 2017 wang and chen 2016 yan and chen 2016 papers in cluster 6 n 8 share distinctive terms such as risk and risk assessment much of this work is an application of ena to assess environmental risk of economic development projects such as dam construction chen et al 2011 2010b cluster 4 n 7 is joined by terms like energy security supply and stability and includes work like a systems assessment of a liquid natural gas distribution system in a region lu et al 2016 shaikh et al 2016 the smallest cluster n 4 cluster 2 is linked by terms such as rate remove and lake but the internal topics are less coherent for example there is an investigation of nitrogen cycling in the laurentian great lakes small et al 2014 that is more like the biogeochemistry models and analyses we have seen in other clusters as well as an effort to link allometric principals to ecological flow networks zhang and wu 2013 to better understand the similarities and differences among the topic clusters we identified the most commonly cited papers in each of the network clusters table 2 twelve papers were commonly cited in more than one cluster indicating their broader impact across the ena domain the most frequently cited source is a review paper that captures both the early intellectual development of the field and summarizes several of the common methods fath and patten 1999 while this paper was key for multiple clusters it was not a common citation of the largest cluster 1 focused on food webs three sources were common citations in three of the co term clusters these include one comprehensive monograph on ecosystem organization with a strong trophic perspective ulanowicz 1986 an expository paper that provides more detail about methods to build the core ecosystem network models fath et al 2007 and an early example of applying ena to investigate urban water metabolism zhang et al 2010a ulanowicz 1986 was influential in the large food webs cluster 1 the flow and sustainability cluster 3 and the systems ecology cluster 5 but is not as commonly cited in the second largest group focused on urban metabolism 7 in fact 56 of the highly cited literature in the food web cluster was unique to this cluster and 80 of the risk assessment cluster was distinct the two oldest papers commonly cited were odum s 1969 strategy of ecosystem development and wolman s 1965 the metabolism of cities further there were three papers from the 1970s that were still influencing the field finn 1976 hannon 1973 patten 1978 thirty five out of the 47 highly cited sources appear to be influential in only one cluster and may provide insight to some of the important differences among the clusters for example two papers on the ecopath software christensen and pauly 1992 christensen and walters 2004 and one on using inverse methods vézina and platt 1988 were commonly cited only in the food web cluster which may be an indicative of a difference in the tools and methods of this cluster 3 3 collaboration structure we identified 347 unique authors of the 186 papers in the corpus these authors are the nodes of the collaboration network fig 6 which identifies 8 main collaborative components the largest component n 195 56 2 includes authors that were associated with both the food web topic cluster 1 and the urban metabolism topic cluster 7 within this component several smaller working groups appeared due to the higher frequency of co authorship for example there appeared to be a strong collaboration amongst y zhang z yang h zheng g liu m su b chen s chen and b fath there also appeared to be a strong working group that includes n niquil b saint béat j lobry g lasalle a chaalali and s tecchio within this component there were three more weakly linked subcomponents coauthorship among d baird b fath and u scharler created a bridge between two elements and a co authorship with s tecchio created the second bridge into a subcomponent with j j heymans the next largest component n 20 included c kazanci q ma b patten and s borrett the third largest component n 15 included r ulanowicz and it constructed from two papers while several distinct components emerged in our period of observation with some apparently stronger and productive working groups these data suggest a generally well connected collaboration structure as is common in science collaboration networks the collaborator degree distribution of ena in our corpus appears exponential the median number of collaborators was 6 while the mean number of collaborators was 9 3 however some investigators were highly collaborative for example within our corpus n niquil had 96 co authors b saint béat was the second most collaborative with 61 co authors in the corpus this high co authorship is despite the fact that the most co authors on a single paper was 26 the author addresses indicate that ena work is distributed among 31 countries fig 7 the countries with the most frequent contributions include austria china france and the united states of america 3 4 feature analysis new models were presented in 103 55 of the papers discovered and the number in each type of system varied from year to year fig 8 in alignment with the previous results the food web and biogeochemical cycling ecosystem models and the urban industrial and economic models were most frequent over our observation window the number of new urban industrial and economic models surpassed the number of new food web and biogeochemical cycling ecosystem models the most frequently reported analyses other than number of nodes or edges across all types of systems were the structure analyses in 106 papers 57 flow analyses including both the input output analyses 98 papers 53 and information based analyses 67 papers 36 including ascendency metrics table 3 were also common the control analysis and impact methods utility analysis and mixed trophic impacts were used more frequently in papers investigating urban industrial and economic models only 33 papers 18 included a sensitivity or uncertainty analysis of the results presented 4 discussion two principal findings result from our analysis of the ena publications between 2010 and 2016 first while there are a variety of topics being investigated with this approach the majority fall either into a cluster focused on food webs or a second cluster focused on the sustainability of socio ecological systems including studies of urban metabolism the majority of the food web models investigated aquatic and primarily marine ecosystems and examined the structure and internal relationships among the ecosystem species or assessed how they differ due to time space or changes in specific drivers like an anthropogenic impact we also discovered a few terrestrial ecosystem applications including one to assess the sustainability of agricultural systems while there is a long history of ena development and applications tied to trophic studies the recent applications to socio economic and socio ecological systems is an important element of the field investigators are finding many creative ways to apply ena a second principal finding is the strong collaborative nature of the field within our observation window the majority of authors were linked into a single large component our results depend on the specific time period observed but the key finding is that the authors in the domain are currently highly collaborative and well connected when evaluating the quality of a bibliometric review it is essential to consider the success of the search in identifying the relevant literature it is possible to have both errors of commission including papers that really do not belong in the target set and errors of omission missing papers in the literature that do belong in the set due to our initial screening and subsequent feature analysis we are confident that our corpus does not contain major errors of commission we included conference proceedings in our corpus 12 to better capture the state of the field by being more inclusive in the type of scholarship included this might have introduced a bias to the results as some conference papers may be turned into similar journal articles that are also included in the corpus this potential double counting would be a type of error of commission and would inflate the importance of the topic or author contribution a review of the author and titles of the corpus indicates that only one conference proceedings was clearly a duplicate layton et al 2016a 2015 thus we expect that the effect of this potential double counting was minimal it is more difficult to assess errors of omission to increase our likelihood of identifying the relevant literature and decrease errors of omission we included searches of both the wos and scopus databases however we are confident that we missed identifying some number of relevant papers for example our search failed to find a study applying ena methods to investigate the ecosystem stoichiometry c n p of the twin cays barrier reef ecosystem in belize scharler et al 2015 as well as an application of ena to investigate the performance of economic supply chains allesina et al 2010 we also failed to find a couple of papers by kharrazi et al 2016 2014 2013 that applied the information based ascendency flow analysis of ena in each of these cases 1 the work was an application of the ena methods to specific systems 2 the papers appear to be written for applied audiences and 3 the papers were missed because the authors did not include the targeted search phrases in their keyword lists titles or abstracts in addition we estimated that we missed 14 papers published in 2016 due to finalizing our search for this analysis on nov 17 2016 9 were conference papers published in energy procedia despite these important omissions given our working knowledge of the field and an informal comparison of our results to those found by google scholar we suspect that our error of omission rate was small 4 1 ena insights a number of insights emerge from this work about the practice of using ena which we consider in three groups model construction analysis and applications 4 1 1 model construction the first step in any application of ena is to construct the network model as noted in the introduction there are multiple ways to construct an appropriate model to be analyzed with ena fath et al 2007 wulff et al 1989 many of which are apparent in the literature we reviewed these model construction methods include building nutrient or energy budgets using phenomenological approaches hines et al 2015 2012 scharler 2012 ulanowicz 1986 xia et al 2017 or employing theoretical energetic constraints for food webs banerjee et al 2016 heymans et al 2011 tomczak et al 2013 linear inverse modeling niquil et al 2011 saint béat et al 2013b small et al 2014 taffi et al 2015 tecchio et al 2016 van oevelen et al 2010 vézina and pace 1994 and creating more mechanistic dynamic models and simulations baird 2011 lee et al 2012 different methods may be more common or appropriate for different applications for example the energetic and trophic constraints built into ecopath models may work well for food webs but they are typically not appropriate for urban metabolism models regardless of the method used creating ecosystem networks is still a model construction process that should follow modeling best practices haefner 2005 jørgensen and bendoricchio 2001 schmolke et al 2010 including a clear evaluation of the model quality both in terms of model structure and the analytic results dame and christian 2008 2006 deehr et al 2014 sensitivity and uncertainty analyses assist with model evaluation and enable investigators to make stronger inferences about the system analyses our review shows that applications of these techniques are becoming more common in ena these analyses have two main forms the first form focuses on the initial conceptual model and considers the impact of issues like node aggregation lumping on the ena results this aggregation may occur when researchers have limited species specific data for food webs and therefore group species into functional groups e g large phytoplankton bacteria for example several studies have found that ena indicators were sensitive to different node aggregation schemes and especially to the representation of detritus and other forms of non living resource pools in food web ecosystem models abarca arenas and ulanowicz 2002 allesina et al 2005 baird et al 2009 johnson et al 2009 for example fath et al 2013 discovered that some network metrics were less affected by their aggregation scheme for the sylt rømø bight model while other metrics exhibited larger differences the aggregation problem is an old one in ecological modeling cale et al 1979 gardner et al 1982 and one that yields few simple guidelines despite the potential influence of aggregation issues fath et al 2007 argued that for ena applications to be most useful as a systems analysis tool it is essential to include all components of the ecosystem in the model even if this means creating aggregated functional groups a second form of sensitivity and uncertainty analysis considers the network structure largely fixed and focuses on the uncertainty in the flux magnitude estimations e g model parameterization ayers and scharler 2011 guesnet et al 2015 hines et al 2018 2015 kones et al 2009 this is largely accomplished by selected flux perturbations to an initial model using a monte carlo approach bodini et al 2012 heymans et al 2016 salas and borrett 2011 or using monte carlo methods coupled to a modeling procedures such as a regionalized sensitivity analysis borrett and osidele 2007 or linear inverse modeling chaalali et al 2016 guesnet et al 2015 kones et al 2009 pacella et al 2013 to sample the space of plausible network model parameterizations these analyses have been used to show that ena whole network metrics tend to be more constrained than the estimated network uncertainty and that some indicators are more robust less sensitive to this uncertainty than others kaufman and borrett 2010 kones et al 2009 the development and application of methods to perform sensitivity and uncertainty analyses for ena studies is a critical step to evaluating the quality of the models and analytical results it is also essential to make ena more useful for ecosystem assessment and environmental management applications because investigators can make stronger inferences about a selected network metric compared to a threshold borrett et al 2016 hines et al 2018 2016 or the differences between systems being compared with ena ayers and scharler 2011 hines et al 2018 2015 saint béat et al 2013a 4 1 2 analyses ena is a set of related analytical tools that build upon ideas in the broader area of network science brandes et al 2013 newman 2010 including social network analysis wasserman and faust 1994 economic input output methods hannon 1973 leontief 1966 and information theory rutledge et al 1976 ulanowicz 1986 one challenge of using ena is that there are a large number of different methods that have developed over its more than four decades of development the advantage of this method diversity however is that there is greater flexibility and choice one way that reviews such as this one might help advance the field is by 1 focusing on methods rather than topic 2 highlighting the applications of the methods and 3 identifying characteristics of how different ena models were implemented we hope that through this elucidation the choices researchers must make will become more clear another way that reviews contribute is by formalizing the boundaries and linkages between methods characterizing the extent to which they vary and identifying tools for implementation to that end fig 2 presents a conceptual model of different groups of methods in ena that builds on previous categorizations fath and patten 1999 at the base are a collection of structural methods that typically ignore the edge weights and include classic food web descriptors like connectance i e network density few of the ena structural methods are unique to the field most are shared in common with other domains in network science however the pathway proliferation concept underlies many of the other ena methods borrett et al 2007 borrett and patten 2003 patten 1985b flow analyses builds on the structural analyses and considers the edge weights finn 1976 gattie et al 2006 kay et al 1989 latham 2006 patten et al 1976 ulanowicz 1986 flow methods can be classified into two types methods that build directly on economic input output techniques fath and patten 1999 finn 1976 patten 1985b patten et al 1976 szyrmer and ulanowicz 1987 ulanowicz and kemp 1979 and a set of analyses that draw on information theory which includes the ascendency set of analytics hirata and ulanowicz 1984 patricio et al 2004 ulanowicz 1980 our review suggests that flow analyses are the most commonly used methods in our corpus storage analyses are mathematically very similar to flow analyses but also account for node weights to represent the amount of energy or matter stored in a node barber 1978 fath and borrett 2006 fath and patten 1999 schramski et al 2011 ulanowicz and abarca arenas 1997 in many ecosystem models storage is equivalent to the biomass of the species or functional group these methods are much less often used in our corpus the environ control and what we are calling impact methods fig 2 build upon the flow or storage analyses the specific environ methods operationalize patten s environ concept for investigating the input and output environs of the system members patten 1981 1978 which have been used to investigate the ecological niche concept patten and auble 1981 and to quantify the coupling of steps in biogeochemical cycling hines et al 2015 control analyses indicate which nodes in a network exert more or less control upon the other node s flow across the network chen and chen 2015 dame and patten 1981 fath 2004a hines et al 2016 schramski et al 2007 2006 the impact methods focus on the net or integral pairwise impact of one species in the network on another and were well used in our corpus 23 this includes mixed trophic analysis gonzález et al 2016 ulanowicz and puccia 1990 and a similar but more general analysis termed utility analysis fath and patten 1998 patten et al 1991 zhang et al 2016c scharler and fath 2009 provide a detailed comparison of these closely related impact methods 4 1 3 applications this review highlights the adaptable nature of ena the modeling approach and analyses have been applied to a wide variety of system types and used to address a variety of kinds of questions from theoretical issues to applications to specific ecosystems the field launched with a strong trophodynamic emphasis belgrano 2005 dame and patten 1981 finn 1976 hannon 1973 wulff et al 1989 that continues today as ena network metrics are being considered as indicators to assess marine food web status bocci et al 2016 brigolin et al 2014 chaalali et al 2016 heymans and tomczak 2016 tomczak et al 2013 several papers have investigated the power of indirect interactions to alter the net relationships among species in the food webs banerjee et al 2016 lassalle et al 2011 rodríguez zaragoza et al 2016 which seem to become more positive when the model traces essential resources in food webs or biogeochemical cycling borrett et al 2016 however creative applications of ena demonstrate that it can be used to trace the negative effects of toxins as well taffi et al 2015 the methods are also being used to assess the functioning and sustainability of technical economic and socio ecological systems for example investigators have used ena ideas to determine if designing industrial networks using ecosystem principles lead to more sustainable industries layton et al 2016a b c others have used ena as a tool to investigate the energy water nexus in socio ecological systems duan and chen 2017 wang and chen 2016 yan and chen 2016 in fact applications to socio ecological systems chen et al 2015 guo et al 2016 liu et al 2011b zhang et al 2016d grew faster than applications to food webs in our study period fig 8 the individual applications are interesting on their own and collectively this review illustrates a broad number of ways to use the ena tools we suspect that these uses will grow as creative scientists continue to develop and explore the tool set 4 2 collaboration the coauthorship network shows that the investigators in this domain are highly collaborative these collaborations have clusters that tend to be focused on specific topics and the work groups tend to have a spatial component that may influence the outcomes de bont and lachmund 2017 however there are also many collaborations that extend beyond these working groups those authors who appear in multiple work groups function as social bridges that enable the diffusion of ideas and innovations further the data intensity and diversity of technical expertise required to successfully apply ena may encourage larger and more varied teams of scientists the observed co authorship structure has a strong temporal component and informs us about the collaborative structure within the observation window 2010 2016 if we were to extend our observation period we would expect to see several of the smaller components join with the giant component for example ulanowicz has coauthored papers with baird baird and ulanowicz 1989 ulanowicz and baird 1999 scharler fath et al 2007 ulanowicz and scharler 2008 and niquil niquil et al 1999 in the past similarly fath coauthored a number of papers with patten before our observation window borrett et al 2007 fath et al 2004 fath and patten 1999 1998 more recent papers would also join the subcomponent with borrett to authors in the largest component hines et al 2018 rakshit et al 2017 similarly two of the ena papers we initially missed in our search would have joined two of the smaller components to the largest author component the scharler et al 2015 paper would have linked the author cluster with ulanowicz and the kharrazi et al 2013 connects the component with kharrazi the core conclusions from this view of collaboration is that this science community is relatively tight knit in this domain thus we expect that ideas and innovations propagate quickly across the community this is reinforced by the finding that some authors are the most common across several topic clusters table 1 despite this connectivity it is important to notice that 1 clear common working groups are still apparent within the components and 2 the large food web topic cluster does not have a common author that appears in the other topic clusters a limitation of this study is that it does not show how well connected this community is to the broader domains of network ecology or general ecology environmental sciences or network science 4 3 challenges opportunities for ena while the use of network models and concepts continues to grow by about 0 2 per year throughout the ecological literature borrett et al 2014 lau et al 2017 the publication rate for ena appears fairly steady between 2010 and 2016 the growth in network ecology is driven by the application of network ideas to a variety of different complex ecological problems these applications include showing how genotypic variation in a foundational species like the narrowleaf cottonwood tree can determine the community composition of macroarthropods that live on the tree lau et al 2016 revealing the small overlap in venus flytrap dionaea muscipula prey and pollinators youngsteadt et al 2018 finding the ecological significance of animal social networks kurvers et al 2014 and considering how organisms move in space dale and fortin 2010 jacoby and freeman 2016 saura et al 2014 while there are clearly some new and interesting applications of ena and more opportunity for expansion the field has had over 44 years to mature in addition the model type is more restrictive than many other network models e g it traces a single thermodynamically conserved currency such as carbon or nitrogen this restriction provides the analysis more power but limits the kinds of system to which the approach may apply other issues that may be hindering the potential of ena include the lack of systematic and critical reviews the large volume of original data required and the large and complex sets of analyses that make it difficult for new investigators to know which method to apply when and for what purpose two additional issues may be impeding the development of the science around ena language barriers and the requirements for tacit knowledge naming conventions may present challenges to the use and dissemination of ena for example scientists within the ena field conceptualize the phrase ecological network analysis and the acronym ena to mean a specific set of approaches measures and data expectation it is unclear if these ideas penetrate into the larger community of ecologists and environmental scientists one indicator that this may not be the case is that while searching the literature for this study we observed that the term ecological network analysis is increasingly being used more generically by scientists beyond the community cited here this generic use may dilute the power of ecological network analysis as a key term however we advocate strongly that the community continue to use the ecological network analysis phrase as a key term in its publications as it will assist with finding the relevant literature which may promote an ease of communication and research sheble et al 2016 at a more detailed level within the lexicons of ena research there remains a jumble of terminology and mathematical notation with the same or similar concepts expressed in different ways with different types of ena approaches in some cases it appears that the software tools as well as publication texts propagate linguistic differences there is opportunity to streamline terminology to facilitate the continued use of the approach expose similarities in approaches and more cohesively communicate to a wider audience the commonalities that enable researchers well versed in ena to recognize strong similarities amongst this family of methods this task could be assisted with additional reviews and synthesis papers and translation aids that enable an extent of multilingualism much in the way that some scientists develop levels of comfort with both network and graph theory the second impediment concerns the hidden knowledge embedded in ena practice ena is like many newer procedurally oriented research practices in that it is most often learned in the contexts of laboratories and research teams or through mentorships leahey 2008 both the methods and the intricacies of decisions made and options available are transmitted from mentors to learners tacitly through the experience of working on a project klemmer et al 2006 polanyi 1967 to counter challenges imposed by irregular naming conventions and transmission of methodological knowledge primarily in the practice of research it could be helpful for ena researchers to question work to codify and write about research and data practices for broader audiences for example researchers could write for more general ecology journals journals targeting complex network modeling and analysis and those that target more application and education oriented audiences another challenge and thus opportunity for ena research is focused on the large number of network metrics produced by the analyses borrett and lau 2014 kazanci and ma 2015 lau et al 2017 each metric was constructed to describe a selected feature of the systems and many appear to relate the system state in the dipsr framework burkhard and müller 2008 however the large number of metrics can be overwhelming e g the get ns function in the enar software returns 82 whole network metrics and we know from both the underlying mathematics and statistical analyses borrett and osidele 2007 kazanci and ma 2015 that not all of the metrics are provide independent information about the system while in some theoretical work and applications it will continue to be useful to have the full range ena network metrics it might also be useful to identify a smaller subset that provide a user or manager with more robust and independent information participants at the use of coastal and estuarine food web models in politics and management the need for an entire ecosystem approach to prevent crises workshop held at the alfred wegener institute helmholtz zentrum fur polar und meeresforschung in sylt germany sept 2017 considered this issue however even if the community can identify a key subset of metrics there remains the challenge of constructing strong indicators from these metrics dale and beyeler 2001 for example we generally do not have clear or consistent expectations with supporting evidence as to how the metrics should or do respond to different stressors luang et al 2014 ludovisi and scharler 2017 is ena up to the task of environmental assessment and guidance of management it has solid theoretical foundations and this review shows that this foundation is being built upon by a dedicated and cohesive community of scientists developing and applying the science in a diversity of ways this is a promising start however there remains a need for the community to collaboratively build and consistently follow best practices for model construction fath et al 2007 including rigorous model evaluation and the application of sensitivity and uncertainty analyses that enable stronger inferences there is also effort required to transform network metrics from system state descriptors into good indicators that have clear meaning for management with known and reliable responses to changes in the system state dale and beyeler 2001 given the findings of this review we are optimistic for the future of ecological network analysis acknowledgements srb acknowledges and appreciates the support from both the duke network analysis center and the university of north carolina wilmington this collaborative work was supported in part by a uncw research reassignment preliminary results in this paper were presented at workshop titled use of coastal and estuarine food web models in politics and management the need for an entire ecosystem approach to prevent crises at the alfred wegener institute helmholtz zentrum fur polar und meeresforschung in sylt germany sept 2017 we are grateful for the initial comments critiques and discussions that improved the work appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 04 020 appendix a supplementary data the following is supplementary data to this article 
25277,ecological network analysis williams and crouthamel unpublished here the model is shown in both its diagram redrawn from ulanowicz 1986 a and matrix b representations the flow matrix f nxn is oriented from row to column i j the inputs z exports e respirations r and storage or biomass x values are shown as separate vectors the living vector has logical values true or false that indicted whether the corresponding node is living which is an important distinction for some ena algorithms such as mixed trophic impacts fig 1 fig 2 organizing framework for ecological network analyses the core analyses can be grouped into three related areas based on their emphasis structure topology flow geometry and storage i e biomass analyses each of which includes both input and output oriented methods three groups of analyses build on the core analyses including the environ control and impact analyses encompassing both utility analysis and mixed trophic analysis fig 2 fig 3 information flow for ena publication identification and selection adapted from the preferred reporting items for systematic reviews and meta analyses prisma guidelines fig 3 fig 4 publication a and source b frequency in the 2010 2016 corpus of ecological network analysis publications fig 4 fig 5 contour plot of the topic network in which nodes are papers and network edges indicate a co term similarity peaks indicate topic clusters which are labeled with cluster numbers and descriptive terms selected author names were placed at the centroid of the papers they authored greater detail about each cluster can be found in tables 1 and 2 fig 5 fig 6 coauthorship network for the ecological network analysis publications from 2010 through 2016 in this network model nodes are authors and edges indicate the number of coauthored publications fig 6 fig 7 geography of ecological network analysis publications from 2010 to 2016 showing the number of publications by authors in each country along with the number of collaborations fig 7 fig 8 number of ecological network analysis papers that introduced a new model each year classified by system type fig 8 table 1 most common authors in eight topic clusters of ecological network analysis inferred from 186 publications from 2010 through 2016 table 1 author cluster total 1 food webs ecosystems 2 species loss 3 flow sustainability 4 security 5 systems ecology ecosystems 6 risk assessment 7 energy urban metabolism 8 wetland water systems bin chen 5 x x x x x brian fath 5 x x x x x meirong su 4 x x x x zhifeng yang 4 x x x x yan zhang 3 x x x shaoquing chen 3 x x x gengyuan liu 2 x x stuart borrett 2 x x aurelie chaalali 1 x blanche saint béat 1 x daniel baird 1 x geraldine lassalle 1 x harald asmus 1 x jeremy lobry 1 x johanna jacomina heymans 1 x nathalie niquil 1 x ragnhild asmus 1 x samuele tecchio 1 x gaston e small 1 x jacques c finlay 1 x jiang zhang 1 x lingfei wu 1 x robert w sterner 1 x ali zharrazi 1 x antonio bodini 1 x mingqi zhang 1 x weiwei lu 1 x yan hao 1 x ying fan 1 x andria salas 1 x bernard patten 1 x caner kazanci 1 x david hines 1 x ge ying 1 x michael freeze 1 x jie chang 1 x qianqian ma 1 x stuart whipple 1 x guillaume junqua 1 x roux philippe 1 x loiseau eleonore 1 x veronique bellon maurel 1 x hong liu 1 x hongmei zheng 1 x shengsheng li 1 x yanxian li 1 x delin fang 1 x he chen 1 x honghan chen 1 x lijuan cui 1 x ursula m scharler 1 x xufeng mao 1 x total 10 5 10 10 10 8 9 10 unique 100 100 20 40 90 50 44 60 table 2 commonly cited references in eight ecological network analysis topic clusters discovered in 186 publications from 2010 through 2016 table 2 title citation total 1 food webs ecosystems 2 species loss 3 flow sustainability 4 security 5 systems ecology ecosystems 6 risk assessment 7 energy urban metabolism 8 wetland water systems review of the foundations of network environ analysis fath and patten 1999 6 x x x x x x growth and development ecosystems phenomenology ulanowicz 1986 3 x x x ecological network analysis network construction fath et al 2007 3 x x x ecological network analysis of an urban water metabolic system model development and a case study for beijing zhang et al 2010a 3 x x x the strategy of ecosystem development odum 1969 2 x x quantitative methods for ecological network analysis ulanowicz 2004 2 x x the comparative ecology of six marine ecosystems baird et al 1991 2 x x measures of ecosystem structure and function derived from analysis of flows finn 1976 2 x x ecological network analysis of an urban energy metabolic system model development and a case study of four chinese cities zhang et al 2010b 2 x x a matlab function for network environ analysis fath and borrett 2006 2 x x the structure of ecosystems hannon 1973 2 x x towards a sustainable use of water resources a whole ecosystem approach using network analysis bodini and bondavalli 2002 2 x x comparative study on the trophic structure cycling and ecosystem properties of four tidal estuaries baird and ulanowicz 1993 1 x ecopath ii a software for balancing steady state ecosystem models and calculating network characteristics christensen and pauly 1992 1 x ecosystem maturity towards quantification christensen 1995 1 x ecopath with ecosim methods capabilities and limitations christensen and walters 2004 1 x food web dynamics in the ocean i best estimates of flow networks using inverse methods vézina and platt 1988 1 x wand an ecological network analysis user friendly tool allesina and bondavalli 2004 1 x quantifying the sustainability of economic resource networks an ecological information based approach ulanowicz et al 2009 1 x an hypothesis on the development of natural communities ulanowicz 1980 1 x quantifying sustainability resilience efficiency and the return of information theory ulanowicz et al 2009 1 x civil unrest in north africa risks for natural gas supply lochner and dieckhöner 2012 1 x symmetrical overhead in flow networks ulanowicz and norden 1990 1 x liberalisation and the security of gas supply in the uk wright 2005 1 x the seasonal dynamics of the chesapeake bay ecosystem baird and ulanowicz 1989 1 x analysis of energy flows in an intertidal oyster reef dame and patten 1981 1 x flow analysis of models of the hubbard brook ecosystem finn 1980 1 x dominance of indirect causality in ecosystems higashi and patten 1989 1 x systems approach to the concept of environment patten 1978 1 x an ecosystem model for assessing ecological risks in québec rivers lakes and reservoirs bartell et al 1999 1 x ecological network analyses and their use for establishing reference domain in functional assessment of an estuary christian et al 2009 1 x effects of nutrient recycling and food chain length on resilience deangelis et al 1989 1 x network analysis in perspective comments on wand an ecological network analysis user friendly tool fath 2004b 1 x estimating ecosystem risks using cross validated multiple regression and cross validated holographic neural networks findlay and zheng 1999 1 x risk uncertainty in risk and the epa release limits for radioactive waste disposal helton 1993 1 x application of bayesian network to the probabilistic risk assessment of nuclear waste disposal lee and lee 2006 1 x probe into the method of regional ecological risk assessment a case study of wetland in the yellow river delta in china xu et al 2004 1 x applying ecological input output flow analysis to material flows in industrial systems part i tracing flows bailey et al 2004 1 x network synergism emergence of positive relations in ecological systems fath and patten 1998 1 x the metabolism of cities wolman 1965 1 x ecological network and emergy analysis of urban metabolic systems model development and a case study of four chinese cities zhang et al 2009 1 x network mutualism positive community level relations in ecosystems fath 2007 1 x ecological network analysis for water use systems a case study of the yellow river basin li et al 2009 1 x quantifying the sustainability of water use systems calculating the balance between network efficiency and resilience li and yang 2011 1 x the water environs of okefenokee swamp an application of static linear environ analysis patten and matis 1982 1 x indirect effects and distributed control in ecosystems distributed control in the environ networks of a seven compartment model of nitrogen flow in the neuse river estuary usa steady state analysis schramski et al 2006 1 x indirect effects and distributed control in ecosystems distributed control in the environ networks of a seven compartment model of nitrogen flow in the neuse river estuary usa time series analysis schramski et al 2007 1 x 9 0 10 7 10 10 10 10 56 40 43 50 80 40 60 table 3 number of publications that performed selected categories of ecological network analyses by system category table 3 ena type food web biogeochemical cycling urban industrial economic hydrologic agroecosystem other total n 71 n 63 n 7 n 2 n 43 n 186 structure 50 70 43 68 7 100 1 50 5 12 106 57 flow input output 58 82 26 41 4 57 2 100 8 19 98 53 flow information a 42 59 14 22 5 71 2 100 4 9 67 36 storage 8 11 1 14 2 5 11 6 utility or mixed trophic impacts 12 17 35 56 3 43 2 5 49 26 control 1 1 10 16 2 29 13 7 environ 7 10 1 2 1 14 9 5 sensitivity or uncertainty analysis 25 35 4 6 4 9 33 18 a includes calculation of information based metrics like ascendency overhead capacity derived ratios and robustness review bibliometric review of ecological network analysis 2010 2016 stuart r borrett a b laura sheble b c james moody b d evan c anway a a department of biology and marine biology and center for marine science university of north carolina wilmington wilmington nc 28403 united states department of biology and marine biology and center for marine science university of north carolina wilmington wilmington nc 28403 united states b duke network analysis center social science research institute duke university durham nc 27708 united states duke network analysis center social science research institute duke university durham nc 27708 united states c school of information sciences wayne state university detroit mi 48202 united states school of information sciences wayne state university detroit mi 48202 united states d department of sociology duke university durham nc 27708 united states department of sociology duke university durham nc 27708 united states corresponding author at department of biology and marine biology university of north carolina wilmington wilmington nc 28403 united states department of biology and marine biology university of north carolina wilmington wilmington nc 28403 united states ecological network analysis ena combines modeling and analysis used to investigate the structure function and evolution of ecosystems and other complex systems ena is applied to network models that trace the movement of thermodynamically conserved energy or matter through the system investigators use ena to answer a range of questions such as the following what is the impact of fishing on the marine food web which species control the flux of nitrogen in an estuary what is the ecological relationship among species in the food web when direct and indirect influences are considered would a proposed regulation make a city more sustainable the field has grown since its inception in the 1970s but it has rarely been systematically reviewed this absence of reviews likely hinders the development of the field as a whole obscures the diversity of its applications and makes it difficult for new investigators to learn develop and apply the techniques the objective of the work presented in this paper was to systematically review ena research published in 2010 through 2016 to 1 identify the topic diversity 2 expose methodological development 3 highlight applications and 4 assess collaboration among ena scholars to accomplish this we used a combination of bibliometric network e g social network and feature analyses our search identified 186 records a topic network built from the bibliographic records revealed eight major topic clusters the largest groups centered on food webs urban metabolism and ecosystem theory co author analysis identified 387 authors in a collaboration network with eight larger components the largest component contained 56 of the authors this review shows ena to be a topically diverse and collaborative science domain and suggests opportunities to further develop ena to better address issues in theoretical ecology and for environmental impact assessment and management keywords ecosystem social network analysis scientometrics food web biogeochemical cycling urban metabolism network science materials flow analysis 1 introduction ecological network analysis ena is used to investigate ecosystem structure and functioning hannon 1973 jørgensen 2007 patten et al 1976 ulanowicz 1986 and is one component of the broader field of network ecology borrett et al 2014 proulx et al 2005 ena techniques have been applied to characterize food web organization baird et al 1998 bondavalli and ulanowicz 1999 pezy et al 2017 rakshit et al 2017 assess ecosystem maturity or status christensen 1995 ulanowicz 1980 trace biogeochemical cycling in ecosystems christian and thomas 2003 small et al 2014 and characterize the sustainability of urban metabolisms and other socio ecological systems fan et al 2017 zhang 2013 zhang et al 2009 responding to the need for ecosystem based management and recognizing the ability of ena to characterize the whole ecosystem multiple papers have called for the increased use of ena to guide ecosystem assessment and management dame and christian 2006 de jonge et al 2012 longo et al 2015 zhang 2013 this push includes the use of ena system metrics as indicators of good environmental status in the eu marine strategy framework directive european parliament and council of the european union 2008 to prepare for this anticipated increase in ena applications for environmental decision making to help advance the field and to better enable new investigators to learn develop and apply the ena approach we reviewed publications in the field between 2010 and 2016 ena studies are distinguished from other types of network analyses in ecology by both the type of network model used and the collection of analyses applied to interrogate the system in ena the network model follows the flow of energy or nutrients through the ecosystem fath et al 2007 hannon 1973 wulff et al 1989 these models use a single thermodynamically conserved tracer so that the networks function like resource distribution maps network nodes represent species functional groups or non living resource pools and the directed edges indicate the transfer of the resources between nodes e g eating excretion death the cone spring model of energy flow through the aquatic ecosystem williams and crouthamel unpublished ulanowicz 1986 is a frequently used example due to its simplicity fig 1 multiple methods exist to build this type of model including a phenomenological energy or nutrient budget approach ulanowicz 1986 the use of linear inverse modeling methods saint béat et al 2013b van oevelen et al 2010 vézina and pace 1994 vézina and platt 1988 bioenergetics modeling as implemented in the ecopath software christensen and walters 2004 polovina 1984 and the construction of dynamic simulation models fath et al 2007 kazanci 2007 moore and de ruiter 2012 patten et al 1976 given this type of energy or material flow model ena scientists then apply a distinctive set of network analyses to these models building on previous work borrett and lau 2014 fath and borrett 2006 fath and patten 1999 ulanowicz and wolff 1991 we have categorized the analyses into six related groups based on their analytic goals and underlying mathematics fig 2 structure flow storage environ control and impact analyses for example the structural analyses focus on the binary network topology and often count the number of different types of pathways e g walks among the nodes borrett et al 2007 borrett and patten 2003 patten 1985a the flow and storage analyses include approaches built directly on economic input output analyses barber et al 1979 finn 1976 hannon 1973 latham 2006 matis and patten 1981 szyrmer and ulanowicz 1987 as well as an information diversity framework macarthur 1955 rutledge et al 1976 ulanowicz 1986 1980 the environ control and impact analyses are derived from the flow and storage analyses often leveraging the input and output perspectives most of these analyses generate whole network descriptors of the system organization and function borrett and lau 2014 kazanci and ma 2015 such as cycling finn 1980 1976 and flow efficiency and system robustness fath 2015 goerner et al 2009 patricio et al 2004 ulanowicz et al 2014 while the analyses can be applied to a single model it is often effective to use the networks as a response variable christian et al 2005 memmott 2009 to compare two or more models of different systems baird et al 1991 borrett et al 2016 christensen 1995 or the same system at different times or under different conditions christian and luczkovich 1999 heymans et al 2002 ray 2008 whipple et al 2014 ena has a long history of development fasham 1985 hannon 1973 patten et al 1976 platt et al 1981 ulanowicz 1980 wulff et al 1989 pinpointing a specific origin point for what we call ena is difficult because network ideas have been used in ecology for many years macarthur 1955 margalef 1963 patten and witcamp 1967 summerhayes and elton 1923 however the introduction of macroeconomic input output analysis methods is a clear transition point hannon 1973 despite this history there are few systematic reviews of ena related research most previous reviews focused on ena methods tracing the derivation from flow analyses input output analyses and information theory allesina and ulanowicz 2004 barber et al 1979 fath and borrett 2006 kay et al 1989 latham 2006 ulanowicz 2005 this focus was necessary because of the large number and complexity of different analyses that are part of ena fig 2 fath and patten 1999 include a review of the methodologies and embedded it in a description of the intellectual development of the core ideas from the environ theory perspective originated by patten 1981 1978 the most comprehensive explanation of the core ena ideas for the development and use of ena to characterize ecosystems from a food web perspective were presented by ulanowicz 1997 1986 several collections present illustrations of applying ena to investigate aquatic ecosystems belgrano 2005 wulff et al 1989 given the importance of reviews to advance a field leitch 1959 noguchi 2006 sheble 2017 this lack of recent and comprehensive reviews may be an impedance to the development and application of ena it also likely makes it more difficult for new investigators to quickly learn the approach and apply it the goal of the work presented here was to provide a high level systematic review and assessment of the state of ecological network analysis for the 2010 2016 period to accomplish this we used a bibliometric approach borrett et al 2014 edelmann et al 2017 moody and light 2006 specifically our objectives were to 1 identify major topics in ena both in terms of theoretical developments and practical applications 2 characterize the collaboration networks of teams working on science related to ena 3 determine the key references used by the community for this work and 4 summarize key features of the analyses given the historical development and use of ena we expected to find a large number of investigations of aquatic primarily marine ecosystems with a strong food web component dame and patten 1981 hannon 1973 wulff et al 1989 however we also anticipated finding an increasing use of ena to investigate urban metabolism and industrial systems kennedy et al 2011 zhang 2013 we also suspected that the collaboration networks would have distinct clusters based on research topics or methodological approaches 2 methods 2 1 corpus selection to identify recent ena publications we searched the web of science wos and elsevier scopus scopus databases for relevant publications between 2010 and 2016 ending on november 17 2016 our search focused on three key terms ecological network analysis network environ analysis and ecosystem network analysis we excluded articles discovered only due to the terms business ecosystems network analysis and molecular ecological network analysis because preliminary screening indicated that articles identified by these terms did not match the target literature fig 3 publications were identified if our key terms occurred in the record title abstract or keywords following the initial identification step we scanned the resultant titles and abstracts for relevance to the targeted ena literature and eligibility for this study for each eligible article we collected the available bibliographic information including title authors abstract keywords publication year source i e the journal conference or book of publication and sources cited we included search results from both wos and scopus to increase the likelihood of detecting the relevant literature and reduce known individual database biases and issues calver et al 2017 pautasso 2014 we selected not to use google scholar due to its tendency to include less relevant items for our study e g r help files course documents challenge of cleaning the data and other known database issues calver et al 2017 jasco 2009 meho and yang 2007 2 2 network models analyses to investigate the literature identified we constructed two different bibliographic network models borgatti et al 2018 börner 2010 edelmann et al 2017 moody and light 2006 van eck and waltman 2011 and manually categorized important features of each paper first we constructed a co term network to identify the key topics in this literature second we built a coauthorship network to characterize the collaborating teams of scientists conducting this work third we reviewed the papers for select key features including the system of interest whether a new model was presented and the methods of network construction and analysis 2 2 1 topics to identify the topic structure of the corpus we built a similarity network of the publications based on co word frequency nodes in this network are the papers and edges indicate a similarity in words used in the title abstract and keywords edges are weighted by the similarity of their term co occurrence using the standard tf idf formulation börner et al 2003 which discounts the similarity of common terms and favors more rare terms to help clarify the strongest relations we retained only those edges that were in the top 10 of the similarity value distribution we then exported this network to pajek batagelj and mrvar 1998 for layout and clustering network layout was done using the fruchterman reingold fr algorithm that aims to maximize the correlation between network geodesic distance shortest path between nodes and point distance in the layout space i e physical distance between each pair in the figure thereby highlighting the natural clusters and contours of the topic space fruchterman and reingold 1991 we fed the resulting coordinates from the network layout to a two dimensional kernel density smoothing procedure to generate the contours the topics that label the contour map were identified by network clustering using the louvain method blondel et al 2008 after a search of the parameter space we determined that a resolution parameter of 1 75 provided a balance between solution stability and detail we also examined a coarser solution with broadly similar results we then identified the 5 most heavily tf idf weighted terms with which to label the cluster centroids in the figure we placed authors at the centroid of the papers they have authored to characterize the shared knowledge foundations we also determined the common citations in each topic cluster common citations were defined as one of the top 10 publications most frequently cited in each cluster with a minimum requirement of at least 5 citations from within the cluster 2 2 2 collaboration we investigated the collaboration structure among ena researchers through a co authorship network built from the identified publications in this network nodes represent individual investigators and the edges are weighted by the number of works co authored as with topics we used pajek to generate a layout with the figure restricted to those with at least 2 publications for clarity we used the kamada kawai layout algorithm kamada and kawai 1989 which like the fr layout used in the term network seeks to minimize the distance between screen distance and geodesic distance but unlike the fr layout adds a node overlap restriction to avoid overlap this layout is adjusted by hand to array disconnected components in a compact manner nodes are sized proportional to the sum of their ties to other nodes i e weighted degree and color represents connected component membership 2 3 feature analysis to further describe the state of ena we conducted a more detailed feature analysis of the corpus each paper was inspected to determine 1 if the paper introduced a new model of a system or analyzed previously published models and then 2 classified the type of ecosystem considered food web biogeochemical cycling agroecosystem hydrologic and urban industrial economic we then considered the ena methods we categorized the network construction methods as being primarily based on a phenomenological or budgeting approach more specifically using the ecopath modeling technique linear inverse modelling or other methods like simulation models we also counted the number of papers that applied the general categories of ena methods fig 2 as well as whether or not the study included sensitivity or uncertainty analyses to support their results 3 results 3 1 publication volume sources our search of the wos and scopus databases yielded 215 unique records fig 3 we excluded 29 of these publications because an initial review of the title and abstracts indicated that the authors used the key terms in ways other than to indicate the type of ecological network modeling and analyses desired for example ivens et al 2016 used the term ecological network analysis to refer to their network study of ant community co occurrence and ant plant interactions this use of the term is more general than the historic focus on ecosystems that we targeted for this corpus we discovered and excluded several papers that used this more general meaning e g tu et al 2015 valverde et al 2015 zhao et al 2016 which has alternatively been referred to as network ecology borrett et al 2014 and ecological networks ings et al 2009 after this initial screening process 186 unique records remained listed in appendix a in supplementary material the publication rate appears to be fairly steady with an average of 26 publications per year 7 5 sd between 2010 and 2016 fig 4 a including 3 papers accepted for publication in 2016 but published in 2017 these records included 144 journal articles 10 book chapters 22 conference papers and 10 journal articles marked as reviews by wos or scopus the reviews were typically focused on other domains and included ena techniques in their consideration chen et al 2013 loiseau et al 2012 longo et al 2015 zhang 2013 the records were published in 60 distinct sources including high impact journals such as applied energy ecological indicators ecology letters environmental modeling software environmental science technology functional ecology marine ecology progress series and methods in ecology and evolution the majority of papers were published in the international journal ecological modelling 22 with the second most common outlet being ecological indicators 5 fig 4b these publication outlets represent a diverse set of wos categories including ecology environmental engineering environmental science marine and freshwater ecology and oceanography 3 2 topics analysis of the co term network revealed eight main topic clusters fig 5 the largest cluster n 55 focused on food webs and general ecosystem analysis cluster 1 frequently used terms include food web ecosystem trophic estuary biomass impact and flow the most common authors in the cluster include d baird b saint béat h asmus r asmus j heymans n niquil and s tecchio table 1 in this cluster the set of common authors was identified as 100 unique because they don t appear as common authors in the other topic clusters while not part of the set of most common authors the centroid of u scharler and r ulanowicz s publications appear on the edge of this cluster fig 5 a scan of the papers included in this cluster showed that many are focused on assessing coastal and marine food webs including the sylt romo bight baird 2012 baird et al 2012 2011 the baltic sea tomczak et al 2013 the humboldt current neira et al 2014 the seine estuary tecchio et al 2015 the nador lagoon in morocco bocci et al 2016 temporarily open estuaries in south africa scharler 2012 and the intertidal brouage mudflat saint béat et al 2014 part of the work in this cluster is motivated by efforts to apply ena indicators to determine good ecological status for management as defined in the eu marine strategy framework directive bocci et al 2016 brigolin et al 2014 chaalali et al 2015 there is a general sense that the results of ena can be used for ecosystem and fisheries management longo et al 2015 and efforts are underway to identify the best whole network metrics to summarize the ecosystem status there are also a number of papers in this cluster focused on improving and extending ena techniques for example lee et al 2012 2011 showed how to combine ena modeling and analysis with other techniques such as stable isotope enrichment and structural population models to enhance the model construction processes and strengthen the scientific discoveries chiu and gould 2010 suggested the use of baysean inference to improve the network model construction and chaalali et al 2016 developed a method to combine ecological niche modeling with lim network construction techniques further work investigated how the physical characteristics of an ecosystem may influence ena results niquil et al 2012 and showed how to use ena to trace and assess the negative impacts of a toxin as opposed to the more common use for the positive impacts of energy and nutrients taffi et al 2015 2014 the second largest cluster of papers n 46 is focused on urban metabolism and the interaction of socio economic and natural ecosystems cluster 7 terms such as energy metabolism utility economic sectors beijing and relationship are common authors with large contributions to this cluster include b chen b fath z yang y zhang table 1 papers in this cluster investigate alternative aspects of the urban metabolism of cities like beijing chen and chen 2015 liu et al 2010 b zhang et al 2016a b compare socio economic regions zhang et al 2016d and evaluate the effective integration and pollution reduction of eco industrial parks lu et al 2015 2012 zhang et al 2015a b several papers in this cluster apply the ena utility analyses fig 2 to determine the net or integral relationships among the socio economic sectors and control analyses to determine which sectors exert the most control on the system dynamics chen et al 2015 guo et al 2016 liu et al 2011a lu et al 2015 xia et al 2016 zhifeng et al 2014 there are also comparisons of ena results to other analytical tools such as energy or material flow analysis and more traditional input output analyses chen and chen 2015 liu et al 2010 the third largest cluster n 26 includes a set of papers that focused on systems theory general ecosystem properties and the ena methods cluster 5 common authors include s borrett b patten c kazanci d hines s whipple and q ma several papers in this cluster investigate evidence for hypothesized general properties of ecosystems borrett 2013 borrett and salas 2010 such as the dominance of indirect effects in ecosystems borrett et al 2010 fann and borrett 2012 ma and kazanci 2013 min et al 2011b salas and borrett 2011 this cluster also includes several papers focused on the development of methods and software these papers include a software tool ncna for constructing and analyzing network models focused on human dominated nitrogen biogeochemical networks min et al 2011a updates to the web based econet software schramski et al 2011 and the introduction of a new r package for ena called enar borrett and lau 2014 this cluster also has a clear connection to the environ concept and theory patten 1978 as a formal approach to studying environments kaufman and borrett 2010 schramski et al 2011 whipple et al 2014 while most of the papers in this cluster analyze previously published models there are two new models presented a ukranian pastoral food web buzhdygan et al 2012 and a pair of models for nitrogen biogeochemistry in the cape fear river estuary hines et al 2015 2012 papers in the fourth largest cluster cluster 3 n 22 exhibited a mix of theory method development and applications but there was a general theme of assessing system sustainability from the perspective of the energy or matter flows terms that link papers in this cluster include sustainability performance indicator information diversity and robustness examples of work in this cluster include an assessment of the resiliency of the heiha river basin and the trade offs it experienced between system efficiency and redundancy kharrazi et al 2016 and an assessment of the success of mixed crop and livestock systems that from a nitrogen flow perspective found a low degree of integration in the systems stark et al 2016 there are also a number of ena applications to urban bodini 2012 bodini et al 2012 chen et al 2010a industrial layton et al 2016a and economic systems huang and ulanowicz 2014 there are again papers to improve the ena methods including work to revise some analyses so as not to require a steady state assumption schaubroeck et al 2012 and to better understand the sensitivity of the whole network metrics to model perturbations mukherjee et al 2015 both of which remain important issues for the field the remaining four clusters in the co term network range in size from 19 to 4 papers cluster 8 n 19 is built around terms such as water wetland basin control utility and management research in this cluster includes the trace of physical water exchanges in wetlands such as the baiyangdian basin mao et al 2015 2010 yang and mao 2011 analyses of virtual water trade when considering the water embedded in economic products such as agricultural crops fang and chen 2015 mao and yang 2012 yang et al 2012 and investigations of the energy water nexus duan and chen 2017 wang and chen 2016 yan and chen 2016 papers in cluster 6 n 8 share distinctive terms such as risk and risk assessment much of this work is an application of ena to assess environmental risk of economic development projects such as dam construction chen et al 2011 2010b cluster 4 n 7 is joined by terms like energy security supply and stability and includes work like a systems assessment of a liquid natural gas distribution system in a region lu et al 2016 shaikh et al 2016 the smallest cluster n 4 cluster 2 is linked by terms such as rate remove and lake but the internal topics are less coherent for example there is an investigation of nitrogen cycling in the laurentian great lakes small et al 2014 that is more like the biogeochemistry models and analyses we have seen in other clusters as well as an effort to link allometric principals to ecological flow networks zhang and wu 2013 to better understand the similarities and differences among the topic clusters we identified the most commonly cited papers in each of the network clusters table 2 twelve papers were commonly cited in more than one cluster indicating their broader impact across the ena domain the most frequently cited source is a review paper that captures both the early intellectual development of the field and summarizes several of the common methods fath and patten 1999 while this paper was key for multiple clusters it was not a common citation of the largest cluster 1 focused on food webs three sources were common citations in three of the co term clusters these include one comprehensive monograph on ecosystem organization with a strong trophic perspective ulanowicz 1986 an expository paper that provides more detail about methods to build the core ecosystem network models fath et al 2007 and an early example of applying ena to investigate urban water metabolism zhang et al 2010a ulanowicz 1986 was influential in the large food webs cluster 1 the flow and sustainability cluster 3 and the systems ecology cluster 5 but is not as commonly cited in the second largest group focused on urban metabolism 7 in fact 56 of the highly cited literature in the food web cluster was unique to this cluster and 80 of the risk assessment cluster was distinct the two oldest papers commonly cited were odum s 1969 strategy of ecosystem development and wolman s 1965 the metabolism of cities further there were three papers from the 1970s that were still influencing the field finn 1976 hannon 1973 patten 1978 thirty five out of the 47 highly cited sources appear to be influential in only one cluster and may provide insight to some of the important differences among the clusters for example two papers on the ecopath software christensen and pauly 1992 christensen and walters 2004 and one on using inverse methods vézina and platt 1988 were commonly cited only in the food web cluster which may be an indicative of a difference in the tools and methods of this cluster 3 3 collaboration structure we identified 347 unique authors of the 186 papers in the corpus these authors are the nodes of the collaboration network fig 6 which identifies 8 main collaborative components the largest component n 195 56 2 includes authors that were associated with both the food web topic cluster 1 and the urban metabolism topic cluster 7 within this component several smaller working groups appeared due to the higher frequency of co authorship for example there appeared to be a strong collaboration amongst y zhang z yang h zheng g liu m su b chen s chen and b fath there also appeared to be a strong working group that includes n niquil b saint béat j lobry g lasalle a chaalali and s tecchio within this component there were three more weakly linked subcomponents coauthorship among d baird b fath and u scharler created a bridge between two elements and a co authorship with s tecchio created the second bridge into a subcomponent with j j heymans the next largest component n 20 included c kazanci q ma b patten and s borrett the third largest component n 15 included r ulanowicz and it constructed from two papers while several distinct components emerged in our period of observation with some apparently stronger and productive working groups these data suggest a generally well connected collaboration structure as is common in science collaboration networks the collaborator degree distribution of ena in our corpus appears exponential the median number of collaborators was 6 while the mean number of collaborators was 9 3 however some investigators were highly collaborative for example within our corpus n niquil had 96 co authors b saint béat was the second most collaborative with 61 co authors in the corpus this high co authorship is despite the fact that the most co authors on a single paper was 26 the author addresses indicate that ena work is distributed among 31 countries fig 7 the countries with the most frequent contributions include austria china france and the united states of america 3 4 feature analysis new models were presented in 103 55 of the papers discovered and the number in each type of system varied from year to year fig 8 in alignment with the previous results the food web and biogeochemical cycling ecosystem models and the urban industrial and economic models were most frequent over our observation window the number of new urban industrial and economic models surpassed the number of new food web and biogeochemical cycling ecosystem models the most frequently reported analyses other than number of nodes or edges across all types of systems were the structure analyses in 106 papers 57 flow analyses including both the input output analyses 98 papers 53 and information based analyses 67 papers 36 including ascendency metrics table 3 were also common the control analysis and impact methods utility analysis and mixed trophic impacts were used more frequently in papers investigating urban industrial and economic models only 33 papers 18 included a sensitivity or uncertainty analysis of the results presented 4 discussion two principal findings result from our analysis of the ena publications between 2010 and 2016 first while there are a variety of topics being investigated with this approach the majority fall either into a cluster focused on food webs or a second cluster focused on the sustainability of socio ecological systems including studies of urban metabolism the majority of the food web models investigated aquatic and primarily marine ecosystems and examined the structure and internal relationships among the ecosystem species or assessed how they differ due to time space or changes in specific drivers like an anthropogenic impact we also discovered a few terrestrial ecosystem applications including one to assess the sustainability of agricultural systems while there is a long history of ena development and applications tied to trophic studies the recent applications to socio economic and socio ecological systems is an important element of the field investigators are finding many creative ways to apply ena a second principal finding is the strong collaborative nature of the field within our observation window the majority of authors were linked into a single large component our results depend on the specific time period observed but the key finding is that the authors in the domain are currently highly collaborative and well connected when evaluating the quality of a bibliometric review it is essential to consider the success of the search in identifying the relevant literature it is possible to have both errors of commission including papers that really do not belong in the target set and errors of omission missing papers in the literature that do belong in the set due to our initial screening and subsequent feature analysis we are confident that our corpus does not contain major errors of commission we included conference proceedings in our corpus 12 to better capture the state of the field by being more inclusive in the type of scholarship included this might have introduced a bias to the results as some conference papers may be turned into similar journal articles that are also included in the corpus this potential double counting would be a type of error of commission and would inflate the importance of the topic or author contribution a review of the author and titles of the corpus indicates that only one conference proceedings was clearly a duplicate layton et al 2016a 2015 thus we expect that the effect of this potential double counting was minimal it is more difficult to assess errors of omission to increase our likelihood of identifying the relevant literature and decrease errors of omission we included searches of both the wos and scopus databases however we are confident that we missed identifying some number of relevant papers for example our search failed to find a study applying ena methods to investigate the ecosystem stoichiometry c n p of the twin cays barrier reef ecosystem in belize scharler et al 2015 as well as an application of ena to investigate the performance of economic supply chains allesina et al 2010 we also failed to find a couple of papers by kharrazi et al 2016 2014 2013 that applied the information based ascendency flow analysis of ena in each of these cases 1 the work was an application of the ena methods to specific systems 2 the papers appear to be written for applied audiences and 3 the papers were missed because the authors did not include the targeted search phrases in their keyword lists titles or abstracts in addition we estimated that we missed 14 papers published in 2016 due to finalizing our search for this analysis on nov 17 2016 9 were conference papers published in energy procedia despite these important omissions given our working knowledge of the field and an informal comparison of our results to those found by google scholar we suspect that our error of omission rate was small 4 1 ena insights a number of insights emerge from this work about the practice of using ena which we consider in three groups model construction analysis and applications 4 1 1 model construction the first step in any application of ena is to construct the network model as noted in the introduction there are multiple ways to construct an appropriate model to be analyzed with ena fath et al 2007 wulff et al 1989 many of which are apparent in the literature we reviewed these model construction methods include building nutrient or energy budgets using phenomenological approaches hines et al 2015 2012 scharler 2012 ulanowicz 1986 xia et al 2017 or employing theoretical energetic constraints for food webs banerjee et al 2016 heymans et al 2011 tomczak et al 2013 linear inverse modeling niquil et al 2011 saint béat et al 2013b small et al 2014 taffi et al 2015 tecchio et al 2016 van oevelen et al 2010 vézina and pace 1994 and creating more mechanistic dynamic models and simulations baird 2011 lee et al 2012 different methods may be more common or appropriate for different applications for example the energetic and trophic constraints built into ecopath models may work well for food webs but they are typically not appropriate for urban metabolism models regardless of the method used creating ecosystem networks is still a model construction process that should follow modeling best practices haefner 2005 jørgensen and bendoricchio 2001 schmolke et al 2010 including a clear evaluation of the model quality both in terms of model structure and the analytic results dame and christian 2008 2006 deehr et al 2014 sensitivity and uncertainty analyses assist with model evaluation and enable investigators to make stronger inferences about the system analyses our review shows that applications of these techniques are becoming more common in ena these analyses have two main forms the first form focuses on the initial conceptual model and considers the impact of issues like node aggregation lumping on the ena results this aggregation may occur when researchers have limited species specific data for food webs and therefore group species into functional groups e g large phytoplankton bacteria for example several studies have found that ena indicators were sensitive to different node aggregation schemes and especially to the representation of detritus and other forms of non living resource pools in food web ecosystem models abarca arenas and ulanowicz 2002 allesina et al 2005 baird et al 2009 johnson et al 2009 for example fath et al 2013 discovered that some network metrics were less affected by their aggregation scheme for the sylt rømø bight model while other metrics exhibited larger differences the aggregation problem is an old one in ecological modeling cale et al 1979 gardner et al 1982 and one that yields few simple guidelines despite the potential influence of aggregation issues fath et al 2007 argued that for ena applications to be most useful as a systems analysis tool it is essential to include all components of the ecosystem in the model even if this means creating aggregated functional groups a second form of sensitivity and uncertainty analysis considers the network structure largely fixed and focuses on the uncertainty in the flux magnitude estimations e g model parameterization ayers and scharler 2011 guesnet et al 2015 hines et al 2018 2015 kones et al 2009 this is largely accomplished by selected flux perturbations to an initial model using a monte carlo approach bodini et al 2012 heymans et al 2016 salas and borrett 2011 or using monte carlo methods coupled to a modeling procedures such as a regionalized sensitivity analysis borrett and osidele 2007 or linear inverse modeling chaalali et al 2016 guesnet et al 2015 kones et al 2009 pacella et al 2013 to sample the space of plausible network model parameterizations these analyses have been used to show that ena whole network metrics tend to be more constrained than the estimated network uncertainty and that some indicators are more robust less sensitive to this uncertainty than others kaufman and borrett 2010 kones et al 2009 the development and application of methods to perform sensitivity and uncertainty analyses for ena studies is a critical step to evaluating the quality of the models and analytical results it is also essential to make ena more useful for ecosystem assessment and environmental management applications because investigators can make stronger inferences about a selected network metric compared to a threshold borrett et al 2016 hines et al 2018 2016 or the differences between systems being compared with ena ayers and scharler 2011 hines et al 2018 2015 saint béat et al 2013a 4 1 2 analyses ena is a set of related analytical tools that build upon ideas in the broader area of network science brandes et al 2013 newman 2010 including social network analysis wasserman and faust 1994 economic input output methods hannon 1973 leontief 1966 and information theory rutledge et al 1976 ulanowicz 1986 one challenge of using ena is that there are a large number of different methods that have developed over its more than four decades of development the advantage of this method diversity however is that there is greater flexibility and choice one way that reviews such as this one might help advance the field is by 1 focusing on methods rather than topic 2 highlighting the applications of the methods and 3 identifying characteristics of how different ena models were implemented we hope that through this elucidation the choices researchers must make will become more clear another way that reviews contribute is by formalizing the boundaries and linkages between methods characterizing the extent to which they vary and identifying tools for implementation to that end fig 2 presents a conceptual model of different groups of methods in ena that builds on previous categorizations fath and patten 1999 at the base are a collection of structural methods that typically ignore the edge weights and include classic food web descriptors like connectance i e network density few of the ena structural methods are unique to the field most are shared in common with other domains in network science however the pathway proliferation concept underlies many of the other ena methods borrett et al 2007 borrett and patten 2003 patten 1985b flow analyses builds on the structural analyses and considers the edge weights finn 1976 gattie et al 2006 kay et al 1989 latham 2006 patten et al 1976 ulanowicz 1986 flow methods can be classified into two types methods that build directly on economic input output techniques fath and patten 1999 finn 1976 patten 1985b patten et al 1976 szyrmer and ulanowicz 1987 ulanowicz and kemp 1979 and a set of analyses that draw on information theory which includes the ascendency set of analytics hirata and ulanowicz 1984 patricio et al 2004 ulanowicz 1980 our review suggests that flow analyses are the most commonly used methods in our corpus storage analyses are mathematically very similar to flow analyses but also account for node weights to represent the amount of energy or matter stored in a node barber 1978 fath and borrett 2006 fath and patten 1999 schramski et al 2011 ulanowicz and abarca arenas 1997 in many ecosystem models storage is equivalent to the biomass of the species or functional group these methods are much less often used in our corpus the environ control and what we are calling impact methods fig 2 build upon the flow or storage analyses the specific environ methods operationalize patten s environ concept for investigating the input and output environs of the system members patten 1981 1978 which have been used to investigate the ecological niche concept patten and auble 1981 and to quantify the coupling of steps in biogeochemical cycling hines et al 2015 control analyses indicate which nodes in a network exert more or less control upon the other node s flow across the network chen and chen 2015 dame and patten 1981 fath 2004a hines et al 2016 schramski et al 2007 2006 the impact methods focus on the net or integral pairwise impact of one species in the network on another and were well used in our corpus 23 this includes mixed trophic analysis gonzález et al 2016 ulanowicz and puccia 1990 and a similar but more general analysis termed utility analysis fath and patten 1998 patten et al 1991 zhang et al 2016c scharler and fath 2009 provide a detailed comparison of these closely related impact methods 4 1 3 applications this review highlights the adaptable nature of ena the modeling approach and analyses have been applied to a wide variety of system types and used to address a variety of kinds of questions from theoretical issues to applications to specific ecosystems the field launched with a strong trophodynamic emphasis belgrano 2005 dame and patten 1981 finn 1976 hannon 1973 wulff et al 1989 that continues today as ena network metrics are being considered as indicators to assess marine food web status bocci et al 2016 brigolin et al 2014 chaalali et al 2016 heymans and tomczak 2016 tomczak et al 2013 several papers have investigated the power of indirect interactions to alter the net relationships among species in the food webs banerjee et al 2016 lassalle et al 2011 rodríguez zaragoza et al 2016 which seem to become more positive when the model traces essential resources in food webs or biogeochemical cycling borrett et al 2016 however creative applications of ena demonstrate that it can be used to trace the negative effects of toxins as well taffi et al 2015 the methods are also being used to assess the functioning and sustainability of technical economic and socio ecological systems for example investigators have used ena ideas to determine if designing industrial networks using ecosystem principles lead to more sustainable industries layton et al 2016a b c others have used ena as a tool to investigate the energy water nexus in socio ecological systems duan and chen 2017 wang and chen 2016 yan and chen 2016 in fact applications to socio ecological systems chen et al 2015 guo et al 2016 liu et al 2011b zhang et al 2016d grew faster than applications to food webs in our study period fig 8 the individual applications are interesting on their own and collectively this review illustrates a broad number of ways to use the ena tools we suspect that these uses will grow as creative scientists continue to develop and explore the tool set 4 2 collaboration the coauthorship network shows that the investigators in this domain are highly collaborative these collaborations have clusters that tend to be focused on specific topics and the work groups tend to have a spatial component that may influence the outcomes de bont and lachmund 2017 however there are also many collaborations that extend beyond these working groups those authors who appear in multiple work groups function as social bridges that enable the diffusion of ideas and innovations further the data intensity and diversity of technical expertise required to successfully apply ena may encourage larger and more varied teams of scientists the observed co authorship structure has a strong temporal component and informs us about the collaborative structure within the observation window 2010 2016 if we were to extend our observation period we would expect to see several of the smaller components join with the giant component for example ulanowicz has coauthored papers with baird baird and ulanowicz 1989 ulanowicz and baird 1999 scharler fath et al 2007 ulanowicz and scharler 2008 and niquil niquil et al 1999 in the past similarly fath coauthored a number of papers with patten before our observation window borrett et al 2007 fath et al 2004 fath and patten 1999 1998 more recent papers would also join the subcomponent with borrett to authors in the largest component hines et al 2018 rakshit et al 2017 similarly two of the ena papers we initially missed in our search would have joined two of the smaller components to the largest author component the scharler et al 2015 paper would have linked the author cluster with ulanowicz and the kharrazi et al 2013 connects the component with kharrazi the core conclusions from this view of collaboration is that this science community is relatively tight knit in this domain thus we expect that ideas and innovations propagate quickly across the community this is reinforced by the finding that some authors are the most common across several topic clusters table 1 despite this connectivity it is important to notice that 1 clear common working groups are still apparent within the components and 2 the large food web topic cluster does not have a common author that appears in the other topic clusters a limitation of this study is that it does not show how well connected this community is to the broader domains of network ecology or general ecology environmental sciences or network science 4 3 challenges opportunities for ena while the use of network models and concepts continues to grow by about 0 2 per year throughout the ecological literature borrett et al 2014 lau et al 2017 the publication rate for ena appears fairly steady between 2010 and 2016 the growth in network ecology is driven by the application of network ideas to a variety of different complex ecological problems these applications include showing how genotypic variation in a foundational species like the narrowleaf cottonwood tree can determine the community composition of macroarthropods that live on the tree lau et al 2016 revealing the small overlap in venus flytrap dionaea muscipula prey and pollinators youngsteadt et al 2018 finding the ecological significance of animal social networks kurvers et al 2014 and considering how organisms move in space dale and fortin 2010 jacoby and freeman 2016 saura et al 2014 while there are clearly some new and interesting applications of ena and more opportunity for expansion the field has had over 44 years to mature in addition the model type is more restrictive than many other network models e g it traces a single thermodynamically conserved currency such as carbon or nitrogen this restriction provides the analysis more power but limits the kinds of system to which the approach may apply other issues that may be hindering the potential of ena include the lack of systematic and critical reviews the large volume of original data required and the large and complex sets of analyses that make it difficult for new investigators to know which method to apply when and for what purpose two additional issues may be impeding the development of the science around ena language barriers and the requirements for tacit knowledge naming conventions may present challenges to the use and dissemination of ena for example scientists within the ena field conceptualize the phrase ecological network analysis and the acronym ena to mean a specific set of approaches measures and data expectation it is unclear if these ideas penetrate into the larger community of ecologists and environmental scientists one indicator that this may not be the case is that while searching the literature for this study we observed that the term ecological network analysis is increasingly being used more generically by scientists beyond the community cited here this generic use may dilute the power of ecological network analysis as a key term however we advocate strongly that the community continue to use the ecological network analysis phrase as a key term in its publications as it will assist with finding the relevant literature which may promote an ease of communication and research sheble et al 2016 at a more detailed level within the lexicons of ena research there remains a jumble of terminology and mathematical notation with the same or similar concepts expressed in different ways with different types of ena approaches in some cases it appears that the software tools as well as publication texts propagate linguistic differences there is opportunity to streamline terminology to facilitate the continued use of the approach expose similarities in approaches and more cohesively communicate to a wider audience the commonalities that enable researchers well versed in ena to recognize strong similarities amongst this family of methods this task could be assisted with additional reviews and synthesis papers and translation aids that enable an extent of multilingualism much in the way that some scientists develop levels of comfort with both network and graph theory the second impediment concerns the hidden knowledge embedded in ena practice ena is like many newer procedurally oriented research practices in that it is most often learned in the contexts of laboratories and research teams or through mentorships leahey 2008 both the methods and the intricacies of decisions made and options available are transmitted from mentors to learners tacitly through the experience of working on a project klemmer et al 2006 polanyi 1967 to counter challenges imposed by irregular naming conventions and transmission of methodological knowledge primarily in the practice of research it could be helpful for ena researchers to question work to codify and write about research and data practices for broader audiences for example researchers could write for more general ecology journals journals targeting complex network modeling and analysis and those that target more application and education oriented audiences another challenge and thus opportunity for ena research is focused on the large number of network metrics produced by the analyses borrett and lau 2014 kazanci and ma 2015 lau et al 2017 each metric was constructed to describe a selected feature of the systems and many appear to relate the system state in the dipsr framework burkhard and müller 2008 however the large number of metrics can be overwhelming e g the get ns function in the enar software returns 82 whole network metrics and we know from both the underlying mathematics and statistical analyses borrett and osidele 2007 kazanci and ma 2015 that not all of the metrics are provide independent information about the system while in some theoretical work and applications it will continue to be useful to have the full range ena network metrics it might also be useful to identify a smaller subset that provide a user or manager with more robust and independent information participants at the use of coastal and estuarine food web models in politics and management the need for an entire ecosystem approach to prevent crises workshop held at the alfred wegener institute helmholtz zentrum fur polar und meeresforschung in sylt germany sept 2017 considered this issue however even if the community can identify a key subset of metrics there remains the challenge of constructing strong indicators from these metrics dale and beyeler 2001 for example we generally do not have clear or consistent expectations with supporting evidence as to how the metrics should or do respond to different stressors luang et al 2014 ludovisi and scharler 2017 is ena up to the task of environmental assessment and guidance of management it has solid theoretical foundations and this review shows that this foundation is being built upon by a dedicated and cohesive community of scientists developing and applying the science in a diversity of ways this is a promising start however there remains a need for the community to collaboratively build and consistently follow best practices for model construction fath et al 2007 including rigorous model evaluation and the application of sensitivity and uncertainty analyses that enable stronger inferences there is also effort required to transform network metrics from system state descriptors into good indicators that have clear meaning for management with known and reliable responses to changes in the system state dale and beyeler 2001 given the findings of this review we are optimistic for the future of ecological network analysis acknowledgements srb acknowledges and appreciates the support from both the duke network analysis center and the university of north carolina wilmington this collaborative work was supported in part by a uncw research reassignment preliminary results in this paper were presented at workshop titled use of coastal and estuarine food web models in politics and management the need for an entire ecosystem approach to prevent crises at the alfred wegener institute helmholtz zentrum fur polar und meeresforschung in sylt germany sept 2017 we are grateful for the initial comments critiques and discussions that improved the work appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 04 020 appendix a supplementary data the following is supplementary data to this article 
25278,developing effective conservation plans for at risk species requires an understanding of the relationship between numbers of breeding adults and their subsequent offspring in particular establishing the degree to which density dependent effects limit population size can be difficult due to errors in the data themselves uncertainty in model parameters and possible misspecification of model structure here we develop a bayesian model averaging framework to fit four simple models of adult offspring production and estimate the probabilities that negative i e decreasing survival with increasing density and positive i e allee effects density dependence exists as an example we analyzed 48 at risk populations of anadromous chinook salmon oncorhynchus tshawytscha from the northwestern united states we found strong evidence that more than two thirds of the populations exhibit negative density dependent effects of adults this result was somewhat unexpected given the large reductions in adult numbers relative to historical benchmarks indicating that carrying capacity of spawning habitat has been reduced considerably approximately two thirds of the populations also had non zero probabilities of positive density dependent effects of adults which could suggest that cumulative losses of spawning adults over the past century has led to decreased nutrient and energy subsidies from semelparous carcasses and diminished bio physical disturbance from nest digging activity importantly our analysis highlights the utility of bayesian model averaging in a conservation context wherein errors in choosing the best model may have more severe consequences than errors in estimating model parameters themselves keywords density dependence bayesian model averaging management strategies allee effect compensation depensation salmon 1 introduction one of the cornerstones of conservation biology is establishing the relationship between the numbers of parents and the offspring they produce in particular the degree to which organisms are affected by population density has important implications for individual fitness and population growth negative density dependence ndd occurs when density is relatively high and any further increases in density lead to increased competition for resources e g food breeding locations or transmission of diseases ultimately causing reductions in per capita survival hixon et al 2002 brook and bradshaw 2006 conversely positive density dependence pdd or the allee effect arises when density is relatively low and the loss of more individuals causes decreased per capita survival because of cooperative foraging or defensive behaviors decreased probability of finding a mate or combinations of these factors courchamp et al 1999 berec et al 2007 gregory et al 2010a the strength of both ndd and pdd in wild populations has practical management implications for example the presence of ndd could indicate limited habitat availability i e insufficient total area whereas the existence of pdd might suggest a high degree of habitat fragmentation rectifying those two types of habitat deficiencies could require rather different actions when combined with historical knowledge about the population insights about the combined roles of ndd and pdd are also useful for reintroduction planning anderson et al 2014 understanding whether ndd and pdd occur and if so to what extent is thus particularly valuable for determining the best options for population management and the conservation of at risk species density dependence has been studied extensively in fish populations because of its importance to both the management of healthy and economically valuable stocks and the conservation of imperiled populations liermann and hilborn 1997 barrowman and myers 2000 barrowman et al 2003 in classical fisheries management ndd within a stock implies parental biomass should be harvested to the point where the surplus production of new recruits to the fishery is maximized relative to replacement hilborn and walters 1992 conversely the degree of pdd mortality will determine the rate at which overfished stocks will recover when harvest is reduced most conservation practitioners concentrate on the possible existence of pdd however ndd at relatively low abundance can exist implying diminished carrying capacity from factors like habitat loss modification or the presence of non native species achord et al 2003 but this is often ignored in conservation contexts models of population dynamics offer a formal means for estimating both positive and negative density dependence boyce 1992 for example beverton and holt 1957 and ricker 1954 models of density dependence have been used to estimate the relationships between parents and offspring for decades approaches allowing for flexibility in curves shapes but not process based such as splines or gaussian process models have also been developed bravington et al 2000 munch et al 2005 meanwhile barrowman and myers 2000 introduced a form of piecewise regression model known as the hockey stick hs model which is similar to the ricker and beverton holt curves the hs model offers potential advantages over these other models in a conservation context because it provides more conservative estimates of the maximum density independent survival i e slope at the origin and carrying capacity barrowman and myers 2000 in addition the breakpoints in the hs segments may provide natural reference points for management decisions however the hs model does not allow for pdd although statistical modeling is a powerful tool three main types of uncertainties can hinder our ability to infer the true underlying relationship between parents and their offspring first observation errors arise in the form of sampling and measurement errors second model parameters are rarely known without error and instead must be estimated from the data third uncertainty about the structure of the model itself affects inference about the form of the parent offspring relationship the first two concerns are often addressed through appropriate sampling designs and explicit consideration of both process and observation sampling errors however possible misspecification of a particular model is typically ignored and instead the best model is chosen based on some model selection measure such as akaike s information criterion burnham and anderson et al 2002 in such cases two models with nearly identical support from the data could produce widely divergent predictions especially when confronted with new data pascual et al 1997 richards 2005 as a guard against this likely possibility model averaging ma offers a formal means for explicitly addressing model selection uncertainty in problems of inference and prediction burnham and anderson et al 2002 wintle et al 2003 in particular model averaging can produce more robust estimates by combining results from an ensemble of multiple independent models banner and higgs 2017 as a cautionary note however averaging expectations from models that are capable of producing an important spectrum of different results may confuse interpretations galipaud et al 2014 cade 2015 thus the set of models to consider should be carefully chosen pacific salmon oncorhynchus spp are important to human economies and the ecology of coastal ecosystems across the northern pacific rim schindler et al 2003 fisheries for salmon are worth hundreds of millions of us dollars annually nmfs 2013 salmon also act as ecosystem engineers by modifying benthic habitats through nest digging activity moore 2006 and serve as keystone species in food webs as food for fish mammals birds and insects helfield and naiman 2006 in many coastal watersheds across western canada and the us however pacific salmon populations have been reduced to mere fractions of their historical abundances due to changes in habitat hydropower development overharvest and changing climate ruckelshaus et al 2006 literature also suggest that pacific salmon population are susceptible to allee effect through predation disease and decreased mate finding abilities at low densities quinn et al 2014 godwin et al 2015 thus obtaining a proper understanding of whether ndd pdd or both occur among at risk salmon populations and estimating related reference points is necessary for determining the best recovery strategies here we examined the strength of ndd and pdd among 48 populations of chinook salmon o tshawytscha from the northwestern usa that are currently listed as threatened under the us endangered species act to do so we simultaneously considered four different piecewise linear models to characterize various forms of density dependence fig 1 1 unrestricted density independent 2 allee effect only pdd 3 carrying capacity only ndd and 4 both pdd and ndd piecewise linear models tend to provide better estimates of per capita productivity at low population sizes and offer more conservative estimates of mortality rates that lead to extinction in addition we addressed both parameter and model uncertainty within a unified framework through bayesian model averaging bma which allowed us to easily combine predictions and uncertainties across all four models 2 material and methods 2 1 allee hockey stick model and nested sub models barrowman and myers 2000 hockey stick hs model assumes the number of offspring increases linearly up to an asymptote beyond which it is independent of parental abundance for a given population the model is described by two linear functions above and below some threshold level of parental abundance p c 1 o t β p t i f p t p c k i f p t p c where β is the density independent per capita reproductive rate p t is the number of parents breeding in year t at parental abundance values above p c ndd effects dominate and restrain the number of offspring to k the carrying capacity as p c approaches infinity the degree of density dependence goes to zero and because of linear growth there is no limit to population size to allow for pdd allee effects at relatively low levels of parental abundance we modified the original hs model barrowman and myers 2000 to allow for a third linear segment this new allee hockey stick ahs model allows growth rates to become depressed when parental abundance is less than some threshold p d 2 o t β 1 p t i f p t p d β 1 p d β 2 p t p d i f p d p t p c k i f p t p c where 0 β 1 1 β 2 k β 1 p d β 2 p c p d and p d and p c are the breakpoint thresholds respectively by fixing some parameters at zero or infinity the ahs model reduces to three less complex models each with contrasting assumptions about the occurrence of ndd and pdd fig 1 the first is for unrestricted or linear growth l model where β 1 0 p d 0 a n d p c such that 3 o t β 2 p t the second is for an allee effect only al model where p c and 4 o t β 1 p t i f p t p d β 1 p d β 2 p t p d i f p t p d the third is the original hs model with carrying capacity only such that β 1 0 p d 0 k β 2 p d and 5 o t β 2 p t i f p t p c k i f p t p c 2 2 parameter estimation and model weighting here we used a 2 step procedure where each model is first fit independently to data using the sampling importance resampling sir algorithm rubin 1988 and then results are averaged across models the sir algorithm we used to approximate the posterior distribution by using an importance function to resample parameter draws from a proposal distribution is equivalent to moore 2006 and detailed in appendix a for a given model the marginal likelihood can be expressed as the product of the prior model probability and the likelihood integrated over the entire parameter space for instance the corresponding equation for model m 1 is p m 1 y p m 1 p θ m 1 p y θ m 1 across models we normalized the marginal likelihoods so that they could be interpreted as posterior model probabilities i p m i x 1 rubin 1988 there are several upsides and downsides of bayesian estimation in sir versus other techniques such as mcmc as a positive calculating the expected marginal likelihood is straightforward in sir because the likelihood of each draw can be easily saved which is not possible in software implementing mcmc such as winbugs lunn et al 2000 jags plummer 2003 or stan stan development team 2016 second the sir algorithm does not require a burn in period or assessment of mcmc diagnostics for convergence however the utility of sir is somewhat limited for complex models beyond 4 5 parameters because sampling can be inefficient for all models presented above we assumed that the residual error was lognormally distributed we chose weakly informative uniform priors that were shared among the four models whenever possible table 1 an r package containing functions to fit the 4 models together with the dataset discussed below is freely available on github at the following address https github com guillaumebal bal et al 2018 bma density dependence 2 3 model application for management purposes pacific salmon species are grouped into evolutionarily significant units esus defined as a group of salmon that 1 is reproductively isolated from other conspecific populations and 2 represents an important component in the evolutionary legacy of the species waples 1991 we estimated the strength of density dependence among 48 chinook salmon populations within 3 distinct esus from washington idaho and oregon in the northwestern usa fig 2 these esus represent different life history types allowing us to compare the strength of density dependence across life histories for example chinook salmon within the puget sound esu are ocean type these juveniles spend less than 1 year in fresh water before migrating to the ocean in contrast salmon from the snake river and upper columbia esus are stream type and spend 1 full year in fresh water before migrating to sea taylor 1990 we used the total number of spawning adults in a given year as our estimate of parent abundance because salmon from the same cohort mature at different ages our estimates of offspring are then the sum of subsequent adults that were born in a given year but that vary in age and return over sequential years e g the offspring of snake river stream type adults that spawned in 2000 return 3 6 years later in 2003 2006 all data used here were compiled by the national marine fisheries service to ensure time series were long enough to potentially detect positive density dependence brook and bradshaw 2006 gregory et al 2010b we restricted our analysis to those populations with at least 20 years of data and no more than 5 missing values within that period table 2 this resulted in time series length ranging from 20 to 54 years full details of the fits of the four models are provided in appendix b 3 results for both life history types across the three esus we found the strong support from the data for a model with only ndd fig 3 a the median posterior model probabilities were 0 65 and 0 45 for ocean and stream type chinook salmon respectively we found little evidence for models containing only pdd allee effects and models that included both pdd and ndd had median probabilities of being the best equal to 0 13 and 0 011 for ocean and stream type salmon respectively among populations within a specific life history type however the relative support for the different models varied considerably fig 3b although there were a few populations whose model probabilities were evenly split among the four model forms e g 4 16 most populations showed strong support in favor of one particular model for ocean type chinook salmon most populations showed strong indications of ndd but a few populations had evidence for either form of density dependence e g 1 4 8 14 15 evidence for ndd was rather strong for stream type chinook and notably the evidence for models with both pdd and ndd was reasonably strong in fewer populations e g 39 42 for each population the model averaged relationship exhibited subtle to rather significant departures from the best model depending of the relative credibility of the models for example the best models selected for big creek the south fork of the salmon river east fork and the south fork of the salmon river mainstem i e populations 23 39 40 in table 2 were the l model hs model and l model respectively applying bma to estimate the shape of this curve may yield a result very similar to the single best model but it can also result in more conservative results fig 4 in the case of big creek a simple model selection analysis would select a linear relationship whereas the shape coming from bma exhibits ndd when the population reaches 409 fish although the departure from the replacement curve is on average weak in the south fork of the salmon river east fork pdd is highly likely when the population size falls under 27 individuals for the south fork of the salmon river mainstream however there is very little difference between the best and bma models although we found no discernable link between the data support for an allee effect in a population and the length of the corresponding time series we did observe a positive relationship with the ratio of the observed lowest to highest counts within a time series i e a measure of relative historical stock depletion fig 5 4 discussion our results reveal two important messages regarding the role of density dependence in the population dynamics of chinook salmon in the pacific northwest first we found that linear relationships between offspring and parents with no density dependence were supported especially within the snake river esu median model posterior probability 0 53 whom the rivers have experimented the strongest historical depletions according to the ratio of minimum over maximum spawners abundances table 2 this suggests that some populations from the columbia river watershed have still not recovered from the overall reduction in parental abundances compared to historical numbers with a few exceptions we found strong support for models with ndd median model posterior probability 0 65 in populations from the puget sound area our results further support ongoing efforts in this region to increase carrying capacity through improvements to freshwater spawning and rearing habitats second the existence of pdd among these chinook salmon populations is possible which agrees with previous studies of other salmon species liermann and hilborn 1997 barrowman et al 2003 the time series used in this study have 20 to 54 years of data which are similar to previous publications attempting to detect the presence of allee dynamics brook and bradshaw 2006 gregory et al 2010b although longer time series are always preferable we found little relationship between time series length and support for allee dynamics furthermore most of the populations are at the low end of their historical sizes such that the ratio of the minimum to maximum spawners ranges from 0 to 20 with about 50 of the populations below 2 5 interestingly we found that the support for allee effects is positively correlated with this ratio the support for allee effects in populations that have been less depleted may result from a lack of data at extremely low abundances wherein the allee model produces different estimates from the linear or hs model although support for allee effects is weak overall and we cannot identify the exact cause some reasonable hypotheses exist first salmon gain about 90 of their adult biomass in the ocean and therefore act as net importers of marine derived nutrients and energy to freshwater ecosystems schindler et al 2003 but decades of low adult abundance may have rendered these ecosystems much less productive for juveniles than they were historically rinella et al 2012 in addition nest digging activity by female salmon mobilizes fine sediment moore et al 2004 and decreases the probability of stream bed scour and excavation of buried salmon eggs or embryos montgomery et al 1996 thus losses of adult salmon may have crossed a threshold whereby the freshwater ecosystem cannot support the juvenile production it once did achord et al 2003 schindler et al 2005 absence of observed allee effects could also indicate that availability of juvenile habitat is more important than direct mortality from predators mogensen and post 2012 for puget sound populations in particular much of the lowland areas have been converted from forest to agricultural areas which has greatly decreased the carrying capacity for juvenile chinook salmon scheuerell et al 2006 furthermore increasing evidence points to ndd among adult life stages during their ocean residency owing to competition with hatchery fish ruggerone et al 2012 connors et al 2012 this potentially shifts the focus away from habitat actions and more toward hatchery reforms buhle et al 2009 the varying degrees of support for different forms of density dependence among the many populations provide some important insights for conservation decisions to list pacific salmon as threatened or endangered under the endangered species act are made collectively at the relatively large esu level but recovery plans are developed and implemented at much smaller scales relating to specific populations here we have used posterior model probabilities to assess the degree to which pdd ndd or a combination thereof exists for each population within an esu managers could potentially use this information to further direct location specific actions that might decrease the intensity of pdd or ndd the sir algorithm applied in this study uses samples across the prior distributions to calculate marginal likelihood and derive model probabilities this approach has already been used in fisheries related studies punt and hilborn 1997 mcallister and kirkwood 1998 zerbini et al 2011 as well as for the study of isotopic mixtures semmens and moore et al 2008 moore and semmens 2008 the efficiency of this sir algorithm is limited to low dimensionality problems models with few parameters as the acceptance rate would otherwise drops off very quickly and thus make computation time very long for this reason mcmc methods tend to be favored because of some recent criticism of bayesian model selection tools such as dic spiegelhalter et al 2014 gelman et al 2014 we were interested in the sir algorithm s ability to perform estimation for these relatively simple models computation time was quick lasting only a few minutes per population we also compared our results to that of the more widely used dic and the more recent looic leave one out information criterion bayesian model selection approaches when compared to the sir algorithm the dic approach tended to rank the hs model first to the detriment of the l model in a few cases appendix c1 the reversed pattern was observed with the looic approach appendix c2 in both cases those shifts were consistent across the two life history types although the different methods lead to a few differences on a river by river basis the general patterns discussed above and based on the sir approach are robust these similarities between methods also support the fact that the chosen priors have little influence on the results obtained our analysis highlights the utility of model averaging for estimating relationships among parents and their offspring model averaged results were more conservative than the best model alone and therefore applying model averaging may be particularly important for populations of conservation concern the use of the hs and ahs models was largely chosen based on the taxa in our analysis other model sets could be developed for other species and unlike our analysis there is no requirement that all candidate models be nested although there are a number of ways to implement bayesian model averaging the sir approach is best for relatively simple models like those we used here increased model complexity will decrease the speed of the sir approach exponentially however using other estimation routines such as markov chain monte carlo mcmc the model averaged procedure could also be constructed hierarchically across populations to estimate common strengths of density dependence across populations acknowledgments this research was performed while dr guillaume bal held an nrc research associateship award at the northwest fisheries science center noaa we thank drs brian burke and kevin see for helpful comments on an earlier draft of the manuscript appendices a b and c supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 04 012 appendices a b and c supplementary data the following are supplementary data to this article 
25278,developing effective conservation plans for at risk species requires an understanding of the relationship between numbers of breeding adults and their subsequent offspring in particular establishing the degree to which density dependent effects limit population size can be difficult due to errors in the data themselves uncertainty in model parameters and possible misspecification of model structure here we develop a bayesian model averaging framework to fit four simple models of adult offspring production and estimate the probabilities that negative i e decreasing survival with increasing density and positive i e allee effects density dependence exists as an example we analyzed 48 at risk populations of anadromous chinook salmon oncorhynchus tshawytscha from the northwestern united states we found strong evidence that more than two thirds of the populations exhibit negative density dependent effects of adults this result was somewhat unexpected given the large reductions in adult numbers relative to historical benchmarks indicating that carrying capacity of spawning habitat has been reduced considerably approximately two thirds of the populations also had non zero probabilities of positive density dependent effects of adults which could suggest that cumulative losses of spawning adults over the past century has led to decreased nutrient and energy subsidies from semelparous carcasses and diminished bio physical disturbance from nest digging activity importantly our analysis highlights the utility of bayesian model averaging in a conservation context wherein errors in choosing the best model may have more severe consequences than errors in estimating model parameters themselves keywords density dependence bayesian model averaging management strategies allee effect compensation depensation salmon 1 introduction one of the cornerstones of conservation biology is establishing the relationship between the numbers of parents and the offspring they produce in particular the degree to which organisms are affected by population density has important implications for individual fitness and population growth negative density dependence ndd occurs when density is relatively high and any further increases in density lead to increased competition for resources e g food breeding locations or transmission of diseases ultimately causing reductions in per capita survival hixon et al 2002 brook and bradshaw 2006 conversely positive density dependence pdd or the allee effect arises when density is relatively low and the loss of more individuals causes decreased per capita survival because of cooperative foraging or defensive behaviors decreased probability of finding a mate or combinations of these factors courchamp et al 1999 berec et al 2007 gregory et al 2010a the strength of both ndd and pdd in wild populations has practical management implications for example the presence of ndd could indicate limited habitat availability i e insufficient total area whereas the existence of pdd might suggest a high degree of habitat fragmentation rectifying those two types of habitat deficiencies could require rather different actions when combined with historical knowledge about the population insights about the combined roles of ndd and pdd are also useful for reintroduction planning anderson et al 2014 understanding whether ndd and pdd occur and if so to what extent is thus particularly valuable for determining the best options for population management and the conservation of at risk species density dependence has been studied extensively in fish populations because of its importance to both the management of healthy and economically valuable stocks and the conservation of imperiled populations liermann and hilborn 1997 barrowman and myers 2000 barrowman et al 2003 in classical fisheries management ndd within a stock implies parental biomass should be harvested to the point where the surplus production of new recruits to the fishery is maximized relative to replacement hilborn and walters 1992 conversely the degree of pdd mortality will determine the rate at which overfished stocks will recover when harvest is reduced most conservation practitioners concentrate on the possible existence of pdd however ndd at relatively low abundance can exist implying diminished carrying capacity from factors like habitat loss modification or the presence of non native species achord et al 2003 but this is often ignored in conservation contexts models of population dynamics offer a formal means for estimating both positive and negative density dependence boyce 1992 for example beverton and holt 1957 and ricker 1954 models of density dependence have been used to estimate the relationships between parents and offspring for decades approaches allowing for flexibility in curves shapes but not process based such as splines or gaussian process models have also been developed bravington et al 2000 munch et al 2005 meanwhile barrowman and myers 2000 introduced a form of piecewise regression model known as the hockey stick hs model which is similar to the ricker and beverton holt curves the hs model offers potential advantages over these other models in a conservation context because it provides more conservative estimates of the maximum density independent survival i e slope at the origin and carrying capacity barrowman and myers 2000 in addition the breakpoints in the hs segments may provide natural reference points for management decisions however the hs model does not allow for pdd although statistical modeling is a powerful tool three main types of uncertainties can hinder our ability to infer the true underlying relationship between parents and their offspring first observation errors arise in the form of sampling and measurement errors second model parameters are rarely known without error and instead must be estimated from the data third uncertainty about the structure of the model itself affects inference about the form of the parent offspring relationship the first two concerns are often addressed through appropriate sampling designs and explicit consideration of both process and observation sampling errors however possible misspecification of a particular model is typically ignored and instead the best model is chosen based on some model selection measure such as akaike s information criterion burnham and anderson et al 2002 in such cases two models with nearly identical support from the data could produce widely divergent predictions especially when confronted with new data pascual et al 1997 richards 2005 as a guard against this likely possibility model averaging ma offers a formal means for explicitly addressing model selection uncertainty in problems of inference and prediction burnham and anderson et al 2002 wintle et al 2003 in particular model averaging can produce more robust estimates by combining results from an ensemble of multiple independent models banner and higgs 2017 as a cautionary note however averaging expectations from models that are capable of producing an important spectrum of different results may confuse interpretations galipaud et al 2014 cade 2015 thus the set of models to consider should be carefully chosen pacific salmon oncorhynchus spp are important to human economies and the ecology of coastal ecosystems across the northern pacific rim schindler et al 2003 fisheries for salmon are worth hundreds of millions of us dollars annually nmfs 2013 salmon also act as ecosystem engineers by modifying benthic habitats through nest digging activity moore 2006 and serve as keystone species in food webs as food for fish mammals birds and insects helfield and naiman 2006 in many coastal watersheds across western canada and the us however pacific salmon populations have been reduced to mere fractions of their historical abundances due to changes in habitat hydropower development overharvest and changing climate ruckelshaus et al 2006 literature also suggest that pacific salmon population are susceptible to allee effect through predation disease and decreased mate finding abilities at low densities quinn et al 2014 godwin et al 2015 thus obtaining a proper understanding of whether ndd pdd or both occur among at risk salmon populations and estimating related reference points is necessary for determining the best recovery strategies here we examined the strength of ndd and pdd among 48 populations of chinook salmon o tshawytscha from the northwestern usa that are currently listed as threatened under the us endangered species act to do so we simultaneously considered four different piecewise linear models to characterize various forms of density dependence fig 1 1 unrestricted density independent 2 allee effect only pdd 3 carrying capacity only ndd and 4 both pdd and ndd piecewise linear models tend to provide better estimates of per capita productivity at low population sizes and offer more conservative estimates of mortality rates that lead to extinction in addition we addressed both parameter and model uncertainty within a unified framework through bayesian model averaging bma which allowed us to easily combine predictions and uncertainties across all four models 2 material and methods 2 1 allee hockey stick model and nested sub models barrowman and myers 2000 hockey stick hs model assumes the number of offspring increases linearly up to an asymptote beyond which it is independent of parental abundance for a given population the model is described by two linear functions above and below some threshold level of parental abundance p c 1 o t β p t i f p t p c k i f p t p c where β is the density independent per capita reproductive rate p t is the number of parents breeding in year t at parental abundance values above p c ndd effects dominate and restrain the number of offspring to k the carrying capacity as p c approaches infinity the degree of density dependence goes to zero and because of linear growth there is no limit to population size to allow for pdd allee effects at relatively low levels of parental abundance we modified the original hs model barrowman and myers 2000 to allow for a third linear segment this new allee hockey stick ahs model allows growth rates to become depressed when parental abundance is less than some threshold p d 2 o t β 1 p t i f p t p d β 1 p d β 2 p t p d i f p d p t p c k i f p t p c where 0 β 1 1 β 2 k β 1 p d β 2 p c p d and p d and p c are the breakpoint thresholds respectively by fixing some parameters at zero or infinity the ahs model reduces to three less complex models each with contrasting assumptions about the occurrence of ndd and pdd fig 1 the first is for unrestricted or linear growth l model where β 1 0 p d 0 a n d p c such that 3 o t β 2 p t the second is for an allee effect only al model where p c and 4 o t β 1 p t i f p t p d β 1 p d β 2 p t p d i f p t p d the third is the original hs model with carrying capacity only such that β 1 0 p d 0 k β 2 p d and 5 o t β 2 p t i f p t p c k i f p t p c 2 2 parameter estimation and model weighting here we used a 2 step procedure where each model is first fit independently to data using the sampling importance resampling sir algorithm rubin 1988 and then results are averaged across models the sir algorithm we used to approximate the posterior distribution by using an importance function to resample parameter draws from a proposal distribution is equivalent to moore 2006 and detailed in appendix a for a given model the marginal likelihood can be expressed as the product of the prior model probability and the likelihood integrated over the entire parameter space for instance the corresponding equation for model m 1 is p m 1 y p m 1 p θ m 1 p y θ m 1 across models we normalized the marginal likelihoods so that they could be interpreted as posterior model probabilities i p m i x 1 rubin 1988 there are several upsides and downsides of bayesian estimation in sir versus other techniques such as mcmc as a positive calculating the expected marginal likelihood is straightforward in sir because the likelihood of each draw can be easily saved which is not possible in software implementing mcmc such as winbugs lunn et al 2000 jags plummer 2003 or stan stan development team 2016 second the sir algorithm does not require a burn in period or assessment of mcmc diagnostics for convergence however the utility of sir is somewhat limited for complex models beyond 4 5 parameters because sampling can be inefficient for all models presented above we assumed that the residual error was lognormally distributed we chose weakly informative uniform priors that were shared among the four models whenever possible table 1 an r package containing functions to fit the 4 models together with the dataset discussed below is freely available on github at the following address https github com guillaumebal bal et al 2018 bma density dependence 2 3 model application for management purposes pacific salmon species are grouped into evolutionarily significant units esus defined as a group of salmon that 1 is reproductively isolated from other conspecific populations and 2 represents an important component in the evolutionary legacy of the species waples 1991 we estimated the strength of density dependence among 48 chinook salmon populations within 3 distinct esus from washington idaho and oregon in the northwestern usa fig 2 these esus represent different life history types allowing us to compare the strength of density dependence across life histories for example chinook salmon within the puget sound esu are ocean type these juveniles spend less than 1 year in fresh water before migrating to the ocean in contrast salmon from the snake river and upper columbia esus are stream type and spend 1 full year in fresh water before migrating to sea taylor 1990 we used the total number of spawning adults in a given year as our estimate of parent abundance because salmon from the same cohort mature at different ages our estimates of offspring are then the sum of subsequent adults that were born in a given year but that vary in age and return over sequential years e g the offspring of snake river stream type adults that spawned in 2000 return 3 6 years later in 2003 2006 all data used here were compiled by the national marine fisheries service to ensure time series were long enough to potentially detect positive density dependence brook and bradshaw 2006 gregory et al 2010b we restricted our analysis to those populations with at least 20 years of data and no more than 5 missing values within that period table 2 this resulted in time series length ranging from 20 to 54 years full details of the fits of the four models are provided in appendix b 3 results for both life history types across the three esus we found the strong support from the data for a model with only ndd fig 3 a the median posterior model probabilities were 0 65 and 0 45 for ocean and stream type chinook salmon respectively we found little evidence for models containing only pdd allee effects and models that included both pdd and ndd had median probabilities of being the best equal to 0 13 and 0 011 for ocean and stream type salmon respectively among populations within a specific life history type however the relative support for the different models varied considerably fig 3b although there were a few populations whose model probabilities were evenly split among the four model forms e g 4 16 most populations showed strong support in favor of one particular model for ocean type chinook salmon most populations showed strong indications of ndd but a few populations had evidence for either form of density dependence e g 1 4 8 14 15 evidence for ndd was rather strong for stream type chinook and notably the evidence for models with both pdd and ndd was reasonably strong in fewer populations e g 39 42 for each population the model averaged relationship exhibited subtle to rather significant departures from the best model depending of the relative credibility of the models for example the best models selected for big creek the south fork of the salmon river east fork and the south fork of the salmon river mainstem i e populations 23 39 40 in table 2 were the l model hs model and l model respectively applying bma to estimate the shape of this curve may yield a result very similar to the single best model but it can also result in more conservative results fig 4 in the case of big creek a simple model selection analysis would select a linear relationship whereas the shape coming from bma exhibits ndd when the population reaches 409 fish although the departure from the replacement curve is on average weak in the south fork of the salmon river east fork pdd is highly likely when the population size falls under 27 individuals for the south fork of the salmon river mainstream however there is very little difference between the best and bma models although we found no discernable link between the data support for an allee effect in a population and the length of the corresponding time series we did observe a positive relationship with the ratio of the observed lowest to highest counts within a time series i e a measure of relative historical stock depletion fig 5 4 discussion our results reveal two important messages regarding the role of density dependence in the population dynamics of chinook salmon in the pacific northwest first we found that linear relationships between offspring and parents with no density dependence were supported especially within the snake river esu median model posterior probability 0 53 whom the rivers have experimented the strongest historical depletions according to the ratio of minimum over maximum spawners abundances table 2 this suggests that some populations from the columbia river watershed have still not recovered from the overall reduction in parental abundances compared to historical numbers with a few exceptions we found strong support for models with ndd median model posterior probability 0 65 in populations from the puget sound area our results further support ongoing efforts in this region to increase carrying capacity through improvements to freshwater spawning and rearing habitats second the existence of pdd among these chinook salmon populations is possible which agrees with previous studies of other salmon species liermann and hilborn 1997 barrowman et al 2003 the time series used in this study have 20 to 54 years of data which are similar to previous publications attempting to detect the presence of allee dynamics brook and bradshaw 2006 gregory et al 2010b although longer time series are always preferable we found little relationship between time series length and support for allee dynamics furthermore most of the populations are at the low end of their historical sizes such that the ratio of the minimum to maximum spawners ranges from 0 to 20 with about 50 of the populations below 2 5 interestingly we found that the support for allee effects is positively correlated with this ratio the support for allee effects in populations that have been less depleted may result from a lack of data at extremely low abundances wherein the allee model produces different estimates from the linear or hs model although support for allee effects is weak overall and we cannot identify the exact cause some reasonable hypotheses exist first salmon gain about 90 of their adult biomass in the ocean and therefore act as net importers of marine derived nutrients and energy to freshwater ecosystems schindler et al 2003 but decades of low adult abundance may have rendered these ecosystems much less productive for juveniles than they were historically rinella et al 2012 in addition nest digging activity by female salmon mobilizes fine sediment moore et al 2004 and decreases the probability of stream bed scour and excavation of buried salmon eggs or embryos montgomery et al 1996 thus losses of adult salmon may have crossed a threshold whereby the freshwater ecosystem cannot support the juvenile production it once did achord et al 2003 schindler et al 2005 absence of observed allee effects could also indicate that availability of juvenile habitat is more important than direct mortality from predators mogensen and post 2012 for puget sound populations in particular much of the lowland areas have been converted from forest to agricultural areas which has greatly decreased the carrying capacity for juvenile chinook salmon scheuerell et al 2006 furthermore increasing evidence points to ndd among adult life stages during their ocean residency owing to competition with hatchery fish ruggerone et al 2012 connors et al 2012 this potentially shifts the focus away from habitat actions and more toward hatchery reforms buhle et al 2009 the varying degrees of support for different forms of density dependence among the many populations provide some important insights for conservation decisions to list pacific salmon as threatened or endangered under the endangered species act are made collectively at the relatively large esu level but recovery plans are developed and implemented at much smaller scales relating to specific populations here we have used posterior model probabilities to assess the degree to which pdd ndd or a combination thereof exists for each population within an esu managers could potentially use this information to further direct location specific actions that might decrease the intensity of pdd or ndd the sir algorithm applied in this study uses samples across the prior distributions to calculate marginal likelihood and derive model probabilities this approach has already been used in fisheries related studies punt and hilborn 1997 mcallister and kirkwood 1998 zerbini et al 2011 as well as for the study of isotopic mixtures semmens and moore et al 2008 moore and semmens 2008 the efficiency of this sir algorithm is limited to low dimensionality problems models with few parameters as the acceptance rate would otherwise drops off very quickly and thus make computation time very long for this reason mcmc methods tend to be favored because of some recent criticism of bayesian model selection tools such as dic spiegelhalter et al 2014 gelman et al 2014 we were interested in the sir algorithm s ability to perform estimation for these relatively simple models computation time was quick lasting only a few minutes per population we also compared our results to that of the more widely used dic and the more recent looic leave one out information criterion bayesian model selection approaches when compared to the sir algorithm the dic approach tended to rank the hs model first to the detriment of the l model in a few cases appendix c1 the reversed pattern was observed with the looic approach appendix c2 in both cases those shifts were consistent across the two life history types although the different methods lead to a few differences on a river by river basis the general patterns discussed above and based on the sir approach are robust these similarities between methods also support the fact that the chosen priors have little influence on the results obtained our analysis highlights the utility of model averaging for estimating relationships among parents and their offspring model averaged results were more conservative than the best model alone and therefore applying model averaging may be particularly important for populations of conservation concern the use of the hs and ahs models was largely chosen based on the taxa in our analysis other model sets could be developed for other species and unlike our analysis there is no requirement that all candidate models be nested although there are a number of ways to implement bayesian model averaging the sir approach is best for relatively simple models like those we used here increased model complexity will decrease the speed of the sir approach exponentially however using other estimation routines such as markov chain monte carlo mcmc the model averaged procedure could also be constructed hierarchically across populations to estimate common strengths of density dependence across populations acknowledgments this research was performed while dr guillaume bal held an nrc research associateship award at the northwest fisheries science center noaa we thank drs brian burke and kevin see for helpful comments on an earlier draft of the manuscript appendices a b and c supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2018 04 012 appendices a b and c supplementary data the following are supplementary data to this article 
25279,we describe an unbiased length based age structured mark recapture lamr model for estimating length based abundance and recruitment of fish populations many mark recapture studies employ capture gear that is size selective leading to a larger and faster growing marked sub population with a different capture probability than the unmarked sub population resulting in a basic violation of assumptions for many mark recapture models persistent differences in marked and unmarked individuals are estimated in our model using growth type group accounting simulation evaluation results indicate that the model produces largely unbiased estimates of recruitment and abundance across a range of sampling scenarios and population life history types and is robust to growth parameter misspecification however in older slow growing populations the model is prone to smearing of recruitment estimates across early year classes the lamr model is applied to data from multiple wild populations of rainbow trout to estimate recruitment and abundance overall results indicate that the lamr model addresses shortcomings associated with using size selective gear in mark recapture studies to produce reliable estimates of recruitment and size based abundance keywords mark recapture growth abundance size selectivity length based model bias 1 introduction many management actions are predicated on an accurate assessment of the abundance of animals being managed changes in the numbers of organisms strongly determine rates of predation food consumption competition and reproduction in ecosystems carpenter and kitchell 1996 which in turn may result in future changes in abundance resulting from density dependent survival growth and reproductive success in many organisms with indeterminate growth e g fish reptiles all of these rates are typically size dependent werner and gilliam 1984 begon et al 1996 miller and rudolf 2011 and thus it is additionally important to assess both total and size structured abundance over space and time when predicting the effect of one or several species on an ecosystem de roos et al 2003 with this in mind any management decision that affects the size structure of one or a group of species may have effects on the ecosystem as a whole rochet and benoit 2012 estimates of abundance are often obtained using depletion or mark recapture models depletion models estimate abundance by monitoring how catch or other abundance indices change over time with a known amount of harvesting effort mark recapture studies estimate abundance by evaluating the change in the number of marked animals over multiple capture occasions information from the marked subset of the population is then used to estimate capture and or survival probabilities which are then used to make inferences about the entire population pine et al 2003 models that combine both methods do exist in some limited contexts maunder and deriso 2003 polacheck et al 2006 coggins et al 2006 cadigan 2016 but many simply use tags to solely estimate movement or spatial distribution e g whitlock and mcallister 2009 rather than absolute abundance true combinations of the two methods are very rare although see polacheck et al 2006 animals within a population grow at different rates wang et al 1998 sinclair et al 2002 and it is generally believed that growth variation among individuals is persistent sainsbury 1980 parma and deriso 1990 mangel and stamps 2001 fast growers consistently grow faster than slow growers it was recognized early in fisheries research that fast growers are differentially selected by fisheries leading to skewed size at age distributions lee 1912 ricker 1969 sinclair et al 2002 when using size selective sampling gear differential growth leads to differential capture probability which can bias certain assessment models like age or size structured depletion models sainsbury 1980 walters and martell 2004 catalano and allen 2010 in mark recapture experiments fast growers may be better represented in the marked sub population because they were more likely to be initially captured and tagged failure to account for differential capture probability of marked and unmarked animals is a violation of a basic assumption of mark recapture models seber 1982 and will result in bias of total population abundance estimates van poorten et al 2017 we are not aware of any method for estimating size structured abundance that explicitly tracks a persistent difference in body growth between marked and unmarked animals in a mark recapture model the key to addressing bias associated with persistent growth variation is explicitly tracking groups of individuals with different growth trajectories this process can be accomplished using an individual based model ibm but these models are computationally intensive growth type group gtg models are a useful approximation to ibms yet are still able to replicate cumulative size based mortality effects on size structure gtg models stratify age classes into groups with a specific growth trajectory set at a fixed deviation from the mean growth function and the abundance of each gtg is tracked over time so changes in the size structure persist through time walters and martell 2004 the gtg accounting method has been shown to effectively address size selective removals of fish in length based models parma and deriso 1990 taylor et al 2005 and may be useful in directly estimating the effects of differential growth rates in mark recapture studies between marked and unmarked individuals the utility of gtg models to overcome the problem of variability in capture probabilities within year classes due to differential growth rates in mark recapture models is obvious yet no models have been developed to date we describe a method for estimating size and age structured abundance using a method we call length based age structured mark recapture lamr this method takes advantage of mark recapture data by using marked individuals to help estimate selectivity and capture probability while also estimating recruitment into each year class of the total population we focus on assessment of fish populations but the method could be used for any species with indeterminate growth our method explicitly accounts for size selectivity of various capture gears and appropriately accounts for selective removal of fast growing animals from the population it is not necessary to include multiple capture gears or removal methods at the end of each season their inclusion here is used to demonstrate the flexibility of the model and to match the data provided in our case study while the model could take advantage of individually marked animals we chose to condition the model on batch marking we simulation tested the model to evaluate relative error in estimated parameters and model performance against more commonly used jolly seber models finally we apply the lamr model to eight wild rainbow trout oncorhynchus mykiss populations from lakes in south central british columbia to estimate recruitment and size structured abundance throughout the study 2 methods 2 1 development of length based age structured mark recapture lamr model the model uses a variety of estimated parameters inputs and functions to predict catch length frequencies table 1 variables and parameters used in the model are listed in table 2 the model proceeds through the following steps 1 predict initial age structure of the population and allocate among gtgs 2 progress fish of each year class and gtg through a year and calculate catches during capture events 3 transition of each year class and gtg between years and 4 calculate catch length frequencies by summing catches across gtgs and ages at each capture event fish are assumed to recruit into the population at the beginning of the year january 1 model code and files necessary to evaluate the rainbow trout case study below are provided online https github com bvanpoor lamr git the lamr model is conditioned on sampling intensity so the number of nets or other suitable unit of sampling effort at each capture occasion is required the mean growth rate of each population over time is also required for which any growth function can be used we used the walters and essington 2010 general bioenergetics model modified to account for varying growth rates in different years van poorten et al 2012 while growth and abundance can be estimated simultaneously by adding likelihood components we chose to estimate growth parameters separately and treat them as fixed in the abundance model we explore model sensitivity to this separation approach below mean length of fish l y a t at each age a in each year y and within year time step t is based on the model presented in van poorten et al 2012 eq t1 1 the standard deviation around the mean length σ y a t is calculated by multiplying the mean length by an estimated coefficient of variation eq t1 2 the actual lengths of fish in each gtg i at any year age time step combination l i y a t is provided in eq t1 3 the population is initialized by predicting recruitment to each year class and allocating it among growth type groups annual recruitment of each year class uj is predicted by multiplying a mean recruitment μr by an annual residual εj that is exponentiated and bias corrected eq t1 4 maunder and deriso 2003 recruits in each year class are normally distributed among gtgs according to their growth relative to the mean growth rate eq t1 5 the abundance of unmarked fish in each year class in the first year is predicted based on the proportion of initial recruits allocated among gtgs surviving from the age at recruitment to the beginning of the study according to a constant instantaneous mortality rate eq t1 6 it is assumed there are no marked fish in the first year eq t1 7 likewise fish recruiting in each subsequent year are normally distributed among gtgs to predict initial unmarked abundance of subsequent year classes eqs t1 8 t1 9 the predicted population propagates through each year as follows the subpopulations of marked and unmarked fish in each gtg are captured in each time step t with a probability defined by their size and the fishing mortality rate on that gtg catch of unmarked and marked fish in each time step is calculated using the baranov equation quinn and deriso 1999 eqs t1 10 and t1 11 respectively based on total mortality calculated for the mean size of the gtg eq t1 12 selectivity is set as dome shaped for the mark recapture gear eq t1 13 thompson 1994 and asymptotic for the depletion gear eq t1 14 but other functions may be used predicted catch is then subject to three fates the first is unmarked catch that are removed from the unmarked subpopulation predicted by multiplying the observed proportion of unmarked captured fish that were either marked or died in sampling by the predicted unmarked catch of each gtg the second fate is unmarked catch that are moved to the marked population predicted by multiplying the observed proportion of unmarked captured fish that were subsequently marked by the predicted unmarked catch of each gtg finally the marked catch that died due to sampling is predicted by multiplying the observed proportion of recaptured fish that died in sampling by the predicted marked catch of each gtg these fish are removed from the marked subpopulation the remaining fish in each subpopulation in each time step are subject to mortality eqs t1 15 and t1 16 to predict numbers at the start of the next time step at the end of each year fish are assumed to lose their mark and return to the unmarked population a conservative assumption that can be waived if necessary therefore the abundance of unmarked fish in the next year y 1 and age a 1 is the sum of unmarked and marked fish in each gtg at the end of the previous year and the abundance of marked fish at the same time is reset to zero eqs t1 17 and t1 18 respectively if fish are assumed to retain marks across years eq t1 17 would have unmarked fish in the next year would simply be the sum of unmarked fish in each age class and gtg in the previous year likewise marked fish in each age class and gtg would be advanced by a year to compare predicted catches of fish across gtgs with observed catch in length bins or length bins and age classes the catches of unmarked and marked fish in each sampling occasion gear type and gtg eqs t1 10 and t1 11 are summed across year classes and gtgs that have predicted lengths within each length bin the fit of model predicted length based catch of marked and unmarked fish is evaluated by assuming that numbers captured varied as poisson log likelihoods eqs t3 3 and t3 4 table 3 which is appropriate for capture recapture data and functionally equivalent to a binomial likelihood e g coggins et al 2006 korman et al 2011 in cases where a proportion of captured fish in a gear are aged pag y t the catch can be separated into catch at length l and catch at length l and age a evaluated using separate log likelihoods eqs t3 5 and t3 6 the total log likelihood is the sum of the log likelihood for all marked and unmarked fish minus a normally distributed recruitment penalty maunder and deriso 2003 eq t3 2 given by eq t3 7 the total log likelihood is maximized while varying parameters t3 1 to obtain estimates of annual recruitment and length based or numerical abundance at any point in the study 2 2 simulation evaluation of lamr model and comparison with jolly seber models to evaluate the effect of alternative model assumptions and to determine the magnitude of error and bias in maximum likelihood parameter estimates using this method the model was fit to data simulated using an individual based model ibm which tracks the fate of all individual fish over time and demonstrates the effect of individual growth rates on probability of capture due to gear selectivity walters and martell 2004 growth trajectories of each individual were determined by multiplying the mean growth trajectory which varied by year by a fixed deviation determined by the simulated coefficient of variation in length at age therefore growth for all fish may vary over years as in the lamr model but there were persistent differences in individual growth from the mean trajectory the structure and assumptions used in the ibm were exactly the same as in the lamr estimation model except individuals were tracked rather than year classes grouped by gtg unless specified otherwise populations were simulated over six consecutive years number of individuals simulated from each year class was randomly determined by drawing from a lognormal distribution with mean of 400 fish per year table 4 untransformed parameters for each simulation were drawn from a normal distribution mean and coefficients of variation for each simulated parameter over simulation evaluation trials are found in table 4 the simulation evaluation procedure was repeated over 100 monte carlo simulation trials and proportional error was calculated from each trial data generated did not include any aged sub samples of catch so represent a worst case scenario because the estimation model was only fit to catch at length data the simulation model was used for various evaluations of the lamr model indices and parameters varied across the different evaluations are shown in table 5 first proportional errors in population abundance estimated using the lamr model were compared with estimates from the popan schwarz and arnason 1996 jolly seber model mark recapture data for the popan model were generated using the ibm assuming all fish were individually identified over a six year simulation with seven sampling occasions each year and six units of fishing effort per occasion table 6 fish were sampled with replacement and capture gear exhibited an asymptotic vulnerability parameters are shown in table 4 with low net consumption rate h 7 0 and low variation in length at age cvl 0 15 abundance was estimated in popan assuming survival probabilities proportional to the time interval between observations analogous to the constant mortality rate in the simulation model the popan model assumed capture probability either varied with length at initial capture or with the actual size based vulnerability used to generate the data with vulnerability based on length at initial capture the corresponding lamr population estimates were based on bulk marking of fish fish were either unmarked or recaptured in each simulation evaluation the same data were used in the popan and the lamr model though popan evaluated individual mark data whereas lamr evaluated bulk marks so true comparisons could be made the second evaluation of the lamr model examined how population life history and sampling intensity affected model performance data were generated using the ibm assuming two gear types the first gear used for mark recapture g1 was assumed to be non destructive so fish could be returned to the population and marked if appropriate mark recapture sampling whereas the second gear g2 was for depleting the population removal sampling this second gear improves information on population abundance and coincides with the sampling of fish on lakes in our field study see field data collection below but is not necessary in a mark recapture experiment data were simulated using two series of fishing efforts sampling scenario 1 or 2 table 6 and sampling duration i e years of data short 3 yrs 0 5 a long 6 yrs a selectivity to the mark recapture gear was defined by mean parameters that resulted in 50 selectivity at 65 mm full selectivity at 113 mm and declined to 75 selectivity by 190 mm selectivity of the depletion gear was defined by mean parameters resulting in 50 selectivity at 82 mm and full selectivity at 205 mm growth parameters were also systematically varied low lage 3 100 and lage 5 130 high lage 3 300 and lage 5 400 by varying net consumption rate h from the walters and essington 2010 bioenergetics model to either 7 0 or 9 0 as was variation around length at age low cvl 0 15 high cvl 0 3 the sampled population was assumed to have a maximum age a of 6 years the next model evaluation examined the ability of the lamr model to estimate annual recruitment across species of different longevity length based catch data were generated assuming six years of sampling a population with low effort sampling scenario 1 table 6 sampling a population with low growth h 7 0 table 4 and low coefficient of variation in length the two scenarios in this evaluation examined proportional error in parameter estimates when the life span of the population being studied is either equal to or double the number of sampling years i e six or 12 years the lamr length based model is conditioned on fixed growth parameters which we assume are known with certainty to evaluate the potential for growth parameter misspecification to introduce bias into parameter estimates we generated data using the ibm as above with sampling effort based on sampling scenario 1 table 6 and estimated them using lamr with either the net consumption rate h or net metabolic rate m set 10 higher or lower than the simulated population the final model evaluation examined the ability to accurately estimate to anomalously high recruitment in older year classes length based methods are often prone to difficulties distinguishing one strong versus multiple weak recruitment events in successive years a phenomenon known as smearing pitcher 2002 walters and martell 2004 in early year classes that have high overlap in size structure at the start of the experiment the model assumes a series of intermediate recruitment years rather than a single high recruitment year this is especially true in slow growing species to evaluate this we used the ibm to generate catch data from a long lived population a 30 with low growth h 2 0 m 0 8 and high coefficient of variation in length cvl 0 3 sampling was conducted using sampling scenario 1 in table 6 recruitment anomalies were generated using a standard deviation of 0 6 except in year class 7 which experienced recruitment 10 times the mean recruitment across all other years the estimation model was then used to estimate parameters to determine whether smearing of recruitment estimates occurs for long lived species with low growth 2 3 case study rainbow trout populations field data were collected from a series of eight lakes in south central british columbia canada on the bonaparte plateau which we collectively refer to as the bonaparte lakes each lake contains populations of rainbow trout which we refer to as trout herein which co occur with northern pikeminnow ptychocheilus oregonensis all lakes are within five kilometers of one another on a low relief landscape at similar elevation and experience similar environmental conditions and growing seasons taylor 2006 however population densities sampling intensities and sampling duration all vary across lakes and within lakes over the course of the study rainbow trout in the bonaparte populations exhibit slow growth for the species van poorten et al 2012 all lakes are foot access only and quite remote a private fishing lodge targeting rainbow trout exists in the middle of the study area but fishing pressure on trout from the lodge on the study lakes is usually quite low and external fishing pressure is non existent fishing mortality in all lakes except that caused by sampling is assumed negligible bonaparte populations were sampled using a combination of fyke nets and gill nets from 2001 to 2008 although not all lakes were sampled in all years fyke nets are classified as small 60 cm hoop diameter or large 90 cm hoop diameter nets each with a unique size selectivity gill nets consisted of a standardized combination of panels with stretched mesh ranging from 13 to 89 mm post et al 1999 askey et al 2007 annual sampling effort on each lake in each year is given in table 7 sampling consisted of a combination of year specific mark recapture experiments and occasional removal netting where all fish captured were measured and removed from the population to manipulate densities removal sampling occasions targeting trout occurred in wilderness lake in 2001 and in nestor lake in 2002 and again in all lakes from 2006 to 2008 table 7 scales were collected during each depletion sampling occasion to assess age from a subset of captured fish van poorten et al 2012 during mark recapture sampling fish captured in fyke nets were usually marked with a spaghetti tag and or given a fin clip measured and released minimum lengths for tagging varied over the study depending on tag size but typical minimum sizes were 120 mm captured fish below the minimum tagging size were given a fin clip unique to each capture year overwinter tag loss was assumed high and fin clips were unreliable after one year so marks were assumed to last one year fish recaptured after the first year were assumed to be unmarked in the data and the model this combination of multiple sampling gears the combination of marking and depleting techniques and the loss of marks after each year creates an analysis problem which is not readily treated using standard jolly seber mark recapture techniques trout size data were summarized using 60 length bins with width of 10 mm the date of recruitment was set at january 1 each year corresponding to age 0 5 since they typically rear in streams in their first summer one hundred gtgs were used for each year class note there are no established rules for deciding on the most appropriate number of gtgs we evaluated several options and settled on 100 as it was enough to ensure simulated length frequencies were not choppy i e there were no length bins that were between gtgs and additional gtgs did not change estimated parameters any number of gtgs could be used but too many does not improve estimates and significantly slows down estimation time all populations were evaluated simultaneously allowing for some parameters to be shared across populations the model assumed catchability and selectivity for each of the three fishing gears small fyke nets large fyke nets and gill nets were constant across years and lakes variation in size at age cvl was also shared across lakes selectivity of the two fyke nets was always assumed to be dome shaped following eq t1 13 selectivity of gill nets was assumed to be asymptotic askey et al 2007 following eq t1 14 mean and standard deviation in recruitment anomalies σr were estimated separately for each lake we estimated a single recruitment deviation for all year classes older than one third of the maximum age of trout at the start of the study all parameters were bounded to be above zero by log transformation except γg which was bounded to be between 0 and 1 by logit transformation and the annual recruitment residual which was untransformed and bounded to be between 10 and 10 natural mortality rate was estimated using a normal prior probability distribution with mean of 0 58 and 10 coefficient of variation 3 results comparisons of the popan jolly seber model with the lamr model demonstrated the risk of ignoring growth variation in mark recapture abundance estimates when there is size selective fishing fig 1 population estimates assuming capture probability varied with initial length were positively biased and bias generally increased throughout each year due to small fish becoming increasingly catchable higher vulnerability fig 1a median bias across all sampling events was 0 58 when the popan model assumed capture probability varied with the true vulnerability at first capture a similar pattern was seen fig 1b median bias across all sampling events in this scenario was 0 47 equivalent estimates based on the lamr model were slightly positive biased and relatively precise with no discernible pattern within or across years median bias across all sampling events was 0 01 fig 1c median proportional absolute error was less than 0 07 for all parameters across all simulated scenarios of fishing effort study length and population growth characteristics when using the lamr model table 8 increased fishing effort generally led to improvements in parameter estimates because of increased sample size and recapture rates especially in the range of proportional error within a parameter grouping longer study length marginally improved parameter estimates selectivity parameters were better estimated when growth rate was low and cv was low most other parameters were insensitive to growth estimates of parameters associated with selectivity and catchability of the two gears were the most difficult to estimate particularly for the depletion gear which was only used for three occasions within each year table 6 the coefficient of variation in length at age cvl was well defined across all scenarios even in instances where actual cvl was quite high leading to substantial overlap in size distributions of adjacent age classes within recruitment estimates bias was consistently greater for year classes that recruited prior to the beginning of the study referred to henceforth as early recruitment than for year classes that recruited within the years of the study late recruitment table 8 fig 2 the maximum age of the simulated population being studied did not appreciably affect the estimates of any parameters using the lamr model the exception was that in an older lived population there are more early recruited year classes for which the range of proportional error is higher than late recruited year classes fig 2 all parameters had minimal bias although early recruitment estimates often had a slight positive median bias across simulations and extreme cases can extend beyond twice the value of the true estimate mis specifying growth parameters specifically net consumption rate h and net metabolic rate m led to under or overestimation of length at age fig 3 in the lamr model which had a corresponding effect in the predicted mode of length frequencies of age classes in the model and parameter estimates when consumption in the estimation model was mis specified by 10 annual recruitment estimates of late year classes showed positive bias fig 3b when consumption in the estimation model was mis specified by 10 early year classes had a positive bias in recruitment whereas late year classes had neutral or negative bias fig 3c a change in the net metabolic rate had little effect on length at age for young fish but progressively influenced the predicted length at age of older fish early recruitment fig 3e accordingly mis specifying net metabolic rate had no impact on recruitment estimates of late recruited year classes fig 3e f simulated data from the ibm were used to evaluate the potential for the lamr model to smear recruitment estimates in slow growing long lived species the estimation model was able to reasonably estimate most year classes with 95 confidence intervals overlapping the true recruitment except for the year classes 6 8 where the year class with the disproportionately high simulated recruitment year class 7 was underestimated and the adjacent year classes were overestimated fig 4 these estimated year classes also showed higher uncertainty in recruitment estimates than many other year classes because the estimate of recruitment variability across years was underestimated this confirms that for early recruits in long lived slow growing species year by year recruitment estimates are somewhat of a running average of true recruitment across year classes because the assumption of annual recruitment being normally distributed is violated mean recruitment estimates for trout varied across lakes however all lakes showed occasional strong year classes fig 5 high mean recruitment in wilderness and nestor lakes which were depleted of adults in 2001 and 2002 respectively had low subsequent recruitment thereafter although nestor had two poor year classes leading up to the depletion abundance of trout in most lakes declined over the course of the study but total abundance was quite variable due to high levels of recruitment relative to the overall abundance fig 6 in lakes with poor catches cath and meghan lakes individual abundance estimates are most uncertain 4 discussion mark recapture studies over protracted periods of time are typically analysed using open population models such as variations on the jolly seber model seber 1982 which can estimate recruitment into the population of interest through birth or immigration as well as abundance and survival pine et al 2003 schwarz and seber 1999 however none of these models explicitly allow for growth and consequent individual changes in capture probabilities to be included thereby potentially leading to biases in recruitment and abundance estimates we have demonstrated that with standard jolly seber models a bias does exist even when the exact form of gear selectivity is known which in practice would rarely happen a key problem with jolly seber models is predicting the length of marked individuals in sampling occasions where they are not captured so that only the length at initial capture can be used as a proxy for individual capture probability schwarz and seber 1999 the lamr model assumes a persistent deviation of all fish from the mean population growth trajectory in the form of growth type groups consistent with inter individual observations e g biro et al 2014 allowing differences in capture probability between marked and unmarked fish to be estimated in fact our population estimates based on the popan model indicate the median error at each sampling occasion is approximately 75 across sampling occasions for our specific scenarios the extent of bias will depend on a number of factors especially the growth rates of animals in the population however estimating how this will impact abundance estimates is beyond scope of this paper the lamr model presented here is effective at estimating recruitment and abundance when individual variation in growth caused marked and unmarked individuals to have fundamentally distinct and time varying capture probabilities estimating animal abundance is often conducted using one of several approaches mark recapture methods catch effort methods or depletion methods estimating abundance and recruitment of small populations can often be carried out only using mark recapture because removal of animals will disturb the study population or is not possible due to conservation concerns protracted studies would either rely on open population estimates such as the jolly seber model or the robust design model which combines open and closed methods to address unequal catchability over time kendall et al 1995 pollock 1982 schwarz and seber 1999 as shown here any estimates based on protracted sampling will be biased due to the unequal capture probabilities of marked and unmarked animals in situations where the capture gear is size selective because fish exhibit indeterminate growth in harvested populations with high abundance it is often more common to estimate an abundance time series through the use of catch effort models where the changes in catch per unit effort cpue is attributed to observed removals or harvest effort hilborn and walters 1992 schwarz and seber 1999 harvest in commercially fished populations is often relatively constant or increasing over time so there is no chance for the population to partially recover this results in one way trip data walters and martell 2004 where it is difficult to separate population productivity from abundance hilborn and walters 1992 because the population index cpue can be either from a productive highly catchable population or an unproductive largely invulnerable population incorporating mark recapture into catch effort models allows for substantial information gain polacheck et al 2006 in situations where reducing harvest rates is not possible the lamr model can be used in either context small populations where marking is size selective and large populations where mark recapture could be incorporated to improve parameter estimation cadigan 2016 mark recapture data carry substantial information on capture probability that could greatly enhance the ability to estimate abundance in data poor studies besbeas et al 2002 polacheck et al 2006 we see the lamr model as a substantial addition to the analysis of both mark recapture and time series data our results highlight the difficulty in estimating the true magnitude of recruitment variation when an occasional high recruitment event occurs prior to the onset of data collection this is common in length based methods because of high overlap in size at age for older year classes pitcher 2002 this may also be due to an underestimate of the standard deviation of recruitment residuals σr as is common with the penalized likelihood used here maunder and deriso 2003 to correct the underestimation of σr maunder and deriso 2003 suggest using a bayesian approach which could also be incorporated here by setting annual recruitment estimates as random effects with associated hyper parameters for mean and standard deviation characterizing annual recruitment similar to the penalty function used here alternately in situations where the full recruitment history is not of critical importance or where sufficient age samples are not available we recommend pooling all older age classes as demonstrated with the bonaparte rainbow trout populations there are several key assumptions of this model which will be met in experimental settings where fishing mortality is limited or closely monitored but may not be met in other situations the first is that fishing mortality is known or absent obviously this is difficult to know in many situations and special attention will need to be paid to this assumption in future applications of this model populations with fishing will likely require additional data to account for this otherwise unexplained mortality the model is also conditioned on sampling effort which may be known in research settings where the researcher is the one doing the fishing but may be highly uncertain in situations where commercial fisheries are collecting data finally natural mortality rate is fixed which will strongly influence final abundance estimates clark 1999 all of these assumptions may limit the applicability of the model to larger scale experiments with high uncertainty in these rates although not examined here the use of informative prior probability distributions around these rates based on external information may help provide useful information to facilitate the use of this model in those situations the lamr model is useful for removing bias due to variation in size based capture probability especially due to sub year growth but its use is not appropriate in all situations lamr and the bioenergetics model that it relies on are both data intensive the bioenergetics model either requires fish to be aged or a relatively large number of recaptures within the year from individuals that span the length distribution of the population walters and essington 2010 lamr may be paired with another growth model but sub year length at age predictions are necessary which will certainly require detailed information on growth however we have shown the resulting bias associated with ignoring size based changes to capture probability and suggest this extra data requirement is a cost of accuracy in abundance estimates obviously if fish are resighted using methods that are not size selective e g pit tags or similar remote detection barbour et al 2013 lamr will not be necessary although could still be used by presuming selectivity is equal across lengths however resighting studies do not require recapture of fish which has additional benefits such as evaluating growth allowing inference of consumption and broader ecosystem impacts and threats van poorten and walters 2016 the lamr model estimates a time series of size and age based abundance which can be useful for determining various size based rates such as consumption and competition preliminary evaluations demonstrated that both total density and size based density measures such as effective density measured as the squared length across all fish in a population post et al 1999 are unbiased and relatively precise van poorten 2012 by estimating both mean population body growth and therefore age specific consumption van poorten et al 2012 as well as total age and size specific abundance it is possible to obtain an accurate estimate of total effect of the population on the resources through consumption or competition these rates have ecosystem wide implications and are particularly important when attempting to determine the implications of changes of management to one or more species on the ecosystem carpenter and kitchell 1996 acknowledgements this work benefited from the help of many people the project was initiated through conversations with eric parkinson of the british columbia ministry of environment members of field crews in every year are too numerous to name here but their hard work in difficult conditions is invaluable and appreciated the analysis presented here benefitted from early discussions with steven martell and murdoch mcallister and structural and editorial suggestions from kyle wilson and several anonymous reviewers support for bvp was provided by a scholarship from the natural science and engineering research council and a mitacs internship jointly funded by and held at the freshwater fisheries society of bc field work was primarily funded through a nserc discovery grant to cjw and grants from the bc small lakes management and conservation initiative to bvp and eric parkinson bc ministry of environment and the habitat conservation trust foundation to eric parkinson 
25279,we describe an unbiased length based age structured mark recapture lamr model for estimating length based abundance and recruitment of fish populations many mark recapture studies employ capture gear that is size selective leading to a larger and faster growing marked sub population with a different capture probability than the unmarked sub population resulting in a basic violation of assumptions for many mark recapture models persistent differences in marked and unmarked individuals are estimated in our model using growth type group accounting simulation evaluation results indicate that the model produces largely unbiased estimates of recruitment and abundance across a range of sampling scenarios and population life history types and is robust to growth parameter misspecification however in older slow growing populations the model is prone to smearing of recruitment estimates across early year classes the lamr model is applied to data from multiple wild populations of rainbow trout to estimate recruitment and abundance overall results indicate that the lamr model addresses shortcomings associated with using size selective gear in mark recapture studies to produce reliable estimates of recruitment and size based abundance keywords mark recapture growth abundance size selectivity length based model bias 1 introduction many management actions are predicated on an accurate assessment of the abundance of animals being managed changes in the numbers of organisms strongly determine rates of predation food consumption competition and reproduction in ecosystems carpenter and kitchell 1996 which in turn may result in future changes in abundance resulting from density dependent survival growth and reproductive success in many organisms with indeterminate growth e g fish reptiles all of these rates are typically size dependent werner and gilliam 1984 begon et al 1996 miller and rudolf 2011 and thus it is additionally important to assess both total and size structured abundance over space and time when predicting the effect of one or several species on an ecosystem de roos et al 2003 with this in mind any management decision that affects the size structure of one or a group of species may have effects on the ecosystem as a whole rochet and benoit 2012 estimates of abundance are often obtained using depletion or mark recapture models depletion models estimate abundance by monitoring how catch or other abundance indices change over time with a known amount of harvesting effort mark recapture studies estimate abundance by evaluating the change in the number of marked animals over multiple capture occasions information from the marked subset of the population is then used to estimate capture and or survival probabilities which are then used to make inferences about the entire population pine et al 2003 models that combine both methods do exist in some limited contexts maunder and deriso 2003 polacheck et al 2006 coggins et al 2006 cadigan 2016 but many simply use tags to solely estimate movement or spatial distribution e g whitlock and mcallister 2009 rather than absolute abundance true combinations of the two methods are very rare although see polacheck et al 2006 animals within a population grow at different rates wang et al 1998 sinclair et al 2002 and it is generally believed that growth variation among individuals is persistent sainsbury 1980 parma and deriso 1990 mangel and stamps 2001 fast growers consistently grow faster than slow growers it was recognized early in fisheries research that fast growers are differentially selected by fisheries leading to skewed size at age distributions lee 1912 ricker 1969 sinclair et al 2002 when using size selective sampling gear differential growth leads to differential capture probability which can bias certain assessment models like age or size structured depletion models sainsbury 1980 walters and martell 2004 catalano and allen 2010 in mark recapture experiments fast growers may be better represented in the marked sub population because they were more likely to be initially captured and tagged failure to account for differential capture probability of marked and unmarked animals is a violation of a basic assumption of mark recapture models seber 1982 and will result in bias of total population abundance estimates van poorten et al 2017 we are not aware of any method for estimating size structured abundance that explicitly tracks a persistent difference in body growth between marked and unmarked animals in a mark recapture model the key to addressing bias associated with persistent growth variation is explicitly tracking groups of individuals with different growth trajectories this process can be accomplished using an individual based model ibm but these models are computationally intensive growth type group gtg models are a useful approximation to ibms yet are still able to replicate cumulative size based mortality effects on size structure gtg models stratify age classes into groups with a specific growth trajectory set at a fixed deviation from the mean growth function and the abundance of each gtg is tracked over time so changes in the size structure persist through time walters and martell 2004 the gtg accounting method has been shown to effectively address size selective removals of fish in length based models parma and deriso 1990 taylor et al 2005 and may be useful in directly estimating the effects of differential growth rates in mark recapture studies between marked and unmarked individuals the utility of gtg models to overcome the problem of variability in capture probabilities within year classes due to differential growth rates in mark recapture models is obvious yet no models have been developed to date we describe a method for estimating size and age structured abundance using a method we call length based age structured mark recapture lamr this method takes advantage of mark recapture data by using marked individuals to help estimate selectivity and capture probability while also estimating recruitment into each year class of the total population we focus on assessment of fish populations but the method could be used for any species with indeterminate growth our method explicitly accounts for size selectivity of various capture gears and appropriately accounts for selective removal of fast growing animals from the population it is not necessary to include multiple capture gears or removal methods at the end of each season their inclusion here is used to demonstrate the flexibility of the model and to match the data provided in our case study while the model could take advantage of individually marked animals we chose to condition the model on batch marking we simulation tested the model to evaluate relative error in estimated parameters and model performance against more commonly used jolly seber models finally we apply the lamr model to eight wild rainbow trout oncorhynchus mykiss populations from lakes in south central british columbia to estimate recruitment and size structured abundance throughout the study 2 methods 2 1 development of length based age structured mark recapture lamr model the model uses a variety of estimated parameters inputs and functions to predict catch length frequencies table 1 variables and parameters used in the model are listed in table 2 the model proceeds through the following steps 1 predict initial age structure of the population and allocate among gtgs 2 progress fish of each year class and gtg through a year and calculate catches during capture events 3 transition of each year class and gtg between years and 4 calculate catch length frequencies by summing catches across gtgs and ages at each capture event fish are assumed to recruit into the population at the beginning of the year january 1 model code and files necessary to evaluate the rainbow trout case study below are provided online https github com bvanpoor lamr git the lamr model is conditioned on sampling intensity so the number of nets or other suitable unit of sampling effort at each capture occasion is required the mean growth rate of each population over time is also required for which any growth function can be used we used the walters and essington 2010 general bioenergetics model modified to account for varying growth rates in different years van poorten et al 2012 while growth and abundance can be estimated simultaneously by adding likelihood components we chose to estimate growth parameters separately and treat them as fixed in the abundance model we explore model sensitivity to this separation approach below mean length of fish l y a t at each age a in each year y and within year time step t is based on the model presented in van poorten et al 2012 eq t1 1 the standard deviation around the mean length σ y a t is calculated by multiplying the mean length by an estimated coefficient of variation eq t1 2 the actual lengths of fish in each gtg i at any year age time step combination l i y a t is provided in eq t1 3 the population is initialized by predicting recruitment to each year class and allocating it among growth type groups annual recruitment of each year class uj is predicted by multiplying a mean recruitment μr by an annual residual εj that is exponentiated and bias corrected eq t1 4 maunder and deriso 2003 recruits in each year class are normally distributed among gtgs according to their growth relative to the mean growth rate eq t1 5 the abundance of unmarked fish in each year class in the first year is predicted based on the proportion of initial recruits allocated among gtgs surviving from the age at recruitment to the beginning of the study according to a constant instantaneous mortality rate eq t1 6 it is assumed there are no marked fish in the first year eq t1 7 likewise fish recruiting in each subsequent year are normally distributed among gtgs to predict initial unmarked abundance of subsequent year classes eqs t1 8 t1 9 the predicted population propagates through each year as follows the subpopulations of marked and unmarked fish in each gtg are captured in each time step t with a probability defined by their size and the fishing mortality rate on that gtg catch of unmarked and marked fish in each time step is calculated using the baranov equation quinn and deriso 1999 eqs t1 10 and t1 11 respectively based on total mortality calculated for the mean size of the gtg eq t1 12 selectivity is set as dome shaped for the mark recapture gear eq t1 13 thompson 1994 and asymptotic for the depletion gear eq t1 14 but other functions may be used predicted catch is then subject to three fates the first is unmarked catch that are removed from the unmarked subpopulation predicted by multiplying the observed proportion of unmarked captured fish that were either marked or died in sampling by the predicted unmarked catch of each gtg the second fate is unmarked catch that are moved to the marked population predicted by multiplying the observed proportion of unmarked captured fish that were subsequently marked by the predicted unmarked catch of each gtg finally the marked catch that died due to sampling is predicted by multiplying the observed proportion of recaptured fish that died in sampling by the predicted marked catch of each gtg these fish are removed from the marked subpopulation the remaining fish in each subpopulation in each time step are subject to mortality eqs t1 15 and t1 16 to predict numbers at the start of the next time step at the end of each year fish are assumed to lose their mark and return to the unmarked population a conservative assumption that can be waived if necessary therefore the abundance of unmarked fish in the next year y 1 and age a 1 is the sum of unmarked and marked fish in each gtg at the end of the previous year and the abundance of marked fish at the same time is reset to zero eqs t1 17 and t1 18 respectively if fish are assumed to retain marks across years eq t1 17 would have unmarked fish in the next year would simply be the sum of unmarked fish in each age class and gtg in the previous year likewise marked fish in each age class and gtg would be advanced by a year to compare predicted catches of fish across gtgs with observed catch in length bins or length bins and age classes the catches of unmarked and marked fish in each sampling occasion gear type and gtg eqs t1 10 and t1 11 are summed across year classes and gtgs that have predicted lengths within each length bin the fit of model predicted length based catch of marked and unmarked fish is evaluated by assuming that numbers captured varied as poisson log likelihoods eqs t3 3 and t3 4 table 3 which is appropriate for capture recapture data and functionally equivalent to a binomial likelihood e g coggins et al 2006 korman et al 2011 in cases where a proportion of captured fish in a gear are aged pag y t the catch can be separated into catch at length l and catch at length l and age a evaluated using separate log likelihoods eqs t3 5 and t3 6 the total log likelihood is the sum of the log likelihood for all marked and unmarked fish minus a normally distributed recruitment penalty maunder and deriso 2003 eq t3 2 given by eq t3 7 the total log likelihood is maximized while varying parameters t3 1 to obtain estimates of annual recruitment and length based or numerical abundance at any point in the study 2 2 simulation evaluation of lamr model and comparison with jolly seber models to evaluate the effect of alternative model assumptions and to determine the magnitude of error and bias in maximum likelihood parameter estimates using this method the model was fit to data simulated using an individual based model ibm which tracks the fate of all individual fish over time and demonstrates the effect of individual growth rates on probability of capture due to gear selectivity walters and martell 2004 growth trajectories of each individual were determined by multiplying the mean growth trajectory which varied by year by a fixed deviation determined by the simulated coefficient of variation in length at age therefore growth for all fish may vary over years as in the lamr model but there were persistent differences in individual growth from the mean trajectory the structure and assumptions used in the ibm were exactly the same as in the lamr estimation model except individuals were tracked rather than year classes grouped by gtg unless specified otherwise populations were simulated over six consecutive years number of individuals simulated from each year class was randomly determined by drawing from a lognormal distribution with mean of 400 fish per year table 4 untransformed parameters for each simulation were drawn from a normal distribution mean and coefficients of variation for each simulated parameter over simulation evaluation trials are found in table 4 the simulation evaluation procedure was repeated over 100 monte carlo simulation trials and proportional error was calculated from each trial data generated did not include any aged sub samples of catch so represent a worst case scenario because the estimation model was only fit to catch at length data the simulation model was used for various evaluations of the lamr model indices and parameters varied across the different evaluations are shown in table 5 first proportional errors in population abundance estimated using the lamr model were compared with estimates from the popan schwarz and arnason 1996 jolly seber model mark recapture data for the popan model were generated using the ibm assuming all fish were individually identified over a six year simulation with seven sampling occasions each year and six units of fishing effort per occasion table 6 fish were sampled with replacement and capture gear exhibited an asymptotic vulnerability parameters are shown in table 4 with low net consumption rate h 7 0 and low variation in length at age cvl 0 15 abundance was estimated in popan assuming survival probabilities proportional to the time interval between observations analogous to the constant mortality rate in the simulation model the popan model assumed capture probability either varied with length at initial capture or with the actual size based vulnerability used to generate the data with vulnerability based on length at initial capture the corresponding lamr population estimates were based on bulk marking of fish fish were either unmarked or recaptured in each simulation evaluation the same data were used in the popan and the lamr model though popan evaluated individual mark data whereas lamr evaluated bulk marks so true comparisons could be made the second evaluation of the lamr model examined how population life history and sampling intensity affected model performance data were generated using the ibm assuming two gear types the first gear used for mark recapture g1 was assumed to be non destructive so fish could be returned to the population and marked if appropriate mark recapture sampling whereas the second gear g2 was for depleting the population removal sampling this second gear improves information on population abundance and coincides with the sampling of fish on lakes in our field study see field data collection below but is not necessary in a mark recapture experiment data were simulated using two series of fishing efforts sampling scenario 1 or 2 table 6 and sampling duration i e years of data short 3 yrs 0 5 a long 6 yrs a selectivity to the mark recapture gear was defined by mean parameters that resulted in 50 selectivity at 65 mm full selectivity at 113 mm and declined to 75 selectivity by 190 mm selectivity of the depletion gear was defined by mean parameters resulting in 50 selectivity at 82 mm and full selectivity at 205 mm growth parameters were also systematically varied low lage 3 100 and lage 5 130 high lage 3 300 and lage 5 400 by varying net consumption rate h from the walters and essington 2010 bioenergetics model to either 7 0 or 9 0 as was variation around length at age low cvl 0 15 high cvl 0 3 the sampled population was assumed to have a maximum age a of 6 years the next model evaluation examined the ability of the lamr model to estimate annual recruitment across species of different longevity length based catch data were generated assuming six years of sampling a population with low effort sampling scenario 1 table 6 sampling a population with low growth h 7 0 table 4 and low coefficient of variation in length the two scenarios in this evaluation examined proportional error in parameter estimates when the life span of the population being studied is either equal to or double the number of sampling years i e six or 12 years the lamr length based model is conditioned on fixed growth parameters which we assume are known with certainty to evaluate the potential for growth parameter misspecification to introduce bias into parameter estimates we generated data using the ibm as above with sampling effort based on sampling scenario 1 table 6 and estimated them using lamr with either the net consumption rate h or net metabolic rate m set 10 higher or lower than the simulated population the final model evaluation examined the ability to accurately estimate to anomalously high recruitment in older year classes length based methods are often prone to difficulties distinguishing one strong versus multiple weak recruitment events in successive years a phenomenon known as smearing pitcher 2002 walters and martell 2004 in early year classes that have high overlap in size structure at the start of the experiment the model assumes a series of intermediate recruitment years rather than a single high recruitment year this is especially true in slow growing species to evaluate this we used the ibm to generate catch data from a long lived population a 30 with low growth h 2 0 m 0 8 and high coefficient of variation in length cvl 0 3 sampling was conducted using sampling scenario 1 in table 6 recruitment anomalies were generated using a standard deviation of 0 6 except in year class 7 which experienced recruitment 10 times the mean recruitment across all other years the estimation model was then used to estimate parameters to determine whether smearing of recruitment estimates occurs for long lived species with low growth 2 3 case study rainbow trout populations field data were collected from a series of eight lakes in south central british columbia canada on the bonaparte plateau which we collectively refer to as the bonaparte lakes each lake contains populations of rainbow trout which we refer to as trout herein which co occur with northern pikeminnow ptychocheilus oregonensis all lakes are within five kilometers of one another on a low relief landscape at similar elevation and experience similar environmental conditions and growing seasons taylor 2006 however population densities sampling intensities and sampling duration all vary across lakes and within lakes over the course of the study rainbow trout in the bonaparte populations exhibit slow growth for the species van poorten et al 2012 all lakes are foot access only and quite remote a private fishing lodge targeting rainbow trout exists in the middle of the study area but fishing pressure on trout from the lodge on the study lakes is usually quite low and external fishing pressure is non existent fishing mortality in all lakes except that caused by sampling is assumed negligible bonaparte populations were sampled using a combination of fyke nets and gill nets from 2001 to 2008 although not all lakes were sampled in all years fyke nets are classified as small 60 cm hoop diameter or large 90 cm hoop diameter nets each with a unique size selectivity gill nets consisted of a standardized combination of panels with stretched mesh ranging from 13 to 89 mm post et al 1999 askey et al 2007 annual sampling effort on each lake in each year is given in table 7 sampling consisted of a combination of year specific mark recapture experiments and occasional removal netting where all fish captured were measured and removed from the population to manipulate densities removal sampling occasions targeting trout occurred in wilderness lake in 2001 and in nestor lake in 2002 and again in all lakes from 2006 to 2008 table 7 scales were collected during each depletion sampling occasion to assess age from a subset of captured fish van poorten et al 2012 during mark recapture sampling fish captured in fyke nets were usually marked with a spaghetti tag and or given a fin clip measured and released minimum lengths for tagging varied over the study depending on tag size but typical minimum sizes were 120 mm captured fish below the minimum tagging size were given a fin clip unique to each capture year overwinter tag loss was assumed high and fin clips were unreliable after one year so marks were assumed to last one year fish recaptured after the first year were assumed to be unmarked in the data and the model this combination of multiple sampling gears the combination of marking and depleting techniques and the loss of marks after each year creates an analysis problem which is not readily treated using standard jolly seber mark recapture techniques trout size data were summarized using 60 length bins with width of 10 mm the date of recruitment was set at january 1 each year corresponding to age 0 5 since they typically rear in streams in their first summer one hundred gtgs were used for each year class note there are no established rules for deciding on the most appropriate number of gtgs we evaluated several options and settled on 100 as it was enough to ensure simulated length frequencies were not choppy i e there were no length bins that were between gtgs and additional gtgs did not change estimated parameters any number of gtgs could be used but too many does not improve estimates and significantly slows down estimation time all populations were evaluated simultaneously allowing for some parameters to be shared across populations the model assumed catchability and selectivity for each of the three fishing gears small fyke nets large fyke nets and gill nets were constant across years and lakes variation in size at age cvl was also shared across lakes selectivity of the two fyke nets was always assumed to be dome shaped following eq t1 13 selectivity of gill nets was assumed to be asymptotic askey et al 2007 following eq t1 14 mean and standard deviation in recruitment anomalies σr were estimated separately for each lake we estimated a single recruitment deviation for all year classes older than one third of the maximum age of trout at the start of the study all parameters were bounded to be above zero by log transformation except γg which was bounded to be between 0 and 1 by logit transformation and the annual recruitment residual which was untransformed and bounded to be between 10 and 10 natural mortality rate was estimated using a normal prior probability distribution with mean of 0 58 and 10 coefficient of variation 3 results comparisons of the popan jolly seber model with the lamr model demonstrated the risk of ignoring growth variation in mark recapture abundance estimates when there is size selective fishing fig 1 population estimates assuming capture probability varied with initial length were positively biased and bias generally increased throughout each year due to small fish becoming increasingly catchable higher vulnerability fig 1a median bias across all sampling events was 0 58 when the popan model assumed capture probability varied with the true vulnerability at first capture a similar pattern was seen fig 1b median bias across all sampling events in this scenario was 0 47 equivalent estimates based on the lamr model were slightly positive biased and relatively precise with no discernible pattern within or across years median bias across all sampling events was 0 01 fig 1c median proportional absolute error was less than 0 07 for all parameters across all simulated scenarios of fishing effort study length and population growth characteristics when using the lamr model table 8 increased fishing effort generally led to improvements in parameter estimates because of increased sample size and recapture rates especially in the range of proportional error within a parameter grouping longer study length marginally improved parameter estimates selectivity parameters were better estimated when growth rate was low and cv was low most other parameters were insensitive to growth estimates of parameters associated with selectivity and catchability of the two gears were the most difficult to estimate particularly for the depletion gear which was only used for three occasions within each year table 6 the coefficient of variation in length at age cvl was well defined across all scenarios even in instances where actual cvl was quite high leading to substantial overlap in size distributions of adjacent age classes within recruitment estimates bias was consistently greater for year classes that recruited prior to the beginning of the study referred to henceforth as early recruitment than for year classes that recruited within the years of the study late recruitment table 8 fig 2 the maximum age of the simulated population being studied did not appreciably affect the estimates of any parameters using the lamr model the exception was that in an older lived population there are more early recruited year classes for which the range of proportional error is higher than late recruited year classes fig 2 all parameters had minimal bias although early recruitment estimates often had a slight positive median bias across simulations and extreme cases can extend beyond twice the value of the true estimate mis specifying growth parameters specifically net consumption rate h and net metabolic rate m led to under or overestimation of length at age fig 3 in the lamr model which had a corresponding effect in the predicted mode of length frequencies of age classes in the model and parameter estimates when consumption in the estimation model was mis specified by 10 annual recruitment estimates of late year classes showed positive bias fig 3b when consumption in the estimation model was mis specified by 10 early year classes had a positive bias in recruitment whereas late year classes had neutral or negative bias fig 3c a change in the net metabolic rate had little effect on length at age for young fish but progressively influenced the predicted length at age of older fish early recruitment fig 3e accordingly mis specifying net metabolic rate had no impact on recruitment estimates of late recruited year classes fig 3e f simulated data from the ibm were used to evaluate the potential for the lamr model to smear recruitment estimates in slow growing long lived species the estimation model was able to reasonably estimate most year classes with 95 confidence intervals overlapping the true recruitment except for the year classes 6 8 where the year class with the disproportionately high simulated recruitment year class 7 was underestimated and the adjacent year classes were overestimated fig 4 these estimated year classes also showed higher uncertainty in recruitment estimates than many other year classes because the estimate of recruitment variability across years was underestimated this confirms that for early recruits in long lived slow growing species year by year recruitment estimates are somewhat of a running average of true recruitment across year classes because the assumption of annual recruitment being normally distributed is violated mean recruitment estimates for trout varied across lakes however all lakes showed occasional strong year classes fig 5 high mean recruitment in wilderness and nestor lakes which were depleted of adults in 2001 and 2002 respectively had low subsequent recruitment thereafter although nestor had two poor year classes leading up to the depletion abundance of trout in most lakes declined over the course of the study but total abundance was quite variable due to high levels of recruitment relative to the overall abundance fig 6 in lakes with poor catches cath and meghan lakes individual abundance estimates are most uncertain 4 discussion mark recapture studies over protracted periods of time are typically analysed using open population models such as variations on the jolly seber model seber 1982 which can estimate recruitment into the population of interest through birth or immigration as well as abundance and survival pine et al 2003 schwarz and seber 1999 however none of these models explicitly allow for growth and consequent individual changes in capture probabilities to be included thereby potentially leading to biases in recruitment and abundance estimates we have demonstrated that with standard jolly seber models a bias does exist even when the exact form of gear selectivity is known which in practice would rarely happen a key problem with jolly seber models is predicting the length of marked individuals in sampling occasions where they are not captured so that only the length at initial capture can be used as a proxy for individual capture probability schwarz and seber 1999 the lamr model assumes a persistent deviation of all fish from the mean population growth trajectory in the form of growth type groups consistent with inter individual observations e g biro et al 2014 allowing differences in capture probability between marked and unmarked fish to be estimated in fact our population estimates based on the popan model indicate the median error at each sampling occasion is approximately 75 across sampling occasions for our specific scenarios the extent of bias will depend on a number of factors especially the growth rates of animals in the population however estimating how this will impact abundance estimates is beyond scope of this paper the lamr model presented here is effective at estimating recruitment and abundance when individual variation in growth caused marked and unmarked individuals to have fundamentally distinct and time varying capture probabilities estimating animal abundance is often conducted using one of several approaches mark recapture methods catch effort methods or depletion methods estimating abundance and recruitment of small populations can often be carried out only using mark recapture because removal of animals will disturb the study population or is not possible due to conservation concerns protracted studies would either rely on open population estimates such as the jolly seber model or the robust design model which combines open and closed methods to address unequal catchability over time kendall et al 1995 pollock 1982 schwarz and seber 1999 as shown here any estimates based on protracted sampling will be biased due to the unequal capture probabilities of marked and unmarked animals in situations where the capture gear is size selective because fish exhibit indeterminate growth in harvested populations with high abundance it is often more common to estimate an abundance time series through the use of catch effort models where the changes in catch per unit effort cpue is attributed to observed removals or harvest effort hilborn and walters 1992 schwarz and seber 1999 harvest in commercially fished populations is often relatively constant or increasing over time so there is no chance for the population to partially recover this results in one way trip data walters and martell 2004 where it is difficult to separate population productivity from abundance hilborn and walters 1992 because the population index cpue can be either from a productive highly catchable population or an unproductive largely invulnerable population incorporating mark recapture into catch effort models allows for substantial information gain polacheck et al 2006 in situations where reducing harvest rates is not possible the lamr model can be used in either context small populations where marking is size selective and large populations where mark recapture could be incorporated to improve parameter estimation cadigan 2016 mark recapture data carry substantial information on capture probability that could greatly enhance the ability to estimate abundance in data poor studies besbeas et al 2002 polacheck et al 2006 we see the lamr model as a substantial addition to the analysis of both mark recapture and time series data our results highlight the difficulty in estimating the true magnitude of recruitment variation when an occasional high recruitment event occurs prior to the onset of data collection this is common in length based methods because of high overlap in size at age for older year classes pitcher 2002 this may also be due to an underestimate of the standard deviation of recruitment residuals σr as is common with the penalized likelihood used here maunder and deriso 2003 to correct the underestimation of σr maunder and deriso 2003 suggest using a bayesian approach which could also be incorporated here by setting annual recruitment estimates as random effects with associated hyper parameters for mean and standard deviation characterizing annual recruitment similar to the penalty function used here alternately in situations where the full recruitment history is not of critical importance or where sufficient age samples are not available we recommend pooling all older age classes as demonstrated with the bonaparte rainbow trout populations there are several key assumptions of this model which will be met in experimental settings where fishing mortality is limited or closely monitored but may not be met in other situations the first is that fishing mortality is known or absent obviously this is difficult to know in many situations and special attention will need to be paid to this assumption in future applications of this model populations with fishing will likely require additional data to account for this otherwise unexplained mortality the model is also conditioned on sampling effort which may be known in research settings where the researcher is the one doing the fishing but may be highly uncertain in situations where commercial fisheries are collecting data finally natural mortality rate is fixed which will strongly influence final abundance estimates clark 1999 all of these assumptions may limit the applicability of the model to larger scale experiments with high uncertainty in these rates although not examined here the use of informative prior probability distributions around these rates based on external information may help provide useful information to facilitate the use of this model in those situations the lamr model is useful for removing bias due to variation in size based capture probability especially due to sub year growth but its use is not appropriate in all situations lamr and the bioenergetics model that it relies on are both data intensive the bioenergetics model either requires fish to be aged or a relatively large number of recaptures within the year from individuals that span the length distribution of the population walters and essington 2010 lamr may be paired with another growth model but sub year length at age predictions are necessary which will certainly require detailed information on growth however we have shown the resulting bias associated with ignoring size based changes to capture probability and suggest this extra data requirement is a cost of accuracy in abundance estimates obviously if fish are resighted using methods that are not size selective e g pit tags or similar remote detection barbour et al 2013 lamr will not be necessary although could still be used by presuming selectivity is equal across lengths however resighting studies do not require recapture of fish which has additional benefits such as evaluating growth allowing inference of consumption and broader ecosystem impacts and threats van poorten and walters 2016 the lamr model estimates a time series of size and age based abundance which can be useful for determining various size based rates such as consumption and competition preliminary evaluations demonstrated that both total density and size based density measures such as effective density measured as the squared length across all fish in a population post et al 1999 are unbiased and relatively precise van poorten 2012 by estimating both mean population body growth and therefore age specific consumption van poorten et al 2012 as well as total age and size specific abundance it is possible to obtain an accurate estimate of total effect of the population on the resources through consumption or competition these rates have ecosystem wide implications and are particularly important when attempting to determine the implications of changes of management to one or more species on the ecosystem carpenter and kitchell 1996 acknowledgements this work benefited from the help of many people the project was initiated through conversations with eric parkinson of the british columbia ministry of environment members of field crews in every year are too numerous to name here but their hard work in difficult conditions is invaluable and appreciated the analysis presented here benefitted from early discussions with steven martell and murdoch mcallister and structural and editorial suggestions from kyle wilson and several anonymous reviewers support for bvp was provided by a scholarship from the natural science and engineering research council and a mitacs internship jointly funded by and held at the freshwater fisheries society of bc field work was primarily funded through a nserc discovery grant to cjw and grants from the bc small lakes management and conservation initiative to bvp and eric parkinson bc ministry of environment and the habitat conservation trust foundation to eric parkinson 
