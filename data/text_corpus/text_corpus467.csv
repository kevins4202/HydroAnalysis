index,text
2335,model soil moisture predictions are routinely updated with independent observations using data assimilation techniques while the impacts of these updates on modeled hydrology are well studied impacts on predicted water quality and crop yield are unresolved in this study we evaluated data assimilation effects for a range of predictions in the soil and water assessment tool swat we used satellite surface soil moisture data products from the soil moisture active passive smap mission to update swat soil moisture for two u s experimental watersheds we addressed possible limitations to the vertical transfer of surface soil moisture updates to deeper layers in the model by additionally testing a modified soil percolation approach that relies on relative saturation rather than the original thresholding behavior of swat results at both watersheds demonstrated that data assimilation greatly impacted water quality and crop yield predictions modifying the soil percolation algorithm however did not improve assimilation results assimilation increased median soil moisture 2 to 6 which in turn increased total streamflow 0 43 to 1 70 m3 s daily critically streamflow alone was not a sufficient predictor for the assimilation changes to water quality predictions as flow component contributions and seasonality differed between sites a varied response in annual water quality predictions to soil moisture updates was identified 1 70 to 123 kg ha total nitrogen 0 11 to 0 57 kg ha total phosphorous 8 1 to 50 0 kg ha sediment that was dependent upon the timing of the updates site characteristics and change to specific transport and transformation processes crop yield predictions were similarly impacted by data assimilation from changes to both water and nutrient availability that varied by crop type the overall strong and diverse response of water quality and crop yield predictions to soil moisture updates provides evidence that assimilation can impact a range of model predictions efforts to improve soil moisture simulations therefore have potential for meaningful improvements in targeted non hydrologic predictions keywords soil moisture swat smap ecohydrologic modeling data assimilation remote sensing data availability data will be made available on request 1 introduction excess nutrient loadings from managed lands to coastal or fresh waters is responsible for several adverse impacts on human and environmental health including exacerbation of infectious diseases johnson et al 2010 and creating toxic conditions for aquatic life cooper 1993 to address and minimize these impacts land managers rely on decision support tools to test and develop strategies for mitigating nutrient loading these tools rely on dependable measurements of key environmental variables including soil moisture which influences nutrient transport and transformation by linking and driving hydrologic climate and biogeochemical cycles entekhabi et al 1996 rodriguez iturbe 2000 seneviratne et al 2010 soil moisture measurement is therefore the target of both extensive in situ monitoring and remote sensing missions however neither approach captures the high variance of soil moisture at sufficient spatial resolution and extent for the needs of land managers typically at the watershed scale where cumulative management effects are observed brocca et al 2017 wagner et al 2007 models provide a flexible alternative to in situ and remote sensing based measurements that are implemented at a range of scales brocca et al 2017 vereecken et al 2016 vereecken et al 2014 if models are sensitive to changes in soil moisture its accurate estimation is potentially useful for a range of targeted ecohydrologic model predictions pignotti et al 2021a because the model soil moisture estimates are uncertain cheng et al 2017 koch et al 2016 xia et al 2014 using observations to update them is one strategy to combine flexible spatial scales of models with improved observational accuracy such practical techniques are broadly defined as data assimilation soil moisture data assimilation research has shown that there is generally improvement of updated target variables or parameters even when using spatially coarse observations azimi et al 2020 loew et al 2009 pan and wood 2010 parada and liang 2008 however previous soil moisture data assimilation research has focused on models which generally do not predict water quality may poorly simulate hydrology houser et al 2010 xie and zhang 2010 or lack dynamic vegetation lahoz and de lannoy 2014 research is therefore needed to determine the impacts of soil moisture data assimilation on ecohydrologic predictions that consider water quality in addition to water quantity cho et al 2020 to understand these impacts we assimilated soil moisture observations into the soil and water assessment tool swat arnold et al 1998 swat is a watershed scale model extensively used to study land use change impacts on hydrology and water quality many processes absent in other hydrologic or land surface models including water quality predictions crop growth and land management are explicitly simulated by swat previous hydrologic data assimilation research with swat table 1 has largely assimilated synthetic observations of either surface soil water content surf swc or streamflow critically no study has investigated the effects on water quality predictions which are of high importance in addressing negative human and environmental impacts of land management a potential obstacle in effective swat surface soil moisture data assimilation is the limited transfer of updates to deeper soil layers likely as a result of insufficient model subsurface physics chen et al 2011b han et al 2012 liu et al 2018 patil and ramsankaran 2017 because model structure can determine the success of data assimilation nayak et al 2021 evaluation of an alternative soil water routing approach to mitigate this limitation was an additional goal of this research accordingly we used a modified swat percolation method proposed in a separate study that demonstrated improved soil moisture dynamics pignotti et al 2021b we therefore addressed two questions to study the impacts of data assimilation in swat 1 what are the effects of soil moisture data assimilation on a range of swat ecohydrologic predictions and 2 is it possible to improve data assimilation performance with the use of an alternative soil water routing scheme we used an ensemble kalman filter data assimilation approach evensen 2003 with swat for two well instrumented experimental watersheds soil moisture observations were obtained from the nasa soil moisture active passive smap satellite mission which provides routine 2 to 3 days gridded 36 km soil moisture estimates when available these observations were merged with daily swat model soil moisture estimates to produce an updated soil moisture prediction to test the importance of soil water routing in the model assimilation was performed separately for both the original and modified soil water percolation approaches while efforts were made to sensibly implement data assimilation computational optimality of data assimilation was not a goal of this study 2 theoretical background 2 1 swat model swat is a semi distributed continuous daily watershed scale model capable of making several ecohydrologic predictions related to hydrology water quality and crop growth swat operates by separately simulating a land and routing phase with the general goal of predicting management and land use impacts on watershed response arnold et al 2012 arnold et al 1998 modeled watersheds are subdivided into separate subwatersheds which are then further discretized into unique combinations of land use soil type and slope referred to as hydrologic response units hrus swat landscape hydrologic simulations calculate a water balance for each unique hru as 1 sw i sw i i 1 t p i q i et i d i qr i where sw is the soil water content on day i p is precipitation q is surface runoff et is evapotranspiration d is percolation out of the soil column and qr is the return flow in mm flows generated at hrus are lagged and summed for each subwatershed after which routing occurs in a stream network across the entire watershed surface runoff is estimated using the curve number approach although the green ampt method 1911 can be used if sub daily precipitation data are available infiltration into the soil column is estimated as the difference between daily precipitation and runoff several soil layers are used with varying depths based on input soil data swat creates an upper soil layer of 10 mm by default to allow surface runoff to interact with nutrient processes and provide transport soil percolation and lateral flow are triggered once a soil layer s water content is above field capacity similar to a bucket type approach soil water processes do not occur below field capacity therefore unsaturated flow is not directly simulated by the model evaporation and transpiration are extracted from soil layers starting with the upper most layer the depth of extraction is controlled by parameters that specify how much demand may be met by lower layers there is additionally both a shallow and deep aquifer which can interact with the soil profile on a limited basis full theoretical documentation is provided by neitsch et al 2011 2 2 ensemble kalman filter in hydrologic and land surface modeling variants of the kalman filter kf kalman 1960 are widely used for data assimilation sun et al 2016b the kf recursively 1 forecasts a state estimate and its error covariance and then 2 updates them using an observation the state variable xk is defined within the context of the modeled system f as 2 x k f x k 1 w k 1 where k is the time step and wk is the model uncertainty from error in model formulation or forcing data error covariance of the state estimate is represented by pk and is concurrently calculated observations or measurements zk are related to the state estimate by 3 z k hx k v k where h is an observation operator that transforms the model state variable to the measurement space as needed measurement uncertainty commonly due to instrument error is represented by vk uncertainty of the model wk and measurement vk are assumed to have a zero mean gaussian distribution with error covariances of q and r respectively and are independent white noise processes reichle et al 2002 the updated state estimate is computed to minimize mean square error of the state estimate error covariance maybeck 1979 if the model is linear and the state and observation errors are independent white noise processes the kf solutions are the best linear unbiased estimate however strongly nonlinear relationships between soil moisture and hydrologic processes violate the linear assumptions of the kf reichle 2008 while the extended kf lee and ricker 1994 provides a nonlinear solution it is computationally limited in calculating the error covariances reichle et al 2002 to overcome this limitation a monte carlo approximation of the kf for nonlinear models referred to as the ensemble kalman filter enkf was developed evensen 2003 1994 rather than explicitly propagating the uncertainty forward in time the enkf samples an ensemble of model state trajectories to estimate uncertainty the enkf is therefore a popular data assimilation methodology in hydrologic modeling because of its robust estimation of error covariance for highly nonlinear systems liu et al 2012 sun et al 2016b a standard kf functions by sequentially using forecast and update steps in the forecast step the state estimate is predicted forward in time x k 1 to x k along with its uncertainty p k 1 to p k the state estimate is then revised using an observation during the update step x k to x k where their respective uncertainties are used to weight their combination the process is then repeated for the next observation operational use of the enkf relies upon perturbing the state estimate to generate an ensemble with individual members denoted by i the enkf then assimilates an observation at time k for each forecast ensemble member x k i using the ensemble sampled state error covariance p k for weighting 4 k k p k h t h p k h t r 1 where k is referred to as the kalman gain each ensemble member is then updated using the kalman gain to calculate a linear combination of the state estimate and observation 5 x k i x k i k k z k h x k i the ensemble mean of the updates is used as the best estimate of the state at the next time step the forecast adapts equation 2 for each ensemble member with random model error wk 6 x k 1 i f x k i w k i forecast state error covariance is sampled from the distribution of the ensemble state forecast 7 p k 1 i 1 n 1 i 1 n x k 1 i x k 1 x k 1 i x k 1 t where x is the ensemble mean the estimates of equations 6 and 7 are then used in equations 4 and 5 to continue the sequential process of forecasting and updating 3 study sites two u s department of agriculture agricultural research service usda ars experimental watersheds were selected to test the effects of soil moisture data assimilation and soil water equations 1 cedar creek watershed in indiana usa and 2 little river watershed in georgia usa fig 1 both sites are well instrumented and have several in situ soil moisture sensors at multiple depths while the data are too spatially sparse and localized for direct assimilation across the watersheds they were used as independent data to evaluate the impacts of remotely sensed soil moisture data assimilation on swat soil moisture estimates the two sites capture distinct climatology hydrology and landscape characteristics allowing evaluation of data assimilation results in varied settings both watersheds are additionally core validation sites for the smap mission chan et al 2016 colliander et al 2017 3 1 cedar creek the cedar creek watershed 707 km2 consists of two hydrologic unit code huc 10 subwatersheds 0410000306 and 0410000307 as part of the larger huc 8 st joseph river watershed 04100003 it is characterized by gentle slopes of 2 to 10 with an overall gradient towards the watershed stream outlet in the southeast temperature generally varies between 1 to 28 c with an annual average of 94 cm of precipitation heathman et al 2012 williams and king 2020 soil texture types are primarily silt loams silty clay loams and clay loams which promote high water retention and slow drainage land use is predominantly agriculture with the major crops consisting of rotational corn and soybean han et al 2012 heathman et al 2012 larose et al 2007 given the low slopes and slow drainage of soils artificial tile drainage is commonly implemented throughout the watershed on agricultural lands and represents a major pathway for water and nutrient transport royer et al 2006 williams et al 2018 the upper cedar creek has been monitored by the usda ars since 2002 measuring several climatic hydrologic and water quality variables there are currently 15 active soil moisture stations at depths of 5 20 40 and 60 cm made available for this study from 2005 until 2016 several swat modeling experiments have been conducted at either the cedar creek han et al 2012 larose et al 2007 rajib and merwade 2015 or more broadly the st joseph river watershed cibin et al 2016 her et al 2016 3 2 little river as part of the western headwaters of the suwannee river basin little river 334 km2 is a huc 8 watershed 03110204 in the u s coastal plains of southern georgia the watershed climate is humid subtropical with 121 cm of annual precipitation with an average temperature range of 3 to 33 c land use includes agriculture in upland flat areas of the watershed with forests and wetlands near the dense stream network on minor slopes the watershed is largely underlain by sands or sandy loams with high infiltration and quick drainage bosch et al 2007a bosch et al 1999 notably there is a shallow impermeable layer restricting deep percolation usda ars has monitored several climatic and hydrologic variables since 1967 including 29 soil moisture stations at depths of 5 20 and 30 cm made available for this study from 2001 to 2016 bosch et al 2007a bosch and sheridan 2007 feyereisen et al 2007 sullivan et al 2007 volk et al 2007 given the diversity and long period of record several swat studies have been conducted in the little river watershed arnold et al 2010 bosch et al 2010 2004 rathjens et al 2014 sahoo et al 2013 van liew et al 2007 4 remote sensing data remotely sensed soil moisture observations from satellite platforms provide global repetitive data products soil moisture is typically estimated from the microwave region of the electromagnetic spectrum where it is based on the large difference in dielectric properties of water and dry soil sensing in the microwave region of the spectrum is advantageous as measurements are neither dependent on solar radiation nor impacted by clouds njoku and entekhabi 1996 data products are however limited by shallow sensing depth 5 cm coarse spatial resolution 25 to 36 km poor retrieval quality over dense vegetation or rough terrain and radio frequency interference wagner et al 2007 4 1 smap data as opposed to the few highly localized in situ network observations remote sensing provides integrated coverage over the entire domains of our study watersheds and is thus better suited for assimilation soil moisture data products from the smap mission entekhabi et al 2010 were assimilated into swat at the hru level for this study smap was launched on january 31 2015 and was designed to synergistically combine complementary radar active and radiometer passive observations to overcome noise in former and poor spatial resolution in the latter however due to failure of the radar instrument on july 7 2015 only radiometer measurements are available the sentinel 1 platform torres et al 2012 has been used as an active system replacement in an effort to continue to produce soil moisture data products at improved spatial resolution das et al 2017 although they are not considered in this study smap observes a given location every 2 to 3 days at the same local solar time overpass acquisitions at 6 a m descending 6 p m ascending accuracy evaluations of smap at core validation sites have shown 0 04 cm3 cm3 unbiased root mean square error with similar performance between ascending and descending passes chan et al 2016 colliander et al 2017 smap level 3 radiometer products smap passive l3 radiometer v005 at 36 km spatial resolution were used in this study data are available beginning april 1 2015 until present given the availability of ground observations of soil moisture at the test watersheds smap data were acquired from april 1 2015 to december 31 2016 for assimilation experiments smap data were geospatially preprocessed to create a time series of smap observed soil moisture values for each hru in both swat models because hrus do not have a geographic position subwatersheds are the finest scale modeling unit in swat neitsch et al 2011 thus we used subwatershed centroids to find the nearest geographic smap center pixel location and assign it to all hrus within a given subwatershed as smap observations are an integrated estimate over a pixel s spatial domain they should appropriately capture the soil moisture signal for an area of interest to account for differences among hrus we bias corrected smap estimates for each hru separately only 6 a m descending pass smap data were used as land surface and soil profile temperatures are more stable and uniform at this time providing higher confidence in soil moisture retrieval chan et al 2017 colliander et al 2017 entekhabi et al 2010 because swat simulations are daily the 6 a m observations are more representative of the previous day s soil moisture thus smap observations were lagged by one day for assimilation purposes further filtering was performed using the smap retrieval quality flag rqf and removing observations that occurred below 4 c the temperature at which ground observations are considered unreliable colliander et al 2017 jackson et al 2016 similar filtering strategies have been employed by researchers for smos data assimilation with the swat patil and ramsankaran 2017 vic lievens et al 2015 and mike she ridler et al 2014 models after filtering smap data were available for 43 and 49 of all simulation days at cedar creek and little river respectively the lower coverage at cedar creek was directly related to the number of days below the temperature threshold whereas little river had zero days filtered for this reason 4 2 bias correction systematic differences or bias between model simulations and assimilated observations can lead to suboptimal performance of data assimilation yilmaz and crow 2013 and should be corrected dee and da silva 1998 reichle and koster 2004 sources of differences include mismatch in range mischaracterization of land use and soils or general sensor and model error drusch 2005 xu et al 2014 to therefore provide an effective assimilation update observations and modeled estimates must be rescaled into the same relative range rescaling is generally performed to correct observations to the model as it is more straightforward than to modify model parameters to fit observations kumar et al 2012 although dynamic online correction within the assimilation framework is feasible de lannoy et al 2015 bias correction is often performed prior to data assimilation given its relative simplicity draper et al 2009 liu et al 2011 reichle and koster 2004 ridler et al 2014 research suggests that most bias correction approaches generally perform well however they differ in their ability to correct higher order statistical moments of the distributions teutschbein and seibert 2012 some variation of cumulative distribution function cdf matching drusch 2005 reichle and koster 2004 or linear rescaling draper et al 2009 are most commonly used for this study linear rescaling was used given the relatively short period of record flexibility of the approach and poor preliminary performance of cdf matching at the little river watershed during exploratory analysis smap soil moisture values were corrected for individual swat hrus over the nearly two years of smap observations linear rescaling was applied monthly according to 8 θ i m s m a p μ m swat θ i m smap μ m smap σ m swat σ m smap where θ is the soil moisture μ are the means σ are the standard deviations i is the given hru m is the month and is indicative of the corrected dataset monthly corrections ideally help to account for temporally inconsistent dynamic bias 5 swat model setup a swat model was created for each watershed based on the specifications provided in the supplementary materials including management operations this resulted in 57 subbassins with 821 hrus for cedar creek and 8 subbasins with 815 hrus for little river with their outlets defined to match usgs gauging stations observed data used for model input calibration and to evaluate performance are summarized in table 2 5 1 soil moisture a 5 cm soil layer was added for all soil types in the swat models to match the depth of smap observations this new layer was assigned the properties of the soil layer that it subdivided exploratory analysis showed the addition of this layer modified model simulated hydrology contrary to the findings of patil and ramsankaran 2017 while soil discretization effects in swat are not well described in the literature and warrant future research a 5 cm layer was necessary for this study given the large discrepancies between smap observation depths and soil input layers swat simulated soil water content is provided as crop available water content in mm to relate to volumetric smap observations swat source code was modified to compute and print out soil water content as the sum of crop available and wilting point water content divided by the depth of the given layer sub hourly soil moisture in situ observations were averaged by day for each sensor to compare to daily swat predictions values were screened to remove any volumetric soil moisture values below 0 0 and above 0 6 cm3 cm3 to compare swat simulations four sites were selected in each watershed table 3 sites were chosen based on the sensor locations that directly corresponded to a modeled hru with an appropriate swat land use classification fig 1 the number of swat soil moisture estimates for each hru varied due to variable number and depths of soil layers for a given input data soil classification to compare these values to fixed depth in situ sensors any sensor that fell within a specific swat soil layer depth was used for comparison to that layer if multiple sensors were within a single swat soil layer they were averaged weighted according to their relative depth from the sensor to the top or bottom of the specific soil layer 5 2 soil moisture routing modifications possible limited transfer of surface soil moisture assimilation updates to deeper layers chen et al 2011b han et al 2012 liu et al 2018 patil and ramsankaran 2017 was addressed by testing a modified soil water routing approach from a previous study pignotti et al 2021b default soil water redistribution in swat presents two primary limitations 1 percolation only occurs when soil moisture is above field capacity and 2 soil water is drained using the saturated rate regardless of relative saturation in effect approximately all excess soil water above field capacity drains from a soil layer in a single model time step day and ignores any possible unsaturated redistribution the modified approach removes the threshold and instead continuously governs soil water percolation using a relative saturation based unsaturated rate adapted from the van genuchten equation van genuchten 1980 the rate of soil water percolation then nonlinearly decreases with decreasing soil moisture previous research found the modified approach improved soil water simulation by reducing the rapid transport of soil water content out of a layer when it was above field capacity pignotti et al 2021b without a field capacity threshold percolation occurred over a greater range of soil water contents which should provide longer periods of interaction between soil layers assimilation experiments for this study were therefore performed using 1 the original swat soil water routing and 2 the modified approach and then compared to determine potential benefits of the latter 5 3 model calibration to isolate the effects of the percolation approach and data assimilation updates we first calibrated swat models without percolation modifications and then transferred the calibrated parameters to the modified percolation models while this approach may not provide optimal parameters for modified percolation models we determined it was necessary to remove possible confounding calibration effects on our results for example if we instead recalibrate the modified percolation models it is likely we would be measuring the effect of calibration on our predictions in addition to differences from model percolation and data assimilation updates accordingly swat models without percolation modifications were calibrated for streamflow at the watershed outlets eleven parameters table 4 were used based on previous swat research in the watersheds cedar creek her chaubey 2015 larose et al 2007 rajib et al 2016 wang et al 2017 little river cho et al 2020 feyereisen et al 2007 van liew et al 2007 we then transferred these calibrated parameters to the modified percolation models and added an additional parameter swcexp to control the rate of change between soil water content and hydraulic conductivity in the modified percolation equation see pignotti et al 2021b for details calibration was then independently conducted for the modified models for this additional parameter while retaining the other transferred parameters calibration was performed using a multi algorithm genetically adaptive approach amalgam vrugt and robinson 2007 with a population of 48 over 60 generations for a total of 2 880 simulations the objective function was set to optimize the daily kling gupta efficiency kge gupta et al 2009 which combines the timing correlation coefficient magnitude mean and variability standard deviation of simulated time series relative to the observations the kge ranges from negative infinity to one where values closer to one are ideal and those greater than zero are considered acceptable calibration and validation were run from 2007 to 2011 and 2012 to 2016 respectively with three years of model warm up prior to calibration 5 4 water quality and crop yield soft data analysis water quality and crop yield were not included in model calibration due to lack of sufficient data for a meaningful calibration instead water quality and crop yield observations were used as soft data yen et al 2016 to evaluate corresponding predictions across model scenarios water quality data in the watersheds were sparsely collected generally once per month at the stream outlets at cedar creek data have been collected since 2001 while little river was sampled only during 2009 and 2010 the usgs load estimator software loadest runkel et al 2004 was therefore used to convert these instantaneous water quality concentrations into estimated monthly cumulative loads for total nitrogen total phosphorous and sediment to compare to swat estimates annual crop yield data were available aggregated by county from the national agricultural statistics survey nass swat predictions however are at the hru scale and are predicted in different units than those provided by nass while nass cannot thus support field specific calibration or validation for hrus sinnathamby et al 2017 we computed an area weighted yield from these data based on the watershed overlap with each county nass yield was converted from bushels per acre to kilograms per hectare using the approach in srinivasan et al 2010 and cibin et al 2016 for comparison to swat predicted yields 5 5 enkf integration into swat 5 5 1 ensemble simulation the swat enkf data assimilation approach of han et al 2012 was adapted for this study fig 2 the key difference in our approach was the use of remotely sensed smap surface soil moisture data as opposed to synthetic data which required flexibility in handling days without observations when bias corrected smap observations were available they were assimilated otherwise the model progressed forward with ensemble soil moisture predictions until the next smap observation daily soil moisture assimilation was performed independently for each swat hru one hundred initial ensembles for each hru were generated by perturbing soil moisture using a zero mean gaussian distribution with a 0 001 mm standard deviation each ensemble member simulated all the landscape hydrologic processes that rely on soil moisture the mean of the predicted ensemble was then computed and used for watershed routing to focus on the impact of soil moisture assimilation and minimize confounding effects forcing variables precipitation and temperature were not explicitly perturbed chen et al 2011b han et al 2012 it was assumed that uncertainty from these data was accounted for in the error term wk of equation 2 5 5 2 assimilation error specifications given the complex and challenging nature of estimating model and observational uncertainty specification of error parameters are commonly user defined de lannoy et al 2019 these error covariances reflect uncertainty in the model forecast or observations via the kalman gain k in equation 4 they determine how closely simulations are aligned with observations during assimilation because model forecast error variance is dynamically estimated from the ensemble choice of ensemble noise or perturbation is key crow and van loon 2006 while multiple approaches ranging in complexity can be used crow and reichle 2008 there remains no widely accepted methodology massari et al 2015 for this study the error was randomly sampled from a zero mean gaussian distribution with a time varying standard deviation obtained by multiplying the non ensemble predicted soil moisture value by a scaling factor of 0 01 while this scaling factor type approach is advantageous in allowing the error variance to vary in time it likely overestimates the standard deviation at high soil moisture values and contributes to nonlinearities near the physical boundaries of soil water content i e saturation and wilting point han et al 2012 other approaches such as adaptive filtering reichle et al 2008 may offer better assimilation performance however the simplicity of a scaling factor was preferred given the goals of this study perfect vertical correlation was assumed between soil layers for the perturbations as suggested by chen et al 2011b and previously applied by han et al 2012 and patil and ramsankaran 2017 physical bounds on soil moisture state i e saturation and wilting point necessitate restrictions to ensemble soil moisture estimates however these constraints may bias the ensemble and skew the forecast error to account for this possible boundary truncation ensemble bias the methodology proposed by ryu et al 2009 was applied as in han et al 2012 in this method for each step update the mean bias estimated between the unperturbed soil moisture and ensemble mean is subtracted from ensemble members ensemble members with values above saturation are adjusted to saturation and negative values to 10 6 however this adjustment may then cause the ensemble mean to change to account for possibly shifting ensemble averages and therefore mean bias the method is repeated ten times to reduce remaining bias observation error covariance r in equation 4 relates to sensor retrieval and representativeness error it is often captured for remote sensing by comparing estimates to independent ground based observations or is otherwise approximated massari et al 2015 in our study observation error covariance was fixed as the common sources for remotely sensed error e g radio frequency interference soil roughness vegetation are not proportional to soil moisture state both of our study watersheds and their in situ soil moisture networks are used for smap validation chan et al 2018 colliander et al 2017 therefore reported smap accuracy provides known error from which we estimated our observation error covariances we used these unbiased root mean square errors as a proxy for error variances in each swat model data assimilation experiment from reported values unbrmse was rounded to 0 04 cm3 cm3 0 0016 cm3 cm3 error variance and 0 03 cm3 cm3 0 0009 cm3 cm3 error variance for cedar creek and little river respectively perturbations to the state variable transformed into the space of the observations v in equation 3 were sampled from a zero mean gaussian distribution with a standard deviation of 0 01 cm3 cm3 6 scenarios tested given the availability of smap data products april 2015 to present and soil moisture ground observations cedar creek 2005 to 2016 little river 2001 to 2016 assimilation was performed from april 1 2015 to december 31 2016 to test the effects of assimilation and the alternative soil water routing approach four model runs were used 1 original orig swat model soil water equations without data assimilation open loop ol 2 van genuchten based vg soil water equations without data assimilation vg ol 3 original swat model soil water equations with data assimilation orig da and 4 van genuchten based equations with data assimilation vg da model simulations included a swat warm up from january 2009 to march 2012 an ensemble warm up from april 2012 to march 2015 and smap data assimilation from april 2015 to december 2016 the three year ensemble warm up was determined from sensitivity analysis where minimal soil moisture updating occurred during the first assimilation year with shorter warm up periods the data assimilation period april 2015 to december 2016 was used to evaluate model predictions in all analyses ground based observations were considered the true reference to which all model simulations were compared using unbiased root mean square error unbrmse percent bias pbias and the pearson correlation coefficient r to directly assess the effects of data assimilation the normalized error reduction ner was used 9 ner 1 rmse a rmse o which evaluates the ratio of the root mean square error rmse after a and prior to o data assimilation ner ranges from negative infinity to one where any positive value is indicative of improvement from data assimilation all simulations were performed using swat version 664 7 results and discussion 7 1 model calibration calibration statistics table 4 indicated good performance of swat in matching daily observed streamflow cedar creek kge 0 85 orig 0 75 vg little river kge 0 73 orig 0 58 vg relatively worse performance at little river was primarily due to the model s inability to correctly capture low magnitude flow events which has been noted in previous research white et al 2009 the lower kge values for the vg models at both watersheds were expected as parameters from the orig calibration were transferred for vg calibration this approach does not provide an optimal vg model calibration because orig model calibrated parameters do not account for changes to subsurface hydrology from the modified vg soil water equations however it was necessary to remove possible differences in calibration effects on our results and instead only measure changes in model predictions from percolation methodology and data assimilation updates 7 2 bias correction smap data bias correction was performed separately for the orig and vg models yielding similar results prior to data assimilation experiments soil moisture data were compared for average in situ 5 cm measurements hru averaged orig swat upper layer soil moisture and original and bias corrected smap soil moisture fig 3 using the in situ observations as reference swat predicted soil moisture exhibited a dry bias at both sites highlighting the potential for improvement in these watersheds smap estimates initially displayed a wet bias that was removed after bias correction transforming smap observations into the range of the swat models for assimilation 7 3 soil moisture analysis 7 3 1 effects on soil moisture distributions soil moisture response to model type and data assimilation was evaluated temporally for each selected site table 3 by comparing the ensemble mean simulations to ground observations figs 4 and 5 supplementary materials figs 1 6 the number of layers for each site was determined from input soil data layer depth specifications on average data assimilation slightly increased median soil water content for most layers between 2 and 6 cedar creek 0 005 cm3 cm3 layer 1 0 015 cm3 cm3 layer 2 0 020 cm3 cm3 layer 3 little river 0 001 cm3 cm3 layer 1 0 004 cm3 cm3 layer 2 0 005 cm3 cm3 layer 3 while reducing inner quartile ranges between 10 and 52 cedar creek 0 023 cm3 cm3 layer 1 0 034 cm3 cm3 layer 2 0 031 cm3 cm3 layer 3 little river 0 003 cm3 cm3 layer 1 0 010 cm3 cm3 layer 2 0 008 cm3 cm3 layer 3 see supplementary materials tables 4 and 5 increased soil moisture was a promising response in correcting for the identified swat soil moisture dry bias fig 3 while increased medians reduced the differences between observations and estimates post assimilation decreased ranges did not particularly at cedar creek slower and wetter dry down rates after data assimilation reduced dry soil moisture occurrence and therefore the overall range this demonstrated a drawback of assimilation in this study where cedar creek reduction in average error was accompanied by a limited soil moisture range in scenarios where capturing the appropriate range of soil moisture values e g low values in this study are critical this change in soil moisture range is important to consider this effect was however less pronounced at little river where relatively coarser textured soils sands allow quicker subsurface transport of soil water and have a lower water holding capacity while the vg and orig simulations were generally similar the vg models tended towards a relatively improved soil moisture range especially in deeper layers in the orig model rapid swat soil water drainage for soil water in exceedance of field capacity limited peak soil water pignotti et al 2021b the vg approach was able to avoid this limitation by allowing soil moisture to remain above field capacity and therefore simulate a larger range of soil moisture values this effect was obvious at little river where soil moisture variance was primarily driven by model type rather than data assimilation regardless of simulation approach there was a strong mismatch in the range of observations compared to predictions for several layers at many sites disagreement in soil properties between the geo soil database i e ssurgo and the physical values at the ground observation sites is the source of this difference and is a significant challenge in comparisons with different spatial scale and support model calibration to soil moisture observations could potentially resolve this issue and improve overall model predictions however soil moisture calibration in swat is complex kundu et al 2017 and in our study difficult with limited in situ observations available there was additionally possible mischaracterization of precipitation at the test sites demonstrated by simulated soil moisture peaks that were not observed figs 4 and 5 supplementary materials figs 1 6 because only two precipitation gauges were used as inputs at both cedar creek and little river it is likely that local precipitation variability was not well captured goodrich et al 1995 error in precipitation data directly impacts soil moisture estimates and may limit improvements from data assimilation updates for model simulations han et al 2012 7 3 2 effects on soil moisture error the impacts of assimilation based changes to soil water content were quantified according to several model performance measures that compared swat estimates to independent in situ observations figs 6 and 7 supplementary materials tables 6 and 7 these measures indicated that overall error unbrmse averaged across all sites and layers was reduced moderately with data assimilation 12 9 0 007 cm3 cm3 and 5 3 0 002 cm3 cm3 at cedar creek and little river respectively greater relative error reduction at cedar creek was likely due to differences in climate and landscape characteristics between the watersheds e g tighter coupling of soil layer interactions with higher clay content both known to affect data assimilation outcomes brocca et al 2012 kumar et al 2009 however it is unlikely that differences in catchment area played a role massari et al 2015 error reduction corresponded to positive ner values of 0 13 and 0 016 at cedar creek and little river respectively this provided further evidence of general improvement in post assimilation soil moisture predictions although only slightly at little river improvements centered upon wetter post assimilation soil moisture conditions which led to a decrease in pbias at cedar creek 1 01 and little river 0 42 as the open loop model dry bias was reduced from a temporal perspective correlation improved by 7 8 0 04 cm3 cm3 and 9 4 0 05 cm3 cm3 at cedar creek and little river respectively this highlighted a possible important benefit of data assimilation updates as the timing and duration of major wet or dry events are crucial model predictions and thus their improved dynamics represents a key outcome scipal et al 2005 in particular data assimilation improvements in soil moisture dynamics can compensate for precipitation input uncertainty which is known to strongly influence predictions brocca et al 2010 han et al 2012 román cascón et al 2017 7 3 3 impacts by layer depth there was no clear indication that soil moisture assimilation updates were restricted to the uppermost soil layer moderate error reduction was found regardless of layer and site unbrmse cedar creek 0 010 cm3 cm3 layer 1 0 009 cm3 cm3 layer 2 0 003 cm3 cm3 layer 3 little river 0 002 cm3 cm3 layer 1 0 002 cm3 cm3 layer 2 0 002 cm3 cm3 layer 3 while minimal vertical transfer of assimilation surface updates has been previously noted as a major swat limitation chen et al 2011a han et al 2012 other assimilation related research has found moderate improvement in deeper soil layers lei et al 2014 sun et al 2016a it is difficult however to compare results across multiple studies because of the differences in methodological approaches for example the use of synthetic or real data soil layer definition error assumptions bias correction sample size model setup and calibration number and spatial coverage of observations and other general enkf implementation related factors are all key e g see table 1 future efforts to determine the most sensitive variables and parameters of the model and assimilation approach for soil moisture dynamics are therefore critical in adapting and unifying these disparate approaches including this study additional direct changes to and testing of vertical soil water redistribution that removes confounding factors is also likely needed 7 3 4 impacts by model soil water routing approach an alternative soil water routing scheme was implemented in this study to address the anticipated limitations of assimilation updates to deeper soil layers while assimilation with the vg model did not outperform the orig model at cedar creek ner 0 14 orig 0 12 vg its use resulted in some improvement at little river ner 0 003 orig 0 037 vg therefore although the vg equations could improve predictions alone when used in combination with data assimilation our findings provided evidence that our modified percolation did not positively interact with assimilation updates to improve soil moisture predictions more physically based schemes such as richard s equation could allow for improved interaction but may require a higher computational cost qi et al 2018 given that assimilation degraded the performance of modified soil water routing in some instances this study suggests there is potential for future improvement with further refinements and efforts to harmonize their combined use 7 4 effects on watershed scale water balance assimilation updated soil moisture modified several components of the predicted annual watershed water balance figs 8 and 9 supplementary materials table 8 the two soil water routing approaches displayed similar changes after data assimilation with average annual profile soil moisture increases of 100 mm and 97 5 mm at cedar creek and little river respectively this increase was an aggregate response to increased median soil moisture in the assimilation soil layer and its transference to deeper layers the greatest monthly soil moisture increases occurred during the growing season broadly defined as april through november when open loop soil moisture predictions were low percolation also increased annually along with soil moisture cedar creek 41 mm orig 24 mm vg little river 99 mm orig 73 mm vg where there was relatively lower percolation for the vg approach due to greater soil water retention however although retention increased overall soil water content was relatively lower for the vg models 30 mm cedar creek 55 mm little river from increased percolation events that occurred below field capacity pignotti et al 2021b soil moisture increases from data assimilation translated into increased flow for various transport components of the water balance dominant subsurface flow characteristic of each watershed exhibited the largest change at cedar creek tile flow increased annually by 61 5 mm on average while at little river groundwater flow increased by 82 5 mm evapotranspiration conversely decreased after assimilation 108 mm cedar creek 116 mm little river this decrease in annual evapotranspiration was approximately equal to the annual increase in water yield i e sum of surface runoff lateral flow tile flow and groundwater flow which was largely related to increases in the dominant subsurface flow processes because flow processes sequentially occur prior to evapotranspiration in the model it is possible the increase in soil moisture post assimilation triggers greater water flow out of the soil leaving less available for plant uptake further investigation using measured evapotranspiration data could help determine if data assimilation improves evapotranspiration estimates and where to target additional model improvements seasonal signals were apparent at both watersheds although revealed opposite trends most water balance components demonstrated increases during the growing season at cedar creek while they occurred during the non growing season at little river differences in site characteristics namely precipitation timing and magnitude dictated these responses as it is directly responsible for providing water input to the system this finding highlights the importance of the seasonal watershed characteristics when assimilating soil moisture which is critical in determining plant growth and nutrient transport and transformation for instance increased soil moisture during the growing season may allow for lower crop water stress but increase the transport of nutrients this effect may be less significant during the non growing season when fertilizers are not frequently applied but may lead to higher flows with erosive potential without structural support provided by crop roots in agricultural lands 7 5 effects on streamflow predicted streamflow at the watershed outlets increased as a result of post assimilation increases in water balance flow components figs 10 and 11 supplementary materials tables 9 and 10 the median of daily average streamflow increased by 1 7 m3 s and 0 43 m3 s and cumulatively monthly by 55 5 m3 s and 19 5 m3 s at cedar creek and little river respectively this corresponded to an average kge increase at both sites 0 24 cedar creek 0 05 little river and an average daily decrease in streamflow unbrmse for three of the four models cedar creek 0 23 m3 s orig 0 30 m3 s vg little river 1 17 m3 s orig 0 16 m3 s vg post assimilation error was not reduced for the little river orig simulation where capturing streamflow was challenging particularly for low flow values the little river vg model however demonstrated slight streamflow prediction improvement post assimilation this was surprising given calibrated parameters were transferred to the vg model from the orig model and were likely not optimal kge 0 73 orig vs 0 58 vg it is possible that by allowing for greater soil water retention the vg model provided favorable conditions for runoff and therefore streamflow this is a potential advantage in more readily improving simulations via data assimilation in little river moreover it further suggests that assimilation with the vg approach may compensate for non optimal parameters in addition to the findings of this study previous research has provided evidence for the benefits of soil moisture data assimilation to improve swat streamflow azimi et al 2020 liu et al 2018 patil and ramsankaran 2017 sun et al 2016a particularly those that used remotely sensed data products liu et al 2018 patil and ramsankaran 2017 however other research has highlighted limited success at improving streamflow estimates due to either weak coupling of the soil layers chen et al 2011b or a lack of sensitivity to soil moisture updates for model flow generating parameters han et al 2012 improvements to swat predicted streamflow are additionally site specific manifesting during low flow conditions liu et al 2018 by reducing peak flow overestimation sun et al 2016a or during a strong seasonal wet cycle patil and ramsankaran 2017 explicitly determining under which conditions assimilation updates are beneficial is thus an important future research need previous efforts have identified specific catchment characteristics that may limit impacts and demonstrated the greatest benefits are likely for models with poor baseline performance or uncertain precipitation inputs de santis et al 2021 it is evident nevertheless that changes to the soil water content are intrinsically linked to the predicted water balance and therefore remain critical to model streamflow predictions 7 6 effects on water quality predicted water quality loads were within expected regional ranges harmel et al 2008 smith and alexander 2000 white et al 2015 without direct calibration of water quality parameters figs 10 and 11 supplementary materials tables 10 and 11 modeled predictions were compared to estimated loadest values although these estimates were limited by sparse sampling and few data at little river only 2009 and 2010 water quality loads overall exhibited a varied response to soil moisture data assimilation updates and depended on how soil moisture changes affected the transport and transformation processes of specific water quality predictions because both modeling approaches orig and vg displayed similar water quality responses to soil moisture assimilation they were averaged for simplicity in examining assimilation effects on water quality predicted total nitrogen loads at cedar creek changed by the largest amount after data assimilation with median loads increasing by an order of magnitude at the monthly scale 9 9 kg ha monthly 123 kg ha annually this increase was largely a result of increased tile flow the primary mechanism for nitrate transport royer et al 2006 such a large increase illustrates the potential need for implementing a water balance constraint e g yilmaz et al 2011 in future assimilation experiments constraining tile flow increases could then directly address overestimation of total nitrogen in this experiment these increased total nitrogen loads were particularly apparent over the growing season when fertilizers were applied in the model nitrogen loads at little river were less affected with slight decreases in median predictions 0 095 kg ha monthly 1 70 kg ha annually because artificial tile drainage is not used at little river there was less total nitrogen exported from the watershed moreover little river predicted subsurface flow increased primarily during the non growing season when based on fertilizer application timing there was less expected available nitrogen for transport post assimilation total nitrogen loads instead decreased at little river due to relatively higher soil moisture that promoted leaching out of the soil profile along with longer residence times that favor denitrification porporato et al 2003 median total phosphorous loads at both watersheds tended to slightly decrease post assimilation cedar creek 0 015 kg ha monthly 0 57 kg ha annually little river 0 002 kg ha monthly 0 11 kg ha annually surface runoff is the dominant transport pathway for phosphorous royer et al 2006 however while surface runoff increased it occurred primarily over the non growing season when less fertilizer is applied and soil moisture was relatively higher elevated soil moisture creates anoxic conditions that promote phosphorous release from soil and organic particle binding jordan et al 1993 this mobilized phosphorous could be more readily taken up by crops 302 kg ha cedar creek 554 kg ha little river per year or leached 2 9 kg ha cedar creek 8 1 kg ha little river per year in swat and was therefore less available for surface runoff transport although sediment loads are similarly transported by surface runoff they did not follow total phosphorous behavior instead median sediment loads increased post assimilation cedar creek 3 1 kg ha monthly 50 kg ha annually little river 0 7 kg ha monthly 10 kg ha annually because sediment does not participate in phase or chemical transformation nor is taken up by plants its transport is affected only by soil moisture changes to surface runoff therefore as increased soil moisture generated additional surface runoff sediment transport increased in real agroecosystems most sediment and nutrient loads are transported during large single event storms borah et al 2003 david et al 1997 gentry et al 1998 where nearly all export occurs at streamflow values greater than the median royer et al 2006 this would suggest for this study that both sediment and nutrient loads should be expected to increase given post assimilation streamflow increases however while this was true for sediment loads annual total phosphorous tended to decrease as noted previously while annual total nitrogen only increased at the cedar creek watershed inferring changes to nutrient loads based on change in total streamflow alone therefore would inadequately capture the dynamics understanding changes to specific water balance components and flow pathways are needed to properly evaluate nutrient load predictions particularly those related to transport and transformation of nitrogen and phosphorous we therefore believe the impacts on water quality predictions identified in this study are an important finding which has received limited consideration to date this is especially crucial for swat applications which are generally intended to predict water quality in management scenario analyses 7 7 effects on crop yield modeled yield for the four major crops evaluated demonstrated a non uniform response to data assimilation fig 12 supplementary materials tables 12 observed yield data was used as a reference point for model predictions but was not quantitatively used to evaluate accuracy of yield predictions given limited direct comparability between swat hru predictions and county level yield counts while it is conceivable that calibration of plant growth parameters would improve these predictions we focused on the relative model prediction change from data assimilation yield predictions showed a greater change for non legumes cedar creek corn little river cotton after data assimilation than legumes i e nitrogen fixing plants cedar creek soybeans little river peanuts non legume yield decreased after data assimilation at both watersheds in three of the four models evaluated averaged over the two simulation years cedar creek corn 6 900 kg ha orig 5 300 kg ha vg little river cotton 180 kg ha orig 710 kg ha vg changes in yield were driven by changes in soil moisture that increased or decreased water and nutrient availability to crops decreased yields were linked to increased nitrogen stress cedar creek 8 days orig 5 days vg little river 13 days orig 11 days vg following increased nitrogen transport and transformation post assimilation legume yields were less influenced by data assimilation changes to soil moisture as they naturally fix nitrogen and are therefore less dependent upon availability of fertilizer based nitrogen inputs their yields accordingly showed an increase cedar creek soybean 570 kg ha orig 640 kg ha vg little river peanuts 280 kg ha orig 770 kg ha vg attributed to less water stress cedar creek 12 days orig 12 days vg little river 9 days orig 20 days vg from general post assimilation increases in soil moisture overall this identified variability in crop response underscores the complex and cumulative effect of changes induced by soil moisture assimilation 8 conclusions soil moisture data assimilation research has previously not explored water quality effects particularly when assimilating remotely sensed data products to understand these impacts smap surface soil moisture data were assimilated into the swat ecohydrologic model and a range of biophysical and biogeochemical predictions were evaluated anticipated transfer limitations of assimilation updates for deep layer soil moisture were addressed by testing an alternative soil water routing approach for swat data assimilation moderately increased median soil moisture predictions correcting for a dry bias in swat open loop simulations and reducing prediction error while poorly characterized soil properties in the model restricted potential improvements in the magnitude of soil moisture temporal improvements were promising in linking soil moisture change to hydrologic dynamics our results did not indicate that data assimilation updates were restricted to surface soil moisture contrary to expectations there is however no established consensus for swat that describes scenarios in which surface updates transfer to deeper layers during surface soil moisture assimilation the findings here in combination with previous research underscores the need to investigate the aspects of the model that are sensitive to or control this transfer to better ensure a realistic movement of assimilated surface soil moisture throughout the soil column an alternative soil water routing approach was tested to address this perceived depth transfer limitation however it did not outperform the original model simulations post assimilation this suggested that there was limited interaction between the soil water routing approach and data assimilation updates future efforts to maximize potential assimilation benefits may consider using advanced approaches including improving model forecast and observation error specification e g crow and van den berg 2010 or joint calibration and assimilation which has shown promise e g koster et al 2018 and is a logical next step use of soil moisture data products with finer spatial resolution or deeper soil profile estimates such as combined smap sentinel 1 or root zone smap data products chan et al 2018 reichle et al 2017 could provide additional improvements soil moisture changes from data assimilation updates impacted hydrologic water quality and crop yield predictions increasing soil moisture increased total streamflow especially via increased subsurface loss tile flow at cedar creek groundwater flow at little river although streamflow predictions were improved by data assimilation updates it was not necessarily a good individual indicator of broad data assimilation impacts the context timing and magnitude of changes for specific water balance components were key this was particularly apparent for water quality predictions that responded differently to soil moisture data assimilation based on changes to the available water for mobilization and subsequent transport out of the soil profile nutrient availability primarily controlled by fertilizer applications in combination with seasonal precipitation patterns further affected these changes that were distinguishable between the cedar creek and little river watersheds these combined changes to the water balance and nutrient availability led to changes in crop yield predictions that were specific to individual crop functional characteristics e g nitrogen fixing ability demonstrating the cascading impacts of soil moisture assimilation throughout the model swat arguably was not intended to precisely simulate soil moisture however because several modeled processes are sensitive to its dynamics efforts to improve predictions are critical in other relevant model predictions while further research is needed to optimize data assimilation approaches in swat the findings here support the conclusion that soil moisture assimilation greatly influences ecohydrologic predictions this provides evidence that future efforts to update simulations with soil moisture data products hold significant potential given the dependence of predictions on soil moisture more representative or rigorous estimates of soil moisture may then improve our ability to predict hydrologic and water quality processes that depend on soil moisture dynamics as land managers rely on modeling analyses e g decision support systems improving these predictions is vital in our ability to assess monitor and manage adverse environmental impacts future land management informed by increasingly reliable and robust predictions is critical for sustainable approaches that engender and maintain resilient ecosystems credit authorship contribution statement garett pignotti conceptualization methodology software investigation visualization writing original draft writing review editing melba crawford conceptualization methodology supervision writing review editing eunjin han conceptualization methodology supervision writing review editing mark williams resources data curation writing review editing indrajeet chaubey conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank steve kelley and the purdue rosen center for advanced computing for providing valuable support resources and insight in completing the computational aspects of this research we would also like to acknowledge the assistance of the usda ars national soil erosion research and southeast watershed research labs in providing observational soil moisture data and in particular stan livingston scott mcafee and david bosch this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129122 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2335,model soil moisture predictions are routinely updated with independent observations using data assimilation techniques while the impacts of these updates on modeled hydrology are well studied impacts on predicted water quality and crop yield are unresolved in this study we evaluated data assimilation effects for a range of predictions in the soil and water assessment tool swat we used satellite surface soil moisture data products from the soil moisture active passive smap mission to update swat soil moisture for two u s experimental watersheds we addressed possible limitations to the vertical transfer of surface soil moisture updates to deeper layers in the model by additionally testing a modified soil percolation approach that relies on relative saturation rather than the original thresholding behavior of swat results at both watersheds demonstrated that data assimilation greatly impacted water quality and crop yield predictions modifying the soil percolation algorithm however did not improve assimilation results assimilation increased median soil moisture 2 to 6 which in turn increased total streamflow 0 43 to 1 70 m3 s daily critically streamflow alone was not a sufficient predictor for the assimilation changes to water quality predictions as flow component contributions and seasonality differed between sites a varied response in annual water quality predictions to soil moisture updates was identified 1 70 to 123 kg ha total nitrogen 0 11 to 0 57 kg ha total phosphorous 8 1 to 50 0 kg ha sediment that was dependent upon the timing of the updates site characteristics and change to specific transport and transformation processes crop yield predictions were similarly impacted by data assimilation from changes to both water and nutrient availability that varied by crop type the overall strong and diverse response of water quality and crop yield predictions to soil moisture updates provides evidence that assimilation can impact a range of model predictions efforts to improve soil moisture simulations therefore have potential for meaningful improvements in targeted non hydrologic predictions keywords soil moisture swat smap ecohydrologic modeling data assimilation remote sensing data availability data will be made available on request 1 introduction excess nutrient loadings from managed lands to coastal or fresh waters is responsible for several adverse impacts on human and environmental health including exacerbation of infectious diseases johnson et al 2010 and creating toxic conditions for aquatic life cooper 1993 to address and minimize these impacts land managers rely on decision support tools to test and develop strategies for mitigating nutrient loading these tools rely on dependable measurements of key environmental variables including soil moisture which influences nutrient transport and transformation by linking and driving hydrologic climate and biogeochemical cycles entekhabi et al 1996 rodriguez iturbe 2000 seneviratne et al 2010 soil moisture measurement is therefore the target of both extensive in situ monitoring and remote sensing missions however neither approach captures the high variance of soil moisture at sufficient spatial resolution and extent for the needs of land managers typically at the watershed scale where cumulative management effects are observed brocca et al 2017 wagner et al 2007 models provide a flexible alternative to in situ and remote sensing based measurements that are implemented at a range of scales brocca et al 2017 vereecken et al 2016 vereecken et al 2014 if models are sensitive to changes in soil moisture its accurate estimation is potentially useful for a range of targeted ecohydrologic model predictions pignotti et al 2021a because the model soil moisture estimates are uncertain cheng et al 2017 koch et al 2016 xia et al 2014 using observations to update them is one strategy to combine flexible spatial scales of models with improved observational accuracy such practical techniques are broadly defined as data assimilation soil moisture data assimilation research has shown that there is generally improvement of updated target variables or parameters even when using spatially coarse observations azimi et al 2020 loew et al 2009 pan and wood 2010 parada and liang 2008 however previous soil moisture data assimilation research has focused on models which generally do not predict water quality may poorly simulate hydrology houser et al 2010 xie and zhang 2010 or lack dynamic vegetation lahoz and de lannoy 2014 research is therefore needed to determine the impacts of soil moisture data assimilation on ecohydrologic predictions that consider water quality in addition to water quantity cho et al 2020 to understand these impacts we assimilated soil moisture observations into the soil and water assessment tool swat arnold et al 1998 swat is a watershed scale model extensively used to study land use change impacts on hydrology and water quality many processes absent in other hydrologic or land surface models including water quality predictions crop growth and land management are explicitly simulated by swat previous hydrologic data assimilation research with swat table 1 has largely assimilated synthetic observations of either surface soil water content surf swc or streamflow critically no study has investigated the effects on water quality predictions which are of high importance in addressing negative human and environmental impacts of land management a potential obstacle in effective swat surface soil moisture data assimilation is the limited transfer of updates to deeper soil layers likely as a result of insufficient model subsurface physics chen et al 2011b han et al 2012 liu et al 2018 patil and ramsankaran 2017 because model structure can determine the success of data assimilation nayak et al 2021 evaluation of an alternative soil water routing approach to mitigate this limitation was an additional goal of this research accordingly we used a modified swat percolation method proposed in a separate study that demonstrated improved soil moisture dynamics pignotti et al 2021b we therefore addressed two questions to study the impacts of data assimilation in swat 1 what are the effects of soil moisture data assimilation on a range of swat ecohydrologic predictions and 2 is it possible to improve data assimilation performance with the use of an alternative soil water routing scheme we used an ensemble kalman filter data assimilation approach evensen 2003 with swat for two well instrumented experimental watersheds soil moisture observations were obtained from the nasa soil moisture active passive smap satellite mission which provides routine 2 to 3 days gridded 36 km soil moisture estimates when available these observations were merged with daily swat model soil moisture estimates to produce an updated soil moisture prediction to test the importance of soil water routing in the model assimilation was performed separately for both the original and modified soil water percolation approaches while efforts were made to sensibly implement data assimilation computational optimality of data assimilation was not a goal of this study 2 theoretical background 2 1 swat model swat is a semi distributed continuous daily watershed scale model capable of making several ecohydrologic predictions related to hydrology water quality and crop growth swat operates by separately simulating a land and routing phase with the general goal of predicting management and land use impacts on watershed response arnold et al 2012 arnold et al 1998 modeled watersheds are subdivided into separate subwatersheds which are then further discretized into unique combinations of land use soil type and slope referred to as hydrologic response units hrus swat landscape hydrologic simulations calculate a water balance for each unique hru as 1 sw i sw i i 1 t p i q i et i d i qr i where sw is the soil water content on day i p is precipitation q is surface runoff et is evapotranspiration d is percolation out of the soil column and qr is the return flow in mm flows generated at hrus are lagged and summed for each subwatershed after which routing occurs in a stream network across the entire watershed surface runoff is estimated using the curve number approach although the green ampt method 1911 can be used if sub daily precipitation data are available infiltration into the soil column is estimated as the difference between daily precipitation and runoff several soil layers are used with varying depths based on input soil data swat creates an upper soil layer of 10 mm by default to allow surface runoff to interact with nutrient processes and provide transport soil percolation and lateral flow are triggered once a soil layer s water content is above field capacity similar to a bucket type approach soil water processes do not occur below field capacity therefore unsaturated flow is not directly simulated by the model evaporation and transpiration are extracted from soil layers starting with the upper most layer the depth of extraction is controlled by parameters that specify how much demand may be met by lower layers there is additionally both a shallow and deep aquifer which can interact with the soil profile on a limited basis full theoretical documentation is provided by neitsch et al 2011 2 2 ensemble kalman filter in hydrologic and land surface modeling variants of the kalman filter kf kalman 1960 are widely used for data assimilation sun et al 2016b the kf recursively 1 forecasts a state estimate and its error covariance and then 2 updates them using an observation the state variable xk is defined within the context of the modeled system f as 2 x k f x k 1 w k 1 where k is the time step and wk is the model uncertainty from error in model formulation or forcing data error covariance of the state estimate is represented by pk and is concurrently calculated observations or measurements zk are related to the state estimate by 3 z k hx k v k where h is an observation operator that transforms the model state variable to the measurement space as needed measurement uncertainty commonly due to instrument error is represented by vk uncertainty of the model wk and measurement vk are assumed to have a zero mean gaussian distribution with error covariances of q and r respectively and are independent white noise processes reichle et al 2002 the updated state estimate is computed to minimize mean square error of the state estimate error covariance maybeck 1979 if the model is linear and the state and observation errors are independent white noise processes the kf solutions are the best linear unbiased estimate however strongly nonlinear relationships between soil moisture and hydrologic processes violate the linear assumptions of the kf reichle 2008 while the extended kf lee and ricker 1994 provides a nonlinear solution it is computationally limited in calculating the error covariances reichle et al 2002 to overcome this limitation a monte carlo approximation of the kf for nonlinear models referred to as the ensemble kalman filter enkf was developed evensen 2003 1994 rather than explicitly propagating the uncertainty forward in time the enkf samples an ensemble of model state trajectories to estimate uncertainty the enkf is therefore a popular data assimilation methodology in hydrologic modeling because of its robust estimation of error covariance for highly nonlinear systems liu et al 2012 sun et al 2016b a standard kf functions by sequentially using forecast and update steps in the forecast step the state estimate is predicted forward in time x k 1 to x k along with its uncertainty p k 1 to p k the state estimate is then revised using an observation during the update step x k to x k where their respective uncertainties are used to weight their combination the process is then repeated for the next observation operational use of the enkf relies upon perturbing the state estimate to generate an ensemble with individual members denoted by i the enkf then assimilates an observation at time k for each forecast ensemble member x k i using the ensemble sampled state error covariance p k for weighting 4 k k p k h t h p k h t r 1 where k is referred to as the kalman gain each ensemble member is then updated using the kalman gain to calculate a linear combination of the state estimate and observation 5 x k i x k i k k z k h x k i the ensemble mean of the updates is used as the best estimate of the state at the next time step the forecast adapts equation 2 for each ensemble member with random model error wk 6 x k 1 i f x k i w k i forecast state error covariance is sampled from the distribution of the ensemble state forecast 7 p k 1 i 1 n 1 i 1 n x k 1 i x k 1 x k 1 i x k 1 t where x is the ensemble mean the estimates of equations 6 and 7 are then used in equations 4 and 5 to continue the sequential process of forecasting and updating 3 study sites two u s department of agriculture agricultural research service usda ars experimental watersheds were selected to test the effects of soil moisture data assimilation and soil water equations 1 cedar creek watershed in indiana usa and 2 little river watershed in georgia usa fig 1 both sites are well instrumented and have several in situ soil moisture sensors at multiple depths while the data are too spatially sparse and localized for direct assimilation across the watersheds they were used as independent data to evaluate the impacts of remotely sensed soil moisture data assimilation on swat soil moisture estimates the two sites capture distinct climatology hydrology and landscape characteristics allowing evaluation of data assimilation results in varied settings both watersheds are additionally core validation sites for the smap mission chan et al 2016 colliander et al 2017 3 1 cedar creek the cedar creek watershed 707 km2 consists of two hydrologic unit code huc 10 subwatersheds 0410000306 and 0410000307 as part of the larger huc 8 st joseph river watershed 04100003 it is characterized by gentle slopes of 2 to 10 with an overall gradient towards the watershed stream outlet in the southeast temperature generally varies between 1 to 28 c with an annual average of 94 cm of precipitation heathman et al 2012 williams and king 2020 soil texture types are primarily silt loams silty clay loams and clay loams which promote high water retention and slow drainage land use is predominantly agriculture with the major crops consisting of rotational corn and soybean han et al 2012 heathman et al 2012 larose et al 2007 given the low slopes and slow drainage of soils artificial tile drainage is commonly implemented throughout the watershed on agricultural lands and represents a major pathway for water and nutrient transport royer et al 2006 williams et al 2018 the upper cedar creek has been monitored by the usda ars since 2002 measuring several climatic hydrologic and water quality variables there are currently 15 active soil moisture stations at depths of 5 20 40 and 60 cm made available for this study from 2005 until 2016 several swat modeling experiments have been conducted at either the cedar creek han et al 2012 larose et al 2007 rajib and merwade 2015 or more broadly the st joseph river watershed cibin et al 2016 her et al 2016 3 2 little river as part of the western headwaters of the suwannee river basin little river 334 km2 is a huc 8 watershed 03110204 in the u s coastal plains of southern georgia the watershed climate is humid subtropical with 121 cm of annual precipitation with an average temperature range of 3 to 33 c land use includes agriculture in upland flat areas of the watershed with forests and wetlands near the dense stream network on minor slopes the watershed is largely underlain by sands or sandy loams with high infiltration and quick drainage bosch et al 2007a bosch et al 1999 notably there is a shallow impermeable layer restricting deep percolation usda ars has monitored several climatic and hydrologic variables since 1967 including 29 soil moisture stations at depths of 5 20 and 30 cm made available for this study from 2001 to 2016 bosch et al 2007a bosch and sheridan 2007 feyereisen et al 2007 sullivan et al 2007 volk et al 2007 given the diversity and long period of record several swat studies have been conducted in the little river watershed arnold et al 2010 bosch et al 2010 2004 rathjens et al 2014 sahoo et al 2013 van liew et al 2007 4 remote sensing data remotely sensed soil moisture observations from satellite platforms provide global repetitive data products soil moisture is typically estimated from the microwave region of the electromagnetic spectrum where it is based on the large difference in dielectric properties of water and dry soil sensing in the microwave region of the spectrum is advantageous as measurements are neither dependent on solar radiation nor impacted by clouds njoku and entekhabi 1996 data products are however limited by shallow sensing depth 5 cm coarse spatial resolution 25 to 36 km poor retrieval quality over dense vegetation or rough terrain and radio frequency interference wagner et al 2007 4 1 smap data as opposed to the few highly localized in situ network observations remote sensing provides integrated coverage over the entire domains of our study watersheds and is thus better suited for assimilation soil moisture data products from the smap mission entekhabi et al 2010 were assimilated into swat at the hru level for this study smap was launched on january 31 2015 and was designed to synergistically combine complementary radar active and radiometer passive observations to overcome noise in former and poor spatial resolution in the latter however due to failure of the radar instrument on july 7 2015 only radiometer measurements are available the sentinel 1 platform torres et al 2012 has been used as an active system replacement in an effort to continue to produce soil moisture data products at improved spatial resolution das et al 2017 although they are not considered in this study smap observes a given location every 2 to 3 days at the same local solar time overpass acquisitions at 6 a m descending 6 p m ascending accuracy evaluations of smap at core validation sites have shown 0 04 cm3 cm3 unbiased root mean square error with similar performance between ascending and descending passes chan et al 2016 colliander et al 2017 smap level 3 radiometer products smap passive l3 radiometer v005 at 36 km spatial resolution were used in this study data are available beginning april 1 2015 until present given the availability of ground observations of soil moisture at the test watersheds smap data were acquired from april 1 2015 to december 31 2016 for assimilation experiments smap data were geospatially preprocessed to create a time series of smap observed soil moisture values for each hru in both swat models because hrus do not have a geographic position subwatersheds are the finest scale modeling unit in swat neitsch et al 2011 thus we used subwatershed centroids to find the nearest geographic smap center pixel location and assign it to all hrus within a given subwatershed as smap observations are an integrated estimate over a pixel s spatial domain they should appropriately capture the soil moisture signal for an area of interest to account for differences among hrus we bias corrected smap estimates for each hru separately only 6 a m descending pass smap data were used as land surface and soil profile temperatures are more stable and uniform at this time providing higher confidence in soil moisture retrieval chan et al 2017 colliander et al 2017 entekhabi et al 2010 because swat simulations are daily the 6 a m observations are more representative of the previous day s soil moisture thus smap observations were lagged by one day for assimilation purposes further filtering was performed using the smap retrieval quality flag rqf and removing observations that occurred below 4 c the temperature at which ground observations are considered unreliable colliander et al 2017 jackson et al 2016 similar filtering strategies have been employed by researchers for smos data assimilation with the swat patil and ramsankaran 2017 vic lievens et al 2015 and mike she ridler et al 2014 models after filtering smap data were available for 43 and 49 of all simulation days at cedar creek and little river respectively the lower coverage at cedar creek was directly related to the number of days below the temperature threshold whereas little river had zero days filtered for this reason 4 2 bias correction systematic differences or bias between model simulations and assimilated observations can lead to suboptimal performance of data assimilation yilmaz and crow 2013 and should be corrected dee and da silva 1998 reichle and koster 2004 sources of differences include mismatch in range mischaracterization of land use and soils or general sensor and model error drusch 2005 xu et al 2014 to therefore provide an effective assimilation update observations and modeled estimates must be rescaled into the same relative range rescaling is generally performed to correct observations to the model as it is more straightforward than to modify model parameters to fit observations kumar et al 2012 although dynamic online correction within the assimilation framework is feasible de lannoy et al 2015 bias correction is often performed prior to data assimilation given its relative simplicity draper et al 2009 liu et al 2011 reichle and koster 2004 ridler et al 2014 research suggests that most bias correction approaches generally perform well however they differ in their ability to correct higher order statistical moments of the distributions teutschbein and seibert 2012 some variation of cumulative distribution function cdf matching drusch 2005 reichle and koster 2004 or linear rescaling draper et al 2009 are most commonly used for this study linear rescaling was used given the relatively short period of record flexibility of the approach and poor preliminary performance of cdf matching at the little river watershed during exploratory analysis smap soil moisture values were corrected for individual swat hrus over the nearly two years of smap observations linear rescaling was applied monthly according to 8 θ i m s m a p μ m swat θ i m smap μ m smap σ m swat σ m smap where θ is the soil moisture μ are the means σ are the standard deviations i is the given hru m is the month and is indicative of the corrected dataset monthly corrections ideally help to account for temporally inconsistent dynamic bias 5 swat model setup a swat model was created for each watershed based on the specifications provided in the supplementary materials including management operations this resulted in 57 subbassins with 821 hrus for cedar creek and 8 subbasins with 815 hrus for little river with their outlets defined to match usgs gauging stations observed data used for model input calibration and to evaluate performance are summarized in table 2 5 1 soil moisture a 5 cm soil layer was added for all soil types in the swat models to match the depth of smap observations this new layer was assigned the properties of the soil layer that it subdivided exploratory analysis showed the addition of this layer modified model simulated hydrology contrary to the findings of patil and ramsankaran 2017 while soil discretization effects in swat are not well described in the literature and warrant future research a 5 cm layer was necessary for this study given the large discrepancies between smap observation depths and soil input layers swat simulated soil water content is provided as crop available water content in mm to relate to volumetric smap observations swat source code was modified to compute and print out soil water content as the sum of crop available and wilting point water content divided by the depth of the given layer sub hourly soil moisture in situ observations were averaged by day for each sensor to compare to daily swat predictions values were screened to remove any volumetric soil moisture values below 0 0 and above 0 6 cm3 cm3 to compare swat simulations four sites were selected in each watershed table 3 sites were chosen based on the sensor locations that directly corresponded to a modeled hru with an appropriate swat land use classification fig 1 the number of swat soil moisture estimates for each hru varied due to variable number and depths of soil layers for a given input data soil classification to compare these values to fixed depth in situ sensors any sensor that fell within a specific swat soil layer depth was used for comparison to that layer if multiple sensors were within a single swat soil layer they were averaged weighted according to their relative depth from the sensor to the top or bottom of the specific soil layer 5 2 soil moisture routing modifications possible limited transfer of surface soil moisture assimilation updates to deeper layers chen et al 2011b han et al 2012 liu et al 2018 patil and ramsankaran 2017 was addressed by testing a modified soil water routing approach from a previous study pignotti et al 2021b default soil water redistribution in swat presents two primary limitations 1 percolation only occurs when soil moisture is above field capacity and 2 soil water is drained using the saturated rate regardless of relative saturation in effect approximately all excess soil water above field capacity drains from a soil layer in a single model time step day and ignores any possible unsaturated redistribution the modified approach removes the threshold and instead continuously governs soil water percolation using a relative saturation based unsaturated rate adapted from the van genuchten equation van genuchten 1980 the rate of soil water percolation then nonlinearly decreases with decreasing soil moisture previous research found the modified approach improved soil water simulation by reducing the rapid transport of soil water content out of a layer when it was above field capacity pignotti et al 2021b without a field capacity threshold percolation occurred over a greater range of soil water contents which should provide longer periods of interaction between soil layers assimilation experiments for this study were therefore performed using 1 the original swat soil water routing and 2 the modified approach and then compared to determine potential benefits of the latter 5 3 model calibration to isolate the effects of the percolation approach and data assimilation updates we first calibrated swat models without percolation modifications and then transferred the calibrated parameters to the modified percolation models while this approach may not provide optimal parameters for modified percolation models we determined it was necessary to remove possible confounding calibration effects on our results for example if we instead recalibrate the modified percolation models it is likely we would be measuring the effect of calibration on our predictions in addition to differences from model percolation and data assimilation updates accordingly swat models without percolation modifications were calibrated for streamflow at the watershed outlets eleven parameters table 4 were used based on previous swat research in the watersheds cedar creek her chaubey 2015 larose et al 2007 rajib et al 2016 wang et al 2017 little river cho et al 2020 feyereisen et al 2007 van liew et al 2007 we then transferred these calibrated parameters to the modified percolation models and added an additional parameter swcexp to control the rate of change between soil water content and hydraulic conductivity in the modified percolation equation see pignotti et al 2021b for details calibration was then independently conducted for the modified models for this additional parameter while retaining the other transferred parameters calibration was performed using a multi algorithm genetically adaptive approach amalgam vrugt and robinson 2007 with a population of 48 over 60 generations for a total of 2 880 simulations the objective function was set to optimize the daily kling gupta efficiency kge gupta et al 2009 which combines the timing correlation coefficient magnitude mean and variability standard deviation of simulated time series relative to the observations the kge ranges from negative infinity to one where values closer to one are ideal and those greater than zero are considered acceptable calibration and validation were run from 2007 to 2011 and 2012 to 2016 respectively with three years of model warm up prior to calibration 5 4 water quality and crop yield soft data analysis water quality and crop yield were not included in model calibration due to lack of sufficient data for a meaningful calibration instead water quality and crop yield observations were used as soft data yen et al 2016 to evaluate corresponding predictions across model scenarios water quality data in the watersheds were sparsely collected generally once per month at the stream outlets at cedar creek data have been collected since 2001 while little river was sampled only during 2009 and 2010 the usgs load estimator software loadest runkel et al 2004 was therefore used to convert these instantaneous water quality concentrations into estimated monthly cumulative loads for total nitrogen total phosphorous and sediment to compare to swat estimates annual crop yield data were available aggregated by county from the national agricultural statistics survey nass swat predictions however are at the hru scale and are predicted in different units than those provided by nass while nass cannot thus support field specific calibration or validation for hrus sinnathamby et al 2017 we computed an area weighted yield from these data based on the watershed overlap with each county nass yield was converted from bushels per acre to kilograms per hectare using the approach in srinivasan et al 2010 and cibin et al 2016 for comparison to swat predicted yields 5 5 enkf integration into swat 5 5 1 ensemble simulation the swat enkf data assimilation approach of han et al 2012 was adapted for this study fig 2 the key difference in our approach was the use of remotely sensed smap surface soil moisture data as opposed to synthetic data which required flexibility in handling days without observations when bias corrected smap observations were available they were assimilated otherwise the model progressed forward with ensemble soil moisture predictions until the next smap observation daily soil moisture assimilation was performed independently for each swat hru one hundred initial ensembles for each hru were generated by perturbing soil moisture using a zero mean gaussian distribution with a 0 001 mm standard deviation each ensemble member simulated all the landscape hydrologic processes that rely on soil moisture the mean of the predicted ensemble was then computed and used for watershed routing to focus on the impact of soil moisture assimilation and minimize confounding effects forcing variables precipitation and temperature were not explicitly perturbed chen et al 2011b han et al 2012 it was assumed that uncertainty from these data was accounted for in the error term wk of equation 2 5 5 2 assimilation error specifications given the complex and challenging nature of estimating model and observational uncertainty specification of error parameters are commonly user defined de lannoy et al 2019 these error covariances reflect uncertainty in the model forecast or observations via the kalman gain k in equation 4 they determine how closely simulations are aligned with observations during assimilation because model forecast error variance is dynamically estimated from the ensemble choice of ensemble noise or perturbation is key crow and van loon 2006 while multiple approaches ranging in complexity can be used crow and reichle 2008 there remains no widely accepted methodology massari et al 2015 for this study the error was randomly sampled from a zero mean gaussian distribution with a time varying standard deviation obtained by multiplying the non ensemble predicted soil moisture value by a scaling factor of 0 01 while this scaling factor type approach is advantageous in allowing the error variance to vary in time it likely overestimates the standard deviation at high soil moisture values and contributes to nonlinearities near the physical boundaries of soil water content i e saturation and wilting point han et al 2012 other approaches such as adaptive filtering reichle et al 2008 may offer better assimilation performance however the simplicity of a scaling factor was preferred given the goals of this study perfect vertical correlation was assumed between soil layers for the perturbations as suggested by chen et al 2011b and previously applied by han et al 2012 and patil and ramsankaran 2017 physical bounds on soil moisture state i e saturation and wilting point necessitate restrictions to ensemble soil moisture estimates however these constraints may bias the ensemble and skew the forecast error to account for this possible boundary truncation ensemble bias the methodology proposed by ryu et al 2009 was applied as in han et al 2012 in this method for each step update the mean bias estimated between the unperturbed soil moisture and ensemble mean is subtracted from ensemble members ensemble members with values above saturation are adjusted to saturation and negative values to 10 6 however this adjustment may then cause the ensemble mean to change to account for possibly shifting ensemble averages and therefore mean bias the method is repeated ten times to reduce remaining bias observation error covariance r in equation 4 relates to sensor retrieval and representativeness error it is often captured for remote sensing by comparing estimates to independent ground based observations or is otherwise approximated massari et al 2015 in our study observation error covariance was fixed as the common sources for remotely sensed error e g radio frequency interference soil roughness vegetation are not proportional to soil moisture state both of our study watersheds and their in situ soil moisture networks are used for smap validation chan et al 2018 colliander et al 2017 therefore reported smap accuracy provides known error from which we estimated our observation error covariances we used these unbiased root mean square errors as a proxy for error variances in each swat model data assimilation experiment from reported values unbrmse was rounded to 0 04 cm3 cm3 0 0016 cm3 cm3 error variance and 0 03 cm3 cm3 0 0009 cm3 cm3 error variance for cedar creek and little river respectively perturbations to the state variable transformed into the space of the observations v in equation 3 were sampled from a zero mean gaussian distribution with a standard deviation of 0 01 cm3 cm3 6 scenarios tested given the availability of smap data products april 2015 to present and soil moisture ground observations cedar creek 2005 to 2016 little river 2001 to 2016 assimilation was performed from april 1 2015 to december 31 2016 to test the effects of assimilation and the alternative soil water routing approach four model runs were used 1 original orig swat model soil water equations without data assimilation open loop ol 2 van genuchten based vg soil water equations without data assimilation vg ol 3 original swat model soil water equations with data assimilation orig da and 4 van genuchten based equations with data assimilation vg da model simulations included a swat warm up from january 2009 to march 2012 an ensemble warm up from april 2012 to march 2015 and smap data assimilation from april 2015 to december 2016 the three year ensemble warm up was determined from sensitivity analysis where minimal soil moisture updating occurred during the first assimilation year with shorter warm up periods the data assimilation period april 2015 to december 2016 was used to evaluate model predictions in all analyses ground based observations were considered the true reference to which all model simulations were compared using unbiased root mean square error unbrmse percent bias pbias and the pearson correlation coefficient r to directly assess the effects of data assimilation the normalized error reduction ner was used 9 ner 1 rmse a rmse o which evaluates the ratio of the root mean square error rmse after a and prior to o data assimilation ner ranges from negative infinity to one where any positive value is indicative of improvement from data assimilation all simulations were performed using swat version 664 7 results and discussion 7 1 model calibration calibration statistics table 4 indicated good performance of swat in matching daily observed streamflow cedar creek kge 0 85 orig 0 75 vg little river kge 0 73 orig 0 58 vg relatively worse performance at little river was primarily due to the model s inability to correctly capture low magnitude flow events which has been noted in previous research white et al 2009 the lower kge values for the vg models at both watersheds were expected as parameters from the orig calibration were transferred for vg calibration this approach does not provide an optimal vg model calibration because orig model calibrated parameters do not account for changes to subsurface hydrology from the modified vg soil water equations however it was necessary to remove possible differences in calibration effects on our results and instead only measure changes in model predictions from percolation methodology and data assimilation updates 7 2 bias correction smap data bias correction was performed separately for the orig and vg models yielding similar results prior to data assimilation experiments soil moisture data were compared for average in situ 5 cm measurements hru averaged orig swat upper layer soil moisture and original and bias corrected smap soil moisture fig 3 using the in situ observations as reference swat predicted soil moisture exhibited a dry bias at both sites highlighting the potential for improvement in these watersheds smap estimates initially displayed a wet bias that was removed after bias correction transforming smap observations into the range of the swat models for assimilation 7 3 soil moisture analysis 7 3 1 effects on soil moisture distributions soil moisture response to model type and data assimilation was evaluated temporally for each selected site table 3 by comparing the ensemble mean simulations to ground observations figs 4 and 5 supplementary materials figs 1 6 the number of layers for each site was determined from input soil data layer depth specifications on average data assimilation slightly increased median soil water content for most layers between 2 and 6 cedar creek 0 005 cm3 cm3 layer 1 0 015 cm3 cm3 layer 2 0 020 cm3 cm3 layer 3 little river 0 001 cm3 cm3 layer 1 0 004 cm3 cm3 layer 2 0 005 cm3 cm3 layer 3 while reducing inner quartile ranges between 10 and 52 cedar creek 0 023 cm3 cm3 layer 1 0 034 cm3 cm3 layer 2 0 031 cm3 cm3 layer 3 little river 0 003 cm3 cm3 layer 1 0 010 cm3 cm3 layer 2 0 008 cm3 cm3 layer 3 see supplementary materials tables 4 and 5 increased soil moisture was a promising response in correcting for the identified swat soil moisture dry bias fig 3 while increased medians reduced the differences between observations and estimates post assimilation decreased ranges did not particularly at cedar creek slower and wetter dry down rates after data assimilation reduced dry soil moisture occurrence and therefore the overall range this demonstrated a drawback of assimilation in this study where cedar creek reduction in average error was accompanied by a limited soil moisture range in scenarios where capturing the appropriate range of soil moisture values e g low values in this study are critical this change in soil moisture range is important to consider this effect was however less pronounced at little river where relatively coarser textured soils sands allow quicker subsurface transport of soil water and have a lower water holding capacity while the vg and orig simulations were generally similar the vg models tended towards a relatively improved soil moisture range especially in deeper layers in the orig model rapid swat soil water drainage for soil water in exceedance of field capacity limited peak soil water pignotti et al 2021b the vg approach was able to avoid this limitation by allowing soil moisture to remain above field capacity and therefore simulate a larger range of soil moisture values this effect was obvious at little river where soil moisture variance was primarily driven by model type rather than data assimilation regardless of simulation approach there was a strong mismatch in the range of observations compared to predictions for several layers at many sites disagreement in soil properties between the geo soil database i e ssurgo and the physical values at the ground observation sites is the source of this difference and is a significant challenge in comparisons with different spatial scale and support model calibration to soil moisture observations could potentially resolve this issue and improve overall model predictions however soil moisture calibration in swat is complex kundu et al 2017 and in our study difficult with limited in situ observations available there was additionally possible mischaracterization of precipitation at the test sites demonstrated by simulated soil moisture peaks that were not observed figs 4 and 5 supplementary materials figs 1 6 because only two precipitation gauges were used as inputs at both cedar creek and little river it is likely that local precipitation variability was not well captured goodrich et al 1995 error in precipitation data directly impacts soil moisture estimates and may limit improvements from data assimilation updates for model simulations han et al 2012 7 3 2 effects on soil moisture error the impacts of assimilation based changes to soil water content were quantified according to several model performance measures that compared swat estimates to independent in situ observations figs 6 and 7 supplementary materials tables 6 and 7 these measures indicated that overall error unbrmse averaged across all sites and layers was reduced moderately with data assimilation 12 9 0 007 cm3 cm3 and 5 3 0 002 cm3 cm3 at cedar creek and little river respectively greater relative error reduction at cedar creek was likely due to differences in climate and landscape characteristics between the watersheds e g tighter coupling of soil layer interactions with higher clay content both known to affect data assimilation outcomes brocca et al 2012 kumar et al 2009 however it is unlikely that differences in catchment area played a role massari et al 2015 error reduction corresponded to positive ner values of 0 13 and 0 016 at cedar creek and little river respectively this provided further evidence of general improvement in post assimilation soil moisture predictions although only slightly at little river improvements centered upon wetter post assimilation soil moisture conditions which led to a decrease in pbias at cedar creek 1 01 and little river 0 42 as the open loop model dry bias was reduced from a temporal perspective correlation improved by 7 8 0 04 cm3 cm3 and 9 4 0 05 cm3 cm3 at cedar creek and little river respectively this highlighted a possible important benefit of data assimilation updates as the timing and duration of major wet or dry events are crucial model predictions and thus their improved dynamics represents a key outcome scipal et al 2005 in particular data assimilation improvements in soil moisture dynamics can compensate for precipitation input uncertainty which is known to strongly influence predictions brocca et al 2010 han et al 2012 román cascón et al 2017 7 3 3 impacts by layer depth there was no clear indication that soil moisture assimilation updates were restricted to the uppermost soil layer moderate error reduction was found regardless of layer and site unbrmse cedar creek 0 010 cm3 cm3 layer 1 0 009 cm3 cm3 layer 2 0 003 cm3 cm3 layer 3 little river 0 002 cm3 cm3 layer 1 0 002 cm3 cm3 layer 2 0 002 cm3 cm3 layer 3 while minimal vertical transfer of assimilation surface updates has been previously noted as a major swat limitation chen et al 2011a han et al 2012 other assimilation related research has found moderate improvement in deeper soil layers lei et al 2014 sun et al 2016a it is difficult however to compare results across multiple studies because of the differences in methodological approaches for example the use of synthetic or real data soil layer definition error assumptions bias correction sample size model setup and calibration number and spatial coverage of observations and other general enkf implementation related factors are all key e g see table 1 future efforts to determine the most sensitive variables and parameters of the model and assimilation approach for soil moisture dynamics are therefore critical in adapting and unifying these disparate approaches including this study additional direct changes to and testing of vertical soil water redistribution that removes confounding factors is also likely needed 7 3 4 impacts by model soil water routing approach an alternative soil water routing scheme was implemented in this study to address the anticipated limitations of assimilation updates to deeper soil layers while assimilation with the vg model did not outperform the orig model at cedar creek ner 0 14 orig 0 12 vg its use resulted in some improvement at little river ner 0 003 orig 0 037 vg therefore although the vg equations could improve predictions alone when used in combination with data assimilation our findings provided evidence that our modified percolation did not positively interact with assimilation updates to improve soil moisture predictions more physically based schemes such as richard s equation could allow for improved interaction but may require a higher computational cost qi et al 2018 given that assimilation degraded the performance of modified soil water routing in some instances this study suggests there is potential for future improvement with further refinements and efforts to harmonize their combined use 7 4 effects on watershed scale water balance assimilation updated soil moisture modified several components of the predicted annual watershed water balance figs 8 and 9 supplementary materials table 8 the two soil water routing approaches displayed similar changes after data assimilation with average annual profile soil moisture increases of 100 mm and 97 5 mm at cedar creek and little river respectively this increase was an aggregate response to increased median soil moisture in the assimilation soil layer and its transference to deeper layers the greatest monthly soil moisture increases occurred during the growing season broadly defined as april through november when open loop soil moisture predictions were low percolation also increased annually along with soil moisture cedar creek 41 mm orig 24 mm vg little river 99 mm orig 73 mm vg where there was relatively lower percolation for the vg approach due to greater soil water retention however although retention increased overall soil water content was relatively lower for the vg models 30 mm cedar creek 55 mm little river from increased percolation events that occurred below field capacity pignotti et al 2021b soil moisture increases from data assimilation translated into increased flow for various transport components of the water balance dominant subsurface flow characteristic of each watershed exhibited the largest change at cedar creek tile flow increased annually by 61 5 mm on average while at little river groundwater flow increased by 82 5 mm evapotranspiration conversely decreased after assimilation 108 mm cedar creek 116 mm little river this decrease in annual evapotranspiration was approximately equal to the annual increase in water yield i e sum of surface runoff lateral flow tile flow and groundwater flow which was largely related to increases in the dominant subsurface flow processes because flow processes sequentially occur prior to evapotranspiration in the model it is possible the increase in soil moisture post assimilation triggers greater water flow out of the soil leaving less available for plant uptake further investigation using measured evapotranspiration data could help determine if data assimilation improves evapotranspiration estimates and where to target additional model improvements seasonal signals were apparent at both watersheds although revealed opposite trends most water balance components demonstrated increases during the growing season at cedar creek while they occurred during the non growing season at little river differences in site characteristics namely precipitation timing and magnitude dictated these responses as it is directly responsible for providing water input to the system this finding highlights the importance of the seasonal watershed characteristics when assimilating soil moisture which is critical in determining plant growth and nutrient transport and transformation for instance increased soil moisture during the growing season may allow for lower crop water stress but increase the transport of nutrients this effect may be less significant during the non growing season when fertilizers are not frequently applied but may lead to higher flows with erosive potential without structural support provided by crop roots in agricultural lands 7 5 effects on streamflow predicted streamflow at the watershed outlets increased as a result of post assimilation increases in water balance flow components figs 10 and 11 supplementary materials tables 9 and 10 the median of daily average streamflow increased by 1 7 m3 s and 0 43 m3 s and cumulatively monthly by 55 5 m3 s and 19 5 m3 s at cedar creek and little river respectively this corresponded to an average kge increase at both sites 0 24 cedar creek 0 05 little river and an average daily decrease in streamflow unbrmse for three of the four models cedar creek 0 23 m3 s orig 0 30 m3 s vg little river 1 17 m3 s orig 0 16 m3 s vg post assimilation error was not reduced for the little river orig simulation where capturing streamflow was challenging particularly for low flow values the little river vg model however demonstrated slight streamflow prediction improvement post assimilation this was surprising given calibrated parameters were transferred to the vg model from the orig model and were likely not optimal kge 0 73 orig vs 0 58 vg it is possible that by allowing for greater soil water retention the vg model provided favorable conditions for runoff and therefore streamflow this is a potential advantage in more readily improving simulations via data assimilation in little river moreover it further suggests that assimilation with the vg approach may compensate for non optimal parameters in addition to the findings of this study previous research has provided evidence for the benefits of soil moisture data assimilation to improve swat streamflow azimi et al 2020 liu et al 2018 patil and ramsankaran 2017 sun et al 2016a particularly those that used remotely sensed data products liu et al 2018 patil and ramsankaran 2017 however other research has highlighted limited success at improving streamflow estimates due to either weak coupling of the soil layers chen et al 2011b or a lack of sensitivity to soil moisture updates for model flow generating parameters han et al 2012 improvements to swat predicted streamflow are additionally site specific manifesting during low flow conditions liu et al 2018 by reducing peak flow overestimation sun et al 2016a or during a strong seasonal wet cycle patil and ramsankaran 2017 explicitly determining under which conditions assimilation updates are beneficial is thus an important future research need previous efforts have identified specific catchment characteristics that may limit impacts and demonstrated the greatest benefits are likely for models with poor baseline performance or uncertain precipitation inputs de santis et al 2021 it is evident nevertheless that changes to the soil water content are intrinsically linked to the predicted water balance and therefore remain critical to model streamflow predictions 7 6 effects on water quality predicted water quality loads were within expected regional ranges harmel et al 2008 smith and alexander 2000 white et al 2015 without direct calibration of water quality parameters figs 10 and 11 supplementary materials tables 10 and 11 modeled predictions were compared to estimated loadest values although these estimates were limited by sparse sampling and few data at little river only 2009 and 2010 water quality loads overall exhibited a varied response to soil moisture data assimilation updates and depended on how soil moisture changes affected the transport and transformation processes of specific water quality predictions because both modeling approaches orig and vg displayed similar water quality responses to soil moisture assimilation they were averaged for simplicity in examining assimilation effects on water quality predicted total nitrogen loads at cedar creek changed by the largest amount after data assimilation with median loads increasing by an order of magnitude at the monthly scale 9 9 kg ha monthly 123 kg ha annually this increase was largely a result of increased tile flow the primary mechanism for nitrate transport royer et al 2006 such a large increase illustrates the potential need for implementing a water balance constraint e g yilmaz et al 2011 in future assimilation experiments constraining tile flow increases could then directly address overestimation of total nitrogen in this experiment these increased total nitrogen loads were particularly apparent over the growing season when fertilizers were applied in the model nitrogen loads at little river were less affected with slight decreases in median predictions 0 095 kg ha monthly 1 70 kg ha annually because artificial tile drainage is not used at little river there was less total nitrogen exported from the watershed moreover little river predicted subsurface flow increased primarily during the non growing season when based on fertilizer application timing there was less expected available nitrogen for transport post assimilation total nitrogen loads instead decreased at little river due to relatively higher soil moisture that promoted leaching out of the soil profile along with longer residence times that favor denitrification porporato et al 2003 median total phosphorous loads at both watersheds tended to slightly decrease post assimilation cedar creek 0 015 kg ha monthly 0 57 kg ha annually little river 0 002 kg ha monthly 0 11 kg ha annually surface runoff is the dominant transport pathway for phosphorous royer et al 2006 however while surface runoff increased it occurred primarily over the non growing season when less fertilizer is applied and soil moisture was relatively higher elevated soil moisture creates anoxic conditions that promote phosphorous release from soil and organic particle binding jordan et al 1993 this mobilized phosphorous could be more readily taken up by crops 302 kg ha cedar creek 554 kg ha little river per year or leached 2 9 kg ha cedar creek 8 1 kg ha little river per year in swat and was therefore less available for surface runoff transport although sediment loads are similarly transported by surface runoff they did not follow total phosphorous behavior instead median sediment loads increased post assimilation cedar creek 3 1 kg ha monthly 50 kg ha annually little river 0 7 kg ha monthly 10 kg ha annually because sediment does not participate in phase or chemical transformation nor is taken up by plants its transport is affected only by soil moisture changes to surface runoff therefore as increased soil moisture generated additional surface runoff sediment transport increased in real agroecosystems most sediment and nutrient loads are transported during large single event storms borah et al 2003 david et al 1997 gentry et al 1998 where nearly all export occurs at streamflow values greater than the median royer et al 2006 this would suggest for this study that both sediment and nutrient loads should be expected to increase given post assimilation streamflow increases however while this was true for sediment loads annual total phosphorous tended to decrease as noted previously while annual total nitrogen only increased at the cedar creek watershed inferring changes to nutrient loads based on change in total streamflow alone therefore would inadequately capture the dynamics understanding changes to specific water balance components and flow pathways are needed to properly evaluate nutrient load predictions particularly those related to transport and transformation of nitrogen and phosphorous we therefore believe the impacts on water quality predictions identified in this study are an important finding which has received limited consideration to date this is especially crucial for swat applications which are generally intended to predict water quality in management scenario analyses 7 7 effects on crop yield modeled yield for the four major crops evaluated demonstrated a non uniform response to data assimilation fig 12 supplementary materials tables 12 observed yield data was used as a reference point for model predictions but was not quantitatively used to evaluate accuracy of yield predictions given limited direct comparability between swat hru predictions and county level yield counts while it is conceivable that calibration of plant growth parameters would improve these predictions we focused on the relative model prediction change from data assimilation yield predictions showed a greater change for non legumes cedar creek corn little river cotton after data assimilation than legumes i e nitrogen fixing plants cedar creek soybeans little river peanuts non legume yield decreased after data assimilation at both watersheds in three of the four models evaluated averaged over the two simulation years cedar creek corn 6 900 kg ha orig 5 300 kg ha vg little river cotton 180 kg ha orig 710 kg ha vg changes in yield were driven by changes in soil moisture that increased or decreased water and nutrient availability to crops decreased yields were linked to increased nitrogen stress cedar creek 8 days orig 5 days vg little river 13 days orig 11 days vg following increased nitrogen transport and transformation post assimilation legume yields were less influenced by data assimilation changes to soil moisture as they naturally fix nitrogen and are therefore less dependent upon availability of fertilizer based nitrogen inputs their yields accordingly showed an increase cedar creek soybean 570 kg ha orig 640 kg ha vg little river peanuts 280 kg ha orig 770 kg ha vg attributed to less water stress cedar creek 12 days orig 12 days vg little river 9 days orig 20 days vg from general post assimilation increases in soil moisture overall this identified variability in crop response underscores the complex and cumulative effect of changes induced by soil moisture assimilation 8 conclusions soil moisture data assimilation research has previously not explored water quality effects particularly when assimilating remotely sensed data products to understand these impacts smap surface soil moisture data were assimilated into the swat ecohydrologic model and a range of biophysical and biogeochemical predictions were evaluated anticipated transfer limitations of assimilation updates for deep layer soil moisture were addressed by testing an alternative soil water routing approach for swat data assimilation moderately increased median soil moisture predictions correcting for a dry bias in swat open loop simulations and reducing prediction error while poorly characterized soil properties in the model restricted potential improvements in the magnitude of soil moisture temporal improvements were promising in linking soil moisture change to hydrologic dynamics our results did not indicate that data assimilation updates were restricted to surface soil moisture contrary to expectations there is however no established consensus for swat that describes scenarios in which surface updates transfer to deeper layers during surface soil moisture assimilation the findings here in combination with previous research underscores the need to investigate the aspects of the model that are sensitive to or control this transfer to better ensure a realistic movement of assimilated surface soil moisture throughout the soil column an alternative soil water routing approach was tested to address this perceived depth transfer limitation however it did not outperform the original model simulations post assimilation this suggested that there was limited interaction between the soil water routing approach and data assimilation updates future efforts to maximize potential assimilation benefits may consider using advanced approaches including improving model forecast and observation error specification e g crow and van den berg 2010 or joint calibration and assimilation which has shown promise e g koster et al 2018 and is a logical next step use of soil moisture data products with finer spatial resolution or deeper soil profile estimates such as combined smap sentinel 1 or root zone smap data products chan et al 2018 reichle et al 2017 could provide additional improvements soil moisture changes from data assimilation updates impacted hydrologic water quality and crop yield predictions increasing soil moisture increased total streamflow especially via increased subsurface loss tile flow at cedar creek groundwater flow at little river although streamflow predictions were improved by data assimilation updates it was not necessarily a good individual indicator of broad data assimilation impacts the context timing and magnitude of changes for specific water balance components were key this was particularly apparent for water quality predictions that responded differently to soil moisture data assimilation based on changes to the available water for mobilization and subsequent transport out of the soil profile nutrient availability primarily controlled by fertilizer applications in combination with seasonal precipitation patterns further affected these changes that were distinguishable between the cedar creek and little river watersheds these combined changes to the water balance and nutrient availability led to changes in crop yield predictions that were specific to individual crop functional characteristics e g nitrogen fixing ability demonstrating the cascading impacts of soil moisture assimilation throughout the model swat arguably was not intended to precisely simulate soil moisture however because several modeled processes are sensitive to its dynamics efforts to improve predictions are critical in other relevant model predictions while further research is needed to optimize data assimilation approaches in swat the findings here support the conclusion that soil moisture assimilation greatly influences ecohydrologic predictions this provides evidence that future efforts to update simulations with soil moisture data products hold significant potential given the dependence of predictions on soil moisture more representative or rigorous estimates of soil moisture may then improve our ability to predict hydrologic and water quality processes that depend on soil moisture dynamics as land managers rely on modeling analyses e g decision support systems improving these predictions is vital in our ability to assess monitor and manage adverse environmental impacts future land management informed by increasingly reliable and robust predictions is critical for sustainable approaches that engender and maintain resilient ecosystems credit authorship contribution statement garett pignotti conceptualization methodology software investigation visualization writing original draft writing review editing melba crawford conceptualization methodology supervision writing review editing eunjin han conceptualization methodology supervision writing review editing mark williams resources data curation writing review editing indrajeet chaubey conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank steve kelley and the purdue rosen center for advanced computing for providing valuable support resources and insight in completing the computational aspects of this research we would also like to acknowledge the assistance of the usda ars national soil erosion research and southeast watershed research labs in providing observational soil moisture data and in particular stan livingston scott mcafee and david bosch this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129122 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2336,soil water deficit and saline alkaline stress impose severe constrains to agriculture and vary across different salt tolerant crops yet the effects and mechanisms of plant salt tolerance on long term soil water budget and future root zone both primary and secondary salinization and alkalization trends under changing environments in irrigated agroecosystems have not been fully understood particularly driven by seasonal irrigation practices and stochastic climate conditions here we introduce a robust species dependent soil water salinity and sodicity coupled model that enables explicitly simulation to the feedback between evapotranspiration and salinity being shaped by plant salt tolerance and saturated hydraulic conductivity as affected by salinization and alkalization in seasonally irrigated agroecosystems using this model in conjunction with field comprehensive measurements from a typical arid inland river basin in northwest china we find that the species dependent model performed well in simulating the root zone moisture s salinity cs and sodicity ex dynamics as driven by seasonal irrigation and random precipitation under different salt tolerant crops with average consistency measure cm reaching to 0 825 0 017 0 819 0 027 and 0 728 0 033 respectively stochastic simulations indicate that plant salt tolerance plays a predominant role in regulating the feedback of vegetation on soil water budget and root zone salinity and sodicity levels over time in seasonally irrigated agroecosystems in contrast to salt sensitive species salt tolerant plants seems to exhibit higher efficiency in water extraction from soil with higher evapotranspiration rates less frequent leaching events and greater capillary upflow fluxes thereby lowering soil moisture and boosting salinization and alkalization in the root zone particularly in arid climates sensitivity analysis revealed that plant salt tolerance together with climatic forcing and anthropogenic perturbations can significantly modulate the soil water balance and determine the possible trends of root zone salinization and alkalization in future thus controlling potential risks of soil degradation related to reducing soil hydraulic conductivity ks cs ex in irrigated agroecosystems notably since ks cs ex decreases with plant salt tolerance increases salt resilient species have the potential to exacerbate soil degradation our results emphasize the importance of comprehensively considering plant salt tolerance for assessing the sustainability of agricultural management practices and environmental protection measures as well as proposing adaptive strategies under global changes keywords plant salt tolerance soil water balance soil salinity soil sodicity soil hydraulic conductivity irrigated agroecosystems data availability data will be made available on request 1 introduction irrigation agriculture development is at the forefront of global food security and is essential for meeting the growing food needs of the burgeoning global population puy et al 2021 worldwide 37 of all cultivated lands are classified as sodic and 23 as saline and nearly 50 of irrigated lands globally 2 5 108 ha is supposed to be markedly influenced by salinization fig 1 a and b zaman et al 2018 sahab et al 2021 and nearly 4 million acres of croplands are abandoned per year due to heavy salt harm mau and porporato 2015 several recent studies emphasize that soil salts have been posing large risks to the sustainability of irrigated agriculture because of a combination of natural and anthropogenic perturbations schoups et al 2005 scanlon et al 2012 minhas et al 2020 further increasing water stress and precipitation variability under global climate change have the potential to aggravate the problem in the coming decades kramer and mau 2020 yin et al 2021a b accordingly with the disorderly extension of irrigated areas and the widespread use of marginal water and land as well as unsustainable management schemes the anticipated intensification of irrigated agriculture will accelerate soil salinization and alkalization shani et al 2007 assouline et al 2015 affect the root zone hydrological partitioning perri et al 2020 and undoubtedly threaten the functionality of such agroecosystems porporato et al 2015 minhas et al 2020 importantly the primary natural salinity and sodicity can take hundreds or even thousands of years to reach critical levels whereas the secondary anthropogenic induced salinization and alkalization can happen in a matter of years or decades suweis et al 2010 lu et al 2021 perri et al 2022 hence a solid investigation to the soil water balance and secondary salinization and alkalization processes is vital to developing sustainable agricultural management while also protecting the environment especially in seasonally irrigated agroecosystems the transport of water within the groundwater soil plant atmosphere continuum gspac system is an important part of the hydrological cycle that governs the energy and mass exchanges between atmosphere and subsurface in irrigated agroecosystems vervoort and van der zee 2008 han and zhou 2018 also water is the primary driver of the contaminant transport in soils and when water enters and leaves the system e g water fluxes evapotranspiration leaching and capillary upflow seasonal variations of soil salinity and sodicity in root zone can occur liu et al 2006 scanlon et al 2010 shah et al 2011 kramer and mau 2020 particularly the process of soil sodicity development is dependent nonlinearly on both soil water composition and salt concentration van der zee et al 2010 in general soil water and salt in root zone are markedly affected by both anthropogenic activities and environmental conditions shani et al 2007 hassani et al 2020 li et al 2022 precipitation regimes irrigation managements and water quality notably influence salts dynamics in the root zone by controlling leaching and evapotranspiration eta processes van der zee et al 2014 assouline et al 2015 capillary upflow predominantly contributes to soil water and salts dynamics and is greatly influenced by shallow groundwater table position and salinity shah et al 2011 van de craats et al 2020 further vegetation type plant salt uptake rate soil properties and dry deposition salt input rate are important aspects of long term root zone salt buildup thereby controlling land productivity suweis et al 2010 manzoni et al 2011 perri et al 2018 kramer and mau 2020 therefore it is critical to clarify the mechanism of soil water movement and its budget and root zone salinization and alkalization trajectories as well as their major controlling factors for sustainable water land utilization and maintenance of healthy irrigated agroecosystems importantly perri et al 2018 highlighted that vegetation salt tolerance is a key factor in limiting and controlling the long term soil moisture dynamics and salinization levels in salt affected soils in dryland ecosystems theoretically in saline sodic environments the main consequence of soil salinization is to reduce plant water absorption and evaporation through lowering the soil water potential inducing toxic effects and osmotic stress imposing significant limitations on water availability fig 1c perri et al 2020 stavi et al 2021 further sodicity negatively impacts the soil physical properties causing soil surface crusting reducing saturated hydraulic conductivity and indirectly affecting soil hydroecological functioning and salt accumulation agassi et al 1981 hassani et al 2020 nonetheless different species respond to these effects through distinct morphological and physiological strategies depending tremendously on their degree of salt tolerance munns and tester 2008 unsurprisingly halophytes salt tolerant plants can achieve water utilization efficiency significantly higher than glycophytes salt sensitive species resulting in higher transpiration rates and lower occurrence of leaching events thereby regulating hydrological partitioning and salinization levels runyan and d odorico 2010 flowers and colmer 2015 in doing so salinity and sodicity directly control soil moisture dynamics by vegetation and plant salt tolerance and trigger feedbacks that can enhance or reduce root zone salt accumulation as well as affect soil structural and hydraulic characteristics van der zee et al 2014 perri et al 2022 hitherto although multiple studies have evaluated how plant salt tolerance affects soil water balance and root zone primary salinization levels in drylands much less is known about whether plant ability to tolerate salinity in irrigated agroecosystems affects long term soil moisture dynamics and future root zone both primary and secondary salinization and alkalization trends under varying scenarios as driven by stochastic climate conditions as well as seasonal irrigation practices furthermore the interconnected avenues via which plant salt tolerance drives the feedback effects of root zone salinity and sodicity on soil saturated hydraulic conductivity in seasonally irrigated agroecosystems remain elusive from an ecohydrological viewpoint increased salinity in the soil can cause a sharp decrease in soil water potential ψs through osmotic effects and as ψs becomes increasingly negative salt begins to produce toxic effects in plant tissues as a result the soil water available to plants is reduced the bare soil evaporative fluxes are suppressed and the energy and water fluxes at the land atmosphere interface are further limited i e the latent heat fluxes are reduced and the water flow patterns are altered shani and dudley 2001 parida and das 2005 munns and tester 2008 perri et al 2020 in particular the impact of salinity on et and the soil water balance depends on plant salt tolerance and can differ notably among species parida and jha 2010 perri et al 2018 simultaneously from a hydropedological standpoint sodicity can cause soil structure deterioration owing to clay particle dispersion and soil swelling and further lead to the formation of an almost impenetrable textural b horizon fig 1d assouline and narkis 2013 van de craats et al 2020 such processes have the potential to delete big pores and change the water retention curve to favor smaller pores resulting in a significant decrease in saturated soil hydraulic conductivity and ultimately impacting the spatiotemporal distribution patterns and transport processes of root zone water and solute mcneal and coleman 1966 mcneal 1968 clapp and hornberger 1978 van de craats et al 2020 notably hydropedological processes linking soil morphology with hydrological processes influence soil water and solute transport and cycling and can distinctly differ across soils lin et al 2006 importantly elucidating the interactions of ecohydrological and hydropedological can greatly enhance our understanding of the interactions between salinity sodicity vegetation and soil water dynamics additionally a vast array of analytical and numerical models have been developed to reproduce variations of water and solute within the gspac system e g hydrus minhas et al 2020 sote model kramer and mau 2020 and species dependent stochastic soil water and salinity coupled model perri et al 2018 which have vastly enhanced the ability to sustainably develop and adaptively manage irrigated agroecosystems in this study by taking into account the feedback between salinity and evapotranspiration as mediated by plant salt tolerance and the feedback of salinity and sodicity on the soil saturated hydraulic conductivity together with field comprehensive measurements of different salt tolerant crop types from a typical inland river basin in northwest china we explore the long term effects and mechanisms of plant salt tolerance on soil moisture dynamics and root zone salinization and alkalization in seasonally irrigated agroecosystems driven by seasonal irrigation practices and stochastic climate conditions this study aims to 1 establish a robust species dependent soil water salinity and sodicity coupled model for exploring variations of water fluxes evapotranspiration leaching and capillary upflow and root zone water salinity and sodicity in seasonally irrigated agroecosystems 2 evaluate the long term effects of plant salt tolerance on water fluxes and root zone water salinity and sodicity resulting from changes in climate patterns irrigation practices groundwater regimes soil types plant salt uptake rates and dry deposition salt input rates in such agroecosystems 3 investigate the feedback of root zone salinity and sodicity on the saturated soil hydraulic conductivity under varying environments and the positive role of plant salt tolerance in regulating such an effect and the implications of anthropogenic activities and climate change for irrigated agroecosystems capitalizing on these study objectives we would propose practical management and restoration directives for accomplishing sustainable agriculture development and environmental preservation in face of ongoing and future global changes in irrigated agricultural regions around the world 2 methods 2 1 species dependent soil water salinity and sodicity coupled model as a first step we introduce three state variables relative soil moisture s dimensionless soil salinity cs mmolc l 1 and soil sodicity ex dimensionless following rodriguez iturbe et al 1999 van der zee et al 2014 and kramer and mau 2020 under their basic assumptions we further assume that the soil water profile below the root zone has a steady state and the groundwater table is constant which means that the temporal variability in the groundwater table and quality occur on a much larger time scale than climate drivers therefore the dynamics of these state variables in irrigated agroecosystems are characterized by coupled nonlinear ordinary differential equations on the basis of water and salt mass balances driven by stochastic climatic conditions and seasonal irrigation practices fig 2 and the balance equation for s 0 s 1 in salt and alkali affected soils can be expressed as 1 n z r ds dt p t i t u s e t s c s e x l s c s e x q s where s is equal to volumetric soil water content θ divided by porosity n zr is the root depth mm p i and u represent the precipitation rate minus canopy interception irrigation rate and capillary flux of groundwater respectively et l and q are the evapotranspiration rate deep percolation rate and surface runoff rate respectively at a daily time scale precipitation is modeled as a marked poisson process with a mean frequency of events λ event d 1 an exponentially distributed precipitation depth of mean α mm event 1 and an interception depth δ mm rodriguez iturbe et al 1999 anthropogenic irrigation inputs can be regarded as either a constant rate mm d 1 triggered by soil moisture regimes or a time dependent process kramer and mau 2020 capillary upflow u can be assumed to be a steady state flux due to fluctuations in groundwater tables occur on much larger timescales than fluctuations in climate drivers van der zee et al 2014 which is determined by climate and vegetation properties soil hydraulic functions root zone saturation and distance to water table vervoort and van der zee 2008 evapotranspiration is the sum of the losses caused by plant transpiration and soil evaporation which depends not only on soil water content but also on soil salinity while the level of plant salt tolerance determines the magnitude and form of the dependence of et on cs perri et al 2018 as from kramer and mau 2020 deep percolation or leakage is functionally dictated by the water saturation and the saturated hydraulic conductivity controlled by soil salinity and sodicity k s c s e x runoff is produced when the soil becomes saturated and when the water input rates are larger than k s c s e x and here can be neglected mau and porporato 2015 accordingly the combination et u and l results in a water loss function of the root zone in an irrigated agroecosystem as presented in section 2 2 given that salt mass dynamics occurs over longer time scales by considering the effect of all inflow and outflow water fluxes on both the concentration of salts in the soil water and the exchangeable sodium fraction of soil following shah et al 2011 van der zee et al 2010 and kramer and mau 2020 under their basic assumptions we consider the soil solution and exchange complex to be in equilibrium due to this study focus on long term processes therefore the temporal evolution of root zone soil salinity cs in irrigated agroecosystems can be depicted by the following balance equation 2 d q s dt n z r d s c s dt i t c i p t c p ψ d u s c u l s c s e x c s φ up where qs is the total salt content per square meter mmolc m 2 in the soil water q s c s n z r s herein molc denotes mole charge and 10 molc m 3 corresponds approximately to an electrical conductivity of the solution of 1 ds m 1 cp ci cs and cu are the salt concentrations in the precipitation irrigation water soil water in the root zone and shallow groundwater mmolc l 1 respectively ψ d is the dry deposition salt input rate mmolc m 2 d 1 such as the saline dust storms in arid regions abuduwaili et al 2010 and the salt spray in coastal regions suweis et al 2010 φ up is the plant salt uptake rate mmolc m 2 d 1 which is governed by plant transpiration and salt uptake efficiency manzoni et al 2011 following rafael et al 2013 the salt mass taken up by plants in the root zone can be modeled as φ up c s exp c s c i nit θ e t s c s e x where cinit denotes the initial root zone salt concentration in mmolc l 1 the salt uptake efficiency θ depends largely on plant traits and soil type and when θ and plant transpiration are elevated plant salt uptake is reduced note that the effects of unharvested salts in belowground biomass and soil evaporation in evapotranspiration on φ up has been integrated into θ in equation 2 the first four terms indicate salt inputs from irrigation precipitation dry and wet deposition and groundwater i e primary and secondary salinization whereas the latter two terms stand for salt losses caused by leaching events and plant uptake we further describe the partitioning between the cations in the soil solution and the adsorbed phase where the input and output of cations are controlled by the same mechanisms that govern the change in cs following kramer and mau 2020 in order to capture the main characteristics of monovalent divalent ion exchange of saline sodic soils we consider two cations sodium na and calcium ca2 henceforth the charges in the notation is omitted that together constitute the cs notably throughout this study soil sodicity represents the equivalent fraction of sodium ena in various phases which can be characterized by the exchangeable sodium percentage esp therefore the balance equation of root zone soil sodicity ex in irrigated agroecosystems over the long term can be given by 3 d q na dt i t c i e i na p t c p e p na ψ d e d na u s s c u e u na l s s c s e x c s φ up e s na where q n a q x na q s na represents the total sodium content of root zone mmolc m 2 with q x na is the sodium ions adsorbed to the soil exchange complex and q s na is the sodium ions in the soil water e p na e i na e s na and e u na are the proportion of sodium cations in precipitation irrigation soil solution and groundwater respectively according to mau and porporato 2015 using the exchange isotherm determined by the gapon equation suarez and jurinak 2011 we re express q s na q s g s c s e x na k g q s g s q s n z r s e x na k g herein the gapon selectivity coefficient kg ranges from 0 00866 to 0 01740 mmolc l 1 1 2 mau and porporato 2015 and k g esr sar with esr exchangeable sodium ratio is defined as esr esp 100 e s p and sar sodium adsorption ratio is given by sar n a c a mg 2 in which the square brackets indicate the concentration of cation in the soil water mmolc l 1 further we re express q x na q x e x na c e c m e x na herein cec denotes the cation exchange capacity mmolc kg 1 m is the dry soil mass in the root zone kg m 2 subsequently substituting re express q s na and q x na into equation 3 then coupling equations 3 and 2 thus a differential equation for ex is obtained the complete equation of ex and its detailed derivation can be found in kramer and mau 2020 note that formally we refer to the e x na as ex i e esp throughout this paper the coupled equations 1 3 are solved numerically with the classical runge kutta 4th order method in the python environment the specific numerical simulation scheme is described in section 2 3 to characterize long term root zone s cs and ex in irrigated agroecosystems forced by anthropogenic irrigation practices and natural stochastic rainfall as from perri et al 2018 and kramer and mau 2020 salinity and sodicity can govern water losses from the soil by varying the hydraulic conductivity and infiltration rate at the same time salinity and sodicity directly control hydrological partitioning by plant salt tolerance and can trigger feedbacks that increase or decrease root zone salinization level in addition salinization can significantly limit water availability and exacerbate aridity i e acts as a form of drought stress in salt affected ecosystems perri et al 2020 in the following we model the feedback effects of plant salt tolerance and saturated hydraulic conductivity k s c s e x on the coupled long term dynamics of root zone s cs and ex in irrigated agroecosystems fig 2b assuming no hysteresis occurs in these processes and potential consequences nonetheless the hysteresis effect can be interpreted using the modeling technique proposed by kramer et al 2022 2 2 water losses for given salinity sodicity and plant salt tolerance in irrigated agroecosystems for given salt tolerance and salinization level as from vervoort and van der zee 2008 the combination of et l and u dominate the long term soil drying process in the root zone i e e t s l s u s as forced by irrigation practices and climate conditions in particular the influence of salinization on evapotranspiration lies at the heart of the long term coupled dynamics of root zone s cs and ex considered in this paper as from parida and jha 2010 the extent of reduction in transpiration due to ionic and osmotic stress is mostly influenced by plant salt tolerance in terms of salt tolerance halophytes have high salt tolerance due to high salt storage potential in tissue whereas glycophytes can only tolerate low salt concentrations in tissues before cell processes are unfavorably affected flowers and colmer 2008 as a result the water use efficiency of halophytes is much higher than that of glycophytes resulting in higher transpiration rates and lower incidence of leaching events runyan and d odorico 2010 to better understand salinity controls on et and elucidate the species specific responses of plants to salt stress following priestly and taylor 1972 and perri et al 2018 under their basic assumptions based on the proportional relationship between plant transpiration and crop yield that is y r et e t m a x e t r where yr etmax and etr are relative yield maximum et and relative et respectively shani and dudley 2001 ben gal et al 2003 and incorporating the compound cumulative effect parameters that determine salt tolerance munns and tester 2008 parida and jha 2010 as well as taking the capillary rise into account vervoort and van der zee 2008 we propose a straightforward modeling of the influences of salt tolerance on et in salt affected irrigated agroecosystems which can be written as 4a e t s c s e x e t m a x c s c t e t m a x 1 β c s c t c t c s 4b e t m a x 1 26 2576 9 exp 12 27 t a 237 3 t a 240 97 t a 2 2576 9 exp 12 27 t a 237 3 t a 240 97 t a 2 g l r n g where etmax is the maximum evapotranspiration rate mm d 1 ct is the crop specific salt stress threshold g l 1 β is the slope parameter in threshold reduction function l g 1 ta is the air temperature in g is the psychometric constant l is the latent heat of water g is the ground heat flux rn is the net radiation the molecular term of equation 4b represents the derivative of the saturation vapor pressure with respect to ta and calculated using the clausius clapeyron equation intuitively equation 4 simply recapitulates the relationship between et and c using parameters ct and β and two key parameters can directly estimated from yr c experimental data and widely adopted from minhas et al 2020 according to maas and hoffman 1977 we here classify plant salt tolerance into three main categories i high sensitivity i e c t 2 g l 1 and β 0 1 l g 1 ii moderate salt tolerance i e 2 c t 5 g l 1 and 0 075 β 0 1 l g 1 and iii high salt tolerance i e c t 5 g l 1 and β 0 075 l g 1 note that the root zone s and ex regulate et by interacting with cs and can notably vary across species before modeling root zone water losses from leakage we first introduce the feedback of k s c s e x on root zone cs and ex in general if monovalent cations dominate a higher proportion of the cation exchange complex the negative charge of soil colloids is difficult to be screened off which may result in dispersion and swelling of organic colloids and clays that is the soil pore size distribution will shift to a smaller radius this implies lower percolation and higher salinization van der zee et al 2014 therefore by incorporating the decomposition model developed by ezlit et al 2013 this feedback can be modeled as 5a k s c s e x k s 0 r c s e x k s 0 1 h x p 3 e p 4 e x x e x p 1 p 2 1 p 3 e p 4 e x x e x p 1 p 2 5b x p 7 3 6 10 4 esp p 5 p 6 ln c s 0 a c s 300 m m o l c l 1 p 7 3 6 10 4 esp p 5 p 6 ln c s 356 4 c s 0 5 1 2 a c s 300 m m o l c l 1 where ks 0 represents the initial saturated hydraulic conductivity mm d 1 r c s e x is a sigmoidal transition function under the control of cs and ex h x is the heaviside step function x is the adjusted effective swelling factor p 1 p 2 p 3 p 4 p 5 p 6 and p 7 are the soil specific parameters in general k s c s e x drops with rising ex for relatively high cs the decline is negligible because the negative charge of soil colloids are effectively shielded by the high ionic strength and counteracts swelling whereas at low cs the k s c s e x decreases remarkably with increasing ex similar to earlier models mcneal 1968 the ezlit et al 2013 model also does not account for the impact of partial reversibility on the variation of saturated hydraulic conductivity with this premises leakage or leaching losses are at maximum when s 1 for s 1 these losses decrease in accordance with an experimentally determined power law and to a value of zero when s is below a field water capacity sfc clapp and hornberger 1978 following kramer and mau 2020 leakage losses in salt affected soils can be given by 6 l s c s e x k s c s e x s c s fc s 1 where parameter c depends on the soil type sfc is the soil saturation point at which gravitational drainage becomes negligible with respect to et laio et al 2001 moreover shallow groundwater can be an important source of root zone both water and salts in irrigated agroecosystems and can have both beneficial and detrimental effects on crop output runyan and d odorico 2010 alizadeh and mousavi 2013 accordingly by linearizing the capillary flux soil moisture relation proposed by vervoort and van der zee 2008 and assuming a time averaged water table depth as well as considering the feedback between k s c s e x and root zone cs and ex a simplified analytical relation between u and s can be expressed as 7a u s c s e x k s c s e x g s c s s k s c s e x g s e s s e s s s s e 0 s e s 1 7b g 5 b 6 2 b 6 h b z z r 2 3 b where k s c s e x g represents the maximum u at the average shallow groundwater depth z the dimensionless parameter g is a function that describes the relationship between u and z hb is the bubbling pressure and parameter b is related to soil water characteristics eagleson 1978 s is the soil saturation point at which transpiration becomes restricted s c k s c s e x g s e t m a x is a specific soil saturation point below which the soil never dries out since the potential u becomes equal to the actual et the effective field capacity s e z z r h b 1 b θ r n with θr denotes residual water content at wilting point and se represents the soil saturation point at which the soil switches from a drainage to a capillary uptake state vervoort and van der zee 2008 alizadeh and mousavi 2013 this means both sc and se two key parameters both of which are contingent on the soil hydraulic properties and the groundwater table it is assumed that u is continuously supplied with water so sc 0 and u is difficult to maintain the maximum evapotranspiration so sc s in addition when the shallow water table z zr the root zone will be in waterlogged conditions which can cause anaerobic conditions and continued exposure to extended periods of anaerobic conditions will adversely affect many plant types and result in their death here we focus on the scenario of z zr similar to that presented by alizadeh and mousavi 2013 together combining equations 4 7 upon normalization with respect to the active soil depth the root zone water loss function for given salinization and plant salt tolerance in irrigated agroecosystems is summarized as ρ s e t s c s e x l s c s e x u s c s e x n z r and as shown in fig s2 in doing so to simulate long term s cs and ex dynamics in the root zone under future scenarios it is hypothesized that irrigation management is consistent across time under quasi steady state conditions at least during the growth season namely no changes in water supply schedule water delivery system irrigation water quality or cropping system shani et al 2007 kramer and mau 2020 despite this the average irrigation requirements for a given soil crop and type of climate can be modeled by a stochastic irrigation process according to vico and porporato 2010 here we only note that the error introduced by this assumption tend to be negligible compared to the uncertainties in the external hydroclimatic forcing 2 3 model parameterization verification and numerical calculations to better understand the impacts of plant salt tolerance on long term root zone water salinity and sodicity dynamics in irrigated agroecosystems under different soil types irrigation practices groundwater regimes and climate forcings the climate is characterized by αλ etmax with the α and λ were obtained from long term daily rainfall data and the etmax was estimated by using equation 4b dralle and thompson 2016 vegetation parameter values used in the simulations following maas and hoffman 1977 and porporato et al 2004 the plant salt tolerance parameters were highly tolerant species β 0 071 l g 1 and c t 6 4 g l 1 moderately tolerant β 0 084 l g 1 and c t 2 84 g l 1 and low tolerance β 0 12 l g 1 and c t 1 92 g l 1 perri et al 2018 the interception capacity of cultivated vegetation δ was set to 0 1 cm d 1 rodriguez iturbe et al 1999 the parameters associated with water losses i e et l and u were estimated according to typical values listed in laio et al 2001 vervoort and van der zee 2008 perri et al 2018 and kramer and mau 2020 further we modeled the k s c s e x based on the relative clay content of the soil and used parameter values given by ezlit et al 2013 and kramer and mau 2020 the ψ d and θ were derived from abuduwaili et al 2010 suweis et al 2010 and rafael et al 2013 specifically the detailed values of climatic vegetation soil and groundwater physicochemical parameters used in model calculations are listed in table 1 we use field comprehensive observations of different salt tolerant crop types under varying groundwater regimes and diverse soil types based on the sangong river watershed srw of northwestern china for model verification this watershed features a typical continental arid climate having low p and high et receiving approximately 200 mm precipitation year and 1533 2240 mm pan evaporation year regionally the watershed has a long history of irrigated agricultural practices and over 95 of the land is farmed and 85 of that irrigation is water saving the majority of it being mulched drip irrigation yin et al 2021b over 90 of all water usage is for agricultural purposes which mostly depends on groundwater pumping the watershed is planted with a wide range of salt tolerant crop varieties with the dominant crop is cotton and other crops include grapes corn wheat melons etc the field measured data of root zone s cs and ex under different crop types as well as the specific model parameters associated with soil hydraulic physical and chemical exchange properties can be obtained in yin et al 2021a and additional climatic crop groundwater and irrigation parameters are given in table s1 the coefficient of determination r2 nash sutcliffe model efficiency nse mean absolute error mae mean absolute percentage error mape root mean square error rmse and consistency measure cm were selected as indicators zhu 1999 xu et al 2013 to assess the goodness of fit between the simulated and observed root zone s cs and ex of different salt tolerance crop types in seasonally irrigated agroecosystems for the numerical simulations we hypothesized the irrigation is continuous during the crop growth period and performed at rate proportional to 125 100 75 and 50 30 of the maximal daily evapotranspiration etmax for non stressed intermediate and stressed levels respectively ben gal et al 2009 which is itself designed to vary seasonally in accordance with a sinusoidal curve and the minimum and maximum values in the curve were made to coincide with the time nodes of the lowest and highest temperatures in a specific climate zone kramer and mau 2020 under the control of plant salt tolerance to characterize the role of climate change soil properties irrigation practices and groundwater dynamics on soil moisture dynamics and root zone salinity sodicity and saturated soil hydraulic conductivity in irrigated agroecosystems we conducted simulations with three precipitation patterns dry climate α 11 mm event 1 λ 0 3 event d 1 semiarid climate α 12 5 mm event 1 λ 0 4 event d 1 and wet climate α 14 mm event 1 λ 0 5 event d 1 three soil types class i 5 7 clay class ii 16 2 clay and class iii 48 5 clay three irrigation water qualities fresh water c i 12 mmolc l 1 e i 0 36 brackish water c i 35 mmolc l 1 e i 0 69 and saline water c i 55 mmolc l 1 e i 1 13 and three types of gtd type i z 2 m type ⅱ z 4 m and type iii z 6 m the groundwater quality can be derived from the gtd the specific formula is shown in yin et al 2021a at the same time the sensitivity of different non irrigated season nis lengths 80 days 130 days and 180 days nsi plant salt uptake rates θ 0 05 0 5 and 5 irrigation quotas i 40 etmax i 75 etmax and i 110 etmax and dry deposition salt input rates ψ d 1 6 and 12 mmolc m 2 d 1 were also compared and analyzed in order to reduce the uncertainties of the simulation results over the long term we ran the simulation operations 100 times to get the average output values the first simulated year was disregarded in order to generate a 1 year warm up phase and the simulated time was over 20 years the python 3 8 5 https www python org and matlab r2014a the mathworks inc natick ma usa were applied for conducting simulations 3 results and discussion 3 1 model effectiveness and long term dynamic stochastic simulations fig 3 presents the measured s cs and ex compared to species dependent coupled model simulations in various salt tolerant crops i e cotton maize wheat sunflower stevia melon and tomato in the srw in performing our validation under different salt tolerant crops the simulated root zones s cs and ex demonstrated good concordance with the observed values the statistics used to evaluate model performance i e average mae rmse nse mape and r2 were all within the acceptable range indicating that the model performed well with a good level of modeling efficiency fig 3a c further the estimated probability density functions pdfs for s cs and ex captured the key distribution properties e g height and location of peak span width of s cs and ex in different soil sampling sites i e o1 o24 over the study period figs s3 s5 with average cm were 0 825 0 017 0 819 0 027 and 0 728 0 033 respectively fig 3d by contrast the cm of s was higher than that of cs and both were notably higher than that of ex the major reason for this discrepancy are the error resulted from the small sample size of numerical pdfs the spatial variability of both cs and ex is much greater than that of s and the inadequate prediction of rainfall and irrigation by the model nonetheless this discrepancy is acceptable in this study and it doesn t bother much as far as the predictions are concerned overall the simulation results suggest that the performance of the species dependent coupled model is widely good for modeling s cs and ex in seasonally irrigated agroecosystems in our simulations the species dependent coupled model is applicable for stochastic climatic simulation with seasonal irrigation in irrigated agroecosystems in order to demonstrate how the long term dynamic stochastic simulations based on the coupled model are generated in the next sections we first examine an example stochastic ensemble as driven by random rainfall and seasonal irrigation over a 2 year simulation period using parameters table 1 under highly salinity tolerant vegetation fig s6 in fig s6 the left column presents evolution of actual evapotranspiration eta l u and root zone s cs ex and relative saturated hydraulic conductivity rks i e the ratio of the k s c s e x to the saturated hydraulic conductivity for a single 2 year run the right column displays 100 runs thin light blue lines for water saline and sodic fluxes as well as rks and the ensemble averages thick red lines intuitively the stochastic rainfall events results in the variability of each variable light blue shading while irrigation events control the magnitude of changes in each variable over the simulation period compared to the non irrigated season the irrigated season had clearly higher eta larger l smaller u and larger s the input of salts from irrigation water and capillary upflow caused a rise in cs and ex but the seasonal variation of the ex was much slower and smaller in magnitude a decline in rks due to the continued rise in ex can be observed in these example runs as fig 4 a1 g1 reveals under dry climate regimes α 11 mm event 1 λ 0 3 event d 1 the general dynamics of each variable is characterized by two features i e the overall sawtooth wave pattern and the final periodic steady state under different plant salt tolerance conditions as time goes on the eta l u and rks all first displayed a downward trend and ultimately attained a cyclically stable state whereas the s cs and ex all first showed an upward trend and finally reached a periodically steady state i e periodically time varying with the same extremums further the three salt tolerant plants had distinctly different interannual dynamics and times for each variable to reach its periodic steady state specifically elevated levels of plant salt tolerance cause higher eta u cs and ex but lower l s and rks and the modes of p eta p u p cs and p ex move to larger values of eta u cs and ex respectively while the patterns of p l p s and p rks shift to smaller values of l s and rks respectively fig 4a2 g2 overall the value of s increases with salinization and alkalization levels i e an increase in cs and ex and decreases with the degree of plant salt tolerance this is due to the fact that salt tolerant plants utilize water in the soil more efficiently i e higher eta against low soil water potentials and saline and sodic phytotoxic effects than the salt sensitive ones perri et al 2018 in this way highly salt tolerant species reduce the leaching frequency and boost the capillary upflow flux in comparison to more salt sensitive species leading to higher salinization and alkalization risks thus accelerating soil structure degradation i e lower rks van der zee et al 2014 our modelling further show that plant salt tolerance plays an important role in regulating vegetation s feedback on the soil moisture dynamics as well as root zone salinity and sodicity levels in seasonally irrigated agroecosystems 3 2 effects of plant salt tolerance on soil moisture dynamics under varying scenarios in this section we evaluated the influences of plant salt tolerance i e highly tolerant moderately tolerant and low tolerant on variations of eta l and u in different climate patterns non irrigated season nis lengths soil types plant salt uptake rates irrigation water qualities irrigation quotas water table depths and dry deposition salt input rates based on the species dependent coupled model using parameters table 1 by runing 10 year simulation with 100 stochastic repetitions in seasonally irrigated agroecosystems the extent to which transpiration is suppressed as a result of osmotic and ionic stress is largely determined by plant salt tolerance and varies notably among species ben gal et al 2009 perri et al 2018 for variations of eta the results presented in figs 5 and s7 illustrate that the difference in plant salt tolerance caused significant variations in long term dynamics and average values of eta under different analysis scenarios except under wet climate and fresh irrigation water and all shown that the average eta was the largest under salt tolerant plants and the smallest under salt sensitive plants as the climate becomes strongly drier i e from wet clamate to dry clamate the effect of plant salt tolerance on eta becomes more pronounced and elevated levels of plant salt tolerance leads to higher eta fig 5 a it is intriguing that under soil class i 5 7 clay variations of eta showed a significant downward trend over time for each plant salt tolerance scenario fig s7c and the mean eta under both soil class ii and class iii was notably higher than that of class i fig 5c similar time varying patterns of eta were also exhibited under both deficit irrigation i 0 4 etmax and shallow water table depth gtd 2 m fig s7f and g with the deterioration of irrigation water quality eta showed a clear downward trend and the interannual fluctuation amplitude decreased markedly fig 5e and s7e these results indicate that salt tolerant crops can achieve substantially higher water use efficiency than salt sensitive crops thereby resulting in higher eta and lower percolation leaching is an important balance term between preventing root zone salt accumulation and removing nutrients from soil in agricultural ecosystems and depends primarily on the root zone hydraulic conductivity kramer and mau 2020 for variations of l the results shown in figs 5 and s7 reveal that various plant salt tolerance levels correspond to unique l under certain analytical scenarios except under wet climate and fresh irrigation water and the average l was the largest under salt sensitive plants and the smallest under salt tolerant plants as well as variations of l exhibited a downward trend over time under each analysis scenario not surprisingly the l in wet climate was significantly higher than that in dry climate it is intriguing that elevated levels of plant salt tolerance result in lower l fig 5a as the length of the non irrigated season increased irrigation events decreased the occurrence of leaching decreased clearly fig s7b particularly short term and high intensity showers may dominate leaching rather than the average levels under dry climates more interestingly the leaching of soil class ii 16 2 clay was evidently higher than that of both soil class i and class iii under the three plant salt tolerance scenarios fig 5c and s7c indicating that lower clay content does not necessarily mean higher leaching with the increase of the plant salt uptake rate the l showed an increasing trend fig 5d and s7d this may be due to the fact that the uptake of salt by plants can reduce transpiration while mitigating the risk of soil degradation further under each plant salt tolerance scenario the l in fresh irrigation water was significantly lower than that in poor irrigation water and the decline of water table depth can lead to the increase of l but is nonmonotonic fig s7e and g additionally the increase of irrigation quota can evidently increase the leaching rate fig 5f and s7f these results reveal that salt tolerant crops consume more root zone water than salt sensitive ones thereby hampering leaching events and accelerating soil degradation in irrigated agroecosystems upward groundwater flow induced by capillary pressure may affect water balance and cause soil degradation in the root zone shah et al 2011 for variations of u the results shown in figs 5 and s7 suggest that the u exhibited a downward trend over time under each analysis scenario except under soil class i and class iii and the average u was the largest under salt tolerant plants and the smallest under salt sensitive plants under specific plant salt tolerance scenarios as the climate changes from dry to wet the shift of the pdf of u to the left and becomes progressively smaller fig 5a moreover the u of soil class ii was significantly higher than that of soil class i and class iii fig 5c and s7c also both the length of irrigation season and the irrigation quota had clear effects on the u fig 5b and f besides the irrigation water quality and groundwater table are further important aspect to the long term dynamic of u fig s7e and g the ψd has no clear influence on the u fig 5h and s7h relatively speaking as climate becomes drier the water used for et in the root zone is replenished by the u which increases when groundwater becomes shallower especially under salt tolerant crops if the groundwater is saline or brackish capillary upflow can transport salts to the root zone these salts may inhibit transpiration as a result of water stress produced by osmotic effects at the same time salinity and sodicity induced soil structural degradation i e the reduction of k s c s e x results in uncoupling of root zone and shallow groundwater thereby reducing salt leaching and limiting capillary upward flow van der zee et al 2014 hence plant salt tolerance can exert significant influence on u and is rely strongly on the soil hydraulic conductivity of the soil layer between root zone and groundwater table altogether these findings emphasize that the long term influences of plant salt tolerance on water fluxes eta l and u should be carefully considered in mitigating agricultural drought and soil degradation risks in face of ongoing and future global changes particularly in arid climates 3 3 effects of plant salt tolerance on root zone cs and ex under varying scenarios before investigating the effects of plant salt tolerance i e highly tolerant moderately tolerant and low tolerant on root zone cs and ex based on the species dependent coupled model using parameters table 1 in seasonally irrigated agroecosystems we first analyzed the impacts of plant salt tolerance on variations of root zone s under different scenarios by combining the analysis results of water fluxes in section 3 2 as shown in figs 6 and s8 the average s under salt tolerant species was lower than that under salt sensitive species that is elevated salt tolerance corresponds to lower relative soil moisture moreover variations of root zone s displayed an upward trend over time in each analysis scenario this is in consistent with the findings of yin et al 2021a notably the drier the climate or the lower the soil water content the more significant the regulation effect of plant salt tolerance on root zone s this may be due to the fact that the et c feedback was further enhanced by sparse precipitation and low soil water content perri et al 2018 also the non irrigated season length soil type irrigation quota and water table depth all had clear influences on variations of s under the control of plant salt tolerance not surprisingly an increase in irrigation events and irrigation quotas as well as a shallower gtd will increase the input flux of soil water which in turn will lead to an increase in root zone s similar to results from kramer and mau 2020 the s in soil class iii was significantly higher than soil class ii and both were clearly greater than in soil class i fig 6 c and s8c these results underscore the central role of plant salt tolerance in modulating the long term soil water balance in irrigated agroecosystems salinity is supposed to exert a direct impact on hydrological partitioning through vegetation slat tolerance and further regulates root zone salt accumulation in drylands perri et al 2022 for variations of cs the results shown in figs 6 and s8 indicate that the varying levels of plant salt tolerance correspond to different cs under given analysis scenarios except under fresh irrigation water and the mean cs was the largest under salt tolerant plants and the smallest under salt sensitive plants as well as variations of cs almost all showed an increasing trend over time under each analysis scenario with the transition from wet to dry climate the shift of the pdf of cs to the right becomes gradually larger and the control effect of plant salt tolerance gradually increased fig 6a this implies the aridity promotes soil salinization by reducing soil moisture and inhibiting leaching events for given salinization and salt tolerance level as can be seen in fig 6b e and f irrigation can be considered to play two distinct roles in regulating root zone cs irrigation can bring dissolved salt into soils while it also enhances leaching and salt flushing processes potentially offsetting the additional salt input brought by irrigation in contrast in wetter climates naturally occurring rainfall induced leaching events already dominate the system so the increase in irrigation has little effect on the overall salt mass balance nonetheless the use of water saving irrigation techniques particularly with saline or brackish water may exacerbate root zone salt accumulation and contribute to soil degradation risks in the near future furthermore variations in shallow groundwater table and quality have non monotonic impacts on cs dynamics particularly in salt tolerant crops fig 6g and s8g the brief waterlogging can exacerbate soil salt accumulation during irrigation as shallow gtd becomes shallower the crucial gtd interval that inhibits capillary fluxes is 2 3 m yin et al 2022 additionally soil clay content θ and ψ d also had significant influences on variations of root zone cs under the control of plant salt tolerance fig 6c d and h since leaching is the principal route through which salts leave the soil the enormously decreased leaching rate in class iii soil results in salt buildup over time these results are consistent with the findings of suweis et al 2010 and shah et al 2011 importantly in seasonally irrigated agroecosystems root zone salinization patterns are also relies on whether the irrigation rainfall events and evaporative demand are in phase these results indicate that plant salt tolerance is a key factor in controlling soil salinization in seasonally irrigated agroecosystems soil sodicity accumulation is affected by salt contents and soil water composition and it can result in poorly irreversible soil structure deterioration and drastically decreased hydraulic conductivity for variations of ex the results shown in figs 6 and s8 suggest that over time the root zone ex displayed an upward trend under each analysis scenario and the control effect of plant salt tolerance gradually increased except under wet climate and fresh irrigation water as well as the average ex was the largest under salt tolerant plants and the smallest under salt sensitive plants as the climate becomes intensely drier the effect of plant salt tolerance on ex becomes more pronounced and the p ex shifted toward higher values of ex fig 6a for given climate soil and salt tolerance level with the increase of non irrigated season length the deterioration of irrigation water quality and the increase of ψ d the long term root zone ex all showed a clear increase trend fig 6b e and h whereas with the increase of θ the enhance of irrigation quota and the decline of groundwater table the long term root zone ex all revealed a significant decrease fig 6d f and g notably the ex of soil class ii was clearly higher than that of soil class i and class iii under the control of plant salt tolerance fig 6c and s8c it is important to note that compared with nonseasonal poisson distributed precipitation plant salt tolerance under seasonal stochastic precipitation had more significant control on soil moisture dynamics and root zone salinity and sodicity such as in mediterranean climate zones by contrast the fluctuations and long term tendencies of ex is less significant compared to that of cs this is largely a result of the differences in cation exchange buffering van der zee et al 2014 besides another possible reason is that as the value of cs increases the sensitivity of their relationship decreases van der zee et al 2010 importantly even if cs does not increase with time while ex may still varies with time as a consequence the esp in the root zone increases due to evapotranspiration condensing salts and capillary upflow supplying salts this leads to the formation of a sodic layer with drastically reduced hydraulic conductivity due to dry wet cycles under the interplay of seasonal irrigation precipitation and capillary upflow van de craats et al 2020 the above phenomenon is more pronounced in highly salt tolerant species these results demonstrate that responses of soil sodicity dynamics to irrigation and precipitation variability is also controlled by vegetation salt resilience in combination these findings emphasize that the long term implications of salt tolerance on s cs and ex must be carefully considered in creating sustainable agriculture and environmental preservation 3 4 feedback of decreasing ks cs ex as mediated by plant salt tolerance soil salinity and sodicity are acute environmental hazards that can result in soil structural degradation and limit land productivity thereby jeopardizing food security kramer and mau 2020 by integrating the species dependent soil water salinity and sodicity coupled model and the soil specificmodel ezlit et al 2013 and using table 1 parameter values we investigated the dependence of k s c s e x on cs and ex for different levels of plant salt tolerance under varying climate patterns soil types groundwater table depths irrigation quotas irrigation water qualities non irrigated season lengths plant salt uptake rates and dry deposition salt input rates as illustrated in fig 7 a h and s9 variations of rks exhibited a downward trend over time under each analysis scenario except in soil class i and class iii and the elevated levels of plant salt tolerance result in lower root zone rks as well as low tolerant plants tend to be more prone than medium and high tolerant species to exceed species specific soil degradation threshold particularly in arid climates it is intriguing that for given climate and salt tolerance level although soil class iii has the highest clay content while no degradation in k s c s e x is found in it meanwhile although soil class i and class ii have similar salinity change patterns only soil class ii experiences degradation fig 7b and s9b suggesting that higher clay contents do not always lead to enhanced soil degradation risk in irrigated agroecosystems interestingly both fresh and saline irrigation water lead to more severe soil degradation than brackish water under the control of plant salt tolerance fig 7d and s9d this discrepancy arises from the fact that changes to cs happen on significantly shorter time periods than changes to ex and the application of fresh irrigation water results in lower cs but saline irrigation water causes higher ex thereby enhancing the risk of soil degradation mau and porporato 2015 unsurprisingly shallower gtds can lead to more pronounced soil structural degradation with a severely decreased hydraulic conductivity whereas rks dynamics can not be expressed as monotonically functions of the gtd fig 7c and s9c as was also emphasized by yin et al 2021a moreover under specific plant salt tolerance both longer irrigation seasons and larger irrigation quotas can increase salt leaching from the root zone rendering soils more susceptible to reduced hydraulic conductivity fig 7e and f in addition the θ is a further important aspect to control the soil structural degradation fig 7g and s9g plants are supposed to decompose extract or promote phytoremediation however it has longer durations than traditional techniques manzoni et al 2011 porporato et al 2015 under varying plant salt tolerance levels similar correlations were presented for soil moisture dynamics components eta l u and s root zone salinity and sodicity cs and ex and rks in dry climates fig 7i there was a significant correlation between rks and ex eta both p 0 01 and a clear correlation with s l both p 0 05 as well as elevated vegetation salt tolerance give rise to higher correlation of rks with s cs eta and lower correlation with ex l u at the same time there were also notable correlations among eta l u s cs and ex almost all p 0 05 except between l and s u both p 0 05 combined with the results of section 2 the rks decreased with the increase of soil sodicity particularly when monovalent cations make up a higher portion of the soil s exchange complex the organic colloid and clay dispersion swelling eliminate large pores and then rks be significantly reduced van der zee et al 2010 ultimately plant water uptake soil aeration and leaching are diminished thus affecting the spatiotemporal patterns of root zone solutes van de craats et al 2020 these results underscore the central role of cs and ex in controlling soil degradation it is important to note that the irreversible degradation is not taken into account in our results but as pointed out by van der zee et al 2014 considering irreversible degradation has the potential to make seasonal degradation cycles more dangerous additionally highly salt tolerant plants often withstand more saline circumstances whereas salt sensitive vegetation typically maintains lower level of salinization salt tolerant species also utilise soil water more efficiently with a reduction in the frequency of leaching than salt sensitive ones meanwhile halophytes have the capacity to absorb and store salt while helping to minimize the quantity of salt that is stored under a variety of climatic conditions further changes in vegetation cover may impact the local hydrologic conditions and promote salt buildup in different parts of soil profile when plants are both sensitive to root zone salt levels and capable of altering the soil salt balance runyan and d odorico 2010 in doing so plant salt tolerance plays a major feedback role on soil salinization and alkalization by regulating evapotranspiration and lowering leaching thereby controlling and limiting the long term soil degradation associated with reducing ks cs ex caused by cs and ex in irrigated agroecosystems 3 5 sustainable management implications for irrigated agroecosystems our simulations emphasize an essential point for sustainable management of irrigated agroecosystems namely that under given plant salt tolerance level developing accessible solutions to plant environmental interrelationships are vital for sustainable agriculture wichelns and qadir 2015 singh 2018 soil structural degradation caused by decreasing ks cs ex can be intensified in the future owing to the compounding impacts of human activities and climate change specifically anthropogenic irrational irrigation practices can further hasten the degradation process related to salinization and alkalization thereby not only changing the soil moisture dynamics but also affecting the dispersion and swelling processes and ultimately reducing pore spaces and altering root zone soil hydraulic connectivity and diffusion processes van der zee et al 2014 furthermore the salinity risks may be exacerbated by increasing water stress and anticipated variations in precipitation as a result of climate change kramer and mau 2020 since the progression of soil alkalization is gradual van der zee et al 2010 has pointed that it is crucial to anticipate its onset to prevent rather than to cure importantly salt tolerance significantly reshapes the vegetation feedback to future soil degradation trends to improve our understanding to plant salt tolerance in regulating soil moisture dynamics and controlling root zone salinity and sodicity in seasonally irrigated agroecosystems in a changing world as well as contribute to the development of effective ways for controlling and minimizing harm to agricultural productivity and environmental quality we investigate the influences of anthropogenic activities i e changes in groundwater regimes and irrigation practices under different effective irrigation rates and climate change i e variations of rainfall depth α and rainfall frequency λ under different non irrigated season lengths on s cs and ex for varying soil types under different plant salt tolerance i e highly moderately and low tolerant based on the species dependent coupled model using parameter values table 1 as shown in fig 8 under given plant salt tolerance except for the low effective irrigation rate corresponding to soil class i as the decline of the water table depth and the deterioration in quality of irrigated water s first decreased then reached a steady state for each soil type at both effective irrigation rates fig 8a1 a3 the cs first increased decreased and then reached a steady state for each soil type at high low effective irrigation rate fig 8b1 b3 the ex first decreased and then reached a steady state for each soil type at both effective irrigation rates fig 8c1 c3 the control effect of plant salt tolerance under deficit irrigation was clearly higher than that under full irrigation as presented in fig 9 under given plant salt tolerance as the climate getting wetter i e α increases while λ decreases the s first increased and then reached a steady state for each soil type at both non irrigated season lengths fig 9a1 a3 and both the cs and ex first decreased and then reached a steady state for each soil type at both non irrigated season lengths fig 9b1 b3 c1 c3 the control effect of plant salt tolerance is more pronounced in dry climates than in wet climates our results here emphasize the importance of comprehensively considering plant salt tolerance when assessing the sustainability of agricultural practices and environmental protection in future changing environments one of the main threats to the sustainability of irrigated agroecosystems lies in the hazards of root zone salinity and sodicity and the unexpected harm for soil hydroecological functioning as highlighted by porporato et al 2015 any attempt to manage water and soil resources sustainably necessitates identifying the best options for a variety of problems in systems driven by erratic biological climatic and anthropogenic factors particularly in irrigated agroecosystems further our results find noticeable vegetation induced effects on evapotranspiration and leaching processes as well as soil salt levels imposing species specific soil degradation risks over time revealingly crop rotation may be one of the effective ways to prevent soil degradation by planting crops with high tolerance during dry periods and low tolerance during wet irrigation periods as rain or irrigation water can wash the salts from upper soil layers to sub layers at the same time to stimulate crop growth under salt conditions special crop soil water management practices should be advocated short term biological salt removal techniques through halophytes should be promoted mixing or recycling multi quality irrigation water in varying growing seasons should be applied and groundwater table thresholds that limit upward capillary fluxes should be maintained it is also important to note that irrigation under saline sodic conditions must rely on local seasonality trends aiming to meet both evapotranspiration needs and leaching requirements so as to keep salt balance for root zone thus the duration of dry wet interval for irrigated soils is vital in water salt controls for agroecosystems additionally higher dimensional modeling in conjunction with a richards equation for root zone ecohydrological modeling for plant salinity dependent water stress as well as the role of ecohydrological and hydropedological interactions in irrigated agroecosystems may are the focus of our future research 4 conclusions in this study using species dependent soil water salinity and sodicity coupled model in conjunction with field comprehensive measurements from a typical inland basin from northwest china we find that the species dependent coupled model successfully simulates dynamics of soil moisture and salts in root zone as driven by seasonal irrigation practices and stochastic climate conditions under different salt tolerant crops stochastic simulations indicate that plant salt tolerance significantly shaped the feedback between plant growth and dynamics of soil moisture and salinity and sodicity levels in root zone over time in seasonally irrigated agroecosystems compared to salt sensitive species salt tolerant plants can extract water from the soil more efficiently with higher evapotranspiration rates lower occurrence of leaching events and greater capillary upflow fluxes thereby lowering soil moisture and boosting salinization and alkalization in the root zone particularly in arid climates sensitivity analysis revealed that plant salt tolerance together with climatic forcing and anthropogenic perturbations significantly shaped soil water balance and determined future variation trends of salts in the root zone thereby controlling the long term soil degradation associated with reducing ks cs ex in irrigated agroecosystems especially for salt resilient species our findings highlight the importance of comprehensively considering plant salt tolerance when assessing the sustainability of agricultural practices and environmental protection as well as proposing adaptive strategies under global changes credit authorship contribution statement xinwei yin conceptualization visualization writing original draft qi feng conceptualization project administration wei liu conceptualization methodology supervision project administration meng zhu methodology supervision writing original draft jutao zhang methodology visualization writing original draft yongge li conceptualization linshan yang supervision chengqi zhang methodology mengqi cui investigation xinjun zheng investigation yan li conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key r d program of china 2022yff1303301 and the national natural science foundation of china 52179026 42101115 41901100 the xpcc science and technique foundation 2021ab021 we gratefully thank all of the staff at the fukang station of desert ecology for their excellent field and laboratory assistance we are especially thankful to isaac kramer and yair mau huji israel for their generous sharing the python code of sote on github https github com isaackramer sote the authors also thank all anonymous reviewers for their helpful comments in improving this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129138 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2336,soil water deficit and saline alkaline stress impose severe constrains to agriculture and vary across different salt tolerant crops yet the effects and mechanisms of plant salt tolerance on long term soil water budget and future root zone both primary and secondary salinization and alkalization trends under changing environments in irrigated agroecosystems have not been fully understood particularly driven by seasonal irrigation practices and stochastic climate conditions here we introduce a robust species dependent soil water salinity and sodicity coupled model that enables explicitly simulation to the feedback between evapotranspiration and salinity being shaped by plant salt tolerance and saturated hydraulic conductivity as affected by salinization and alkalization in seasonally irrigated agroecosystems using this model in conjunction with field comprehensive measurements from a typical arid inland river basin in northwest china we find that the species dependent model performed well in simulating the root zone moisture s salinity cs and sodicity ex dynamics as driven by seasonal irrigation and random precipitation under different salt tolerant crops with average consistency measure cm reaching to 0 825 0 017 0 819 0 027 and 0 728 0 033 respectively stochastic simulations indicate that plant salt tolerance plays a predominant role in regulating the feedback of vegetation on soil water budget and root zone salinity and sodicity levels over time in seasonally irrigated agroecosystems in contrast to salt sensitive species salt tolerant plants seems to exhibit higher efficiency in water extraction from soil with higher evapotranspiration rates less frequent leaching events and greater capillary upflow fluxes thereby lowering soil moisture and boosting salinization and alkalization in the root zone particularly in arid climates sensitivity analysis revealed that plant salt tolerance together with climatic forcing and anthropogenic perturbations can significantly modulate the soil water balance and determine the possible trends of root zone salinization and alkalization in future thus controlling potential risks of soil degradation related to reducing soil hydraulic conductivity ks cs ex in irrigated agroecosystems notably since ks cs ex decreases with plant salt tolerance increases salt resilient species have the potential to exacerbate soil degradation our results emphasize the importance of comprehensively considering plant salt tolerance for assessing the sustainability of agricultural management practices and environmental protection measures as well as proposing adaptive strategies under global changes keywords plant salt tolerance soil water balance soil salinity soil sodicity soil hydraulic conductivity irrigated agroecosystems data availability data will be made available on request 1 introduction irrigation agriculture development is at the forefront of global food security and is essential for meeting the growing food needs of the burgeoning global population puy et al 2021 worldwide 37 of all cultivated lands are classified as sodic and 23 as saline and nearly 50 of irrigated lands globally 2 5 108 ha is supposed to be markedly influenced by salinization fig 1 a and b zaman et al 2018 sahab et al 2021 and nearly 4 million acres of croplands are abandoned per year due to heavy salt harm mau and porporato 2015 several recent studies emphasize that soil salts have been posing large risks to the sustainability of irrigated agriculture because of a combination of natural and anthropogenic perturbations schoups et al 2005 scanlon et al 2012 minhas et al 2020 further increasing water stress and precipitation variability under global climate change have the potential to aggravate the problem in the coming decades kramer and mau 2020 yin et al 2021a b accordingly with the disorderly extension of irrigated areas and the widespread use of marginal water and land as well as unsustainable management schemes the anticipated intensification of irrigated agriculture will accelerate soil salinization and alkalization shani et al 2007 assouline et al 2015 affect the root zone hydrological partitioning perri et al 2020 and undoubtedly threaten the functionality of such agroecosystems porporato et al 2015 minhas et al 2020 importantly the primary natural salinity and sodicity can take hundreds or even thousands of years to reach critical levels whereas the secondary anthropogenic induced salinization and alkalization can happen in a matter of years or decades suweis et al 2010 lu et al 2021 perri et al 2022 hence a solid investigation to the soil water balance and secondary salinization and alkalization processes is vital to developing sustainable agricultural management while also protecting the environment especially in seasonally irrigated agroecosystems the transport of water within the groundwater soil plant atmosphere continuum gspac system is an important part of the hydrological cycle that governs the energy and mass exchanges between atmosphere and subsurface in irrigated agroecosystems vervoort and van der zee 2008 han and zhou 2018 also water is the primary driver of the contaminant transport in soils and when water enters and leaves the system e g water fluxes evapotranspiration leaching and capillary upflow seasonal variations of soil salinity and sodicity in root zone can occur liu et al 2006 scanlon et al 2010 shah et al 2011 kramer and mau 2020 particularly the process of soil sodicity development is dependent nonlinearly on both soil water composition and salt concentration van der zee et al 2010 in general soil water and salt in root zone are markedly affected by both anthropogenic activities and environmental conditions shani et al 2007 hassani et al 2020 li et al 2022 precipitation regimes irrigation managements and water quality notably influence salts dynamics in the root zone by controlling leaching and evapotranspiration eta processes van der zee et al 2014 assouline et al 2015 capillary upflow predominantly contributes to soil water and salts dynamics and is greatly influenced by shallow groundwater table position and salinity shah et al 2011 van de craats et al 2020 further vegetation type plant salt uptake rate soil properties and dry deposition salt input rate are important aspects of long term root zone salt buildup thereby controlling land productivity suweis et al 2010 manzoni et al 2011 perri et al 2018 kramer and mau 2020 therefore it is critical to clarify the mechanism of soil water movement and its budget and root zone salinization and alkalization trajectories as well as their major controlling factors for sustainable water land utilization and maintenance of healthy irrigated agroecosystems importantly perri et al 2018 highlighted that vegetation salt tolerance is a key factor in limiting and controlling the long term soil moisture dynamics and salinization levels in salt affected soils in dryland ecosystems theoretically in saline sodic environments the main consequence of soil salinization is to reduce plant water absorption and evaporation through lowering the soil water potential inducing toxic effects and osmotic stress imposing significant limitations on water availability fig 1c perri et al 2020 stavi et al 2021 further sodicity negatively impacts the soil physical properties causing soil surface crusting reducing saturated hydraulic conductivity and indirectly affecting soil hydroecological functioning and salt accumulation agassi et al 1981 hassani et al 2020 nonetheless different species respond to these effects through distinct morphological and physiological strategies depending tremendously on their degree of salt tolerance munns and tester 2008 unsurprisingly halophytes salt tolerant plants can achieve water utilization efficiency significantly higher than glycophytes salt sensitive species resulting in higher transpiration rates and lower occurrence of leaching events thereby regulating hydrological partitioning and salinization levels runyan and d odorico 2010 flowers and colmer 2015 in doing so salinity and sodicity directly control soil moisture dynamics by vegetation and plant salt tolerance and trigger feedbacks that can enhance or reduce root zone salt accumulation as well as affect soil structural and hydraulic characteristics van der zee et al 2014 perri et al 2022 hitherto although multiple studies have evaluated how plant salt tolerance affects soil water balance and root zone primary salinization levels in drylands much less is known about whether plant ability to tolerate salinity in irrigated agroecosystems affects long term soil moisture dynamics and future root zone both primary and secondary salinization and alkalization trends under varying scenarios as driven by stochastic climate conditions as well as seasonal irrigation practices furthermore the interconnected avenues via which plant salt tolerance drives the feedback effects of root zone salinity and sodicity on soil saturated hydraulic conductivity in seasonally irrigated agroecosystems remain elusive from an ecohydrological viewpoint increased salinity in the soil can cause a sharp decrease in soil water potential ψs through osmotic effects and as ψs becomes increasingly negative salt begins to produce toxic effects in plant tissues as a result the soil water available to plants is reduced the bare soil evaporative fluxes are suppressed and the energy and water fluxes at the land atmosphere interface are further limited i e the latent heat fluxes are reduced and the water flow patterns are altered shani and dudley 2001 parida and das 2005 munns and tester 2008 perri et al 2020 in particular the impact of salinity on et and the soil water balance depends on plant salt tolerance and can differ notably among species parida and jha 2010 perri et al 2018 simultaneously from a hydropedological standpoint sodicity can cause soil structure deterioration owing to clay particle dispersion and soil swelling and further lead to the formation of an almost impenetrable textural b horizon fig 1d assouline and narkis 2013 van de craats et al 2020 such processes have the potential to delete big pores and change the water retention curve to favor smaller pores resulting in a significant decrease in saturated soil hydraulic conductivity and ultimately impacting the spatiotemporal distribution patterns and transport processes of root zone water and solute mcneal and coleman 1966 mcneal 1968 clapp and hornberger 1978 van de craats et al 2020 notably hydropedological processes linking soil morphology with hydrological processes influence soil water and solute transport and cycling and can distinctly differ across soils lin et al 2006 importantly elucidating the interactions of ecohydrological and hydropedological can greatly enhance our understanding of the interactions between salinity sodicity vegetation and soil water dynamics additionally a vast array of analytical and numerical models have been developed to reproduce variations of water and solute within the gspac system e g hydrus minhas et al 2020 sote model kramer and mau 2020 and species dependent stochastic soil water and salinity coupled model perri et al 2018 which have vastly enhanced the ability to sustainably develop and adaptively manage irrigated agroecosystems in this study by taking into account the feedback between salinity and evapotranspiration as mediated by plant salt tolerance and the feedback of salinity and sodicity on the soil saturated hydraulic conductivity together with field comprehensive measurements of different salt tolerant crop types from a typical inland river basin in northwest china we explore the long term effects and mechanisms of plant salt tolerance on soil moisture dynamics and root zone salinization and alkalization in seasonally irrigated agroecosystems driven by seasonal irrigation practices and stochastic climate conditions this study aims to 1 establish a robust species dependent soil water salinity and sodicity coupled model for exploring variations of water fluxes evapotranspiration leaching and capillary upflow and root zone water salinity and sodicity in seasonally irrigated agroecosystems 2 evaluate the long term effects of plant salt tolerance on water fluxes and root zone water salinity and sodicity resulting from changes in climate patterns irrigation practices groundwater regimes soil types plant salt uptake rates and dry deposition salt input rates in such agroecosystems 3 investigate the feedback of root zone salinity and sodicity on the saturated soil hydraulic conductivity under varying environments and the positive role of plant salt tolerance in regulating such an effect and the implications of anthropogenic activities and climate change for irrigated agroecosystems capitalizing on these study objectives we would propose practical management and restoration directives for accomplishing sustainable agriculture development and environmental preservation in face of ongoing and future global changes in irrigated agricultural regions around the world 2 methods 2 1 species dependent soil water salinity and sodicity coupled model as a first step we introduce three state variables relative soil moisture s dimensionless soil salinity cs mmolc l 1 and soil sodicity ex dimensionless following rodriguez iturbe et al 1999 van der zee et al 2014 and kramer and mau 2020 under their basic assumptions we further assume that the soil water profile below the root zone has a steady state and the groundwater table is constant which means that the temporal variability in the groundwater table and quality occur on a much larger time scale than climate drivers therefore the dynamics of these state variables in irrigated agroecosystems are characterized by coupled nonlinear ordinary differential equations on the basis of water and salt mass balances driven by stochastic climatic conditions and seasonal irrigation practices fig 2 and the balance equation for s 0 s 1 in salt and alkali affected soils can be expressed as 1 n z r ds dt p t i t u s e t s c s e x l s c s e x q s where s is equal to volumetric soil water content θ divided by porosity n zr is the root depth mm p i and u represent the precipitation rate minus canopy interception irrigation rate and capillary flux of groundwater respectively et l and q are the evapotranspiration rate deep percolation rate and surface runoff rate respectively at a daily time scale precipitation is modeled as a marked poisson process with a mean frequency of events λ event d 1 an exponentially distributed precipitation depth of mean α mm event 1 and an interception depth δ mm rodriguez iturbe et al 1999 anthropogenic irrigation inputs can be regarded as either a constant rate mm d 1 triggered by soil moisture regimes or a time dependent process kramer and mau 2020 capillary upflow u can be assumed to be a steady state flux due to fluctuations in groundwater tables occur on much larger timescales than fluctuations in climate drivers van der zee et al 2014 which is determined by climate and vegetation properties soil hydraulic functions root zone saturation and distance to water table vervoort and van der zee 2008 evapotranspiration is the sum of the losses caused by plant transpiration and soil evaporation which depends not only on soil water content but also on soil salinity while the level of plant salt tolerance determines the magnitude and form of the dependence of et on cs perri et al 2018 as from kramer and mau 2020 deep percolation or leakage is functionally dictated by the water saturation and the saturated hydraulic conductivity controlled by soil salinity and sodicity k s c s e x runoff is produced when the soil becomes saturated and when the water input rates are larger than k s c s e x and here can be neglected mau and porporato 2015 accordingly the combination et u and l results in a water loss function of the root zone in an irrigated agroecosystem as presented in section 2 2 given that salt mass dynamics occurs over longer time scales by considering the effect of all inflow and outflow water fluxes on both the concentration of salts in the soil water and the exchangeable sodium fraction of soil following shah et al 2011 van der zee et al 2010 and kramer and mau 2020 under their basic assumptions we consider the soil solution and exchange complex to be in equilibrium due to this study focus on long term processes therefore the temporal evolution of root zone soil salinity cs in irrigated agroecosystems can be depicted by the following balance equation 2 d q s dt n z r d s c s dt i t c i p t c p ψ d u s c u l s c s e x c s φ up where qs is the total salt content per square meter mmolc m 2 in the soil water q s c s n z r s herein molc denotes mole charge and 10 molc m 3 corresponds approximately to an electrical conductivity of the solution of 1 ds m 1 cp ci cs and cu are the salt concentrations in the precipitation irrigation water soil water in the root zone and shallow groundwater mmolc l 1 respectively ψ d is the dry deposition salt input rate mmolc m 2 d 1 such as the saline dust storms in arid regions abuduwaili et al 2010 and the salt spray in coastal regions suweis et al 2010 φ up is the plant salt uptake rate mmolc m 2 d 1 which is governed by plant transpiration and salt uptake efficiency manzoni et al 2011 following rafael et al 2013 the salt mass taken up by plants in the root zone can be modeled as φ up c s exp c s c i nit θ e t s c s e x where cinit denotes the initial root zone salt concentration in mmolc l 1 the salt uptake efficiency θ depends largely on plant traits and soil type and when θ and plant transpiration are elevated plant salt uptake is reduced note that the effects of unharvested salts in belowground biomass and soil evaporation in evapotranspiration on φ up has been integrated into θ in equation 2 the first four terms indicate salt inputs from irrigation precipitation dry and wet deposition and groundwater i e primary and secondary salinization whereas the latter two terms stand for salt losses caused by leaching events and plant uptake we further describe the partitioning between the cations in the soil solution and the adsorbed phase where the input and output of cations are controlled by the same mechanisms that govern the change in cs following kramer and mau 2020 in order to capture the main characteristics of monovalent divalent ion exchange of saline sodic soils we consider two cations sodium na and calcium ca2 henceforth the charges in the notation is omitted that together constitute the cs notably throughout this study soil sodicity represents the equivalent fraction of sodium ena in various phases which can be characterized by the exchangeable sodium percentage esp therefore the balance equation of root zone soil sodicity ex in irrigated agroecosystems over the long term can be given by 3 d q na dt i t c i e i na p t c p e p na ψ d e d na u s s c u e u na l s s c s e x c s φ up e s na where q n a q x na q s na represents the total sodium content of root zone mmolc m 2 with q x na is the sodium ions adsorbed to the soil exchange complex and q s na is the sodium ions in the soil water e p na e i na e s na and e u na are the proportion of sodium cations in precipitation irrigation soil solution and groundwater respectively according to mau and porporato 2015 using the exchange isotherm determined by the gapon equation suarez and jurinak 2011 we re express q s na q s g s c s e x na k g q s g s q s n z r s e x na k g herein the gapon selectivity coefficient kg ranges from 0 00866 to 0 01740 mmolc l 1 1 2 mau and porporato 2015 and k g esr sar with esr exchangeable sodium ratio is defined as esr esp 100 e s p and sar sodium adsorption ratio is given by sar n a c a mg 2 in which the square brackets indicate the concentration of cation in the soil water mmolc l 1 further we re express q x na q x e x na c e c m e x na herein cec denotes the cation exchange capacity mmolc kg 1 m is the dry soil mass in the root zone kg m 2 subsequently substituting re express q s na and q x na into equation 3 then coupling equations 3 and 2 thus a differential equation for ex is obtained the complete equation of ex and its detailed derivation can be found in kramer and mau 2020 note that formally we refer to the e x na as ex i e esp throughout this paper the coupled equations 1 3 are solved numerically with the classical runge kutta 4th order method in the python environment the specific numerical simulation scheme is described in section 2 3 to characterize long term root zone s cs and ex in irrigated agroecosystems forced by anthropogenic irrigation practices and natural stochastic rainfall as from perri et al 2018 and kramer and mau 2020 salinity and sodicity can govern water losses from the soil by varying the hydraulic conductivity and infiltration rate at the same time salinity and sodicity directly control hydrological partitioning by plant salt tolerance and can trigger feedbacks that increase or decrease root zone salinization level in addition salinization can significantly limit water availability and exacerbate aridity i e acts as a form of drought stress in salt affected ecosystems perri et al 2020 in the following we model the feedback effects of plant salt tolerance and saturated hydraulic conductivity k s c s e x on the coupled long term dynamics of root zone s cs and ex in irrigated agroecosystems fig 2b assuming no hysteresis occurs in these processes and potential consequences nonetheless the hysteresis effect can be interpreted using the modeling technique proposed by kramer et al 2022 2 2 water losses for given salinity sodicity and plant salt tolerance in irrigated agroecosystems for given salt tolerance and salinization level as from vervoort and van der zee 2008 the combination of et l and u dominate the long term soil drying process in the root zone i e e t s l s u s as forced by irrigation practices and climate conditions in particular the influence of salinization on evapotranspiration lies at the heart of the long term coupled dynamics of root zone s cs and ex considered in this paper as from parida and jha 2010 the extent of reduction in transpiration due to ionic and osmotic stress is mostly influenced by plant salt tolerance in terms of salt tolerance halophytes have high salt tolerance due to high salt storage potential in tissue whereas glycophytes can only tolerate low salt concentrations in tissues before cell processes are unfavorably affected flowers and colmer 2008 as a result the water use efficiency of halophytes is much higher than that of glycophytes resulting in higher transpiration rates and lower incidence of leaching events runyan and d odorico 2010 to better understand salinity controls on et and elucidate the species specific responses of plants to salt stress following priestly and taylor 1972 and perri et al 2018 under their basic assumptions based on the proportional relationship between plant transpiration and crop yield that is y r et e t m a x e t r where yr etmax and etr are relative yield maximum et and relative et respectively shani and dudley 2001 ben gal et al 2003 and incorporating the compound cumulative effect parameters that determine salt tolerance munns and tester 2008 parida and jha 2010 as well as taking the capillary rise into account vervoort and van der zee 2008 we propose a straightforward modeling of the influences of salt tolerance on et in salt affected irrigated agroecosystems which can be written as 4a e t s c s e x e t m a x c s c t e t m a x 1 β c s c t c t c s 4b e t m a x 1 26 2576 9 exp 12 27 t a 237 3 t a 240 97 t a 2 2576 9 exp 12 27 t a 237 3 t a 240 97 t a 2 g l r n g where etmax is the maximum evapotranspiration rate mm d 1 ct is the crop specific salt stress threshold g l 1 β is the slope parameter in threshold reduction function l g 1 ta is the air temperature in g is the psychometric constant l is the latent heat of water g is the ground heat flux rn is the net radiation the molecular term of equation 4b represents the derivative of the saturation vapor pressure with respect to ta and calculated using the clausius clapeyron equation intuitively equation 4 simply recapitulates the relationship between et and c using parameters ct and β and two key parameters can directly estimated from yr c experimental data and widely adopted from minhas et al 2020 according to maas and hoffman 1977 we here classify plant salt tolerance into three main categories i high sensitivity i e c t 2 g l 1 and β 0 1 l g 1 ii moderate salt tolerance i e 2 c t 5 g l 1 and 0 075 β 0 1 l g 1 and iii high salt tolerance i e c t 5 g l 1 and β 0 075 l g 1 note that the root zone s and ex regulate et by interacting with cs and can notably vary across species before modeling root zone water losses from leakage we first introduce the feedback of k s c s e x on root zone cs and ex in general if monovalent cations dominate a higher proportion of the cation exchange complex the negative charge of soil colloids is difficult to be screened off which may result in dispersion and swelling of organic colloids and clays that is the soil pore size distribution will shift to a smaller radius this implies lower percolation and higher salinization van der zee et al 2014 therefore by incorporating the decomposition model developed by ezlit et al 2013 this feedback can be modeled as 5a k s c s e x k s 0 r c s e x k s 0 1 h x p 3 e p 4 e x x e x p 1 p 2 1 p 3 e p 4 e x x e x p 1 p 2 5b x p 7 3 6 10 4 esp p 5 p 6 ln c s 0 a c s 300 m m o l c l 1 p 7 3 6 10 4 esp p 5 p 6 ln c s 356 4 c s 0 5 1 2 a c s 300 m m o l c l 1 where ks 0 represents the initial saturated hydraulic conductivity mm d 1 r c s e x is a sigmoidal transition function under the control of cs and ex h x is the heaviside step function x is the adjusted effective swelling factor p 1 p 2 p 3 p 4 p 5 p 6 and p 7 are the soil specific parameters in general k s c s e x drops with rising ex for relatively high cs the decline is negligible because the negative charge of soil colloids are effectively shielded by the high ionic strength and counteracts swelling whereas at low cs the k s c s e x decreases remarkably with increasing ex similar to earlier models mcneal 1968 the ezlit et al 2013 model also does not account for the impact of partial reversibility on the variation of saturated hydraulic conductivity with this premises leakage or leaching losses are at maximum when s 1 for s 1 these losses decrease in accordance with an experimentally determined power law and to a value of zero when s is below a field water capacity sfc clapp and hornberger 1978 following kramer and mau 2020 leakage losses in salt affected soils can be given by 6 l s c s e x k s c s e x s c s fc s 1 where parameter c depends on the soil type sfc is the soil saturation point at which gravitational drainage becomes negligible with respect to et laio et al 2001 moreover shallow groundwater can be an important source of root zone both water and salts in irrigated agroecosystems and can have both beneficial and detrimental effects on crop output runyan and d odorico 2010 alizadeh and mousavi 2013 accordingly by linearizing the capillary flux soil moisture relation proposed by vervoort and van der zee 2008 and assuming a time averaged water table depth as well as considering the feedback between k s c s e x and root zone cs and ex a simplified analytical relation between u and s can be expressed as 7a u s c s e x k s c s e x g s c s s k s c s e x g s e s s e s s s s e 0 s e s 1 7b g 5 b 6 2 b 6 h b z z r 2 3 b where k s c s e x g represents the maximum u at the average shallow groundwater depth z the dimensionless parameter g is a function that describes the relationship between u and z hb is the bubbling pressure and parameter b is related to soil water characteristics eagleson 1978 s is the soil saturation point at which transpiration becomes restricted s c k s c s e x g s e t m a x is a specific soil saturation point below which the soil never dries out since the potential u becomes equal to the actual et the effective field capacity s e z z r h b 1 b θ r n with θr denotes residual water content at wilting point and se represents the soil saturation point at which the soil switches from a drainage to a capillary uptake state vervoort and van der zee 2008 alizadeh and mousavi 2013 this means both sc and se two key parameters both of which are contingent on the soil hydraulic properties and the groundwater table it is assumed that u is continuously supplied with water so sc 0 and u is difficult to maintain the maximum evapotranspiration so sc s in addition when the shallow water table z zr the root zone will be in waterlogged conditions which can cause anaerobic conditions and continued exposure to extended periods of anaerobic conditions will adversely affect many plant types and result in their death here we focus on the scenario of z zr similar to that presented by alizadeh and mousavi 2013 together combining equations 4 7 upon normalization with respect to the active soil depth the root zone water loss function for given salinization and plant salt tolerance in irrigated agroecosystems is summarized as ρ s e t s c s e x l s c s e x u s c s e x n z r and as shown in fig s2 in doing so to simulate long term s cs and ex dynamics in the root zone under future scenarios it is hypothesized that irrigation management is consistent across time under quasi steady state conditions at least during the growth season namely no changes in water supply schedule water delivery system irrigation water quality or cropping system shani et al 2007 kramer and mau 2020 despite this the average irrigation requirements for a given soil crop and type of climate can be modeled by a stochastic irrigation process according to vico and porporato 2010 here we only note that the error introduced by this assumption tend to be negligible compared to the uncertainties in the external hydroclimatic forcing 2 3 model parameterization verification and numerical calculations to better understand the impacts of plant salt tolerance on long term root zone water salinity and sodicity dynamics in irrigated agroecosystems under different soil types irrigation practices groundwater regimes and climate forcings the climate is characterized by αλ etmax with the α and λ were obtained from long term daily rainfall data and the etmax was estimated by using equation 4b dralle and thompson 2016 vegetation parameter values used in the simulations following maas and hoffman 1977 and porporato et al 2004 the plant salt tolerance parameters were highly tolerant species β 0 071 l g 1 and c t 6 4 g l 1 moderately tolerant β 0 084 l g 1 and c t 2 84 g l 1 and low tolerance β 0 12 l g 1 and c t 1 92 g l 1 perri et al 2018 the interception capacity of cultivated vegetation δ was set to 0 1 cm d 1 rodriguez iturbe et al 1999 the parameters associated with water losses i e et l and u were estimated according to typical values listed in laio et al 2001 vervoort and van der zee 2008 perri et al 2018 and kramer and mau 2020 further we modeled the k s c s e x based on the relative clay content of the soil and used parameter values given by ezlit et al 2013 and kramer and mau 2020 the ψ d and θ were derived from abuduwaili et al 2010 suweis et al 2010 and rafael et al 2013 specifically the detailed values of climatic vegetation soil and groundwater physicochemical parameters used in model calculations are listed in table 1 we use field comprehensive observations of different salt tolerant crop types under varying groundwater regimes and diverse soil types based on the sangong river watershed srw of northwestern china for model verification this watershed features a typical continental arid climate having low p and high et receiving approximately 200 mm precipitation year and 1533 2240 mm pan evaporation year regionally the watershed has a long history of irrigated agricultural practices and over 95 of the land is farmed and 85 of that irrigation is water saving the majority of it being mulched drip irrigation yin et al 2021b over 90 of all water usage is for agricultural purposes which mostly depends on groundwater pumping the watershed is planted with a wide range of salt tolerant crop varieties with the dominant crop is cotton and other crops include grapes corn wheat melons etc the field measured data of root zone s cs and ex under different crop types as well as the specific model parameters associated with soil hydraulic physical and chemical exchange properties can be obtained in yin et al 2021a and additional climatic crop groundwater and irrigation parameters are given in table s1 the coefficient of determination r2 nash sutcliffe model efficiency nse mean absolute error mae mean absolute percentage error mape root mean square error rmse and consistency measure cm were selected as indicators zhu 1999 xu et al 2013 to assess the goodness of fit between the simulated and observed root zone s cs and ex of different salt tolerance crop types in seasonally irrigated agroecosystems for the numerical simulations we hypothesized the irrigation is continuous during the crop growth period and performed at rate proportional to 125 100 75 and 50 30 of the maximal daily evapotranspiration etmax for non stressed intermediate and stressed levels respectively ben gal et al 2009 which is itself designed to vary seasonally in accordance with a sinusoidal curve and the minimum and maximum values in the curve were made to coincide with the time nodes of the lowest and highest temperatures in a specific climate zone kramer and mau 2020 under the control of plant salt tolerance to characterize the role of climate change soil properties irrigation practices and groundwater dynamics on soil moisture dynamics and root zone salinity sodicity and saturated soil hydraulic conductivity in irrigated agroecosystems we conducted simulations with three precipitation patterns dry climate α 11 mm event 1 λ 0 3 event d 1 semiarid climate α 12 5 mm event 1 λ 0 4 event d 1 and wet climate α 14 mm event 1 λ 0 5 event d 1 three soil types class i 5 7 clay class ii 16 2 clay and class iii 48 5 clay three irrigation water qualities fresh water c i 12 mmolc l 1 e i 0 36 brackish water c i 35 mmolc l 1 e i 0 69 and saline water c i 55 mmolc l 1 e i 1 13 and three types of gtd type i z 2 m type ⅱ z 4 m and type iii z 6 m the groundwater quality can be derived from the gtd the specific formula is shown in yin et al 2021a at the same time the sensitivity of different non irrigated season nis lengths 80 days 130 days and 180 days nsi plant salt uptake rates θ 0 05 0 5 and 5 irrigation quotas i 40 etmax i 75 etmax and i 110 etmax and dry deposition salt input rates ψ d 1 6 and 12 mmolc m 2 d 1 were also compared and analyzed in order to reduce the uncertainties of the simulation results over the long term we ran the simulation operations 100 times to get the average output values the first simulated year was disregarded in order to generate a 1 year warm up phase and the simulated time was over 20 years the python 3 8 5 https www python org and matlab r2014a the mathworks inc natick ma usa were applied for conducting simulations 3 results and discussion 3 1 model effectiveness and long term dynamic stochastic simulations fig 3 presents the measured s cs and ex compared to species dependent coupled model simulations in various salt tolerant crops i e cotton maize wheat sunflower stevia melon and tomato in the srw in performing our validation under different salt tolerant crops the simulated root zones s cs and ex demonstrated good concordance with the observed values the statistics used to evaluate model performance i e average mae rmse nse mape and r2 were all within the acceptable range indicating that the model performed well with a good level of modeling efficiency fig 3a c further the estimated probability density functions pdfs for s cs and ex captured the key distribution properties e g height and location of peak span width of s cs and ex in different soil sampling sites i e o1 o24 over the study period figs s3 s5 with average cm were 0 825 0 017 0 819 0 027 and 0 728 0 033 respectively fig 3d by contrast the cm of s was higher than that of cs and both were notably higher than that of ex the major reason for this discrepancy are the error resulted from the small sample size of numerical pdfs the spatial variability of both cs and ex is much greater than that of s and the inadequate prediction of rainfall and irrigation by the model nonetheless this discrepancy is acceptable in this study and it doesn t bother much as far as the predictions are concerned overall the simulation results suggest that the performance of the species dependent coupled model is widely good for modeling s cs and ex in seasonally irrigated agroecosystems in our simulations the species dependent coupled model is applicable for stochastic climatic simulation with seasonal irrigation in irrigated agroecosystems in order to demonstrate how the long term dynamic stochastic simulations based on the coupled model are generated in the next sections we first examine an example stochastic ensemble as driven by random rainfall and seasonal irrigation over a 2 year simulation period using parameters table 1 under highly salinity tolerant vegetation fig s6 in fig s6 the left column presents evolution of actual evapotranspiration eta l u and root zone s cs ex and relative saturated hydraulic conductivity rks i e the ratio of the k s c s e x to the saturated hydraulic conductivity for a single 2 year run the right column displays 100 runs thin light blue lines for water saline and sodic fluxes as well as rks and the ensemble averages thick red lines intuitively the stochastic rainfall events results in the variability of each variable light blue shading while irrigation events control the magnitude of changes in each variable over the simulation period compared to the non irrigated season the irrigated season had clearly higher eta larger l smaller u and larger s the input of salts from irrigation water and capillary upflow caused a rise in cs and ex but the seasonal variation of the ex was much slower and smaller in magnitude a decline in rks due to the continued rise in ex can be observed in these example runs as fig 4 a1 g1 reveals under dry climate regimes α 11 mm event 1 λ 0 3 event d 1 the general dynamics of each variable is characterized by two features i e the overall sawtooth wave pattern and the final periodic steady state under different plant salt tolerance conditions as time goes on the eta l u and rks all first displayed a downward trend and ultimately attained a cyclically stable state whereas the s cs and ex all first showed an upward trend and finally reached a periodically steady state i e periodically time varying with the same extremums further the three salt tolerant plants had distinctly different interannual dynamics and times for each variable to reach its periodic steady state specifically elevated levels of plant salt tolerance cause higher eta u cs and ex but lower l s and rks and the modes of p eta p u p cs and p ex move to larger values of eta u cs and ex respectively while the patterns of p l p s and p rks shift to smaller values of l s and rks respectively fig 4a2 g2 overall the value of s increases with salinization and alkalization levels i e an increase in cs and ex and decreases with the degree of plant salt tolerance this is due to the fact that salt tolerant plants utilize water in the soil more efficiently i e higher eta against low soil water potentials and saline and sodic phytotoxic effects than the salt sensitive ones perri et al 2018 in this way highly salt tolerant species reduce the leaching frequency and boost the capillary upflow flux in comparison to more salt sensitive species leading to higher salinization and alkalization risks thus accelerating soil structure degradation i e lower rks van der zee et al 2014 our modelling further show that plant salt tolerance plays an important role in regulating vegetation s feedback on the soil moisture dynamics as well as root zone salinity and sodicity levels in seasonally irrigated agroecosystems 3 2 effects of plant salt tolerance on soil moisture dynamics under varying scenarios in this section we evaluated the influences of plant salt tolerance i e highly tolerant moderately tolerant and low tolerant on variations of eta l and u in different climate patterns non irrigated season nis lengths soil types plant salt uptake rates irrigation water qualities irrigation quotas water table depths and dry deposition salt input rates based on the species dependent coupled model using parameters table 1 by runing 10 year simulation with 100 stochastic repetitions in seasonally irrigated agroecosystems the extent to which transpiration is suppressed as a result of osmotic and ionic stress is largely determined by plant salt tolerance and varies notably among species ben gal et al 2009 perri et al 2018 for variations of eta the results presented in figs 5 and s7 illustrate that the difference in plant salt tolerance caused significant variations in long term dynamics and average values of eta under different analysis scenarios except under wet climate and fresh irrigation water and all shown that the average eta was the largest under salt tolerant plants and the smallest under salt sensitive plants as the climate becomes strongly drier i e from wet clamate to dry clamate the effect of plant salt tolerance on eta becomes more pronounced and elevated levels of plant salt tolerance leads to higher eta fig 5 a it is intriguing that under soil class i 5 7 clay variations of eta showed a significant downward trend over time for each plant salt tolerance scenario fig s7c and the mean eta under both soil class ii and class iii was notably higher than that of class i fig 5c similar time varying patterns of eta were also exhibited under both deficit irrigation i 0 4 etmax and shallow water table depth gtd 2 m fig s7f and g with the deterioration of irrigation water quality eta showed a clear downward trend and the interannual fluctuation amplitude decreased markedly fig 5e and s7e these results indicate that salt tolerant crops can achieve substantially higher water use efficiency than salt sensitive crops thereby resulting in higher eta and lower percolation leaching is an important balance term between preventing root zone salt accumulation and removing nutrients from soil in agricultural ecosystems and depends primarily on the root zone hydraulic conductivity kramer and mau 2020 for variations of l the results shown in figs 5 and s7 reveal that various plant salt tolerance levels correspond to unique l under certain analytical scenarios except under wet climate and fresh irrigation water and the average l was the largest under salt sensitive plants and the smallest under salt tolerant plants as well as variations of l exhibited a downward trend over time under each analysis scenario not surprisingly the l in wet climate was significantly higher than that in dry climate it is intriguing that elevated levels of plant salt tolerance result in lower l fig 5a as the length of the non irrigated season increased irrigation events decreased the occurrence of leaching decreased clearly fig s7b particularly short term and high intensity showers may dominate leaching rather than the average levels under dry climates more interestingly the leaching of soil class ii 16 2 clay was evidently higher than that of both soil class i and class iii under the three plant salt tolerance scenarios fig 5c and s7c indicating that lower clay content does not necessarily mean higher leaching with the increase of the plant salt uptake rate the l showed an increasing trend fig 5d and s7d this may be due to the fact that the uptake of salt by plants can reduce transpiration while mitigating the risk of soil degradation further under each plant salt tolerance scenario the l in fresh irrigation water was significantly lower than that in poor irrigation water and the decline of water table depth can lead to the increase of l but is nonmonotonic fig s7e and g additionally the increase of irrigation quota can evidently increase the leaching rate fig 5f and s7f these results reveal that salt tolerant crops consume more root zone water than salt sensitive ones thereby hampering leaching events and accelerating soil degradation in irrigated agroecosystems upward groundwater flow induced by capillary pressure may affect water balance and cause soil degradation in the root zone shah et al 2011 for variations of u the results shown in figs 5 and s7 suggest that the u exhibited a downward trend over time under each analysis scenario except under soil class i and class iii and the average u was the largest under salt tolerant plants and the smallest under salt sensitive plants under specific plant salt tolerance scenarios as the climate changes from dry to wet the shift of the pdf of u to the left and becomes progressively smaller fig 5a moreover the u of soil class ii was significantly higher than that of soil class i and class iii fig 5c and s7c also both the length of irrigation season and the irrigation quota had clear effects on the u fig 5b and f besides the irrigation water quality and groundwater table are further important aspect to the long term dynamic of u fig s7e and g the ψd has no clear influence on the u fig 5h and s7h relatively speaking as climate becomes drier the water used for et in the root zone is replenished by the u which increases when groundwater becomes shallower especially under salt tolerant crops if the groundwater is saline or brackish capillary upflow can transport salts to the root zone these salts may inhibit transpiration as a result of water stress produced by osmotic effects at the same time salinity and sodicity induced soil structural degradation i e the reduction of k s c s e x results in uncoupling of root zone and shallow groundwater thereby reducing salt leaching and limiting capillary upward flow van der zee et al 2014 hence plant salt tolerance can exert significant influence on u and is rely strongly on the soil hydraulic conductivity of the soil layer between root zone and groundwater table altogether these findings emphasize that the long term influences of plant salt tolerance on water fluxes eta l and u should be carefully considered in mitigating agricultural drought and soil degradation risks in face of ongoing and future global changes particularly in arid climates 3 3 effects of plant salt tolerance on root zone cs and ex under varying scenarios before investigating the effects of plant salt tolerance i e highly tolerant moderately tolerant and low tolerant on root zone cs and ex based on the species dependent coupled model using parameters table 1 in seasonally irrigated agroecosystems we first analyzed the impacts of plant salt tolerance on variations of root zone s under different scenarios by combining the analysis results of water fluxes in section 3 2 as shown in figs 6 and s8 the average s under salt tolerant species was lower than that under salt sensitive species that is elevated salt tolerance corresponds to lower relative soil moisture moreover variations of root zone s displayed an upward trend over time in each analysis scenario this is in consistent with the findings of yin et al 2021a notably the drier the climate or the lower the soil water content the more significant the regulation effect of plant salt tolerance on root zone s this may be due to the fact that the et c feedback was further enhanced by sparse precipitation and low soil water content perri et al 2018 also the non irrigated season length soil type irrigation quota and water table depth all had clear influences on variations of s under the control of plant salt tolerance not surprisingly an increase in irrigation events and irrigation quotas as well as a shallower gtd will increase the input flux of soil water which in turn will lead to an increase in root zone s similar to results from kramer and mau 2020 the s in soil class iii was significantly higher than soil class ii and both were clearly greater than in soil class i fig 6 c and s8c these results underscore the central role of plant salt tolerance in modulating the long term soil water balance in irrigated agroecosystems salinity is supposed to exert a direct impact on hydrological partitioning through vegetation slat tolerance and further regulates root zone salt accumulation in drylands perri et al 2022 for variations of cs the results shown in figs 6 and s8 indicate that the varying levels of plant salt tolerance correspond to different cs under given analysis scenarios except under fresh irrigation water and the mean cs was the largest under salt tolerant plants and the smallest under salt sensitive plants as well as variations of cs almost all showed an increasing trend over time under each analysis scenario with the transition from wet to dry climate the shift of the pdf of cs to the right becomes gradually larger and the control effect of plant salt tolerance gradually increased fig 6a this implies the aridity promotes soil salinization by reducing soil moisture and inhibiting leaching events for given salinization and salt tolerance level as can be seen in fig 6b e and f irrigation can be considered to play two distinct roles in regulating root zone cs irrigation can bring dissolved salt into soils while it also enhances leaching and salt flushing processes potentially offsetting the additional salt input brought by irrigation in contrast in wetter climates naturally occurring rainfall induced leaching events already dominate the system so the increase in irrigation has little effect on the overall salt mass balance nonetheless the use of water saving irrigation techniques particularly with saline or brackish water may exacerbate root zone salt accumulation and contribute to soil degradation risks in the near future furthermore variations in shallow groundwater table and quality have non monotonic impacts on cs dynamics particularly in salt tolerant crops fig 6g and s8g the brief waterlogging can exacerbate soil salt accumulation during irrigation as shallow gtd becomes shallower the crucial gtd interval that inhibits capillary fluxes is 2 3 m yin et al 2022 additionally soil clay content θ and ψ d also had significant influences on variations of root zone cs under the control of plant salt tolerance fig 6c d and h since leaching is the principal route through which salts leave the soil the enormously decreased leaching rate in class iii soil results in salt buildup over time these results are consistent with the findings of suweis et al 2010 and shah et al 2011 importantly in seasonally irrigated agroecosystems root zone salinization patterns are also relies on whether the irrigation rainfall events and evaporative demand are in phase these results indicate that plant salt tolerance is a key factor in controlling soil salinization in seasonally irrigated agroecosystems soil sodicity accumulation is affected by salt contents and soil water composition and it can result in poorly irreversible soil structure deterioration and drastically decreased hydraulic conductivity for variations of ex the results shown in figs 6 and s8 suggest that over time the root zone ex displayed an upward trend under each analysis scenario and the control effect of plant salt tolerance gradually increased except under wet climate and fresh irrigation water as well as the average ex was the largest under salt tolerant plants and the smallest under salt sensitive plants as the climate becomes intensely drier the effect of plant salt tolerance on ex becomes more pronounced and the p ex shifted toward higher values of ex fig 6a for given climate soil and salt tolerance level with the increase of non irrigated season length the deterioration of irrigation water quality and the increase of ψ d the long term root zone ex all showed a clear increase trend fig 6b e and h whereas with the increase of θ the enhance of irrigation quota and the decline of groundwater table the long term root zone ex all revealed a significant decrease fig 6d f and g notably the ex of soil class ii was clearly higher than that of soil class i and class iii under the control of plant salt tolerance fig 6c and s8c it is important to note that compared with nonseasonal poisson distributed precipitation plant salt tolerance under seasonal stochastic precipitation had more significant control on soil moisture dynamics and root zone salinity and sodicity such as in mediterranean climate zones by contrast the fluctuations and long term tendencies of ex is less significant compared to that of cs this is largely a result of the differences in cation exchange buffering van der zee et al 2014 besides another possible reason is that as the value of cs increases the sensitivity of their relationship decreases van der zee et al 2010 importantly even if cs does not increase with time while ex may still varies with time as a consequence the esp in the root zone increases due to evapotranspiration condensing salts and capillary upflow supplying salts this leads to the formation of a sodic layer with drastically reduced hydraulic conductivity due to dry wet cycles under the interplay of seasonal irrigation precipitation and capillary upflow van de craats et al 2020 the above phenomenon is more pronounced in highly salt tolerant species these results demonstrate that responses of soil sodicity dynamics to irrigation and precipitation variability is also controlled by vegetation salt resilience in combination these findings emphasize that the long term implications of salt tolerance on s cs and ex must be carefully considered in creating sustainable agriculture and environmental preservation 3 4 feedback of decreasing ks cs ex as mediated by plant salt tolerance soil salinity and sodicity are acute environmental hazards that can result in soil structural degradation and limit land productivity thereby jeopardizing food security kramer and mau 2020 by integrating the species dependent soil water salinity and sodicity coupled model and the soil specificmodel ezlit et al 2013 and using table 1 parameter values we investigated the dependence of k s c s e x on cs and ex for different levels of plant salt tolerance under varying climate patterns soil types groundwater table depths irrigation quotas irrigation water qualities non irrigated season lengths plant salt uptake rates and dry deposition salt input rates as illustrated in fig 7 a h and s9 variations of rks exhibited a downward trend over time under each analysis scenario except in soil class i and class iii and the elevated levels of plant salt tolerance result in lower root zone rks as well as low tolerant plants tend to be more prone than medium and high tolerant species to exceed species specific soil degradation threshold particularly in arid climates it is intriguing that for given climate and salt tolerance level although soil class iii has the highest clay content while no degradation in k s c s e x is found in it meanwhile although soil class i and class ii have similar salinity change patterns only soil class ii experiences degradation fig 7b and s9b suggesting that higher clay contents do not always lead to enhanced soil degradation risk in irrigated agroecosystems interestingly both fresh and saline irrigation water lead to more severe soil degradation than brackish water under the control of plant salt tolerance fig 7d and s9d this discrepancy arises from the fact that changes to cs happen on significantly shorter time periods than changes to ex and the application of fresh irrigation water results in lower cs but saline irrigation water causes higher ex thereby enhancing the risk of soil degradation mau and porporato 2015 unsurprisingly shallower gtds can lead to more pronounced soil structural degradation with a severely decreased hydraulic conductivity whereas rks dynamics can not be expressed as monotonically functions of the gtd fig 7c and s9c as was also emphasized by yin et al 2021a moreover under specific plant salt tolerance both longer irrigation seasons and larger irrigation quotas can increase salt leaching from the root zone rendering soils more susceptible to reduced hydraulic conductivity fig 7e and f in addition the θ is a further important aspect to control the soil structural degradation fig 7g and s9g plants are supposed to decompose extract or promote phytoremediation however it has longer durations than traditional techniques manzoni et al 2011 porporato et al 2015 under varying plant salt tolerance levels similar correlations were presented for soil moisture dynamics components eta l u and s root zone salinity and sodicity cs and ex and rks in dry climates fig 7i there was a significant correlation between rks and ex eta both p 0 01 and a clear correlation with s l both p 0 05 as well as elevated vegetation salt tolerance give rise to higher correlation of rks with s cs eta and lower correlation with ex l u at the same time there were also notable correlations among eta l u s cs and ex almost all p 0 05 except between l and s u both p 0 05 combined with the results of section 2 the rks decreased with the increase of soil sodicity particularly when monovalent cations make up a higher portion of the soil s exchange complex the organic colloid and clay dispersion swelling eliminate large pores and then rks be significantly reduced van der zee et al 2010 ultimately plant water uptake soil aeration and leaching are diminished thus affecting the spatiotemporal patterns of root zone solutes van de craats et al 2020 these results underscore the central role of cs and ex in controlling soil degradation it is important to note that the irreversible degradation is not taken into account in our results but as pointed out by van der zee et al 2014 considering irreversible degradation has the potential to make seasonal degradation cycles more dangerous additionally highly salt tolerant plants often withstand more saline circumstances whereas salt sensitive vegetation typically maintains lower level of salinization salt tolerant species also utilise soil water more efficiently with a reduction in the frequency of leaching than salt sensitive ones meanwhile halophytes have the capacity to absorb and store salt while helping to minimize the quantity of salt that is stored under a variety of climatic conditions further changes in vegetation cover may impact the local hydrologic conditions and promote salt buildup in different parts of soil profile when plants are both sensitive to root zone salt levels and capable of altering the soil salt balance runyan and d odorico 2010 in doing so plant salt tolerance plays a major feedback role on soil salinization and alkalization by regulating evapotranspiration and lowering leaching thereby controlling and limiting the long term soil degradation associated with reducing ks cs ex caused by cs and ex in irrigated agroecosystems 3 5 sustainable management implications for irrigated agroecosystems our simulations emphasize an essential point for sustainable management of irrigated agroecosystems namely that under given plant salt tolerance level developing accessible solutions to plant environmental interrelationships are vital for sustainable agriculture wichelns and qadir 2015 singh 2018 soil structural degradation caused by decreasing ks cs ex can be intensified in the future owing to the compounding impacts of human activities and climate change specifically anthropogenic irrational irrigation practices can further hasten the degradation process related to salinization and alkalization thereby not only changing the soil moisture dynamics but also affecting the dispersion and swelling processes and ultimately reducing pore spaces and altering root zone soil hydraulic connectivity and diffusion processes van der zee et al 2014 furthermore the salinity risks may be exacerbated by increasing water stress and anticipated variations in precipitation as a result of climate change kramer and mau 2020 since the progression of soil alkalization is gradual van der zee et al 2010 has pointed that it is crucial to anticipate its onset to prevent rather than to cure importantly salt tolerance significantly reshapes the vegetation feedback to future soil degradation trends to improve our understanding to plant salt tolerance in regulating soil moisture dynamics and controlling root zone salinity and sodicity in seasonally irrigated agroecosystems in a changing world as well as contribute to the development of effective ways for controlling and minimizing harm to agricultural productivity and environmental quality we investigate the influences of anthropogenic activities i e changes in groundwater regimes and irrigation practices under different effective irrigation rates and climate change i e variations of rainfall depth α and rainfall frequency λ under different non irrigated season lengths on s cs and ex for varying soil types under different plant salt tolerance i e highly moderately and low tolerant based on the species dependent coupled model using parameter values table 1 as shown in fig 8 under given plant salt tolerance except for the low effective irrigation rate corresponding to soil class i as the decline of the water table depth and the deterioration in quality of irrigated water s first decreased then reached a steady state for each soil type at both effective irrigation rates fig 8a1 a3 the cs first increased decreased and then reached a steady state for each soil type at high low effective irrigation rate fig 8b1 b3 the ex first decreased and then reached a steady state for each soil type at both effective irrigation rates fig 8c1 c3 the control effect of plant salt tolerance under deficit irrigation was clearly higher than that under full irrigation as presented in fig 9 under given plant salt tolerance as the climate getting wetter i e α increases while λ decreases the s first increased and then reached a steady state for each soil type at both non irrigated season lengths fig 9a1 a3 and both the cs and ex first decreased and then reached a steady state for each soil type at both non irrigated season lengths fig 9b1 b3 c1 c3 the control effect of plant salt tolerance is more pronounced in dry climates than in wet climates our results here emphasize the importance of comprehensively considering plant salt tolerance when assessing the sustainability of agricultural practices and environmental protection in future changing environments one of the main threats to the sustainability of irrigated agroecosystems lies in the hazards of root zone salinity and sodicity and the unexpected harm for soil hydroecological functioning as highlighted by porporato et al 2015 any attempt to manage water and soil resources sustainably necessitates identifying the best options for a variety of problems in systems driven by erratic biological climatic and anthropogenic factors particularly in irrigated agroecosystems further our results find noticeable vegetation induced effects on evapotranspiration and leaching processes as well as soil salt levels imposing species specific soil degradation risks over time revealingly crop rotation may be one of the effective ways to prevent soil degradation by planting crops with high tolerance during dry periods and low tolerance during wet irrigation periods as rain or irrigation water can wash the salts from upper soil layers to sub layers at the same time to stimulate crop growth under salt conditions special crop soil water management practices should be advocated short term biological salt removal techniques through halophytes should be promoted mixing or recycling multi quality irrigation water in varying growing seasons should be applied and groundwater table thresholds that limit upward capillary fluxes should be maintained it is also important to note that irrigation under saline sodic conditions must rely on local seasonality trends aiming to meet both evapotranspiration needs and leaching requirements so as to keep salt balance for root zone thus the duration of dry wet interval for irrigated soils is vital in water salt controls for agroecosystems additionally higher dimensional modeling in conjunction with a richards equation for root zone ecohydrological modeling for plant salinity dependent water stress as well as the role of ecohydrological and hydropedological interactions in irrigated agroecosystems may are the focus of our future research 4 conclusions in this study using species dependent soil water salinity and sodicity coupled model in conjunction with field comprehensive measurements from a typical inland basin from northwest china we find that the species dependent coupled model successfully simulates dynamics of soil moisture and salts in root zone as driven by seasonal irrigation practices and stochastic climate conditions under different salt tolerant crops stochastic simulations indicate that plant salt tolerance significantly shaped the feedback between plant growth and dynamics of soil moisture and salinity and sodicity levels in root zone over time in seasonally irrigated agroecosystems compared to salt sensitive species salt tolerant plants can extract water from the soil more efficiently with higher evapotranspiration rates lower occurrence of leaching events and greater capillary upflow fluxes thereby lowering soil moisture and boosting salinization and alkalization in the root zone particularly in arid climates sensitivity analysis revealed that plant salt tolerance together with climatic forcing and anthropogenic perturbations significantly shaped soil water balance and determined future variation trends of salts in the root zone thereby controlling the long term soil degradation associated with reducing ks cs ex in irrigated agroecosystems especially for salt resilient species our findings highlight the importance of comprehensively considering plant salt tolerance when assessing the sustainability of agricultural practices and environmental protection as well as proposing adaptive strategies under global changes credit authorship contribution statement xinwei yin conceptualization visualization writing original draft qi feng conceptualization project administration wei liu conceptualization methodology supervision project administration meng zhu methodology supervision writing original draft jutao zhang methodology visualization writing original draft yongge li conceptualization linshan yang supervision chengqi zhang methodology mengqi cui investigation xinjun zheng investigation yan li conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key r d program of china 2022yff1303301 and the national natural science foundation of china 52179026 42101115 41901100 the xpcc science and technique foundation 2021ab021 we gratefully thank all of the staff at the fukang station of desert ecology for their excellent field and laboratory assistance we are especially thankful to isaac kramer and yair mau huji israel for their generous sharing the python code of sote on github https github com isaackramer sote the authors also thank all anonymous reviewers for their helpful comments in improving this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129138 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2337,this paper presents the use of a double sigmoidal model for precipitation phase partitioning in mountains for the model development and evaluation daily rainfall minimum and maximum air temperatures and snow depth data from twelve synoptic stations in the mountainous regions of iran are used the model performance is compared against six air temperature based methods using the taylor diagram the coefficient of determination r2 and the root mean square error rmse performance indicators comparing the frequency of snowfall events estimated by the proposed model with those of the existing models and observation at the selected stations showed better performance of the proposed model in precipitation phase discrimination at the studied stations the average r2 statistic that relates the frequency of snowfall occurrences estimated by the proposed model with the frequency of snowfall events observed at the studied stations is 0 989 which is the highest compared to other available models its average error across the stations is 4 the lowest among the examined models a split sample approach was used to ensure that the parameters of the proposed model are appropriately estimated the result showed that the r2 and rmse values of both calibration and validation subsets are not vastly different from each other suggesting that the parameters of the two experiments are stable and the corresponding results are robust the proposed model also performs better than other existing models in accurately estimating air temperature thresholds required for precipitation phase discrimination as well as the snow depth data in all studied stations keywords snow rain phase logistic function air temperature threshold logistic logistic double sigmoidal boltzmann model data availability data will be made available on request 1 introduction the phase of precipitation that reaches the ground is a first order driver of hydrologic processes in a watershed as it affects the initial and boundary conditions that drive hydrological models harpold et al 2017 therefore knowledge of the frequency of snowfall in a region is essential since it is a vital source and key parameter in hydrological studies and water resources management in areas where snowfall has a large contribution to total precipitation maidment 1992 without correctly estimating the proportion or percentage of snow to the total precipitation especially the identification of the rain snow phase separation in the mountainous areas managing water resources and reservoirs and planning for water resources and rivers is impossible the methods for discriminating solid from liquid precipitation are often based on near surface air temperature thresholds including static linear transformation the minimum and maximum air temperature and the sigmoidal curve approaches harpold et al 2017 however there are limitations in using air temperature based static methods for snow rain phase separation some researchers showed that the temperature thresholds used for separating snow from rain could vary from place to place thus the thresholds should be determined for each location using local daily weather data matsuo et al 1981 u s army corps of engineers 1956 furthermore the range of the two critical air temperature thresholds required for the linear transformation method is wide and unbounded dai 2008 fassnacht and soulis 2002 hay and mccabe 2010 wigmosta et al 1994 nonetheless for the precipitation phase estimation required for hydrological modeling many hydrological practitioners use a fixed spatially uniform air temperature threshold and or a range between two air temperatures in which a mix of rain and snow can occur jennings et al 2018 this may lead to significant biases in estimating snow water equivalent swe snow depth and snow cover duration at both the point and basin scale which can subsequently propagate into errors in streamflow land surface albedo and surface atmosphere energy exchange jennings et al 2018 this indicates that the static method is not applicable universally and it is necessary to conduct more research to determine the appropriate station s specific values of the critical air temperature thresholds kienzle 2008 has proposed a sigmoidal curve method for estimating the frequency of snowfall events as a function of air temperature this sigmoidal curve that requires two parameters for precipitation phase discrimination fits a linear regression to the frequency of observed snowfall events conditioned on the daily air temperature the first parameter of this sigmoid function is the average daily air temperature threshold at which 50 of precipitation is considered snow and the second is the air temperature range at which precipitation can occur as a mixture of snow and rain similarly by experimental analysis of observed snowfall and air temperature records of 15 000 stations scattered over the globe for the 1997 2007 period dai 2008 has presented a hyperbolic tangent function to separate the snow phase from the rain he determined the snow rain phase separation air temperature between 2 to 4 c for the low land areas and between 3 to 6 c for the oceans liu et al 2016 also introduced another s curve based method to separate the phase of snowfall from rainfall using the frequency of observed snowfall data from 6 scattered stations in the naqu river basin china all the aforementioned sigmoidal methods estimate the type of precipitation of a given day by creating a conditional relationship between the frequency of observed rainfall snowfall events and air temperature at a daily or hourly time scale simplicity in the calculation and easy access to the meteorological data required for their calculation are the main advantages of these models given the binary nature of the examined data for discriminating the phase of snow from rain previous studies have used different forms of logistic function to predict the frequency of snow rain occurrences these sigmoidal functions can take any real value and map the snowfall frequencies between 0 and 1 over an s shaped curve however our experiments in iran show that such single sigmoidal models do not fit well with the frequency of snowfall in most of the stations examined in this study more specifically the available single sigmoid functions do not fit the most extreme values of the upper and lower tails of the s shaped distribution of the snowfall frequency of most of the stations thus it is assumed that such a snowfall frequency time series can be better described by a double sigmoid function that is formed from the sum of two different singular sigmoid functions i e logistic logistic logistic gompertz and gompertz gompertz lipovetsky 2010 shabani et al 2018 according to the literature the approaches introduced for snow rain phase separation dai 2008 kienzle 2008 liu et al 2016 are almost single sigmoidal functions and the double sigmoidal functions have not been yet examined therefore among the double sigmoid functions this study examines the performance of the logistic logistic and the double sigmoidal boltzmann equation dsbe to discriminate the phase of snowfall from rainfall in the mountainous areas of iran since the logistic logistic and dsbe models have two inflection points for two consecutive growth stages they are expected to fit better the frequency of snowfall in the studied stations considering that they are more flexible to fit the curvy pattern of the examined data thus the present study attempts to 1 evaluate the performance of double sigmoidal functions in fitting the frequency of snowfall occurrences in the studied stations 2 the calibration of the parameters of the proposed models using a split sample approach that is a standard in hydrologic applications and 3 comparison of the results with observation and the results of other existing snow rain partitioning methods the data used for the analysis is described in section 2 while a detailed description of the snow rain phase separation models including the proposed models and the performance metrics used for the performance evaluation of the models is presented in section 3 the result of the study is presented in section 4 followed by a discussion and conclusion in section 5 2 data for implementing this study that was performed in snow dominated mountainous areas of iran the daily snow depth minimum maximum and average air temperatures and precipitation data of the synoptic and climatological stations of the meteorological organization of iran irimo were acquired and used for the analysis as depicted in fig 1 the total number of irimo stations where snowfall is probable in winter is 417 most of them distributed over western and northern iran from these stations 281 stations were removed from the analysis due to either lacking the snow depth records 191 stations or having suspected data 90 stations the latter group of stations was excluded because they did not properly flag the days with snowfall occurrences or had an insufficient number of snowy days for the analysis therefore the remaining 136 synoptic stations with a relatively adequate number of records of snowy days were selected for snow rain phase separation calculation from these 136 stations only 12 stations with the most reliable and lengthier snow depth data records i e the higher number of snow depth observations were selected for the analysis the selected stations have the lengthiest snow season because they are located at the higher elevations of the mountainous areas of the zagros and alborz ranges the most seasonally snow dominated areas in iran table 1 presents the records lengths altitudes and the köppen geiger climate types raziei 2022 2017 of these 12 stations precipitation occurrences in these stations are mostly concentrated in the winter raziei 2018 3 methodology 3 1 snowfall frequency calculations for discriminating the phase of snow from the rain at the studied stations daily recorded snow depth and rainfall amount greater than 0 1 cm and 0 1 mm respectively were considered as indicators for categorizing the days as rainy or snowy day accordingly each day is flagged as rainy if it recorded 0 1 mm or more of rain or as snowy day if it recorded 0 1 cm or more of snow depth when both snow depth and rainfall are reported simultaneously for a given day that day is flagged as the day with both rainfall and snowfall occurrences subsequently the frequency of snowfall occurrences as a function of air temperature was computed for the selected stations by counting the number of days with recorded snow depth and rainfall amount greater than 0 1 cm and 0 1 mm respectively that occurred in each 0 5 c air temperature bin and dividing the number of days with recorded snowfall events by the total number of days with snowfall and rainfall events in that bin auer 1974 dai 2008 jennings et al 2018 for example if there were 100 days with recorded snowfall and rainfall observations from 0 5 c to 1 0 c air temperature bin 75 of which were snow the snowfall frequency in that bin would be 75 jenings et al 2018 it is worth noting that here only the frequency of snowfall occurrences is considered without taking into consideration the magnitude of snow that fell on the ground on the considered days considering that the frequency of snowfall may be interpreted as the probability or ratio of snow when precipitation occurs dai 2008 this study uses these three terminologies interchangeably since the magnitude of air temperature interval affects the dispersion of the cloud of points over the curve line the frequency of snowfall functioned on mean daily air temperature was binned by 0 1 c and 0 5 c intervals to examine which interval is more suited to form the sigmoidal s shape curve 3 2 the proposed precipitation phase separation model given the boolean nature of classifying daily precipitation as snow or rain the binary logistic regression can be used for precipitation phase discrimination as a function of air temperature relative humidity surface air pressure or a combination of two or three of them as implemented by jennings et al 2018 and froidurot et al 2014 logistic regression is a mathematical function that can take any real value and rescale it to values between 0 and 1 and form an s shape curve when plotted as implemented by jennings et al 2018 a univariate binary logistic function conditioned on surface air temperature is defined as eq 1 1 s p 1 1 e a b t where sp is the probability of snow occurring and t is the average air temperature in degrees celsius lastly a and b are the model coefficients optimized using a generalized linear model jennings et al 2018 eq 1 produces a sigmoid logistic curve that starts with a slower linear growth followed by exponential growth which then slows to a stable rate lipovetsky 2010 eq 1 represents a sigmoidal pattern with an inflection point often observed at the phase transition however if the transition changes from continuous to discontinuous at the inflection point the inflection point may correspond to the critical point navarro verdugo et al 2011 such a sigmodal pattern can be better described by a function proposed by boltzmann 1879 derived based on the general form of the logistic sigmoidal equation as presented in eq 2 the sigmoidal boltzmann equation sbe has a single inflection point 2 s p s 0 s max s 0 a exp t x 0 k 1 in equation 2 sp is the snow probability and t is the average air temperature in degrees celsius s0 and smax are the left and right asymptotes of sp the smallest and largest values of sp respectively and x0 is the center point that returns the mean of s0 and smax k is a constant period of the independent variable that determines the rising profile or decrease from s0 to smax for a high k the increase is slow while for low k the increase is quick parameter a is used to adjust the position of the critical value for the geometric location of the transition if a set to 1 the critical value is located in the middle of the transition as in the case of the logistic function eq 1 alternatively if a 1 the critical value of the phase transition is located in the vicinity of the middle point navarro verdugo et al 2011 the equation therefore basically deals with the flipping of a parameter from an original state state of s0 to a final state state of smax through the transition factor x0 the distance from s0 to smax which shows the gradient of changes in the curve is called the slope factor navarro verdugo et al 2011 however as experienced in this study many snow frequency data series do not fit the single sigmoid functions like the logistic regression eq 1 and sbe eq 2 characterized by a monotonic behavior and a single inflection point therefore it is expected that a double logistic function featured by a more prolonged flat area in the central part of the curve better describes such data lipovetsky 2010 the single logistic regression eq 1 is usually defined by a parameter of the center which determines the inflection point a parameter of the rate of change and the lower and upper asymptotic levels whereas as defined in eq 3 its double sigmoid version which is constructed by summing two different single logistic regressions has two parameters for their two centers two parameters of the rates and three parameters of the lower middle and upper levels lipovetsky 2010 3 s p s 0 s max p 1 exp a 1 b 1 t 1 1 p 1 exp a 2 b 2 t 1 in eq 3 the parameters sp t s0 and smax are the same as those in eq 2 p is the fraction of the curve comprising phase 1 and 1 p is the fraction of the curve comprising phase 2 at point p the curve consists of two phases with phase 1 at points smaller than p and 1 p is the other part of the curve which contains points greater than p the parameters a1 a2 b1 and b2 are the model coefficients a and b as in eq 1 but for the two parts of the equation likewise as presented in eq 4 a double sigmoidal boltzmann equation dsbe can be constructed by summing the sbe equation eq 2 with itself 4 s p s 0 s max p a exp t x 1 k 1 1 1 p a exp t x 2 k 2 1 most of the parameters of eq 4 are the same as those in eq 3 however k1 and k2 in eq 4 called the slope factors are fixed distances controlling the rise of phases 1 and 2 x1 and x2 are also the center points of the two curves created in phases 1 and 2 fig 2 graphically illustrates the double boltzmann function and its parameters though the performance of the sbe double logistic and dsbe models for snow phase separation has been examined however for the sake of brevity the full comparative analysis with the existing models is carried out only for the most promising one furthermore to ensure that the parameters of the most promising model are stable and the associated results are robust a split sample exercise that is a standard approach in hydrologic applications was performed on this function for this purpose 70 of the data records of each station were randomly selected and used for the calibration of the proposed model then the estimated parameters of the model applied in the calibration experiment were used to fit the model to the other 30 subset of the data to validate the model the snow depth frequencies estimated by the proposed model for the calibration and validation periods were then compared with observation using r2 and rmse indicators as described in section 3 4 3 3 comparison of the proposed model with the existing models to evaluate the accuracy of the proposed model in precipitation phase estimation in the studied stations the frequency of snowfall occurrences as a function of air temperature identified by the proposed model was compared with the frequency of snowfall occurrences observed at each station as well as with those determined by the available precipitation phase separation methods described in table 2 the air temperature thresholds identified by the proposed model at the studied stations were also compared with those determined by other available methods as in table 2 in the static method precipitation on days whose average daily air temperature is less greater than a certain air temperature threshold is considered snow rain the linear transformation method of mccabe wolock 1999 also uses the average air temperature as the precipitation phase discrimination threshold in contrast the method of leavesley et al 1983 uses the minimum and maximum air temperatures to discriminate the phase of snow from rain while the sigmoidal method of kienzle 2008 forms an s curve using two air temperature thresholds the methods of liu et al 2016 and dai 2008 construct the s curve without needing to determine the air temperature threshold in table 2 sp is the frequency of snow t is the average daily air temperature ts is the air temperature threshold at which 50 of precipitation is snow rain tmax and tmin are the maximum and minimum daily air temperatures respectively train tsnow is the air temperature threshold above which below which precipitation events fall in the form of rain snow and trang is the range of air temperature values in which the occurrence of both snow and rain is equivalently probable the parameters a b c and d in the models of liu et al 2016 and or dai 2008 are also the constant coefficients determined by the regression models for more details on these methods the readers are referred to liu et al 2016 and harpold et al 2017 the parameters of the sigmoidal models of dai 2008 and liu et al 2016 as well as the ts and trang thresholds of the method of kienzle 2008 are estimated from the frequency of observed snowfall events therefore the estimated train and tsnow thresholds by such models can be compared with the train and tsnow thresholds derived directly from the observed frequency of snowfalls at each station 3 4 accuracy assessment of the models the comparison between the proposed model and the existing models regarding the estimation of the frequency of snowfall occurrences as well as the air temperature thresholds are made using the taylor diagram taylor 2001 as well as the r2 and rmse performance indicators that are calculated using equations 5 and 6 since the range of snowfall frequency values varies from 0 0 to 1 0 the rmse unit is thus dimensionless however in the text it is multiplied by 100 and referred to as percentages for a better understanding 5 r 2 i n s obs s obs s est s est 2 i n s obs s obs 2 i n s est s est 2 6 r m s e i n s o b s s o b s s e s t s e s t n in equations 5 and 6 sobs and sest are the observed and predicted daily snowfall frequency respectively s o b s and s e s t are the averages of the observed and predicted snowfall frequency and n is the number of data days it is worth mentioning that we have used r2 rather than r statistic since the values of the latter statistic approach unity in most of the stations but the wider range of values of the r2 statistic makes it more suitable than r for the comparative analysis in this study 4 results 4 1 performance of precipitation phase separation methods for discrimination of the phase of precipitation at the studied stations the frequency of snowfall occurrences as a function of mean daily air temperature was binned by 0 1 c and 0 5 c intervals to form the sigmoidal s shape curve the results showed that the 0 5 c air temperature interval is more suitable for stations with longer snow depth records or where snowfall occurrence is more frequent on the contrary the 0 1 c interval is more appropriate for stations where the frequency of snowfall occurrence is low or their snow depth data records are short we have tested the sbe model eq 2 and both double sigmoid functions eqs 3 and 4 in all the studied stations and found that the double sigmoid functions fit well the observed frequency of snowfall occurrences at all the stations this is because they have two inflection points that make them more flexible to fit the data better than the single sigmoid functions eqs 1 and 2 as presented in supplementary table 1 the r2 rmse statistic for the sbe model is lower higher than that for both the dsbe and logistic logistic functions in all studied stations though the r2 and rmse statistics of both double logistic functions are relatively the same in all stations the dsbe shows slightly higher r2 and lower rmse values in some of the stations performing a split sample exercise on the dsbe function also ensured the stability of the parameters of the dsbe model and the robustness of the associated results therefore in the present study only the ability of the dsbe function to model the frequency of snowfall as a function of daily air temperature has been investigated and presented as it showed a slightly better performance than the logistic logistic function in all studied stations fig 3 compares the frequency of snowfall occurrences estimated by the dsbe model against the observed snowfall occurrences in the studied stations for both calibration and validation subsets as noted in the figure the r2 and rmse values for the calibration subset are on average 0 983 and 4 7 respectively indicating a strong association between the estimated and observed values which is an indication of the strong performance of the dsbe model in accurately estimating what observed in the stations such statistics are 0 960 and 7 5 for the validation subset which is comparable with those for the calibration subset the comparable metrics of the calibration and validation experiments indicate that the characteristics of the two experiments are not vastly different from each other suggesting that the parameters of the two experiments are stable and the corresponding results are robust 4 2 comparative analysis of the double boltzmann sigmoidal method and other existing models fig 4 shows how the dsbe model fits the frequency of the observed snowfall occurrences in the selected stations with the estimated parameters of the fitted model shown in supplementary table 2 the dsbe model fits the observed snowfall occurrences of the stations better than the other available models see supplementary fig 1 as depicted the models of motoyama 1990 and yang et al 1997 fit the worst which was expected a priori as they only predict the air temperatures at which the probability of snowfall is either zero or 100 and do not comment on the air temperatures at which a mixture of snow and rain can occur simultaneously the supplementary table 3 also presents the computed rmse and r2 statistics between the observed and estimated frequency of snowfall occurrences by dsbe and the available models as seen the rmse of the models ranges between zero and 60 across the stations while their r2 varies between zero and one with the lowest rmse value less than 5 6 among the models the r2 of the dsbe model is higher than 0 98 in all the stations this shows the highest correspondence between the observed frequency of snowfall occurrences and the fitted curve of the dsbe model at the selected stations as compared to other available models given the better fit of the dsbe model to the frequency of snowfall in the selected stations supplementary fig 1 it can be concluded that the dsbe model is better suited for snow phase estimation in the studied stations to graphically illustrate the performance of the dsbe model in phase partitioning of precipitation at the studied stations the taylor diagram depicted in fig 5 further compares the frequency of snowfall predicted by the dsbe and other existing models with the frequency of observed snowfall occurrences at the studied stations according to fig 5 the accuracy of the models of motoyama 1990 and yang et al 1997 in precipitation phase estimation is poor in all the stations since they use only a single air temperature threshold to partition precipitation occurrences into rain or snow however the performance of the models of mccabe wolock 1999 and leavesley et al 1983 that are based on air temperature thresholds of train tsnow and ts respectively are comparable with those estimated by the sigmoidal models of kienzle 2008 liu et al 2016 and dai 2008 in all the stations as depicted the dsbe model outperforms all other existing models considering that its r and rmsd values are above 0 99 and below 0 05 respectively as compared to observation the r and rmsd values of the sigmoidal methods of keinzel 2008 liu et al 2016 and dai 2008 are also comparable to those of the dsbe in some of the stations this is because the air temperature thresholds required for fitting the models of liu et al 2016 and dai 2008 and the ts threshold of the model of kienzle 2008 are directly derived from the stations observations therefore based on the taylor diagrams it can be concluded that the better precipitation phase estimation of the dsbe model in the selected stations is due to its flexibility in fitting the observed frequency of the snowfall occurrences in the stations as described in the methodology section the r2 and rmse indicators that measure the association between the observed frequency of snowfall occurrences with those estimated by the used models also reveal the better performance of the dsbe model in precipitation phase discrimination in all studied stations supplementary table 3 as demonstrated in fig 4 the dsbe model fitted to the frequency of the observed snowfall occurrences of the stations allows determining train tsnow and ts air temperature thresholds for considered stations however the analysis performed in this study shows that since the dsbe model often does not fit well the upper tail of the curve it is better to set train at 95 rather than the 100 probability when using this model setting the train at the air temperature at 95 rather than 100 of precipitation falling as rain makes a more accurate train estimation by the model in all the studied stations contrarily the dsbe model has the best performance in determining tsnow at 100 probability the tsnow threshold determined with this model has also the least difference from the tsnow threshold obtained from the observational data the taylor diagrams in fig 6 compare the air temperature thresholds determined by the dsbe model against those estimated by the other existing models and those directly derived from the observed frequency of snowfall occurrences of the selected stations fig 6a and 6b respectively show the train and tsnow air temperature thresholds determined by the models for the selected stations according to fig 6a the model of mccabe wolock 1999 is the best performer in estimating the train threshold in all the stations since it uses exactly the train threshold derived from the observations therefore by discarding the model of mccabe wolock 1999 the dsbe and die 2010 models are respectively the first and 2nd best performers in accurately estimating train in the studied stations as depicted in fig 6b the tsnow threshold estimated by the model of motoyama 1990 exactly coincides with the tsnow threshold derived from the observations this happens because the model of motoyama 1990 exactly uses the tsnow of observation therefore if we discard this model the models of dsbe dai 2008 and kienzle 2008 are respectively the first second and third best performers in estimating the tsnow air temperature threshold in the studied stations according to fig 6c the model of kienzle 2008 is the best performer in estimating ts followed by the models of dsbe and dai 2008 however the model of kienzle 2008 does not estimate the ts but derives it from the observation therefore the dsbe can be considered the best performer in estimating ts in the studied stations since the models of motoyama 1990 and yang et al 1997 have only one air temperature threshold they were not presented in fig 6c since they could not estimate ts for the stations the taylor diagrams of fig 6 imply that the dsbe model performs best in accurately estimating train tsnow and ts thresholds in all the stations in all the stations the air temperature thresholds estimated by the dsbe model are comparable to those determined by the model of dai 2008 but with slightly higher r and lower rmsd values this indicates that the dsbe model surpasses all the existing models in estimating the air temperature thresholds in all studied stations considering that the outputs of precipitation phase discrimination models are mainly used for snow depth estimation by hydrological models herein the estimated snow depth by the dbse model and the existing models are compared with the observed snow depth at the studied stations to validate the performance of dsbe model in hydrological applications for this purpose only the models of liu et al 2016 and dai 2010 were used in the comparison since they performed comparably well with the dsbe model in estimating air temperature thresholds and the frequency of snowfall occurrences to convert daily precipitation records to snow depth according to the frequencies determined by the considered models precipitation of a given day was set to be all snow when its average daily air temperature was tsnow and rain when it was train the taylor diagrams of fig 7 that compare the snow depth estimated by the dsbe model and the models of liu et al 2016 and dai 2010 with the snow depth measured at the studied stations suggest a comparable performance of the considered models in all stations the diagrams also indicate that the estimated snow depth by the three models is close to the observed snow depth of the stations however in stations like ardabil sarab kamiaran and saqez the dsbe model perform slightly better than the models of liu et al 2016 and dai 2010 5 discussion and conclusion we have analyzed 50 years 1970 2020 of daily precipitation snow depth and air temperature records from 12 synoptic stations scattered over the mountainous areas of west and north of iran and proposed a double sigmoidal function i e a dsbe model for determining the air temperature thresholds required for partitioning precipitation occurrences into rain and snow phases comparing the frequency of snowfall events estimated by the dsbe model and several other existing models with the frequency of snowfall events observed in the studied stations showed that the dsbe model fits the frequency of observed snowfall occurrences better than the existing models this is because the dsbe model better fitted the extremes of the upper tail of the frequency of snowfall occurrences than the other existing functions which is related to the effect of its parameter a which can take any value close to 1 as opposed to the logistic logistic function that fixed it to 1 supplementary table 1 this makes dsbe more flexible than other functions and even the logistic logistic function to fit the extremes of the frequency of snowfall events at the studied stations on the contrary the other existing models may over or under estimate the probability of snowfall occurrences at extremely lower air temperatures due to not fitting properly to the upper tail of the curve of the cloud of observed snowfall occurrences supplementary fig 1 the average of the r2 statistic computed between the frequency of snowfall occurrences estimated by the proposed model and the frequency of snowfall events observed at the studied stations was the highest 0 989 among the models while its average error was the lowest 4 the dsbe model also performs the best in accurately estimating train tsnow and ts air temperature thresholds in all studied stations suggesting the supremacy of the proposed model for snow rain phase discrimination and estimating the air temperature thresholds in all stations however it was found that the tsnow considerably varies between the studied stations this is because tsnow is highly sensitive to variations in air humidity and air temperature that are heavily dependent on the topographical and geographical features of the locations particularly atmospheric humidity affects the energy budget of falling hydrometeors harporld et al 2018 this indicates that the determination of air temperature thresholds required for precipitation phase separation at any location is a location specific issue and therefore must be calculated with the snowfall observations from that location using a proper method such as the dsbe model that showed better performance than other existing models the dsbe model also provides a closer snow depth estimation to the snow depth observations of the studied stations when compared to the other available models examining the snowfall frequency versus air temperature bins at the studied stations suggests that snowfall occurrences in the mountainous areas of iran can occur over a wide range of mean daily air temperatures this may partly be attributed to the continental climate of iran which is mostly characterized by dry and semi dry climates raziei 2022 2017 as well as the high elevation of some of the studied stations which leads to more snowfall occurrences at higher air temperatures in sites with drier climates or higher elevation jennings et al 2018 this is because the snowflakes fall faster in the thin air of the mountains and reach the ground at higher air temperatures before melting dai 2008 similarly rain occurs in a wide range of air temperature bins at the studied stations partly because in many cases the snowflakes reach near the surface at negative air temperatures but quickly melt and turn into liquid form due to warmer air temperatures at the surface dai 2008 global warming has accelerated this phenomenon in the last decades particularly in the stations located in the urban areas that are heavily affected by urban heat islands the ts threshold determined by the dsbe model varies from 1 to 2 c across the stations which is consistent with the results obtained for other parts of the world for example auer 1974 dai 2008 kienzle 2008 g liu 2008 lynch stieglitz 1994 motoyama 1990 yang et al 1997 the range of ts estimated for the studied stations is also in concordance with the range of ts simulated by jennings et al 2018 for the mountainous areas of western and northern iran the slightly higher ts values estimated for some of the studied stations can partly be attributed to the drier climate of such stations which is in agreement with the general belief that the continental areas and mountain ranges generally exhibit the warmest ts threshold jennings et al 2018 though the stations used for the analysis have different climate types and geographical features table 1 however we did not find a significant association between any air temperature thresholds and the geographical coordination of the sites which may be related to the limited number of stations used in this study the snow rain phase discrimination presented in this study is solely based on mean daily air temperature as the main predictor however some authors found better results when using a combination of air temperature and relative humidity as predictors for snow rain phase separation froidurot et al 2014 jennings et al 2018 moreover the present study has used daily precipitation and air temperature data for precipitation phase discrimination because of their availability for the studied stations however since most of the precipitation occurrences in the study area have a short duration the results achieved in this study may be improved when a set of sub daily records of such climate variables are used this is because many short duration snowfall events may be misclassified as rain when daily data are used for precipitation phase discrimination for example the snow that fell on the ground during a short term snowfall event in the morning of a day may melt a few hours later when the air temperature gets warmer such snowfalls may thus be misclassified as rain rather than snow when using daily data therefore since the diurnal air temperature range in the study area is very wide a more accurate precipitation phase discrimination can be achieved with a set of sub daily records of such climate variables this is in agreement with kongoli bland 2000 and feiccabrino lundberg 2008 who stated that the phase of precipitation usually changes over a short period of a day therefore using a higher temporal resolution of data records could reduce the amount of mixed precipitation induced by the rapid diurnal changes in the air temperature or the occurrence of rain on snow both of which quickly melt the snow accumulated over the ground marks et al 2013 though precipitation phase discrimination is a useful tool for correcting precipitation gauge data for wind undercatch marks et al 2013 however blowing away snow particularly the dry snow from the snow pillow by winds may also cause an underestimation in snow measurement that in turn may lead to a bias in precipitation phase discrimination these could be the topics for future studies to examine whether utilizing air temperature and relative humidity as the joint input predictors of the dsbe model improves the precipitation phase separation and the related air temperature thresholds identified herein particularly when sub daily data records are used 6 declarations funding no funding availability of data and materials please contact the corresponding author for data requests code availability please contact the corresponding author for code requests ethics approval not applicable consent to participate not applicable consent for publication not applicable credit authorship contribution statement firooze hashemireza methodology software formal analysis data curation writing original draft ahmad sharafati conceptualization investigation validation tayeb raziei supervision methodology validation writing review editing sara nazif visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to reveal their gratitude and appreciation to the data provider the iranian meteorological organization the authors also sincerely thank the editor and anonymous reviewers for their constructive recommendations suggestions that substantially improved the quality of the paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129153 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 auer 1974 auer a h 1974 the rain versus snow threshold temperatures weatherwise 27 67 67 https doi org 10 1080 00431672 1974 9931684 dai 2008 dai a 2008 temperature and pressure dependence of the rain snow phase transition over land and ocean 35 1 7 https doi org 10 1029 2008gl033295 fassnacht and soulis 2002 s r fassnacht e d soulis implications during transitional periods of improvements to the snow processes in the land surface scheme hydrological model watclass atmos ocean 40 2002 389 403 10 3137 ao 400402 fassnacht s r soulis e d 2002 implications during transitional periods of improvements to the snow processes in the land surface scheme hydrological model watclass atmos ocean 40 389 403 https doi org 10 3137 ao 400402 feiccabrino and lundberg 2008 j feiccabrino a lundberg precipitation phase discrimination in sweden 65th east 2008 snow conf 239 254 feiccabrino j lundberg a 2008 precipitation phase discrimination in sweden 65th east snow conf 239 254 froidurot et al 2014 s froidurot i zin b hingray a gautheron sensitivity of precipitation phase over the swiss alps to different meteorological variables j hydrometeorol 15 2014 685 696 10 1175 jhm d 13 073 1 froidurot s zin i hingray b gautheron a 2014 sensitivity of precipitation phase over the swiss alps to different meteorological variables j hydrometeorol 15 685 696 https doi org 10 1175 jhm d 13 073 1 harpold et al 2017 a a harpold m l kaplan p zion klos t link j p mcnamara s rajagopal r schumer c m steele rain or snow hydrologic processes observations prediction and research needs hydrol earth syst sci 21 2017 1 22 10 5194 hess 21 1 2017 harpold a a kaplan m l zion klos p link t mcnamara j p rajagopal s schumer r steele c m 2017 rain or snow hydrologic processes observations prediction and research needs hydrol earth syst sci 21 1 22 https doi org 10 5194 hess 21 1 2017 hay and mccabe 2010 l e hay g j mccabe hydrologic effects of climate change in the yukon river basin clim change 100 3 4 2010 509 523 hay l e mccabe g j 2010 hydrologic effects of climate change in the yukon river basin 509 523 https doi org 10 1007 s10584 010 9805 x jennings et al 2018 k s jennings t s winchell b livneh n p molotch spatial variation of the rain snow temperature threshold across the northern hemisphere nat commun 9 2018 10 1038 s41467 018 03629 7 jennings k s winchell t s livneh b molotch n p 2018 spatial variation of the rain snow temperature threshold across the northern hemisphere nat commun 9 https doi org 10 1038 s41467 018 03629 7 kienzle 2008 kienzle s w 2008 a new temperature based method to separate rain and snow 5085 5067 5085 https doi org 10 1002 hyp kongoli and bland 2000 c e kongoli w l bland long term snow depth simulations using a modified atmosphere land exchange model agric for meteorol 104 2000 273 287 10 1016 s0168 1923 00 00169 6 kongoli c e bland w l 2000 long term snow depth simulations using a modified atmosphere land exchange model agric for meteorol 104 273 287 https doi org 10 1016 s0168 1923 00 00169 6 leavesley et al 1983 g h leavesley r w lichty b m troutman l g saindon precipitation runoff modeling system user s manual water resources investigations report 1983 10 3133 wri834238 leavesley g h lichty r w troutman b m saindon l g 1983 precipitation runoff modeling system user s manual water resources investigations report https doi org 10 3133 wri834238 lipovetsky 2010 s lipovetsky double logistic curve in regression modeling j appl stat 37 2010 1785 1793 10 1080 02664760903093633 lipovetsky s 2010 double logistic curve in regression modeling j appl stat 37 1785 1793 https doi org 10 1080 02664760903093633 liu 2008 g liu deriving snow cloud characteristics from cloudsat observations j geophys res 113 2008 10 1029 2007jd009766 liu g 2008 deriving snow cloud characteristics from cloudsat observations j geophys res 113 0 09 https doi org 10 1029 2007jd009766 liu et al 2016 s liu d yan t qin b weng y lu precipitation phase separation schemes in the naqu river basin eastern tibetan plateau theor appl climatol 2016 10 1007 s00704 016 1967 7 liu s yan d qin t weng b lu y 2016 precipitation phase separation schemes in the naqu river basin eastern tibetan plateau theor appl climatol https doi org 10 1007 s00704 016 1967 7 lynch stieglitz 1994 m lynch stieglitz the development and validation of a simple snow model for the giss gcm j clim 7 1994 1842 1855 10 1175 1520 0442 1994 007 1842 tdavoa 2 0 co 2 lynch stieglitz m 1994 the development and validation of a simple snow model for the giss gcm j clim 7 1842 1855 https doi org 10 1175 1520 0442 1994 007 1842 tdavoa 2 0 co 2 maidment 1992 maidment 1992 d r maidment handbook of hydrology mcgraw hill inc new york 1992 p 1992 
2337,this paper presents the use of a double sigmoidal model for precipitation phase partitioning in mountains for the model development and evaluation daily rainfall minimum and maximum air temperatures and snow depth data from twelve synoptic stations in the mountainous regions of iran are used the model performance is compared against six air temperature based methods using the taylor diagram the coefficient of determination r2 and the root mean square error rmse performance indicators comparing the frequency of snowfall events estimated by the proposed model with those of the existing models and observation at the selected stations showed better performance of the proposed model in precipitation phase discrimination at the studied stations the average r2 statistic that relates the frequency of snowfall occurrences estimated by the proposed model with the frequency of snowfall events observed at the studied stations is 0 989 which is the highest compared to other available models its average error across the stations is 4 the lowest among the examined models a split sample approach was used to ensure that the parameters of the proposed model are appropriately estimated the result showed that the r2 and rmse values of both calibration and validation subsets are not vastly different from each other suggesting that the parameters of the two experiments are stable and the corresponding results are robust the proposed model also performs better than other existing models in accurately estimating air temperature thresholds required for precipitation phase discrimination as well as the snow depth data in all studied stations keywords snow rain phase logistic function air temperature threshold logistic logistic double sigmoidal boltzmann model data availability data will be made available on request 1 introduction the phase of precipitation that reaches the ground is a first order driver of hydrologic processes in a watershed as it affects the initial and boundary conditions that drive hydrological models harpold et al 2017 therefore knowledge of the frequency of snowfall in a region is essential since it is a vital source and key parameter in hydrological studies and water resources management in areas where snowfall has a large contribution to total precipitation maidment 1992 without correctly estimating the proportion or percentage of snow to the total precipitation especially the identification of the rain snow phase separation in the mountainous areas managing water resources and reservoirs and planning for water resources and rivers is impossible the methods for discriminating solid from liquid precipitation are often based on near surface air temperature thresholds including static linear transformation the minimum and maximum air temperature and the sigmoidal curve approaches harpold et al 2017 however there are limitations in using air temperature based static methods for snow rain phase separation some researchers showed that the temperature thresholds used for separating snow from rain could vary from place to place thus the thresholds should be determined for each location using local daily weather data matsuo et al 1981 u s army corps of engineers 1956 furthermore the range of the two critical air temperature thresholds required for the linear transformation method is wide and unbounded dai 2008 fassnacht and soulis 2002 hay and mccabe 2010 wigmosta et al 1994 nonetheless for the precipitation phase estimation required for hydrological modeling many hydrological practitioners use a fixed spatially uniform air temperature threshold and or a range between two air temperatures in which a mix of rain and snow can occur jennings et al 2018 this may lead to significant biases in estimating snow water equivalent swe snow depth and snow cover duration at both the point and basin scale which can subsequently propagate into errors in streamflow land surface albedo and surface atmosphere energy exchange jennings et al 2018 this indicates that the static method is not applicable universally and it is necessary to conduct more research to determine the appropriate station s specific values of the critical air temperature thresholds kienzle 2008 has proposed a sigmoidal curve method for estimating the frequency of snowfall events as a function of air temperature this sigmoidal curve that requires two parameters for precipitation phase discrimination fits a linear regression to the frequency of observed snowfall events conditioned on the daily air temperature the first parameter of this sigmoid function is the average daily air temperature threshold at which 50 of precipitation is considered snow and the second is the air temperature range at which precipitation can occur as a mixture of snow and rain similarly by experimental analysis of observed snowfall and air temperature records of 15 000 stations scattered over the globe for the 1997 2007 period dai 2008 has presented a hyperbolic tangent function to separate the snow phase from the rain he determined the snow rain phase separation air temperature between 2 to 4 c for the low land areas and between 3 to 6 c for the oceans liu et al 2016 also introduced another s curve based method to separate the phase of snowfall from rainfall using the frequency of observed snowfall data from 6 scattered stations in the naqu river basin china all the aforementioned sigmoidal methods estimate the type of precipitation of a given day by creating a conditional relationship between the frequency of observed rainfall snowfall events and air temperature at a daily or hourly time scale simplicity in the calculation and easy access to the meteorological data required for their calculation are the main advantages of these models given the binary nature of the examined data for discriminating the phase of snow from rain previous studies have used different forms of logistic function to predict the frequency of snow rain occurrences these sigmoidal functions can take any real value and map the snowfall frequencies between 0 and 1 over an s shaped curve however our experiments in iran show that such single sigmoidal models do not fit well with the frequency of snowfall in most of the stations examined in this study more specifically the available single sigmoid functions do not fit the most extreme values of the upper and lower tails of the s shaped distribution of the snowfall frequency of most of the stations thus it is assumed that such a snowfall frequency time series can be better described by a double sigmoid function that is formed from the sum of two different singular sigmoid functions i e logistic logistic logistic gompertz and gompertz gompertz lipovetsky 2010 shabani et al 2018 according to the literature the approaches introduced for snow rain phase separation dai 2008 kienzle 2008 liu et al 2016 are almost single sigmoidal functions and the double sigmoidal functions have not been yet examined therefore among the double sigmoid functions this study examines the performance of the logistic logistic and the double sigmoidal boltzmann equation dsbe to discriminate the phase of snowfall from rainfall in the mountainous areas of iran since the logistic logistic and dsbe models have two inflection points for two consecutive growth stages they are expected to fit better the frequency of snowfall in the studied stations considering that they are more flexible to fit the curvy pattern of the examined data thus the present study attempts to 1 evaluate the performance of double sigmoidal functions in fitting the frequency of snowfall occurrences in the studied stations 2 the calibration of the parameters of the proposed models using a split sample approach that is a standard in hydrologic applications and 3 comparison of the results with observation and the results of other existing snow rain partitioning methods the data used for the analysis is described in section 2 while a detailed description of the snow rain phase separation models including the proposed models and the performance metrics used for the performance evaluation of the models is presented in section 3 the result of the study is presented in section 4 followed by a discussion and conclusion in section 5 2 data for implementing this study that was performed in snow dominated mountainous areas of iran the daily snow depth minimum maximum and average air temperatures and precipitation data of the synoptic and climatological stations of the meteorological organization of iran irimo were acquired and used for the analysis as depicted in fig 1 the total number of irimo stations where snowfall is probable in winter is 417 most of them distributed over western and northern iran from these stations 281 stations were removed from the analysis due to either lacking the snow depth records 191 stations or having suspected data 90 stations the latter group of stations was excluded because they did not properly flag the days with snowfall occurrences or had an insufficient number of snowy days for the analysis therefore the remaining 136 synoptic stations with a relatively adequate number of records of snowy days were selected for snow rain phase separation calculation from these 136 stations only 12 stations with the most reliable and lengthier snow depth data records i e the higher number of snow depth observations were selected for the analysis the selected stations have the lengthiest snow season because they are located at the higher elevations of the mountainous areas of the zagros and alborz ranges the most seasonally snow dominated areas in iran table 1 presents the records lengths altitudes and the köppen geiger climate types raziei 2022 2017 of these 12 stations precipitation occurrences in these stations are mostly concentrated in the winter raziei 2018 3 methodology 3 1 snowfall frequency calculations for discriminating the phase of snow from the rain at the studied stations daily recorded snow depth and rainfall amount greater than 0 1 cm and 0 1 mm respectively were considered as indicators for categorizing the days as rainy or snowy day accordingly each day is flagged as rainy if it recorded 0 1 mm or more of rain or as snowy day if it recorded 0 1 cm or more of snow depth when both snow depth and rainfall are reported simultaneously for a given day that day is flagged as the day with both rainfall and snowfall occurrences subsequently the frequency of snowfall occurrences as a function of air temperature was computed for the selected stations by counting the number of days with recorded snow depth and rainfall amount greater than 0 1 cm and 0 1 mm respectively that occurred in each 0 5 c air temperature bin and dividing the number of days with recorded snowfall events by the total number of days with snowfall and rainfall events in that bin auer 1974 dai 2008 jennings et al 2018 for example if there were 100 days with recorded snowfall and rainfall observations from 0 5 c to 1 0 c air temperature bin 75 of which were snow the snowfall frequency in that bin would be 75 jenings et al 2018 it is worth noting that here only the frequency of snowfall occurrences is considered without taking into consideration the magnitude of snow that fell on the ground on the considered days considering that the frequency of snowfall may be interpreted as the probability or ratio of snow when precipitation occurs dai 2008 this study uses these three terminologies interchangeably since the magnitude of air temperature interval affects the dispersion of the cloud of points over the curve line the frequency of snowfall functioned on mean daily air temperature was binned by 0 1 c and 0 5 c intervals to examine which interval is more suited to form the sigmoidal s shape curve 3 2 the proposed precipitation phase separation model given the boolean nature of classifying daily precipitation as snow or rain the binary logistic regression can be used for precipitation phase discrimination as a function of air temperature relative humidity surface air pressure or a combination of two or three of them as implemented by jennings et al 2018 and froidurot et al 2014 logistic regression is a mathematical function that can take any real value and rescale it to values between 0 and 1 and form an s shape curve when plotted as implemented by jennings et al 2018 a univariate binary logistic function conditioned on surface air temperature is defined as eq 1 1 s p 1 1 e a b t where sp is the probability of snow occurring and t is the average air temperature in degrees celsius lastly a and b are the model coefficients optimized using a generalized linear model jennings et al 2018 eq 1 produces a sigmoid logistic curve that starts with a slower linear growth followed by exponential growth which then slows to a stable rate lipovetsky 2010 eq 1 represents a sigmoidal pattern with an inflection point often observed at the phase transition however if the transition changes from continuous to discontinuous at the inflection point the inflection point may correspond to the critical point navarro verdugo et al 2011 such a sigmodal pattern can be better described by a function proposed by boltzmann 1879 derived based on the general form of the logistic sigmoidal equation as presented in eq 2 the sigmoidal boltzmann equation sbe has a single inflection point 2 s p s 0 s max s 0 a exp t x 0 k 1 in equation 2 sp is the snow probability and t is the average air temperature in degrees celsius s0 and smax are the left and right asymptotes of sp the smallest and largest values of sp respectively and x0 is the center point that returns the mean of s0 and smax k is a constant period of the independent variable that determines the rising profile or decrease from s0 to smax for a high k the increase is slow while for low k the increase is quick parameter a is used to adjust the position of the critical value for the geometric location of the transition if a set to 1 the critical value is located in the middle of the transition as in the case of the logistic function eq 1 alternatively if a 1 the critical value of the phase transition is located in the vicinity of the middle point navarro verdugo et al 2011 the equation therefore basically deals with the flipping of a parameter from an original state state of s0 to a final state state of smax through the transition factor x0 the distance from s0 to smax which shows the gradient of changes in the curve is called the slope factor navarro verdugo et al 2011 however as experienced in this study many snow frequency data series do not fit the single sigmoid functions like the logistic regression eq 1 and sbe eq 2 characterized by a monotonic behavior and a single inflection point therefore it is expected that a double logistic function featured by a more prolonged flat area in the central part of the curve better describes such data lipovetsky 2010 the single logistic regression eq 1 is usually defined by a parameter of the center which determines the inflection point a parameter of the rate of change and the lower and upper asymptotic levels whereas as defined in eq 3 its double sigmoid version which is constructed by summing two different single logistic regressions has two parameters for their two centers two parameters of the rates and three parameters of the lower middle and upper levels lipovetsky 2010 3 s p s 0 s max p 1 exp a 1 b 1 t 1 1 p 1 exp a 2 b 2 t 1 in eq 3 the parameters sp t s0 and smax are the same as those in eq 2 p is the fraction of the curve comprising phase 1 and 1 p is the fraction of the curve comprising phase 2 at point p the curve consists of two phases with phase 1 at points smaller than p and 1 p is the other part of the curve which contains points greater than p the parameters a1 a2 b1 and b2 are the model coefficients a and b as in eq 1 but for the two parts of the equation likewise as presented in eq 4 a double sigmoidal boltzmann equation dsbe can be constructed by summing the sbe equation eq 2 with itself 4 s p s 0 s max p a exp t x 1 k 1 1 1 p a exp t x 2 k 2 1 most of the parameters of eq 4 are the same as those in eq 3 however k1 and k2 in eq 4 called the slope factors are fixed distances controlling the rise of phases 1 and 2 x1 and x2 are also the center points of the two curves created in phases 1 and 2 fig 2 graphically illustrates the double boltzmann function and its parameters though the performance of the sbe double logistic and dsbe models for snow phase separation has been examined however for the sake of brevity the full comparative analysis with the existing models is carried out only for the most promising one furthermore to ensure that the parameters of the most promising model are stable and the associated results are robust a split sample exercise that is a standard approach in hydrologic applications was performed on this function for this purpose 70 of the data records of each station were randomly selected and used for the calibration of the proposed model then the estimated parameters of the model applied in the calibration experiment were used to fit the model to the other 30 subset of the data to validate the model the snow depth frequencies estimated by the proposed model for the calibration and validation periods were then compared with observation using r2 and rmse indicators as described in section 3 4 3 3 comparison of the proposed model with the existing models to evaluate the accuracy of the proposed model in precipitation phase estimation in the studied stations the frequency of snowfall occurrences as a function of air temperature identified by the proposed model was compared with the frequency of snowfall occurrences observed at each station as well as with those determined by the available precipitation phase separation methods described in table 2 the air temperature thresholds identified by the proposed model at the studied stations were also compared with those determined by other available methods as in table 2 in the static method precipitation on days whose average daily air temperature is less greater than a certain air temperature threshold is considered snow rain the linear transformation method of mccabe wolock 1999 also uses the average air temperature as the precipitation phase discrimination threshold in contrast the method of leavesley et al 1983 uses the minimum and maximum air temperatures to discriminate the phase of snow from rain while the sigmoidal method of kienzle 2008 forms an s curve using two air temperature thresholds the methods of liu et al 2016 and dai 2008 construct the s curve without needing to determine the air temperature threshold in table 2 sp is the frequency of snow t is the average daily air temperature ts is the air temperature threshold at which 50 of precipitation is snow rain tmax and tmin are the maximum and minimum daily air temperatures respectively train tsnow is the air temperature threshold above which below which precipitation events fall in the form of rain snow and trang is the range of air temperature values in which the occurrence of both snow and rain is equivalently probable the parameters a b c and d in the models of liu et al 2016 and or dai 2008 are also the constant coefficients determined by the regression models for more details on these methods the readers are referred to liu et al 2016 and harpold et al 2017 the parameters of the sigmoidal models of dai 2008 and liu et al 2016 as well as the ts and trang thresholds of the method of kienzle 2008 are estimated from the frequency of observed snowfall events therefore the estimated train and tsnow thresholds by such models can be compared with the train and tsnow thresholds derived directly from the observed frequency of snowfalls at each station 3 4 accuracy assessment of the models the comparison between the proposed model and the existing models regarding the estimation of the frequency of snowfall occurrences as well as the air temperature thresholds are made using the taylor diagram taylor 2001 as well as the r2 and rmse performance indicators that are calculated using equations 5 and 6 since the range of snowfall frequency values varies from 0 0 to 1 0 the rmse unit is thus dimensionless however in the text it is multiplied by 100 and referred to as percentages for a better understanding 5 r 2 i n s obs s obs s est s est 2 i n s obs s obs 2 i n s est s est 2 6 r m s e i n s o b s s o b s s e s t s e s t n in equations 5 and 6 sobs and sest are the observed and predicted daily snowfall frequency respectively s o b s and s e s t are the averages of the observed and predicted snowfall frequency and n is the number of data days it is worth mentioning that we have used r2 rather than r statistic since the values of the latter statistic approach unity in most of the stations but the wider range of values of the r2 statistic makes it more suitable than r for the comparative analysis in this study 4 results 4 1 performance of precipitation phase separation methods for discrimination of the phase of precipitation at the studied stations the frequency of snowfall occurrences as a function of mean daily air temperature was binned by 0 1 c and 0 5 c intervals to form the sigmoidal s shape curve the results showed that the 0 5 c air temperature interval is more suitable for stations with longer snow depth records or where snowfall occurrence is more frequent on the contrary the 0 1 c interval is more appropriate for stations where the frequency of snowfall occurrence is low or their snow depth data records are short we have tested the sbe model eq 2 and both double sigmoid functions eqs 3 and 4 in all the studied stations and found that the double sigmoid functions fit well the observed frequency of snowfall occurrences at all the stations this is because they have two inflection points that make them more flexible to fit the data better than the single sigmoid functions eqs 1 and 2 as presented in supplementary table 1 the r2 rmse statistic for the sbe model is lower higher than that for both the dsbe and logistic logistic functions in all studied stations though the r2 and rmse statistics of both double logistic functions are relatively the same in all stations the dsbe shows slightly higher r2 and lower rmse values in some of the stations performing a split sample exercise on the dsbe function also ensured the stability of the parameters of the dsbe model and the robustness of the associated results therefore in the present study only the ability of the dsbe function to model the frequency of snowfall as a function of daily air temperature has been investigated and presented as it showed a slightly better performance than the logistic logistic function in all studied stations fig 3 compares the frequency of snowfall occurrences estimated by the dsbe model against the observed snowfall occurrences in the studied stations for both calibration and validation subsets as noted in the figure the r2 and rmse values for the calibration subset are on average 0 983 and 4 7 respectively indicating a strong association between the estimated and observed values which is an indication of the strong performance of the dsbe model in accurately estimating what observed in the stations such statistics are 0 960 and 7 5 for the validation subset which is comparable with those for the calibration subset the comparable metrics of the calibration and validation experiments indicate that the characteristics of the two experiments are not vastly different from each other suggesting that the parameters of the two experiments are stable and the corresponding results are robust 4 2 comparative analysis of the double boltzmann sigmoidal method and other existing models fig 4 shows how the dsbe model fits the frequency of the observed snowfall occurrences in the selected stations with the estimated parameters of the fitted model shown in supplementary table 2 the dsbe model fits the observed snowfall occurrences of the stations better than the other available models see supplementary fig 1 as depicted the models of motoyama 1990 and yang et al 1997 fit the worst which was expected a priori as they only predict the air temperatures at which the probability of snowfall is either zero or 100 and do not comment on the air temperatures at which a mixture of snow and rain can occur simultaneously the supplementary table 3 also presents the computed rmse and r2 statistics between the observed and estimated frequency of snowfall occurrences by dsbe and the available models as seen the rmse of the models ranges between zero and 60 across the stations while their r2 varies between zero and one with the lowest rmse value less than 5 6 among the models the r2 of the dsbe model is higher than 0 98 in all the stations this shows the highest correspondence between the observed frequency of snowfall occurrences and the fitted curve of the dsbe model at the selected stations as compared to other available models given the better fit of the dsbe model to the frequency of snowfall in the selected stations supplementary fig 1 it can be concluded that the dsbe model is better suited for snow phase estimation in the studied stations to graphically illustrate the performance of the dsbe model in phase partitioning of precipitation at the studied stations the taylor diagram depicted in fig 5 further compares the frequency of snowfall predicted by the dsbe and other existing models with the frequency of observed snowfall occurrences at the studied stations according to fig 5 the accuracy of the models of motoyama 1990 and yang et al 1997 in precipitation phase estimation is poor in all the stations since they use only a single air temperature threshold to partition precipitation occurrences into rain or snow however the performance of the models of mccabe wolock 1999 and leavesley et al 1983 that are based on air temperature thresholds of train tsnow and ts respectively are comparable with those estimated by the sigmoidal models of kienzle 2008 liu et al 2016 and dai 2008 in all the stations as depicted the dsbe model outperforms all other existing models considering that its r and rmsd values are above 0 99 and below 0 05 respectively as compared to observation the r and rmsd values of the sigmoidal methods of keinzel 2008 liu et al 2016 and dai 2008 are also comparable to those of the dsbe in some of the stations this is because the air temperature thresholds required for fitting the models of liu et al 2016 and dai 2008 and the ts threshold of the model of kienzle 2008 are directly derived from the stations observations therefore based on the taylor diagrams it can be concluded that the better precipitation phase estimation of the dsbe model in the selected stations is due to its flexibility in fitting the observed frequency of the snowfall occurrences in the stations as described in the methodology section the r2 and rmse indicators that measure the association between the observed frequency of snowfall occurrences with those estimated by the used models also reveal the better performance of the dsbe model in precipitation phase discrimination in all studied stations supplementary table 3 as demonstrated in fig 4 the dsbe model fitted to the frequency of the observed snowfall occurrences of the stations allows determining train tsnow and ts air temperature thresholds for considered stations however the analysis performed in this study shows that since the dsbe model often does not fit well the upper tail of the curve it is better to set train at 95 rather than the 100 probability when using this model setting the train at the air temperature at 95 rather than 100 of precipitation falling as rain makes a more accurate train estimation by the model in all the studied stations contrarily the dsbe model has the best performance in determining tsnow at 100 probability the tsnow threshold determined with this model has also the least difference from the tsnow threshold obtained from the observational data the taylor diagrams in fig 6 compare the air temperature thresholds determined by the dsbe model against those estimated by the other existing models and those directly derived from the observed frequency of snowfall occurrences of the selected stations fig 6a and 6b respectively show the train and tsnow air temperature thresholds determined by the models for the selected stations according to fig 6a the model of mccabe wolock 1999 is the best performer in estimating the train threshold in all the stations since it uses exactly the train threshold derived from the observations therefore by discarding the model of mccabe wolock 1999 the dsbe and die 2010 models are respectively the first and 2nd best performers in accurately estimating train in the studied stations as depicted in fig 6b the tsnow threshold estimated by the model of motoyama 1990 exactly coincides with the tsnow threshold derived from the observations this happens because the model of motoyama 1990 exactly uses the tsnow of observation therefore if we discard this model the models of dsbe dai 2008 and kienzle 2008 are respectively the first second and third best performers in estimating the tsnow air temperature threshold in the studied stations according to fig 6c the model of kienzle 2008 is the best performer in estimating ts followed by the models of dsbe and dai 2008 however the model of kienzle 2008 does not estimate the ts but derives it from the observation therefore the dsbe can be considered the best performer in estimating ts in the studied stations since the models of motoyama 1990 and yang et al 1997 have only one air temperature threshold they were not presented in fig 6c since they could not estimate ts for the stations the taylor diagrams of fig 6 imply that the dsbe model performs best in accurately estimating train tsnow and ts thresholds in all the stations in all the stations the air temperature thresholds estimated by the dsbe model are comparable to those determined by the model of dai 2008 but with slightly higher r and lower rmsd values this indicates that the dsbe model surpasses all the existing models in estimating the air temperature thresholds in all studied stations considering that the outputs of precipitation phase discrimination models are mainly used for snow depth estimation by hydrological models herein the estimated snow depth by the dbse model and the existing models are compared with the observed snow depth at the studied stations to validate the performance of dsbe model in hydrological applications for this purpose only the models of liu et al 2016 and dai 2010 were used in the comparison since they performed comparably well with the dsbe model in estimating air temperature thresholds and the frequency of snowfall occurrences to convert daily precipitation records to snow depth according to the frequencies determined by the considered models precipitation of a given day was set to be all snow when its average daily air temperature was tsnow and rain when it was train the taylor diagrams of fig 7 that compare the snow depth estimated by the dsbe model and the models of liu et al 2016 and dai 2010 with the snow depth measured at the studied stations suggest a comparable performance of the considered models in all stations the diagrams also indicate that the estimated snow depth by the three models is close to the observed snow depth of the stations however in stations like ardabil sarab kamiaran and saqez the dsbe model perform slightly better than the models of liu et al 2016 and dai 2010 5 discussion and conclusion we have analyzed 50 years 1970 2020 of daily precipitation snow depth and air temperature records from 12 synoptic stations scattered over the mountainous areas of west and north of iran and proposed a double sigmoidal function i e a dsbe model for determining the air temperature thresholds required for partitioning precipitation occurrences into rain and snow phases comparing the frequency of snowfall events estimated by the dsbe model and several other existing models with the frequency of snowfall events observed in the studied stations showed that the dsbe model fits the frequency of observed snowfall occurrences better than the existing models this is because the dsbe model better fitted the extremes of the upper tail of the frequency of snowfall occurrences than the other existing functions which is related to the effect of its parameter a which can take any value close to 1 as opposed to the logistic logistic function that fixed it to 1 supplementary table 1 this makes dsbe more flexible than other functions and even the logistic logistic function to fit the extremes of the frequency of snowfall events at the studied stations on the contrary the other existing models may over or under estimate the probability of snowfall occurrences at extremely lower air temperatures due to not fitting properly to the upper tail of the curve of the cloud of observed snowfall occurrences supplementary fig 1 the average of the r2 statistic computed between the frequency of snowfall occurrences estimated by the proposed model and the frequency of snowfall events observed at the studied stations was the highest 0 989 among the models while its average error was the lowest 4 the dsbe model also performs the best in accurately estimating train tsnow and ts air temperature thresholds in all studied stations suggesting the supremacy of the proposed model for snow rain phase discrimination and estimating the air temperature thresholds in all stations however it was found that the tsnow considerably varies between the studied stations this is because tsnow is highly sensitive to variations in air humidity and air temperature that are heavily dependent on the topographical and geographical features of the locations particularly atmospheric humidity affects the energy budget of falling hydrometeors harporld et al 2018 this indicates that the determination of air temperature thresholds required for precipitation phase separation at any location is a location specific issue and therefore must be calculated with the snowfall observations from that location using a proper method such as the dsbe model that showed better performance than other existing models the dsbe model also provides a closer snow depth estimation to the snow depth observations of the studied stations when compared to the other available models examining the snowfall frequency versus air temperature bins at the studied stations suggests that snowfall occurrences in the mountainous areas of iran can occur over a wide range of mean daily air temperatures this may partly be attributed to the continental climate of iran which is mostly characterized by dry and semi dry climates raziei 2022 2017 as well as the high elevation of some of the studied stations which leads to more snowfall occurrences at higher air temperatures in sites with drier climates or higher elevation jennings et al 2018 this is because the snowflakes fall faster in the thin air of the mountains and reach the ground at higher air temperatures before melting dai 2008 similarly rain occurs in a wide range of air temperature bins at the studied stations partly because in many cases the snowflakes reach near the surface at negative air temperatures but quickly melt and turn into liquid form due to warmer air temperatures at the surface dai 2008 global warming has accelerated this phenomenon in the last decades particularly in the stations located in the urban areas that are heavily affected by urban heat islands the ts threshold determined by the dsbe model varies from 1 to 2 c across the stations which is consistent with the results obtained for other parts of the world for example auer 1974 dai 2008 kienzle 2008 g liu 2008 lynch stieglitz 1994 motoyama 1990 yang et al 1997 the range of ts estimated for the studied stations is also in concordance with the range of ts simulated by jennings et al 2018 for the mountainous areas of western and northern iran the slightly higher ts values estimated for some of the studied stations can partly be attributed to the drier climate of such stations which is in agreement with the general belief that the continental areas and mountain ranges generally exhibit the warmest ts threshold jennings et al 2018 though the stations used for the analysis have different climate types and geographical features table 1 however we did not find a significant association between any air temperature thresholds and the geographical coordination of the sites which may be related to the limited number of stations used in this study the snow rain phase discrimination presented in this study is solely based on mean daily air temperature as the main predictor however some authors found better results when using a combination of air temperature and relative humidity as predictors for snow rain phase separation froidurot et al 2014 jennings et al 2018 moreover the present study has used daily precipitation and air temperature data for precipitation phase discrimination because of their availability for the studied stations however since most of the precipitation occurrences in the study area have a short duration the results achieved in this study may be improved when a set of sub daily records of such climate variables are used this is because many short duration snowfall events may be misclassified as rain when daily data are used for precipitation phase discrimination for example the snow that fell on the ground during a short term snowfall event in the morning of a day may melt a few hours later when the air temperature gets warmer such snowfalls may thus be misclassified as rain rather than snow when using daily data therefore since the diurnal air temperature range in the study area is very wide a more accurate precipitation phase discrimination can be achieved with a set of sub daily records of such climate variables this is in agreement with kongoli bland 2000 and feiccabrino lundberg 2008 who stated that the phase of precipitation usually changes over a short period of a day therefore using a higher temporal resolution of data records could reduce the amount of mixed precipitation induced by the rapid diurnal changes in the air temperature or the occurrence of rain on snow both of which quickly melt the snow accumulated over the ground marks et al 2013 though precipitation phase discrimination is a useful tool for correcting precipitation gauge data for wind undercatch marks et al 2013 however blowing away snow particularly the dry snow from the snow pillow by winds may also cause an underestimation in snow measurement that in turn may lead to a bias in precipitation phase discrimination these could be the topics for future studies to examine whether utilizing air temperature and relative humidity as the joint input predictors of the dsbe model improves the precipitation phase separation and the related air temperature thresholds identified herein particularly when sub daily data records are used 6 declarations funding no funding availability of data and materials please contact the corresponding author for data requests code availability please contact the corresponding author for code requests ethics approval not applicable consent to participate not applicable consent for publication not applicable credit authorship contribution statement firooze hashemireza methodology software formal analysis data curation writing original draft ahmad sharafati conceptualization investigation validation tayeb raziei supervision methodology validation writing review editing sara nazif visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to reveal their gratitude and appreciation to the data provider the iranian meteorological organization the authors also sincerely thank the editor and anonymous reviewers for their constructive recommendations suggestions that substantially improved the quality of the paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129153 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 auer 1974 auer a h 1974 the rain versus snow threshold temperatures weatherwise 27 67 67 https doi org 10 1080 00431672 1974 9931684 dai 2008 dai a 2008 temperature and pressure dependence of the rain snow phase transition over land and ocean 35 1 7 https doi org 10 1029 2008gl033295 fassnacht and soulis 2002 s r fassnacht e d soulis implications during transitional periods of improvements to the snow processes in the land surface scheme hydrological model watclass atmos ocean 40 2002 389 403 10 3137 ao 400402 fassnacht s r soulis e d 2002 implications during transitional periods of improvements to the snow processes in the land surface scheme hydrological model watclass atmos ocean 40 389 403 https doi org 10 3137 ao 400402 feiccabrino and lundberg 2008 j feiccabrino a lundberg precipitation phase discrimination in sweden 65th east 2008 snow conf 239 254 feiccabrino j lundberg a 2008 precipitation phase discrimination in sweden 65th east snow conf 239 254 froidurot et al 2014 s froidurot i zin b hingray a gautheron sensitivity of precipitation phase over the swiss alps to different meteorological variables j hydrometeorol 15 2014 685 696 10 1175 jhm d 13 073 1 froidurot s zin i hingray b gautheron a 2014 sensitivity of precipitation phase over the swiss alps to different meteorological variables j hydrometeorol 15 685 696 https doi org 10 1175 jhm d 13 073 1 harpold et al 2017 a a harpold m l kaplan p zion klos t link j p mcnamara s rajagopal r schumer c m steele rain or snow hydrologic processes observations prediction and research needs hydrol earth syst sci 21 2017 1 22 10 5194 hess 21 1 2017 harpold a a kaplan m l zion klos p link t mcnamara j p rajagopal s schumer r steele c m 2017 rain or snow hydrologic processes observations prediction and research needs hydrol earth syst sci 21 1 22 https doi org 10 5194 hess 21 1 2017 hay and mccabe 2010 l e hay g j mccabe hydrologic effects of climate change in the yukon river basin clim change 100 3 4 2010 509 523 hay l e mccabe g j 2010 hydrologic effects of climate change in the yukon river basin 509 523 https doi org 10 1007 s10584 010 9805 x jennings et al 2018 k s jennings t s winchell b livneh n p molotch spatial variation of the rain snow temperature threshold across the northern hemisphere nat commun 9 2018 10 1038 s41467 018 03629 7 jennings k s winchell t s livneh b molotch n p 2018 spatial variation of the rain snow temperature threshold across the northern hemisphere nat commun 9 https doi org 10 1038 s41467 018 03629 7 kienzle 2008 kienzle s w 2008 a new temperature based method to separate rain and snow 5085 5067 5085 https doi org 10 1002 hyp kongoli and bland 2000 c e kongoli w l bland long term snow depth simulations using a modified atmosphere land exchange model agric for meteorol 104 2000 273 287 10 1016 s0168 1923 00 00169 6 kongoli c e bland w l 2000 long term snow depth simulations using a modified atmosphere land exchange model agric for meteorol 104 273 287 https doi org 10 1016 s0168 1923 00 00169 6 leavesley et al 1983 g h leavesley r w lichty b m troutman l g saindon precipitation runoff modeling system user s manual water resources investigations report 1983 10 3133 wri834238 leavesley g h lichty r w troutman b m saindon l g 1983 precipitation runoff modeling system user s manual water resources investigations report https doi org 10 3133 wri834238 lipovetsky 2010 s lipovetsky double logistic curve in regression modeling j appl stat 37 2010 1785 1793 10 1080 02664760903093633 lipovetsky s 2010 double logistic curve in regression modeling j appl stat 37 1785 1793 https doi org 10 1080 02664760903093633 liu 2008 g liu deriving snow cloud characteristics from cloudsat observations j geophys res 113 2008 10 1029 2007jd009766 liu g 2008 deriving snow cloud characteristics from cloudsat observations j geophys res 113 0 09 https doi org 10 1029 2007jd009766 liu et al 2016 s liu d yan t qin b weng y lu precipitation phase separation schemes in the naqu river basin eastern tibetan plateau theor appl climatol 2016 10 1007 s00704 016 1967 7 liu s yan d qin t weng b lu y 2016 precipitation phase separation schemes in the naqu river basin eastern tibetan plateau theor appl climatol https doi org 10 1007 s00704 016 1967 7 lynch stieglitz 1994 m lynch stieglitz the development and validation of a simple snow model for the giss gcm j clim 7 1994 1842 1855 10 1175 1520 0442 1994 007 1842 tdavoa 2 0 co 2 lynch stieglitz m 1994 the development and validation of a simple snow model for the giss gcm j clim 7 1842 1855 https doi org 10 1175 1520 0442 1994 007 1842 tdavoa 2 0 co 2 maidment 1992 maidment 1992 d r maidment handbook of hydrology mcgraw hill inc new york 1992 p 1992 
2338,the representation of uncertainty in results is an important aspect of statistical techniques in hydrology and climatology hypothesis tests and point estimates are not well suited for this purpose other statistical tools such as confidence curves are better suited to represent uncertainty therefore three parametric methods to construct confidence curves for the location of a sudden change in the properties of a time series a change point cp are analyzed for three distributions log normal gamma and gumbel two types of change are considered a change in the mean and a change in the standard deviation a question that confidence curves do not answer is how likely the null hypothesis of no change is a possible statistic to help answer this question denoted by un is introduced and analyzed it is compared to the statistic that underlies the pettitt test all methods perform well in terms of coverage and confidence set size one method is based on the profile likelihood for a cp the other two first defined in this article on the pseudolikelihood for a cp the main advantage of the pseudolikelihood over the profile likelihood lies in the much lower computational cost the confidence curves generated by the three methods are very similar in a limited test on time series of measurements found in the literature the methods gave results that largely matched those reported elsewhere some results are also given for an order one autoregressive series with a lognormal marginal distribution keywords confidence curves pseudolikelihood likelihood change point detection structural break l moments method of moments uncertainty data availability the authors do not have permission to share data 1 introduction today the need to take into account climate variability and the results of human interventions in water management and hydrology seems clear kolokytha et al 2017 teegavarapu 2018 to do so it is necessary to combine statistical information obtained from hydrological and climatological time series with investigations of how the natural variations in the behavior of the physical system and human alterations of that system could result in changes in those time series and link the changes suggested by statistics to physical causes tao et al 2011 while this will often be a search for trends or periodic changes the time series in question must also be tested for abrupt changes either to find real changes tao et al 2011 harrigan et al 2014 or to see whether it is necessary to split a series into two parts for further analysis cong et al 2017 beaulieu et al 2012 mention that an abrupt change in the statistical properties of a time series could signal an undocumented change in the measurement procedure a general overview of change detection is given in kundzewicz and robson 2004 in this article the emphasis is on abrupt changes but please keep in mind that for instance the initial filling of a reservoir may take several years so it may look as a trend on a daily scale and as a jump in the time series of annual maximum flows there have been many publications on the detection of an abrupt change or change point cp in hydrology and climatology beaulieu et al 2012 conte et al 2019 xie et al 2014 xiong and guo 2004 theoretical work on cp detection in general was done for example by pettitt 1979 chen and gupta 2001 2011 or brodsky and darkhovsky 2013 there are many statistical tools that can be used to detect the presence of cps ideally such a tool should provide information on the uncertainty in the location of the cp the traditional tests such as the one presented in pettitt 1979 focus on the acceptance or rejection of the null hypothesis that there is no cp at a given significance level a form of null hypothesis significance testing nhst if the null hypothesis is rejected then the cp is assumed to be at the location that results in the largest value for the test statistic such a point estimate gives no indication of the probability that this is the true cp location in the literature the emphasis tends to be on determining whether or not there is a cp and delivering as point estimate of the cp location attention for the uncertainty in its location is limited based on web of science search it seems that less than 10 of the papers dealing with cps uses a method that does more than deliver a point estimate this also holds when only papers dealing with environmental times series are considered of those relatively rare papers that deal with the uncertainty in the cp location most use bayesian methods examples of bayesian methods are easier to find see for instance perreault et al 1999 2000 or for a hierarchical bayesian version belisle et al 1998 chu and zhao 2004 bayesian methods require prior distributions for all parameters and they can be computationally intensive a rare example of a frequentist paper that looks into uncertainty is hušková and kirch 2008 where a bootstrap based method is used to construct confidence intervals for cps strictly speaking the methods discussed in this article serve a different purpose than nhst and they are not designed to reject or not reject the null hypothesis however experiments showed that from the confidence curves a number may be calculated that may serve the same purpose as the original p value namely to indicate data worthy of a second look nuzzo 2014 this is of interest in situations where a large set of time series is studied and it would not be feasible to analyze all confidence curves by eye different thresholds for that value could then be used to separate the set into three groups curves that provide clear information on the location of a cp curves that provide no information on the location of a cp and curves that need to be investigated further a possible candidate for such a number is the function un introduced in this paper as in all of statistics there are parametric and nonparametric methods the nonparametric methods avoid the choice of a distribution for the time series but they tend to specialize in detecting changes in either the mean or the standard deviation not both at the same time eastwood 1993 the parametric tests can look for changes in all parameters of the underlying distribution for hydrological meteorological or climatological time series the distribution may or may not be known sheskin 2003 pp 97 98 states that while parametric tests generally provide a more powerful test of the alternative hypothesis they may lose that advantage if the assumptions underlying the test are violated an example of a nonparametric detection method using confidence curves can be found in zhou et al 2020 it therefore makes sense to examine both types of cp tests the current article examines two parametric approaches while the emphasis is on detection of changes in the mean additional experiments showed that the same algorithm is equally sensitive to changes in the standard deviation both parametric approaches belong to the domain of parametric statistics and represent uncertainty by a confidence curve both use a likelihood where the location of the cp the distribution parameters to the left of the cp and the distribution parameters to the right of the cp are free variables one then introduces a profile likelihood the other introduces a pseudolikelihood a method based on the first approach can be found in cunen et al 2018 where it is called method b method b is based on a calculation of the log likelihood of the time series for all possible cp locations in this calculation the parameters of the distribution to the left and to the right of the cp are so called nuisance parameters their values are needed to calculate the log likelihood but are not of intrinsic interest a profile log likelihood approach is used to calculate the log likelihoods the resulting log likelihood values for the potential cps are used to construct a deviance function next monte carlo mc simulation is used to approximate the distribution of the values of the deviance function for each potential cp this approximate distribution is then used to build a confidence curve in the remainder of this study this method will be referred to as confidence curve based on maximum likelihood parameter estimation cml a potential problem with this method is that it is very computationally intensive even in the case of just one cp two optimizations of a log likelihood need to be done for each possible cp location to determine the profile log likelihood moreover a mc simulation is needed to determine an approximate distribution for each possible cp location this mc simulation needs to repeat the profile log likelihood calculation as often as is needed to obtain an approximate distribution as shown in appendix e this leads to a computational complexity linearly proportional to the number of samples in the mc simulation and proportional to the cube of the time series length run times on a desktop workstation may take hundreds of seconds for a single sample removal of the maximum likelihood optimization can reduce the computational cost considerably this is the chief reason to examine the second approach the current study presents two methods based on the second approach which uses pseudolikelihood more information on pseudolikelihood can be found in for example gong and samaniego 1981 distribution parameters are estimated by the method of moments mom or l moments lmo this reduces the computational cost of the likelihood calculations moreover fast code for these methods is often easier to obtain than for log likelihood optimization these methods will be referred to as confidence curve based on method of moments parameter estimation cmom and confidence curve based on l moments parameter estimation clmo respectively as the experimental results for cmom and clmo were very similar only cml and clmo results are reported in this study to verify that clmo cmom works it should be demonstrated that the results obtained are similar to those of cml as hydrological time series are relatively short asymptotic results on the performance of the methods may not be valid therefore it is necessary to generate statistics on the performance of all methods through computer experiments in this study this has been done for several two parameter distributions where the cost of the maximum likelihood calculations is still manageable log normal ln gamma ga and gumbel gu for ease of interpretation of the results clarity of method representation and to keep the computing time needed down to a manageable level only the case of at most one change amoc is considered the equations used in the methods are derived for independent identically distributed i i d random variables rvs the methods are based on pseudolikelihood and in principle they can be extended to time series with short range correlation see also aue and horváth 2012 for other deviations from the i i d assumption such as periodic components or trends methods that have been applied in combination with other cp detection schemes should work here as well preliminary results on series with short range dependence show that the methods with formulas based on i i d still work but information about uncertainty decreases in quality see appendix g finally with regard to long range dependence aue and horváth 2012 state that tests for structural stability that are designed for the i i d or short range correlation case are not robust against long memory moreover time series with short range correlation and change points may be difficult to distinguish from time series with long memory berkes et al 2006 the remainder of this paper is organized as follows first the two approaches to confidence curve construction are presented next indicators are defined that can be used to evaluate the method performance and compare the confidence curves then the results of the application of the methods to synthetic data are analyzed after that the methods are applied to several hydrological and climatological time series for which cp detection results are available in the literature finally we discuss the results and present our conclusions mathematical details can be found in appendices a e in appendix f several time series of annual maximum flows for different stations downstream of the site of the three gorges dam are checked for cps 2 methodology all time series will be modeled as a vector y of n independent rvs y 1 y 2 y n in the remainder of the paper y will represent a realization of y and y obs will represent the actual observed time series the null hypothesis h 0 will be that the y i are i i d rvs the alternative hypothesis h 1 will be that there is an index τ 1 2 n 1 such that the original random vector is split into two subseries a subseries with i i d rvs y 1 y 2 y τ and a subseries with i i d rvs y τ 1 y τ 2 y n but the distributions of the variables in the two subseries are different furthermore it is assumed that all distributions are from the same family so they differ only in the parameters used in the shared probability density function pdf and cumulative distribution function cdf the cdf of y i will be referred to as f θ and the pdf as f θ where θ is a vector the parameter vectors for the left and the right subseries will be θ l and θ r respectively the null hypothesis can now be expressed as θ l θ r both approaches need to approximately solve maximum likelihood problems for the subseries to the left and to the right of the change point τ intuitively it is clear that parameter estimation for very small samples will be difficult some studies considering this are lettenmaier and burges 1982 delicado and goria 2008 landwehr et al 1979 these suggest that for short subseries the results may vary considerably from sample to sample a minimum subseries length n min will therefore be used as a result only a subset of cp locations given by 1 l cp n min n min 1 n n min was considered and no parameter estimates for subseries shorter than n min were carried out the choice of n min is to a certain extent arbitrary here we take a minimum subseries length 2 n min 2 log n where the notation denotes rounding down towards the nearest integer n min 1 corresponds to considering all possible cps one reason to consider trimming is that the variance in parameter estimates tends to decrease with increasing sample size as a result a short sequence may lead too much wilder parameter estimates than a long sequence landwehr et al 1979 this would seem undesirable when looking for parameter changes 2 1 a description of the two approaches the starting point for both approaches is the log likelihood function ℓ for a cp problem the value of ℓ for a cp τ distribution parameter vectors θ l and θ r and a realization y of the time series is 3 ℓ τ θ l θ r y i 1 τ log f y i θ l j τ 1 n log f y j θ r τ 1 2 n 1 here θ l and θ r are vectors of nuisance parameters and τ is the parameter of interest a common way of dealing with nuisance parameters is the following for each τ take the supremum least upper bound of 3 over all θ l θ r the resulting function is called the profile log likelihood 4 ℓ prof τ y sup θ l θ r ℓ τ θ l θ r y for a closed bounded parameter set the supremum coincides with the maximum for a given τ let θ ˆ l τ y and θ ˆ r τ y stand for the values of θ l and θ r respectively for which ℓ τ θ l θ r y attains the maximum value with this notation 4 is equivalent to 5 ℓ prof τ y ℓ τ θ ˆ l τ y θ ˆ r τ y y in cml θ ˆ l τ y and θ ˆ r τ y are calculated whenever needed the smallest value of τ l cp for which ℓ prof is maximal will be denoted by τ ˆ y 6 τ ˆ y min arg max τ l cp ℓ τ θ ˆ l τ y θ ˆ r τ y y the minimum is taken to allow for the highly unusual case where there are multiple maxima in clmo cmom instead of a profile log likelihood ℓ prof a pseudo log likelihood ℓ pseu is used to obtain ℓ pseu the lmo mom estimates θ l τ y and θ r τ y of the nuisance parameters are inserted in 3 7 ℓ pseu τ y ℓ τ θ l τ y θ r τ y y these estimates are assumed to be acceptable approximations of the maximum likelihood estimation results the smallest value of τ l cp for which ℓ pseu is maximal will be denoted by τ y 8 τ y min arg max τ l cp ℓ τ θ l τ y θ r τ y y from this point onwards all methods follow the same path towards a confidence curve a deviance function for cml is defined as the deviance of ℓ prof from the maximum value it attains at τ ˆ y 9 d prof τ y 2 ℓ prof τ ˆ y y ℓ prof τ y and a deviance function for clmo cmom is defined as the deviance of ℓ pseu from the maximum value it attains at τ y 10 d pseu τ y 2 ℓ pseu τ y y ℓ pseu τ y for all τ l cp the distribution of the deviance function for cml follows from 11 r r k τ prof r pr d prof τ y r τ θ l θ ˆ l τ ˆ y y θ r θ ˆ r τ ˆ y y and for clmo cmom from 12 r r k τ pseu r pr d pseu τ y r τ θ l θ l τ y y θ r θ r τ y y no exact or approximate expression for k τ is available therefore an mc simulation will be used to approximate k τ in cunen et al 2018 and in this paper a confidence curve see also appendix a is defined using the distribution of the deviance function 13 cc τ y obs k τ d τ y obs where y obs is an observation of the random sample y the mc approximation of k τ is obtained as follows 1 estimate parameters τ θ l θ r by first solving for τ y obs and then calculating θ l τ y obs y obs and θ r τ y obs y obs 2 for each possible location τ l cp and j 1 2 n draw a new sample y j k where the components y i j k k 1 2 τ are distributed according to the distribution f θ with θ θ l τ y obs y obs and the components y i j k k τ 1 τ 2 n are distributed according to the distribution f θ with θ θ r τ y obs y obs 3 approximate the confidence curve cc τ y obs k τ d τ y obs by 14 k τ n d τ y obs 1 n j 1 n 1 d τ y d τ y obs where 1 is the indicator function 15 1 a b 0 a b 1 a b and τ is τ ˆ for cml and τ for clmo cmom and θ is θ ˆ for cml and θ for clmo cmom standard software is not yet available for the methods a custom implementation in matlab was written where necessary random numbers were obtained from the threefry type random number generator in matlab 2 2 properties of confidence curves the performance of cml and clmo cmom methods will be examined and compared by exploring some properties zhou et al 2020 of confidence curves constructed by the two methods they are the cumulative frequency distribution of the τ ˆ y for cml and τ y for clmo cmom based on synthetic data when the null hypothesis h 0 there is no cp holds in this case the distribution should be close to uniform if it is not uniform then it indicates that there is a bias for certain locations when a type i error incorrect rejection of the null hypothesis occurs the cumulative frequency distribution of the τ ˆ y and τ y for synthetic data when the alternative hypothesis h 1 there is a cp holds while the point where the deviance function is zero is not necessarily the true cp it is contained in all confidence sets that follow from the confidence curve if these sets are narrow then this point should be near the true cp for a definition of a confidence set see definition 1 in appendix a the actual versus nominal coverage probability for the confidence sets produced by the curves at all confidence levels for synthetic data the actual coverage probability at a given confidence level nominal coverage probability indicates the probability of a confidence set containing the true value of the parameter of interest for detailed definitions of actual and nominal coverage probability see definition 1 in appendix a a summary of the uncertainty about the cp associated with a confidence curve cc is defined in appendix b by b 7 un cc k n min n n min 1 cc k γ max 1 n 2 n min where γ max n 2 n min n 2 n min 1 the similarity index is used to measure the similarity of two confidence curves 16 j cc cc k n min n n min min 1 cc k 1 cc k k n min n n min max 1 cc k 1 cc k where cc and cc are a pair of confidence curves this index was proposed in zhou et al 2020 and resembles the ružička index schubert and telcs 2014 it is one for identical curves and smaller than one for curves that differ 2 3 synthetic time series generation and examples of confidence curves the cml and clmo cmom methods were implemented for three distributions ln ga gu to evaluate the performance of cml and clmo cmom synthetic data were generated from the underlying distributions the distributions were selected because they are commonly used in hydrology hamed and rao 2019 thompson 2017 haktanir 1991 karim and chowdhury 1995 the pdfs and the relations between the parameters and moments and l moments are given in appendix d the change in statistical properties of the synthetic data was a change in the mean μ for cml cmom and a change in the mean or in the standard deviation σ for clmo for each distribution and each combination of a change in the mean δ μ 1 2 4 and a series length n 40 100 a set of m 1000 artificial time series of length n with standard deviation σ 1 τ n 4 n 2 3 n 4 and a jump δ μ in the mean between τ and τ 1 was generated the location of the cp during sample generation will be referred to as τ true in this study the mean of a specific distribution for the subseries up to τ was μ l 2 and the mean for the subseries after τ was μ r μ l δ μ where δ μ 1 2 4 examples of synthetic data sets with δ μ 0 1 2 and the corresponding confidence curves for cml and clmo are given in fig 1 a f the standard deviation for the left and right subseries will be referred to as σ l and σ r respectively additional experiments were done for clmo with μ r μ l σ r σ l δ σ where δ σ 1 2 3 examples of data series synthetic data sets with δ σ 0 1 2 are given in fig 1 g l the effect of shifting different μ l or scaling different σ l a time series is discussed in appendix c where necessary random numbers to generate samples were obtained from the twister type random number generator in matlab 3 evaluation of the methods for synthetic data the performance of the confidence curves produced by cml and clmo cmom as represented by the properties listed in section 2 2 are examined for all methods n 1000 mc simulations were used to generate the approximate confidence curve the majority of the experiments involved a change in the mean however one advantage of a parametric method is that it looks for changes in all parameters at the same time so some experiments were performed for synthetic series with a change in the standard deviation as well 3 1 the cumulative frequency distribution of the cp estimate the methods produce confidence curves instead of point estimates these confidence curves are characterized by their shape and the location of their minimum in the remainder of the paper the minimum of the confidence curve will be referred to as the point estimate of the cp 3 1 1 the cumulative frequency distribution of the cp estimate when the null hypothesis holds fig 2 shows the cumulative frequency distribution of the cp estimates found by cml and clmo when the null hypothesis holds no cp in this case if the method is forced to select a cp then it should not display a preference for any particular cp the possible candidates are the elements of the set l cp defined in 1 the black line in fig 2 a c shows the corresponding uniform frequency distribution on that set the experimental results do not match this exactly but do approximate it the methods have a slight preference for points near the middle of the time series for ln ga and gu the methods cml and clmo give similar results 3 1 2 the cumulative frequency distribution of the cp estimate when the alternative hypothesis holds figs 3 a f show the frequency distribution of detected cps by cmlo when the alternative hypothesis holds for τ true n 4 n 2 3 n 4 and n 40 100 figs 3 g l show the equivalent results for δ σ 1 2 for clmo the minima of the confidence curves for the different samples are spread around the true cp results for cml with a change in the mean are similar the spread decreases with increasing δ μ δ σ and n for example for δ μ 1 and n 100 about 90 of the estimates lie within 10 points of the actual cp for δ μ 2 the spread reduces to 5 points on average the cp estimates are closer to the true value for changes in the mean than for changes in the standard deviation the frequency distributions found by all methods for synthetic time series drawn from the three distributions are very similar 3 2 actual versus nominal coverage probability the difference between the actual and the nominal coverage of the confidence sets defined by the confidence curve is quite important for their practical use if the actual coverage of a confidence set is lower than the nominal one then it is permissive appendix a this may cause problems because it suggests too much certainty about the cp location if the set were a person then that person would be overconfident if the actual coverage probability exceeds the nominal coverage then the set is conservative while this is less problematical than permissiveness it suggests too much uncertainty the set would please an overcareful person the actual coverage was estimated as follows synthetic time series with indices m 1 2 m were generated and for each time series m the confidence curve and the confidence set r γ m at confidence level γ were determined finally the number k of sets for which τ true r γ m was divided by m in fig 4 plots of the actual versus nominal coverage are shown when interpreting fig 4 it is important to recall that if a cp is present then there is only a finite number of possible locations for that cp this in turn means that if the construction method for the curve makes very good use of the information in the sample then it may result in confidence random sets that contain only one or two points but have a very high probability of containing the actual cp this implies that for low confidence levels the sets will be very conservative this manifests itself in fig 4 where in a the actual coverage is always above 37 for δ μ 1 it always exceeds 65 for δ μ 2 in b and in c it is higher than 70 for δ μ 2 in fig 4 d f it can be seen that for changes in the standard deviation the actual coverage and nominal coverage start to coincide at lower values it follows that in practice the confidence sets with relatively high nominal confidence carry the best information the sets at low confidence levels are much too conservative the results for cml show that all distributions provide accurate actual coverage for nominal coverages above 90 for changes in the mean the results for clmo cmom are nearly identical to those for cml results for n 40 were generated as well but the impact from series length on actual coverage probability was small so they have not been included here table 1 shows detailed information about actual versus nominal coverage for confidence curves constructed by cml and clmo for confidence levels γ 0 90 0 95 0 99 an indication of the spread in actual coverage can be provided as follows if the actual coverage were equal to the nominal coverage then the number k of m confidence sets r γ m m 1 2 m that contained the true cp would be distributed according to a binomial distribution 17 p r k m k γ k 1 γ m k for the binomial distribution the variance is m γ 1 γ so the standard deviation of k m is γ 1 γ m for m 1000 the standard deviation of the distribution of k for γ 0 90 is 0 009 for γ 0 95 it is 0 007 and for γ 0 99 it is 0 003 when combining this information with table 1 please recall that the location of the cp is a discrete rv so for some confidence levels it might not be possible to define a confidence set with that exact coverage 3 3 the uncertainty in the confidence curves as mentioned in the introduction it may be necessary to automatically split a set of confidence curves into groups for further analysis here un is proposed as a tool to do so one way to evaluate the suitability of un is to compare its associated type i and type ii errors to a classical hypothesis test for the null hypothesis that no cp is present for this purpose a comparison with the classical pettitt test is performed the value un for a confidence curve is calculated according to b 7 it summarizes the uncertainty of a confidence curve the bounds on un depend on the distribution and the parameters so in principle they should be determined by monte carlo experiments for each individual case in practice splitting the series into three classes definitely no cp definitely a cp and to be examined further might allow rough bounds to be established that depend only weakly on the distribution parameters see also appendix c 3 3 1 the uncertainty in the confidence curves for the null hypothesis the cml approach implicitly assumes that a cp is present so it would seem that it should be preceded by a test for the presence of a cp however if un is calculated for synthetic time series generated without a cp then it turns out to be quite high in most cases near one for 80 n 40 to 90 n 100 of all curves as shown in fig 5 examples of confidence curves for time series without a cp are shown in fig 1 a g as high un in the presence of a cp means that the method supplies only a very limited amount of information on cp location it is tempting to simply say that if un exceeds a certain bound then either there is no cp or the method cannot reliably detect the cp location for example fig 5b shows that for cml n 100 95 of all un values exceed 0 63 if that bound were used to reject the null hypothesis then for this particular distribution and this particular parameter set that choice would result in a 5 type i error the viability of this approach depends on the distribution of un in cases where the alternative hypothesis holds 3 3 2 the uncertainty of confidence curves for the alternative hypothesis fig 6 shows the frequency distribution of un for clmo when h 1 holds and the cp lies in the middle of the time series the values for cml for a change in the mean are very similar for n 100 δ μ 1 95 of the values lie below 0 4 for ln and for ga 95 of the un values lie below 0 45 fig 6b for δ μ 2 these bounds less than 0 1 for all distributions fig 6 d f show the frequency distribution for un when h 1 holds and the cp lies in the middle of the time series for n 100 δ σ 2 and the ln distribution 95 of the values lie below 0 35 for ga the 95 of the un values lie below 0 2 for gu 95 of the un values lie below 0 2 it should be noted that the scale parameter of ga equals the variance divided by the mean so for fixed mean it increases with the square of the standard deviation for higher standard deviations this leads to a distribution that tends to produce many low values with a few very high values mixed in special care may be needed in the calculations for low means and high standard deviation 3 3 3 uncertainty as a tool to select curves and data that need closer inspection there are two types of error that are of interest when testing a hypothesis if h 0 is rejected when there is no cp then that is a type i error and if h 0 is accepted when there is a cp then that is a type ii error for example for δ μ 1 n 100 and distribution ln fig 5 a implies that rejection of h 0 for un 0 2 would result in a very small type i error while fig 6 a implies that non rejection of h 0 for un 0 5 would result in a very small type ii error the subset of time series where 0 2 un 0 5 would then need further study by visual inspection or additional tests if none of the original time series actually has a cp then that subset would contain less than 5 of the original set of time series while if all series actually have a cp then that subset would contain about 30 of the original set fig 7 is based on the frequency distribution of un over the synthetic samples sets and shows how a particular choice of a un value as a bound for acceptance of h 0 would translate into type i and type ii errors for that set of samples for different applications of the methods the relative importance of the type i and type ii error will differ the point marked a corresponds to the un value for which the type i and type ii errors are equal for n 40 the point b corresponds to the un value for which the type i and type ii errors are equal for n 100 by plotting the value pairs of type i and type ii errors associated with a particular value of un over a range of un values it is possible to visualize the relation between the errors for n 100 and a change in the mean of 1 or 2 fig 7 a f shows that there are choices of un boundary that for these distributions and parameters result in both type i and type ii errors that are smaller than 5 for n 100 and δ σ 2 similar results are obtained for n 100 and δ σ 1 an upper bound of 5 on both errors can be achieved only for gu to see how a null hypothesis test based on un would do when compared with the classical pettitt test the curve of error pairs is drawn for both tests for a cp in the middle of the time series in fig 8 the results show that in principle un could even serve as the basis for a hypothesis test for a change in the standard deviation the standard pettitt test is much less effective fig 8g l a modification of that test specifically designed for the change to be detected would be needed here the test based on un is not the most effective for any particular change but it is the one that will detect changes in all parameters 3 4 the similarity index between confidence curves to evaluate the similarity between confidence curves for the same synthetic time series the similarity index j was calculated by 16 for δ μ 1 2 τ true n 2 and n 40 100 details on the calculation of j and its properties can be found in zhou et al 2020 appendix c fig 9 shows the resulting cumulative frequency distributions of j the confidence curves for synthetic data calculated by cml are very similar to those calculated by clmo the similarity increases with increasing δ μ and n for the gu distribution similarity seems lower to provide a point of reference for the similarity values j was calculated for 16000 random pairs of h 0 confidence curves the result was that 95 of the pairs had a similarity below 0 7 for all series lengths distributions and methods 4 change point detection and uncertainty in real hydrometeorological data to examine the performance of the cml and clmo methods on real world data three time series of measurements were taken from previous publications annual average naturalized flow at itaipu conte et al 2019 case study 1 annual average temperature at tuscaloosa reeves et al 2007 case study 2 and annual average rainfall at tucumán jandhyala et al 2010 case study 3 the cps found in the original studies are used as a reference both methods were used to construct confidence curves for cps with each of the three distributions ln ga and gu the uncertainties for the confidence curves were determined as was the similarity between the cml and clmo curve for each case the confidence set at confidence level 95 is also shown in appendix f the methods are applied to four time series of annual maximum discharge on the yangtze river in china that were also analyzed in zhou et al 2019 by a non parametric method case study 4 4 1 case study 1 conte et al 2019 found a significant cp in 1971 in the annual average naturalized flow at the itaipu hydroelectric plant in brazil from 1931 to 2015 by the bootstrap pettitt test in this case the value of δ μ σ 1 33 suggests cml and clmo should do reasonably well and so they do un is low 0 03 to 0 07 and j is high 0 96 all give a 95 confidence interval of about three years see fig 10 4 2 case study 2 the annual average temperature time series from 1940 to 1986 in tuscaloosa usa was selected because there was only one documented reason for a cp during this period the time series was used in reeves et al 2007 and a cp located at the year of 1957 was found by eight different methods the value of δ μ σ 1 33 again suggests the methods should do well both ln and ga based methods find a reasonably precise confidence curve for the cp with a 95 confidence interval 1955 1959 in this case gu is not doing as well as ln and ga moreover gu combined with clmo seems to be confused by the sudden drop from 1975 to 1976 fig 11 b d a possible explanation is the difference in parameters for the gumbel distribution found by the different methods while one would hope that cml cmom and clmo would give similar results all parameter estimates are rvs and their variance may be quite large for small samples given the very different formulas used to obtain the estimates it should not be surprising that without large samples to reduce the variance very different results can be found this in turn may lead to different points being selected as cp table 2 gives the estimated parameters and the corresponding values of the log likelihood it can be seen that a cp in 1975 results in a value for the profile log likelihood that is close to the minimum and that the pseudo log likelihood values are close to the profile log likelihood value for 1975 for 1957 the clmo and cmom parameter approximations of the location are close to the cml value but the scale parameter estimates are different this results in a large deviation of the pseudo log likelihood value from the profile log likelihood value for 1957 4 3 case study 3 in jandhyala et al 2010 the annual average rainfall time series from 1884 to 1996 at tucumán in argentina was investigated and a cp was found in 1956 by a bayesian method the result was confirmed by wu et al 2001 they believed the change was caused by the construction of a dam in tucumán from 1952 to 1962 fig 11 e shows the data and the cp in 1956 in fig 11 f h the results of cml and clmo with different distributions are shown the value of δ μ σ 0 75 suggests that the uncertainty here will be bigger this is confirmed by the results all three methods generate curves with several local minima a global one at 1955 and a deep local one near 1972 this leads to relatively high uncertainties for ln and ga the uncertainties 0 43 to 0 47 are still low enough to make the presence of a change point probable further investigation is needed to determine whether or not this type of curve means that a check for multiple change points should be made extension of the methods discussed here to multiple change points would involve the use of 2d confidence sets 5 conclusion and discussion this study proposed new parametric methods to quantify the uncertainty in the location of a cp the methods discussed here are intended for situations where it is of interest to look for the location of a cp and the statistical properties of the time series are sufficiently clear to determine expressions for the likelihood or pseudolikelihood to keep the description of the methods readable only the amoc case with i i d rvs in the sub series was presented extension to multiple cps and or series with short range dependence is possible in principle and will be investigated in future articles furthermore when the methods as described in this study were applied to time series with short range dependence they still worked although the performance was reduced the question of how to detect cps in time series resulting from long memory processes is a different topic berkes et al 2006 aue and horváth 2012 moreover it turns out that distinguishing between long memory processes and short memory processes with shifting means is quite difficult rea et al 2011 the two new methods clmo cmom were compared to a method cml described in cunen et al 2018 all methods were able to detect changes in the mean and in the standard deviation they all involve a choice of a distribution family that is used to define a likelihood function for the cp in this likelihood function the parameters of the distribution are nuisance parameters it would be possible to add an additional nuisance parameter to represent dependence the cml method deals with the nuisance parameters by using a profile likelihood the cmom and clmo methods use a pseudolikelihood with parameter estimates based on moments and l moments respectively all methods define a deviance function based on the likelihood for the possible cp locations an mc calculation is then used to assign approximate probabilities to the deviance function values these approximate probabilities then define the confidence curve the reason for the introduction of cmom and clmo is that cml which uses ml parameter estimates can be very costly in terms of computations and therefore in terms of time even for the gamma and gumbel distributions where the ml method is relatively cheap the cost of cml was at least 8 times that of cmom a statistical analysis of the results of a large number of synthetic data series of two lengths 40 and 100 showed that clmo cmom and cml performed equally well performance in terms of actual coverage of the associated confidence sets for high confidence levels was satisfactory and nearly independent of series length coverage for lower confidence levels was very conservative due to the discrete nature of the cp variable for all distributions the confidence curves produced by clmo cmom and cml were very close to each other so using clmo or cmom instead of cml does not result in loss of quality in this article un was introduced to provide a summary of the uncertainty about the cp location shown by a confidence curve the amount of uncertainty about the cp location decreased with increasing series length and or with increasing size of the change at the cp given that a longer series provides more data and that a larger change should be easier to distinguish from random noise this was to be expected preliminary findings suggest that a test based on un may perform on a par with the classical pettitt test as long as the series are not too short and the change is large enough this would combine in one method a null hypothesis test and confidence set estimates of cp location at multiple confidence levels when applied to measurement series from literature all methods produced results compatible with the results reported in the literature in fact in all cases where the literature reported one or more cps the lowest point on the confidence curve coincided with one of those cps a somewhat surprising but most welcome result was that the choice of distribution gumbel gamma or log normal used to calculate the likelihood had very little influence on the ability of the methods to recover information on a possible cp from the measurement series to see if this holds more generally more experiments with both synthetic data series and measurement time series are planned both the experiments on synthetic data series and the results for measurement time series suggest that the series should have a length of about 100 points and changes in the mean are detected if they exceed one standard deviation for changes in the standard deviation more experiments are needed to see how absolute or relative size of the change influences the method sensitivity the two new methods clmo and cmom introduced in this article complement the aed bp method from zhou et al 2020 the aed bp method has as advantage that it is non parametric and relatively fast but it tends to generate confidence curves with somewhat larger and therefore less informative confidence sets moreover it needs an additional calculation to properly detect changes in standard deviation a viable approach would be to start with aed bp apply clmo when the results are not conclusive or a change in the mean is not expected and use the more expensive cml method when the clmo results still display large uncertainty credit authorship contribution statement changrang zhou writing original draft writing review editing investigation conceptualization formal analysis data curation methodology software ronald van nooijen supervision formal analysis software writing review editing validation conceptualization alla kolechkina formal analysis validation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partially developed within the framework of the panta rhei research initiative montanari et al 2013 mcmillan et al 2016 of the international association of hydrological sciences iahs by the members of the working group on natural and man made control systems in water resources the authors would like to thank j reeves university of georgia k jandhyala washington state university and d m bayer federal university of rio grande do sul for sharing their data which allowed us to test our methods the authors also thank a viglione politecnico di turino for his valuable comments on a draft of this article our special thanks to t iliopoulou and an anonymous reviewer for their comments insightful questions and suggestions funding this work was supported by the china scholarship council under grant number 201706710004 appendix a confidence curves in the literature the definition of confidence curves has evolved over time an early definition was given by birnbaum 1961 who defined a confidence curve as a set of upper and lower confidence limits at each confidence coefficient from 0 5 to 1 inclusive schweder and hjort 2016 definition 4 3 gave a more general abstract definition of a confidence curve a variation on that definition is given below in this paper γ is used to denote a confidence level as opposed to cunen et al 2018 and zhou et al 2020 where α is used for more details on confidence curves please consult zhou et al 2020 appendix a definition 1 if λ is a parameter of a random sample x then a confidence set for λ with confidence level γ is a random set r x such that a 1 pr λ r x γ where pr e denotes the probability of event e a confidence set is a generalized confidence interval the standard concepts that hold for confidence intervals can therefore be extended to confidence sets a confidence set with confidence level γ has anominal coverage probability of γ in other words it is constructed to contain λ with a probability γ however the construction may use approximations therefore the actual coverage probability is defined which is the probability that λ is in r x when the set is actually constructed for a sample taken from x the actual coverage probability can be estimated by mc experiments if the actual coverage probability is smaller than nominal coverage probability γ the set is called permissive when the actual coverage probability is larger than γ the set is called conservative definition 2 suppose x is a random sample of size n and λ is a parameter of the random sample with values in a value set v a function g λ x with range 0 1 that is continuous in x for fixed λ is a confidence curve when 1 there is a point estimator λ ˆ for λ such that a 2 min λ v g λ x g λ ˆ x x 0 for all realizations x of x 2 for the true value λ true of the property λ the rv g λ true x has the uniform distribution on the unit interval the estimate λ ˆ x is merely a reference point it is the confidence curve as a whole that is meaningful if cc is a confidence curve according to definition 2 then for fixed λ 0 the function cc λ 0 x is a rv hence we can speak of the distribution of cc λ 0 x if λ true is the true value of λ then for a given confidence level γ 0 1 cc λ true x is uniformly distributed on 0 1 therefore a 3 pr cc λ true x γ γ now define confidence sets r γ x λ cc λ x γ with a confidence level γ by definition λ true r γ x if and only if cc λ true x γ so a 4 pr λ true r γ x pr cc λ true x γ γ note that the confidence sets r γ x are nested sets because they are derived from a confidence curve appendix b a summary of total uncertainty for a confidence curve to have a reference for the size of confidence sets for cps we introduce the following notation for a set s with a finite number of elements let s denote the number of elements and let choice k s denote a random set obtained by drawing k elements from s at random without replacement and with equal probability of selection for each element now for a given fixed element s 0 s n s and a given value 0 γ 1 the following equations hold b 1 pr s 0 choice k s k n b 2 pr s 0 choice γ n s γ n n γ where r min k z k r visual inspection of a confidence curve cc can give a subjective impression of the location of the cp and its uncertainty but a more objective measure would be needed for automated analysis of large sets of time series in the case that the cp is restricted to l cp defined in 1 it is easy to define random sets such that the probability that the true cp τ true lies in the set is approximately γ independently of the properties of the sample simply take b 3 r γ choice γ n 2 n min 1 l cp which has a coverage probability of b 4 pr τ true r γ x γ n 2 n min 1 n 2 n min 1 γ for a realization r γ of a confidence set with confidence level γ for a cp restricted to l cp we take as a summary of relative uncertainty b 5 un r γ r γ 1 γ n 2 n min now for large n the value of un r γ is zero for a one point set approximately one for a realization of r γ and larger than one for very uninformative sets this measure is useful for a set at a given confidence level but for automated analysis of a cc a level needs to be selected the highest confidence level for which a non trivial r γ can be constructed for which the equals sign holds is b 6 γ max n 2 n min n 2 n min 1 so that is the level that will be used for un applied to a confidence curve is defined as leaving out the factor 1 γ max b 7 un cc k n min n n min 1 cc k γ max 1 n 2 n min appendix c the effect of shifting or scaling the time series on the confidence curve c 1 location scale distribution families if the pdf f x θ with θ ξ ς is of the form c 1 f x θ 1 ς g x ξ ς where ξ is the location and ς is the scale then for the cml method it can be shown that the deviance function d prof τ a y b is equal to d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy c 2 ξ a y b a ξ y b c 3 ς a y b a ς y if d τ a y b d τ y then tests on synthetic time series with θ l 0 1 while varying θ r are representative for the performance of the method c 2 distribution families with a scale parameter if the pdf f x θ with θ ς η is of the form c 4 f x θ 1 ς g x ς η where ς is the scale and η is a shape parameter then for the cml method it can be shown that d prof τ a y d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy c 5 ς a y a ς y c 6 η a y η y if d τ a y d τ y then tests on synthetic time series with θ l 1 ς l 1 while varying the other parameters are representative for the performance of the method appendix d details on pdfs and parameter estimates d 1 location scale distribution families if the pdf f x θ with θ ξ ς is of the form d 1 f x θ 1 ς g x ξ ς where ξ is the location and ς is the scale then for the cml method it can be shown that the deviance function d prof τ a y b is equal to d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy d 2 ξ a y b a ξ y b d 3 ς a y b a ς y if d τ a y b d τ y then tests on synthetic time series with θ l 0 1 while varying θ r are representative for the performance of the method d 2 distribution families with a scale parameter if the pdf f x θ with θ ς η is of the form d 4 f x θ 1 ς g x ς η where ς is the scale and η is a shape parameter then for the cml method it can be shown that d prof τ a y d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy d 5 ς a y a ς y d 6 η a y η y if d τ a y d τ y then tests on synthetic time series with θ l 1 ς l 1 while varying the other parameters are representative for the performance of the method appendix e the computational cost of the methods for a time series of length n with n mc runs for distribution approximation all three methods cml clmo cmom need 1 n n 2 n min 1 deviance calculations each deviance calculation needs 2 n 2 n min 1 parameter estimates and n 2 n min 1 n calculations of the logarithm of the pdf each pair of ml parameter estimates will need at least n calculations of the logarithm of the pdf the costs of a pair of mom or lmo parameter estimates may be lower but will still be on the order of n arithmetic operations a relatively big difference in cost occurs for those distributions where ml needs to solve a minimization problem while mom and lmo provide explicit formulas for all methods the total number of operations for one sample will be e 1 o 1 n n 2 n min 1 2 n where o stands for on the order of the difference in cost between the methods does not show up in the o notation because it arises from multiplication factors that do not depend on n a mom or lmo parameter estimate involves on the order of n additions and multiplications plus a constant number of more complex operations an ml estimate where the solution is not available in explicit form will involve solving a minimization problem this in turn may involve between 5 and 20 evaluations of expressions derived from the log likelihood while these evaluations are order n in the operations count they are likely to be more costly perhaps a factor of 2 to 10 than the order n addition and multiplication operations needed by mom and lmo so in theory ml may well take anywhere from 10 to 200 times as long for gu and ga where the ml problems correspond to a one dimensional search for the point where a nonlinear function is zero in practice the cost of ml was between 8 and 11 times that of cmom with n 100 and n 1000 the computational cost is not negligible when one of these methods is itself analyzed statistically for instance by studying m 1000 time series this becomes a major problem for n min 1 n 100 and m n 1000 the cost exceeds o 1 0 12 calculations of the logarithm of the pdf in practice for one series taken from the ga distribution with n 100 n min 9 and n 1000 a cml curve for one series took 314 seconds and cmom took 37 seconds counting flops is complicated by the presence of the log and gamma functions calculating flop rates is difficult because the current implementation is in matlab not in c or fortran moreover runs for different parameter sets were done in parallel the calculations were performed on a six core intel xeon w 2133 at 3 60 ghz a rough estimate of the code performance would be between 0 04 clmo and 0 4 cml gflops per core intel 2020 gives an adjusted peak performance app of 160 gflops so about 27 gflops per core in theory there is room for improvement but to verify this an optimized implementation in a compiled language would be needed appendix f case study 4 four time series of annual maximum discharge on the yangtze river in china were analyzed by classical methods pettitt cusum cramér von mises in zhou et al 2019 and by nonparametric confidence curves in zhou et al 2020 the stations cuntan yichang hankou and datong along the yangtze river were selected to examine the impacts from the construction of the three georges dam construction officially started in 1994 there followed a series of interventions in the flow of the yangtze river first by partial damming and then by the filling in stages of the reservoir construction was completed in 2009 but the reservoir was not yet completely filled at that point for cuntan which lies upstream of the three gorges dam a time series of annual maximum flow from 1893 to 2014 was examined earlier studies did not find clear cps all confidence curves in fig f 12 b d show that there is no clear indication of a cp all un values are near one this strongly suggests that there is no cp for yichang which lies about 40 km downstream of the three gorges dam a time series of annual maximum flow from 1946 to 2014 was examined an earlier study found a possible cp in 1962 xie et al 2014 in zhou et al 2019 cusum found a cp in 1962 while pettitt and cramér von mises found a cp in 1966 all confidence curves in fig f 12 f h show that there is a clear cp near 1962 at the 95 confidence level the ln and ga based methods provide a set with about 7 candidates while for gu cml selects 4 years and clmo selects 2 years the value of δ μ σ at the cp in 1962 is near one for hankou approximately 700 km downstream of the three gorges dam a time series of annual maximum flow from 1950 to 2014 was examined earlier studies did not find clear cps all methods except for clmo with gu have un close to one see fig f 13 b d however given the closeness of the lowest point on the confidence curve to the end of the series and the narrowness of the 80 confidence set more data is needed to decide whether there is a cp near 2005 or not for datong about 1200 km downstream of the three gorges dam a time series of annual maximum flow from 1952 to 2014 was examined earlier studies did not find clear cps again all methods have a un that is nearly one see fig f 13 f h the shape of the confidence curve suggests that more data is needed to decide whether or not there is a cp near 2003 appendix g effects of short range dependence autoregressive time series of order one ar 1 with an underlying ln distribution were generated according to the procedure used by vogel et al 1998 summarized below first an ar 1 model is used to generate a time series y k g 1 y k ϕ y k 1 g k for k 1 2 where y 0 is normally distributed with mean μ and standard deviation σ the g k are i i d according to a normal distribution with mean μ 1 ϕ μ and standard deviation σ 1 ϕ 2 and y 0 is independent of all g k next a time series y k is obtained by setting g 2 y k exp y k if g 3 μ log μ 1 σ 2 μ 2 g 4 σ log 1 σ 2 μ 2 g 5 ϕ log ρ exp σ 2 1 1 σ 2 then y k will have a ln distribution with mean μ and standard deviation σ the series y k will have lag one autocorrelation ρ eq g 3 differs from eq 2 in vogel et al 1998 because of a typing error when needed a cp at k is introduced by starting a new series with initial value y k but μ and σ derived from μ r and σ r these are preliminary results for groups of 100 samples instead of the groups of 1000 samples used in the main paper samples were generated using the multfibonacci random number generator from matlab fig g 14 shows that the confidence curves still have their minimum close to the actual cp the algorithms used the multfibonacci generator from matlab to obtain random numbers figs g 15 and g 16 show that due to the difference between the assumed i i d ln distribution and the actual ar 1 ln distribution the actual coverage becomes increasingly permissive and the uncertainty about the cp increases 
2338,the representation of uncertainty in results is an important aspect of statistical techniques in hydrology and climatology hypothesis tests and point estimates are not well suited for this purpose other statistical tools such as confidence curves are better suited to represent uncertainty therefore three parametric methods to construct confidence curves for the location of a sudden change in the properties of a time series a change point cp are analyzed for three distributions log normal gamma and gumbel two types of change are considered a change in the mean and a change in the standard deviation a question that confidence curves do not answer is how likely the null hypothesis of no change is a possible statistic to help answer this question denoted by un is introduced and analyzed it is compared to the statistic that underlies the pettitt test all methods perform well in terms of coverage and confidence set size one method is based on the profile likelihood for a cp the other two first defined in this article on the pseudolikelihood for a cp the main advantage of the pseudolikelihood over the profile likelihood lies in the much lower computational cost the confidence curves generated by the three methods are very similar in a limited test on time series of measurements found in the literature the methods gave results that largely matched those reported elsewhere some results are also given for an order one autoregressive series with a lognormal marginal distribution keywords confidence curves pseudolikelihood likelihood change point detection structural break l moments method of moments uncertainty data availability the authors do not have permission to share data 1 introduction today the need to take into account climate variability and the results of human interventions in water management and hydrology seems clear kolokytha et al 2017 teegavarapu 2018 to do so it is necessary to combine statistical information obtained from hydrological and climatological time series with investigations of how the natural variations in the behavior of the physical system and human alterations of that system could result in changes in those time series and link the changes suggested by statistics to physical causes tao et al 2011 while this will often be a search for trends or periodic changes the time series in question must also be tested for abrupt changes either to find real changes tao et al 2011 harrigan et al 2014 or to see whether it is necessary to split a series into two parts for further analysis cong et al 2017 beaulieu et al 2012 mention that an abrupt change in the statistical properties of a time series could signal an undocumented change in the measurement procedure a general overview of change detection is given in kundzewicz and robson 2004 in this article the emphasis is on abrupt changes but please keep in mind that for instance the initial filling of a reservoir may take several years so it may look as a trend on a daily scale and as a jump in the time series of annual maximum flows there have been many publications on the detection of an abrupt change or change point cp in hydrology and climatology beaulieu et al 2012 conte et al 2019 xie et al 2014 xiong and guo 2004 theoretical work on cp detection in general was done for example by pettitt 1979 chen and gupta 2001 2011 or brodsky and darkhovsky 2013 there are many statistical tools that can be used to detect the presence of cps ideally such a tool should provide information on the uncertainty in the location of the cp the traditional tests such as the one presented in pettitt 1979 focus on the acceptance or rejection of the null hypothesis that there is no cp at a given significance level a form of null hypothesis significance testing nhst if the null hypothesis is rejected then the cp is assumed to be at the location that results in the largest value for the test statistic such a point estimate gives no indication of the probability that this is the true cp location in the literature the emphasis tends to be on determining whether or not there is a cp and delivering as point estimate of the cp location attention for the uncertainty in its location is limited based on web of science search it seems that less than 10 of the papers dealing with cps uses a method that does more than deliver a point estimate this also holds when only papers dealing with environmental times series are considered of those relatively rare papers that deal with the uncertainty in the cp location most use bayesian methods examples of bayesian methods are easier to find see for instance perreault et al 1999 2000 or for a hierarchical bayesian version belisle et al 1998 chu and zhao 2004 bayesian methods require prior distributions for all parameters and they can be computationally intensive a rare example of a frequentist paper that looks into uncertainty is hušková and kirch 2008 where a bootstrap based method is used to construct confidence intervals for cps strictly speaking the methods discussed in this article serve a different purpose than nhst and they are not designed to reject or not reject the null hypothesis however experiments showed that from the confidence curves a number may be calculated that may serve the same purpose as the original p value namely to indicate data worthy of a second look nuzzo 2014 this is of interest in situations where a large set of time series is studied and it would not be feasible to analyze all confidence curves by eye different thresholds for that value could then be used to separate the set into three groups curves that provide clear information on the location of a cp curves that provide no information on the location of a cp and curves that need to be investigated further a possible candidate for such a number is the function un introduced in this paper as in all of statistics there are parametric and nonparametric methods the nonparametric methods avoid the choice of a distribution for the time series but they tend to specialize in detecting changes in either the mean or the standard deviation not both at the same time eastwood 1993 the parametric tests can look for changes in all parameters of the underlying distribution for hydrological meteorological or climatological time series the distribution may or may not be known sheskin 2003 pp 97 98 states that while parametric tests generally provide a more powerful test of the alternative hypothesis they may lose that advantage if the assumptions underlying the test are violated an example of a nonparametric detection method using confidence curves can be found in zhou et al 2020 it therefore makes sense to examine both types of cp tests the current article examines two parametric approaches while the emphasis is on detection of changes in the mean additional experiments showed that the same algorithm is equally sensitive to changes in the standard deviation both parametric approaches belong to the domain of parametric statistics and represent uncertainty by a confidence curve both use a likelihood where the location of the cp the distribution parameters to the left of the cp and the distribution parameters to the right of the cp are free variables one then introduces a profile likelihood the other introduces a pseudolikelihood a method based on the first approach can be found in cunen et al 2018 where it is called method b method b is based on a calculation of the log likelihood of the time series for all possible cp locations in this calculation the parameters of the distribution to the left and to the right of the cp are so called nuisance parameters their values are needed to calculate the log likelihood but are not of intrinsic interest a profile log likelihood approach is used to calculate the log likelihoods the resulting log likelihood values for the potential cps are used to construct a deviance function next monte carlo mc simulation is used to approximate the distribution of the values of the deviance function for each potential cp this approximate distribution is then used to build a confidence curve in the remainder of this study this method will be referred to as confidence curve based on maximum likelihood parameter estimation cml a potential problem with this method is that it is very computationally intensive even in the case of just one cp two optimizations of a log likelihood need to be done for each possible cp location to determine the profile log likelihood moreover a mc simulation is needed to determine an approximate distribution for each possible cp location this mc simulation needs to repeat the profile log likelihood calculation as often as is needed to obtain an approximate distribution as shown in appendix e this leads to a computational complexity linearly proportional to the number of samples in the mc simulation and proportional to the cube of the time series length run times on a desktop workstation may take hundreds of seconds for a single sample removal of the maximum likelihood optimization can reduce the computational cost considerably this is the chief reason to examine the second approach the current study presents two methods based on the second approach which uses pseudolikelihood more information on pseudolikelihood can be found in for example gong and samaniego 1981 distribution parameters are estimated by the method of moments mom or l moments lmo this reduces the computational cost of the likelihood calculations moreover fast code for these methods is often easier to obtain than for log likelihood optimization these methods will be referred to as confidence curve based on method of moments parameter estimation cmom and confidence curve based on l moments parameter estimation clmo respectively as the experimental results for cmom and clmo were very similar only cml and clmo results are reported in this study to verify that clmo cmom works it should be demonstrated that the results obtained are similar to those of cml as hydrological time series are relatively short asymptotic results on the performance of the methods may not be valid therefore it is necessary to generate statistics on the performance of all methods through computer experiments in this study this has been done for several two parameter distributions where the cost of the maximum likelihood calculations is still manageable log normal ln gamma ga and gumbel gu for ease of interpretation of the results clarity of method representation and to keep the computing time needed down to a manageable level only the case of at most one change amoc is considered the equations used in the methods are derived for independent identically distributed i i d random variables rvs the methods are based on pseudolikelihood and in principle they can be extended to time series with short range correlation see also aue and horváth 2012 for other deviations from the i i d assumption such as periodic components or trends methods that have been applied in combination with other cp detection schemes should work here as well preliminary results on series with short range dependence show that the methods with formulas based on i i d still work but information about uncertainty decreases in quality see appendix g finally with regard to long range dependence aue and horváth 2012 state that tests for structural stability that are designed for the i i d or short range correlation case are not robust against long memory moreover time series with short range correlation and change points may be difficult to distinguish from time series with long memory berkes et al 2006 the remainder of this paper is organized as follows first the two approaches to confidence curve construction are presented next indicators are defined that can be used to evaluate the method performance and compare the confidence curves then the results of the application of the methods to synthetic data are analyzed after that the methods are applied to several hydrological and climatological time series for which cp detection results are available in the literature finally we discuss the results and present our conclusions mathematical details can be found in appendices a e in appendix f several time series of annual maximum flows for different stations downstream of the site of the three gorges dam are checked for cps 2 methodology all time series will be modeled as a vector y of n independent rvs y 1 y 2 y n in the remainder of the paper y will represent a realization of y and y obs will represent the actual observed time series the null hypothesis h 0 will be that the y i are i i d rvs the alternative hypothesis h 1 will be that there is an index τ 1 2 n 1 such that the original random vector is split into two subseries a subseries with i i d rvs y 1 y 2 y τ and a subseries with i i d rvs y τ 1 y τ 2 y n but the distributions of the variables in the two subseries are different furthermore it is assumed that all distributions are from the same family so they differ only in the parameters used in the shared probability density function pdf and cumulative distribution function cdf the cdf of y i will be referred to as f θ and the pdf as f θ where θ is a vector the parameter vectors for the left and the right subseries will be θ l and θ r respectively the null hypothesis can now be expressed as θ l θ r both approaches need to approximately solve maximum likelihood problems for the subseries to the left and to the right of the change point τ intuitively it is clear that parameter estimation for very small samples will be difficult some studies considering this are lettenmaier and burges 1982 delicado and goria 2008 landwehr et al 1979 these suggest that for short subseries the results may vary considerably from sample to sample a minimum subseries length n min will therefore be used as a result only a subset of cp locations given by 1 l cp n min n min 1 n n min was considered and no parameter estimates for subseries shorter than n min were carried out the choice of n min is to a certain extent arbitrary here we take a minimum subseries length 2 n min 2 log n where the notation denotes rounding down towards the nearest integer n min 1 corresponds to considering all possible cps one reason to consider trimming is that the variance in parameter estimates tends to decrease with increasing sample size as a result a short sequence may lead too much wilder parameter estimates than a long sequence landwehr et al 1979 this would seem undesirable when looking for parameter changes 2 1 a description of the two approaches the starting point for both approaches is the log likelihood function ℓ for a cp problem the value of ℓ for a cp τ distribution parameter vectors θ l and θ r and a realization y of the time series is 3 ℓ τ θ l θ r y i 1 τ log f y i θ l j τ 1 n log f y j θ r τ 1 2 n 1 here θ l and θ r are vectors of nuisance parameters and τ is the parameter of interest a common way of dealing with nuisance parameters is the following for each τ take the supremum least upper bound of 3 over all θ l θ r the resulting function is called the profile log likelihood 4 ℓ prof τ y sup θ l θ r ℓ τ θ l θ r y for a closed bounded parameter set the supremum coincides with the maximum for a given τ let θ ˆ l τ y and θ ˆ r τ y stand for the values of θ l and θ r respectively for which ℓ τ θ l θ r y attains the maximum value with this notation 4 is equivalent to 5 ℓ prof τ y ℓ τ θ ˆ l τ y θ ˆ r τ y y in cml θ ˆ l τ y and θ ˆ r τ y are calculated whenever needed the smallest value of τ l cp for which ℓ prof is maximal will be denoted by τ ˆ y 6 τ ˆ y min arg max τ l cp ℓ τ θ ˆ l τ y θ ˆ r τ y y the minimum is taken to allow for the highly unusual case where there are multiple maxima in clmo cmom instead of a profile log likelihood ℓ prof a pseudo log likelihood ℓ pseu is used to obtain ℓ pseu the lmo mom estimates θ l τ y and θ r τ y of the nuisance parameters are inserted in 3 7 ℓ pseu τ y ℓ τ θ l τ y θ r τ y y these estimates are assumed to be acceptable approximations of the maximum likelihood estimation results the smallest value of τ l cp for which ℓ pseu is maximal will be denoted by τ y 8 τ y min arg max τ l cp ℓ τ θ l τ y θ r τ y y from this point onwards all methods follow the same path towards a confidence curve a deviance function for cml is defined as the deviance of ℓ prof from the maximum value it attains at τ ˆ y 9 d prof τ y 2 ℓ prof τ ˆ y y ℓ prof τ y and a deviance function for clmo cmom is defined as the deviance of ℓ pseu from the maximum value it attains at τ y 10 d pseu τ y 2 ℓ pseu τ y y ℓ pseu τ y for all τ l cp the distribution of the deviance function for cml follows from 11 r r k τ prof r pr d prof τ y r τ θ l θ ˆ l τ ˆ y y θ r θ ˆ r τ ˆ y y and for clmo cmom from 12 r r k τ pseu r pr d pseu τ y r τ θ l θ l τ y y θ r θ r τ y y no exact or approximate expression for k τ is available therefore an mc simulation will be used to approximate k τ in cunen et al 2018 and in this paper a confidence curve see also appendix a is defined using the distribution of the deviance function 13 cc τ y obs k τ d τ y obs where y obs is an observation of the random sample y the mc approximation of k τ is obtained as follows 1 estimate parameters τ θ l θ r by first solving for τ y obs and then calculating θ l τ y obs y obs and θ r τ y obs y obs 2 for each possible location τ l cp and j 1 2 n draw a new sample y j k where the components y i j k k 1 2 τ are distributed according to the distribution f θ with θ θ l τ y obs y obs and the components y i j k k τ 1 τ 2 n are distributed according to the distribution f θ with θ θ r τ y obs y obs 3 approximate the confidence curve cc τ y obs k τ d τ y obs by 14 k τ n d τ y obs 1 n j 1 n 1 d τ y d τ y obs where 1 is the indicator function 15 1 a b 0 a b 1 a b and τ is τ ˆ for cml and τ for clmo cmom and θ is θ ˆ for cml and θ for clmo cmom standard software is not yet available for the methods a custom implementation in matlab was written where necessary random numbers were obtained from the threefry type random number generator in matlab 2 2 properties of confidence curves the performance of cml and clmo cmom methods will be examined and compared by exploring some properties zhou et al 2020 of confidence curves constructed by the two methods they are the cumulative frequency distribution of the τ ˆ y for cml and τ y for clmo cmom based on synthetic data when the null hypothesis h 0 there is no cp holds in this case the distribution should be close to uniform if it is not uniform then it indicates that there is a bias for certain locations when a type i error incorrect rejection of the null hypothesis occurs the cumulative frequency distribution of the τ ˆ y and τ y for synthetic data when the alternative hypothesis h 1 there is a cp holds while the point where the deviance function is zero is not necessarily the true cp it is contained in all confidence sets that follow from the confidence curve if these sets are narrow then this point should be near the true cp for a definition of a confidence set see definition 1 in appendix a the actual versus nominal coverage probability for the confidence sets produced by the curves at all confidence levels for synthetic data the actual coverage probability at a given confidence level nominal coverage probability indicates the probability of a confidence set containing the true value of the parameter of interest for detailed definitions of actual and nominal coverage probability see definition 1 in appendix a a summary of the uncertainty about the cp associated with a confidence curve cc is defined in appendix b by b 7 un cc k n min n n min 1 cc k γ max 1 n 2 n min where γ max n 2 n min n 2 n min 1 the similarity index is used to measure the similarity of two confidence curves 16 j cc cc k n min n n min min 1 cc k 1 cc k k n min n n min max 1 cc k 1 cc k where cc and cc are a pair of confidence curves this index was proposed in zhou et al 2020 and resembles the ružička index schubert and telcs 2014 it is one for identical curves and smaller than one for curves that differ 2 3 synthetic time series generation and examples of confidence curves the cml and clmo cmom methods were implemented for three distributions ln ga gu to evaluate the performance of cml and clmo cmom synthetic data were generated from the underlying distributions the distributions were selected because they are commonly used in hydrology hamed and rao 2019 thompson 2017 haktanir 1991 karim and chowdhury 1995 the pdfs and the relations between the parameters and moments and l moments are given in appendix d the change in statistical properties of the synthetic data was a change in the mean μ for cml cmom and a change in the mean or in the standard deviation σ for clmo for each distribution and each combination of a change in the mean δ μ 1 2 4 and a series length n 40 100 a set of m 1000 artificial time series of length n with standard deviation σ 1 τ n 4 n 2 3 n 4 and a jump δ μ in the mean between τ and τ 1 was generated the location of the cp during sample generation will be referred to as τ true in this study the mean of a specific distribution for the subseries up to τ was μ l 2 and the mean for the subseries after τ was μ r μ l δ μ where δ μ 1 2 4 examples of synthetic data sets with δ μ 0 1 2 and the corresponding confidence curves for cml and clmo are given in fig 1 a f the standard deviation for the left and right subseries will be referred to as σ l and σ r respectively additional experiments were done for clmo with μ r μ l σ r σ l δ σ where δ σ 1 2 3 examples of data series synthetic data sets with δ σ 0 1 2 are given in fig 1 g l the effect of shifting different μ l or scaling different σ l a time series is discussed in appendix c where necessary random numbers to generate samples were obtained from the twister type random number generator in matlab 3 evaluation of the methods for synthetic data the performance of the confidence curves produced by cml and clmo cmom as represented by the properties listed in section 2 2 are examined for all methods n 1000 mc simulations were used to generate the approximate confidence curve the majority of the experiments involved a change in the mean however one advantage of a parametric method is that it looks for changes in all parameters at the same time so some experiments were performed for synthetic series with a change in the standard deviation as well 3 1 the cumulative frequency distribution of the cp estimate the methods produce confidence curves instead of point estimates these confidence curves are characterized by their shape and the location of their minimum in the remainder of the paper the minimum of the confidence curve will be referred to as the point estimate of the cp 3 1 1 the cumulative frequency distribution of the cp estimate when the null hypothesis holds fig 2 shows the cumulative frequency distribution of the cp estimates found by cml and clmo when the null hypothesis holds no cp in this case if the method is forced to select a cp then it should not display a preference for any particular cp the possible candidates are the elements of the set l cp defined in 1 the black line in fig 2 a c shows the corresponding uniform frequency distribution on that set the experimental results do not match this exactly but do approximate it the methods have a slight preference for points near the middle of the time series for ln ga and gu the methods cml and clmo give similar results 3 1 2 the cumulative frequency distribution of the cp estimate when the alternative hypothesis holds figs 3 a f show the frequency distribution of detected cps by cmlo when the alternative hypothesis holds for τ true n 4 n 2 3 n 4 and n 40 100 figs 3 g l show the equivalent results for δ σ 1 2 for clmo the minima of the confidence curves for the different samples are spread around the true cp results for cml with a change in the mean are similar the spread decreases with increasing δ μ δ σ and n for example for δ μ 1 and n 100 about 90 of the estimates lie within 10 points of the actual cp for δ μ 2 the spread reduces to 5 points on average the cp estimates are closer to the true value for changes in the mean than for changes in the standard deviation the frequency distributions found by all methods for synthetic time series drawn from the three distributions are very similar 3 2 actual versus nominal coverage probability the difference between the actual and the nominal coverage of the confidence sets defined by the confidence curve is quite important for their practical use if the actual coverage of a confidence set is lower than the nominal one then it is permissive appendix a this may cause problems because it suggests too much certainty about the cp location if the set were a person then that person would be overconfident if the actual coverage probability exceeds the nominal coverage then the set is conservative while this is less problematical than permissiveness it suggests too much uncertainty the set would please an overcareful person the actual coverage was estimated as follows synthetic time series with indices m 1 2 m were generated and for each time series m the confidence curve and the confidence set r γ m at confidence level γ were determined finally the number k of sets for which τ true r γ m was divided by m in fig 4 plots of the actual versus nominal coverage are shown when interpreting fig 4 it is important to recall that if a cp is present then there is only a finite number of possible locations for that cp this in turn means that if the construction method for the curve makes very good use of the information in the sample then it may result in confidence random sets that contain only one or two points but have a very high probability of containing the actual cp this implies that for low confidence levels the sets will be very conservative this manifests itself in fig 4 where in a the actual coverage is always above 37 for δ μ 1 it always exceeds 65 for δ μ 2 in b and in c it is higher than 70 for δ μ 2 in fig 4 d f it can be seen that for changes in the standard deviation the actual coverage and nominal coverage start to coincide at lower values it follows that in practice the confidence sets with relatively high nominal confidence carry the best information the sets at low confidence levels are much too conservative the results for cml show that all distributions provide accurate actual coverage for nominal coverages above 90 for changes in the mean the results for clmo cmom are nearly identical to those for cml results for n 40 were generated as well but the impact from series length on actual coverage probability was small so they have not been included here table 1 shows detailed information about actual versus nominal coverage for confidence curves constructed by cml and clmo for confidence levels γ 0 90 0 95 0 99 an indication of the spread in actual coverage can be provided as follows if the actual coverage were equal to the nominal coverage then the number k of m confidence sets r γ m m 1 2 m that contained the true cp would be distributed according to a binomial distribution 17 p r k m k γ k 1 γ m k for the binomial distribution the variance is m γ 1 γ so the standard deviation of k m is γ 1 γ m for m 1000 the standard deviation of the distribution of k for γ 0 90 is 0 009 for γ 0 95 it is 0 007 and for γ 0 99 it is 0 003 when combining this information with table 1 please recall that the location of the cp is a discrete rv so for some confidence levels it might not be possible to define a confidence set with that exact coverage 3 3 the uncertainty in the confidence curves as mentioned in the introduction it may be necessary to automatically split a set of confidence curves into groups for further analysis here un is proposed as a tool to do so one way to evaluate the suitability of un is to compare its associated type i and type ii errors to a classical hypothesis test for the null hypothesis that no cp is present for this purpose a comparison with the classical pettitt test is performed the value un for a confidence curve is calculated according to b 7 it summarizes the uncertainty of a confidence curve the bounds on un depend on the distribution and the parameters so in principle they should be determined by monte carlo experiments for each individual case in practice splitting the series into three classes definitely no cp definitely a cp and to be examined further might allow rough bounds to be established that depend only weakly on the distribution parameters see also appendix c 3 3 1 the uncertainty in the confidence curves for the null hypothesis the cml approach implicitly assumes that a cp is present so it would seem that it should be preceded by a test for the presence of a cp however if un is calculated for synthetic time series generated without a cp then it turns out to be quite high in most cases near one for 80 n 40 to 90 n 100 of all curves as shown in fig 5 examples of confidence curves for time series without a cp are shown in fig 1 a g as high un in the presence of a cp means that the method supplies only a very limited amount of information on cp location it is tempting to simply say that if un exceeds a certain bound then either there is no cp or the method cannot reliably detect the cp location for example fig 5b shows that for cml n 100 95 of all un values exceed 0 63 if that bound were used to reject the null hypothesis then for this particular distribution and this particular parameter set that choice would result in a 5 type i error the viability of this approach depends on the distribution of un in cases where the alternative hypothesis holds 3 3 2 the uncertainty of confidence curves for the alternative hypothesis fig 6 shows the frequency distribution of un for clmo when h 1 holds and the cp lies in the middle of the time series the values for cml for a change in the mean are very similar for n 100 δ μ 1 95 of the values lie below 0 4 for ln and for ga 95 of the un values lie below 0 45 fig 6b for δ μ 2 these bounds less than 0 1 for all distributions fig 6 d f show the frequency distribution for un when h 1 holds and the cp lies in the middle of the time series for n 100 δ σ 2 and the ln distribution 95 of the values lie below 0 35 for ga the 95 of the un values lie below 0 2 for gu 95 of the un values lie below 0 2 it should be noted that the scale parameter of ga equals the variance divided by the mean so for fixed mean it increases with the square of the standard deviation for higher standard deviations this leads to a distribution that tends to produce many low values with a few very high values mixed in special care may be needed in the calculations for low means and high standard deviation 3 3 3 uncertainty as a tool to select curves and data that need closer inspection there are two types of error that are of interest when testing a hypothesis if h 0 is rejected when there is no cp then that is a type i error and if h 0 is accepted when there is a cp then that is a type ii error for example for δ μ 1 n 100 and distribution ln fig 5 a implies that rejection of h 0 for un 0 2 would result in a very small type i error while fig 6 a implies that non rejection of h 0 for un 0 5 would result in a very small type ii error the subset of time series where 0 2 un 0 5 would then need further study by visual inspection or additional tests if none of the original time series actually has a cp then that subset would contain less than 5 of the original set of time series while if all series actually have a cp then that subset would contain about 30 of the original set fig 7 is based on the frequency distribution of un over the synthetic samples sets and shows how a particular choice of a un value as a bound for acceptance of h 0 would translate into type i and type ii errors for that set of samples for different applications of the methods the relative importance of the type i and type ii error will differ the point marked a corresponds to the un value for which the type i and type ii errors are equal for n 40 the point b corresponds to the un value for which the type i and type ii errors are equal for n 100 by plotting the value pairs of type i and type ii errors associated with a particular value of un over a range of un values it is possible to visualize the relation between the errors for n 100 and a change in the mean of 1 or 2 fig 7 a f shows that there are choices of un boundary that for these distributions and parameters result in both type i and type ii errors that are smaller than 5 for n 100 and δ σ 2 similar results are obtained for n 100 and δ σ 1 an upper bound of 5 on both errors can be achieved only for gu to see how a null hypothesis test based on un would do when compared with the classical pettitt test the curve of error pairs is drawn for both tests for a cp in the middle of the time series in fig 8 the results show that in principle un could even serve as the basis for a hypothesis test for a change in the standard deviation the standard pettitt test is much less effective fig 8g l a modification of that test specifically designed for the change to be detected would be needed here the test based on un is not the most effective for any particular change but it is the one that will detect changes in all parameters 3 4 the similarity index between confidence curves to evaluate the similarity between confidence curves for the same synthetic time series the similarity index j was calculated by 16 for δ μ 1 2 τ true n 2 and n 40 100 details on the calculation of j and its properties can be found in zhou et al 2020 appendix c fig 9 shows the resulting cumulative frequency distributions of j the confidence curves for synthetic data calculated by cml are very similar to those calculated by clmo the similarity increases with increasing δ μ and n for the gu distribution similarity seems lower to provide a point of reference for the similarity values j was calculated for 16000 random pairs of h 0 confidence curves the result was that 95 of the pairs had a similarity below 0 7 for all series lengths distributions and methods 4 change point detection and uncertainty in real hydrometeorological data to examine the performance of the cml and clmo methods on real world data three time series of measurements were taken from previous publications annual average naturalized flow at itaipu conte et al 2019 case study 1 annual average temperature at tuscaloosa reeves et al 2007 case study 2 and annual average rainfall at tucumán jandhyala et al 2010 case study 3 the cps found in the original studies are used as a reference both methods were used to construct confidence curves for cps with each of the three distributions ln ga and gu the uncertainties for the confidence curves were determined as was the similarity between the cml and clmo curve for each case the confidence set at confidence level 95 is also shown in appendix f the methods are applied to four time series of annual maximum discharge on the yangtze river in china that were also analyzed in zhou et al 2019 by a non parametric method case study 4 4 1 case study 1 conte et al 2019 found a significant cp in 1971 in the annual average naturalized flow at the itaipu hydroelectric plant in brazil from 1931 to 2015 by the bootstrap pettitt test in this case the value of δ μ σ 1 33 suggests cml and clmo should do reasonably well and so they do un is low 0 03 to 0 07 and j is high 0 96 all give a 95 confidence interval of about three years see fig 10 4 2 case study 2 the annual average temperature time series from 1940 to 1986 in tuscaloosa usa was selected because there was only one documented reason for a cp during this period the time series was used in reeves et al 2007 and a cp located at the year of 1957 was found by eight different methods the value of δ μ σ 1 33 again suggests the methods should do well both ln and ga based methods find a reasonably precise confidence curve for the cp with a 95 confidence interval 1955 1959 in this case gu is not doing as well as ln and ga moreover gu combined with clmo seems to be confused by the sudden drop from 1975 to 1976 fig 11 b d a possible explanation is the difference in parameters for the gumbel distribution found by the different methods while one would hope that cml cmom and clmo would give similar results all parameter estimates are rvs and their variance may be quite large for small samples given the very different formulas used to obtain the estimates it should not be surprising that without large samples to reduce the variance very different results can be found this in turn may lead to different points being selected as cp table 2 gives the estimated parameters and the corresponding values of the log likelihood it can be seen that a cp in 1975 results in a value for the profile log likelihood that is close to the minimum and that the pseudo log likelihood values are close to the profile log likelihood value for 1975 for 1957 the clmo and cmom parameter approximations of the location are close to the cml value but the scale parameter estimates are different this results in a large deviation of the pseudo log likelihood value from the profile log likelihood value for 1957 4 3 case study 3 in jandhyala et al 2010 the annual average rainfall time series from 1884 to 1996 at tucumán in argentina was investigated and a cp was found in 1956 by a bayesian method the result was confirmed by wu et al 2001 they believed the change was caused by the construction of a dam in tucumán from 1952 to 1962 fig 11 e shows the data and the cp in 1956 in fig 11 f h the results of cml and clmo with different distributions are shown the value of δ μ σ 0 75 suggests that the uncertainty here will be bigger this is confirmed by the results all three methods generate curves with several local minima a global one at 1955 and a deep local one near 1972 this leads to relatively high uncertainties for ln and ga the uncertainties 0 43 to 0 47 are still low enough to make the presence of a change point probable further investigation is needed to determine whether or not this type of curve means that a check for multiple change points should be made extension of the methods discussed here to multiple change points would involve the use of 2d confidence sets 5 conclusion and discussion this study proposed new parametric methods to quantify the uncertainty in the location of a cp the methods discussed here are intended for situations where it is of interest to look for the location of a cp and the statistical properties of the time series are sufficiently clear to determine expressions for the likelihood or pseudolikelihood to keep the description of the methods readable only the amoc case with i i d rvs in the sub series was presented extension to multiple cps and or series with short range dependence is possible in principle and will be investigated in future articles furthermore when the methods as described in this study were applied to time series with short range dependence they still worked although the performance was reduced the question of how to detect cps in time series resulting from long memory processes is a different topic berkes et al 2006 aue and horváth 2012 moreover it turns out that distinguishing between long memory processes and short memory processes with shifting means is quite difficult rea et al 2011 the two new methods clmo cmom were compared to a method cml described in cunen et al 2018 all methods were able to detect changes in the mean and in the standard deviation they all involve a choice of a distribution family that is used to define a likelihood function for the cp in this likelihood function the parameters of the distribution are nuisance parameters it would be possible to add an additional nuisance parameter to represent dependence the cml method deals with the nuisance parameters by using a profile likelihood the cmom and clmo methods use a pseudolikelihood with parameter estimates based on moments and l moments respectively all methods define a deviance function based on the likelihood for the possible cp locations an mc calculation is then used to assign approximate probabilities to the deviance function values these approximate probabilities then define the confidence curve the reason for the introduction of cmom and clmo is that cml which uses ml parameter estimates can be very costly in terms of computations and therefore in terms of time even for the gamma and gumbel distributions where the ml method is relatively cheap the cost of cml was at least 8 times that of cmom a statistical analysis of the results of a large number of synthetic data series of two lengths 40 and 100 showed that clmo cmom and cml performed equally well performance in terms of actual coverage of the associated confidence sets for high confidence levels was satisfactory and nearly independent of series length coverage for lower confidence levels was very conservative due to the discrete nature of the cp variable for all distributions the confidence curves produced by clmo cmom and cml were very close to each other so using clmo or cmom instead of cml does not result in loss of quality in this article un was introduced to provide a summary of the uncertainty about the cp location shown by a confidence curve the amount of uncertainty about the cp location decreased with increasing series length and or with increasing size of the change at the cp given that a longer series provides more data and that a larger change should be easier to distinguish from random noise this was to be expected preliminary findings suggest that a test based on un may perform on a par with the classical pettitt test as long as the series are not too short and the change is large enough this would combine in one method a null hypothesis test and confidence set estimates of cp location at multiple confidence levels when applied to measurement series from literature all methods produced results compatible with the results reported in the literature in fact in all cases where the literature reported one or more cps the lowest point on the confidence curve coincided with one of those cps a somewhat surprising but most welcome result was that the choice of distribution gumbel gamma or log normal used to calculate the likelihood had very little influence on the ability of the methods to recover information on a possible cp from the measurement series to see if this holds more generally more experiments with both synthetic data series and measurement time series are planned both the experiments on synthetic data series and the results for measurement time series suggest that the series should have a length of about 100 points and changes in the mean are detected if they exceed one standard deviation for changes in the standard deviation more experiments are needed to see how absolute or relative size of the change influences the method sensitivity the two new methods clmo and cmom introduced in this article complement the aed bp method from zhou et al 2020 the aed bp method has as advantage that it is non parametric and relatively fast but it tends to generate confidence curves with somewhat larger and therefore less informative confidence sets moreover it needs an additional calculation to properly detect changes in standard deviation a viable approach would be to start with aed bp apply clmo when the results are not conclusive or a change in the mean is not expected and use the more expensive cml method when the clmo results still display large uncertainty credit authorship contribution statement changrang zhou writing original draft writing review editing investigation conceptualization formal analysis data curation methodology software ronald van nooijen supervision formal analysis software writing review editing validation conceptualization alla kolechkina formal analysis validation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partially developed within the framework of the panta rhei research initiative montanari et al 2013 mcmillan et al 2016 of the international association of hydrological sciences iahs by the members of the working group on natural and man made control systems in water resources the authors would like to thank j reeves university of georgia k jandhyala washington state university and d m bayer federal university of rio grande do sul for sharing their data which allowed us to test our methods the authors also thank a viglione politecnico di turino for his valuable comments on a draft of this article our special thanks to t iliopoulou and an anonymous reviewer for their comments insightful questions and suggestions funding this work was supported by the china scholarship council under grant number 201706710004 appendix a confidence curves in the literature the definition of confidence curves has evolved over time an early definition was given by birnbaum 1961 who defined a confidence curve as a set of upper and lower confidence limits at each confidence coefficient from 0 5 to 1 inclusive schweder and hjort 2016 definition 4 3 gave a more general abstract definition of a confidence curve a variation on that definition is given below in this paper γ is used to denote a confidence level as opposed to cunen et al 2018 and zhou et al 2020 where α is used for more details on confidence curves please consult zhou et al 2020 appendix a definition 1 if λ is a parameter of a random sample x then a confidence set for λ with confidence level γ is a random set r x such that a 1 pr λ r x γ where pr e denotes the probability of event e a confidence set is a generalized confidence interval the standard concepts that hold for confidence intervals can therefore be extended to confidence sets a confidence set with confidence level γ has anominal coverage probability of γ in other words it is constructed to contain λ with a probability γ however the construction may use approximations therefore the actual coverage probability is defined which is the probability that λ is in r x when the set is actually constructed for a sample taken from x the actual coverage probability can be estimated by mc experiments if the actual coverage probability is smaller than nominal coverage probability γ the set is called permissive when the actual coverage probability is larger than γ the set is called conservative definition 2 suppose x is a random sample of size n and λ is a parameter of the random sample with values in a value set v a function g λ x with range 0 1 that is continuous in x for fixed λ is a confidence curve when 1 there is a point estimator λ ˆ for λ such that a 2 min λ v g λ x g λ ˆ x x 0 for all realizations x of x 2 for the true value λ true of the property λ the rv g λ true x has the uniform distribution on the unit interval the estimate λ ˆ x is merely a reference point it is the confidence curve as a whole that is meaningful if cc is a confidence curve according to definition 2 then for fixed λ 0 the function cc λ 0 x is a rv hence we can speak of the distribution of cc λ 0 x if λ true is the true value of λ then for a given confidence level γ 0 1 cc λ true x is uniformly distributed on 0 1 therefore a 3 pr cc λ true x γ γ now define confidence sets r γ x λ cc λ x γ with a confidence level γ by definition λ true r γ x if and only if cc λ true x γ so a 4 pr λ true r γ x pr cc λ true x γ γ note that the confidence sets r γ x are nested sets because they are derived from a confidence curve appendix b a summary of total uncertainty for a confidence curve to have a reference for the size of confidence sets for cps we introduce the following notation for a set s with a finite number of elements let s denote the number of elements and let choice k s denote a random set obtained by drawing k elements from s at random without replacement and with equal probability of selection for each element now for a given fixed element s 0 s n s and a given value 0 γ 1 the following equations hold b 1 pr s 0 choice k s k n b 2 pr s 0 choice γ n s γ n n γ where r min k z k r visual inspection of a confidence curve cc can give a subjective impression of the location of the cp and its uncertainty but a more objective measure would be needed for automated analysis of large sets of time series in the case that the cp is restricted to l cp defined in 1 it is easy to define random sets such that the probability that the true cp τ true lies in the set is approximately γ independently of the properties of the sample simply take b 3 r γ choice γ n 2 n min 1 l cp which has a coverage probability of b 4 pr τ true r γ x γ n 2 n min 1 n 2 n min 1 γ for a realization r γ of a confidence set with confidence level γ for a cp restricted to l cp we take as a summary of relative uncertainty b 5 un r γ r γ 1 γ n 2 n min now for large n the value of un r γ is zero for a one point set approximately one for a realization of r γ and larger than one for very uninformative sets this measure is useful for a set at a given confidence level but for automated analysis of a cc a level needs to be selected the highest confidence level for which a non trivial r γ can be constructed for which the equals sign holds is b 6 γ max n 2 n min n 2 n min 1 so that is the level that will be used for un applied to a confidence curve is defined as leaving out the factor 1 γ max b 7 un cc k n min n n min 1 cc k γ max 1 n 2 n min appendix c the effect of shifting or scaling the time series on the confidence curve c 1 location scale distribution families if the pdf f x θ with θ ξ ς is of the form c 1 f x θ 1 ς g x ξ ς where ξ is the location and ς is the scale then for the cml method it can be shown that the deviance function d prof τ a y b is equal to d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy c 2 ξ a y b a ξ y b c 3 ς a y b a ς y if d τ a y b d τ y then tests on synthetic time series with θ l 0 1 while varying θ r are representative for the performance of the method c 2 distribution families with a scale parameter if the pdf f x θ with θ ς η is of the form c 4 f x θ 1 ς g x ς η where ς is the scale and η is a shape parameter then for the cml method it can be shown that d prof τ a y d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy c 5 ς a y a ς y c 6 η a y η y if d τ a y d τ y then tests on synthetic time series with θ l 1 ς l 1 while varying the other parameters are representative for the performance of the method appendix d details on pdfs and parameter estimates d 1 location scale distribution families if the pdf f x θ with θ ξ ς is of the form d 1 f x θ 1 ς g x ξ ς where ξ is the location and ς is the scale then for the cml method it can be shown that the deviance function d prof τ a y b is equal to d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy d 2 ξ a y b a ξ y b d 3 ς a y b a ς y if d τ a y b d τ y then tests on synthetic time series with θ l 0 1 while varying θ r are representative for the performance of the method d 2 distribution families with a scale parameter if the pdf f x θ with θ ς η is of the form d 4 f x θ 1 ς g x ς η where ς is the scale and η is a shape parameter then for the cml method it can be shown that d prof τ a y d prof τ y for the cmom and clmo methods a similar equality holds for d pseu under the condition that the estimates of the parameters satisfy d 5 ς a y a ς y d 6 η a y η y if d τ a y d τ y then tests on synthetic time series with θ l 1 ς l 1 while varying the other parameters are representative for the performance of the method appendix e the computational cost of the methods for a time series of length n with n mc runs for distribution approximation all three methods cml clmo cmom need 1 n n 2 n min 1 deviance calculations each deviance calculation needs 2 n 2 n min 1 parameter estimates and n 2 n min 1 n calculations of the logarithm of the pdf each pair of ml parameter estimates will need at least n calculations of the logarithm of the pdf the costs of a pair of mom or lmo parameter estimates may be lower but will still be on the order of n arithmetic operations a relatively big difference in cost occurs for those distributions where ml needs to solve a minimization problem while mom and lmo provide explicit formulas for all methods the total number of operations for one sample will be e 1 o 1 n n 2 n min 1 2 n where o stands for on the order of the difference in cost between the methods does not show up in the o notation because it arises from multiplication factors that do not depend on n a mom or lmo parameter estimate involves on the order of n additions and multiplications plus a constant number of more complex operations an ml estimate where the solution is not available in explicit form will involve solving a minimization problem this in turn may involve between 5 and 20 evaluations of expressions derived from the log likelihood while these evaluations are order n in the operations count they are likely to be more costly perhaps a factor of 2 to 10 than the order n addition and multiplication operations needed by mom and lmo so in theory ml may well take anywhere from 10 to 200 times as long for gu and ga where the ml problems correspond to a one dimensional search for the point where a nonlinear function is zero in practice the cost of ml was between 8 and 11 times that of cmom with n 100 and n 1000 the computational cost is not negligible when one of these methods is itself analyzed statistically for instance by studying m 1000 time series this becomes a major problem for n min 1 n 100 and m n 1000 the cost exceeds o 1 0 12 calculations of the logarithm of the pdf in practice for one series taken from the ga distribution with n 100 n min 9 and n 1000 a cml curve for one series took 314 seconds and cmom took 37 seconds counting flops is complicated by the presence of the log and gamma functions calculating flop rates is difficult because the current implementation is in matlab not in c or fortran moreover runs for different parameter sets were done in parallel the calculations were performed on a six core intel xeon w 2133 at 3 60 ghz a rough estimate of the code performance would be between 0 04 clmo and 0 4 cml gflops per core intel 2020 gives an adjusted peak performance app of 160 gflops so about 27 gflops per core in theory there is room for improvement but to verify this an optimized implementation in a compiled language would be needed appendix f case study 4 four time series of annual maximum discharge on the yangtze river in china were analyzed by classical methods pettitt cusum cramér von mises in zhou et al 2019 and by nonparametric confidence curves in zhou et al 2020 the stations cuntan yichang hankou and datong along the yangtze river were selected to examine the impacts from the construction of the three georges dam construction officially started in 1994 there followed a series of interventions in the flow of the yangtze river first by partial damming and then by the filling in stages of the reservoir construction was completed in 2009 but the reservoir was not yet completely filled at that point for cuntan which lies upstream of the three gorges dam a time series of annual maximum flow from 1893 to 2014 was examined earlier studies did not find clear cps all confidence curves in fig f 12 b d show that there is no clear indication of a cp all un values are near one this strongly suggests that there is no cp for yichang which lies about 40 km downstream of the three gorges dam a time series of annual maximum flow from 1946 to 2014 was examined an earlier study found a possible cp in 1962 xie et al 2014 in zhou et al 2019 cusum found a cp in 1962 while pettitt and cramér von mises found a cp in 1966 all confidence curves in fig f 12 f h show that there is a clear cp near 1962 at the 95 confidence level the ln and ga based methods provide a set with about 7 candidates while for gu cml selects 4 years and clmo selects 2 years the value of δ μ σ at the cp in 1962 is near one for hankou approximately 700 km downstream of the three gorges dam a time series of annual maximum flow from 1950 to 2014 was examined earlier studies did not find clear cps all methods except for clmo with gu have un close to one see fig f 13 b d however given the closeness of the lowest point on the confidence curve to the end of the series and the narrowness of the 80 confidence set more data is needed to decide whether there is a cp near 2005 or not for datong about 1200 km downstream of the three gorges dam a time series of annual maximum flow from 1952 to 2014 was examined earlier studies did not find clear cps again all methods have a un that is nearly one see fig f 13 f h the shape of the confidence curve suggests that more data is needed to decide whether or not there is a cp near 2003 appendix g effects of short range dependence autoregressive time series of order one ar 1 with an underlying ln distribution were generated according to the procedure used by vogel et al 1998 summarized below first an ar 1 model is used to generate a time series y k g 1 y k ϕ y k 1 g k for k 1 2 where y 0 is normally distributed with mean μ and standard deviation σ the g k are i i d according to a normal distribution with mean μ 1 ϕ μ and standard deviation σ 1 ϕ 2 and y 0 is independent of all g k next a time series y k is obtained by setting g 2 y k exp y k if g 3 μ log μ 1 σ 2 μ 2 g 4 σ log 1 σ 2 μ 2 g 5 ϕ log ρ exp σ 2 1 1 σ 2 then y k will have a ln distribution with mean μ and standard deviation σ the series y k will have lag one autocorrelation ρ eq g 3 differs from eq 2 in vogel et al 1998 because of a typing error when needed a cp at k is introduced by starting a new series with initial value y k but μ and σ derived from μ r and σ r these are preliminary results for groups of 100 samples instead of the groups of 1000 samples used in the main paper samples were generated using the multfibonacci random number generator from matlab fig g 14 shows that the confidence curves still have their minimum close to the actual cp the algorithms used the multfibonacci generator from matlab to obtain random numbers figs g 15 and g 16 show that due to the difference between the assumed i i d ln distribution and the actual ar 1 ln distribution the actual coverage becomes increasingly permissive and the uncertainty about the cp increases 
2339,the majority of runoff studies to date have reported a similar pattern of rapid rain to runoff conversion via overland flow and shallow subsurface water flow as well as the ubiquity of thresholds and hysteresis in rainfall runoff response but each of those approaches has limitations in terms of inference and process description processes of water transport and mixing and how they influence runoff generation are still not well understood or quantified in this study hydrogeosphere a fully integrated surface subsurface flow model was used together with stable isotopes for disentangling runoff generation mechanisms in a headwater catchment the study area 0 21 km2 is the first level tributary of the xin an jiang river located in a humid climate region of eastern china water flow simulation elucidated the spatial water transport process and isotope tracing quantified the complex water mixing process between the shallow soil and hillslope surface this study provides insights into the rapid transformation of rainfall infiltration and mixing in soil and exfiltration to a hillslope results show that the stream runoff was separated into rainfall induced overland flow 9 exfiltration induced overland flow including the 53 of mixed water from rainfall infiltration and 6 of the stored soil water and subsurface flow 32 exfiltration induced overland flow was the dominant water source in the headwater catchment during a rainfall runoff event the mutual influence of rainfall infiltration and soil water exfiltration caused the shallow soil to rapidly become saturated thus forming saturation excess overland flow the consistence of estimated soil water velocity based on the integrated isotope and numerical modeling approach at about 0 4 m d nearby the stream channel improved the reliability of model visualizations further analysis indicates that water flow paths and velocities responding to the rainfall event were attributed to the soil moisture conditions and topography this study demonstrates that identifying the rapid mixing processes between the rain and the soil water was crucial for understanding hillslope overland flow and runoff generation in headwater catchments keywords runoff generation water mixing process headwater catchment stable isotope hydrogeosphere integrated analysis data availability data will be made available on request 1 introduction among the effects of climate change are the alteration of hillslope overland flow and stream runoff generation within headwater catchments wine and davison 2019 the runoff generation mechanism is one of the most crucial aspects of hillslope hydrology in humid mountainous environments headwaters or first order catchments are important as they commonly contribute a significant proportion of the total streamflow to drainage basins mcdonnell and beven 2014 hillslope hydrological processes are influenced by many factors including soil texture topography meteorology and hydrological conditions lee and kim 2021 mcguire and mcdonnell 2010 the source and movement of hillslope and stream water are fundamental to the understanding of catchment behavior dunne and black 1970 horton 1933 the shallow soil conditions on hillslopes where much flow generation and interaction take place are sources of uncertainty mcdonnell 2013 as the exchange between soil water and surface water occurs not only in stream channels but also significantly along the hillslope it is worth noting that the influence of mixing processes between rainfall and soil water is important at the catchment scale and affects the interpretation of runoff generation jones et al 2006 vereecken et al 2008 understanding the spatiotemporal dynamics of soil water movement during a rainfall event remains a challenge in hydrology ala aho et al 2017 brooks et al 2015 kirchner 2006 many studies focused on the development of numerical modeling describing soil water flow and runoff generation ala aho et al 2017 yu et al 2010 lumped conceptual rainfall runoff models were first proposed based on empirical relationships including the sac sma model peck 1976 hbv bergström 1976 and the xinanjiang model zhao 1992 later conceptually or physically based distributed hydrologic models that use spatial distributed inputs were developed yu et al 1999a including models such as topmodel beven and kirkby 1979 modflow mcdonald and harbaugh 1984 she abbott et al 1986 swat arnold et al 1993 and vic liang et al 1994 the hms yu et al 1999a b 2006 was developed to simulate basin scale hydrological processes driven by weather and includes surface and subsurface water flow and the interactions between them as well as evapotranspiration et the hydrogeosphere hgs model a fully integrated surface subsurface flow and transport model was designed to take all of the key components of the hydrologic cycle into account aquanty 2022 hgs has been applied over range of hydrologic settings to understand complex hydrological processes at hillslope catchment basin and continental scales park et al 2011 hwang et al 2018 yang et al 2018 chen et al 2020 frey et al 2021 xu et al 2021 based on model simulation results ali et al 2014 analyzed the travel time distribution in an idealized conceptual hillslope and wilusz et al 2017 studied the relationships between rainfall variability and transit time in two neighboring headwater catchments in the uk simulation capabilities have progressed significantly in recent years from lumped to distributed hydrologic models khakbaz et al 2012 to fully integrated 3d hydrologic models davison et al 2015 while acknowledging the strengths of fully coupled distributed models for better understanding of water flow they are often criticized because of their considerable data requirements beven 2002 stable isotopes δ2h and δ18o have been used as natural tracers to track complex soil water processes and their connectivity with the surface use of monitored isotope data can reflect the actual status of the catchment because they are components of the water molecule itself and are thus not strongly altered by chemical reactions li et al 2017 isotopic analysis has been widely used to interpret soil water transport and residence times jasechko et al 2016 and to estimate the subsurface water contribution to streamflow jones et al 2006 klaus and mcdonnell 2013 at scales ranging from a soil cross section and hillslope mcguire and mcdonnell 2010 to the catchment scale mcguire and mcdonnell 2006 li et al 2017 sprenger et al 2016 reviewed the crucial role played by stable isotopes in revealing the soil water movement han and zhou 2018 characterized the mechanism of soil water movement in the unsaturated zone under the impacts of extensive irrigation by using a combined physically based modeling approach and stable isotopes gibson et al 2016 conducted a process based summary of the use of stable isotopes in models many methodologies have been used for monitoring and simulating streamflow compositions wu et al 2020 estimating water flow paths and mean residence times kim et al 2016 koeniger et al 2016 and evaluating hydrological responses to various catchment properties park et al 2011 here we report on an integrated rainfall runoff response of a humid headwater mountain catchment instead of the large indoor facilities or only using numerical modeling the site is located on the first level tributary of the xin an jiang river in eastern china the outdoor experimental setting where natural conditions rainfall soil vegetation and landforms represent the key elements was coupled to the hgs modeling to provide an overall picture of the system studies in humid headwater catchments have described a pattern of rapid rainfall to runoff conversion via overland flow and shallow subsurface water flow muñoz villers and mcdonnell 2012 zhang et al 2021 and also showed the ubiquity of thresholds and hysteresis in rainfall runoff responses mcdonnell et al 2021 ross et al 2021 singh et al 2021 however the mechanisms that reveal how the rapid mixing processes of rain and soil water may influence runoff generation are still not well understood wu et al 2020 in this study we combine isotope tracing and modeling with hgs to disentangle the above complex runoff generation processes this study is one of the first that brings together stable isotope tracing and integrated surface subsurface simulations to determine streamflow compositions flow paths and transport time through the soil matrix and to the stream in a headwater catchment the main objectives of this study are to answer the following questions 1 can stable isotopes be used to improve the identification of water transport pathways and mixing processes when used in conjunction with physically based integrated hydrologic models 2 what are the spatiotemporal patterns of stream water sources and subsurface water fluxes in a small headwater catchment 2 study area the study site of the mukeng catchment 117 59 12 48 e 29 40 2 28 n is the first level tributary of the xin an jiang river fig 1 and has a drainage area of 0 21 km2 the xin an jiang river originates in anhui province flows through zhejiang province converges to qiantang river and finally flows into the east china sea topographic relief of the mukeng catchment was defined with 1338 measured elevation points fig 1 with elevations ranging from 387 m a s l at the northeast hilltop to 191 m at the catchment outlet the mukeng catchment is characterized by hilly topography and dense vegetation hillslopes on both sides of the main stem channel are dominated by shrub lands and forests except for a small portion adjacent to the western edge that is covered by croplands the forest land occupies more than 90 of the area the riparian areas of the valley bottom are mainly covered with croplands and native grasslands the topsoil is heterogeneous ranging from coarse sand to till and has a thickness of approximately 1 m the selection of the experimental site was aimed to represent the relatively most common natural settings in south of china where slope and hills are covered with dense vegetation rainfall p temperature t and potential evapotranspiration pet for the period of 2001 to 2015 were used in the analysis the daily rainfall and temperature data were provided by the climate data center national meteorological information centre of china with a 0 5 resolution dataset and three nearby climate station based datasets nearest distance of about 26 km https data cma cn rainfall and temperature data of august 2015 were monitored with the climate station located in the study area in addition daily pet was obtained from the usgs global pet datasets with 1 0 resolution https earlywarning usgs gov fews product 81 the data have changed little over the years although the changes in rainfall are more significant after 2007 the average annual temperature is 16 7 c with the lowest and highest average monthly temperatures being 4 c in january and 28 c in july the mean annual rainfall and pet are about 1580 mm y and 1000 mm y respectively furthermore according to a fifteen year water balance q p pet the annual outlet discharge q of this catchment is estimated to be 580 mm y per unit area which corresponds to approximately 37 of the mean annual rainfall 3 material and methods 3 1 field sampling and isotope measurements sampling locations for the stable isotope were chosen along the main stream channel fig 1 stream water samples sites r1 r8 were collected from 17 to 22 july in 2014 at the end of a short rainfall event sites r4 r5 and r6 are close to the confluence of tributaries at the same time soil water samples beside the main stream channel at a downstream location site i1 were taken using ceramic cup suction lysimeters with an applied pressure of 80 kpa at 30 cm i1 30 and 70 cm intervals i1 70 beneath the soil surface the water extraction process did not change the stable isotopic composition of the soil water additionally large plastic bottles were pre positioned in the downstream and central positions of the sampling area and rainfall samples sites e1 and e2 were taken on 17 july 2014 for use in isotopic hydrograph separation in total 58 isotope samples of the stream soil and rainwater were obtained from the mukeng catchment a second field campaign was carried out in august 2015 for better model calibration and validation rainfall and soil volumetric water contents were continuously monitored with a ten minute interval an automated climate station was installed in midstream and a set of soil moisture sensors were buried at a depth of 30 cm site i2 the daily outlet discharge was measured along with the stream stages and velocities according to iaea international atomic energy agency standard procedures all isotope samples were stored in 30 ml high density plastic bottles leaving no headspace with the cap covered with plastic wrap to avoid evaporation the samples were stored at about 4 c before the laboratory isotopic analysis the isotopic analysis was completed at hohai university using a spectrometer isotopic water analyzer picarro l2130 i with precision of 1 for δ2h and 0 1 for δ18o measurements on one water sample from a single vial were made six times and the reported isotope values δ2h and δ18o were determined by averaging the last three results after every third sample measurement calibration was carried out with three standard samples reported results table 1 were defined in the standard δ notation and the internal referenced standard was based on vienna standard mean ocean water vsmow 3 2 fully coupled subsurface surface model setup we chose hgs as the physically based water flow model to perform the simulations it is a 3d fully coupled subsurface surface hydrologic model that solves the continuum based nonlinear equations describing surface and subsurface flow including et aquanty 2022 richards equation and darcy s law are employed to describe three dimensional variably saturated subsurface flow 1 t θ s s ω q γ ex q 0 2 q k k r φ z where θ s is the saturated water content dimensionless s ω is water saturation dimensionless γ ex is the fluid exchange between the surface subsurface l3l 3t 1 positive for flow into the porous medium q is the volumetric flow rate per unit volume with the outside of the simulation domain representing a source positive or a sink negative l3l 3t 1 k is the hydraulic conductivity tensor lt 1 k r is the relative permeability of porous medium dimensionless φ is the pressure head l and z is the elevation head l the diffusive wave approximation of the saint venant equation is used to simulate flow over the land surface which is written as 3 d o z o t v xo d o x v yo d o y γ o q o 0 where d o is the depth of the surface flow l z o is the land surface elevation l and the terms v xo and v yo are the vertically averaged flow velocities in the x and y directions lt 1 used to couple with the momentum equation and manning s equation q o is a volumetric flow rate per unit area representing external source positive and sinks negative lt 1 et is treated as a nonlinear water sink in hgs and consists of evaporation e s lt 1 and transpiration t p lt 1 4 e s α 1 f 1 e d f p e t 5 t p f 1 f 2 s ω r d f p e t where α represents the reduced evaporative area of available water in the overland flow domain within the depressions dimensionless f 1 is a evaporation and transpiration partitioning factor f 2 s ω is a function of nodal water content edf is the evaporation distribution function rdf is the time varying root distribution function the surface subsurface exchange flux is simulated using a dual node approach assuming that subsurface and surface domain are connected through a thin exchange layer with a coupling length of l exch l 6 γ k r exch k zz l exch φ z d 0 z 0 where a positive γ represents water flow from the subsurface to surface system k r exch is the relative permeability for the exchange flux dimensionless and k zz is the vertical saturated hydraulic conductivity of the underlying porous medium lt 1 in this study the vertical discretization contains three stratigraphic layers from the surface to the base of the system fig 2 the top layer has a minimum thickness of 1 05 m and represents a loose soil vadose zone which has relatively high porosity and permeability with developed root zones in the croplands and grasslands the soil vadose zone was further divided into six elemental layers with the thickness of 20 10 20 20 20 and 15 cm respectively the lower part consists of an aquitard zone which is divided into two layers at a depth of 15 m below the surface the lowest layer extends to the bottom horizontal plane at z 150 m the surface domain consists of 6 different land cover types the two dimensional areal mesh consisting of triangular elements was generated with the software algomesh hydroalgorithmics 2016 given the local topography and stream channel a finer mesh resolution was used in the riparian areas to improve model accuracy in zones where steeper hydraulic gradients are expected details in table s1 to enhance the efficiency and maintain the accuracy of hgs simulation parameter settings for constructing the domain mesh were determined by optimizing the mesh generation features for catchment boundary stream minimum angle and length between nodes the total two dimensional areal mesh contains 12 427 triangle elements and 6 308 nodes extending the surface mesh with depth over all the grid layers yields 99 416 triangular prism elements and 56 772 nodes the et is controlled by the soil moisture state and vegetation type the optimal parameters for evaporation and transpiration estimated through model calibration are shown in table 2 the surface and subsurface flow parameter values for each land cover type and subsurface zone are also listed in table 2 three kinds of boundary condition were used 1 the outlet boundary was considered a critical depth boundary 2 a no flow boundary was assigned at all other sides of the domain 3 the surface rainfall boundary was set as the flux type boundary condition et on the top surface of the simulation domain is calculated internally in the model because the simulation domain is small spatially homogeneous but temporally variable rainfall and pet was applied for the simulations calibration of the hgs model focused on the discharge at the outlet and soil water saturation at site i2 for the period of august 2015 using both the daily and hourly discrete simulations respectively model performance was assessed using both the root mean squared error rmse and nash sutcliffe efficiency nse and also the mean and standard deviation of the residuals between the modeled and observed data were analyzed to show the systematic error and the random error the metrics of rmse and nse are described in dawson et al 2007 they are described as 7 r m s e i 1 n q i q i 2 n 8 n s e 1 i 1 n q i q i 2 i 1 n q i q 2 where q i is the observed value q i is the modeled value where i 1 to n data points and q is the mean of observed data 3 3 separation of the water source for stream flow to more clearly understand how and where the stream runoff was generated the temporal and spatial origins of the stream runoff were deduced using both isotopic analysis and numerical modeling regarding the rainfall runoff process when new water is introduced into the catchment it mixes with the old water by tracking monitored isotope signals that occurred before pre event water or are newly introduced event water an isotope mass balance can be constructed based on a water mass and isotope mass balance 9 q t q pre e v e n t q event 10 q t c t q pre e v e n t c pre e v e n t q event c event 11 f pre e v e n t q pre e v e n t q t c t c event c pre e v e n t c event where q t is the total stream runoff l3t 1 q pre e v e n t and q event are the discharge from pre event and event water l3t 1 c t c pre e v e n t and c event are the stable isotope values of the stream pre event and event respectively f pre e v e n t is the contribution of pre event water in the stream runoff from the spatial perspective of water sources subsurface water flow is generated by hydraulic potential differences and transports the water to the streams while surface water is accumulated from rainfall and overland flow and occurs based on topography park et al 2011 here the method for calculating the subsurface water contribution to the total stream runoff f sub is used that is based on the simulated exchange flux between the subsurface and surface 12 f sub a river γ d a river q t i 1 n γ l e n g t h i w i d t h i q t where n is the total number of nodes along the stream channel and i is node index γ lt 1 length i l and width i l are the exchange flux and the corresponding length and width of each node s contributing area in the stream channel and q t is the total stream runoff l3t 1 the nodal exchange flux is given by the eq 6 during the rainfall event infiltration causes the shallow soil to saturate rapidly thus producing saturation excess overland flow the hillslope overland flow is composed of rainfall induced and exfiltration induced portions based on the water balance the hillslope overland flow can be expressed as 13 hr p et s i s i g δ w s 14 hr p p et s i s δ w s α α 0 1 15 f r p hr p hr where hr is the runoff of hillslope overland flow l t 1 p is the amount of rainfall l t 1 et s is the et on the surface l t 1 i s is the amount of water infiltration l t 1 i g is the amount of water exfiltration from the underground l t 1 δ w s is the changes of overland water storage l t 1 hr p is the rainfall induced overland flow l t 1 α is an factor to distinguish the different impacts from rainfall and exfiltration on the changes of overland water storage f r p is the rainfall induced contribution to the hillslope overland flow 3 4 estimation of the soil water velocity this study provides an isotope based technique to calculate the soil water velocity in addition to that determined from model simulation the horizontal soil water velocity v h s o i l l t 1 can be obtained with the soil water transport time t trans t and the corresponding flow distance l t l 16 v h s o i l l t t trans estimating the soil water transport time t trans using the convolution method assumes that the isotopic composition of the water leaving the system δ out stream water is identical to that of the water entering it δ in soil water lagged by some time and weighted by a time distribution function g t trans t trans is the time that a water particle would take to flow through a hydrological system this is expressed mathematically as details in koeniger et al 2016 17 δ out t 0 δ in t t trans g t trans d t trans to simplistically characterize the time distribution function g t trans the isotopic peak shift method has been introduced this method focuses on tracking the obvious and unique isotope feature such as the abrupt rise and fall processes or peak values of the monitored isotope data series and then estimates the t trans based on the reviews by sprenger et al 2016 this study simplified t trans as 18 t trans t out t in where t in is the time of the distinctive peak of the input isotope signal t and t out is the time of the peak in the output time series t 4 results 4 1 stable isotope distributions in the catchment the relationship of δ18o and δ2h for all the water samples is shown in fig 3 for the stream samples the linear relationship is referred to as the river water line rwl δ2h 3 593δ18o 18 196 similarly the soil water evaporation line sel is expressed as δ2h 3 358δ18o 19 846 the local meteoric water line lmwl is obtained from liu et al 2014 δ2h 6 41δ18o 8 25 the similar slopes between rwl 3 593 and sel 3 358 demonstrates the strong correlation between the subsurface and surface water in this study area moreover these slopes are gentler than those of the global meteoric water line gmwl and lmwl 8 and 6 41 indicating the vital effect of evaporation in this study area the different types of water samples stream and soil water showed different temporal isotopic patterns table 1 and fig 4 the isotopic composition of the stream water ranged from 66 29 to 17 04 in δ2h and from 12 67 to 0 28 in δ18o and the isotopic composition of the soil water varied in the range of 59 79 to 11 59 and 16 42 to 0 13 in δ2h and δ18o respectively the similar isotope ranges of the stream and soil water imply that they are well mixed and have a strong hydraulic connection the average stable isotope values in the stream water were 48 84 and 8 53 for δ2h and δ18o respectively which are slightly lower than that in the rainwater therefore the streamflow must be primarily fed by the subsurface water which is commonly old water and depleted in heavy isotopes after july 20th the isotope value was relatively stable at the value of approximate 5 in δ18o at a depth of 30 cm while it decreased significantly at 70 cm the difference in stable isotope changes in the soil water at 30 cm and 70 cm reveals different evaporation effects on the vertical soil profile a d excess analysis has been performed to show the evaporation effect on the stream and soil water and it is defined as d excess δ2h 8δ18o dansgaard 1964 evaporation within the catchment causes the enrichment of isotope values and decrease of d excess values the trends in the d excess distribution in space and time table 1 and fig 4 are such that the values decrease from the upstream to the downstream and over time the evaporation effect is small during the rapid rainfall runoff processes after july 17th evaporation becomes more intense and varies spatially across the catchment therefore the monitored stable isotopes show a slight enrichment over time and significant variability in space 4 2 flow characteristics during a rainfall event based on hgs simulation a pseudo steady state simulation was first performed with average annual rainfall and pet inputs to obtain an initial state for the subsequent transient simulations the model was forced with a constant net rainfall input rainfall pet at the top surface of the simulation domain the simulation was performed until the outlet discharge reached a stable value which equaled the amount of water falling on the simulation domain under the net rainfall of 5 23 10 3 m3 s the steady state condition was used as the initial state for the subsequent transient simulations then the transient hgs simulation was carried out from 2001 to 2015 in order to enhance the simulation efficiency the simulation period was separated into three stages monthly discrete simulation before 2011 daily discrete simulation after 2011 and additional hourly discrete simulation on august 2015 the hgs model was calibrated by fitting the simulated outlet discharge and soil water saturation with the observed data in the study site over the period of 1 to 28 august 2015 using the daily and hourly discrete simulations respectively model calibration in the study mainly included three parts 1 calibrated surface flow parameter values with land cover types 2 model parameter sets for subsurface flow simulation based on the soil textural classes and 3 et parameter value set for evaporation and transpiration simulations first land cover types were recorded during two field campaigns and representative parameter values table s3 of different land cover for hgs surface flow simulation were selected with the references of hwang et al 2018 and yang et al 2018 second soil textural classes were distinguished for each land cover area by combining the measured representative soil hydraulic conductivity values values of porosity residual water contents θr and hydraulic conductivity kx ky of different soil type table s4 were obtained from the default values in hydrus 1d šimůnek et al 2013 with the consideration of anisotropy kx ky 10kz was assumed the representative values of specific storage that reflects the soil water storage capacity were chosen based on the reference of domenico and mifflin 1965 finally considering the importance of water balance during the quantification of different water sources et simulation was carefully optimized to control the water storage change in the catchment and streamflow discharge at the outlet sensitive parameters were chosen and calibrated table s2 based on the hgs user manual aquanty 2022 including the maximum root depth oxic limit of transpiration limiting saturations and maximum value of evaporation limiting saturations the metrics of rmse and nse were calculated for both the outlet discharge and soil water saturation to evaluate the model performance for the period of 1 to 28 august 2015 the daily and hourly discrete simulations were carried out with rainfall measurements from the climate station in the study area the pattern of measured rainfall dataset is comparable with the grid based daily rainfall data both the daily and hourly discrete simulations match the measured stream runoff well fig 5 a capturing the first and second peaks of the runoff hydrograph additionally the runoff response to the rainfall is very rapid the rmse results for the daily 0 0018 m3 s and hourly 0 0016 m3 s flow simulations are close to zero and the nse results are 0 49 and 0 57 respectively table 3 the simulation result for the soil water saturation rmse 0 0334 is acceptable in term of the average state nevertheless the difference between the simulated and measured soil water saturation is noticeable a negative nse of 1 49 with a slight overestimation by the model at early times and some underestimation at later times respectively fig 5b meanwhile to further demonstrate the systematic error and the random error the mean and standard deviation of the residuals between the modeled and observed data were calculated the mean of the residuals for daily and hourly flow simulations are 3 10 5 m3 s and 7 10 4 m3 s respectively and the corresponding standard deviations of the residuals are 0 0018 m3 s and 0 0015 m3 s results demonstrate that the hgs model performs well for the water flow simulation in the catchment and the hourly simulation with its hourly precipitation input captures more details in the runoff peaks in response to the discrete rainfall processes fig 5a at the perspective of the soil water saturation simulation the mean 0 0131 and standard deviation 0 0307 of the residuals show that the overall bias of simulation results is small besides the reliability of the hgs simulation has been further improved through the comparative verification of hydrological processes based on simulation results and isotopic analysis in the following sections for example the separation results of the subsurface water pre event water contribution to stream runoff are similar and the estimations of the soil water transport time are consistent in general although there are some uncertainties associated with the model parameters and limited field data for verification the simulation results are reasonable and acceptable to provide more details on the rainfall runoff process the simulated stream and soil water velocity et depth to groundwater table dtg and exchange flux between the surface and subsurface were analyzed during the first sampling period fig 6 the data show that the rainfall influences the stream water velocity and horizontal soil water velocity with a fast soil water respond by contrast the vertical soil water velocity is more related to the et process soil water moves to the surface as driven by the evaporation but this trend diminishes during the period 13 15 july due to the strong rainfall the data demonstrate a good correlation between the subsurface surface exchange flux and dtg where exchange flux increases as the groundwater level rises during the rainfall event thus the soil water dynamics significantly influence the runoff generation especially during the rainfall event 4 3 temporal and spatial sources of the stream runoff the temporal source of the stream runoff will be divided into pre event and event water the average δ18o isotope value of the event water is 7 71 which is comparable to that in the nearby areas reported in liu et al 2014 in order to eliminate the effects caused by evaporation and water mixing along the subsurface flow paths the minimum isotope value 11 50 at a depth of 70 cm i1 70 is assumed to be the signature of the pre event water these values together with the average δ18o isotope value of the stream water at 8 53 bring the fraction of pre event water in the stream at approximately 39 34 21 using the isotope mass balance model this estimates also emerges from 37 49 30 fraction using the δ2h data thus the percentage of the pre event water in the stream runoff is about 38 on average for the first sampling period the results of the hydrograph separation based on the hgs calculations are listed in table 4 for the entire rainfall event of the first sampling period the contributions of the subsurface water to the stream runoff decrease from 52 to 8 until the flow peak time after that the contribution gradually increases to about 38 to the total outlet runoff the estimated subsurface water contribution to stream runoff for the first field sampling period is approximate 25 to 38 32 on average which is somewhat lower than the estimated pre event water contribution based on the isotope mass balance approach during the rainfall period there was ponded water observed on the ground surface near the main stream channel and in the small ditches and this surface water quickly converged to flow toward the stream channel based on above water balance method for separating water sources of hillslope overland flow quantifying water sources of hillslope overland runoff suggests no rainfall induced overland flow during the first two days of the rainfall event table 4 and the infiltration and exfiltration processes are significant in response to the rainfall the highest proportion of rainfall induced overland flow occurs on 15 july that was associated with intense rainfall event this proportion derived from hgs model results is correlated with the daily rainfall and spans at a wide range from zero to 63 2 3 8 4 4 water flow velocity from model and isotope based approach the simulated water flow paths and velocities within the surface and subsurface domains during the first sampling period are displayed in fig 7 the water flow velocity is substantially higher in the stream channel and within the shallow subsurface of the soil the lateral water flow velocity within the soil was calculated by using both the hgs simulation results and the measured isotope signals the soil water flow distance from soil monitoring site i1 fig 1 to the stream channel is about 1 45 m and the average linear soil water velocity calculated by hgs is approximately 0 415 m d during the first sampling period this average velocity was estimated using all elemental soil water velocities along the studied flow path based on the flow distance and the model based average velocity the soil water transport time is about 3 to 4 days the stable isotope data reveal distinctive trends of fluctuations in the stream water fig 4 at sites r1 r2 and r7 after 17 july the surface water velocities fig 6 are similar and low while the simulated evaporation rates fig 6 are much lower at sites r1 and r7 than that at r2 isotope evaporative fractionation could be a factor at site r2 thus there must be a water source containing enriched isotopes at sites r1 and r7 it is notable that the isotopic composition of the soil water at site i1 spans a wide range from 11 50 to 0 13 in δ18o table 1 with fairly high values on 18 and 20 july after the rainfall event fig 4 as mentioned above the soil water flows towards the stream causing the increase in heavier oxygen isotope values in the stream water site r1 on 22 july based on the isotopic peak shift method the soil water transport time from the soil site i1 to the stream site r1 1 45 m is in good agreement with the hgs simulation result at about 3 to 4 days thus the isotope based soil water velocity is about 0 42 m d 5 discussion 5 1 evaluation of transport and mixing processes in the soil water soils play a vital role in the water cycle by controlling infiltration exfiltration et and lateral water migration and mixing each can affect the soil water moisture and the isotopic signatures of water sprenger et al 2016 based on the simulated patterns of the soil water flow paths fig 7 characteristics of the soil water movement are distinctive from the upstream to the downstream locations the study area is a hilly region with larger slopes upstream and relative flat topography midstream and downstream at the upstream vertical infiltration is the dominant process and the deep groundwater is slowly recharged at the midstream fast soil water movement is parallel to the land surface and subsurface water seepage occurs at the downstream vertical water exchange infiltration and fast exfiltration increases the interaction between the subsurface and surface this result is consistent with that reported by park et al 2011 in a schematic catchment horizontal flow and mixing of soil water play an important role the soil water velocity of about 0 4 m d from the soil site i1 to the stream site r1 was estimated by both the hgs simulation and from the isotope data the higher horizontal hydraulic conductivity at the hillslope leads to the increased soil water seepage towards the surface along the valley during the rainfall event fig 7 in the riparian areas of the valley bottom soil water exfiltration appears whether there is rainfall or not while on the upland hillslope areas rainfall induced soil water moves laterally in the shallow soil during the rainfall event fig 7b the isotope variability is attributed to processes occurring in the catchment such as water mixing from enriched or depleted isotope water sources thus the observation of high isotope values at midstream site r7 with the d excess values of 9 36 and 12 20 that appeared a few days earlier than r1 is related to the enriched heavy isotopes stored in the shallow soil water the interaction between the subsurface and surface is directly affected by the fluctuations in the depth to the groundwater table dtg in fig 6 with the rise in the groundwater table after the rainfall causing an increase in the subsurface water contribution to the streamflow the changing pattern of the dtg exhibits characteristics related to the soil saturation with the shallower dtg corresponding to the higher saturation the very negative values of d excess 17 44 and 17 96 in the soil water at the 70 cm depth indicate that the water source for these two samples experienced strong evaporation reckerth et al 2017 the isotopic composition of the deeper soil water is assumed to be relatively constant over time and space and the fractionation effects caused by evaporation are primarily limited to the upper 30 cm of the soil evaristo et al 2015 sprenger et al 2016 thus the soil water at 70 cm depths showing heavy isotope enrichment was likely transported from the upland surroundings as suggested by the downslope soil water movement driven by the heavy rainfall this water mixing is more obvious in the shallow soil water which depends on the strong vertical movement of the soil water singh et al 2021 however research on hillslope hydrological connectivity has mainly focused on the horizontal direction rather than the vertical flow effect liu et al 2019 overall the hillslope hydrological response to a rainfall event involves complex mixing processes between the rainfall the surface water and the soil water park et al 2011 5 2 the effect of infiltration mixing exfiltration on the hillslope runoff generation based on the spatial and temporal sources of the stream runoff the contribution of subsurface event water estimated by hgs is smaller than the pre event water calculated with isotope data as mentioned above the traditional separation of the stream runoff into subsurface pre event and surface event sources is affected by complex mixing processes the soil water exfiltrates to the hillslope and then ultimately emerges as surface runoff thus the contribution from the soil water in the streamflow composition will be underestimated during the rainfall event the process of rainwater infiltration to the underlying subsurface should be dominant because the soil infiltration capacity 1 000 10 7 to 1 217 10 4 m s in table 2 exceeds the rainfall intensity average value of about 5 010 10 8 m s dunne and black 1970 therefore the formation of overland runoff in this humid and forested study area is dominated by saturation excess overland flow which is driven not only by the rainfall but also by the soil water exfiltration ala aho et al 2017 in this study the hillslope overland flow was further separated into rainfall induced and exfiltration induced parts table 4 the proportion of rainfall induced overland runoff in the hillslope increases to about 63 and then it sharply decreases to zero within four days the average contribution of rainfall induced flow in the total stream runoff is about 9 for the whole rainfall event in humid areas rainfall can also quickly generate surface runoff through the soil water flow liu et al 2021 mccoll et al 2017 reported that 14 4 of the rainfall remained in the surface soil within 3 days which was continuously influencing the runoff generation the above estimated contribution of surface water overland flow is mixed with the rainfall and exfiltration water from the soil kim et al 2016 yang et al 2018 while the exfiltrated soil water could be dominated by the continued rainfall a conceptual of the runoff generation processes is presented in the diagram provided in fig 8 during the rainfall event based on the hgs simulation results overland flow and subsurface flow provide 68 and 32 of the total stream runoff respectively the overland flow has been separated into rainfall induced 9 to stream runoff and exfiltration induced 59 to stream runoff parts considering the results derived from isotopic analysis the event water 62 consists of not only the rainfall induced overland flow but also the exfiltrated soil water derived from the rainfall infiltration 53 thus exfiltrated water from the stored shallow soil water represents about 6 the hillslope runoff generation is dominated not only by the topography but also by the rainfall conditions feng and liu 2015 to further explore subsurface stormflow generation during a rainfall runoff event over the hillslope three dimensional soil water saturation distributions at various times were selected to visualize the rainfall induced soil water movement fig 9 in headwater catchments the degree of soil water saturation is a critical factor for soil water movement at the first occurrence of the rainfall event the short duration has a generally minor influence on the distribution of soil saturations although the influence is noticeable in the downstream riparian areas marked area in fig 9 during the rainfall event the subsurface domain experiences increasing soil moisture towards a state of saturation intensive rainfall results in the storage of water in the soil that sharply changes the saturation of the topsoil causing rapid soil water flow and water exchange with the surface after 17 july the vertical exchange of water becomes weak during the following monitored one week thus the result suggests that the shallow soil water movement rapidly responds to the heavy rainfall which also has been explained by lee and kim 2021 in summary the shallow soil water flow plays a vital role in mixing different water sources and bringing them into the stream channel the infiltration mixing exfiltration process in the shallow soil is key for runoff generation in mountain headwater catchments the integrated analysis combining hgs simulation with isotope tracing revealed useful details about soil water storage and release processes and the complex surface subsurface exchange of water 6 conclusions the integrated approach of isotopic analysis and modeling employed in this study adds understanding of water mixing processes and the effect on runoff generation in a headwater mountain catchment our results indicate that the hydrological connectivity between the soil and the surface is significant in headwater catchments in response to the rainfall the contribution of the subsurface water to the stream was estimated to be 32 during the rainfall event hillslope overland flow consisted of not only the rainfall but also the soil water exfiltration the proportion of rainfall induced overland flow exhibited a wide range from zero to 63 2 3 8 our finding suggested that rainfall can quickly generate hillslope overland flow through the saturation excess overland flow and through soil water exfiltration considering the temporal separation of water sources derived from the isotopic analysis the complex process of rainfall infiltration mixing in soil exfiltration to hillslope can be quantitatively described this study showed that the shallow soil and surface interactions were enhanced at both downstream and hillslope locations by the strong soil water infiltration exfiltration process during rainfall events we presented an effective approach to identify details about rainfall runoff processes with a focus on the separation of the water sources contributing to streamflow this study demonstrates the great potential of isotope tracing in the study of the water source composition and movement and can also be used to verify the reliability of hydrological simulations traditional hydrological simulations primarily focus on stream runoff optimization which frequently results in unpredictable deviation in the simulation of subsurface water flow in the catchment the distribution of sampling location and frequency limits the application of isotopic analysis in exposing hydrological characteristics making the quantitative analysis and research limited or highly imprecise in this study an integrated surface subsurface flow simulation and isotope tracing analysis are combined to improve the understanding of runoff generation mechanisms in a headwater catchment isotope tracing provides useful hydrological information for refined hydrological simulation and calibration especially subsurface water flow characteristics that are difficult to directly observe however this study also has limitations such that we only analyzed the runoff composition and mixing processes for a single rainfall runoff event and thus more work should be conducted for various rainfall runoff events in general the success in the integrated application of stable isotopes and hgs model provides a new perspective for elucidating runoff generation mechanisms credit authorship contribution statement xuegao chen methodology investigation writing review editing formal analysis writing original draft visualization data curation zhongbo yu conceptualization funding acquisition supervision peng yi validation formal analysis project administration resources ala aldahan writing review editing hyoun tae hwang software writing review editing edward a sudicky software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported bythe national natural science foundation of china grant no 42201015 u2240217 51979072 the jiangsu funding program for excellent postdoctoral talent grant no 2022zb173 national science funds for creative research groups of china grant no 51421006 the strategic priority research program of chinese academy of sciences grant no xda2010010307 thespecialfundofthe state key laboratory of hydrology water resources and hydraulic engineering of china grant no 520004412 521013122 the natural science foundation of zhejiang province grant no lzjwy22d010002 the lead author thanks aquanty for his time spent at their waterloo ontario office and the training received on the use of the hgs model we also wish to thank prof jeffrey j mcdonnell from university of saskatchewan for improving the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129149 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2339,the majority of runoff studies to date have reported a similar pattern of rapid rain to runoff conversion via overland flow and shallow subsurface water flow as well as the ubiquity of thresholds and hysteresis in rainfall runoff response but each of those approaches has limitations in terms of inference and process description processes of water transport and mixing and how they influence runoff generation are still not well understood or quantified in this study hydrogeosphere a fully integrated surface subsurface flow model was used together with stable isotopes for disentangling runoff generation mechanisms in a headwater catchment the study area 0 21 km2 is the first level tributary of the xin an jiang river located in a humid climate region of eastern china water flow simulation elucidated the spatial water transport process and isotope tracing quantified the complex water mixing process between the shallow soil and hillslope surface this study provides insights into the rapid transformation of rainfall infiltration and mixing in soil and exfiltration to a hillslope results show that the stream runoff was separated into rainfall induced overland flow 9 exfiltration induced overland flow including the 53 of mixed water from rainfall infiltration and 6 of the stored soil water and subsurface flow 32 exfiltration induced overland flow was the dominant water source in the headwater catchment during a rainfall runoff event the mutual influence of rainfall infiltration and soil water exfiltration caused the shallow soil to rapidly become saturated thus forming saturation excess overland flow the consistence of estimated soil water velocity based on the integrated isotope and numerical modeling approach at about 0 4 m d nearby the stream channel improved the reliability of model visualizations further analysis indicates that water flow paths and velocities responding to the rainfall event were attributed to the soil moisture conditions and topography this study demonstrates that identifying the rapid mixing processes between the rain and the soil water was crucial for understanding hillslope overland flow and runoff generation in headwater catchments keywords runoff generation water mixing process headwater catchment stable isotope hydrogeosphere integrated analysis data availability data will be made available on request 1 introduction among the effects of climate change are the alteration of hillslope overland flow and stream runoff generation within headwater catchments wine and davison 2019 the runoff generation mechanism is one of the most crucial aspects of hillslope hydrology in humid mountainous environments headwaters or first order catchments are important as they commonly contribute a significant proportion of the total streamflow to drainage basins mcdonnell and beven 2014 hillslope hydrological processes are influenced by many factors including soil texture topography meteorology and hydrological conditions lee and kim 2021 mcguire and mcdonnell 2010 the source and movement of hillslope and stream water are fundamental to the understanding of catchment behavior dunne and black 1970 horton 1933 the shallow soil conditions on hillslopes where much flow generation and interaction take place are sources of uncertainty mcdonnell 2013 as the exchange between soil water and surface water occurs not only in stream channels but also significantly along the hillslope it is worth noting that the influence of mixing processes between rainfall and soil water is important at the catchment scale and affects the interpretation of runoff generation jones et al 2006 vereecken et al 2008 understanding the spatiotemporal dynamics of soil water movement during a rainfall event remains a challenge in hydrology ala aho et al 2017 brooks et al 2015 kirchner 2006 many studies focused on the development of numerical modeling describing soil water flow and runoff generation ala aho et al 2017 yu et al 2010 lumped conceptual rainfall runoff models were first proposed based on empirical relationships including the sac sma model peck 1976 hbv bergström 1976 and the xinanjiang model zhao 1992 later conceptually or physically based distributed hydrologic models that use spatial distributed inputs were developed yu et al 1999a including models such as topmodel beven and kirkby 1979 modflow mcdonald and harbaugh 1984 she abbott et al 1986 swat arnold et al 1993 and vic liang et al 1994 the hms yu et al 1999a b 2006 was developed to simulate basin scale hydrological processes driven by weather and includes surface and subsurface water flow and the interactions between them as well as evapotranspiration et the hydrogeosphere hgs model a fully integrated surface subsurface flow and transport model was designed to take all of the key components of the hydrologic cycle into account aquanty 2022 hgs has been applied over range of hydrologic settings to understand complex hydrological processes at hillslope catchment basin and continental scales park et al 2011 hwang et al 2018 yang et al 2018 chen et al 2020 frey et al 2021 xu et al 2021 based on model simulation results ali et al 2014 analyzed the travel time distribution in an idealized conceptual hillslope and wilusz et al 2017 studied the relationships between rainfall variability and transit time in two neighboring headwater catchments in the uk simulation capabilities have progressed significantly in recent years from lumped to distributed hydrologic models khakbaz et al 2012 to fully integrated 3d hydrologic models davison et al 2015 while acknowledging the strengths of fully coupled distributed models for better understanding of water flow they are often criticized because of their considerable data requirements beven 2002 stable isotopes δ2h and δ18o have been used as natural tracers to track complex soil water processes and their connectivity with the surface use of monitored isotope data can reflect the actual status of the catchment because they are components of the water molecule itself and are thus not strongly altered by chemical reactions li et al 2017 isotopic analysis has been widely used to interpret soil water transport and residence times jasechko et al 2016 and to estimate the subsurface water contribution to streamflow jones et al 2006 klaus and mcdonnell 2013 at scales ranging from a soil cross section and hillslope mcguire and mcdonnell 2010 to the catchment scale mcguire and mcdonnell 2006 li et al 2017 sprenger et al 2016 reviewed the crucial role played by stable isotopes in revealing the soil water movement han and zhou 2018 characterized the mechanism of soil water movement in the unsaturated zone under the impacts of extensive irrigation by using a combined physically based modeling approach and stable isotopes gibson et al 2016 conducted a process based summary of the use of stable isotopes in models many methodologies have been used for monitoring and simulating streamflow compositions wu et al 2020 estimating water flow paths and mean residence times kim et al 2016 koeniger et al 2016 and evaluating hydrological responses to various catchment properties park et al 2011 here we report on an integrated rainfall runoff response of a humid headwater mountain catchment instead of the large indoor facilities or only using numerical modeling the site is located on the first level tributary of the xin an jiang river in eastern china the outdoor experimental setting where natural conditions rainfall soil vegetation and landforms represent the key elements was coupled to the hgs modeling to provide an overall picture of the system studies in humid headwater catchments have described a pattern of rapid rainfall to runoff conversion via overland flow and shallow subsurface water flow muñoz villers and mcdonnell 2012 zhang et al 2021 and also showed the ubiquity of thresholds and hysteresis in rainfall runoff responses mcdonnell et al 2021 ross et al 2021 singh et al 2021 however the mechanisms that reveal how the rapid mixing processes of rain and soil water may influence runoff generation are still not well understood wu et al 2020 in this study we combine isotope tracing and modeling with hgs to disentangle the above complex runoff generation processes this study is one of the first that brings together stable isotope tracing and integrated surface subsurface simulations to determine streamflow compositions flow paths and transport time through the soil matrix and to the stream in a headwater catchment the main objectives of this study are to answer the following questions 1 can stable isotopes be used to improve the identification of water transport pathways and mixing processes when used in conjunction with physically based integrated hydrologic models 2 what are the spatiotemporal patterns of stream water sources and subsurface water fluxes in a small headwater catchment 2 study area the study site of the mukeng catchment 117 59 12 48 e 29 40 2 28 n is the first level tributary of the xin an jiang river fig 1 and has a drainage area of 0 21 km2 the xin an jiang river originates in anhui province flows through zhejiang province converges to qiantang river and finally flows into the east china sea topographic relief of the mukeng catchment was defined with 1338 measured elevation points fig 1 with elevations ranging from 387 m a s l at the northeast hilltop to 191 m at the catchment outlet the mukeng catchment is characterized by hilly topography and dense vegetation hillslopes on both sides of the main stem channel are dominated by shrub lands and forests except for a small portion adjacent to the western edge that is covered by croplands the forest land occupies more than 90 of the area the riparian areas of the valley bottom are mainly covered with croplands and native grasslands the topsoil is heterogeneous ranging from coarse sand to till and has a thickness of approximately 1 m the selection of the experimental site was aimed to represent the relatively most common natural settings in south of china where slope and hills are covered with dense vegetation rainfall p temperature t and potential evapotranspiration pet for the period of 2001 to 2015 were used in the analysis the daily rainfall and temperature data were provided by the climate data center national meteorological information centre of china with a 0 5 resolution dataset and three nearby climate station based datasets nearest distance of about 26 km https data cma cn rainfall and temperature data of august 2015 were monitored with the climate station located in the study area in addition daily pet was obtained from the usgs global pet datasets with 1 0 resolution https earlywarning usgs gov fews product 81 the data have changed little over the years although the changes in rainfall are more significant after 2007 the average annual temperature is 16 7 c with the lowest and highest average monthly temperatures being 4 c in january and 28 c in july the mean annual rainfall and pet are about 1580 mm y and 1000 mm y respectively furthermore according to a fifteen year water balance q p pet the annual outlet discharge q of this catchment is estimated to be 580 mm y per unit area which corresponds to approximately 37 of the mean annual rainfall 3 material and methods 3 1 field sampling and isotope measurements sampling locations for the stable isotope were chosen along the main stream channel fig 1 stream water samples sites r1 r8 were collected from 17 to 22 july in 2014 at the end of a short rainfall event sites r4 r5 and r6 are close to the confluence of tributaries at the same time soil water samples beside the main stream channel at a downstream location site i1 were taken using ceramic cup suction lysimeters with an applied pressure of 80 kpa at 30 cm i1 30 and 70 cm intervals i1 70 beneath the soil surface the water extraction process did not change the stable isotopic composition of the soil water additionally large plastic bottles were pre positioned in the downstream and central positions of the sampling area and rainfall samples sites e1 and e2 were taken on 17 july 2014 for use in isotopic hydrograph separation in total 58 isotope samples of the stream soil and rainwater were obtained from the mukeng catchment a second field campaign was carried out in august 2015 for better model calibration and validation rainfall and soil volumetric water contents were continuously monitored with a ten minute interval an automated climate station was installed in midstream and a set of soil moisture sensors were buried at a depth of 30 cm site i2 the daily outlet discharge was measured along with the stream stages and velocities according to iaea international atomic energy agency standard procedures all isotope samples were stored in 30 ml high density plastic bottles leaving no headspace with the cap covered with plastic wrap to avoid evaporation the samples were stored at about 4 c before the laboratory isotopic analysis the isotopic analysis was completed at hohai university using a spectrometer isotopic water analyzer picarro l2130 i with precision of 1 for δ2h and 0 1 for δ18o measurements on one water sample from a single vial were made six times and the reported isotope values δ2h and δ18o were determined by averaging the last three results after every third sample measurement calibration was carried out with three standard samples reported results table 1 were defined in the standard δ notation and the internal referenced standard was based on vienna standard mean ocean water vsmow 3 2 fully coupled subsurface surface model setup we chose hgs as the physically based water flow model to perform the simulations it is a 3d fully coupled subsurface surface hydrologic model that solves the continuum based nonlinear equations describing surface and subsurface flow including et aquanty 2022 richards equation and darcy s law are employed to describe three dimensional variably saturated subsurface flow 1 t θ s s ω q γ ex q 0 2 q k k r φ z where θ s is the saturated water content dimensionless s ω is water saturation dimensionless γ ex is the fluid exchange between the surface subsurface l3l 3t 1 positive for flow into the porous medium q is the volumetric flow rate per unit volume with the outside of the simulation domain representing a source positive or a sink negative l3l 3t 1 k is the hydraulic conductivity tensor lt 1 k r is the relative permeability of porous medium dimensionless φ is the pressure head l and z is the elevation head l the diffusive wave approximation of the saint venant equation is used to simulate flow over the land surface which is written as 3 d o z o t v xo d o x v yo d o y γ o q o 0 where d o is the depth of the surface flow l z o is the land surface elevation l and the terms v xo and v yo are the vertically averaged flow velocities in the x and y directions lt 1 used to couple with the momentum equation and manning s equation q o is a volumetric flow rate per unit area representing external source positive and sinks negative lt 1 et is treated as a nonlinear water sink in hgs and consists of evaporation e s lt 1 and transpiration t p lt 1 4 e s α 1 f 1 e d f p e t 5 t p f 1 f 2 s ω r d f p e t where α represents the reduced evaporative area of available water in the overland flow domain within the depressions dimensionless f 1 is a evaporation and transpiration partitioning factor f 2 s ω is a function of nodal water content edf is the evaporation distribution function rdf is the time varying root distribution function the surface subsurface exchange flux is simulated using a dual node approach assuming that subsurface and surface domain are connected through a thin exchange layer with a coupling length of l exch l 6 γ k r exch k zz l exch φ z d 0 z 0 where a positive γ represents water flow from the subsurface to surface system k r exch is the relative permeability for the exchange flux dimensionless and k zz is the vertical saturated hydraulic conductivity of the underlying porous medium lt 1 in this study the vertical discretization contains three stratigraphic layers from the surface to the base of the system fig 2 the top layer has a minimum thickness of 1 05 m and represents a loose soil vadose zone which has relatively high porosity and permeability with developed root zones in the croplands and grasslands the soil vadose zone was further divided into six elemental layers with the thickness of 20 10 20 20 20 and 15 cm respectively the lower part consists of an aquitard zone which is divided into two layers at a depth of 15 m below the surface the lowest layer extends to the bottom horizontal plane at z 150 m the surface domain consists of 6 different land cover types the two dimensional areal mesh consisting of triangular elements was generated with the software algomesh hydroalgorithmics 2016 given the local topography and stream channel a finer mesh resolution was used in the riparian areas to improve model accuracy in zones where steeper hydraulic gradients are expected details in table s1 to enhance the efficiency and maintain the accuracy of hgs simulation parameter settings for constructing the domain mesh were determined by optimizing the mesh generation features for catchment boundary stream minimum angle and length between nodes the total two dimensional areal mesh contains 12 427 triangle elements and 6 308 nodes extending the surface mesh with depth over all the grid layers yields 99 416 triangular prism elements and 56 772 nodes the et is controlled by the soil moisture state and vegetation type the optimal parameters for evaporation and transpiration estimated through model calibration are shown in table 2 the surface and subsurface flow parameter values for each land cover type and subsurface zone are also listed in table 2 three kinds of boundary condition were used 1 the outlet boundary was considered a critical depth boundary 2 a no flow boundary was assigned at all other sides of the domain 3 the surface rainfall boundary was set as the flux type boundary condition et on the top surface of the simulation domain is calculated internally in the model because the simulation domain is small spatially homogeneous but temporally variable rainfall and pet was applied for the simulations calibration of the hgs model focused on the discharge at the outlet and soil water saturation at site i2 for the period of august 2015 using both the daily and hourly discrete simulations respectively model performance was assessed using both the root mean squared error rmse and nash sutcliffe efficiency nse and also the mean and standard deviation of the residuals between the modeled and observed data were analyzed to show the systematic error and the random error the metrics of rmse and nse are described in dawson et al 2007 they are described as 7 r m s e i 1 n q i q i 2 n 8 n s e 1 i 1 n q i q i 2 i 1 n q i q 2 where q i is the observed value q i is the modeled value where i 1 to n data points and q is the mean of observed data 3 3 separation of the water source for stream flow to more clearly understand how and where the stream runoff was generated the temporal and spatial origins of the stream runoff were deduced using both isotopic analysis and numerical modeling regarding the rainfall runoff process when new water is introduced into the catchment it mixes with the old water by tracking monitored isotope signals that occurred before pre event water or are newly introduced event water an isotope mass balance can be constructed based on a water mass and isotope mass balance 9 q t q pre e v e n t q event 10 q t c t q pre e v e n t c pre e v e n t q event c event 11 f pre e v e n t q pre e v e n t q t c t c event c pre e v e n t c event where q t is the total stream runoff l3t 1 q pre e v e n t and q event are the discharge from pre event and event water l3t 1 c t c pre e v e n t and c event are the stable isotope values of the stream pre event and event respectively f pre e v e n t is the contribution of pre event water in the stream runoff from the spatial perspective of water sources subsurface water flow is generated by hydraulic potential differences and transports the water to the streams while surface water is accumulated from rainfall and overland flow and occurs based on topography park et al 2011 here the method for calculating the subsurface water contribution to the total stream runoff f sub is used that is based on the simulated exchange flux between the subsurface and surface 12 f sub a river γ d a river q t i 1 n γ l e n g t h i w i d t h i q t where n is the total number of nodes along the stream channel and i is node index γ lt 1 length i l and width i l are the exchange flux and the corresponding length and width of each node s contributing area in the stream channel and q t is the total stream runoff l3t 1 the nodal exchange flux is given by the eq 6 during the rainfall event infiltration causes the shallow soil to saturate rapidly thus producing saturation excess overland flow the hillslope overland flow is composed of rainfall induced and exfiltration induced portions based on the water balance the hillslope overland flow can be expressed as 13 hr p et s i s i g δ w s 14 hr p p et s i s δ w s α α 0 1 15 f r p hr p hr where hr is the runoff of hillslope overland flow l t 1 p is the amount of rainfall l t 1 et s is the et on the surface l t 1 i s is the amount of water infiltration l t 1 i g is the amount of water exfiltration from the underground l t 1 δ w s is the changes of overland water storage l t 1 hr p is the rainfall induced overland flow l t 1 α is an factor to distinguish the different impacts from rainfall and exfiltration on the changes of overland water storage f r p is the rainfall induced contribution to the hillslope overland flow 3 4 estimation of the soil water velocity this study provides an isotope based technique to calculate the soil water velocity in addition to that determined from model simulation the horizontal soil water velocity v h s o i l l t 1 can be obtained with the soil water transport time t trans t and the corresponding flow distance l t l 16 v h s o i l l t t trans estimating the soil water transport time t trans using the convolution method assumes that the isotopic composition of the water leaving the system δ out stream water is identical to that of the water entering it δ in soil water lagged by some time and weighted by a time distribution function g t trans t trans is the time that a water particle would take to flow through a hydrological system this is expressed mathematically as details in koeniger et al 2016 17 δ out t 0 δ in t t trans g t trans d t trans to simplistically characterize the time distribution function g t trans the isotopic peak shift method has been introduced this method focuses on tracking the obvious and unique isotope feature such as the abrupt rise and fall processes or peak values of the monitored isotope data series and then estimates the t trans based on the reviews by sprenger et al 2016 this study simplified t trans as 18 t trans t out t in where t in is the time of the distinctive peak of the input isotope signal t and t out is the time of the peak in the output time series t 4 results 4 1 stable isotope distributions in the catchment the relationship of δ18o and δ2h for all the water samples is shown in fig 3 for the stream samples the linear relationship is referred to as the river water line rwl δ2h 3 593δ18o 18 196 similarly the soil water evaporation line sel is expressed as δ2h 3 358δ18o 19 846 the local meteoric water line lmwl is obtained from liu et al 2014 δ2h 6 41δ18o 8 25 the similar slopes between rwl 3 593 and sel 3 358 demonstrates the strong correlation between the subsurface and surface water in this study area moreover these slopes are gentler than those of the global meteoric water line gmwl and lmwl 8 and 6 41 indicating the vital effect of evaporation in this study area the different types of water samples stream and soil water showed different temporal isotopic patterns table 1 and fig 4 the isotopic composition of the stream water ranged from 66 29 to 17 04 in δ2h and from 12 67 to 0 28 in δ18o and the isotopic composition of the soil water varied in the range of 59 79 to 11 59 and 16 42 to 0 13 in δ2h and δ18o respectively the similar isotope ranges of the stream and soil water imply that they are well mixed and have a strong hydraulic connection the average stable isotope values in the stream water were 48 84 and 8 53 for δ2h and δ18o respectively which are slightly lower than that in the rainwater therefore the streamflow must be primarily fed by the subsurface water which is commonly old water and depleted in heavy isotopes after july 20th the isotope value was relatively stable at the value of approximate 5 in δ18o at a depth of 30 cm while it decreased significantly at 70 cm the difference in stable isotope changes in the soil water at 30 cm and 70 cm reveals different evaporation effects on the vertical soil profile a d excess analysis has been performed to show the evaporation effect on the stream and soil water and it is defined as d excess δ2h 8δ18o dansgaard 1964 evaporation within the catchment causes the enrichment of isotope values and decrease of d excess values the trends in the d excess distribution in space and time table 1 and fig 4 are such that the values decrease from the upstream to the downstream and over time the evaporation effect is small during the rapid rainfall runoff processes after july 17th evaporation becomes more intense and varies spatially across the catchment therefore the monitored stable isotopes show a slight enrichment over time and significant variability in space 4 2 flow characteristics during a rainfall event based on hgs simulation a pseudo steady state simulation was first performed with average annual rainfall and pet inputs to obtain an initial state for the subsequent transient simulations the model was forced with a constant net rainfall input rainfall pet at the top surface of the simulation domain the simulation was performed until the outlet discharge reached a stable value which equaled the amount of water falling on the simulation domain under the net rainfall of 5 23 10 3 m3 s the steady state condition was used as the initial state for the subsequent transient simulations then the transient hgs simulation was carried out from 2001 to 2015 in order to enhance the simulation efficiency the simulation period was separated into three stages monthly discrete simulation before 2011 daily discrete simulation after 2011 and additional hourly discrete simulation on august 2015 the hgs model was calibrated by fitting the simulated outlet discharge and soil water saturation with the observed data in the study site over the period of 1 to 28 august 2015 using the daily and hourly discrete simulations respectively model calibration in the study mainly included three parts 1 calibrated surface flow parameter values with land cover types 2 model parameter sets for subsurface flow simulation based on the soil textural classes and 3 et parameter value set for evaporation and transpiration simulations first land cover types were recorded during two field campaigns and representative parameter values table s3 of different land cover for hgs surface flow simulation were selected with the references of hwang et al 2018 and yang et al 2018 second soil textural classes were distinguished for each land cover area by combining the measured representative soil hydraulic conductivity values values of porosity residual water contents θr and hydraulic conductivity kx ky of different soil type table s4 were obtained from the default values in hydrus 1d šimůnek et al 2013 with the consideration of anisotropy kx ky 10kz was assumed the representative values of specific storage that reflects the soil water storage capacity were chosen based on the reference of domenico and mifflin 1965 finally considering the importance of water balance during the quantification of different water sources et simulation was carefully optimized to control the water storage change in the catchment and streamflow discharge at the outlet sensitive parameters were chosen and calibrated table s2 based on the hgs user manual aquanty 2022 including the maximum root depth oxic limit of transpiration limiting saturations and maximum value of evaporation limiting saturations the metrics of rmse and nse were calculated for both the outlet discharge and soil water saturation to evaluate the model performance for the period of 1 to 28 august 2015 the daily and hourly discrete simulations were carried out with rainfall measurements from the climate station in the study area the pattern of measured rainfall dataset is comparable with the grid based daily rainfall data both the daily and hourly discrete simulations match the measured stream runoff well fig 5 a capturing the first and second peaks of the runoff hydrograph additionally the runoff response to the rainfall is very rapid the rmse results for the daily 0 0018 m3 s and hourly 0 0016 m3 s flow simulations are close to zero and the nse results are 0 49 and 0 57 respectively table 3 the simulation result for the soil water saturation rmse 0 0334 is acceptable in term of the average state nevertheless the difference between the simulated and measured soil water saturation is noticeable a negative nse of 1 49 with a slight overestimation by the model at early times and some underestimation at later times respectively fig 5b meanwhile to further demonstrate the systematic error and the random error the mean and standard deviation of the residuals between the modeled and observed data were calculated the mean of the residuals for daily and hourly flow simulations are 3 10 5 m3 s and 7 10 4 m3 s respectively and the corresponding standard deviations of the residuals are 0 0018 m3 s and 0 0015 m3 s results demonstrate that the hgs model performs well for the water flow simulation in the catchment and the hourly simulation with its hourly precipitation input captures more details in the runoff peaks in response to the discrete rainfall processes fig 5a at the perspective of the soil water saturation simulation the mean 0 0131 and standard deviation 0 0307 of the residuals show that the overall bias of simulation results is small besides the reliability of the hgs simulation has been further improved through the comparative verification of hydrological processes based on simulation results and isotopic analysis in the following sections for example the separation results of the subsurface water pre event water contribution to stream runoff are similar and the estimations of the soil water transport time are consistent in general although there are some uncertainties associated with the model parameters and limited field data for verification the simulation results are reasonable and acceptable to provide more details on the rainfall runoff process the simulated stream and soil water velocity et depth to groundwater table dtg and exchange flux between the surface and subsurface were analyzed during the first sampling period fig 6 the data show that the rainfall influences the stream water velocity and horizontal soil water velocity with a fast soil water respond by contrast the vertical soil water velocity is more related to the et process soil water moves to the surface as driven by the evaporation but this trend diminishes during the period 13 15 july due to the strong rainfall the data demonstrate a good correlation between the subsurface surface exchange flux and dtg where exchange flux increases as the groundwater level rises during the rainfall event thus the soil water dynamics significantly influence the runoff generation especially during the rainfall event 4 3 temporal and spatial sources of the stream runoff the temporal source of the stream runoff will be divided into pre event and event water the average δ18o isotope value of the event water is 7 71 which is comparable to that in the nearby areas reported in liu et al 2014 in order to eliminate the effects caused by evaporation and water mixing along the subsurface flow paths the minimum isotope value 11 50 at a depth of 70 cm i1 70 is assumed to be the signature of the pre event water these values together with the average δ18o isotope value of the stream water at 8 53 bring the fraction of pre event water in the stream at approximately 39 34 21 using the isotope mass balance model this estimates also emerges from 37 49 30 fraction using the δ2h data thus the percentage of the pre event water in the stream runoff is about 38 on average for the first sampling period the results of the hydrograph separation based on the hgs calculations are listed in table 4 for the entire rainfall event of the first sampling period the contributions of the subsurface water to the stream runoff decrease from 52 to 8 until the flow peak time after that the contribution gradually increases to about 38 to the total outlet runoff the estimated subsurface water contribution to stream runoff for the first field sampling period is approximate 25 to 38 32 on average which is somewhat lower than the estimated pre event water contribution based on the isotope mass balance approach during the rainfall period there was ponded water observed on the ground surface near the main stream channel and in the small ditches and this surface water quickly converged to flow toward the stream channel based on above water balance method for separating water sources of hillslope overland flow quantifying water sources of hillslope overland runoff suggests no rainfall induced overland flow during the first two days of the rainfall event table 4 and the infiltration and exfiltration processes are significant in response to the rainfall the highest proportion of rainfall induced overland flow occurs on 15 july that was associated with intense rainfall event this proportion derived from hgs model results is correlated with the daily rainfall and spans at a wide range from zero to 63 2 3 8 4 4 water flow velocity from model and isotope based approach the simulated water flow paths and velocities within the surface and subsurface domains during the first sampling period are displayed in fig 7 the water flow velocity is substantially higher in the stream channel and within the shallow subsurface of the soil the lateral water flow velocity within the soil was calculated by using both the hgs simulation results and the measured isotope signals the soil water flow distance from soil monitoring site i1 fig 1 to the stream channel is about 1 45 m and the average linear soil water velocity calculated by hgs is approximately 0 415 m d during the first sampling period this average velocity was estimated using all elemental soil water velocities along the studied flow path based on the flow distance and the model based average velocity the soil water transport time is about 3 to 4 days the stable isotope data reveal distinctive trends of fluctuations in the stream water fig 4 at sites r1 r2 and r7 after 17 july the surface water velocities fig 6 are similar and low while the simulated evaporation rates fig 6 are much lower at sites r1 and r7 than that at r2 isotope evaporative fractionation could be a factor at site r2 thus there must be a water source containing enriched isotopes at sites r1 and r7 it is notable that the isotopic composition of the soil water at site i1 spans a wide range from 11 50 to 0 13 in δ18o table 1 with fairly high values on 18 and 20 july after the rainfall event fig 4 as mentioned above the soil water flows towards the stream causing the increase in heavier oxygen isotope values in the stream water site r1 on 22 july based on the isotopic peak shift method the soil water transport time from the soil site i1 to the stream site r1 1 45 m is in good agreement with the hgs simulation result at about 3 to 4 days thus the isotope based soil water velocity is about 0 42 m d 5 discussion 5 1 evaluation of transport and mixing processes in the soil water soils play a vital role in the water cycle by controlling infiltration exfiltration et and lateral water migration and mixing each can affect the soil water moisture and the isotopic signatures of water sprenger et al 2016 based on the simulated patterns of the soil water flow paths fig 7 characteristics of the soil water movement are distinctive from the upstream to the downstream locations the study area is a hilly region with larger slopes upstream and relative flat topography midstream and downstream at the upstream vertical infiltration is the dominant process and the deep groundwater is slowly recharged at the midstream fast soil water movement is parallel to the land surface and subsurface water seepage occurs at the downstream vertical water exchange infiltration and fast exfiltration increases the interaction between the subsurface and surface this result is consistent with that reported by park et al 2011 in a schematic catchment horizontal flow and mixing of soil water play an important role the soil water velocity of about 0 4 m d from the soil site i1 to the stream site r1 was estimated by both the hgs simulation and from the isotope data the higher horizontal hydraulic conductivity at the hillslope leads to the increased soil water seepage towards the surface along the valley during the rainfall event fig 7 in the riparian areas of the valley bottom soil water exfiltration appears whether there is rainfall or not while on the upland hillslope areas rainfall induced soil water moves laterally in the shallow soil during the rainfall event fig 7b the isotope variability is attributed to processes occurring in the catchment such as water mixing from enriched or depleted isotope water sources thus the observation of high isotope values at midstream site r7 with the d excess values of 9 36 and 12 20 that appeared a few days earlier than r1 is related to the enriched heavy isotopes stored in the shallow soil water the interaction between the subsurface and surface is directly affected by the fluctuations in the depth to the groundwater table dtg in fig 6 with the rise in the groundwater table after the rainfall causing an increase in the subsurface water contribution to the streamflow the changing pattern of the dtg exhibits characteristics related to the soil saturation with the shallower dtg corresponding to the higher saturation the very negative values of d excess 17 44 and 17 96 in the soil water at the 70 cm depth indicate that the water source for these two samples experienced strong evaporation reckerth et al 2017 the isotopic composition of the deeper soil water is assumed to be relatively constant over time and space and the fractionation effects caused by evaporation are primarily limited to the upper 30 cm of the soil evaristo et al 2015 sprenger et al 2016 thus the soil water at 70 cm depths showing heavy isotope enrichment was likely transported from the upland surroundings as suggested by the downslope soil water movement driven by the heavy rainfall this water mixing is more obvious in the shallow soil water which depends on the strong vertical movement of the soil water singh et al 2021 however research on hillslope hydrological connectivity has mainly focused on the horizontal direction rather than the vertical flow effect liu et al 2019 overall the hillslope hydrological response to a rainfall event involves complex mixing processes between the rainfall the surface water and the soil water park et al 2011 5 2 the effect of infiltration mixing exfiltration on the hillslope runoff generation based on the spatial and temporal sources of the stream runoff the contribution of subsurface event water estimated by hgs is smaller than the pre event water calculated with isotope data as mentioned above the traditional separation of the stream runoff into subsurface pre event and surface event sources is affected by complex mixing processes the soil water exfiltrates to the hillslope and then ultimately emerges as surface runoff thus the contribution from the soil water in the streamflow composition will be underestimated during the rainfall event the process of rainwater infiltration to the underlying subsurface should be dominant because the soil infiltration capacity 1 000 10 7 to 1 217 10 4 m s in table 2 exceeds the rainfall intensity average value of about 5 010 10 8 m s dunne and black 1970 therefore the formation of overland runoff in this humid and forested study area is dominated by saturation excess overland flow which is driven not only by the rainfall but also by the soil water exfiltration ala aho et al 2017 in this study the hillslope overland flow was further separated into rainfall induced and exfiltration induced parts table 4 the proportion of rainfall induced overland runoff in the hillslope increases to about 63 and then it sharply decreases to zero within four days the average contribution of rainfall induced flow in the total stream runoff is about 9 for the whole rainfall event in humid areas rainfall can also quickly generate surface runoff through the soil water flow liu et al 2021 mccoll et al 2017 reported that 14 4 of the rainfall remained in the surface soil within 3 days which was continuously influencing the runoff generation the above estimated contribution of surface water overland flow is mixed with the rainfall and exfiltration water from the soil kim et al 2016 yang et al 2018 while the exfiltrated soil water could be dominated by the continued rainfall a conceptual of the runoff generation processes is presented in the diagram provided in fig 8 during the rainfall event based on the hgs simulation results overland flow and subsurface flow provide 68 and 32 of the total stream runoff respectively the overland flow has been separated into rainfall induced 9 to stream runoff and exfiltration induced 59 to stream runoff parts considering the results derived from isotopic analysis the event water 62 consists of not only the rainfall induced overland flow but also the exfiltrated soil water derived from the rainfall infiltration 53 thus exfiltrated water from the stored shallow soil water represents about 6 the hillslope runoff generation is dominated not only by the topography but also by the rainfall conditions feng and liu 2015 to further explore subsurface stormflow generation during a rainfall runoff event over the hillslope three dimensional soil water saturation distributions at various times were selected to visualize the rainfall induced soil water movement fig 9 in headwater catchments the degree of soil water saturation is a critical factor for soil water movement at the first occurrence of the rainfall event the short duration has a generally minor influence on the distribution of soil saturations although the influence is noticeable in the downstream riparian areas marked area in fig 9 during the rainfall event the subsurface domain experiences increasing soil moisture towards a state of saturation intensive rainfall results in the storage of water in the soil that sharply changes the saturation of the topsoil causing rapid soil water flow and water exchange with the surface after 17 july the vertical exchange of water becomes weak during the following monitored one week thus the result suggests that the shallow soil water movement rapidly responds to the heavy rainfall which also has been explained by lee and kim 2021 in summary the shallow soil water flow plays a vital role in mixing different water sources and bringing them into the stream channel the infiltration mixing exfiltration process in the shallow soil is key for runoff generation in mountain headwater catchments the integrated analysis combining hgs simulation with isotope tracing revealed useful details about soil water storage and release processes and the complex surface subsurface exchange of water 6 conclusions the integrated approach of isotopic analysis and modeling employed in this study adds understanding of water mixing processes and the effect on runoff generation in a headwater mountain catchment our results indicate that the hydrological connectivity between the soil and the surface is significant in headwater catchments in response to the rainfall the contribution of the subsurface water to the stream was estimated to be 32 during the rainfall event hillslope overland flow consisted of not only the rainfall but also the soil water exfiltration the proportion of rainfall induced overland flow exhibited a wide range from zero to 63 2 3 8 our finding suggested that rainfall can quickly generate hillslope overland flow through the saturation excess overland flow and through soil water exfiltration considering the temporal separation of water sources derived from the isotopic analysis the complex process of rainfall infiltration mixing in soil exfiltration to hillslope can be quantitatively described this study showed that the shallow soil and surface interactions were enhanced at both downstream and hillslope locations by the strong soil water infiltration exfiltration process during rainfall events we presented an effective approach to identify details about rainfall runoff processes with a focus on the separation of the water sources contributing to streamflow this study demonstrates the great potential of isotope tracing in the study of the water source composition and movement and can also be used to verify the reliability of hydrological simulations traditional hydrological simulations primarily focus on stream runoff optimization which frequently results in unpredictable deviation in the simulation of subsurface water flow in the catchment the distribution of sampling location and frequency limits the application of isotopic analysis in exposing hydrological characteristics making the quantitative analysis and research limited or highly imprecise in this study an integrated surface subsurface flow simulation and isotope tracing analysis are combined to improve the understanding of runoff generation mechanisms in a headwater catchment isotope tracing provides useful hydrological information for refined hydrological simulation and calibration especially subsurface water flow characteristics that are difficult to directly observe however this study also has limitations such that we only analyzed the runoff composition and mixing processes for a single rainfall runoff event and thus more work should be conducted for various rainfall runoff events in general the success in the integrated application of stable isotopes and hgs model provides a new perspective for elucidating runoff generation mechanisms credit authorship contribution statement xuegao chen methodology investigation writing review editing formal analysis writing original draft visualization data curation zhongbo yu conceptualization funding acquisition supervision peng yi validation formal analysis project administration resources ala aldahan writing review editing hyoun tae hwang software writing review editing edward a sudicky software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported bythe national natural science foundation of china grant no 42201015 u2240217 51979072 the jiangsu funding program for excellent postdoctoral talent grant no 2022zb173 national science funds for creative research groups of china grant no 51421006 the strategic priority research program of chinese academy of sciences grant no xda2010010307 thespecialfundofthe state key laboratory of hydrology water resources and hydraulic engineering of china grant no 520004412 521013122 the natural science foundation of zhejiang province grant no lzjwy22d010002 the lead author thanks aquanty for his time spent at their waterloo ontario office and the training received on the use of the hgs model we also wish to thank prof jeffrey j mcdonnell from university of saskatchewan for improving the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129149 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
