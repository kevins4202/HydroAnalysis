index,text
21075,this paper proposes a method based on the improved genetic algorithm for cooperative collision avoidance by multiple unmanned surface vehicles hereinafter referred to as multiple usvs in the multiple usvs collaborative task mode in a complex environment featuring obstacles we establish models of the multiple usvs system and sensor detection divide scenarios involving multiple usvs encounters and design corresponding collision avoidance strategies and calculate the motion parameters and risk of collision to determine whether to take measures to avoid collisions following this we choose the genetic algorithm ga as core algorithm to plan for collision avoidance improve it through retention deletion and replacement use the analytic hierarchy process to build a fitness iteratively optimize the adjustment of velocity and heading and calculate the current best path for collision avoidance for multiple usvs finally we built a simulation platform for multiple usvs collision avoidance planning based on the qt software and designed typical cases to verify the proposed method with and without communication conditions the results show that the proposed method can be used for the safe operation of multiple usvs index terms colregs genetic algorithm multiple unmanned surface vehicles collision avoidance 1 introduction the usv is an intelligent unmanned maritime platform that can usually be used to perform tasks during military and civil activities that are not suitable for manned vessels in complex marine environments wang et al 2009 multiple usvs are a cluster of two or more usvs that take advantage of group leadership through overall command and close collaboration and can quickly and efficiently complete complex tasks that are difficult or even impossible to accomplish with a single usv steimle and hall 2006 in the complex and ever changing marine environment it is important to enable multiple usvs to safely sail and successfully complete tasks by implementing a collision avoidance function liu et al 2016 collaborative collision avoidance planning for multiple usvs groups refers to multiple usvs avoiding static and dynamic obstacles and not colliding with each other during the execution of tasks larson et al 2007 tang et al 2015 local obstacle avoidance planning for usvs refers to the use of maneuvering behavior in real time to avoid collisions with static and dynamic obstacles casalino et al 2009 it consists of two strategies local path planning based on path search which can generate a series of reasonable track points and reactive collision avoidance planning based on real time behavior to control speed and direction richard bucknall applied cubic spline interpolation to improve the traditional a star a algorithm designed three path smoothers to reduce the number of turning points and the costs of turning and applied it to the springer usv to obtain a relatively smooth and non redundant path richard et al 2019 yogang singh proposed a constrained dijkstra algorithm to generate safe waypoints by maintaining a safe distance from obstacles however the problem of the heading constraint variable range of heading has never been considered in simulations yogang et al 2018 rui song improved the algorithm for path planning by using a two layer vector field and represented the dynamic environment as a base vector field and an environment vector field which solved the problem of the high risk of collision in the traditional method song et al 2017 tsou used the concept of e navigation as a framework positioning collision avoidance path planning as the main theme and applies an ant colony algorithm aca in the field of artificial intelligence to construct a collision avoidance model that imitates optimization behaviors in real life applications tsou and hsueh 2010 tsou 2016 wang dong designed an algorithm based on the steering strategy to obtain the steering rate using the smallest relative distance between the usv and obstacles in the feasible steering range but its speed was not optimized wang et al 2011 naeem developed a usv collision avoidance system that automatically generates an environmental map when the collision avoidance distance is reached the system generates a collision avoidance warning and maintains a sufficient safety distance from obstacles to realize autonomous collision avoidance in a highly dynamic and unpredictable environment naeem and irwin 2010 lifei song introduced the centrifugal field to improve the artificial potential field and used the velocity obstacle vo algorithm to solve the vector of velocity to avoid obstacles but this method is not suitable for complex environments featuring multiple dynamic obstacles song et al 2018 although many algorithms for real time obstacle avoidance have been proposed in dynamic environments in the last few years collision avoidance planning persists as a problem that limits the long term development of usvs for example in the context of the above two strategies some proposed methods based on path search do not consider the scenario where dynamic obstacles are encountered in close proximity bańka et al 2015 some reactive obstacle avoidance planning usually only plans the steering angle of the usv without considering the length of the path some consider velocity fukushima et al 2013 in addition only some studies have combined rules of collision avoidance campbell proposed a heuristic repair a algorithm based on the international maritime collision avoidance rule in a decision making framework that plans a safe and feasible path online and implements a quick search by retaining and reusing cost information campbell et al 2012 yanlong wang proposed the algorithm based on international regulations for preventing collisions at sea colregs and applied a re planning strategy to generate feasible trajectories according to the kinematics of usvs and discriminative locality alignment dlas however only the case where single obstacles were encountered was considered wang et al 2018 naeem et al proposed a usv path search planning algorithm based on colregs and proposed a re planning strategy for overtaking crossover and frontal naeem et al 2012 johansen et al use simulated predictions of the trajectories of the obstacles and ship compliance with the colregs and collision hazards associated with each of the alternative control behaviors are evaluated on a finite prediction horizon and the optimal control behavior is selected johansen et al 2016 chiang proposed colregs rapid exploration random tree rrt an rrt based planner capable of identifying long term colregs compliant trajectories with a high navigation success rate chiang and tapia 2018 tam described the development of a deterministic path planning algorithm that computes a practical and colregs compliant navigation path for vessels which are on a collision course the algorithm was evaluated with a set of test cases simulating various traffic scenarios tam and bucknall 2010 most current usv collision avoidance methods that consider criteria for collision avoidance divide encounter scenarios with a dynamic target into only three types encounter chase and cross the three encounters are shown in the picture in table 2 each scenario is too general to describe the various situations that can obtain therefore the collision avoidance strategy cannot guarantee that encounters at all angles within the given range of angles can achieve optimal collision avoidance campbell et al 2014 in addition most studies have not considered scenarios involving encounters with multiple obstacles compared with collision avoidance for a single usv that for multiple usvs is a combinatorial optimization problem with more constraints mu et al 2017 it is usually necessary to satisfy multiple objective requirements such as the heading angle of multiple usvs and speed constraints on them and path length and smoothness which are non deterministic polynomial np problems colito 2003 the systems of multiple usvs have more control objects where this increases the computational complexity of the algorithm and the coupling of variables zhuang et al 2016 in addition encounter scenarios involving multiple usvs are more complex and these include scenarios where multiple usvs encounter multiple obstacles at the same time kim et al 2014 few studies have considered the collision avoidance for a system of multiple usvs benjamin proposed the fast marching square algorithm based on colregs for obstacle avoidance and path planning for multiple usvs however this method is limited for use only when the sensor fails benjamin and curcio 2014 krishnamurthy used the method of the equivalent threat circle to construct a threat field to improve the spatial voronoi diagram the set of initial paths and the neighborhood in multiple usvs path planning are constructed according to the radius of threat the chaotic algorithm is used to initialize the honey source to improve the artificial bee colony algorithm and accelerate convergence however only static environments are considered krishnamurthy et al 2008 yuanchang liu used the distance at closest point of approach dcpa to evaluate the risk of collision and proposed the afms learning the weight of feature interactions via attention networks algorithm to carry out multiple usvs path re planning to achieve formation control without considering the criteria for collision avoidance liu and bucknall 2015 huang yamin proposed system visualizes the changes of one ship s course and speed resulting in collisions which can be used not only for supporting the officer on watch to prevent collisions but also for collision prevention of autonomous surface vessels asvs and for human operators taking over the control of asvs huang et al 2019 zheng huarong li shijie proposes a distributed coordination strategy predictions of ship trajectories are made based on ship dynamics giving different candidate rudder angles and potential collision risks that may be caused by each rudder angle selection are evaluated based on calculations of collision risk parameters zheng and negenborn 2017 in systems of multiple usvs it is necessary to consider whether there is communication among the usvs most systems for usv collision avoidance planning do not consider communication or assume by default that there is no communication which is inconsistent with empirical situation and ignores the communication module as a perceptual tool li et al 2019 caccia used the communication module of the blackboard structure to write the position of the obstacle caccia et al 2007 and corfield et al proposed an information interactive explicit communication module based on the knowledge query and manipulation language kqml protocol corfield and young 2006 however it has a problem whereby the communication module and sensor module are confused in a certain range and the role of the former which is used to obtain information on position speed and heading is not fully utilized to assist in collision avoidance heidarsson and sukhatme 2011 current models of collision avoidance can be divided into traditional and intelligent methods traditional methods include the artificial potential field method and random sampling whereas intelligent methods include fuzzy logic and neural networks naeem et al 2008 sun et al 2018 kim et al 2012 larson et al 2006 various methods have been used to solve the problem of collision avoidance planning but are limited for example the artificial potential field method has advantages in terms of real time dynamic collision avoidance but suffers from the problem of overshoot and does not consider the next movement sutulo and guedes soares 2014 the forward maximum match fmm algorithm has better path smoothness and continuity but its ability to solve dynamic constraints in real time planning is poor wu et al 2017 random sampling planning can effectively overcome the problem of the local minimum but requirements for setting parameters of the algorithm are stringent zhao et al 2016 fuzzy logic comprehensively evaluates all directions and can effectively avoid collisions but the requisite calculation is complex when the number of obstacles increases cheng and zhang 2018 neural networks can maintain small path lengths as far away as possible from obstacles but appropriate network topologies and connection weights need to be used liu 2015 the genetic algorithm is an adaptive global probability search optimization algorithm that has been widely applied to research on collision avoidance planning for example y liu proposed an assistant decision making method based on genetic algorithm to give a better collision avoidance strategy liu and liu 2018 tsou mc adopted the genetic algorithm used in artificial intelligence to find a theoretically safety critical recommendation for the shortest route of collision avoidance from an economic viewpoint tsou et al 2010 ni shengke presented a novel optimal trajectory planning based on hybrid genetic algorithm ni et al 2018 zeng x used a path planning method to avoid navigation obstacles and other moving ships according on navigation traffic rule zeng et al 2000 it has the following characteristics 1 it is adaptive and can discover environmental characteristics and laws based on environmental changes 2 it has parallelism and can cover all information and avoid search for useless points 3 it uses probabilistic search and has a strong ability to update the solution set 4 it is robust and its object of operation is the chromosome without considering variable constraints 5 it is universal and is suitable for nonlinear multi model and multi objective optimization problems he et al 2012 based on the needs and a comparison of various algorithms the authors chose the genetic algorithm to study the multiple usvs collision avoidance in terms of single usv collision avoidance the uk s springer uses collision avoidance based on the genetic algorithm to predict and control movement in a nonlinear environment and implements real time local path planning huang et al 2020 north wind marine s sea fox uses a search algorithm based on collaboration to independently plan a secure path in an environmental model li et al 2016 bye robin t define the 1d tug fleet optimization problem and present a receding horizon genetic algorithm for solving it the algorithm can be configured with a set of cost functions such that each configuration effectively constitute a unique tug fleet optimization algorithm bye 2010 in terms of multiple usvs collision avoidance liu designed a decision making system based on the evolutionary genetic algorithm and adopted a heuristic method for population initialization economy of resources smoothness and safety were used as factors of fitness and deletion and repair operations were added to the traditional genetic operation to establish an optimized iterative process liu et al 2018 he et al combined the simulated annealing algorithm based on a time varying selection strategy when establishing the fitness of the genetic algorithm and used the simulated annealing algorithm to eliminate local optimal ability and prevent the genetic algorithm from falling into a local optimum he et al 2019 while the genetic algorithm has been used for multiple objects for collision avoidance planning it generally encounters such problems as falling into the local optimum slow convergence and the degradation of the solution bye et al 2015 the number of iterations and population determine the time taken for each optimization and most of them are ineffective the coding for the initialization of the heuristic binary adopted by liu is complicated and redundant the deletion and repair operations are ineffective and a simple simulation of the design cannot fully verify the algorithm he et al nested the simulated annealing algorithm into the fitness of the genetic algorithm but this algorithm is difficult to solve and increases the time needed for each iteration in summary the following difficulties mainly exist in the current multiple usv collision avoidance planning methods 1 design of collision avoidance methods when the navigation environment is complex and changeable full of multiple static and dynamic obstacles 2 the fusion of environmental information when there are multiple instruments in the system 3 the influence of communication information on collision avoidance when there is a communication module 4 the design of multiple usvs collaborative collision avoidance strategy makes it comply with norms and safety 5 multiple usvs collision avoidance is a multi objective multi constrained optimization problem and the algorithm is not easy to solve 6 for high speed usv collision avoidance it is necessary to ensure the timeliness and safety of the collision avoidance method but also to consider the platform motion characteristics to output parameters 7 in the optimization process of the intelligent algorithm based on random iteration there are problems such as falling into the local optimum and slow convergence speed in response to the above problems given that the literature does not provide an adequate solution to the problem of multiple usvs collision avoidance planning this paper designs a multiple usvs cooperative collision avoidance planning method based on the improved genetic algorithm with the aim of solving the problem of local obstacle avoidance by multiple usvs in a complex environment featuring obstacle the method is directed to the mode of multiple usvs group collaboration establishes the models of the multiple usvs system and the sensor divides encounter scenarios and designs corresponding strategies for collision avoidance and calculates motion parameters and the risk of collision in real time to determine whether to take collision avoidance measures aiming at the limitations of the genetic algorithm we design retention according to the strategy of elite retention to solve the problem of degradation and premature convergence and design deletion and replacement to improve the ability of local search and speed of convergence of the algorithm we then use the improved genetic algorithm to iteratively optimize the adjustment of velocity and heading and calculate the current best path for multiple usvs compared with the conventional genetic algorithm the improved algorithm designed in this paper has the advantages of fast convergence high stability fast optimization and low time complexity in addition the algorithm is versatile and can be used for collision avoidance planning on other intelligent platforms the remainder of this paper is organized as follows section 2 describes the basic design of collision avoidance systems and section 3 elaborates on the design of collision avoidance based on the improved genetic algorithm section 4 details the design of the simulation software and verifies the proposed algorithm finally section 5 discusses the conclusions of this study and direction for future work 2 basic design of obstacle avoidance the basic design of collision avoidance includes the establishment of multiple usvs models and sensor models division of encounter scenarios design of corresponding measures and calculation of motion parameters and the risk of collision 2 1 multiple usvs system modeling when studying multiple usvs cooperative collision avoidance planning we consider motion only in the horizontal plane in general the usv can be assumed to be a rigid body we simplify it into three degrees of freedom surge sway and yaw to describe the movement of multiple usvs as shown in fig 1 and table 1 we establish the northeast frame the body fixed frame the sensor fixed frame and use symbols and criteria defined by the society of naval architects and marine engineers to describe the three degrees of freedom movement of multiple usvs in the ocean www liveyachting com the the northeast frame uses the initial center of gravity of the usv as origin the north direction is the positive direction of the e 0 n axis and the east direction is the positive direction of the e 0 e axis the body fixed frame uses the center of gravity as origin the direction to the bow is the o m b x m b axis and the direction to the starboard is the o m b y m b axis the establishment of the sensor fixed frame is similar to that of the body fixed frame except that the origin changes in addition we assume that n m e m x m b y m b x m s y m s are frames d m x d m y is the installation deviation between the center of the rotation of the sensor and that of the usv and ψ is the heading then the usv kinematic model can be derived fu 2017 fu 2017 1 n m e m a x m b y m b 2 x m s y m s b x m b y m b d m x d m y in the middle a cos θ sin θ sin θ cos θ b 1 0 0 1 in addition the usv motion model can be derived fu 2017 3 n m e m ψ m cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 u m v m r m 4 m m v m c m ν m ν m d m ν m ν m g m 0 τ m c ω m in the formula ν m u m v m r m t m m is the system inertia matrix m m m m r b m m a m m r b is the rigid body system inertia matrix m m a is hydrodynamic system inertia matrix c m ν m is the coriolis centripetal force matrix c m ν m c m r b ν m c m a ν m c m r b ν m is the rigid body coriolis centripetal force matrix c m a ν m is the hydrodynamic coriolis centripetal force matrix d m ν m is the damping coefficient matrix if m m is the quality of usv x m g y m g is the center of gravity of the usv j m z i m m i x m i 2 y m i 2 is the moment of inertia of the usv on the z axis x m u x m u y m v y m r y m v y m r n m v n m r n m r is the hydrodynamic coefficient then the system s several parameter matrices are as follows fu 2017 m m r b m m 0 0 0 m m m m x m g 0 m m x m g j m z m m a x m u 0 0 0 y m v y m r 0 y m r n m r d m ν m x m u 0 0 0 y m v y m r 0 n m v n m r c m r b ν m 0 0 m m x m g r m v m 0 0 m m u m m m x m g r m v m m m u m 0 c m a ν m 0 0 y m v v m y m r r m 0 0 x m u u m y m v v m y m r r m x m u u m 0 in addition g m 0 τ m 0 x m 0 y m 0 n m 0 g m 0 is the hydrodynamic operating point expansion item τ m c is the control force thrust force rudder force ω m ω m w i n d ω m w a v e s ω m c u r r e n t is the marine environmental power in this article we assume that c m x c m y is the coefficient of wind c m n is the moment coefficient of wind ρ m α is density of air v m ω r is relative speed of wind α m ω is the angle of wind l m is the total length of usv h m t is the height of the usv water area orthographic projection b m is the width of the usv a m l is the area projected from the side above the waterline a m t is the area of the orthographic projection above the waterline a m s s is the area projected from the side of the superstructure s m is the perimeter of the area projected from the side above the waterline c m is the distance between the centroid of the area of the side projection above the waterline and the bow m m is the number of masts or pillars in the side projection area the calculation formula of wind is a m i b m i c m i in the wind direction table fu 2017 x m 0 x m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 y m 0 y m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 n m 0 n m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 5 ω m w i n d x m w i n d y m w i n d n m w i n d 1 2 c m x α m ω ρ m α v m ω r 2 a m t 1 2 c m y α m ω ρ m α v m ω r 2 a m t 1 2 c m n α m ω ρ m α v m ω r 2 a m t l m c m x a m 0 a m 1 2 a m l l m 2 a m 2 2 a m t b m 2 a m 3 l m b m a m 4 s m l m a m 5 c m l m a m 6 m m c m y b m 0 b m 1 2 a m l l m 2 b m 2 2 a m t b m 2 b m 3 l m b m b m 4 s m l m b m 5 c m l m b m 6 a m s s a m l c m n c m 0 c m 1 2 a m l l m 2 c m 2 2 a m t b m 2 c m 3 l m b m c m 4 s m l m c m 5 c m l m then we assume that ω m i is the frequency of wave g m is the acceleration of gravity ρ m is density of seawater v m is the combined speed of usv β m is encounter angle of wave z m b is the vertical distance from the waterline to the center of gravity h m i 2 δ ω m i s m ω m i is the amplitude of each discrete regular wave λ m i 2 π ω m i 2 g m is the component wavelength c m x w d c m y w d c m n w d are dimensionless coefficients of wave the calculation formula of waves is a m b m t m 1 s m h m s significant boga in the table of waves fu 2017 6 ω m w a v e s x m w a v e s y m w a v e s n m w a v e s x m w d y m w d n m w d x m w a v e s i 1 n 4 ρ m g m 3 ω m i 4 sin β m h m i 1 e ω m i 2 d m g m sin ω m i 2 l m cos β m 2 g m sin ω m i 2 b m sin β m 2 g m sin ω m i ω m i 2 v m cos β m g m t ε m i y m w a v e s i 1 n 4 ρ m g m 3 ω m i 4 cos β m h m i 1 e ω m i 2 d m g m sin ω m i 2 l m cos β m 2 g m sin ω m i 2 b m sin β m 2 g m sin ω m i ω m i 2 v m cos β m g m t ε m i n m w a v e s i 1 n 2 ρ m g m 2 ω m i 2 h m i 1 e ω m i 2 d m g m sin ω m i 2 b m sin β m 2 g m cos ω m i ω m i 2 v m cos β m g m t ε m i 2 g m 2 sin ω m i 2 l m cos β m 2 g m ω m i 4 cos 2 β m l m g m cos ω m i 2 b m sin β m 2 g m ω m i 2 cos β m x m w d ρ m g m l m cos χ m i 1 n c m x w d λ m i s m ω m i δ ω m y m w d ρ m g m l m sin χ m i 1 n c m y w d λ m i s m ω m i δ ω m n m w d ρ m g m l m 2 cos χ m i 1 n c m n w d λ m i s m ω m i δ ω m c m x w d λ m 0 05 0 2 λ m l m 0 75 λ m l m 2 0 51 λ m l m 3 c m y w d λ m 0 46 6 83 λ m l m 15 65 λ m l m 2 8 44 λ m l m 3 c m n w d λ m 0 11 0 68 λ m l m 0 79 λ m l m 2 0 21 λ m l m 3 at last we assume that v m c r is the speed of the ocean current α m c is the corner of the ocean current a m t c is the cross sectional area below the waterline of usv a m l s is the longitudinal cross sectional area below the waterline of usv c m x c α m c c m y c α m c c m n c α m c are the force coefficient of the ocean current along the x m b y m b direction and the force moment coefficient around the z m b direction the calculation formula of current is fu 2017 7 ω m c u r r e n t x m c u r r e n t y m c u r r e n t n m c u r r e n t 1 2 ρ m v m c r 2 c m x c α m c a m t c 1 2 ρ m v m c r 2 c m y c α m c a m l c 1 2 ρ m v m c r 2 c m n c α m c a m l s l m in the multiple usvs system the body fixed frame and sensor fixed frame for every usv are similarly established the coordinate transformation and motion model of each usv are also similar and there is no coupling relationship 2 2 establishing sensor detection model usually the usvs perception system contains multiple instruments such as electronic charts radar sensors infrared sensors laser sensors ais communication modules etc when studying multiple usv collision avoidance planning this article mainly considers electronic charts radar sensors ais and communication modules in this paper the detection distance of the radar was 50 m m 10 km km and its range of detection was 0 360 the resolution of the bearing is 5 the resolution of the distance is 40 m the accuracy of distance measurement is 10 m the accuracy of the angle measurement is 1 and the refresh rate of radar is 22 revolutions per minute rpm as shown in fig 2 the model of the radar was established to measure the azimuth and distance to the target the origin of the sensor fixed frame was the yaw center of the radar stabilized platform the o m s x m s axis was parallel to the head to tail line of the stable platform and the bow pointed in the positive direction 2 3 encounter scenario and collision avoidance measures this paper used the 13th 17th rules of the colregs as reference and designed the corresponding collision avoidance measures based on the navigation conditions of multiple usvs according to the above rules when multiple usvs are navigating and headings are crossed the system determines whether there is a risk of collision based on the relative heading and relative distance between the usvs if there is a risk it is necessary to further determine the collision avoidance measures to be taken to eliminate it then it is necessary to accurately divide the encounter scenarios featuring multiple usvs to clarify obligations for collision avoidance among the usvs then the system decides the actions and actions of each usv in the collision avoidance process turn left turn right hold finally the genetic algorithm encodes and initializes the control variables according to the determined actions and behaviors different actions and behaviors correspond to different variable coding ranges this method can ensure the accuracy of each usv action and behavior and can further reduce the optimization time of the genetic algorithm as shown in fig 3 according to the navigation of the usv and the heading of other usvs we divide encounter scenarios into seven types and design the corresponding collision avoidance measures a starboard of ship crossing at a small angle in area a in fig 3 when other usvs come from the fan shaped direction of the right side of the usv the encounter scenario is one where the starboard of the ship crosses at a small angle this usv turns right to avoid the coming usv will slow down b starboard of ship crossing at a large angle in area b in fig 3 when other usvs come from the fan shaped direction of the right side of the usv the encounter scenario is one where the starboard of the ship crosses at a large angle this usv accelerates to leave the coming usv decelerates c d other ship starboard chasing or other ship port chasing in areas c and d in fig 3 when other usvs come from the fan shaped direction from the right or left side of an usv and catch up to it if the oncoming usv can see only the tail of this usv the encounter scenario is one where other ship starboard chasing or other ship port chasing this usv accelerates to leave and the coming usv turns left and passes to the left of this usv e f port of ship crossing at a small or large angle in areas e or f in fig 3 when usvs come from the fan shaped direction on the right side of a given usv the encounter scenario is one where the port of the ship crosses at a small or large angle the usv decelerates or accelerates to left and the coming usv turned left and passed the tail of the usv g encounter in area g in fig 3 when usvs come from the fan shaped direction of the port and starboard of a given usv both sets of usvs turn right and pass each other on the left side the above description is for the case where two usvs meet then when more than two usvs meet the situation can be broken down into groups of two usvs that meet for each usv if it can be fully implemented according to the formulated strategy then no collision will occur when more than two usvs meet 2 4 calculating motion parameters and collision risk when there is no communication the usv can obtain only the position speed and heading of other usvs through radar when there is communication information on other usvs can be obtained through the communication module in a multiple usvs system the motion parameters of each usv and the method to calculate the risk of collision are similar below we take one of the usvs as research object and discuss the calculation of its motion parameters and risk of collision with without communication as shown in fig 4 and table 3 when usv m encounters other usvs or obstacles we calculate the motion parameters and risk of collision to determine whether to take collision avoidance measures and the time need for them we assume that x i 1 m y i 1 m x i k m y i k m are coordinates of the scanning point of an obstacle from radar detection of usv m at moment i and is described in the northeast frame then when there is no noise we can estimate the coordinates of the center of the obstacle calculate the averaged position based on a set of measurements 8 x n x i m 1 k j 1 k x i j m y n y i m 1 k j 1 k y i j m however in fact the radar measurement data will inevitably include clutter white noise and colored noise when we use formula 8 to estimate the center position of the obstacle based on the radar data the spike data in the radar data has the greatest impact on the results which would lead to horrendous speed and course estimates while other noise effects are slightly weaker first we need to determine if there are spikes in the data that have a large impact we calculate the standard deviation of the data set when the standard deviation is less than a certain range it is considered non existent otherwise it is considered to exist at this time in order to eliminate such spike data we need to process the radar measurement data when one value of a set of data exceeds the others too much it is deleted then we need to adopt a denoising algorithm to remove the noise to obtain the coordinates of the center of the obstacle the relative distance between usv m and the target n is 9 r m x m x n 2 y m y n 2 the orientation of dynamic targets n other usvs relative to the heading of usv m is 10 α m 90 arctan x n x m y n y m i f y n y m 0 270 arctan x n x m y n y m i f y n y m 0 the distance between the estimated centers of obstacles at adjacent moments is 11 d m x i 1 m x i m 2 y i 1 m y i m 2 in the above formula x i 1 m y i 1 m is the center of the obstacle time i 1 we assume the time interval is t and threshold is d 0 if d m d 0 the obstacle is static relative to this usv and if d m d 0 the obstacle is dynamic relative to this usv in turn we can estimate the velocity v n and heading β n of the dynamic target other usvs 12 v n d m t 13 β n 90 arctan x i 1 m x i m y i 1 m y i m i f y i 1 m y i m 0 270 arctan x i 1 m x i m y i 1 m y i m i f y i 1 m y i m 0 the component of the velocity of the dynamic target n other usvs in the x m y m axis is 14 v n x v n cos β n v n y v n sin β n in this way if v m is the velocity of the usv and β m its heading we can calculate the component of the moving velocity in x m y m axis v m x v m y then the component of the velocity of the usv relative to that of the dynamic target n is 15 v r x v m x v n x v r y v m y v n y the velocity of the usv relative to the dynamic target n other usvs is 16 v r v r x 2 v r y 2 when there is communication the usv can obtain the motion parameters of other usvs through the communication module where the range of acquisition is greater than that detected by radar in addition we establish a public barrier database with a blackboard structure which means that each usv stores and shares parameters of the static and dynamic obstacles it detects and other usvs can refer this information for collision avoidance planning the formulae for the motion parameters of the usv m and target n r m α m v r x v r y v r are same as in 8 9 14 and 15 distance at closest point of approach d c p a m fu 2017 17 d c p a m r m sin 90 arctan v r x v r y α m when the dynamic target other usvs is in the direction of the usv s bow d c p a m is positive when it is in the direction of the usv s stern d c p a m is negative time at closest point of approach t c p a m fu 2017 18 t c p a m r m v r cos 90 arctan v r x v r y α m when the usv does not reach the nearest place of encountering other usvs t c p a m is positive when the usv exceeds the nearest place of encounter t c p a m is negative the usv s risk of collision is an important criterion for measuring whether a collision hazard occurs in a collision system it is also an important measure of whether to start collision avoidance and it is necessary to calculate it accurately however the calculation of the collision risk is currently applied to the ship s collision avoidance system and the influence caused by human operation is considered in the calculation process in the collision avoidance system there are no human factors so the method is only used as a reference in addition there is some ambiguity and uncertainty in the parameter of collision risk at present there is no clear explanation of the calculation method in the literature at home and abroad rule 7 of the colregs states that when determining whether there is a danger of collision the factors to be considered should include there is no significant change in the compass position of the coming ship even if there is a significant change in the position this danger may sometimes exist especially when approaching a very large vessel or tugboat or when approaching another vessel at close range in recent years methods that can determine the calculation of collision risk can be roughly divided into the following dcpa and tcpa weighted determination methods artificial neural network methods fuzzy set methods and extension set methods there are many factors that affect the risk of collision including dcpa and tcpa and their errors target azimuth sailing speed and the speed ratio between two ships but most scholars believe that dcpa and tcpa are the two main factors that affect the collision risk kearon first proposed the method if a and b are weighted values u a d c p a 2 b t c p a 2 imazu and makoyama think the smaller the margin between the own ship and other ships and the shorter the margin of time the higher the danger of collision u a d c p a b t c p a r a and b are weighted values the problem with both calculation methods is that dcpa and tcpa have different dimensions so the calculated collision risk is not accurate enough some scholars have divided it into two parts namely the space collision risk and time collision danger which is more conducive to a deeper understanding of the formation of collision danger this paper uses the calculation of this risk as reference for the ship s collision avoidance planning draws on the dcpa and tcpa weighting methods and considers the navigation of the usv to design the risk of collision the risk is divided into two aspects space and time the risk of spatial collision of usv m is fu 2017 19 u d m 1 d c p a m l 1 1 2 1 2 sin π l 2 l 1 d c p a m l 1 l 2 2 l 1 d c p a m l 2 0 l 2 d c p a m where l 1 is the safe distance l 2 is the distance of starting collision avoidance if l 2 d c p a m the usv is safe if d c p a m l 1 there is a risk of collision if l 1 d c p a m l 2 the system needs to calculate the risk of collision of the usv the temporal risk of collision of usv m is fu 2017 20 t c p a m 0 u t m 1 t c p a m t 1 t 2 t c p a m t 2 t 1 2 t 1 t c p a m t 2 0 t c p a m t 2 t c p a m 0 u t m 1 t c p a m t 1 t 2 t c p a m t 2 t 1 2 t 1 t c p a m t 2 0 t c p a m t 2 where t 1 d 1 2 d c p a m 2 v r and t 2 d 2 2 d c p a m 2 v r combining the spatial and temporal risks of collision we derive the risk to usv m 21 u m u d m u t m where means the following if u d m 0 or u t m 0 u m 0 if u d m 0 and u t m 0 u m max u d m u t m in the multiple usvs system the calculation of the risk of collision of the other usvs is similar to that of usv m and we will not repeat this here 3 design of multiple usvs collision avoidance planning algorithm as shown in fig 5 the improved genetic algorithm is the core module in the proposed multiple usvs collision avoidance planning system after the usvs start to sail the system calculates the heading and speed in real time and navigates according to them during the navigation the radar detects the signals of surrounding environment in real time and the communication module receives information in real time when the usvs reach the destination they stop sailing when the radar and communication module of usvs perceive obstacles and the distance to the obstacles are less than the starting collision avoidance distance the motion parameters and collision risk of the usvs are calculated if the collision risk is less than a certain threshold divide the encounter situation between usvs and obstacles and select the corresponding collision avoidance strategy after that the improved genetic algorithm is started to plan the optimal control instructions of acceleration and yaw rate for usv as shown in fig 6 we use retention deletion and replacement to improve the genetic algorithm and the analytic hierarchy process to build fitness following the population initialization of the genetic algorithm establishment of fitness and selection crossover and mutation the system iterates real time optimization acceleration and optimizes the yaw rate of every usv to calculate the current best path of each 3 1 individual coding and population initialization design the motion control of the usv usually functions according to the strategy of heading control and velocity control we thus used acceleration and yaw rate as control variables in this paper the population initialization of the improved genetic algorithm used float coding and we employed a certain range of float to code and express the acceleration and yaw rate we set the initial population of usv m to 50 individuals chromosomes with a coding length of two each m i a r included acceleration a and yaw rate r and each usv population was independent we assume that x m i y m i is the position of usv m at the given time v m i ψ m i are its velocity and heading and a m i r m i is the current best solution of the genetic algorithm at time i when the interval is t the velocity and heading of the next moment v m i 1 ψ m i 1 are given by 22 v m i 1 v m i a m i t ψ m i 1 ψ m i r m i t the position at the next moment x m i 1 y m i 1 is 23 x m i 1 x m i v m i 1 δ t cos ψ m i 1 0 5 a m i δ t 2 cos ψ m i 1 y m i 1 y m i v m i 1 δ t sin ψ m i 1 0 5 a m i δ t 2 sin ψ m i 1 we arbitrarily set the initial position of each usv and set the initial speed of each to zero and its initial direction to the end point in addition to ensure the stability of the usv and avoid large angle steering we set the range of acceleration for each usv to 2 2 k n s 0 514 m s 2 and the range of yaw rate for each to 5 5 s according to the above rules when multiple usvs are navigating and headings are crossed the system determines whether there is a risk of collision based on the relative heading and relative distance between the usvs if there is a risk it is necessary to further determine the collision avoidance measures to be taken to eliminate it then it is necessary to accurately divide the encounter scenarios featuring multiple usvs to clarify obligations for collision avoidance among the usvs then the system decides the actions and actions of each usv in the collision avoidance process turn left turn right hold finally the genetic algorithm encodes and initializes the control variables according to the determined actions and behaviors different actions and behaviors correspond to different variable coding ranges for example the decision to turn right and accelerate we set the range of acceleration for each usv to 0 2 k n s and the range of yaw rate for each to 5 5 s this method can ensure the accuracy of each usv action and behavior and can further reduce the optimization time of the genetic algorithm once each usv had completed the optimization at the given time its motion parameters and obstacle in its path changed and it was necessary to re initialize the population and iterate to the current best solution in the next moment in these iterations the optimized acceleration and yaw rate at each moment constituted the current best path of usv m its structure is x m 0 y m 0 x m i y m i x m k y m k where x m 0 y m 0 and x m k y m k are the starting and ending points of the usv and x m i y m i is the path point obtained by the current best solution of the optimization the structure of the current best solution is a m 0 r m 0 a m i r m i a m k r m k where a m i r m i is the current best solution of the optimization 3 2 fitness model the value of fitness is the criterion for evaluating individuals of a population this paper set the maximum value convergence that is to say the selection screened individuals with higher fitness to form the next population in multiple usvs collaborative collision avoidance planning the purpose is to plan the path with the shortest length and lowest sailing time while avoiding all obstacles and collisions between usvs according to the colregs therefore when constructing fitness in this paper we considered such factors as the distance between the given position of the usv and the end point the distance between the given position of the usv and obstacles the distance between the given position of the usv and other usvs the given velocity and heading and the positions of obstacles and other usvs as shown in fig 7 an usv simultaneously detects the positions of the obstacle and another usv x 0 o 0 y 0 is the sensor fixed frame of the usv and o 1 is the origin in the sensor fixed frame of another usv the circle represents the range of the radar s detection d 0 is the current shortest distance between the origin in the sensor fixed frame of the usv and obstacle a d 1 is the current shortest distance between the origin in the sensor fixed frame of the usv and current position of another usv d is the current distance between the given positions of the usv and the end point μ is the start angle of the obstacle the angle of the lower boundary of the obstacle detected by radar ν is the end angle of the obstacle the angle of the upper boundary of the obstacle detected by radar δ is the start angle of another usv the angle of the lower boundary of another usv detected by radar and γ is the end angle of another usv the angle of the upper boundary of another usv detected by radar different yaw rate and acceleration will make the position of the usv different which affects d 0 d 1 d then the fitness of the improved genetic algorithm in this paper is 24 f 1 λ k 1 c k 2 d 0 k 3 d 1 μ ψ i 1 ν o r δ ψ i 1 γ λ k 1 c k 2 d 0 k 3 d 1 e l s e in the above c d o r i d d o r i is the distance from the initial moment of usv to the end point k 1 k 2 k 3 are constants ψ i 1 is the heading if the usv selects an individual at the next moment and f is the value of fitness that is always positive the greater the value of f is the more likely is the relevant individual to be selected as a child we introduce the reward and punishment factors in fitness and adopts a reward and punishment mechanism to increase the degree of discrimination if the angle of the next moment is within the range of angles of the obstacles or other usvs and the given usv continues to sail close to obstacles or other usvs the value of fitness is reduced λ times to reduce the probability of being selected if the angle of the next moment is not within the range of angles of obstacles or other usvs and the given usv continues to sail to avoid obstacles or other usvs the value of fitness is expanded by a factor of λ to increase the probability of being selected in addition we apply the analytic hierarchy process to calculate the coefficients of each factor according to the influence of various factors on fitness as shown in table 4 the left half is the designation standard level matrix and the right half is the results of operation that pass the consistency test the consistency test is to determine whether there is a significant difference between the averages or variances at a certain level of significance if there is no significant difference the mean or variances are consistent when there is no risk of collision between the usv and the target or if the distance to begin collision avoidance is not reached under this fitness the optimized acceleration and optimized yaw rate of the algorithm are mainly constrained by the distance d between the usv and the end point the system selects individuals arriving at the end point more quickly with optimized acceleration and turn rate when there is a risk of collision between the usv and the target and the distance to start collision avoidance is reached under this fitness the optimized acceleration and yaw rate of the algorithm are mainly constrained by distance d 0 d 1 between the usv and the static and dynamic target while the effect of d between the usv and the end point is small the system selects individuals who are more stable in avoiding static and dynamic targets with an optimized acceleration and turn rate after each usv moves corresponding to optimized acceleration and yaw rate the heading of the usv moves gradually away from the range of angles of the static and dynamic targets after a certain period the heading of the usv is no longer within the range of angles of the targets this leads to a large change in the relative speed and the component of relative speed between the usv and the static and dynamic targets according to the calculation of d c p a m t c p a m and the risk of collision in the previous section when the relative speed and component of relative speed between the usv and static and dynamic targets are significantly increased the values of d c p a m and t c p a m are reduced accordingly thus reducing the risk of collision in addition when the heading of the usv is not within the range of angles of the static and dynamic targets this increases d 0 d 1 to the targets and reduces the risk of collision to some extent 3 3 design of evolutionary operations evolutionary operations are the core of improved genetic algorithms including selection crossover and mutation according to fitness the system selects a certain number of individuals to cross and mutate to generate offspring and form the progeny populations the current best individuals are obtained after a certain number of iterations 3 3 1 selection in this paper we adopt roulette selection the system calculates the probability that each individual is selected according to fitness and randomly select individuals to form progeny populations according to the probability the larger the value of fitness is the greater is the probability of being selected 3 3 2 crossover crossover is the primary way to generate new individuals by pairing individuals and exchanging genes in some way as shown in fig 8 in this paper we use discrete cross individuals exchange variable values and sub individuals randomly select the parent individual with a certain probability before the crossover individuals of the population were randomly paired and the crossover probability was set to 0 8 when crossing the acceleration and yaw rate were separated 3 3 3 mutation mutation is a means of generate new individuals while fully maintaining the diversity of the population s genes as shown in fig 9 in this paper we adopt gaussian mutation the system generates a random number obeying the gaussian probability distribution instead of a gene part of the individual selected with a certain probability if the initialization sets the population capacity to 50 the reciprocal 0 02 of the population capacity is set as the mutation probability 3 3 4 retention deletion and replacement to effectively improve the speed of optimization and solve the problems of the local optimum premature convergence and sub optimal superiority to the parent this paper adds retention deletion and replacement as shown in fig 10 the retention operation refers to preserving the current best individual of each generation in the next generation which ensures that good genes are inherited by the offspring population and prevents sub optimal solutions the deletion and replacement operations refer to determining whether the heading is within the range of the start and end angles of the target when considering the yaw rate of the individual if it is within the range the usv approaches the obstacle while continuing to sail at this point we replace the yaw rate of the individual with that of the best individual in this generation this is equivalent to adding a way to generate new individuals complementing the reward and punishment mechanism to enhance protection for good genes and avoid local optima to some extent finally after several generations of populations have been iterated the system determines whether the end condition is satisfied if it is the optimized acceleration and yaw rate of the current best individual are output if not fitness is reconstructed and iterated in multiple usvs systems the methods of individual coding and population initialization establishment of fitness selections crossover mutation and the additional retention deletion and replacement of other usvs are similar to those of usv m and thus we will not repeat them here 4 experimental analyses to verify the effectiveness of multiple usvs collaborative collision avoidance planning based on the improved genetic algorithm this paper selected the qt software to establish the simulation platform designed typical simulation cases for experiment and analyzed the experimental results and data 4 1 collision avoidance simulation system as shown in fig 11 to visually reflect the effect of multiple usvs collision avoidance planning the software s initial window of the multiple usvs navigation simulation environment constructed in this paper was maximized by default the lower left corner of the screen was the origin of the north east coordinate system the right direction was the positive direction of the x axis and the upward direction was the positive direction of the y axis the experimental area was 100 km long and 150 km wide the software could arbitrarily set the starting and end points of multiple usvs the shape size position of the obstacle and the control mode with without communication in addition the simulation experiment could display the navigation parameters of each usv in real time and draw the trajectories of usvs 1 3 with smooth curves of red yellow and green respectively as shown in table 5 considering the navigation of high speed usvs and retaining a sufficient margin and through a comparative analysis of multiple simulations we set the initial parameters of each usv as given in the table below to complete the simulation quickly factors for accelerating it were set here 4 2 cooperative collision avoidance for usvs without communication collision avoidance planning for multiple usvs missions without communication means that the usvs avoid all obstacles or other usvs encountered from their respective starting points to their respective mission locations and can detect only the position speed and heading of the obstacles and other usvs through radar as shown in fig 11 in the experiment each usv traveled from the starting point to the end point straight along the obstacle from other usvs when sailing to obstacles or other usvs the target information was detected by radar when the distance to the target was less than 2 km which and the risk of collision are used as a condition to initiate collision avoidance the system started collision avoidance and circumvented both sides of the target and continued to sail toward the end during the voyage the distance between multiple usvs and obstacles was always kept greater than the minimum safe distance and there was no collision between usvs this meant that collision avoidance was effective as shown in figs 12 and 13 the trend of acceleration and the yaw rate changed with the experimental effect in the experiment the navigation trajectory of the usv and the trend of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or large angle turns however according to rule 8 b of colregs any alteration of course and or speed to avoid collision shall if the circumstances of the case admit be large enough to be readily apparent to another vessel observing visually or by radar a succession of small alterations of course and or speed should be avoided smooth curves is probably against colreg regulations however considering the effects of motion control we will still control the upper limit of speed and heading as shown in fig 14 because there was no communication when the distance between usvs exceeds the range of detection of the radar it was assumed that the relative distance between usvs was used as the radar s detection distance of 10 km the trend of relative distance changed with the experimental effect the relative distance between usvs was always greater than the minimum safe distance and no collision occurred as shown in figs 15 and 16 the trend of tcpa and dcpa corresponded to the experimental effect and the trend of relative distance when dcpa and tcpa were small the distance between a usv and another was relatively small and collision might have occurred if the usvs had continued to sail along their course at this time each usv took appropriate measures to avoid collision thereby increasing dcpa and tcpa as shown in fig 17 the trend of risk of collision corresponded to the experimental effect dcpa tcpa and relative distance when the risk of collision was high this indicated a greater possibility of collision if the usvs had continued along their course at this time each usv took appropriate measures to avoid collision and thus reduced its risk as shown in fig 18 during the simulation experiment we intercepted the encounter between usvs judged the encounter situation adopted the corresponding collision avoidance strategy and successfully avoided the moment corresponding to fig 3 in the previous article the situation is divided into 7 types and the corresponding collision avoidance strategies are designed here the effectiveness of the 7 collision avoidance strategies is also verified for example in g of the figure the position and heading of the two usvs at this time constitute a confrontation situation at this time the two usvs simultaneously adopt the strategy of turning right to avoid as shown in figs 19 and 20 the trends of multiple usvs fitness were roughly similar and were optimized for the maximum value the more the number of iterations of the algorithm were the higher was the fitness of the individual population multiple optimizations were performed in the same state the fitness of optimization for each usv was not changed by much and the algorithm had a certain stability when keeping the other parameters constant we changed the number of iterations and performed multiple experiments as shown in table 6 compared with the iterative process of the conventional genetic algorithm the number of iterations were reduced the speed of convergence clearly improved premature convergence was slightly improved and there was no mutation in the late convergence of the curve which means that there was no local optimization we performed multiple optimization experiments in the same state compared the optimization results of the improved genetic algorithm with those of the conventional genetic algorithm and use 25 to calculate the standard deviation of multiple experimental results we improved the genetic algorithm with a low standard deviation high success rate and strong stability following the program test it took 90 ms to complete an optimization the efficiency of the algorithm was thus high and its optimization time was adequate for system response compared with the 160 ms of the conventional genetic algorithm the speed of optimization also significantly improved for the collision avoidance system in this paper the range of yaw rate was 5 5 s when encountering obstacles if deceleration was not considered the 18s turning motion could cause the usv to turn 90 at this time the usv traveled at its full speed of 50 knots over 500 m therefore the running time of the genetic algorithm distance at which collision avoidance begins and the minimum safe distance were all adequate for the usv to avoid collision 25 s 1 n 1 i 1 n x i x in our experiments the improved genetic algorithm reduced the optimization time by 70 s compared with the traditional genetic algorithm to prove the superiority of improved genetic algorithms we have added several sets of experiments to quantitatively analyze the impact of the reduction in optimization time on the collision avoidance ability in the experiment we set the initial speed of each usv to 20 30 40 50 knots and other experimental conditions are shown in table 5 we use traditional genetic algorithm and improved genetic algorithm to conduct experiments to compare the indicators of the collision avoidance under different initial speed conditions as shown in table 7 at different speeds the time taken by the improved genetic algorithm to avoid obstacles is shorter than that of the traditional genetic algorithm the minimum distance to obstacles and success rate of the improved genetic algorithm is greater than that of the traditional genetic algorithm and with the increase of sailing speed the gap of time to avoid obstacles minimum distance to obstacles and success rate between the improved genetic algorithm and the traditional genetic algorithm to avoid obstacles is larger that is to say the greater the sailing speed the more obvious the performance advantages of the improved genetic algorithm in these aspects the shorter the collision avoidance calculation time is the better it is to ensure the safety of collision avoidance under high speed conditions 4 3 cooperative collision avoidance for usvs with communication when there is no communication the usv can obtain only the position velocity heading and some other information of the target through radar it is not possible to pre plan the path to avoid the target in advance when multiple usvs arrive at a cross section it is necessary to formulate traffic rules and pauses or shifts to avoid cross sectional collisions when there is communication as a tool for sensing environmental information the communication module senses dynamic usvs and static obstacles in advance the usv can obtain the position velocity heading and some other information of the target through the communication module in advance and can plan its path in advance to avoid dire situations or encounters according to such parameters as distance velocity and heading the usv plans the path in real time where there is no cross section to improve the reliability of collision avoidance and safety of navigation as shown in fig 21 in the experiment each usv sailed from the starting point to the end point when the usv was far from obstacles and other usvs it sailed in a straight line when the usv sailed to the vicinity of obstacles and other usvs the information of the target was detected by radar if the distance between the usv and the target was less than 2 km the usv started collision avoidance to pass on either side of the target and continue to sail toward the end during the voyage the distance between each usv and the obstacle was always greater than the minimum safe distance and there was no collision between usvs as shown in figs 22 and 23 the trends of acceleration and the yaw rate changed with the experimental effect in the experiment the trajectory of the usv and the trends of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or a large angle turn as shown in fig 24 the trend of relative distance changed with the experimental effect compared with the case of no communication the distance between the usvs was larger as shown in figs 25 and 26 the trend of tcpa and dcpa corresponded to the experimental effect and trend of relative distance when dcpa and tcpa were small the distance between usvs was small and collision might have occurred if they had continued on course each usv took appropriate measures to avoid collision thereby increasing dcpa and tcpa compared with the case of no communication the dcpa and tcpa of each usv were always big enough it shows the role of the communication module in improving collision avoidance as shown in fig 27 the trend of risk of collision corresponded to the experimental effect dcpa tcpa and relative distance when the risk of collision was high this indicates a greater possibility of the collision if the usvs had continued on course each usv took appropriate measures to avoid collision and thus reduced its risk as shown in figs 28 and 29 the trends of multiple usvs fitness were roughly similar and optimized for the maximum value the greater the number of iterations of the algorithm were the higher was the fitness of the individual multiple optimizations were performed in the same state the fitness of optimization was not changed by much and the algorithm had a certain stability when keeping the other parameters constant we changed the number of iterations and performed multiple experiments to test that when the number of iterations was 250 and 100 as shown in table 8 and fig 30 usv no 3 was considered as an example compared with the case of collision avoidance with without communication the minimum relative distance between the usv and two other usvs was significantly greater this shows that the communication module had a significant effect on maintaining the relative distance among the three usvs in addition dcpa and tcpa also increased prominently which shows that the communication module can improve the space and time margins of collision avoidance to prevent emergency collision avoidance the communication module sensed dynamic usv and static obstacles in advance and obtained the information on the position velocity and heading of the target to plan its path in advance and avoid emergencies and even encounters when the other conditions were unchanged the frequency of communication changed the higher the communication frequency the better the effect of maintaining distance between usvs by referring to the communication frequency of a ship s ais this paper enabled the communication dynamic information at 0 5 hz and static information at 0 05 hz of course the communication module has information processing and transmission delays in practice compared with the running time of the algorithm 80 ms the time delay 0 62 ms of the communication of the blackboard mode established in this paper was small and can be ignored we performed multiple optimization experiments in the same state compared the optimization results of the improved genetic algorithm with without communication and use 25 to calculate the standard deviation of multiple experimental results compared with the iterative process of the improved genetic algorithm without communication the evaluation index of the algorithm has improved but the improvement is not obvious this means that the communication module has improved the running time and stability of the collision avoidance algorithm but the improvement is not large the minimum relative distance between usv no i and usv no j d min i j the minimum dcpa between usv no i and usv no j d c p a min i j the minimum tcpa between usv no 1 and usv no 2 t c p a min i j the maximum collision risk of usv no i r i s k max i as shown in table 9 compared with the iterative process of the improved genetic algorithm without communication the evaluation index of the algorithm has improved but the improvement is not obvious as shown in fig 31 in order to prove the performance of our method we conducted multiple statistical experiments in these simulations we changed the start and end points of each usv as well as the shape size and location of obstacles in this way the success of multiple scene simulation experiments is enough to prove the stability of our algorithm then we compared the parameters of the improved genetic algorithm with those of algorithms specifically designed for real time online collision avoidance planning as shown in table 10 the artificial potential field method has a higher optimization speed and good ability to avoid obstacles tsou and hsueh 2010 however it has a low success rate and stability similarly the ca algorithm has higher optimization speed tsou 2016 compared with the artificial potential field method the stability and success rate of the proposed algorithm are superior however control of the distance to the target is weakened when considering the steering strategy compared with the artificial potential field method and the ca algorithm the improved genetic algorithm is slower at optimization but its stability success rate and control of distance to the target are significant advantages the speed of the improved genetic algorithm and its parameters of collision avoidance can satisfy the demands of high speed usvs for collision avoidance therefore combining various indicators and improving genetic algorithms yields satisfactory performance finally to further verify the performance of the improved genetic algorithm we compare it with a novel algorithm deep learning when applying deep learning dl to usvs collision avoidance we choose the same system model as the genetic algorithm which includes the motion model of usvs the detection model of sensor the encounter situation division and collision avoidance measures the calculation of related motion parameters and collision avoidance risk the input to the obstacle avoidance planning network is an 91 dimensional vector consisting of the 90 dimensional input distance vector and an input direction vector obtained from the radar the two dimensional output vector from the obstacle avoidance planning network consists of the yaw rate and the acceleration of the usv the dataset used to test the proposed method consists of 112003 training samples and 783 test samples in the offline training process training the labels used for supervised learning are obtained by traditional obstacle avoidance planning methods the model was trained with input layer hidden layer middle layer and output layer the input layer consists of 91 neurons corresponding to the input vector the hidden layer consists of network structures the middle layer contains 36 neurons and the output layer has two neurons corresponding to the yaw rate and the acceleration of the usv lin et al 2019 in order to better verify the comparative effect of the two algorithms we run the two algorithms in the same environment to simulate collision avoidance as shown in fig 32 the red green and yellow curves are the trajectories of the three usvs when running the genetic algorithm to avoid collisions the blue black and white curves are the trajectories of the three usvs when running deep learning to avoid collisions in the simulation experiment of the two algorithms each usv sailed from the starting point to the end point when the usv was far from obstacles and other usvs it sailed in a straight line when the usv sailed to the vicinity of obstacles and other usvs the information of the target was detected by radar if the distance between the usv and the target was less than 2 km the usv started collision avoidance to pass on either side of the target and continue to sail toward the end during the voyage the distance between each usv and the obstacle was always greater than the minimum safe distance and there was no collision between usvs it can be seen that although the paths of the two algorithms have certain differences they both have good collision avoidance effects as shown in figs 33 38 in order to compare the characteristics of the output control parameters of the two algorithms we plot the yaw rate and acceleration of each usv output by the two algorithms on the same graph the trends of acceleration and the yaw rate changed with the experimental effect in the simulation experiment of the two algorithms although the acceleration and yaw rate output by the two algorithms are different the trajectory of the usv and the trends of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or a large angle turn further we quantitatively compare the collision avoidance performance parameters and algorithm operating characteristics of the two algorithms we performed multiple optimization experiments in the same state that is to say at a certain time run the two algorithms multiple times to plan a large number of feasible solutions for usvs in this way this article runs two algorithms to plan 1000 times for usvs from the total time of multiple optimizations the running time of each algorithm can be calculated the success rate of the algorithm can also be obtained from the results of multiple runs the standard deviation can also be obtained by formula 25 calculation results as shown in table 11 and fig 39 in terms of minimum relative distance minimum dcpa minimum tcpa maximum collision risk success rate standard deviation there is no obvious difference between the two algorithms both algorithms have a higher success rate and lower standard deviation indicating that both algorithms have strong stability in terms of operation time the deep learning takes very little time 9 8 ms to complete the planning compared with genetic algorithm it has obvious advantages however deep learning is not perfect for multiple usvs collision avoidance when the navigation environment the number of usvs and parameters of usv s motion model change the network needs to be retrained when deep learning collision avoidance it is difficult to suitable for full mission scenarios different motion models maneuver strategies any environmental models wind waves and currents and mission based collision avoidance rules in short the rise of new intelligent algorithms cannot conceal the vitality of traditional algorithms both genetic algorithms and deep learning have their own advantages and disadvantages and these disadvantages are still the direction of future research 5 conclusion the most significant contribution of this paper is solving the problem of multiple usvs collaborative collision avoidance planning by using the improved genetic algorithm in a certain degree in the multiple usvs collaborative task mode in a complex environment featuring obstacles the authors established a multiple usvs model of motion and sensors categorized encounter scenarios involving multiple usvs and formulated corresponding collision avoidance strategies and calculated the motion parameters and risk of collision of multiple usvs to determine whether to take collision avoidance measures we then chose the genetic algorithm as the core algorithm of collision avoidance planning improved it with retention deletion and replacement used the analytic hierarchy process to establish fitness based on the information of obstacles and other usvs and iteratively optimized the acceleration and yaw rate to calculate the current best path of collision avoidance for each usv finally we built a multiple usvs simulation platform of collision avoidance planning based on the qt software and designed some typical simulation cases to verify the effectiveness of the proposed collision avoidance planning with and without communication the results show that the proposed method can be used to plan the current best path of collision avoidance for multiple usvs in complex environment and has good stability and smooth trajectories compared with the conventional genetic algorithm the improved algorithm effectively reduces the number of iterations running time and standard deviation and improves the success rate the results show that the communication module transmits information to plan the path in advance and can thus avoid emergencies and even encounter scenarios credit authorship contribution statement hongjian wang conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing project administration funding acquisition zhongjian fu conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing jiajia zhou validation formal analysis investigation resources project administration funding acquisition mingyu fu validation formal analysis investigation resources project administration funding acquisition li ruan validation formal analysis investigation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the college of intelligent systems science and engineering of harbin engineering university for providing a laboratory learning environment and experimental equipment and colleagues and students in the laboratory for their assistance this work was supported in part by the national natural science foundation of china under grant 61633008 and grant 51609046 and in part by the natural science foundation of heilongjiang province under grant f2015035 
21075,this paper proposes a method based on the improved genetic algorithm for cooperative collision avoidance by multiple unmanned surface vehicles hereinafter referred to as multiple usvs in the multiple usvs collaborative task mode in a complex environment featuring obstacles we establish models of the multiple usvs system and sensor detection divide scenarios involving multiple usvs encounters and design corresponding collision avoidance strategies and calculate the motion parameters and risk of collision to determine whether to take measures to avoid collisions following this we choose the genetic algorithm ga as core algorithm to plan for collision avoidance improve it through retention deletion and replacement use the analytic hierarchy process to build a fitness iteratively optimize the adjustment of velocity and heading and calculate the current best path for collision avoidance for multiple usvs finally we built a simulation platform for multiple usvs collision avoidance planning based on the qt software and designed typical cases to verify the proposed method with and without communication conditions the results show that the proposed method can be used for the safe operation of multiple usvs index terms colregs genetic algorithm multiple unmanned surface vehicles collision avoidance 1 introduction the usv is an intelligent unmanned maritime platform that can usually be used to perform tasks during military and civil activities that are not suitable for manned vessels in complex marine environments wang et al 2009 multiple usvs are a cluster of two or more usvs that take advantage of group leadership through overall command and close collaboration and can quickly and efficiently complete complex tasks that are difficult or even impossible to accomplish with a single usv steimle and hall 2006 in the complex and ever changing marine environment it is important to enable multiple usvs to safely sail and successfully complete tasks by implementing a collision avoidance function liu et al 2016 collaborative collision avoidance planning for multiple usvs groups refers to multiple usvs avoiding static and dynamic obstacles and not colliding with each other during the execution of tasks larson et al 2007 tang et al 2015 local obstacle avoidance planning for usvs refers to the use of maneuvering behavior in real time to avoid collisions with static and dynamic obstacles casalino et al 2009 it consists of two strategies local path planning based on path search which can generate a series of reasonable track points and reactive collision avoidance planning based on real time behavior to control speed and direction richard bucknall applied cubic spline interpolation to improve the traditional a star a algorithm designed three path smoothers to reduce the number of turning points and the costs of turning and applied it to the springer usv to obtain a relatively smooth and non redundant path richard et al 2019 yogang singh proposed a constrained dijkstra algorithm to generate safe waypoints by maintaining a safe distance from obstacles however the problem of the heading constraint variable range of heading has never been considered in simulations yogang et al 2018 rui song improved the algorithm for path planning by using a two layer vector field and represented the dynamic environment as a base vector field and an environment vector field which solved the problem of the high risk of collision in the traditional method song et al 2017 tsou used the concept of e navigation as a framework positioning collision avoidance path planning as the main theme and applies an ant colony algorithm aca in the field of artificial intelligence to construct a collision avoidance model that imitates optimization behaviors in real life applications tsou and hsueh 2010 tsou 2016 wang dong designed an algorithm based on the steering strategy to obtain the steering rate using the smallest relative distance between the usv and obstacles in the feasible steering range but its speed was not optimized wang et al 2011 naeem developed a usv collision avoidance system that automatically generates an environmental map when the collision avoidance distance is reached the system generates a collision avoidance warning and maintains a sufficient safety distance from obstacles to realize autonomous collision avoidance in a highly dynamic and unpredictable environment naeem and irwin 2010 lifei song introduced the centrifugal field to improve the artificial potential field and used the velocity obstacle vo algorithm to solve the vector of velocity to avoid obstacles but this method is not suitable for complex environments featuring multiple dynamic obstacles song et al 2018 although many algorithms for real time obstacle avoidance have been proposed in dynamic environments in the last few years collision avoidance planning persists as a problem that limits the long term development of usvs for example in the context of the above two strategies some proposed methods based on path search do not consider the scenario where dynamic obstacles are encountered in close proximity bańka et al 2015 some reactive obstacle avoidance planning usually only plans the steering angle of the usv without considering the length of the path some consider velocity fukushima et al 2013 in addition only some studies have combined rules of collision avoidance campbell proposed a heuristic repair a algorithm based on the international maritime collision avoidance rule in a decision making framework that plans a safe and feasible path online and implements a quick search by retaining and reusing cost information campbell et al 2012 yanlong wang proposed the algorithm based on international regulations for preventing collisions at sea colregs and applied a re planning strategy to generate feasible trajectories according to the kinematics of usvs and discriminative locality alignment dlas however only the case where single obstacles were encountered was considered wang et al 2018 naeem et al proposed a usv path search planning algorithm based on colregs and proposed a re planning strategy for overtaking crossover and frontal naeem et al 2012 johansen et al use simulated predictions of the trajectories of the obstacles and ship compliance with the colregs and collision hazards associated with each of the alternative control behaviors are evaluated on a finite prediction horizon and the optimal control behavior is selected johansen et al 2016 chiang proposed colregs rapid exploration random tree rrt an rrt based planner capable of identifying long term colregs compliant trajectories with a high navigation success rate chiang and tapia 2018 tam described the development of a deterministic path planning algorithm that computes a practical and colregs compliant navigation path for vessels which are on a collision course the algorithm was evaluated with a set of test cases simulating various traffic scenarios tam and bucknall 2010 most current usv collision avoidance methods that consider criteria for collision avoidance divide encounter scenarios with a dynamic target into only three types encounter chase and cross the three encounters are shown in the picture in table 2 each scenario is too general to describe the various situations that can obtain therefore the collision avoidance strategy cannot guarantee that encounters at all angles within the given range of angles can achieve optimal collision avoidance campbell et al 2014 in addition most studies have not considered scenarios involving encounters with multiple obstacles compared with collision avoidance for a single usv that for multiple usvs is a combinatorial optimization problem with more constraints mu et al 2017 it is usually necessary to satisfy multiple objective requirements such as the heading angle of multiple usvs and speed constraints on them and path length and smoothness which are non deterministic polynomial np problems colito 2003 the systems of multiple usvs have more control objects where this increases the computational complexity of the algorithm and the coupling of variables zhuang et al 2016 in addition encounter scenarios involving multiple usvs are more complex and these include scenarios where multiple usvs encounter multiple obstacles at the same time kim et al 2014 few studies have considered the collision avoidance for a system of multiple usvs benjamin proposed the fast marching square algorithm based on colregs for obstacle avoidance and path planning for multiple usvs however this method is limited for use only when the sensor fails benjamin and curcio 2014 krishnamurthy used the method of the equivalent threat circle to construct a threat field to improve the spatial voronoi diagram the set of initial paths and the neighborhood in multiple usvs path planning are constructed according to the radius of threat the chaotic algorithm is used to initialize the honey source to improve the artificial bee colony algorithm and accelerate convergence however only static environments are considered krishnamurthy et al 2008 yuanchang liu used the distance at closest point of approach dcpa to evaluate the risk of collision and proposed the afms learning the weight of feature interactions via attention networks algorithm to carry out multiple usvs path re planning to achieve formation control without considering the criteria for collision avoidance liu and bucknall 2015 huang yamin proposed system visualizes the changes of one ship s course and speed resulting in collisions which can be used not only for supporting the officer on watch to prevent collisions but also for collision prevention of autonomous surface vessels asvs and for human operators taking over the control of asvs huang et al 2019 zheng huarong li shijie proposes a distributed coordination strategy predictions of ship trajectories are made based on ship dynamics giving different candidate rudder angles and potential collision risks that may be caused by each rudder angle selection are evaluated based on calculations of collision risk parameters zheng and negenborn 2017 in systems of multiple usvs it is necessary to consider whether there is communication among the usvs most systems for usv collision avoidance planning do not consider communication or assume by default that there is no communication which is inconsistent with empirical situation and ignores the communication module as a perceptual tool li et al 2019 caccia used the communication module of the blackboard structure to write the position of the obstacle caccia et al 2007 and corfield et al proposed an information interactive explicit communication module based on the knowledge query and manipulation language kqml protocol corfield and young 2006 however it has a problem whereby the communication module and sensor module are confused in a certain range and the role of the former which is used to obtain information on position speed and heading is not fully utilized to assist in collision avoidance heidarsson and sukhatme 2011 current models of collision avoidance can be divided into traditional and intelligent methods traditional methods include the artificial potential field method and random sampling whereas intelligent methods include fuzzy logic and neural networks naeem et al 2008 sun et al 2018 kim et al 2012 larson et al 2006 various methods have been used to solve the problem of collision avoidance planning but are limited for example the artificial potential field method has advantages in terms of real time dynamic collision avoidance but suffers from the problem of overshoot and does not consider the next movement sutulo and guedes soares 2014 the forward maximum match fmm algorithm has better path smoothness and continuity but its ability to solve dynamic constraints in real time planning is poor wu et al 2017 random sampling planning can effectively overcome the problem of the local minimum but requirements for setting parameters of the algorithm are stringent zhao et al 2016 fuzzy logic comprehensively evaluates all directions and can effectively avoid collisions but the requisite calculation is complex when the number of obstacles increases cheng and zhang 2018 neural networks can maintain small path lengths as far away as possible from obstacles but appropriate network topologies and connection weights need to be used liu 2015 the genetic algorithm is an adaptive global probability search optimization algorithm that has been widely applied to research on collision avoidance planning for example y liu proposed an assistant decision making method based on genetic algorithm to give a better collision avoidance strategy liu and liu 2018 tsou mc adopted the genetic algorithm used in artificial intelligence to find a theoretically safety critical recommendation for the shortest route of collision avoidance from an economic viewpoint tsou et al 2010 ni shengke presented a novel optimal trajectory planning based on hybrid genetic algorithm ni et al 2018 zeng x used a path planning method to avoid navigation obstacles and other moving ships according on navigation traffic rule zeng et al 2000 it has the following characteristics 1 it is adaptive and can discover environmental characteristics and laws based on environmental changes 2 it has parallelism and can cover all information and avoid search for useless points 3 it uses probabilistic search and has a strong ability to update the solution set 4 it is robust and its object of operation is the chromosome without considering variable constraints 5 it is universal and is suitable for nonlinear multi model and multi objective optimization problems he et al 2012 based on the needs and a comparison of various algorithms the authors chose the genetic algorithm to study the multiple usvs collision avoidance in terms of single usv collision avoidance the uk s springer uses collision avoidance based on the genetic algorithm to predict and control movement in a nonlinear environment and implements real time local path planning huang et al 2020 north wind marine s sea fox uses a search algorithm based on collaboration to independently plan a secure path in an environmental model li et al 2016 bye robin t define the 1d tug fleet optimization problem and present a receding horizon genetic algorithm for solving it the algorithm can be configured with a set of cost functions such that each configuration effectively constitute a unique tug fleet optimization algorithm bye 2010 in terms of multiple usvs collision avoidance liu designed a decision making system based on the evolutionary genetic algorithm and adopted a heuristic method for population initialization economy of resources smoothness and safety were used as factors of fitness and deletion and repair operations were added to the traditional genetic operation to establish an optimized iterative process liu et al 2018 he et al combined the simulated annealing algorithm based on a time varying selection strategy when establishing the fitness of the genetic algorithm and used the simulated annealing algorithm to eliminate local optimal ability and prevent the genetic algorithm from falling into a local optimum he et al 2019 while the genetic algorithm has been used for multiple objects for collision avoidance planning it generally encounters such problems as falling into the local optimum slow convergence and the degradation of the solution bye et al 2015 the number of iterations and population determine the time taken for each optimization and most of them are ineffective the coding for the initialization of the heuristic binary adopted by liu is complicated and redundant the deletion and repair operations are ineffective and a simple simulation of the design cannot fully verify the algorithm he et al nested the simulated annealing algorithm into the fitness of the genetic algorithm but this algorithm is difficult to solve and increases the time needed for each iteration in summary the following difficulties mainly exist in the current multiple usv collision avoidance planning methods 1 design of collision avoidance methods when the navigation environment is complex and changeable full of multiple static and dynamic obstacles 2 the fusion of environmental information when there are multiple instruments in the system 3 the influence of communication information on collision avoidance when there is a communication module 4 the design of multiple usvs collaborative collision avoidance strategy makes it comply with norms and safety 5 multiple usvs collision avoidance is a multi objective multi constrained optimization problem and the algorithm is not easy to solve 6 for high speed usv collision avoidance it is necessary to ensure the timeliness and safety of the collision avoidance method but also to consider the platform motion characteristics to output parameters 7 in the optimization process of the intelligent algorithm based on random iteration there are problems such as falling into the local optimum and slow convergence speed in response to the above problems given that the literature does not provide an adequate solution to the problem of multiple usvs collision avoidance planning this paper designs a multiple usvs cooperative collision avoidance planning method based on the improved genetic algorithm with the aim of solving the problem of local obstacle avoidance by multiple usvs in a complex environment featuring obstacle the method is directed to the mode of multiple usvs group collaboration establishes the models of the multiple usvs system and the sensor divides encounter scenarios and designs corresponding strategies for collision avoidance and calculates motion parameters and the risk of collision in real time to determine whether to take collision avoidance measures aiming at the limitations of the genetic algorithm we design retention according to the strategy of elite retention to solve the problem of degradation and premature convergence and design deletion and replacement to improve the ability of local search and speed of convergence of the algorithm we then use the improved genetic algorithm to iteratively optimize the adjustment of velocity and heading and calculate the current best path for multiple usvs compared with the conventional genetic algorithm the improved algorithm designed in this paper has the advantages of fast convergence high stability fast optimization and low time complexity in addition the algorithm is versatile and can be used for collision avoidance planning on other intelligent platforms the remainder of this paper is organized as follows section 2 describes the basic design of collision avoidance systems and section 3 elaborates on the design of collision avoidance based on the improved genetic algorithm section 4 details the design of the simulation software and verifies the proposed algorithm finally section 5 discusses the conclusions of this study and direction for future work 2 basic design of obstacle avoidance the basic design of collision avoidance includes the establishment of multiple usvs models and sensor models division of encounter scenarios design of corresponding measures and calculation of motion parameters and the risk of collision 2 1 multiple usvs system modeling when studying multiple usvs cooperative collision avoidance planning we consider motion only in the horizontal plane in general the usv can be assumed to be a rigid body we simplify it into three degrees of freedom surge sway and yaw to describe the movement of multiple usvs as shown in fig 1 and table 1 we establish the northeast frame the body fixed frame the sensor fixed frame and use symbols and criteria defined by the society of naval architects and marine engineers to describe the three degrees of freedom movement of multiple usvs in the ocean www liveyachting com the the northeast frame uses the initial center of gravity of the usv as origin the north direction is the positive direction of the e 0 n axis and the east direction is the positive direction of the e 0 e axis the body fixed frame uses the center of gravity as origin the direction to the bow is the o m b x m b axis and the direction to the starboard is the o m b y m b axis the establishment of the sensor fixed frame is similar to that of the body fixed frame except that the origin changes in addition we assume that n m e m x m b y m b x m s y m s are frames d m x d m y is the installation deviation between the center of the rotation of the sensor and that of the usv and ψ is the heading then the usv kinematic model can be derived fu 2017 fu 2017 1 n m e m a x m b y m b 2 x m s y m s b x m b y m b d m x d m y in the middle a cos θ sin θ sin θ cos θ b 1 0 0 1 in addition the usv motion model can be derived fu 2017 3 n m e m ψ m cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 u m v m r m 4 m m v m c m ν m ν m d m ν m ν m g m 0 τ m c ω m in the formula ν m u m v m r m t m m is the system inertia matrix m m m m r b m m a m m r b is the rigid body system inertia matrix m m a is hydrodynamic system inertia matrix c m ν m is the coriolis centripetal force matrix c m ν m c m r b ν m c m a ν m c m r b ν m is the rigid body coriolis centripetal force matrix c m a ν m is the hydrodynamic coriolis centripetal force matrix d m ν m is the damping coefficient matrix if m m is the quality of usv x m g y m g is the center of gravity of the usv j m z i m m i x m i 2 y m i 2 is the moment of inertia of the usv on the z axis x m u x m u y m v y m r y m v y m r n m v n m r n m r is the hydrodynamic coefficient then the system s several parameter matrices are as follows fu 2017 m m r b m m 0 0 0 m m m m x m g 0 m m x m g j m z m m a x m u 0 0 0 y m v y m r 0 y m r n m r d m ν m x m u 0 0 0 y m v y m r 0 n m v n m r c m r b ν m 0 0 m m x m g r m v m 0 0 m m u m m m x m g r m v m m m u m 0 c m a ν m 0 0 y m v v m y m r r m 0 0 x m u u m y m v v m y m r r m x m u u m 0 in addition g m 0 τ m 0 x m 0 y m 0 n m 0 g m 0 is the hydrodynamic operating point expansion item τ m c is the control force thrust force rudder force ω m ω m w i n d ω m w a v e s ω m c u r r e n t is the marine environmental power in this article we assume that c m x c m y is the coefficient of wind c m n is the moment coefficient of wind ρ m α is density of air v m ω r is relative speed of wind α m ω is the angle of wind l m is the total length of usv h m t is the height of the usv water area orthographic projection b m is the width of the usv a m l is the area projected from the side above the waterline a m t is the area of the orthographic projection above the waterline a m s s is the area projected from the side of the superstructure s m is the perimeter of the area projected from the side above the waterline c m is the distance between the centroid of the area of the side projection above the waterline and the bow m m is the number of masts or pillars in the side projection area the calculation formula of wind is a m i b m i c m i in the wind direction table fu 2017 x m 0 x m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 y m 0 y m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 n m 0 n m u m 0 v m 0 r m 0 u m 0 v m 0 r m 0 5 ω m w i n d x m w i n d y m w i n d n m w i n d 1 2 c m x α m ω ρ m α v m ω r 2 a m t 1 2 c m y α m ω ρ m α v m ω r 2 a m t 1 2 c m n α m ω ρ m α v m ω r 2 a m t l m c m x a m 0 a m 1 2 a m l l m 2 a m 2 2 a m t b m 2 a m 3 l m b m a m 4 s m l m a m 5 c m l m a m 6 m m c m y b m 0 b m 1 2 a m l l m 2 b m 2 2 a m t b m 2 b m 3 l m b m b m 4 s m l m b m 5 c m l m b m 6 a m s s a m l c m n c m 0 c m 1 2 a m l l m 2 c m 2 2 a m t b m 2 c m 3 l m b m c m 4 s m l m c m 5 c m l m then we assume that ω m i is the frequency of wave g m is the acceleration of gravity ρ m is density of seawater v m is the combined speed of usv β m is encounter angle of wave z m b is the vertical distance from the waterline to the center of gravity h m i 2 δ ω m i s m ω m i is the amplitude of each discrete regular wave λ m i 2 π ω m i 2 g m is the component wavelength c m x w d c m y w d c m n w d are dimensionless coefficients of wave the calculation formula of waves is a m b m t m 1 s m h m s significant boga in the table of waves fu 2017 6 ω m w a v e s x m w a v e s y m w a v e s n m w a v e s x m w d y m w d n m w d x m w a v e s i 1 n 4 ρ m g m 3 ω m i 4 sin β m h m i 1 e ω m i 2 d m g m sin ω m i 2 l m cos β m 2 g m sin ω m i 2 b m sin β m 2 g m sin ω m i ω m i 2 v m cos β m g m t ε m i y m w a v e s i 1 n 4 ρ m g m 3 ω m i 4 cos β m h m i 1 e ω m i 2 d m g m sin ω m i 2 l m cos β m 2 g m sin ω m i 2 b m sin β m 2 g m sin ω m i ω m i 2 v m cos β m g m t ε m i n m w a v e s i 1 n 2 ρ m g m 2 ω m i 2 h m i 1 e ω m i 2 d m g m sin ω m i 2 b m sin β m 2 g m cos ω m i ω m i 2 v m cos β m g m t ε m i 2 g m 2 sin ω m i 2 l m cos β m 2 g m ω m i 4 cos 2 β m l m g m cos ω m i 2 b m sin β m 2 g m ω m i 2 cos β m x m w d ρ m g m l m cos χ m i 1 n c m x w d λ m i s m ω m i δ ω m y m w d ρ m g m l m sin χ m i 1 n c m y w d λ m i s m ω m i δ ω m n m w d ρ m g m l m 2 cos χ m i 1 n c m n w d λ m i s m ω m i δ ω m c m x w d λ m 0 05 0 2 λ m l m 0 75 λ m l m 2 0 51 λ m l m 3 c m y w d λ m 0 46 6 83 λ m l m 15 65 λ m l m 2 8 44 λ m l m 3 c m n w d λ m 0 11 0 68 λ m l m 0 79 λ m l m 2 0 21 λ m l m 3 at last we assume that v m c r is the speed of the ocean current α m c is the corner of the ocean current a m t c is the cross sectional area below the waterline of usv a m l s is the longitudinal cross sectional area below the waterline of usv c m x c α m c c m y c α m c c m n c α m c are the force coefficient of the ocean current along the x m b y m b direction and the force moment coefficient around the z m b direction the calculation formula of current is fu 2017 7 ω m c u r r e n t x m c u r r e n t y m c u r r e n t n m c u r r e n t 1 2 ρ m v m c r 2 c m x c α m c a m t c 1 2 ρ m v m c r 2 c m y c α m c a m l c 1 2 ρ m v m c r 2 c m n c α m c a m l s l m in the multiple usvs system the body fixed frame and sensor fixed frame for every usv are similarly established the coordinate transformation and motion model of each usv are also similar and there is no coupling relationship 2 2 establishing sensor detection model usually the usvs perception system contains multiple instruments such as electronic charts radar sensors infrared sensors laser sensors ais communication modules etc when studying multiple usv collision avoidance planning this article mainly considers electronic charts radar sensors ais and communication modules in this paper the detection distance of the radar was 50 m m 10 km km and its range of detection was 0 360 the resolution of the bearing is 5 the resolution of the distance is 40 m the accuracy of distance measurement is 10 m the accuracy of the angle measurement is 1 and the refresh rate of radar is 22 revolutions per minute rpm as shown in fig 2 the model of the radar was established to measure the azimuth and distance to the target the origin of the sensor fixed frame was the yaw center of the radar stabilized platform the o m s x m s axis was parallel to the head to tail line of the stable platform and the bow pointed in the positive direction 2 3 encounter scenario and collision avoidance measures this paper used the 13th 17th rules of the colregs as reference and designed the corresponding collision avoidance measures based on the navigation conditions of multiple usvs according to the above rules when multiple usvs are navigating and headings are crossed the system determines whether there is a risk of collision based on the relative heading and relative distance between the usvs if there is a risk it is necessary to further determine the collision avoidance measures to be taken to eliminate it then it is necessary to accurately divide the encounter scenarios featuring multiple usvs to clarify obligations for collision avoidance among the usvs then the system decides the actions and actions of each usv in the collision avoidance process turn left turn right hold finally the genetic algorithm encodes and initializes the control variables according to the determined actions and behaviors different actions and behaviors correspond to different variable coding ranges this method can ensure the accuracy of each usv action and behavior and can further reduce the optimization time of the genetic algorithm as shown in fig 3 according to the navigation of the usv and the heading of other usvs we divide encounter scenarios into seven types and design the corresponding collision avoidance measures a starboard of ship crossing at a small angle in area a in fig 3 when other usvs come from the fan shaped direction of the right side of the usv the encounter scenario is one where the starboard of the ship crosses at a small angle this usv turns right to avoid the coming usv will slow down b starboard of ship crossing at a large angle in area b in fig 3 when other usvs come from the fan shaped direction of the right side of the usv the encounter scenario is one where the starboard of the ship crosses at a large angle this usv accelerates to leave the coming usv decelerates c d other ship starboard chasing or other ship port chasing in areas c and d in fig 3 when other usvs come from the fan shaped direction from the right or left side of an usv and catch up to it if the oncoming usv can see only the tail of this usv the encounter scenario is one where other ship starboard chasing or other ship port chasing this usv accelerates to leave and the coming usv turns left and passes to the left of this usv e f port of ship crossing at a small or large angle in areas e or f in fig 3 when usvs come from the fan shaped direction on the right side of a given usv the encounter scenario is one where the port of the ship crosses at a small or large angle the usv decelerates or accelerates to left and the coming usv turned left and passed the tail of the usv g encounter in area g in fig 3 when usvs come from the fan shaped direction of the port and starboard of a given usv both sets of usvs turn right and pass each other on the left side the above description is for the case where two usvs meet then when more than two usvs meet the situation can be broken down into groups of two usvs that meet for each usv if it can be fully implemented according to the formulated strategy then no collision will occur when more than two usvs meet 2 4 calculating motion parameters and collision risk when there is no communication the usv can obtain only the position speed and heading of other usvs through radar when there is communication information on other usvs can be obtained through the communication module in a multiple usvs system the motion parameters of each usv and the method to calculate the risk of collision are similar below we take one of the usvs as research object and discuss the calculation of its motion parameters and risk of collision with without communication as shown in fig 4 and table 3 when usv m encounters other usvs or obstacles we calculate the motion parameters and risk of collision to determine whether to take collision avoidance measures and the time need for them we assume that x i 1 m y i 1 m x i k m y i k m are coordinates of the scanning point of an obstacle from radar detection of usv m at moment i and is described in the northeast frame then when there is no noise we can estimate the coordinates of the center of the obstacle calculate the averaged position based on a set of measurements 8 x n x i m 1 k j 1 k x i j m y n y i m 1 k j 1 k y i j m however in fact the radar measurement data will inevitably include clutter white noise and colored noise when we use formula 8 to estimate the center position of the obstacle based on the radar data the spike data in the radar data has the greatest impact on the results which would lead to horrendous speed and course estimates while other noise effects are slightly weaker first we need to determine if there are spikes in the data that have a large impact we calculate the standard deviation of the data set when the standard deviation is less than a certain range it is considered non existent otherwise it is considered to exist at this time in order to eliminate such spike data we need to process the radar measurement data when one value of a set of data exceeds the others too much it is deleted then we need to adopt a denoising algorithm to remove the noise to obtain the coordinates of the center of the obstacle the relative distance between usv m and the target n is 9 r m x m x n 2 y m y n 2 the orientation of dynamic targets n other usvs relative to the heading of usv m is 10 α m 90 arctan x n x m y n y m i f y n y m 0 270 arctan x n x m y n y m i f y n y m 0 the distance between the estimated centers of obstacles at adjacent moments is 11 d m x i 1 m x i m 2 y i 1 m y i m 2 in the above formula x i 1 m y i 1 m is the center of the obstacle time i 1 we assume the time interval is t and threshold is d 0 if d m d 0 the obstacle is static relative to this usv and if d m d 0 the obstacle is dynamic relative to this usv in turn we can estimate the velocity v n and heading β n of the dynamic target other usvs 12 v n d m t 13 β n 90 arctan x i 1 m x i m y i 1 m y i m i f y i 1 m y i m 0 270 arctan x i 1 m x i m y i 1 m y i m i f y i 1 m y i m 0 the component of the velocity of the dynamic target n other usvs in the x m y m axis is 14 v n x v n cos β n v n y v n sin β n in this way if v m is the velocity of the usv and β m its heading we can calculate the component of the moving velocity in x m y m axis v m x v m y then the component of the velocity of the usv relative to that of the dynamic target n is 15 v r x v m x v n x v r y v m y v n y the velocity of the usv relative to the dynamic target n other usvs is 16 v r v r x 2 v r y 2 when there is communication the usv can obtain the motion parameters of other usvs through the communication module where the range of acquisition is greater than that detected by radar in addition we establish a public barrier database with a blackboard structure which means that each usv stores and shares parameters of the static and dynamic obstacles it detects and other usvs can refer this information for collision avoidance planning the formulae for the motion parameters of the usv m and target n r m α m v r x v r y v r are same as in 8 9 14 and 15 distance at closest point of approach d c p a m fu 2017 17 d c p a m r m sin 90 arctan v r x v r y α m when the dynamic target other usvs is in the direction of the usv s bow d c p a m is positive when it is in the direction of the usv s stern d c p a m is negative time at closest point of approach t c p a m fu 2017 18 t c p a m r m v r cos 90 arctan v r x v r y α m when the usv does not reach the nearest place of encountering other usvs t c p a m is positive when the usv exceeds the nearest place of encounter t c p a m is negative the usv s risk of collision is an important criterion for measuring whether a collision hazard occurs in a collision system it is also an important measure of whether to start collision avoidance and it is necessary to calculate it accurately however the calculation of the collision risk is currently applied to the ship s collision avoidance system and the influence caused by human operation is considered in the calculation process in the collision avoidance system there are no human factors so the method is only used as a reference in addition there is some ambiguity and uncertainty in the parameter of collision risk at present there is no clear explanation of the calculation method in the literature at home and abroad rule 7 of the colregs states that when determining whether there is a danger of collision the factors to be considered should include there is no significant change in the compass position of the coming ship even if there is a significant change in the position this danger may sometimes exist especially when approaching a very large vessel or tugboat or when approaching another vessel at close range in recent years methods that can determine the calculation of collision risk can be roughly divided into the following dcpa and tcpa weighted determination methods artificial neural network methods fuzzy set methods and extension set methods there are many factors that affect the risk of collision including dcpa and tcpa and their errors target azimuth sailing speed and the speed ratio between two ships but most scholars believe that dcpa and tcpa are the two main factors that affect the collision risk kearon first proposed the method if a and b are weighted values u a d c p a 2 b t c p a 2 imazu and makoyama think the smaller the margin between the own ship and other ships and the shorter the margin of time the higher the danger of collision u a d c p a b t c p a r a and b are weighted values the problem with both calculation methods is that dcpa and tcpa have different dimensions so the calculated collision risk is not accurate enough some scholars have divided it into two parts namely the space collision risk and time collision danger which is more conducive to a deeper understanding of the formation of collision danger this paper uses the calculation of this risk as reference for the ship s collision avoidance planning draws on the dcpa and tcpa weighting methods and considers the navigation of the usv to design the risk of collision the risk is divided into two aspects space and time the risk of spatial collision of usv m is fu 2017 19 u d m 1 d c p a m l 1 1 2 1 2 sin π l 2 l 1 d c p a m l 1 l 2 2 l 1 d c p a m l 2 0 l 2 d c p a m where l 1 is the safe distance l 2 is the distance of starting collision avoidance if l 2 d c p a m the usv is safe if d c p a m l 1 there is a risk of collision if l 1 d c p a m l 2 the system needs to calculate the risk of collision of the usv the temporal risk of collision of usv m is fu 2017 20 t c p a m 0 u t m 1 t c p a m t 1 t 2 t c p a m t 2 t 1 2 t 1 t c p a m t 2 0 t c p a m t 2 t c p a m 0 u t m 1 t c p a m t 1 t 2 t c p a m t 2 t 1 2 t 1 t c p a m t 2 0 t c p a m t 2 where t 1 d 1 2 d c p a m 2 v r and t 2 d 2 2 d c p a m 2 v r combining the spatial and temporal risks of collision we derive the risk to usv m 21 u m u d m u t m where means the following if u d m 0 or u t m 0 u m 0 if u d m 0 and u t m 0 u m max u d m u t m in the multiple usvs system the calculation of the risk of collision of the other usvs is similar to that of usv m and we will not repeat this here 3 design of multiple usvs collision avoidance planning algorithm as shown in fig 5 the improved genetic algorithm is the core module in the proposed multiple usvs collision avoidance planning system after the usvs start to sail the system calculates the heading and speed in real time and navigates according to them during the navigation the radar detects the signals of surrounding environment in real time and the communication module receives information in real time when the usvs reach the destination they stop sailing when the radar and communication module of usvs perceive obstacles and the distance to the obstacles are less than the starting collision avoidance distance the motion parameters and collision risk of the usvs are calculated if the collision risk is less than a certain threshold divide the encounter situation between usvs and obstacles and select the corresponding collision avoidance strategy after that the improved genetic algorithm is started to plan the optimal control instructions of acceleration and yaw rate for usv as shown in fig 6 we use retention deletion and replacement to improve the genetic algorithm and the analytic hierarchy process to build fitness following the population initialization of the genetic algorithm establishment of fitness and selection crossover and mutation the system iterates real time optimization acceleration and optimizes the yaw rate of every usv to calculate the current best path of each 3 1 individual coding and population initialization design the motion control of the usv usually functions according to the strategy of heading control and velocity control we thus used acceleration and yaw rate as control variables in this paper the population initialization of the improved genetic algorithm used float coding and we employed a certain range of float to code and express the acceleration and yaw rate we set the initial population of usv m to 50 individuals chromosomes with a coding length of two each m i a r included acceleration a and yaw rate r and each usv population was independent we assume that x m i y m i is the position of usv m at the given time v m i ψ m i are its velocity and heading and a m i r m i is the current best solution of the genetic algorithm at time i when the interval is t the velocity and heading of the next moment v m i 1 ψ m i 1 are given by 22 v m i 1 v m i a m i t ψ m i 1 ψ m i r m i t the position at the next moment x m i 1 y m i 1 is 23 x m i 1 x m i v m i 1 δ t cos ψ m i 1 0 5 a m i δ t 2 cos ψ m i 1 y m i 1 y m i v m i 1 δ t sin ψ m i 1 0 5 a m i δ t 2 sin ψ m i 1 we arbitrarily set the initial position of each usv and set the initial speed of each to zero and its initial direction to the end point in addition to ensure the stability of the usv and avoid large angle steering we set the range of acceleration for each usv to 2 2 k n s 0 514 m s 2 and the range of yaw rate for each to 5 5 s according to the above rules when multiple usvs are navigating and headings are crossed the system determines whether there is a risk of collision based on the relative heading and relative distance between the usvs if there is a risk it is necessary to further determine the collision avoidance measures to be taken to eliminate it then it is necessary to accurately divide the encounter scenarios featuring multiple usvs to clarify obligations for collision avoidance among the usvs then the system decides the actions and actions of each usv in the collision avoidance process turn left turn right hold finally the genetic algorithm encodes and initializes the control variables according to the determined actions and behaviors different actions and behaviors correspond to different variable coding ranges for example the decision to turn right and accelerate we set the range of acceleration for each usv to 0 2 k n s and the range of yaw rate for each to 5 5 s this method can ensure the accuracy of each usv action and behavior and can further reduce the optimization time of the genetic algorithm once each usv had completed the optimization at the given time its motion parameters and obstacle in its path changed and it was necessary to re initialize the population and iterate to the current best solution in the next moment in these iterations the optimized acceleration and yaw rate at each moment constituted the current best path of usv m its structure is x m 0 y m 0 x m i y m i x m k y m k where x m 0 y m 0 and x m k y m k are the starting and ending points of the usv and x m i y m i is the path point obtained by the current best solution of the optimization the structure of the current best solution is a m 0 r m 0 a m i r m i a m k r m k where a m i r m i is the current best solution of the optimization 3 2 fitness model the value of fitness is the criterion for evaluating individuals of a population this paper set the maximum value convergence that is to say the selection screened individuals with higher fitness to form the next population in multiple usvs collaborative collision avoidance planning the purpose is to plan the path with the shortest length and lowest sailing time while avoiding all obstacles and collisions between usvs according to the colregs therefore when constructing fitness in this paper we considered such factors as the distance between the given position of the usv and the end point the distance between the given position of the usv and obstacles the distance between the given position of the usv and other usvs the given velocity and heading and the positions of obstacles and other usvs as shown in fig 7 an usv simultaneously detects the positions of the obstacle and another usv x 0 o 0 y 0 is the sensor fixed frame of the usv and o 1 is the origin in the sensor fixed frame of another usv the circle represents the range of the radar s detection d 0 is the current shortest distance between the origin in the sensor fixed frame of the usv and obstacle a d 1 is the current shortest distance between the origin in the sensor fixed frame of the usv and current position of another usv d is the current distance between the given positions of the usv and the end point μ is the start angle of the obstacle the angle of the lower boundary of the obstacle detected by radar ν is the end angle of the obstacle the angle of the upper boundary of the obstacle detected by radar δ is the start angle of another usv the angle of the lower boundary of another usv detected by radar and γ is the end angle of another usv the angle of the upper boundary of another usv detected by radar different yaw rate and acceleration will make the position of the usv different which affects d 0 d 1 d then the fitness of the improved genetic algorithm in this paper is 24 f 1 λ k 1 c k 2 d 0 k 3 d 1 μ ψ i 1 ν o r δ ψ i 1 γ λ k 1 c k 2 d 0 k 3 d 1 e l s e in the above c d o r i d d o r i is the distance from the initial moment of usv to the end point k 1 k 2 k 3 are constants ψ i 1 is the heading if the usv selects an individual at the next moment and f is the value of fitness that is always positive the greater the value of f is the more likely is the relevant individual to be selected as a child we introduce the reward and punishment factors in fitness and adopts a reward and punishment mechanism to increase the degree of discrimination if the angle of the next moment is within the range of angles of the obstacles or other usvs and the given usv continues to sail close to obstacles or other usvs the value of fitness is reduced λ times to reduce the probability of being selected if the angle of the next moment is not within the range of angles of obstacles or other usvs and the given usv continues to sail to avoid obstacles or other usvs the value of fitness is expanded by a factor of λ to increase the probability of being selected in addition we apply the analytic hierarchy process to calculate the coefficients of each factor according to the influence of various factors on fitness as shown in table 4 the left half is the designation standard level matrix and the right half is the results of operation that pass the consistency test the consistency test is to determine whether there is a significant difference between the averages or variances at a certain level of significance if there is no significant difference the mean or variances are consistent when there is no risk of collision between the usv and the target or if the distance to begin collision avoidance is not reached under this fitness the optimized acceleration and optimized yaw rate of the algorithm are mainly constrained by the distance d between the usv and the end point the system selects individuals arriving at the end point more quickly with optimized acceleration and turn rate when there is a risk of collision between the usv and the target and the distance to start collision avoidance is reached under this fitness the optimized acceleration and yaw rate of the algorithm are mainly constrained by distance d 0 d 1 between the usv and the static and dynamic target while the effect of d between the usv and the end point is small the system selects individuals who are more stable in avoiding static and dynamic targets with an optimized acceleration and turn rate after each usv moves corresponding to optimized acceleration and yaw rate the heading of the usv moves gradually away from the range of angles of the static and dynamic targets after a certain period the heading of the usv is no longer within the range of angles of the targets this leads to a large change in the relative speed and the component of relative speed between the usv and the static and dynamic targets according to the calculation of d c p a m t c p a m and the risk of collision in the previous section when the relative speed and component of relative speed between the usv and static and dynamic targets are significantly increased the values of d c p a m and t c p a m are reduced accordingly thus reducing the risk of collision in addition when the heading of the usv is not within the range of angles of the static and dynamic targets this increases d 0 d 1 to the targets and reduces the risk of collision to some extent 3 3 design of evolutionary operations evolutionary operations are the core of improved genetic algorithms including selection crossover and mutation according to fitness the system selects a certain number of individuals to cross and mutate to generate offspring and form the progeny populations the current best individuals are obtained after a certain number of iterations 3 3 1 selection in this paper we adopt roulette selection the system calculates the probability that each individual is selected according to fitness and randomly select individuals to form progeny populations according to the probability the larger the value of fitness is the greater is the probability of being selected 3 3 2 crossover crossover is the primary way to generate new individuals by pairing individuals and exchanging genes in some way as shown in fig 8 in this paper we use discrete cross individuals exchange variable values and sub individuals randomly select the parent individual with a certain probability before the crossover individuals of the population were randomly paired and the crossover probability was set to 0 8 when crossing the acceleration and yaw rate were separated 3 3 3 mutation mutation is a means of generate new individuals while fully maintaining the diversity of the population s genes as shown in fig 9 in this paper we adopt gaussian mutation the system generates a random number obeying the gaussian probability distribution instead of a gene part of the individual selected with a certain probability if the initialization sets the population capacity to 50 the reciprocal 0 02 of the population capacity is set as the mutation probability 3 3 4 retention deletion and replacement to effectively improve the speed of optimization and solve the problems of the local optimum premature convergence and sub optimal superiority to the parent this paper adds retention deletion and replacement as shown in fig 10 the retention operation refers to preserving the current best individual of each generation in the next generation which ensures that good genes are inherited by the offspring population and prevents sub optimal solutions the deletion and replacement operations refer to determining whether the heading is within the range of the start and end angles of the target when considering the yaw rate of the individual if it is within the range the usv approaches the obstacle while continuing to sail at this point we replace the yaw rate of the individual with that of the best individual in this generation this is equivalent to adding a way to generate new individuals complementing the reward and punishment mechanism to enhance protection for good genes and avoid local optima to some extent finally after several generations of populations have been iterated the system determines whether the end condition is satisfied if it is the optimized acceleration and yaw rate of the current best individual are output if not fitness is reconstructed and iterated in multiple usvs systems the methods of individual coding and population initialization establishment of fitness selections crossover mutation and the additional retention deletion and replacement of other usvs are similar to those of usv m and thus we will not repeat them here 4 experimental analyses to verify the effectiveness of multiple usvs collaborative collision avoidance planning based on the improved genetic algorithm this paper selected the qt software to establish the simulation platform designed typical simulation cases for experiment and analyzed the experimental results and data 4 1 collision avoidance simulation system as shown in fig 11 to visually reflect the effect of multiple usvs collision avoidance planning the software s initial window of the multiple usvs navigation simulation environment constructed in this paper was maximized by default the lower left corner of the screen was the origin of the north east coordinate system the right direction was the positive direction of the x axis and the upward direction was the positive direction of the y axis the experimental area was 100 km long and 150 km wide the software could arbitrarily set the starting and end points of multiple usvs the shape size position of the obstacle and the control mode with without communication in addition the simulation experiment could display the navigation parameters of each usv in real time and draw the trajectories of usvs 1 3 with smooth curves of red yellow and green respectively as shown in table 5 considering the navigation of high speed usvs and retaining a sufficient margin and through a comparative analysis of multiple simulations we set the initial parameters of each usv as given in the table below to complete the simulation quickly factors for accelerating it were set here 4 2 cooperative collision avoidance for usvs without communication collision avoidance planning for multiple usvs missions without communication means that the usvs avoid all obstacles or other usvs encountered from their respective starting points to their respective mission locations and can detect only the position speed and heading of the obstacles and other usvs through radar as shown in fig 11 in the experiment each usv traveled from the starting point to the end point straight along the obstacle from other usvs when sailing to obstacles or other usvs the target information was detected by radar when the distance to the target was less than 2 km which and the risk of collision are used as a condition to initiate collision avoidance the system started collision avoidance and circumvented both sides of the target and continued to sail toward the end during the voyage the distance between multiple usvs and obstacles was always kept greater than the minimum safe distance and there was no collision between usvs this meant that collision avoidance was effective as shown in figs 12 and 13 the trend of acceleration and the yaw rate changed with the experimental effect in the experiment the navigation trajectory of the usv and the trend of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or large angle turns however according to rule 8 b of colregs any alteration of course and or speed to avoid collision shall if the circumstances of the case admit be large enough to be readily apparent to another vessel observing visually or by radar a succession of small alterations of course and or speed should be avoided smooth curves is probably against colreg regulations however considering the effects of motion control we will still control the upper limit of speed and heading as shown in fig 14 because there was no communication when the distance between usvs exceeds the range of detection of the radar it was assumed that the relative distance between usvs was used as the radar s detection distance of 10 km the trend of relative distance changed with the experimental effect the relative distance between usvs was always greater than the minimum safe distance and no collision occurred as shown in figs 15 and 16 the trend of tcpa and dcpa corresponded to the experimental effect and the trend of relative distance when dcpa and tcpa were small the distance between a usv and another was relatively small and collision might have occurred if the usvs had continued to sail along their course at this time each usv took appropriate measures to avoid collision thereby increasing dcpa and tcpa as shown in fig 17 the trend of risk of collision corresponded to the experimental effect dcpa tcpa and relative distance when the risk of collision was high this indicated a greater possibility of collision if the usvs had continued along their course at this time each usv took appropriate measures to avoid collision and thus reduced its risk as shown in fig 18 during the simulation experiment we intercepted the encounter between usvs judged the encounter situation adopted the corresponding collision avoidance strategy and successfully avoided the moment corresponding to fig 3 in the previous article the situation is divided into 7 types and the corresponding collision avoidance strategies are designed here the effectiveness of the 7 collision avoidance strategies is also verified for example in g of the figure the position and heading of the two usvs at this time constitute a confrontation situation at this time the two usvs simultaneously adopt the strategy of turning right to avoid as shown in figs 19 and 20 the trends of multiple usvs fitness were roughly similar and were optimized for the maximum value the more the number of iterations of the algorithm were the higher was the fitness of the individual population multiple optimizations were performed in the same state the fitness of optimization for each usv was not changed by much and the algorithm had a certain stability when keeping the other parameters constant we changed the number of iterations and performed multiple experiments as shown in table 6 compared with the iterative process of the conventional genetic algorithm the number of iterations were reduced the speed of convergence clearly improved premature convergence was slightly improved and there was no mutation in the late convergence of the curve which means that there was no local optimization we performed multiple optimization experiments in the same state compared the optimization results of the improved genetic algorithm with those of the conventional genetic algorithm and use 25 to calculate the standard deviation of multiple experimental results we improved the genetic algorithm with a low standard deviation high success rate and strong stability following the program test it took 90 ms to complete an optimization the efficiency of the algorithm was thus high and its optimization time was adequate for system response compared with the 160 ms of the conventional genetic algorithm the speed of optimization also significantly improved for the collision avoidance system in this paper the range of yaw rate was 5 5 s when encountering obstacles if deceleration was not considered the 18s turning motion could cause the usv to turn 90 at this time the usv traveled at its full speed of 50 knots over 500 m therefore the running time of the genetic algorithm distance at which collision avoidance begins and the minimum safe distance were all adequate for the usv to avoid collision 25 s 1 n 1 i 1 n x i x in our experiments the improved genetic algorithm reduced the optimization time by 70 s compared with the traditional genetic algorithm to prove the superiority of improved genetic algorithms we have added several sets of experiments to quantitatively analyze the impact of the reduction in optimization time on the collision avoidance ability in the experiment we set the initial speed of each usv to 20 30 40 50 knots and other experimental conditions are shown in table 5 we use traditional genetic algorithm and improved genetic algorithm to conduct experiments to compare the indicators of the collision avoidance under different initial speed conditions as shown in table 7 at different speeds the time taken by the improved genetic algorithm to avoid obstacles is shorter than that of the traditional genetic algorithm the minimum distance to obstacles and success rate of the improved genetic algorithm is greater than that of the traditional genetic algorithm and with the increase of sailing speed the gap of time to avoid obstacles minimum distance to obstacles and success rate between the improved genetic algorithm and the traditional genetic algorithm to avoid obstacles is larger that is to say the greater the sailing speed the more obvious the performance advantages of the improved genetic algorithm in these aspects the shorter the collision avoidance calculation time is the better it is to ensure the safety of collision avoidance under high speed conditions 4 3 cooperative collision avoidance for usvs with communication when there is no communication the usv can obtain only the position velocity heading and some other information of the target through radar it is not possible to pre plan the path to avoid the target in advance when multiple usvs arrive at a cross section it is necessary to formulate traffic rules and pauses or shifts to avoid cross sectional collisions when there is communication as a tool for sensing environmental information the communication module senses dynamic usvs and static obstacles in advance the usv can obtain the position velocity heading and some other information of the target through the communication module in advance and can plan its path in advance to avoid dire situations or encounters according to such parameters as distance velocity and heading the usv plans the path in real time where there is no cross section to improve the reliability of collision avoidance and safety of navigation as shown in fig 21 in the experiment each usv sailed from the starting point to the end point when the usv was far from obstacles and other usvs it sailed in a straight line when the usv sailed to the vicinity of obstacles and other usvs the information of the target was detected by radar if the distance between the usv and the target was less than 2 km the usv started collision avoidance to pass on either side of the target and continue to sail toward the end during the voyage the distance between each usv and the obstacle was always greater than the minimum safe distance and there was no collision between usvs as shown in figs 22 and 23 the trends of acceleration and the yaw rate changed with the experimental effect in the experiment the trajectory of the usv and the trends of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or a large angle turn as shown in fig 24 the trend of relative distance changed with the experimental effect compared with the case of no communication the distance between the usvs was larger as shown in figs 25 and 26 the trend of tcpa and dcpa corresponded to the experimental effect and trend of relative distance when dcpa and tcpa were small the distance between usvs was small and collision might have occurred if they had continued on course each usv took appropriate measures to avoid collision thereby increasing dcpa and tcpa compared with the case of no communication the dcpa and tcpa of each usv were always big enough it shows the role of the communication module in improving collision avoidance as shown in fig 27 the trend of risk of collision corresponded to the experimental effect dcpa tcpa and relative distance when the risk of collision was high this indicates a greater possibility of the collision if the usvs had continued on course each usv took appropriate measures to avoid collision and thus reduced its risk as shown in figs 28 and 29 the trends of multiple usvs fitness were roughly similar and optimized for the maximum value the greater the number of iterations of the algorithm were the higher was the fitness of the individual multiple optimizations were performed in the same state the fitness of optimization was not changed by much and the algorithm had a certain stability when keeping the other parameters constant we changed the number of iterations and performed multiple experiments to test that when the number of iterations was 250 and 100 as shown in table 8 and fig 30 usv no 3 was considered as an example compared with the case of collision avoidance with without communication the minimum relative distance between the usv and two other usvs was significantly greater this shows that the communication module had a significant effect on maintaining the relative distance among the three usvs in addition dcpa and tcpa also increased prominently which shows that the communication module can improve the space and time margins of collision avoidance to prevent emergency collision avoidance the communication module sensed dynamic usv and static obstacles in advance and obtained the information on the position velocity and heading of the target to plan its path in advance and avoid emergencies and even encounters when the other conditions were unchanged the frequency of communication changed the higher the communication frequency the better the effect of maintaining distance between usvs by referring to the communication frequency of a ship s ais this paper enabled the communication dynamic information at 0 5 hz and static information at 0 05 hz of course the communication module has information processing and transmission delays in practice compared with the running time of the algorithm 80 ms the time delay 0 62 ms of the communication of the blackboard mode established in this paper was small and can be ignored we performed multiple optimization experiments in the same state compared the optimization results of the improved genetic algorithm with without communication and use 25 to calculate the standard deviation of multiple experimental results compared with the iterative process of the improved genetic algorithm without communication the evaluation index of the algorithm has improved but the improvement is not obvious this means that the communication module has improved the running time and stability of the collision avoidance algorithm but the improvement is not large the minimum relative distance between usv no i and usv no j d min i j the minimum dcpa between usv no i and usv no j d c p a min i j the minimum tcpa between usv no 1 and usv no 2 t c p a min i j the maximum collision risk of usv no i r i s k max i as shown in table 9 compared with the iterative process of the improved genetic algorithm without communication the evaluation index of the algorithm has improved but the improvement is not obvious as shown in fig 31 in order to prove the performance of our method we conducted multiple statistical experiments in these simulations we changed the start and end points of each usv as well as the shape size and location of obstacles in this way the success of multiple scene simulation experiments is enough to prove the stability of our algorithm then we compared the parameters of the improved genetic algorithm with those of algorithms specifically designed for real time online collision avoidance planning as shown in table 10 the artificial potential field method has a higher optimization speed and good ability to avoid obstacles tsou and hsueh 2010 however it has a low success rate and stability similarly the ca algorithm has higher optimization speed tsou 2016 compared with the artificial potential field method the stability and success rate of the proposed algorithm are superior however control of the distance to the target is weakened when considering the steering strategy compared with the artificial potential field method and the ca algorithm the improved genetic algorithm is slower at optimization but its stability success rate and control of distance to the target are significant advantages the speed of the improved genetic algorithm and its parameters of collision avoidance can satisfy the demands of high speed usvs for collision avoidance therefore combining various indicators and improving genetic algorithms yields satisfactory performance finally to further verify the performance of the improved genetic algorithm we compare it with a novel algorithm deep learning when applying deep learning dl to usvs collision avoidance we choose the same system model as the genetic algorithm which includes the motion model of usvs the detection model of sensor the encounter situation division and collision avoidance measures the calculation of related motion parameters and collision avoidance risk the input to the obstacle avoidance planning network is an 91 dimensional vector consisting of the 90 dimensional input distance vector and an input direction vector obtained from the radar the two dimensional output vector from the obstacle avoidance planning network consists of the yaw rate and the acceleration of the usv the dataset used to test the proposed method consists of 112003 training samples and 783 test samples in the offline training process training the labels used for supervised learning are obtained by traditional obstacle avoidance planning methods the model was trained with input layer hidden layer middle layer and output layer the input layer consists of 91 neurons corresponding to the input vector the hidden layer consists of network structures the middle layer contains 36 neurons and the output layer has two neurons corresponding to the yaw rate and the acceleration of the usv lin et al 2019 in order to better verify the comparative effect of the two algorithms we run the two algorithms in the same environment to simulate collision avoidance as shown in fig 32 the red green and yellow curves are the trajectories of the three usvs when running the genetic algorithm to avoid collisions the blue black and white curves are the trajectories of the three usvs when running deep learning to avoid collisions in the simulation experiment of the two algorithms each usv sailed from the starting point to the end point when the usv was far from obstacles and other usvs it sailed in a straight line when the usv sailed to the vicinity of obstacles and other usvs the information of the target was detected by radar if the distance between the usv and the target was less than 2 km the usv started collision avoidance to pass on either side of the target and continue to sail toward the end during the voyage the distance between each usv and the obstacle was always greater than the minimum safe distance and there was no collision between usvs it can be seen that although the paths of the two algorithms have certain differences they both have good collision avoidance effects as shown in figs 33 38 in order to compare the characteristics of the output control parameters of the two algorithms we plot the yaw rate and acceleration of each usv output by the two algorithms on the same graph the trends of acceleration and the yaw rate changed with the experimental effect in the simulation experiment of the two algorithms although the acceleration and yaw rate output by the two algorithms are different the trajectory of the usv and the trends of acceleration and the yaw rate were smooth and there was no emergency acceleration and deceleration or a large angle turn further we quantitatively compare the collision avoidance performance parameters and algorithm operating characteristics of the two algorithms we performed multiple optimization experiments in the same state that is to say at a certain time run the two algorithms multiple times to plan a large number of feasible solutions for usvs in this way this article runs two algorithms to plan 1000 times for usvs from the total time of multiple optimizations the running time of each algorithm can be calculated the success rate of the algorithm can also be obtained from the results of multiple runs the standard deviation can also be obtained by formula 25 calculation results as shown in table 11 and fig 39 in terms of minimum relative distance minimum dcpa minimum tcpa maximum collision risk success rate standard deviation there is no obvious difference between the two algorithms both algorithms have a higher success rate and lower standard deviation indicating that both algorithms have strong stability in terms of operation time the deep learning takes very little time 9 8 ms to complete the planning compared with genetic algorithm it has obvious advantages however deep learning is not perfect for multiple usvs collision avoidance when the navigation environment the number of usvs and parameters of usv s motion model change the network needs to be retrained when deep learning collision avoidance it is difficult to suitable for full mission scenarios different motion models maneuver strategies any environmental models wind waves and currents and mission based collision avoidance rules in short the rise of new intelligent algorithms cannot conceal the vitality of traditional algorithms both genetic algorithms and deep learning have their own advantages and disadvantages and these disadvantages are still the direction of future research 5 conclusion the most significant contribution of this paper is solving the problem of multiple usvs collaborative collision avoidance planning by using the improved genetic algorithm in a certain degree in the multiple usvs collaborative task mode in a complex environment featuring obstacles the authors established a multiple usvs model of motion and sensors categorized encounter scenarios involving multiple usvs and formulated corresponding collision avoidance strategies and calculated the motion parameters and risk of collision of multiple usvs to determine whether to take collision avoidance measures we then chose the genetic algorithm as the core algorithm of collision avoidance planning improved it with retention deletion and replacement used the analytic hierarchy process to establish fitness based on the information of obstacles and other usvs and iteratively optimized the acceleration and yaw rate to calculate the current best path of collision avoidance for each usv finally we built a multiple usvs simulation platform of collision avoidance planning based on the qt software and designed some typical simulation cases to verify the effectiveness of the proposed collision avoidance planning with and without communication the results show that the proposed method can be used to plan the current best path of collision avoidance for multiple usvs in complex environment and has good stability and smooth trajectories compared with the conventional genetic algorithm the improved algorithm effectively reduces the number of iterations running time and standard deviation and improves the success rate the results show that the communication module transmits information to plan the path in advance and can thus avoid emergencies and even encounter scenarios credit authorship contribution statement hongjian wang conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing project administration funding acquisition zhongjian fu conceptualization methodology software validation formal analysis investigation resources writing original draft writing review editing jiajia zhou validation formal analysis investigation resources project administration funding acquisition mingyu fu validation formal analysis investigation resources project administration funding acquisition li ruan validation formal analysis investigation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the college of intelligent systems science and engineering of harbin engineering university for providing a laboratory learning environment and experimental equipment and colleagues and students in the laboratory for their assistance this work was supported in part by the national natural science foundation of china under grant 61633008 and grant 51609046 and in part by the natural science foundation of heilongjiang province under grant f2015035 
21076,data driven models for ship propulsion are presented while the effect of data pre processing techniques is extensively examined in this study a large automatically collected with high sampling frequency data set is exploited for training models that estimate the required shaft power or main engine fuel consumption of a container ship sailing under arbitrary conditions emphasis is given to the statistical evaluation and pre processing of the data and two algorithms are presented for this scope additionally state of the art techniques for training and optimizing feed forward neural networks fnns are applied the results indicate that with a delicate filtering and preparation stage it is possible to significantly increase the model s accuracy therefore increase the prediction ability and awareness regarding the ship s hull and propeller actual condition furthermore such models could be employed in studies targeting at the improvement of ship s operational energy efficiency keywords performance monitoring artificial neural network data processing propulsion modeling predictive analytics 1 introduction the shipping industry nowadays is under heavy obligations for more efficient and environmental friendly ships and maritime operations even though the green house gas ghg emissions from ships are less than 3 of the global ghg emissions smith et al 2014 and while they transfer more than 90 of the goods imo has set goals for reducing them imo 2018 these goals are coming on the wake of the global scale efforts against climate change that initiated for the first time a few years ago and are bringing new legislations and requirements on one hand reducing ship emissions can have multiple benefits for ship owners and ship managers it would be simpler for them to comply with the increasing regulatory requirements and survive through possible downturns of the markets on the other hand achieving improvements in the vessels energy efficiency is a big challenge as mentioned by imo s 2018 initial strategy on the reduction of ghg emissions from ships operational measures appeared as one of the prominent short term measures to achieve them they require minimum capital expenditures in comparison to other measures and can be immediately implemented to almost every type of vessel however in order to successfully implement these measures it is crucial to have a robust performance monitoring system that is based on real time high frequency data and state of the art models the developments in different fields of technology have made feasible the continuous monitoring of ships and the collection of huge amount of operational data that carry valuable information if properly exploited more specifically it is the convergence of i technologies in the field of the electronics and sensors ii the global satellite internet connection capacity and iii the machine learning ml methods which produce models with superior predictive capabilities thereby the reasoning and purpose of this study may be summarized as follows the capability to produce highly accurate ship propulsion models through improved methods and practices of data manipulation will enable the thorough and effective monitoring of ship performance and provide support for the investigation of operational measures that could lead to an improvement of operational energy efficiency such models can considerably boost the effectiveness of applications like speed and route optimization and weather routing an overview of the proposed procedure for propulsion modeling is presented in fig 1 starting from the installed systems and sensors on the ship the recorded data are collected formatted and synchronized before stored on a server onboard and sent via satellite internet on shore firstly a brief description of the parameters targeted for data acquisition is provided then follows the data preparation stage where the retrieved data should be validated and statistically processed before further exploited in order to ensure a quality data set the next step concerns the modeling stage and specifically the generation and selection of the best suited combination of parameters feature engineering for building each ml model finally the data are used to train artificial neural network ann models whose architecture and parameters have been carefully selected application wise in the current study we are going to analyze the data preparation and modeling stages of the framework shown in fig 1 2 literature review nowadays there is an increasing trend for utilizing data driven models due to the availability in a cost effective way of a vast amount of operational data as well as due to the need to increase the level of accuracy achieved by the empirical models while avoiding the computational cost required when employing computational fluid dynamics cfd simulations the basic idea behind these models is to exploit the data collected from a particular ship s operation and use them to create a statistical model that could estimate its powering needs or forecast its consumption and monitor its performance indicative papers that are applying this type of propulsion modeling are presented below in petersen et al 2012a a publicly available dataset collected from the onboard sensors of a ferry over a period of two months is used for the training of two types of neural network models an instantaneous and a predictive model the instantaneous is a typical feed forward neural network that estimates an output yn e g the main engine s fuel consumption based on the current input vector xn and hence omitting the temporal character of the propulsion parameters the predictive is a tdnn tap delayed neural network a type of recurrent neural network that takes as input x n all the available propulsion parameters defined as state control and constant vectors and estimates the difference in the target variable at the next time step x n 1 also the predictive model s residual error in the training set is used to fit a probability distribution that will be added to the model s final predictions as noise the achieved accuracy for the instantaneous model is given as mean relative error of 1 50 on the fuel oil consumption foc estimation while their tdnn model had no comparable metric estimated in this study in pedersen and larsen 2009 the propulsion power of an 110 000 dwt tanker is predicted again with anns for the data pre processing the ship s heading is used to filter the data since it was noticed that when it is fluctuating there is significant influence on the measured propulsion power the results from the ann models demonstrate a mean relative error in the estimation of propulsion power ranging from 0 82 to 2 69 while same predictions using empirical methods are found to be ten times less accurate brandsaeter and vanem 2018 applied regression models to predict ship s speed using a set of 18 vessel parameters collected from high frequency sensors but over a limited time period of about 3 months data filtering and pre processing are not examined in detail because focus is given on modelling technics like k folds cross validation and ensembles methods optimum results are obtained when larger portion of the data is utilized for the models training and the baseline method for predicting speed using the admiralty s formula is outperformed statistically but not in the whole range of speeds perera and mo 2016 proposed a procedure based on machine learning methods for handling the big data generated on board it includes three steps sensor faults detection data classification and data compression particularly principal components analysis and gaussian mixture models are exploited to filter the data points and cluster them respectively outcome of this procedure is a prepared dataset that is compressed on board and expanded on shore using again the pca structure discussed further in perera and mo 2018 as the data compression and expansion functions of an autoencoder they demonstrated that information can be compressed and preserved effectively with their methodology but no further quantitative metrics are offered ahlgren and thern 2018 relied on an automated process of machine learning in order to generate models that predict ship fuel consumption without human intervention in the model parameter selection even though they recognized the significance of the pre processing stage they attempted to validate only fuel consumption data their best performing model achieved accuracy similar to this of the previous researchers 4 8e 4 mean squared error in normalized model output but the number of features used as inputs was quite limited at max 4 inputs another recent work that developed ship propulsion models based on high frequency sensory data is that of soner et al 2018 they utilized the same data set as petersen et al 2012b and reported similar accuracy root mean square error of 0 45 knots in the speed and 44 6 l hr in the foc estimation for their models however the argument that favors their modeling technic which is based on shrinkage models such as ridge and lasso is that they are not using a black box method and therefore their model and results are easier interpretable the same conclusion is reached by wang et al 2018 where a lasso regression was used to model the foc of containerships from a dataset that included 97 vessels results from lasso models compared to other typical ml methods models and demonstrated more than 3 folds improvement in the accuracy of predictions gkerekos et al 2019 developed a pipeline for producing data driven models in a 3 step process which includes the pre processing of the data the training of various types of regression models and the selection of the one that performs best on the test set the extra trees regressors achieved the highest accuracy among all models r2 98 followed by anns and random forest regressors another recent effort to utilize high frequency sensory data along with weather hindcast information and ml methods is presented in farag and ölçer 2020 an ann and a multi regression model are combined to predict a vlcc tanker s break power and break specific fuel oil consumption successively even though their data set is limited 1 voyage trainset 1 voyage test same loading condition the demonstrated applications achieve high accuracy 99 6 and provide quantifiable saving in terms of fuel consumption and co2 emissions but only if certain assumptions can be met for a just in time port arrival scenario also model s high accuracy comes at the cost of generalization since it is not tested over varying loading conditions or heavy weather i e north atlantic passage gkerekos and lazakis 2020 combined an ann foc prediction model with a weather routing algorithm in order to maximize the effectiveness of the later as a decision support tool an automated data logging monitoring adlm system provides the required ship data that should be merged with hindcast data from cmems 1 1 copernicus marine environment monitoring service anomalies in the ship dataset are filtered out by applying the central limit theorem in each parameter and adopting a cut off value of 3σ finally a deep neural network trained on the aforementioned data is used in conjunction with the weather routing algorithm and an optimal route is estimated while good agreement among predicted and measured values is achieved coraddu et al 2017 tested three different modelling approaches white box or else physical gray box or else hybrid and black box models and shown that gray box models can actually breed the best of the two worlds white and black box models they achieve the same high accuracy of black box models with less historical data due to the transferred knowledge from the white box models also feature selection is addressed very systematically with random forest feature testing and the results indicate that it is a robust procedure that could be followed in other studies as well an alternative approach on the characterization of hull and propeller condition comes in another study from coraddu et al 2019a where a blend of auto logged and ais data from a research vessel train two anomaly detection models support vector machines and k nearest neighbors learn to classify the vessel s hull and propeller condition as clean or fouled also the feature selection process is validated through brute force checking of each input parameter s importance the results encourage authors to suggest the adoption of their method for real time fouling detection or for energy saving technologies evaluation finally in coraddu et al 2019b a large dataset obtained from on board sensors of two handymax chemical product tankers are utilized to develop the ships digital twin with neural networks with the goal to estimate speed loss due to marine fouling they propose a model based method that is compared to iso 19030 standard approach and outperforms it and thus allowing for more accurate and timely detection of hull fouling the efforts in the data driven modeling of the ship s propulsion however are not limited in the field of neural networks aldous 2015 provided an extended treatment of ship performance analysis it is a study with a more systematic approach on the subject of data uncertainty and pre processing which are crucial elements of the data driven modeling procedure that were not treated so meticulously in the previous studies data from noon reports nr are compared to continuous monitoring cm data and the main disadvantages of the first are found to be a the lack of standardization b the missing observations and inaccuracies and c the inherent characteristic of expressing the ship s performance in terms of foc only and not in the more appropriate term of shaft power one of the concluding arguments is that cm datasets decrease the uncertainty of the collected data and hence of the produced models that are used to evaluate vessel s performance this argument is found to be supported in other works too such as in themelis et al 2018 where the focus is given to the comparison of the prediction capabilities of nr and cm datasets 3 data acquisition for the present study a large set of data acquired from the operation of a container ship was made available utilizing a continuous monitoring system see themelis et al 2019 and karagiannidis et al 2019 for details about the data acquisition system used the ship s main characteristics are presented in table 1 it is crucial to recognize at this stage the influence of the type of the data collection equipment as well as other parameters of the process such as the sampling frequency to the ultimate accuracy of any ship performance model see for example aldous et al 2015 the aforementioned container ship was equipped with sensors that were monitoring the propulsion parameters of interest as well as the loading condition of the ship and the relative wind speed and direction all the available parameters from the ship s operation are presented in table 2 along with the dedicated measuring device these parameters were constantly sampled during the ship s operation with a period of 1 min all the data were synchronized in common timestamps data collected over a period of almost 19 months 2 2 the recordings cover 69 52 531 560 values in 764 637 min period of the total time which can be considered as the time that the ship spent sailing and so the port time was about 30 4 data pre processing even though acquiring a set of data from the operation of a ship is a meaningful endeavor from scientific technological and business perspective the real value of these data will not arise without an effective pre processing the reason is that the collected dataset should prove to be a reliable and well aligned realistic approximation of the occurring situations that a ship is facing the first plausible step would be to inspect visually the collected data since this is a common quality control measure in many engineering activities however due to the fact that large datasets shall be examined we need more efficient and automated methods to identify and clean the dataset from anomalies and outliers and hence improve their intrinsic information nevertheless the issue of data pre processing is quite vague as several methods and techniques exist in the following sub sections we present a 3 step method for pre processing a data set 4 1 imputation algorithm an algorithm is developed for spotting and replacing suspicious measurements on time dependent data that are related to some kinds of physical phenomena it is intended to make modest adjustments on time series data like a liquid s flow rate the revolutions of an engine s shaft or the angular position of a rudder the basic idea behind this algorithm is that physical objects always display inertial behavior in the sense that during an adequately short time window in future their past value or state is not expected to change drastically we present this data imputation algorithm firstly through a real life example and then describe its theoretical structure in the examined data set the most profound case of such suspected measurements existence is spotted on the latitude parameter of the gps signal this parameter along with the longitude define the ship s position in fig 2 the samples of the latitude coordinate that correspond to a 6 month period excluding idle periods are plotted on the left graph the points that break the continuity of the ship s path are the ones that we visually identify as outliers and would like to replace their values in fig 3 left graph the latitude and longitude signals are plotted on a map projection and it becomes clear that these points cannot be accurate measurements that describe the path of the vessel they seem to form a pattern similar to the vessel s original path this is a fact that declares some kind of drifting in the recording or transmission of the gps signal on frequent intervals in fig 2 right graph the processed latitude signal is plotted as time series and in fig 3 right graph the processed ship s path is projected on the map no more points seem to break the continuity of the ship s path now and the whole amount of information regarding ship s position seems to be preserved in order to characterize a datum of the latitude coordinate signal as an outlier and replace it we should consider the dynamics of the ship s movement through sea the latitude can be thought as the y coordinate of the ship s position in a cartesian plane in this case speed over ground and the derivative of the ship s heading are the parameters that determine the rate of change of the ship s coordinates if the speed and heading are constant the rate of change is constant and for constant sampling rate the absolute difference distance of consecutive latitude and longitude data points is also constant when real ship data are processed we cannot expect to encounter absolutely steady conditions however any acceleration or deceleration that occurs to the ship is not expected to cause a displacement significantly larger e g 2 3 times larger than the previously observed that is due to the magnitude of a large ship s inertia and on condition that the sampling frequency is efficiently high in comparison with the dynamics of the observed phenomena if we express it in calculus terms the time derivative of the signal should not be able to rise to an arbitrarily high value the above idea takes the form of an algorithm that examines if a data point is diverging excessively spikes from the neighboring data points and replaces it by setting its value equal to the mean value of the previous and the next data point it is the algorithm that processes the latitude signal of fig 2 resulting to the signal of the right graph image 1 in step iii t l i m is a user defined parameter that can force the algorithm to skip checking the current data point it defines the maximum time gap between two measurements that permits the algorithm to check if a data point should be replaced in step iv s f is a scaling factor whose value is defined by the user based on his understanding of the natural quantity s dynamic behavior and maybe some experimentation for the implementation of the algorithm in this study the t l i m value was set to 3 min and the sf had several different values depending on the parameter that was processed each time the algorithm may be applied once more on the same data points but this time checking among the i 2 th and i 2 th elements instead of the i 1 th and i 1 th this is suggested because it was noticed that after the first implementation of the algorithm some outliers remained in the data set that happened because some outlying points may appear consecutively in this case the i 1 th element is an outlier itself and the algorithm does not identify the i th element as an outlier by pursuing one time step further and involving the i 2 th and i 2 th elements we manage to drastically reduce the probability of misinterpreting a data point if we consider the outliers to be independent and identically distributed the probability of having three consecutive outliers is the cube of the probability of having a single outlier which is by definition much less than 1 hence the value of this probability is really small 4 2 outliers identification the second stage of the data pre processing aims to identify outliers with an alternative approach which does not consider the dataset s temporal information at all the focus is given on the statistical behavior of certain interconnected parameters thus as an outlier we characterize a data point whose distance from the mean value of the measurements in that area is above a predefined threshold defined as k σ where the factor k is a multiplier of the parameters standard deviation σ more specifically the algorithmic procedure that is followed for detecting outliers is given below image 2 we choose not to replace the identified outliers but to remove them from the data set provided the high frequency sampling rate we could afford this choice from a statistical point of view as the remaining data still provide statistically reliable information in the case noon report data were used one shall proceed with data imputation as the loss of data could not be affordable in fig 4 the histograms for a group bin of data points with rpm 92 93 are presented with the x axis being the propeller s shaft torque value left graph and the main engines fuel oil consumption me foc right graph the outlier threshold is marked with the colored dot lines for the different values of the factor k the data group in the rpm range 92 93 includes around 14 000 observations in both cases the distribution s shape seems similar and close to a normal distribution but it is slightly asymmetric for the setting of the outlier threshold based on the obtained distributions and the various values of k that were tested we choose to apply k 3 having in mind to filter the tails without removing too many data points and hence lose information the procedure of outliers detection is completed by scanning the whole range of rpm groups using a step of 1 rpm the final results of the cleaned data set with respect to one primary x axis propeller shaft s rpm and two secondary parameters y axis are illustrated in fig 5 an additional filtering criterion that was used at this stage is a cut off limit of 3 t 24hr and 3 knots for the me foc and stw respectively even though this is an explicit filtering criterion with no statistical reasoning behind it the reason for its adoption is that we do not wish to involve in our models the cases were ship movement is quite slow 4 3 data smoothing the third stage in the data pre processing is the smoothing of the data this stage is quite common among other similar works in the field e g hasselaar 2010 perera and mo 2016 senteris 2018 but we shall discuss it briefly here for sake of completeness the data smoothing is achieved by implementing a simple moving average sma algorithm the idea is to smooth the response of our signals in order to capture the important patterns in data while leaving out some noise or similarly in a more common machine learning terminology increase the signal over noise ratio the sma is an unweight mean of the previous n data points and since we have a constant sampling rate of 1 min this number n is defining our time window some factors that should be taken under consideration when deciding for the value of n are i the dynamics of the vessel for the problem under examination where the averaging time window should be short enough to capture environmental loading changes that result in changes to ship s condition but long enough to smoothen natural fluctuations hasselaar 2010 ii the application in which the data will be used in a performance analysis task we can afford to work with a relatively small but indicative data set because we only need to observe the trends in a deep learning model we benefit from a large number of data because they may include more noise but also carry more information which a complex model can extract iii the reduction of uncertainty in exchange for detailed information if the uncertainty of each measured value can be described by a standard deviation σ and n readings are taken the standard deviation over the n data points is reduced according to eq 2 2 σ x σ ν however we still do not know what the exact value of a proper time window is but we note that i the studied ship is a 200 m long containership which means that it has slow dynamics in the scale of minutes ii the data will be finally used for the training of a neural network we often see averages over 10 or 15 min time windows in the relevant literature e g senteris 2018 pedersen and larsen 2009 however we choose to average the data in 5 min time windows because the sampling frequency is high and thus preserve higher data resolution for the modelling and more data points for the training process an example of the averaged versus the original signal is demonstrated in fig 6 the signal in this figure contains a 5 h long sample of the ship s stw and the effect of smoothing while keeping enough details is obvious 4 4 data quality control the entire concept of data pre processing exists for the evaluation and the improvement of the information contained in the available dataset so as to coincide better with the reality that is faced by the ship however it is essential to pay attention to the effect that any filtering replacing or transforming algorithm acting upon the data may have on them the idea of careful data pre processing is also found in aldous 2015 and is summed up in the phrase the level of filtering is subjective and requires balance between removing inaccurate data points that will incorrectly skew the results and preserving valuable information about the system physics the term data quality here is used with the notion that differences in statistical parameters mean value standard deviation between the original dataset and the processed one declares poorer data quality in regard to the imputation algorithm the percentage of data points that are affected by the algorithm is estimated for two different subsets of the dataset the first subset contained 14 000 data points and the second contained 140 000 data points the algorithm was applied in these two subsets that differ by order of magnitude in order to investigate if the occurring frequencies of values replacement depend on the size of the dataset from the obtained results we can assume that the algorithm displays a quite robust behavior when scaling up since when applied to a ten times larger dataset it is affecting the same percentage of data points which is around 7 in average encouraging results are also acquired when we calculated the difference in the mean values between the original data set and the corrected one this difference is estimated as a percentage of the original dataset s mean value fig 7 demonstrates the differences in the mean value of every parameter in the dataset we notice that the mean values have only so slightly changed thus no concerns are raised regarding data distortion phenomena the largest difference of mean value is observed in the me foc signal but the 0 74 difference is considered rational since it was noticed to be a signal with extreme values on regular intervals the next algorithm that was applied on the dataset is the cleaning algorithm here a much simpler metric is used to check the rationality of the algorithm only the number of the deleted data points is calculated and presented as a percentage of the total number of data points that were examined in this case the mean values of the parameters before and after the cleaning process are not calculated firstly because a very small portion of the data is affected by the algorithm and secondly because extreme values are almost symmetrically rejected from the dataset at this point it is stated again that in the case of cleaning the entire row of data is dropped from the dataset if an outlier is detected on any parameter of a particular timestamp in contrast with the previous imputation algorithm that affects only the data point on the specific parameter that is being tested and does not affect the rest of the data at that timestamp see table 3 consequently on table 3 the percentages could be summed up to estimate the total percentage of data rows removed from the dataset 3 35 in this case the data pre processing procedure concludes with a last filter for sea current above 1 knot data rows where the absolute difference between the sog and the stw is above 1 knot are deleted this criterion is also included in iso 19030 iso 2016 and account for reducing the effect of sea current the number of data rows dropped from this filter is 11 23 other cases where the data are filtered for operational criteria i e limits on draft wind wave propeller revolutions are not considered to be part of the pre processing procedure 5 feature engineering a process of paramount importance in the data driven modeling is that of feature engineering that includes the feature generation and feature selection stages in this study an effort to approach more systematically the process of feature engineering is made feature generation is a basic part of this process a feature can be generated from an existing one by applying on it some mathematical operations or by combining it with another existing one in particular with the objective to develop one model for the estimation of shaft power and one for the me foc we choose to generate the following features wind effect by multiplying the wind s relative speed with the cosine of the wind s relative direction fouling by applying a logarithmic function to the values of the time elapsed from the first timestamp parameter features of standard deviation std of the initial parameters calculated for 5 min intervals sea current by subtracting the stw from sog draft tot by taking the mean value of draft aft and draft fore it should be mentioned that a feature could be generated just for providing a better insight on the problem or to assist in filtering the data and not necessarily to be included in the final model feature selection is the next step and refers to the process of choosing which features will finally be the inputs of our model in order to take such decisions the following considerations are made a does the feature provide any valuable information or it seems redundant with respect to the target variable b is it highly correlated to any other feature and provides the exact same information to the model c would the increase in the solution input space dimension benefit the model or it already seems too complex for the problem that is being addressed while considering the above it is important to keep in mind that thanks to the abstract inferring capabilities of the anns a feature does not have to be accurate in a physical and quantifying sense in order to be a good predictor and contribute to the model s performance however when the general and qualitative discussion is completed metrics and statistics about the data should be calculated and evaluate the features based on these results as well this quantitative part of feature selection is presented in karagiannidis 2019 the idea of course is to select features that not only statistically correlate with the output variable but have a known physical causal relationship as well for instance high values of rudder s angle may increase the ship s hydrodynamic drag significantly the optimum selection of features for a ship propulsion model remains an open problem in the literature but in our case for the models in this study the features parameters of table 4 were used as input table 4 shows also the output parameter of each model 6 ann model production comprehending properly the anns architecture and parameters influence on the possible outcome is of great importance for building functional and well performing models we attempt to shed light on the key factors that fine tune an ann model however it is not only the capabilities of the model that influence the final accuracy but the quality of the training data set as well this argument is supported in the present section where the results from testing ann models are presented in increasing pre processing complexity order quantitative evidence is provided for the significance and effectiveness of the data pre processing and feature engineering procedures that were implemented in previous stages of this work 6 1 parameters selection training results and optimization in order to produce high accuracy models every step of the process is meticulously investigated having completed the pre processing and feature engineering stages we proceed to define the training process of the ann models when we refer to the training process we mean a set of specific steps that are implemented in the following order a shuffling the data set b splitting the data set into the training set and the validation set as common practice we use 80 20 split and 70 20 10 when test set is required c normalizing the arithmetic elements of our data using z score normalization zero mean and unit variance d train a typical feed forward neural network fnn in our case training the fnn requires the parameters presented in table 5 to be defined every one of the aforementioned steps plays a crucial role in the performance and robustness of the model the goal is to minimize the error function of course but this does not mean that a model with poor generalization capabilities and over fitted to the training data is desired even if it brings the training error down to almost zero for this reason we will discuss briefly the importance and the benefits of each and every one of these steps that we implement before the training procedure shuffling the data is crucial in order to avoid biased learning of the model if we consider all the measured parameters in the ship dataset to be random variables we may confidently assume that not all are static consequently data collected later on time carry new information based on actual changes in our physical system if the data are not shuffled the model will be trained on hull conditions that describe a certain time window of the ship s operation and examples related with the later behavior of the system will be ignored by the model the split of the data by convention among machine learning practitioners varies between 70 30 and 90 10 as training validation set the most influential factor in the determination of the split percentages is the dataset s size in large datasets the validation or the test set can be a smaller percentage of the whole since it is still quite large in absolute number data normalization is a standard procedure for most cases for regression models and arithmetic data and should not be skipped it is easier to conceptualize its importance in a two dimensional curve fitting example suppose a set of data points located distantly from the axes origin of our 2 d plane and an estimation of the slope α and intercept β of a line that fits the data and results to the least square error a small perturbation in the value of α is shifted to larger displacements of the line s position in points more distant regarding the axes origin and therefor erratic behavior of the error function setting the models parameters is a demanding procedure since on one hand there are not any straight forward technics to guide us through and on the other hand brute force search for optimum values is inefficient one should take under consideration a lot of theoretical background knowledge mainly related with the anns architecture and mechanism but this is not enough the reason is that selecting a relatively efficient number of layers and units or a well suited activation functions is plausible with some experience and following basic rules of thumb offered in the machine learning literature i e bishop 2006 haykin 2009 raschka 2015 however fine tuning the model and being confident that we are verging to the global minimum of the error function is far more difficult the strategy followed in this study can be summarized in the following propositions add layers until the error stabilizes then add one more and if there is not improvement keep the least number of layers that achieves this performance similarly add units to each layer until the error stabilizes then add even more and if there is not improvement keep the least number of layers that achieves this performance experiment with fundamentally different types of activation functions detect the most suitable family of activation functions i e tanh and sigmoid behave similarly and test a subset of them to ensure that they do not induce deviations in the model s performance solid understanding of the training process and the available optimizing algorithms may assist significantly in the direct selection of the proper optimizer ruder 2017 in this study adam adaptive momentum estimation is found to be the most effective optimization algorithm with the default hyper parameter tuning by keras chollet 2015 it follows the principals of error backpropagation and gradient decent optimization but has certain enhancements related to the adjustment of the momentum term which can be found in detail at kingma and bo 2015 the batch size is the number of training samples that are forward propagated through the network before re adjusting the weights if the batch size is set equal to 1 then we have a sequential model and weights are adjusted for the error estimated on each sample point if the batch size is set equal to the total number of training samples then we have a batch method and the weights are adjusted only once in every epoch other cases of intermediate batch size are mini batch methods we decided to couple the selection of batch size number with the number of epochs the number of epochs is selected in relation to the batch size increasing the number of epochs means increasing the number of times that the whole training set is propagated through the model but the batch size determines the number of weight updates that occur in each epoch we consider the total number of weight updates to be the effective degree of the model s training for instance if the number of epochs is constant doubling the batch size leads to the half weight updates and this is proportional to the computational time required for the model s training fewer weight updates lead to faster training but a larger batch size means less focus on the fitting of each individual data point and vice versa finally it should be noted that a large number of epochs is usually responsible for over fitting the model while a large batch size can assist the model to fit better on noisy data the error function in regression models is commonly selected to be the root mean square error rmse function and this is also our selection in table 6 we present the results of an extended training and testing procedure τhe data set column has the labels of differently processed datasets in an ascending order of pre processing degree the raw data are completely unprocessed and have only been synchronized into per one minute timestamps all the datasets originate from the raw data and are further processed the smoothed s dataset is produced by averaging the raw data in 5 min time windows the smoothed corrected scor dataset is averaged in the same way and preprocessed by the imputation algorithm presented previously the smoothed cleaned scl dataset is averaged in the same way and preprocessed by the outlier detection algorithm presented previously the smoothed corrected cleaned scc dataset is averaged in the same way and preprocessed by both the previous algorithms the scc k folds is just the scc dataset in which the k fold technic for cross validation of the generated models has been applied the scc atlantic trips originates from the scc dataset but includes only the data points that were collected while crossing the atlantic ocean the scc fouling is the scc dataset without the fouling feature the other columns in table 6 and figs 8 and 9 present error metrics for the target of the models as mentioned previously model 1 is feature engineered and trained to estimate the me foc and model 2 to estimate the propeller s shaft power the rmse column is the root mean squared error between the model s estimations and the target values of the validation set if y i is the target value and y i ˆ is the estimated we calculate the rmse as 3 r m s e r r o r i 1 n y i ˆ y i 2 n the r2 value is the linear correlation coefficient among the estimated values and the targets values the accuracy with respect to w r t the mean is defined as 4 m v s r m s e m v s 100 where m v s is the mean value of the target variable at the validation set the relative error pedersen and larsen 2009 is calculated as 5 r e l a t i v e e r r o r 1 n i 1 n y i ˆ y i y i 100 all the models share the same number of hidden layers and hidden units the same activation functions batch size epochs and the same error function as defined earlier in this sub section this is done in order to benchmark the pre processing algorithms that were used for replacing or cleaning the data and to observe the effect of some features on the model s performance the results presented in table 6 and in figs 8 and 9 are the average values of five training testing procedures in order to reduce the randomness on the attained error metric value the values of the error metrics support the positive effect of the imputation and cleaning algorithms in both target cases the rmse is drastically reduced when we use the smoothed data set and it keeps shrinking when the data have been replaced or cleaned accuracy improves from 92 to almost 98 when in the case of me foc model and from 96 to 98 5 in the case of shaft power the optimum results are obtained when k fold cross validation technic is applied and that was expected since it is a common technic in machine learning applications furthermore in the scenario where data points only from atlantic ocean sailing are included in the dataset the errors are even smaller because the modeled phenomena are in a much steadier state and effects such that of shallow or confined waters are absent also transient engine operation is much more frequent during coastal navigation rather than during atlantic ocean sailing and so intense nonlinearities from the engine s signals are absent as well finally a test for the effect of the fouling feature that was generated from the dataset s temporal information is implemented we see that the errors are increasing when the fouling feature is omitted from the input data set and that gives us confident to utilize this generated feature in future applications 7 applications 7 1 operational scenarios testing with fuel oil consumption model in this section an application that aims to predict the actual me foc over a ship s voyage is presented given that all the values for the input parameters table 4 of the model are known our model estimates the total mass of consumed fuel with accuracy above 98 5 from the available dataset of the examined ship only the data points that were collected during the crossings of the atlantic ocean shall be utilized a typical ship route is shown in fig 10 in a period of 12 months we detect 12 crosses of the atlantic and we split them to 8 trips as training set 2 trips as validation set and 2 trips as test set we need a validation set because the k folds technic is used for improved model performance also at this stage we introduce the ensembles technic which is the training of multiple identical i e having the same architecture models on the exact same data in order to average the outputs of all these models which vary due to the stochastic character of the training process and use this value as the final estimation hence when we refer to the model s estimation we mean the average value of the ten models outputs the model provides the instantaneous value of the fuel oil consumption output and the total consumed mass of the fuel is derived by integration for each estimation the 99 confidence interval is calculated to quantify the uncertainty in the model the results from the test set s estimations and errors are presented in table 7 and in figs 11 and 12 the y axis scale in fig 11 is not allowing us to display the confidence intervals around the estimation curve for this reason in fig 13 a shorter time window from the test set is presented in general it was noticed that for low values of the me foc the uncertainty in the model increases because there are few training data on this range but in overall it behaves quite robustly that explains why in fig 12 the highest model errors appear on the 11th day where me foc gets the lowest values encountered in the voyage the expected error related to the estimated value of the total me foc in table 7 is 4 4 tons it is calculated by propagating the standard error of each estimated value we see that the actual value of the total me foc lies well within the anticipated interval it shall be also mentioned that the total me foc is calculated under the assumptions presented previously and corresponds to the available and pre processed data sets an alternative way to exploit this model is to create scenarios of reduced or increased average stw during an identical voyage where the loading and weather conditions are considered the same as previously the model s output me foc can be used to estimate the difference in the total fuel consumption also the added voyage duration can be calculated for the needs of this sensitivity study directly by the stw variation the scenarios that were tested are listed in table 8 along with their expected errors for the total me foc in fig 14 the results of table 8 are interpreted and presented in terms of relative difference of consumed fuel and voyage duration using as baseline scenario that of the 17 68 knots finally the error distribution of the model is plotted in fig 15 the graph on the left side demonstrates the distribution of the model s absolute value of error which is calculated as y i ˆ y i where y i is the target measured value and y i ˆ is the model s estimation the graph on the right side demonstrates the distribution of the model error which is calculated as y i ˆ y i a slight left skew on the error s distribution is noticed which may imply a bias in the model due to the influence of an unobserved factor i e swell currents ambient or sea temperature however considering further the statistics of the below distributions see table 9 we may state that such bias is of insignificant influence to the predicting capabilities of the model due to its relative magnitude i e mean error value 0 23 t 24hr corresponding to mean foc value of 51 78 t 24hr 7 2 average speed loss estimation this section presents an application that aims to highlight an alternative approach to the standard iso 19030 processes for estimating a ship s average speed loss the analysis is focused on the filtering process and on the calculation of the expected speeds from the available data points the iso procedure for normalization is compared to an innovative way of normalizing the data through a machine learning model the basic idea in iso 19030 lies on the calculation of a performance indicator e g speed loss over a specific time window which is based on the average value of the respective performance value at each data point the performance value is defined as the difference between the expected value of the parameter e g ship s speed and the measured one at the same shaft power in order this comparison to be meaningful the same reference conditions shall apply and usually speed power curves from sea trials are used however in order to achieve these reference conditions specific filtering and corrections are needed for eliminating either the effect of external parameters e g weather or for the comparison of values at the same draft and trim furthermore it is suggested to filter out the outliers prior the normalization of the data points the proposed methodology for outlier detection by iso 19030 is based on the chauvenet s criterion described by eq 6 6 n e r f c x i μ σ 1 2 where n μ σ and x i are the number of data points in the set the mean value the standard deviation and the suspect data point respectively while erfc is the complementary error function according to this criterion when the expected number of measurements at least as bad as the suspect measurement is less than 1 2 then the suspect measurement x i should be rejected however there are two assumptions in the chauvenet s criterion that should be discussed i the probability distribution of the data points is given by the complementary error function this assumption actually implies that the error of the collected data points is normally distributed in any case ii a frequentist notion of probability is clearly assumed on the check for the outlier that notion requires a satisfactory large amount of data in order to provide a legit probability value and then judge upon it the fact that these two assumptions cannot be always realistically fulfilled is the first reason why we attempt to come up with an alternative approach which is presented as the cleaning algorithm for statistical detection of outliers on ships data the other reason is that we wanted to avoid applying a generic statistical or machine learning method for outlier detection according to iso 19030 in the data filtering and validation phase for consecutive non overlapping blocks spanning 10 min data for every parameter shall be filtered according to chauvenet s criterion a data block contains by definition a maximum of 40 measurements sampling period 15 s for each parameter however in practice rarely the storing frequencies of sensors are set so high as to produce datasets complying with this requirement if the 10 min period is extended the assumption of steady environmental and operational conditions is less supported for example if we have four recordings of the ship s speed in a 5 min time window it makes no sense to apply the chauvenet s criterion in order to identify at least one of these four data points as an outlier if we choose a larger time window i e 30 minute so that a sufficiently large number of speed recordings will be available the probability of an increase or decrease in the speed due to changes in the environmental conditions is quite high once again outliers cannot be properly detected since the same value of speed may be an actual outlier if it occurred later in the time window when the ship s state was different rather than earlier table 10 presents the filtering requirements according to iso 19030 and compares them with the case that an ann model is to be used for the normalization of the data the main difference among these two methods is that iso 19030 requires filtering for calm sea conditions true wind speed 7 9 m s and the same loading condition when an ann model is utilized to estimate the ship s stw model output for any loading and weather conditions model inputs we can keep in the dataset a large number of data points that otherwise would be rejected we still have to filter for large rudder angles and strong sea currents because in these cases the physic of the problem differs fundamentally e g completely different flow of the water around the hull the standard deviation of the stw std stw is added in the filtering procedure because we wish to reject data points from transient or high uncertainty moments also the propeller shaft power is required to be more than 9 000 kw only because the available sea trials are for a power range over this value finally by constraining the longitude coordinate s value we filter for transatlantic trips only because there are no available data for water depth and temperatures coastal sailing data points will definitely include cases of shallow or confined water sailing and maneuvering close to ports and transient operations after the filtering of the data the normalization procedure allows us to make possible the direct comparison of measured data points to the expected ones in the reference condition reference condition could be any loading condition of the ship for which we have the speed power curve in clean hull and calm weather conditions and hence the expected values of speed stw for a particular value of power the analysis could refer to a reference period which could be a 6 month period of data collection before and after a hull cleaning by subtracting from the expected stw values the normalized measured values of stw for the same engine power we get an indication of the ship s performance in the form of a speed loss see eq 7 7 v d 100 v e v m v e where v e is the expected value of stw in reference condition and v m is the measured one if v m is not measured in the exact same displacement as the one of the reference conditions it should be normalized according to eq 8 8 v 2 v 1 δ 1 2 3 δ 2 2 3 1 3 where v 2 is the speed at reference condition displacement δ 2 v 1 is the speed at measured displacement δ 1 after the calculation of the v d values for all the available data points n we take their mean and this result to the average speed loss v d eq 9 9 v d 1 n i n v d i in fig 16 we have estimated the average speed loss asl with both methods the blue dots upper group of points are calculated through the iso 19030 normalization formula eq 8 while the green dots lower group are obtained by normalizing the speed values with the ann model obviously in the case of the ann we have much more available data points to support our estimation because the filtering procedure is not so strict also both methods result to a similar value for the average speed loss but the ann method trends in the expected way increasing speed loss over time while the iso 19030 method estimates a decreasing speed loss over time we believe that this happens mainly due to the limited number of data points involved in the estimation of the average speed loss the average speed loss value estimated from the ann model is 5 12 and from the iso 19030 is 5 99 while the available data points after filtering are about 22 000 and 2 500 respectively of course the uncertainty level that accompanies each value is different due to different size of the datasets 8 discussion on the level of accuracy achieved in data driven models so far comparison among the various studies on the field is not always achieved in a straight forward way that is mainly due to the lack of standardization in error metrics that are adopted i e absolute error percentage error or normalized error etc by researchers furthermore we should note that different datasets offer different constrains and opportunities in the modelling process and normally are not of the same quality different noise levels or availability of parameters despite the aforementioned we shall compare the achieved accuracy of our fnn models to other similar works in the field the most relevant comparison of results is among studies that built ann models using high frequency data to predict foc like pedersen and larsen 2009 that reported an average model error 1 83 beşikçi et al 2016 that achieved rms error 0 193 t hr or more recently gkerekos et al 2019 reported 89 5 in terms of explained variance 1 4 t 24hr mean average error alternatively on shaft power estimation senteris et al 2019 reported normalized rms error equal to 2 74e 04 and petersen et al 2012b achieved an rms error of 0 32 knots in the speed estimation finally we shall present indicative results from studies that utilize other machine learning methods to model the ship propulsion leifsson et al 2008 using a combination of data driven and physical models gray box models achieve rms error equal to 0 65 knots on the speed estimation and 60 l hr on the foc petersen et al 2012b developed models using gaussian process and achieved rms error of 0 63 knots on the speed estimation and 44 2 l hr on the foc soner et al 2018 with lasso regression achieved rms error of 0 45 knots on the speed estimation and 44 6 l hr on the foc last but not least coraddu et al 2019b utilized random forest technic and a systematic feature selection process to develop gray box models that achieved error of 0 83 on foc and 0 79 on shaft power estimation 9 concluding remarks we investigate the margins of improvement in the data driven ship propulsion models also known as black box models for the scopes of performance monitoring and analysis the models trained were multi layer artificial neural networks anns and therefore two important stages in this modeling procedure were the data pre processing stage and the neural network s parameters and optimizer selection stage these stages were investigated thoroughly and proved to be able to contribute remarkably to the high accuracy that was achieved by the models two models were developed targeting me foc and shaft power respectively more specifically in the pre processing stage two algorithms for replacing and cleaning the data were proposed when applied to the available dataset they increased the accuracy of the produced models by approximately 1 5 however the initial accuracy of the ann models was quite high from 93 to 95 depending on the targeted parameter fuel oil consumption or shaft power this high initial accuracy was achieved due to the larger number of hidden units that were used in our networks and the recently developed optimizer adam here we would like to mention that a point of further examination about the feature s selection could be the inclusion of a criterion related with their practicality in a fleet optimization model in that case a trade off between model s accuracy and model s practicality shall be needed finally we implemented the average speed loss estimation according to iso 19030 procedure and then attempted to alter the filtering and normalization process by utilizing a neural network model that could predict the expected ship s speed based on the shaft power value the aim is to maintain a larger data set as less filtering is needed and therefore the derived average speed loss and trend in time entail less uncertainty the results were quite rational and encouraging for further investigation of this method credit authorship contribution statement pavlos karagiannidis conceptualization software formal analysis data curation writing original draft visualization nikos themelis conceptualization methodology investigation writing original draft writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank prisma electronics for proving the dataset acquired by the laros platform 
21076,data driven models for ship propulsion are presented while the effect of data pre processing techniques is extensively examined in this study a large automatically collected with high sampling frequency data set is exploited for training models that estimate the required shaft power or main engine fuel consumption of a container ship sailing under arbitrary conditions emphasis is given to the statistical evaluation and pre processing of the data and two algorithms are presented for this scope additionally state of the art techniques for training and optimizing feed forward neural networks fnns are applied the results indicate that with a delicate filtering and preparation stage it is possible to significantly increase the model s accuracy therefore increase the prediction ability and awareness regarding the ship s hull and propeller actual condition furthermore such models could be employed in studies targeting at the improvement of ship s operational energy efficiency keywords performance monitoring artificial neural network data processing propulsion modeling predictive analytics 1 introduction the shipping industry nowadays is under heavy obligations for more efficient and environmental friendly ships and maritime operations even though the green house gas ghg emissions from ships are less than 3 of the global ghg emissions smith et al 2014 and while they transfer more than 90 of the goods imo has set goals for reducing them imo 2018 these goals are coming on the wake of the global scale efforts against climate change that initiated for the first time a few years ago and are bringing new legislations and requirements on one hand reducing ship emissions can have multiple benefits for ship owners and ship managers it would be simpler for them to comply with the increasing regulatory requirements and survive through possible downturns of the markets on the other hand achieving improvements in the vessels energy efficiency is a big challenge as mentioned by imo s 2018 initial strategy on the reduction of ghg emissions from ships operational measures appeared as one of the prominent short term measures to achieve them they require minimum capital expenditures in comparison to other measures and can be immediately implemented to almost every type of vessel however in order to successfully implement these measures it is crucial to have a robust performance monitoring system that is based on real time high frequency data and state of the art models the developments in different fields of technology have made feasible the continuous monitoring of ships and the collection of huge amount of operational data that carry valuable information if properly exploited more specifically it is the convergence of i technologies in the field of the electronics and sensors ii the global satellite internet connection capacity and iii the machine learning ml methods which produce models with superior predictive capabilities thereby the reasoning and purpose of this study may be summarized as follows the capability to produce highly accurate ship propulsion models through improved methods and practices of data manipulation will enable the thorough and effective monitoring of ship performance and provide support for the investigation of operational measures that could lead to an improvement of operational energy efficiency such models can considerably boost the effectiveness of applications like speed and route optimization and weather routing an overview of the proposed procedure for propulsion modeling is presented in fig 1 starting from the installed systems and sensors on the ship the recorded data are collected formatted and synchronized before stored on a server onboard and sent via satellite internet on shore firstly a brief description of the parameters targeted for data acquisition is provided then follows the data preparation stage where the retrieved data should be validated and statistically processed before further exploited in order to ensure a quality data set the next step concerns the modeling stage and specifically the generation and selection of the best suited combination of parameters feature engineering for building each ml model finally the data are used to train artificial neural network ann models whose architecture and parameters have been carefully selected application wise in the current study we are going to analyze the data preparation and modeling stages of the framework shown in fig 1 2 literature review nowadays there is an increasing trend for utilizing data driven models due to the availability in a cost effective way of a vast amount of operational data as well as due to the need to increase the level of accuracy achieved by the empirical models while avoiding the computational cost required when employing computational fluid dynamics cfd simulations the basic idea behind these models is to exploit the data collected from a particular ship s operation and use them to create a statistical model that could estimate its powering needs or forecast its consumption and monitor its performance indicative papers that are applying this type of propulsion modeling are presented below in petersen et al 2012a a publicly available dataset collected from the onboard sensors of a ferry over a period of two months is used for the training of two types of neural network models an instantaneous and a predictive model the instantaneous is a typical feed forward neural network that estimates an output yn e g the main engine s fuel consumption based on the current input vector xn and hence omitting the temporal character of the propulsion parameters the predictive is a tdnn tap delayed neural network a type of recurrent neural network that takes as input x n all the available propulsion parameters defined as state control and constant vectors and estimates the difference in the target variable at the next time step x n 1 also the predictive model s residual error in the training set is used to fit a probability distribution that will be added to the model s final predictions as noise the achieved accuracy for the instantaneous model is given as mean relative error of 1 50 on the fuel oil consumption foc estimation while their tdnn model had no comparable metric estimated in this study in pedersen and larsen 2009 the propulsion power of an 110 000 dwt tanker is predicted again with anns for the data pre processing the ship s heading is used to filter the data since it was noticed that when it is fluctuating there is significant influence on the measured propulsion power the results from the ann models demonstrate a mean relative error in the estimation of propulsion power ranging from 0 82 to 2 69 while same predictions using empirical methods are found to be ten times less accurate brandsaeter and vanem 2018 applied regression models to predict ship s speed using a set of 18 vessel parameters collected from high frequency sensors but over a limited time period of about 3 months data filtering and pre processing are not examined in detail because focus is given on modelling technics like k folds cross validation and ensembles methods optimum results are obtained when larger portion of the data is utilized for the models training and the baseline method for predicting speed using the admiralty s formula is outperformed statistically but not in the whole range of speeds perera and mo 2016 proposed a procedure based on machine learning methods for handling the big data generated on board it includes three steps sensor faults detection data classification and data compression particularly principal components analysis and gaussian mixture models are exploited to filter the data points and cluster them respectively outcome of this procedure is a prepared dataset that is compressed on board and expanded on shore using again the pca structure discussed further in perera and mo 2018 as the data compression and expansion functions of an autoencoder they demonstrated that information can be compressed and preserved effectively with their methodology but no further quantitative metrics are offered ahlgren and thern 2018 relied on an automated process of machine learning in order to generate models that predict ship fuel consumption without human intervention in the model parameter selection even though they recognized the significance of the pre processing stage they attempted to validate only fuel consumption data their best performing model achieved accuracy similar to this of the previous researchers 4 8e 4 mean squared error in normalized model output but the number of features used as inputs was quite limited at max 4 inputs another recent work that developed ship propulsion models based on high frequency sensory data is that of soner et al 2018 they utilized the same data set as petersen et al 2012b and reported similar accuracy root mean square error of 0 45 knots in the speed and 44 6 l hr in the foc estimation for their models however the argument that favors their modeling technic which is based on shrinkage models such as ridge and lasso is that they are not using a black box method and therefore their model and results are easier interpretable the same conclusion is reached by wang et al 2018 where a lasso regression was used to model the foc of containerships from a dataset that included 97 vessels results from lasso models compared to other typical ml methods models and demonstrated more than 3 folds improvement in the accuracy of predictions gkerekos et al 2019 developed a pipeline for producing data driven models in a 3 step process which includes the pre processing of the data the training of various types of regression models and the selection of the one that performs best on the test set the extra trees regressors achieved the highest accuracy among all models r2 98 followed by anns and random forest regressors another recent effort to utilize high frequency sensory data along with weather hindcast information and ml methods is presented in farag and ölçer 2020 an ann and a multi regression model are combined to predict a vlcc tanker s break power and break specific fuel oil consumption successively even though their data set is limited 1 voyage trainset 1 voyage test same loading condition the demonstrated applications achieve high accuracy 99 6 and provide quantifiable saving in terms of fuel consumption and co2 emissions but only if certain assumptions can be met for a just in time port arrival scenario also model s high accuracy comes at the cost of generalization since it is not tested over varying loading conditions or heavy weather i e north atlantic passage gkerekos and lazakis 2020 combined an ann foc prediction model with a weather routing algorithm in order to maximize the effectiveness of the later as a decision support tool an automated data logging monitoring adlm system provides the required ship data that should be merged with hindcast data from cmems 1 1 copernicus marine environment monitoring service anomalies in the ship dataset are filtered out by applying the central limit theorem in each parameter and adopting a cut off value of 3σ finally a deep neural network trained on the aforementioned data is used in conjunction with the weather routing algorithm and an optimal route is estimated while good agreement among predicted and measured values is achieved coraddu et al 2017 tested three different modelling approaches white box or else physical gray box or else hybrid and black box models and shown that gray box models can actually breed the best of the two worlds white and black box models they achieve the same high accuracy of black box models with less historical data due to the transferred knowledge from the white box models also feature selection is addressed very systematically with random forest feature testing and the results indicate that it is a robust procedure that could be followed in other studies as well an alternative approach on the characterization of hull and propeller condition comes in another study from coraddu et al 2019a where a blend of auto logged and ais data from a research vessel train two anomaly detection models support vector machines and k nearest neighbors learn to classify the vessel s hull and propeller condition as clean or fouled also the feature selection process is validated through brute force checking of each input parameter s importance the results encourage authors to suggest the adoption of their method for real time fouling detection or for energy saving technologies evaluation finally in coraddu et al 2019b a large dataset obtained from on board sensors of two handymax chemical product tankers are utilized to develop the ships digital twin with neural networks with the goal to estimate speed loss due to marine fouling they propose a model based method that is compared to iso 19030 standard approach and outperforms it and thus allowing for more accurate and timely detection of hull fouling the efforts in the data driven modeling of the ship s propulsion however are not limited in the field of neural networks aldous 2015 provided an extended treatment of ship performance analysis it is a study with a more systematic approach on the subject of data uncertainty and pre processing which are crucial elements of the data driven modeling procedure that were not treated so meticulously in the previous studies data from noon reports nr are compared to continuous monitoring cm data and the main disadvantages of the first are found to be a the lack of standardization b the missing observations and inaccuracies and c the inherent characteristic of expressing the ship s performance in terms of foc only and not in the more appropriate term of shaft power one of the concluding arguments is that cm datasets decrease the uncertainty of the collected data and hence of the produced models that are used to evaluate vessel s performance this argument is found to be supported in other works too such as in themelis et al 2018 where the focus is given to the comparison of the prediction capabilities of nr and cm datasets 3 data acquisition for the present study a large set of data acquired from the operation of a container ship was made available utilizing a continuous monitoring system see themelis et al 2019 and karagiannidis et al 2019 for details about the data acquisition system used the ship s main characteristics are presented in table 1 it is crucial to recognize at this stage the influence of the type of the data collection equipment as well as other parameters of the process such as the sampling frequency to the ultimate accuracy of any ship performance model see for example aldous et al 2015 the aforementioned container ship was equipped with sensors that were monitoring the propulsion parameters of interest as well as the loading condition of the ship and the relative wind speed and direction all the available parameters from the ship s operation are presented in table 2 along with the dedicated measuring device these parameters were constantly sampled during the ship s operation with a period of 1 min all the data were synchronized in common timestamps data collected over a period of almost 19 months 2 2 the recordings cover 69 52 531 560 values in 764 637 min period of the total time which can be considered as the time that the ship spent sailing and so the port time was about 30 4 data pre processing even though acquiring a set of data from the operation of a ship is a meaningful endeavor from scientific technological and business perspective the real value of these data will not arise without an effective pre processing the reason is that the collected dataset should prove to be a reliable and well aligned realistic approximation of the occurring situations that a ship is facing the first plausible step would be to inspect visually the collected data since this is a common quality control measure in many engineering activities however due to the fact that large datasets shall be examined we need more efficient and automated methods to identify and clean the dataset from anomalies and outliers and hence improve their intrinsic information nevertheless the issue of data pre processing is quite vague as several methods and techniques exist in the following sub sections we present a 3 step method for pre processing a data set 4 1 imputation algorithm an algorithm is developed for spotting and replacing suspicious measurements on time dependent data that are related to some kinds of physical phenomena it is intended to make modest adjustments on time series data like a liquid s flow rate the revolutions of an engine s shaft or the angular position of a rudder the basic idea behind this algorithm is that physical objects always display inertial behavior in the sense that during an adequately short time window in future their past value or state is not expected to change drastically we present this data imputation algorithm firstly through a real life example and then describe its theoretical structure in the examined data set the most profound case of such suspected measurements existence is spotted on the latitude parameter of the gps signal this parameter along with the longitude define the ship s position in fig 2 the samples of the latitude coordinate that correspond to a 6 month period excluding idle periods are plotted on the left graph the points that break the continuity of the ship s path are the ones that we visually identify as outliers and would like to replace their values in fig 3 left graph the latitude and longitude signals are plotted on a map projection and it becomes clear that these points cannot be accurate measurements that describe the path of the vessel they seem to form a pattern similar to the vessel s original path this is a fact that declares some kind of drifting in the recording or transmission of the gps signal on frequent intervals in fig 2 right graph the processed latitude signal is plotted as time series and in fig 3 right graph the processed ship s path is projected on the map no more points seem to break the continuity of the ship s path now and the whole amount of information regarding ship s position seems to be preserved in order to characterize a datum of the latitude coordinate signal as an outlier and replace it we should consider the dynamics of the ship s movement through sea the latitude can be thought as the y coordinate of the ship s position in a cartesian plane in this case speed over ground and the derivative of the ship s heading are the parameters that determine the rate of change of the ship s coordinates if the speed and heading are constant the rate of change is constant and for constant sampling rate the absolute difference distance of consecutive latitude and longitude data points is also constant when real ship data are processed we cannot expect to encounter absolutely steady conditions however any acceleration or deceleration that occurs to the ship is not expected to cause a displacement significantly larger e g 2 3 times larger than the previously observed that is due to the magnitude of a large ship s inertia and on condition that the sampling frequency is efficiently high in comparison with the dynamics of the observed phenomena if we express it in calculus terms the time derivative of the signal should not be able to rise to an arbitrarily high value the above idea takes the form of an algorithm that examines if a data point is diverging excessively spikes from the neighboring data points and replaces it by setting its value equal to the mean value of the previous and the next data point it is the algorithm that processes the latitude signal of fig 2 resulting to the signal of the right graph image 1 in step iii t l i m is a user defined parameter that can force the algorithm to skip checking the current data point it defines the maximum time gap between two measurements that permits the algorithm to check if a data point should be replaced in step iv s f is a scaling factor whose value is defined by the user based on his understanding of the natural quantity s dynamic behavior and maybe some experimentation for the implementation of the algorithm in this study the t l i m value was set to 3 min and the sf had several different values depending on the parameter that was processed each time the algorithm may be applied once more on the same data points but this time checking among the i 2 th and i 2 th elements instead of the i 1 th and i 1 th this is suggested because it was noticed that after the first implementation of the algorithm some outliers remained in the data set that happened because some outlying points may appear consecutively in this case the i 1 th element is an outlier itself and the algorithm does not identify the i th element as an outlier by pursuing one time step further and involving the i 2 th and i 2 th elements we manage to drastically reduce the probability of misinterpreting a data point if we consider the outliers to be independent and identically distributed the probability of having three consecutive outliers is the cube of the probability of having a single outlier which is by definition much less than 1 hence the value of this probability is really small 4 2 outliers identification the second stage of the data pre processing aims to identify outliers with an alternative approach which does not consider the dataset s temporal information at all the focus is given on the statistical behavior of certain interconnected parameters thus as an outlier we characterize a data point whose distance from the mean value of the measurements in that area is above a predefined threshold defined as k σ where the factor k is a multiplier of the parameters standard deviation σ more specifically the algorithmic procedure that is followed for detecting outliers is given below image 2 we choose not to replace the identified outliers but to remove them from the data set provided the high frequency sampling rate we could afford this choice from a statistical point of view as the remaining data still provide statistically reliable information in the case noon report data were used one shall proceed with data imputation as the loss of data could not be affordable in fig 4 the histograms for a group bin of data points with rpm 92 93 are presented with the x axis being the propeller s shaft torque value left graph and the main engines fuel oil consumption me foc right graph the outlier threshold is marked with the colored dot lines for the different values of the factor k the data group in the rpm range 92 93 includes around 14 000 observations in both cases the distribution s shape seems similar and close to a normal distribution but it is slightly asymmetric for the setting of the outlier threshold based on the obtained distributions and the various values of k that were tested we choose to apply k 3 having in mind to filter the tails without removing too many data points and hence lose information the procedure of outliers detection is completed by scanning the whole range of rpm groups using a step of 1 rpm the final results of the cleaned data set with respect to one primary x axis propeller shaft s rpm and two secondary parameters y axis are illustrated in fig 5 an additional filtering criterion that was used at this stage is a cut off limit of 3 t 24hr and 3 knots for the me foc and stw respectively even though this is an explicit filtering criterion with no statistical reasoning behind it the reason for its adoption is that we do not wish to involve in our models the cases were ship movement is quite slow 4 3 data smoothing the third stage in the data pre processing is the smoothing of the data this stage is quite common among other similar works in the field e g hasselaar 2010 perera and mo 2016 senteris 2018 but we shall discuss it briefly here for sake of completeness the data smoothing is achieved by implementing a simple moving average sma algorithm the idea is to smooth the response of our signals in order to capture the important patterns in data while leaving out some noise or similarly in a more common machine learning terminology increase the signal over noise ratio the sma is an unweight mean of the previous n data points and since we have a constant sampling rate of 1 min this number n is defining our time window some factors that should be taken under consideration when deciding for the value of n are i the dynamics of the vessel for the problem under examination where the averaging time window should be short enough to capture environmental loading changes that result in changes to ship s condition but long enough to smoothen natural fluctuations hasselaar 2010 ii the application in which the data will be used in a performance analysis task we can afford to work with a relatively small but indicative data set because we only need to observe the trends in a deep learning model we benefit from a large number of data because they may include more noise but also carry more information which a complex model can extract iii the reduction of uncertainty in exchange for detailed information if the uncertainty of each measured value can be described by a standard deviation σ and n readings are taken the standard deviation over the n data points is reduced according to eq 2 2 σ x σ ν however we still do not know what the exact value of a proper time window is but we note that i the studied ship is a 200 m long containership which means that it has slow dynamics in the scale of minutes ii the data will be finally used for the training of a neural network we often see averages over 10 or 15 min time windows in the relevant literature e g senteris 2018 pedersen and larsen 2009 however we choose to average the data in 5 min time windows because the sampling frequency is high and thus preserve higher data resolution for the modelling and more data points for the training process an example of the averaged versus the original signal is demonstrated in fig 6 the signal in this figure contains a 5 h long sample of the ship s stw and the effect of smoothing while keeping enough details is obvious 4 4 data quality control the entire concept of data pre processing exists for the evaluation and the improvement of the information contained in the available dataset so as to coincide better with the reality that is faced by the ship however it is essential to pay attention to the effect that any filtering replacing or transforming algorithm acting upon the data may have on them the idea of careful data pre processing is also found in aldous 2015 and is summed up in the phrase the level of filtering is subjective and requires balance between removing inaccurate data points that will incorrectly skew the results and preserving valuable information about the system physics the term data quality here is used with the notion that differences in statistical parameters mean value standard deviation between the original dataset and the processed one declares poorer data quality in regard to the imputation algorithm the percentage of data points that are affected by the algorithm is estimated for two different subsets of the dataset the first subset contained 14 000 data points and the second contained 140 000 data points the algorithm was applied in these two subsets that differ by order of magnitude in order to investigate if the occurring frequencies of values replacement depend on the size of the dataset from the obtained results we can assume that the algorithm displays a quite robust behavior when scaling up since when applied to a ten times larger dataset it is affecting the same percentage of data points which is around 7 in average encouraging results are also acquired when we calculated the difference in the mean values between the original data set and the corrected one this difference is estimated as a percentage of the original dataset s mean value fig 7 demonstrates the differences in the mean value of every parameter in the dataset we notice that the mean values have only so slightly changed thus no concerns are raised regarding data distortion phenomena the largest difference of mean value is observed in the me foc signal but the 0 74 difference is considered rational since it was noticed to be a signal with extreme values on regular intervals the next algorithm that was applied on the dataset is the cleaning algorithm here a much simpler metric is used to check the rationality of the algorithm only the number of the deleted data points is calculated and presented as a percentage of the total number of data points that were examined in this case the mean values of the parameters before and after the cleaning process are not calculated firstly because a very small portion of the data is affected by the algorithm and secondly because extreme values are almost symmetrically rejected from the dataset at this point it is stated again that in the case of cleaning the entire row of data is dropped from the dataset if an outlier is detected on any parameter of a particular timestamp in contrast with the previous imputation algorithm that affects only the data point on the specific parameter that is being tested and does not affect the rest of the data at that timestamp see table 3 consequently on table 3 the percentages could be summed up to estimate the total percentage of data rows removed from the dataset 3 35 in this case the data pre processing procedure concludes with a last filter for sea current above 1 knot data rows where the absolute difference between the sog and the stw is above 1 knot are deleted this criterion is also included in iso 19030 iso 2016 and account for reducing the effect of sea current the number of data rows dropped from this filter is 11 23 other cases where the data are filtered for operational criteria i e limits on draft wind wave propeller revolutions are not considered to be part of the pre processing procedure 5 feature engineering a process of paramount importance in the data driven modeling is that of feature engineering that includes the feature generation and feature selection stages in this study an effort to approach more systematically the process of feature engineering is made feature generation is a basic part of this process a feature can be generated from an existing one by applying on it some mathematical operations or by combining it with another existing one in particular with the objective to develop one model for the estimation of shaft power and one for the me foc we choose to generate the following features wind effect by multiplying the wind s relative speed with the cosine of the wind s relative direction fouling by applying a logarithmic function to the values of the time elapsed from the first timestamp parameter features of standard deviation std of the initial parameters calculated for 5 min intervals sea current by subtracting the stw from sog draft tot by taking the mean value of draft aft and draft fore it should be mentioned that a feature could be generated just for providing a better insight on the problem or to assist in filtering the data and not necessarily to be included in the final model feature selection is the next step and refers to the process of choosing which features will finally be the inputs of our model in order to take such decisions the following considerations are made a does the feature provide any valuable information or it seems redundant with respect to the target variable b is it highly correlated to any other feature and provides the exact same information to the model c would the increase in the solution input space dimension benefit the model or it already seems too complex for the problem that is being addressed while considering the above it is important to keep in mind that thanks to the abstract inferring capabilities of the anns a feature does not have to be accurate in a physical and quantifying sense in order to be a good predictor and contribute to the model s performance however when the general and qualitative discussion is completed metrics and statistics about the data should be calculated and evaluate the features based on these results as well this quantitative part of feature selection is presented in karagiannidis 2019 the idea of course is to select features that not only statistically correlate with the output variable but have a known physical causal relationship as well for instance high values of rudder s angle may increase the ship s hydrodynamic drag significantly the optimum selection of features for a ship propulsion model remains an open problem in the literature but in our case for the models in this study the features parameters of table 4 were used as input table 4 shows also the output parameter of each model 6 ann model production comprehending properly the anns architecture and parameters influence on the possible outcome is of great importance for building functional and well performing models we attempt to shed light on the key factors that fine tune an ann model however it is not only the capabilities of the model that influence the final accuracy but the quality of the training data set as well this argument is supported in the present section where the results from testing ann models are presented in increasing pre processing complexity order quantitative evidence is provided for the significance and effectiveness of the data pre processing and feature engineering procedures that were implemented in previous stages of this work 6 1 parameters selection training results and optimization in order to produce high accuracy models every step of the process is meticulously investigated having completed the pre processing and feature engineering stages we proceed to define the training process of the ann models when we refer to the training process we mean a set of specific steps that are implemented in the following order a shuffling the data set b splitting the data set into the training set and the validation set as common practice we use 80 20 split and 70 20 10 when test set is required c normalizing the arithmetic elements of our data using z score normalization zero mean and unit variance d train a typical feed forward neural network fnn in our case training the fnn requires the parameters presented in table 5 to be defined every one of the aforementioned steps plays a crucial role in the performance and robustness of the model the goal is to minimize the error function of course but this does not mean that a model with poor generalization capabilities and over fitted to the training data is desired even if it brings the training error down to almost zero for this reason we will discuss briefly the importance and the benefits of each and every one of these steps that we implement before the training procedure shuffling the data is crucial in order to avoid biased learning of the model if we consider all the measured parameters in the ship dataset to be random variables we may confidently assume that not all are static consequently data collected later on time carry new information based on actual changes in our physical system if the data are not shuffled the model will be trained on hull conditions that describe a certain time window of the ship s operation and examples related with the later behavior of the system will be ignored by the model the split of the data by convention among machine learning practitioners varies between 70 30 and 90 10 as training validation set the most influential factor in the determination of the split percentages is the dataset s size in large datasets the validation or the test set can be a smaller percentage of the whole since it is still quite large in absolute number data normalization is a standard procedure for most cases for regression models and arithmetic data and should not be skipped it is easier to conceptualize its importance in a two dimensional curve fitting example suppose a set of data points located distantly from the axes origin of our 2 d plane and an estimation of the slope α and intercept β of a line that fits the data and results to the least square error a small perturbation in the value of α is shifted to larger displacements of the line s position in points more distant regarding the axes origin and therefor erratic behavior of the error function setting the models parameters is a demanding procedure since on one hand there are not any straight forward technics to guide us through and on the other hand brute force search for optimum values is inefficient one should take under consideration a lot of theoretical background knowledge mainly related with the anns architecture and mechanism but this is not enough the reason is that selecting a relatively efficient number of layers and units or a well suited activation functions is plausible with some experience and following basic rules of thumb offered in the machine learning literature i e bishop 2006 haykin 2009 raschka 2015 however fine tuning the model and being confident that we are verging to the global minimum of the error function is far more difficult the strategy followed in this study can be summarized in the following propositions add layers until the error stabilizes then add one more and if there is not improvement keep the least number of layers that achieves this performance similarly add units to each layer until the error stabilizes then add even more and if there is not improvement keep the least number of layers that achieves this performance experiment with fundamentally different types of activation functions detect the most suitable family of activation functions i e tanh and sigmoid behave similarly and test a subset of them to ensure that they do not induce deviations in the model s performance solid understanding of the training process and the available optimizing algorithms may assist significantly in the direct selection of the proper optimizer ruder 2017 in this study adam adaptive momentum estimation is found to be the most effective optimization algorithm with the default hyper parameter tuning by keras chollet 2015 it follows the principals of error backpropagation and gradient decent optimization but has certain enhancements related to the adjustment of the momentum term which can be found in detail at kingma and bo 2015 the batch size is the number of training samples that are forward propagated through the network before re adjusting the weights if the batch size is set equal to 1 then we have a sequential model and weights are adjusted for the error estimated on each sample point if the batch size is set equal to the total number of training samples then we have a batch method and the weights are adjusted only once in every epoch other cases of intermediate batch size are mini batch methods we decided to couple the selection of batch size number with the number of epochs the number of epochs is selected in relation to the batch size increasing the number of epochs means increasing the number of times that the whole training set is propagated through the model but the batch size determines the number of weight updates that occur in each epoch we consider the total number of weight updates to be the effective degree of the model s training for instance if the number of epochs is constant doubling the batch size leads to the half weight updates and this is proportional to the computational time required for the model s training fewer weight updates lead to faster training but a larger batch size means less focus on the fitting of each individual data point and vice versa finally it should be noted that a large number of epochs is usually responsible for over fitting the model while a large batch size can assist the model to fit better on noisy data the error function in regression models is commonly selected to be the root mean square error rmse function and this is also our selection in table 6 we present the results of an extended training and testing procedure τhe data set column has the labels of differently processed datasets in an ascending order of pre processing degree the raw data are completely unprocessed and have only been synchronized into per one minute timestamps all the datasets originate from the raw data and are further processed the smoothed s dataset is produced by averaging the raw data in 5 min time windows the smoothed corrected scor dataset is averaged in the same way and preprocessed by the imputation algorithm presented previously the smoothed cleaned scl dataset is averaged in the same way and preprocessed by the outlier detection algorithm presented previously the smoothed corrected cleaned scc dataset is averaged in the same way and preprocessed by both the previous algorithms the scc k folds is just the scc dataset in which the k fold technic for cross validation of the generated models has been applied the scc atlantic trips originates from the scc dataset but includes only the data points that were collected while crossing the atlantic ocean the scc fouling is the scc dataset without the fouling feature the other columns in table 6 and figs 8 and 9 present error metrics for the target of the models as mentioned previously model 1 is feature engineered and trained to estimate the me foc and model 2 to estimate the propeller s shaft power the rmse column is the root mean squared error between the model s estimations and the target values of the validation set if y i is the target value and y i ˆ is the estimated we calculate the rmse as 3 r m s e r r o r i 1 n y i ˆ y i 2 n the r2 value is the linear correlation coefficient among the estimated values and the targets values the accuracy with respect to w r t the mean is defined as 4 m v s r m s e m v s 100 where m v s is the mean value of the target variable at the validation set the relative error pedersen and larsen 2009 is calculated as 5 r e l a t i v e e r r o r 1 n i 1 n y i ˆ y i y i 100 all the models share the same number of hidden layers and hidden units the same activation functions batch size epochs and the same error function as defined earlier in this sub section this is done in order to benchmark the pre processing algorithms that were used for replacing or cleaning the data and to observe the effect of some features on the model s performance the results presented in table 6 and in figs 8 and 9 are the average values of five training testing procedures in order to reduce the randomness on the attained error metric value the values of the error metrics support the positive effect of the imputation and cleaning algorithms in both target cases the rmse is drastically reduced when we use the smoothed data set and it keeps shrinking when the data have been replaced or cleaned accuracy improves from 92 to almost 98 when in the case of me foc model and from 96 to 98 5 in the case of shaft power the optimum results are obtained when k fold cross validation technic is applied and that was expected since it is a common technic in machine learning applications furthermore in the scenario where data points only from atlantic ocean sailing are included in the dataset the errors are even smaller because the modeled phenomena are in a much steadier state and effects such that of shallow or confined waters are absent also transient engine operation is much more frequent during coastal navigation rather than during atlantic ocean sailing and so intense nonlinearities from the engine s signals are absent as well finally a test for the effect of the fouling feature that was generated from the dataset s temporal information is implemented we see that the errors are increasing when the fouling feature is omitted from the input data set and that gives us confident to utilize this generated feature in future applications 7 applications 7 1 operational scenarios testing with fuel oil consumption model in this section an application that aims to predict the actual me foc over a ship s voyage is presented given that all the values for the input parameters table 4 of the model are known our model estimates the total mass of consumed fuel with accuracy above 98 5 from the available dataset of the examined ship only the data points that were collected during the crossings of the atlantic ocean shall be utilized a typical ship route is shown in fig 10 in a period of 12 months we detect 12 crosses of the atlantic and we split them to 8 trips as training set 2 trips as validation set and 2 trips as test set we need a validation set because the k folds technic is used for improved model performance also at this stage we introduce the ensembles technic which is the training of multiple identical i e having the same architecture models on the exact same data in order to average the outputs of all these models which vary due to the stochastic character of the training process and use this value as the final estimation hence when we refer to the model s estimation we mean the average value of the ten models outputs the model provides the instantaneous value of the fuel oil consumption output and the total consumed mass of the fuel is derived by integration for each estimation the 99 confidence interval is calculated to quantify the uncertainty in the model the results from the test set s estimations and errors are presented in table 7 and in figs 11 and 12 the y axis scale in fig 11 is not allowing us to display the confidence intervals around the estimation curve for this reason in fig 13 a shorter time window from the test set is presented in general it was noticed that for low values of the me foc the uncertainty in the model increases because there are few training data on this range but in overall it behaves quite robustly that explains why in fig 12 the highest model errors appear on the 11th day where me foc gets the lowest values encountered in the voyage the expected error related to the estimated value of the total me foc in table 7 is 4 4 tons it is calculated by propagating the standard error of each estimated value we see that the actual value of the total me foc lies well within the anticipated interval it shall be also mentioned that the total me foc is calculated under the assumptions presented previously and corresponds to the available and pre processed data sets an alternative way to exploit this model is to create scenarios of reduced or increased average stw during an identical voyage where the loading and weather conditions are considered the same as previously the model s output me foc can be used to estimate the difference in the total fuel consumption also the added voyage duration can be calculated for the needs of this sensitivity study directly by the stw variation the scenarios that were tested are listed in table 8 along with their expected errors for the total me foc in fig 14 the results of table 8 are interpreted and presented in terms of relative difference of consumed fuel and voyage duration using as baseline scenario that of the 17 68 knots finally the error distribution of the model is plotted in fig 15 the graph on the left side demonstrates the distribution of the model s absolute value of error which is calculated as y i ˆ y i where y i is the target measured value and y i ˆ is the model s estimation the graph on the right side demonstrates the distribution of the model error which is calculated as y i ˆ y i a slight left skew on the error s distribution is noticed which may imply a bias in the model due to the influence of an unobserved factor i e swell currents ambient or sea temperature however considering further the statistics of the below distributions see table 9 we may state that such bias is of insignificant influence to the predicting capabilities of the model due to its relative magnitude i e mean error value 0 23 t 24hr corresponding to mean foc value of 51 78 t 24hr 7 2 average speed loss estimation this section presents an application that aims to highlight an alternative approach to the standard iso 19030 processes for estimating a ship s average speed loss the analysis is focused on the filtering process and on the calculation of the expected speeds from the available data points the iso procedure for normalization is compared to an innovative way of normalizing the data through a machine learning model the basic idea in iso 19030 lies on the calculation of a performance indicator e g speed loss over a specific time window which is based on the average value of the respective performance value at each data point the performance value is defined as the difference between the expected value of the parameter e g ship s speed and the measured one at the same shaft power in order this comparison to be meaningful the same reference conditions shall apply and usually speed power curves from sea trials are used however in order to achieve these reference conditions specific filtering and corrections are needed for eliminating either the effect of external parameters e g weather or for the comparison of values at the same draft and trim furthermore it is suggested to filter out the outliers prior the normalization of the data points the proposed methodology for outlier detection by iso 19030 is based on the chauvenet s criterion described by eq 6 6 n e r f c x i μ σ 1 2 where n μ σ and x i are the number of data points in the set the mean value the standard deviation and the suspect data point respectively while erfc is the complementary error function according to this criterion when the expected number of measurements at least as bad as the suspect measurement is less than 1 2 then the suspect measurement x i should be rejected however there are two assumptions in the chauvenet s criterion that should be discussed i the probability distribution of the data points is given by the complementary error function this assumption actually implies that the error of the collected data points is normally distributed in any case ii a frequentist notion of probability is clearly assumed on the check for the outlier that notion requires a satisfactory large amount of data in order to provide a legit probability value and then judge upon it the fact that these two assumptions cannot be always realistically fulfilled is the first reason why we attempt to come up with an alternative approach which is presented as the cleaning algorithm for statistical detection of outliers on ships data the other reason is that we wanted to avoid applying a generic statistical or machine learning method for outlier detection according to iso 19030 in the data filtering and validation phase for consecutive non overlapping blocks spanning 10 min data for every parameter shall be filtered according to chauvenet s criterion a data block contains by definition a maximum of 40 measurements sampling period 15 s for each parameter however in practice rarely the storing frequencies of sensors are set so high as to produce datasets complying with this requirement if the 10 min period is extended the assumption of steady environmental and operational conditions is less supported for example if we have four recordings of the ship s speed in a 5 min time window it makes no sense to apply the chauvenet s criterion in order to identify at least one of these four data points as an outlier if we choose a larger time window i e 30 minute so that a sufficiently large number of speed recordings will be available the probability of an increase or decrease in the speed due to changes in the environmental conditions is quite high once again outliers cannot be properly detected since the same value of speed may be an actual outlier if it occurred later in the time window when the ship s state was different rather than earlier table 10 presents the filtering requirements according to iso 19030 and compares them with the case that an ann model is to be used for the normalization of the data the main difference among these two methods is that iso 19030 requires filtering for calm sea conditions true wind speed 7 9 m s and the same loading condition when an ann model is utilized to estimate the ship s stw model output for any loading and weather conditions model inputs we can keep in the dataset a large number of data points that otherwise would be rejected we still have to filter for large rudder angles and strong sea currents because in these cases the physic of the problem differs fundamentally e g completely different flow of the water around the hull the standard deviation of the stw std stw is added in the filtering procedure because we wish to reject data points from transient or high uncertainty moments also the propeller shaft power is required to be more than 9 000 kw only because the available sea trials are for a power range over this value finally by constraining the longitude coordinate s value we filter for transatlantic trips only because there are no available data for water depth and temperatures coastal sailing data points will definitely include cases of shallow or confined water sailing and maneuvering close to ports and transient operations after the filtering of the data the normalization procedure allows us to make possible the direct comparison of measured data points to the expected ones in the reference condition reference condition could be any loading condition of the ship for which we have the speed power curve in clean hull and calm weather conditions and hence the expected values of speed stw for a particular value of power the analysis could refer to a reference period which could be a 6 month period of data collection before and after a hull cleaning by subtracting from the expected stw values the normalized measured values of stw for the same engine power we get an indication of the ship s performance in the form of a speed loss see eq 7 7 v d 100 v e v m v e where v e is the expected value of stw in reference condition and v m is the measured one if v m is not measured in the exact same displacement as the one of the reference conditions it should be normalized according to eq 8 8 v 2 v 1 δ 1 2 3 δ 2 2 3 1 3 where v 2 is the speed at reference condition displacement δ 2 v 1 is the speed at measured displacement δ 1 after the calculation of the v d values for all the available data points n we take their mean and this result to the average speed loss v d eq 9 9 v d 1 n i n v d i in fig 16 we have estimated the average speed loss asl with both methods the blue dots upper group of points are calculated through the iso 19030 normalization formula eq 8 while the green dots lower group are obtained by normalizing the speed values with the ann model obviously in the case of the ann we have much more available data points to support our estimation because the filtering procedure is not so strict also both methods result to a similar value for the average speed loss but the ann method trends in the expected way increasing speed loss over time while the iso 19030 method estimates a decreasing speed loss over time we believe that this happens mainly due to the limited number of data points involved in the estimation of the average speed loss the average speed loss value estimated from the ann model is 5 12 and from the iso 19030 is 5 99 while the available data points after filtering are about 22 000 and 2 500 respectively of course the uncertainty level that accompanies each value is different due to different size of the datasets 8 discussion on the level of accuracy achieved in data driven models so far comparison among the various studies on the field is not always achieved in a straight forward way that is mainly due to the lack of standardization in error metrics that are adopted i e absolute error percentage error or normalized error etc by researchers furthermore we should note that different datasets offer different constrains and opportunities in the modelling process and normally are not of the same quality different noise levels or availability of parameters despite the aforementioned we shall compare the achieved accuracy of our fnn models to other similar works in the field the most relevant comparison of results is among studies that built ann models using high frequency data to predict foc like pedersen and larsen 2009 that reported an average model error 1 83 beşikçi et al 2016 that achieved rms error 0 193 t hr or more recently gkerekos et al 2019 reported 89 5 in terms of explained variance 1 4 t 24hr mean average error alternatively on shaft power estimation senteris et al 2019 reported normalized rms error equal to 2 74e 04 and petersen et al 2012b achieved an rms error of 0 32 knots in the speed estimation finally we shall present indicative results from studies that utilize other machine learning methods to model the ship propulsion leifsson et al 2008 using a combination of data driven and physical models gray box models achieve rms error equal to 0 65 knots on the speed estimation and 60 l hr on the foc petersen et al 2012b developed models using gaussian process and achieved rms error of 0 63 knots on the speed estimation and 44 2 l hr on the foc soner et al 2018 with lasso regression achieved rms error of 0 45 knots on the speed estimation and 44 6 l hr on the foc last but not least coraddu et al 2019b utilized random forest technic and a systematic feature selection process to develop gray box models that achieved error of 0 83 on foc and 0 79 on shaft power estimation 9 concluding remarks we investigate the margins of improvement in the data driven ship propulsion models also known as black box models for the scopes of performance monitoring and analysis the models trained were multi layer artificial neural networks anns and therefore two important stages in this modeling procedure were the data pre processing stage and the neural network s parameters and optimizer selection stage these stages were investigated thoroughly and proved to be able to contribute remarkably to the high accuracy that was achieved by the models two models were developed targeting me foc and shaft power respectively more specifically in the pre processing stage two algorithms for replacing and cleaning the data were proposed when applied to the available dataset they increased the accuracy of the produced models by approximately 1 5 however the initial accuracy of the ann models was quite high from 93 to 95 depending on the targeted parameter fuel oil consumption or shaft power this high initial accuracy was achieved due to the larger number of hidden units that were used in our networks and the recently developed optimizer adam here we would like to mention that a point of further examination about the feature s selection could be the inclusion of a criterion related with their practicality in a fleet optimization model in that case a trade off between model s accuracy and model s practicality shall be needed finally we implemented the average speed loss estimation according to iso 19030 procedure and then attempted to alter the filtering and normalization process by utilizing a neural network model that could predict the expected ship s speed based on the shaft power value the aim is to maintain a larger data set as less filtering is needed and therefore the derived average speed loss and trend in time entail less uncertainty the results were quite rational and encouraging for further investigation of this method credit authorship contribution statement pavlos karagiannidis conceptualization software formal analysis data curation writing original draft visualization nikos themelis conceptualization methodology investigation writing original draft writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank prisma electronics for proving the dataset acquired by the laros platform 
21077,in this paper a hardware architecture of real time dynamic data collection is designed and the method of direct motion control based on the feedback data is used to realize the automatic berthing of the ship in this method a ship based microwave radar array is used to detect the relative position attitude of the ship and distance from the berth shoreline according to the precise definition of ship berthing state an automatic berthing method composed of upper scheduling and lower control is proposed the results of real ship experiments show that the method is feasible and practical keywords automatic berthing model free adaptive control data driven control microwave radar array 1 introduction in the course of automatic ship berthing ship dynamics becomes highly nonlinear and complex dynamic behaviors occur due to environmental conditions such as wind currents as well as the shallow water and quay wall which makes it difficult to control the ship accurately zhang et al 2006 thus it is of great significance to study automatic berthing technology both theoretically and pragmatically the research on automatic berthing technology began in the early 1990s yang 1996 first proposed a mathematical model for manoeuvring by berthing and proposed a practical algorithm for calculating the fluid force acting on the hull and the propeller rudder force tug force cable and anchor chain tension combining incremental feedback technology bu et al 2007 designed an automatic berthing algorithm without estimating wind and current interference mizuno et al 2012 proposed the nonlinear model predictive controller based on the minimum time berthing method for nonlinear programming zhang et al 2015 summarized the development of ship berthing technology in the past and proposed the future research direction of automatic ship berthing yan et al 2016 used the working principle of three dimensional laser scanner and the processing method of three dimensional point cloud data to propose a ship berthing monitoring technology that can provide nautical dynamic information for automatic berthing ablyakimov et al 2017 proposed local navigation system that can be used for automatic berthing yang et al 2017 designed a ship based stranded cable control device which can realize parallel mooring by using two cables at the bow and stern maki et al 2020 presented a numerical method using the covariance matrix adaption evolution strategy cma es and applied it to the automatic berthing problem li et al 2020 proposed a nonlinear model predictive control nmpc based approach for underactuated ships providing optimal ship rudder angles and propeller revolution rate to automate the ship docking process in summary the research of ship s automatic berthing is still in the theoretical research stage and the research is mostly focused on the path planning algorithm when the ship is finally near the berth and the control of the ship courses in this process there is less research done on how to control the ship s relative attitude to gradually reach the berth and achieve the predetermined berthing process when the ship is close to the berth it is at a low speed and it is affected by the shallow water and the bank effect it is difficult to accurately model the ship therefore the motion control method based on the ship motion model has limitations and cannot meet the requirements of the ship s automatic berthing scholars in china and abroad have tried to control the ship s motion by adopting a method that does not depend on the ship s motion model in 1990 yamato et al 1990 used the artificial neural network ann algorithm to design a ship s automatic berthing controller for the first time zhang et al 1997 used a multi parameter neural network algorithm to design an on line parameterized berthing controller im et al 2002 2007 and tran et al 2012 used neural networks to design berthing controllers and designed ship s automatic berthing controllers considering auxiliary equipment such as side thrusters and tugs nguyen et al 2007 used adaptive neural networks to train control signals of the rudder and paddle to achieve automatic berthing ahmed and hasegawa 2012 2015 used neural network technology combined with virtual window theory designed ship s automatic berthing controller and used ship model test to verify its effectiveness zhang et al 2017 used ann algorithm to simulate the ship s automatic berthing control in the field of research on low speed motion control of ships gong et al 2017 designed interference observers and global sliding mode controllers based on the working principle of the waterjet propulsion steering control system nguyen et al 2018 improved the ann algorithm and applied it to real ship control in 2020 nguyen 2020 proposed a multitasking system for automatic ship berthing based on an integrated neural controller to carry out different tasks without retraining the neural network structure zhang et al 2020 2020 2020 improved the radial basis function neural networks rbf nns to deal with the uncertainties of path following control system which was proved practical in cable laying operation in summary the research history of ship s automatic berthing methods has been decades but less people have applied these methods to real ship s automatic berthing and the existing control methods that do not rely on ship motion models are mostly ann algorithms mostly staying in the simulation stage in the actual ship berthing process the real time performance of this method is difficult to guarantee and it is difficult to obtain samples for parameter training however the control convergence time allowed by the ship during the berthing process is short making it difficult for the artificial neural network control method to be applied to the ship to this end a ship based microwave radar array is designed to detect the relative position attitude of the ship and distance from the berth shoreline a model free adaptive control method based on data driven control is used to realize the ship s berthing control and the actual ship experiment to verify the feasibility and control effect of the algorithm the rest of the paper is arranged as follows firstly section 2 introduces the hardware structure of automatic berthing system then in section 3 the overall process of automatic berthing is presented based on precise definition of berthing state section 4 proposes automatic berthing scheduling algorithm section 5 uses data driven control to design the ship s course and speed controller to verify the effectiveness of the method real ship experiments are carried out in section 6 finally section 7 makes the conclusion 2 hardware design of automatic berthing system for the automatic berthing of ships it is necessary to take the experimental ship as the carrier to complete the hardware design of the experimental ship then build the experimental platform of the automatic berthing system and finally design the experiment to verify the applicability of the system the stability and reliability of each model and algorithm the hardware design of ships is the basis for the realization of the automatic berthing of ships a crucial step in hardware design is the design of a microwave radar array the projection of a ship on the horizontal plane can be simplified into a convex polygon which is required to completely cover the horizontal projection of the ship the vertex of convex polygon must be the first to collide with shoreline in this paper since the experimental ship is simplified into a hexagon a radar is installed on each of the six vertices the number of radars can t be reduced otherwise there will be a collision between a vertex and the shoreline that cannot be detected in advance the hardware structure of automatic berthing is mainly composed of the following units which fulfil the functions of environment perception and signal acquisition 2 1 attitude sensor in the process of the ship s automatic berthing the real time attitude information of the ship needs to be obtained the motion parameters of six degrees of freedom including bow roll pitch heave sway and surge are measured in real time by using the high precision inertial navigation module the acceleration angle and angular velocity values in x y and z directions are provided for the automatic berthing of the ship 2 2 electronic compass when the ship is close to the berth it is necessary to obtain the longitude and latitude data of the current position of the equipment at the same time it is also necessary to determine its current orientation and heading use the electronic compass to obtain the gps data and heading angle data in real time and use the analyzed data to monitor the ship s position and berthing control 2 3 microwave radar the control of the ship s automatic berthing is different from the traditional ship motion control when the ship is berthing it is close to the shoreline however the accuracy of the traditional civil gps can only reach the meter level unable to meet the centimeter scale accuracy requirements when the ships are berthing therefore the microwave radar array is used to assist the shipborne gps in high precision positioning microwave radar can achieve the measurement accuracy of the centimeter scale six microwave radars are installed on the hull respectively the accurate position of the ship is calculated based on the distance from the shoreline collected by each microwave radar after combined with gps data the precise positioning of the ship is realized and the attitude of the ship could be calculated accurately with the onboard attitude sensor the distribution of six microwave radars installed on the ship is shown in fig 1 s 1 s 6 indicates the distance between each microwave radar and the shoreline the position of the ship is accurately located according to the specific position of each microwave radar on the ship and the onboard gps equipment the current attitude of the ship is determined by the distance from the shoreline measured by each microwave radar 3 design of automatic berthing process this paper researches the problem of automatic berthing of ships in still water in the process of automatic berthing according to the parameters of ships it is necessary to define the berthing state of ships 3 1 berthing rules the berthing process can be divided into two stages the first stage refers to the moving process before the ship arrives at the berth and the second stage refers to the movement process of the ship approaching the wharf from the front of the berth when the water flow and the wind are gentle and the water area of the wharf is wide the ship shall keep a safe cross distance of at least 1 1 5 times the length of the ship to the wharf let the ship navigate by water slowly and stop when the distance between the bow and the end of the wharf is 2 3 times the length of the ship the angle between the fore and aft line and the extended long line of the wharf shall not be greater than 15 with the steering engine and the ship shall slide forward with the inertia sun 2008 3 2 mathematical definition of ship berthing on the basis of the berthing rules the ship s surge speed u sway speed v ship s heading ϕ yaw rate ϕ ship s position x y and berth center x 0 y 0 are defined in the process of berthing when the ship meets the following formula it is considered that the ship has achieved berthing 1 u 0 v 0 ϕ 0 ϕ θ x x 0 2 y y 0 2 s 0 s min s j the final berthing state of the ship is as shown in formula 1 and the final berthing state of the ship is the surge speed of the ship is zero the sway speed is zero the turning angle speed is zero the ship heading is a fixed value and the ship arrives at the berth that is the distance between the center of gravity of the ship and the berth is less than a threshold s 0 in the process of berthing keep the distance between the ship boundary and the shore line always greater than a fixed value s j and s min is the minimum value of the distance information collected by each microwave radar 3 3 overall process of automatic berthing the distance between the ship s microwave radars and the shore line is obtained by using the ship borne electronic localizer and microwave radar array and the position of the ship relative to the berth is determined by combining the gps data of the ship then the attitude of the ship relative to the shore is obtained the microwave radar and attitude sensor are used to feedback the position information and heading of the ship in real time according to the scheduling algorithm of the upper layer and the model free adaptive control of the lower layer the automatic berthing of the ship is realized as shown in fig 2 the structure of the automatic berthing algorithm is divided into two layers the upper layer of berthing scheduling algorithm and the lower layer of motion control algorithm when the ship is automatically berthing the upper scheduling algorithm can help us calculate the ship s target heading angle and target speed according to the ship s current position heading and speed information and the lower motion control method calculates the ship s current command rudder angle information and command propeller speed information so as to realize the heading and speed control and finally make the ship reach the defined final berthing position and the automatic berthing of ships could be realized 4 ship automatic berthing scheduling algorithm according to the rules of ship berthing this paper uses the path planning algorithm to divide the ship s automatic berthing into two stages the first stage is to drive the ship to the turning point the second stage is to adjust the ship s attitude after the ship reaches the turning point and then drive the ship into the berth along the guide line the distance from each microwave radar to the shoreline is s 1 s 6 the nearest distance between each radar and the shoreline is s min and the warning distance between each radar and the shoreline of the ship is s j 1 5 times the length of the ship when the ship enters the range it immediately drives in the opposite direction away from the shoreline the turning circle radius is s z 10 times the length of the ship and the ship turns when entering the turning circle the ship first moves to the set turning point when the ship reaches the turning point adjust the speed to 5 knots after the speed adjustment adjust the heading to make the ship reach the guide line then adjust the bow angle of the ship to θ 10 travel along the guide line and keep the speed of the ship at 4 5 knots the radius of the speed adjustment circle is s t 4 times the length of the ship the ship starts to slow down to 1 2 knots in the speed adjustment circle and keep the bow angle at θ so that the ship slowly drives into the berth the radius of the berthing circle is s 0 1 time the length of the ship when the ship enters the berthing circle the ship adjusts its attitude and turns off its electric motor to make the ship arrive at the berth which is to say the ship has completed the berthing operation the included angle between the guide line and the shoreline is θ and the turning point is eight times the length of the ship from the guide line to the center of the berth the thresholds for berthing are shown in fig 3 when the ship berths from the left side and the right side respectively the specific process of automatic berthing is as follows 4 1 berthing on the left side of the ship when the ship approaches the turning circle from the left side as shown in fig 4 first calculate the distance s from the ship to the center of the berth through the gps data on the ship when s s z the ship is outside the turning circle the ship will normally move to the berth when s t s s z the ship enters the steering circle the ship begins to perform the preparation for berthing first drive the ship to the turning point calculate the target heading judge the ship s attitude by combining the ship s heading angle at that time with the data of microwave radar input it to the model free adaptive controller and calculate the ship s current command rudder angle so that the ship reaches the turning point after the ship reaches the turning point adjust the speed to 5 knots through the speed controller and approach to the guide line which is in other words to continuously calculate the distance between the ship and the guide line and calculate the direction of command at the next moment in combination with the current course angle of the ship when the ship arrives at the guide line it needs to know the attitude and precise position of the ship relative to the berth so microwave radar is used to assist gps positioning at this time the ship is not only regarded as a particle but also as a rigid body for berthing control by calculating the distance from each microwave radar to the shoreline s 1 s 6 the attitude of the ship is adjusted to when s min s 2 i e the ship approaches to the set berthing position the ship s heading angle should be adjusted with the information of the ship s electronic heading instrument when the heading angle is 10 as shown in fig 5 the ship conforms to the berthing position and at this time slowly drives into the speed regulating circle here taking s min s 4 as an example as shown in fig 6 there is a large gap between the current ship attitude and the defined berthing attitude which requires a large angle left turn the berthing scheduling algorithm outputs the control command of the large angle turning to the ship s heading controller to control the ship at the next moment the single chip microcomputer continues to obtain the real time data of each microwave radar on the ship and judges the current attitude of the ship here until the ship is fully berthed after adjusting the ship s attitude when entering the speed control circle s k s s t the ship starts to slow down at the same time the current attitude of the ship is calculated according to the ship s electronic heading instrument and microwave radar array and the ship s heading angle is continuously adjusted and the ship moves closer to the berthing circle meanwhile the data and s j of each microwave radar on the ship are constantly judged warning line to prevent the ship from getting too close to the shoreline or even hitting the shoreline until the calculated s s k i e the ship enters the berthing circle the ship stops and at the same time adjust the ship s heading angle to be within the set range until the ship s surge speed is zero the sway speed is zero and the turning angle speed is zero at this point the ship is considered to have completed the berthing operation 4 2 berthing on the right side of the ship similarly when the ship is approaching the steering wheel from the right side the distance s between the ship and the berth center is calculated first when s s z the ship is moving to the berth normally when s t s s z the ship will start to carry out the berthing the ship will be moved to the turning point then adjust the speed of the ship and approach the guide line so that the ship s min s 2 and heading angle will be θ and then slowly move into the speed control ring when s k s s t the relationship between the data of each microwave radar on the ship and s j is constantly judged to prevent the ship from getting too close to the shoreline or even hitting the shoreline until the calculated s s k i e the ship enters the berthing circle the ship stops and the bow angle of the ship is constantly adjusted to be within the set range until the surge speed of the ship is zero the traverse speed is zero and the bow angle speed is zero at this point the ship is considered to have completed the berthing operation as shown in fig 7 5 model free adaptive control in the process of the ship s automatic berthing two controllers need to be designed ship course controller and ship speed controller in the process of automatic berthing the ship will have either high speed or low speed movement however it is difficult to establish a ship motion model when the ship is sailing at low speed which affects the accuracy of ship motion control the data driven control is not based on the mechanism model but only uses the input and output data of the controlled object to realize the controller design sun 2008 therefore in the process of the ship s automatic berthing the data driven control is used to design the ship s speed and course controller respectively model free adaptive control can be divided into three schemes compact form dynamic linearization model free adaptive control cfdl mfac partial form dynamic linearization model free adaptive control pfdl mfac and full form dynamic linearization model free adaptive control ffdl mfac cfdl mfac scheme aims at simple nonlinear system which has the simplest controller form and only one dimensional partial derivative parameter needs to be adjusted online pfdl mfac scheme is an extended form of cfdl mfac scheme and it can be considered as a special case of ffdl mfac scheme therefore the ffdl mfac scheme has the most general form compared with cfdl mfac scheme pfdl mfac and ffdl mfac scheme have more adjustable degrees of freedom and greater design flexibility this is because the latter two schemes respectively consider the possible changes of system output caused by all input changes in a fixed length sliding time window before a certain time k for the ship s course and speed control which is a complex nonlinear system cfdl mfac which only considers the time varying dynamic relationship between the output change at the next time and the input change at the current time cannot be used to design the controller considering the actual maneuverability and real time control effect of the ship the design method of ffdl mfac is too redundant to meet the simplicity requirements of the actual ship motion controller design therefore pfdl mfac is used to design the ship s heading and speed controller 5 1 ship course control algorithm the basic idea of model free adaptive control in data driven control method is to use an equivalent dynamic linearization model to replace the general discrete time nonlinear system at the current working point of the controlled system and only use the input and output data of the controlled object to estimate the pseudo partial derivative in the dynamic linearization model online the model free control has nothing to do with the parameters of the controlled system the mathematical model and the order of the controlled system therefore this paper will not rely on the original mathematical model of the controlled system using the model free adaptive control algorithm which can adjust the control parameters online and real time to control the ship motion consider the following general discrete time nonlinear systems 2 y k 1 f y k y k n u k u k m among them y k represents the measured value of the controller u k represents the output of the controller k represents the sampling time n and m represent the order of the system output and input respectively and f represents the unknown nonlinear function it can represent the general nonlinear system without noise interference three basic assumptions are made for the nonlinear controlled system as expressed in equation 2 3 y k 1 ϕ k δ u k y k assumption 1 the system can be observed and controlled for input and output assumption 2 the system is a smooth nonlinear function and the partial derivatives of f with respect to the control input u are continuous assumption 3 the system satisfies the generalized lipschitz condition that is if the input variable is bounded then the output variable is bounded hou 1994 in the course control of a ship the input of the controller is the ship s target course angle and the output is the ship s rudder angle these two control quantities satisfy the above assumption the design criteria function is as follows 4 j ϕ ˆ k y k 1 y k ϕ ˆ k δ u k 2 μ 1 ϕ ˆ k ϕ ˆ k 1 2 when j ϕ ˆ k ϕ ˆ k 0 is met there are 5 ϕ ˆ k ϕ ˆ k 1 η 1 δ u k 1 μ 1 δ u k 1 2 y k 1 y k ϕ ˆ k δ u k 1 6 δ u k 1 u k 1 u k 2 in formula 5 η 1 is the step factor and μ 1 is a small constant to ensure that the denominator in the fraction is not zero this formula is the identification formula of pseudo partial derivative ϕ ˆ k without model adaptive control therefore the adaptive control algorithm is given as follows 7 ϕ ˆ k ϕ ˆ 1 i f ϕ ˆ k ε o r δ u k 1 ε 8 u k u k 1 ρ 1 ϕ ˆ k λ 1 ϕ ˆ k 2 δ y k 9 δ y k y y k where y is the desired heading angle ρ 1 and λ 1 are the control parameters of the modeless control law the formula is a control law formula without model adaptive control in which only one parameter ϕ k that needs to be identified by input and output data u is the output rudder angle information and y is the input current heading angle 5 2 ship speed control algorithm similarly the ship speed control system is also a typical nonlinear system the input of the system is the propeller speed of the ship and the output of the system is the ship speed the two control variables satisfy the assumption of model free adaptive control the nonlinear controlled system is designed as follows 10 v k 1 φ k δ n k v k the design criteria function is as follows 11 j φ ˆ k v k 1 v k φ ˆ k δ n k 2 μ 2 φ ˆ k φ ˆ k 1 2 when j φ ˆ k φ ˆ k 0 is met there are 12 φ ˆ k φ ˆ k 1 η 2 δ n k 1 μ 2 δ n k 1 2 v k 1 v k φ ˆ k δ n k 1 13 δ n k 1 n k 1 n k 2 in formula 12 η 2 is the step factor and μ 2 is a small constant to ensure that the denominator in the fraction is not zero this formula is the identification formula of the pseudo partial derivative φ ˆ k without model adaptive control thus the adaptive control algorithm is given 14 φ ˆ k φ ˆ 1 i f φ ˆ k ε o r δ n k 1 ε 15 n k n k 1 ρ 2 φ ˆ k λ 2 φ ˆ k 2 δ v k 16 δ v k v v k in the formula v is the desired speed ρ 2 and λ 2 are the control parameters without model control law the formula is a control law formula without model adaptive control in which there is only one parameter φ k that needs to be identified by input and output data n is the propeller speed output by the controller and v is the current ship speed input by the controller 6 experiment the parameters of the experimental ship are shown in table 1 the experimental ship is shown in fig 8 the parameters of the ship course angle controller are ρ 1 0 25 λ 1 3 η 1 0 001 μ 1 1 the parameters of ship speed controller are ρ 2 0 2 λ 2 2 6 η 2 0 0015 μ 2 0 8 two groups of berthing experiments are designed for one group the ship is on the left side outside the steering circle and heading for the berth for the other group the ship is on the right side outside the steering circle and heading for the berth the experimental steps are as follows step1 build a cloud platform introduce the interface of baidu map to display the current location of the device and control it step2 build hardware circuit and debug motor step3 drive the ship to the left and right sides of the steering ring respectively and press the automatic berthing control button step4 download the track data use matlab for data analysis and processing and draw fig 9 below shows the cloud platform interface 6 1 berthing on the left side of the ship the initial state of the ship in fig 10 is the left side outside the steering circle in the experiment according to the designed ship scheduling algorithm the ship enters the steering circle speed control circle and berthing circle in turn and finally stops at the berth to complete the automatic berthing the specific heading angle changes are shown in fig 11 and the speed changes are shown in fig 12 as shown in fig 11 the initial heading angle recorded by the ship is 101 2 after entering the turning circle the ship moves towards the turning point after arriving at the turning point adjust the ship s heading after adjusting the ship to the guide line keep the ship s heading angle at 10 and enter the speed regulating circle then stop finally the ship stops at the berth and the heading angle remains at about 9 the whole process of automatic berthing takes about 40s as shown in fig 12 the step length is 0 2s and the initial speed recorded by the ship is about 8 knots at this time there is no expected speed requirement after about 8s the ship adjusts the course according to the scheduling algorithm the expected speed is 5 knots after the ship completes the speed adjustment keep the speed of 5 knots and continue to drive after entering the speed adjustment circle adjust the speed of the ship to 1 knot slowly move closer to the berth then stop after arriving at the berth stop the motor to complete berthing 6 2 berthing on the right side of the ship the initial state of the ship in fig 13 is the right side outside the steering circle in the experiment according to the designed ship scheduling algorithm the ship enters the steering circle speed control circle and berthing circle in turn and finally stops at the berth to complete the automatic berthing the specific heading angle change is shown in fig 14 and the speed change is shown in fig 15 as shown in fig 14 the initial heading angle of the ship is 151 5 after entering the turning circle the ship moves towards the turning point after reaching the turning point adjust the ship s heading after adjusting the ship to the guide line keep the ship s heading angle at 10 and enter the speed regulating circle then stop finally the ship stops at the berth and the heading angle is about 9 as shown in fig 15 the step length is 0 2s and the initial speed recorded by the ship is about 8 knots at this time there is no expected speed requirement after about 4s the ship adjusts the course according to the scheduling algorithm the expected speed is 5 knots after the ship completes the speed adjustment keep the speed of 5 knots and continue to drive after entering the speed adjustment circle adjust the speed of the ship to 1 knot slowly approach the berth then stop after arriving at the berth stop the motor to complete berthing the experimental results show that the model free adaptive control has a better control effect in the process of automatic berthing although there are some errors considering the accuracy of the measuring equipment these errors are within the acceptable range especially when the ship is about to dock the ship is in a low speed state but still has a good control effect experiments show that the automatic berthing algorithm designed in this paper can achieve the automatic berthing task of ships 7 conclusion in this paper a set of automatic berthing algorithm is designed based on the microwave radar array combined with the gps data on board on the basis of accurately obtaining the real time position of the ship the model free adaptive control is used to control the course and speed of the ship so as to realize the automatic berthing of the ship and the real ship test is designed the experiments show that according to the automatic berthing algorithm introduced in this paper the test ship can complete the automatic berthing the ship used in this paper is a small scale unmanned boat which does not verify whether the large scale unmanned boat can use this method to complete berthing but the method proposed in this paper is general which can provide reference for the research of automatic berthing technology of large scale ships credit authorship contribution statement yong xiong conceptualization methodology jiajun yu formal analysis writing original draft yijing tu writing review editing lin pan project administration qige zhu software junmin mou supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the work presented in this study is supported by ministry of industry and information technology of the people s republic of china green intelligent inland ship innovation programme grant number 2019 358 national natural science foundation of china grant number 51579201 and the open fund of national engineering research center for water transport safety grant number 17kf02 
21077,in this paper a hardware architecture of real time dynamic data collection is designed and the method of direct motion control based on the feedback data is used to realize the automatic berthing of the ship in this method a ship based microwave radar array is used to detect the relative position attitude of the ship and distance from the berth shoreline according to the precise definition of ship berthing state an automatic berthing method composed of upper scheduling and lower control is proposed the results of real ship experiments show that the method is feasible and practical keywords automatic berthing model free adaptive control data driven control microwave radar array 1 introduction in the course of automatic ship berthing ship dynamics becomes highly nonlinear and complex dynamic behaviors occur due to environmental conditions such as wind currents as well as the shallow water and quay wall which makes it difficult to control the ship accurately zhang et al 2006 thus it is of great significance to study automatic berthing technology both theoretically and pragmatically the research on automatic berthing technology began in the early 1990s yang 1996 first proposed a mathematical model for manoeuvring by berthing and proposed a practical algorithm for calculating the fluid force acting on the hull and the propeller rudder force tug force cable and anchor chain tension combining incremental feedback technology bu et al 2007 designed an automatic berthing algorithm without estimating wind and current interference mizuno et al 2012 proposed the nonlinear model predictive controller based on the minimum time berthing method for nonlinear programming zhang et al 2015 summarized the development of ship berthing technology in the past and proposed the future research direction of automatic ship berthing yan et al 2016 used the working principle of three dimensional laser scanner and the processing method of three dimensional point cloud data to propose a ship berthing monitoring technology that can provide nautical dynamic information for automatic berthing ablyakimov et al 2017 proposed local navigation system that can be used for automatic berthing yang et al 2017 designed a ship based stranded cable control device which can realize parallel mooring by using two cables at the bow and stern maki et al 2020 presented a numerical method using the covariance matrix adaption evolution strategy cma es and applied it to the automatic berthing problem li et al 2020 proposed a nonlinear model predictive control nmpc based approach for underactuated ships providing optimal ship rudder angles and propeller revolution rate to automate the ship docking process in summary the research of ship s automatic berthing is still in the theoretical research stage and the research is mostly focused on the path planning algorithm when the ship is finally near the berth and the control of the ship courses in this process there is less research done on how to control the ship s relative attitude to gradually reach the berth and achieve the predetermined berthing process when the ship is close to the berth it is at a low speed and it is affected by the shallow water and the bank effect it is difficult to accurately model the ship therefore the motion control method based on the ship motion model has limitations and cannot meet the requirements of the ship s automatic berthing scholars in china and abroad have tried to control the ship s motion by adopting a method that does not depend on the ship s motion model in 1990 yamato et al 1990 used the artificial neural network ann algorithm to design a ship s automatic berthing controller for the first time zhang et al 1997 used a multi parameter neural network algorithm to design an on line parameterized berthing controller im et al 2002 2007 and tran et al 2012 used neural networks to design berthing controllers and designed ship s automatic berthing controllers considering auxiliary equipment such as side thrusters and tugs nguyen et al 2007 used adaptive neural networks to train control signals of the rudder and paddle to achieve automatic berthing ahmed and hasegawa 2012 2015 used neural network technology combined with virtual window theory designed ship s automatic berthing controller and used ship model test to verify its effectiveness zhang et al 2017 used ann algorithm to simulate the ship s automatic berthing control in the field of research on low speed motion control of ships gong et al 2017 designed interference observers and global sliding mode controllers based on the working principle of the waterjet propulsion steering control system nguyen et al 2018 improved the ann algorithm and applied it to real ship control in 2020 nguyen 2020 proposed a multitasking system for automatic ship berthing based on an integrated neural controller to carry out different tasks without retraining the neural network structure zhang et al 2020 2020 2020 improved the radial basis function neural networks rbf nns to deal with the uncertainties of path following control system which was proved practical in cable laying operation in summary the research history of ship s automatic berthing methods has been decades but less people have applied these methods to real ship s automatic berthing and the existing control methods that do not rely on ship motion models are mostly ann algorithms mostly staying in the simulation stage in the actual ship berthing process the real time performance of this method is difficult to guarantee and it is difficult to obtain samples for parameter training however the control convergence time allowed by the ship during the berthing process is short making it difficult for the artificial neural network control method to be applied to the ship to this end a ship based microwave radar array is designed to detect the relative position attitude of the ship and distance from the berth shoreline a model free adaptive control method based on data driven control is used to realize the ship s berthing control and the actual ship experiment to verify the feasibility and control effect of the algorithm the rest of the paper is arranged as follows firstly section 2 introduces the hardware structure of automatic berthing system then in section 3 the overall process of automatic berthing is presented based on precise definition of berthing state section 4 proposes automatic berthing scheduling algorithm section 5 uses data driven control to design the ship s course and speed controller to verify the effectiveness of the method real ship experiments are carried out in section 6 finally section 7 makes the conclusion 2 hardware design of automatic berthing system for the automatic berthing of ships it is necessary to take the experimental ship as the carrier to complete the hardware design of the experimental ship then build the experimental platform of the automatic berthing system and finally design the experiment to verify the applicability of the system the stability and reliability of each model and algorithm the hardware design of ships is the basis for the realization of the automatic berthing of ships a crucial step in hardware design is the design of a microwave radar array the projection of a ship on the horizontal plane can be simplified into a convex polygon which is required to completely cover the horizontal projection of the ship the vertex of convex polygon must be the first to collide with shoreline in this paper since the experimental ship is simplified into a hexagon a radar is installed on each of the six vertices the number of radars can t be reduced otherwise there will be a collision between a vertex and the shoreline that cannot be detected in advance the hardware structure of automatic berthing is mainly composed of the following units which fulfil the functions of environment perception and signal acquisition 2 1 attitude sensor in the process of the ship s automatic berthing the real time attitude information of the ship needs to be obtained the motion parameters of six degrees of freedom including bow roll pitch heave sway and surge are measured in real time by using the high precision inertial navigation module the acceleration angle and angular velocity values in x y and z directions are provided for the automatic berthing of the ship 2 2 electronic compass when the ship is close to the berth it is necessary to obtain the longitude and latitude data of the current position of the equipment at the same time it is also necessary to determine its current orientation and heading use the electronic compass to obtain the gps data and heading angle data in real time and use the analyzed data to monitor the ship s position and berthing control 2 3 microwave radar the control of the ship s automatic berthing is different from the traditional ship motion control when the ship is berthing it is close to the shoreline however the accuracy of the traditional civil gps can only reach the meter level unable to meet the centimeter scale accuracy requirements when the ships are berthing therefore the microwave radar array is used to assist the shipborne gps in high precision positioning microwave radar can achieve the measurement accuracy of the centimeter scale six microwave radars are installed on the hull respectively the accurate position of the ship is calculated based on the distance from the shoreline collected by each microwave radar after combined with gps data the precise positioning of the ship is realized and the attitude of the ship could be calculated accurately with the onboard attitude sensor the distribution of six microwave radars installed on the ship is shown in fig 1 s 1 s 6 indicates the distance between each microwave radar and the shoreline the position of the ship is accurately located according to the specific position of each microwave radar on the ship and the onboard gps equipment the current attitude of the ship is determined by the distance from the shoreline measured by each microwave radar 3 design of automatic berthing process this paper researches the problem of automatic berthing of ships in still water in the process of automatic berthing according to the parameters of ships it is necessary to define the berthing state of ships 3 1 berthing rules the berthing process can be divided into two stages the first stage refers to the moving process before the ship arrives at the berth and the second stage refers to the movement process of the ship approaching the wharf from the front of the berth when the water flow and the wind are gentle and the water area of the wharf is wide the ship shall keep a safe cross distance of at least 1 1 5 times the length of the ship to the wharf let the ship navigate by water slowly and stop when the distance between the bow and the end of the wharf is 2 3 times the length of the ship the angle between the fore and aft line and the extended long line of the wharf shall not be greater than 15 with the steering engine and the ship shall slide forward with the inertia sun 2008 3 2 mathematical definition of ship berthing on the basis of the berthing rules the ship s surge speed u sway speed v ship s heading ϕ yaw rate ϕ ship s position x y and berth center x 0 y 0 are defined in the process of berthing when the ship meets the following formula it is considered that the ship has achieved berthing 1 u 0 v 0 ϕ 0 ϕ θ x x 0 2 y y 0 2 s 0 s min s j the final berthing state of the ship is as shown in formula 1 and the final berthing state of the ship is the surge speed of the ship is zero the sway speed is zero the turning angle speed is zero the ship heading is a fixed value and the ship arrives at the berth that is the distance between the center of gravity of the ship and the berth is less than a threshold s 0 in the process of berthing keep the distance between the ship boundary and the shore line always greater than a fixed value s j and s min is the minimum value of the distance information collected by each microwave radar 3 3 overall process of automatic berthing the distance between the ship s microwave radars and the shore line is obtained by using the ship borne electronic localizer and microwave radar array and the position of the ship relative to the berth is determined by combining the gps data of the ship then the attitude of the ship relative to the shore is obtained the microwave radar and attitude sensor are used to feedback the position information and heading of the ship in real time according to the scheduling algorithm of the upper layer and the model free adaptive control of the lower layer the automatic berthing of the ship is realized as shown in fig 2 the structure of the automatic berthing algorithm is divided into two layers the upper layer of berthing scheduling algorithm and the lower layer of motion control algorithm when the ship is automatically berthing the upper scheduling algorithm can help us calculate the ship s target heading angle and target speed according to the ship s current position heading and speed information and the lower motion control method calculates the ship s current command rudder angle information and command propeller speed information so as to realize the heading and speed control and finally make the ship reach the defined final berthing position and the automatic berthing of ships could be realized 4 ship automatic berthing scheduling algorithm according to the rules of ship berthing this paper uses the path planning algorithm to divide the ship s automatic berthing into two stages the first stage is to drive the ship to the turning point the second stage is to adjust the ship s attitude after the ship reaches the turning point and then drive the ship into the berth along the guide line the distance from each microwave radar to the shoreline is s 1 s 6 the nearest distance between each radar and the shoreline is s min and the warning distance between each radar and the shoreline of the ship is s j 1 5 times the length of the ship when the ship enters the range it immediately drives in the opposite direction away from the shoreline the turning circle radius is s z 10 times the length of the ship and the ship turns when entering the turning circle the ship first moves to the set turning point when the ship reaches the turning point adjust the speed to 5 knots after the speed adjustment adjust the heading to make the ship reach the guide line then adjust the bow angle of the ship to θ 10 travel along the guide line and keep the speed of the ship at 4 5 knots the radius of the speed adjustment circle is s t 4 times the length of the ship the ship starts to slow down to 1 2 knots in the speed adjustment circle and keep the bow angle at θ so that the ship slowly drives into the berth the radius of the berthing circle is s 0 1 time the length of the ship when the ship enters the berthing circle the ship adjusts its attitude and turns off its electric motor to make the ship arrive at the berth which is to say the ship has completed the berthing operation the included angle between the guide line and the shoreline is θ and the turning point is eight times the length of the ship from the guide line to the center of the berth the thresholds for berthing are shown in fig 3 when the ship berths from the left side and the right side respectively the specific process of automatic berthing is as follows 4 1 berthing on the left side of the ship when the ship approaches the turning circle from the left side as shown in fig 4 first calculate the distance s from the ship to the center of the berth through the gps data on the ship when s s z the ship is outside the turning circle the ship will normally move to the berth when s t s s z the ship enters the steering circle the ship begins to perform the preparation for berthing first drive the ship to the turning point calculate the target heading judge the ship s attitude by combining the ship s heading angle at that time with the data of microwave radar input it to the model free adaptive controller and calculate the ship s current command rudder angle so that the ship reaches the turning point after the ship reaches the turning point adjust the speed to 5 knots through the speed controller and approach to the guide line which is in other words to continuously calculate the distance between the ship and the guide line and calculate the direction of command at the next moment in combination with the current course angle of the ship when the ship arrives at the guide line it needs to know the attitude and precise position of the ship relative to the berth so microwave radar is used to assist gps positioning at this time the ship is not only regarded as a particle but also as a rigid body for berthing control by calculating the distance from each microwave radar to the shoreline s 1 s 6 the attitude of the ship is adjusted to when s min s 2 i e the ship approaches to the set berthing position the ship s heading angle should be adjusted with the information of the ship s electronic heading instrument when the heading angle is 10 as shown in fig 5 the ship conforms to the berthing position and at this time slowly drives into the speed regulating circle here taking s min s 4 as an example as shown in fig 6 there is a large gap between the current ship attitude and the defined berthing attitude which requires a large angle left turn the berthing scheduling algorithm outputs the control command of the large angle turning to the ship s heading controller to control the ship at the next moment the single chip microcomputer continues to obtain the real time data of each microwave radar on the ship and judges the current attitude of the ship here until the ship is fully berthed after adjusting the ship s attitude when entering the speed control circle s k s s t the ship starts to slow down at the same time the current attitude of the ship is calculated according to the ship s electronic heading instrument and microwave radar array and the ship s heading angle is continuously adjusted and the ship moves closer to the berthing circle meanwhile the data and s j of each microwave radar on the ship are constantly judged warning line to prevent the ship from getting too close to the shoreline or even hitting the shoreline until the calculated s s k i e the ship enters the berthing circle the ship stops and at the same time adjust the ship s heading angle to be within the set range until the ship s surge speed is zero the sway speed is zero and the turning angle speed is zero at this point the ship is considered to have completed the berthing operation 4 2 berthing on the right side of the ship similarly when the ship is approaching the steering wheel from the right side the distance s between the ship and the berth center is calculated first when s s z the ship is moving to the berth normally when s t s s z the ship will start to carry out the berthing the ship will be moved to the turning point then adjust the speed of the ship and approach the guide line so that the ship s min s 2 and heading angle will be θ and then slowly move into the speed control ring when s k s s t the relationship between the data of each microwave radar on the ship and s j is constantly judged to prevent the ship from getting too close to the shoreline or even hitting the shoreline until the calculated s s k i e the ship enters the berthing circle the ship stops and the bow angle of the ship is constantly adjusted to be within the set range until the surge speed of the ship is zero the traverse speed is zero and the bow angle speed is zero at this point the ship is considered to have completed the berthing operation as shown in fig 7 5 model free adaptive control in the process of the ship s automatic berthing two controllers need to be designed ship course controller and ship speed controller in the process of automatic berthing the ship will have either high speed or low speed movement however it is difficult to establish a ship motion model when the ship is sailing at low speed which affects the accuracy of ship motion control the data driven control is not based on the mechanism model but only uses the input and output data of the controlled object to realize the controller design sun 2008 therefore in the process of the ship s automatic berthing the data driven control is used to design the ship s speed and course controller respectively model free adaptive control can be divided into three schemes compact form dynamic linearization model free adaptive control cfdl mfac partial form dynamic linearization model free adaptive control pfdl mfac and full form dynamic linearization model free adaptive control ffdl mfac cfdl mfac scheme aims at simple nonlinear system which has the simplest controller form and only one dimensional partial derivative parameter needs to be adjusted online pfdl mfac scheme is an extended form of cfdl mfac scheme and it can be considered as a special case of ffdl mfac scheme therefore the ffdl mfac scheme has the most general form compared with cfdl mfac scheme pfdl mfac and ffdl mfac scheme have more adjustable degrees of freedom and greater design flexibility this is because the latter two schemes respectively consider the possible changes of system output caused by all input changes in a fixed length sliding time window before a certain time k for the ship s course and speed control which is a complex nonlinear system cfdl mfac which only considers the time varying dynamic relationship between the output change at the next time and the input change at the current time cannot be used to design the controller considering the actual maneuverability and real time control effect of the ship the design method of ffdl mfac is too redundant to meet the simplicity requirements of the actual ship motion controller design therefore pfdl mfac is used to design the ship s heading and speed controller 5 1 ship course control algorithm the basic idea of model free adaptive control in data driven control method is to use an equivalent dynamic linearization model to replace the general discrete time nonlinear system at the current working point of the controlled system and only use the input and output data of the controlled object to estimate the pseudo partial derivative in the dynamic linearization model online the model free control has nothing to do with the parameters of the controlled system the mathematical model and the order of the controlled system therefore this paper will not rely on the original mathematical model of the controlled system using the model free adaptive control algorithm which can adjust the control parameters online and real time to control the ship motion consider the following general discrete time nonlinear systems 2 y k 1 f y k y k n u k u k m among them y k represents the measured value of the controller u k represents the output of the controller k represents the sampling time n and m represent the order of the system output and input respectively and f represents the unknown nonlinear function it can represent the general nonlinear system without noise interference three basic assumptions are made for the nonlinear controlled system as expressed in equation 2 3 y k 1 ϕ k δ u k y k assumption 1 the system can be observed and controlled for input and output assumption 2 the system is a smooth nonlinear function and the partial derivatives of f with respect to the control input u are continuous assumption 3 the system satisfies the generalized lipschitz condition that is if the input variable is bounded then the output variable is bounded hou 1994 in the course control of a ship the input of the controller is the ship s target course angle and the output is the ship s rudder angle these two control quantities satisfy the above assumption the design criteria function is as follows 4 j ϕ ˆ k y k 1 y k ϕ ˆ k δ u k 2 μ 1 ϕ ˆ k ϕ ˆ k 1 2 when j ϕ ˆ k ϕ ˆ k 0 is met there are 5 ϕ ˆ k ϕ ˆ k 1 η 1 δ u k 1 μ 1 δ u k 1 2 y k 1 y k ϕ ˆ k δ u k 1 6 δ u k 1 u k 1 u k 2 in formula 5 η 1 is the step factor and μ 1 is a small constant to ensure that the denominator in the fraction is not zero this formula is the identification formula of pseudo partial derivative ϕ ˆ k without model adaptive control therefore the adaptive control algorithm is given as follows 7 ϕ ˆ k ϕ ˆ 1 i f ϕ ˆ k ε o r δ u k 1 ε 8 u k u k 1 ρ 1 ϕ ˆ k λ 1 ϕ ˆ k 2 δ y k 9 δ y k y y k where y is the desired heading angle ρ 1 and λ 1 are the control parameters of the modeless control law the formula is a control law formula without model adaptive control in which only one parameter ϕ k that needs to be identified by input and output data u is the output rudder angle information and y is the input current heading angle 5 2 ship speed control algorithm similarly the ship speed control system is also a typical nonlinear system the input of the system is the propeller speed of the ship and the output of the system is the ship speed the two control variables satisfy the assumption of model free adaptive control the nonlinear controlled system is designed as follows 10 v k 1 φ k δ n k v k the design criteria function is as follows 11 j φ ˆ k v k 1 v k φ ˆ k δ n k 2 μ 2 φ ˆ k φ ˆ k 1 2 when j φ ˆ k φ ˆ k 0 is met there are 12 φ ˆ k φ ˆ k 1 η 2 δ n k 1 μ 2 δ n k 1 2 v k 1 v k φ ˆ k δ n k 1 13 δ n k 1 n k 1 n k 2 in formula 12 η 2 is the step factor and μ 2 is a small constant to ensure that the denominator in the fraction is not zero this formula is the identification formula of the pseudo partial derivative φ ˆ k without model adaptive control thus the adaptive control algorithm is given 14 φ ˆ k φ ˆ 1 i f φ ˆ k ε o r δ n k 1 ε 15 n k n k 1 ρ 2 φ ˆ k λ 2 φ ˆ k 2 δ v k 16 δ v k v v k in the formula v is the desired speed ρ 2 and λ 2 are the control parameters without model control law the formula is a control law formula without model adaptive control in which there is only one parameter φ k that needs to be identified by input and output data n is the propeller speed output by the controller and v is the current ship speed input by the controller 6 experiment the parameters of the experimental ship are shown in table 1 the experimental ship is shown in fig 8 the parameters of the ship course angle controller are ρ 1 0 25 λ 1 3 η 1 0 001 μ 1 1 the parameters of ship speed controller are ρ 2 0 2 λ 2 2 6 η 2 0 0015 μ 2 0 8 two groups of berthing experiments are designed for one group the ship is on the left side outside the steering circle and heading for the berth for the other group the ship is on the right side outside the steering circle and heading for the berth the experimental steps are as follows step1 build a cloud platform introduce the interface of baidu map to display the current location of the device and control it step2 build hardware circuit and debug motor step3 drive the ship to the left and right sides of the steering ring respectively and press the automatic berthing control button step4 download the track data use matlab for data analysis and processing and draw fig 9 below shows the cloud platform interface 6 1 berthing on the left side of the ship the initial state of the ship in fig 10 is the left side outside the steering circle in the experiment according to the designed ship scheduling algorithm the ship enters the steering circle speed control circle and berthing circle in turn and finally stops at the berth to complete the automatic berthing the specific heading angle changes are shown in fig 11 and the speed changes are shown in fig 12 as shown in fig 11 the initial heading angle recorded by the ship is 101 2 after entering the turning circle the ship moves towards the turning point after arriving at the turning point adjust the ship s heading after adjusting the ship to the guide line keep the ship s heading angle at 10 and enter the speed regulating circle then stop finally the ship stops at the berth and the heading angle remains at about 9 the whole process of automatic berthing takes about 40s as shown in fig 12 the step length is 0 2s and the initial speed recorded by the ship is about 8 knots at this time there is no expected speed requirement after about 8s the ship adjusts the course according to the scheduling algorithm the expected speed is 5 knots after the ship completes the speed adjustment keep the speed of 5 knots and continue to drive after entering the speed adjustment circle adjust the speed of the ship to 1 knot slowly move closer to the berth then stop after arriving at the berth stop the motor to complete berthing 6 2 berthing on the right side of the ship the initial state of the ship in fig 13 is the right side outside the steering circle in the experiment according to the designed ship scheduling algorithm the ship enters the steering circle speed control circle and berthing circle in turn and finally stops at the berth to complete the automatic berthing the specific heading angle change is shown in fig 14 and the speed change is shown in fig 15 as shown in fig 14 the initial heading angle of the ship is 151 5 after entering the turning circle the ship moves towards the turning point after reaching the turning point adjust the ship s heading after adjusting the ship to the guide line keep the ship s heading angle at 10 and enter the speed regulating circle then stop finally the ship stops at the berth and the heading angle is about 9 as shown in fig 15 the step length is 0 2s and the initial speed recorded by the ship is about 8 knots at this time there is no expected speed requirement after about 4s the ship adjusts the course according to the scheduling algorithm the expected speed is 5 knots after the ship completes the speed adjustment keep the speed of 5 knots and continue to drive after entering the speed adjustment circle adjust the speed of the ship to 1 knot slowly approach the berth then stop after arriving at the berth stop the motor to complete berthing the experimental results show that the model free adaptive control has a better control effect in the process of automatic berthing although there are some errors considering the accuracy of the measuring equipment these errors are within the acceptable range especially when the ship is about to dock the ship is in a low speed state but still has a good control effect experiments show that the automatic berthing algorithm designed in this paper can achieve the automatic berthing task of ships 7 conclusion in this paper a set of automatic berthing algorithm is designed based on the microwave radar array combined with the gps data on board on the basis of accurately obtaining the real time position of the ship the model free adaptive control is used to control the course and speed of the ship so as to realize the automatic berthing of the ship and the real ship test is designed the experiments show that according to the automatic berthing algorithm introduced in this paper the test ship can complete the automatic berthing the ship used in this paper is a small scale unmanned boat which does not verify whether the large scale unmanned boat can use this method to complete berthing but the method proposed in this paper is general which can provide reference for the research of automatic berthing technology of large scale ships credit authorship contribution statement yong xiong conceptualization methodology jiajun yu formal analysis writing original draft yijing tu writing review editing lin pan project administration qige zhu software junmin mou supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the work presented in this study is supported by ministry of industry and information technology of the people s republic of china green intelligent inland ship innovation programme grant number 2019 358 national natural science foundation of china grant number 51579201 and the open fund of national engineering research center for water transport safety grant number 17kf02 
21078,a hybrid boundary element method has been developed to efficiently solve the hydrodynamic response of a wide perforated breakwater with arbitrary hull geometry and multiple horizontal slits the fluid subdomains inside the slits were considered as rectangular and analytical eigenfunctions of the slit area were applied to derive the boundary condition at the interface the involvement of analytical solutions in the numerical boundary element method bem is the novelty of the present approach the 2d numerical solution was verified with analytical solution of perforated rectangular breakwater to show the validity of the proposed hybrid bem parametric studies have been performed to study the effect of porosity position and layout of the slits it has been found that the slits generally reduce the diffracted and radiation potentials and would be most effective when placed near the free surface the approach was also extended to 3d channel flow and the results were calibrated against an experimental study performed in the wave flume keywords porous breakwater hybrid boundary element method eigenfunction expansion model test hydrodynamics 1 introduction perforated breakwaters have the following advantages over their solid non porous counterparts i a lower reflection of waves which creates a calmer sea environment in the upstream area and ii a better dissipation of wave energy through viscous effect created by the pores or openings on the breakwater walls perforated breakwaters have been designed and applied in various forms for example layers of perforated plates or walls have been used either independently cho and kim 2013 faraci et al 2015 zhao et al 2017 liu et al 2018 alkhalidi et al 2015a or integrated with other offshore structures kou et al 2019 ji et al 2015 2019 dai et al 2018 a common feature of the abovementioned perforated breakwater designs is that each individual perforation is very small as compared to the structure dimensions and the porosity is evenly distributed on the surface of the plates as a result the effect of porosity can be readily incorporated in the modelling via a uniform damping coefficient applied on the entire porous surface many numerical studies based on the linear potential flow theory have been carried out to optimize the design of this type of perforated breakwater in which the porous effect can be accounted for by introducing a porous wall boundary condition with an empirical damping coefficient cho and kim 2013 zhao et al 2017 ning et al 2017 koraim et al 2011 somervell et al 2018 somervell et al 2017 a different kind of perforated breakwater concerns wide breakwater structures with large vacant spaces inside the breakwater which has been called differently in the literature as apertures slits pores water channels or water chambers the fluid spaces concerned are usually of considerable size and are sparsely distributed in the breakwater this type of structure has been studied experimentally by alkhalidi et al 2015a 2015c teh and venugopal 2013 various analytical and numerical models have also been developed a vertical barrier with finite width and one horizontal slit in deep water has been studied for both normal wave and oblique wave condition by guiney et al 1972 liu and wu 1986 1987 losada et al 1992 a multi layer surface piercing breakwater with single or multiple internal spaces was studied analytically by hu et al 2019 hu and liu 2018 while a rectangular breakwater with multiple l shaped internal water channels was studied by kim et al 2014 in these studies the solid walls and the openings of the internal spaces herein called slits were considered as separate boundaries instead of one porous surface the matching boundary condition satisfying the continuity of normal velocity and pressure is applied at the openings only liu et al 2018 ning et al 2017 somervell et al 2018 bennett et al 1992 isaacson et al 1999 mei 1989 the studies of breakwater with large and sparse slits have largely been confined in 2d rectangular breakwaters where analytical solution can be found by the eigenfunction matching method for breakwaters with arbitrary geometry however a suitable eigenfunction may be improbable to find and numerical approaches such as boundary element method have to be resorted for solution for these cases a multi domain boundary element method bem may be used koley et al 2020 mackay and johanning 2020 given the matching boundary conditions at the interface the boundary integral equations bie of external and internal domains can be separately formulated and then matched at the interface liu and li 2017 liu et al 2016 the main disadvantage is that the inclusion of multiple internal domains will significantly increase the number of the elements required in addition for 3d cases the multiple slits would complicate the topology of the structure and increase the difficulty in generating high quality meshing the present study aims at extending the research on perforated breakwaters to those with arbitrary outer geometry and rectangular slits by applying a hybrid boundary element method bem the hybrid boundary element method has been applied in many 2d bem studies wang and meylan 2002 koley and sahoo 2017 koley 2019 one of its main application is to derive a boundary condition that accounts for the contribution of the semi infinite domain extending from infinite distance to the vicinity of the body the diffraction or radiation wave potential to be solved is expanded into a series of eigenfunctions from which a boundary condition at the vertical interface can be derived an obvious advantage of this method is that the length of the fluid domain is largely shortened because the contribution of the evanescent modes is correctly accounted for at the interface and thus the fluid domain does not need to extend far away from the body for the evanescent modes to dissipate similarly a novel numerical method is presented herein which involves analytical eigenfunctions by using the eigenfunctions for the fluid velocity potential inside the slits a boundary condition can be derived at the interfaces between the slits and the outer fluid domain when compared to the multi domain boundary element method the proposed hybrid bem has the following advantages 1 the velocity potential in the internal domains of the multiple slits can be considered analytically which means that there is no need for meshing for its numerical modelling this leads to an overall reduction of the matrix size for solution and hence make the approach more computationally efficient 2 for 3d cases with complex geometries the elimination of slits leads to simpler discretization and grid generation thus saving time in the pre processing stage the paper is arranged as follows section 2 briefly discusses the analytical solution of a rectangular perforated breakwater by the eigenfunction matching method section 3 presents the formulation of the hybrid bem method with and without artificial viscous damping the results from the bem method are compared with analytical results in section 4 to show the validity of the present approach and a set of parametric studies carried out to identify the influence of the internal water channels on the hydrodynamic properties of the floating breakwater the model test performed for a multi slit breakwater and 3d numerical simulation of the tests are presented in section 5 to show a conditional application of the approach in modelling perforated breakwater in 3d wave channels the summary and conclusions are given in section 6 2 mathematical formulation of boundary value problem the formulation of the problem regarding perforated breakwater with horizontal slits share a lot of common boundary conditions and eigenfunctions with that of a solid breakwater as the latter has been well discussed in existing literature such as in references mei and black 1969 and zheng et al 2004 only the formulation regarding the horizontal slit will be highlighted here the geometry of the problem was defined as in fig 1 a the breakwater has a half width a and draft d the single slit goes through the breakwater and distances from the free surface to the upper and lower boundary of the slit are denoted as d 1 and d 2 respectively the water depth h is constant in the fluid domain the coordinate system is established with origin located on the free surface x axis pointing to the wave progressing direction and z axis upwards the rectangular breakwater is symmetrical with respect to the z axis the analytical approach solves the total velocity potential that satisfies the laplace equation 1 2 φ x z 0 in view of the linear potential flow assumptions the velocity potential of the incident wave φ i with unitary wave amplitude and an angular frequency of ω can be written as 2 φ i i g ω cosh k z h cosh k h e i k x where g is the gravitational acceleration k the wave number determined by the dispersion relation and h the water depth the scattered potential induced by the structures can be decomposed into a diffracted potential component and three radiation potential components so that the total velocity potential can be written as 3 φ φ i φ d i 1 3 φ r i where i 1 2 3 represents the degree of freedoms sway heave and roll φ d and φ r i are the diffracted and radiation potentials of each dof the following boundary conditions apply for each of these components 4 φ d r i z ω 2 g φ d r i a t z 0 x a x a 5 φ d r i z 0 a t z h 6 φ d r i x i k φ d r i 0 a t x 7 φ d r i x i k φ d r i 0 a t x in addition the wall boundary conditions on the breakwater walls have to be satisfied the boundary conditions on the outer walls are presented in earlier studies on solid breakwater such as references mei and black 1969 and zheng et al 2004 the boundary conditions on the two horizontal slit walls are given below diffracted potential 8 φ d z φ i z a x a z d 1 z d 2 z h sway 9 φ r 1 z 0 a x a z d 1 z d 2 z h heave 10 φ r 2 z 1 a x a z d 1 z d 2 z h roll 11 φ r 3 z x a x a z d 1 z d 2 z h in order to solve the boundary value problem the entire fluid domain is further separated into four subdomains 1 the upstream subdomain 2 downstream subdomain 3 breakwater bottom and 4 internal domain of the slit the velocity potential in each subdomain is marked with superscripts 1 4 the boundary value problem is solved by finding an eigenfunction that satisfies the laplace equation and the boundary conditions the eigenfunction in the slit domain 4 can be written as 12 φ d r i 4 φ p d r i 4 e d r i 1 x f d r i 1 m 2 e d r i m cosh α m x f d r i m sinh α m x cos α m z d 2 where a m d m e m and f m are series of unknown parameters to be solved subscripts d and r i denote the diffraction and radiation potentials α m is the vertical eigenvalue given by 13 α m m 1 π d 2 d 1 m 1 2 m where φ p d r i 4 is the particular solution satisfying the non homogenous boundary condition in eq 8 eq 11 for each component of diffraction and radiation potential it can be expressed as 14 φ p d 4 φ i 15 φ p r i 4 0 i 1 z i 2 x z i 3 by assuming no viscous damping effects on the interfaces between subdomains 1 4 and 3 4 the analytical solution can be derived by matching the eigenfunction expansions at two vertical boundaries at x a h z 0 and ensuring the continuity of normal velocity and velocity potential in particular the matching boundary conditions at the interface between the slit area 4 and the external subdomains 1 and 2 can be written as 16 φ d r i 1 φ d r i 4 x a d 2 z d 1 17 φ d r i 3 φ d r i 4 x a d 2 z d 1 18 φ d r i 1 x φ d r i 4 x x a d 2 z d 1 19 φ d r i 3 x φ d r i 4 x x a d 2 z d 1 the complete set of matching conditions consists of 6 equations in total the two additional equations that do not involve the slit area have been omitted for brevity for a complete representation of the matching equations and eigenfunctions in each subdomain one may refer to zheng et al 2004 for details all unknown parameters in the eigenfunction expansion series can be solved by multiplying the two sides of the matching boundary condition by corresponding eigenvalues integrated in the range of the boundaries and noting the orthogonality property the matching boundary conditions can be converted into a set of linear equations from which the unknown parameters can be solved as an example the matrix assembly and solution is demonstrated with the matching equation in the appendix the analytical solution of the rectangular perforated breakwater is used in section 4 for the verification of the numerical method 3 formulation of hybrid boundary element method 3 1 boundary integral equations for a perforated breakwater with arbitrary geometries an admissible eigenfunction may be difficult to find and the numerical approach has to be adopted to solve the boundary value problem the perforated breakwater with arbitrary outer geometries is shown in fig 1 b the fluid domain was separated into an external domain s and internal domain s the entire boundary of the fluid domain was separated into several segments the upstream s u downstream s d free surface s f seabed s b breakwater outer wall s w slit wall s w downstream side interface i and upstream side interface i the velocity potentials of external and internal domain were denoted as φ and ϕ respectively in particular the velocity potentials at the interfaces i and i were denoted as φ ϕ and φ ϕ by applying the boundary condition for each boundary segments as in eq 4 eq 7 the 2d boundary integral equation of the external domain may be written as the sum of line integrals on the boundary segments 20 1 2 φ p s u g n p q i k g p q φ q d q s d g n p q i k g p q φ q d q s f g n p q ω 2 g g p q φ q d q s b g n p q φ q d q s w g n p q φ q g p q φ p n d q i i g n p q φ q g p q φ q n d q in which p and q are the source and field points g and g n are the source function and its normal derivative φ q and φ q n are the potential and its normal derivative at point q and φ p n is the normal derivative of the particular solution that satisfies the wall boundary condition the boundary conditions on the free surface and the far fields as in eqs 6 and 7 are used in the boundary integral equation eq 20 the 2d and 3d source functions may be written as 21 g p q ln r 2 π for 2 d 22 g p q 1 4 π r for 3 d where r is the distance between the source point p and field point q similarly the boundary integral equation of internal subdomain accounting for the slit can be written as 23 1 2 ϕ p s w g n p q ϕ q g p q ϕ p n d q i i g n p q ϕ q g p q ϕ n q d q by assuming that there is no viscous damping at the matched interface the following matching boundary conditions are applied at the interfaces between external and internal domain at the two interfaces i and i 24 φ x ϕ x φ ϕ the integral equations 20 and 23 were assembled into a linear matrix equation to be solved for the unknown velocity potentials with nodes and elements on the interfaces been used twice note that the number of elements would be large for cases of multiple slits as the extra slit walls and interfaces have to be modelled 3 2 two parameter hybrid boundary element method in order to reduce the number of elements required for the numerical solution and the effort of meshing a hybrid boundary element method has been proposed as described below to solve this type of problem more efficiently we assume that on condition that the characteristic length of the horizontal slits is much larger than its thickness the geometry of the slit may be simplified as rectangular by slight modifications of the external geometries near the openings this assumption is taken since floating breakwaters usually do not involve mild slopes as in rubble mound breakwaters for a perforated breakwater with arbitrary geometry with rectangular slits and vertical openings as shown in fig 1 b the internal domain of the slits retain the eigenfunction in the form of eq 12 denoting the four convex points of the rectangular slits to be x d 1 x d 2 x d 1 and x d 2 as shown in fig 1 b the velocity potential on the upstream side interface i can be written as 25 ϕ ϕ p x e 1 x f 1 m 2 e m cosh α m x f m sinh α m x cos α m z d 2 similarly on the downstream side interface the velocity potential can be written as 26 ϕ ϕ p x e 1 x f 1 n 2 e m cosh α m x f m sinh α m x cos α m z d 2 its derivative in x direction may be written as 27 ϕ x ϕ p x e 1 α m m 2 e m sinh α m x f m cosh α m x cos α m z d 2 28 ϕ x ϕ p x e 1 α m m 2 e m sinh α m x f m cosh α m x cos α m z d 2 in which ϕ p and ϕ p x are the particular solution and its x derivative as in eq 14 and eq 15 all subscripts and denote the interfaces of the upstream and downstream sides by integrating both sides of eq 25 and eq 26 over d 2 d 1 and eliminating all high order terms one obtains 29 d 2 d 1 ϕ d z d 2 d 1 ϕ p d z e 1 x d 2 d 1 f 1 d 2 d 1 30 d 2 d 1 ϕ d z d 2 d 1 ϕ p d z e 1 x d 2 d 1 f 1 d 2 d 1 in view of eqs 29 and 30 we have 31 e 1 d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t 32 f 1 x d 2 d 1 ϕ d z x d 2 d 1 ϕ d z x d 2 d 1 ϕ p d z x d 2 d 1 ϕ p d z b t where b x x and t d 2 d 1 are the length and the thickness of the slit respectively on the other hand by multiplying both sides of eq 25 and eq 26 by cos α m z d 2 m 1 noting the orthogonality property and integrating over d 2 d 1 one obtains 33 d 2 d 1 ϕ cos α m z d 2 d z d 2 d 1 ϕ p cos α m z d 2 d z i m e m cosh α m x f m sinh α m x 34 d 2 d 1 ϕ cos α m z d 2 d z d 2 d 1 ϕ p cos α m z d 2 d z i m e m cosh α m x f m sinh α m x in view of eqs 33 and 34 the unknown coefficients in higher order terms can be expressed as 35 e m sinh α m x d 2 d 1 ϕ cos α m z d 2 d z sinh α m x d 2 d 1 ϕ cos α m z d 2 d z sinh α m x d 2 d 1 ϕ p cos α m z d 2 d z sinh α m x d 2 d 1 ϕ p cos α m z d 2 d z i m cosh α m x sinh α m x sinh α m x cosh α m x 36 f m cosh α m x d 2 d 1 ϕ cos α m z d 2 d z cosh α m x d 2 d 1 ϕ cos α m z d 2 d z cosh α m x d 2 d 1 ϕ p cos α m z d 2 d z cosh α m x d 2 d 1 ϕ p cos α m z d 2 d z i m sinh α m x cosh α m x cosh α m x sinh α m x where i m is the inner product of the vertical eigenfunctions and is given by 37 i m d 2 d 1 2 m 1 by inserting eq 31 eq 32 and eq 35 and 36 into eq 27 and eq 28 eliminating the unknown parameter series e m and f m and the boundary condition at the interface can be expressed in terms of ϕ and ϕ x at x x 38 ϕ x ϕ p x d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t α m m 2 d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh α m b d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b sinh 2 α m x cosh 2 α m x cos α m z d 2 at x x 39 ϕ x ϕ p x d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t α m m 2 d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh 2 α m x sinh 2 α m x d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh α m b cos α m z d 2 the derived boundary condition in eq 38 and eq 39 relates the normal velocity to the integration of velocity potential on both downstream and upstream side interfaces i and i in the numerical approach the integrals are evaluated as the sum of the values on a series of line elements on the interface here we adopt low order panels and assume that the velocity potential is identical on each line element without losing generality the downstream and upstream side interfaces are discretised with same number of elements n with equal length the indices of the elements are denoted as j 1 2 3 n and j 1 2 3 n inserting the matching boundary conditions eq 24 into eq 38 and eq 39 the boundary condition of the velocity potential in external domain can be thus written in the following matrix form 40 φ n φ n φ n φ x φ x φ p n a φ φ a f d r i in which a is the operator matrix relating φ and φ n and f d r i φ p d r i φ p d r i t is the non homogenous component due to the particular solution the matrix a can be further divided into four submatrices 41 a 2 n 2 n a 1 a 2 a 3 a 4 each submatrix has the size n n and can be further expressed as 42 a n n k s n m k r m n k where k 1 2 3 4 is the index of the submatrices the infinite series in eq 38 and eq 39 are truncated at mode m and m 1 2 3 m is the index of the mode referring to eq 38 and eq 39 the parameter matrices s k and r k are different at downstream and upstream side interfaces and are calculated separately the contribution of each mode m at each element j is calculated as 43 s j m 1 1 cosh α m b cos α m z j d 2 j 1 j 1 44 r m j 1 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 45 s j m 2 1 sinh 2 α m x cosh 2 α m x cos α m z j d 2 j 1 j 1 46 r m j 2 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 47 s j m 3 1 cosh 2 α m x sinh 2 α m x cos α m z j d 2 j 1 j 1 48 r m j 3 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 49 s j m 4 1 cosh α m l cos α m z j d 2 j 1 j 1 50 r m j 4 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 in the above equations q z 1 and q z 2 are the vertical coordinates of start point and end point of each element δ t is the length of each element and the vertical coordinate of the middle point of each element is denoted as z j similar to those in eq 24 39 all superscripts and denote the downstream and upstream side interfaces the contribution of the particular solution can be easily calculated from eq 14 and eq 15 depending on the different components of diffracted or radiation waves the non homogenous components can be expressed as 51 f d φ i φ i 52 f r 2 z j z j 53 f r 3 x z j x z j the particular solution of sway motion is zero the boundary condition in matrix form in eq 40 is incorporated into the boundary integral equation eq 20 of the external subdomain s and the global matrix is assembled as 54 1 2 e g n gq φ g φ n ga f d r i where 55 q d i a g i k e 0 i k e ω 2 g e 0 a 56 φ n 0 φ p n where φ p n is non zero on the elements in s w i and i the elements are arranged in the sequence of upstream s u seabed s b downstream s d free surface s f breakwater wall s w and downstream i and upstream side interface i the boundary integral equation accounting for internal subdomain eq 23 is eliminated from the global matrix after the velocity potentials have been solved the wave excitation force added mass and radiation damping can be calculated by the integration on the body surface it should be noted that the calculation of hydrodynamic parameters related to heave motion should involve the integration of internal surfaces of the slit where no actual mesh has been generated however it has been found in the parametric studies that the homogenous components in eq 12 contribute very little to the heave related hydrodynamic coefficients the contribution of the internal subdomain s on heave motion and the vertical component in roll motion can thus be calculated simply by integrating the particular solution φ p on the two horizontal slit walls 3 3 artificial viscous damping model the numerical model as described in section 3 2 assumes no viscous damping however in reality viscous damping accounts for a significant part of the performance of the porous breakwater in this study the overall viscous effect is separated into two parts one part accounting for the viscous effect of the breakwater walls which exists both in non porous and porous breakwater and the other part for the extra viscous damping induced by the sharp edges of the slit referring to taniguchi and kawano 2003 the viscous damping on the breakwater wall is modelled by altering the wall boundary condition to 57 φ n φ p n i ε k φ where ε is an arbitrary artificial viscous damping coefficient the method is adopted in the commercial software hydrostar for modelling the viscous damping on the walls of the sloshing tank taniguchi and kawano 2003 bureau veritas 2007 the change in boundary condition leads to the modification of boundary integral equation eq 20 to the following boundary integral equation 58 1 2 φ p s u g n p q i k g p q φ q d q s d g n p q i k g p q φ q d q s f g n p q ω 2 g g p q φ q d q s b g n p q φ q d q s w g n p q φ q g p q φ p n i ε k φ q d q i i g n p q φ q g p q φ q n d q the extra viscous damping induced by the slit is modelled by adding a pressure drop at the interface while the continuity of the velocity remains unchanged an efficient boundary condition was developed in bennett et al 1992 based on the euler equation which can be expressed as 59 ϕ t φ t f 2 u u l u t where f is the head loss coefficient and l the effective orifice length for a linear model as in the present study the higher order term has to be linearized here we apply the linearization in kim et al 2014 and adopt the modified form of the drag term 60 f 2 u u β u β 4 u 3 π where β is the linearized loss coefficient and u denotes the amplitude of the velocity similar boundary conditions are also applied on the downstream interface the boundary condition can thus be written as kim et al 2014 61 ϕ φ i β ω l ϕ x the change of boundary condition at the interfaces leads to the modified boundary condition in the following matrix form 62 e i β ω l a φ n φ p n a φ af the boundary condition as in eq 61 can also be applied on either the front wall or the back wall only instead of both sides in reality the pressure drop in upstream and downstream side interfaces may not be the same however as the loss coefficients applied here as an arbitrary parameters accounting for the viscous effect and will be calibrated against physical experiments applying the boundary conditions in different ways will lead to similar results the head loss coefficient is highly dependent on the opening shape of the slits which will be discussed further in section 5 1 3 4 breakwater with multiple slits the numerical model is developed based on the assumption that there is only one slit in the breakwater for cases with multiple slits where the downstream and upstream side interfaces are denoted with i 1 i 2 i n and i 1 i 2 i n the local operator matrix for each pair of interfaces a n will be calculated separately with the numerical integration on each interface pair i n and i n the global operator matrix a may be assembled as 63 a d i a g a 1 a 2 a n the other components of the global matrix q remain unchanged the artificial damping model in 3 4 can be applied on each separate slit with different empirical damping coefficients 3 5 incorporation with conventional hybrid bem for computational domain reduction as is reviewed in section 1 the application of hybrid bem in existing literature has largely focused on the reduction of the computational domain fig 2 shows the reduced computational domain in the present hybrid bem instead of extending the computational domain to the far field s u and s d the conventional hybrid bem selects arbitrary vertical boundaries s u and s d which are closer to the breakwater body since the influence of the evanescent modes is not negligible at this close distance the velocity potential accounting for the upstream and downstream domain need to be written in the complete form 64 φ d r i 1 a 1 i cosh k z h e i k x m 2 a m i cos λ m z h e λ m x l 65 φ d r i 3 d 1 i cosh k z h e i k x m 2 d m i cos λ m z h e λ m x l where a mi and d mi are unknown coefficients and the fluid domain is truncated at x l here we assume a constant water depth the present approach of eigenfunction expansion in the multiple slits can be easily incorporated with the conventional bem of the truncated domain which further reduces the required number of elements for a perforated breakwater problem as the conventional hybrid bem is already well developed as in koley and sahoo 2017 its formulation is given herein without more detailed proof based on the eigenfunction expansion in the form of eq 64 65 the boundary conditions on the fortuitous upstream side vertical boundary s u can be expressed as 66 φ x d r i 1 i k cosh k z h h 0 φ d r i 1 cosh k s h d s i 1 m 2 λ m cos λ m z h h 0 φ d r i 1 cos λ m s h d s i m similarly the downstream side boundary condition s d can be expressed as 67 φ x d r i 3 i k cosh k z h h 0 φ d r i 3 cosh k s h d s i 1 m 2 λ m cos λ m z h h 0 φ d r i 3 cos λ m s h d s i m where i m is also the inner products of the eigenfunctions similar to eq 37 68 i m h 1 2 sinh 2 k h 4 k m 1 h 1 2 sinh 2 λ m h 4 λ m m 1 the eigenvalues determined by the dispersion relation is expressed as 69 λ 1 i k ω 2 g k tanh k h 70 ω 2 g λ m tanh λ m h m 1 together with the present approach the boundary conditions are incorporated into the boundary integral equation in the matrix form of 71 q d i a g q l 0 q r ω 2 g e 0 a so that the matrix form of boundary conditions eq 66 67 q l and q r are applied instead of the far field boundary conditions as shown in fig 2 the reduced elements due to a shortened computational domain by conventional method is highlighted in red while those reduced elements due to elimination of slit area by present method is highlighted in blue the combined approach yields a higher computational efficiency for determining the hydrodynamic parameters the comparison of the efficiency and element numbers of the present approach and a multi domain bem with complete fluid domain is presented in section 4 3 4 verification and parametric study of 2d breakwaters 4 1 convergence study of numerical model the convergence of the numerical results obtained from the hybrid bem method depends on both the mesh size and the number of evanescent modes as a result convergence studies involving the two variables were first carried out the numerical method applied was formulated in the form of eq 55 with a fully extended fluid domain referring to koley and sahoo 2017 the absolute size of the mesh should be proportional to the input wave length l table 1 shows the results of wave reflection coefficient k r transmission coefficient k t and horizontal excitation force f x calculated with mesh sizes varying from 0 05l to 0 002l the geometry of the breakwater remains unchanged the centreline of the slit is denoted as d c the parameters were calculated with three different input wave numbers kd 0 3 0 6 and 0 9 in the calculations the number of evanescent modes was set at m 10 referring to williams et al 2000 the upstream and downstream boundary were generally set to be 6h away from the structure walls while a shorter boundary distance varying from 3h to h was applied for shorter waves the results show that when the mesh size was refined to 0 005l or smaller the numerical solution to all hydrodynamic parameters converge to 2 or 3 decimal places the vertical excitation force is not influenced by the discretion of the fluid domain boundaries and remains constant at every calculated frequency table 2 shows the convergence study of evanescent modes referring to the analytical solution in eq 12 eq 13 the convergence speed of evanescent modes should be dependent on the thickness of the slit as smaller thickness t leads to larger eigenvalues and thus faster convergence of the higher mode contribution as a result three different thicknesses t 0 1d 0 4d and 0 7d were studied with mesh size kept identical at 0 005l the results reveal that when the number of modes was increased from m 1 to m 10 the hydrodynamic parameters of thin slit case t 0 1d remain largely unchanged with only up to 0 2 difference however a 9 difference in wave excitation force and 7 5 difference in added mass exist for the thick slit case t 0 7d the influence of the evanescent modes on wave reflection and transmission coefficient is less significant when compared with other coefficients which possibly results from the evanescent modes dissipating in the far field based on the convergence study the number of total modes m 10 is chosen for the 2d parametric study cases in the following section 4 2 verification of analytical solution with existing results in the following sections the numerical solution will be verified with analytical solution for rectangular breakwaters obtained from the eigenfunction matching method the analytical method is first verified with results from existing literature so that it can be used to assess the accuracy of numerical method the diffraction potential of non porous breakwater is calibrated by comparing the calculated reflection coefficients against analytical results obtained by mei and black 1969 the same sets of parameters were applied with h 2d a d 3d and 5d as shown in fig 3 fig 4 shows the comparison of added mass and damping coefficients with respect to the non dimensional wave number kh the calibration case refers to the analytical and bem solution in zheng et al 2004 reproduced as dots in fig 4 a high accuracy of results was achieved as the present paper applies a similar approach in solving non porous breakwaters with a different form of eigenfunction in subdomain 2 the analytical results of perforated breakwater were compared with the results of previous studies for a special case where the breakwater hull extends to the seabed leaving only one slit in the middle for wave transmission the subdomain 2 is thus non existent in this special case for very long wave conditions kh 0 we checked the asymptotic behaviour of the present solution against the analytical results of a thin vertical wall with one slot the case of a very narrow breakwater with a 0 002d was thus calculated and the results were compared with the thin vertical wall solution given by porter and evans 1995 in fig 5 a as the present method does not allow for zero width breakwater the non zero width results in slightly lower transmission coefficients for larger kh while the results are identical to those in porter and evans 1995 when kh 0 the wide slotted barrier problem was solved with the same method and the results compared to those in reference liu and wu 1987 where the source like behaviour of the wave potential was exploited and a matched asymptotic expansion method was applied following the practice in liu and wu 1987 the data is plotted in fig 5 b in the form of transmitted wave energy t 2 against wave length parameter kd c 2π it can be seen that the solution of present approach matches well when the width of the breakwater is considerable the present results were also compared with experimental data performed for a barrier with finite thickness and water depth as presented in guiney et al 1972 the results of transmitted wave energy t 2 have been plotted against the relative wave length h λ in fig 6 a and b the design of the barrier is similar to that discussed in fig 5 b consequently the results show good agreements for shorter waves while the difference in results increases for longer waves 4 3 comparison of accuracy and computational efficiency with multi domain bem the highest efficiency of the present approach is achieved by having a reduced computational domain by using the formulation in section 3 5 a comparative study is presented here to demonstrate the robustness of the present approach by comparing the required number of line elements and time of computation of present approach in 3 5 and the conventional multi domain bem with fluid domain extending to far field the two approaches for reducing the number of elements required have been discussed in section 3 the truncation of computational domain and the elimination of slit elements the combination of the two approaches would guarantee the maximum efficiency the breakdown of the mesh required for different numerical approaches is listed in table 3 the mesh number varies with both the incident wave length and the numerical approaches and the element numbers are consequently listed as a range the number of elements of the bem methods with or without removed slit domains and computational domain truncation were compared it can be seen that the number of elements on the body can be many times larger if the four horizontal slit walls were modelled with actual elements because the walls have the same width and discretization as the breakwater bottom the reduction in the total element number leads to a shorter computational time when the matlab program was executed with a single processor on a desktop computer with windows 10 os and intel core i7 7700 cpu it took a cpu time of 6 106s to calculate 40 wave numbers using the hybrid bem in the formulation of eq 71 as compared with 44 618s using the multi domain bem fig 7 shows the comparison of the hydrodynamic parameters calculated by multi domain bem and hybrid bem in the formulation of eq 71 the analysed geometry is a d d c1 0 4d d c2 0 8d t 0 1d l d h 2d d c1 and d c2 denote the vertical positions of the slit centreline a total of 40 non dimensional wave numbers kd 0 1 4 0 was simulated the results show that the present approach gives the same results as the conventional approach 4 4 parametric studies of 2d porous breakwater in this section the hydrodynamic performance of a rectangular breakwater with single or multiple slits and various geometries was studied as a parametric study the hydrodynamic parameters of the single slit breakwater were calculated by both analytical eigenfunction matching method and present numerical methods no artificial damping was applied in the model and all the influences induced by the porosity are the potential flow effects the comparison study of the analytical and numerical results is also used as a verification of the numerical method 4 4 1 influence of breakwater porosity the influence of porosity on the hydrodynamic performance of the rectangular breakwater was first studied the hydrodynamic parameters related to wave diffraction potential were plotted with respect to the non dimensional wave number kd in fig 8 the analytical results wereplotted with lines and the numerical results with dots while the breakwater geometries b 2d h 2d and the centreline of the slit d c 0 5d remain the same in all cases three different slit thicknesses t 0 1d 0 2d and 0 4d were applied to the calculation the wave forces and moments were normalized with half width of the breakwater a 0 5b so as to keep the data form identical to the verification cases in fig 3 fig 8 a shows that the wave reflection coefficients are significantly reduced with respect to increasingporosity restricted by energy conservation the wave transmission coefficients are correspondingly increased the results indicate that under potential flow assumptions the porous breakwater sacrifice part of the breakwater s wave blocking efficiency in exchange for low reflection and calmer sea in the upstream area however the conclusion may be different when considering damping induced by the porosity as shown in the following section 5 2 with regard to wave excitation forces it is found that the slits in the horizontal direction do not influence the vertical excitation force and the results are thus not plotted here on the contrary the horizontal wave force and the overturning moment are significantly reduced by the porosity when quantifying the reduction of the horizontal wave force plotted in fig 8 c it can be found that the reduction rates in all cases are higher than the porosity of the structure when compared with the non porous breakwater the maximum wave excitation force is reduced by 17 0 34 5 and 55 2 corresponding to 10 20 and 40 porosity this can be explained by analysing the change of hydrodynamic pressure on the vertical walls the pressure induced by incident wave potential is not altered by the slit but the overall froude krylov force will be reduced as the perforated walls have a reduced projected area as compared with non porous walls on the other hand as plotted in fig 9 the pressure induced by wave diffraction potential is reduced on the front and back wall with the presence of the slit combined with the constant incident wave potential the total hydrodynamic pressure on the vertical wall is also lower as a result the wave force on the porous breakwater is the integration of lower pressure on a reduced surface area the overturning moment m y is influenced by the slit in a similar manner similarly the hydrodynamic parameters related to wave radiation potential namely the added mass and potential damping were also calculated analytically and numerically the normalized results were plotted with respect to kd in fig 10 it can be observed that the influence of porosity on sway added mass and damping is strongly frequency dependent the maximum reduction of added mass takes place in small wave number cases while the peak of the potential damping is significantly reduced by comparison the influence of porosity on heave motion is mostly hydrostatic it can be seen that a larger slit thickness leads to a higher added mass but the increment is largely independent from wave frequency the analysis of the analytical results shows that the increment approximately equals ρ g b t m which is the contribution of the integration of the particular solution φ p z on the two slit walls at z d 1 and z d 2 the potential damping a 2 is not affected by the slit as a result it can be concluded that the increase of the heave added mass due to the slit equals the solid mass of the water in the slit meanwhile the heave radiation potential remains unchanged in porous and non porous breakwater cases the roll added mass m 3 is under the joint influence of horizontal and vertical forces and would thus decrease at small wave numbers and increase as the wave numbers become larger the general pattern of roll potential damping follows that of the sway motion the analysis of the hydrodynamic parameters reveals that the slit has a general effect of weakening the wave diffraction and radiation by allowing passage of wave energy to the downstream area 4 4 2 influence of slit layouts the following studies show that the porosity is not the only factor that affects the hydrodynamic parameters of the breakwater with the same porosity the position and number of the slits also have an impact on the breakwater performance which is the reason why the exact slit position and layout have to be modelled numerically fig 11 shows the hydrodynamic parameters of the breakwater with the same geometry b d h 3d and same slit thickness t 0 1d but with different centreline positions of the slit d c it can be seen that as the vertical position of the slit is moved from close to the surface d c 0 3d to the bottom d c 0 7d the reflection coefficients increase by around 5 as the transmission coefficients decrease by about 35 on average this is in accordance with intuitive expectation that as the wave energy concentrates more on the surface an opening close to the surface allows more wave energy to pass as a result with the same porosity the wave blockage of the breakwater with a slit near the free surface is less than that with the same slit located near the bottom however the wave excitation force on the structure can also be reduced by around 8 7 by comparing fig 11 d with fig 11 c it can be seen that the overturning moment is less influenced by the vertical position of the slit because the overturning moment induced by vertical wave force is not affected and only the moment from horizontal wave force is changed the influence of slit vertical position on added mass and damping terms is plotted in fig 12 as the depth of the slit increases the wave blockage is stronger resulting in a larger amplitude of added mass and damping coefficients for sway and roll motions on average a 33 change in sway added mass can be achieved by moving the slit from d c 0 15d to d c 0 35d the heave added mass and damping are insensitive to the positions of the slit because the heave radiation potential is not much affected by the horizontal slit by comparing the results in figs 12 and 10 the reduction in the depth of the slit has a similar effect as the slight expansion of its thickness the conclusions of the parametric study on single slit breakwater also apply to multi slit cases the influence of the vertical position of two slits on the hydrodynamic parameters are plotted in fig 13 various combinations of slit positions have been simulated with the minimum distance between slits set at 0 1d the results show that the largest reduction of diffracted and radiation potentials can be achieved when both slits were placed near the free surface d c1 0 2d d c2 0 4d while the least effective combination of slits occured when the slits were placed near the bottom d c1 0 6d d c2 0 8d the other simulated cases result in values lying in between in particular by placing the slits symmetrically with respect to the middle depth d c1 0 2 d c2 0 8 or d c1 0 4 d c2 0 6 the results are basically the mean value of all cases it is also similar with placing one slit in the middle depth with doubled thickness d c 0 5d t 0 2d as a result an evenly distributed layout of slits on the entire wall which is often adopted in designs would achieve an average performance of perforated breakwaters 4 4 3 comparison with existing porous breakwater design the slit breakwater studied herein is compared with a fixed perforated breakwater concept proposed by somervell et al 2017 in somervell et al 2017 the breakwater is composed of two vertical perforated thin walls that extend all the way from the free surface to the seabed the spacing between the two walls is denoted as 2a and the walls have a constant porosity ratio of ε 0 2 for the comparison study we consider our perforated thick breakwater design to have a single slit and a width 2a which is equivalent to the spacing between the two vertical walls in somervell et al breakwater design the water depth h is assumed to be twice the draft d i e h 2d the width of the breakwater is assumed to be equal to the draft d i e 2a d the slits are placed at various heights of the breakwater while keeping a constant thickness t 0 2d so that the equivalent porosity ratio is also ε 0 2 the wave reflection and transmission coefficients are plotted with respect to h λ in fig 14 where λ is the wavelength it can be seen the transmission coefficients for the slit breakwater with d c 0 8d are similar to those of the somervell et al breakwater this indicates that the draft of the floating breakwater does not need to extend to the seabed the floating breakwater with a shallower draft does not compromise too much on the wave blockage performance and at the same time has a smaller impact on the environment under the non viscous assumption the calculated wave reflection is however much larger than that in somervell et al 2017 in reality the viscosity induced by the slit and the sharp corners of the wide breakwater would lead to smaller wave reflection as it can be seen in the model test data reported in section 5 3 5 3d case study comparison and analysis of model test data 5 1 simplified 3d formulation the present numerical approach can also be conditionally applied in some 3d numerical studies consider a rectangular slit that goes through the breakwater with length 2a with centre of the opening area at a y0 z0 and a y 0 z 0 the incident wave is considered to be in normal direction which is the case for the channel flow in the wave flume tests the width and the depth of the slit are t b and t d respectively similar to the 2d solution the eigenvalues in the y and z directions are determined by the slit width and depth and a simple series of trigonometric function can be used as eigenfunctions similar to the 3d expansion in the moonpool problem in molin 2001 the velocity potential in the semi confined fluid domain inside the slit can be written as 72 ϕ x y z ϕ p e 11 x f 11 m 2 n 2 e m n cosh α m n x f m n sinh α m n x cos β m y 1 2 t b y 0 cos γ n z 1 2 t d z 0 where α m n β m 2 γ n 2 β m m 1 π t b γ n n 1 π t d the matching conditions of normal velocity and pressure continuities at the interface still need to be satisfied while the integration takes place on the 2d opening area without giving the complete solution to the matching problem here we consider the problem regarding long and slender slits with an opening area and dimensions much smaller when compared to the breakwater dimensions and the incident wave length the slender slit assumption is proposed based on the observation that the porous breakwater designs more often involve multiple slits and openings of small sizes on the walls e g in alkhalidi et al 2015a kou et al 2019 ji et al 2019 dai et al 2018 the complete solution for wide slits with large openings is not within the scope of this study as it can be seen in table 4 the hydrodynamic parameters converge very fast when the number of modes increases especially for cases with small t for a slit thickness t 0 4d the calculated results only change around 3 by increasing the number of modes from m 1 to m 10 this implies that the lowest mode is predominant in determining the flow characteristics inside the slender slit as a result it is a convenient way to consider only the lowest mode m 1 n 1 in eq 72 for slender slits without compromising much on the computational accuracy further it can be noticed that for diffracted wave the simplification leads to the combined potential and normal velocity 73 ϕ ϕ i ϕ d e 11 x f 11 74 ϕ x ϕ i x ϕ d x e 11 which physically implies that the fluid passes through the slit with a uniform amplitude velocity a piston like behaviour without any sloshing like fluctuation in y and z directions this means that the operator matrices can be calculated in the same way as in 2d method since the variables y and z are eliminated from the equation apart from the simplicity by considering only the lowest mode the influence of different shapes of openings can also be simplified for a slit with non rectangular openings an eigenfunction series of explicit form may not be possible to establish however the lowest mode describing a uniform normal velocity in x direction remains unchanged the velocity potential would have the general form of 75 ϕ x y z φ p e 11 x f 11 m 2 n 2 f x g y z where the eigenfunctions are not determined by considering the lowest mode and a uniform velocity profile through the slits the exact expression of the higher modes is no longer needed for the analysis and the fluid domains inside slender slits with all opening shapes will have the velocity potential in the form of eq 73 and eq 74 although the shape of the openings does not influence the formulation of the velocity potential inside the slits by neglecting higher modes it is acknowledged that the shape of the slits generally has an effect on the energy dissipation near the openings mei 1989 in previous studies the influence of the opening geometries have been accounted for by applying different artificial damping coefficients in the matching boundary condition it has been suggested by bennett et al 1992 mei 1989 that the head loss coefficient f in eq 59 60 can be calculated as 76 f w b c w a 1 2 where w b and w a are the half width of the structure and the opening respectively and c is an artificial discharge coefficient which is sensitive to the shape of the slit opening the experimental data presented by daily and harleman 1966 suggests c 0 62 1 0 for a circular opening while it is recommended in mei et al 1974 that the empirical relationship c 0 6 0 4 η 2 be used for rectangular openings where η is the porosity the empirical formulae have been applied and verified in bennett et al 1992 the simplified 3d method can be used to better understand the experimental results once the empirical damping coefficients are calibrated it can also be used to estimate the hydrodynamic parameters not measured in the tests the following study shows the 3d numerical simulation of wave flume test of a rectangular breakwater with multiple horizontal slits inside carried out for the concept validation of a novel concept of porous breakwater as described in detail in han and wang 2020 5 2 model test setup the isometric view of the test model is shown in fig 15 in the horizontal direction the model is separated into 5 porous compartments designated as p1 to p5 and 6 non porous ones designated as b1 to b6 the porous compartments have two types of sections namely section a for p1 p3 highest opening space reserved for installation of gaskets and p5 and section b for p2 and p4 side views of sections a and b are shown in fig 16 with the dimensions of the slits the compartments are separated by watertight bulkheads and the non porous compartments are used as ballast tanks in the test in the vertical direction up to seven layers of slits designated as s1 to s7 from the lowest layer to highest layer were arranged when constructing the physical model straight pvc tubes with 50 mm outer diameter are inserted to form the slits in total there are 17 openings on each side of the wall and the total opening area is 0 033 m2 the experiments were performed in the wave flume of the hydraulics lab in the university of queensland australia the wave flume measures 24 m long 1 m wide 1 m deep a model scale of 1 50 was adopted with a constant water depth of 0 60 m with 0 9 m long 0 9 m wide in order to investigate the breakwater response with different drafts the model was raised vertically and fixed at different levels the model was placed at the mid point of the flume between the wave paddle and the absorptive beach at the other end and was kept stationary by bolting it to rigid frames that were clamped to the wave flume as well as supported at the bottom by small wooden boxes filled with sand as shown in fig 17 the wave reflection was measured by three wave gauges numbered 2 to 4 placed at the upstream and two wave gauges 5 and 6 at the downstream so as to measure the transmitted wave heights the wave reflection and transmission coefficients were then calculated from recorded data wave gauge wg1 was placed near the structure to measure the wave elevation immediately before wave run up wg7 is placed along the tilted deck for the monitoring of possible wave run up in deeper drafted cases fig 18 shows a photo of the breakwater model in the wave flume the slits were physically modelled by inserting pvc tubes into the breakwater hull through the openings on the front and back walls the breakwater structure can be made non porous by sealing the openings with plugs four different drafts of d 0 27 m 0 32 m 0 37 m and 0 42 m were tested three wave heights of h 0 06 m 0 10 m and 0 15 m were considered in the regular wave tests the tested wave periods range from 0 6s to 3 0s corresponding to around 4 2s 21 2s in full scale this is in accordance with the design sea state of the present case han and wang 2020 with 100 year design wave condition to be h s 8 4m t p 13 9s an active wave absorption scheme is adopted in wave generation to reduce the effect of re reflection in the upstream area table 4 presents the geometry and dimensions of the model in reduced scale and table 5 shows the test parameters 5 3 comparison between numerical and experimental results the model test was performed to investigate both breakwater efficiency and wave run up on the breakwater deck here we only simulate the shallow drafted cases with draft d 0 27m and d 0 32m in which no wave run up on the deck has been observed under small waves h 0 06m owing to the large number of elements required to simulate the entire length of the wave tank the fluid domain of the numerical model was shortened to be 6 0 m 1 0 m x 0 6 m other dimensions are kept identical as in the model test the 3d panel mesh was visualized by using the mesh visualization module in the commercial software hydrostar bureau veritas 2007 an example of generated mesh is shown in fig 19 in fig 19 the mesh at the interfaces was hidden so that the positions of the slits can be demonstrated only the fully submerged slits will be considered in the numerical study as can be seen in fig 19 b a total number of 10 slits numbered s1 to s4 in fig 15 have to be modelled at their exact position which would require extensive efforts in modelling and computation without the proposed simplified approach the slits have a side length of 0 05 m which is 5 of the breakwater width and 15 18 of the draft consequently the slits were considered slender and the simplified 3d approach was applied the size of the mesh was kept similar to that in the 2d numerical simulation the number of the mesh varies from 4000 to 7000 the same artificial damping coefficients were applied on the all the interfaces the slits were still modelled as rectangular which differ from the cylindrical tubes used in the model test however as it was already discussed in section 5 1 only the lowest mode was needed to be considered for slender slits the influence of the slits was consequently modelled by allowing a 1d uniform flow through the slits the different opening shapes would only influence the artificial viscous damping coefficients 2d and 3d numerical results of 1 non porous breakwater 2 perforated breakwater without artificial damping 3 perforated breakwater with artificial damping were compared with model test results tested under random waves and plotted against tested wave periods in fig 20 both 2d and 3d results were presented in which the geometry of section a in fig 16 was applied for 2d study the results associated with section b as geometrical input were similar to those of section a and hence they will not be presented herein in the study a uniform damping coefficient on the structure walls ε 0 005 so that the viscous effect could be accounted for in non porous breakwater cases the artificial damping parameters at the interface were taken as β 0 5 l 0 5 these values were adopted for convenience so that the numerical results could best fit the experimental ones and other sets of parameters leading to similar results may also exist the 3d results show that the general pattern of the numerical results without damping were similar to that in 2d analysis the reflection coefficients were reduced by the multiple slits while the transmission coefficients were increased however the experimental data though less conforming than the numerical results show that the transmission coefficients remain largely unchanged by the slits when artificial damping was added to the interface the qualitative conclusions from numerical and experimental results become identical by comparing the 2d and 3d numerical studies it is clear that the 2d results significantly overestimated the influence of the slits when compared with non porous counterparts the 2d porous case with 2 slits shows an average reduction of k r by approximately 37 while the reduction of k r is approximately 11 for the 3d case this is reasonable as the 3d model comprises both porous and non porous compartments as shown in fig 15 whereas the 2d case assumes that the slits extend across the entire width the equivalent porosity ratios in 2d cases are consequently 31 37 as compared to 8 6 10 3 in 3d cases the numerical approach after calibrating against the model tests can also be used to perform an initial estimation on the parameters that are not measured in the tests fig 21 shows the calculated horizontal wave forces using the same viscous damping parameters as in fig 20 the force is normalized with static pressure on the bottom area from the simulation a 16 reduction for case d 0 27 m and 14 reduction for case d 0 32 m in the wave forces can be expected with the porosity of the structure being 8 this is in accordance with the conclusions in the 2d numerical studies that the wave force reduction is higher than the porosity and the slits are more effective when placed closer to the interface unlike 2d numerical analysis a spike in wave transmission and reflection coefficients shows up at wave period around t 1 0 s this is possibly due to sloshing like behaviour as the 3d fluid domain was simulated in a confined space however the present numerical approach does not attempt to suppress this behaviour as the experiments seem to be influenced by the same effect as well the tested breakwater concept is designed to be non moving in the horizontal direction as it is restrained by caissons so the sway added mass and damping will not be presented here 6 summary and conclusions a hybrid boundary element method was developed to analyse the perforated breakwater with large horizontal slits that are sparsely distributed in the hull an appropriate boundary condition was derived by using the eigenfunction series of the velocity potential inside the slits so as to eliminate the need to model the slits by eliminating the mesh required for modelling the slits the method reduces the number of total elements and increases the efficiency of the numerical approach it can be used to analyse 2d or 3d perforated breakwater in channel flow with multiple horizontal slits while there is no restriction on the outer geometry of the breakwater the approach is however restricted to horizontal slits only in the present 3d analysis the influence of the multiple slender slits is simplified by considering the lowest mode of the velocity potential essentially it means allowing a uniform normal velocity in normal direction on the slit openings all studies presented herein are based on normal incident wave angle but directional waves can also be simulated in a similar approach by changing the eigenfunction the numerical method was verified with analytical results from eigenfunction matching method and good agreements have been achieved the 2d parametric study shows that the perforations induced by the slits generally weaken the diffracted and radiation potentials in the horizontal direction regardless of the position and size of the slits the weakening effect leads to changes in the hydrodynamic parameters the wave reflection horizontal wave force and overturning moment are reduced and wave transmission is increased further it is discovered that the percentage reduction of the horizontal wave forces is always higher than the porosity percentage of the breakwater for example a breakwater with 10 porosity shows a 17 decrease in the wave force a general reduction in sway and roll added mass and radiation damping can also be observed the 2d studies also emphasize the influence of the vertical positions of the slits and consequently the importance of modelling each slit at its exact position with the same slit geometry the effects on hydrodynamic parameters are more prominent when the position of the slits are placed closer to the free surface for example in the case study it is found that there is an average change of 5 in wave reflection coefficient 33 in wave transmission and 8 7 in wave force unlike predictions in 2d studies the data from the model test performed in the wave flume suggests that while the wave reflection coefficients reduce due to the slits the wave transmission coefficients would remain largely identical instead of increasing this means that the energy dissipation that takes place at the interfaces cannot be neglected further numerical studies show that the gap between numerical and experimental results can be minimized by applying the viscous damping model in addition the experimental results reveal that the perforated breakwater with large slits is advantageous in terms of reflection the test data shows that the reflection coefficients are reduced by approximately 10 with an 8 porosity while its efficiency will not be influenced by allowing water passage through the slits by using the same numerical method it is expected that the tested perforated breakwater attracts 14 16 reduction in horizontal wave force as compared with a solid breakwater with the same geometry the present findings provide insights for development of floating porous breakwaters in coastal infrastructure industry the floating breakwaters have relatively smaller benthic footprints and easily removed as compared to rubble mound breakwaters it is also a low wave reflection design with smaller reflection coefficients when compared to non porous breakwaters while its wave blocking capability is not weakened in addition some porous floating breakwater concepts have attached secondary structures such as porous sheets e g fig 8 in dai et al 2018 skirts e g fig 11 in dai et al 2018 or perforated walls kou et al 2019 to the main body the attached porous components attract extra wave loading as well as they increase the dead load of the breakwater as the proposed floating breakwater creates porosity inside the main body of the breakwater the outer geometry of the breakwater is unchanged and the internal slits do not attract extra wave loading as attached sheets do on the contrary the installed internal slits reduce the horizontal wave load while maintaining a constant vertical wave load the reduction of horizontal wave load is beneficial as it will lead to a less costly mooring system in practical designs of breakwaters it is worth noting that 1 the change of added mass due to the slits will alter the natural frequency of the breakwater and the motion responses under given incident wave conditions an effect that should be carefully studied 2 the static weight of the water inside the slits need to be considered during weight estimation and calculation of centre of gravity credit authorship contribution statement m m han methodology software formal analysis validation model testing writing original draft c m wang conceptualization supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful to the australian research council for providing the discovery project dp170104546 grant as well as to hyundai engineering and construction and the arc nanocomm hub for additional grants to perform this study appendix the example of forming the matrix and solving the unknown parameters in the analytical method is presented here by using eq 16 multiplying both sides of eq 16 by the eigenfunction cos α i z d 2 and integrating from z d 2 to z d 1 yields a 1 d 2 d 1 a d 1 cosh k z h e i k a m 2 a d m cos λ m z h cos α i z d 2 d z d 2 d 1 φ i e d 1 a f d 1 m 2 e d m cosh α m a f d m sinh α m a cos α m z d 2 cos α i z d 2 d z i 1 2 3 m the diffraction potential is calculated here while the radiation potential components can be solved in the same manner the linear equations above can be written in a matrix form a 2 ax f where x is the array of unknown parameters a 1 a m b 1 b m c 1 c m d 1 d m e 1 e m and f 1 f m a is the parameter matrix and f is the contribution of the non homogenous term φ i the orthogonality of the cosine function makes the parameter matrices related to e m and f m take on a diagonal form as d 2 d 1 cos α m z d 2 cos α i z d 2 d z is non zero only if m i with the same procedure each one of the matching equations 16 19 provides a matrix with an order m x m in total the unknown parameters will be calculated by solving the 6m 6m matrix 
21078,a hybrid boundary element method has been developed to efficiently solve the hydrodynamic response of a wide perforated breakwater with arbitrary hull geometry and multiple horizontal slits the fluid subdomains inside the slits were considered as rectangular and analytical eigenfunctions of the slit area were applied to derive the boundary condition at the interface the involvement of analytical solutions in the numerical boundary element method bem is the novelty of the present approach the 2d numerical solution was verified with analytical solution of perforated rectangular breakwater to show the validity of the proposed hybrid bem parametric studies have been performed to study the effect of porosity position and layout of the slits it has been found that the slits generally reduce the diffracted and radiation potentials and would be most effective when placed near the free surface the approach was also extended to 3d channel flow and the results were calibrated against an experimental study performed in the wave flume keywords porous breakwater hybrid boundary element method eigenfunction expansion model test hydrodynamics 1 introduction perforated breakwaters have the following advantages over their solid non porous counterparts i a lower reflection of waves which creates a calmer sea environment in the upstream area and ii a better dissipation of wave energy through viscous effect created by the pores or openings on the breakwater walls perforated breakwaters have been designed and applied in various forms for example layers of perforated plates or walls have been used either independently cho and kim 2013 faraci et al 2015 zhao et al 2017 liu et al 2018 alkhalidi et al 2015a or integrated with other offshore structures kou et al 2019 ji et al 2015 2019 dai et al 2018 a common feature of the abovementioned perforated breakwater designs is that each individual perforation is very small as compared to the structure dimensions and the porosity is evenly distributed on the surface of the plates as a result the effect of porosity can be readily incorporated in the modelling via a uniform damping coefficient applied on the entire porous surface many numerical studies based on the linear potential flow theory have been carried out to optimize the design of this type of perforated breakwater in which the porous effect can be accounted for by introducing a porous wall boundary condition with an empirical damping coefficient cho and kim 2013 zhao et al 2017 ning et al 2017 koraim et al 2011 somervell et al 2018 somervell et al 2017 a different kind of perforated breakwater concerns wide breakwater structures with large vacant spaces inside the breakwater which has been called differently in the literature as apertures slits pores water channels or water chambers the fluid spaces concerned are usually of considerable size and are sparsely distributed in the breakwater this type of structure has been studied experimentally by alkhalidi et al 2015a 2015c teh and venugopal 2013 various analytical and numerical models have also been developed a vertical barrier with finite width and one horizontal slit in deep water has been studied for both normal wave and oblique wave condition by guiney et al 1972 liu and wu 1986 1987 losada et al 1992 a multi layer surface piercing breakwater with single or multiple internal spaces was studied analytically by hu et al 2019 hu and liu 2018 while a rectangular breakwater with multiple l shaped internal water channels was studied by kim et al 2014 in these studies the solid walls and the openings of the internal spaces herein called slits were considered as separate boundaries instead of one porous surface the matching boundary condition satisfying the continuity of normal velocity and pressure is applied at the openings only liu et al 2018 ning et al 2017 somervell et al 2018 bennett et al 1992 isaacson et al 1999 mei 1989 the studies of breakwater with large and sparse slits have largely been confined in 2d rectangular breakwaters where analytical solution can be found by the eigenfunction matching method for breakwaters with arbitrary geometry however a suitable eigenfunction may be improbable to find and numerical approaches such as boundary element method have to be resorted for solution for these cases a multi domain boundary element method bem may be used koley et al 2020 mackay and johanning 2020 given the matching boundary conditions at the interface the boundary integral equations bie of external and internal domains can be separately formulated and then matched at the interface liu and li 2017 liu et al 2016 the main disadvantage is that the inclusion of multiple internal domains will significantly increase the number of the elements required in addition for 3d cases the multiple slits would complicate the topology of the structure and increase the difficulty in generating high quality meshing the present study aims at extending the research on perforated breakwaters to those with arbitrary outer geometry and rectangular slits by applying a hybrid boundary element method bem the hybrid boundary element method has been applied in many 2d bem studies wang and meylan 2002 koley and sahoo 2017 koley 2019 one of its main application is to derive a boundary condition that accounts for the contribution of the semi infinite domain extending from infinite distance to the vicinity of the body the diffraction or radiation wave potential to be solved is expanded into a series of eigenfunctions from which a boundary condition at the vertical interface can be derived an obvious advantage of this method is that the length of the fluid domain is largely shortened because the contribution of the evanescent modes is correctly accounted for at the interface and thus the fluid domain does not need to extend far away from the body for the evanescent modes to dissipate similarly a novel numerical method is presented herein which involves analytical eigenfunctions by using the eigenfunctions for the fluid velocity potential inside the slits a boundary condition can be derived at the interfaces between the slits and the outer fluid domain when compared to the multi domain boundary element method the proposed hybrid bem has the following advantages 1 the velocity potential in the internal domains of the multiple slits can be considered analytically which means that there is no need for meshing for its numerical modelling this leads to an overall reduction of the matrix size for solution and hence make the approach more computationally efficient 2 for 3d cases with complex geometries the elimination of slits leads to simpler discretization and grid generation thus saving time in the pre processing stage the paper is arranged as follows section 2 briefly discusses the analytical solution of a rectangular perforated breakwater by the eigenfunction matching method section 3 presents the formulation of the hybrid bem method with and without artificial viscous damping the results from the bem method are compared with analytical results in section 4 to show the validity of the present approach and a set of parametric studies carried out to identify the influence of the internal water channels on the hydrodynamic properties of the floating breakwater the model test performed for a multi slit breakwater and 3d numerical simulation of the tests are presented in section 5 to show a conditional application of the approach in modelling perforated breakwater in 3d wave channels the summary and conclusions are given in section 6 2 mathematical formulation of boundary value problem the formulation of the problem regarding perforated breakwater with horizontal slits share a lot of common boundary conditions and eigenfunctions with that of a solid breakwater as the latter has been well discussed in existing literature such as in references mei and black 1969 and zheng et al 2004 only the formulation regarding the horizontal slit will be highlighted here the geometry of the problem was defined as in fig 1 a the breakwater has a half width a and draft d the single slit goes through the breakwater and distances from the free surface to the upper and lower boundary of the slit are denoted as d 1 and d 2 respectively the water depth h is constant in the fluid domain the coordinate system is established with origin located on the free surface x axis pointing to the wave progressing direction and z axis upwards the rectangular breakwater is symmetrical with respect to the z axis the analytical approach solves the total velocity potential that satisfies the laplace equation 1 2 φ x z 0 in view of the linear potential flow assumptions the velocity potential of the incident wave φ i with unitary wave amplitude and an angular frequency of ω can be written as 2 φ i i g ω cosh k z h cosh k h e i k x where g is the gravitational acceleration k the wave number determined by the dispersion relation and h the water depth the scattered potential induced by the structures can be decomposed into a diffracted potential component and three radiation potential components so that the total velocity potential can be written as 3 φ φ i φ d i 1 3 φ r i where i 1 2 3 represents the degree of freedoms sway heave and roll φ d and φ r i are the diffracted and radiation potentials of each dof the following boundary conditions apply for each of these components 4 φ d r i z ω 2 g φ d r i a t z 0 x a x a 5 φ d r i z 0 a t z h 6 φ d r i x i k φ d r i 0 a t x 7 φ d r i x i k φ d r i 0 a t x in addition the wall boundary conditions on the breakwater walls have to be satisfied the boundary conditions on the outer walls are presented in earlier studies on solid breakwater such as references mei and black 1969 and zheng et al 2004 the boundary conditions on the two horizontal slit walls are given below diffracted potential 8 φ d z φ i z a x a z d 1 z d 2 z h sway 9 φ r 1 z 0 a x a z d 1 z d 2 z h heave 10 φ r 2 z 1 a x a z d 1 z d 2 z h roll 11 φ r 3 z x a x a z d 1 z d 2 z h in order to solve the boundary value problem the entire fluid domain is further separated into four subdomains 1 the upstream subdomain 2 downstream subdomain 3 breakwater bottom and 4 internal domain of the slit the velocity potential in each subdomain is marked with superscripts 1 4 the boundary value problem is solved by finding an eigenfunction that satisfies the laplace equation and the boundary conditions the eigenfunction in the slit domain 4 can be written as 12 φ d r i 4 φ p d r i 4 e d r i 1 x f d r i 1 m 2 e d r i m cosh α m x f d r i m sinh α m x cos α m z d 2 where a m d m e m and f m are series of unknown parameters to be solved subscripts d and r i denote the diffraction and radiation potentials α m is the vertical eigenvalue given by 13 α m m 1 π d 2 d 1 m 1 2 m where φ p d r i 4 is the particular solution satisfying the non homogenous boundary condition in eq 8 eq 11 for each component of diffraction and radiation potential it can be expressed as 14 φ p d 4 φ i 15 φ p r i 4 0 i 1 z i 2 x z i 3 by assuming no viscous damping effects on the interfaces between subdomains 1 4 and 3 4 the analytical solution can be derived by matching the eigenfunction expansions at two vertical boundaries at x a h z 0 and ensuring the continuity of normal velocity and velocity potential in particular the matching boundary conditions at the interface between the slit area 4 and the external subdomains 1 and 2 can be written as 16 φ d r i 1 φ d r i 4 x a d 2 z d 1 17 φ d r i 3 φ d r i 4 x a d 2 z d 1 18 φ d r i 1 x φ d r i 4 x x a d 2 z d 1 19 φ d r i 3 x φ d r i 4 x x a d 2 z d 1 the complete set of matching conditions consists of 6 equations in total the two additional equations that do not involve the slit area have been omitted for brevity for a complete representation of the matching equations and eigenfunctions in each subdomain one may refer to zheng et al 2004 for details all unknown parameters in the eigenfunction expansion series can be solved by multiplying the two sides of the matching boundary condition by corresponding eigenvalues integrated in the range of the boundaries and noting the orthogonality property the matching boundary conditions can be converted into a set of linear equations from which the unknown parameters can be solved as an example the matrix assembly and solution is demonstrated with the matching equation in the appendix the analytical solution of the rectangular perforated breakwater is used in section 4 for the verification of the numerical method 3 formulation of hybrid boundary element method 3 1 boundary integral equations for a perforated breakwater with arbitrary geometries an admissible eigenfunction may be difficult to find and the numerical approach has to be adopted to solve the boundary value problem the perforated breakwater with arbitrary outer geometries is shown in fig 1 b the fluid domain was separated into an external domain s and internal domain s the entire boundary of the fluid domain was separated into several segments the upstream s u downstream s d free surface s f seabed s b breakwater outer wall s w slit wall s w downstream side interface i and upstream side interface i the velocity potentials of external and internal domain were denoted as φ and ϕ respectively in particular the velocity potentials at the interfaces i and i were denoted as φ ϕ and φ ϕ by applying the boundary condition for each boundary segments as in eq 4 eq 7 the 2d boundary integral equation of the external domain may be written as the sum of line integrals on the boundary segments 20 1 2 φ p s u g n p q i k g p q φ q d q s d g n p q i k g p q φ q d q s f g n p q ω 2 g g p q φ q d q s b g n p q φ q d q s w g n p q φ q g p q φ p n d q i i g n p q φ q g p q φ q n d q in which p and q are the source and field points g and g n are the source function and its normal derivative φ q and φ q n are the potential and its normal derivative at point q and φ p n is the normal derivative of the particular solution that satisfies the wall boundary condition the boundary conditions on the free surface and the far fields as in eqs 6 and 7 are used in the boundary integral equation eq 20 the 2d and 3d source functions may be written as 21 g p q ln r 2 π for 2 d 22 g p q 1 4 π r for 3 d where r is the distance between the source point p and field point q similarly the boundary integral equation of internal subdomain accounting for the slit can be written as 23 1 2 ϕ p s w g n p q ϕ q g p q ϕ p n d q i i g n p q ϕ q g p q ϕ n q d q by assuming that there is no viscous damping at the matched interface the following matching boundary conditions are applied at the interfaces between external and internal domain at the two interfaces i and i 24 φ x ϕ x φ ϕ the integral equations 20 and 23 were assembled into a linear matrix equation to be solved for the unknown velocity potentials with nodes and elements on the interfaces been used twice note that the number of elements would be large for cases of multiple slits as the extra slit walls and interfaces have to be modelled 3 2 two parameter hybrid boundary element method in order to reduce the number of elements required for the numerical solution and the effort of meshing a hybrid boundary element method has been proposed as described below to solve this type of problem more efficiently we assume that on condition that the characteristic length of the horizontal slits is much larger than its thickness the geometry of the slit may be simplified as rectangular by slight modifications of the external geometries near the openings this assumption is taken since floating breakwaters usually do not involve mild slopes as in rubble mound breakwaters for a perforated breakwater with arbitrary geometry with rectangular slits and vertical openings as shown in fig 1 b the internal domain of the slits retain the eigenfunction in the form of eq 12 denoting the four convex points of the rectangular slits to be x d 1 x d 2 x d 1 and x d 2 as shown in fig 1 b the velocity potential on the upstream side interface i can be written as 25 ϕ ϕ p x e 1 x f 1 m 2 e m cosh α m x f m sinh α m x cos α m z d 2 similarly on the downstream side interface the velocity potential can be written as 26 ϕ ϕ p x e 1 x f 1 n 2 e m cosh α m x f m sinh α m x cos α m z d 2 its derivative in x direction may be written as 27 ϕ x ϕ p x e 1 α m m 2 e m sinh α m x f m cosh α m x cos α m z d 2 28 ϕ x ϕ p x e 1 α m m 2 e m sinh α m x f m cosh α m x cos α m z d 2 in which ϕ p and ϕ p x are the particular solution and its x derivative as in eq 14 and eq 15 all subscripts and denote the interfaces of the upstream and downstream sides by integrating both sides of eq 25 and eq 26 over d 2 d 1 and eliminating all high order terms one obtains 29 d 2 d 1 ϕ d z d 2 d 1 ϕ p d z e 1 x d 2 d 1 f 1 d 2 d 1 30 d 2 d 1 ϕ d z d 2 d 1 ϕ p d z e 1 x d 2 d 1 f 1 d 2 d 1 in view of eqs 29 and 30 we have 31 e 1 d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t 32 f 1 x d 2 d 1 ϕ d z x d 2 d 1 ϕ d z x d 2 d 1 ϕ p d z x d 2 d 1 ϕ p d z b t where b x x and t d 2 d 1 are the length and the thickness of the slit respectively on the other hand by multiplying both sides of eq 25 and eq 26 by cos α m z d 2 m 1 noting the orthogonality property and integrating over d 2 d 1 one obtains 33 d 2 d 1 ϕ cos α m z d 2 d z d 2 d 1 ϕ p cos α m z d 2 d z i m e m cosh α m x f m sinh α m x 34 d 2 d 1 ϕ cos α m z d 2 d z d 2 d 1 ϕ p cos α m z d 2 d z i m e m cosh α m x f m sinh α m x in view of eqs 33 and 34 the unknown coefficients in higher order terms can be expressed as 35 e m sinh α m x d 2 d 1 ϕ cos α m z d 2 d z sinh α m x d 2 d 1 ϕ cos α m z d 2 d z sinh α m x d 2 d 1 ϕ p cos α m z d 2 d z sinh α m x d 2 d 1 ϕ p cos α m z d 2 d z i m cosh α m x sinh α m x sinh α m x cosh α m x 36 f m cosh α m x d 2 d 1 ϕ cos α m z d 2 d z cosh α m x d 2 d 1 ϕ cos α m z d 2 d z cosh α m x d 2 d 1 ϕ p cos α m z d 2 d z cosh α m x d 2 d 1 ϕ p cos α m z d 2 d z i m sinh α m x cosh α m x cosh α m x sinh α m x where i m is the inner product of the vertical eigenfunctions and is given by 37 i m d 2 d 1 2 m 1 by inserting eq 31 eq 32 and eq 35 and 36 into eq 27 and eq 28 eliminating the unknown parameter series e m and f m and the boundary condition at the interface can be expressed in terms of ϕ and ϕ x at x x 38 ϕ x ϕ p x d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t α m m 2 d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh α m b d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b sinh 2 α m x cosh 2 α m x cos α m z d 2 at x x 39 ϕ x ϕ p x d 2 d 1 ϕ d z d 2 d 1 ϕ d z d 2 d 1 ϕ p d z d 2 d 1 ϕ p d z b t α m m 2 d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh 2 α m x sinh 2 α m x d 2 d 1 ϕ ϕ p cos α m z d 2 d z i m sinh α m b cosh α m b cos α m z d 2 the derived boundary condition in eq 38 and eq 39 relates the normal velocity to the integration of velocity potential on both downstream and upstream side interfaces i and i in the numerical approach the integrals are evaluated as the sum of the values on a series of line elements on the interface here we adopt low order panels and assume that the velocity potential is identical on each line element without losing generality the downstream and upstream side interfaces are discretised with same number of elements n with equal length the indices of the elements are denoted as j 1 2 3 n and j 1 2 3 n inserting the matching boundary conditions eq 24 into eq 38 and eq 39 the boundary condition of the velocity potential in external domain can be thus written in the following matrix form 40 φ n φ n φ n φ x φ x φ p n a φ φ a f d r i in which a is the operator matrix relating φ and φ n and f d r i φ p d r i φ p d r i t is the non homogenous component due to the particular solution the matrix a can be further divided into four submatrices 41 a 2 n 2 n a 1 a 2 a 3 a 4 each submatrix has the size n n and can be further expressed as 42 a n n k s n m k r m n k where k 1 2 3 4 is the index of the submatrices the infinite series in eq 38 and eq 39 are truncated at mode m and m 1 2 3 m is the index of the mode referring to eq 38 and eq 39 the parameter matrices s k and r k are different at downstream and upstream side interfaces and are calculated separately the contribution of each mode m at each element j is calculated as 43 s j m 1 1 cosh α m b cos α m z j d 2 j 1 j 1 44 r m j 1 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 45 s j m 2 1 sinh 2 α m x cosh 2 α m x cos α m z j d 2 j 1 j 1 46 r m j 2 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 47 s j m 3 1 cosh 2 α m x sinh 2 α m x cos α m z j d 2 j 1 j 1 48 r m j 3 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 49 s j m 4 1 cosh α m l cos α m z j d 2 j 1 j 1 50 r m j 4 δ t b t sin α m q z 2 j d 2 sin α m q z 1 j d 2 i m sinh α m b j 1 j 1 in the above equations q z 1 and q z 2 are the vertical coordinates of start point and end point of each element δ t is the length of each element and the vertical coordinate of the middle point of each element is denoted as z j similar to those in eq 24 39 all superscripts and denote the downstream and upstream side interfaces the contribution of the particular solution can be easily calculated from eq 14 and eq 15 depending on the different components of diffracted or radiation waves the non homogenous components can be expressed as 51 f d φ i φ i 52 f r 2 z j z j 53 f r 3 x z j x z j the particular solution of sway motion is zero the boundary condition in matrix form in eq 40 is incorporated into the boundary integral equation eq 20 of the external subdomain s and the global matrix is assembled as 54 1 2 e g n gq φ g φ n ga f d r i where 55 q d i a g i k e 0 i k e ω 2 g e 0 a 56 φ n 0 φ p n where φ p n is non zero on the elements in s w i and i the elements are arranged in the sequence of upstream s u seabed s b downstream s d free surface s f breakwater wall s w and downstream i and upstream side interface i the boundary integral equation accounting for internal subdomain eq 23 is eliminated from the global matrix after the velocity potentials have been solved the wave excitation force added mass and radiation damping can be calculated by the integration on the body surface it should be noted that the calculation of hydrodynamic parameters related to heave motion should involve the integration of internal surfaces of the slit where no actual mesh has been generated however it has been found in the parametric studies that the homogenous components in eq 12 contribute very little to the heave related hydrodynamic coefficients the contribution of the internal subdomain s on heave motion and the vertical component in roll motion can thus be calculated simply by integrating the particular solution φ p on the two horizontal slit walls 3 3 artificial viscous damping model the numerical model as described in section 3 2 assumes no viscous damping however in reality viscous damping accounts for a significant part of the performance of the porous breakwater in this study the overall viscous effect is separated into two parts one part accounting for the viscous effect of the breakwater walls which exists both in non porous and porous breakwater and the other part for the extra viscous damping induced by the sharp edges of the slit referring to taniguchi and kawano 2003 the viscous damping on the breakwater wall is modelled by altering the wall boundary condition to 57 φ n φ p n i ε k φ where ε is an arbitrary artificial viscous damping coefficient the method is adopted in the commercial software hydrostar for modelling the viscous damping on the walls of the sloshing tank taniguchi and kawano 2003 bureau veritas 2007 the change in boundary condition leads to the modification of boundary integral equation eq 20 to the following boundary integral equation 58 1 2 φ p s u g n p q i k g p q φ q d q s d g n p q i k g p q φ q d q s f g n p q ω 2 g g p q φ q d q s b g n p q φ q d q s w g n p q φ q g p q φ p n i ε k φ q d q i i g n p q φ q g p q φ q n d q the extra viscous damping induced by the slit is modelled by adding a pressure drop at the interface while the continuity of the velocity remains unchanged an efficient boundary condition was developed in bennett et al 1992 based on the euler equation which can be expressed as 59 ϕ t φ t f 2 u u l u t where f is the head loss coefficient and l the effective orifice length for a linear model as in the present study the higher order term has to be linearized here we apply the linearization in kim et al 2014 and adopt the modified form of the drag term 60 f 2 u u β u β 4 u 3 π where β is the linearized loss coefficient and u denotes the amplitude of the velocity similar boundary conditions are also applied on the downstream interface the boundary condition can thus be written as kim et al 2014 61 ϕ φ i β ω l ϕ x the change of boundary condition at the interfaces leads to the modified boundary condition in the following matrix form 62 e i β ω l a φ n φ p n a φ af the boundary condition as in eq 61 can also be applied on either the front wall or the back wall only instead of both sides in reality the pressure drop in upstream and downstream side interfaces may not be the same however as the loss coefficients applied here as an arbitrary parameters accounting for the viscous effect and will be calibrated against physical experiments applying the boundary conditions in different ways will lead to similar results the head loss coefficient is highly dependent on the opening shape of the slits which will be discussed further in section 5 1 3 4 breakwater with multiple slits the numerical model is developed based on the assumption that there is only one slit in the breakwater for cases with multiple slits where the downstream and upstream side interfaces are denoted with i 1 i 2 i n and i 1 i 2 i n the local operator matrix for each pair of interfaces a n will be calculated separately with the numerical integration on each interface pair i n and i n the global operator matrix a may be assembled as 63 a d i a g a 1 a 2 a n the other components of the global matrix q remain unchanged the artificial damping model in 3 4 can be applied on each separate slit with different empirical damping coefficients 3 5 incorporation with conventional hybrid bem for computational domain reduction as is reviewed in section 1 the application of hybrid bem in existing literature has largely focused on the reduction of the computational domain fig 2 shows the reduced computational domain in the present hybrid bem instead of extending the computational domain to the far field s u and s d the conventional hybrid bem selects arbitrary vertical boundaries s u and s d which are closer to the breakwater body since the influence of the evanescent modes is not negligible at this close distance the velocity potential accounting for the upstream and downstream domain need to be written in the complete form 64 φ d r i 1 a 1 i cosh k z h e i k x m 2 a m i cos λ m z h e λ m x l 65 φ d r i 3 d 1 i cosh k z h e i k x m 2 d m i cos λ m z h e λ m x l where a mi and d mi are unknown coefficients and the fluid domain is truncated at x l here we assume a constant water depth the present approach of eigenfunction expansion in the multiple slits can be easily incorporated with the conventional bem of the truncated domain which further reduces the required number of elements for a perforated breakwater problem as the conventional hybrid bem is already well developed as in koley and sahoo 2017 its formulation is given herein without more detailed proof based on the eigenfunction expansion in the form of eq 64 65 the boundary conditions on the fortuitous upstream side vertical boundary s u can be expressed as 66 φ x d r i 1 i k cosh k z h h 0 φ d r i 1 cosh k s h d s i 1 m 2 λ m cos λ m z h h 0 φ d r i 1 cos λ m s h d s i m similarly the downstream side boundary condition s d can be expressed as 67 φ x d r i 3 i k cosh k z h h 0 φ d r i 3 cosh k s h d s i 1 m 2 λ m cos λ m z h h 0 φ d r i 3 cos λ m s h d s i m where i m is also the inner products of the eigenfunctions similar to eq 37 68 i m h 1 2 sinh 2 k h 4 k m 1 h 1 2 sinh 2 λ m h 4 λ m m 1 the eigenvalues determined by the dispersion relation is expressed as 69 λ 1 i k ω 2 g k tanh k h 70 ω 2 g λ m tanh λ m h m 1 together with the present approach the boundary conditions are incorporated into the boundary integral equation in the matrix form of 71 q d i a g q l 0 q r ω 2 g e 0 a so that the matrix form of boundary conditions eq 66 67 q l and q r are applied instead of the far field boundary conditions as shown in fig 2 the reduced elements due to a shortened computational domain by conventional method is highlighted in red while those reduced elements due to elimination of slit area by present method is highlighted in blue the combined approach yields a higher computational efficiency for determining the hydrodynamic parameters the comparison of the efficiency and element numbers of the present approach and a multi domain bem with complete fluid domain is presented in section 4 3 4 verification and parametric study of 2d breakwaters 4 1 convergence study of numerical model the convergence of the numerical results obtained from the hybrid bem method depends on both the mesh size and the number of evanescent modes as a result convergence studies involving the two variables were first carried out the numerical method applied was formulated in the form of eq 55 with a fully extended fluid domain referring to koley and sahoo 2017 the absolute size of the mesh should be proportional to the input wave length l table 1 shows the results of wave reflection coefficient k r transmission coefficient k t and horizontal excitation force f x calculated with mesh sizes varying from 0 05l to 0 002l the geometry of the breakwater remains unchanged the centreline of the slit is denoted as d c the parameters were calculated with three different input wave numbers kd 0 3 0 6 and 0 9 in the calculations the number of evanescent modes was set at m 10 referring to williams et al 2000 the upstream and downstream boundary were generally set to be 6h away from the structure walls while a shorter boundary distance varying from 3h to h was applied for shorter waves the results show that when the mesh size was refined to 0 005l or smaller the numerical solution to all hydrodynamic parameters converge to 2 or 3 decimal places the vertical excitation force is not influenced by the discretion of the fluid domain boundaries and remains constant at every calculated frequency table 2 shows the convergence study of evanescent modes referring to the analytical solution in eq 12 eq 13 the convergence speed of evanescent modes should be dependent on the thickness of the slit as smaller thickness t leads to larger eigenvalues and thus faster convergence of the higher mode contribution as a result three different thicknesses t 0 1d 0 4d and 0 7d were studied with mesh size kept identical at 0 005l the results reveal that when the number of modes was increased from m 1 to m 10 the hydrodynamic parameters of thin slit case t 0 1d remain largely unchanged with only up to 0 2 difference however a 9 difference in wave excitation force and 7 5 difference in added mass exist for the thick slit case t 0 7d the influence of the evanescent modes on wave reflection and transmission coefficient is less significant when compared with other coefficients which possibly results from the evanescent modes dissipating in the far field based on the convergence study the number of total modes m 10 is chosen for the 2d parametric study cases in the following section 4 2 verification of analytical solution with existing results in the following sections the numerical solution will be verified with analytical solution for rectangular breakwaters obtained from the eigenfunction matching method the analytical method is first verified with results from existing literature so that it can be used to assess the accuracy of numerical method the diffraction potential of non porous breakwater is calibrated by comparing the calculated reflection coefficients against analytical results obtained by mei and black 1969 the same sets of parameters were applied with h 2d a d 3d and 5d as shown in fig 3 fig 4 shows the comparison of added mass and damping coefficients with respect to the non dimensional wave number kh the calibration case refers to the analytical and bem solution in zheng et al 2004 reproduced as dots in fig 4 a high accuracy of results was achieved as the present paper applies a similar approach in solving non porous breakwaters with a different form of eigenfunction in subdomain 2 the analytical results of perforated breakwater were compared with the results of previous studies for a special case where the breakwater hull extends to the seabed leaving only one slit in the middle for wave transmission the subdomain 2 is thus non existent in this special case for very long wave conditions kh 0 we checked the asymptotic behaviour of the present solution against the analytical results of a thin vertical wall with one slot the case of a very narrow breakwater with a 0 002d was thus calculated and the results were compared with the thin vertical wall solution given by porter and evans 1995 in fig 5 a as the present method does not allow for zero width breakwater the non zero width results in slightly lower transmission coefficients for larger kh while the results are identical to those in porter and evans 1995 when kh 0 the wide slotted barrier problem was solved with the same method and the results compared to those in reference liu and wu 1987 where the source like behaviour of the wave potential was exploited and a matched asymptotic expansion method was applied following the practice in liu and wu 1987 the data is plotted in fig 5 b in the form of transmitted wave energy t 2 against wave length parameter kd c 2π it can be seen that the solution of present approach matches well when the width of the breakwater is considerable the present results were also compared with experimental data performed for a barrier with finite thickness and water depth as presented in guiney et al 1972 the results of transmitted wave energy t 2 have been plotted against the relative wave length h λ in fig 6 a and b the design of the barrier is similar to that discussed in fig 5 b consequently the results show good agreements for shorter waves while the difference in results increases for longer waves 4 3 comparison of accuracy and computational efficiency with multi domain bem the highest efficiency of the present approach is achieved by having a reduced computational domain by using the formulation in section 3 5 a comparative study is presented here to demonstrate the robustness of the present approach by comparing the required number of line elements and time of computation of present approach in 3 5 and the conventional multi domain bem with fluid domain extending to far field the two approaches for reducing the number of elements required have been discussed in section 3 the truncation of computational domain and the elimination of slit elements the combination of the two approaches would guarantee the maximum efficiency the breakdown of the mesh required for different numerical approaches is listed in table 3 the mesh number varies with both the incident wave length and the numerical approaches and the element numbers are consequently listed as a range the number of elements of the bem methods with or without removed slit domains and computational domain truncation were compared it can be seen that the number of elements on the body can be many times larger if the four horizontal slit walls were modelled with actual elements because the walls have the same width and discretization as the breakwater bottom the reduction in the total element number leads to a shorter computational time when the matlab program was executed with a single processor on a desktop computer with windows 10 os and intel core i7 7700 cpu it took a cpu time of 6 106s to calculate 40 wave numbers using the hybrid bem in the formulation of eq 71 as compared with 44 618s using the multi domain bem fig 7 shows the comparison of the hydrodynamic parameters calculated by multi domain bem and hybrid bem in the formulation of eq 71 the analysed geometry is a d d c1 0 4d d c2 0 8d t 0 1d l d h 2d d c1 and d c2 denote the vertical positions of the slit centreline a total of 40 non dimensional wave numbers kd 0 1 4 0 was simulated the results show that the present approach gives the same results as the conventional approach 4 4 parametric studies of 2d porous breakwater in this section the hydrodynamic performance of a rectangular breakwater with single or multiple slits and various geometries was studied as a parametric study the hydrodynamic parameters of the single slit breakwater were calculated by both analytical eigenfunction matching method and present numerical methods no artificial damping was applied in the model and all the influences induced by the porosity are the potential flow effects the comparison study of the analytical and numerical results is also used as a verification of the numerical method 4 4 1 influence of breakwater porosity the influence of porosity on the hydrodynamic performance of the rectangular breakwater was first studied the hydrodynamic parameters related to wave diffraction potential were plotted with respect to the non dimensional wave number kd in fig 8 the analytical results wereplotted with lines and the numerical results with dots while the breakwater geometries b 2d h 2d and the centreline of the slit d c 0 5d remain the same in all cases three different slit thicknesses t 0 1d 0 2d and 0 4d were applied to the calculation the wave forces and moments were normalized with half width of the breakwater a 0 5b so as to keep the data form identical to the verification cases in fig 3 fig 8 a shows that the wave reflection coefficients are significantly reduced with respect to increasingporosity restricted by energy conservation the wave transmission coefficients are correspondingly increased the results indicate that under potential flow assumptions the porous breakwater sacrifice part of the breakwater s wave blocking efficiency in exchange for low reflection and calmer sea in the upstream area however the conclusion may be different when considering damping induced by the porosity as shown in the following section 5 2 with regard to wave excitation forces it is found that the slits in the horizontal direction do not influence the vertical excitation force and the results are thus not plotted here on the contrary the horizontal wave force and the overturning moment are significantly reduced by the porosity when quantifying the reduction of the horizontal wave force plotted in fig 8 c it can be found that the reduction rates in all cases are higher than the porosity of the structure when compared with the non porous breakwater the maximum wave excitation force is reduced by 17 0 34 5 and 55 2 corresponding to 10 20 and 40 porosity this can be explained by analysing the change of hydrodynamic pressure on the vertical walls the pressure induced by incident wave potential is not altered by the slit but the overall froude krylov force will be reduced as the perforated walls have a reduced projected area as compared with non porous walls on the other hand as plotted in fig 9 the pressure induced by wave diffraction potential is reduced on the front and back wall with the presence of the slit combined with the constant incident wave potential the total hydrodynamic pressure on the vertical wall is also lower as a result the wave force on the porous breakwater is the integration of lower pressure on a reduced surface area the overturning moment m y is influenced by the slit in a similar manner similarly the hydrodynamic parameters related to wave radiation potential namely the added mass and potential damping were also calculated analytically and numerically the normalized results were plotted with respect to kd in fig 10 it can be observed that the influence of porosity on sway added mass and damping is strongly frequency dependent the maximum reduction of added mass takes place in small wave number cases while the peak of the potential damping is significantly reduced by comparison the influence of porosity on heave motion is mostly hydrostatic it can be seen that a larger slit thickness leads to a higher added mass but the increment is largely independent from wave frequency the analysis of the analytical results shows that the increment approximately equals ρ g b t m which is the contribution of the integration of the particular solution φ p z on the two slit walls at z d 1 and z d 2 the potential damping a 2 is not affected by the slit as a result it can be concluded that the increase of the heave added mass due to the slit equals the solid mass of the water in the slit meanwhile the heave radiation potential remains unchanged in porous and non porous breakwater cases the roll added mass m 3 is under the joint influence of horizontal and vertical forces and would thus decrease at small wave numbers and increase as the wave numbers become larger the general pattern of roll potential damping follows that of the sway motion the analysis of the hydrodynamic parameters reveals that the slit has a general effect of weakening the wave diffraction and radiation by allowing passage of wave energy to the downstream area 4 4 2 influence of slit layouts the following studies show that the porosity is not the only factor that affects the hydrodynamic parameters of the breakwater with the same porosity the position and number of the slits also have an impact on the breakwater performance which is the reason why the exact slit position and layout have to be modelled numerically fig 11 shows the hydrodynamic parameters of the breakwater with the same geometry b d h 3d and same slit thickness t 0 1d but with different centreline positions of the slit d c it can be seen that as the vertical position of the slit is moved from close to the surface d c 0 3d to the bottom d c 0 7d the reflection coefficients increase by around 5 as the transmission coefficients decrease by about 35 on average this is in accordance with intuitive expectation that as the wave energy concentrates more on the surface an opening close to the surface allows more wave energy to pass as a result with the same porosity the wave blockage of the breakwater with a slit near the free surface is less than that with the same slit located near the bottom however the wave excitation force on the structure can also be reduced by around 8 7 by comparing fig 11 d with fig 11 c it can be seen that the overturning moment is less influenced by the vertical position of the slit because the overturning moment induced by vertical wave force is not affected and only the moment from horizontal wave force is changed the influence of slit vertical position on added mass and damping terms is plotted in fig 12 as the depth of the slit increases the wave blockage is stronger resulting in a larger amplitude of added mass and damping coefficients for sway and roll motions on average a 33 change in sway added mass can be achieved by moving the slit from d c 0 15d to d c 0 35d the heave added mass and damping are insensitive to the positions of the slit because the heave radiation potential is not much affected by the horizontal slit by comparing the results in figs 12 and 10 the reduction in the depth of the slit has a similar effect as the slight expansion of its thickness the conclusions of the parametric study on single slit breakwater also apply to multi slit cases the influence of the vertical position of two slits on the hydrodynamic parameters are plotted in fig 13 various combinations of slit positions have been simulated with the minimum distance between slits set at 0 1d the results show that the largest reduction of diffracted and radiation potentials can be achieved when both slits were placed near the free surface d c1 0 2d d c2 0 4d while the least effective combination of slits occured when the slits were placed near the bottom d c1 0 6d d c2 0 8d the other simulated cases result in values lying in between in particular by placing the slits symmetrically with respect to the middle depth d c1 0 2 d c2 0 8 or d c1 0 4 d c2 0 6 the results are basically the mean value of all cases it is also similar with placing one slit in the middle depth with doubled thickness d c 0 5d t 0 2d as a result an evenly distributed layout of slits on the entire wall which is often adopted in designs would achieve an average performance of perforated breakwaters 4 4 3 comparison with existing porous breakwater design the slit breakwater studied herein is compared with a fixed perforated breakwater concept proposed by somervell et al 2017 in somervell et al 2017 the breakwater is composed of two vertical perforated thin walls that extend all the way from the free surface to the seabed the spacing between the two walls is denoted as 2a and the walls have a constant porosity ratio of ε 0 2 for the comparison study we consider our perforated thick breakwater design to have a single slit and a width 2a which is equivalent to the spacing between the two vertical walls in somervell et al breakwater design the water depth h is assumed to be twice the draft d i e h 2d the width of the breakwater is assumed to be equal to the draft d i e 2a d the slits are placed at various heights of the breakwater while keeping a constant thickness t 0 2d so that the equivalent porosity ratio is also ε 0 2 the wave reflection and transmission coefficients are plotted with respect to h λ in fig 14 where λ is the wavelength it can be seen the transmission coefficients for the slit breakwater with d c 0 8d are similar to those of the somervell et al breakwater this indicates that the draft of the floating breakwater does not need to extend to the seabed the floating breakwater with a shallower draft does not compromise too much on the wave blockage performance and at the same time has a smaller impact on the environment under the non viscous assumption the calculated wave reflection is however much larger than that in somervell et al 2017 in reality the viscosity induced by the slit and the sharp corners of the wide breakwater would lead to smaller wave reflection as it can be seen in the model test data reported in section 5 3 5 3d case study comparison and analysis of model test data 5 1 simplified 3d formulation the present numerical approach can also be conditionally applied in some 3d numerical studies consider a rectangular slit that goes through the breakwater with length 2a with centre of the opening area at a y0 z0 and a y 0 z 0 the incident wave is considered to be in normal direction which is the case for the channel flow in the wave flume tests the width and the depth of the slit are t b and t d respectively similar to the 2d solution the eigenvalues in the y and z directions are determined by the slit width and depth and a simple series of trigonometric function can be used as eigenfunctions similar to the 3d expansion in the moonpool problem in molin 2001 the velocity potential in the semi confined fluid domain inside the slit can be written as 72 ϕ x y z ϕ p e 11 x f 11 m 2 n 2 e m n cosh α m n x f m n sinh α m n x cos β m y 1 2 t b y 0 cos γ n z 1 2 t d z 0 where α m n β m 2 γ n 2 β m m 1 π t b γ n n 1 π t d the matching conditions of normal velocity and pressure continuities at the interface still need to be satisfied while the integration takes place on the 2d opening area without giving the complete solution to the matching problem here we consider the problem regarding long and slender slits with an opening area and dimensions much smaller when compared to the breakwater dimensions and the incident wave length the slender slit assumption is proposed based on the observation that the porous breakwater designs more often involve multiple slits and openings of small sizes on the walls e g in alkhalidi et al 2015a kou et al 2019 ji et al 2019 dai et al 2018 the complete solution for wide slits with large openings is not within the scope of this study as it can be seen in table 4 the hydrodynamic parameters converge very fast when the number of modes increases especially for cases with small t for a slit thickness t 0 4d the calculated results only change around 3 by increasing the number of modes from m 1 to m 10 this implies that the lowest mode is predominant in determining the flow characteristics inside the slender slit as a result it is a convenient way to consider only the lowest mode m 1 n 1 in eq 72 for slender slits without compromising much on the computational accuracy further it can be noticed that for diffracted wave the simplification leads to the combined potential and normal velocity 73 ϕ ϕ i ϕ d e 11 x f 11 74 ϕ x ϕ i x ϕ d x e 11 which physically implies that the fluid passes through the slit with a uniform amplitude velocity a piston like behaviour without any sloshing like fluctuation in y and z directions this means that the operator matrices can be calculated in the same way as in 2d method since the variables y and z are eliminated from the equation apart from the simplicity by considering only the lowest mode the influence of different shapes of openings can also be simplified for a slit with non rectangular openings an eigenfunction series of explicit form may not be possible to establish however the lowest mode describing a uniform normal velocity in x direction remains unchanged the velocity potential would have the general form of 75 ϕ x y z φ p e 11 x f 11 m 2 n 2 f x g y z where the eigenfunctions are not determined by considering the lowest mode and a uniform velocity profile through the slits the exact expression of the higher modes is no longer needed for the analysis and the fluid domains inside slender slits with all opening shapes will have the velocity potential in the form of eq 73 and eq 74 although the shape of the openings does not influence the formulation of the velocity potential inside the slits by neglecting higher modes it is acknowledged that the shape of the slits generally has an effect on the energy dissipation near the openings mei 1989 in previous studies the influence of the opening geometries have been accounted for by applying different artificial damping coefficients in the matching boundary condition it has been suggested by bennett et al 1992 mei 1989 that the head loss coefficient f in eq 59 60 can be calculated as 76 f w b c w a 1 2 where w b and w a are the half width of the structure and the opening respectively and c is an artificial discharge coefficient which is sensitive to the shape of the slit opening the experimental data presented by daily and harleman 1966 suggests c 0 62 1 0 for a circular opening while it is recommended in mei et al 1974 that the empirical relationship c 0 6 0 4 η 2 be used for rectangular openings where η is the porosity the empirical formulae have been applied and verified in bennett et al 1992 the simplified 3d method can be used to better understand the experimental results once the empirical damping coefficients are calibrated it can also be used to estimate the hydrodynamic parameters not measured in the tests the following study shows the 3d numerical simulation of wave flume test of a rectangular breakwater with multiple horizontal slits inside carried out for the concept validation of a novel concept of porous breakwater as described in detail in han and wang 2020 5 2 model test setup the isometric view of the test model is shown in fig 15 in the horizontal direction the model is separated into 5 porous compartments designated as p1 to p5 and 6 non porous ones designated as b1 to b6 the porous compartments have two types of sections namely section a for p1 p3 highest opening space reserved for installation of gaskets and p5 and section b for p2 and p4 side views of sections a and b are shown in fig 16 with the dimensions of the slits the compartments are separated by watertight bulkheads and the non porous compartments are used as ballast tanks in the test in the vertical direction up to seven layers of slits designated as s1 to s7 from the lowest layer to highest layer were arranged when constructing the physical model straight pvc tubes with 50 mm outer diameter are inserted to form the slits in total there are 17 openings on each side of the wall and the total opening area is 0 033 m2 the experiments were performed in the wave flume of the hydraulics lab in the university of queensland australia the wave flume measures 24 m long 1 m wide 1 m deep a model scale of 1 50 was adopted with a constant water depth of 0 60 m with 0 9 m long 0 9 m wide in order to investigate the breakwater response with different drafts the model was raised vertically and fixed at different levels the model was placed at the mid point of the flume between the wave paddle and the absorptive beach at the other end and was kept stationary by bolting it to rigid frames that were clamped to the wave flume as well as supported at the bottom by small wooden boxes filled with sand as shown in fig 17 the wave reflection was measured by three wave gauges numbered 2 to 4 placed at the upstream and two wave gauges 5 and 6 at the downstream so as to measure the transmitted wave heights the wave reflection and transmission coefficients were then calculated from recorded data wave gauge wg1 was placed near the structure to measure the wave elevation immediately before wave run up wg7 is placed along the tilted deck for the monitoring of possible wave run up in deeper drafted cases fig 18 shows a photo of the breakwater model in the wave flume the slits were physically modelled by inserting pvc tubes into the breakwater hull through the openings on the front and back walls the breakwater structure can be made non porous by sealing the openings with plugs four different drafts of d 0 27 m 0 32 m 0 37 m and 0 42 m were tested three wave heights of h 0 06 m 0 10 m and 0 15 m were considered in the regular wave tests the tested wave periods range from 0 6s to 3 0s corresponding to around 4 2s 21 2s in full scale this is in accordance with the design sea state of the present case han and wang 2020 with 100 year design wave condition to be h s 8 4m t p 13 9s an active wave absorption scheme is adopted in wave generation to reduce the effect of re reflection in the upstream area table 4 presents the geometry and dimensions of the model in reduced scale and table 5 shows the test parameters 5 3 comparison between numerical and experimental results the model test was performed to investigate both breakwater efficiency and wave run up on the breakwater deck here we only simulate the shallow drafted cases with draft d 0 27m and d 0 32m in which no wave run up on the deck has been observed under small waves h 0 06m owing to the large number of elements required to simulate the entire length of the wave tank the fluid domain of the numerical model was shortened to be 6 0 m 1 0 m x 0 6 m other dimensions are kept identical as in the model test the 3d panel mesh was visualized by using the mesh visualization module in the commercial software hydrostar bureau veritas 2007 an example of generated mesh is shown in fig 19 in fig 19 the mesh at the interfaces was hidden so that the positions of the slits can be demonstrated only the fully submerged slits will be considered in the numerical study as can be seen in fig 19 b a total number of 10 slits numbered s1 to s4 in fig 15 have to be modelled at their exact position which would require extensive efforts in modelling and computation without the proposed simplified approach the slits have a side length of 0 05 m which is 5 of the breakwater width and 15 18 of the draft consequently the slits were considered slender and the simplified 3d approach was applied the size of the mesh was kept similar to that in the 2d numerical simulation the number of the mesh varies from 4000 to 7000 the same artificial damping coefficients were applied on the all the interfaces the slits were still modelled as rectangular which differ from the cylindrical tubes used in the model test however as it was already discussed in section 5 1 only the lowest mode was needed to be considered for slender slits the influence of the slits was consequently modelled by allowing a 1d uniform flow through the slits the different opening shapes would only influence the artificial viscous damping coefficients 2d and 3d numerical results of 1 non porous breakwater 2 perforated breakwater without artificial damping 3 perforated breakwater with artificial damping were compared with model test results tested under random waves and plotted against tested wave periods in fig 20 both 2d and 3d results were presented in which the geometry of section a in fig 16 was applied for 2d study the results associated with section b as geometrical input were similar to those of section a and hence they will not be presented herein in the study a uniform damping coefficient on the structure walls ε 0 005 so that the viscous effect could be accounted for in non porous breakwater cases the artificial damping parameters at the interface were taken as β 0 5 l 0 5 these values were adopted for convenience so that the numerical results could best fit the experimental ones and other sets of parameters leading to similar results may also exist the 3d results show that the general pattern of the numerical results without damping were similar to that in 2d analysis the reflection coefficients were reduced by the multiple slits while the transmission coefficients were increased however the experimental data though less conforming than the numerical results show that the transmission coefficients remain largely unchanged by the slits when artificial damping was added to the interface the qualitative conclusions from numerical and experimental results become identical by comparing the 2d and 3d numerical studies it is clear that the 2d results significantly overestimated the influence of the slits when compared with non porous counterparts the 2d porous case with 2 slits shows an average reduction of k r by approximately 37 while the reduction of k r is approximately 11 for the 3d case this is reasonable as the 3d model comprises both porous and non porous compartments as shown in fig 15 whereas the 2d case assumes that the slits extend across the entire width the equivalent porosity ratios in 2d cases are consequently 31 37 as compared to 8 6 10 3 in 3d cases the numerical approach after calibrating against the model tests can also be used to perform an initial estimation on the parameters that are not measured in the tests fig 21 shows the calculated horizontal wave forces using the same viscous damping parameters as in fig 20 the force is normalized with static pressure on the bottom area from the simulation a 16 reduction for case d 0 27 m and 14 reduction for case d 0 32 m in the wave forces can be expected with the porosity of the structure being 8 this is in accordance with the conclusions in the 2d numerical studies that the wave force reduction is higher than the porosity and the slits are more effective when placed closer to the interface unlike 2d numerical analysis a spike in wave transmission and reflection coefficients shows up at wave period around t 1 0 s this is possibly due to sloshing like behaviour as the 3d fluid domain was simulated in a confined space however the present numerical approach does not attempt to suppress this behaviour as the experiments seem to be influenced by the same effect as well the tested breakwater concept is designed to be non moving in the horizontal direction as it is restrained by caissons so the sway added mass and damping will not be presented here 6 summary and conclusions a hybrid boundary element method was developed to analyse the perforated breakwater with large horizontal slits that are sparsely distributed in the hull an appropriate boundary condition was derived by using the eigenfunction series of the velocity potential inside the slits so as to eliminate the need to model the slits by eliminating the mesh required for modelling the slits the method reduces the number of total elements and increases the efficiency of the numerical approach it can be used to analyse 2d or 3d perforated breakwater in channel flow with multiple horizontal slits while there is no restriction on the outer geometry of the breakwater the approach is however restricted to horizontal slits only in the present 3d analysis the influence of the multiple slender slits is simplified by considering the lowest mode of the velocity potential essentially it means allowing a uniform normal velocity in normal direction on the slit openings all studies presented herein are based on normal incident wave angle but directional waves can also be simulated in a similar approach by changing the eigenfunction the numerical method was verified with analytical results from eigenfunction matching method and good agreements have been achieved the 2d parametric study shows that the perforations induced by the slits generally weaken the diffracted and radiation potentials in the horizontal direction regardless of the position and size of the slits the weakening effect leads to changes in the hydrodynamic parameters the wave reflection horizontal wave force and overturning moment are reduced and wave transmission is increased further it is discovered that the percentage reduction of the horizontal wave forces is always higher than the porosity percentage of the breakwater for example a breakwater with 10 porosity shows a 17 decrease in the wave force a general reduction in sway and roll added mass and radiation damping can also be observed the 2d studies also emphasize the influence of the vertical positions of the slits and consequently the importance of modelling each slit at its exact position with the same slit geometry the effects on hydrodynamic parameters are more prominent when the position of the slits are placed closer to the free surface for example in the case study it is found that there is an average change of 5 in wave reflection coefficient 33 in wave transmission and 8 7 in wave force unlike predictions in 2d studies the data from the model test performed in the wave flume suggests that while the wave reflection coefficients reduce due to the slits the wave transmission coefficients would remain largely identical instead of increasing this means that the energy dissipation that takes place at the interfaces cannot be neglected further numerical studies show that the gap between numerical and experimental results can be minimized by applying the viscous damping model in addition the experimental results reveal that the perforated breakwater with large slits is advantageous in terms of reflection the test data shows that the reflection coefficients are reduced by approximately 10 with an 8 porosity while its efficiency will not be influenced by allowing water passage through the slits by using the same numerical method it is expected that the tested perforated breakwater attracts 14 16 reduction in horizontal wave force as compared with a solid breakwater with the same geometry the present findings provide insights for development of floating porous breakwaters in coastal infrastructure industry the floating breakwaters have relatively smaller benthic footprints and easily removed as compared to rubble mound breakwaters it is also a low wave reflection design with smaller reflection coefficients when compared to non porous breakwaters while its wave blocking capability is not weakened in addition some porous floating breakwater concepts have attached secondary structures such as porous sheets e g fig 8 in dai et al 2018 skirts e g fig 11 in dai et al 2018 or perforated walls kou et al 2019 to the main body the attached porous components attract extra wave loading as well as they increase the dead load of the breakwater as the proposed floating breakwater creates porosity inside the main body of the breakwater the outer geometry of the breakwater is unchanged and the internal slits do not attract extra wave loading as attached sheets do on the contrary the installed internal slits reduce the horizontal wave load while maintaining a constant vertical wave load the reduction of horizontal wave load is beneficial as it will lead to a less costly mooring system in practical designs of breakwaters it is worth noting that 1 the change of added mass due to the slits will alter the natural frequency of the breakwater and the motion responses under given incident wave conditions an effect that should be carefully studied 2 the static weight of the water inside the slits need to be considered during weight estimation and calculation of centre of gravity credit authorship contribution statement m m han methodology software formal analysis validation model testing writing original draft c m wang conceptualization supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful to the australian research council for providing the discovery project dp170104546 grant as well as to hyundai engineering and construction and the arc nanocomm hub for additional grants to perform this study appendix the example of forming the matrix and solving the unknown parameters in the analytical method is presented here by using eq 16 multiplying both sides of eq 16 by the eigenfunction cos α i z d 2 and integrating from z d 2 to z d 1 yields a 1 d 2 d 1 a d 1 cosh k z h e i k a m 2 a d m cos λ m z h cos α i z d 2 d z d 2 d 1 φ i e d 1 a f d 1 m 2 e d m cosh α m a f d m sinh α m a cos α m z d 2 cos α i z d 2 d z i 1 2 3 m the diffraction potential is calculated here while the radiation potential components can be solved in the same manner the linear equations above can be written in a matrix form a 2 ax f where x is the array of unknown parameters a 1 a m b 1 b m c 1 c m d 1 d m e 1 e m and f 1 f m a is the parameter matrix and f is the contribution of the non homogenous term φ i the orthogonality of the cosine function makes the parameter matrices related to e m and f m take on a diagonal form as d 2 d 1 cos α m z d 2 cos α i z d 2 d z is non zero only if m i with the same procedure each one of the matching equations 16 19 provides a matrix with an order m x m in total the unknown parameters will be calculated by solving the 6m 6m matrix 
21079,this study aims to determine long term spatial variability of wind and wave characteristics over the sea of marmara for this purpose we produced four different wind and wave datasets for a period of 40 years 1979 2018 using the calibrated and default setting swan models forced with both cfsr and era interim winds and inter compared the performance of these datasets is examined against the wave height measurements of 2015 at the silivri buoy station and 27 year 1991 2018 satellites data envisat ers 1 ers 2 jason 1 jason 2 jason 3 sentinel 3a sentinel 3b topex then for wind and wave climate analysis the spatial distributions of the wind and wave characteristics over the study area are determined in terms of seasonal and annual averages 40 year averages of 95th and 99th percentile significant wave heights probabilities of being larger than significant wave heights exceeding a critical value and 40 year maximum significant wave heights are spatially analyzed finally the calibrated swan model using cfsr winds presents the most accurate results therefore the effects of different model inputs and settings on the model results are examined by creating spatial distributions of the biases of the other three model results and comparing them to those of the calibrated model results using cfsr winds the cfsr forced and calibrated model predicts the largest average wind speed and average wave height in the central regions of the sea of marmara in comparison with the other three models the shores of kapidag peninsula and marmara island are exposed to be with the highest wave conditions keywords wind speeds wave heights extreme waves the sea of marmara 1 introduction wind generated ocean surface waves potentially represent a serious hazard to life and property in various maritime and coastal activities hence it is necessary to develop the capability to forecast short term wave conditions over global and regional ocean domains to minimize loss of life and property tolman et al 2002 long term statistical information of the waves is also needed in order to solve many coastal engineering problems such as the design of coastal and harbor construction determination of the wave energy potential coastal erosion and sediment transport considering both short term fluctuations such as monthly seasonal and inter annual variations and long term changes due to the climate change are very important for coastal regions kamranzad 2018 although instrumental measurements are valuable for studying these characteristics they are limited in practice akpinar et al 2012 kalra et al 2005 buoys directly measure accurate time series of wave data at specific locations however the duration of buoy measurements is generally relatively short and sparsely distributed around the world satellites present a global coverage and provide information with a high spatial resolution and long duration izaguirre et al 2011 young et al 2011 ribal et al 2019 satellite measurements however are not reliable in coastal areas and do not give spectral and or wave period information altimeter products only provided significant wave heights as an attractive alternative to the aforementioned techniques the wave hindcast provides a long term homogeneous wave database which can be used to analyse the characteristics of waves at global and regional scales liang et al 2019 using third generation numerical wave hindcast models such as swan wavewatchiii wam and etc an assessment of spatio temporal variations of the wind and wave characteristics can be carried out in different areas of the world in order to define the marine wave climate kamranzad 2018 for regional scales there are many studies akpınar et al 2016 arkhipkin et al 2014 chen et al 2013 gippius et al 2016 kamranzad 2018 lv et al 2014 soukissian et al 2008 wang et al 2018 xu et al 2017 investigating the wind and wave climate concerning the sea of marmara to this day there are only three studies abddollahzadeh et al 2014 özhan and abdalla 1999 saraçoğlu 2011 available on wind wave modeling in these studies however model performance evaluations and validations have been carried out using wave measurements for a too short period about 2 months for this reason in our previous study kutupoğlu et al 2018 we focused on model development using long term wind and wave measurements the swan model forced with the cfsr and era interim winds was calibrated using one year wave measurements and the validation was based on three year wave measurements in the present study we aim to determine the long term spatial variations of wind and wave characteristics on the sea of marmara in addition we present an intercomparison of the results obtained with the four models to determine the impact of the different settings and various forcing to achieve this goal we benefit from four different wind and wave datasets at a 40 year period 1979 2018 produced with the calibrated and default setting swan models forced with both cfsr and era interim winds by kutupoğlu et al 2018 these datasets have wind and wave parameters regarding wind speed components u and v significant wave height hm0 and the mean wave direction dir by using the collected data in the present study spatial distributions and variability of wind and wave characteristics are examined in terms of monthly seasonal and annual means of these parameters the 95th and 99th percentile significant wave heights probabilities of significant wave heights exceeding a critical value and maximum significant wave heights areal values are given for the calibrated swan model forced with the cfsr winds spatial distributions of biases of wind and waves parameters between the four different models are also discussed 2 study area the sea of marmara is located in the northwest of turkey between the 40 41 25 north latitude and 26 30 east longitude the sea of marmara connects to the aegean sea with dardanelles strait and to the black sea with the bosphorus in the north south direction the widest part of the sea is 80 km and in the east west direction the longest axes of is 280 km the sea of marmara has an area of 11 350 km2 is also an internationally important waterway due to its two straits the smallest width of these straits reaches 700 m in the bosphorus at the anatolian coasts of the sea of marmara bays and gulfs are presents producing an irregular coastline the main ones are the bays of i̇zmit gemlik bandırma and erdek near those bays there are prince islands i̇mralı and marmara islands which have a rough terrain at the south coast of the sea of marmara the coastline is wavy because of the existence of peninsulas and bays in the sea of marmara there are significant depths despite being a small sea the deepest spots are in the elliptic pit that goes in west east direction starting from the entrance of the bay of i̇zmit the easternmost pit located in south of the prince islands is 1238 m deep the deepest pit is located in the middle of the sea of marmara between marmara ereğlisi and kapıdağ peninsula with a depth of 1390 m artüz et al 2007 3 data used any wave hindcast model which aims to produce long term wind and wave data base needs input data that include bathymetry and wind fields the bathymetry of the sea of marmara is shared in the public domain for academic studies from the general bathymetric chart of the oceans gebco digital atlas 2014 with a resolution of 0 008333 in both longitude and latitude for the black sea van vledder akpinar 2015 showed that among 6 different wind fields the best wave model performance is obtained by using cfsr winds besides era interim winds are used as the main wind data source in turkey therefore it was preferred to use the data bases of cfsr from noaa and era interim from ecmwf for the wind fields for both wind data source the data is provided for the years from 1979 to 2018 covering the study area noaa presents two versions for cfsr winds which the cfsr version 1 of cfs re analysis data set saha et al 2010 is available from january 1 1979 to march 31 2011 and version 2 saha et al 2014 of the cfsr data sets was put into operation in march 2011 all cfsr winds data sets have a 1 h temporal resolution but they have a 0 3125 0 3125 spatial resolution from 1979 to 2010 and 0 2045 0 2045 from 2011 to present however era interim winds dee et al 2011 are collected in a 6 h temporal resolution and in 0 1 spatial resolution both in latitude and longitude for both wind data sources 10 m u and v wind speed components up to 2013 were downloaded from ecmwf and noaa websites at the end of 2014 within thesis project of the first author in addition the data from 2014 to the present were obtained within this study in order to examine the validity of the models two measurement data sets were used the first one comprises wave buoy measurements collected for the year 2015 deployed for meteorological purpose located offshore of silivri the station belongs the tpao turkish petroleum corporation and named at the odas 01 tr silivri buoy station positioned in 41 043889 n and 28 186944 e is located 3 km offshore from the coasts of silivri district of i̇stanbul province at a depth of 50 m at this station wind speed measurements at a 1 min temporal resolution and wave measurements at 30 min temporal resolution are available from 2013 to the end of 2017 in 2015 there are 16 246 data records and the measured maximum significant wave height is 2 93 m and the average significant wave height is 0 35 m the second data set for wave height are envisat environmental satellite ers european remote sensing 1 ers 2 jason joint altimetry satellite oceanography 1 jason 2 jason 3 sentinel 3a sentinel 3b topex poseidon satellites data that recorded between 1991 and 2018 the positions of the recorded data by the satellites and its passes are shown in fig 1 and the satellites used within the study and the years of satellite data measurements are shown in table 1 in this study satellite data described and calibrated in ribal et al 2019 was used data belonging to all satellites were analyzed as a single data set as stated in ribal et al 2019 the concurrent process was carried out with a maximum 30 min temporal difference and 7 km spatial difference between the model data and satellite data between 1991 and 2018 years the number of wave measurement collocated data points is 65139 the data statistics see table 2 show that the measured maximum significant wave height is 3 76 m and the mean significant wave height is 0 74 m long term analysis of wind and wave parameters was carried out by using models results of our previous studies kutupoğlu 2017 kutupoğlu et al 2018 the four different models which were run with both wind datasets and two different wave model settings were operated for the 40 year period between 1979 and 2018 4 wave model setup swan version 41 01 model is used to perform the wave hindcast study the model was run in third generation mode with a time step of 30 min in a nonstationary mode using 1 iteration per time step model grid involves the area between 26 6958 and 29 9958 east longitudes and 40 2042 41 0942 north latitudes which includes entire the sea of marmara this area is discretized with a regular spherical grid that includes 500 135 nodal points with a 0 0066 around 1 15 uniform resolution in every direction this grid resolution was determined in view of the ability to accurately predict short fetch wave growth data storage and simulation times directional wave variance spectrum is discretized by using 36 directional and 35 frequency bins between 0 04 hz and 1 0 hz kutupoğlu et al 2018 within the scope of the study four different swan models with different settings and inputs are run as mentioned in the previous chapter two of them are based on the default settings of the swan model that use cfsr and era interim winds to distinguish between results obtained from the various models we used the following codes the letters c and e to refer to the wind sources cfsr and era interim respectively and d and c for default and calibrated so the acronym cc refers to the calibrated model forced with the cfsr winds dc default model using the cfsr ce the calibrated model forced with the era interim and de default model using era interim default setting wave model computations are based on swan version 41 01 using the recommended default setting swan team 2016 for whitecapping the expression by komen et al 1994 is used in which delta 1 according to rogers et al 2003 for wind wave growth the formulation of komen et al 1994 is used quadruplet interactions are estimated using the discrete interaction approximation dia by hasselmann et al 1985 using λ 0 25 and cnl4 3 107 the jonswap bottom friction formulation is used with cfjon 0 038 m2 s 3 according to zijlema et al 2012 depth limited wave breaking is modeled according to the bore model of battjes and janssen 1978 using alfa 1 and gamma 0 73 the other two models are based on the settings kutupoğlu et al 2018 obtained from the calibration of swan models run with both the cfsr and era interim winds the performances of the calibrated models and calibration details are given in the detail in our previous study kutupoğlu et al 2018 to sum up the swan model was calibrated with the wind and wave measurements of the silivri wave buoy annual measurements at the silivri station in 2013 are used to calibrate the swan model for both wind data sources swan model performances are evaluated on the basis of the significant wave height hm0 measured at the buoy location for the calibration of the models a sensitivity analysis was performed to find the optimal numerical and physical settings the sea of marmara can practically be considered as deep water so the deep water processes of wind input whitecapping and quadruplet interactions are dominant and of equal magnitude the shallow water processes of bottom friction depth limited wave breaking and triad interactions are insignificant except along the shallow coastal zones also the analyzes show that the most effective process on the model results is the selection of the deep water physical source terms for wind input and whitecapping formulations and the whitecapping coefficient c ds for the wave model calculations different recommended formulations i e source terms and coefficients are used for wind input and whitecapping processes and the ones with the best performances minimum error and maximum correlation are selected for further inspection apart from choosing a particular source term also the whitecapping coefficient cds is calibrated the best swan model setup obtained after the calibration kutupoğlu et al 2018 for cfsr winds is based on the komen et al 1994 s formulation for the wind input and janssen janssen 1991 1992 s whitecapping term with delta 1 and cds 1 0 which its default value is 4 5 for the era interim winds the calibration yields the same wind input formulation as for the cfsr wind and the komen et al 1994 s whitecapping formulation with cds 0 5e 5 which its default value equals to 2 36e 5 all other physical adjustments of the model setting were kept as in the default model however the only exception is that when the triad wave wave interaction is deactivated in default model it is actived based on eldeberky 1996 s lta approach with trfac 2 5 in calibrated models as can be seen from these adjustments besides the difference in triads the whitecapping formulation in the calibrated model using cfsr is different from the default formulation and also the whitecapping coefficients in the calibrated models using era interim and cfsr winds is different in comparison with that of default model 5 results and discussion 5 1 model performances the statistical error analysis summary of wave prediction results based on the four different models and the 1 year period is given in table 2 according to table 2 the models produce similar mae rmse and nrmse values except the de model results whose error values are higher than the others the models run with cfsr winds have lower si values 49 and 47 for the cc and de models and higher values for coefficient of correlation 84 for both models and the index of agreement 91 and 89 for the cc and de models in comparison with the models run with era interim winds on the one hand the calibrated swan model run with cfsr winds cc model has a lower bias 0 03 m hh 40 and nbi 8 values in comparison with the other three models on the other hand in comparison to the other three swan model the best calibrated model cc model achieved the closest predicted mean 0 32 m to the measurement means 0 35 m it is also observed that according to the nmb all models slightly underestimate the significant wave heights before testing the accuracy of model data against satellite data the performance of satellite data against silivri buoy data was analyzed to show the validity of satellite data in the area of interest when we apply the collocation code maximum 30 min temporal difference and 7 km spatial difference between the buoy and satellite data we obtained no collocated data between buoy and satellites therefore we tried to allow more time shifting from 0 5 h to 12 h and larger area to have more collocated data between tried options highest correlation and lowest errors were obtained in the case of option for the area between longitudes 28 12 28 25 and latitudes 40 9 41 042 of collocation and 0 5 h time shift correlation is 0 48 and si rmse and bias are respectively 0 61 0 44 m and 0 30 m fig 2 a presents silivri buoy location and satellite data points there is presented concurrent satellite data with buoy data based on the collocation method as the green points the red rectangle frame shows the area longitudes 28 12 28 25 and latitudes 40 9 41 042 used for the best option the satellite data falling into this area was co located to the buoy data the scatter diagram of the satellite data matched with this collocation method against the buoy data is given in fig 2b as can be seen from this scatter plot satellite data gives higher wave heights than the buoy data the results of the error analysis of swan model hindcasts against the satellites data are also presented in table 2 the results show that the best performing model cc model has lower error values bias 0 21 m and si 60 for cc model in terms of all error parameters in comparison with other three models likewise the models using cfsr winds have higher correlation coefficient for cc model r 0 60 and for dc model r 0 61 than the models using era interim winds for both models r 0 57 the best agrement d 0 73 is also obtained with the cc model thus as expected the best model results are obtained for the cc model it should be also noted that there is a difference between the averages of the satellite data and the hindcast results the satellite based wave heights are higher than the model predictions due to land effects this case can be also observed in fig 3 presented the box plots of significant wave height for all model results against the 2015 silivri buoy and the satellites data on each box the central mark indicates the median and the bottom and top edges of the box indicate the 25th and 75th percentiles respectively the whiskers extend to the most extreme data points not considered outliers and the outliers are plotted individually using the symbol when the similarities between the silivri buoy data and the model hindcasts in the box plots the left panel of fig 3 are examined it is seen that the cc model is more compatible with the measurements likewise when the satellite data and the model hindcasts in the box plot the right panel of fig 3 are examined it is seen that the satellite data is higher but cc model is the more compatible with the measurements as can be seen from the scatter diagrams shown in fig 4 the results of cc are closer to the line of perfect agreement in comparison to the other models the other three swan models under estimate on average the wave height values in order to examine the validity of the models for the entire sea of marmara the data measured by the satellites is used in this regard the performances of the predictions obtained from the four models are compared with the satellite data and the results are given in fig 5 as can be seen in this figure the cc model performs better in comparison to the other three models in regard to both buoy and satellite data this case can be explained by the over estimation of the cfsr winds compensated by the under estimation of swan as mentioned in van vledder and akpınar 2015 therefore use of the cfsr wind in combination with swan gives the best wave hindcast result in the sea of marmara based on the validation 5 2 spatial variability of mean wind and wave characteristics 5 2 1 mean wind speeds in this section the spatial distributions of the long term mean of the wind speed and directions on the sea of marmara are examined for this the means for the 40 years between 1979 and 2018 of the wind speeds taken from cfsr and era interim data sets were determined the resulting spatial distributions of mean speed and direction of the cfsr winds are given in fig 6 upper panel according to this figure the highest mean wind speeds 5 m s are observed in the middle regions of the sea of marmara the mean wind speeds decrease as one moves from the center of the sea of marmara towards the coasts and in the areas close to the islands and gulfs the lowest mean wind speeds 3 m s were detected in gulf of izmit gulf of gemlik and in the dardanelles south of the sea of marmara the highest mean wind speeds between 4 m s and 5 m s occurring in the coastal regions are found along the northern coasts possibly because they are not exposed to surface roughness effects by peninsulas and islands according to the long term mean wind directions the northeastern winds dominate the whole sea fig 6 lower panel also presents the differences in the mean wind speeds between the cfsr and era interim data obtained for the years of 1979 and 2018 according to this figure the highest mean wind speed differences 1 3 m s are obtained in the middle region of the sea of marmara it is also observed that the mean wind speed differences are between 0 5 m s and 1 m s in the middle regions of the sea of marmara in these regions it is found that cfsr winds are higher than the era interim winds the differences in mean wind speed decrease with increasing distance from the center of the sea of marmara and reverse sign near the eastern and western edges the era interim winds has made higher estimates around 0 8 m s in this area the seasonal evaluation of the areal changes of the long term mean wind speeds over the sea of marmara has also been made the spatial distribution of seasonal mean wind speeds of cfsr winds for 40 years 1979 2018 is presented in fig 7 left column as can be seen from this figure the highest mean wind speeds in all seasons occur in the middle regions of the sea of marmara also when all seasons are taken into consideration the highest mean wind speeds occur in the winter and they are around 5 8 m s for all season the lowest mean wind speeds between 2 5 m s 3 m s occur in gulfs of izmit and gemlik and dardanelles in the south western part of the sea of marmara the highest mean wind speeds along the coasts occur along the northern shores of the sea of marmara in all seasons in these areas mean wind speeds are around 5 m s in winter and around 4 m s in other seasons fig 7 second column also presents the spatial distributions of the seasonal mean wind speed differences between the cfsr and era interim data these spatial distribution plots show that the highest mean wind speed differences around 1 5 m sn in winter and autumn are in the mid coast of the sea of marmara in summer and spring the highest mean wind speed differences 1 m s are in the area along the mid coast and the north eastern coast of the sea of marmara and south western coast of the sea of marmara towards the dardanelles cfsr winds have higher values than the era interim winds in the middle regions of the sea of marmara in all seasons they are also higher along the south east and north west coats of the sea of marmara during winter and along the coasts of bursa during the other seasons in addition during all seasons the mean wind speed difference from the center of the sea of marmara to the north east and south west coasts decreased to zero and to reverse sign as was also seen in fig 6 5 2 2 mean significant wave heights hm0 long term spatial variations of the mean significant wave height over the sea of marmara are examined in this part for this the spatial distribution of the mean significant wave height obtained from the cc model is presented in fig 8 first row in upper panel in this figure the mean significant wave height distributions are consistent with the spatial distribution of the wind speed see fig 6 the highest mean significant wave heights of around 0 4 m were estimated in the central regions of the sea of marmara and decrease towards the shores in addition the sheltering effects of islands and peninsulas on wave heights are clearly seen in the decrease of mean significant wave height in such areas in the northern coasts of the kapıdağ peninsula the marmara island and i̇mralı island the mean significant wave heights are observed to be over 0 3 m while in the areas behind these islands this value falls below 0 2 m however the mean wave heights along the coasts of bursa karacabey which is not affected by the islands are in the range of 0 2 0 3 m in the gemlik i̇zmit and bandırma gulf inlets the mean significant wave heights are between 0 1 and 0 2 m and this value decreases to values lower than 0 1 m in the gulfs the mean significant wave heights in the gulf of erdek which are more affected by the islands and the gulf are close to zero the difference graphs fig 8 second third fourth row of panels show that the cc model has made higher estimates in the middle of the sea of marmara than the results of the other 3 models and the differences decrease from the middle towards the coasts it is also found that the cc model produces higher results over the whole sea of marmara compared to dc model the results however for both of the ce and de models indicate that the differences are again increasing in negative direction in the south west part of the sea of marmara and along the northeast coast of the sea of marmara and in the gulf of izmit consequently higher wave height estimates were made according to the cc model results the seasonal variations of the mean significant wave heights are presented in fig 9 according to the seasonal variation graphs of the cc model results upper row of panels the highest mean significant wave heights of around 0 55 m occur in the middle of sea of marmara in winter in the spring waves at lower heights occur in comparison to other seasons the highest mean wave height in this season is around 0 3 m and observed in the middle of the sea of marmara in the gulfs it is found that for all seasons the mean wave heights are close to zero for the areas on the north coast of the i̇stanbul islands and to the south west of the sea of marmara towards the dardanelles the difference graphs of the seasonal mean significant wave heights fig 9 second third and fourth row of panels show that the highest mean significant wave height differences in all models occur in the middle of the sea of marmara in winter in this area the results closest to the cc model results are obtained from the dc model results 0 08 m while the highest differences 0 28 m are obtained from the de model results the lowest seasonal mean wave height differences obtained from the dc and de model results are found in the gulfs and the areas close to the islands the mean significant wave height differences in these areas are close to zero in all seasons the cc model results along the shores of bursa province kapıdağ peninsula and marmara island and in the central regions of the sea of marmara show higher values compared to the ce model results apart from these areas the wave height differences approach to zero as one moves from the central regions of the sea of marmara towards the coasts then the differences increase again and reverse sign in the north east and south west coast of the sea of marmara in these areas the ce model results were estimated to be approximately 0 1 m higher than the cc model results 5 3 spatial variability of extreme wave heights 5 3 1 95th and 99th percentile significant wave heights many oceanographic and engineering applications require estimates of extreme values of geophysical parameters such as wave height and wind speed such extremes can be expressed in a number of forms for a given time series operational activities will require estimates of extreme individual wave amplitudes or wind gusts similarly statistical quantities such as 95th and 99th percentiles signify the values which would be exceeded 5 and 1 of the time respectively they can be also defined as significant wave heights not exceeding the 95 and 99 of time the long term analysis of significant wave heights values not exceeding the 95 and 99 of time in the sea of marmara for the four models is investigated by inspection of their spatial variations as shown in fig 10 the spatial distribution graphs of yearly mean significant wave heights not exceeding the 95 and 99 of time using the cc model results are given in the upper row of fig 10 significant wave heights not exceeding the 95 and 99 of time in the central regions of the sea of marmara are between 1 m and 1 2 m and between 1 5 m and 2 m respectively in addition significant wave heights not exceeding the 99 of time are between 1 5 and 2 m on the northern and northeastern coasts of kapıdağ peninsula and marmara island these values are close to zero in the gulfs and along the northern shores of the istanbul islands the difference graphs show that the largest differences for yearly mean significant wave heights not exceeding the 95 and 99 of time are produced in the central regions of the sea of marmara from the de and ce models for both probability of non exceedance significant wave height values for ce model 0 4 m for 95 0 6 m for 99 for de model 0 6 m for 95 0 9 m for 99 the probabilities of non exceedance for both thresholds obtained from the ce model results in the gulfs north east of the sea of marmara and in the south west of the sea of marmara show higher estimates compared to the cc model results in addition the de model seems to give higher estimates in the areas of the gulf of i̇zmit along the northern shores of the istanbul islands and along the south west coast of the sea of marmara towards the dardanelles in comparison to the cc model results according to these graphs the closest estimates to the cc model results in the central regions of the sea of marmara are provided by the dc model results 5 3 2 probabilities of significant wave heights exceeding a critical value long term analyses of the four models are examined by obtaining spatial variations of probabilities of the significant wave height estimates of exceeding a certain critical value within the scope of this article two critical wave heights were selected and analyzed the first of them is the wave height of 0 5 m reflecting the calm sea state the other is 2 m which is the maximum value of significant wave heights not exceeding the 99 threshold over the marmara sea calm sea state and different threshold wave heights are of significance in ocean engineering so we discussed them the probabilities exceeding the critical waves were determined separately for each year for 40 years and an average distribution map was obtained using 40 year probability maps the spatial distribution graphs upper row of the probability exceeding 0 5 m and 2 m waves produced from the cc model and spatial difference plots of the probability of exceeding the waves of 0 5 m and 2 m produced from the other models are presented in fig 11 based on the spatial distribution graphs fig 11 upper row of the probability of exceeding the 0 5 m and 2 m significant wave heights produced by the cc model the maximum values of the probability of exceeding the 0 5 m threshold around 30 are observed in the central regions of the sea of marmara the highest values of the probability of exceedance 1 for the 2 m threshold are estimated in the central regions of the sea of marmara also in the northern shores of kapıdağ peninsula and the northeast shores of the marmara island the values of probability of exceedance are between 0 6 and 1 0 the probability of exceedance for both wave heights decreases as one moves from the central regions of the sea of marmara to the shores along the north east coast of the sea of marmara in the gulfs and in the south west of the sea of marmara towards the dardanelles strait the probability of exceedance for each of the two heights is close to zero the difference graphs lower left row of fig 11 show that the biggest differences for the probability of exceeding 0 5 m waves occur in the central regions of the sea of marmara using the de model results the differences here are around 20 in all models the probability of exceeding the 0 5 m threshold decreases towards the coast the differences however of the probabilities of exceeding the 0 5 m threshold produced from the ce model results first decrease towards the shores and then increase again towards the north east coasts and towards the area in the south west towards the dardanelles it is seen here that the ce model have higher probability estimates than the cc model outside these areas the cc model gives higher probability estimates compared to the ce model results the differences for all models are however very small based on the spatial variation graphs of the differences in the probability of exceedance for the 2 m threshold the highest difference values of the probability of exceedance for the 2 m threshold were obtained as about 1 from the de model results in an area close to the north of the kapıdağ peninsula in the central part of the sea of marmara for all models the differences of the probability of exceedance for the 2 m threshold are near zero in the most part of the sea of marmara 5 3 3 maximum significant wave heights this section addresses the spatial distribution of long term maximum significant wave heights in the sea of marmara the spatial distribution graphs of the maximum significant wave heights obtained from the cc model results and the spatial distribution graphs of the differences with respect to the other three models are presented in fig 12 the results of the cc model show that the largest maximum significant wave height is about 4 70 m such waves occurred in the central regions of the sea of marmara along the eastern shores of the marmara island and along the north coasts of the kapıdağ peninsula the changes in the spatial variation of the maximum significant wave heights are similar to those of the mean significant wave height when approaching the coast the decrease in wave heights is faster in areas sheltered by islands similarly the lowest maximum significant wave heights occur in the gulfs along the northern shores of the istanbul islands and in the areas south of the marmara islands the difference graphs show that the biggest maximum significant wave height differences for each model combination occur in the central regions of the sea of marmara near the kapıdağ peninsula and marmara island the biggest maximum significant wave height differences were observed to be around 2 8 m this value is obtained from the differences of the de model results from the cc model results this may be probably due to model settings because in our previous study kutupoğlu et al 2018 we determined that the default model underestimates significant wave heights in comparison to the calibrated model the lower whitecapping coefficient cds in the calibrated model yields higher significant wave heights therefore we speculate that the difference here is due to different model settings the significant differences in results between the four models are very important for the choice of model settings in wave climate studies this holds in particular for the common practice in turkey where modelers and designers usually apply the default settings in the third generation wave hindcast model as well as the era interim winds the noted differences do not have a great effect on average wave conditions but the more for the higher extreme and maximum wave heights where underestimations up to 2 8 m may result these significant under predictions can also cause design errors due to their use in the port design and design of coastal structures in the relevant coastal areas when the present results are taken into consideration the importance of model settings and the winds selected emerges according to the mean wave height values the de model produced lower estimates than the cc model but according to the extreme wave heights it is observed it made higher estimates about 0 6 m in the east of i̇zmit bay and in the area to the south west of the sea of marmara towards the dardanelles differences from the ce model also provide spatial distribution graphs similar to the mean value distributions here from the central areas of the sea of marmara to the north east and south west coasts firstly the maximum wave heights are decreased and secondly the values are close to zero then it is seen that the ce model results are higher than the cc model results this behavior is similar to the behavior in the winds 6 conclusions the calibrated swan model using cfsr winds presents the most accurate results areal values are therefore given for the calibrated swan model forced with the cfsr winds spatial distributions of biases of wind and waves parameters between the four different models are also discussed in the sea of marmara the cfsr winds present a better wave hindcast model performance and thus we may mention that the cfsr winds are generally the best in comparison with the era interim winds in view of its spatial and temporal resolutions because they are better able to solve land effects the best results are obtained with the cc model in terms of both buoy and satellite data calibration has a large effect on the estimated maximum wave conditions showing about 2 8 m difference between the calibrated and default model settings results while it does not show a significant effect in terms of average wave conditions therefore using calibrated wave models is especially important in the design of ports and coastal structures in the relevant coastal areas as it avoids too optimistic design criteria the model hindcasts are consistent with the silivri buoy data and satellite data but the satellite based wave heights are higher than the model predictions due to land effects mean wind speeds decrease from central towards coastal areas of the sea of marmara and this decrease is even more in areas that interact with islands and gulfs related to this behavior the mean significant wave height decreases towards the coastal areas of the sea due to the island and peninsula effects on the surface roughness the highest mean wind speeds and significant wave heights are observed in winter and the lowest in spring and in the rest of the seasons these mean conditions are close to each other spatial distributions of seasonal and long term mean wind speeds and significant wave heights show similarities although their distribution details and intensity are different the spatial distributions of the long term mean significant wave heights obtained from the cc model results are consistent with the spatial distributions of mean wind speeds three different analyzes have been made for the spatial variability of extreme wave heights the highest values for significant wave heights not exceeding the 95 and 99 of time are obtained from the cc model these values are respectively 1 25 m and 1 91 m in the central regions of the sea of marmara close to kapıdağ peninsula and marmara island the highest values 30 for the probability of exceedance of the mean of 0 5 m threshold are obtained from the cc model occur in the central regions of the sea of marmara also the highest values of the probability of exceedance 1 for the 2 m threshold are estimated in the central regions of the sea of marmara the highest maximum significant wave heights for 40 years estimated by the cc model on the sea of marmara are estimated to be around 4 70 m in the central regions of the sea of marmara along the eastern shores of the marmara island and along the northern and eastern shores of the kapıdağ peninsula for all that the cc model predicts a maximum significant wave height up to 0 78 m higher than obtained by the dc model these differences increase to 2 18 m and 2 78 m for the ce and de models in most areas the cc model produces the highest maximum significant wave heights exceptions occur for the areas towards the dardanelles strait and on the north east coast of the sea of marmara where the highest maximum significant wave heights are obtained with the de and ce models which are 0 5 m higher than those obtained with the cc model within the scope of this study four different 40 year datasets with high resolution and accuracy have been produced which can be used in the design of nearshore structures in the sea of marmara and or in the continuation of any activity e g cruise port operation etc it is recommended that these data sets be used to sustain these activities in the following process temporal analysis of wind and wave parameters individual analyzes of storms analysis of spectral properties of waves and estimation of extreme waves with different recurrent periods will be carried out with the help of these data sets credit authorship contribution statement adem akpınar conceptualization methodology writing review editingwriting review editing supervision volkan kutupoğlu writing original draftwriting original draft software validation visualization formal analysis investigation resources data curation bilal bingölbali software visualization resources formal analysis data curation emre çalışır validation visualization software formal analysis resources data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is dedicated to dr gerbrant van vledder for his kindness and devotion and his endless help and support in the preparation of this manuscript the authors would like to thank him deeply unfortunately we lost him with great sadness at november 22 2019 although he is no longer with us he continues to inspire us by his example and dedication to science we would like to thank to australian ocean data network aodn portal where we obtain calibrated satellite data tsms turkish state meteorological service for providing the the measurements at silivri noaa national oceanic and atmospheric administration for sharing the cfsr wind datasets tsms turkish state meteorological service for its help in obtaining the necessary permissions for obtaining the data from the ecmwf and gebco general bathymetric chart of the oceans for where we provide bathymetry of the sea of marmara appendix a model performance evaluation criteria model performance is assessed using the following statistical error measures it is noted that to properly judge the quality of any model it is recommended to apply a mixture of various statistical and graphical techniques since using only one error criterion may lead to a misinterpretation of results therefore we use several error indicators such as the mae rmse bias si etc as well as the correlation coefficient and index of agreement the first error value to be compared is the mean absolute error mae calculated as below a 1 m a e 1 n i 1 n y i x i where yi are hindcast values xi are measurement values and n is the number of data another error parameter is the root mean square error rmse calculated as a 2 r m s e 1 n i 1 n x i y i 2 and the variables are the same as those of the previous error parameter the normalized root mean square error nrmse is defined as the following a 3 n r m s e i 1 n x i y i 2 i 1 n x i 2 the mean difference bias is given by a 4 b i a s x y where x and y are the means of the measurements and hindcasts respectively the normalized bias index nbi is calculated as a 5 n b i b i a s x to evaluate the performances of the wave heights we used also the normalized bias nmb a 6 n m b y i x i x i the nmb shows the model tendency to over or underestimate relative to the measurements the other indicator used for a cross comparison between different models is the normalized root mean square error hh introduced by hanna and heinold 1985 the main advantage of this parameter is the fact that it is not biased toward simulations that underestimate the average and it is not sensitive to the mean observed values a 7 h h y i x i 2 y i x i except for seven different error criteria the scatter index si values were calculated using the following expression a 8 s i r m s e x for all error indices above a value being nearest to zero presents better performance in comparison with other values the correlation coefficient r indicating the correspondence between measurement and hindcast data sets is calculated as a 9 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 the index of agreement d introduced by willmott 1982 was also used to make a cross comparison between different models for the same observed dataset this indicator varies from 0 to 1 with higher index values indicating that the modeled values have a better agreement with the observations a 10 d 1 y i x i 2 y i x x i x 2 
21079,this study aims to determine long term spatial variability of wind and wave characteristics over the sea of marmara for this purpose we produced four different wind and wave datasets for a period of 40 years 1979 2018 using the calibrated and default setting swan models forced with both cfsr and era interim winds and inter compared the performance of these datasets is examined against the wave height measurements of 2015 at the silivri buoy station and 27 year 1991 2018 satellites data envisat ers 1 ers 2 jason 1 jason 2 jason 3 sentinel 3a sentinel 3b topex then for wind and wave climate analysis the spatial distributions of the wind and wave characteristics over the study area are determined in terms of seasonal and annual averages 40 year averages of 95th and 99th percentile significant wave heights probabilities of being larger than significant wave heights exceeding a critical value and 40 year maximum significant wave heights are spatially analyzed finally the calibrated swan model using cfsr winds presents the most accurate results therefore the effects of different model inputs and settings on the model results are examined by creating spatial distributions of the biases of the other three model results and comparing them to those of the calibrated model results using cfsr winds the cfsr forced and calibrated model predicts the largest average wind speed and average wave height in the central regions of the sea of marmara in comparison with the other three models the shores of kapidag peninsula and marmara island are exposed to be with the highest wave conditions keywords wind speeds wave heights extreme waves the sea of marmara 1 introduction wind generated ocean surface waves potentially represent a serious hazard to life and property in various maritime and coastal activities hence it is necessary to develop the capability to forecast short term wave conditions over global and regional ocean domains to minimize loss of life and property tolman et al 2002 long term statistical information of the waves is also needed in order to solve many coastal engineering problems such as the design of coastal and harbor construction determination of the wave energy potential coastal erosion and sediment transport considering both short term fluctuations such as monthly seasonal and inter annual variations and long term changes due to the climate change are very important for coastal regions kamranzad 2018 although instrumental measurements are valuable for studying these characteristics they are limited in practice akpinar et al 2012 kalra et al 2005 buoys directly measure accurate time series of wave data at specific locations however the duration of buoy measurements is generally relatively short and sparsely distributed around the world satellites present a global coverage and provide information with a high spatial resolution and long duration izaguirre et al 2011 young et al 2011 ribal et al 2019 satellite measurements however are not reliable in coastal areas and do not give spectral and or wave period information altimeter products only provided significant wave heights as an attractive alternative to the aforementioned techniques the wave hindcast provides a long term homogeneous wave database which can be used to analyse the characteristics of waves at global and regional scales liang et al 2019 using third generation numerical wave hindcast models such as swan wavewatchiii wam and etc an assessment of spatio temporal variations of the wind and wave characteristics can be carried out in different areas of the world in order to define the marine wave climate kamranzad 2018 for regional scales there are many studies akpınar et al 2016 arkhipkin et al 2014 chen et al 2013 gippius et al 2016 kamranzad 2018 lv et al 2014 soukissian et al 2008 wang et al 2018 xu et al 2017 investigating the wind and wave climate concerning the sea of marmara to this day there are only three studies abddollahzadeh et al 2014 özhan and abdalla 1999 saraçoğlu 2011 available on wind wave modeling in these studies however model performance evaluations and validations have been carried out using wave measurements for a too short period about 2 months for this reason in our previous study kutupoğlu et al 2018 we focused on model development using long term wind and wave measurements the swan model forced with the cfsr and era interim winds was calibrated using one year wave measurements and the validation was based on three year wave measurements in the present study we aim to determine the long term spatial variations of wind and wave characteristics on the sea of marmara in addition we present an intercomparison of the results obtained with the four models to determine the impact of the different settings and various forcing to achieve this goal we benefit from four different wind and wave datasets at a 40 year period 1979 2018 produced with the calibrated and default setting swan models forced with both cfsr and era interim winds by kutupoğlu et al 2018 these datasets have wind and wave parameters regarding wind speed components u and v significant wave height hm0 and the mean wave direction dir by using the collected data in the present study spatial distributions and variability of wind and wave characteristics are examined in terms of monthly seasonal and annual means of these parameters the 95th and 99th percentile significant wave heights probabilities of significant wave heights exceeding a critical value and maximum significant wave heights areal values are given for the calibrated swan model forced with the cfsr winds spatial distributions of biases of wind and waves parameters between the four different models are also discussed 2 study area the sea of marmara is located in the northwest of turkey between the 40 41 25 north latitude and 26 30 east longitude the sea of marmara connects to the aegean sea with dardanelles strait and to the black sea with the bosphorus in the north south direction the widest part of the sea is 80 km and in the east west direction the longest axes of is 280 km the sea of marmara has an area of 11 350 km2 is also an internationally important waterway due to its two straits the smallest width of these straits reaches 700 m in the bosphorus at the anatolian coasts of the sea of marmara bays and gulfs are presents producing an irregular coastline the main ones are the bays of i̇zmit gemlik bandırma and erdek near those bays there are prince islands i̇mralı and marmara islands which have a rough terrain at the south coast of the sea of marmara the coastline is wavy because of the existence of peninsulas and bays in the sea of marmara there are significant depths despite being a small sea the deepest spots are in the elliptic pit that goes in west east direction starting from the entrance of the bay of i̇zmit the easternmost pit located in south of the prince islands is 1238 m deep the deepest pit is located in the middle of the sea of marmara between marmara ereğlisi and kapıdağ peninsula with a depth of 1390 m artüz et al 2007 3 data used any wave hindcast model which aims to produce long term wind and wave data base needs input data that include bathymetry and wind fields the bathymetry of the sea of marmara is shared in the public domain for academic studies from the general bathymetric chart of the oceans gebco digital atlas 2014 with a resolution of 0 008333 in both longitude and latitude for the black sea van vledder akpinar 2015 showed that among 6 different wind fields the best wave model performance is obtained by using cfsr winds besides era interim winds are used as the main wind data source in turkey therefore it was preferred to use the data bases of cfsr from noaa and era interim from ecmwf for the wind fields for both wind data source the data is provided for the years from 1979 to 2018 covering the study area noaa presents two versions for cfsr winds which the cfsr version 1 of cfs re analysis data set saha et al 2010 is available from january 1 1979 to march 31 2011 and version 2 saha et al 2014 of the cfsr data sets was put into operation in march 2011 all cfsr winds data sets have a 1 h temporal resolution but they have a 0 3125 0 3125 spatial resolution from 1979 to 2010 and 0 2045 0 2045 from 2011 to present however era interim winds dee et al 2011 are collected in a 6 h temporal resolution and in 0 1 spatial resolution both in latitude and longitude for both wind data sources 10 m u and v wind speed components up to 2013 were downloaded from ecmwf and noaa websites at the end of 2014 within thesis project of the first author in addition the data from 2014 to the present were obtained within this study in order to examine the validity of the models two measurement data sets were used the first one comprises wave buoy measurements collected for the year 2015 deployed for meteorological purpose located offshore of silivri the station belongs the tpao turkish petroleum corporation and named at the odas 01 tr silivri buoy station positioned in 41 043889 n and 28 186944 e is located 3 km offshore from the coasts of silivri district of i̇stanbul province at a depth of 50 m at this station wind speed measurements at a 1 min temporal resolution and wave measurements at 30 min temporal resolution are available from 2013 to the end of 2017 in 2015 there are 16 246 data records and the measured maximum significant wave height is 2 93 m and the average significant wave height is 0 35 m the second data set for wave height are envisat environmental satellite ers european remote sensing 1 ers 2 jason joint altimetry satellite oceanography 1 jason 2 jason 3 sentinel 3a sentinel 3b topex poseidon satellites data that recorded between 1991 and 2018 the positions of the recorded data by the satellites and its passes are shown in fig 1 and the satellites used within the study and the years of satellite data measurements are shown in table 1 in this study satellite data described and calibrated in ribal et al 2019 was used data belonging to all satellites were analyzed as a single data set as stated in ribal et al 2019 the concurrent process was carried out with a maximum 30 min temporal difference and 7 km spatial difference between the model data and satellite data between 1991 and 2018 years the number of wave measurement collocated data points is 65139 the data statistics see table 2 show that the measured maximum significant wave height is 3 76 m and the mean significant wave height is 0 74 m long term analysis of wind and wave parameters was carried out by using models results of our previous studies kutupoğlu 2017 kutupoğlu et al 2018 the four different models which were run with both wind datasets and two different wave model settings were operated for the 40 year period between 1979 and 2018 4 wave model setup swan version 41 01 model is used to perform the wave hindcast study the model was run in third generation mode with a time step of 30 min in a nonstationary mode using 1 iteration per time step model grid involves the area between 26 6958 and 29 9958 east longitudes and 40 2042 41 0942 north latitudes which includes entire the sea of marmara this area is discretized with a regular spherical grid that includes 500 135 nodal points with a 0 0066 around 1 15 uniform resolution in every direction this grid resolution was determined in view of the ability to accurately predict short fetch wave growth data storage and simulation times directional wave variance spectrum is discretized by using 36 directional and 35 frequency bins between 0 04 hz and 1 0 hz kutupoğlu et al 2018 within the scope of the study four different swan models with different settings and inputs are run as mentioned in the previous chapter two of them are based on the default settings of the swan model that use cfsr and era interim winds to distinguish between results obtained from the various models we used the following codes the letters c and e to refer to the wind sources cfsr and era interim respectively and d and c for default and calibrated so the acronym cc refers to the calibrated model forced with the cfsr winds dc default model using the cfsr ce the calibrated model forced with the era interim and de default model using era interim default setting wave model computations are based on swan version 41 01 using the recommended default setting swan team 2016 for whitecapping the expression by komen et al 1994 is used in which delta 1 according to rogers et al 2003 for wind wave growth the formulation of komen et al 1994 is used quadruplet interactions are estimated using the discrete interaction approximation dia by hasselmann et al 1985 using λ 0 25 and cnl4 3 107 the jonswap bottom friction formulation is used with cfjon 0 038 m2 s 3 according to zijlema et al 2012 depth limited wave breaking is modeled according to the bore model of battjes and janssen 1978 using alfa 1 and gamma 0 73 the other two models are based on the settings kutupoğlu et al 2018 obtained from the calibration of swan models run with both the cfsr and era interim winds the performances of the calibrated models and calibration details are given in the detail in our previous study kutupoğlu et al 2018 to sum up the swan model was calibrated with the wind and wave measurements of the silivri wave buoy annual measurements at the silivri station in 2013 are used to calibrate the swan model for both wind data sources swan model performances are evaluated on the basis of the significant wave height hm0 measured at the buoy location for the calibration of the models a sensitivity analysis was performed to find the optimal numerical and physical settings the sea of marmara can practically be considered as deep water so the deep water processes of wind input whitecapping and quadruplet interactions are dominant and of equal magnitude the shallow water processes of bottom friction depth limited wave breaking and triad interactions are insignificant except along the shallow coastal zones also the analyzes show that the most effective process on the model results is the selection of the deep water physical source terms for wind input and whitecapping formulations and the whitecapping coefficient c ds for the wave model calculations different recommended formulations i e source terms and coefficients are used for wind input and whitecapping processes and the ones with the best performances minimum error and maximum correlation are selected for further inspection apart from choosing a particular source term also the whitecapping coefficient cds is calibrated the best swan model setup obtained after the calibration kutupoğlu et al 2018 for cfsr winds is based on the komen et al 1994 s formulation for the wind input and janssen janssen 1991 1992 s whitecapping term with delta 1 and cds 1 0 which its default value is 4 5 for the era interim winds the calibration yields the same wind input formulation as for the cfsr wind and the komen et al 1994 s whitecapping formulation with cds 0 5e 5 which its default value equals to 2 36e 5 all other physical adjustments of the model setting were kept as in the default model however the only exception is that when the triad wave wave interaction is deactivated in default model it is actived based on eldeberky 1996 s lta approach with trfac 2 5 in calibrated models as can be seen from these adjustments besides the difference in triads the whitecapping formulation in the calibrated model using cfsr is different from the default formulation and also the whitecapping coefficients in the calibrated models using era interim and cfsr winds is different in comparison with that of default model 5 results and discussion 5 1 model performances the statistical error analysis summary of wave prediction results based on the four different models and the 1 year period is given in table 2 according to table 2 the models produce similar mae rmse and nrmse values except the de model results whose error values are higher than the others the models run with cfsr winds have lower si values 49 and 47 for the cc and de models and higher values for coefficient of correlation 84 for both models and the index of agreement 91 and 89 for the cc and de models in comparison with the models run with era interim winds on the one hand the calibrated swan model run with cfsr winds cc model has a lower bias 0 03 m hh 40 and nbi 8 values in comparison with the other three models on the other hand in comparison to the other three swan model the best calibrated model cc model achieved the closest predicted mean 0 32 m to the measurement means 0 35 m it is also observed that according to the nmb all models slightly underestimate the significant wave heights before testing the accuracy of model data against satellite data the performance of satellite data against silivri buoy data was analyzed to show the validity of satellite data in the area of interest when we apply the collocation code maximum 30 min temporal difference and 7 km spatial difference between the buoy and satellite data we obtained no collocated data between buoy and satellites therefore we tried to allow more time shifting from 0 5 h to 12 h and larger area to have more collocated data between tried options highest correlation and lowest errors were obtained in the case of option for the area between longitudes 28 12 28 25 and latitudes 40 9 41 042 of collocation and 0 5 h time shift correlation is 0 48 and si rmse and bias are respectively 0 61 0 44 m and 0 30 m fig 2 a presents silivri buoy location and satellite data points there is presented concurrent satellite data with buoy data based on the collocation method as the green points the red rectangle frame shows the area longitudes 28 12 28 25 and latitudes 40 9 41 042 used for the best option the satellite data falling into this area was co located to the buoy data the scatter diagram of the satellite data matched with this collocation method against the buoy data is given in fig 2b as can be seen from this scatter plot satellite data gives higher wave heights than the buoy data the results of the error analysis of swan model hindcasts against the satellites data are also presented in table 2 the results show that the best performing model cc model has lower error values bias 0 21 m and si 60 for cc model in terms of all error parameters in comparison with other three models likewise the models using cfsr winds have higher correlation coefficient for cc model r 0 60 and for dc model r 0 61 than the models using era interim winds for both models r 0 57 the best agrement d 0 73 is also obtained with the cc model thus as expected the best model results are obtained for the cc model it should be also noted that there is a difference between the averages of the satellite data and the hindcast results the satellite based wave heights are higher than the model predictions due to land effects this case can be also observed in fig 3 presented the box plots of significant wave height for all model results against the 2015 silivri buoy and the satellites data on each box the central mark indicates the median and the bottom and top edges of the box indicate the 25th and 75th percentiles respectively the whiskers extend to the most extreme data points not considered outliers and the outliers are plotted individually using the symbol when the similarities between the silivri buoy data and the model hindcasts in the box plots the left panel of fig 3 are examined it is seen that the cc model is more compatible with the measurements likewise when the satellite data and the model hindcasts in the box plot the right panel of fig 3 are examined it is seen that the satellite data is higher but cc model is the more compatible with the measurements as can be seen from the scatter diagrams shown in fig 4 the results of cc are closer to the line of perfect agreement in comparison to the other models the other three swan models under estimate on average the wave height values in order to examine the validity of the models for the entire sea of marmara the data measured by the satellites is used in this regard the performances of the predictions obtained from the four models are compared with the satellite data and the results are given in fig 5 as can be seen in this figure the cc model performs better in comparison to the other three models in regard to both buoy and satellite data this case can be explained by the over estimation of the cfsr winds compensated by the under estimation of swan as mentioned in van vledder and akpınar 2015 therefore use of the cfsr wind in combination with swan gives the best wave hindcast result in the sea of marmara based on the validation 5 2 spatial variability of mean wind and wave characteristics 5 2 1 mean wind speeds in this section the spatial distributions of the long term mean of the wind speed and directions on the sea of marmara are examined for this the means for the 40 years between 1979 and 2018 of the wind speeds taken from cfsr and era interim data sets were determined the resulting spatial distributions of mean speed and direction of the cfsr winds are given in fig 6 upper panel according to this figure the highest mean wind speeds 5 m s are observed in the middle regions of the sea of marmara the mean wind speeds decrease as one moves from the center of the sea of marmara towards the coasts and in the areas close to the islands and gulfs the lowest mean wind speeds 3 m s were detected in gulf of izmit gulf of gemlik and in the dardanelles south of the sea of marmara the highest mean wind speeds between 4 m s and 5 m s occurring in the coastal regions are found along the northern coasts possibly because they are not exposed to surface roughness effects by peninsulas and islands according to the long term mean wind directions the northeastern winds dominate the whole sea fig 6 lower panel also presents the differences in the mean wind speeds between the cfsr and era interim data obtained for the years of 1979 and 2018 according to this figure the highest mean wind speed differences 1 3 m s are obtained in the middle region of the sea of marmara it is also observed that the mean wind speed differences are between 0 5 m s and 1 m s in the middle regions of the sea of marmara in these regions it is found that cfsr winds are higher than the era interim winds the differences in mean wind speed decrease with increasing distance from the center of the sea of marmara and reverse sign near the eastern and western edges the era interim winds has made higher estimates around 0 8 m s in this area the seasonal evaluation of the areal changes of the long term mean wind speeds over the sea of marmara has also been made the spatial distribution of seasonal mean wind speeds of cfsr winds for 40 years 1979 2018 is presented in fig 7 left column as can be seen from this figure the highest mean wind speeds in all seasons occur in the middle regions of the sea of marmara also when all seasons are taken into consideration the highest mean wind speeds occur in the winter and they are around 5 8 m s for all season the lowest mean wind speeds between 2 5 m s 3 m s occur in gulfs of izmit and gemlik and dardanelles in the south western part of the sea of marmara the highest mean wind speeds along the coasts occur along the northern shores of the sea of marmara in all seasons in these areas mean wind speeds are around 5 m s in winter and around 4 m s in other seasons fig 7 second column also presents the spatial distributions of the seasonal mean wind speed differences between the cfsr and era interim data these spatial distribution plots show that the highest mean wind speed differences around 1 5 m sn in winter and autumn are in the mid coast of the sea of marmara in summer and spring the highest mean wind speed differences 1 m s are in the area along the mid coast and the north eastern coast of the sea of marmara and south western coast of the sea of marmara towards the dardanelles cfsr winds have higher values than the era interim winds in the middle regions of the sea of marmara in all seasons they are also higher along the south east and north west coats of the sea of marmara during winter and along the coasts of bursa during the other seasons in addition during all seasons the mean wind speed difference from the center of the sea of marmara to the north east and south west coasts decreased to zero and to reverse sign as was also seen in fig 6 5 2 2 mean significant wave heights hm0 long term spatial variations of the mean significant wave height over the sea of marmara are examined in this part for this the spatial distribution of the mean significant wave height obtained from the cc model is presented in fig 8 first row in upper panel in this figure the mean significant wave height distributions are consistent with the spatial distribution of the wind speed see fig 6 the highest mean significant wave heights of around 0 4 m were estimated in the central regions of the sea of marmara and decrease towards the shores in addition the sheltering effects of islands and peninsulas on wave heights are clearly seen in the decrease of mean significant wave height in such areas in the northern coasts of the kapıdağ peninsula the marmara island and i̇mralı island the mean significant wave heights are observed to be over 0 3 m while in the areas behind these islands this value falls below 0 2 m however the mean wave heights along the coasts of bursa karacabey which is not affected by the islands are in the range of 0 2 0 3 m in the gemlik i̇zmit and bandırma gulf inlets the mean significant wave heights are between 0 1 and 0 2 m and this value decreases to values lower than 0 1 m in the gulfs the mean significant wave heights in the gulf of erdek which are more affected by the islands and the gulf are close to zero the difference graphs fig 8 second third fourth row of panels show that the cc model has made higher estimates in the middle of the sea of marmara than the results of the other 3 models and the differences decrease from the middle towards the coasts it is also found that the cc model produces higher results over the whole sea of marmara compared to dc model the results however for both of the ce and de models indicate that the differences are again increasing in negative direction in the south west part of the sea of marmara and along the northeast coast of the sea of marmara and in the gulf of izmit consequently higher wave height estimates were made according to the cc model results the seasonal variations of the mean significant wave heights are presented in fig 9 according to the seasonal variation graphs of the cc model results upper row of panels the highest mean significant wave heights of around 0 55 m occur in the middle of sea of marmara in winter in the spring waves at lower heights occur in comparison to other seasons the highest mean wave height in this season is around 0 3 m and observed in the middle of the sea of marmara in the gulfs it is found that for all seasons the mean wave heights are close to zero for the areas on the north coast of the i̇stanbul islands and to the south west of the sea of marmara towards the dardanelles the difference graphs of the seasonal mean significant wave heights fig 9 second third and fourth row of panels show that the highest mean significant wave height differences in all models occur in the middle of the sea of marmara in winter in this area the results closest to the cc model results are obtained from the dc model results 0 08 m while the highest differences 0 28 m are obtained from the de model results the lowest seasonal mean wave height differences obtained from the dc and de model results are found in the gulfs and the areas close to the islands the mean significant wave height differences in these areas are close to zero in all seasons the cc model results along the shores of bursa province kapıdağ peninsula and marmara island and in the central regions of the sea of marmara show higher values compared to the ce model results apart from these areas the wave height differences approach to zero as one moves from the central regions of the sea of marmara towards the coasts then the differences increase again and reverse sign in the north east and south west coast of the sea of marmara in these areas the ce model results were estimated to be approximately 0 1 m higher than the cc model results 5 3 spatial variability of extreme wave heights 5 3 1 95th and 99th percentile significant wave heights many oceanographic and engineering applications require estimates of extreme values of geophysical parameters such as wave height and wind speed such extremes can be expressed in a number of forms for a given time series operational activities will require estimates of extreme individual wave amplitudes or wind gusts similarly statistical quantities such as 95th and 99th percentiles signify the values which would be exceeded 5 and 1 of the time respectively they can be also defined as significant wave heights not exceeding the 95 and 99 of time the long term analysis of significant wave heights values not exceeding the 95 and 99 of time in the sea of marmara for the four models is investigated by inspection of their spatial variations as shown in fig 10 the spatial distribution graphs of yearly mean significant wave heights not exceeding the 95 and 99 of time using the cc model results are given in the upper row of fig 10 significant wave heights not exceeding the 95 and 99 of time in the central regions of the sea of marmara are between 1 m and 1 2 m and between 1 5 m and 2 m respectively in addition significant wave heights not exceeding the 99 of time are between 1 5 and 2 m on the northern and northeastern coasts of kapıdağ peninsula and marmara island these values are close to zero in the gulfs and along the northern shores of the istanbul islands the difference graphs show that the largest differences for yearly mean significant wave heights not exceeding the 95 and 99 of time are produced in the central regions of the sea of marmara from the de and ce models for both probability of non exceedance significant wave height values for ce model 0 4 m for 95 0 6 m for 99 for de model 0 6 m for 95 0 9 m for 99 the probabilities of non exceedance for both thresholds obtained from the ce model results in the gulfs north east of the sea of marmara and in the south west of the sea of marmara show higher estimates compared to the cc model results in addition the de model seems to give higher estimates in the areas of the gulf of i̇zmit along the northern shores of the istanbul islands and along the south west coast of the sea of marmara towards the dardanelles in comparison to the cc model results according to these graphs the closest estimates to the cc model results in the central regions of the sea of marmara are provided by the dc model results 5 3 2 probabilities of significant wave heights exceeding a critical value long term analyses of the four models are examined by obtaining spatial variations of probabilities of the significant wave height estimates of exceeding a certain critical value within the scope of this article two critical wave heights were selected and analyzed the first of them is the wave height of 0 5 m reflecting the calm sea state the other is 2 m which is the maximum value of significant wave heights not exceeding the 99 threshold over the marmara sea calm sea state and different threshold wave heights are of significance in ocean engineering so we discussed them the probabilities exceeding the critical waves were determined separately for each year for 40 years and an average distribution map was obtained using 40 year probability maps the spatial distribution graphs upper row of the probability exceeding 0 5 m and 2 m waves produced from the cc model and spatial difference plots of the probability of exceeding the waves of 0 5 m and 2 m produced from the other models are presented in fig 11 based on the spatial distribution graphs fig 11 upper row of the probability of exceeding the 0 5 m and 2 m significant wave heights produced by the cc model the maximum values of the probability of exceeding the 0 5 m threshold around 30 are observed in the central regions of the sea of marmara the highest values of the probability of exceedance 1 for the 2 m threshold are estimated in the central regions of the sea of marmara also in the northern shores of kapıdağ peninsula and the northeast shores of the marmara island the values of probability of exceedance are between 0 6 and 1 0 the probability of exceedance for both wave heights decreases as one moves from the central regions of the sea of marmara to the shores along the north east coast of the sea of marmara in the gulfs and in the south west of the sea of marmara towards the dardanelles strait the probability of exceedance for each of the two heights is close to zero the difference graphs lower left row of fig 11 show that the biggest differences for the probability of exceeding 0 5 m waves occur in the central regions of the sea of marmara using the de model results the differences here are around 20 in all models the probability of exceeding the 0 5 m threshold decreases towards the coast the differences however of the probabilities of exceeding the 0 5 m threshold produced from the ce model results first decrease towards the shores and then increase again towards the north east coasts and towards the area in the south west towards the dardanelles it is seen here that the ce model have higher probability estimates than the cc model outside these areas the cc model gives higher probability estimates compared to the ce model results the differences for all models are however very small based on the spatial variation graphs of the differences in the probability of exceedance for the 2 m threshold the highest difference values of the probability of exceedance for the 2 m threshold were obtained as about 1 from the de model results in an area close to the north of the kapıdağ peninsula in the central part of the sea of marmara for all models the differences of the probability of exceedance for the 2 m threshold are near zero in the most part of the sea of marmara 5 3 3 maximum significant wave heights this section addresses the spatial distribution of long term maximum significant wave heights in the sea of marmara the spatial distribution graphs of the maximum significant wave heights obtained from the cc model results and the spatial distribution graphs of the differences with respect to the other three models are presented in fig 12 the results of the cc model show that the largest maximum significant wave height is about 4 70 m such waves occurred in the central regions of the sea of marmara along the eastern shores of the marmara island and along the north coasts of the kapıdağ peninsula the changes in the spatial variation of the maximum significant wave heights are similar to those of the mean significant wave height when approaching the coast the decrease in wave heights is faster in areas sheltered by islands similarly the lowest maximum significant wave heights occur in the gulfs along the northern shores of the istanbul islands and in the areas south of the marmara islands the difference graphs show that the biggest maximum significant wave height differences for each model combination occur in the central regions of the sea of marmara near the kapıdağ peninsula and marmara island the biggest maximum significant wave height differences were observed to be around 2 8 m this value is obtained from the differences of the de model results from the cc model results this may be probably due to model settings because in our previous study kutupoğlu et al 2018 we determined that the default model underestimates significant wave heights in comparison to the calibrated model the lower whitecapping coefficient cds in the calibrated model yields higher significant wave heights therefore we speculate that the difference here is due to different model settings the significant differences in results between the four models are very important for the choice of model settings in wave climate studies this holds in particular for the common practice in turkey where modelers and designers usually apply the default settings in the third generation wave hindcast model as well as the era interim winds the noted differences do not have a great effect on average wave conditions but the more for the higher extreme and maximum wave heights where underestimations up to 2 8 m may result these significant under predictions can also cause design errors due to their use in the port design and design of coastal structures in the relevant coastal areas when the present results are taken into consideration the importance of model settings and the winds selected emerges according to the mean wave height values the de model produced lower estimates than the cc model but according to the extreme wave heights it is observed it made higher estimates about 0 6 m in the east of i̇zmit bay and in the area to the south west of the sea of marmara towards the dardanelles differences from the ce model also provide spatial distribution graphs similar to the mean value distributions here from the central areas of the sea of marmara to the north east and south west coasts firstly the maximum wave heights are decreased and secondly the values are close to zero then it is seen that the ce model results are higher than the cc model results this behavior is similar to the behavior in the winds 6 conclusions the calibrated swan model using cfsr winds presents the most accurate results areal values are therefore given for the calibrated swan model forced with the cfsr winds spatial distributions of biases of wind and waves parameters between the four different models are also discussed in the sea of marmara the cfsr winds present a better wave hindcast model performance and thus we may mention that the cfsr winds are generally the best in comparison with the era interim winds in view of its spatial and temporal resolutions because they are better able to solve land effects the best results are obtained with the cc model in terms of both buoy and satellite data calibration has a large effect on the estimated maximum wave conditions showing about 2 8 m difference between the calibrated and default model settings results while it does not show a significant effect in terms of average wave conditions therefore using calibrated wave models is especially important in the design of ports and coastal structures in the relevant coastal areas as it avoids too optimistic design criteria the model hindcasts are consistent with the silivri buoy data and satellite data but the satellite based wave heights are higher than the model predictions due to land effects mean wind speeds decrease from central towards coastal areas of the sea of marmara and this decrease is even more in areas that interact with islands and gulfs related to this behavior the mean significant wave height decreases towards the coastal areas of the sea due to the island and peninsula effects on the surface roughness the highest mean wind speeds and significant wave heights are observed in winter and the lowest in spring and in the rest of the seasons these mean conditions are close to each other spatial distributions of seasonal and long term mean wind speeds and significant wave heights show similarities although their distribution details and intensity are different the spatial distributions of the long term mean significant wave heights obtained from the cc model results are consistent with the spatial distributions of mean wind speeds three different analyzes have been made for the spatial variability of extreme wave heights the highest values for significant wave heights not exceeding the 95 and 99 of time are obtained from the cc model these values are respectively 1 25 m and 1 91 m in the central regions of the sea of marmara close to kapıdağ peninsula and marmara island the highest values 30 for the probability of exceedance of the mean of 0 5 m threshold are obtained from the cc model occur in the central regions of the sea of marmara also the highest values of the probability of exceedance 1 for the 2 m threshold are estimated in the central regions of the sea of marmara the highest maximum significant wave heights for 40 years estimated by the cc model on the sea of marmara are estimated to be around 4 70 m in the central regions of the sea of marmara along the eastern shores of the marmara island and along the northern and eastern shores of the kapıdağ peninsula for all that the cc model predicts a maximum significant wave height up to 0 78 m higher than obtained by the dc model these differences increase to 2 18 m and 2 78 m for the ce and de models in most areas the cc model produces the highest maximum significant wave heights exceptions occur for the areas towards the dardanelles strait and on the north east coast of the sea of marmara where the highest maximum significant wave heights are obtained with the de and ce models which are 0 5 m higher than those obtained with the cc model within the scope of this study four different 40 year datasets with high resolution and accuracy have been produced which can be used in the design of nearshore structures in the sea of marmara and or in the continuation of any activity e g cruise port operation etc it is recommended that these data sets be used to sustain these activities in the following process temporal analysis of wind and wave parameters individual analyzes of storms analysis of spectral properties of waves and estimation of extreme waves with different recurrent periods will be carried out with the help of these data sets credit authorship contribution statement adem akpınar conceptualization methodology writing review editingwriting review editing supervision volkan kutupoğlu writing original draftwriting original draft software validation visualization formal analysis investigation resources data curation bilal bingölbali software visualization resources formal analysis data curation emre çalışır validation visualization software formal analysis resources data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is dedicated to dr gerbrant van vledder for his kindness and devotion and his endless help and support in the preparation of this manuscript the authors would like to thank him deeply unfortunately we lost him with great sadness at november 22 2019 although he is no longer with us he continues to inspire us by his example and dedication to science we would like to thank to australian ocean data network aodn portal where we obtain calibrated satellite data tsms turkish state meteorological service for providing the the measurements at silivri noaa national oceanic and atmospheric administration for sharing the cfsr wind datasets tsms turkish state meteorological service for its help in obtaining the necessary permissions for obtaining the data from the ecmwf and gebco general bathymetric chart of the oceans for where we provide bathymetry of the sea of marmara appendix a model performance evaluation criteria model performance is assessed using the following statistical error measures it is noted that to properly judge the quality of any model it is recommended to apply a mixture of various statistical and graphical techniques since using only one error criterion may lead to a misinterpretation of results therefore we use several error indicators such as the mae rmse bias si etc as well as the correlation coefficient and index of agreement the first error value to be compared is the mean absolute error mae calculated as below a 1 m a e 1 n i 1 n y i x i where yi are hindcast values xi are measurement values and n is the number of data another error parameter is the root mean square error rmse calculated as a 2 r m s e 1 n i 1 n x i y i 2 and the variables are the same as those of the previous error parameter the normalized root mean square error nrmse is defined as the following a 3 n r m s e i 1 n x i y i 2 i 1 n x i 2 the mean difference bias is given by a 4 b i a s x y where x and y are the means of the measurements and hindcasts respectively the normalized bias index nbi is calculated as a 5 n b i b i a s x to evaluate the performances of the wave heights we used also the normalized bias nmb a 6 n m b y i x i x i the nmb shows the model tendency to over or underestimate relative to the measurements the other indicator used for a cross comparison between different models is the normalized root mean square error hh introduced by hanna and heinold 1985 the main advantage of this parameter is the fact that it is not biased toward simulations that underestimate the average and it is not sensitive to the mean observed values a 7 h h y i x i 2 y i x i except for seven different error criteria the scatter index si values were calculated using the following expression a 8 s i r m s e x for all error indices above a value being nearest to zero presents better performance in comparison with other values the correlation coefficient r indicating the correspondence between measurement and hindcast data sets is calculated as a 9 r i 1 n x i x y i y i 1 n x i x 2 i 1 n y i y 2 the index of agreement d introduced by willmott 1982 was also used to make a cross comparison between different models for the same observed dataset this indicator varies from 0 to 1 with higher index values indicating that the modeled values have a better agreement with the observations a 10 d 1 y i x i 2 y i x x i x 2 
