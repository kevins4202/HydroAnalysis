index,text
22430,the study of air gun bubbles is significant to marine resource detection and the use of clustered air guns is an effective way to reduce the undesirable bubble pulse in engineering applications in this paper an improved air gun bubble model is established based on the boundary element method the mass and heat transfer of the gas from the air gun chamber to the bubble and the heat transfer between the bubble and surrounding water are taken into consideration using this model motion of non spherical clustered air gun bubbles is simulated through consideration of the bubble topology under coalescence and splitting the multi period pressure waves released from the clustered air guns are successfully calculated the influence of the separation distance and the volume distribution of two bubbles on the far field pressure wave are then investigated a critical value for the distance between two bubbles at which the bubble pulse is effectively suppressed is found changing the bubble volume distribution not only reduces the bubble pulse but also decreases the primary pulse provided the volumes of the two bubbles are not equal finally the pressure waves generated by three bubbles and by two bubbles are compared although pressure waves from three bubbles have a long period the bubble pulse attenuation effects are almost the same as those for two bubbles keywords marine prospecting air gun bubble boundary element method clustered air guns 1 introduction 1 1 air guns in seabed resource exploration air guns play an important role in marine prospecting caldwell and dragoset 2000 a pressure wave is emitted into the surrounding water through the release of highly compressed gas stored in the air gun chamber as shown in fig 1 pressure waves are a type of mechanical wave which can propagate long distances in sea water with little decay they are also known as seismic waves acoustic waves or detecting waves in some references safar 1976b schulze gattermann 1972 when the pressure wave reaches the interface of different media at the sea bottom part of it is reflected back to the sea surface and part of it continues to propagate down into the seabed because different seabed sediments have different reflection characteristics general information about the inner structure of the seabed can then be obtained from the reflection pressure wave received by the hydrophones distributed at the sea surface ursin 1978 zhang et al 2017a 1 2 characteristics of the high quality air gun signal as the air gun is fired the shuttle inside moves upward the high pressure gas inside the air gun chamber then rushes into the water and an initial bubble is formed in the center of the air gun langhammer and landrø 1996 safar 1984 because the pressure in the bubble is far greater than the ambient pressure of the surrounding water the bubble expands rapidly outward at the same time the first positive pressure pulse which is used for seismic exploration is released into the water under the inertia effect bubble expansion and contraction often repeat several cycles de graaf et al 2014a b and each time the bubble approaches its minimum size a new pulse is emitted from the air gun as seen in fig 2 the first positive pulse is called the primary pulse and the subsequent pressure pulses are named bubble pulses zhang et al 2017a each pulsation of the bubble is equivalent to a new source which makes the seismic data blurred to produce a high quality detecting signal the relative size of the bubble pulse needs to be reduced as much as possible furthermore to ensure that the pressure wave can propagate sufficiently far both horizontally and vertically the primary pulse needs to be sufficiently large dragoset 1984 giles and johnston 1973 to quantitatively describe the quality of an air gun source a parameter named the primary to bubble pulse ratio pb is often used this is defined as p pri p bub where p pri is the size of the primary pulse and p bub the first bubble pulse so the pressure wave has a higher detection resolution at larger pb in engineering situations the aim is therefore to increase pb 1 3 obtaining a high quality air gun signal clustered air gun to reduce the undesirable bubble pulse a series of methods have been attempted such as the use of the gi gun wave shape kit and clustered air guns landrø 1992 langhammer et al 1995 mott smith 1971 however the gi gun requires a large amount of additional gas and the wave shape kit can cause a reduction of the primary pulse clustered air guns are most widely used today and have a good effect in suppressing the bubble pulse they were first proposed in the 1970s and involve air guns being close enough together smaller than a critical distance apart that their interactions cannot be ignored to obtain this critical distance many experimental and theoretical analyses have been carried out by for example safar 1976a nooteboom 1978 and vaage et al 1984 how to calculate the pressure wave released from clustered air guns is a difficult problem and the interactions between multi oscillating bubbles have been a constant subject of study ziolkowski et al 1982 developed a set of algorithms based on the approximation of giles and johnston 1973 each air gun bubble was treated as a point source with the bubble size ignored this method was later applied by laws et al 1990 li et al 2011 and strandenes and vaage 1992 with the condition that the separation between any two guns must be more than three times maximum bubble radius bubbles with a relatively small separation distance are usually considered equivalent to one large bubble before the calculation with an initial volume equal to the sum of the volumes of the individual bubbles 1 4 focus of this study a large amount of research has been carried out using numerical simulations with the spherical bubble model li et al 2010 ziolkowski et al 1999 however it is difficult to simulate the interaction between two bubbles separated by a relatively small distance and the near field pressure of the air gun bubble cannot be calculated accurately with the spherical bubble model in view of the success of the boundary element method bem in the field of explosive bubbles li et al 2012 2018 zhang and liu 2015 this has been introduced to simulate the non spherical air gun bubbles motion cox et al 2004 the interaction between multiple bubbles has been widely studied but most references focus on the evolution of the bubble shape han et al 2015b rungsiyaphornrat et al 2003 wang et al 2018 in experimental studies laser bubbles and spark bubbles are commonly used chew et al 2011 cui et al 2018 zhang et al 2015a 2017b however because it is difficult to control the bubble size and spacing there are still many mechanical problems on the interaction of bubbles which require further study this paper first introduces the significance of the air gun in marine prospecting and which kind of pressure wavelet emitted from air gun is what we required then the methods to get high quality pressure wavelet are summarized it is found the utilization of the clustered air guns can effectively suppress the undesired bubble pulse of the pressure wavelet with the air gun bubble model presented in this paper the influence of bubble separation bubble volume distribution and number of cluster air guns on the pressure wave are investigated the paper published by us in 2018 is mainly focused on the interaction between two bubbles of the same size zhang et al 2018 while this paper is more comprehensive including the interaction between two bubbles of the same size and different sizes and even three bubbles the mass transport of the gas between the air gun and the bubble and the heat transfer between bubble and surrounding water are considered in this paper the variation of primary pulse bubble pulse bubble period caused by two air gun bubbles with bubble separation d r m and volume distribution v 1 v 2 are concluded 2 air gun bubble model 2 1 model simplification and initial conditions the motion of the air gun bubble is complicated by the co existence of three phases gas water and the solid boundary and it is difficult to consider all the relevant factors at the same time in one model to simplify the simulation the air gun is assumed to be a point source within the bubble of released air and the influence of the air gun body itself on the bubble pulsation is ignored giles and johnston 1973 ziolkowski 1970 the initial bubble is assumed to be a spherical mass of gas with a radius r 0 and inner pressure p 0 a simplified axisymmetric model of the air gun bubble is shown in fig 3 a the bubble surface on one side of the symmetrical axis is discretized into 100 elements as introduced in fig 2 high pressure gas is initially sealed inside the air gun chamber with the exhaust ports blocked by the shuttle after firing the shuttle moves upward and highly compressed gas is then released into the water through the exhaust ports this process of gas moving from the air gun chamber to the bubble is named mass transport the air gun bubble is not formed instantaneously like an explosion bubble the mass transport is considered to last for a period of time τ until the air gun is closed with the shuttle moving back to its original position therefore the pulsation of the bubble is divided into two parts for t τ gas inside the air gun chamber is transferred to the bubble continuously for t τ the air gun is closed and the bubble is assumed to be oscillating in a free field after the air gun is closed however there is still a portion of the gas left in the air gun chamber and the ratio of the released gases to total gases is denoted by η the heat loss between the oscillating bubble and surrounding water must also be considered throughout the lifetime of the bubble to describe the speed of heat dissipation we adopt a heat dissipation coefficient α to model this situation we first need to know the volume pressure and temperature of the gas inside the air gun chamber and the firing depth v g p g t g and h g respectively for standard values p g is set to be 2000 psi 13 8 mpa v g is set to be 200 in3 3 277 l h g is 6 m and t g is 20 c in all cases below unless noted otherwise as well as v g p g t g and h g we need to know another five parameters r 0 p 0 τ η and α following li et al 2011 r 0 is assumed to be 3v g 4π 1 3 p 0 is assumed to be equal to the hydrostatic pressure p and the heat transfer coefficient α is set to be a constant 6000 j k mol the time length of mass transport τ 0 and the discharge efficiency η are related to the air gun volume and the size of the air gun opening 2 2 governing equation in this paper the viscosity and compressibility of the flow field are ignored air gun bubbles are usually large in size and travel at high speeds the maximum speed can reach 100 m s and the effect of viscosity is weak in a high reynolds number flow field blake and gibson 1981 langhammer and landrø 1993 in addition the velocity of the bubble wall is for most of the time much less than that of sound in water so the compressibility of the external flow field is also neglected wang et al 1996b ziolkowski 1970 analyzed the energy decay of air gun bubbles based on gilmore s compressible spherical bubble model the results show that the influence of flow field compressibility on the energy decay of air gun bubbles is limited and the heat transfer of the bubbles and the breakup of the jet are the main energy dissipation factors in summary the external flow field can be regarded as incompressible and inviscid a cylindrical coordinate system r θ z is established as shown in fig 3 the origin of the coordinates o is located at the initial center of the upper bubble the velocity u is equal to the gradient of a potential ϕ under the ideal fluid assumption blake and gibson 1981 blake et al 1986 the potential flow is governed by the laplace equation 1 2 ϕ 1 r r r ϕ r 1 r 2 2 ϕ θ 2 2 ϕ z 2 0 from the above formula it is seen that the velocity potential of the whole flow field is related only to the spatial coordinates and is independent of time this means that at any time as long as the values of ϕ at the boundary of the flow field are known information about the whole flow field can be obtained 2 3 velocity updating and vortex ring model in the previous subsection the motion of an air gun bubble is simplified to a model of a freely oscillating bubble in an ideal flow field to solve eq 1 a green function g p q satisfying the laplace equation is constructed g p q is equal to p q 1 where p is a fixed point in the fluid and q is an integration point on the fluid boundary with this green function newman 1977 the velocity potential ϕ at any point in the flow field can be represented in terms of integrals over the whole fluid boundary using the boundary integral equation 2 ϕ p s g p q n d s s ϕ q n g p q d s s g p q n ϕ q d s where s is the fluid boundary including the bubble boundary and the boundary at infinity and n is its unit normal vector from eq 2 we can obtain the normal velocity ϕ n if ϕ is known on the boundary s the tangential velocity ϕ τ t of the bubble can then be calculated using a finite difference method taib 1985 zhang et al 2015b the node velocity of the fluid boundary d r dt in an axisymmetric model then can be written as 3 u d r d t ϕ n n ϕ τ t τ t during the later stages of bubble collapse a high speed liquid jet forms inside the bubble after the jet penetrates the bubble surface it becomes doubly connected taking on an annular shape the velocity potential of the bubble surface is no longer a single valued function and there is a velocity loop around the annular bubble to solve the annular bubble problem wang et al 1996a proposed a vortex ring model where it is assumed that there is a vortex ring at the center of the bubble the velocity potential of the flow field is divided into two parts one is the residual velocity potential ϕ r and the other is the induced velocity ϕ i caused by the vortex ring similarly the velocity u of the fluid contains two parts it can be expressed as u u i u r where u i and u r are induced velocity and residual velocity respectively the residual velocity potential ϕ r can be derived from the boundary integral equation the induced velocity potential ϕ i can be calculated from the biot savart law 4 ϕ i γ 4 π c r d l r 3 γ 4 π c r d l r r 2 r z 2 3 2 in which c is the boundary of the enclosed vortex ring γ is the vortex ring circulation and r represents the spatial coordinates of an arbitrary point in the fluid wang 2014 wang et al 1996a by integrating eq 4 the induced velocity potential at a point p in the fluid can be obtained 5 ϕ i p γ 4 π c r z r r 2 r z 2 1 2 1 1 r r 2 e z r d l where r z and r r are the vertical and radial components respectively of r liu et al 2016 fig 4 shows two typical cases of the vortex ring model that we met in the numerical simulation of the interaction between two differently sized bubbles for the first case only one toroidal bubble is formed but the velocity potential ϕ of each bubble is affected by the vortex ring i e ϕ ϕ i1 ϕ r for the second case two toroidal bubbles are formed at the same time a vortex ring occurs at the center of each bubble the velocity potential ϕ at an arbitrary node on the bubble surface therefore consists of three parts the residual velocity potential ϕ r the induced velocity potential ϕ i1 caused by bubble 1 and the induced velocity potential ϕ i2 caused by bubble 2 i e ϕ ϕ i1 ϕ i2 ϕ r similarly the velocity itself at each node of the bubble surface also includes three parts the induced velocity caused by each vortex ring can be calculated from eq 4 2 4 velocity potential updating considering mass and heat transfer if the pressure p b of the gas inside the bubble is known then the velocity potential at each node can be calculated from the unsteady bernoulli theorem 6 ρ d ϕ t d t p b t 1 2 ρ ϕ t 2 ρ g z t p to obtain p b the ideal gas state equation is used 7 p b t v b t r g m b t t b t where r g is the ideal gas constant 8 314 jmol 1k 1 m b is the mass of the gas inside the bubble v b is the volume of the bubble and t b is the temperature of the gas inside the bubble to obtain p b from eq 7 we still need to know 1 m b and 2 t b the volume v b t of the bubble can easily be calculated from its position vector r t 1 for the mass m b of gas inside the bubble at time t a linear assumption is adopted landrø and sollie 1992 the mass transfer rate dm b dt of the gas from the air gun chamber to the bubble is assumed to be a constant if the gas inside the bubble is an ideal gas then dm b dt during the mass transport stage t τ satisfies 8 d m b t d t η m g m 0 τ η p g v g r g t g p 0 v 0 r g t 0 τ in which m g is the initial mass of the gas inside the air gun chamber and m 0 is the initial mass of the gas inside the bubble after the air gun is closed by the shuttle t τ the mass transport is terminated i e dm b dt 0 2 for the temperature t b of the gas inside the bubble at time t the first law of thermodynamics can be applied as shown in fig 3 b the mass transport is treated as a quasi static thermodynamic process 9 δ q h i n c i n 2 2 g z i n δ m i n h o u t c o u t 2 2 g z o u t δ m o u t δ w δ u in which δq is the heat conduction between the system and the outside δu is the increment of internal energy of the system h in is the enthalpy of the gas flowing into the bubble c in is its velocity gz in and δm in are the potential energy and mass respectively of the gas flowing into the bubble while the variables h out c out gz out and δm out represent the corresponding variables of the gas flowing out of the bubble and the last term δw represents the work done by the gas inside the bubble the first two terms represent the energy flowing into the system and the last two terms represent the energy flowing out of the system the enthalpy of the gas flowing into the bubble h in c p t g the internal energy of the gas inside the bubble u m b c v t b c p and c v are the specific heat capacity at constant volume and pressure respectively c p c v r g the work done by the gas inside the bubble w p b v b the kinetic energy and gravitational potential energy of the gas moved from the air gun chamber to the bubble are neglected as is the gas flowing out of the bubble landrø and sollie 1992 from eq 9 we then obtain 10 δ q c p t g δ m i n p b δ v b δ m b c v t b dividing both sides of eq 10 by δt we obtain 11 d q t d t c p t g d m b t d t p b t d v b t d t d m b t d t c v t b t m b t c v d t b t d t after the air gun is closed t τ dm b dt is equal to zero so dt b dt satisfies the following piecewise function 12 m b t c v d t b t d t d q t d t d m b t d t c p t g c v t b t p b t d v b t d t f o r 0 t τ m b t c v d t b t d t d q t d t p b t d v b t d t f o r t τ in which q is the heat conduction between the surrounding water and the bubble dq dt is assumed to be proportional to the area of the bubble surface s b and satisfies li et al 2010 13 d q d t α s b t b t w now the bubble volume v b bubble temperature t b and mass of the gas inside the bubble m b have been obtained so the velocity potential ϕ then can be updated through eq 6 2 5 fluid pressure the pressure at an arbitrary node p of the fluid is denoted by p and can be obtained from the bernoulli equation if the velocity at infinity is neglected then p satisfies 14 p p ρ d ϕ d t ϕ 2 2 g z to calculate p from eq 14 we need to know the gradient of the velocity potential ϕ and its time derivative dϕ dt at node p we can obtain ϕ from the indirect boundary integral equation expressed as 15 ϕ p s σ q p q d s g σ q q s where σ q is the source density distribution on the boundary s of the fluid wang and khoo 2004 zhang et al 1999 to obtain σ q we first consider nodes p at the boundary of the fluid i e p s the velocity potential at the fluid boundary is already known so σ q can be obtained through a simple mathematical transformation 16 σ q g q 1 ϕ q q s having obtained σ q it is straightforward to calculate ϕ p at an arbitrary node p in the flow field 17 ϕ p g σ q g g q 1 ϕ q the gradient of the velocity potential at node p is then obtained from 18 ϕ p g σ q s p 1 p q d s g q 1 ϕ q and the time derivative of the velocity potential at node p from 19 d ϕ p d t g d σ q d t g g q 1 ϕ q t δ t ϕ q t δ t 2 6 time step and numerical procedures to ensure the stability of the mesh the time step formula given by wang et al 1996a is adopted to control the moving speed of the mesh where δt varies with the velocity potential such that the displacement of each node is not more than the minimum length of the mesh in addition the value obtained for the primary pulse of the pressure wave emitted by the air gun bubble is sensitive to the time step to avoid errors due to the time step the following equation is used to calculate δt before the air gun is closed 20 δ t min δ ϕ max d ϕ d t l min ϕ δ m d m d t f o r t τ min δ ϕ max d ϕ d t l min ϕ f o r t τ where δϕ is a constant controlling the updating speed l min is the minimum length of the bubble mesh and δm is usually set to be m 0 100th in which m 0 is the initial mass of the gas inside the bubble the numerical model is implemented as follows 1 initiate the program including m 0 r 0 v 0 p 0 t 0 and u 0 2 discretize the bubble surface and obtain the spatial coordinate r velocity potential ϕ and velocity u at each node 3 calculate the time increment δt 4 calculate the normal velocity ϕ n using green s theorem the tangential velocity v τ using finite difference and the velocity d r dt at each node 5 update the spatial coordinate r at each node and the bubble volume v 6 update the mass m of the gas inside the bubble 7 update the temperature t of the gas inside the bubble 8 update the bubble pressure p using the ideal gas state equation 9 update the velocity potential ϕ using the bernoulli equation 10 go back to step 3 with the updated r ϕ and u 2 7 non dimensional parameters the interactions of two clustered air gun bubbles are mainly determined by two factors the distance d between the two bubble centers and the volume distribution v 1 v 2 of the two bubbles where v 1 and v 2 are the initial volumes of each bubble to study the influence of the center separation the maximum radius r m of a freely oscillating bubble with an initial volume of v 1 v 2 2 is taken as the length parameter the non dimensional distance between the two bubbles can then be expressed as d r m for comparison the sum of v 1 and v 2 is set to be a constant 400 in3 6 554 l in this paper so that the length parameter is the maximum radius of the bubble with a volume of 200 in3 as shown in fig 5 r m is 0 585 m calculated using the boundary element method 3 numerical validation 3 1 bubble coalescence fig 6 compares the experimental and numerical results of the motion for three bubbles relatively close together d 1 1r m and good agreement is found the three bubbles are generated at the same time initially water surrounding the bubble is pushed rapidly outward due to the high pressure inside the bubble as the bubble volumes increase the surface of adjacent bubbles become closer and coalescence is considered to occur when the thickness δs of the water layer between adjacent bubbles is less than 1 4 the minimum length of the mesh of the bubble zhang et al 2018 it is about 0 25 times of the initial radius and 0 0015 times of the maximum radius of the bubble as shown in the third frame of fig 6 three bubbles are merged into one through a simple topological process the mass pressure and temperature of the gas inside the new bubble are updated using the following equation rungsiyaphornrat et al 2003 21 m n e w m 1 m 2 m 3 p n e w v 1 v 2 v 3 p 1 v 1 p 2 v 2 p 3 v 3 m 1 m 2 m 3 r g t n e w m 1 r g t 1 m 2 r g t 2 m 3 r g t 3 3 2 bubble splitting fig 7 compares the numerical and experimental results for the motion of three bubbles a relatively large distance apart d 2 7r m as with the previous case the three bubbles expand rapidly at first with adjacent surfaces between two bubbles flattening after the bubble volumes reach their maximum the bubbles begin to collapse during this phase inward jets occur inside the two outer bubbles and the center bubble becomes progressively thinner as the bubbles continue to collapse the inward jets eventually penetrate through the other sides of the bubbles and long protrusions named jet torus are formed around the jets zhang et al 2013 2016 meanwhile the center bubble gradually splits into two equal parts 3 3 fluid pressure to verify the model used in this study the spherical bubble model of rayleigh is adopted fig 8 shows a comparison between the pressure waves calculated using the two methods the rayleigh equation is solved using the iteration method as in zhang et al 2017a the fluid pressure is calculated from the theory developed in section 2 5 using bem and the buoyancy effect is ignored during the calculation as seen in the figure good agreement between bem and rayleigh is found for various air gun volumes and the air gun depths this indicates that our boundary element model and fluid pressure calculation method are accurate 4 results for two bubbles 4 1 bubble volumes both equal to 200 in3 fig 9 shows the motion of two air gun bubbles with the same initial bubble volume and different initial separations a similar problem has also been studied by zhang et al 2018 so only two typical cases are selected here the volume v 0 of each bubble is 200 in3 and the initial inner pressure p 0 is 2000 psi for d 1 5r m the two bubbles merge into one at a late stage of the bubble collapse t 115 42 ms during the collapse water moves towards the bubble center and two high pressure zones occur at the top and bottom of the bubble the formation of high pressure zones has been observed more than once in experiments and numerical simulations han et al 2015a reuter et al 2017 as with the interaction between a bubble and a rigid boundary the bulk of the fluid away from the boundary is decelerated due to mass conservation leading to the formation of high pressure zones water between the high pressure zones and the bubble is accelerated resulting in the formation of two inward jets inside the bubble the inward jets become closer to each other as the bubble continuous to collapse and eventually collide at the bubble center t 123 92 ms for d 2 0r m the two bubbles remain independent and coalescence does not occur at all during the bubble pulsation process however due to the mutual suppression of the two collapsing bubbles pronounced high pressure zones still formed around them t 125 03 ms one high pressure zone is located at the top of the upper bubble and the other high pressure zone at the bottom of the lower bubble two inward jets are formed inside the two bubbles driven by these high pressure zones when the jets penetrate the outer edges of the bubbles two toroidal bubbles are formed synchronously for which the corresponding numerical treatment has been described in fig 5 in shape the bubbles change from singly connected to doubly connected using the vortex ring model the re expansion of the toroidal bubbles is successfully simulated 129 52 ms the rebounding bubbles move close to each other and are likely to merge 137 37 ms fig 10 compares the pressure waves emitted from two clustered air gun bubbles at different bubble separations 1 0r m 1 5r m 2 0r m 3 0r m the initial volume of each bubble is 200 in3 and the measuring point is 100 m away from the upper bubble center the abscissa of the graph is the product of pressure and measuring distance 1 bar is equal to 100 000 pa for comparison two times the value of the pressure wave generated by a single air gun is also included when d varies from 3 0r m to 1 0r m the primary pulse decreases from 6 5 bar m to 5 8 bar m and the bubble period increases from 122 ms to 136 ms however the bubble pulse first increases and then decreases with a critical value for d 1 5r m seeming to exist at which it takes a minimum value this can be explained by considering energy transfer because of the interactions between neighboring bubbles energy is partially dissipated through mutual repulsion or attraction when bubble separation decreases therefore the primary pulse decreases monotonically due to enhancement of the bubble interaction this also explains why both the primary pulse and the bubble pulse of clustered air guns are reduced compared with the pressure wave generated by a single air gun black dashed line however the bubble pulse is emitted from the air gun when the bubble approaches its minimum size so it is strongly affected by bubble coalescence after coalescence interactions between bubbles disappear and the bubble will have more energy to generate a large bubble pulse the case d 1 5r m has a smaller bubble pulse because bubble coalescence occurs later and more energy is lost in principle then the minimum value of the bubble pulse should occur when the initial bubble separation is near its critical value 4 2 bubble volumes equal to 230 in3 and 170 in3 to study the influence of the volume distribution of two bubbles on the pressure wave two bubbles with different initial volumes are considered in this subsection for ease of comparison their sum is set to the same value as in the previous subsection 400 in3 the initial volumes of the bubbles are 230 in3 and 170 in3 and the initial pressures are both 2000 psi the motion of two differently sized bubbles at different initial center separations d is shown in fig 11 for d 1 0r m the bubbles become very close together and their adjacent surfaces flatten during expansion laying the foundation for bubble coalescence t 55 11 ms when the thickness of the water layer between the bubbles is smaller than the minimum length of the bubble mesh they merge into one bubble for different initial bubble sizes the single bubble is clearly vertically asymmetric after coalescence t 89 33 ms during the collapse phase of the single bubble two high pressure zones are formed near its top and bottom however the high pressure zone below has a higher initial pressure than that above so that the bottom of the bubble takes on a concave shape more quickly than the top t 124 48 ms in the final stage of collapse the bubble is penetrated by inward jets and then continues to pulsate in a toroidal form t 139 12 ms for d 1 5r m the motion of the bubble is similar except that the merge time is later due to the larger initial separation for d 2 0r m and 3 0r m the two bubbles remain independent at all times and clearly have different oscillation periods high pressure zone forms at the lower bubble s bottom causing the formation of the pronounced jet after a while another high pressure zone forms at the top of upper bubble causing the formation of a new jet inside this bubble as the bubbles collapse the two jets move towards each other the smaller lower bubble is first penetrated by the jet inside it and a long protrusion forms around the jet at this moment the larger upper bubble continues to collapse and the newly formed long protrusion from the small bubble moves rapidly towards the large bubble fig 12 compares the pressure waves emitted from two differently sized air gun bubbles at different initial center separations 1 0r m 1 5r m 2 0r m 3 0r m each with initial bubble volumes of 230 in3 and 170 in3 the far field measuring point is 100 m away from the upper bubble center in order to highlight the advantages of clustered air guns the sum of the pressure waves generated by two individual air gun bubbles is also provided in the figure the black dotted line because the periods of the two individual bubbles are quite different the bubble pulse of this combined pressure wave is somewhat flattened as seen in fig 12 the bubble pulse for d 1 5r m is the smallest among the four cases while the primary pulse and period vary monotonically with bubble separation in the previous subsection the reason for this was explained by considering energy as d decreases interaction between the two bubbles is obviously enhanced if there is no coalescence because the two bubbles suppress each other the period is longer and the bubbles do not collapse to such a small volume at smaller separations d as a result the energy used to generate the bubble pulse is reduced however when d is smaller than 1 5r m there is bubble coalescence meaning that the interaction between two bubbles disappears the bubble pulse therefore takes a minimum value at approximately 1 5r m 4 3 bubble volumes equal to 266 in3 and 134 in3 in fig 13 the difference between the volumes of the two bubbles is further increased the volumes are now 266 in3 and 134 in3 for d 1 0r m and 1 5r m bubble coalescence still occurs after coalescence a high pressure zone first forms at the bottom of the newly generated large bubble as in the previous subsection this bubble is eventually penetrated by inward jets from inside and then oscillates in a toroidal form for d 2 0r m and 3 0r m when the lower bubble is penetrated by the jet the upper bubble is still collapsing after the jet penetrates the small bubble a long protrusion forms around the jet while the large bubble continues to collapse the long protrusion from the small bubble moves close to the large bubble fig 14 shows the pressure wave generated by the bubble for different initial separations each with initial bubble volumes of 266 in3 and 134 in3 the measuring point is 100 m away from the upper bubble center the black dotted line is the sum of the pressure waves caused by single air gun bubbles with volumes of 266 in3 and 134 in3 because there is a large difference in bubble period between the two volumes two bubble pulses appear on the combined pressure curve the primary pulse bubble pulse and period all follow similar behavior to the previous subsection with decreasing of the bubble center separation the primary pulse reduces and the bubble period increases the bubble pulse first increases and then decreases with a critical value at about 1 5r m which is also a critical distance for bubble coalescence 5 discussion fig 15 shows the variation of primary pulse caused by two air gun bubbles with bubble separation d r m and volume distribution v 1 v 2 v 1 and v 2 are the initial volumes of each bubble and the sum of v 1 and v 2 is a constant 400 in3 so for example v 1 v 2 1 stands for two bubbles with equal volume 200 in3 as seen in the figure the primary pulse is larger for larger d r m and v 1 v 2 when the bubble separation d r m increases the interaction between the two bubbles weakens so that the non dimensional primary pulse relative to twice that caused by a single air gun approaches 1 when the volume distribution v 1 v 2 decreases the difference in the oscillation periods between the two bubbles increases as a result the formation time of the primary pulses induced by the two bubbles is different the far field pressure wave is the superposition of the pressure wave induced by each bubble so the primary pulse caused by two differently sized bubbles v 1 v 2 1 is smaller than that caused by two bubbles of the same size v 1 v 2 1 fig 16 shows the variation of bubble pulse caused by two air gun bubbles with d r m and v 1 v 2 the bubble pulse first increases and then decreases with the increasing d r m a critical value exists at about 1 5 this is because when d 1 5 r m bubble coalescence happens before the formation of the bubble pulse the bubble then collapses with the same energy after coalescence and the energy used to radiate the pressure wave is also the same even when v 1 v 2 varies nevertheless the primary pulse is generated before bubble coalescence so it is almost unaffected by coalescence varying monotonously with d r m for large bubble separations d 1 5r m the influence of the volume distribution of the two air gun bubbles on the pressure waves becomes pronounced because the formation time of the bubble pulse is different when v 1 v 2 1 the larger the bubble period difference the smaller the bubble pulse fig 17 shows the variation of primary to bubble pulse ratio pb from two air gun bubbles with d r m and v 1 v 2 according to engineering requirements as stated in section 1 pb should be as large as possible in order to improve the detection resolution of the seismic source and to enable seabed exploration at longer distances and deeper depths from fig 19 the maximum value of pb occurs near d 1 5 r m since interaction between two bubbles is strongest at this bubble separation and 1 5r m is also a critical value for bubble coalescence in other words when the bubble separation is small but the bubbles do not merge the bubble pulse is most effectively suppressed the volume distribution of the two bubbles v 1 v 2 should also not be too small fig 18 shows the variation of period of the pressure wave caused by two air gun bubbles with d r m and v 1 v 2 for two bubbles the period denotes the time formation of the first bubble pulse as marked on the pressure wave in fig 2 the bubble pulse is defined as the first maximum pulse after the primary pulse the period for two bubbles is therefore determined essentially by that of the larger bubble this explains why the period of two bubbles is large at a relatively small v 1 v 2 as the bubble with larger initial volume has a larger pulsation period cole 1948 however at relatively small d r m the two bubbles merge into one during the oscillation so the period for the two bubbles depends only on the sum of v 1 and v 2 the maximum period occurs at small d r m 6 results for three bubbles fig 19 shows the motion of three bubbles with different initial separations and each with a volume of 200 in3 during the expansion the bubbles repel each other the surfaces between adjacent bubbles are flattened and the water layer thicknesses between any two adjacent bubbles are reduced the three bubbles eventually merged into one if d is relatively small e g d 1 0r m and 1 5r m during the collapse of the bubble two high pressure zones are formed at the bottom and top of the bubble at the same time driven by this high pressure the two ends of the bubble have a faster contraction speed and the wall of the bubble gradually becomes more concave with two inward jets forming inside the bubble after the two jets collide at the bubble center it becomes toroidal and continues to oscillate in this form for d 2 0r m and 3 0r m the bubbles remain independent and do not come into contact with each other at any time during the oscillation during the bubble collapse high pressure stagnation points form at the bottom of the lower bubble and the top of the upper bubble the water between the bubbles and the stagnation points is accelerated making these two ends of the bubbles concave and forming inward liquid jets inside the lower and upper bubble meanwhile the middle bubble is attracted to both the upper and lower bubble and so elongates along the vertical direction after the upper and lower bubbles are penetrated by the inward jets long protrusions form around each bubble the protrusions gradually become close to the middle bubble as the bubbles continue to collapse the time variation of the fluid pressure induced by three air gun bubbles with different center separations is shown in fig 20 the initial volume of each bubble is 200 in3 and the measurement point is 100 m away from the upper bubble center because of the complex splitting and coalescence of the bubbles the calculation is terminated before the bubble pulse appears for d 1 5r m and 2 0r m for comparison 3 times the pressure wave caused by a bubble with initial volume 200 in3 from a single air gun and 1 5 times of the pressure wave caused by bubbles from two air guns d 3 0r m are included in fig 21 because the interaction between three bubbles is stronger the period is obviously longer than that caused by a single gun or two guns as for the suppression of bubble pulses the effect of three bubbles is not much different from that of two bubbles 7 conclusions this paper concerns the pressure waves generated by clustered air gun bubbles through treatment of the bubble topology under coalescence and splitting these multi period pressure waves are successfully calculated using the boundary element method to find effective ways to suppress the bubble pulse the influence of bubble distance bubble volume distribution and number of cluster air guns on the pressure wave are investigated based on the analysis of a large amount of numerical data the following conclusions are drawn 1 adjusting the distance d between clustered air gun bubbles is an effective way to suppress the bubble pulse of the pressure wave with an increase of d the primary pulse is reduced but the period is lengthened a critical value of d 1 5 is found at which the bubble pulse reaches a minimum value 2 if the distance d between two bubbles is relatively small then changing the volume distribution of the clustered air gun bubbles does not have a significant effect on the pressure wave but when d is relatively large the volume distribution has a pronounced effect on the pressure wave as v 1 v 2 decreases the primary pulse and the bubble pulse both reduce 3 as the number of the clustered air guns is increased to three the period of the pressure wave generated by the three bubbles is clearly longer than that caused by a single gun or two guns however the attenuation effect on the bubble pulse is about the same as that with two bubbles acknowledgments this work is supported by the national key r d program of china 2018yfc0308900 national natural science foundation of china no 11872158 no 11672081 the china postdoctoral science foundation funded project grant no 2018m640292 and the heilongjiang postdoctoral fund grant no lbh z18057 the authors are also grateful to dr q x wang at the university of birmingham for his great help 
22430,the study of air gun bubbles is significant to marine resource detection and the use of clustered air guns is an effective way to reduce the undesirable bubble pulse in engineering applications in this paper an improved air gun bubble model is established based on the boundary element method the mass and heat transfer of the gas from the air gun chamber to the bubble and the heat transfer between the bubble and surrounding water are taken into consideration using this model motion of non spherical clustered air gun bubbles is simulated through consideration of the bubble topology under coalescence and splitting the multi period pressure waves released from the clustered air guns are successfully calculated the influence of the separation distance and the volume distribution of two bubbles on the far field pressure wave are then investigated a critical value for the distance between two bubbles at which the bubble pulse is effectively suppressed is found changing the bubble volume distribution not only reduces the bubble pulse but also decreases the primary pulse provided the volumes of the two bubbles are not equal finally the pressure waves generated by three bubbles and by two bubbles are compared although pressure waves from three bubbles have a long period the bubble pulse attenuation effects are almost the same as those for two bubbles keywords marine prospecting air gun bubble boundary element method clustered air guns 1 introduction 1 1 air guns in seabed resource exploration air guns play an important role in marine prospecting caldwell and dragoset 2000 a pressure wave is emitted into the surrounding water through the release of highly compressed gas stored in the air gun chamber as shown in fig 1 pressure waves are a type of mechanical wave which can propagate long distances in sea water with little decay they are also known as seismic waves acoustic waves or detecting waves in some references safar 1976b schulze gattermann 1972 when the pressure wave reaches the interface of different media at the sea bottom part of it is reflected back to the sea surface and part of it continues to propagate down into the seabed because different seabed sediments have different reflection characteristics general information about the inner structure of the seabed can then be obtained from the reflection pressure wave received by the hydrophones distributed at the sea surface ursin 1978 zhang et al 2017a 1 2 characteristics of the high quality air gun signal as the air gun is fired the shuttle inside moves upward the high pressure gas inside the air gun chamber then rushes into the water and an initial bubble is formed in the center of the air gun langhammer and landrø 1996 safar 1984 because the pressure in the bubble is far greater than the ambient pressure of the surrounding water the bubble expands rapidly outward at the same time the first positive pressure pulse which is used for seismic exploration is released into the water under the inertia effect bubble expansion and contraction often repeat several cycles de graaf et al 2014a b and each time the bubble approaches its minimum size a new pulse is emitted from the air gun as seen in fig 2 the first positive pulse is called the primary pulse and the subsequent pressure pulses are named bubble pulses zhang et al 2017a each pulsation of the bubble is equivalent to a new source which makes the seismic data blurred to produce a high quality detecting signal the relative size of the bubble pulse needs to be reduced as much as possible furthermore to ensure that the pressure wave can propagate sufficiently far both horizontally and vertically the primary pulse needs to be sufficiently large dragoset 1984 giles and johnston 1973 to quantitatively describe the quality of an air gun source a parameter named the primary to bubble pulse ratio pb is often used this is defined as p pri p bub where p pri is the size of the primary pulse and p bub the first bubble pulse so the pressure wave has a higher detection resolution at larger pb in engineering situations the aim is therefore to increase pb 1 3 obtaining a high quality air gun signal clustered air gun to reduce the undesirable bubble pulse a series of methods have been attempted such as the use of the gi gun wave shape kit and clustered air guns landrø 1992 langhammer et al 1995 mott smith 1971 however the gi gun requires a large amount of additional gas and the wave shape kit can cause a reduction of the primary pulse clustered air guns are most widely used today and have a good effect in suppressing the bubble pulse they were first proposed in the 1970s and involve air guns being close enough together smaller than a critical distance apart that their interactions cannot be ignored to obtain this critical distance many experimental and theoretical analyses have been carried out by for example safar 1976a nooteboom 1978 and vaage et al 1984 how to calculate the pressure wave released from clustered air guns is a difficult problem and the interactions between multi oscillating bubbles have been a constant subject of study ziolkowski et al 1982 developed a set of algorithms based on the approximation of giles and johnston 1973 each air gun bubble was treated as a point source with the bubble size ignored this method was later applied by laws et al 1990 li et al 2011 and strandenes and vaage 1992 with the condition that the separation between any two guns must be more than three times maximum bubble radius bubbles with a relatively small separation distance are usually considered equivalent to one large bubble before the calculation with an initial volume equal to the sum of the volumes of the individual bubbles 1 4 focus of this study a large amount of research has been carried out using numerical simulations with the spherical bubble model li et al 2010 ziolkowski et al 1999 however it is difficult to simulate the interaction between two bubbles separated by a relatively small distance and the near field pressure of the air gun bubble cannot be calculated accurately with the spherical bubble model in view of the success of the boundary element method bem in the field of explosive bubbles li et al 2012 2018 zhang and liu 2015 this has been introduced to simulate the non spherical air gun bubbles motion cox et al 2004 the interaction between multiple bubbles has been widely studied but most references focus on the evolution of the bubble shape han et al 2015b rungsiyaphornrat et al 2003 wang et al 2018 in experimental studies laser bubbles and spark bubbles are commonly used chew et al 2011 cui et al 2018 zhang et al 2015a 2017b however because it is difficult to control the bubble size and spacing there are still many mechanical problems on the interaction of bubbles which require further study this paper first introduces the significance of the air gun in marine prospecting and which kind of pressure wavelet emitted from air gun is what we required then the methods to get high quality pressure wavelet are summarized it is found the utilization of the clustered air guns can effectively suppress the undesired bubble pulse of the pressure wavelet with the air gun bubble model presented in this paper the influence of bubble separation bubble volume distribution and number of cluster air guns on the pressure wave are investigated the paper published by us in 2018 is mainly focused on the interaction between two bubbles of the same size zhang et al 2018 while this paper is more comprehensive including the interaction between two bubbles of the same size and different sizes and even three bubbles the mass transport of the gas between the air gun and the bubble and the heat transfer between bubble and surrounding water are considered in this paper the variation of primary pulse bubble pulse bubble period caused by two air gun bubbles with bubble separation d r m and volume distribution v 1 v 2 are concluded 2 air gun bubble model 2 1 model simplification and initial conditions the motion of the air gun bubble is complicated by the co existence of three phases gas water and the solid boundary and it is difficult to consider all the relevant factors at the same time in one model to simplify the simulation the air gun is assumed to be a point source within the bubble of released air and the influence of the air gun body itself on the bubble pulsation is ignored giles and johnston 1973 ziolkowski 1970 the initial bubble is assumed to be a spherical mass of gas with a radius r 0 and inner pressure p 0 a simplified axisymmetric model of the air gun bubble is shown in fig 3 a the bubble surface on one side of the symmetrical axis is discretized into 100 elements as introduced in fig 2 high pressure gas is initially sealed inside the air gun chamber with the exhaust ports blocked by the shuttle after firing the shuttle moves upward and highly compressed gas is then released into the water through the exhaust ports this process of gas moving from the air gun chamber to the bubble is named mass transport the air gun bubble is not formed instantaneously like an explosion bubble the mass transport is considered to last for a period of time τ until the air gun is closed with the shuttle moving back to its original position therefore the pulsation of the bubble is divided into two parts for t τ gas inside the air gun chamber is transferred to the bubble continuously for t τ the air gun is closed and the bubble is assumed to be oscillating in a free field after the air gun is closed however there is still a portion of the gas left in the air gun chamber and the ratio of the released gases to total gases is denoted by η the heat loss between the oscillating bubble and surrounding water must also be considered throughout the lifetime of the bubble to describe the speed of heat dissipation we adopt a heat dissipation coefficient α to model this situation we first need to know the volume pressure and temperature of the gas inside the air gun chamber and the firing depth v g p g t g and h g respectively for standard values p g is set to be 2000 psi 13 8 mpa v g is set to be 200 in3 3 277 l h g is 6 m and t g is 20 c in all cases below unless noted otherwise as well as v g p g t g and h g we need to know another five parameters r 0 p 0 τ η and α following li et al 2011 r 0 is assumed to be 3v g 4π 1 3 p 0 is assumed to be equal to the hydrostatic pressure p and the heat transfer coefficient α is set to be a constant 6000 j k mol the time length of mass transport τ 0 and the discharge efficiency η are related to the air gun volume and the size of the air gun opening 2 2 governing equation in this paper the viscosity and compressibility of the flow field are ignored air gun bubbles are usually large in size and travel at high speeds the maximum speed can reach 100 m s and the effect of viscosity is weak in a high reynolds number flow field blake and gibson 1981 langhammer and landrø 1993 in addition the velocity of the bubble wall is for most of the time much less than that of sound in water so the compressibility of the external flow field is also neglected wang et al 1996b ziolkowski 1970 analyzed the energy decay of air gun bubbles based on gilmore s compressible spherical bubble model the results show that the influence of flow field compressibility on the energy decay of air gun bubbles is limited and the heat transfer of the bubbles and the breakup of the jet are the main energy dissipation factors in summary the external flow field can be regarded as incompressible and inviscid a cylindrical coordinate system r θ z is established as shown in fig 3 the origin of the coordinates o is located at the initial center of the upper bubble the velocity u is equal to the gradient of a potential ϕ under the ideal fluid assumption blake and gibson 1981 blake et al 1986 the potential flow is governed by the laplace equation 1 2 ϕ 1 r r r ϕ r 1 r 2 2 ϕ θ 2 2 ϕ z 2 0 from the above formula it is seen that the velocity potential of the whole flow field is related only to the spatial coordinates and is independent of time this means that at any time as long as the values of ϕ at the boundary of the flow field are known information about the whole flow field can be obtained 2 3 velocity updating and vortex ring model in the previous subsection the motion of an air gun bubble is simplified to a model of a freely oscillating bubble in an ideal flow field to solve eq 1 a green function g p q satisfying the laplace equation is constructed g p q is equal to p q 1 where p is a fixed point in the fluid and q is an integration point on the fluid boundary with this green function newman 1977 the velocity potential ϕ at any point in the flow field can be represented in terms of integrals over the whole fluid boundary using the boundary integral equation 2 ϕ p s g p q n d s s ϕ q n g p q d s s g p q n ϕ q d s where s is the fluid boundary including the bubble boundary and the boundary at infinity and n is its unit normal vector from eq 2 we can obtain the normal velocity ϕ n if ϕ is known on the boundary s the tangential velocity ϕ τ t of the bubble can then be calculated using a finite difference method taib 1985 zhang et al 2015b the node velocity of the fluid boundary d r dt in an axisymmetric model then can be written as 3 u d r d t ϕ n n ϕ τ t τ t during the later stages of bubble collapse a high speed liquid jet forms inside the bubble after the jet penetrates the bubble surface it becomes doubly connected taking on an annular shape the velocity potential of the bubble surface is no longer a single valued function and there is a velocity loop around the annular bubble to solve the annular bubble problem wang et al 1996a proposed a vortex ring model where it is assumed that there is a vortex ring at the center of the bubble the velocity potential of the flow field is divided into two parts one is the residual velocity potential ϕ r and the other is the induced velocity ϕ i caused by the vortex ring similarly the velocity u of the fluid contains two parts it can be expressed as u u i u r where u i and u r are induced velocity and residual velocity respectively the residual velocity potential ϕ r can be derived from the boundary integral equation the induced velocity potential ϕ i can be calculated from the biot savart law 4 ϕ i γ 4 π c r d l r 3 γ 4 π c r d l r r 2 r z 2 3 2 in which c is the boundary of the enclosed vortex ring γ is the vortex ring circulation and r represents the spatial coordinates of an arbitrary point in the fluid wang 2014 wang et al 1996a by integrating eq 4 the induced velocity potential at a point p in the fluid can be obtained 5 ϕ i p γ 4 π c r z r r 2 r z 2 1 2 1 1 r r 2 e z r d l where r z and r r are the vertical and radial components respectively of r liu et al 2016 fig 4 shows two typical cases of the vortex ring model that we met in the numerical simulation of the interaction between two differently sized bubbles for the first case only one toroidal bubble is formed but the velocity potential ϕ of each bubble is affected by the vortex ring i e ϕ ϕ i1 ϕ r for the second case two toroidal bubbles are formed at the same time a vortex ring occurs at the center of each bubble the velocity potential ϕ at an arbitrary node on the bubble surface therefore consists of three parts the residual velocity potential ϕ r the induced velocity potential ϕ i1 caused by bubble 1 and the induced velocity potential ϕ i2 caused by bubble 2 i e ϕ ϕ i1 ϕ i2 ϕ r similarly the velocity itself at each node of the bubble surface also includes three parts the induced velocity caused by each vortex ring can be calculated from eq 4 2 4 velocity potential updating considering mass and heat transfer if the pressure p b of the gas inside the bubble is known then the velocity potential at each node can be calculated from the unsteady bernoulli theorem 6 ρ d ϕ t d t p b t 1 2 ρ ϕ t 2 ρ g z t p to obtain p b the ideal gas state equation is used 7 p b t v b t r g m b t t b t where r g is the ideal gas constant 8 314 jmol 1k 1 m b is the mass of the gas inside the bubble v b is the volume of the bubble and t b is the temperature of the gas inside the bubble to obtain p b from eq 7 we still need to know 1 m b and 2 t b the volume v b t of the bubble can easily be calculated from its position vector r t 1 for the mass m b of gas inside the bubble at time t a linear assumption is adopted landrø and sollie 1992 the mass transfer rate dm b dt of the gas from the air gun chamber to the bubble is assumed to be a constant if the gas inside the bubble is an ideal gas then dm b dt during the mass transport stage t τ satisfies 8 d m b t d t η m g m 0 τ η p g v g r g t g p 0 v 0 r g t 0 τ in which m g is the initial mass of the gas inside the air gun chamber and m 0 is the initial mass of the gas inside the bubble after the air gun is closed by the shuttle t τ the mass transport is terminated i e dm b dt 0 2 for the temperature t b of the gas inside the bubble at time t the first law of thermodynamics can be applied as shown in fig 3 b the mass transport is treated as a quasi static thermodynamic process 9 δ q h i n c i n 2 2 g z i n δ m i n h o u t c o u t 2 2 g z o u t δ m o u t δ w δ u in which δq is the heat conduction between the system and the outside δu is the increment of internal energy of the system h in is the enthalpy of the gas flowing into the bubble c in is its velocity gz in and δm in are the potential energy and mass respectively of the gas flowing into the bubble while the variables h out c out gz out and δm out represent the corresponding variables of the gas flowing out of the bubble and the last term δw represents the work done by the gas inside the bubble the first two terms represent the energy flowing into the system and the last two terms represent the energy flowing out of the system the enthalpy of the gas flowing into the bubble h in c p t g the internal energy of the gas inside the bubble u m b c v t b c p and c v are the specific heat capacity at constant volume and pressure respectively c p c v r g the work done by the gas inside the bubble w p b v b the kinetic energy and gravitational potential energy of the gas moved from the air gun chamber to the bubble are neglected as is the gas flowing out of the bubble landrø and sollie 1992 from eq 9 we then obtain 10 δ q c p t g δ m i n p b δ v b δ m b c v t b dividing both sides of eq 10 by δt we obtain 11 d q t d t c p t g d m b t d t p b t d v b t d t d m b t d t c v t b t m b t c v d t b t d t after the air gun is closed t τ dm b dt is equal to zero so dt b dt satisfies the following piecewise function 12 m b t c v d t b t d t d q t d t d m b t d t c p t g c v t b t p b t d v b t d t f o r 0 t τ m b t c v d t b t d t d q t d t p b t d v b t d t f o r t τ in which q is the heat conduction between the surrounding water and the bubble dq dt is assumed to be proportional to the area of the bubble surface s b and satisfies li et al 2010 13 d q d t α s b t b t w now the bubble volume v b bubble temperature t b and mass of the gas inside the bubble m b have been obtained so the velocity potential ϕ then can be updated through eq 6 2 5 fluid pressure the pressure at an arbitrary node p of the fluid is denoted by p and can be obtained from the bernoulli equation if the velocity at infinity is neglected then p satisfies 14 p p ρ d ϕ d t ϕ 2 2 g z to calculate p from eq 14 we need to know the gradient of the velocity potential ϕ and its time derivative dϕ dt at node p we can obtain ϕ from the indirect boundary integral equation expressed as 15 ϕ p s σ q p q d s g σ q q s where σ q is the source density distribution on the boundary s of the fluid wang and khoo 2004 zhang et al 1999 to obtain σ q we first consider nodes p at the boundary of the fluid i e p s the velocity potential at the fluid boundary is already known so σ q can be obtained through a simple mathematical transformation 16 σ q g q 1 ϕ q q s having obtained σ q it is straightforward to calculate ϕ p at an arbitrary node p in the flow field 17 ϕ p g σ q g g q 1 ϕ q the gradient of the velocity potential at node p is then obtained from 18 ϕ p g σ q s p 1 p q d s g q 1 ϕ q and the time derivative of the velocity potential at node p from 19 d ϕ p d t g d σ q d t g g q 1 ϕ q t δ t ϕ q t δ t 2 6 time step and numerical procedures to ensure the stability of the mesh the time step formula given by wang et al 1996a is adopted to control the moving speed of the mesh where δt varies with the velocity potential such that the displacement of each node is not more than the minimum length of the mesh in addition the value obtained for the primary pulse of the pressure wave emitted by the air gun bubble is sensitive to the time step to avoid errors due to the time step the following equation is used to calculate δt before the air gun is closed 20 δ t min δ ϕ max d ϕ d t l min ϕ δ m d m d t f o r t τ min δ ϕ max d ϕ d t l min ϕ f o r t τ where δϕ is a constant controlling the updating speed l min is the minimum length of the bubble mesh and δm is usually set to be m 0 100th in which m 0 is the initial mass of the gas inside the bubble the numerical model is implemented as follows 1 initiate the program including m 0 r 0 v 0 p 0 t 0 and u 0 2 discretize the bubble surface and obtain the spatial coordinate r velocity potential ϕ and velocity u at each node 3 calculate the time increment δt 4 calculate the normal velocity ϕ n using green s theorem the tangential velocity v τ using finite difference and the velocity d r dt at each node 5 update the spatial coordinate r at each node and the bubble volume v 6 update the mass m of the gas inside the bubble 7 update the temperature t of the gas inside the bubble 8 update the bubble pressure p using the ideal gas state equation 9 update the velocity potential ϕ using the bernoulli equation 10 go back to step 3 with the updated r ϕ and u 2 7 non dimensional parameters the interactions of two clustered air gun bubbles are mainly determined by two factors the distance d between the two bubble centers and the volume distribution v 1 v 2 of the two bubbles where v 1 and v 2 are the initial volumes of each bubble to study the influence of the center separation the maximum radius r m of a freely oscillating bubble with an initial volume of v 1 v 2 2 is taken as the length parameter the non dimensional distance between the two bubbles can then be expressed as d r m for comparison the sum of v 1 and v 2 is set to be a constant 400 in3 6 554 l in this paper so that the length parameter is the maximum radius of the bubble with a volume of 200 in3 as shown in fig 5 r m is 0 585 m calculated using the boundary element method 3 numerical validation 3 1 bubble coalescence fig 6 compares the experimental and numerical results of the motion for three bubbles relatively close together d 1 1r m and good agreement is found the three bubbles are generated at the same time initially water surrounding the bubble is pushed rapidly outward due to the high pressure inside the bubble as the bubble volumes increase the surface of adjacent bubbles become closer and coalescence is considered to occur when the thickness δs of the water layer between adjacent bubbles is less than 1 4 the minimum length of the mesh of the bubble zhang et al 2018 it is about 0 25 times of the initial radius and 0 0015 times of the maximum radius of the bubble as shown in the third frame of fig 6 three bubbles are merged into one through a simple topological process the mass pressure and temperature of the gas inside the new bubble are updated using the following equation rungsiyaphornrat et al 2003 21 m n e w m 1 m 2 m 3 p n e w v 1 v 2 v 3 p 1 v 1 p 2 v 2 p 3 v 3 m 1 m 2 m 3 r g t n e w m 1 r g t 1 m 2 r g t 2 m 3 r g t 3 3 2 bubble splitting fig 7 compares the numerical and experimental results for the motion of three bubbles a relatively large distance apart d 2 7r m as with the previous case the three bubbles expand rapidly at first with adjacent surfaces between two bubbles flattening after the bubble volumes reach their maximum the bubbles begin to collapse during this phase inward jets occur inside the two outer bubbles and the center bubble becomes progressively thinner as the bubbles continue to collapse the inward jets eventually penetrate through the other sides of the bubbles and long protrusions named jet torus are formed around the jets zhang et al 2013 2016 meanwhile the center bubble gradually splits into two equal parts 3 3 fluid pressure to verify the model used in this study the spherical bubble model of rayleigh is adopted fig 8 shows a comparison between the pressure waves calculated using the two methods the rayleigh equation is solved using the iteration method as in zhang et al 2017a the fluid pressure is calculated from the theory developed in section 2 5 using bem and the buoyancy effect is ignored during the calculation as seen in the figure good agreement between bem and rayleigh is found for various air gun volumes and the air gun depths this indicates that our boundary element model and fluid pressure calculation method are accurate 4 results for two bubbles 4 1 bubble volumes both equal to 200 in3 fig 9 shows the motion of two air gun bubbles with the same initial bubble volume and different initial separations a similar problem has also been studied by zhang et al 2018 so only two typical cases are selected here the volume v 0 of each bubble is 200 in3 and the initial inner pressure p 0 is 2000 psi for d 1 5r m the two bubbles merge into one at a late stage of the bubble collapse t 115 42 ms during the collapse water moves towards the bubble center and two high pressure zones occur at the top and bottom of the bubble the formation of high pressure zones has been observed more than once in experiments and numerical simulations han et al 2015a reuter et al 2017 as with the interaction between a bubble and a rigid boundary the bulk of the fluid away from the boundary is decelerated due to mass conservation leading to the formation of high pressure zones water between the high pressure zones and the bubble is accelerated resulting in the formation of two inward jets inside the bubble the inward jets become closer to each other as the bubble continuous to collapse and eventually collide at the bubble center t 123 92 ms for d 2 0r m the two bubbles remain independent and coalescence does not occur at all during the bubble pulsation process however due to the mutual suppression of the two collapsing bubbles pronounced high pressure zones still formed around them t 125 03 ms one high pressure zone is located at the top of the upper bubble and the other high pressure zone at the bottom of the lower bubble two inward jets are formed inside the two bubbles driven by these high pressure zones when the jets penetrate the outer edges of the bubbles two toroidal bubbles are formed synchronously for which the corresponding numerical treatment has been described in fig 5 in shape the bubbles change from singly connected to doubly connected using the vortex ring model the re expansion of the toroidal bubbles is successfully simulated 129 52 ms the rebounding bubbles move close to each other and are likely to merge 137 37 ms fig 10 compares the pressure waves emitted from two clustered air gun bubbles at different bubble separations 1 0r m 1 5r m 2 0r m 3 0r m the initial volume of each bubble is 200 in3 and the measuring point is 100 m away from the upper bubble center the abscissa of the graph is the product of pressure and measuring distance 1 bar is equal to 100 000 pa for comparison two times the value of the pressure wave generated by a single air gun is also included when d varies from 3 0r m to 1 0r m the primary pulse decreases from 6 5 bar m to 5 8 bar m and the bubble period increases from 122 ms to 136 ms however the bubble pulse first increases and then decreases with a critical value for d 1 5r m seeming to exist at which it takes a minimum value this can be explained by considering energy transfer because of the interactions between neighboring bubbles energy is partially dissipated through mutual repulsion or attraction when bubble separation decreases therefore the primary pulse decreases monotonically due to enhancement of the bubble interaction this also explains why both the primary pulse and the bubble pulse of clustered air guns are reduced compared with the pressure wave generated by a single air gun black dashed line however the bubble pulse is emitted from the air gun when the bubble approaches its minimum size so it is strongly affected by bubble coalescence after coalescence interactions between bubbles disappear and the bubble will have more energy to generate a large bubble pulse the case d 1 5r m has a smaller bubble pulse because bubble coalescence occurs later and more energy is lost in principle then the minimum value of the bubble pulse should occur when the initial bubble separation is near its critical value 4 2 bubble volumes equal to 230 in3 and 170 in3 to study the influence of the volume distribution of two bubbles on the pressure wave two bubbles with different initial volumes are considered in this subsection for ease of comparison their sum is set to the same value as in the previous subsection 400 in3 the initial volumes of the bubbles are 230 in3 and 170 in3 and the initial pressures are both 2000 psi the motion of two differently sized bubbles at different initial center separations d is shown in fig 11 for d 1 0r m the bubbles become very close together and their adjacent surfaces flatten during expansion laying the foundation for bubble coalescence t 55 11 ms when the thickness of the water layer between the bubbles is smaller than the minimum length of the bubble mesh they merge into one bubble for different initial bubble sizes the single bubble is clearly vertically asymmetric after coalescence t 89 33 ms during the collapse phase of the single bubble two high pressure zones are formed near its top and bottom however the high pressure zone below has a higher initial pressure than that above so that the bottom of the bubble takes on a concave shape more quickly than the top t 124 48 ms in the final stage of collapse the bubble is penetrated by inward jets and then continues to pulsate in a toroidal form t 139 12 ms for d 1 5r m the motion of the bubble is similar except that the merge time is later due to the larger initial separation for d 2 0r m and 3 0r m the two bubbles remain independent at all times and clearly have different oscillation periods high pressure zone forms at the lower bubble s bottom causing the formation of the pronounced jet after a while another high pressure zone forms at the top of upper bubble causing the formation of a new jet inside this bubble as the bubbles collapse the two jets move towards each other the smaller lower bubble is first penetrated by the jet inside it and a long protrusion forms around the jet at this moment the larger upper bubble continues to collapse and the newly formed long protrusion from the small bubble moves rapidly towards the large bubble fig 12 compares the pressure waves emitted from two differently sized air gun bubbles at different initial center separations 1 0r m 1 5r m 2 0r m 3 0r m each with initial bubble volumes of 230 in3 and 170 in3 the far field measuring point is 100 m away from the upper bubble center in order to highlight the advantages of clustered air guns the sum of the pressure waves generated by two individual air gun bubbles is also provided in the figure the black dotted line because the periods of the two individual bubbles are quite different the bubble pulse of this combined pressure wave is somewhat flattened as seen in fig 12 the bubble pulse for d 1 5r m is the smallest among the four cases while the primary pulse and period vary monotonically with bubble separation in the previous subsection the reason for this was explained by considering energy as d decreases interaction between the two bubbles is obviously enhanced if there is no coalescence because the two bubbles suppress each other the period is longer and the bubbles do not collapse to such a small volume at smaller separations d as a result the energy used to generate the bubble pulse is reduced however when d is smaller than 1 5r m there is bubble coalescence meaning that the interaction between two bubbles disappears the bubble pulse therefore takes a minimum value at approximately 1 5r m 4 3 bubble volumes equal to 266 in3 and 134 in3 in fig 13 the difference between the volumes of the two bubbles is further increased the volumes are now 266 in3 and 134 in3 for d 1 0r m and 1 5r m bubble coalescence still occurs after coalescence a high pressure zone first forms at the bottom of the newly generated large bubble as in the previous subsection this bubble is eventually penetrated by inward jets from inside and then oscillates in a toroidal form for d 2 0r m and 3 0r m when the lower bubble is penetrated by the jet the upper bubble is still collapsing after the jet penetrates the small bubble a long protrusion forms around the jet while the large bubble continues to collapse the long protrusion from the small bubble moves close to the large bubble fig 14 shows the pressure wave generated by the bubble for different initial separations each with initial bubble volumes of 266 in3 and 134 in3 the measuring point is 100 m away from the upper bubble center the black dotted line is the sum of the pressure waves caused by single air gun bubbles with volumes of 266 in3 and 134 in3 because there is a large difference in bubble period between the two volumes two bubble pulses appear on the combined pressure curve the primary pulse bubble pulse and period all follow similar behavior to the previous subsection with decreasing of the bubble center separation the primary pulse reduces and the bubble period increases the bubble pulse first increases and then decreases with a critical value at about 1 5r m which is also a critical distance for bubble coalescence 5 discussion fig 15 shows the variation of primary pulse caused by two air gun bubbles with bubble separation d r m and volume distribution v 1 v 2 v 1 and v 2 are the initial volumes of each bubble and the sum of v 1 and v 2 is a constant 400 in3 so for example v 1 v 2 1 stands for two bubbles with equal volume 200 in3 as seen in the figure the primary pulse is larger for larger d r m and v 1 v 2 when the bubble separation d r m increases the interaction between the two bubbles weakens so that the non dimensional primary pulse relative to twice that caused by a single air gun approaches 1 when the volume distribution v 1 v 2 decreases the difference in the oscillation periods between the two bubbles increases as a result the formation time of the primary pulses induced by the two bubbles is different the far field pressure wave is the superposition of the pressure wave induced by each bubble so the primary pulse caused by two differently sized bubbles v 1 v 2 1 is smaller than that caused by two bubbles of the same size v 1 v 2 1 fig 16 shows the variation of bubble pulse caused by two air gun bubbles with d r m and v 1 v 2 the bubble pulse first increases and then decreases with the increasing d r m a critical value exists at about 1 5 this is because when d 1 5 r m bubble coalescence happens before the formation of the bubble pulse the bubble then collapses with the same energy after coalescence and the energy used to radiate the pressure wave is also the same even when v 1 v 2 varies nevertheless the primary pulse is generated before bubble coalescence so it is almost unaffected by coalescence varying monotonously with d r m for large bubble separations d 1 5r m the influence of the volume distribution of the two air gun bubbles on the pressure waves becomes pronounced because the formation time of the bubble pulse is different when v 1 v 2 1 the larger the bubble period difference the smaller the bubble pulse fig 17 shows the variation of primary to bubble pulse ratio pb from two air gun bubbles with d r m and v 1 v 2 according to engineering requirements as stated in section 1 pb should be as large as possible in order to improve the detection resolution of the seismic source and to enable seabed exploration at longer distances and deeper depths from fig 19 the maximum value of pb occurs near d 1 5 r m since interaction between two bubbles is strongest at this bubble separation and 1 5r m is also a critical value for bubble coalescence in other words when the bubble separation is small but the bubbles do not merge the bubble pulse is most effectively suppressed the volume distribution of the two bubbles v 1 v 2 should also not be too small fig 18 shows the variation of period of the pressure wave caused by two air gun bubbles with d r m and v 1 v 2 for two bubbles the period denotes the time formation of the first bubble pulse as marked on the pressure wave in fig 2 the bubble pulse is defined as the first maximum pulse after the primary pulse the period for two bubbles is therefore determined essentially by that of the larger bubble this explains why the period of two bubbles is large at a relatively small v 1 v 2 as the bubble with larger initial volume has a larger pulsation period cole 1948 however at relatively small d r m the two bubbles merge into one during the oscillation so the period for the two bubbles depends only on the sum of v 1 and v 2 the maximum period occurs at small d r m 6 results for three bubbles fig 19 shows the motion of three bubbles with different initial separations and each with a volume of 200 in3 during the expansion the bubbles repel each other the surfaces between adjacent bubbles are flattened and the water layer thicknesses between any two adjacent bubbles are reduced the three bubbles eventually merged into one if d is relatively small e g d 1 0r m and 1 5r m during the collapse of the bubble two high pressure zones are formed at the bottom and top of the bubble at the same time driven by this high pressure the two ends of the bubble have a faster contraction speed and the wall of the bubble gradually becomes more concave with two inward jets forming inside the bubble after the two jets collide at the bubble center it becomes toroidal and continues to oscillate in this form for d 2 0r m and 3 0r m the bubbles remain independent and do not come into contact with each other at any time during the oscillation during the bubble collapse high pressure stagnation points form at the bottom of the lower bubble and the top of the upper bubble the water between the bubbles and the stagnation points is accelerated making these two ends of the bubbles concave and forming inward liquid jets inside the lower and upper bubble meanwhile the middle bubble is attracted to both the upper and lower bubble and so elongates along the vertical direction after the upper and lower bubbles are penetrated by the inward jets long protrusions form around each bubble the protrusions gradually become close to the middle bubble as the bubbles continue to collapse the time variation of the fluid pressure induced by three air gun bubbles with different center separations is shown in fig 20 the initial volume of each bubble is 200 in3 and the measurement point is 100 m away from the upper bubble center because of the complex splitting and coalescence of the bubbles the calculation is terminated before the bubble pulse appears for d 1 5r m and 2 0r m for comparison 3 times the pressure wave caused by a bubble with initial volume 200 in3 from a single air gun and 1 5 times of the pressure wave caused by bubbles from two air guns d 3 0r m are included in fig 21 because the interaction between three bubbles is stronger the period is obviously longer than that caused by a single gun or two guns as for the suppression of bubble pulses the effect of three bubbles is not much different from that of two bubbles 7 conclusions this paper concerns the pressure waves generated by clustered air gun bubbles through treatment of the bubble topology under coalescence and splitting these multi period pressure waves are successfully calculated using the boundary element method to find effective ways to suppress the bubble pulse the influence of bubble distance bubble volume distribution and number of cluster air guns on the pressure wave are investigated based on the analysis of a large amount of numerical data the following conclusions are drawn 1 adjusting the distance d between clustered air gun bubbles is an effective way to suppress the bubble pulse of the pressure wave with an increase of d the primary pulse is reduced but the period is lengthened a critical value of d 1 5 is found at which the bubble pulse reaches a minimum value 2 if the distance d between two bubbles is relatively small then changing the volume distribution of the clustered air gun bubbles does not have a significant effect on the pressure wave but when d is relatively large the volume distribution has a pronounced effect on the pressure wave as v 1 v 2 decreases the primary pulse and the bubble pulse both reduce 3 as the number of the clustered air guns is increased to three the period of the pressure wave generated by the three bubbles is clearly longer than that caused by a single gun or two guns however the attenuation effect on the bubble pulse is about the same as that with two bubbles acknowledgments this work is supported by the national key r d program of china 2018yfc0308900 national natural science foundation of china no 11872158 no 11672081 the china postdoctoral science foundation funded project grant no 2018m640292 and the heilongjiang postdoctoral fund grant no lbh z18057 the authors are also grateful to dr q x wang at the university of birmingham for his great help 
22431,an uncertainty analysis is performed with the open source cfd toolkit openfoam for four different ship models kcs dtc kvlcc2 and jbc a brief review of the practices in uncertainty analysis in the field of ship cfd is presented uncertainty analysis is performed for their resistance sinkage and trim results using the two most popular uncertainty analysis methods the study revealed that the two methods differ significantly from each other in total uncertainty prediction and confirms that both validation and verification studies are case specific keywords cfd openfoam uncertainty analysis verification and validation 1 introduction modern day ship design is relying more often on computational fluid dynamics because of its ability to provide details of the flow field and its effects on ships however the accuracy of simulation data is still a major issue and this leads to giving most confidence to water tank test results thus in order to boost confidence in computational fluid dynamics cfd one of the essential tasks is to go through systematic verification and validation analysis for the used codes to ensure their consistent performance historically the first scientific gathering to discuss numerical uncertainty in some sense was the stanford olympics of 1968 kline et al 1968 however discussion back then was limited to the potential of early cfd codes and turbulence models in solving fluid flow problems it was in the 1990s when researchers and publishers started paying keen attention to the uncertainty analysis process of numerical codes because of the widespread development of numerous cfd codes in that period most of the past and even present verification studies are based on richardson extrapolation richardson and glazebrook 1911 richardson and gaunt 1927 where convergence is studied based on systematically refined grids journal of fluids engineering division of the american society of mechanical engineers asme was the first to publish an editorial policy on control of numerical accuracy in 1986 by roache et al 1986 however the policy simply stated the requirement of a systematic accuracy estimation for papers presenting numerical solutions and no guidelines for preparing such systematic analysis was provided to correct the situation and establish a generally acceptable quantification process of numerical uncertainty asme formed the cfd coordination group which led to the revision of the initial policy in 1993 as described by freitas 1993 aiaa journal and international journal of numerical methods in fluids also adopted editorial policies regarding numerical uncertainties in 1994 in 1998 aiaa published their guidelines for the verification and validation of cfd simulations aiaa 1998 roache 1994 1998 2003 celik et al 1993 1997 and freitas 1995a 1995b 1999 were among the early contributors to the field of systematic verification study their methods were mostly based on richardson extrapolation method and proposed computation of a grid convergence index gci for predicting uncertainty soon after coleman et al 1997 1999 2001 and stern et al 2001 joined the list of contributors and provided a more elaborate and complex method for verification mehta 1998 performed a variety of case studies for a wide range of applications following different methods uncertainty was also widely discussed in ittc proceedings 1996 and the first set of guidelines from ittc for uncertainty analysis was published in ittc 1999 which had a high resemblance to the proposed method by stern et al 2001 and wilson et al 2001 provided a more detailed process for verification study based on a correction factor ci method which was later revised by wilson and stern 2002 2004 however roache 2003a b criticized some of the limitations of the correction factor method proposed by stern nevertheless both the gci and ci method remained equally popular among researchers and several publications were made to demonstrate their applications and evaluations roache 2003 eça and hoekstra 2006 stern et al 2006 asme published their standard guidelines for v v studies in 2006 asme 2006 aiaa also revised their editorial policy in the same year aiaa 2006 in 2008 ittc revised its cfd uncertainty analysis guidelines taking roache s criticism into account ittc 2008 celik et al 2008 also proposed a simplified method based on gci for predicting the uncertainty due to discretization in cfd simulation in the same year at present both the verification methods ci and gci factor of safety remain popular among researchers since both suggest systematic verification study of the solver with a slight difference in final uncertainty prediction later eça and hoekstra 2014 proposed a least square root approach which allows uncertainty estimation for scattered results as well the method was included in the revised ittc guideline in 2017 ittc 2017 recently stern et al 2017 also proposed an n version verification and validation method for estimating the random error uncertainty which combined with experimental and systematic numerical uncertainties can be used to determine whether individual codes or simulations and the mean code codes in total are n version validated here the mean code is a fictitious representation of the average of the n version population all codes under study along with the study of the verification process it was also necessary to standardize a validation process since validation unlike verification was case dependent in other words only a calculation can be validated not the entire code most of the initial papers discussing uncertainty studies included discussion on both verification and validation processes however eventually it was realized that validation unlike verification cannot be generalized and is strictly case specific thus separate studies and papers were introduced focusing on validation among the contributors a group from sandia national laboratory published several publications by oberkampf et al 2000 2004 2010 and trucano et al 2006 discussing in detail about verification validation and calibration process they emphasize that solution verification must be performed for every simulation that is sufficiently different from previous solutions their discussion on verification was mostly for scientific computing rather than general cfd however their discussion on validation and calibration is well applicable to cfd codes and were very helpful in improving the understanding on the validation process and its limitations roy and oberkampf 2011 also presented a detailed paper on verification validation and uncertainty quantification at present it is well understood that validations are case specific and a certain validation level may be enough for a particular application and not for others finally calibration is also a major topic of discussion for scientific computing and has been discussed by oberkampf et al 2004 calibration in cfd is also used to reduce results discrepancy among different fidelity models wang et al 2015 however in computational ship hydrodynamics calibrations are rarely applied since calibration for one case might have uncertain effects on other cases this paper aims at providing a systematic and reliable verification and validation study for the open source cfd toolkit openfoam for calm water simulation of four different ship models the target is also to demonstrate the difference between the two most popular verification study methods and how validation studies are strictly case dependent the work was performed in the scope of shopera project papanikolaou et al 2016 which aims at determining the minimum power requirements for an ocean going vessel in different operating conditions confirming to the energy efficiency design index eedi criteria the introduction of eedi was a major step in promoting efficient ship operation with reduced emissions however over the years concerns have also been raised that some ship designers simply prefer to reduce installed propulsion power to attain eedi criteria instead of coming up with innovative propulsion and efficiency measures this raises serious concerns regarding ship s manoeuvring and seakeeping capabilities at adverse weather conditions thus the shopera project addressed the consequences of establishing a minimum power requirement criteria for an ocean going vessel one of the objectives of the project was to develop and adapt existing high fidelity hydrodynamic simulation software tools for the efficient analysis of the seakeeping and manoeuvring performance of ships in complex environmental and adverse weather conditions it is important to understand how a ship s power requirement changes from calm water to wave conditions to extreme wave conditions thus proper resistance prediction using cfd or other tools is essential under this scope different cfd tools were studied star ccm fournarakis et al 2016 2017 comet el moctar et al 2016 openfoam labanti et al 2016 neptuno cura hochbaum and voigt 2002 sprenger et al 2017 however the numerical uncertainties involved with these tools are important to know to understand the reliability of the results furthermore researchers in computational ship hydrodynamics field use a different type of uncertainty studies to evaluate the solvers they use in this study an uncertainty study is performed for the open source toolkit openfoam using the two most popular uncertainty analysis methods along with the one suggested by ittc guidelines a total of four ship models were evaluated for the study two container ships dtc kcs one crude carrier kvlcc2 and a bulk carrier jbc among them one container ship kcs and the crude carrier kvlcc2 were tested in the shopera project the other two hulls were simulated to demonstrate that even for similar hull forms numerical uncertainty can be different openfoam is an open source cfd tool that is becoming popular among different research groups thus the work is expected to be helpful to this cfd community 2 uncertainty analysis 2 1 definitions uncertainty analysis is a systematic study performed to assess the consistency and accuracy of a cfd solver in solving the intended problem uncertainty analysis is sub divided into two processes verification and validation verification assesses the consistency of the solver whereas validation evaluates its accuracy according to wikipedia verification is the evaluation of whether or not a product service or system complies with a regulation requirement specification or imposed condition it is often an internal process validation is the assurance that a product service or system meets the needs of the customer and other identified stakeholders it often involves acceptance and suitability with external customers however the definitions of verification and validation for the engineering community and research groups are more computing code oriented the us department of energy s advanced simulation and computing program asc gave a definition as followed verification asc is the process of confirming that a computer code correctly implements the algorithms that were intended validation asc is the process of confirming that the predictions of a code adequately represent measured physical phenomena the american institute of aeronautics and astronautics aiaa gave a more elaborate and generalized definition for verification validation and calibration verification aiaa is the process of determining that a model implementation accurately represents the developer s conceptual description of the model and the solution to the model validation aiaa is the process of determining the degree to which a model is an accurate representation of the real world from the perspective of the intended uses of the model calibration aiaa is the process of adjusting numerical or physical modelling parameters in the computational model for the purpose of improving agreement with real world data different lead researchers in the field defined verification and validation processes in their own ways among them roache 1998 gave a very simplified definition of verification and validation that says that verification is solving the equations right and validation is solving the right equations according to freitas 2002 the inherent inaccuracies in any numerical simulation of continuum problem comes from the approximation of the continuous system by a finite length a discrete approximation this creates uncertainty in a simulation which is quantified by the conditions of consistency and convergence verification and validation are essential processes to quantify this uncertainty freitas defined verification as the process to determine whether the mathematical model is solved correctly and validation is the process of assessing the accuracy of the simulation model for its domain of application stern et al 2001 commented that verification is a process to establish and confirm accuracy whereas validation is checking the agreement of the numerical model with physical data from experiments he defined verification as a process for assessing simulation numerical uncertainty and when conditions permit estimating the sign and magnitude of the simulation numerical error itself and the uncertainty in that error estimate whereas validation is a process for assessing simulation modelling uncertainty by using benchmark experimental data and when conditions permit estimating the sign and magnitude of the modelling error itself according to oberkampf 2004a oberkampf and roy 2010 verification provides evidence that the computational model is solved correctly and accurately and validation provides evidence that the mathematical model accurately relates to experimental measurements he emphasized that for verification the standard is the conceptual model and for validation the standard is the real world and calibration is a response to the degree of representation of the real world directed toward improvement of the agreement although different authorities publishers and research groups defined verification and validation process in different manners the core idea remains the same and they all agree that it is essential to perform verification and validation study for any simulation code to ensure its consistency and reliability 2 2 process numerous methods of uncertainty analysis have long been in discussion for the previous few decades both for experimental and computational studies among the studies most appreciated methods for verification study may be the ones discussed by celik et al 2008 stern et al 2001 wilson et al 2001 2004 and wilson and stern 2002 both follow a similar method based on richardson extrapolation however one suggests the use of grid convergence index gci using a safety factor fs whereas the other suggests correction factor ci over prediction 2 2 1 methodology verification and validation following the ittc 2008 guidelines for uncertainty analysis in cfd simulation error δ s may be defined as the difference between actual value t and simulated value s which may be further elaborated as the sum of modelling error δ s m and numerical error δ s n of cfd δ s s t δ s m δ s n for certain conditions both the sign and magnitude of the numerical error can be assumed as δ s n δ s n ε s n where δ s n is an estimation of the sign and magnitude of simulation numerical error and ε s n is the error in that estimate the simulation value is corrected to provide a numerical benchmark s c which is defined as s c s δ s n verification of numerical data involves assessing simulation numerical uncertainty and determining the error sign and magnitude when conditions permit it also involves assessing the uncertainty in the error estimation u s c n for uncorrected simulation approach numerical errors are decomposed into iterative errors δ i grid size errors δ g time step errors δ t and other parameters related errors δ p in this case the simulation numerical uncertainty is provided as 1 u s n 2 u i 2 u g 2 u t 2 u p 2 for the corrected simulation approach the solution is corrected to produce a numerical benchmark s c and the estimated simulation numerical error δ s n and corrected uncertainty u s c n are given by 2 δ s n δ i δ g δ t δ p 3 u s c n 2 u i c 2 u g c 2 u t c 2 u p c 2 validation is defined as a process for assessing simulation modelling uncertainty u s m by using benchmark experimental data and when conditions permit estimating the sign and magnitude of the modelling error δ s m itself the comparison error e is given by the difference in the data d and simulation s values e d s δ d δ s m δ s n modelling errors δ s m can be decomposed into modelling assumptions and the use of previous data to determine if validation has been achieved e is compared to the validation uncertainty u v given by u v 2 u d 2 u s n 2 if e u v the combination of all the errors in d and s is smaller than u v and validation is achieved at the u v level if u v e the sign and magnitude of e δ s m can be used to make modelling improvements for the corrected simulations the equations can be represented as 4 e d s c δ d δ s m δ s n 5 u v c 2 u e c 2 u s m 2 u d 2 u s c n 2 however in practical applications quantifying modelling errors are very difficult thus attention is provided just to simulation numerical errors as for numerical errors errors related to other parameters are mostly ignored unless something specific is mentioned as for errors related to iteration grid and time step each of them is investigated by varying particular conditions assuming that the other parameters remain unaffected according to the ittc guidelines however in practice iterative uncertainties are negligible for steady state simulations thus mostly grid size and time step uncertainties are analysed 2 2 2 convergence study convergence studies for parameters are performed following a systematic refinement process to create multiple solutions at least 3 for the parameter under investigations holding all other parameters constant say for grid refinement if r i is the refinement ratio r i δ x i 2 δ x i 1 δ x i 3 x i 2 δ x i m x i m 1 here in δ x i m x is the unit cell size in the mesh i is the refinement ratio and m is the number of solution the process is the same for time or other parameter study as for the refinement ratio ri the recommended value is 2 since the value is large enough to be sensitive to parameter changes and small enough to be used to generate at least three successive solutions maintaining the economy a larger refinement ratio may be used however m has to be at least three two solutions may be able to check parameter sensitivity but not convergence if s ˆ i 1 s ˆ i 2 and s ˆ i 3 represent three different solutions with fine medium and coarse input parameters respectively then changes between medium fine and coarse medium input are represented by ε i 21 s ˆ i 2 s ˆ i 1 and ε i 32 s ˆ i 3 s ˆ i 2 so the convergence ratio for the input parameter is defined as 6 r i ε i 21 ε i 32 depending on the sign and magnitude of r i three convergence conditions are possible 1 monotonic convergence 0 r i 1 2 oscillatory convergence r i 0 3 divergence r i 1 if the convergence is monotonic richardson extrapolation is used to estimate u i or δ i and u i c for oscillatory convergence uncertainties are estimated by bounding the error within the average of oscillating maximums s u and minimums s l u i 1 2 s u s l as for divergence errors and uncertainties cannot be estimated 2 2 3 richardson extrapolation and uncertainty estimation after the convergence study for monotonous convergence the order of convergence rate or accuracy p i is estimated next richardson extrapolation is used to estimate normalized discretization error δ r e i 1 in the solution 7 p i ln ε i 32 ε i 21 ln r i 8 δ r e i 1 ε i 21 r i p i 1 with three solutions only one term error and accuracy order can be estimated with five solutions two terms can be estimated which provides two term estimates for error and orders of accuracy equations for two term estimates can be found in ittc guidelines 2008 celik et al 2008 used a slightly different approach for predicting the apparent order p i and also proposed further calculation for prediction of extrapolated values s ˆ i 21 e x t approximate relative error δ i 21 a and extrapolated relative error δ i 21 e x t 7a p i 1 ln r i 21 l n ε i 32 ε i 21 q p 7b q p ln r i 21 p s r i 32 p s 7c s 1 s g n ε i 32 ε i 21 9 s ˆ i 21 e x t r i 21 p s ˆ i 1 s ˆ i 2 r i 21 p 1 10 δ i 21 a ε i 21 s ˆ i 1 11 δ i 21 e x t s ˆ i 21 e x t s ˆ i 1 s ˆ i 21 e x t finally grid convergence index gci and corrected simulation uncertainty are calculated by 12 g c i f i n e 21 1 25 δ i 21 a r i 21 p 1 f s δ r e i 1 13 u i c f s 1 δ r e i 1 thus gci is defined to be a multiple of richardson normalized discretization error by fs factor of safety the value of fs is suggested to be 1 25 for systematic parameter refinement study with at least three inputs or 3 for simple convergence studies with two values of the input parameter the multiplication of factor of safety makes the error band wider thus making the prediction less conservative however some researchers believe that the value of fs is ambiguous and the approach is over conservative when solutions are close to the asymptotic range and under conservative when solutions are far from the asymptotic range as an alternative to roache s approach wilson and stern 2002 and wilson et al 2004 proposed a correction factor ci based approach the ci based error estimation is defined by 14 δ i 1 c i δ r e i 1 c i ε i 21 r i p i 1 here instead of using a fixed value the correction factor is decided based on an estimated order of accuracy for the solver the correction factor ci is defined by 15 c i r i p i 1 r i p i e s t 1 here p i e s t is defined as an estimate for the limiting order of accuracy for the first term as sample spacing size tends to zero and the asymptotic range is attained so that ci 1 a two term based estimate can be found in the ittc 2008 guidelines for uncertainty assessment finally simulation uncertainty and corrected uncertainty are estimated as 16 u i 9 6 1 c i 2 1 1 δ r e i 1 1 c i 0 125 2 1 c i 1 δ r e i 1 1 c i 0 125 17 u i c 2 4 1 c i 2 0 1 δ r e i 1 1 c i 0 25 1 c i δ r e i 1 1 c i 0 25 these uncertainty estimates provide a 10 factor of safety in the limit c i 1 2 2 4 validation approach after predicting the simulation numerical uncertainty validation uncertainty is calculated by adding the involved data uncertainty so with validation uncertainty u v error e and the required level of validation uncertainty u r e q d six possible scenarios can be observed 1 e u v u r e q d 2 e u r e q d u v 3 u r e q d e u v 4 u v e u r e q d 5 u v u r e q d e 6 u r e q d u v e for cases 1 2 and 3 e u v so validation is achieved at u v level in the case of 4 5 and 6 u v e so the comparison error is above the noise level and validation could not be achieved for 4 though validation is achieved from a programmatic perspective 3 uncertainty in openfoam in the case of openfoam like any other cfd solver the numerical uncertainty may be defined as a summation of iterative grid size and time step uncertainty however since most of the ship simulation are recorded in the steady state the solver in general is independent of iterative convergence for grid convergence study the grids were refined with a refinement ratio of 2 and the uncertainty in error prediction was determined as for time step dependence the refinement ratio was kept at around 2 in this paper grid and time step uncertainty analysis are presented for four different hulls following richardson extrapolation the uncorrected simulation or factor of safety based approach celik et al 2008 and corrected simulation based approach stern et al 2001 since all the performed simulations were stable iterative uncertainty was ignored wilson et al 2001 3 1 solver structure openfoam is an open source library that numerically solves a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it contains an extensive range of solvers to perform different types of cfd simulations the solver has several packages to perform multiphase turbulent flow simulation for floating objects the solver has been elaborately described by jasak 2009 the module used to perform ship hydrodynamic simulations in openfoam simulates incompressible two phase flow the governing equation is based on continuity and reynolds averaged navier stokes equation the volume of fluid vof method is used to model fluid as one continuum of mixed properties finite volume method fvm is used to discretize the governing equations pressure velocity coupling is obtained through pimple algorithm openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference for the present paper the sst k ω model was used 3 1 1 turbulence parameters turbulence was modelled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated following the most common guidelines that were also used in labanti et al 2016 as follows 18 i 0 16 r 1 8 19 k m 2 s 2 3 2 u i 2 20 δ m l r 21 l m 0 4 δ 22 c μ 0 09 23 ω 1 s k c μ 1 4 l 24 ν t m 2 s 3 2 u i l where i is the turbulence intensity k is the turbulent kinetic energy per unit mass δ is the height of the boundary layer l is the turbulence length scale cμ is an empirical constant ω is the turbulence specific dissipation rate and ν t is the turbulent kinetic eddy viscosity the density and the kinematic viscosity of the fluids used in simulations are reported in table 1 3 1 2 boundary conditions the control volume represents a deep water condition so the two lateral sides and the bottom are symmetry plane type faces no additional information is required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions are as shown in table 2 3 2 ship models four different ship hulls kcs dtc kvlcc2 and jbc were simulated to investigate the uncertainty in openfoam for calm water simulation the models are quite popular among researchers and have been discussed widely in different workshops larsson et al 2011 gothenburg 2010 tokyo 2015 and simman 2008 2014 conferences and eu funded projects 3 2 1 kcs model the kriso container ship kcs is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose tokyo 2015 fig 1 shows the body plan of the kcs model and the ship specifications are provided in table 3 3 2 2 dtc dtc is a container ship model with a bulbous bow large bow flare and a transom stern with a large overhang el moctar et al 2012 it is a single screw vessel with a propeller and a rudder the ship is also equipped with a bilge keel comprised of five segments per ship side however for simulation only the bare hull was considered main particulars of the ship are mentioned in table 4 and the ship s body plan is shown in fig 2 3 2 3 kvlcc2 the kriso very large crude carrier 2 kvlcc2 is a large oil tanker model developed solely for research purpose and was first introduced to researchers in simman 2008 larsson et al 2011 table 5 provides the specifications of the kvlcc2 model and fig 3 shows its side view and body planes all the simulations have been performed in non dimensional scale 3 2 4 jbc the japan bulk carrier jbc is a capesize bulk carrier jointly introduced by national maritime research institute nmri yokohama national university and shipbuilding research centre of japan src for the tokyo 2015 workshop see fig 4 table 6 provides specifications of the jbc model and 4 shows its profile view and body plan the surface panels on the profile view have been generated using post processing from the computational mesh 3 3 meshing the domain size blockmesh for simulations was set mostly following ittc 2011 guidelines the inlet was placed two ship length windward the bow the outlet four ship length downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which creates a body fitted hexahedral mesh around the hull surface from the specified stl file the domain area near the free surface and hull form was refined multiple times using toposet and refinement then snappyhexmesh was applied some refinement was also performed through snappyhexmesh due to different hull shape and model size different mesh resolutions were used for the four different cases however the similarity was maintained in the mesh topology detail regarding mesh is provided in the results section the general mesh assembly used for the simulations is shown in fig 5 3 4 computational resource the simulations were performed in a single node intel r core i7 cpu with 8 cores clock speed of 2 27 ghz and 8 gb of physical memory the average time step used was 0 02 s and for simulating each case with stable output the required physical time was about 15 48 h per case all the simulations were run up to 100 s simulation time for attaining stable results 4 results calm water resistance prediction is the estimation of drag force for a ship while moving forward in the calm water ship s drag resistance is a summation of frictional resistance and pressure resistance frictional resistance arises from the hull surface friction and pressure resistance is mainly the wave making resistance encountered by ship during its forward motion when the ship moves forward the bow creates waves on the free surface thus energy is transferred from ship to free surface and this loss is termed as wave making resistance the flow separation occurs at the stern section where the turbulence is mainly observed thus higher resolution at the bow and stern sections and also at the free surface near these sections are essential to attain a good prediction as for free surface mesh distribution the emphasis is on capturing the boundary layer near the hull surface however openfoam uses a wall function to capture the effects of the boundary layer thus a y value of 30 and above is maintained for performing the uncertainty analysis three different mesh resolutions and three time steps were used for each model uncertainty was analysed for total drag coefficient sinkage and trim prediction all simulations were performed using interdymfoam solver of openfoam with dynamic meshing and heave and pitch free motion the numerical uncertainty was initially determined based on the safety factor fs based model proposed by celik et al 2008 accordingly convergence order of accuracy p and grid convergence index gci were determined for all the cases p value was calculated following equation 7a as proposed by celik et al 2008 not following the equation 7 as recommended in ittc guidelines this was done because the ittc recommended equation for p only allows calculation for an order of accuracy for monotonous convergence thus it would not be possible to calculate the corrected uncertainty for all the cases using equation 7 furthermore the p value gained using equation 7a is more conservative compared to equation 7 after that following the ittc guidelines 2008 corrected uncertainty was estimated for both factor of safety fs and correction factor ci based approach for the fs method corrected uncertainty was estimated for all cases monotonous oscillatory and divergent simply by applying equation 13 with fs value of 1 25 as for ci method corrected uncertainty was predicted using equation 17 for monotonous cases the theoretical order of accuracy was assumed to be 2 as most of the discretization schemes used in openfoam are of 2nd order for oscillatory cases an error band was calculated by taking an average of max and min simulation values as for divergent cases corrected uncertainty is not estimated ne as for systematic validation approach the study only calculated the corrected numerical uncertainty however related data uncertainty was not available for any of the cases thus proper validation study could not be performed nevertheless if the error level is below the corrected numerical uncertainty naturally validation is achieved so only the simulation results that have error level below the numerical noise level were claimed to be validated in the following cases 4 1 kcs model to investigate the uncertainty in calm water simulation for kcs model a 7 27 m model ship was simulated the simulations were performed with free heave and pitch motion and all other motions were restricted three different mesh resolutions were used for simulation in each case mesh number was revised in x y and z direction in blockmeshdict maintaining a rough ratio of 2 simulations were performed with mesh resolutions of 5 57 million fine 2 4 million mid and 1 08 million coarse for froude numbers of 0 26 and 0 195 all simulations were full hull simulations the uncertainty analysis performed for kcs model in openfoam based on the mesh dependency is shown in detail in table 7 as can be seen from table 7 for froude number 0 26 both resistance and sinkage results show monotonous convergence whereas trim shows oscillatory convergence however in the case of froude number 0 195 the resistance data shows divergence sinkage shows oscillatory and trim shows monotonous convergence the divergence is observed for resistance prediction since simulation result significantly improves with mesh resolution exceeding 2 million in the case of sinkage and trim the actual scale deviation is small and very high grid resolution in the z axis is required to capture the variations properly which was avoided in the presented simulations next corrected uncertainty was estimated for both factor of safety fs and correction factor ci based approach as shown in table 8 as can be seen from the table the correction factor based approach provides a wider range of uncertainty for the same results comparing to the factor of safety based approach in order to further illustrate mesh dependency in openfoam pressure distribution on free surface and hull form is shown in fig 6 as can be seen from the figure with higher mesh resolution pressure distribution on free surface is revealed with better detail next time dependent uncertainty was estimated three different simulations were performed with a mesh resolution of 2 4 million and time step size 0 02s 0 03s and 0 04s the analysis is shown in table 9 the results only show oscillatory convergence and divergence indicating that the lowest time step used for the study might have been too coarse also the refinement ratio was higher for 1st and 2nd step comparing to 2nd and 3rd step this was done to have a comparison range which is both economical and that easily converges although the results are not favourable here the simulations provided data for continuing the analysis and showed limitations regarding selecting time steps depending on flow field velocity next corrected uncertainty was estimated for both fs and ci based methods as shown in table 10 finally the total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 11 in order to validate the simulation predictions results were compared with experimental data provided by gothenburg university in tokyo 2015 workshop the comparison is shown only for the fine mesh in table 12 as can be seen from the comparison even with a mesh resolution of 5 5 million the solver fails to predict the resistance with reasonable accuracy this may be contributed to insufficient mesh distribution at some mesh sensitive areas thus although results show improvement with increasing mesh resolution the improvement is limited as for sinkage and trim results the real scale deviation with experimental data is quite small the results should improve with the application of higher mesh resolution in the z direction further investigation may be needed in this case for a better understanding of mesh dependency however this deviation doesn t affect the uncertainty study following a systematic validation approach for all the cases except the drag resistance at fr 0 195 the error level is higher than the corrected total numerical uncertainty table 11 so comparison error is above the noise level in the numerical process for all cases and only resistance prediction at fr 0 195 is validated however the corrected uncertainty here only includes numerical uncertainty not data uncertainty thus performing proper comparison and reaching conclusion is not possible at present 4 2 dtc model to investigate the calm water simulation uncertainty for dtc model a 5 976 m model ship was simulated with free heave and pitch motion and all other motions restricted three mesh resolutions were used with gradual mesh refinement in x y and z direction in blockmeshdict maintaining a ratio of 2 however just for the dtc hull case only half hull was simulated the simulation follows the dtc tutorial available in openfoam so that it is easier for other researchers to reproduce the results if interested simulations were performed with mesh resolutions of 1 4 million fine 0 576 million mid and 0 247 million coarse for froude numbers of 0 218 and 0 200 the uncertainty analysis performed for the dtc model in openfoam based on the mesh dependency is shown in table 13 as can be seen from the table for both the froude numbers the analysis shows monotonous convergence for resistance and sinkage prediction in the case of trim the higher froude number shows divergence while the lower one shows monotonous convergence the divergence in this case is observed due to lack of minimum required resolution in z axis for capturing the minute trim movement at the coarse grid the order of accuracy for all the predictions are also acceptable next corrected uncertainty was estimated as shown in table 14 to further illustrate the impact of mesh resolution on simulation fig 7 shows pressure distribution on the free surface for the simulations using three different mesh resolution the time dependent uncertainty was estimated by simulating the dtc model with a mesh resolution of 1 4 million and time step size 0 01s 0 02s and 0 04s the analysis is shown in table 15 the results show divergence for resistance prediction at fr 0 2 and convergence for the rest next corrected uncertainty was estimated for both fs and ci based methods as shown in table 16 finally the total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 17 to validate the simulations results were compared with experimental data provided by el moctar et al 2012 however only resistance data were available for comparison not motion data the comparison is shown in table 18 as can be seen from the table the simulation results show good agreement with experimental data and deviation is limited to 3 7 the deviation increases with reduction in ship speed this happens because with decreasing speed the amplitude of pressure force decreases and it becomes more difficult for cfd to capture the forces accurately following a systematic validation approach validation could not be achieved for either the cases since the discrepancy between efd and cfd is higher comparing to the estimated cfd uncertainty 4 3 kvlcc2 model a 7 m kvlcc2 model was used for the simulations with three different mesh resolutions of 3 54 1 88 and 0 9 million the full hull model was simulated with a heave and pitch free motion for froude number 0 1194 and 0 1423 the design speed of kvlcc2 is at fr 0 1423 the uncertainty analysis for the kvlcc2 model based on mesh dependency is shown in table 19 the analysis shows both monotonous and oscillatory convergence however no divergence is observed the calculated order of accuracies are also high and gci has low values next corrected uncertainty was estimated as shown in table 20 the time dependent uncertainty was estimated by simulating the kvlcc2 model with a mesh resolution of 3 54 million and time step size 0 02s 0 03s and 0 04s the analysis is shown in table 21 the analysis shows poor convergence with just one oscillatory convergence and rest to be divergent the calculated order of accuracies are also high comparing to the limiting theoretical value and gci is of low values as observed before for kcs case similarly the coarse time step used for the simulations here was most probably not suitable and thus gave a poor convergence apart from influencing simulation results time step size also influences the stability convergence of results as time step size increases higher oscillation is observed in the time history of the results this is demonstrated by fig 8 where time history for force prediction is shown for three different time steps the simulations were re started at 90 s thus the initial high amplitude is observed in the figures after gci calculation corrected uncertainty was estimated for both fs and ci based methods as shown in table 22 and finally total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 23 unfortunately due to many diverged cases in the time step uncertainty analysis total uncertainty could be calculated just for one case following the correction factor based approach for validation results were compared with experimental data provided by the gothenburg university in gothenburg 2010 workshop larsson et al 2011 the comparison is shown only for the fine mesh in table 24 the resistance and trim results show very good agreement with experimental data however for the sinkage cases the deviation is significantly large however the sinkage trend is well followed by cfd besides the actual deviation is in the millimetre scale which is very small furthermore the difference may also come from different assumption for the vertical centre of gravity in case of efd and cfd thus it may be assumed that overall the results are well predicted here for resistance and trim prediction validation is achieved for the second froude cases following the ci method as the predicted uncertainty is higher than the deviation observed with experimental data 4 4 jbc model for the japan bulk carrier jbc a 7 m model was simulated with mesh resolution of 3 77 million 1 88 million and 0 88 million following the previous case simulations were run for froude number 0 1423 and 0 1194 jbc and kvlcc2 have very similar hull forms and design speed all simulations for jbc was performed with a heave and pitch free motion since both kvlcc2 and jbc hull form have similar hull form and they share same model size the mesh resolution used for the two cases is quite similar the uncertainty analysis for the jbc model based on mesh dependency is shown in table 25 the uncertainty analysis in this case shows both convergence and divergence the resistance prediction shows monotonous convergence the sinkage shows oscillatory convergence and one trim prediction shows divergence however in resistance prediction cases the difference in predicted results for different mesh resolution is relatively high as a result the order of accuracy is low and gci is high this might be because of the insufficient mesh resolution near the hull surface because of its blunt bow and low design speed it is relatively difficult to properly capture the flow field without sufficiently high resolution the latter two mesh resolutions might not have been enough to capture the flow features properly near bow and stern thus larger deviation is observed the corrected uncertainty estimate for mesh resolution for jbc is shown in table 26 to further illustrate the results hydrodynamic pressure distribution on zero water level and hull surface are shown in fig 9 the figure shows how the detail in pressure distribution varies with mesh resolution the figure shows how the pressure capturing around the free surface and the hull improves with improving mesh resolution the time dependent uncertainty was estimated by simulating the jbc model with a mesh resolution of 3 77 million and time step size 0 01s 0 02s and 0 04s the analysis is shown in table 27 as can be seen from the analysis the results show both monotonous and oscillatory convergence and one case of divergence the order of accuracy is relatively low as mentioned before because of the low froude number the pressure variation near hull form is small and relatively large time step simply fail to capture it properly next corrected uncertainty was estimated for both fs and ci based methods as shown in table 28 and finally total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 29 since there were several divergent cases in grid and time dependency study total uncertainty could not be determined for two cases overall for the jbc model total uncertainty is quite high for resistance prediction at lower froude number next for the validation study the results were compared with the experimental data provided by nmri in the tokyo 2015 workshop however data were available only for froude number 0 1423 the comparison is shown in table 30 the simulation results show very good agreement with experimental data for resistance and trim data however the sinkage data is significantly out of order according to the experimental data provided in tokyo 2015 workshop website the actual sinkage value for a 7 m model should be 0 6 mm which is too small thus the applied mesh resolution most probably was not enough to capture such minute value properly with improved mesh resolution in the z direction and applying the same vertical centre of gravity as the experiment when available the results should improve it was not attempted for present cases considering the high resource requirement involved here validation is achieved for resistance prediction for ci based approach and for trim following the fs based approach 4 5 grid independence with higher mesh resolution as discussed in the theoretical section of uncertainty assessment verification and validation studies are essentially case specific which is clearly demonstrated in the study of the four ship models used for the present study although similar mesh resolutions were used for the studies the degree of agreement with experimental data for each case varied significantly the variation may be mainly contributed to the difference in froude number for different ship models which results in a different y value for each case nevertheless it is widely proposed by different research groups that if sufficiently high mesh resolution is applied the results become grid independent to assess the belief simulations were performed with around 10 million cells for a container kcs and bulk carrier jbc for two different froude numbers maintaining similar mesh topology for both models the domain size of the meshes was kept the same as shown in previous cases and the mesh resolution was improved by increasing number of sections in x y and z direction in blockmesh all simulations were performed with a heave and pitch free motion the required simulation time for these cases was about 96 h for each case the comparison results are shown in tables 31 and 32 as can be seen from the results for the kcs case the higher resolution has improved the resistance prediction however accuracy in sinkage and trim prediction is still significantly low as for the jbc case the deviation with experimental data slightly increased with higher mesh resolution overall the validation level for the two models is significantly different from each other thus as observed even a mesh resolution of 10 million cells is not enough to attain a grid independent solution for two different ship models 5 conclusion in the paper a systematic verification and validation study was attempted for ship simulation for the open source cfd toolkit openfoam initially a brief literature review on verification and validation study is provided together with the ittc recommended procedure for the study next four different ship models were simulated to investigate their grid and time step dependence for resistance sinkage and trim prediction in calm water a systematic verification study was performed with the results using the two most popular uncertainty models and total corrected uncertainty was estimated four different hull forms two container ship models kcs dtc a crude carrier kvlcc2 and a bulk carrier jbc were simulated in calm water condition and total drag coefficient sinkage and trim were predicted from the results to perform the uncertainty study three different mesh resolution and three time steps were used for each case uncertainty for the cases was estimated using both safety factor fs and correction factor ci based approach the analysis showed a significant difference between the total predicted uncertainties for the two methods in almost all cases fs based approach predicted a lower level of uncertainty comparing ci based method furthermore although similar mesh topology was used all four simulations showed different results from each other both for verification and validation study the results show that despite having geometric similarities mesh dependency for each hull form is different from the other even with the application of significantly high mesh resolution 10 million cells container model and bulk carrier model do not show a similar level of agreement with experimental data overall it may be concluded from the study that the safety factor and correction factor based approach differ significantly from each other in uncertainty prediction furthermore it is not just a validation study that is case specific verification study is case specific as well acknowledgements this work was performed within the project shopera energy efficient safe ship operation which was partially funded by the eu fp7 under contract 605221 
22431,an uncertainty analysis is performed with the open source cfd toolkit openfoam for four different ship models kcs dtc kvlcc2 and jbc a brief review of the practices in uncertainty analysis in the field of ship cfd is presented uncertainty analysis is performed for their resistance sinkage and trim results using the two most popular uncertainty analysis methods the study revealed that the two methods differ significantly from each other in total uncertainty prediction and confirms that both validation and verification studies are case specific keywords cfd openfoam uncertainty analysis verification and validation 1 introduction modern day ship design is relying more often on computational fluid dynamics because of its ability to provide details of the flow field and its effects on ships however the accuracy of simulation data is still a major issue and this leads to giving most confidence to water tank test results thus in order to boost confidence in computational fluid dynamics cfd one of the essential tasks is to go through systematic verification and validation analysis for the used codes to ensure their consistent performance historically the first scientific gathering to discuss numerical uncertainty in some sense was the stanford olympics of 1968 kline et al 1968 however discussion back then was limited to the potential of early cfd codes and turbulence models in solving fluid flow problems it was in the 1990s when researchers and publishers started paying keen attention to the uncertainty analysis process of numerical codes because of the widespread development of numerous cfd codes in that period most of the past and even present verification studies are based on richardson extrapolation richardson and glazebrook 1911 richardson and gaunt 1927 where convergence is studied based on systematically refined grids journal of fluids engineering division of the american society of mechanical engineers asme was the first to publish an editorial policy on control of numerical accuracy in 1986 by roache et al 1986 however the policy simply stated the requirement of a systematic accuracy estimation for papers presenting numerical solutions and no guidelines for preparing such systematic analysis was provided to correct the situation and establish a generally acceptable quantification process of numerical uncertainty asme formed the cfd coordination group which led to the revision of the initial policy in 1993 as described by freitas 1993 aiaa journal and international journal of numerical methods in fluids also adopted editorial policies regarding numerical uncertainties in 1994 in 1998 aiaa published their guidelines for the verification and validation of cfd simulations aiaa 1998 roache 1994 1998 2003 celik et al 1993 1997 and freitas 1995a 1995b 1999 were among the early contributors to the field of systematic verification study their methods were mostly based on richardson extrapolation method and proposed computation of a grid convergence index gci for predicting uncertainty soon after coleman et al 1997 1999 2001 and stern et al 2001 joined the list of contributors and provided a more elaborate and complex method for verification mehta 1998 performed a variety of case studies for a wide range of applications following different methods uncertainty was also widely discussed in ittc proceedings 1996 and the first set of guidelines from ittc for uncertainty analysis was published in ittc 1999 which had a high resemblance to the proposed method by stern et al 2001 and wilson et al 2001 provided a more detailed process for verification study based on a correction factor ci method which was later revised by wilson and stern 2002 2004 however roache 2003a b criticized some of the limitations of the correction factor method proposed by stern nevertheless both the gci and ci method remained equally popular among researchers and several publications were made to demonstrate their applications and evaluations roache 2003 eça and hoekstra 2006 stern et al 2006 asme published their standard guidelines for v v studies in 2006 asme 2006 aiaa also revised their editorial policy in the same year aiaa 2006 in 2008 ittc revised its cfd uncertainty analysis guidelines taking roache s criticism into account ittc 2008 celik et al 2008 also proposed a simplified method based on gci for predicting the uncertainty due to discretization in cfd simulation in the same year at present both the verification methods ci and gci factor of safety remain popular among researchers since both suggest systematic verification study of the solver with a slight difference in final uncertainty prediction later eça and hoekstra 2014 proposed a least square root approach which allows uncertainty estimation for scattered results as well the method was included in the revised ittc guideline in 2017 ittc 2017 recently stern et al 2017 also proposed an n version verification and validation method for estimating the random error uncertainty which combined with experimental and systematic numerical uncertainties can be used to determine whether individual codes or simulations and the mean code codes in total are n version validated here the mean code is a fictitious representation of the average of the n version population all codes under study along with the study of the verification process it was also necessary to standardize a validation process since validation unlike verification was case dependent in other words only a calculation can be validated not the entire code most of the initial papers discussing uncertainty studies included discussion on both verification and validation processes however eventually it was realized that validation unlike verification cannot be generalized and is strictly case specific thus separate studies and papers were introduced focusing on validation among the contributors a group from sandia national laboratory published several publications by oberkampf et al 2000 2004 2010 and trucano et al 2006 discussing in detail about verification validation and calibration process they emphasize that solution verification must be performed for every simulation that is sufficiently different from previous solutions their discussion on verification was mostly for scientific computing rather than general cfd however their discussion on validation and calibration is well applicable to cfd codes and were very helpful in improving the understanding on the validation process and its limitations roy and oberkampf 2011 also presented a detailed paper on verification validation and uncertainty quantification at present it is well understood that validations are case specific and a certain validation level may be enough for a particular application and not for others finally calibration is also a major topic of discussion for scientific computing and has been discussed by oberkampf et al 2004 calibration in cfd is also used to reduce results discrepancy among different fidelity models wang et al 2015 however in computational ship hydrodynamics calibrations are rarely applied since calibration for one case might have uncertain effects on other cases this paper aims at providing a systematic and reliable verification and validation study for the open source cfd toolkit openfoam for calm water simulation of four different ship models the target is also to demonstrate the difference between the two most popular verification study methods and how validation studies are strictly case dependent the work was performed in the scope of shopera project papanikolaou et al 2016 which aims at determining the minimum power requirements for an ocean going vessel in different operating conditions confirming to the energy efficiency design index eedi criteria the introduction of eedi was a major step in promoting efficient ship operation with reduced emissions however over the years concerns have also been raised that some ship designers simply prefer to reduce installed propulsion power to attain eedi criteria instead of coming up with innovative propulsion and efficiency measures this raises serious concerns regarding ship s manoeuvring and seakeeping capabilities at adverse weather conditions thus the shopera project addressed the consequences of establishing a minimum power requirement criteria for an ocean going vessel one of the objectives of the project was to develop and adapt existing high fidelity hydrodynamic simulation software tools for the efficient analysis of the seakeeping and manoeuvring performance of ships in complex environmental and adverse weather conditions it is important to understand how a ship s power requirement changes from calm water to wave conditions to extreme wave conditions thus proper resistance prediction using cfd or other tools is essential under this scope different cfd tools were studied star ccm fournarakis et al 2016 2017 comet el moctar et al 2016 openfoam labanti et al 2016 neptuno cura hochbaum and voigt 2002 sprenger et al 2017 however the numerical uncertainties involved with these tools are important to know to understand the reliability of the results furthermore researchers in computational ship hydrodynamics field use a different type of uncertainty studies to evaluate the solvers they use in this study an uncertainty study is performed for the open source toolkit openfoam using the two most popular uncertainty analysis methods along with the one suggested by ittc guidelines a total of four ship models were evaluated for the study two container ships dtc kcs one crude carrier kvlcc2 and a bulk carrier jbc among them one container ship kcs and the crude carrier kvlcc2 were tested in the shopera project the other two hulls were simulated to demonstrate that even for similar hull forms numerical uncertainty can be different openfoam is an open source cfd tool that is becoming popular among different research groups thus the work is expected to be helpful to this cfd community 2 uncertainty analysis 2 1 definitions uncertainty analysis is a systematic study performed to assess the consistency and accuracy of a cfd solver in solving the intended problem uncertainty analysis is sub divided into two processes verification and validation verification assesses the consistency of the solver whereas validation evaluates its accuracy according to wikipedia verification is the evaluation of whether or not a product service or system complies with a regulation requirement specification or imposed condition it is often an internal process validation is the assurance that a product service or system meets the needs of the customer and other identified stakeholders it often involves acceptance and suitability with external customers however the definitions of verification and validation for the engineering community and research groups are more computing code oriented the us department of energy s advanced simulation and computing program asc gave a definition as followed verification asc is the process of confirming that a computer code correctly implements the algorithms that were intended validation asc is the process of confirming that the predictions of a code adequately represent measured physical phenomena the american institute of aeronautics and astronautics aiaa gave a more elaborate and generalized definition for verification validation and calibration verification aiaa is the process of determining that a model implementation accurately represents the developer s conceptual description of the model and the solution to the model validation aiaa is the process of determining the degree to which a model is an accurate representation of the real world from the perspective of the intended uses of the model calibration aiaa is the process of adjusting numerical or physical modelling parameters in the computational model for the purpose of improving agreement with real world data different lead researchers in the field defined verification and validation processes in their own ways among them roache 1998 gave a very simplified definition of verification and validation that says that verification is solving the equations right and validation is solving the right equations according to freitas 2002 the inherent inaccuracies in any numerical simulation of continuum problem comes from the approximation of the continuous system by a finite length a discrete approximation this creates uncertainty in a simulation which is quantified by the conditions of consistency and convergence verification and validation are essential processes to quantify this uncertainty freitas defined verification as the process to determine whether the mathematical model is solved correctly and validation is the process of assessing the accuracy of the simulation model for its domain of application stern et al 2001 commented that verification is a process to establish and confirm accuracy whereas validation is checking the agreement of the numerical model with physical data from experiments he defined verification as a process for assessing simulation numerical uncertainty and when conditions permit estimating the sign and magnitude of the simulation numerical error itself and the uncertainty in that error estimate whereas validation is a process for assessing simulation modelling uncertainty by using benchmark experimental data and when conditions permit estimating the sign and magnitude of the modelling error itself according to oberkampf 2004a oberkampf and roy 2010 verification provides evidence that the computational model is solved correctly and accurately and validation provides evidence that the mathematical model accurately relates to experimental measurements he emphasized that for verification the standard is the conceptual model and for validation the standard is the real world and calibration is a response to the degree of representation of the real world directed toward improvement of the agreement although different authorities publishers and research groups defined verification and validation process in different manners the core idea remains the same and they all agree that it is essential to perform verification and validation study for any simulation code to ensure its consistency and reliability 2 2 process numerous methods of uncertainty analysis have long been in discussion for the previous few decades both for experimental and computational studies among the studies most appreciated methods for verification study may be the ones discussed by celik et al 2008 stern et al 2001 wilson et al 2001 2004 and wilson and stern 2002 both follow a similar method based on richardson extrapolation however one suggests the use of grid convergence index gci using a safety factor fs whereas the other suggests correction factor ci over prediction 2 2 1 methodology verification and validation following the ittc 2008 guidelines for uncertainty analysis in cfd simulation error δ s may be defined as the difference between actual value t and simulated value s which may be further elaborated as the sum of modelling error δ s m and numerical error δ s n of cfd δ s s t δ s m δ s n for certain conditions both the sign and magnitude of the numerical error can be assumed as δ s n δ s n ε s n where δ s n is an estimation of the sign and magnitude of simulation numerical error and ε s n is the error in that estimate the simulation value is corrected to provide a numerical benchmark s c which is defined as s c s δ s n verification of numerical data involves assessing simulation numerical uncertainty and determining the error sign and magnitude when conditions permit it also involves assessing the uncertainty in the error estimation u s c n for uncorrected simulation approach numerical errors are decomposed into iterative errors δ i grid size errors δ g time step errors δ t and other parameters related errors δ p in this case the simulation numerical uncertainty is provided as 1 u s n 2 u i 2 u g 2 u t 2 u p 2 for the corrected simulation approach the solution is corrected to produce a numerical benchmark s c and the estimated simulation numerical error δ s n and corrected uncertainty u s c n are given by 2 δ s n δ i δ g δ t δ p 3 u s c n 2 u i c 2 u g c 2 u t c 2 u p c 2 validation is defined as a process for assessing simulation modelling uncertainty u s m by using benchmark experimental data and when conditions permit estimating the sign and magnitude of the modelling error δ s m itself the comparison error e is given by the difference in the data d and simulation s values e d s δ d δ s m δ s n modelling errors δ s m can be decomposed into modelling assumptions and the use of previous data to determine if validation has been achieved e is compared to the validation uncertainty u v given by u v 2 u d 2 u s n 2 if e u v the combination of all the errors in d and s is smaller than u v and validation is achieved at the u v level if u v e the sign and magnitude of e δ s m can be used to make modelling improvements for the corrected simulations the equations can be represented as 4 e d s c δ d δ s m δ s n 5 u v c 2 u e c 2 u s m 2 u d 2 u s c n 2 however in practical applications quantifying modelling errors are very difficult thus attention is provided just to simulation numerical errors as for numerical errors errors related to other parameters are mostly ignored unless something specific is mentioned as for errors related to iteration grid and time step each of them is investigated by varying particular conditions assuming that the other parameters remain unaffected according to the ittc guidelines however in practice iterative uncertainties are negligible for steady state simulations thus mostly grid size and time step uncertainties are analysed 2 2 2 convergence study convergence studies for parameters are performed following a systematic refinement process to create multiple solutions at least 3 for the parameter under investigations holding all other parameters constant say for grid refinement if r i is the refinement ratio r i δ x i 2 δ x i 1 δ x i 3 x i 2 δ x i m x i m 1 here in δ x i m x is the unit cell size in the mesh i is the refinement ratio and m is the number of solution the process is the same for time or other parameter study as for the refinement ratio ri the recommended value is 2 since the value is large enough to be sensitive to parameter changes and small enough to be used to generate at least three successive solutions maintaining the economy a larger refinement ratio may be used however m has to be at least three two solutions may be able to check parameter sensitivity but not convergence if s ˆ i 1 s ˆ i 2 and s ˆ i 3 represent three different solutions with fine medium and coarse input parameters respectively then changes between medium fine and coarse medium input are represented by ε i 21 s ˆ i 2 s ˆ i 1 and ε i 32 s ˆ i 3 s ˆ i 2 so the convergence ratio for the input parameter is defined as 6 r i ε i 21 ε i 32 depending on the sign and magnitude of r i three convergence conditions are possible 1 monotonic convergence 0 r i 1 2 oscillatory convergence r i 0 3 divergence r i 1 if the convergence is monotonic richardson extrapolation is used to estimate u i or δ i and u i c for oscillatory convergence uncertainties are estimated by bounding the error within the average of oscillating maximums s u and minimums s l u i 1 2 s u s l as for divergence errors and uncertainties cannot be estimated 2 2 3 richardson extrapolation and uncertainty estimation after the convergence study for monotonous convergence the order of convergence rate or accuracy p i is estimated next richardson extrapolation is used to estimate normalized discretization error δ r e i 1 in the solution 7 p i ln ε i 32 ε i 21 ln r i 8 δ r e i 1 ε i 21 r i p i 1 with three solutions only one term error and accuracy order can be estimated with five solutions two terms can be estimated which provides two term estimates for error and orders of accuracy equations for two term estimates can be found in ittc guidelines 2008 celik et al 2008 used a slightly different approach for predicting the apparent order p i and also proposed further calculation for prediction of extrapolated values s ˆ i 21 e x t approximate relative error δ i 21 a and extrapolated relative error δ i 21 e x t 7a p i 1 ln r i 21 l n ε i 32 ε i 21 q p 7b q p ln r i 21 p s r i 32 p s 7c s 1 s g n ε i 32 ε i 21 9 s ˆ i 21 e x t r i 21 p s ˆ i 1 s ˆ i 2 r i 21 p 1 10 δ i 21 a ε i 21 s ˆ i 1 11 δ i 21 e x t s ˆ i 21 e x t s ˆ i 1 s ˆ i 21 e x t finally grid convergence index gci and corrected simulation uncertainty are calculated by 12 g c i f i n e 21 1 25 δ i 21 a r i 21 p 1 f s δ r e i 1 13 u i c f s 1 δ r e i 1 thus gci is defined to be a multiple of richardson normalized discretization error by fs factor of safety the value of fs is suggested to be 1 25 for systematic parameter refinement study with at least three inputs or 3 for simple convergence studies with two values of the input parameter the multiplication of factor of safety makes the error band wider thus making the prediction less conservative however some researchers believe that the value of fs is ambiguous and the approach is over conservative when solutions are close to the asymptotic range and under conservative when solutions are far from the asymptotic range as an alternative to roache s approach wilson and stern 2002 and wilson et al 2004 proposed a correction factor ci based approach the ci based error estimation is defined by 14 δ i 1 c i δ r e i 1 c i ε i 21 r i p i 1 here instead of using a fixed value the correction factor is decided based on an estimated order of accuracy for the solver the correction factor ci is defined by 15 c i r i p i 1 r i p i e s t 1 here p i e s t is defined as an estimate for the limiting order of accuracy for the first term as sample spacing size tends to zero and the asymptotic range is attained so that ci 1 a two term based estimate can be found in the ittc 2008 guidelines for uncertainty assessment finally simulation uncertainty and corrected uncertainty are estimated as 16 u i 9 6 1 c i 2 1 1 δ r e i 1 1 c i 0 125 2 1 c i 1 δ r e i 1 1 c i 0 125 17 u i c 2 4 1 c i 2 0 1 δ r e i 1 1 c i 0 25 1 c i δ r e i 1 1 c i 0 25 these uncertainty estimates provide a 10 factor of safety in the limit c i 1 2 2 4 validation approach after predicting the simulation numerical uncertainty validation uncertainty is calculated by adding the involved data uncertainty so with validation uncertainty u v error e and the required level of validation uncertainty u r e q d six possible scenarios can be observed 1 e u v u r e q d 2 e u r e q d u v 3 u r e q d e u v 4 u v e u r e q d 5 u v u r e q d e 6 u r e q d u v e for cases 1 2 and 3 e u v so validation is achieved at u v level in the case of 4 5 and 6 u v e so the comparison error is above the noise level and validation could not be achieved for 4 though validation is achieved from a programmatic perspective 3 uncertainty in openfoam in the case of openfoam like any other cfd solver the numerical uncertainty may be defined as a summation of iterative grid size and time step uncertainty however since most of the ship simulation are recorded in the steady state the solver in general is independent of iterative convergence for grid convergence study the grids were refined with a refinement ratio of 2 and the uncertainty in error prediction was determined as for time step dependence the refinement ratio was kept at around 2 in this paper grid and time step uncertainty analysis are presented for four different hulls following richardson extrapolation the uncorrected simulation or factor of safety based approach celik et al 2008 and corrected simulation based approach stern et al 2001 since all the performed simulations were stable iterative uncertainty was ignored wilson et al 2001 3 1 solver structure openfoam is an open source library that numerically solves a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it contains an extensive range of solvers to perform different types of cfd simulations the solver has several packages to perform multiphase turbulent flow simulation for floating objects the solver has been elaborately described by jasak 2009 the module used to perform ship hydrodynamic simulations in openfoam simulates incompressible two phase flow the governing equation is based on continuity and reynolds averaged navier stokes equation the volume of fluid vof method is used to model fluid as one continuum of mixed properties finite volume method fvm is used to discretize the governing equations pressure velocity coupling is obtained through pimple algorithm openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference for the present paper the sst k ω model was used 3 1 1 turbulence parameters turbulence was modelled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated following the most common guidelines that were also used in labanti et al 2016 as follows 18 i 0 16 r 1 8 19 k m 2 s 2 3 2 u i 2 20 δ m l r 21 l m 0 4 δ 22 c μ 0 09 23 ω 1 s k c μ 1 4 l 24 ν t m 2 s 3 2 u i l where i is the turbulence intensity k is the turbulent kinetic energy per unit mass δ is the height of the boundary layer l is the turbulence length scale cμ is an empirical constant ω is the turbulence specific dissipation rate and ν t is the turbulent kinetic eddy viscosity the density and the kinematic viscosity of the fluids used in simulations are reported in table 1 3 1 2 boundary conditions the control volume represents a deep water condition so the two lateral sides and the bottom are symmetry plane type faces no additional information is required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions are as shown in table 2 3 2 ship models four different ship hulls kcs dtc kvlcc2 and jbc were simulated to investigate the uncertainty in openfoam for calm water simulation the models are quite popular among researchers and have been discussed widely in different workshops larsson et al 2011 gothenburg 2010 tokyo 2015 and simman 2008 2014 conferences and eu funded projects 3 2 1 kcs model the kriso container ship kcs is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose tokyo 2015 fig 1 shows the body plan of the kcs model and the ship specifications are provided in table 3 3 2 2 dtc dtc is a container ship model with a bulbous bow large bow flare and a transom stern with a large overhang el moctar et al 2012 it is a single screw vessel with a propeller and a rudder the ship is also equipped with a bilge keel comprised of five segments per ship side however for simulation only the bare hull was considered main particulars of the ship are mentioned in table 4 and the ship s body plan is shown in fig 2 3 2 3 kvlcc2 the kriso very large crude carrier 2 kvlcc2 is a large oil tanker model developed solely for research purpose and was first introduced to researchers in simman 2008 larsson et al 2011 table 5 provides the specifications of the kvlcc2 model and fig 3 shows its side view and body planes all the simulations have been performed in non dimensional scale 3 2 4 jbc the japan bulk carrier jbc is a capesize bulk carrier jointly introduced by national maritime research institute nmri yokohama national university and shipbuilding research centre of japan src for the tokyo 2015 workshop see fig 4 table 6 provides specifications of the jbc model and 4 shows its profile view and body plan the surface panels on the profile view have been generated using post processing from the computational mesh 3 3 meshing the domain size blockmesh for simulations was set mostly following ittc 2011 guidelines the inlet was placed two ship length windward the bow the outlet four ship length downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which creates a body fitted hexahedral mesh around the hull surface from the specified stl file the domain area near the free surface and hull form was refined multiple times using toposet and refinement then snappyhexmesh was applied some refinement was also performed through snappyhexmesh due to different hull shape and model size different mesh resolutions were used for the four different cases however the similarity was maintained in the mesh topology detail regarding mesh is provided in the results section the general mesh assembly used for the simulations is shown in fig 5 3 4 computational resource the simulations were performed in a single node intel r core i7 cpu with 8 cores clock speed of 2 27 ghz and 8 gb of physical memory the average time step used was 0 02 s and for simulating each case with stable output the required physical time was about 15 48 h per case all the simulations were run up to 100 s simulation time for attaining stable results 4 results calm water resistance prediction is the estimation of drag force for a ship while moving forward in the calm water ship s drag resistance is a summation of frictional resistance and pressure resistance frictional resistance arises from the hull surface friction and pressure resistance is mainly the wave making resistance encountered by ship during its forward motion when the ship moves forward the bow creates waves on the free surface thus energy is transferred from ship to free surface and this loss is termed as wave making resistance the flow separation occurs at the stern section where the turbulence is mainly observed thus higher resolution at the bow and stern sections and also at the free surface near these sections are essential to attain a good prediction as for free surface mesh distribution the emphasis is on capturing the boundary layer near the hull surface however openfoam uses a wall function to capture the effects of the boundary layer thus a y value of 30 and above is maintained for performing the uncertainty analysis three different mesh resolutions and three time steps were used for each model uncertainty was analysed for total drag coefficient sinkage and trim prediction all simulations were performed using interdymfoam solver of openfoam with dynamic meshing and heave and pitch free motion the numerical uncertainty was initially determined based on the safety factor fs based model proposed by celik et al 2008 accordingly convergence order of accuracy p and grid convergence index gci were determined for all the cases p value was calculated following equation 7a as proposed by celik et al 2008 not following the equation 7 as recommended in ittc guidelines this was done because the ittc recommended equation for p only allows calculation for an order of accuracy for monotonous convergence thus it would not be possible to calculate the corrected uncertainty for all the cases using equation 7 furthermore the p value gained using equation 7a is more conservative compared to equation 7 after that following the ittc guidelines 2008 corrected uncertainty was estimated for both factor of safety fs and correction factor ci based approach for the fs method corrected uncertainty was estimated for all cases monotonous oscillatory and divergent simply by applying equation 13 with fs value of 1 25 as for ci method corrected uncertainty was predicted using equation 17 for monotonous cases the theoretical order of accuracy was assumed to be 2 as most of the discretization schemes used in openfoam are of 2nd order for oscillatory cases an error band was calculated by taking an average of max and min simulation values as for divergent cases corrected uncertainty is not estimated ne as for systematic validation approach the study only calculated the corrected numerical uncertainty however related data uncertainty was not available for any of the cases thus proper validation study could not be performed nevertheless if the error level is below the corrected numerical uncertainty naturally validation is achieved so only the simulation results that have error level below the numerical noise level were claimed to be validated in the following cases 4 1 kcs model to investigate the uncertainty in calm water simulation for kcs model a 7 27 m model ship was simulated the simulations were performed with free heave and pitch motion and all other motions were restricted three different mesh resolutions were used for simulation in each case mesh number was revised in x y and z direction in blockmeshdict maintaining a rough ratio of 2 simulations were performed with mesh resolutions of 5 57 million fine 2 4 million mid and 1 08 million coarse for froude numbers of 0 26 and 0 195 all simulations were full hull simulations the uncertainty analysis performed for kcs model in openfoam based on the mesh dependency is shown in detail in table 7 as can be seen from table 7 for froude number 0 26 both resistance and sinkage results show monotonous convergence whereas trim shows oscillatory convergence however in the case of froude number 0 195 the resistance data shows divergence sinkage shows oscillatory and trim shows monotonous convergence the divergence is observed for resistance prediction since simulation result significantly improves with mesh resolution exceeding 2 million in the case of sinkage and trim the actual scale deviation is small and very high grid resolution in the z axis is required to capture the variations properly which was avoided in the presented simulations next corrected uncertainty was estimated for both factor of safety fs and correction factor ci based approach as shown in table 8 as can be seen from the table the correction factor based approach provides a wider range of uncertainty for the same results comparing to the factor of safety based approach in order to further illustrate mesh dependency in openfoam pressure distribution on free surface and hull form is shown in fig 6 as can be seen from the figure with higher mesh resolution pressure distribution on free surface is revealed with better detail next time dependent uncertainty was estimated three different simulations were performed with a mesh resolution of 2 4 million and time step size 0 02s 0 03s and 0 04s the analysis is shown in table 9 the results only show oscillatory convergence and divergence indicating that the lowest time step used for the study might have been too coarse also the refinement ratio was higher for 1st and 2nd step comparing to 2nd and 3rd step this was done to have a comparison range which is both economical and that easily converges although the results are not favourable here the simulations provided data for continuing the analysis and showed limitations regarding selecting time steps depending on flow field velocity next corrected uncertainty was estimated for both fs and ci based methods as shown in table 10 finally the total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 11 in order to validate the simulation predictions results were compared with experimental data provided by gothenburg university in tokyo 2015 workshop the comparison is shown only for the fine mesh in table 12 as can be seen from the comparison even with a mesh resolution of 5 5 million the solver fails to predict the resistance with reasonable accuracy this may be contributed to insufficient mesh distribution at some mesh sensitive areas thus although results show improvement with increasing mesh resolution the improvement is limited as for sinkage and trim results the real scale deviation with experimental data is quite small the results should improve with the application of higher mesh resolution in the z direction further investigation may be needed in this case for a better understanding of mesh dependency however this deviation doesn t affect the uncertainty study following a systematic validation approach for all the cases except the drag resistance at fr 0 195 the error level is higher than the corrected total numerical uncertainty table 11 so comparison error is above the noise level in the numerical process for all cases and only resistance prediction at fr 0 195 is validated however the corrected uncertainty here only includes numerical uncertainty not data uncertainty thus performing proper comparison and reaching conclusion is not possible at present 4 2 dtc model to investigate the calm water simulation uncertainty for dtc model a 5 976 m model ship was simulated with free heave and pitch motion and all other motions restricted three mesh resolutions were used with gradual mesh refinement in x y and z direction in blockmeshdict maintaining a ratio of 2 however just for the dtc hull case only half hull was simulated the simulation follows the dtc tutorial available in openfoam so that it is easier for other researchers to reproduce the results if interested simulations were performed with mesh resolutions of 1 4 million fine 0 576 million mid and 0 247 million coarse for froude numbers of 0 218 and 0 200 the uncertainty analysis performed for the dtc model in openfoam based on the mesh dependency is shown in table 13 as can be seen from the table for both the froude numbers the analysis shows monotonous convergence for resistance and sinkage prediction in the case of trim the higher froude number shows divergence while the lower one shows monotonous convergence the divergence in this case is observed due to lack of minimum required resolution in z axis for capturing the minute trim movement at the coarse grid the order of accuracy for all the predictions are also acceptable next corrected uncertainty was estimated as shown in table 14 to further illustrate the impact of mesh resolution on simulation fig 7 shows pressure distribution on the free surface for the simulations using three different mesh resolution the time dependent uncertainty was estimated by simulating the dtc model with a mesh resolution of 1 4 million and time step size 0 01s 0 02s and 0 04s the analysis is shown in table 15 the results show divergence for resistance prediction at fr 0 2 and convergence for the rest next corrected uncertainty was estimated for both fs and ci based methods as shown in table 16 finally the total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 17 to validate the simulations results were compared with experimental data provided by el moctar et al 2012 however only resistance data were available for comparison not motion data the comparison is shown in table 18 as can be seen from the table the simulation results show good agreement with experimental data and deviation is limited to 3 7 the deviation increases with reduction in ship speed this happens because with decreasing speed the amplitude of pressure force decreases and it becomes more difficult for cfd to capture the forces accurately following a systematic validation approach validation could not be achieved for either the cases since the discrepancy between efd and cfd is higher comparing to the estimated cfd uncertainty 4 3 kvlcc2 model a 7 m kvlcc2 model was used for the simulations with three different mesh resolutions of 3 54 1 88 and 0 9 million the full hull model was simulated with a heave and pitch free motion for froude number 0 1194 and 0 1423 the design speed of kvlcc2 is at fr 0 1423 the uncertainty analysis for the kvlcc2 model based on mesh dependency is shown in table 19 the analysis shows both monotonous and oscillatory convergence however no divergence is observed the calculated order of accuracies are also high and gci has low values next corrected uncertainty was estimated as shown in table 20 the time dependent uncertainty was estimated by simulating the kvlcc2 model with a mesh resolution of 3 54 million and time step size 0 02s 0 03s and 0 04s the analysis is shown in table 21 the analysis shows poor convergence with just one oscillatory convergence and rest to be divergent the calculated order of accuracies are also high comparing to the limiting theoretical value and gci is of low values as observed before for kcs case similarly the coarse time step used for the simulations here was most probably not suitable and thus gave a poor convergence apart from influencing simulation results time step size also influences the stability convergence of results as time step size increases higher oscillation is observed in the time history of the results this is demonstrated by fig 8 where time history for force prediction is shown for three different time steps the simulations were re started at 90 s thus the initial high amplitude is observed in the figures after gci calculation corrected uncertainty was estimated for both fs and ci based methods as shown in table 22 and finally total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 23 unfortunately due to many diverged cases in the time step uncertainty analysis total uncertainty could be calculated just for one case following the correction factor based approach for validation results were compared with experimental data provided by the gothenburg university in gothenburg 2010 workshop larsson et al 2011 the comparison is shown only for the fine mesh in table 24 the resistance and trim results show very good agreement with experimental data however for the sinkage cases the deviation is significantly large however the sinkage trend is well followed by cfd besides the actual deviation is in the millimetre scale which is very small furthermore the difference may also come from different assumption for the vertical centre of gravity in case of efd and cfd thus it may be assumed that overall the results are well predicted here for resistance and trim prediction validation is achieved for the second froude cases following the ci method as the predicted uncertainty is higher than the deviation observed with experimental data 4 4 jbc model for the japan bulk carrier jbc a 7 m model was simulated with mesh resolution of 3 77 million 1 88 million and 0 88 million following the previous case simulations were run for froude number 0 1423 and 0 1194 jbc and kvlcc2 have very similar hull forms and design speed all simulations for jbc was performed with a heave and pitch free motion since both kvlcc2 and jbc hull form have similar hull form and they share same model size the mesh resolution used for the two cases is quite similar the uncertainty analysis for the jbc model based on mesh dependency is shown in table 25 the uncertainty analysis in this case shows both convergence and divergence the resistance prediction shows monotonous convergence the sinkage shows oscillatory convergence and one trim prediction shows divergence however in resistance prediction cases the difference in predicted results for different mesh resolution is relatively high as a result the order of accuracy is low and gci is high this might be because of the insufficient mesh resolution near the hull surface because of its blunt bow and low design speed it is relatively difficult to properly capture the flow field without sufficiently high resolution the latter two mesh resolutions might not have been enough to capture the flow features properly near bow and stern thus larger deviation is observed the corrected uncertainty estimate for mesh resolution for jbc is shown in table 26 to further illustrate the results hydrodynamic pressure distribution on zero water level and hull surface are shown in fig 9 the figure shows how the detail in pressure distribution varies with mesh resolution the figure shows how the pressure capturing around the free surface and the hull improves with improving mesh resolution the time dependent uncertainty was estimated by simulating the jbc model with a mesh resolution of 3 77 million and time step size 0 01s 0 02s and 0 04s the analysis is shown in table 27 as can be seen from the analysis the results show both monotonous and oscillatory convergence and one case of divergence the order of accuracy is relatively low as mentioned before because of the low froude number the pressure variation near hull form is small and relatively large time step simply fail to capture it properly next corrected uncertainty was estimated for both fs and ci based methods as shown in table 28 and finally total corrected uncertainty is calculated by combining both the grid and time uncertainty as shown in table 29 since there were several divergent cases in grid and time dependency study total uncertainty could not be determined for two cases overall for the jbc model total uncertainty is quite high for resistance prediction at lower froude number next for the validation study the results were compared with the experimental data provided by nmri in the tokyo 2015 workshop however data were available only for froude number 0 1423 the comparison is shown in table 30 the simulation results show very good agreement with experimental data for resistance and trim data however the sinkage data is significantly out of order according to the experimental data provided in tokyo 2015 workshop website the actual sinkage value for a 7 m model should be 0 6 mm which is too small thus the applied mesh resolution most probably was not enough to capture such minute value properly with improved mesh resolution in the z direction and applying the same vertical centre of gravity as the experiment when available the results should improve it was not attempted for present cases considering the high resource requirement involved here validation is achieved for resistance prediction for ci based approach and for trim following the fs based approach 4 5 grid independence with higher mesh resolution as discussed in the theoretical section of uncertainty assessment verification and validation studies are essentially case specific which is clearly demonstrated in the study of the four ship models used for the present study although similar mesh resolutions were used for the studies the degree of agreement with experimental data for each case varied significantly the variation may be mainly contributed to the difference in froude number for different ship models which results in a different y value for each case nevertheless it is widely proposed by different research groups that if sufficiently high mesh resolution is applied the results become grid independent to assess the belief simulations were performed with around 10 million cells for a container kcs and bulk carrier jbc for two different froude numbers maintaining similar mesh topology for both models the domain size of the meshes was kept the same as shown in previous cases and the mesh resolution was improved by increasing number of sections in x y and z direction in blockmesh all simulations were performed with a heave and pitch free motion the required simulation time for these cases was about 96 h for each case the comparison results are shown in tables 31 and 32 as can be seen from the results for the kcs case the higher resolution has improved the resistance prediction however accuracy in sinkage and trim prediction is still significantly low as for the jbc case the deviation with experimental data slightly increased with higher mesh resolution overall the validation level for the two models is significantly different from each other thus as observed even a mesh resolution of 10 million cells is not enough to attain a grid independent solution for two different ship models 5 conclusion in the paper a systematic verification and validation study was attempted for ship simulation for the open source cfd toolkit openfoam initially a brief literature review on verification and validation study is provided together with the ittc recommended procedure for the study next four different ship models were simulated to investigate their grid and time step dependence for resistance sinkage and trim prediction in calm water a systematic verification study was performed with the results using the two most popular uncertainty models and total corrected uncertainty was estimated four different hull forms two container ship models kcs dtc a crude carrier kvlcc2 and a bulk carrier jbc were simulated in calm water condition and total drag coefficient sinkage and trim were predicted from the results to perform the uncertainty study three different mesh resolution and three time steps were used for each case uncertainty for the cases was estimated using both safety factor fs and correction factor ci based approach the analysis showed a significant difference between the total predicted uncertainties for the two methods in almost all cases fs based approach predicted a lower level of uncertainty comparing ci based method furthermore although similar mesh topology was used all four simulations showed different results from each other both for verification and validation study the results show that despite having geometric similarities mesh dependency for each hull form is different from the other even with the application of significantly high mesh resolution 10 million cells container model and bulk carrier model do not show a similar level of agreement with experimental data overall it may be concluded from the study that the safety factor and correction factor based approach differ significantly from each other in uncertainty prediction furthermore it is not just a validation study that is case specific verification study is case specific as well acknowledgements this work was performed within the project shopera energy efficient safe ship operation which was partially funded by the eu fp7 under contract 605221 
22432,this work presents experimental and numerical investigations on the nonlinear interaction coalescence collapse and rebound of two pulsating bubbles which are generated by underwater explosions 2 5 g petn for each the transient physical phenomena are captured by a high speed camera and the near field pressure signals measured by pressure sensors the boundary integral simulations gain further insight into the high speed liquid jet formation jet impact splash fragmentation and the associated flow field characteristics particularly the numerical simulation reproduces the multiple splits of the coalesced bubble which partly reveals the mechanism of the bubble cloud formation these sub bubbles collapse with different velocities and reach their minimum volumes at different times leading to the emission of multiple bubble pulse pressures shock waves at the final collapse phase interestingly we find that the last pressure peak is the largest one for non axisymmetric configurations which is attributed to the asymmetric collapse of the coalesced bubble about the centerline of the two bubbles at inception more specifically the lower bubble segments collapse earlier and generate large pressure waves which further drives the remaining part of the bubble to collapse more violently we also make quantitative comparisons of the pressure impulse between different configurations keywords bubble dynamics bubble coalescence underwater explosion shock waves boundary integral method 1 introduction bubble dynamics is an important study field for its crucial role in ocean engineering and many other applications the imbalance between the pressure of the bubble gas laplace pressure and ambient hydrostatic pressure leads to bubble oscillation which is one of the key physics in underwater explosion klaseboer et al 2005a brett and krelle 2018 wang et al 2018 cavitation brennen 1995 ji et al 2014 supponen et al 2018 saleki haselghoubi and dadvand 2018 ultrasonic cleaning reuter and mettin 2016 geophysical exploration de graaf et al 2014 shock wave lithotripsy lingeman et al 2009 high intensity focused ultrasound yuan et al 2015 sonoporation ohl et al 2006 etc although the bubble size scale in the forementioned applications ranges from micrometers to meters some essential physics show striking similarities including expansion collapse jetting shock wave emission etc hence studies on different types of bubbles can mutually stimulate each other gong et al 2010 supponen et al 2016 the bubble gas is highly compressed during the violent collapse phase leading to a strong energy focusing it is well known that a spherical collapse of the bubble leads to the strongest shock wave pressure wave emission the dynamics of a spherical oscillating bubble is described by the celebrated rayleigh plesset equation lord rayleigh 1917 plesset and calif 1949 however a bubble near boundaries or in external force fields cannot keep a spherical shape understanding and predicting the collapse pattern of nonspherical bubbles and the associated shock waves are crucial to the foregoing applications single bubble dynamics near different boundaries for example rigid wall lauterborn et al 2018 li et al 2016b free surface wang et al 1996 movable rigid structure li et al 2018a elastic structure li et al 2018c jin et al 2018 etc have been extensively investigated before the high speed liquid jet is one of the most important features of non spherical bubbles the jet impact is another cause of damage to nearby structures or a beneficial tool in cleaning reuter and mettin 2016 and sonoporation ohl et al 2006 additionally the liquid jet may occupy a large amount of kinetic energy which weakens the strength of bubble collapses cui et al 2016b supponen et al 2017 presented detailed observations on the shock waves generated by nonspherical cavitation bubbles they found that the multiple shocks are related to different processes including jet penetration and collapses of distinct bubble segments nevertheless the characteristics of the shock waves generated by two or multiple bubbles are far from well understood multiple bubbles or a bubble cluster is more often encountered in practical applications and real life one bubble changes the ambient pressure field for a neighboring bubble and vice versa hence the bubble bubble interaction also has a significant influence on bubble collapse pattern during the collapse of two identical cavitation bubbles in an infinite field two axial jets form from the far ends of the two bubble system and are directed towards each other han et al 2015a cui et al 2016a the two bubble dynamics is dependent on the separation distance phase difference size ratio and boundary conditions chew et al 2011 han et al 2015a 2018 fong et al 2009 bremond et al 2006a tomita and sato 2017 han et al 2015b 2019a luo and niu 2019 peng et al 2019 three typical phenomena are observed in previous experimental studies namely jet toward each other jet away and coalescence chew et al 2011 fong et al 2009 recently the anti phase bubbles were used to produce a fast thin jet which is a promising tool in micropumping and opto injection han et al 2015a much attention has been paid to bubble motion in previous studies however the associated shock wave emission is less concerned with due to the complexity of two bubble interactions this study is limited to the coalescence collapse and rebound of two underwater explosion bubbles and the associated shock wave emission there are only a few experimental studies on the dynamics of a coalesced bubble fong et al 2009 presented experimental observations on the coalescence of two spark bubbles clearer experimental images can be found in cui et al 2016a and han et al 2016 2018 these experiments suggested that two liquid jets are formed during the collapse phase and impact in the center of the coalesced bubble thereafter the coalesced bubble splits into many smaller ones and presents as a bubble cloud during the rebound phase han et al 2018 argued that the pressure generated by a coalesced bubble is weakened because the bubble energy is disintegrated in the present study two identical explosives 2 5 g petn for each are used to generate two identical bubbles in a water tank different arrangements of the two bubbles vertical horizontal and oblique are tested with almost the same separation distance 0 2 0 21 m in which simultaneous high speed photography and pressure sensor measurement are used to explore the dynamics of coalesced bubbles before the impact of the two jets the overall dynamics of the coalesced bubble changes little for different arrangements however the pressure signals are strikingly different quantitative comparisons of the near field pressure signal bubble induced shock waves are made between two bubble experiments and a single bubble experiment apart from the experiments the boundary integral simulations han et al 2016 2018 li et al 2016b zhang et al 2015 han et al 2019b are also carried out to gain more insights into the collapse pattern of coalesced bubbles rungsiyaphornrat et al 2003 first simulated the coalescence of two underwater explosion bubbles using axisymmetric boundary integral method bim han et al 2016 established a 3d model to simulate bubble coalescence in a free field in both studies the simulations stopped before the toroidal bubble stage in this study an improved vortex ring model zhang et al 2015 li et al 2016b is introduced to simulate the toroidal bubble motion a multiple vortex ring model zhang et al 2015 is used to simulate the splitting of a toroidal bubble the numerical simulations partly elucidate the complex collapse pattern and fragmentation of the coalesced bubble this paper is organized as follows the experimental setup and numerical setup are given in sections 2 and 3 respectively in section 4 1 a single bubble experiment is discussed and the measured data are used to determine the initial conditions for numerical simulations in section 4 2 4 5 we discuss the physics in the two bubble experiments with different configurations at last we summarize this study and draw the conclusions in section 5 2 experimental setup the present experimental setup is similar to that in cui et al 2016b and some basic equipment and the experimental procedure can be found therein every bubble in our experiments is generated by an underwater explosion of 2 5 0 01 g petn pentaerythritol tetranitrate in a 2 2 2 m 3 water tank the synchronized detonations of two explosives are accurately controlled by an electric detonator different configurations of the two explosives are investigated namely axisymmetric horizontal and oblique configurations in the single bubble experiment the maximum bubble radius r m reaches 0 23 m when the detonation takes place at the water depth of 0 99 m and the atmospheric pressure 0 98 bar the distances between the explosive and boundaries tank walls and free surface are more than 4 r m as suggested by a universal estimation in obreschkow et al 2011 the effects of the tank walls on non spherical bubble dynamics are negligible when compared to the gravity and bubble bubble interactions the transient processes of our experiments are recorded by a high speed camera phantom v711 at an acquisition rate of 7500 hz with generated images of 1280 800 pixels the spatial resolution is around 0 7 mm per pixel the uncertainty for length measurement since the tank walls are stiffened plates made of steel an acrylic window on the front wall is installed for photography the back illumination cannot be applied to the present setup hence the experiments are conducted outdoors to achieve clearer images under the strong sunlight with white painted inner tank walls to enhance the brightness the exposure time is also set as large as possible 130 μ s and the bubble boundary is slightly blurred in previous studies pressure sensors were often placed relatively far from the bubble surface to measure the far field pressure while the near field pressure of underwater explosion bubbles was rarely concerned with in this paper we aim to study the near field pressure in different directions of a coalesced bubble pressures sensors pcb 138a are installed on a thin tight rope and placed very close r m to the explosive the diameter of the rope is around 2 mm which has a negligible effect on bubble dynamics the diameter of the pressure sensor is 9 6 mm and the length 193 mm as suggested by li et al 2018a the overall bubble dynamics is hardly affected by a nearby suspended object if the size ratio is smaller than 0 1 the signals from the pressure sensors are recorded by an oscilloscope tektronix dpo7104c working at 5 million samples per second the nominal range of the pcb 138a sensor reaches 344 mpa and the rise time is 1 5 μ s since the bubble migrates upward under the buoyancy effects the most dangerous position should be above the bubble top hence the pressure sensor is placed above the explosive in most of our experiments 3 numerical setup consider a two bubble system in three dimensional configuration as shown in fig 1 a cartesian coordinate system x y z is defined with the origin o located at the initial center of the upper bubble or left bubble referred to as bubble 1 and z axis pointing upward for simulation of the dynamic behaviors of the bubbles an axisymmetric as well as a 3 d bim model are used as described in blake and gibson 1987 wang et al 1996 rungsiyaphornrat et al 2003 zhang et al 2015 han et al 2016 and li et al 2018d 2019 since the shock wave induced by the detonation of explosive is short lived and propagates quickly the flow field surrounding bubbles is approximated to be incompressible inviscid and irrotational as a result the velocity in the flow can be described by the gradient of a potential φ 1 v φ which satisfies the laplace equation and the boundary integral equation 2 2 φ 0 3 θ φ g φ n φ g n d s where θ is the solid angle s is the flow boundary g is the green function and n is the outward normal of s as the potential distribution on the bubble surface is obatined in each time step the normal velocity on the bubble surface can be calculated by solving eq 3 wang et al 1996 wang 1998 a finite difference method is adopted to calculate the velocity in the tangential direction zhang et al 2001 the position of the bubble surface and the potential on it are updated by the kinematic boundary condition and dynamic boundary condition respectively given by 4 d r d t φ 5 d φ d t 1 2 φ 2 p p b ρ g z where p b is the bubble surface pressure ρ is the liquid density surrounding the bubble g is the gravitational acceleration and p p atm ρ g h is the ambient hydrostatic pressure as demonstrated by navier stokes simulations li et al 2018b han et al 2015a lauterborn et al 2018 the pressure field inside the bubble is uniform despite the velocity field is highly non uniform distributed besides the adiabatic law has been confirmed to be a good approach to describe the bubble gas pressure during the transient oscillation of underwater explosion bubbles rungsiyaphornrat et al 2003 klaseboer et al 2005a zhang et al 2017 written as 6 p b p 0 v 0 v κ where κ is the gas specific heat ratio p 0 and v 0 are the initial bubble pressure and volume respectively and v is the bubble volume for a large scale underwater explosion bubble the gravity induced pressure gradient drives an upward liquid jet at the collapse stage of the bubble cui et al 2016b klaseboer et al 2005a b after the jet penetration the single connected flow domain becomes double connected and the bubble becomes toroidal the conventional bim cannot be directly applied to the subsequent simulation of a toroidal bubble hence an improved vortex ring model zhang et al 2015 li et al 2017 is used to deal with the discontinuous distribution of the velocity potential on the toroidal bubble surface a vortex ring is placed inside the toroidal bubble and the circulation γ is set as the potential jump at the jet impact location 7 γ φ n φ 1 where the subscripts 1 and n denote the first and last node on the bubble surface before the jet penetration the total velocity and potential on the toroidal bubble surface are decomposed into two parts i e 8 φ φ r φ v v v r v v where φ v and v v are the potential and velocity induced by the vortex ring and φ r and v v are the remnant potential and the remnant velocity moreover the toroidal bubble is also likely to split under some circumstances zhang et al 2015 li et al 2016a leading to the formation of two or more sub bubbles the multiple vortex ring model zhang et al 2015 is adopted here to investigate the coupling of two toroidal bubbles the decomposition of the potential and velocity can be rewritten as 9 φ φ r φ v1 φ v2 v v r v v1 v v2 where the subscripts v 1 and v 2 denote the first vortex ring and the second vortex ring respectively the velocity induced by a vortex ring can be analytically calculated from the biot savart law wang et al 2005 zhang et al 2015 the remnant velocity is calculated by bim directly a semi analytical method zhang et al 2015 is adopted to calculate the potential induced by a vortex ring given by the following formulas in the cylindrical coordinate system o r θ z 10 φ v p γ 4 π c r z r 1 e z r r 2 d q r r p q r r 0 r z 11 φ v p γ 4 π c r z r 1 e z r r 2 d q r r p q r r 0 r z where q is a integration point on the vortex ring and e z is taken as 0 0 1 eqs 10 and 11 are used when the node p is above and below the vortex ring plane respectively in the toroidal bubble stage the dynamic boundary condition eq 5 is rewritten as 12 d φ r d t φ r v r v v 1 2 v r v v 2 p p b ρ g z the details about the foregoing models refer to zhang et al 2015 at last the pressure field and velocity field are calculated using an auxiliary function method li et al 2016b 4 results and discussion 4 1 single bubble dynamics an experiment on single bubble dynamics in the free field is carried out first in which the explosive 2 5 g petn is placed at the water depth of 0 99 m this experiment provides a reference for the following two bubble experiments selected images of the experiment are shown in fig 2 soon after detonation frame 1 the shock wave emission and the subsequent reflections as tension waves cause very pronounced cavitation in the water bulk frame 2 which almost disappears around t 3 47 ms frame 3 the bubble holds high sphericity during the subsequent expansion phase frames 4 6 during the collapse stage non spherical features of the bubble emerge due to the gravity effect specifically the bubble bottom collapses faster than the upper part and becomes flattened gradually frames 8 11 finally a high speed liquid jet shoots upward in the final collapse phase of the bubble frame 12 the jetting behavior of a bubble has been investigated in great detail in previous literature cui et al 2016b klaseboer et al 2005a li et al 2018b frames 13 23 cover the second cycle of the bubble at the beginning of the rebound a shock wave is emitted and reflected at the free surface the rarefaction wave which causes very evident cavitation frames 13 14 due to the high speed jet penetration the bubble is elongated in the vertical direction and the bubble assumes a pear shape during the rebounding process frames 15 18 the bubble shape is not spherical during the whole rebounding phase which leads to a different collapse pattern as the bubble surface at the top owns the maximum curvature in frame 19 it collapses faster during the early recollapse phase frame 20 lord rayleigh 1917 lauterborn 1982 thereafter a bump forms at the bottom of the bubble see the blue dashed rectangles in frames 20 21 supponen et al 2016 also found this phenomenon in their cavitation bubble experiments they attributed the bump formation to the break up of the liquid jet within the toroidal bubble after which the remainder of the jet is pulled back by surface tension however the surface tension plays a minor role in our experiment since the associated weber number is much larger than 1 therefore we will try to reveal the mechanism by using boundary integral simulation in later discussions presumably two axial jets form from the bubble top and bottom respectively frame 23 during the third cycle frame 24 the rough bubble surface may be caused by the strong splashing during the impact of the two axial jets han et al 2018 the above experiment is used to determine the initial bubble parameters for the simulation a commonly used empirical relationship for the maximum bubble radius klaseboer et al 2005a is given by 13 r m α 1 w h h atm 1 3 where h atm denotes the water column height for the atmospheric pressure which is taken as 10 in the present study substituting the known parameters of this experiment r m 0 230 m w 2 5 1 0 3 kg yields the prefactor α 1 equals 3 77 this formula has been tested to be an accurate estimation for larger petn explosives cui et al 2016b zhang et al 2013 another empirical relationship for the initial bubble pressure klaseboer et al 2005a is given by 14 p 0 α 2 w v 0 κ where α 2 is the second parameter that needs to be determined the initial bubble radius r 0 is estimated by the rayleigh plesset equation lord rayleigh 1917 klaseboer et al 2005b as follows 15 p r 0 r m 3 1 p 0 κ 1 r 0 r m 3 κ r 0 r m 3 the three parameters r 0 p 0 and κ are not independent for a fixed r m as suggested by best 2002 and li et al 2016b κ mainly controls the bubble period and p 0 controls the bubble pulse pressure the experiment can be well reproduced by adjusting κ and p 0 in terms of the bubble period and the pressure field in the present study we set κ 1 6 and α 2 1 1 1 0 5 the value of κ is within the reasonable range for an underwater explosion bubble 1 25 κ 1 667 hung and hwangfu 2010 these parameters are different from those for tnt explosives klaseboer et al 2005a b which attributes to the difference in chemical components of petn fig 3 a shows the comparison of the bubble radius between boundary integral simulation solid line and the experimental data red triangles in this single bubble experiment the bubble keeps a spherical shape during most of the bubble life so the bubble radius can be obtained from each experimental image directly the relative error of the measured maximum bubble radius is about 0 3 after the bubble becomes non spherical we need to get the boundary of the bubble first and calculate the equivalent radius of the bubble excellent agreement is found for the first cycle of the bubble fig 3 b shows the comparison of pressure signals the pressure sensor captures the shock wave and the bubble pulse pressure our numerical simulation starts with a tiny high pressure bubble thus the initial high amplitude shock wave is beyond the capacity of bim however the bubble pulse is extremely well reproduced by the present model except for a little difference in time it is worth noting that the pressure sensor moves during the bubble oscillation for it is difficult to control the sensor at a fixed position due to the large pressure load in the computation of the pressure signal the location of the field point is interpolated from the experimental data in fact during most of the bubble lifetime the magnitude of the pressure signal is relatively small the bubble pulse pressure around the minimum bubble volume moment is within quite a short time when the distance between the sensor and the bubble top is around 0 146 m at the rebounding stage the bubble migrates upward rapidly and approaches the sensor directly as shown in frame 14 of fig 2 however no obvious pressure increase in the pressure signal is found at the same moment there are some reasons responsible for this counter intuitive phenomenon firstly the jet impact only affects a very localized region around the jet front as shown in fig 4 a thus it is difficult to capture the jet impact pressure accurately with the sensor secondly the high amplitude water hammer pressure brujan et al 2001 ρ c v where c is the sound speed in water and v is the jet impact velocity induced by the jet impact has a very short duration about δ t d 2 c where d is the diameter of the liquid jet in the present experiment the jet diameter predicted by the numerical simulation is around 17 5 mm thus obtaining δ t 5 8 μ s which is much smaller than the duration of the bubble pulse in fig 3 b up to date experimental studies on bubble jet impact pressure are rarely seen in published literature cui et al 2016b supponen et al 2017 cui et al 2018 and some numerical studies can be found in some references li et al 2016b zhang et al 2015 hsiao et al 2014 at last we try to explain the formation of the bump at the bubble bottom during the second collapse phase frames 20 21 of fig 2 which is still not well understood although the energy loss due to the emission of the pressure wave is not considered in our bim code some features of the bubble during the second cycle are still well preserved fig 4 shows the pressure and velocity fields surrounding the rebounding bubble at two moments as shown in panel a the pear shaped bubble in the experiment is well reproduced the liquid surrounding the rebounding bubble is generally pushed outward there exists a stagnation point in the liquid jet above which the velocity is directed upward and below which the velocity is directed downward thus the jet width inside the bubble decreases and the toroidal bubble tends to rejoin in the numerical simulation we perform a surgery cut of the thin jet when the minimum radius of the liquid jet is smaller than the local mesh size δ s wang 2013 lee et al 2007 the region with the radius of the liquid jet less than 2 5 δ s is regarded as the rejoin area then the toroidal bubble transforms into a singly connected bubble again the total velocity potential on the surface of the bubble remains the same as that before the surgery cut more details about this numerical treatment can be found in lee et al 2007 and wang 2013 after the rejoin the lower part of the original jet keeps thinning and the liquid therein is gradually squeezed out by the expanding bubble surface as shown in panel b as expected the bubble bottom would be pulled down due to inertia no surface tension here which may be responsible for the formation of the bump at the bubble bottom lim et al 2010 experimentally and numerically studied the dynamics of an initially v shaped bubble they found that the hollow part of the v shape overshot and became a bulge during the expansion see figs 6 7 therein which is similar to our observation 4 2 two bubble dynamics in axisymmetric configuration in the second experiment two explosives are arranged in a vertical line with different water depths 0 9 m and 1 1 m respectively fig 5 gives selected images of the experiment and each sequence during the first bubble cycle is overlaid with the simulation results denoted by red dashed lines due to the small distance between two explosives the two bubbles quickly become non spherical after the detonations frames 1 3 as two bubbles approach each other a water film forms between them and the film thickness keeps decreasing bremond et al 2006a demonstrated that the film thinning between two micron size cavitation bubbles is inertia dominated for the present meter sized bubbles the viscous effect is believed to be negligible rungsiyaphornrat et al 2003 the film rupture cannot be observed in our experiment in every time step during the numerical simulation the minimum distance between the two bubbles surfaces s min is calculated as previously done in rungsiyaphornrat et al 2003 and han et al 2016 a numerical coalescence of bubbles is performed if s min 0 02 r m the elements on the thin film between two bubbles are deleted and the rest parts of the bubble surfaces are stitched together the convergence test of the 3d bim code has been performed for the two bubble coalescence in our previously published paper han et al 2016 the 3d results approach the axisymmetric results when the element number on one bubble surface is 5120 the corresponding node number is 2562 the coalesced bubble reaches its maximum volume in frame 6 and assumes a capsule shape at the collapse stage the velocities at the bubble bottom and top are higher than that around the equator this can be explained by the argument by vogel et al 1989 i e the locations of the bubble surface with higher curvature collapse faster an upward liquid jet forms from the bubble bottom followed by the formation of a downward jet from the bubble top frame 10 presumably the two jets would collide within the bubble and lead to a violent splashing however this phenomenon could not be observed in the experiment because the underwater explosion bubble is not transparent hence we conduct a numerical simulation to gain further insight into the high speed liquid jet formation and the subsequent splashing we find excellent agreement of bubble profiles between experiment and boundary integral simulation in the first cycle the development of jets can be clearly clarified and the impact point of two jets is slightly above the midplane of the coalesced bubble frame 11 subsequently the jet flow along the axis of symmetry is redirected radially outward splashing after the bubble reaches its minimum volume frame 12 the oscillation in the second cycle begins very different from a single bubble case the rebounding coalesced bubble undergoes quite an unstable process as suggested by the bubble cloud and rough bubble surface frames 13 16 in this process the bubble energy is disintegrated and the boundary integral simulation is used to reveal the underlying mechanisms as the annular jet develops the toroidal bubble finally splits into two parts in the present study we use the multiple vortex ring model zhang et al 2015 to simulate the subsequent motion of two toroidal bubbles fig 6 gives the numerical results in which the bubble profiles pressure contours and velocity fields are provided in panel a it is observed that the pressure inside the toroidal bubble the inner jet is relatively large due to the impact of the two jets meanwhile the impact of the annular jet causes an annular high pressure region which has a higher magnitude than the inner one thereafter the two toroidal bubbles collapse with different velocities in panel b it is noted that the lower bubble collapses faster than the upper bubble thus the gas pressure of the lower bubble is larger than that of the upper one consequently the pressure surrounding the lower bubble is much higher than that around the upper bubble additionally the lower toroidal bubble is about to further split presumably the upper bubble will also split subsequently hence our numerical simulation partly reveals the mechanism of bubble splitting and the formation of bubble cloud however it is believed that the bubble exhibits more splits as suggested by the formation of bubble cloud during the rebound phase frames 17 18 every bubble ring may break up into several parts around the minimum volume moment due to rayleigh taylor instabilities despite we have done the simulation of the first split of a toroidal bubble more splits are about to occur before the minimum volume of the bubble is reached therefore it is difficult for bim to obtain the pressure peaks in such a two bubble system more advanced numerical methods are worth developing in our future work back to frames 19 24 of fig 5 it seems that almost all the gaseous of the bubble merges into a single bubble again and an upward migration can be observed during the third cycle of the bubble using the proportional relation between the maximum bubble volume and bubble energy we can roughly estimate the bubble energy left after the second cycle is around 28 hence the damage potential of a bubble after the second collapse is often neglected in the underwater explosion study in the current experiment the second bubble pressure pulse emitted at the end of the second bubble cycle is much weaker than the first one fig 7 a shows the initial shock waves generated by the two detonations both sensors capture two individual pressure peaks due to different distances between the sensor and the explosives as marked in the figure a and b are the two pressure peaks captured by the upper sensor and c and d by the horizontal sensor the maximum shock wave pressure is over 20 mpa some tiny pressure peaks are also observed around e which are caused by the reflections of the shock waves on the tank walls fig 7 b shows the first bubble pulse pressure generated at the end of the first bubble cycle interestingly we find that the pressure profiles are quite different from that of the single bubble experiment as shown in fig 3 b in the following aspects firstly the occurrence time of the bubble pulse peak is about 16 later than that of the single bubble experiment this is because one bubble alters the surrounding pressure field for the other one bremond et al 2006a the bubble period increases as the distance between two bubbles decreases when the inner bubble distance becomes zero a limiting situation two bubbles become a single one from the beginning and the bubble period will increase by 26 the second and most important aspect is that distinctive multiple pressure peaks can be observed on the pressure profiles which confirms the foregoing discussion on bubble splitting before reaching the minimum volume the toroidal bubble splits into several parts which collapse with different velocities and reach their minimum volumes at different times consequently multiple bubble pulse pressures are emitted during the collapse phase of this coalesced bubble however almost all the pressure peaks are lower than that in the single bubble experiment except for a comparable sharp pressure peak marked as f this sharp pressure wave may be caused by the collapse of a small bubble in close vicinity to the horizontal sensor to make a quantitative comparison between the pressure profiles we define a modified pressure impulse as the integration of the pressure over time multiplied by the distance between the pressure sensor and the bubble center r tagawa et al 2016 given by 16 i r t 1 t 2 p d t the integration range t 1 t 2 is set where the pressure rises above 0 1 p max during the first collapse of the coalesced bubble where p max is the maximum pressure signal in fact the best choice of the minimum pressure in the integration range is zero however the pressure signals have some oscillation problems thus it is difficult to determine the integration range in addition the pressure wave below a critical value may have little threat to nearby structures if we set the minimum pressure as an absolute value for example 1 mpa the waveforms of the shock wave can be quite different when the measured distance varies instead we set the minimum pressure in the integration range as a relative value 0 1 p max thus the waveforms of the shock wave can be similar different from the definition in tagawa et al 2016 here the pressure integral is multiplied by r which eliminates the influence of the measured distance vogel and lauterborn 1988 brujan et al 2012 it is assumed that the pressure waves propagate through the water without any nonlinear dissipation for the two pressure profiles in fig 7 b we get the impulses as i upper 339 pa s m and i horizontal 334 pa s m surprisingly the two impulses are almost identical hence the directionality of the pressure wave induced by the coalesced bubble is not evident tagawa et al 2016 also found that the distribution of the pressure impulse of a laser cavitation bubble is spherically symmetric even when the distribution of the peak pressure is not spherically symmetric applying eq 16 to the initial shock wave yields i shock 307 pa s m which means the bubble induced impulse is higher than shock waves as for the single bubble experiment in section 4 1 we get the impulse as i single 2 5g 251 pa s m thus the impulse of the two bubble system is 1 34 times i single 2 5g as for a single bubble generated by 5 g petn we get the impulse from the numerical simulation as i single 5g 397 pa s m which is 1 58 times i single 2 5g clearly the collapse of each bubble in the two bubble system becomes less violent than that of a single bubble situation which results in a relatively weaker bubble pulse pressure the underlying mechanism can be explained from the point of view of energy the formulas for the kinetic energy e k and potential energy of the bubble e p are given below lee et al 2007 17 e k 1 2 ρ φ φ n d s 18 e p v p ρ g z c p b v κ 1 where z c is the depth of the bubble center for the single bubble experiment the percentage of the kinetic energy of the flow field at the jet impact moment is only 17 of the total energy obtained from numerical simulation more energy has been transferred into potential energy indicating a very high pressure of the bubble gas and a violent collapse however in the two bubble experiment two high speed liquid jets form and the associated kinetic energy reaches 80 which alters the subsequent bubble collapse pattern and shock wave emission as a consequence the collapse of the coalesced bubble is less violent than that in the scenario with a single bubble 4 3 two bubble dynamics in a horizontal configuration in the third experiment two explosives are arranged in a horizontal line at a depth of 1 0 m and the distance between the two explosives is 0 2 m selected images of the experiment are given in fig 8 during the first cycle of the bubble frames 1 12 the bubble shape is almost symmetric about the centerline of the two initial bubbles hereafter referred to as centerline and the migration cannot be clearly observed until the final collapse phase of the bubble frame 12 the dynamic behaviors of the two bubbles are quite similar to those in the previous experiment two jets originating from the two ends of the coalesced bubble shoot towards the middle of the bubble during the rebounding phase frames 13 18 the bubble turns into a bubble cloud a pressure sensor is installed on the perpendicular bisector of the centerline and 0 3 m above at the minimum bubble volume moment frame 12 the sensor is only 0 07 m above the bubble top surface more interestingly the sensor seems to enter the rebounding bubble frame 15 the pressure field inside the bubble cloud is rarely reported before fig 9 a and b shows the first and second bubble pulse respectively in panel a multiple pressure peaks can be observed which is due to the fragmentation of the toroidal bubble and individual collapses of the sub bubbles the maximum pressure reaches 21 8mpa which is comparable to the initial shock wave pressure applying eq 16 we get i 470 pa s m which is about 40 larger than that in the previous experiment the most possible reason for the increase of the impulse may be the upward migration of the bubble under buoyancy the collapse velocity of the toroidal bubble is no longer symmetrically distributed along the bubble ring leading to some directivity of the bubble pulse pressure in the aforementioned axisymmetric configuration experiment there is no obvious second bubble pulse on the pressure curve however in the present experiment the second bubble pulse is still evident as shown in panel b since the sensor gets into the bubble s interior during the second bubble oscillation the measured pressure should be very close to the gas pressure of the bubble compared with the first bubble pulse fewer pressure peaks on the signal profile are found in panel b indicating that most of the sub bubbles merge into a large bubble and the second collapse of the bubble is more concentrated however since most of the bubble energy has dissipated around the final stage of the first bubble cycle the maximum pressure peak is only 2 4 mpa this should be the upper bound of the second bubble pulse because the sensor is already inside the bubble a well verified three dimensional bim code han et al 2016 is used to reproduce this experiment and selected results are shown in fig 10 the contours denote the velocity magnitude and the arrows denote the velocity direction in panel a the two bubbles expand rapidly and the maximum velocity is over 40 m s a stagnation point forms at the midpoint of the two bubble system due to the symmetry of the system before the bubble coalescence see panel b the maximum velocity in the flow is located around the edge of the liquid film between the bubbles in panel c this annular high velocity region still exists after the coalescence which is responsible for the formation of a swelling on the coalesced bubble surface han et al 2016 during the collapse phase see panel d the left end and right end of the coalesced bubble collapse faster than other positions of the bubble surface two high speed liquid jets develop gradually over 50 m s and impact at the center of the coalesced bubble after the jet impact a stagnation point can be seen around the jet impact position panel f the liquid around the original jet tips is redirected from quasi horizontal direction to the radial direction our numerical prediction of the annular jet velocity reaches 85m s the essential bubble dynamics obtained from the experiment fig 8 are well reproduced by the numerical model from the numerical simulation we can confirm that the toroidal bubble collapses with a relatively asymmetrical velocity about the centerline in addition the bubble is not transparent in the experiment thus our numerical simulation gains further insight into the high speed liquid jet formation jet impact splash and the associated flow field characteristics 4 4 two bubble dynamics in an oblique configuration in the fourth experiment two explosives are arranged obliquely the angle between the centerline of two bubbles and the gravity is π 4 and the distance between the two explosives is about 0 21 m which is slightly larger than that in the above cases we have conducted two numerical simulations to test the sensitivity of the distance parameter for this oblique configuration i e a d 0 2 m and b d 0 21 m the relative difference of the jet impact time between the two cases is 0 4 and the difference of the jet impact velocity is about 4 7 selected images of the experiment are given in fig 11 as expected two jets form from the two ends of the coalesced bubble at the final collapse stage of the bubble frame 11 the upper part of the bubble has a larger volume than that of the lower part which is caused by the buoyancy effect at the minimum bubble volume moment frame 12 a small protrusion can be seen at the top of the coalesced bubble which is attributed to the jet impact the protrusion grows during the rebound stage and migrates upward frames 13 18 similar to the second and third experiments the bubble in the second cycle displays as cloud and no smooth surface can be observed anymore the second collapse of the bubble frame 22 becomes less focusing and the rebound of the third cycle frames 23 24 is much less evident in this experiment the sensor is initially installed at the same depth as the upper explosive and 0 25 m away from the explosive center in frame 12 the sensor position is marked as a red cross which is about 0 19 m to the midpoint of the two explosives fig 12 a shows the time history of the first bubble pulse pressure there are also multiple peaks on the pressure profile indicating the fragmentation of the coalesced bubble before the minimum bubble volume moment it is noted that the maximum pressure peak reaches 20 mpa which indicates the occurrence of a very violent collapse of a sub bubble near the sensor using eq 16 obtains the impulse as i 449 pa s m which is about 34 larger than that in the second experiment and 4 4 smaller than the third experiment fig 12 b shows the second bubble pulse in which we can find fewer pressure peaks and the maximum pressure is only 1 2 mpa however the duration of the second bubble pulse is around 1 5 ms which is much longer than the first bubble pulse applying eq 16 to the second bubble pulse obtains the impulse as i 183 pa s m selected numerical results of this experiment are given in fig 13 here the contours denote the pressure field in the flow at the early expansion stage panel a the pressure between the bubbles is slightly enhanced which hinders the approach process of bubbles before the bubble coalescence panel b the pressure in the thin liquid film is very close to that of the bubble gas when the coalesced bubble reaches its maximum volume panel c the pressure surrounding the bubble surface is much smaller than the hydrostatic pressure during the collapse phase panel d a localized high pressure region can be observed near the bottom right part of the bubble surface which further drives a liquid jet upward and leftward another liquid jet also forms afterward panel e directed downward and rightward the high pressure region behind the second jet is more pronounced than that behind the first jet at this moment after the jet impact panel f a much more localized high pressure region is generated around the jet impact area and the maximum pressure is about 4 3 mpa the simulation again confirms the asymmetrical collapse of the toroidal bubble the simulation of the subsequent process requires a much higher resolution mesh on the bubble surface which is beyond the capacity of our present computing power additionally the physical complexities e g fragmentation of the bubble compressibility of the liquid heat and mass transfer involved in 3d toroidal bubble dynamics are still challenging for numerical modeling which will be for our future work 4 5 more discussion in all these two bubble experiments the impact of two liquid jets leads to the formation of a toroidal bubble in the vertical configuration case the pressure field surrounding the bubbles are axisymmetric about the centerline thus the toroidal bubble collapses with a relatively symmetrical velocity although multiple pressure peaks can be observed in fig 7 b they are relatively more concentrated however in the horizontal and oblique configuration cases the toroidal bubbles collapse asymmetrically specifically the bubble segments located at larger depths collapse faster and the upper bubble segments exhibit larger volumes and collapse with delayed times in both fig 9 a and fig 12 a the multiple pressure peaks are relatively less concentrated than those in the axisymmetric case interestingly the last pressure peak is the largest one a possible explanation is that the lower bubble segments collapse earlier and generate some pressure waves or high hydrodynamic pressure which further drives the remaining part of the bubble to collapse more violently this phenomenon is similar to the collapse pattern of the bubble cluster bremond et al 2006b a brujan et al 2012 zhang et al 2019 i e the collapse of one bubble may be reinforced by the neighboring ones during the bubble cluster collapse under some certain conditions the bubble cluster collapses from the cluster surface inwardly resulting in an intense energy focusing and a pressure wave of a very high amplitude reisman et al 1998 bremond et al 2006b 5 summary and conclusions in this study we experimentally and numerically investigate the dynamics of coalesced bubbles which are generated by synchronized detonations of two identical explosives 2 5 g petn for each in a free field the maximum equivalent radius of each bubble is about 0 23 m and the distance between two explosives is fixed around 0 2 m a high speed camera and pressure sensors are used to capture the transient bubble dynamics and the associated shock waves respectively different configurations of the two bubble system are studied to perform boundary integral simulations a single bubble experiment is carried out first the data of which is used to determine the initial conditions for the simulation the main findings are summarized as follows 1 in the single bubble experiment a counter intuitive bump forms at the bottom of the bubble during the second collapse phase our numerical simulation reveals the underlying mechanism the liquid in the axial jet of the toroidal bubble is gradually squeezed out during the rebounding phase after a certain time a stagnation point inside the jet can be observed below which the velocity is directed downward consequently the collapse of the bubble bottom is delayed by the downward jet flow 2 in our experiments the coalescence of two bubbles occurs during the expansion phase during the collapse phase two liquid jets form from the two ends of the coalesced bubble and shoot toward each other the violent impact of the two jets causes a strong splashing followed by a very unstable collapse and rebound of the bubble the pulsation period of the two bubble system 2 5 g 2 5 g petn is about 16 higher than that of a single bubble 2 5 g petn but 7 9 smaller than a single bubble with double explosive weight 5 g petn 3 the numerical simulation reproduces the multiple splits of the collapsing bubble which partly reveals the mechanism of the bubble cloud formation these sub bubbles collapse with different velocities and reach their minimum volumes individually which consequently lead to multiple emissions of shock waves generally most of the pressure peaks are lower than those in the single bubble experiment 4 interestingly in the horizontal and oblique configuration cases the last peak of the bubble pulse is the largest one which is possibly attributed to the asymmetric collapse of the bubble about the centerline specifically the lower bubble segments collapse earlier and generate some pressure waves or high hydrodynamic pressure which drives the remaining part of the bubble to collapse more violently 5 a modified pressure impulse is used to make quantitative comparisons between the pressure signals in different experiments the pressure impulse induced by two collapsing bubbles is less than twice of the impulse generated by a single collapsing bubble in this sense the collapse of the two bubble system is less violent than that of a single bubble since the experimental data is limited the directionality of the pressure waves induced by two bubbles need further investigation in the future acknowledgments this work is supported by the national natural science foundation of china 51709056 and 11702071 and the industrial technology development program china jcky2017604c002 jcky2018604c010 the authors want to thank bin wang and yuanping zhang from china academy of engineering physics in conducting the experiments appendix a supplementary data supplementary material related to this article can be found online at http dx doi org 10 1016 j oceaneng 2019 106414 see movie 1 for the experiment in fig 2 movie 2 for the experiment in fig 5 movie 3 for the experiment in fig 8 and movie 4 for the experiment in fig 11 appendix a supplementary data the following is the supplementary material related to this article video s1 the dynamic behaviors of a single underwater explosion bubble generated by 2 5 g petn explosive at the water depth of 0 99 m video s2 the dynamic behaviors of the coalesced bubble in the free field generated by two synchronized detonations in the axisymmetric configuration video s3 the dynamic behaviors the dynamic behaviors of coalesced bubble in the free field generated by two synchronized detonations in a horizontal configuration video s4 the dynamic behaviors of a coalesced bubble in the free field generated by two synchronized detonations in an oblique configuration 
22432,this work presents experimental and numerical investigations on the nonlinear interaction coalescence collapse and rebound of two pulsating bubbles which are generated by underwater explosions 2 5 g petn for each the transient physical phenomena are captured by a high speed camera and the near field pressure signals measured by pressure sensors the boundary integral simulations gain further insight into the high speed liquid jet formation jet impact splash fragmentation and the associated flow field characteristics particularly the numerical simulation reproduces the multiple splits of the coalesced bubble which partly reveals the mechanism of the bubble cloud formation these sub bubbles collapse with different velocities and reach their minimum volumes at different times leading to the emission of multiple bubble pulse pressures shock waves at the final collapse phase interestingly we find that the last pressure peak is the largest one for non axisymmetric configurations which is attributed to the asymmetric collapse of the coalesced bubble about the centerline of the two bubbles at inception more specifically the lower bubble segments collapse earlier and generate large pressure waves which further drives the remaining part of the bubble to collapse more violently we also make quantitative comparisons of the pressure impulse between different configurations keywords bubble dynamics bubble coalescence underwater explosion shock waves boundary integral method 1 introduction bubble dynamics is an important study field for its crucial role in ocean engineering and many other applications the imbalance between the pressure of the bubble gas laplace pressure and ambient hydrostatic pressure leads to bubble oscillation which is one of the key physics in underwater explosion klaseboer et al 2005a brett and krelle 2018 wang et al 2018 cavitation brennen 1995 ji et al 2014 supponen et al 2018 saleki haselghoubi and dadvand 2018 ultrasonic cleaning reuter and mettin 2016 geophysical exploration de graaf et al 2014 shock wave lithotripsy lingeman et al 2009 high intensity focused ultrasound yuan et al 2015 sonoporation ohl et al 2006 etc although the bubble size scale in the forementioned applications ranges from micrometers to meters some essential physics show striking similarities including expansion collapse jetting shock wave emission etc hence studies on different types of bubbles can mutually stimulate each other gong et al 2010 supponen et al 2016 the bubble gas is highly compressed during the violent collapse phase leading to a strong energy focusing it is well known that a spherical collapse of the bubble leads to the strongest shock wave pressure wave emission the dynamics of a spherical oscillating bubble is described by the celebrated rayleigh plesset equation lord rayleigh 1917 plesset and calif 1949 however a bubble near boundaries or in external force fields cannot keep a spherical shape understanding and predicting the collapse pattern of nonspherical bubbles and the associated shock waves are crucial to the foregoing applications single bubble dynamics near different boundaries for example rigid wall lauterborn et al 2018 li et al 2016b free surface wang et al 1996 movable rigid structure li et al 2018a elastic structure li et al 2018c jin et al 2018 etc have been extensively investigated before the high speed liquid jet is one of the most important features of non spherical bubbles the jet impact is another cause of damage to nearby structures or a beneficial tool in cleaning reuter and mettin 2016 and sonoporation ohl et al 2006 additionally the liquid jet may occupy a large amount of kinetic energy which weakens the strength of bubble collapses cui et al 2016b supponen et al 2017 presented detailed observations on the shock waves generated by nonspherical cavitation bubbles they found that the multiple shocks are related to different processes including jet penetration and collapses of distinct bubble segments nevertheless the characteristics of the shock waves generated by two or multiple bubbles are far from well understood multiple bubbles or a bubble cluster is more often encountered in practical applications and real life one bubble changes the ambient pressure field for a neighboring bubble and vice versa hence the bubble bubble interaction also has a significant influence on bubble collapse pattern during the collapse of two identical cavitation bubbles in an infinite field two axial jets form from the far ends of the two bubble system and are directed towards each other han et al 2015a cui et al 2016a the two bubble dynamics is dependent on the separation distance phase difference size ratio and boundary conditions chew et al 2011 han et al 2015a 2018 fong et al 2009 bremond et al 2006a tomita and sato 2017 han et al 2015b 2019a luo and niu 2019 peng et al 2019 three typical phenomena are observed in previous experimental studies namely jet toward each other jet away and coalescence chew et al 2011 fong et al 2009 recently the anti phase bubbles were used to produce a fast thin jet which is a promising tool in micropumping and opto injection han et al 2015a much attention has been paid to bubble motion in previous studies however the associated shock wave emission is less concerned with due to the complexity of two bubble interactions this study is limited to the coalescence collapse and rebound of two underwater explosion bubbles and the associated shock wave emission there are only a few experimental studies on the dynamics of a coalesced bubble fong et al 2009 presented experimental observations on the coalescence of two spark bubbles clearer experimental images can be found in cui et al 2016a and han et al 2016 2018 these experiments suggested that two liquid jets are formed during the collapse phase and impact in the center of the coalesced bubble thereafter the coalesced bubble splits into many smaller ones and presents as a bubble cloud during the rebound phase han et al 2018 argued that the pressure generated by a coalesced bubble is weakened because the bubble energy is disintegrated in the present study two identical explosives 2 5 g petn for each are used to generate two identical bubbles in a water tank different arrangements of the two bubbles vertical horizontal and oblique are tested with almost the same separation distance 0 2 0 21 m in which simultaneous high speed photography and pressure sensor measurement are used to explore the dynamics of coalesced bubbles before the impact of the two jets the overall dynamics of the coalesced bubble changes little for different arrangements however the pressure signals are strikingly different quantitative comparisons of the near field pressure signal bubble induced shock waves are made between two bubble experiments and a single bubble experiment apart from the experiments the boundary integral simulations han et al 2016 2018 li et al 2016b zhang et al 2015 han et al 2019b are also carried out to gain more insights into the collapse pattern of coalesced bubbles rungsiyaphornrat et al 2003 first simulated the coalescence of two underwater explosion bubbles using axisymmetric boundary integral method bim han et al 2016 established a 3d model to simulate bubble coalescence in a free field in both studies the simulations stopped before the toroidal bubble stage in this study an improved vortex ring model zhang et al 2015 li et al 2016b is introduced to simulate the toroidal bubble motion a multiple vortex ring model zhang et al 2015 is used to simulate the splitting of a toroidal bubble the numerical simulations partly elucidate the complex collapse pattern and fragmentation of the coalesced bubble this paper is organized as follows the experimental setup and numerical setup are given in sections 2 and 3 respectively in section 4 1 a single bubble experiment is discussed and the measured data are used to determine the initial conditions for numerical simulations in section 4 2 4 5 we discuss the physics in the two bubble experiments with different configurations at last we summarize this study and draw the conclusions in section 5 2 experimental setup the present experimental setup is similar to that in cui et al 2016b and some basic equipment and the experimental procedure can be found therein every bubble in our experiments is generated by an underwater explosion of 2 5 0 01 g petn pentaerythritol tetranitrate in a 2 2 2 m 3 water tank the synchronized detonations of two explosives are accurately controlled by an electric detonator different configurations of the two explosives are investigated namely axisymmetric horizontal and oblique configurations in the single bubble experiment the maximum bubble radius r m reaches 0 23 m when the detonation takes place at the water depth of 0 99 m and the atmospheric pressure 0 98 bar the distances between the explosive and boundaries tank walls and free surface are more than 4 r m as suggested by a universal estimation in obreschkow et al 2011 the effects of the tank walls on non spherical bubble dynamics are negligible when compared to the gravity and bubble bubble interactions the transient processes of our experiments are recorded by a high speed camera phantom v711 at an acquisition rate of 7500 hz with generated images of 1280 800 pixels the spatial resolution is around 0 7 mm per pixel the uncertainty for length measurement since the tank walls are stiffened plates made of steel an acrylic window on the front wall is installed for photography the back illumination cannot be applied to the present setup hence the experiments are conducted outdoors to achieve clearer images under the strong sunlight with white painted inner tank walls to enhance the brightness the exposure time is also set as large as possible 130 μ s and the bubble boundary is slightly blurred in previous studies pressure sensors were often placed relatively far from the bubble surface to measure the far field pressure while the near field pressure of underwater explosion bubbles was rarely concerned with in this paper we aim to study the near field pressure in different directions of a coalesced bubble pressures sensors pcb 138a are installed on a thin tight rope and placed very close r m to the explosive the diameter of the rope is around 2 mm which has a negligible effect on bubble dynamics the diameter of the pressure sensor is 9 6 mm and the length 193 mm as suggested by li et al 2018a the overall bubble dynamics is hardly affected by a nearby suspended object if the size ratio is smaller than 0 1 the signals from the pressure sensors are recorded by an oscilloscope tektronix dpo7104c working at 5 million samples per second the nominal range of the pcb 138a sensor reaches 344 mpa and the rise time is 1 5 μ s since the bubble migrates upward under the buoyancy effects the most dangerous position should be above the bubble top hence the pressure sensor is placed above the explosive in most of our experiments 3 numerical setup consider a two bubble system in three dimensional configuration as shown in fig 1 a cartesian coordinate system x y z is defined with the origin o located at the initial center of the upper bubble or left bubble referred to as bubble 1 and z axis pointing upward for simulation of the dynamic behaviors of the bubbles an axisymmetric as well as a 3 d bim model are used as described in blake and gibson 1987 wang et al 1996 rungsiyaphornrat et al 2003 zhang et al 2015 han et al 2016 and li et al 2018d 2019 since the shock wave induced by the detonation of explosive is short lived and propagates quickly the flow field surrounding bubbles is approximated to be incompressible inviscid and irrotational as a result the velocity in the flow can be described by the gradient of a potential φ 1 v φ which satisfies the laplace equation and the boundary integral equation 2 2 φ 0 3 θ φ g φ n φ g n d s where θ is the solid angle s is the flow boundary g is the green function and n is the outward normal of s as the potential distribution on the bubble surface is obatined in each time step the normal velocity on the bubble surface can be calculated by solving eq 3 wang et al 1996 wang 1998 a finite difference method is adopted to calculate the velocity in the tangential direction zhang et al 2001 the position of the bubble surface and the potential on it are updated by the kinematic boundary condition and dynamic boundary condition respectively given by 4 d r d t φ 5 d φ d t 1 2 φ 2 p p b ρ g z where p b is the bubble surface pressure ρ is the liquid density surrounding the bubble g is the gravitational acceleration and p p atm ρ g h is the ambient hydrostatic pressure as demonstrated by navier stokes simulations li et al 2018b han et al 2015a lauterborn et al 2018 the pressure field inside the bubble is uniform despite the velocity field is highly non uniform distributed besides the adiabatic law has been confirmed to be a good approach to describe the bubble gas pressure during the transient oscillation of underwater explosion bubbles rungsiyaphornrat et al 2003 klaseboer et al 2005a zhang et al 2017 written as 6 p b p 0 v 0 v κ where κ is the gas specific heat ratio p 0 and v 0 are the initial bubble pressure and volume respectively and v is the bubble volume for a large scale underwater explosion bubble the gravity induced pressure gradient drives an upward liquid jet at the collapse stage of the bubble cui et al 2016b klaseboer et al 2005a b after the jet penetration the single connected flow domain becomes double connected and the bubble becomes toroidal the conventional bim cannot be directly applied to the subsequent simulation of a toroidal bubble hence an improved vortex ring model zhang et al 2015 li et al 2017 is used to deal with the discontinuous distribution of the velocity potential on the toroidal bubble surface a vortex ring is placed inside the toroidal bubble and the circulation γ is set as the potential jump at the jet impact location 7 γ φ n φ 1 where the subscripts 1 and n denote the first and last node on the bubble surface before the jet penetration the total velocity and potential on the toroidal bubble surface are decomposed into two parts i e 8 φ φ r φ v v v r v v where φ v and v v are the potential and velocity induced by the vortex ring and φ r and v v are the remnant potential and the remnant velocity moreover the toroidal bubble is also likely to split under some circumstances zhang et al 2015 li et al 2016a leading to the formation of two or more sub bubbles the multiple vortex ring model zhang et al 2015 is adopted here to investigate the coupling of two toroidal bubbles the decomposition of the potential and velocity can be rewritten as 9 φ φ r φ v1 φ v2 v v r v v1 v v2 where the subscripts v 1 and v 2 denote the first vortex ring and the second vortex ring respectively the velocity induced by a vortex ring can be analytically calculated from the biot savart law wang et al 2005 zhang et al 2015 the remnant velocity is calculated by bim directly a semi analytical method zhang et al 2015 is adopted to calculate the potential induced by a vortex ring given by the following formulas in the cylindrical coordinate system o r θ z 10 φ v p γ 4 π c r z r 1 e z r r 2 d q r r p q r r 0 r z 11 φ v p γ 4 π c r z r 1 e z r r 2 d q r r p q r r 0 r z where q is a integration point on the vortex ring and e z is taken as 0 0 1 eqs 10 and 11 are used when the node p is above and below the vortex ring plane respectively in the toroidal bubble stage the dynamic boundary condition eq 5 is rewritten as 12 d φ r d t φ r v r v v 1 2 v r v v 2 p p b ρ g z the details about the foregoing models refer to zhang et al 2015 at last the pressure field and velocity field are calculated using an auxiliary function method li et al 2016b 4 results and discussion 4 1 single bubble dynamics an experiment on single bubble dynamics in the free field is carried out first in which the explosive 2 5 g petn is placed at the water depth of 0 99 m this experiment provides a reference for the following two bubble experiments selected images of the experiment are shown in fig 2 soon after detonation frame 1 the shock wave emission and the subsequent reflections as tension waves cause very pronounced cavitation in the water bulk frame 2 which almost disappears around t 3 47 ms frame 3 the bubble holds high sphericity during the subsequent expansion phase frames 4 6 during the collapse stage non spherical features of the bubble emerge due to the gravity effect specifically the bubble bottom collapses faster than the upper part and becomes flattened gradually frames 8 11 finally a high speed liquid jet shoots upward in the final collapse phase of the bubble frame 12 the jetting behavior of a bubble has been investigated in great detail in previous literature cui et al 2016b klaseboer et al 2005a li et al 2018b frames 13 23 cover the second cycle of the bubble at the beginning of the rebound a shock wave is emitted and reflected at the free surface the rarefaction wave which causes very evident cavitation frames 13 14 due to the high speed jet penetration the bubble is elongated in the vertical direction and the bubble assumes a pear shape during the rebounding process frames 15 18 the bubble shape is not spherical during the whole rebounding phase which leads to a different collapse pattern as the bubble surface at the top owns the maximum curvature in frame 19 it collapses faster during the early recollapse phase frame 20 lord rayleigh 1917 lauterborn 1982 thereafter a bump forms at the bottom of the bubble see the blue dashed rectangles in frames 20 21 supponen et al 2016 also found this phenomenon in their cavitation bubble experiments they attributed the bump formation to the break up of the liquid jet within the toroidal bubble after which the remainder of the jet is pulled back by surface tension however the surface tension plays a minor role in our experiment since the associated weber number is much larger than 1 therefore we will try to reveal the mechanism by using boundary integral simulation in later discussions presumably two axial jets form from the bubble top and bottom respectively frame 23 during the third cycle frame 24 the rough bubble surface may be caused by the strong splashing during the impact of the two axial jets han et al 2018 the above experiment is used to determine the initial bubble parameters for the simulation a commonly used empirical relationship for the maximum bubble radius klaseboer et al 2005a is given by 13 r m α 1 w h h atm 1 3 where h atm denotes the water column height for the atmospheric pressure which is taken as 10 in the present study substituting the known parameters of this experiment r m 0 230 m w 2 5 1 0 3 kg yields the prefactor α 1 equals 3 77 this formula has been tested to be an accurate estimation for larger petn explosives cui et al 2016b zhang et al 2013 another empirical relationship for the initial bubble pressure klaseboer et al 2005a is given by 14 p 0 α 2 w v 0 κ where α 2 is the second parameter that needs to be determined the initial bubble radius r 0 is estimated by the rayleigh plesset equation lord rayleigh 1917 klaseboer et al 2005b as follows 15 p r 0 r m 3 1 p 0 κ 1 r 0 r m 3 κ r 0 r m 3 the three parameters r 0 p 0 and κ are not independent for a fixed r m as suggested by best 2002 and li et al 2016b κ mainly controls the bubble period and p 0 controls the bubble pulse pressure the experiment can be well reproduced by adjusting κ and p 0 in terms of the bubble period and the pressure field in the present study we set κ 1 6 and α 2 1 1 1 0 5 the value of κ is within the reasonable range for an underwater explosion bubble 1 25 κ 1 667 hung and hwangfu 2010 these parameters are different from those for tnt explosives klaseboer et al 2005a b which attributes to the difference in chemical components of petn fig 3 a shows the comparison of the bubble radius between boundary integral simulation solid line and the experimental data red triangles in this single bubble experiment the bubble keeps a spherical shape during most of the bubble life so the bubble radius can be obtained from each experimental image directly the relative error of the measured maximum bubble radius is about 0 3 after the bubble becomes non spherical we need to get the boundary of the bubble first and calculate the equivalent radius of the bubble excellent agreement is found for the first cycle of the bubble fig 3 b shows the comparison of pressure signals the pressure sensor captures the shock wave and the bubble pulse pressure our numerical simulation starts with a tiny high pressure bubble thus the initial high amplitude shock wave is beyond the capacity of bim however the bubble pulse is extremely well reproduced by the present model except for a little difference in time it is worth noting that the pressure sensor moves during the bubble oscillation for it is difficult to control the sensor at a fixed position due to the large pressure load in the computation of the pressure signal the location of the field point is interpolated from the experimental data in fact during most of the bubble lifetime the magnitude of the pressure signal is relatively small the bubble pulse pressure around the minimum bubble volume moment is within quite a short time when the distance between the sensor and the bubble top is around 0 146 m at the rebounding stage the bubble migrates upward rapidly and approaches the sensor directly as shown in frame 14 of fig 2 however no obvious pressure increase in the pressure signal is found at the same moment there are some reasons responsible for this counter intuitive phenomenon firstly the jet impact only affects a very localized region around the jet front as shown in fig 4 a thus it is difficult to capture the jet impact pressure accurately with the sensor secondly the high amplitude water hammer pressure brujan et al 2001 ρ c v where c is the sound speed in water and v is the jet impact velocity induced by the jet impact has a very short duration about δ t d 2 c where d is the diameter of the liquid jet in the present experiment the jet diameter predicted by the numerical simulation is around 17 5 mm thus obtaining δ t 5 8 μ s which is much smaller than the duration of the bubble pulse in fig 3 b up to date experimental studies on bubble jet impact pressure are rarely seen in published literature cui et al 2016b supponen et al 2017 cui et al 2018 and some numerical studies can be found in some references li et al 2016b zhang et al 2015 hsiao et al 2014 at last we try to explain the formation of the bump at the bubble bottom during the second collapse phase frames 20 21 of fig 2 which is still not well understood although the energy loss due to the emission of the pressure wave is not considered in our bim code some features of the bubble during the second cycle are still well preserved fig 4 shows the pressure and velocity fields surrounding the rebounding bubble at two moments as shown in panel a the pear shaped bubble in the experiment is well reproduced the liquid surrounding the rebounding bubble is generally pushed outward there exists a stagnation point in the liquid jet above which the velocity is directed upward and below which the velocity is directed downward thus the jet width inside the bubble decreases and the toroidal bubble tends to rejoin in the numerical simulation we perform a surgery cut of the thin jet when the minimum radius of the liquid jet is smaller than the local mesh size δ s wang 2013 lee et al 2007 the region with the radius of the liquid jet less than 2 5 δ s is regarded as the rejoin area then the toroidal bubble transforms into a singly connected bubble again the total velocity potential on the surface of the bubble remains the same as that before the surgery cut more details about this numerical treatment can be found in lee et al 2007 and wang 2013 after the rejoin the lower part of the original jet keeps thinning and the liquid therein is gradually squeezed out by the expanding bubble surface as shown in panel b as expected the bubble bottom would be pulled down due to inertia no surface tension here which may be responsible for the formation of the bump at the bubble bottom lim et al 2010 experimentally and numerically studied the dynamics of an initially v shaped bubble they found that the hollow part of the v shape overshot and became a bulge during the expansion see figs 6 7 therein which is similar to our observation 4 2 two bubble dynamics in axisymmetric configuration in the second experiment two explosives are arranged in a vertical line with different water depths 0 9 m and 1 1 m respectively fig 5 gives selected images of the experiment and each sequence during the first bubble cycle is overlaid with the simulation results denoted by red dashed lines due to the small distance between two explosives the two bubbles quickly become non spherical after the detonations frames 1 3 as two bubbles approach each other a water film forms between them and the film thickness keeps decreasing bremond et al 2006a demonstrated that the film thinning between two micron size cavitation bubbles is inertia dominated for the present meter sized bubbles the viscous effect is believed to be negligible rungsiyaphornrat et al 2003 the film rupture cannot be observed in our experiment in every time step during the numerical simulation the minimum distance between the two bubbles surfaces s min is calculated as previously done in rungsiyaphornrat et al 2003 and han et al 2016 a numerical coalescence of bubbles is performed if s min 0 02 r m the elements on the thin film between two bubbles are deleted and the rest parts of the bubble surfaces are stitched together the convergence test of the 3d bim code has been performed for the two bubble coalescence in our previously published paper han et al 2016 the 3d results approach the axisymmetric results when the element number on one bubble surface is 5120 the corresponding node number is 2562 the coalesced bubble reaches its maximum volume in frame 6 and assumes a capsule shape at the collapse stage the velocities at the bubble bottom and top are higher than that around the equator this can be explained by the argument by vogel et al 1989 i e the locations of the bubble surface with higher curvature collapse faster an upward liquid jet forms from the bubble bottom followed by the formation of a downward jet from the bubble top frame 10 presumably the two jets would collide within the bubble and lead to a violent splashing however this phenomenon could not be observed in the experiment because the underwater explosion bubble is not transparent hence we conduct a numerical simulation to gain further insight into the high speed liquid jet formation and the subsequent splashing we find excellent agreement of bubble profiles between experiment and boundary integral simulation in the first cycle the development of jets can be clearly clarified and the impact point of two jets is slightly above the midplane of the coalesced bubble frame 11 subsequently the jet flow along the axis of symmetry is redirected radially outward splashing after the bubble reaches its minimum volume frame 12 the oscillation in the second cycle begins very different from a single bubble case the rebounding coalesced bubble undergoes quite an unstable process as suggested by the bubble cloud and rough bubble surface frames 13 16 in this process the bubble energy is disintegrated and the boundary integral simulation is used to reveal the underlying mechanisms as the annular jet develops the toroidal bubble finally splits into two parts in the present study we use the multiple vortex ring model zhang et al 2015 to simulate the subsequent motion of two toroidal bubbles fig 6 gives the numerical results in which the bubble profiles pressure contours and velocity fields are provided in panel a it is observed that the pressure inside the toroidal bubble the inner jet is relatively large due to the impact of the two jets meanwhile the impact of the annular jet causes an annular high pressure region which has a higher magnitude than the inner one thereafter the two toroidal bubbles collapse with different velocities in panel b it is noted that the lower bubble collapses faster than the upper bubble thus the gas pressure of the lower bubble is larger than that of the upper one consequently the pressure surrounding the lower bubble is much higher than that around the upper bubble additionally the lower toroidal bubble is about to further split presumably the upper bubble will also split subsequently hence our numerical simulation partly reveals the mechanism of bubble splitting and the formation of bubble cloud however it is believed that the bubble exhibits more splits as suggested by the formation of bubble cloud during the rebound phase frames 17 18 every bubble ring may break up into several parts around the minimum volume moment due to rayleigh taylor instabilities despite we have done the simulation of the first split of a toroidal bubble more splits are about to occur before the minimum volume of the bubble is reached therefore it is difficult for bim to obtain the pressure peaks in such a two bubble system more advanced numerical methods are worth developing in our future work back to frames 19 24 of fig 5 it seems that almost all the gaseous of the bubble merges into a single bubble again and an upward migration can be observed during the third cycle of the bubble using the proportional relation between the maximum bubble volume and bubble energy we can roughly estimate the bubble energy left after the second cycle is around 28 hence the damage potential of a bubble after the second collapse is often neglected in the underwater explosion study in the current experiment the second bubble pressure pulse emitted at the end of the second bubble cycle is much weaker than the first one fig 7 a shows the initial shock waves generated by the two detonations both sensors capture two individual pressure peaks due to different distances between the sensor and the explosives as marked in the figure a and b are the two pressure peaks captured by the upper sensor and c and d by the horizontal sensor the maximum shock wave pressure is over 20 mpa some tiny pressure peaks are also observed around e which are caused by the reflections of the shock waves on the tank walls fig 7 b shows the first bubble pulse pressure generated at the end of the first bubble cycle interestingly we find that the pressure profiles are quite different from that of the single bubble experiment as shown in fig 3 b in the following aspects firstly the occurrence time of the bubble pulse peak is about 16 later than that of the single bubble experiment this is because one bubble alters the surrounding pressure field for the other one bremond et al 2006a the bubble period increases as the distance between two bubbles decreases when the inner bubble distance becomes zero a limiting situation two bubbles become a single one from the beginning and the bubble period will increase by 26 the second and most important aspect is that distinctive multiple pressure peaks can be observed on the pressure profiles which confirms the foregoing discussion on bubble splitting before reaching the minimum volume the toroidal bubble splits into several parts which collapse with different velocities and reach their minimum volumes at different times consequently multiple bubble pulse pressures are emitted during the collapse phase of this coalesced bubble however almost all the pressure peaks are lower than that in the single bubble experiment except for a comparable sharp pressure peak marked as f this sharp pressure wave may be caused by the collapse of a small bubble in close vicinity to the horizontal sensor to make a quantitative comparison between the pressure profiles we define a modified pressure impulse as the integration of the pressure over time multiplied by the distance between the pressure sensor and the bubble center r tagawa et al 2016 given by 16 i r t 1 t 2 p d t the integration range t 1 t 2 is set where the pressure rises above 0 1 p max during the first collapse of the coalesced bubble where p max is the maximum pressure signal in fact the best choice of the minimum pressure in the integration range is zero however the pressure signals have some oscillation problems thus it is difficult to determine the integration range in addition the pressure wave below a critical value may have little threat to nearby structures if we set the minimum pressure as an absolute value for example 1 mpa the waveforms of the shock wave can be quite different when the measured distance varies instead we set the minimum pressure in the integration range as a relative value 0 1 p max thus the waveforms of the shock wave can be similar different from the definition in tagawa et al 2016 here the pressure integral is multiplied by r which eliminates the influence of the measured distance vogel and lauterborn 1988 brujan et al 2012 it is assumed that the pressure waves propagate through the water without any nonlinear dissipation for the two pressure profiles in fig 7 b we get the impulses as i upper 339 pa s m and i horizontal 334 pa s m surprisingly the two impulses are almost identical hence the directionality of the pressure wave induced by the coalesced bubble is not evident tagawa et al 2016 also found that the distribution of the pressure impulse of a laser cavitation bubble is spherically symmetric even when the distribution of the peak pressure is not spherically symmetric applying eq 16 to the initial shock wave yields i shock 307 pa s m which means the bubble induced impulse is higher than shock waves as for the single bubble experiment in section 4 1 we get the impulse as i single 2 5g 251 pa s m thus the impulse of the two bubble system is 1 34 times i single 2 5g as for a single bubble generated by 5 g petn we get the impulse from the numerical simulation as i single 5g 397 pa s m which is 1 58 times i single 2 5g clearly the collapse of each bubble in the two bubble system becomes less violent than that of a single bubble situation which results in a relatively weaker bubble pulse pressure the underlying mechanism can be explained from the point of view of energy the formulas for the kinetic energy e k and potential energy of the bubble e p are given below lee et al 2007 17 e k 1 2 ρ φ φ n d s 18 e p v p ρ g z c p b v κ 1 where z c is the depth of the bubble center for the single bubble experiment the percentage of the kinetic energy of the flow field at the jet impact moment is only 17 of the total energy obtained from numerical simulation more energy has been transferred into potential energy indicating a very high pressure of the bubble gas and a violent collapse however in the two bubble experiment two high speed liquid jets form and the associated kinetic energy reaches 80 which alters the subsequent bubble collapse pattern and shock wave emission as a consequence the collapse of the coalesced bubble is less violent than that in the scenario with a single bubble 4 3 two bubble dynamics in a horizontal configuration in the third experiment two explosives are arranged in a horizontal line at a depth of 1 0 m and the distance between the two explosives is 0 2 m selected images of the experiment are given in fig 8 during the first cycle of the bubble frames 1 12 the bubble shape is almost symmetric about the centerline of the two initial bubbles hereafter referred to as centerline and the migration cannot be clearly observed until the final collapse phase of the bubble frame 12 the dynamic behaviors of the two bubbles are quite similar to those in the previous experiment two jets originating from the two ends of the coalesced bubble shoot towards the middle of the bubble during the rebounding phase frames 13 18 the bubble turns into a bubble cloud a pressure sensor is installed on the perpendicular bisector of the centerline and 0 3 m above at the minimum bubble volume moment frame 12 the sensor is only 0 07 m above the bubble top surface more interestingly the sensor seems to enter the rebounding bubble frame 15 the pressure field inside the bubble cloud is rarely reported before fig 9 a and b shows the first and second bubble pulse respectively in panel a multiple pressure peaks can be observed which is due to the fragmentation of the toroidal bubble and individual collapses of the sub bubbles the maximum pressure reaches 21 8mpa which is comparable to the initial shock wave pressure applying eq 16 we get i 470 pa s m which is about 40 larger than that in the previous experiment the most possible reason for the increase of the impulse may be the upward migration of the bubble under buoyancy the collapse velocity of the toroidal bubble is no longer symmetrically distributed along the bubble ring leading to some directivity of the bubble pulse pressure in the aforementioned axisymmetric configuration experiment there is no obvious second bubble pulse on the pressure curve however in the present experiment the second bubble pulse is still evident as shown in panel b since the sensor gets into the bubble s interior during the second bubble oscillation the measured pressure should be very close to the gas pressure of the bubble compared with the first bubble pulse fewer pressure peaks on the signal profile are found in panel b indicating that most of the sub bubbles merge into a large bubble and the second collapse of the bubble is more concentrated however since most of the bubble energy has dissipated around the final stage of the first bubble cycle the maximum pressure peak is only 2 4 mpa this should be the upper bound of the second bubble pulse because the sensor is already inside the bubble a well verified three dimensional bim code han et al 2016 is used to reproduce this experiment and selected results are shown in fig 10 the contours denote the velocity magnitude and the arrows denote the velocity direction in panel a the two bubbles expand rapidly and the maximum velocity is over 40 m s a stagnation point forms at the midpoint of the two bubble system due to the symmetry of the system before the bubble coalescence see panel b the maximum velocity in the flow is located around the edge of the liquid film between the bubbles in panel c this annular high velocity region still exists after the coalescence which is responsible for the formation of a swelling on the coalesced bubble surface han et al 2016 during the collapse phase see panel d the left end and right end of the coalesced bubble collapse faster than other positions of the bubble surface two high speed liquid jets develop gradually over 50 m s and impact at the center of the coalesced bubble after the jet impact a stagnation point can be seen around the jet impact position panel f the liquid around the original jet tips is redirected from quasi horizontal direction to the radial direction our numerical prediction of the annular jet velocity reaches 85m s the essential bubble dynamics obtained from the experiment fig 8 are well reproduced by the numerical model from the numerical simulation we can confirm that the toroidal bubble collapses with a relatively asymmetrical velocity about the centerline in addition the bubble is not transparent in the experiment thus our numerical simulation gains further insight into the high speed liquid jet formation jet impact splash and the associated flow field characteristics 4 4 two bubble dynamics in an oblique configuration in the fourth experiment two explosives are arranged obliquely the angle between the centerline of two bubbles and the gravity is π 4 and the distance between the two explosives is about 0 21 m which is slightly larger than that in the above cases we have conducted two numerical simulations to test the sensitivity of the distance parameter for this oblique configuration i e a d 0 2 m and b d 0 21 m the relative difference of the jet impact time between the two cases is 0 4 and the difference of the jet impact velocity is about 4 7 selected images of the experiment are given in fig 11 as expected two jets form from the two ends of the coalesced bubble at the final collapse stage of the bubble frame 11 the upper part of the bubble has a larger volume than that of the lower part which is caused by the buoyancy effect at the minimum bubble volume moment frame 12 a small protrusion can be seen at the top of the coalesced bubble which is attributed to the jet impact the protrusion grows during the rebound stage and migrates upward frames 13 18 similar to the second and third experiments the bubble in the second cycle displays as cloud and no smooth surface can be observed anymore the second collapse of the bubble frame 22 becomes less focusing and the rebound of the third cycle frames 23 24 is much less evident in this experiment the sensor is initially installed at the same depth as the upper explosive and 0 25 m away from the explosive center in frame 12 the sensor position is marked as a red cross which is about 0 19 m to the midpoint of the two explosives fig 12 a shows the time history of the first bubble pulse pressure there are also multiple peaks on the pressure profile indicating the fragmentation of the coalesced bubble before the minimum bubble volume moment it is noted that the maximum pressure peak reaches 20 mpa which indicates the occurrence of a very violent collapse of a sub bubble near the sensor using eq 16 obtains the impulse as i 449 pa s m which is about 34 larger than that in the second experiment and 4 4 smaller than the third experiment fig 12 b shows the second bubble pulse in which we can find fewer pressure peaks and the maximum pressure is only 1 2 mpa however the duration of the second bubble pulse is around 1 5 ms which is much longer than the first bubble pulse applying eq 16 to the second bubble pulse obtains the impulse as i 183 pa s m selected numerical results of this experiment are given in fig 13 here the contours denote the pressure field in the flow at the early expansion stage panel a the pressure between the bubbles is slightly enhanced which hinders the approach process of bubbles before the bubble coalescence panel b the pressure in the thin liquid film is very close to that of the bubble gas when the coalesced bubble reaches its maximum volume panel c the pressure surrounding the bubble surface is much smaller than the hydrostatic pressure during the collapse phase panel d a localized high pressure region can be observed near the bottom right part of the bubble surface which further drives a liquid jet upward and leftward another liquid jet also forms afterward panel e directed downward and rightward the high pressure region behind the second jet is more pronounced than that behind the first jet at this moment after the jet impact panel f a much more localized high pressure region is generated around the jet impact area and the maximum pressure is about 4 3 mpa the simulation again confirms the asymmetrical collapse of the toroidal bubble the simulation of the subsequent process requires a much higher resolution mesh on the bubble surface which is beyond the capacity of our present computing power additionally the physical complexities e g fragmentation of the bubble compressibility of the liquid heat and mass transfer involved in 3d toroidal bubble dynamics are still challenging for numerical modeling which will be for our future work 4 5 more discussion in all these two bubble experiments the impact of two liquid jets leads to the formation of a toroidal bubble in the vertical configuration case the pressure field surrounding the bubbles are axisymmetric about the centerline thus the toroidal bubble collapses with a relatively symmetrical velocity although multiple pressure peaks can be observed in fig 7 b they are relatively more concentrated however in the horizontal and oblique configuration cases the toroidal bubbles collapse asymmetrically specifically the bubble segments located at larger depths collapse faster and the upper bubble segments exhibit larger volumes and collapse with delayed times in both fig 9 a and fig 12 a the multiple pressure peaks are relatively less concentrated than those in the axisymmetric case interestingly the last pressure peak is the largest one a possible explanation is that the lower bubble segments collapse earlier and generate some pressure waves or high hydrodynamic pressure which further drives the remaining part of the bubble to collapse more violently this phenomenon is similar to the collapse pattern of the bubble cluster bremond et al 2006b a brujan et al 2012 zhang et al 2019 i e the collapse of one bubble may be reinforced by the neighboring ones during the bubble cluster collapse under some certain conditions the bubble cluster collapses from the cluster surface inwardly resulting in an intense energy focusing and a pressure wave of a very high amplitude reisman et al 1998 bremond et al 2006b 5 summary and conclusions in this study we experimentally and numerically investigate the dynamics of coalesced bubbles which are generated by synchronized detonations of two identical explosives 2 5 g petn for each in a free field the maximum equivalent radius of each bubble is about 0 23 m and the distance between two explosives is fixed around 0 2 m a high speed camera and pressure sensors are used to capture the transient bubble dynamics and the associated shock waves respectively different configurations of the two bubble system are studied to perform boundary integral simulations a single bubble experiment is carried out first the data of which is used to determine the initial conditions for the simulation the main findings are summarized as follows 1 in the single bubble experiment a counter intuitive bump forms at the bottom of the bubble during the second collapse phase our numerical simulation reveals the underlying mechanism the liquid in the axial jet of the toroidal bubble is gradually squeezed out during the rebounding phase after a certain time a stagnation point inside the jet can be observed below which the velocity is directed downward consequently the collapse of the bubble bottom is delayed by the downward jet flow 2 in our experiments the coalescence of two bubbles occurs during the expansion phase during the collapse phase two liquid jets form from the two ends of the coalesced bubble and shoot toward each other the violent impact of the two jets causes a strong splashing followed by a very unstable collapse and rebound of the bubble the pulsation period of the two bubble system 2 5 g 2 5 g petn is about 16 higher than that of a single bubble 2 5 g petn but 7 9 smaller than a single bubble with double explosive weight 5 g petn 3 the numerical simulation reproduces the multiple splits of the collapsing bubble which partly reveals the mechanism of the bubble cloud formation these sub bubbles collapse with different velocities and reach their minimum volumes individually which consequently lead to multiple emissions of shock waves generally most of the pressure peaks are lower than those in the single bubble experiment 4 interestingly in the horizontal and oblique configuration cases the last peak of the bubble pulse is the largest one which is possibly attributed to the asymmetric collapse of the bubble about the centerline specifically the lower bubble segments collapse earlier and generate some pressure waves or high hydrodynamic pressure which drives the remaining part of the bubble to collapse more violently 5 a modified pressure impulse is used to make quantitative comparisons between the pressure signals in different experiments the pressure impulse induced by two collapsing bubbles is less than twice of the impulse generated by a single collapsing bubble in this sense the collapse of the two bubble system is less violent than that of a single bubble since the experimental data is limited the directionality of the pressure waves induced by two bubbles need further investigation in the future acknowledgments this work is supported by the national natural science foundation of china 51709056 and 11702071 and the industrial technology development program china jcky2017604c002 jcky2018604c010 the authors want to thank bin wang and yuanping zhang from china academy of engineering physics in conducting the experiments appendix a supplementary data supplementary material related to this article can be found online at http dx doi org 10 1016 j oceaneng 2019 106414 see movie 1 for the experiment in fig 2 movie 2 for the experiment in fig 5 movie 3 for the experiment in fig 8 and movie 4 for the experiment in fig 11 appendix a supplementary data the following is the supplementary material related to this article video s1 the dynamic behaviors of a single underwater explosion bubble generated by 2 5 g petn explosive at the water depth of 0 99 m video s2 the dynamic behaviors of the coalesced bubble in the free field generated by two synchronized detonations in the axisymmetric configuration video s3 the dynamic behaviors the dynamic behaviors of coalesced bubble in the free field generated by two synchronized detonations in a horizontal configuration video s4 the dynamic behaviors of a coalesced bubble in the free field generated by two synchronized detonations in an oblique configuration 
22433,the bragg reflection of regular waves over fringing reefs is studied using a shock capturing boussinesq model funwave tvd model validation shows the present model can reasonably reproduce regular wave processes over a reef bathymetry with a proper grid size and bragg reflection induced by sinusoidal and rectified cosinoidal bars set on the horizontal bottom numerical results clearly show the sinusoidal bars set on the reef flat can reduce the maximum run up height and confirm the bragg resonance effect over the reef bathymetry the basic effects of parameters of sinusoidal bars i e the number of bars and the relative bar height on the bragg reflection of regular waves over fringing reefs are slightly different to the ones over the horizontal bottom moreover bragg resonance can also be observed over the rectified cosinoidal bars set on the reef flat but the effect of the rectified cosinoidal bars is not as significant as the sinusoidal bars the results presented in this paper preliminarily reveal the feasibility of bragg reflection of water waves in reef environment and further investigation of the bragg reflections of irregular waves over fringing reefs can be expected keywords fringing reefs bragg reflection boussinesq model sinusoidal bars rectified cosinoidal bars 1 introduction fringing coral reefs widely distributed along the shoreline in tropical and sub tropical regions are becoming more and more significant to coastal engineers hydrodynamics associated with waves over fringing reefs has been extensively studied over the last decades since wave actions are recognized as an important agent in determining the reef top environment gourlay 1996 due to the steep fore reef face and shallow reef flat it is believed that fringing reefs can protect coastal areas from wave actions through the energy dissipation induced by strong wave breaking and bottom friction of the reef flat e g brander et al 2004 cuttler et al 2018 lugo fernández et al 1998 péquignet et al 2011 however it was reported during large wave events coastal areas fronted by fringing reefs were still vulnerable to wave inundation e g tajima et al 2014 yamano et al 2007 therefore protective engineering against wave inundation is developed along reef lined coasts some of which are already heavily populated so far the widespread protective engineering against coastal disasters is the breakwater facing the challenge of finding sustainable sources of aggregate armor stone and fresh water dredging and excavating reef flat to obtain the materials for protective engineering have been adopted in many atoll islands resulting in some permanent excavation pits on the reef flat yao et al 2016 and sea water is expected to replace the fresh water for concrete mixing some new concrete made from sulphoaluminate cement marine sand and sea water has been proposed and verified chen et al 2015 however the complex hydrodynamic conditions serious corrosion of steel bars and strong ultraviolet radiation in reef environment still threaten the structural performance and durability of conventional breakwaters besides yao et al 2016 numerically examined the impacts of the excavation pit on the wave processes over fringing reefs and found the excavation pit on the reef flat may increase the shoreline wave heights moreover it is reported that sea level rise coral bleaching and extreme weather conditions associated with climate change will have a significant negative impact on the ability of fringing reefs to mitigate the effects of coastal hazards in the future quataert et al 2015 therefore alternative or additional protective methods against wave actions over fringing reefs are still worthy of consideration for coastal engineers and managers it is well known that when the wavelength of the surface water wave is twice of the wave length of the bottom sinusoidal undulation wave reflection can be amplified and transmitted waves to the shore are significantly reduced which is the so called bragg reflection surface water waves scattered by the bragg reflection over periodic sea beds have been studied experimentally theoretically and numerically in the past decades e g cho and lee 2000 davies and heathershaw 1984 hsu et al 2007 hsu et al 2003 liu et al 2015b mei 1985 miles 1981 liu et al 2019a based on this phenomena many practical ocean structures as submerged breakwaters e g hsu et al 2003 liu et al 2015a liu et al 2016 mattioli 1990 tao et al 2017 twu and liu 2004 zhang et al 2012 have been proposed and studied for preventing the beaches and structures from wave attack compared to the conventional breakwaters submerged breakwaters in the sea have the merits of not affecting coastal aesthetics and allowing water circulation and fish passage these merits may be important for the reef environment because a cross shore current and 2dh circulations are frequently observed at reef sites yao et al 2018b however so far these studies were mainly focused on the bragg reflection of water waves over horizontal bottoms or mild plane beaches where incoming surface waves do not undergo significant transformation when approaching the undulated bottom or submerged breakwaters as for the reef bathymetry hydrodynamics associated with waves is more complex yao et al 2012 waves propagating onto shallow fringing reefs undergo significant transformations due to nonlinear steepening wave breaking over the steep fore reef face and reform bore propagation with steep crest fronts and long flat trailing regions over the reef flat nwogu and demirbilek 2010 high setup over the reef flat is also induced by strong wave breaking gourlay 1996 therefore application of bragg reflection of water waves in reef environment is still ambiguous as the wave shape and flow pattern over fringing reefs are different from the ones over horizontal bottoms or mildly sloping beds the main objective of this paper is to investigate the feasibility of bragg reflection of water waves over fringing reefs preliminarily based on a numerical model regular waves were just adopted in this numerical study for the reef bathymetry shock capturing ability is the desirable property for a model that aims at simulating nearshore reef hydrodynamics fang et al 2016 intense wave breaking on the steep fore reef slope induces an abrupt flow transition from dispersion dominated state to flux dominated state accurate capture of this shock related process requires satisfaction of conservation laws across flow discontinuities roeber and cheung 2012 it is well known that numerical models based on the nonlinear shallow water equations e g wang et al 2011 have the shock capturing capability however they lack frequency dispersion and fail in resolving short wave motions and the wave reformation process sophisticated models based on navier stokes equations e g wu and hsiao 2013 zhao et al 2014 are also operational to capture free surface flows accurately while this type of models may be still limited to relative small scale phenomena both in space and time domain due to their high computational costs over the last decades the successes of boussinesq type models are noted in modelling the entire evolution process of coastal waves from deep water to swash zone this modeling approach employs a polynomial approximation to the vertical profile of velocity field thereby reducing the dimensions of a three dimensional problem by one with relatively low computational costs comparing to the numerical models based on nonlinear shallow equations the boussinesq type model are reported better in predicting the wave processes in deeper water in front of the fringing reef because of retention of dispersive terms yao et al 2018a considering the merits of boussinesq type models recent efforts e g fang et al 2017 kazolea et al 2014 roeber and cheung 2012 shi et al 2012 tonelli and petti 2011 have been devoted to developing boussinesq type models with shock capturing capability therefore the fully nonlinear and dispersive shock capturing boussinesq model named funwave tvd shi et al 2012 is employed in the present study this model is the most recent implementation of the well known boussinesq model funwave kirby et al 1998 and has been validated for tsunami like solitary wave transformation over fringing reefs in recent studies e g kazolea et al 2019 ning et al 2019a in this paper we will firstly validate and calibrate funwave tvd version 3 0 with existing experimental data to confirm its ability in predicting bragg reflection of regular water waves on the horizontal bottom and regular wave characteristics over fringing reefs then the validated model will be applied to model regular wave processes over fringing reefs with sinusoidal bottom undulation on the reef flat variations of maximum run up height instead of reflection coefficient are utilized to confirm and investigate the effect of bragg reflection moreover rectified cosinoidal bars are also implemented on the reef flat to check the feasibility of practical application of submerged breakwaters directly put on the reef flat the remaining of this paper is organized as follows in section 2 the adopted numerical model funwave tvd is briefly reviewed in section 3 model validations with the existing experimental data of regular wave transformation over fringing reefs and bragg reflection of regular waves on the horizontal bottom are presented in section 4 the validated model is applied to investigate the bragg reflection of regular waves over fringing reefs including sinusoidal and rectified cosinoidal bars set on the reef flat finally main conclusions are summarized in section 5 2 brief description of the numerical model in this section the fully nonlinear and dispersive boussinesq wave model funwave tvd developed by shi et al 2012 is briefly introduced the model solves the fully nonlinear boussinesq equations proposed by chen 2006 which incorporate a moving reference level introduced by kennedy et al 2001 using a hybrid finite volume finite difference scheme the major difference between funwave tvd and the original funwave model is that the governing equations in funwave tvd are reorganized in a well balanced conservative form and numerically solved by a high order shock capturing tvd scheme this improvement allows the model to treat wave breaking as shock waves by switching the boussinesq equations to nonlinear shallow water equations making the implementation of an additional ad hoc dissipation term for wave breaking unnecessary consequently it does not require several empirical parameters as breaking criteria to tune the additional dissipation term and only the ratio of wave height to total water depth is used to trigger wave breaking with a threshold value set to 0 8 as suggested by tonelli and petti 2009 the third order strong stability preserving ssp runge kutta scheme is used for the time stepping implementing an adaptive time step instead of a uniform time step a quadratic friction law with a manning coefficient is used to characterize the bottom friction the value of the manning coefficient for surface materials can be easily found in standard text books of hydraulics the moving shoreline is also handled quite naturally as part of the reiman solver underlying the finite volume scheme more details of the present model can be referred to shi et al 2012 3 model validation as no existing experimental data of bragg reflection of regular water waves over a reef bathymetry are reported for model validation in this section the published experimental data of regular wave transformation over an idealized fringing reef and bragg reflection of regular waves over bottom undulations set on the horizontal bottom are used to validate the present model respectively 3 1 regular wave transformation over an idealized fringing reef yao et al 2012 presented a series of laboratory experiments in wave propagation over fringing reefs and the representative case of regular wave transformation over an idealized fringing reef is reproduced using the present model based on yao s experimental settings the numerical setup is shown in fig 1 the fore reef slope is 1 6 the offshore water depth h 0 is 0 45 m and the water depth over the reef flat h r is 0 1 m the incoming regular wave was generated by an internal wave maker which is 16 35 m from the toe of the fore reef slope with the incident height of 0 095 m and wave period of 1 25s sponge layers were put on both offshore and onshore sides manning coefficient was set as 0 012 to characterize the surface roughness of pvc plates used in yao s experiments fig 2 shows the measured and computed results of spatial distribution of wave height and mean water level twelve wave gauges g1 g12 were placed to record the surface water fluctuations in yao s experiment as shown in fig 1 the model was run for 200 wave cycles and the last 50 wave cycles were used for data analysis numerical simulations with different grid sizes i e dx 0 025 m dx 0 03 m dx 0 05 m were performed to demonstrate the sensitivity of the grid size since optimal grid resolution is important to introduce just the right amount of diffusion at the breaking point to correctly mimic the physics of the wave breaking for the present model chakrabarti et al 2017 shi et al 2012 the number of grids per incident wave length is 84 71 and 42 for dx 0 025 m dx 0 03 m and dx 0 05 m respectively numerical results of yao et al 2012 which were obtained from a fully nonlinear boussinesq model kim et al 2009 coupled with an ad hoc dissipation term kennedy et al 2000 for wave breaking are also presented for comparison as seen in fig 2 basically the simulations of the present model compare well with those of yao et al 2012 the breaking points predicted by the present model move onshore a little as the grid size gets finer simulated results with fine grids i e dx 0 025 m dx 0 03 m seem to capture the reformation of bore like waves after wave breaking better than those with dx 0 05 m and of yao since the grid size adopted in yao s numerical model is 0 03 m wave height prediction is confirmed to be more accurate using the present model mean water level is reasonably reproduced by the present model with all grid sizes it should be also noted that the ad hoc dissipation term an eddy viscosity term used in yao s model needs four empirical parameters the values of which need to be calibrated over plane beaches and fringing reefs while the present model with shock capturing scheme only uses the ratio of wave height to water depth whose default value is 0 8 as the criteria to switch boussinesq equations to nonlinear shallow water equations this ratio has been proved to be robust for wave processes over sloping plane beaches shi et al 2012 and solitary wave transformation over fringing reefs kazolea et al 2019 liu et al 2019b ning et al 2019a shao et al 2019 here we confirm that this ratio is also valid for the regular wave propagation over fringing reefs with no need of tuning the results presented here clearly demonstrate the robustness and advantages of the present model with shock capturing capability for regular wave processes over fringing reefs 3 2 bragg reflection of regular waves hsu et al 2007 conducted the pioneer work of extending boussinesq type model to bragg reflection of water waves compared with the results of the theoretical model miles 1981 and the numerical model using mild slope equation hsu et al 2003 the results of their boussinesq model are more consistent with the experimental data of davies and heathershaw 1984 and kirby and anton 1990 for regular waves in this study the experimental data of davies and heathershaw 1984 and kirby and anton 1990 were also used to validate the applicability of the present model in calculating the bragg reflection of regular waves based on their experiments the numerical setups are plotted in fig 3 and fig 4 where d is the amplitude of bars n is the number of bars s is the bar spacing and b is the width of a bar as seen in figs 3 and 4 sinusoidal bars and rectified cosinoidal bars were set over the horizontal bottom respectively rectified cosinoidal bars were used to mimic the practical submerged breakwaters the conditions of sinusoidal and rectified cosinoidal bars are listed in table 1 the grid size was 0 02 m and sponge layers were put on both offshore and onshore sides manning coefficient was also set as 0 012 to characterize the smooth surface in laboratory experiments two wave gauges were positioned in front of the bars for calculating the reflection coefficient based on the method of goda and suzuki 1976 the model was run for 100 wave cycles and the last 50 wave cycles were used for data analysis fig 5 shows the computed and measured reflection coefficient as a function of the dimensionless parameter 2s l l is the wave length of incident waves and 2s l is changed by changing l for sinusoidal bars the solutions and numerical results from miles theoretical formula 1981 and hsu s boussinesq model 2007 are also presented for comparison it can be seen the simulated results of the present model compare reasonably well with the experimental data mile s solutions obviously overestimate the reflection coefficient at the primary reflection peak numerical results of funwave tvd are close to those of hsu et al 2007 but the reflection coefficients around the primary reflection peak predicted by funwave tvd are a little lower than those predicted by hsu et al 2007 fig 6 shows the computed and measured reflection coefficient as a function of the dimensionless parameter 2s l for rectified cosinoidal bars as seen in fig 6 the simulated results of hsu et al 2007 and the present model have better overall agreement with the experimental data than those of miles theoretical results both the primary reflection peaks predicted by hsu et al 2007 and the present model deviate from 2s l 1 but the band width and reflection coefficients around the primary reflection peak of the present model is a little narrower and lower than those of hsu et al 2007 4 results and discussions after validation of the present model several numerical experiments were implemented to investigate the bragg reflection of regular water waves over fringing reefs 4 1 sinusoidal bars over fringing reefs in this section sinusoidal bars were implemented over the reef flat the sketch of numerical experiment setup is shown in fig 7 regular waves were generated by the internal wave maker which is 16 35 m from the toe of the fore reef slope and the computational domain with the length of 54 25 m and grid size of 0 03 m were applied an idealized reef beach profile which is similar to yao s physical model was implemented including a 1 6 fore reef slope a 9 8 m wide reef flat and a 1 12 back reef beach the offshore water depth is 0 45 m in which case the water depth over the reef flat is 0 1 m sinusoidal bars which are 2 m from the reef edge were implemented over the reef flat a 5 m sponge layer was set at the offshore side to absorb reflected waves from the reef conditions of incoming waves and sinusoidal bars are listed in table 2 as seen in table 2 three groups with different incident wave heights h i 0 095 m 0 11 m and 0 12 m and the same wave period t i 1 25s were designed for each group 2s l is changing from 0 7 to 1 3 to check whether bragg reflection is induced over the reef flat here l is the wave length over the reef flat and 2s l is changed by changing s the amplitude d and the number of bars n were 0 05 m and 4 in all groups the design of the numerical experiments was based on the froude similarity with a geometric scale factor of 1 50 so that the values of the reef geometry and hydrodynamic parameters i e fore reef slope reef flat width water depth over the reef flat at the prototype scale are all fall within the common ranges reported in the existing literatures as summarized by quataert et al 2015 and the incoming wave conditions at the prototype scale can be regarded as typical wave conditions during typhoons as waves propagating onto the shallow reef flat become strongly nonlinear we implemented a 1 12 plane slope as the back reef beach at the onshore side so that the maximum run up height can be utilized instead of the reflection coefficient computed by goda and suzuki s formula 1976 to check the effect of bragg reflection of water waves over fringing reefs manning coefficient n for the fringing reef was set as 0 05 this value was based on the values used by previous studies gelfenbaum et al 2011 kunkel et al 2006 in which n 0 02 represented a dead and smooth reef and n 0 05 represented a healthy and normal reef besides manning coefficient was fixed as 0 02 sand for the horizontal bottom in front of the fore reef slope and 0 04 cobbles for the back reef beach the simulation was run for 200 wave cycles and the last 50 wave cycles were used for data analysis figs 8 10 show the computed dimensionless maximum run up height r max r max as a function of 2s l for group a b c r max is the averaged maximum run up height of last 50 wave cycles with the presence of the sinusoidal bars and r max is the averaged maximum run up height of last 50 wave cycles without the presence of the sinusoidal bars as seen in figs 7 9 with the presence of the sinusoidal bars the maximum run up height can be reduced and the degree of reduction responses to the change of 2s l which confirms the bragg reflection effect induced by the sinusoidal bars over the reef flat the locations of primary reflection peaks for all groups are near 2s l 1 the maximum run up height can be reduced by more than 25 at the primary reflection peak fig 11 shows the comparisons of spatial distribution of wave height and mean water level for the incident regular wave of group a with 2s l 1 and without sinusoidal bars on the reef flat as seen in fig 11 the modulation of wave height is enhanced at the seaward side of sinusoidal bars and wave height is reduced obviously after waves travel across the sinusoidal bars this further confirms the existence of bragg reflection induced by the sinusoidal bars on the reef flat mean water level over the reef flat is not affected much and slightly lower with the presence of sinusoidal bars 4 2 effects of parameters of sinusoidal bars in this section the effects of parameters of sinusoidal bars including the number of bars n the relative bar height d h r on the bragg reflection of regular waves over fringing reefs are investigated figs 12 14 show the computed r max r max as a function of 2s l for group a b c with different numbers of bars for the effect of the number of bars guazzelli et al 1992 performed some laboratory experiments and indicated that the peak amplitude of the bragg reflection of regular waves increases and the bandwidth decreases for increasing number of the sinusoidal bars on the horizontal bottom as seen in figs 12 14 the peak amplitude of the bragg reflection on the fringing reefs also increases with the increase of the number of bars but the bandwidth of the primary reflection seems to be not affected much the effect of number of bars is significant and the maximum run up height can be reduced by about 50 when n 8 figs 15 17 show the computed r max r max as a function of 2s l for group a b c with different relative bar heights hsu et al 2007 applied their boussinesq model to calculate the bragg reflections of regular waves by using kirby and anton 1990 s experimental conditions with different relative bar heights it was found the peak of the primary resonance increases with the increase of the relative bar height and the location of the primary peak reflections deviates from 2s l 1 with increasing the relative bar height as seen in figs 15 17 the effect of relative bar heights over fringing reefs on bragg reflection is similar the peak of the primary resonance increases and the location of the primary peak reflections deviates from 2s l 1 with the increase of the relative bar height within the tested range the effect of the relative bar height is not as significant as the effect of the number of bars and the primary peak reflections shifts when the relative bar height is changed therefore increasing the number of bars may be a more effective way to enhance the bragg reflection over fringing reefs 4 3 rectified cosinoidal bars over fringing reefs the sinusoidal bars used in section 4 1 are the idealized bottom undulation for bragg resonance as for a practical use artificial ocean structures as a series of submerged breakwaters are usually adopted based on the bragg resonance principle these structures are designed to put on the seabed discretely without excavating the seabed to create concaves the rectified cosinoidal bars in kirby and anton 1990 s experiments were used just for mimicking the artificial ocean structures fig 18 shows r max r max as a function of 2s l over the rectified cosinoidal bars without concaves as well as the sinusoidal bars on the reef flat for group a the effect of bragg resonance can be still observed over cosinoidal bars which indicates the practical application of submerged breakwaters directly put on the reef flat is possible but it is also noted the effect of bragg resonance over the cosinoidal bars is not as significant as the sinusoidal bars this indicates that instead of excavation pits which may enhance the shoreline wave heights excavating the reef flat can be projected based on the bragg resonance principle to increase wave reflection submerged bars can also be made from materials obtained from excavating the reef flat the wave shape and flow pattern over fringing reefs are much different from those over horizontal bottoms or mildly sloping beds used in previous studies of bragg reflections the results presented in section 4 preliminarily reveal the feasibility of bragg reflection of water waves in reef environment the maximum run up height can be reduced with the presence of bottom undulations set on the reef flat in reality the infragravity waves released from the breaking of irregular waves over fringing reefs have been recognized as the main cause of the large inundation along the reef lined coasts during large wave events cheriton et al 2016 as revealed in previous studies e g nwogu and demirbilek 2010 yao et al 2012 ning et al 2019b the high frequency sea swell wave energy transfers to a low frequency band during irregular wave propagation over the reef flat and under certain wave conditions infragravity waves whose frequencies are around the natural frequency of the reef beach system may be trapped and form resonant oscillations over the reef flat e g nwogu and demirbilek 2010 péquignet et al 2009 pomeroy et al 2012 although this study only adopted regular waves we speculate based on the presented results that for irregular waves spatial variability of infragravity wave may also be affected with the presence of bottom undulations set on the reef flat since high frequency incident sea swell wave energy may be reflected by the bragg resonance before it transfers to the infragravity band but one major concern is that the wave spectrum of irregular wave is changing continuously over the reef flat this makes the application of bragg reflection of irregular waves over fringing reefs remain anecdotal future studies should be necessary for a better understanding of bragg reflections of irregular waves over fringing reefs 5 conclusions in this paper the fully nonlinear boussinesq wave model funwave tvd was utilized to investigate the feasibility of bragg reflection of water waves over fringing reefs the published experimental data of regular wave transformation over an idealized fringing reef and bragg reflection of regular waves over the horizontal bottom were used to validate the present model respectively validation results show that the present model can reasonably reproduce the regular wave processes over a reef bathymetry and reflection coefficients of sinusoidal and rectified cosinoidal bars with a proper grid size the present model with shock capturing capability shows better prediction of the reformation of bore like waves after wave breaking over fringing reefs compared to the boussinesq model coupled with an empirical breaking model the validated model was then utilized to investigate the bragg reflection of regular waves over fringing reefs the results clearly show the sinusoidal bars set on the reef flat can reduce the wave run up height and confirm the bragg resonance effect over the reef bathymetry the basic effects of key parameters of sinusoidal bars i e the number of bars and the relative bar height on the bragg reflection of regular waves over fringing reefs are slightly different to those over the horizontal bottom increasing the number of bars should be a more effective way to enhance the effect of the bragg reflection over fringing reefs in addition the effect of bragg resonance can also be observed over the rectified cosinoidal bars set on the reef flat which indicates the practical application of submerged breakwaters directly put on the reef flat is possible but excavating the reef flat based on the bragg resonance principle may be still useful to enhance the wave reflection over fringing reefs we have to confess the results presented in this paper are preliminary and aimed to give coastal engineers and managers some insights into the feasibility of bragg reflection in reef environment in reality irregular waves are more representative of incident wave conditions especially during the large wave events in reef environments future work should be conducted to investigate the bragg reflections of irregular waves over fringing reefs for a better understanding of bragg resonance on reefs acknowledgements this work was funded by the national natural science foundation of china grant nos 51809234 and 51679212 the key laboratory of port waterway sedimentation engineering ministry of communications china grant no yn918002 the key laboratory of coastal disasters and defense of ministry of education china grant no 201708 zhejiang provincial natural science foundation of china grant no lr16e090002 and the fundamental research funds for the central universities of china grant no 2018qna4041 
22433,the bragg reflection of regular waves over fringing reefs is studied using a shock capturing boussinesq model funwave tvd model validation shows the present model can reasonably reproduce regular wave processes over a reef bathymetry with a proper grid size and bragg reflection induced by sinusoidal and rectified cosinoidal bars set on the horizontal bottom numerical results clearly show the sinusoidal bars set on the reef flat can reduce the maximum run up height and confirm the bragg resonance effect over the reef bathymetry the basic effects of parameters of sinusoidal bars i e the number of bars and the relative bar height on the bragg reflection of regular waves over fringing reefs are slightly different to the ones over the horizontal bottom moreover bragg resonance can also be observed over the rectified cosinoidal bars set on the reef flat but the effect of the rectified cosinoidal bars is not as significant as the sinusoidal bars the results presented in this paper preliminarily reveal the feasibility of bragg reflection of water waves in reef environment and further investigation of the bragg reflections of irregular waves over fringing reefs can be expected keywords fringing reefs bragg reflection boussinesq model sinusoidal bars rectified cosinoidal bars 1 introduction fringing coral reefs widely distributed along the shoreline in tropical and sub tropical regions are becoming more and more significant to coastal engineers hydrodynamics associated with waves over fringing reefs has been extensively studied over the last decades since wave actions are recognized as an important agent in determining the reef top environment gourlay 1996 due to the steep fore reef face and shallow reef flat it is believed that fringing reefs can protect coastal areas from wave actions through the energy dissipation induced by strong wave breaking and bottom friction of the reef flat e g brander et al 2004 cuttler et al 2018 lugo fernández et al 1998 péquignet et al 2011 however it was reported during large wave events coastal areas fronted by fringing reefs were still vulnerable to wave inundation e g tajima et al 2014 yamano et al 2007 therefore protective engineering against wave inundation is developed along reef lined coasts some of which are already heavily populated so far the widespread protective engineering against coastal disasters is the breakwater facing the challenge of finding sustainable sources of aggregate armor stone and fresh water dredging and excavating reef flat to obtain the materials for protective engineering have been adopted in many atoll islands resulting in some permanent excavation pits on the reef flat yao et al 2016 and sea water is expected to replace the fresh water for concrete mixing some new concrete made from sulphoaluminate cement marine sand and sea water has been proposed and verified chen et al 2015 however the complex hydrodynamic conditions serious corrosion of steel bars and strong ultraviolet radiation in reef environment still threaten the structural performance and durability of conventional breakwaters besides yao et al 2016 numerically examined the impacts of the excavation pit on the wave processes over fringing reefs and found the excavation pit on the reef flat may increase the shoreline wave heights moreover it is reported that sea level rise coral bleaching and extreme weather conditions associated with climate change will have a significant negative impact on the ability of fringing reefs to mitigate the effects of coastal hazards in the future quataert et al 2015 therefore alternative or additional protective methods against wave actions over fringing reefs are still worthy of consideration for coastal engineers and managers it is well known that when the wavelength of the surface water wave is twice of the wave length of the bottom sinusoidal undulation wave reflection can be amplified and transmitted waves to the shore are significantly reduced which is the so called bragg reflection surface water waves scattered by the bragg reflection over periodic sea beds have been studied experimentally theoretically and numerically in the past decades e g cho and lee 2000 davies and heathershaw 1984 hsu et al 2007 hsu et al 2003 liu et al 2015b mei 1985 miles 1981 liu et al 2019a based on this phenomena many practical ocean structures as submerged breakwaters e g hsu et al 2003 liu et al 2015a liu et al 2016 mattioli 1990 tao et al 2017 twu and liu 2004 zhang et al 2012 have been proposed and studied for preventing the beaches and structures from wave attack compared to the conventional breakwaters submerged breakwaters in the sea have the merits of not affecting coastal aesthetics and allowing water circulation and fish passage these merits may be important for the reef environment because a cross shore current and 2dh circulations are frequently observed at reef sites yao et al 2018b however so far these studies were mainly focused on the bragg reflection of water waves over horizontal bottoms or mild plane beaches where incoming surface waves do not undergo significant transformation when approaching the undulated bottom or submerged breakwaters as for the reef bathymetry hydrodynamics associated with waves is more complex yao et al 2012 waves propagating onto shallow fringing reefs undergo significant transformations due to nonlinear steepening wave breaking over the steep fore reef face and reform bore propagation with steep crest fronts and long flat trailing regions over the reef flat nwogu and demirbilek 2010 high setup over the reef flat is also induced by strong wave breaking gourlay 1996 therefore application of bragg reflection of water waves in reef environment is still ambiguous as the wave shape and flow pattern over fringing reefs are different from the ones over horizontal bottoms or mildly sloping beds the main objective of this paper is to investigate the feasibility of bragg reflection of water waves over fringing reefs preliminarily based on a numerical model regular waves were just adopted in this numerical study for the reef bathymetry shock capturing ability is the desirable property for a model that aims at simulating nearshore reef hydrodynamics fang et al 2016 intense wave breaking on the steep fore reef slope induces an abrupt flow transition from dispersion dominated state to flux dominated state accurate capture of this shock related process requires satisfaction of conservation laws across flow discontinuities roeber and cheung 2012 it is well known that numerical models based on the nonlinear shallow water equations e g wang et al 2011 have the shock capturing capability however they lack frequency dispersion and fail in resolving short wave motions and the wave reformation process sophisticated models based on navier stokes equations e g wu and hsiao 2013 zhao et al 2014 are also operational to capture free surface flows accurately while this type of models may be still limited to relative small scale phenomena both in space and time domain due to their high computational costs over the last decades the successes of boussinesq type models are noted in modelling the entire evolution process of coastal waves from deep water to swash zone this modeling approach employs a polynomial approximation to the vertical profile of velocity field thereby reducing the dimensions of a three dimensional problem by one with relatively low computational costs comparing to the numerical models based on nonlinear shallow equations the boussinesq type model are reported better in predicting the wave processes in deeper water in front of the fringing reef because of retention of dispersive terms yao et al 2018a considering the merits of boussinesq type models recent efforts e g fang et al 2017 kazolea et al 2014 roeber and cheung 2012 shi et al 2012 tonelli and petti 2011 have been devoted to developing boussinesq type models with shock capturing capability therefore the fully nonlinear and dispersive shock capturing boussinesq model named funwave tvd shi et al 2012 is employed in the present study this model is the most recent implementation of the well known boussinesq model funwave kirby et al 1998 and has been validated for tsunami like solitary wave transformation over fringing reefs in recent studies e g kazolea et al 2019 ning et al 2019a in this paper we will firstly validate and calibrate funwave tvd version 3 0 with existing experimental data to confirm its ability in predicting bragg reflection of regular water waves on the horizontal bottom and regular wave characteristics over fringing reefs then the validated model will be applied to model regular wave processes over fringing reefs with sinusoidal bottom undulation on the reef flat variations of maximum run up height instead of reflection coefficient are utilized to confirm and investigate the effect of bragg reflection moreover rectified cosinoidal bars are also implemented on the reef flat to check the feasibility of practical application of submerged breakwaters directly put on the reef flat the remaining of this paper is organized as follows in section 2 the adopted numerical model funwave tvd is briefly reviewed in section 3 model validations with the existing experimental data of regular wave transformation over fringing reefs and bragg reflection of regular waves on the horizontal bottom are presented in section 4 the validated model is applied to investigate the bragg reflection of regular waves over fringing reefs including sinusoidal and rectified cosinoidal bars set on the reef flat finally main conclusions are summarized in section 5 2 brief description of the numerical model in this section the fully nonlinear and dispersive boussinesq wave model funwave tvd developed by shi et al 2012 is briefly introduced the model solves the fully nonlinear boussinesq equations proposed by chen 2006 which incorporate a moving reference level introduced by kennedy et al 2001 using a hybrid finite volume finite difference scheme the major difference between funwave tvd and the original funwave model is that the governing equations in funwave tvd are reorganized in a well balanced conservative form and numerically solved by a high order shock capturing tvd scheme this improvement allows the model to treat wave breaking as shock waves by switching the boussinesq equations to nonlinear shallow water equations making the implementation of an additional ad hoc dissipation term for wave breaking unnecessary consequently it does not require several empirical parameters as breaking criteria to tune the additional dissipation term and only the ratio of wave height to total water depth is used to trigger wave breaking with a threshold value set to 0 8 as suggested by tonelli and petti 2009 the third order strong stability preserving ssp runge kutta scheme is used for the time stepping implementing an adaptive time step instead of a uniform time step a quadratic friction law with a manning coefficient is used to characterize the bottom friction the value of the manning coefficient for surface materials can be easily found in standard text books of hydraulics the moving shoreline is also handled quite naturally as part of the reiman solver underlying the finite volume scheme more details of the present model can be referred to shi et al 2012 3 model validation as no existing experimental data of bragg reflection of regular water waves over a reef bathymetry are reported for model validation in this section the published experimental data of regular wave transformation over an idealized fringing reef and bragg reflection of regular waves over bottom undulations set on the horizontal bottom are used to validate the present model respectively 3 1 regular wave transformation over an idealized fringing reef yao et al 2012 presented a series of laboratory experiments in wave propagation over fringing reefs and the representative case of regular wave transformation over an idealized fringing reef is reproduced using the present model based on yao s experimental settings the numerical setup is shown in fig 1 the fore reef slope is 1 6 the offshore water depth h 0 is 0 45 m and the water depth over the reef flat h r is 0 1 m the incoming regular wave was generated by an internal wave maker which is 16 35 m from the toe of the fore reef slope with the incident height of 0 095 m and wave period of 1 25s sponge layers were put on both offshore and onshore sides manning coefficient was set as 0 012 to characterize the surface roughness of pvc plates used in yao s experiments fig 2 shows the measured and computed results of spatial distribution of wave height and mean water level twelve wave gauges g1 g12 were placed to record the surface water fluctuations in yao s experiment as shown in fig 1 the model was run for 200 wave cycles and the last 50 wave cycles were used for data analysis numerical simulations with different grid sizes i e dx 0 025 m dx 0 03 m dx 0 05 m were performed to demonstrate the sensitivity of the grid size since optimal grid resolution is important to introduce just the right amount of diffusion at the breaking point to correctly mimic the physics of the wave breaking for the present model chakrabarti et al 2017 shi et al 2012 the number of grids per incident wave length is 84 71 and 42 for dx 0 025 m dx 0 03 m and dx 0 05 m respectively numerical results of yao et al 2012 which were obtained from a fully nonlinear boussinesq model kim et al 2009 coupled with an ad hoc dissipation term kennedy et al 2000 for wave breaking are also presented for comparison as seen in fig 2 basically the simulations of the present model compare well with those of yao et al 2012 the breaking points predicted by the present model move onshore a little as the grid size gets finer simulated results with fine grids i e dx 0 025 m dx 0 03 m seem to capture the reformation of bore like waves after wave breaking better than those with dx 0 05 m and of yao since the grid size adopted in yao s numerical model is 0 03 m wave height prediction is confirmed to be more accurate using the present model mean water level is reasonably reproduced by the present model with all grid sizes it should be also noted that the ad hoc dissipation term an eddy viscosity term used in yao s model needs four empirical parameters the values of which need to be calibrated over plane beaches and fringing reefs while the present model with shock capturing scheme only uses the ratio of wave height to water depth whose default value is 0 8 as the criteria to switch boussinesq equations to nonlinear shallow water equations this ratio has been proved to be robust for wave processes over sloping plane beaches shi et al 2012 and solitary wave transformation over fringing reefs kazolea et al 2019 liu et al 2019b ning et al 2019a shao et al 2019 here we confirm that this ratio is also valid for the regular wave propagation over fringing reefs with no need of tuning the results presented here clearly demonstrate the robustness and advantages of the present model with shock capturing capability for regular wave processes over fringing reefs 3 2 bragg reflection of regular waves hsu et al 2007 conducted the pioneer work of extending boussinesq type model to bragg reflection of water waves compared with the results of the theoretical model miles 1981 and the numerical model using mild slope equation hsu et al 2003 the results of their boussinesq model are more consistent with the experimental data of davies and heathershaw 1984 and kirby and anton 1990 for regular waves in this study the experimental data of davies and heathershaw 1984 and kirby and anton 1990 were also used to validate the applicability of the present model in calculating the bragg reflection of regular waves based on their experiments the numerical setups are plotted in fig 3 and fig 4 where d is the amplitude of bars n is the number of bars s is the bar spacing and b is the width of a bar as seen in figs 3 and 4 sinusoidal bars and rectified cosinoidal bars were set over the horizontal bottom respectively rectified cosinoidal bars were used to mimic the practical submerged breakwaters the conditions of sinusoidal and rectified cosinoidal bars are listed in table 1 the grid size was 0 02 m and sponge layers were put on both offshore and onshore sides manning coefficient was also set as 0 012 to characterize the smooth surface in laboratory experiments two wave gauges were positioned in front of the bars for calculating the reflection coefficient based on the method of goda and suzuki 1976 the model was run for 100 wave cycles and the last 50 wave cycles were used for data analysis fig 5 shows the computed and measured reflection coefficient as a function of the dimensionless parameter 2s l l is the wave length of incident waves and 2s l is changed by changing l for sinusoidal bars the solutions and numerical results from miles theoretical formula 1981 and hsu s boussinesq model 2007 are also presented for comparison it can be seen the simulated results of the present model compare reasonably well with the experimental data mile s solutions obviously overestimate the reflection coefficient at the primary reflection peak numerical results of funwave tvd are close to those of hsu et al 2007 but the reflection coefficients around the primary reflection peak predicted by funwave tvd are a little lower than those predicted by hsu et al 2007 fig 6 shows the computed and measured reflection coefficient as a function of the dimensionless parameter 2s l for rectified cosinoidal bars as seen in fig 6 the simulated results of hsu et al 2007 and the present model have better overall agreement with the experimental data than those of miles theoretical results both the primary reflection peaks predicted by hsu et al 2007 and the present model deviate from 2s l 1 but the band width and reflection coefficients around the primary reflection peak of the present model is a little narrower and lower than those of hsu et al 2007 4 results and discussions after validation of the present model several numerical experiments were implemented to investigate the bragg reflection of regular water waves over fringing reefs 4 1 sinusoidal bars over fringing reefs in this section sinusoidal bars were implemented over the reef flat the sketch of numerical experiment setup is shown in fig 7 regular waves were generated by the internal wave maker which is 16 35 m from the toe of the fore reef slope and the computational domain with the length of 54 25 m and grid size of 0 03 m were applied an idealized reef beach profile which is similar to yao s physical model was implemented including a 1 6 fore reef slope a 9 8 m wide reef flat and a 1 12 back reef beach the offshore water depth is 0 45 m in which case the water depth over the reef flat is 0 1 m sinusoidal bars which are 2 m from the reef edge were implemented over the reef flat a 5 m sponge layer was set at the offshore side to absorb reflected waves from the reef conditions of incoming waves and sinusoidal bars are listed in table 2 as seen in table 2 three groups with different incident wave heights h i 0 095 m 0 11 m and 0 12 m and the same wave period t i 1 25s were designed for each group 2s l is changing from 0 7 to 1 3 to check whether bragg reflection is induced over the reef flat here l is the wave length over the reef flat and 2s l is changed by changing s the amplitude d and the number of bars n were 0 05 m and 4 in all groups the design of the numerical experiments was based on the froude similarity with a geometric scale factor of 1 50 so that the values of the reef geometry and hydrodynamic parameters i e fore reef slope reef flat width water depth over the reef flat at the prototype scale are all fall within the common ranges reported in the existing literatures as summarized by quataert et al 2015 and the incoming wave conditions at the prototype scale can be regarded as typical wave conditions during typhoons as waves propagating onto the shallow reef flat become strongly nonlinear we implemented a 1 12 plane slope as the back reef beach at the onshore side so that the maximum run up height can be utilized instead of the reflection coefficient computed by goda and suzuki s formula 1976 to check the effect of bragg reflection of water waves over fringing reefs manning coefficient n for the fringing reef was set as 0 05 this value was based on the values used by previous studies gelfenbaum et al 2011 kunkel et al 2006 in which n 0 02 represented a dead and smooth reef and n 0 05 represented a healthy and normal reef besides manning coefficient was fixed as 0 02 sand for the horizontal bottom in front of the fore reef slope and 0 04 cobbles for the back reef beach the simulation was run for 200 wave cycles and the last 50 wave cycles were used for data analysis figs 8 10 show the computed dimensionless maximum run up height r max r max as a function of 2s l for group a b c r max is the averaged maximum run up height of last 50 wave cycles with the presence of the sinusoidal bars and r max is the averaged maximum run up height of last 50 wave cycles without the presence of the sinusoidal bars as seen in figs 7 9 with the presence of the sinusoidal bars the maximum run up height can be reduced and the degree of reduction responses to the change of 2s l which confirms the bragg reflection effect induced by the sinusoidal bars over the reef flat the locations of primary reflection peaks for all groups are near 2s l 1 the maximum run up height can be reduced by more than 25 at the primary reflection peak fig 11 shows the comparisons of spatial distribution of wave height and mean water level for the incident regular wave of group a with 2s l 1 and without sinusoidal bars on the reef flat as seen in fig 11 the modulation of wave height is enhanced at the seaward side of sinusoidal bars and wave height is reduced obviously after waves travel across the sinusoidal bars this further confirms the existence of bragg reflection induced by the sinusoidal bars on the reef flat mean water level over the reef flat is not affected much and slightly lower with the presence of sinusoidal bars 4 2 effects of parameters of sinusoidal bars in this section the effects of parameters of sinusoidal bars including the number of bars n the relative bar height d h r on the bragg reflection of regular waves over fringing reefs are investigated figs 12 14 show the computed r max r max as a function of 2s l for group a b c with different numbers of bars for the effect of the number of bars guazzelli et al 1992 performed some laboratory experiments and indicated that the peak amplitude of the bragg reflection of regular waves increases and the bandwidth decreases for increasing number of the sinusoidal bars on the horizontal bottom as seen in figs 12 14 the peak amplitude of the bragg reflection on the fringing reefs also increases with the increase of the number of bars but the bandwidth of the primary reflection seems to be not affected much the effect of number of bars is significant and the maximum run up height can be reduced by about 50 when n 8 figs 15 17 show the computed r max r max as a function of 2s l for group a b c with different relative bar heights hsu et al 2007 applied their boussinesq model to calculate the bragg reflections of regular waves by using kirby and anton 1990 s experimental conditions with different relative bar heights it was found the peak of the primary resonance increases with the increase of the relative bar height and the location of the primary peak reflections deviates from 2s l 1 with increasing the relative bar height as seen in figs 15 17 the effect of relative bar heights over fringing reefs on bragg reflection is similar the peak of the primary resonance increases and the location of the primary peak reflections deviates from 2s l 1 with the increase of the relative bar height within the tested range the effect of the relative bar height is not as significant as the effect of the number of bars and the primary peak reflections shifts when the relative bar height is changed therefore increasing the number of bars may be a more effective way to enhance the bragg reflection over fringing reefs 4 3 rectified cosinoidal bars over fringing reefs the sinusoidal bars used in section 4 1 are the idealized bottom undulation for bragg resonance as for a practical use artificial ocean structures as a series of submerged breakwaters are usually adopted based on the bragg resonance principle these structures are designed to put on the seabed discretely without excavating the seabed to create concaves the rectified cosinoidal bars in kirby and anton 1990 s experiments were used just for mimicking the artificial ocean structures fig 18 shows r max r max as a function of 2s l over the rectified cosinoidal bars without concaves as well as the sinusoidal bars on the reef flat for group a the effect of bragg resonance can be still observed over cosinoidal bars which indicates the practical application of submerged breakwaters directly put on the reef flat is possible but it is also noted the effect of bragg resonance over the cosinoidal bars is not as significant as the sinusoidal bars this indicates that instead of excavation pits which may enhance the shoreline wave heights excavating the reef flat can be projected based on the bragg resonance principle to increase wave reflection submerged bars can also be made from materials obtained from excavating the reef flat the wave shape and flow pattern over fringing reefs are much different from those over horizontal bottoms or mildly sloping beds used in previous studies of bragg reflections the results presented in section 4 preliminarily reveal the feasibility of bragg reflection of water waves in reef environment the maximum run up height can be reduced with the presence of bottom undulations set on the reef flat in reality the infragravity waves released from the breaking of irregular waves over fringing reefs have been recognized as the main cause of the large inundation along the reef lined coasts during large wave events cheriton et al 2016 as revealed in previous studies e g nwogu and demirbilek 2010 yao et al 2012 ning et al 2019b the high frequency sea swell wave energy transfers to a low frequency band during irregular wave propagation over the reef flat and under certain wave conditions infragravity waves whose frequencies are around the natural frequency of the reef beach system may be trapped and form resonant oscillations over the reef flat e g nwogu and demirbilek 2010 péquignet et al 2009 pomeroy et al 2012 although this study only adopted regular waves we speculate based on the presented results that for irregular waves spatial variability of infragravity wave may also be affected with the presence of bottom undulations set on the reef flat since high frequency incident sea swell wave energy may be reflected by the bragg resonance before it transfers to the infragravity band but one major concern is that the wave spectrum of irregular wave is changing continuously over the reef flat this makes the application of bragg reflection of irregular waves over fringing reefs remain anecdotal future studies should be necessary for a better understanding of bragg reflections of irregular waves over fringing reefs 5 conclusions in this paper the fully nonlinear boussinesq wave model funwave tvd was utilized to investigate the feasibility of bragg reflection of water waves over fringing reefs the published experimental data of regular wave transformation over an idealized fringing reef and bragg reflection of regular waves over the horizontal bottom were used to validate the present model respectively validation results show that the present model can reasonably reproduce the regular wave processes over a reef bathymetry and reflection coefficients of sinusoidal and rectified cosinoidal bars with a proper grid size the present model with shock capturing capability shows better prediction of the reformation of bore like waves after wave breaking over fringing reefs compared to the boussinesq model coupled with an empirical breaking model the validated model was then utilized to investigate the bragg reflection of regular waves over fringing reefs the results clearly show the sinusoidal bars set on the reef flat can reduce the wave run up height and confirm the bragg resonance effect over the reef bathymetry the basic effects of key parameters of sinusoidal bars i e the number of bars and the relative bar height on the bragg reflection of regular waves over fringing reefs are slightly different to those over the horizontal bottom increasing the number of bars should be a more effective way to enhance the effect of the bragg reflection over fringing reefs in addition the effect of bragg resonance can also be observed over the rectified cosinoidal bars set on the reef flat which indicates the practical application of submerged breakwaters directly put on the reef flat is possible but excavating the reef flat based on the bragg resonance principle may be still useful to enhance the wave reflection over fringing reefs we have to confess the results presented in this paper are preliminary and aimed to give coastal engineers and managers some insights into the feasibility of bragg reflection in reef environment in reality irregular waves are more representative of incident wave conditions especially during the large wave events in reef environments future work should be conducted to investigate the bragg reflections of irregular waves over fringing reefs for a better understanding of bragg resonance on reefs acknowledgements this work was funded by the national natural science foundation of china grant nos 51809234 and 51679212 the key laboratory of port waterway sedimentation engineering ministry of communications china grant no yn918002 the key laboratory of coastal disasters and defense of ministry of education china grant no 201708 zhejiang provincial natural science foundation of china grant no lr16e090002 and the fundamental research funds for the central universities of china grant no 2018qna4041 
22434,in this paper a mooring system design methodology combining the non dominated sorting genetic algorithm ii nsga ii with the vessel mooring coupled model is first proposed in the proposed methodology the multi objective optimization problem for mooring system design which involves several design variables objective functions and constraints is established and solved by the combination of the nsga ii algorithm and the vessel mooring coupled model and the initial feasible range of design variables is narrowed in advance by combining the nsga ii with the quasi static mooring system model a case study is presented to demonstrated the proposed methodology in which a catenary mooring system is designed from scratch for a semi submersible very large floating structure vlfs module it can be concluded from the obtained results that owing to the combination of the nsga ii algorithm and the vessel mooring coupled model the accurate dynamic responses of vessel and mooring systems can be used as the objective functions thus the proposed methodology is able to attain an optimal mooring system considering more practical design requirements such as the vessel motion response the safety factor of the mooring system the length of mooring line lay down part and mooring system layout keywords mooring system design methodology vessel mooring coupled model multi objective optimization problem nsga ii 1 introduction the rapid exploration and exploitation of ocean resources have led to the design and manufacture of a great number of different floating structures such as semi submersible platforms spar platforms tension leg platforms tlp and floating production storage and offloading fpso etc the station keeping systems for these floating structures have been intensively investigated in the literature bhattacharya et al 2006 wang and tay 2011 lamas pardo et al 2015 zhang et al 2015 etc being simple safe and inexpensive mooring systems have become an essential choice in the station keeping systems of floating structures chas and garcía 2008 mooring system design has been the subject of many studies recently beyond the realm of ocean engineering industries girón et al 2014 proposed an integrated design methodology for mooring systems and risers their study focused on the selection of governing critical loading cases and the interaction of mooring system and risers whereas the specific mooring system design process was not detailed benassai et al 2014a b 2015 dealt with a catenary mooring system design for a tri floater floating offshore wind turbine they investigated the variation in line length and diameter of three candidate mooring systems at different water depths the performance of the three candidate mooring systems in terms of ultimate limit states uls and accidental limit states als was also examined campanile et al 2018 designed and selected a mooring system for floating offshore wind turbines in their study 6 and 9 line mooring configurations were selected as design candidates and were compared and modified according to their performances under the varying environmental conditions of the southern and northern regions of the north sea the design of mooring systems involves several variables objectives and constraints and thus can be transformed into a multi objective optimization problem shafieefar and rezvani 2007 proposed a mooring system optimization design method based on a genetic algorithm ga they established a single objective optimization problem for mooring system design by normalizing objective functions based on a weighted sum method felix gonzalez and mercier 2016 introduced a design method based on static equivalence and ga in their study three objective functions were normalized by utilizing several sets of weighting factors it was found from their study that the selection of the weighting factor has a significant impact on the mooring system design results brommundt et al 2012 described a new tool for the optimization design of a catenary mooring system for a floating wind turbine the optimization problem with four design variables and three constraints was established and solved by a nelder mead simplex algorithm however minimization of the mooring line length was the only design objective considered in their study da fonseca monteiro et al 2016 proposed a mooring system design methodology based on the particle swarm optimization pso method and the differential evolution de method in their study the mooring system design problem was transformed into a single objective optimization problem by normalizing objective functions with a kind of averaging method other than the above studies there are several researches related to truncated mooring system design for model testing such as su et al 2009 zhang et al 2012 wei et al 2017 among others they established a multi objective optimization problem for mooring system truncation and solved it using a non dominated sorting genetic algorithm ii nsga ii despite many studies dedicated to designing a mooring system from scratch as the design problem is complex involving multiple objectives and weighting factors of these objectives cannot be accurately estimated in advance problems remain regarding the unified consideration of multiple objectives and over simplified models in this paper a mooring system design methodology combining the nsga ii algorithm with the vessel mooring coupled model is first proposed in the proposed methodology a multi objective optimization problem for mooring system design is established in which the vessel mooring coupled model is adopted to calculate the dynamic characteristics of the mooring system and the nsga ii algorithm is utilized to find the optimal mooring system parameters owing to the combining of the nsga ii algorithm and the vessel mooring coupled model the accurate dynamic characteristics of vessel and mooring system can be used as the objective functions and do not need to be normalized the proposed methodology allows for the design of an optimal mooring system considering more practical requirements such as the vessel motion response the safety factor of the mooring system the length of the mooring line lay down part and the mooring system layout compared with traditional methods 2 mathematical modeling of mooring line 2 1 coordinated system and notations the different coordinate systems used are illustrated in fig 1 and described below 1 the global coordinate system o x y z fixed in space with o x y located at the still water surface and the z axis oriented straight up 2 the body fixed coordinate system o b x b y b z b is fixed to the vessel which coincides with the global coordinate system in its initial position the incident wave angle is 0 if the wave travels along the positive direction of the x axis and increases in a counter clockwise direction 2 2 lumped mass method the lumped mass method is generally used for modeling the mooring line low and langley 2006 xiong et al 2016 according to the lumped mass method a mooring line is divided into several elements the mass and external forces acting on each element are lumped at its two end nodes thus the line element is regarded as a massless spring fig 2 illustrates the lumped mass model of three arbitrary nodes numbered from 1 to 3 which connect to element j and k the y 1 y 2 y 3 are respectively the coordinates of the nodes 1 2 3 in the global coordinate system at the equilibrium position the governing equation of each node can be expressed as 1 m y f y y where m is the mass matrix y y and y are the acceleration velocity and position vector respectively f is the external force lumped at each node which includes tension gravity buoyancy hydrodynamic force and seabed interaction force 2 2 1 line tension for an arbitrary element i e element j the elastic potential energy can be expressed as 2 v j 1 2 e a l j y 2 y 1 l j 2 where v j is the elastic potential energy e is the young s modulus a is the cross section area of line l j is the non stretched length thus the tension of one end node i e node 2 provided by element j can be derived 3 t 2 j v j y 2 q e a 1 l j 1 y 2 y 1 y 1 y 2 where t 2 j is the tension on node 2 provided by j th element q can be 1 2 3 corresponding to the global coordinate x y z respectively 2 2 2 gravity and buoyancy the resultant force of gravity and buoyancy of a submerged node i e node 2 comes from the two adjacent line elements 4 g 2 g 2 0 0 l j ρ a ω j d r y l k ρ a ω k d r y t where g 2 is the resultant force of gravity and buoyancy ρ is the sea water density g is the gravity acceleration ω d r y is the dry mass of line subscript j and k are the indications of line element 2 2 3 hydrodynamic forces the hydrodynamic forces acted on a submerged line element are usually calculated separately in normal and tangential directions using the morison equation the drag force f d and the inertia force f i of a line element i e element j are expressed as follows 5 f j d 1 2 ρ d j l j c d n v r v r τ j τ j v r v r τ j τ j 1 2 ρ d j l j c d t v r τ j τ j v r τ j τ j 6 f j i 1 4 ρ π d j 2 l j 1 c a n u c a n u τ j τ j 7 τ y 2 y 1 y 2 y 1 where d j is diameter c d n and c d t are the normal and tangential drag coefficients respectively c a n is normal added mass coefficient v r is the relative velocity between the fluid particle and the line element u is the acceleration of the fluid particle thus the hydrodynamic load lumped on each node i e node 2 is 8 f 2 d i 1 2 f j d f j i 1 2 f k d f k i the added mass matrix a 2 of node 2 can be expressed as 9 a 2 1 8 ρ π c a n d j l j i τ j t τ j d k l k i τ k t τ k where i is the identity matrix the added mass matrix a 2 is non diagonal with coupling between the three degrees of freedom at any given node 2 2 4 seabed interaction force a simplified seabed interaction model is utilized to calculate the interaction force between the seabed and mooring line as shown in fig 3 if the node contacts with the seabed the interaction force is applied to it by three equivalent springs which remain parallel to the coordinate axes of the global coordinate system for an arbitrary node i e node 2 contacted with the seabed the corresponding seabed interaction force is represented as follows 10 f 2 s b f 2 b μ δ d f 1 μ δ d f 2 1 t 11 f 2 b g 2 1 t a n h a 1 y 23 a 1 h where f 2 s b is the total seabed interaction force f 2 b is the vertical component of the seabed interaction force h is the water depth a 1 is an appropriate parameter so that the f 2 b approaches to 0 when node 2 is a suitable distance away from the seabed μ is the friction coefficient d f and δ are the node deflection and the target deflection the relationship between δ and d f can be expressed as 12 d f q y 2 q y 2 q y 2 q y 2 q δ δ y 2 q y 2 q δ where q can be 1 or 2 y 2 is the new position of node 2 after moving a distance from its original position y 2 2 2 5 jacobian matrix the jacobian matrix needed for solving the mooring line governing eq 1 is obtained by assembling the tension stiffness matrix k t and seabed interaction force stiffness matrix k s b the tension stiffness matrix of a node i e node 1 in the element j is derived from line tension eq 3 which is denoted by 13 k 1 q r t 2 v j y 1 q y 1 r δ q r e a 1 y 2 y 1 1 l j e a y 2 q y 1 q y 2 r y 1 r y 2 y 1 3 where n 1 q r t is the element in matrix k 1 t q and r indicate its position can be 1 2 and 3 δ q r 1 when q r and δ q r 0 when q r thus the tension stiffness matrix k t is assembled by 14 k t k 1 t k 1 t k 1 t k 1 t k 2 t k 2 t k n 2 t k n 2 t k n 1 t k n 1 t k n 1 t k n 1 t where n is number of the elements on a mooring line the seabed interaction force stiffness matrix of an node i e node 1 is derived from eqs 10 and 11 which are denoted by 15 k 1 s b η 1 μ f 1 b δ 0 μ d f 1 δ a 1 g 1 c o s h 2 a 1 y 13 a 1 h 0 η 2 μ f 1 b δ μ d f 2 δ a 1 g 1 c o s h 2 a 1 y 13 a 1 h 0 0 a 1 g 1 c o s h 2 a 1 y 13 a 1 h where η 1 and η 2 are defined as 16 η 1 η 2 1 y 2 q y 2 q δ 0 y 2 q y 2 q δ hence the seabed interaction force stiffness matrix k s b is assembled by 17 k s b k 1 s b k 2 s b k 3 s b k n s b where n is number of the elements on a mooring line 2 3 vessel mooring numerical models the coupling of vessel and mooring system is achieved by combining the vessel model with the mooring line model in general the vessel mooring coupled motion equation is solved in the time domain 2 3 1 mooring line model based on the lumped mass model the governing equation of mooring line motion is written as follows 18 m a y t g f s b f d i where m and a are the mass and added mass matrix of mooring line elements respectively t g f s b and f d i are the tension vector gravity and buoyancy vector seabed interaction force vector and hydrodynamic force vector of each node on a mooring line the dynamic time integration scheme the newmark β method is used to linearize the differential eq 18 the newmark β method is expressed by 19 y t δ t 1 β δ t 2 δ y 1 β δ t y t 1 2 β 1 y t 20 y t δ t α β δ t δ y 1 α β y t α 2 β 1 y t δ t 21 y t δ t y t δ y where α and β are used to adjust the accuracy and stability of the algorithm substituting eqs 19 21 into eq 18 yields 22 f δ y f δ y m 1 β δ t 2 δ y 1 β δ t y t 1 2 β 1 y t the δ y is solved by the newton raphson iteration method from eq 22 23 j f δ y m δ y 24 ε j δ y m 1 f δ y m 25 δ y m 1 δ y m ε where the subscript m is the number of iteration the ε is the correction to the iteration the j is the jacobian matrix 2 3 2 vessel mooring coupled model the motion equation of the vessel mooring coupled model is presented as follows 26 m a x c x k x f e x t f m where m and a are the mass matrix and added mass matrix of the vessel respectively c is the damping matrix of the vessel k is the hydrostatic restoring coefficient matrix of the vessel x x x are the acceleration velocity and position vector of the vessel respectively f e x t is the external environmental force f m is the mooring force the weak coupling scheme is commonly used to solve eq 26 in which the governing equations of the mooring line model eq 18 and vessel model eq 26 are solved separately and the coupling is achieved by applying the mooring force on the right hand side of the governing equation of the vessel model jacob et al 2012a b according to the weak coupling scheme the governing equation of each mooring line eq 22 is solved independently which can effectively reduce the calculation time if parallel architecture is used in this paper a self dependently developed vessel mooring coupled program is utilized to deal with the vessel mooring coupled problem 2 4 degenerated quasi static model by ignoring the mooring line dynamic effects i e y 0 and y 0 the dynamic model degenerates into a quasi static model thus the governing equation can be written as 27 t g f s b f d i 0 the quasi static model is specifically utilized to narrow the feasible range of the design variables for saving computational cost for further investigation using the vessel mooring coupled model with the determination of the mooring line top node and end node positions the position of other nodes can be obtained by solving eq 27 with the newton raphson iteration method 3 non dominated sorting genetic algorithm ii the nsga ii proposed by deb et al 2002 is an improved algorithm of nsga fig 4 illustrates a schematic diagram of the nsga ii the initial random parents are the input then the generated children and their parents are combined the objective function value of each individual in a combined set is calculated by the proposed quasi static model eq 27 or vessel mooring coupled model eq 26 then sort the individuals into different fronts and estimate the crowding distances for them the individuals with higher rank and larger crowding distance are selected as the new parents for crossover and mutation to generate the new generations of children continue the process until the termination condition is met 3 1 fast non dominated sorting approach the individuals are sorted into different fronts by utilizing the fast non dominated sorting approach based on the values of their objective functions according to this algorithm the individual with a lower valued objective function dominates the others the individuals are sorted into the first front if there is no individual dominating them among the remaining individuals the second front contains those who are not dominated by others then the fast non dominated sorting continues until all individuals belong to different fronts 3 2 density estimation the crowding distance is represented by the population density which is also a criterion for the evaluation of individuals existing in each front the infinitive distance is allocated to the individuals of the minimum and maximum objective function values in each front for other individuals the corresponding crowding distance can be calculated by 28 ψ i j 1 n f j i 1 f j i 1 f j m a x f j m i n where ψ is the crowding distance n is the number of objective functions f j i is the j th objective function value of the i th individual f j m a x and f j m i n are the maximum and minimum values of the j th objective function respectively 4 mooring system design methodology the design of mooring system involves multiple design variables requirements and constraints in order to obtain an optimal and practical mooring system the accurate dynamic characteristics of the vessel and mooring system are required for the design methodology in this context a mooring system design methodology combining the nsga ii algorithm and vessel mooring coupled model is proposed 4 1 design variables the design variables of the mooring system are its properties including line number line length line diameter mooring system layout material grade and line structure the line number line length and line diameter are three independent design variables the mooring system layout depends on the mooring radius and mooring line azimuth in general the line number material grade and line structure are determined at the beginning of the design based on the requirements of vessel motion response and mooring system safety the mooring system properties such as the mass buoyancy and position of the weight and buoy attached to the mooring line can also be selected as design variables if necessary 4 2 narrowing the feasible range the initial feasible range should be narrowed according to station keeping ability of the mooring system which can be quickly estimated by calculating its stiffness matrix with a quasi static model in this context the required stiffness matrix of a mooring system can be solved based on the estimated environmental force and allowable offset of the vessel by adjusting the design variables specifically the restoring force provided by the mooring system should be equal to the estimated environmental force when its fairleads move to the allowable offset position of the vessel thus the objective function for narrowing the feasible range can be expressed as 29 ϕ 1 i r i r i r i where subscript i represents the i th degree of freedom dof of the vessel r is the estimated environmental force r is the restoring force provided by the mooring system when its fairleads move to the allowable offset position of the vessel ϕ 1 represents the deviation of the restoring force and the estimated environmental force it is required to minimize the line length the line diameter and the mooring radius when narrowing the feasible range the corresponding objective functions can be expressed as 30 ϕ l l ϕ d d ϕ s s where l d and s represent the line length the line diameter and the mooring radius respectively moreover the constraints should be set to filter unacceptable solutions one of the constraints is that the obtained restoring force should not be less than the estimated environmental force which can be represented as 31 r i r i the unacceptable solutions have the possibility of crossover with other viable solutions to produce the unacceptable solutions in next generation during the calculation in order to avoid this situation and to improve the efficiency of calculation the solutions are discarded if they do not satisfy the constraints hence the multi objective optimization problem for narrowing the feasible range of the design variables based on a quasi static model can be established p r o b l e m 1 m i n i m i z e f l d s α ϕ 1 i ϕ l ϕ d ϕ s s u b j e c t t o l d s α ω i n i c o n s t r a i n e d t o r i r i v 1 j θ 1 where ω i n i is the initial feasible range j indicates the j th design variable θ 1 is the constraint set of the design variables v 1 in a specific design scenario the θ 1 can be the constraints of the mooring system safety factor mooring line lay down length mooring system layout etc the multi objective optimization problem 32 of narrowing the feasible range is solved by the nsga ii algorithm as described by algorithm 1 the obtained optimal solution p is the narrowed feasible range for the subsequent mooring system design by the combination of the nsga ii and vessel mooring coupled model it should be noted that the population and generation of nsga ii should be set to be sufficiently large to establish a convincible narrowed feasible range the mutation probability of nsga ii should be set small enough to ensure convergence of the optimal solutions 4 3 vessel mooring coupled design the accurate dynamic characteristics of the vessel and mooring system such as the vessel motion response the safety factor of mooring system and the length of mooring line lay down part are required for designing a more practical mooring system since the vessel mooring coupled model is combined with the nsga ii algorithm the vessel motion response and the mooring line tension can be obtained by a time domain simulation thus two objective functions related to vessel motion response and mooring system safety can be expressed as follows 32 ϕ 2 i m a x x i 33 ϕ s a f e t m a x t m b l where subscript i represents the i th dof of the vessel ϕ 2 is the objective function related to vessel motion response x is the time series of vessel motion response ϕ s a f e is the safety factor of the mooring line which is the ratio of maximum line tension t m a x and minimum breaking load t m b l the line length the line diameter and mooring radius must also be minimized in the vessel mooring coupled design the corresponding objective function is eq 30 hence the multi objective optimization problem for the vessel mooring coupled design can be established p r o b l e m 2 m i n i m i z e f l d s α ϕ 2 i ϕ s a f e ϕ l ϕ d ϕ s s u b j e c t t o l d s α ω n a r c o n s t r a i n e d t o ϕ s a f e ϕ s a f e 0 v 2 j θ 2 where ω n a r is the narrowed feasible range obtained by the quasi static model j indicates the j th design variable θ 2 is the constraint set of design variable v 2 ϕ s a f e 0 equals 0 6 according to api 2005 and adopted here in a specific design scenario the θ 2 can be the constraints of the mooring system safety factor vessel motion response mooring line lay down length mooring system layout etc by combining of nsga ii and vessel mooring coupled model the design requirements such as pretension minimum the lay down length and the mooring force acting on the anchor can be selected as the objective functions for the mooring system design the optimal solution or designed mooring system parameters of the multi objective optimization problem 34 is found by nsga ii where the procedure is similar to that of algorithm 1 the population and generation of nsga ii can appropriately be set smaller since the feasible range is sufficiently narrow it is expected that several optimal solutions can be found by nsga ii it is necessary to group the optimal solutions to further analyze the designed mooring systems and select the desired one an effective method to group the optimal solutions is converting the different mooring systems into points in a multi dimensional coordinate system by non dimensionalizing the value of their design variables the points are then grouped by a multi dimensional sphere with a radius of δ p as illustrated in fig 5 the mooring systems are in the same group if their corresponding points are located in the same sphere only one representative mooring system needs to be selected from each group since an arbitrary solution can represent the others in the same group the priorities of the representative mooring systems obtained by nsga ii are equal since the nsga ii is established based on pareto optimality it is inappropriate to choose the best result by relying on the objective functions used in the nsga ii additional information on each representative mooring system is required for selecting the final mooring system eq 34 combines existing information objective function used in the nsga ii with additional information independent objective function and is proposed as a criterion for selecting the final mooring system 34 y k γ i ϕ k i ε j φ k j where y k is a selection criterion function for the k th optimal solution i and j indicate the i th and j th objective function ϕ represents the existing objective function used in nsga ii φ is the independent objective function which is not used in nsga ii γ and ε are the corresponding weighting factors the selection criterion function value y for optimal mooring systems can be obtained by appropriately setting the weighting factors since the mooring system design problem 34 requires minimizing the objective functions the mooring system with the smallest selection criterion value for y forms the final designed mooring system 5 case study in this section a catenary mooring system is designed from scratch for a semi submersible very large floating structure vlfs module to demonstrate the proposed mooring system design methodology 5 1 parameters of the vlfs module the semi submersible vlfs module is composed of a box shaped upper hull ten cylindrical columns five hexahedral pontoons and eight cylindrical braces the vlfs module is deployed at a water depth of 50 m and its main parameters are presented in table 1 5 2 environmental conditions eight environmental conditions including operational and survival conditions are determined for the mooring system design as shown in table 2 where envs 1 to 6 are the operational conditions while envs 7 to 8 are the survival conditions in order to avoid green water and slamming in survival conditions the draft of the vlfs module should be reduced and its mooring line should be appropriately released to increase the air gap api 2010 from this perspective the line length for survival condition should be designed independently after the mooring system is designed under operational conditions 5 3 design variables selection according to the type of structure of the vlfs module 10 fairleads are deployed on the two sides of the five pontoons considering the high station keeping requirements of the vlfs module two mooring lines are linked at each fairlead for the candidate catenary mooring system the material grade of the mooring line is r5 the line length l o and l s for the operational and survival conditions the mooring radius s the line diameter d and the mooring azimuth angles α and β are selected as design variables the α and β respectively indicate the azimuth of the angular bisector of the first and second fairleads as shown in fig 6 the angle between the two adjacent mooring lines linked at the same fairlead is set as 5 the dotted line is the angular bisector between two adjacent lines linked at a fairlead since the candidate mooring system is symmetrical at the x and y axes in the vessel body fixed coordinate system the mooring system layout can be obtained with the determination of α and β the initial feasible range of the selected design variables is listed in table 3 based on the dnv 2008 guidelines the material properties of the mooring line are selected where the mass per unit length minimum breaking load and axial stiffness can be calculated by 35 ω 0 0219 d 2 36 t m b l 0 032 d 2 44 0 08 d 37 e a 101 d 2 where ω is the mass per unit length in kg m t m b l is the minimum breaking load in kn e a is axial stiffness in kn d is the line diameter in mm the mooring system parameters for the operational and survival conditions are the same except that the mooring line is extended in the survival condition thus to avoid the obtained mooring line length for survival condition is shorter than that for operational condition and improve computational efficiency mooring line length for survival condition can be updated after obtaining the mooring system parameters for the operational condition 5 4 narrowed feasible range the feasible range of design variables should be narrowed in advance to reduce the computational cost of the subsequent design 5 4 1 problem establishment based on quasi static model when the vlfs module moves to the maximum allowable offsets the restoring force provided by the mooring system should not be smaller than the estimated environmental force as listed in table 4 in operational and survival conditions the maximum allowable offsets in surge and sway dof are 3 m in operational conditions and 5 m in survival conditions respectively in this paper the maximum allowable offsets in yaw dof are 1 5 and 2 5 in operational and survival conditions respectively thus the first three objective functions are obtained based on eq 29 the other objective functions for minimizing mooring radius mooring line length and diameter can be established according to eq 30 moreover the constraints θ 1 of the mooring system layout and mooring line lay down part length should be set to filter out unacceptable solutions as indicated below 1 the value of α is not less than β 2 the initial lay down part length v i n i is not less than 200 m hence the multi objective optimization problem for narrowing the feasible range of design variables in operational condition can be established based on 32 and shown in table 5 where the r o and r o respectively represent restoring force and the environmental force in operational condition ω i n i is the initial feasible range table 3 v i n i represents the initial lay down part length to update the feasible range in survival conditions the established optimization problem is the same as that in operational conditions except the constraint of the initial lay down part length is relatively loose thus the multi objective optimization problem for updating the feasible range in survival condition can be established as shown in table 5 where the r s and r s represent the restoring force and the environmental force in survival condition respectively ω o p e r is the narrowed feasible range obtained under operational conditions 5 4 2 results the optimal solutions of the multi objective optimization problem based on the quasi static model are found by nsga ii with the population and generation respectively set as 300 and 100 the narrowed feasible ranges of operational and survival conditions which are ω o p e r and ω s u r v are obtained by taking the intersection of the two feasible ranges the desired feasible range ω n a r for the subsequent mooring system design can be obtained as listed in table 6 a comparison of initial and narrowed feasible range is shown in fig 7 it can be seen that the feasible range for the subsequent design is effectively narrowed from the initial feasible range by combining the quasi static model and nsga ii specifically the volume of ω n a r is only 2 of that of the initial feasible range ω i n i 5 5 designed mooring system with the narrowed feasible range of the design variables the multi objective optimization problem using the vessel mooring coupled model combined with nsga ii is established to obtain a practical mooring system design 5 5 1 problem establishment based on vessel mooring coupled model the first two objective functions related to vlfs module motion response and mooring system safety are obtained based on eqs 32 and 33 the other objective functions to minimize mooring radius mooring line length and diameter can be established according to eq 30 moreover the constraints θ 2 of vlfs module motion response mooring system safety and layout should be set as below 1 the vlfs module motion response ϕ 2 is smaller than the maximum allowable motion δ which are 3 m and 1 5 for horizontal and yaw offset respectively 2 the safety factor of the mooring line ϕ s a f e is smaller than 0 6 3 the initial lay down part length v i n i is larger than 200 m 4 the minimum lay down part length v m i n during the motion of vlfs module is larger than 100 m 5 the value of α is smaller than β hence the multi objective problem for mooring system design in operational conditions can be established according to 34 and is shown in table 7 where j can be 1 and 2 which indicates the horizontal and yaw offset of the vlfs module δ represents the maximum allowable motions of the vlfs module the v m i n represents the minimum lay down part length for survival conditions the line length is designed independently while the other design variables are determined under operational conditions consequently the constraints of initial lay down part length and mooring system layout are no longer needed meanwhile the mooring line length in survival conditions should be larger than that in operational conditions to avoid green water and slamming the maximum allowance motion δ of the vlfs module in survival conditions is 5 m and 2 5 for horizontal and yaw offset of the vlfs module respectively thus the multi objective optimization problem for the mooring design in survival condition can be established as shown in table 7 5 5 2 results the multi objective problem shown in table 7 is solved with the population and generation of nsga ii both set as 50 since the feasible range of the design variables was sufficiently narrowed a time domain simulation is conducted based on the vessel mooring coupled model with a total simulation time of 10 800 s and a time step of 0 2 s fifty sets of optimal solutions for operational conditions are found by the nsga ii algorithm the optimal solutions are non dimensionalized to convert into points in a five dimensional coordinate system grouping the 50 points by a sphere with a radius of 0 2 nine groups of mooring system are gained the representative mooring system of each group is selected and given in table 8 the line length for survival condition is then found for the nine representative mooring systems several optimal solutions or line length for survival conditions that fulfill the design requirements are found with the nsga ii since the safety of the mooring system is the most important factor under survival conditions the optimal solution with the minimum safety factor is selected as the line length of survival conditions for each representative mooring system as listed in table 8 the additional information or the independent objective function required for selecting the final mooring system is the minimum lay down part length v m i n s in survival condition meanwhile the line length ϕ l o and ϕ l s of operational and survival conditions the line diameter ϕ d the vlfs horizontal offset in operational conditions ϕ 2 1 and mooring line safety factor in survival conditions ϕ s a f e s are selected as the existing objective functions for eq 34 thus the final selection criterion function y is written as 38 y k γ 1 f k ϕ l o γ 2 f k ϕ l s γ 3 f k ϕ d γ 4 f k ϕ 2 1 γ 5 f k ϕ s a f e s ε f k φ where γ 1 γ 2 γ 5 and ε are the weighting factors of the corresponding objective variables the f is the normalization operation k indicates the k th optimal solution φ is the lay down part length related independent objective function which can be expressed as φ 1 v m i n s in this particular case it is focused on the compromise between vlfs motion mooring system safety mooring line length and line diameter thus in this paper the six weighting factors are equally set as 1 the obtained selection criterion values y for the nine representative mooring systems are also listed in table 8 it can be found that the no 1 candidate mooring system has the smallest selection criterion value y among the candidate mooring systems therefore the no 1 mooring system is selected as the desired mooring system for the vlfs module and its designed variables are listed in table 9 5 6 discussion the maximum horizontal offset and yaw offset of vlfs module coupled with the designed mooring system under the operational and survival conditions are listed in table 10 and safety factors of mooring lines are shown in fig 8 a it can be seen that the vlfs module achieves the maximum yaw motion under the env 6 condition while the maximum horizontal offset and the maximum safety factor show in the env 5 condition the vlfs module motion response and the mooring system safety factor under the env 5 and env 6 conditions actually dominate the ϕ 2 and ϕ s a f e that suggests the env 5 and env 6 are the critical conditions for designing the mooring system in operational conditions similarly the env 7 is the critical condition for mooring system design in the survival condition girón et al 2014 have proposed a method to select the critical environmental conditions for the mooring system design based on an existing reference by roughly estimating the vessel motion response for the mooring system has to be designed from scratch the critical environmental conditions change with the adjustments of the mooring line parameters thus they cannot be determined in advance hence beyond the critical environmental conditions all the environmental conditions should be considered when designing a mooring system from scratch and the vessel mooring coupled model should be utilized to accurately predict the dynamic response of vlfs module and mooring system meanwhile to reduce computation cost by use of vessel mooring coupled model the initial feasible range of design variables should be sufficiently narrowed by nsga ii combined with the static model of the mooring system for comparison the mooring system is designed for the operational conditions by a single objective optimization algorithm based on the narrowed feasible range where the objective functions are normalized by the weighted sum method and the weighting factor for each objective function are set as 1 the obtained results by the proposed methodology and the single objective optimization algorithm are compared in fig 9 it can be obviously found that the proposed methodology can generate better optimal solution with less iteration steps while the optimal solution obtained by the single objective optimization algorithm converges slower in general it takes nearly a week to design the mooring system by using the proposed methodology most importantly the mooring system design methodology proposed in this paper does not require too much manual intervention which reduces the requirement for design experience 6 conclusions the primary contribution of this paper is the development of a methodology for design and optimization of the mooring system combining the nsga ii algorithm and vessel mooring coupled model where accurate dynamic characteristics of the vessel and mooring system can be used as objective functions a case study is presented to demonstrate the proposed methodology in which a catenary mooring system is designed for a semi submersible vlfs module considering eight environmental conditions the feasible range of design variables is sufficiently narrowed which is only 2 of its initial dimension nine optimal mooring systems are obtained according to the requirements and constraints regarding aspects of the station keeping ability the mooring system safety the mooring radius the mooring line length and diameter thereafter one optimal solution with the smallest selection criterion function value is selected as the desired mooring system compared with a traditional single objective optimization algorithm the proposed methodology can generate better mooring system solution with less iteration steps it can be concluded that the proposed methodology is effective in designing mooring system from scratch considering more practical requirements and thus can be used as a marine research tool for optimizing mooring systems for offshore structures in order to improve the proposed mooring system design methodology a series study of the mooring system design methodology including mooring system design for deep water condition and for taut mooring system will be conducted in our further work acknowledgments the authors greatly acknowledge the support of the national natural science foundation of china grant 51709170 the ministry of industry and information technology china mooring position technology floating support platform engineering ii and the shanghai sailing program china grant 17yf1409700 
22434,in this paper a mooring system design methodology combining the non dominated sorting genetic algorithm ii nsga ii with the vessel mooring coupled model is first proposed in the proposed methodology the multi objective optimization problem for mooring system design which involves several design variables objective functions and constraints is established and solved by the combination of the nsga ii algorithm and the vessel mooring coupled model and the initial feasible range of design variables is narrowed in advance by combining the nsga ii with the quasi static mooring system model a case study is presented to demonstrated the proposed methodology in which a catenary mooring system is designed from scratch for a semi submersible very large floating structure vlfs module it can be concluded from the obtained results that owing to the combination of the nsga ii algorithm and the vessel mooring coupled model the accurate dynamic responses of vessel and mooring systems can be used as the objective functions thus the proposed methodology is able to attain an optimal mooring system considering more practical design requirements such as the vessel motion response the safety factor of the mooring system the length of mooring line lay down part and mooring system layout keywords mooring system design methodology vessel mooring coupled model multi objective optimization problem nsga ii 1 introduction the rapid exploration and exploitation of ocean resources have led to the design and manufacture of a great number of different floating structures such as semi submersible platforms spar platforms tension leg platforms tlp and floating production storage and offloading fpso etc the station keeping systems for these floating structures have been intensively investigated in the literature bhattacharya et al 2006 wang and tay 2011 lamas pardo et al 2015 zhang et al 2015 etc being simple safe and inexpensive mooring systems have become an essential choice in the station keeping systems of floating structures chas and garcía 2008 mooring system design has been the subject of many studies recently beyond the realm of ocean engineering industries girón et al 2014 proposed an integrated design methodology for mooring systems and risers their study focused on the selection of governing critical loading cases and the interaction of mooring system and risers whereas the specific mooring system design process was not detailed benassai et al 2014a b 2015 dealt with a catenary mooring system design for a tri floater floating offshore wind turbine they investigated the variation in line length and diameter of three candidate mooring systems at different water depths the performance of the three candidate mooring systems in terms of ultimate limit states uls and accidental limit states als was also examined campanile et al 2018 designed and selected a mooring system for floating offshore wind turbines in their study 6 and 9 line mooring configurations were selected as design candidates and were compared and modified according to their performances under the varying environmental conditions of the southern and northern regions of the north sea the design of mooring systems involves several variables objectives and constraints and thus can be transformed into a multi objective optimization problem shafieefar and rezvani 2007 proposed a mooring system optimization design method based on a genetic algorithm ga they established a single objective optimization problem for mooring system design by normalizing objective functions based on a weighted sum method felix gonzalez and mercier 2016 introduced a design method based on static equivalence and ga in their study three objective functions were normalized by utilizing several sets of weighting factors it was found from their study that the selection of the weighting factor has a significant impact on the mooring system design results brommundt et al 2012 described a new tool for the optimization design of a catenary mooring system for a floating wind turbine the optimization problem with four design variables and three constraints was established and solved by a nelder mead simplex algorithm however minimization of the mooring line length was the only design objective considered in their study da fonseca monteiro et al 2016 proposed a mooring system design methodology based on the particle swarm optimization pso method and the differential evolution de method in their study the mooring system design problem was transformed into a single objective optimization problem by normalizing objective functions with a kind of averaging method other than the above studies there are several researches related to truncated mooring system design for model testing such as su et al 2009 zhang et al 2012 wei et al 2017 among others they established a multi objective optimization problem for mooring system truncation and solved it using a non dominated sorting genetic algorithm ii nsga ii despite many studies dedicated to designing a mooring system from scratch as the design problem is complex involving multiple objectives and weighting factors of these objectives cannot be accurately estimated in advance problems remain regarding the unified consideration of multiple objectives and over simplified models in this paper a mooring system design methodology combining the nsga ii algorithm with the vessel mooring coupled model is first proposed in the proposed methodology a multi objective optimization problem for mooring system design is established in which the vessel mooring coupled model is adopted to calculate the dynamic characteristics of the mooring system and the nsga ii algorithm is utilized to find the optimal mooring system parameters owing to the combining of the nsga ii algorithm and the vessel mooring coupled model the accurate dynamic characteristics of vessel and mooring system can be used as the objective functions and do not need to be normalized the proposed methodology allows for the design of an optimal mooring system considering more practical requirements such as the vessel motion response the safety factor of the mooring system the length of the mooring line lay down part and the mooring system layout compared with traditional methods 2 mathematical modeling of mooring line 2 1 coordinated system and notations the different coordinate systems used are illustrated in fig 1 and described below 1 the global coordinate system o x y z fixed in space with o x y located at the still water surface and the z axis oriented straight up 2 the body fixed coordinate system o b x b y b z b is fixed to the vessel which coincides with the global coordinate system in its initial position the incident wave angle is 0 if the wave travels along the positive direction of the x axis and increases in a counter clockwise direction 2 2 lumped mass method the lumped mass method is generally used for modeling the mooring line low and langley 2006 xiong et al 2016 according to the lumped mass method a mooring line is divided into several elements the mass and external forces acting on each element are lumped at its two end nodes thus the line element is regarded as a massless spring fig 2 illustrates the lumped mass model of three arbitrary nodes numbered from 1 to 3 which connect to element j and k the y 1 y 2 y 3 are respectively the coordinates of the nodes 1 2 3 in the global coordinate system at the equilibrium position the governing equation of each node can be expressed as 1 m y f y y where m is the mass matrix y y and y are the acceleration velocity and position vector respectively f is the external force lumped at each node which includes tension gravity buoyancy hydrodynamic force and seabed interaction force 2 2 1 line tension for an arbitrary element i e element j the elastic potential energy can be expressed as 2 v j 1 2 e a l j y 2 y 1 l j 2 where v j is the elastic potential energy e is the young s modulus a is the cross section area of line l j is the non stretched length thus the tension of one end node i e node 2 provided by element j can be derived 3 t 2 j v j y 2 q e a 1 l j 1 y 2 y 1 y 1 y 2 where t 2 j is the tension on node 2 provided by j th element q can be 1 2 3 corresponding to the global coordinate x y z respectively 2 2 2 gravity and buoyancy the resultant force of gravity and buoyancy of a submerged node i e node 2 comes from the two adjacent line elements 4 g 2 g 2 0 0 l j ρ a ω j d r y l k ρ a ω k d r y t where g 2 is the resultant force of gravity and buoyancy ρ is the sea water density g is the gravity acceleration ω d r y is the dry mass of line subscript j and k are the indications of line element 2 2 3 hydrodynamic forces the hydrodynamic forces acted on a submerged line element are usually calculated separately in normal and tangential directions using the morison equation the drag force f d and the inertia force f i of a line element i e element j are expressed as follows 5 f j d 1 2 ρ d j l j c d n v r v r τ j τ j v r v r τ j τ j 1 2 ρ d j l j c d t v r τ j τ j v r τ j τ j 6 f j i 1 4 ρ π d j 2 l j 1 c a n u c a n u τ j τ j 7 τ y 2 y 1 y 2 y 1 where d j is diameter c d n and c d t are the normal and tangential drag coefficients respectively c a n is normal added mass coefficient v r is the relative velocity between the fluid particle and the line element u is the acceleration of the fluid particle thus the hydrodynamic load lumped on each node i e node 2 is 8 f 2 d i 1 2 f j d f j i 1 2 f k d f k i the added mass matrix a 2 of node 2 can be expressed as 9 a 2 1 8 ρ π c a n d j l j i τ j t τ j d k l k i τ k t τ k where i is the identity matrix the added mass matrix a 2 is non diagonal with coupling between the three degrees of freedom at any given node 2 2 4 seabed interaction force a simplified seabed interaction model is utilized to calculate the interaction force between the seabed and mooring line as shown in fig 3 if the node contacts with the seabed the interaction force is applied to it by three equivalent springs which remain parallel to the coordinate axes of the global coordinate system for an arbitrary node i e node 2 contacted with the seabed the corresponding seabed interaction force is represented as follows 10 f 2 s b f 2 b μ δ d f 1 μ δ d f 2 1 t 11 f 2 b g 2 1 t a n h a 1 y 23 a 1 h where f 2 s b is the total seabed interaction force f 2 b is the vertical component of the seabed interaction force h is the water depth a 1 is an appropriate parameter so that the f 2 b approaches to 0 when node 2 is a suitable distance away from the seabed μ is the friction coefficient d f and δ are the node deflection and the target deflection the relationship between δ and d f can be expressed as 12 d f q y 2 q y 2 q y 2 q y 2 q δ δ y 2 q y 2 q δ where q can be 1 or 2 y 2 is the new position of node 2 after moving a distance from its original position y 2 2 2 5 jacobian matrix the jacobian matrix needed for solving the mooring line governing eq 1 is obtained by assembling the tension stiffness matrix k t and seabed interaction force stiffness matrix k s b the tension stiffness matrix of a node i e node 1 in the element j is derived from line tension eq 3 which is denoted by 13 k 1 q r t 2 v j y 1 q y 1 r δ q r e a 1 y 2 y 1 1 l j e a y 2 q y 1 q y 2 r y 1 r y 2 y 1 3 where n 1 q r t is the element in matrix k 1 t q and r indicate its position can be 1 2 and 3 δ q r 1 when q r and δ q r 0 when q r thus the tension stiffness matrix k t is assembled by 14 k t k 1 t k 1 t k 1 t k 1 t k 2 t k 2 t k n 2 t k n 2 t k n 1 t k n 1 t k n 1 t k n 1 t where n is number of the elements on a mooring line the seabed interaction force stiffness matrix of an node i e node 1 is derived from eqs 10 and 11 which are denoted by 15 k 1 s b η 1 μ f 1 b δ 0 μ d f 1 δ a 1 g 1 c o s h 2 a 1 y 13 a 1 h 0 η 2 μ f 1 b δ μ d f 2 δ a 1 g 1 c o s h 2 a 1 y 13 a 1 h 0 0 a 1 g 1 c o s h 2 a 1 y 13 a 1 h where η 1 and η 2 are defined as 16 η 1 η 2 1 y 2 q y 2 q δ 0 y 2 q y 2 q δ hence the seabed interaction force stiffness matrix k s b is assembled by 17 k s b k 1 s b k 2 s b k 3 s b k n s b where n is number of the elements on a mooring line 2 3 vessel mooring numerical models the coupling of vessel and mooring system is achieved by combining the vessel model with the mooring line model in general the vessel mooring coupled motion equation is solved in the time domain 2 3 1 mooring line model based on the lumped mass model the governing equation of mooring line motion is written as follows 18 m a y t g f s b f d i where m and a are the mass and added mass matrix of mooring line elements respectively t g f s b and f d i are the tension vector gravity and buoyancy vector seabed interaction force vector and hydrodynamic force vector of each node on a mooring line the dynamic time integration scheme the newmark β method is used to linearize the differential eq 18 the newmark β method is expressed by 19 y t δ t 1 β δ t 2 δ y 1 β δ t y t 1 2 β 1 y t 20 y t δ t α β δ t δ y 1 α β y t α 2 β 1 y t δ t 21 y t δ t y t δ y where α and β are used to adjust the accuracy and stability of the algorithm substituting eqs 19 21 into eq 18 yields 22 f δ y f δ y m 1 β δ t 2 δ y 1 β δ t y t 1 2 β 1 y t the δ y is solved by the newton raphson iteration method from eq 22 23 j f δ y m δ y 24 ε j δ y m 1 f δ y m 25 δ y m 1 δ y m ε where the subscript m is the number of iteration the ε is the correction to the iteration the j is the jacobian matrix 2 3 2 vessel mooring coupled model the motion equation of the vessel mooring coupled model is presented as follows 26 m a x c x k x f e x t f m where m and a are the mass matrix and added mass matrix of the vessel respectively c is the damping matrix of the vessel k is the hydrostatic restoring coefficient matrix of the vessel x x x are the acceleration velocity and position vector of the vessel respectively f e x t is the external environmental force f m is the mooring force the weak coupling scheme is commonly used to solve eq 26 in which the governing equations of the mooring line model eq 18 and vessel model eq 26 are solved separately and the coupling is achieved by applying the mooring force on the right hand side of the governing equation of the vessel model jacob et al 2012a b according to the weak coupling scheme the governing equation of each mooring line eq 22 is solved independently which can effectively reduce the calculation time if parallel architecture is used in this paper a self dependently developed vessel mooring coupled program is utilized to deal with the vessel mooring coupled problem 2 4 degenerated quasi static model by ignoring the mooring line dynamic effects i e y 0 and y 0 the dynamic model degenerates into a quasi static model thus the governing equation can be written as 27 t g f s b f d i 0 the quasi static model is specifically utilized to narrow the feasible range of the design variables for saving computational cost for further investigation using the vessel mooring coupled model with the determination of the mooring line top node and end node positions the position of other nodes can be obtained by solving eq 27 with the newton raphson iteration method 3 non dominated sorting genetic algorithm ii the nsga ii proposed by deb et al 2002 is an improved algorithm of nsga fig 4 illustrates a schematic diagram of the nsga ii the initial random parents are the input then the generated children and their parents are combined the objective function value of each individual in a combined set is calculated by the proposed quasi static model eq 27 or vessel mooring coupled model eq 26 then sort the individuals into different fronts and estimate the crowding distances for them the individuals with higher rank and larger crowding distance are selected as the new parents for crossover and mutation to generate the new generations of children continue the process until the termination condition is met 3 1 fast non dominated sorting approach the individuals are sorted into different fronts by utilizing the fast non dominated sorting approach based on the values of their objective functions according to this algorithm the individual with a lower valued objective function dominates the others the individuals are sorted into the first front if there is no individual dominating them among the remaining individuals the second front contains those who are not dominated by others then the fast non dominated sorting continues until all individuals belong to different fronts 3 2 density estimation the crowding distance is represented by the population density which is also a criterion for the evaluation of individuals existing in each front the infinitive distance is allocated to the individuals of the minimum and maximum objective function values in each front for other individuals the corresponding crowding distance can be calculated by 28 ψ i j 1 n f j i 1 f j i 1 f j m a x f j m i n where ψ is the crowding distance n is the number of objective functions f j i is the j th objective function value of the i th individual f j m a x and f j m i n are the maximum and minimum values of the j th objective function respectively 4 mooring system design methodology the design of mooring system involves multiple design variables requirements and constraints in order to obtain an optimal and practical mooring system the accurate dynamic characteristics of the vessel and mooring system are required for the design methodology in this context a mooring system design methodology combining the nsga ii algorithm and vessel mooring coupled model is proposed 4 1 design variables the design variables of the mooring system are its properties including line number line length line diameter mooring system layout material grade and line structure the line number line length and line diameter are three independent design variables the mooring system layout depends on the mooring radius and mooring line azimuth in general the line number material grade and line structure are determined at the beginning of the design based on the requirements of vessel motion response and mooring system safety the mooring system properties such as the mass buoyancy and position of the weight and buoy attached to the mooring line can also be selected as design variables if necessary 4 2 narrowing the feasible range the initial feasible range should be narrowed according to station keeping ability of the mooring system which can be quickly estimated by calculating its stiffness matrix with a quasi static model in this context the required stiffness matrix of a mooring system can be solved based on the estimated environmental force and allowable offset of the vessel by adjusting the design variables specifically the restoring force provided by the mooring system should be equal to the estimated environmental force when its fairleads move to the allowable offset position of the vessel thus the objective function for narrowing the feasible range can be expressed as 29 ϕ 1 i r i r i r i where subscript i represents the i th degree of freedom dof of the vessel r is the estimated environmental force r is the restoring force provided by the mooring system when its fairleads move to the allowable offset position of the vessel ϕ 1 represents the deviation of the restoring force and the estimated environmental force it is required to minimize the line length the line diameter and the mooring radius when narrowing the feasible range the corresponding objective functions can be expressed as 30 ϕ l l ϕ d d ϕ s s where l d and s represent the line length the line diameter and the mooring radius respectively moreover the constraints should be set to filter unacceptable solutions one of the constraints is that the obtained restoring force should not be less than the estimated environmental force which can be represented as 31 r i r i the unacceptable solutions have the possibility of crossover with other viable solutions to produce the unacceptable solutions in next generation during the calculation in order to avoid this situation and to improve the efficiency of calculation the solutions are discarded if they do not satisfy the constraints hence the multi objective optimization problem for narrowing the feasible range of the design variables based on a quasi static model can be established p r o b l e m 1 m i n i m i z e f l d s α ϕ 1 i ϕ l ϕ d ϕ s s u b j e c t t o l d s α ω i n i c o n s t r a i n e d t o r i r i v 1 j θ 1 where ω i n i is the initial feasible range j indicates the j th design variable θ 1 is the constraint set of the design variables v 1 in a specific design scenario the θ 1 can be the constraints of the mooring system safety factor mooring line lay down length mooring system layout etc the multi objective optimization problem 32 of narrowing the feasible range is solved by the nsga ii algorithm as described by algorithm 1 the obtained optimal solution p is the narrowed feasible range for the subsequent mooring system design by the combination of the nsga ii and vessel mooring coupled model it should be noted that the population and generation of nsga ii should be set to be sufficiently large to establish a convincible narrowed feasible range the mutation probability of nsga ii should be set small enough to ensure convergence of the optimal solutions 4 3 vessel mooring coupled design the accurate dynamic characteristics of the vessel and mooring system such as the vessel motion response the safety factor of mooring system and the length of mooring line lay down part are required for designing a more practical mooring system since the vessel mooring coupled model is combined with the nsga ii algorithm the vessel motion response and the mooring line tension can be obtained by a time domain simulation thus two objective functions related to vessel motion response and mooring system safety can be expressed as follows 32 ϕ 2 i m a x x i 33 ϕ s a f e t m a x t m b l where subscript i represents the i th dof of the vessel ϕ 2 is the objective function related to vessel motion response x is the time series of vessel motion response ϕ s a f e is the safety factor of the mooring line which is the ratio of maximum line tension t m a x and minimum breaking load t m b l the line length the line diameter and mooring radius must also be minimized in the vessel mooring coupled design the corresponding objective function is eq 30 hence the multi objective optimization problem for the vessel mooring coupled design can be established p r o b l e m 2 m i n i m i z e f l d s α ϕ 2 i ϕ s a f e ϕ l ϕ d ϕ s s u b j e c t t o l d s α ω n a r c o n s t r a i n e d t o ϕ s a f e ϕ s a f e 0 v 2 j θ 2 where ω n a r is the narrowed feasible range obtained by the quasi static model j indicates the j th design variable θ 2 is the constraint set of design variable v 2 ϕ s a f e 0 equals 0 6 according to api 2005 and adopted here in a specific design scenario the θ 2 can be the constraints of the mooring system safety factor vessel motion response mooring line lay down length mooring system layout etc by combining of nsga ii and vessel mooring coupled model the design requirements such as pretension minimum the lay down length and the mooring force acting on the anchor can be selected as the objective functions for the mooring system design the optimal solution or designed mooring system parameters of the multi objective optimization problem 34 is found by nsga ii where the procedure is similar to that of algorithm 1 the population and generation of nsga ii can appropriately be set smaller since the feasible range is sufficiently narrow it is expected that several optimal solutions can be found by nsga ii it is necessary to group the optimal solutions to further analyze the designed mooring systems and select the desired one an effective method to group the optimal solutions is converting the different mooring systems into points in a multi dimensional coordinate system by non dimensionalizing the value of their design variables the points are then grouped by a multi dimensional sphere with a radius of δ p as illustrated in fig 5 the mooring systems are in the same group if their corresponding points are located in the same sphere only one representative mooring system needs to be selected from each group since an arbitrary solution can represent the others in the same group the priorities of the representative mooring systems obtained by nsga ii are equal since the nsga ii is established based on pareto optimality it is inappropriate to choose the best result by relying on the objective functions used in the nsga ii additional information on each representative mooring system is required for selecting the final mooring system eq 34 combines existing information objective function used in the nsga ii with additional information independent objective function and is proposed as a criterion for selecting the final mooring system 34 y k γ i ϕ k i ε j φ k j where y k is a selection criterion function for the k th optimal solution i and j indicate the i th and j th objective function ϕ represents the existing objective function used in nsga ii φ is the independent objective function which is not used in nsga ii γ and ε are the corresponding weighting factors the selection criterion function value y for optimal mooring systems can be obtained by appropriately setting the weighting factors since the mooring system design problem 34 requires minimizing the objective functions the mooring system with the smallest selection criterion value for y forms the final designed mooring system 5 case study in this section a catenary mooring system is designed from scratch for a semi submersible very large floating structure vlfs module to demonstrate the proposed mooring system design methodology 5 1 parameters of the vlfs module the semi submersible vlfs module is composed of a box shaped upper hull ten cylindrical columns five hexahedral pontoons and eight cylindrical braces the vlfs module is deployed at a water depth of 50 m and its main parameters are presented in table 1 5 2 environmental conditions eight environmental conditions including operational and survival conditions are determined for the mooring system design as shown in table 2 where envs 1 to 6 are the operational conditions while envs 7 to 8 are the survival conditions in order to avoid green water and slamming in survival conditions the draft of the vlfs module should be reduced and its mooring line should be appropriately released to increase the air gap api 2010 from this perspective the line length for survival condition should be designed independently after the mooring system is designed under operational conditions 5 3 design variables selection according to the type of structure of the vlfs module 10 fairleads are deployed on the two sides of the five pontoons considering the high station keeping requirements of the vlfs module two mooring lines are linked at each fairlead for the candidate catenary mooring system the material grade of the mooring line is r5 the line length l o and l s for the operational and survival conditions the mooring radius s the line diameter d and the mooring azimuth angles α and β are selected as design variables the α and β respectively indicate the azimuth of the angular bisector of the first and second fairleads as shown in fig 6 the angle between the two adjacent mooring lines linked at the same fairlead is set as 5 the dotted line is the angular bisector between two adjacent lines linked at a fairlead since the candidate mooring system is symmetrical at the x and y axes in the vessel body fixed coordinate system the mooring system layout can be obtained with the determination of α and β the initial feasible range of the selected design variables is listed in table 3 based on the dnv 2008 guidelines the material properties of the mooring line are selected where the mass per unit length minimum breaking load and axial stiffness can be calculated by 35 ω 0 0219 d 2 36 t m b l 0 032 d 2 44 0 08 d 37 e a 101 d 2 where ω is the mass per unit length in kg m t m b l is the minimum breaking load in kn e a is axial stiffness in kn d is the line diameter in mm the mooring system parameters for the operational and survival conditions are the same except that the mooring line is extended in the survival condition thus to avoid the obtained mooring line length for survival condition is shorter than that for operational condition and improve computational efficiency mooring line length for survival condition can be updated after obtaining the mooring system parameters for the operational condition 5 4 narrowed feasible range the feasible range of design variables should be narrowed in advance to reduce the computational cost of the subsequent design 5 4 1 problem establishment based on quasi static model when the vlfs module moves to the maximum allowable offsets the restoring force provided by the mooring system should not be smaller than the estimated environmental force as listed in table 4 in operational and survival conditions the maximum allowable offsets in surge and sway dof are 3 m in operational conditions and 5 m in survival conditions respectively in this paper the maximum allowable offsets in yaw dof are 1 5 and 2 5 in operational and survival conditions respectively thus the first three objective functions are obtained based on eq 29 the other objective functions for minimizing mooring radius mooring line length and diameter can be established according to eq 30 moreover the constraints θ 1 of the mooring system layout and mooring line lay down part length should be set to filter out unacceptable solutions as indicated below 1 the value of α is not less than β 2 the initial lay down part length v i n i is not less than 200 m hence the multi objective optimization problem for narrowing the feasible range of design variables in operational condition can be established based on 32 and shown in table 5 where the r o and r o respectively represent restoring force and the environmental force in operational condition ω i n i is the initial feasible range table 3 v i n i represents the initial lay down part length to update the feasible range in survival conditions the established optimization problem is the same as that in operational conditions except the constraint of the initial lay down part length is relatively loose thus the multi objective optimization problem for updating the feasible range in survival condition can be established as shown in table 5 where the r s and r s represent the restoring force and the environmental force in survival condition respectively ω o p e r is the narrowed feasible range obtained under operational conditions 5 4 2 results the optimal solutions of the multi objective optimization problem based on the quasi static model are found by nsga ii with the population and generation respectively set as 300 and 100 the narrowed feasible ranges of operational and survival conditions which are ω o p e r and ω s u r v are obtained by taking the intersection of the two feasible ranges the desired feasible range ω n a r for the subsequent mooring system design can be obtained as listed in table 6 a comparison of initial and narrowed feasible range is shown in fig 7 it can be seen that the feasible range for the subsequent design is effectively narrowed from the initial feasible range by combining the quasi static model and nsga ii specifically the volume of ω n a r is only 2 of that of the initial feasible range ω i n i 5 5 designed mooring system with the narrowed feasible range of the design variables the multi objective optimization problem using the vessel mooring coupled model combined with nsga ii is established to obtain a practical mooring system design 5 5 1 problem establishment based on vessel mooring coupled model the first two objective functions related to vlfs module motion response and mooring system safety are obtained based on eqs 32 and 33 the other objective functions to minimize mooring radius mooring line length and diameter can be established according to eq 30 moreover the constraints θ 2 of vlfs module motion response mooring system safety and layout should be set as below 1 the vlfs module motion response ϕ 2 is smaller than the maximum allowable motion δ which are 3 m and 1 5 for horizontal and yaw offset respectively 2 the safety factor of the mooring line ϕ s a f e is smaller than 0 6 3 the initial lay down part length v i n i is larger than 200 m 4 the minimum lay down part length v m i n during the motion of vlfs module is larger than 100 m 5 the value of α is smaller than β hence the multi objective problem for mooring system design in operational conditions can be established according to 34 and is shown in table 7 where j can be 1 and 2 which indicates the horizontal and yaw offset of the vlfs module δ represents the maximum allowable motions of the vlfs module the v m i n represents the minimum lay down part length for survival conditions the line length is designed independently while the other design variables are determined under operational conditions consequently the constraints of initial lay down part length and mooring system layout are no longer needed meanwhile the mooring line length in survival conditions should be larger than that in operational conditions to avoid green water and slamming the maximum allowance motion δ of the vlfs module in survival conditions is 5 m and 2 5 for horizontal and yaw offset of the vlfs module respectively thus the multi objective optimization problem for the mooring design in survival condition can be established as shown in table 7 5 5 2 results the multi objective problem shown in table 7 is solved with the population and generation of nsga ii both set as 50 since the feasible range of the design variables was sufficiently narrowed a time domain simulation is conducted based on the vessel mooring coupled model with a total simulation time of 10 800 s and a time step of 0 2 s fifty sets of optimal solutions for operational conditions are found by the nsga ii algorithm the optimal solutions are non dimensionalized to convert into points in a five dimensional coordinate system grouping the 50 points by a sphere with a radius of 0 2 nine groups of mooring system are gained the representative mooring system of each group is selected and given in table 8 the line length for survival condition is then found for the nine representative mooring systems several optimal solutions or line length for survival conditions that fulfill the design requirements are found with the nsga ii since the safety of the mooring system is the most important factor under survival conditions the optimal solution with the minimum safety factor is selected as the line length of survival conditions for each representative mooring system as listed in table 8 the additional information or the independent objective function required for selecting the final mooring system is the minimum lay down part length v m i n s in survival condition meanwhile the line length ϕ l o and ϕ l s of operational and survival conditions the line diameter ϕ d the vlfs horizontal offset in operational conditions ϕ 2 1 and mooring line safety factor in survival conditions ϕ s a f e s are selected as the existing objective functions for eq 34 thus the final selection criterion function y is written as 38 y k γ 1 f k ϕ l o γ 2 f k ϕ l s γ 3 f k ϕ d γ 4 f k ϕ 2 1 γ 5 f k ϕ s a f e s ε f k φ where γ 1 γ 2 γ 5 and ε are the weighting factors of the corresponding objective variables the f is the normalization operation k indicates the k th optimal solution φ is the lay down part length related independent objective function which can be expressed as φ 1 v m i n s in this particular case it is focused on the compromise between vlfs motion mooring system safety mooring line length and line diameter thus in this paper the six weighting factors are equally set as 1 the obtained selection criterion values y for the nine representative mooring systems are also listed in table 8 it can be found that the no 1 candidate mooring system has the smallest selection criterion value y among the candidate mooring systems therefore the no 1 mooring system is selected as the desired mooring system for the vlfs module and its designed variables are listed in table 9 5 6 discussion the maximum horizontal offset and yaw offset of vlfs module coupled with the designed mooring system under the operational and survival conditions are listed in table 10 and safety factors of mooring lines are shown in fig 8 a it can be seen that the vlfs module achieves the maximum yaw motion under the env 6 condition while the maximum horizontal offset and the maximum safety factor show in the env 5 condition the vlfs module motion response and the mooring system safety factor under the env 5 and env 6 conditions actually dominate the ϕ 2 and ϕ s a f e that suggests the env 5 and env 6 are the critical conditions for designing the mooring system in operational conditions similarly the env 7 is the critical condition for mooring system design in the survival condition girón et al 2014 have proposed a method to select the critical environmental conditions for the mooring system design based on an existing reference by roughly estimating the vessel motion response for the mooring system has to be designed from scratch the critical environmental conditions change with the adjustments of the mooring line parameters thus they cannot be determined in advance hence beyond the critical environmental conditions all the environmental conditions should be considered when designing a mooring system from scratch and the vessel mooring coupled model should be utilized to accurately predict the dynamic response of vlfs module and mooring system meanwhile to reduce computation cost by use of vessel mooring coupled model the initial feasible range of design variables should be sufficiently narrowed by nsga ii combined with the static model of the mooring system for comparison the mooring system is designed for the operational conditions by a single objective optimization algorithm based on the narrowed feasible range where the objective functions are normalized by the weighted sum method and the weighting factor for each objective function are set as 1 the obtained results by the proposed methodology and the single objective optimization algorithm are compared in fig 9 it can be obviously found that the proposed methodology can generate better optimal solution with less iteration steps while the optimal solution obtained by the single objective optimization algorithm converges slower in general it takes nearly a week to design the mooring system by using the proposed methodology most importantly the mooring system design methodology proposed in this paper does not require too much manual intervention which reduces the requirement for design experience 6 conclusions the primary contribution of this paper is the development of a methodology for design and optimization of the mooring system combining the nsga ii algorithm and vessel mooring coupled model where accurate dynamic characteristics of the vessel and mooring system can be used as objective functions a case study is presented to demonstrate the proposed methodology in which a catenary mooring system is designed for a semi submersible vlfs module considering eight environmental conditions the feasible range of design variables is sufficiently narrowed which is only 2 of its initial dimension nine optimal mooring systems are obtained according to the requirements and constraints regarding aspects of the station keeping ability the mooring system safety the mooring radius the mooring line length and diameter thereafter one optimal solution with the smallest selection criterion function value is selected as the desired mooring system compared with a traditional single objective optimization algorithm the proposed methodology can generate better mooring system solution with less iteration steps it can be concluded that the proposed methodology is effective in designing mooring system from scratch considering more practical requirements and thus can be used as a marine research tool for optimizing mooring systems for offshore structures in order to improve the proposed mooring system design methodology a series study of the mooring system design methodology including mooring system design for deep water condition and for taut mooring system will be conducted in our further work acknowledgments the authors greatly acknowledge the support of the national natural science foundation of china grant 51709170 the ministry of industry and information technology china mooring position technology floating support platform engineering ii and the shanghai sailing program china grant 17yf1409700 
