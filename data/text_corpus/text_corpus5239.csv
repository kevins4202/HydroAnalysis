index,text
26195,reliable estimates of the sustainable yield of supply boreholes are critical to ensure that groundwater resources are managed sustainably sustainable yields are dependent on the pumped groundwater level in a borehole how this relates to vertical aquifer heterogeneity and features of the borehole itself this paper presents a 3d radial flow model spiderr based on the darcy forchheimer equation for simulating the groundwater level response in supply boreholes in unconfined heterogeneous aquifers the model provides a tool for investigating the causes of non linear behaviour in abstraction boreholes which can have a significant impact on sustainable yields this is demonstrated by simulating a variable rate pumping test in a chalk abstraction borehole the application suggests the non linear response to pumping is due to a combination of factors a reduction in well storage with depth due to changes in the borehole diameter a reduction in hydraulic conductivity with depth and non darcian flow keywords groundwater sustainable yield forchheimer equation non darcy flow radial flow model chalk aquifer 1 introduction groundwater is estimated to provide drinking water to more than 50 of the global population with 2 5 billion people solely dependent on groundwater resources for their basic daily water needs groundwater also accounts for 43 of irrigation water worldwide playing a crucial role in maintaining the livelihoods of some of the world s most vulnerable people and contributing to food security for many more wwap 2015 however it is estimated that 20 of the world s aquifers are over exploited gleeson et al 2012 a situation which is likely to escalate due to an increasing demand for water for domestic agricultural and industrial uses in the context of global population growth and climate change to develop and use groundwater resources sustainably aquifers particularly those that are strategically important or vulnerable to over abstraction and or large seasonal groundwater level fluctuations must be managed carefully within the context of the wider environment there is a need to assess both the short and long term availability of groundwater to ensure an economically socially and environmentally acceptable balance is maintained between supply and demand without risk to the long term supply over short seasonal to annual timescales this requires an understanding of the sustainable yield of individual abstraction boreholes how yields change as groundwater levels decline seasonally particularly during droughts and the impact of abstraction on the surrounding environment e g river flows and groundwater dependent ecosystems over longer timescales it is important to understand groundwater abstraction within the context of long term average recharge to prevent continuous declines in groundwater levels and consequent long term reductions in aquifer and borehole yields the sustainable yield of a borehole reflects an interplay between regional and local scale processes at the regional scale yields are largely influenced by the spatial and temporal distribution of recharge groundwater storage and aquifer transmissivity at the local scale yields are critically dependent on the pumped water level in the borehole and how this relates to vertical aquifer heterogeneity the nature and distribution of inflow horizons to the borehole and features of the borehole itself such as borehole storage the depth of the pump and its pumping characteristics foster et al 2017 in unconfined vertically heterogeneous aquifers particularly fractured aquifers which are estimated to cover more than 20 of the earth s surface krasny and sharp 2007 the groundwater level response in a pumped borehole can be highly non linear dewatering of major fractures or inflow horizons can result in significant reductions to the yield of a borehole as the groundwater level in the borehole falls in response to pumping understanding this response and being able to accurately model it is therefore crucial for determining the sustainable yield of a borehole particularly during droughts and predicting how yields might change in response to future reductions in groundwater recharge doll 2009 and or increases in demand the groundwater level response in a pumped borehole is typically tested by constant or variable rate pumping tests carried out over periods of hours to days numerous analytical and numerical methods have been developed to analyse these tests under different hydrogeological conditions analytical solutions exist for solving for the groundwater level in a pumped borehole in confined theis 1935 and unconfined neuman 1972 aquifers with large diameter abstraction boreholes papadopulos and cooper 1967 mathias and butler 2006 and non linear well losses jacob 1947 and in non uniform or fractured aquifers barker and herbert 1982 barker 1988 butler 1988 butler and liu 1993 these methods are generally based on a number of simplifying assumptions that may not be satisfied in hydrogeologically complex aquifers which can be more accurately represented by numerical models the most commonly applied numerical method for simulating flow to an abstraction borehole is based on a finite difference approximation to the governing flow equation in cylindrical coordinates whereby specific discharge is calculated using darcy s law this method was applied in the earliest radial flow models rushton 1974 rushton and booth 1976 rushton and redshaw 1979 rathod rushton 1984 1991 sakthivadivel and rushton 1989 and in more recent developments such as coompute mansour et al 2003 and modflow samani et al 2004 langevin 2008 louwyck et al 2012 2014 the application of these models has highlighted the importance of representing several features in and around a borehole to accurately simulate the pumped water level in the borehole confined and unconfined conditions and particularly variations in the rest water level where hydraulic conductivity varies with depth rushton and chan 1976 aquifer heterogeneity in both the vertical and horizontal dimension connorton and reed 1978 mansour et al 2006 2011 development of vertical head gradients and vertical flow rushton and howard 1982 rathod and rushton 1991 well storage casing and screening and seepage face development rushton and singh 1987 sakthivadivel and rushton 1989 rushton 2006 a common observation during variable rate pumping tests which are designed to test the efficiency of a borehole is the effect of well losses or a non linear increase in drawdown with the rate of abstraction well losses can be attributed to the effect of flow through gravel packs or well screens the development of a seepage face or to the development of non darcian flow in the aquifer itself the radial flow models described above typically account for well losses by lowering the hydraulic conductivity in the immediate vicinity of the borehole but assume that flow in the aquifer remains linear and can therefore be described by darcy s law the significance of non darcian groundwater flow is well documented in the literature sen 1987 1989 1990 2000 kohl et al 1997 wen et al 2006 qian et al 2007 this is particularly the case where high flow velocities are likely to develop around abstraction boreholes in fractured aquifers non darcian groundwater flow is most commonly represented by forchheimer s law which includes a quadratic term to account for the observed non linear relationship between head gradient and specific discharge as flow velocities increase forchheimer 1901 several analytical models based on forchheimer s law are available in the literature şen 1988 ewing et al 1999 mathias et al 2008 mathias and wen 2015 liu et al 2017 and it has been applied using finite difference and mesh free methods to simulate drawdown in 1d confined and leaky aquifers mathias and todman 2010 wen et al 2011 2014 there are however no examples in the literature of numerical groundwater models that incorporate forchheimer non darcian flow aquifer heterogeneity and the detailed features of an abstraction borehole which have all previously been shown to influence drawdown in pumped boreholes this represents a gap in our analytical tools to simulate and assess sustainable borehole yields in unconfined aquifers this paper presents a 3d radial flow model spiderr based on the darcy forchheimer equation for simulating the pumped water level in an abstraction borehole the model can represent confined and unconfined aquifers vertical and horizontal aquifer heterogeneity darcian and non darcian flow and key features of a borehole such as changes in diameter with depth well casing and screening this is crucial if the simulation of sustainable borehole yields which can reduce as groundwater levels fall in response to pumping in complex water table aquifers is to be improved as outlined above a reliable estimation of borehole yields is key to managing groundwater resources in a safe and sustainable way in the uk this is also a statutory requirement for water companies who must provide estimates of the sustainable yield of supply boreholes during droughts as part of the water resource management process the model presented here integrates components of the work described above explicitly representing all of the pertinent hydrogeological and borehole construction features that may be required to simulate the water level response in an abstraction borehole during pumping the model is evaluated against an analytical solution for non linear drawdown in a pumped borehole cooper and jacob 1946 and by reproducing two relatively simple step drawdown tests from confined sandstone aquifers as previously presented by mathias and todman 2010 the model is then applied to simulate a more complex groundwater level response from a pumping test in an abstraction borehole in the chalk aquifer this is the principal aquifer in the uk where borehole yields are often significantly affected by pumped water levels and vertical heterogeneity related to fracture development butler et al 2009 the application to simulate a variable rate pumping test in a chalk borehole demonstrates that the model can be used as a tool to investigate the causes of non linearity in the groundwater level response to pumping the ability of spiderr to simulate the short term response in an abstraction borehole is a key step in evaluating the long term sustainable yield of a borehole the model has been developed as part of a wider study which has produced a methodology to insert this borehole scale model into a regional groundwater flow model this coupled representation of local and regional groundwater processes is critical for estimating the long term sustainable yield of a borehole upton 2014 we cite this wider study which will be presented in a future paper as it places the development of this model in context the focus of this paper however is on the development of the radial flow model and its application to simulate drawdown during variable rate pumping tests which allows us to investigate the key factors influencing drawdown in complex heterogeneous aquifers 2 model description 2 1 conceptualisation the model is constructed on a three dimensional cylindrical grid as shown in fig 1 this allows aquifer heterogeneity to be represented along the radial r cylindrical θ and vertical z axes grid nodes are spaced logarithmically in the radial direction to provide refinement in the vicinity of the borehole where the hydraulic head or in the case of an unconfined aquifer the water table has greatest curvature the borehole is located at the centre of the radial grid and is represented by a single node with a specified radius the borehole node can extend to the base of any model layer allowing the representation of fully or partially penetrating boreholes the borehole can be connected to the first adjacent aquifer node located on the well face with a very high conductance term to represent an open borehole a specified conductance to represent a well screen or it can be completely disconnected from the aquifer node to represent the presence of a well casing a gravel pack can be represented by modifying the hydraulic conductivity of the aquifer nodes around the borehole the borehole node to which pumping is applied has a storage coefficient equal to unity to represent well storage the depth of the pump is also specified such that no water can continue to be abstracted if the water level in the borehole falls below this depth the vertical dimension of the model is represented as a series of horizontal layers of varying thickness nodes transition between confined unconfined and inactive depending on the elevation of the groundwater head relative to the top and bottom of the layer fig 1 cell dewatering and rewetting often causes numerical instabilities in groundwater models particularly when modelling highly non linear systems an upstream weighting approach similar to that applied in modflow nwt niswonger et al 2011 has been implemented in the radial flow model to help smooth the transition when cells dewater or rewet in a single direction the flux between two cells is therefore based on the weighted harmonic mean of the hydraulic conductivity of the two cells and the up gradient saturated thickness in that direction this means that water cannot flow horizontally out of a dewatered cell but it can still receive water from an up gradient cell all water entering a dewatered cell either from an adjacent cell or from recharge is automatically routed vertically to the active node below this helps to smooth the transition as cells dewater and rewet thus reducing numerical instabilities vertical flow from the water table and development of a seepage face are common features around abstraction boreholes in unconfined aquifers rushton and howard 1982 rushton and singh 1987 sakthivadivel and rushton 1989 rathod and rushton 1991 rushton 2006 flow across a seepage face is poorly quantified particularly in fractured aquifers it occurs across the interval between the water level in the borehole and the elevation at which the water table intersects the borehole wall in the radial flow model the groundwater head in the upper unconfined layer does not explicitly represent the elevation of the water table but an average of the head within that layer in a single layer model the use of the dupuit approximation for unconfined flow assumes that all flow into the borehole is horizontal and occurs below the water level in the borehole fig 2 a vertical discretization allows the vertical component of flow to be incorporated fig 2b and a seepage face is approximated by allowing a layer to discharge to the borehole even after the water level in the borehole has fallen below the base of the layer under these conditions the head at the node on the borehole wall which represents the seepage face is fixed at the elevation of the base of the layer and all flow into this node from the adjacent aquifer node is passed directly into the borehole when this aquifer node also dewaters the layer becomes horizontally disconnected from the borehole and seepage flow stops this representation is slightly different from the coompute radial flow model which approximates seepage flow by representing the water table as a discrete numerical layer mansour et al 2011 while the coompute model provides an approximate solution of the water table elevation vertical discretization is still required to represent seepage flow and there are known issues during recovery whereby the water level in the borehole rises more quickly than the water table surface in adjacent aquifer nodes resulting in flow from the borehole into the aquifer 2 2 mathematical formulation the radial flow model is based on the continuity equation for transient groundwater flow through a porous medium in cylindrical co ordinates 1 r q r q r r 1 r q θ θ q z z n q s s h t where q is specific discharge lt 1 in the radial r cylindrical θ and vertical z dimensions n and q are a volumetric source and sink per unit volume t 1 respectively s s is specific storage l 1 t is time t and h is hydraulic head l the vertical dimension is replaced by a series of layers hydraulic head is a mean value over the saturated thickness of each layer b l and vertical flow between layers is calculated as a leakage term lt 1 specific storage is replaced by a storage coefficient s where s s s b for confined layers i e where groundwater head is above the top elevation of the layer z t s s s b s y for unconfined layers i e where groundwater head is between z t and the elevation of the bottom of the layer z b and s y is the specific yield of the layer note that b z t z b for confined layers and b h z b for unconfined layers specific discharge in the radial and cylindrical dimensions is calculated by the darcy forchheimer equation q r θ β q r θ 2 k r θ h r θ where β is the non linear forchheimer parameter l 1t and k r θ is hydraulic conductivity lt 1 in the radial and cylindrical directions this reduces to darcy s law when β 0 the numerical model is based a finite difference approximation to the continuity equation which reduces to the following set of ordinary differential equations with respect to time t s h i j k t r i 1 2 j k b max i j k i 1 j k q i 1 2 j k r i 1 2 j k b max i j k i 1 j k q i 1 2 j k r i j k r i 1 2 j k r i 1 2 j k b max i j k i j 1 k q i j 1 2 k b max i j k i j 1 k q i j 1 2 k r i j k δ θ q i j k 1 2 q i j k 1 2 n q this allows groundwater head to be approximated at each node in the radial i cylindrical j and vertical k directions whereby r i is the radial distance from the borehole to the node mathias et al 2008 show that the darcy forchheimer equation can be solved for specific discharge to give in the radial direction q i 1 2 j k 1 2 β i 1 2 j k 1 4 β i 1 2 j k k i 1 2 j k h i j k h i 1 j k r i j k r i 1 j k 1 2 1 vertical flow across layer boundaries is calculated by q i j k 1 2 2 k z i j k 1 k z i j k k z i j k δ z i j k 1 k z i j k 1 δ z i j k h i j k h i j k 1 where k z is the vertical hydraulic conductivity of a layer and δz is the thickness of the layer the vertical and horizontal hydraulic conductivities forchheimer parameter specific storage and specific yield can be set at different values for each individual layer in the model to represent vertical heterogeneity in the aquifer horizontal heterogeneity can also be incorporated by specifying different conductivities and storage values at each node within a layer if this is the case the harmonic mean is used to calculate the conductivity between adjacent nodes the darcy forchheimer radial flow model is coded using the matlab software package mathworks 2012 the set of non linear ordinary differential equations is solved using the stiff differential equation solver ode15s shampine and reichlet 1997 this is an implicit variable order solver which uses adaptive time stepping based on the error in computed head at each iteration 2 3 validation testing the model was evaluated against various analytical solutions that describe drawdown in simplified aquifers and was found to accurately reproduce the response in large diameter boreholes in confined and unconfined aquifers papadopulos and cooper 1967 neuman 1972 the model was also evaluated against a late time approximation to the forchheimer equation using the cooper jacob solution cooper and jacob 1946 and the method of matched asymptotic expansion mathias et al 2008 this provides a benchmark for testing the non linear behaviour of the spiderr model a series of single layer confined and laterally extensive 10 km radius models were set up with a hydraulic conductivity of 50 m day 1 aquifer thickness of 10 m specific storage of 10 6 m 1 and abstraction rate of 1000 m3 day 1 eight non linear models were run with the forchheimer parameter increasing from 0 05 to 1 5 m 1 day these models were compared with an equivalent linear model in which the forchheimer parameter was set to zero table 1 the transmissivity and storage thus the linear component of drawdown were constant in all models and the variations in drawdown between the linear and non linear models is therefore due only to variations in the forchheimer parameter the proportion of the total late time drawdown attributable to the non linear component of drawdown is shown in table 1 for each test simulation the results of the linear and non linear simulations were compared with the analytical model whereby the cooper jacob non linear parameter is calculated from the forchheimer parameter according to the relationship presented by mathias and todman 2010 see table 1 the numerical model does not match the early time data of the analytical model because this does not account for well storage but there is agreement between the models at late times in all simulations fig 3 a comparison of the cones of depression at the end of the simulation 1 day shows that the influence of non linearity decreases away from the borehole the test simulations presented in fig 3 show that the relationship between the forchheimer parameter and the distance from the borehole at which the influence of non linear flow is no longer observed defined as the distance at which the difference between the final cones of depression for the linear and non linear models is 1 cm and therefore largely unmeasurable is approximately linear fig 3b the difference between the final cone of depression for the linear model and non linear test 1 which has a forchheimer parameter of 0 05 m 1 day is negligible 1 cm at a distance of 25 m from the borehole fig 3c for the final non linear test which has a forchheimer parameter of 1 5 m 1 day the cone of depression converges to the linear model at a distance of around 700 m from the borehole fig 3d table 1 shows that the non linear component of drawdown in test 8 accounts for more than 95 of the total drawdown which is unlikely to be a realistic estimation in the case studies presented by mathias and todman 2010 which simulate step drawdown tests in four different aquifer types using a 1d darcy forchheimer radial flow model the non linear component of drawdown accounts for between 1 and 60 of the total drawdown for equivalent components of non linear losses the simulations presented above suggest that the impact of non darcian flow will be fairly localised around the abstraction borehole with the biggest impact on drawdown observed within 10 m of the borehole this has implications for the required location of an observation borehole to verify the non linear component of drawdown which would need to be located close to the abstraction borehole to be within the cone of influence of non darcian flow spiderr is further evaluated by reproducing two relatively simple step drawdown tests previously presented by clark 1977 and van tonder et al 2001 and modelled by mathias and todman 2010 using a 1d forchheimer model these tests are from confined sandstone aquifers and are accurately reproduced by a 1d homogeneous confined spiderr model using the best fit parameters identified by mathias and todman 2010 fig 4 the validation exercises described above demonstrate the ability of spiderr to represent linear and non linear flow to boreholes in relatively simple homogeneous aquifers further evaluation of the model for simulating observed groundwater level data from more complex heterogeneous aquifers is provided in the following section through application to a variable rate pumping test in a chalk abstraction borehole 3 model application 3 1 study area pumping test data the spiderr model represents a range of hydrogeological and borehole construction features that may control the groundwater level response in an abstraction borehole providing a tool for simulating drawdown in complex heterogeneous aquifers where the assumptions of simpler analytical models are not met this is illustrated in the following sections through application to a groundwater source in the chalk aquifer in the uk which displays a distinct non linear response to pumping the model is used as a tool to investigate the key factors influencing drawdown and thus the yield of the borehole in this strategically important dual permeability aquifer the chalk aquifer is designated a principal aquifer in the uk accounting for up to 70 of the total public water supply in parts of southern england butler et al 2012 the chalk is a very fine grained limestone deposited over significant parts of england and northern europe during a cretaceous marine transgression in southern england the chalk aquifer has a thickness of 200 400 m and is classified into several members based on widespread flint and marl units bristow et al 1997 the chalk matrix is highly porous 20 45 but has very low permeability 10 2 m day 1 matrix blocks are typically bound by interconnected fractures the fracture network which is often enhanced by dissolution is highly permeable 10 2 m day 1 and is the principal mechanism for groundwater flow in the saturated zone allen et al 1997 macdonald et al 1998 trends in fracture density are controlled by depth and location within a catchment and correspond with distinct vertical and lateral variations in transmissivity and storativity owen and robinson 1978 fractures generally have a higher density at shallow depths and in valleys and dry valleys and a lower density at greater depths and on the interfluves williams et al 2006 the chalk aquifer therefore displays two broad vertical hydraulic zones 1 a high permeability upper zone of active groundwater movement within which the water table fluctuates and fractures are enhanced by dissolution 2 a deeper zone of slow regional scale flow characterised by low relatively uniform permeability lateral variations in transmissivity are also observed with transmissivity estimates from pumping tests in valleys or dry valleys typically ranging from 500 m2 day 1 to 2000 m2 day 1 and those on the interfluves suggesting transmissivities of approximately 50 m2 day 1 allen et al 1997 the variations in the properties of the chalk described above have a strong influence on the yield of abstraction boreholes which often vary non linearly with groundwater level rushton and chan 1976 butler et al 2009 mansour et al 2011 tamayo mas et al 2018 the pumping test analysed for this study is from a borehole commissioned by thames water utilities ltd in the early 2000s located at the western extent of the bean well field in the south eastern part of the london basin fig 5 the chalk in this region forms the dip slope of the north downs and the regional hydraulic gradient generally slopes from the chalk escarpment in the south to the river thames in the north the chalk of the north downs is known to have well developed karstic systems allen et al 1997 it is locally covered by the palaeogene thanet sand formation and overlying lambeth group which largely comprise clays to fine grained sandstones it is largely unconfined due to the depth of the water table the borehole is drilled to a depth of 137 m with a diameter of 406 mm in the upper 60 5 m and 248 mm below this it is cased within the upper 60 m and open below this depth geological and geophysical logging of the borehole indicate the following features thanet sands are present in the upper 16 m of the borehole below which the seaford and lewes nodular chalk formations are present with respective thicknesses of 62 and 45 m the seaford chalk is composed mainly of soft blocky white chalk which has a high flint content in its lower 10 m in this area the lewes nodular chalk is composed of hard nodular chalk and is well fractured in its upper 10 m the rest water level was recorded at a depth of 60 m the caliper log shows borehole enlargement due to acidisation between 60 and 80 m depth with an increased diameter of 380 mm below which the diameter is closer to the drilled diameter of 248 mm the interval between 60 and 90 m depth shows lower fluid temperature and electrical conductivity relative to those at lower depths below 90 m depth the gamma and resistivity logs show a number of distinct marl bands which coincide with higher fluid temperature and electrical conductivity buckley 2003 the geophysical observations suggest that the majority of inflow to the borehole occurs above a depth of 90 m corresponding with the fractured boundary between the seaford and lewes nodular chalk formations fig 6 the borehole was tested with a variable rate pumping test which was carried out after two phases of borehole development involving acid injection and air lifting the test consisted of five 100 min steps at abstraction rates increasing from 10 to 30 l per second ls 1 0 86 2 6 ml per day the time drawdown data from the pumping test are shown in fig 7 there is evidence of non linear behaviour during the test particularly the final step which shows a significant increase in drawdown relative to the increase in abstraction rate the increased drawdown observed during step five occurs when the pumped groundwater level in the borehole falls below the boundary between the seaford and lewes nodular chalk formations which also coincides with the reduction in borehole diameter as outlined in the introduction non linearity in the groundwater level response to pumping could be due to a number of factors including aquifer heterogeneity borehole construction and losses and aquifer losses due to non darcian flow these will be explored further in the following section groundwater levels were not monitored in any observation boreholes during this pumping test therefore analysis focuses solely on the abstraction borehole 3 2 methodology spiderr is used to simulate the variable rate test described above both to evaluate the model s ability to reproduce drawdown in complex heterogeneous aquifers and to investigate the potential causes of non linearity in the groundwater level response in this chalk abstraction borehole in order to do this the following hypotheses were tested with a series of simulations with increasing model complexity 1 the non linear response to pumping is due to neither vertical heterogeneity or non darcian flow and can be reproduced using a single layer homogeneous model without non darcian flow 2 the non linear response to pumping is due only to non darcian flow and can be reproduced using a single layer homogeneous model with non darcian flow as for the validation runs in section 2 3 3 the non linear response to pumping is due only to vertical heterogeneity and can be reproduced using a two layer heterogeneous model without non darcian flow 4 the non linear response to pumping is due to vertical heterogeneity and non darcian flow and can be reproduced using a two layer heterogeneous model with non darcian flow for each of the hypotheses described above a single or two layer model was set up with logarithmically spaced nodes extending from the borehole to an outer boundary at a radial distance of 1000 m a sensitivity analysis was carried out to test the impact of node refinement on model results highlighting that grid refinement in the vicinity of the borehole has a significant impact on model results when non darcian flow is included an optimum number of radial nodes was selected to balance accuracy and stability in the model results with model run times for the linear and non linear simulations 33 nodes and 801 nodes were logarithmically spaced along the radial dimension respectively this has obvious implications for model run times however the impact is not significant for practical purposes example model run times are shown in table 2 model results were also checked to ensure the outer boundary did not impact the simulated drawdowns the top of the model was set at the elevation of the rest water level which corresponds approximately to the base of the cased section of the borehole the total model thickness was 77 5 m with the base of the model corresponding with the base of the borehole this was deemed acceptable because the geophysical surveys indicate that flow into the lower 47 m of the borehole was minor and it was not necessary therefore to represent the chalk below this depth in the two layer model the elevation of the layer boundary was informed by the downhole geophysics and pumping test data and set to coincide with the boundary between the seaford and lewes nodular chalk formations which is also the approximate depth at which the borehole narrows the borehole was open throughout the full thickness of the model and was set at the enlarged diameter of 380 mm in the single layer models in the two layer models vertical variation in the borehole structure was incorporated with the diameter set at 380 mm in the upper layer and 248 mm in the lower layer the layer elevations and hydraulic heads prior to pumping were assumed constant across the model domain for each of the hypotheses listed above the radial flow model was calibrated to the variable rate test using a monte carlo method whereby a simulation consists of multiple model runs using different parameter sets that are sampled from a predefined range the modelled groundwater levels in the abstraction borehole from each run are evaluated against the observed pumping test data allowing a best fit parameter set to be identified parameter ranges for each simulation as shown in table 3 were based approximately on minimum and maximum published values of the chalk in the london basin allen et al 1997 for the single layer simulations 1000 model runs were performed with parameters sampled from the ranges displayed in table 3 sim1 and sim2 it is suggested that the number of model runs required to adequately sample the parameter space should increase by an order of magnitude per parameter when monte carlo sampling methods are applied for hydrological modelling beven 2001 however for the two layer models this becomes computationally unfeasible consequently parameters were sampled using the quasi random sobol sequencing method which produces sequences that are uniformly distributed in an n dimensional unit cube sobol 1967 sobol et al 1992 to sample more efficiently the parameter space and reduce the number of runs required an initial simulation of 10 000 runs was therefore carried out for the two layer non darcian model sim4c and this was compared with a 100 000 run simulation for the same model set up the order of magnitude increase in model runs did not produce an improved fit to the observed data and therefore 10 000 runs were performed for all two layer simulations sim3 and sim4a c using the parameter ranges shown in table 3 the modelled groundwater levels were evaluated against the observed data from the abstraction borehole using the nash sutcliffe efficiency nse this is a measure of the residual variance relative to the observed data variance and is widely used to evaluate hydrological models an nse value of one indicates a perfect fit to the observed data while a value of zero indicates that the observed mean is a better predictor than the model nse is sensitive to magnitude and will therefore be biased towards the late time data this was considered acceptable for this application because the late time data captures the non linear response of the borehole and aquifer 3 3 results fig 8 shows the modelled and observed groundwater level in the abstraction borehole for the best fit model s from each monte carlo simulation of the variable rate pumping test the single layer models simulations 1 and 2 shown in fig 8a and b do not reproduce the pumped response in the borehole this may be partly due to the failure of the model to represent vertical variations in the aquifer and borehole properties and the delayed yield process caused by movement of the water table at later times incorporating non darcian flow does not significantly improve the model performance this allows hypotheses one and two to be disregarded indicating that the non linear response in the chalk abstraction borehole must be partly attributable to vertical variations in the borehole structure i e a reduction in well storage with depth due to the borehole narrowing and or aquifer heterogeneity the simulation using a two layer darcian model simulation 3 produces three models with a nse of 0 98 fig 8c this is slightly improved upon by introducing non darcian flow in the bottom layer simulation 4b as is evident in fig 8e which shows four models with a nse of 0 99 including non darcian flow in the upper layer as is the case in simulations 4a and 4c does not appear to improve the model s ability to reproduce the observed groundwater level response in the borehole fig 8d and f the parameter sets for simulations 3 and 4b as evaluated by the nse are shown in figs 9 and 10 respectively and the best fit parameters are given in table 4 in both the darcian and non darcian models hydraulic conductivity in both the horizontal and vertical dimensions are reasonably identifiable and are generally an order of magnitude higher in layer one than layer two this suggests that the non linear response in the abstraction borehole is not fully explained by a reduction in borehole storage with depth but is partly due to vertical heterogeneity in the chalk aquifer however the significant role that the reduction in borehole diameter with depth has on the model results is demonstrated in fig 11 which shows a comparison of the four best fit two layer non darcian models with equivalent parameterisations but a uniform borehole diameter of 350 mm fig 11 this further highlights the importance of both factors vertical variations in borehole storage and hydraulic conductivity in controlling non linearity in the borehole response introducing non darcian flow in layer two results in slightly higher hydraulic conductivities in this layer compared to the darcian model this provides a better fit to the late time behaviour of the final step during which the rate of drawdown is more significantly overestimated in the darcian model the slight improvement in model performance for the non darcian model compared to the darcian model particularly during the fifth step of the test indicates that the non linear response in the borehole is most likely caused by an interplay of aquifer heterogeneity changes in borehole storage with depth and non darcian flow figs 9 and 10 show that the storage parameters are not identifiable in simulations 3 or 4b this is not surprising given the models are only evaluated against observations from the abstraction borehole and not the wider aquifer comparing the modelled cone of depression for the best fit non darcian models simulation 4b at the end of each step of the variable rate test shows that modelled groundwater levels in the wider aquifer vary significantly despite similar levels of drawdown in the abstraction borehole fig 12 this effect is not only seen in the immediate vicinity of the borehole but up to a distance of 100 m from the borehole the validation runs presented in section 2 3 highlighted that non darcian flow can also have an impact on drawdown away from the borehole with the distance of influence proportional to the forchheimer parameter fig 10 shows that the forchheimer parameter varies by an order of magnitude for the four best fit models in simulation 4b therefore variations in drawdown away from the borehole are likely due to variations in both the storage and forchheimer parameters groundwater levels from observation boreholes would help to better constrain these parameters which would help to develop a more complete understanding of the main causes of non linear behaviour in the borehole itself 4 discussion the above simulations demonstrate the ability of spiderr to simulate drawdown in an abstraction borehole in a complex heterogeneous unconfined aquifer this is particularly important for determining the sustainable yield of an abstraction borehole where yields are highly dependent on pumped water levels and may not be linearly related to abstraction the application presented here demonstrates that the model can be used as a tool to investigate the potential causes of this non linearity in the groundwater level response to pumping particularly where there aren t sufficient observations to fully understand the factors influencing drawdown in and around a borehole increasing the complexity in the model structure and performing a monte carlo simulation to calibrate the model to pumping test data from the chalk aquifer allowed the relative importance of vertical heterogeneity borehole structure and non darcian flow to be assessed in the case studied it was found that changes in borehole storage with depth as well as vertical heterogeneity in the chalk aquifer have a significant impact on the model results while introducing non darcian flow in the bottom layer was found to slightly improve the fit of the model to the observed pumping test data in general the best fit to the observed data was achieved with a higher hydraulic conductivity in layer 1 compared with layer 2 which is consistent with our understanding of vertical heterogeneity in the chalk aquifer non darcian flow was found to provide a better fit to the data when incorporated in layer 2 but not layer 1 which may be consistent with a conceptual model where flow is concentrated in fewer fractures in layer 2 therefore the average hydraulic conductivity of the layer may be lower but non darcian flow may be relatively more significant these outcomes are consistent with our general understanding of flow in the chalk under pumped conditions butler et al 2009 which can often occur through highly preferential pathways where velocities in the vicinity of abstraction wells are often sufficiently large for turbulent conditions to occur mathias et al 2007 the modelled groundwater levels in the abstraction borehole were not sensitive to the storage parameter however this significantly affects drawdown in the wider aquifer we also demonstrate that non darcian flow impacts drawdown away from the borehole with the cone of influence of non darcain flow proportional to the forchheimer parameter this highlights the need for better observation data in the vicinity of an abstraction borehole to constrain potential causes of non linearity in the groundwater level response 5 conclusions pumping test analysis remains an important tool not only for obtaining in situ upscaled aquifer parameters but also for assessing the sustainable yield of a groundwater source the spiderr model builds on previous modelling capabilities for simulating groundwater flow to boreholes by allowing darcian and non darcian flow to be represented in unconfined heterogeneous aquifers as shown through application to a chalk borehole this provides a tool for investigating the potential causes of non linear behaviour in abstraction boreholes which can have a significant impact on the sustainable yield of a borehole in this case the model was able to reproduce the short term response in the chalk abstraction borehole using a two layer non darcian model suggesting that non linearity at this source is due to a combination of factors a reduction in well storage with depth due to changes in the borehole diameter following acidisation a reduction in hydraulic conductivity with depth which is consistent with our conceptual understanding of the hydrogeology of the chalk and non darcian flow the long term response in an abstraction borehole is dependent on regional groundwater processes as well as the local scale processes investigated in this paper the spiderr model has been developed as part of a larger study which allows this borehole scale model to be incorporated into conventional groundwater models such as modflow and zoomq3d this allows the effect of both local and regional groundwater behaviour on pumped levels in abstraction boreholes to be simulated which is critical for evaluating the long term sustainable yield of an abstraction borehole this multi scale methodology will be presented in a future paper software availability name of software spiderr developer dr kirsty upton kirlto bgs ac uk availability on request program language matlab spiderr is jointly owned by imperial college london and the british geological survey declaration of interest we wish to confirm that there are no known conflicts of interest associated with this publication and there has been no significant financial support for this work that could have influenced its outcome acknowledgements spiderr was jointly developed by imperial college london icl and the british geological survey bgs and is jointly owned by icl and bgs this work was funded under an engineering and physical sciences research council epsrc doctoral training programme additional support was provided through core natural environment research council funds of the british geological survey bgs and by thames water utilities limited twul pumping test data were also provided by twul and invaluable advice on the source and test data was provided by mike jones and jamie riches twul upton jackson and mansour publish with the permission of the executive director of the bgs 
26195,reliable estimates of the sustainable yield of supply boreholes are critical to ensure that groundwater resources are managed sustainably sustainable yields are dependent on the pumped groundwater level in a borehole how this relates to vertical aquifer heterogeneity and features of the borehole itself this paper presents a 3d radial flow model spiderr based on the darcy forchheimer equation for simulating the groundwater level response in supply boreholes in unconfined heterogeneous aquifers the model provides a tool for investigating the causes of non linear behaviour in abstraction boreholes which can have a significant impact on sustainable yields this is demonstrated by simulating a variable rate pumping test in a chalk abstraction borehole the application suggests the non linear response to pumping is due to a combination of factors a reduction in well storage with depth due to changes in the borehole diameter a reduction in hydraulic conductivity with depth and non darcian flow keywords groundwater sustainable yield forchheimer equation non darcy flow radial flow model chalk aquifer 1 introduction groundwater is estimated to provide drinking water to more than 50 of the global population with 2 5 billion people solely dependent on groundwater resources for their basic daily water needs groundwater also accounts for 43 of irrigation water worldwide playing a crucial role in maintaining the livelihoods of some of the world s most vulnerable people and contributing to food security for many more wwap 2015 however it is estimated that 20 of the world s aquifers are over exploited gleeson et al 2012 a situation which is likely to escalate due to an increasing demand for water for domestic agricultural and industrial uses in the context of global population growth and climate change to develop and use groundwater resources sustainably aquifers particularly those that are strategically important or vulnerable to over abstraction and or large seasonal groundwater level fluctuations must be managed carefully within the context of the wider environment there is a need to assess both the short and long term availability of groundwater to ensure an economically socially and environmentally acceptable balance is maintained between supply and demand without risk to the long term supply over short seasonal to annual timescales this requires an understanding of the sustainable yield of individual abstraction boreholes how yields change as groundwater levels decline seasonally particularly during droughts and the impact of abstraction on the surrounding environment e g river flows and groundwater dependent ecosystems over longer timescales it is important to understand groundwater abstraction within the context of long term average recharge to prevent continuous declines in groundwater levels and consequent long term reductions in aquifer and borehole yields the sustainable yield of a borehole reflects an interplay between regional and local scale processes at the regional scale yields are largely influenced by the spatial and temporal distribution of recharge groundwater storage and aquifer transmissivity at the local scale yields are critically dependent on the pumped water level in the borehole and how this relates to vertical aquifer heterogeneity the nature and distribution of inflow horizons to the borehole and features of the borehole itself such as borehole storage the depth of the pump and its pumping characteristics foster et al 2017 in unconfined vertically heterogeneous aquifers particularly fractured aquifers which are estimated to cover more than 20 of the earth s surface krasny and sharp 2007 the groundwater level response in a pumped borehole can be highly non linear dewatering of major fractures or inflow horizons can result in significant reductions to the yield of a borehole as the groundwater level in the borehole falls in response to pumping understanding this response and being able to accurately model it is therefore crucial for determining the sustainable yield of a borehole particularly during droughts and predicting how yields might change in response to future reductions in groundwater recharge doll 2009 and or increases in demand the groundwater level response in a pumped borehole is typically tested by constant or variable rate pumping tests carried out over periods of hours to days numerous analytical and numerical methods have been developed to analyse these tests under different hydrogeological conditions analytical solutions exist for solving for the groundwater level in a pumped borehole in confined theis 1935 and unconfined neuman 1972 aquifers with large diameter abstraction boreholes papadopulos and cooper 1967 mathias and butler 2006 and non linear well losses jacob 1947 and in non uniform or fractured aquifers barker and herbert 1982 barker 1988 butler 1988 butler and liu 1993 these methods are generally based on a number of simplifying assumptions that may not be satisfied in hydrogeologically complex aquifers which can be more accurately represented by numerical models the most commonly applied numerical method for simulating flow to an abstraction borehole is based on a finite difference approximation to the governing flow equation in cylindrical coordinates whereby specific discharge is calculated using darcy s law this method was applied in the earliest radial flow models rushton 1974 rushton and booth 1976 rushton and redshaw 1979 rathod rushton 1984 1991 sakthivadivel and rushton 1989 and in more recent developments such as coompute mansour et al 2003 and modflow samani et al 2004 langevin 2008 louwyck et al 2012 2014 the application of these models has highlighted the importance of representing several features in and around a borehole to accurately simulate the pumped water level in the borehole confined and unconfined conditions and particularly variations in the rest water level where hydraulic conductivity varies with depth rushton and chan 1976 aquifer heterogeneity in both the vertical and horizontal dimension connorton and reed 1978 mansour et al 2006 2011 development of vertical head gradients and vertical flow rushton and howard 1982 rathod and rushton 1991 well storage casing and screening and seepage face development rushton and singh 1987 sakthivadivel and rushton 1989 rushton 2006 a common observation during variable rate pumping tests which are designed to test the efficiency of a borehole is the effect of well losses or a non linear increase in drawdown with the rate of abstraction well losses can be attributed to the effect of flow through gravel packs or well screens the development of a seepage face or to the development of non darcian flow in the aquifer itself the radial flow models described above typically account for well losses by lowering the hydraulic conductivity in the immediate vicinity of the borehole but assume that flow in the aquifer remains linear and can therefore be described by darcy s law the significance of non darcian groundwater flow is well documented in the literature sen 1987 1989 1990 2000 kohl et al 1997 wen et al 2006 qian et al 2007 this is particularly the case where high flow velocities are likely to develop around abstraction boreholes in fractured aquifers non darcian groundwater flow is most commonly represented by forchheimer s law which includes a quadratic term to account for the observed non linear relationship between head gradient and specific discharge as flow velocities increase forchheimer 1901 several analytical models based on forchheimer s law are available in the literature şen 1988 ewing et al 1999 mathias et al 2008 mathias and wen 2015 liu et al 2017 and it has been applied using finite difference and mesh free methods to simulate drawdown in 1d confined and leaky aquifers mathias and todman 2010 wen et al 2011 2014 there are however no examples in the literature of numerical groundwater models that incorporate forchheimer non darcian flow aquifer heterogeneity and the detailed features of an abstraction borehole which have all previously been shown to influence drawdown in pumped boreholes this represents a gap in our analytical tools to simulate and assess sustainable borehole yields in unconfined aquifers this paper presents a 3d radial flow model spiderr based on the darcy forchheimer equation for simulating the pumped water level in an abstraction borehole the model can represent confined and unconfined aquifers vertical and horizontal aquifer heterogeneity darcian and non darcian flow and key features of a borehole such as changes in diameter with depth well casing and screening this is crucial if the simulation of sustainable borehole yields which can reduce as groundwater levels fall in response to pumping in complex water table aquifers is to be improved as outlined above a reliable estimation of borehole yields is key to managing groundwater resources in a safe and sustainable way in the uk this is also a statutory requirement for water companies who must provide estimates of the sustainable yield of supply boreholes during droughts as part of the water resource management process the model presented here integrates components of the work described above explicitly representing all of the pertinent hydrogeological and borehole construction features that may be required to simulate the water level response in an abstraction borehole during pumping the model is evaluated against an analytical solution for non linear drawdown in a pumped borehole cooper and jacob 1946 and by reproducing two relatively simple step drawdown tests from confined sandstone aquifers as previously presented by mathias and todman 2010 the model is then applied to simulate a more complex groundwater level response from a pumping test in an abstraction borehole in the chalk aquifer this is the principal aquifer in the uk where borehole yields are often significantly affected by pumped water levels and vertical heterogeneity related to fracture development butler et al 2009 the application to simulate a variable rate pumping test in a chalk borehole demonstrates that the model can be used as a tool to investigate the causes of non linearity in the groundwater level response to pumping the ability of spiderr to simulate the short term response in an abstraction borehole is a key step in evaluating the long term sustainable yield of a borehole the model has been developed as part of a wider study which has produced a methodology to insert this borehole scale model into a regional groundwater flow model this coupled representation of local and regional groundwater processes is critical for estimating the long term sustainable yield of a borehole upton 2014 we cite this wider study which will be presented in a future paper as it places the development of this model in context the focus of this paper however is on the development of the radial flow model and its application to simulate drawdown during variable rate pumping tests which allows us to investigate the key factors influencing drawdown in complex heterogeneous aquifers 2 model description 2 1 conceptualisation the model is constructed on a three dimensional cylindrical grid as shown in fig 1 this allows aquifer heterogeneity to be represented along the radial r cylindrical θ and vertical z axes grid nodes are spaced logarithmically in the radial direction to provide refinement in the vicinity of the borehole where the hydraulic head or in the case of an unconfined aquifer the water table has greatest curvature the borehole is located at the centre of the radial grid and is represented by a single node with a specified radius the borehole node can extend to the base of any model layer allowing the representation of fully or partially penetrating boreholes the borehole can be connected to the first adjacent aquifer node located on the well face with a very high conductance term to represent an open borehole a specified conductance to represent a well screen or it can be completely disconnected from the aquifer node to represent the presence of a well casing a gravel pack can be represented by modifying the hydraulic conductivity of the aquifer nodes around the borehole the borehole node to which pumping is applied has a storage coefficient equal to unity to represent well storage the depth of the pump is also specified such that no water can continue to be abstracted if the water level in the borehole falls below this depth the vertical dimension of the model is represented as a series of horizontal layers of varying thickness nodes transition between confined unconfined and inactive depending on the elevation of the groundwater head relative to the top and bottom of the layer fig 1 cell dewatering and rewetting often causes numerical instabilities in groundwater models particularly when modelling highly non linear systems an upstream weighting approach similar to that applied in modflow nwt niswonger et al 2011 has been implemented in the radial flow model to help smooth the transition when cells dewater or rewet in a single direction the flux between two cells is therefore based on the weighted harmonic mean of the hydraulic conductivity of the two cells and the up gradient saturated thickness in that direction this means that water cannot flow horizontally out of a dewatered cell but it can still receive water from an up gradient cell all water entering a dewatered cell either from an adjacent cell or from recharge is automatically routed vertically to the active node below this helps to smooth the transition as cells dewater and rewet thus reducing numerical instabilities vertical flow from the water table and development of a seepage face are common features around abstraction boreholes in unconfined aquifers rushton and howard 1982 rushton and singh 1987 sakthivadivel and rushton 1989 rathod and rushton 1991 rushton 2006 flow across a seepage face is poorly quantified particularly in fractured aquifers it occurs across the interval between the water level in the borehole and the elevation at which the water table intersects the borehole wall in the radial flow model the groundwater head in the upper unconfined layer does not explicitly represent the elevation of the water table but an average of the head within that layer in a single layer model the use of the dupuit approximation for unconfined flow assumes that all flow into the borehole is horizontal and occurs below the water level in the borehole fig 2 a vertical discretization allows the vertical component of flow to be incorporated fig 2b and a seepage face is approximated by allowing a layer to discharge to the borehole even after the water level in the borehole has fallen below the base of the layer under these conditions the head at the node on the borehole wall which represents the seepage face is fixed at the elevation of the base of the layer and all flow into this node from the adjacent aquifer node is passed directly into the borehole when this aquifer node also dewaters the layer becomes horizontally disconnected from the borehole and seepage flow stops this representation is slightly different from the coompute radial flow model which approximates seepage flow by representing the water table as a discrete numerical layer mansour et al 2011 while the coompute model provides an approximate solution of the water table elevation vertical discretization is still required to represent seepage flow and there are known issues during recovery whereby the water level in the borehole rises more quickly than the water table surface in adjacent aquifer nodes resulting in flow from the borehole into the aquifer 2 2 mathematical formulation the radial flow model is based on the continuity equation for transient groundwater flow through a porous medium in cylindrical co ordinates 1 r q r q r r 1 r q θ θ q z z n q s s h t where q is specific discharge lt 1 in the radial r cylindrical θ and vertical z dimensions n and q are a volumetric source and sink per unit volume t 1 respectively s s is specific storage l 1 t is time t and h is hydraulic head l the vertical dimension is replaced by a series of layers hydraulic head is a mean value over the saturated thickness of each layer b l and vertical flow between layers is calculated as a leakage term lt 1 specific storage is replaced by a storage coefficient s where s s s b for confined layers i e where groundwater head is above the top elevation of the layer z t s s s b s y for unconfined layers i e where groundwater head is between z t and the elevation of the bottom of the layer z b and s y is the specific yield of the layer note that b z t z b for confined layers and b h z b for unconfined layers specific discharge in the radial and cylindrical dimensions is calculated by the darcy forchheimer equation q r θ β q r θ 2 k r θ h r θ where β is the non linear forchheimer parameter l 1t and k r θ is hydraulic conductivity lt 1 in the radial and cylindrical directions this reduces to darcy s law when β 0 the numerical model is based a finite difference approximation to the continuity equation which reduces to the following set of ordinary differential equations with respect to time t s h i j k t r i 1 2 j k b max i j k i 1 j k q i 1 2 j k r i 1 2 j k b max i j k i 1 j k q i 1 2 j k r i j k r i 1 2 j k r i 1 2 j k b max i j k i j 1 k q i j 1 2 k b max i j k i j 1 k q i j 1 2 k r i j k δ θ q i j k 1 2 q i j k 1 2 n q this allows groundwater head to be approximated at each node in the radial i cylindrical j and vertical k directions whereby r i is the radial distance from the borehole to the node mathias et al 2008 show that the darcy forchheimer equation can be solved for specific discharge to give in the radial direction q i 1 2 j k 1 2 β i 1 2 j k 1 4 β i 1 2 j k k i 1 2 j k h i j k h i 1 j k r i j k r i 1 j k 1 2 1 vertical flow across layer boundaries is calculated by q i j k 1 2 2 k z i j k 1 k z i j k k z i j k δ z i j k 1 k z i j k 1 δ z i j k h i j k h i j k 1 where k z is the vertical hydraulic conductivity of a layer and δz is the thickness of the layer the vertical and horizontal hydraulic conductivities forchheimer parameter specific storage and specific yield can be set at different values for each individual layer in the model to represent vertical heterogeneity in the aquifer horizontal heterogeneity can also be incorporated by specifying different conductivities and storage values at each node within a layer if this is the case the harmonic mean is used to calculate the conductivity between adjacent nodes the darcy forchheimer radial flow model is coded using the matlab software package mathworks 2012 the set of non linear ordinary differential equations is solved using the stiff differential equation solver ode15s shampine and reichlet 1997 this is an implicit variable order solver which uses adaptive time stepping based on the error in computed head at each iteration 2 3 validation testing the model was evaluated against various analytical solutions that describe drawdown in simplified aquifers and was found to accurately reproduce the response in large diameter boreholes in confined and unconfined aquifers papadopulos and cooper 1967 neuman 1972 the model was also evaluated against a late time approximation to the forchheimer equation using the cooper jacob solution cooper and jacob 1946 and the method of matched asymptotic expansion mathias et al 2008 this provides a benchmark for testing the non linear behaviour of the spiderr model a series of single layer confined and laterally extensive 10 km radius models were set up with a hydraulic conductivity of 50 m day 1 aquifer thickness of 10 m specific storage of 10 6 m 1 and abstraction rate of 1000 m3 day 1 eight non linear models were run with the forchheimer parameter increasing from 0 05 to 1 5 m 1 day these models were compared with an equivalent linear model in which the forchheimer parameter was set to zero table 1 the transmissivity and storage thus the linear component of drawdown were constant in all models and the variations in drawdown between the linear and non linear models is therefore due only to variations in the forchheimer parameter the proportion of the total late time drawdown attributable to the non linear component of drawdown is shown in table 1 for each test simulation the results of the linear and non linear simulations were compared with the analytical model whereby the cooper jacob non linear parameter is calculated from the forchheimer parameter according to the relationship presented by mathias and todman 2010 see table 1 the numerical model does not match the early time data of the analytical model because this does not account for well storage but there is agreement between the models at late times in all simulations fig 3 a comparison of the cones of depression at the end of the simulation 1 day shows that the influence of non linearity decreases away from the borehole the test simulations presented in fig 3 show that the relationship between the forchheimer parameter and the distance from the borehole at which the influence of non linear flow is no longer observed defined as the distance at which the difference between the final cones of depression for the linear and non linear models is 1 cm and therefore largely unmeasurable is approximately linear fig 3b the difference between the final cone of depression for the linear model and non linear test 1 which has a forchheimer parameter of 0 05 m 1 day is negligible 1 cm at a distance of 25 m from the borehole fig 3c for the final non linear test which has a forchheimer parameter of 1 5 m 1 day the cone of depression converges to the linear model at a distance of around 700 m from the borehole fig 3d table 1 shows that the non linear component of drawdown in test 8 accounts for more than 95 of the total drawdown which is unlikely to be a realistic estimation in the case studies presented by mathias and todman 2010 which simulate step drawdown tests in four different aquifer types using a 1d darcy forchheimer radial flow model the non linear component of drawdown accounts for between 1 and 60 of the total drawdown for equivalent components of non linear losses the simulations presented above suggest that the impact of non darcian flow will be fairly localised around the abstraction borehole with the biggest impact on drawdown observed within 10 m of the borehole this has implications for the required location of an observation borehole to verify the non linear component of drawdown which would need to be located close to the abstraction borehole to be within the cone of influence of non darcian flow spiderr is further evaluated by reproducing two relatively simple step drawdown tests previously presented by clark 1977 and van tonder et al 2001 and modelled by mathias and todman 2010 using a 1d forchheimer model these tests are from confined sandstone aquifers and are accurately reproduced by a 1d homogeneous confined spiderr model using the best fit parameters identified by mathias and todman 2010 fig 4 the validation exercises described above demonstrate the ability of spiderr to represent linear and non linear flow to boreholes in relatively simple homogeneous aquifers further evaluation of the model for simulating observed groundwater level data from more complex heterogeneous aquifers is provided in the following section through application to a variable rate pumping test in a chalk abstraction borehole 3 model application 3 1 study area pumping test data the spiderr model represents a range of hydrogeological and borehole construction features that may control the groundwater level response in an abstraction borehole providing a tool for simulating drawdown in complex heterogeneous aquifers where the assumptions of simpler analytical models are not met this is illustrated in the following sections through application to a groundwater source in the chalk aquifer in the uk which displays a distinct non linear response to pumping the model is used as a tool to investigate the key factors influencing drawdown and thus the yield of the borehole in this strategically important dual permeability aquifer the chalk aquifer is designated a principal aquifer in the uk accounting for up to 70 of the total public water supply in parts of southern england butler et al 2012 the chalk is a very fine grained limestone deposited over significant parts of england and northern europe during a cretaceous marine transgression in southern england the chalk aquifer has a thickness of 200 400 m and is classified into several members based on widespread flint and marl units bristow et al 1997 the chalk matrix is highly porous 20 45 but has very low permeability 10 2 m day 1 matrix blocks are typically bound by interconnected fractures the fracture network which is often enhanced by dissolution is highly permeable 10 2 m day 1 and is the principal mechanism for groundwater flow in the saturated zone allen et al 1997 macdonald et al 1998 trends in fracture density are controlled by depth and location within a catchment and correspond with distinct vertical and lateral variations in transmissivity and storativity owen and robinson 1978 fractures generally have a higher density at shallow depths and in valleys and dry valleys and a lower density at greater depths and on the interfluves williams et al 2006 the chalk aquifer therefore displays two broad vertical hydraulic zones 1 a high permeability upper zone of active groundwater movement within which the water table fluctuates and fractures are enhanced by dissolution 2 a deeper zone of slow regional scale flow characterised by low relatively uniform permeability lateral variations in transmissivity are also observed with transmissivity estimates from pumping tests in valleys or dry valleys typically ranging from 500 m2 day 1 to 2000 m2 day 1 and those on the interfluves suggesting transmissivities of approximately 50 m2 day 1 allen et al 1997 the variations in the properties of the chalk described above have a strong influence on the yield of abstraction boreholes which often vary non linearly with groundwater level rushton and chan 1976 butler et al 2009 mansour et al 2011 tamayo mas et al 2018 the pumping test analysed for this study is from a borehole commissioned by thames water utilities ltd in the early 2000s located at the western extent of the bean well field in the south eastern part of the london basin fig 5 the chalk in this region forms the dip slope of the north downs and the regional hydraulic gradient generally slopes from the chalk escarpment in the south to the river thames in the north the chalk of the north downs is known to have well developed karstic systems allen et al 1997 it is locally covered by the palaeogene thanet sand formation and overlying lambeth group which largely comprise clays to fine grained sandstones it is largely unconfined due to the depth of the water table the borehole is drilled to a depth of 137 m with a diameter of 406 mm in the upper 60 5 m and 248 mm below this it is cased within the upper 60 m and open below this depth geological and geophysical logging of the borehole indicate the following features thanet sands are present in the upper 16 m of the borehole below which the seaford and lewes nodular chalk formations are present with respective thicknesses of 62 and 45 m the seaford chalk is composed mainly of soft blocky white chalk which has a high flint content in its lower 10 m in this area the lewes nodular chalk is composed of hard nodular chalk and is well fractured in its upper 10 m the rest water level was recorded at a depth of 60 m the caliper log shows borehole enlargement due to acidisation between 60 and 80 m depth with an increased diameter of 380 mm below which the diameter is closer to the drilled diameter of 248 mm the interval between 60 and 90 m depth shows lower fluid temperature and electrical conductivity relative to those at lower depths below 90 m depth the gamma and resistivity logs show a number of distinct marl bands which coincide with higher fluid temperature and electrical conductivity buckley 2003 the geophysical observations suggest that the majority of inflow to the borehole occurs above a depth of 90 m corresponding with the fractured boundary between the seaford and lewes nodular chalk formations fig 6 the borehole was tested with a variable rate pumping test which was carried out after two phases of borehole development involving acid injection and air lifting the test consisted of five 100 min steps at abstraction rates increasing from 10 to 30 l per second ls 1 0 86 2 6 ml per day the time drawdown data from the pumping test are shown in fig 7 there is evidence of non linear behaviour during the test particularly the final step which shows a significant increase in drawdown relative to the increase in abstraction rate the increased drawdown observed during step five occurs when the pumped groundwater level in the borehole falls below the boundary between the seaford and lewes nodular chalk formations which also coincides with the reduction in borehole diameter as outlined in the introduction non linearity in the groundwater level response to pumping could be due to a number of factors including aquifer heterogeneity borehole construction and losses and aquifer losses due to non darcian flow these will be explored further in the following section groundwater levels were not monitored in any observation boreholes during this pumping test therefore analysis focuses solely on the abstraction borehole 3 2 methodology spiderr is used to simulate the variable rate test described above both to evaluate the model s ability to reproduce drawdown in complex heterogeneous aquifers and to investigate the potential causes of non linearity in the groundwater level response in this chalk abstraction borehole in order to do this the following hypotheses were tested with a series of simulations with increasing model complexity 1 the non linear response to pumping is due to neither vertical heterogeneity or non darcian flow and can be reproduced using a single layer homogeneous model without non darcian flow 2 the non linear response to pumping is due only to non darcian flow and can be reproduced using a single layer homogeneous model with non darcian flow as for the validation runs in section 2 3 3 the non linear response to pumping is due only to vertical heterogeneity and can be reproduced using a two layer heterogeneous model without non darcian flow 4 the non linear response to pumping is due to vertical heterogeneity and non darcian flow and can be reproduced using a two layer heterogeneous model with non darcian flow for each of the hypotheses described above a single or two layer model was set up with logarithmically spaced nodes extending from the borehole to an outer boundary at a radial distance of 1000 m a sensitivity analysis was carried out to test the impact of node refinement on model results highlighting that grid refinement in the vicinity of the borehole has a significant impact on model results when non darcian flow is included an optimum number of radial nodes was selected to balance accuracy and stability in the model results with model run times for the linear and non linear simulations 33 nodes and 801 nodes were logarithmically spaced along the radial dimension respectively this has obvious implications for model run times however the impact is not significant for practical purposes example model run times are shown in table 2 model results were also checked to ensure the outer boundary did not impact the simulated drawdowns the top of the model was set at the elevation of the rest water level which corresponds approximately to the base of the cased section of the borehole the total model thickness was 77 5 m with the base of the model corresponding with the base of the borehole this was deemed acceptable because the geophysical surveys indicate that flow into the lower 47 m of the borehole was minor and it was not necessary therefore to represent the chalk below this depth in the two layer model the elevation of the layer boundary was informed by the downhole geophysics and pumping test data and set to coincide with the boundary between the seaford and lewes nodular chalk formations which is also the approximate depth at which the borehole narrows the borehole was open throughout the full thickness of the model and was set at the enlarged diameter of 380 mm in the single layer models in the two layer models vertical variation in the borehole structure was incorporated with the diameter set at 380 mm in the upper layer and 248 mm in the lower layer the layer elevations and hydraulic heads prior to pumping were assumed constant across the model domain for each of the hypotheses listed above the radial flow model was calibrated to the variable rate test using a monte carlo method whereby a simulation consists of multiple model runs using different parameter sets that are sampled from a predefined range the modelled groundwater levels in the abstraction borehole from each run are evaluated against the observed pumping test data allowing a best fit parameter set to be identified parameter ranges for each simulation as shown in table 3 were based approximately on minimum and maximum published values of the chalk in the london basin allen et al 1997 for the single layer simulations 1000 model runs were performed with parameters sampled from the ranges displayed in table 3 sim1 and sim2 it is suggested that the number of model runs required to adequately sample the parameter space should increase by an order of magnitude per parameter when monte carlo sampling methods are applied for hydrological modelling beven 2001 however for the two layer models this becomes computationally unfeasible consequently parameters were sampled using the quasi random sobol sequencing method which produces sequences that are uniformly distributed in an n dimensional unit cube sobol 1967 sobol et al 1992 to sample more efficiently the parameter space and reduce the number of runs required an initial simulation of 10 000 runs was therefore carried out for the two layer non darcian model sim4c and this was compared with a 100 000 run simulation for the same model set up the order of magnitude increase in model runs did not produce an improved fit to the observed data and therefore 10 000 runs were performed for all two layer simulations sim3 and sim4a c using the parameter ranges shown in table 3 the modelled groundwater levels were evaluated against the observed data from the abstraction borehole using the nash sutcliffe efficiency nse this is a measure of the residual variance relative to the observed data variance and is widely used to evaluate hydrological models an nse value of one indicates a perfect fit to the observed data while a value of zero indicates that the observed mean is a better predictor than the model nse is sensitive to magnitude and will therefore be biased towards the late time data this was considered acceptable for this application because the late time data captures the non linear response of the borehole and aquifer 3 3 results fig 8 shows the modelled and observed groundwater level in the abstraction borehole for the best fit model s from each monte carlo simulation of the variable rate pumping test the single layer models simulations 1 and 2 shown in fig 8a and b do not reproduce the pumped response in the borehole this may be partly due to the failure of the model to represent vertical variations in the aquifer and borehole properties and the delayed yield process caused by movement of the water table at later times incorporating non darcian flow does not significantly improve the model performance this allows hypotheses one and two to be disregarded indicating that the non linear response in the chalk abstraction borehole must be partly attributable to vertical variations in the borehole structure i e a reduction in well storage with depth due to the borehole narrowing and or aquifer heterogeneity the simulation using a two layer darcian model simulation 3 produces three models with a nse of 0 98 fig 8c this is slightly improved upon by introducing non darcian flow in the bottom layer simulation 4b as is evident in fig 8e which shows four models with a nse of 0 99 including non darcian flow in the upper layer as is the case in simulations 4a and 4c does not appear to improve the model s ability to reproduce the observed groundwater level response in the borehole fig 8d and f the parameter sets for simulations 3 and 4b as evaluated by the nse are shown in figs 9 and 10 respectively and the best fit parameters are given in table 4 in both the darcian and non darcian models hydraulic conductivity in both the horizontal and vertical dimensions are reasonably identifiable and are generally an order of magnitude higher in layer one than layer two this suggests that the non linear response in the abstraction borehole is not fully explained by a reduction in borehole storage with depth but is partly due to vertical heterogeneity in the chalk aquifer however the significant role that the reduction in borehole diameter with depth has on the model results is demonstrated in fig 11 which shows a comparison of the four best fit two layer non darcian models with equivalent parameterisations but a uniform borehole diameter of 350 mm fig 11 this further highlights the importance of both factors vertical variations in borehole storage and hydraulic conductivity in controlling non linearity in the borehole response introducing non darcian flow in layer two results in slightly higher hydraulic conductivities in this layer compared to the darcian model this provides a better fit to the late time behaviour of the final step during which the rate of drawdown is more significantly overestimated in the darcian model the slight improvement in model performance for the non darcian model compared to the darcian model particularly during the fifth step of the test indicates that the non linear response in the borehole is most likely caused by an interplay of aquifer heterogeneity changes in borehole storage with depth and non darcian flow figs 9 and 10 show that the storage parameters are not identifiable in simulations 3 or 4b this is not surprising given the models are only evaluated against observations from the abstraction borehole and not the wider aquifer comparing the modelled cone of depression for the best fit non darcian models simulation 4b at the end of each step of the variable rate test shows that modelled groundwater levels in the wider aquifer vary significantly despite similar levels of drawdown in the abstraction borehole fig 12 this effect is not only seen in the immediate vicinity of the borehole but up to a distance of 100 m from the borehole the validation runs presented in section 2 3 highlighted that non darcian flow can also have an impact on drawdown away from the borehole with the distance of influence proportional to the forchheimer parameter fig 10 shows that the forchheimer parameter varies by an order of magnitude for the four best fit models in simulation 4b therefore variations in drawdown away from the borehole are likely due to variations in both the storage and forchheimer parameters groundwater levels from observation boreholes would help to better constrain these parameters which would help to develop a more complete understanding of the main causes of non linear behaviour in the borehole itself 4 discussion the above simulations demonstrate the ability of spiderr to simulate drawdown in an abstraction borehole in a complex heterogeneous unconfined aquifer this is particularly important for determining the sustainable yield of an abstraction borehole where yields are highly dependent on pumped water levels and may not be linearly related to abstraction the application presented here demonstrates that the model can be used as a tool to investigate the potential causes of this non linearity in the groundwater level response to pumping particularly where there aren t sufficient observations to fully understand the factors influencing drawdown in and around a borehole increasing the complexity in the model structure and performing a monte carlo simulation to calibrate the model to pumping test data from the chalk aquifer allowed the relative importance of vertical heterogeneity borehole structure and non darcian flow to be assessed in the case studied it was found that changes in borehole storage with depth as well as vertical heterogeneity in the chalk aquifer have a significant impact on the model results while introducing non darcian flow in the bottom layer was found to slightly improve the fit of the model to the observed pumping test data in general the best fit to the observed data was achieved with a higher hydraulic conductivity in layer 1 compared with layer 2 which is consistent with our understanding of vertical heterogeneity in the chalk aquifer non darcian flow was found to provide a better fit to the data when incorporated in layer 2 but not layer 1 which may be consistent with a conceptual model where flow is concentrated in fewer fractures in layer 2 therefore the average hydraulic conductivity of the layer may be lower but non darcian flow may be relatively more significant these outcomes are consistent with our general understanding of flow in the chalk under pumped conditions butler et al 2009 which can often occur through highly preferential pathways where velocities in the vicinity of abstraction wells are often sufficiently large for turbulent conditions to occur mathias et al 2007 the modelled groundwater levels in the abstraction borehole were not sensitive to the storage parameter however this significantly affects drawdown in the wider aquifer we also demonstrate that non darcian flow impacts drawdown away from the borehole with the cone of influence of non darcain flow proportional to the forchheimer parameter this highlights the need for better observation data in the vicinity of an abstraction borehole to constrain potential causes of non linearity in the groundwater level response 5 conclusions pumping test analysis remains an important tool not only for obtaining in situ upscaled aquifer parameters but also for assessing the sustainable yield of a groundwater source the spiderr model builds on previous modelling capabilities for simulating groundwater flow to boreholes by allowing darcian and non darcian flow to be represented in unconfined heterogeneous aquifers as shown through application to a chalk borehole this provides a tool for investigating the potential causes of non linear behaviour in abstraction boreholes which can have a significant impact on the sustainable yield of a borehole in this case the model was able to reproduce the short term response in the chalk abstraction borehole using a two layer non darcian model suggesting that non linearity at this source is due to a combination of factors a reduction in well storage with depth due to changes in the borehole diameter following acidisation a reduction in hydraulic conductivity with depth which is consistent with our conceptual understanding of the hydrogeology of the chalk and non darcian flow the long term response in an abstraction borehole is dependent on regional groundwater processes as well as the local scale processes investigated in this paper the spiderr model has been developed as part of a larger study which allows this borehole scale model to be incorporated into conventional groundwater models such as modflow and zoomq3d this allows the effect of both local and regional groundwater behaviour on pumped levels in abstraction boreholes to be simulated which is critical for evaluating the long term sustainable yield of an abstraction borehole this multi scale methodology will be presented in a future paper software availability name of software spiderr developer dr kirsty upton kirlto bgs ac uk availability on request program language matlab spiderr is jointly owned by imperial college london and the british geological survey declaration of interest we wish to confirm that there are no known conflicts of interest associated with this publication and there has been no significant financial support for this work that could have influenced its outcome acknowledgements spiderr was jointly developed by imperial college london icl and the british geological survey bgs and is jointly owned by icl and bgs this work was funded under an engineering and physical sciences research council epsrc doctoral training programme additional support was provided through core natural environment research council funds of the british geological survey bgs and by thames water utilities limited twul pumping test data were also provided by twul and invaluable advice on the source and test data was provided by mike jones and jamie riches twul upton jackson and mansour publish with the permission of the executive director of the bgs 
26196,investment decisions in renewable energies are known to be influenced by many diverse drivers e g social political geographic economic and psychological non comprehensive models are problematic since missed interactions might introduce bias we implement a robust modelling approach by 1 using a large data set with 1 4 million solar installations and 2 three different machine learning algorithms deep neural networks gradient boosting random forests generalized linear models serve as baseline and comparison a high prediction accuracy can be achieved on the county level with deep neural networks adjusted r2 0 86 and gradient boosting adjusted r2 0 87 the most important drivers are population per county followed by type of urbanisation and social variables like unemployment with varying degree of importance for the different machine learning algorithms our approach points out both differences and agreements across methods and therefore a higher confidence in their interpretation keywords investment decisions solar installation renewable energy deep learning machine learning germany 1 introduction on our way to reduce carbon emissions improvements in many different areas are necessary in some areas e g electromobility progress is very slow www eafo eu while increasing the share of electricity from renewables is well underway williams et al 2012 haegel et al 2017 in order to achieve the paris agreement to keep the average global temperature below 2 c an almost completely decarbonised electricity sector is needed by 2050 irena 2018 since it is responsible for about 25 of all energy related co2 emissions ipcc 2014 however large differences between countries remain both in the private and the public sector while in some countries large investments in solar and wind have been made china japan germany other countries and other technologies lag behind ren21 2017 solar pv is a cornerstone for achieving the paris agreement since it reduces the need for fossil fuel based power plants in germany for example the installed pv capacity reached 40 gw in 2016 with an electricity generation of 38 gwh this implies a net mitigation of greenhouse gas emissions of more than 23 000 tons in that year from pv generated electricity alone memmler et al 2017 hence private investments in solar installations on roof tops are a central part of the future electricity mix and make up a substantial part of reducing co2 emissions breyer et al 2017 it is remarkable that there is uncertainty about the factors that drive the decision making process behind such private investments kastner and stern 2015 although it seems clear that a variety of factors influence investments in renewables romano and fumagalli 2018 kwan 2012 wüstenhagen and menichetti 2012 both endogenous e g individual risk aversity and exogenous e g interest rates to the decision making process no clear picture has emerged yet a review study as recent as 2015 concludes that much research still needs to be done to understand energy relevant investment decisions of households we could identify only 26 empirical studies looking across many countries several decades and several scientific disciplines kastner and stern 2015 p 84 p 84 therefore the present study aims to develop a more comprehensive model with potential factors from various backgrounds including social economic and geographic drivers in contrast to surveys e g kastner and matthies 2016 that suffer from their hypothetical nature we use an existing data set of real investments in photovoltaics pv in germany from 1991 to 2014 these 1 4 million investment decisions are merged with other data sets with information on employment rural urban characteristics election results etc 2 state of the art 2 1 existing problems in modelling investments in renewables many studies agree that investment decisions are complex and influenced by many drivers although many of these factors have been identified in previous studies no clear picture has yet emerged on the one hand this is due to the fact that drivers come from different backgrounds social political geographic economic and psychological factors are known to influence investment decisions in renewables kastner and stern 2015 on the other hand this is due to a lack of large data sets rich enough to encompass more than a handful of drivers known to influence investment decisions one major step forward of this article is to create such a large data set which includes almost all pv installations in one country on a local scale with factors from various domains therefore it does not come as surprise that many studies do not include most drivers in their surveys and models this is understandable but problematic since missed interactions between drivers that are not part of the model might introduce considerable bias the choice of methods also introduces problems most studies tend to emphasize certain variables often the method choice reflects this and the respective disciplinary background if for example geographic factors are considered the most relevant models will most likely include spatial components bollinger and gillingham 2012 rode and weber 2016 if psychological factors are considered important modelling will follow psychological theories ajzen and fishbein 2005 korcaj et al 2015 and so on in conclusion the variety of methods used in previous studies is quite large and sometimes reflects the various disciplinary backgrounds since the number of potential drivers is quite large complexity is an issue as well per se a large number of drivers would not be a problem more factors could be added over time to ever more complex models in order to achieve satisfactory explanatory power however most drivers identified do not consistently point in one direction on the contrary a review paper finds conflicting evidence for almost all drivers e g for age the most frequently analyzed demographic variables concerned the decision makers age or retirement status n 30 in 18 of these cases an association was found these associations were positive in six cases negative in ten cases and curvilinear in two cases with amid level age positively associated with an investment decision kastner and stern 2015 this may be due to less comprehensive models as pointed out above or due to the use of different methodologies a fourth problem is that not too many large and rich data sets exist which are both highly detailed in time and space while not lacking in social economic and other dimensions one solution for this problem by some existing studies is the augmentation i e the enrichment of large data sets e g solar installations with economic data see klein and deissenroth 2017 however data augmentation is relatively rare in the literature this paper also enriches existing data sets in this way in order to address these problems we take a different modelling approach concerning the problem method choice according to background we instead use machine learning algorithms which do not presuppose any model structure this allows implementing a data driven approach concerning the problem of conflicting direction of potential drivers we use a large data set with 1 4 million installations in order to increase the robustness of findings a large data set also helps to mitigate the problem of spurious correlations the second problem hidden interactions i e interactions between variables that are not part of a model that nevertheless influence variables that are present in a particular model is addressed through the comprehensive set of drivers from various backgrounds modelling is performed with four different methods deep neural networks gradient boosting random forests and generalized linear models in order to check whether direction and strength of independent variables are dependent on method choice 2 2 drivers for investment decisions in previous research the following section discusses the identified drivers for investment decisions from previous studies for a meta analysis see kastner and stern 2015 for a summary of motivations and barriers see balta ozkan et al 2015 for an application of abm modelling to investment decisions see rai and robinson 2015 identified drivers are from the geographic economic psychological demographic political and social domain identification is data driven i e drivers are included that have been empirically found to be relevant in previous analyses these studies are in turn based on different theories in their respective fields which are shortly discussed below for each section of drivers geographic factors are among the most prominent a higher solar insolation irradiation is not surprisingly positively correlated with the adoption of residential solar pv kwan 2012 this is supported by studies in the uk balta ozkan et al 2015 who find only small effects however a study from japanese prefectures does not find any effect zhang et al 2011 since the amount of irradiation directly affects the profitability this geographic factor influences economic considerations as well a second set of factors are economic variables that have been shown to be relevant for profitability considerations include the cost of electricity the household income and the home value kwan 2012 kastner and matthies 2016 installation costs seem to be a major factor too zhang et al 2011 however installation costs decrease with more installations so there is a reinforcing feedback loop here most notably residents take long term benefits into account i e lower electricity costs zhai and williams 2012 investment recommendations by trustworthy sources have also been found to be relevant kastner and matthies 2016 financial incentives like feed in tariff legislation play a major positive role as well klein and deissenroth 2017 kwan 2012 while economic profitability has been shown to be at the centre of decision making processes recent research has also pointed to psychological drivers underlying theories include the theory of planned behavior by ajzen this third set of influencing factors comprises for example peer or spillover effects as predicted by the theory of social action if pv is already installed in the vicinity spillover effects have been found thus increasing the probability of further installations bollinger and gillingham 2012 rai and robinson 2013 this is partly confirmed by related research that finds spillover effects as well but not at the county zip code level only in the immediate neighbourhoods rode and weber 2016 yet other studies confirm this positive effect müller and rode 2013 environmental friendliness i e the wish to reduce one s impact on the environment has also been recognized in the literature as important rai and mcandrews 2012 zhang et al 2011 psychological factors also include the value orientation of a would be investor a strong hedonistic value orientation seems to reduce investment likelihood kastner and matthies 2016 it is also well known that people differ in their willingness to take chances their risk propensity this has been shown to affect the likelihood of investing in res as well masini and menichetti 2012 what is more it has been demonstrated that loss aversion kahneman and tversky 1979 plays a major role for investment decisions in renewables klein and deissenroth 2017 if investors know that incentives will be cut at a certain date investments cumulate just before such a date in order to reap existing benefits a fourth set of factors consists of demographic variables age ethnic background and education seem to have at least some influence on investment decisions kwan 2012 however their direction is not yet clear a fifth and last set of factors are political and social drivers this includes political measures like party affiliation strong conservative value orientation reduces likelihood of investment kastner and matthies 2016 kwan finds a positive effect on pv installations in the us for zip codes with a higher proportion of democrats kwan 2012 housing density balta ozkan et al 2015 müller and rode 2013 and level of urbanisation are other important aspects of the social environment influencing investments kwan 2012 these set of drivers represent a large collection of variables which is difficult to include in any model however the potential set of variables is wider still as shown by a review on household energy investments kastner and stern 2015 for some of these variables relatively consistent relations in the expected direction have been found these include lower investment costs and higher benefits recommendation for an investment and higher future energy prices these all foster investments on the other hand many other variables investigated did not show a consistent effect on investments this means that both negative and positive effects have been found this is true for age gender household financial resources education and pro environmental attitudes thus the research gap identified from the state of the art as described above is the lack of a comprehensive model based on a large data set using methods with a high prediction quality the aim is to arrive at a robust estimation of the relevance for a variety of drivers however a model encompassing all potential drivers mentioned above is not feasible due to data availability on the county level still the overall goal of this article is to develop a model of sufficient generality in order to understand investment decisions by including explanatory variables from various backgrounds 3 methods previous studies mostly focused on a limited set of explanatory variables the present study uses 13 variables social demographic geographic and economic ones see table 2 and the data section since the interactions between these variables may be complex non linear and are basically not known we decided to use machine learning statistical methods these have several advantages first the model structure does not have to be specified in advance thus coping with unknown interactions second the explanatory power in most cases is much higher than that of traditional methods like linear regression models this is due to their ability to cope with non linear functions our objective is to predict yearly nominal capacity addition of solar power per county in germany concerning method choice we used generalized linear models glm as a base line they serve as a benchmark to test against the other machine learning algorithms for robustness we decided to use decision trees since they are known to provide very robust results in the presence of noise i e variables that are not relevant coupled with a high explanatory power alpaydin 2010 therefore we implemented two high performing variants random forests breiman 2001 and gradient boosting friedman 2002 finally provided there is ample data the highest model quality is often reached by deep neural networks reed and marks 1999 which is the fourth method we used the implementation was done in r with the package h2o r core team 2017 the h2o ai team 2016 implementing all four methods with the same package ensures the highest possible consistency all three machine learning methods required setting some model parameters to reach optimal results searching the combinations of parameters is often time consuming since permutations of them quickly reach a vast number here the function grid of the h2o package was used to systematically perform a search of suitable hyper parameters in the case of random forests two parameters were varied in the case of gradient boosting four parameters and for deep neural networks six parameters the following table table 1 provides a short overview for a complete detailed description and explanation see the documentation of the h2o package https h2o release s3 amazonaws com h2o rel ueno 6 docs website h2o docs grid search html data was split into training 75 validation 15 and test 10 set note l1 regularization is a method constraining the absolute value of the weights and has the net effect of dropping some weights setting them to zero to avoid overfitting l2 regularization is a method constraining the sum of the squared weights it introduces bias but produces substantial gains as estimate variance is reduced early stopping was used in all model training runs as soon as the mean squared error mse did not improve by more than 0 05 on the validation set for 3 consecutive scoring events training was stopped it is important to note that the tuning described above on one validation data set did not always result in a similar consistent improvement of model results of other validation data sets this indicates that further fine tuning each model for each data set individually could improve performance 4 data the inconsistent findings mentioned above about the direction and significance of drivers make it necessary to reassess the roles of these variables with regard to robustness to ensure a driver s robustness across models we employ various measures first four different methods are used to estimate the importance of the variables used second a large data set n 1 4 million records is used third the data is augmented to arrive at a comprehensive set of factors that have previously been identified in the literature as relevant for investment decisions this addresses possible hidden interactions with variables that have not been jointly considered previously for our models 13 variables have been selected from the literature described above as potential drivers of investment in renewables the selection is based on both previous research suggesting the relevance of a variable and data availability on a fine grained level i e county a validation of the claim of a more comprehensive model is to check the explanatory power if a substantial part of the variance in a large data set can be explained then the most relevant drivers have been captured we constrain the analysis on solar installations since they are responsible for a major part of renewable investments at least in terms of single installations in our data set 97 5 of all installations of renewables the main data set used is freely available at energymap info it has been collected from the transmission system operators tso in germany cleaned and made available online to enhance transparency in the german electricity sector data collection stops in 2015 the data set consists of more than 1 5 million entries with 23 variables for each record not all of these variables are used since e g the name of the tso or dso are not considered good predictors around 70 000 entries are labelled as suspect by energymap info and are excluded in this analysis further plausibility checks did not reveal any major irregularities after checking for duplicates missing values and other obvious errors e g 60 entries were removed since they show more operating hours than hours in a year 1 489 612 entries remain of this the subset of solar installations n 1 452 977 is used for all following analyses all analyses have been conducted with r r core team 2017 each record the unit of analysis is one installation of a renewable electricity source sorted by their start of operation the list of variables can be found in the appendix the most important variables are the date of operation type of renewable installation solar wind biomass water the community and zip code the nominal capacity of the facility the eeg key which codes the feed in tariff and latitude longitude other data sets were merged with the main data based on the unique zip code and community code gemeindeschlüssel if neither zip nor community code was available latitude longitude pairs were used to ensure matching between data sets longitude and latitude had to be trimmed to a precision of two decimal places to be able to match community keys consistently with zip code a web crawler was programmed to extract both keys and codes and corresponding names from the german wikipedia the following table 2 sums up these variables data sources for all data sets are also shown the corresponding descriptive statistics are presented in table 3 the following paragraphs describe the data sets and their variables that were merged with the main data in more detail first geographic factors for example the suitability of an area for solar might be relevant one variable used is the solar radiation on the county level it is calculated from an improved data set using remote sensing data huld et al 2012 second to be able to compare investment decisions with alternative investment options the official bonds rate from the german federal bank was merged on a monthly basis thus the explanatory variable used is the bonds interest rate in percent in the month of installation third to be able to analyse the influence of political attitude the respective results of the bundestag elections 2009 and 2013 or the regional elections per federal state retrieved from regionalstatistik de were merged with the main data set on a community level basis the explanatory variables are the percentages of each party per community aggregated per county in per cent cdu csu spd green party fdp left party fourth unemployment is an important economic indicator the data unemployment rate in per cent was retrieved from the official data of the german employment agency for 2008 to 2014 from regionalstatistik de and was merged with the main data set on the community level aggregated per county another economic indicator for investment decisions are feed in tariffs einspeisevergütungen these data are taken from netztransparenz https www netztransparenz de which lists the date specific compensation for all different eeg keys the latter are also present in the main data set the merge is thus done by using the specific eeg key for each record the eeg key is also used for the npv calculation fifth the characteristics of location might influence investments in particular the dimensions urban vs rural large city vs small village and central vs peripheral location might be relevant the data set for all three dimensions is from the federal institute for research on building urban affairs and spatial development bundesinstitut für bau stadt raumforschung the centrality variable has four levels very peripheral 14 peripheral 31 central 38 and very central 6 11 are missing the urbanity variable captures the type of city and has seven levels major metropolis 0 05 metropolis 0 2 big city 1 small city 16 big town 21 small town 25 and village 26 and 11 missing the distribution of all three variables over germany is visualised as maps in the appendix two other variables used that are related to geographic location are population and population density per community aggregated per county sixth an important economic proxy is the net present value npv of an investment it is a widely used measure of overall future benefits scaled to the present monetary value in order to calculate the npv for solar installations several intermediary steps are necessary first the costs consisting in investment and operating costs and the revenues consisting of the eeg feed in tariffs are calculated for calculating the costs we first split installations by size since investment costs are getting cheaper due to scaling we derived a scaling factor γ from feldman et al 2012 which models how much more expensive pv installations get compared to an installation with reference size s 0 with specific cost c 0 per kw pv system prices also decline over time both factors have to be taken into account the formula for the investment costs c is thus c t s s s 0 γ c 0 t we use the prices and sizes of the pv pricing report eupd research 2016 the operating costs o are estimated at 1 of the investment costs which is a typical widely used estimate the assumed life period t of a system is twenty years the performance ratio pr is set at 84 reich et al 2012 a degradation d of 0 5 per year y is also taken into account reaching 10 after 20 years finally the feed in remuneration fit determines for the economic lifetime of the investment for how much the solar electricity is remunerated the formula for the income per year i for each year is thus i y irradiation pr 1 d y fit the npv is calculated from income and operating costs modified by a discount factor d of 0 02 and a bond rate b for return on quasi riskless investments government bonds n p v t c t y 1 t i y o 1 d b y the discount factor is set at 2 since the actors are not primarily interested in profit maximization we are aware that the choice of the discount factor is a sensitive parameter in economic assessments however it is set at the same value for all investors finally the total npv is divided by the total initial investment cost c in order to derive a proxy that is adjusted for size in this formulation it roughly resembles an inverse pay back period as it calculates the ratio of total earnings over initial spending n p v t n p v t c in order to determine which aggregation level is the most suitable for investment decisions two aggregations have been calculated the first aggregation is the most fine grained possible with this data set i e on the community level in germany there are roughly 11 000 communities excluding missing data leaves us with around 9000 data records however it could be that the noise of individual decisions is too high at this level therefore the data has also been aggregated at the county level i e 432 counties landkreise i e nuts3 level for the county level data all variables are averaged except the dependent variable nominal capacity which is summed up the following figure fig 1 shows the correlations between these variables at the community code level data was preprocessed before modelling all variables were normalized for any year that had fewer than 50 records the data set was not used since machine learning methods require larger data sets to train properly with less than 50 training cases no proper generalization can be expected 5 results descriptive statistics for the independent variables and the response variable used in building the models of investment decisions in solar installations are presented in table 3 the next step is to examine the explanatory power of the different models the response variable to study is the increase in nominal capacity per county a comparison between models and methods sheds light on whether models are similar in their quality whether there are large changes over the years federal states and finally which method produces the best models overall a first comparison pertains to the level of aggregation we tested both aggregation of individual household data on the community gemeindeschlüssel n 9000 and the county landkreis n 400 level the results are clear cut the mean model quality i e explaining the increase in nominal capacity measured as adjusted r2 for 5 runs with different random seeds for the starting values of 24 data sets for all of germany solar installations and all the years between 1991 and 2014 for the county landkreis level is 0 51 for glm 0 59 for random forests 0 61 for deep neural nets and 0 63 for gradient boosting in contrast it is much lower for the community level r2 of 0 47 0 47 0 49 and 0 52 respectively all further results presented are therefore aggregated on the county level a second comparison relates to the methods themselves is there a method that is consistently better in model quality than the others the following figure fig 2 shows the prediction quality over the years for all methods for the whole of germany to ensure robustness each model was run five times and the mean accuracy was calculated generalized linear models clearly have the lowest overall predictive accuracy in contrast the highest overall quality mean of 5 runs as shown in table 4 is achieved by deep neural networks and gradient boosting both 0 75 in adjusted r2 the best models overall mean are found by gradient boosting r2 0 63 just a bit better than deep neural networks r2 0 61 furthermore neural networks perform better when the weakest models are considered as indicated by the higher minimum if only the best model runs are considered without averaging across runs predictive power is even higher the adjusted r2 is 0 72 for glm 0 84 for rf 0 86 for dl and 0 87 for gbm not shown in table based on these results we analyse the importance of explanatory variables on nominal capacity per county since dl and gbm offer the highest explanatory power and rf results are very similar to gbm we show results for dl and gbm only using relative importance as percentage as measure for comparisons variable values add up to 1 making each variable contribution easily interpretable this also allows a direct comparison of variable importance depending on method choice first we present variable importance as percentage in gbm fig 3 in contrast the results of the dl models are much more balanced fig 4 6 discussion our first result is that aggregation on the county level boosts results considerably compared to modelling solar installations on the community level this might be of interest for further modelling of german renewable energies it suggests that there is too much noise in the data below the county level a second result is that prediction quality seems to stabilise after the year 1999 fig 2 one reason might be the number of complete data sets available which increases sharply after 1999 see appendix it might also be due to a change in the political regime in germany at that time and perhaps to the increasing heterogeneity of individuals investing in solar installations by then a broader public had been introduced to this investment opportunity a third more methodological result confirms deep neural networks as promising tools current research across a wide variety of topics consistently finds high model performance for nn silver et al 2017 lecun et al 2015 so do we for modelling investment in renewables on par with this performance is gradient boosting which offer as additional advantages a clear interpretation of results using less computational power a fourth result is model prediction quality that varies between years and methods in a wide range between 0 26 and 0 75 of adjusted r2 for gbm and dl up to the year 1999 poorer results may be explained with less data sets available other reasons include parameter settings in the methods themselves for example random values for the weights or split of data in training validation and test set however all these settings are randomly varied thus do not offer a ready explanation some fluctuations are certainly attributable to the random initialization of the starting values in different runs this is standard practice in machine learning software packages however in order to remediate exactly this five runs with different seeds as starting values for each model ensured robustness by taking the respective mean in adjusted r2 and importance of variables minimum and maximum values of model quality conform to the expectations across methods a fifth result estimating variable influence investment decisions in solar is perhaps most relevant for advancing research in this area in general agreement is decent while the rank for each factor differs the general importance of most factors is similar however two things immediately stand out first both dl and gbm assign population and type of urbanisation an important role second dl models are much more balanced no factor importance is below 7 or above 9 all other variables are considered similarly across methods i e ranked at most two ranks apart except for the importance of one party cdu interest rate and npv it is surprising that three variables are estimated differently in their relevance for investment decisions by both methods even though results from both gbm and dl models are somewhat comparable the differences on the same data set are not negligible however repeated runs with the same method are practically identical concerning the ranking of independent variables yet this finding points to caution in interpreting any one result obtained with just a single method which is precisely the reason we used a variety of methods in the first place therefore this measure of precaution allows pointing out both the differences and agreements in order to obtain more robust results and a higher confidence in their interpretation apart from the results shown models with different sets of independent variables were calculated for example models with latitude and longitude as independent variables show a high influence however in our estimation these variables are probably just proxies for irradiation and the higher incidence of highly populated areas in the west and south of germany compared to the north and east similarly population per county as important factor could just be an effect of the number of houses available for rooftop installations therefore we ran other models where the response variable nominal capacity was controlled for population per county i e installed capacity per capita per county results of these models without population as independent variable are significantly weaker in explaining the per capita installed capacity but keep type of urbanisation and population density as the most important variables results can be found in the appendix tables a 10 and a 11 a surprising finding is the somewhat low influence of economic indicators which could be partially explained with the separation of the data set per year since economic and other indicators neither change much within one year nor by county little can be said about their influence over longer periods of time with the type of model configuration used here a third change in model set up was to include full load hours and the maximum installable capacity per county i e including potential constraints instead of irradiation while the capacity had an impact we decided not to include both variables in the final models because both variables are heavily pre processed making it hard to isolate the respective influence of their constituents which limits reproducibility we can confirm that the amount of solar insolation received is an important factor for the number of solar installations kwan 2012 only some models confirm the impact of population on the propensity to install a pv system müller and rode 2013 bollinger and gillingham 2012 this work has some limitations most notably that there is no fine tuning of hyper parameters to each data set in addition the political variables election results are for 2009 and 2013 only which seems to be a decent proxy but may not be precise enough a final drawback for the interpretation is that the machine learning libraries allow only quantifying the significance of one factor in comparison to the other drivers via the measure of relative importance in percentage but not the direction of the influence this drawback can be mitigated by three circumstances a for most variables the direction is known from previous studies b we provide a correlational matrix fig 1 which may help to indicate the direction and c glm also provide a direction as yet another indicator see appendix table a 5 7 conclusion understanding and predicting investment decisions in renewables is a complex issue economic political social and demographic influences have been found to play a role therefore it is necessary to use the existing rich economic and social theories about the potential influence of most variables analysed from these domains in this study they are able to establish direction quantity and interactions with other variables yet to our knowledge a comprehensive theory that acknowledges drivers from all these domains is still missing kastner and stern 2015 thus a direct comparison of the study results with an underlying theory is not yet possible however in order to model variables of different domains in such a comprehensive combination methods like ml are suited best to integrate various research fields we show that such a model for germany is feasible explaining a major part of the variance adjusted r2 of as high as 0 86 achieved with dl and 0 87 with gbm the aggregation level of the data is important on a community level model quality is clearly inferior the noise ratio seems to be too high the two best machine learning algorithms agree on the importance of population and type of urbanisation estimate most other variables somewhat similarly but differ in their estimation of npv interest rate and one political party cdu due to differences in methodology dl presents a well balanced model whereas the gbm models clearly calculates one most important factor although random forests are very similar to gbm only four one rank positional switches glm models do not agree with either dl or gbm rf this disagreement forbids far reaching conclusions although the general influence of many variables is similar this finding points to caution in interpreting any result obtained with just one single machine learning method our suggestion for further research would be to carefully choose methods appropriate for a particular problem or even use two or more methods alongside each other to be able to compare differences and common ground whenever the black box character leads to problematic interpretation of machine learning results methods like gradient boosting or random forests may be the first choice their interpretation is straightforward if on the other hand a high explanatory power is of primary importance deep neural networks might be preferred in addition possible misinterpretations might be avoided if results are informed by context and grounded in theory to enable and further such interdisciplinary research more comprehensive theories are desirable in general the presented results confirm the importance of social influences for investment decisions which should be considered by future research for example by a broader application of machine learning methods current software packages e g keras h2o make them readily available and easily implementable thus a more comprehensive analysis of different domains may lead to more robust models with higher explanatory power since all mentioned domains are affected by energy transitions the suggested new models may support efforts towards a more sustainable energy system in line with the paris agreements from 2016 acknowledgment we would like to thank the federal ministry of education and research bmbf for support project enavi grant number 03sfk4d1 appendix for modelling complex investment decisions for renewables with different machine learning algorithms table a 1 variables in the main data set from energymap info table a 1 number variable name 1 inbetriebnahme 2 geodbid 3 postleitzahl 4 ort 5 strasse 6 anlagenschluessel 7 anlagentyp 8 anlagenuntertyp 9 nennleistung kwp el 10 einspeisespannungsebene 11 dso eic 12 dso 13 tso eic 14 tso 15 kwh 2013 16 kwh average 17 kwh kw 18 eeg verguetungsschluessel 19 gemeindeschluessel 20 gps lat 21 gps lon 22 gps genauigkeit dm 23 validierung table a 2 sources of data merged with main data set table a 2 variable source url name name of data set bonds rate german federal bank url 1 yields on debt securities outstanding issued by residents bbk01 wt0115 election results regionalstatistik de url 2 wahlberechtigte und beteiligung gültige zweitstimmen nach parteien gemeindeebene 14111 01 03 5 unemployment regionalstatistik de url 3 arbeitslose nach ausgewählten personengruppen jahresdurchschnitt gemeindeebene 13211 01 03 5 eeg compensation netztransparenz url 4 verguetungs und umlagekategorien eeg verguetungs kategorien eeg 2014 20140813 population area in km2 type of community size rural bundesinstitut für bau stadt raumforschung url 5 raumabgrenzungen stadt gemeindetyp ref sgtyp urban rural central periphery bundesinstitut für bau stadt raumforschung url 6 raumabgrenzungen raumtypen raumtypen note full urls are given below url 1 https www bundesbank de navigation en statistics money and capital markets interest rates and yields tables table zeitreihenliste html id 71408 url 2 https www regionalstatistik de genesis online data jsessionid 8b869893fd8abfcaee57fe8418e4a845 reg1 operation abruftabelleabrufen selectionname 14111 01 03 5 levelindex 1 levelid 1519897103439 index 2 url 3 https www regionalstatistik de genesis online data jsessionid 8b869893fd8abfcaee57fe8418e4a845 reg1 operation abruftabelleabrufen selectionname 13211 01 03 5 levelindex 1 levelid 1519897058349 index 2 url 4 https www netztransparenz de eeg verguetungs und umlagekategorien url 5 https www bbsr bund de bbsr de raumbeobachtung raumabgrenzungen stadtgemeindetyp downloadangebote html jsessionid 691fcb8fb9761f10658924970f40b4dd live11293 nn 443182 url 6 http www bbsr bund de bbsr de raumbeobachtung raumabgrenzungen raumtypen2010 vbg downlaods refkarten html nn 443270 table a 3 model quality for yearly models for all four methods single best run table a 3 data set glm r2 rf r2 dl r2 gbm r2 row means de 1991 solar 0 30 0 60 0 16 0 52 0 40 de 1992 solar 0 37 0 66 0 53 0 59 0 54 de 1993 solar 0 29 0 61 0 11 0 53 0 39 de 1994 solar 0 67 0 59 0 68 0 69 0 66 de 1995 solar 0 46 0 67 0 69 0 73 0 64 de 1996 solar 0 56 0 47 0 62 0 49 0 53 de 1997 solar 0 54 0 66 0 86 0 71 0 69 de 1998 solar 0 51 0 64 0 60 0 73 0 62 de 1999 solar 0 57 0 55 0 63 0 69 0 61 de 2000 solar 0 55 0 65 0 68 0 67 0 64 de 2001 solar 0 53 0 72 0 74 0 76 0 69 de 2002 solar 0 52 0 61 0 68 0 64 0 61 de 2003 solar 0 53 0 63 0 40 0 70 0 56 de 2004 solar 0 50 0 60 0 59 0 65 0 59 de 2005 solar 0 58 0 71 0 56 0 69 0 63 de 2006 solar 0 58 0 72 0 70 0 69 0 67 de 2007 solar 0 68 0 84 0 83 0 87 0 80 de 2008 solar 0 58 0 73 0 78 0 80 0 72 de 2009 solar 0 56 0 64 0 69 0 74 0 66 de 2010 solar 0 55 0 55 0 71 0 56 0 59 de 2011 solar 0 47 0 67 0 64 0 63 0 60 de 2012 solar 0 48 0 69 0 74 0 66 0 64 de 2013 solar 0 57 0 67 0 74 0 74 0 68 de 2014 solar 0 67 0 71 0 73 0 76 0 72 min all years per model 0 29 0 47 0 11 0 49 0 34 max all years per model 0 68 0 84 0 86 0 87 0 81 mean all years per model 0 53 0 65 0 63 0 68 0 62 description of methods all data sets were split randomly by the h2o splitframe command in the h2o package in training 75 validation 15 and test set 10 the grid search determined the best parameters for the neural network architecture for the range that was considered see table 2 in the main article the parameters used for training were epochs 65 hidden layer 33 51 20 for the random forests the parameter choice was number of trees 3500 number of variables randomly sampled as candidates at each split 6 for the gradient boosting machines2 the parameters were number of trees 1350 maximum depth of a tree 35 if model quality measured in mean squared error mse does not improve for 0 005 for three consecutive rounds this is taken as an indication that model quality cannot be improved on the training set in order to avoid overfitting model runs are stopped at this point table a 4 number of cases for the training and testing for each year and for germany at the county level table a 4 year number of complete data sets used for training and testing at the county level 1991 77 1992 181 1993 194 1994 167 1995 134 1996 189 1997 201 1998 215 1999 289 2000 389 2001 411 2002 408 2003 405 2004 412 2005 414 2006 414 2007 413 2008 414 2009 414 2010 414 2011 414 2012 415 2013 415 2014 413 fig f 1 type of community source bbsr fig f 1 fig f 2 central peripheral source bbsr fig f 2 table a 5 direction of variable influence in generalized linear models per year for germany table a 5 all direction population per lk pos population density per lk neg fdp in per lk none irradiation per lk pos green party in per lk neg central periphery per lk pos type of urbanisation per lk pos mostly at most 1 model with contrary sign unemployment rate per lk neg interest rate none mixed cdu in per lk neg linke in per lk neg npv per size per lk none spd per lk neg note only if all 24 years had the same sign direction this variable shows up in the all section table a 6 mean variable importance five runs for germany per year aggregated for glm table a 6 variable mean coefficients fdp in per lk 11 22 interest rate per lk 10 92 npv per size per investment cost per lk 10 63 spd in per lk 9 40 cdu in per lk 9 14 unemployment rate per lk 8 70 left party in per lk 8 22 population density per lk 7 10 green party in per lk 5 33 irradiation per lk 3 22 type of urbanisation per lk 3 07 central periphery per lk 3 04 population per lk 1 02 table a 7 mean variable importance five runs for germany per year aggregated for rf table a 7 variable mean relative importance population per lk 0 285 population density per lk 0 148 cdu in per lk 0 114 type of urbanisation per lk 0 107 unemployment rate per lk 0 069 irradiation per lk 0 053 central periphery per lk 0 047 left party in per lk 0 038 spd in per lk 0 035 green party in per lk 0 031 npv per size per investment cost per lk 0 027 fdp in per lk 0 026 interest rate per lk 0 019 table a 8 mean variable importance five runs for germany per year aggregated for dl table a 8 variable mean relative importance type of urbanisation per lk 0 083 population per lk 0 082 npv per size per investment cost per lk 0 080 population density per lk 0 079 interest rate per lk 0 077 irradiation per lk 0 076 unemployment rate per lk 0 076 central periphery per lk 0 075 spd in per lk 0 075 fdp in per lk 0 075 left party in per lk 0 075 green party in per lk 0 074 cdu in per lk 0 072 table a 9 mean variable importance five runs for germany per year aggregated for gbm table a 9 variable mean relative importance population per lk 0 370 population density per lk 0 178 type of urbanisation per lk 0 093 cdu in per lk 0 091 irradiation per lk 0 086 unemployment rate per lk 0 039 central periphery per lk 0 036 spd in per lk 0 031 left party in per lk 0 025 green party in per lk 0 020 fdp in per lk 0 014 npv per size per investment cost per lk 0 011 interest rate per lk 0 006 model runs with response variable controlled for population i e nominal capacity per county per capita table a 10 mean adjusted r2 across five runs for minimum maximum and mean respectively table a 10 dataset glm r2 rf r2 dl r2 gbm r2 min all years per model 2 48 2 74 3 23 1 10 max all years per model 0 44 0 68 0 45 0 73 mean all years per model 0 00 0 14 0 07 0 30 table a 11 mean relative importance in of five gradient boosting model runs response variable nominal capacity per county per capita table a 11 variable name relative importance in type of urbanisation per lk 0 40 population density per lk 0 28 unemployment rate per lk 0 06 interest rate 0 04 left party in per lk 0 04 cdu in per lk 0 03 sonstige per lk 0 03 spd in per lk 0 03 irradiation per lk 0 02 central periphery per lk 0 02 green party in per lk 0 02 fdp in per lk 0 01 npv per size per investment cost per lk 0 01 
26196,investment decisions in renewable energies are known to be influenced by many diverse drivers e g social political geographic economic and psychological non comprehensive models are problematic since missed interactions might introduce bias we implement a robust modelling approach by 1 using a large data set with 1 4 million solar installations and 2 three different machine learning algorithms deep neural networks gradient boosting random forests generalized linear models serve as baseline and comparison a high prediction accuracy can be achieved on the county level with deep neural networks adjusted r2 0 86 and gradient boosting adjusted r2 0 87 the most important drivers are population per county followed by type of urbanisation and social variables like unemployment with varying degree of importance for the different machine learning algorithms our approach points out both differences and agreements across methods and therefore a higher confidence in their interpretation keywords investment decisions solar installation renewable energy deep learning machine learning germany 1 introduction on our way to reduce carbon emissions improvements in many different areas are necessary in some areas e g electromobility progress is very slow www eafo eu while increasing the share of electricity from renewables is well underway williams et al 2012 haegel et al 2017 in order to achieve the paris agreement to keep the average global temperature below 2 c an almost completely decarbonised electricity sector is needed by 2050 irena 2018 since it is responsible for about 25 of all energy related co2 emissions ipcc 2014 however large differences between countries remain both in the private and the public sector while in some countries large investments in solar and wind have been made china japan germany other countries and other technologies lag behind ren21 2017 solar pv is a cornerstone for achieving the paris agreement since it reduces the need for fossil fuel based power plants in germany for example the installed pv capacity reached 40 gw in 2016 with an electricity generation of 38 gwh this implies a net mitigation of greenhouse gas emissions of more than 23 000 tons in that year from pv generated electricity alone memmler et al 2017 hence private investments in solar installations on roof tops are a central part of the future electricity mix and make up a substantial part of reducing co2 emissions breyer et al 2017 it is remarkable that there is uncertainty about the factors that drive the decision making process behind such private investments kastner and stern 2015 although it seems clear that a variety of factors influence investments in renewables romano and fumagalli 2018 kwan 2012 wüstenhagen and menichetti 2012 both endogenous e g individual risk aversity and exogenous e g interest rates to the decision making process no clear picture has emerged yet a review study as recent as 2015 concludes that much research still needs to be done to understand energy relevant investment decisions of households we could identify only 26 empirical studies looking across many countries several decades and several scientific disciplines kastner and stern 2015 p 84 p 84 therefore the present study aims to develop a more comprehensive model with potential factors from various backgrounds including social economic and geographic drivers in contrast to surveys e g kastner and matthies 2016 that suffer from their hypothetical nature we use an existing data set of real investments in photovoltaics pv in germany from 1991 to 2014 these 1 4 million investment decisions are merged with other data sets with information on employment rural urban characteristics election results etc 2 state of the art 2 1 existing problems in modelling investments in renewables many studies agree that investment decisions are complex and influenced by many drivers although many of these factors have been identified in previous studies no clear picture has yet emerged on the one hand this is due to the fact that drivers come from different backgrounds social political geographic economic and psychological factors are known to influence investment decisions in renewables kastner and stern 2015 on the other hand this is due to a lack of large data sets rich enough to encompass more than a handful of drivers known to influence investment decisions one major step forward of this article is to create such a large data set which includes almost all pv installations in one country on a local scale with factors from various domains therefore it does not come as surprise that many studies do not include most drivers in their surveys and models this is understandable but problematic since missed interactions between drivers that are not part of the model might introduce considerable bias the choice of methods also introduces problems most studies tend to emphasize certain variables often the method choice reflects this and the respective disciplinary background if for example geographic factors are considered the most relevant models will most likely include spatial components bollinger and gillingham 2012 rode and weber 2016 if psychological factors are considered important modelling will follow psychological theories ajzen and fishbein 2005 korcaj et al 2015 and so on in conclusion the variety of methods used in previous studies is quite large and sometimes reflects the various disciplinary backgrounds since the number of potential drivers is quite large complexity is an issue as well per se a large number of drivers would not be a problem more factors could be added over time to ever more complex models in order to achieve satisfactory explanatory power however most drivers identified do not consistently point in one direction on the contrary a review paper finds conflicting evidence for almost all drivers e g for age the most frequently analyzed demographic variables concerned the decision makers age or retirement status n 30 in 18 of these cases an association was found these associations were positive in six cases negative in ten cases and curvilinear in two cases with amid level age positively associated with an investment decision kastner and stern 2015 this may be due to less comprehensive models as pointed out above or due to the use of different methodologies a fourth problem is that not too many large and rich data sets exist which are both highly detailed in time and space while not lacking in social economic and other dimensions one solution for this problem by some existing studies is the augmentation i e the enrichment of large data sets e g solar installations with economic data see klein and deissenroth 2017 however data augmentation is relatively rare in the literature this paper also enriches existing data sets in this way in order to address these problems we take a different modelling approach concerning the problem method choice according to background we instead use machine learning algorithms which do not presuppose any model structure this allows implementing a data driven approach concerning the problem of conflicting direction of potential drivers we use a large data set with 1 4 million installations in order to increase the robustness of findings a large data set also helps to mitigate the problem of spurious correlations the second problem hidden interactions i e interactions between variables that are not part of a model that nevertheless influence variables that are present in a particular model is addressed through the comprehensive set of drivers from various backgrounds modelling is performed with four different methods deep neural networks gradient boosting random forests and generalized linear models in order to check whether direction and strength of independent variables are dependent on method choice 2 2 drivers for investment decisions in previous research the following section discusses the identified drivers for investment decisions from previous studies for a meta analysis see kastner and stern 2015 for a summary of motivations and barriers see balta ozkan et al 2015 for an application of abm modelling to investment decisions see rai and robinson 2015 identified drivers are from the geographic economic psychological demographic political and social domain identification is data driven i e drivers are included that have been empirically found to be relevant in previous analyses these studies are in turn based on different theories in their respective fields which are shortly discussed below for each section of drivers geographic factors are among the most prominent a higher solar insolation irradiation is not surprisingly positively correlated with the adoption of residential solar pv kwan 2012 this is supported by studies in the uk balta ozkan et al 2015 who find only small effects however a study from japanese prefectures does not find any effect zhang et al 2011 since the amount of irradiation directly affects the profitability this geographic factor influences economic considerations as well a second set of factors are economic variables that have been shown to be relevant for profitability considerations include the cost of electricity the household income and the home value kwan 2012 kastner and matthies 2016 installation costs seem to be a major factor too zhang et al 2011 however installation costs decrease with more installations so there is a reinforcing feedback loop here most notably residents take long term benefits into account i e lower electricity costs zhai and williams 2012 investment recommendations by trustworthy sources have also been found to be relevant kastner and matthies 2016 financial incentives like feed in tariff legislation play a major positive role as well klein and deissenroth 2017 kwan 2012 while economic profitability has been shown to be at the centre of decision making processes recent research has also pointed to psychological drivers underlying theories include the theory of planned behavior by ajzen this third set of influencing factors comprises for example peer or spillover effects as predicted by the theory of social action if pv is already installed in the vicinity spillover effects have been found thus increasing the probability of further installations bollinger and gillingham 2012 rai and robinson 2013 this is partly confirmed by related research that finds spillover effects as well but not at the county zip code level only in the immediate neighbourhoods rode and weber 2016 yet other studies confirm this positive effect müller and rode 2013 environmental friendliness i e the wish to reduce one s impact on the environment has also been recognized in the literature as important rai and mcandrews 2012 zhang et al 2011 psychological factors also include the value orientation of a would be investor a strong hedonistic value orientation seems to reduce investment likelihood kastner and matthies 2016 it is also well known that people differ in their willingness to take chances their risk propensity this has been shown to affect the likelihood of investing in res as well masini and menichetti 2012 what is more it has been demonstrated that loss aversion kahneman and tversky 1979 plays a major role for investment decisions in renewables klein and deissenroth 2017 if investors know that incentives will be cut at a certain date investments cumulate just before such a date in order to reap existing benefits a fourth set of factors consists of demographic variables age ethnic background and education seem to have at least some influence on investment decisions kwan 2012 however their direction is not yet clear a fifth and last set of factors are political and social drivers this includes political measures like party affiliation strong conservative value orientation reduces likelihood of investment kastner and matthies 2016 kwan finds a positive effect on pv installations in the us for zip codes with a higher proportion of democrats kwan 2012 housing density balta ozkan et al 2015 müller and rode 2013 and level of urbanisation are other important aspects of the social environment influencing investments kwan 2012 these set of drivers represent a large collection of variables which is difficult to include in any model however the potential set of variables is wider still as shown by a review on household energy investments kastner and stern 2015 for some of these variables relatively consistent relations in the expected direction have been found these include lower investment costs and higher benefits recommendation for an investment and higher future energy prices these all foster investments on the other hand many other variables investigated did not show a consistent effect on investments this means that both negative and positive effects have been found this is true for age gender household financial resources education and pro environmental attitudes thus the research gap identified from the state of the art as described above is the lack of a comprehensive model based on a large data set using methods with a high prediction quality the aim is to arrive at a robust estimation of the relevance for a variety of drivers however a model encompassing all potential drivers mentioned above is not feasible due to data availability on the county level still the overall goal of this article is to develop a model of sufficient generality in order to understand investment decisions by including explanatory variables from various backgrounds 3 methods previous studies mostly focused on a limited set of explanatory variables the present study uses 13 variables social demographic geographic and economic ones see table 2 and the data section since the interactions between these variables may be complex non linear and are basically not known we decided to use machine learning statistical methods these have several advantages first the model structure does not have to be specified in advance thus coping with unknown interactions second the explanatory power in most cases is much higher than that of traditional methods like linear regression models this is due to their ability to cope with non linear functions our objective is to predict yearly nominal capacity addition of solar power per county in germany concerning method choice we used generalized linear models glm as a base line they serve as a benchmark to test against the other machine learning algorithms for robustness we decided to use decision trees since they are known to provide very robust results in the presence of noise i e variables that are not relevant coupled with a high explanatory power alpaydin 2010 therefore we implemented two high performing variants random forests breiman 2001 and gradient boosting friedman 2002 finally provided there is ample data the highest model quality is often reached by deep neural networks reed and marks 1999 which is the fourth method we used the implementation was done in r with the package h2o r core team 2017 the h2o ai team 2016 implementing all four methods with the same package ensures the highest possible consistency all three machine learning methods required setting some model parameters to reach optimal results searching the combinations of parameters is often time consuming since permutations of them quickly reach a vast number here the function grid of the h2o package was used to systematically perform a search of suitable hyper parameters in the case of random forests two parameters were varied in the case of gradient boosting four parameters and for deep neural networks six parameters the following table table 1 provides a short overview for a complete detailed description and explanation see the documentation of the h2o package https h2o release s3 amazonaws com h2o rel ueno 6 docs website h2o docs grid search html data was split into training 75 validation 15 and test 10 set note l1 regularization is a method constraining the absolute value of the weights and has the net effect of dropping some weights setting them to zero to avoid overfitting l2 regularization is a method constraining the sum of the squared weights it introduces bias but produces substantial gains as estimate variance is reduced early stopping was used in all model training runs as soon as the mean squared error mse did not improve by more than 0 05 on the validation set for 3 consecutive scoring events training was stopped it is important to note that the tuning described above on one validation data set did not always result in a similar consistent improvement of model results of other validation data sets this indicates that further fine tuning each model for each data set individually could improve performance 4 data the inconsistent findings mentioned above about the direction and significance of drivers make it necessary to reassess the roles of these variables with regard to robustness to ensure a driver s robustness across models we employ various measures first four different methods are used to estimate the importance of the variables used second a large data set n 1 4 million records is used third the data is augmented to arrive at a comprehensive set of factors that have previously been identified in the literature as relevant for investment decisions this addresses possible hidden interactions with variables that have not been jointly considered previously for our models 13 variables have been selected from the literature described above as potential drivers of investment in renewables the selection is based on both previous research suggesting the relevance of a variable and data availability on a fine grained level i e county a validation of the claim of a more comprehensive model is to check the explanatory power if a substantial part of the variance in a large data set can be explained then the most relevant drivers have been captured we constrain the analysis on solar installations since they are responsible for a major part of renewable investments at least in terms of single installations in our data set 97 5 of all installations of renewables the main data set used is freely available at energymap info it has been collected from the transmission system operators tso in germany cleaned and made available online to enhance transparency in the german electricity sector data collection stops in 2015 the data set consists of more than 1 5 million entries with 23 variables for each record not all of these variables are used since e g the name of the tso or dso are not considered good predictors around 70 000 entries are labelled as suspect by energymap info and are excluded in this analysis further plausibility checks did not reveal any major irregularities after checking for duplicates missing values and other obvious errors e g 60 entries were removed since they show more operating hours than hours in a year 1 489 612 entries remain of this the subset of solar installations n 1 452 977 is used for all following analyses all analyses have been conducted with r r core team 2017 each record the unit of analysis is one installation of a renewable electricity source sorted by their start of operation the list of variables can be found in the appendix the most important variables are the date of operation type of renewable installation solar wind biomass water the community and zip code the nominal capacity of the facility the eeg key which codes the feed in tariff and latitude longitude other data sets were merged with the main data based on the unique zip code and community code gemeindeschlüssel if neither zip nor community code was available latitude longitude pairs were used to ensure matching between data sets longitude and latitude had to be trimmed to a precision of two decimal places to be able to match community keys consistently with zip code a web crawler was programmed to extract both keys and codes and corresponding names from the german wikipedia the following table 2 sums up these variables data sources for all data sets are also shown the corresponding descriptive statistics are presented in table 3 the following paragraphs describe the data sets and their variables that were merged with the main data in more detail first geographic factors for example the suitability of an area for solar might be relevant one variable used is the solar radiation on the county level it is calculated from an improved data set using remote sensing data huld et al 2012 second to be able to compare investment decisions with alternative investment options the official bonds rate from the german federal bank was merged on a monthly basis thus the explanatory variable used is the bonds interest rate in percent in the month of installation third to be able to analyse the influence of political attitude the respective results of the bundestag elections 2009 and 2013 or the regional elections per federal state retrieved from regionalstatistik de were merged with the main data set on a community level basis the explanatory variables are the percentages of each party per community aggregated per county in per cent cdu csu spd green party fdp left party fourth unemployment is an important economic indicator the data unemployment rate in per cent was retrieved from the official data of the german employment agency for 2008 to 2014 from regionalstatistik de and was merged with the main data set on the community level aggregated per county another economic indicator for investment decisions are feed in tariffs einspeisevergütungen these data are taken from netztransparenz https www netztransparenz de which lists the date specific compensation for all different eeg keys the latter are also present in the main data set the merge is thus done by using the specific eeg key for each record the eeg key is also used for the npv calculation fifth the characteristics of location might influence investments in particular the dimensions urban vs rural large city vs small village and central vs peripheral location might be relevant the data set for all three dimensions is from the federal institute for research on building urban affairs and spatial development bundesinstitut für bau stadt raumforschung the centrality variable has four levels very peripheral 14 peripheral 31 central 38 and very central 6 11 are missing the urbanity variable captures the type of city and has seven levels major metropolis 0 05 metropolis 0 2 big city 1 small city 16 big town 21 small town 25 and village 26 and 11 missing the distribution of all three variables over germany is visualised as maps in the appendix two other variables used that are related to geographic location are population and population density per community aggregated per county sixth an important economic proxy is the net present value npv of an investment it is a widely used measure of overall future benefits scaled to the present monetary value in order to calculate the npv for solar installations several intermediary steps are necessary first the costs consisting in investment and operating costs and the revenues consisting of the eeg feed in tariffs are calculated for calculating the costs we first split installations by size since investment costs are getting cheaper due to scaling we derived a scaling factor γ from feldman et al 2012 which models how much more expensive pv installations get compared to an installation with reference size s 0 with specific cost c 0 per kw pv system prices also decline over time both factors have to be taken into account the formula for the investment costs c is thus c t s s s 0 γ c 0 t we use the prices and sizes of the pv pricing report eupd research 2016 the operating costs o are estimated at 1 of the investment costs which is a typical widely used estimate the assumed life period t of a system is twenty years the performance ratio pr is set at 84 reich et al 2012 a degradation d of 0 5 per year y is also taken into account reaching 10 after 20 years finally the feed in remuneration fit determines for the economic lifetime of the investment for how much the solar electricity is remunerated the formula for the income per year i for each year is thus i y irradiation pr 1 d y fit the npv is calculated from income and operating costs modified by a discount factor d of 0 02 and a bond rate b for return on quasi riskless investments government bonds n p v t c t y 1 t i y o 1 d b y the discount factor is set at 2 since the actors are not primarily interested in profit maximization we are aware that the choice of the discount factor is a sensitive parameter in economic assessments however it is set at the same value for all investors finally the total npv is divided by the total initial investment cost c in order to derive a proxy that is adjusted for size in this formulation it roughly resembles an inverse pay back period as it calculates the ratio of total earnings over initial spending n p v t n p v t c in order to determine which aggregation level is the most suitable for investment decisions two aggregations have been calculated the first aggregation is the most fine grained possible with this data set i e on the community level in germany there are roughly 11 000 communities excluding missing data leaves us with around 9000 data records however it could be that the noise of individual decisions is too high at this level therefore the data has also been aggregated at the county level i e 432 counties landkreise i e nuts3 level for the county level data all variables are averaged except the dependent variable nominal capacity which is summed up the following figure fig 1 shows the correlations between these variables at the community code level data was preprocessed before modelling all variables were normalized for any year that had fewer than 50 records the data set was not used since machine learning methods require larger data sets to train properly with less than 50 training cases no proper generalization can be expected 5 results descriptive statistics for the independent variables and the response variable used in building the models of investment decisions in solar installations are presented in table 3 the next step is to examine the explanatory power of the different models the response variable to study is the increase in nominal capacity per county a comparison between models and methods sheds light on whether models are similar in their quality whether there are large changes over the years federal states and finally which method produces the best models overall a first comparison pertains to the level of aggregation we tested both aggregation of individual household data on the community gemeindeschlüssel n 9000 and the county landkreis n 400 level the results are clear cut the mean model quality i e explaining the increase in nominal capacity measured as adjusted r2 for 5 runs with different random seeds for the starting values of 24 data sets for all of germany solar installations and all the years between 1991 and 2014 for the county landkreis level is 0 51 for glm 0 59 for random forests 0 61 for deep neural nets and 0 63 for gradient boosting in contrast it is much lower for the community level r2 of 0 47 0 47 0 49 and 0 52 respectively all further results presented are therefore aggregated on the county level a second comparison relates to the methods themselves is there a method that is consistently better in model quality than the others the following figure fig 2 shows the prediction quality over the years for all methods for the whole of germany to ensure robustness each model was run five times and the mean accuracy was calculated generalized linear models clearly have the lowest overall predictive accuracy in contrast the highest overall quality mean of 5 runs as shown in table 4 is achieved by deep neural networks and gradient boosting both 0 75 in adjusted r2 the best models overall mean are found by gradient boosting r2 0 63 just a bit better than deep neural networks r2 0 61 furthermore neural networks perform better when the weakest models are considered as indicated by the higher minimum if only the best model runs are considered without averaging across runs predictive power is even higher the adjusted r2 is 0 72 for glm 0 84 for rf 0 86 for dl and 0 87 for gbm not shown in table based on these results we analyse the importance of explanatory variables on nominal capacity per county since dl and gbm offer the highest explanatory power and rf results are very similar to gbm we show results for dl and gbm only using relative importance as percentage as measure for comparisons variable values add up to 1 making each variable contribution easily interpretable this also allows a direct comparison of variable importance depending on method choice first we present variable importance as percentage in gbm fig 3 in contrast the results of the dl models are much more balanced fig 4 6 discussion our first result is that aggregation on the county level boosts results considerably compared to modelling solar installations on the community level this might be of interest for further modelling of german renewable energies it suggests that there is too much noise in the data below the county level a second result is that prediction quality seems to stabilise after the year 1999 fig 2 one reason might be the number of complete data sets available which increases sharply after 1999 see appendix it might also be due to a change in the political regime in germany at that time and perhaps to the increasing heterogeneity of individuals investing in solar installations by then a broader public had been introduced to this investment opportunity a third more methodological result confirms deep neural networks as promising tools current research across a wide variety of topics consistently finds high model performance for nn silver et al 2017 lecun et al 2015 so do we for modelling investment in renewables on par with this performance is gradient boosting which offer as additional advantages a clear interpretation of results using less computational power a fourth result is model prediction quality that varies between years and methods in a wide range between 0 26 and 0 75 of adjusted r2 for gbm and dl up to the year 1999 poorer results may be explained with less data sets available other reasons include parameter settings in the methods themselves for example random values for the weights or split of data in training validation and test set however all these settings are randomly varied thus do not offer a ready explanation some fluctuations are certainly attributable to the random initialization of the starting values in different runs this is standard practice in machine learning software packages however in order to remediate exactly this five runs with different seeds as starting values for each model ensured robustness by taking the respective mean in adjusted r2 and importance of variables minimum and maximum values of model quality conform to the expectations across methods a fifth result estimating variable influence investment decisions in solar is perhaps most relevant for advancing research in this area in general agreement is decent while the rank for each factor differs the general importance of most factors is similar however two things immediately stand out first both dl and gbm assign population and type of urbanisation an important role second dl models are much more balanced no factor importance is below 7 or above 9 all other variables are considered similarly across methods i e ranked at most two ranks apart except for the importance of one party cdu interest rate and npv it is surprising that three variables are estimated differently in their relevance for investment decisions by both methods even though results from both gbm and dl models are somewhat comparable the differences on the same data set are not negligible however repeated runs with the same method are practically identical concerning the ranking of independent variables yet this finding points to caution in interpreting any one result obtained with just a single method which is precisely the reason we used a variety of methods in the first place therefore this measure of precaution allows pointing out both the differences and agreements in order to obtain more robust results and a higher confidence in their interpretation apart from the results shown models with different sets of independent variables were calculated for example models with latitude and longitude as independent variables show a high influence however in our estimation these variables are probably just proxies for irradiation and the higher incidence of highly populated areas in the west and south of germany compared to the north and east similarly population per county as important factor could just be an effect of the number of houses available for rooftop installations therefore we ran other models where the response variable nominal capacity was controlled for population per county i e installed capacity per capita per county results of these models without population as independent variable are significantly weaker in explaining the per capita installed capacity but keep type of urbanisation and population density as the most important variables results can be found in the appendix tables a 10 and a 11 a surprising finding is the somewhat low influence of economic indicators which could be partially explained with the separation of the data set per year since economic and other indicators neither change much within one year nor by county little can be said about their influence over longer periods of time with the type of model configuration used here a third change in model set up was to include full load hours and the maximum installable capacity per county i e including potential constraints instead of irradiation while the capacity had an impact we decided not to include both variables in the final models because both variables are heavily pre processed making it hard to isolate the respective influence of their constituents which limits reproducibility we can confirm that the amount of solar insolation received is an important factor for the number of solar installations kwan 2012 only some models confirm the impact of population on the propensity to install a pv system müller and rode 2013 bollinger and gillingham 2012 this work has some limitations most notably that there is no fine tuning of hyper parameters to each data set in addition the political variables election results are for 2009 and 2013 only which seems to be a decent proxy but may not be precise enough a final drawback for the interpretation is that the machine learning libraries allow only quantifying the significance of one factor in comparison to the other drivers via the measure of relative importance in percentage but not the direction of the influence this drawback can be mitigated by three circumstances a for most variables the direction is known from previous studies b we provide a correlational matrix fig 1 which may help to indicate the direction and c glm also provide a direction as yet another indicator see appendix table a 5 7 conclusion understanding and predicting investment decisions in renewables is a complex issue economic political social and demographic influences have been found to play a role therefore it is necessary to use the existing rich economic and social theories about the potential influence of most variables analysed from these domains in this study they are able to establish direction quantity and interactions with other variables yet to our knowledge a comprehensive theory that acknowledges drivers from all these domains is still missing kastner and stern 2015 thus a direct comparison of the study results with an underlying theory is not yet possible however in order to model variables of different domains in such a comprehensive combination methods like ml are suited best to integrate various research fields we show that such a model for germany is feasible explaining a major part of the variance adjusted r2 of as high as 0 86 achieved with dl and 0 87 with gbm the aggregation level of the data is important on a community level model quality is clearly inferior the noise ratio seems to be too high the two best machine learning algorithms agree on the importance of population and type of urbanisation estimate most other variables somewhat similarly but differ in their estimation of npv interest rate and one political party cdu due to differences in methodology dl presents a well balanced model whereas the gbm models clearly calculates one most important factor although random forests are very similar to gbm only four one rank positional switches glm models do not agree with either dl or gbm rf this disagreement forbids far reaching conclusions although the general influence of many variables is similar this finding points to caution in interpreting any result obtained with just one single machine learning method our suggestion for further research would be to carefully choose methods appropriate for a particular problem or even use two or more methods alongside each other to be able to compare differences and common ground whenever the black box character leads to problematic interpretation of machine learning results methods like gradient boosting or random forests may be the first choice their interpretation is straightforward if on the other hand a high explanatory power is of primary importance deep neural networks might be preferred in addition possible misinterpretations might be avoided if results are informed by context and grounded in theory to enable and further such interdisciplinary research more comprehensive theories are desirable in general the presented results confirm the importance of social influences for investment decisions which should be considered by future research for example by a broader application of machine learning methods current software packages e g keras h2o make them readily available and easily implementable thus a more comprehensive analysis of different domains may lead to more robust models with higher explanatory power since all mentioned domains are affected by energy transitions the suggested new models may support efforts towards a more sustainable energy system in line with the paris agreements from 2016 acknowledgment we would like to thank the federal ministry of education and research bmbf for support project enavi grant number 03sfk4d1 appendix for modelling complex investment decisions for renewables with different machine learning algorithms table a 1 variables in the main data set from energymap info table a 1 number variable name 1 inbetriebnahme 2 geodbid 3 postleitzahl 4 ort 5 strasse 6 anlagenschluessel 7 anlagentyp 8 anlagenuntertyp 9 nennleistung kwp el 10 einspeisespannungsebene 11 dso eic 12 dso 13 tso eic 14 tso 15 kwh 2013 16 kwh average 17 kwh kw 18 eeg verguetungsschluessel 19 gemeindeschluessel 20 gps lat 21 gps lon 22 gps genauigkeit dm 23 validierung table a 2 sources of data merged with main data set table a 2 variable source url name name of data set bonds rate german federal bank url 1 yields on debt securities outstanding issued by residents bbk01 wt0115 election results regionalstatistik de url 2 wahlberechtigte und beteiligung gültige zweitstimmen nach parteien gemeindeebene 14111 01 03 5 unemployment regionalstatistik de url 3 arbeitslose nach ausgewählten personengruppen jahresdurchschnitt gemeindeebene 13211 01 03 5 eeg compensation netztransparenz url 4 verguetungs und umlagekategorien eeg verguetungs kategorien eeg 2014 20140813 population area in km2 type of community size rural bundesinstitut für bau stadt raumforschung url 5 raumabgrenzungen stadt gemeindetyp ref sgtyp urban rural central periphery bundesinstitut für bau stadt raumforschung url 6 raumabgrenzungen raumtypen raumtypen note full urls are given below url 1 https www bundesbank de navigation en statistics money and capital markets interest rates and yields tables table zeitreihenliste html id 71408 url 2 https www regionalstatistik de genesis online data jsessionid 8b869893fd8abfcaee57fe8418e4a845 reg1 operation abruftabelleabrufen selectionname 14111 01 03 5 levelindex 1 levelid 1519897103439 index 2 url 3 https www regionalstatistik de genesis online data jsessionid 8b869893fd8abfcaee57fe8418e4a845 reg1 operation abruftabelleabrufen selectionname 13211 01 03 5 levelindex 1 levelid 1519897058349 index 2 url 4 https www netztransparenz de eeg verguetungs und umlagekategorien url 5 https www bbsr bund de bbsr de raumbeobachtung raumabgrenzungen stadtgemeindetyp downloadangebote html jsessionid 691fcb8fb9761f10658924970f40b4dd live11293 nn 443182 url 6 http www bbsr bund de bbsr de raumbeobachtung raumabgrenzungen raumtypen2010 vbg downlaods refkarten html nn 443270 table a 3 model quality for yearly models for all four methods single best run table a 3 data set glm r2 rf r2 dl r2 gbm r2 row means de 1991 solar 0 30 0 60 0 16 0 52 0 40 de 1992 solar 0 37 0 66 0 53 0 59 0 54 de 1993 solar 0 29 0 61 0 11 0 53 0 39 de 1994 solar 0 67 0 59 0 68 0 69 0 66 de 1995 solar 0 46 0 67 0 69 0 73 0 64 de 1996 solar 0 56 0 47 0 62 0 49 0 53 de 1997 solar 0 54 0 66 0 86 0 71 0 69 de 1998 solar 0 51 0 64 0 60 0 73 0 62 de 1999 solar 0 57 0 55 0 63 0 69 0 61 de 2000 solar 0 55 0 65 0 68 0 67 0 64 de 2001 solar 0 53 0 72 0 74 0 76 0 69 de 2002 solar 0 52 0 61 0 68 0 64 0 61 de 2003 solar 0 53 0 63 0 40 0 70 0 56 de 2004 solar 0 50 0 60 0 59 0 65 0 59 de 2005 solar 0 58 0 71 0 56 0 69 0 63 de 2006 solar 0 58 0 72 0 70 0 69 0 67 de 2007 solar 0 68 0 84 0 83 0 87 0 80 de 2008 solar 0 58 0 73 0 78 0 80 0 72 de 2009 solar 0 56 0 64 0 69 0 74 0 66 de 2010 solar 0 55 0 55 0 71 0 56 0 59 de 2011 solar 0 47 0 67 0 64 0 63 0 60 de 2012 solar 0 48 0 69 0 74 0 66 0 64 de 2013 solar 0 57 0 67 0 74 0 74 0 68 de 2014 solar 0 67 0 71 0 73 0 76 0 72 min all years per model 0 29 0 47 0 11 0 49 0 34 max all years per model 0 68 0 84 0 86 0 87 0 81 mean all years per model 0 53 0 65 0 63 0 68 0 62 description of methods all data sets were split randomly by the h2o splitframe command in the h2o package in training 75 validation 15 and test set 10 the grid search determined the best parameters for the neural network architecture for the range that was considered see table 2 in the main article the parameters used for training were epochs 65 hidden layer 33 51 20 for the random forests the parameter choice was number of trees 3500 number of variables randomly sampled as candidates at each split 6 for the gradient boosting machines2 the parameters were number of trees 1350 maximum depth of a tree 35 if model quality measured in mean squared error mse does not improve for 0 005 for three consecutive rounds this is taken as an indication that model quality cannot be improved on the training set in order to avoid overfitting model runs are stopped at this point table a 4 number of cases for the training and testing for each year and for germany at the county level table a 4 year number of complete data sets used for training and testing at the county level 1991 77 1992 181 1993 194 1994 167 1995 134 1996 189 1997 201 1998 215 1999 289 2000 389 2001 411 2002 408 2003 405 2004 412 2005 414 2006 414 2007 413 2008 414 2009 414 2010 414 2011 414 2012 415 2013 415 2014 413 fig f 1 type of community source bbsr fig f 1 fig f 2 central peripheral source bbsr fig f 2 table a 5 direction of variable influence in generalized linear models per year for germany table a 5 all direction population per lk pos population density per lk neg fdp in per lk none irradiation per lk pos green party in per lk neg central periphery per lk pos type of urbanisation per lk pos mostly at most 1 model with contrary sign unemployment rate per lk neg interest rate none mixed cdu in per lk neg linke in per lk neg npv per size per lk none spd per lk neg note only if all 24 years had the same sign direction this variable shows up in the all section table a 6 mean variable importance five runs for germany per year aggregated for glm table a 6 variable mean coefficients fdp in per lk 11 22 interest rate per lk 10 92 npv per size per investment cost per lk 10 63 spd in per lk 9 40 cdu in per lk 9 14 unemployment rate per lk 8 70 left party in per lk 8 22 population density per lk 7 10 green party in per lk 5 33 irradiation per lk 3 22 type of urbanisation per lk 3 07 central periphery per lk 3 04 population per lk 1 02 table a 7 mean variable importance five runs for germany per year aggregated for rf table a 7 variable mean relative importance population per lk 0 285 population density per lk 0 148 cdu in per lk 0 114 type of urbanisation per lk 0 107 unemployment rate per lk 0 069 irradiation per lk 0 053 central periphery per lk 0 047 left party in per lk 0 038 spd in per lk 0 035 green party in per lk 0 031 npv per size per investment cost per lk 0 027 fdp in per lk 0 026 interest rate per lk 0 019 table a 8 mean variable importance five runs for germany per year aggregated for dl table a 8 variable mean relative importance type of urbanisation per lk 0 083 population per lk 0 082 npv per size per investment cost per lk 0 080 population density per lk 0 079 interest rate per lk 0 077 irradiation per lk 0 076 unemployment rate per lk 0 076 central periphery per lk 0 075 spd in per lk 0 075 fdp in per lk 0 075 left party in per lk 0 075 green party in per lk 0 074 cdu in per lk 0 072 table a 9 mean variable importance five runs for germany per year aggregated for gbm table a 9 variable mean relative importance population per lk 0 370 population density per lk 0 178 type of urbanisation per lk 0 093 cdu in per lk 0 091 irradiation per lk 0 086 unemployment rate per lk 0 039 central periphery per lk 0 036 spd in per lk 0 031 left party in per lk 0 025 green party in per lk 0 020 fdp in per lk 0 014 npv per size per investment cost per lk 0 011 interest rate per lk 0 006 model runs with response variable controlled for population i e nominal capacity per county per capita table a 10 mean adjusted r2 across five runs for minimum maximum and mean respectively table a 10 dataset glm r2 rf r2 dl r2 gbm r2 min all years per model 2 48 2 74 3 23 1 10 max all years per model 0 44 0 68 0 45 0 73 mean all years per model 0 00 0 14 0 07 0 30 table a 11 mean relative importance in of five gradient boosting model runs response variable nominal capacity per county per capita table a 11 variable name relative importance in type of urbanisation per lk 0 40 population density per lk 0 28 unemployment rate per lk 0 06 interest rate 0 04 left party in per lk 0 04 cdu in per lk 0 03 sonstige per lk 0 03 spd in per lk 0 03 irradiation per lk 0 02 central periphery per lk 0 02 green party in per lk 0 02 fdp in per lk 0 01 npv per size per investment cost per lk 0 01 
26197,remote sensing based surface energy balance seb models such as seb algorithm for land sebal and mapping evapotranspiration et at high resolution with internalized calibration metric are widely used to monitor et however their operational use is challenged by model complexity and the tedious process of selecting hot and cold pixels we developed a new matlab based et mapping toolbox named landmod et mapper for automated implementation of these models to facilitate their widespread applications among new users the toolbox is demonstrated using one landsat and one moderate resolution imaging spectroradiometer modis terra image covering three ameriflux sites in nebraska u s daily et estimates were comparable with the observed et for five days when near cloud free landsat and modis terra images were available in the 2006 maize growing season the toolbox provides a viable et mapping option to new and inexperienced users with reduced time and labor demands keywords landmod et mapper sebal metric matlab landsat modis 1 introduction the transfer of water vapor from earth s surface to the atmosphere also referred to as evapotranspiration et is an important phenomenon within the land atmosphere interface that regulates the earth s energy and water cycles quantifying et is considered a challenging task given the complex nature of heat and energy exchanges between the land and the atmosphere over the last few decades the evolution of several remote sensing tools especially the development and applications of several land surface temperature lst or t s driven surface energy balance seb algorithms has significantly improved our ability to monitor the process of et kalma et al 2008 liou and kar 2014 in thermal remote sensing based seb model lst is used to define the surface moisture conditions and solve the seb equation eq 1 kalma et al 2008 liou and kar 2014 1 r n le g h where r n g h and le are net radiation soil heat sensible and latent heat fluxes respectively the surface energy balance algorithm for land sebal bastiaanssen et al 1998 and mapping et at high resolution with internalized calibration metric allen et al 2007b are two widely used seb based et models on thermal sensors such as landsat and modis allen et al 2011 bastiaanssen et al 2005 bhattarai et al 2016 sebal pioneered the concept of selecting the hot and cold pixels referred to as anchor pixels hereafter within a remotely sensed image to contextually derive et across all pixels within the image metric is a simple extension of the sebal model in which reference et allen et al 1998 is used to internally calibrate h and was first developed for applications in the us allen et al 2007a 2007b 2011 however metric now has been successfully tested and applied other parts of the world khand et al 2017 madugundu et al 2017 santos et al 2008 spiliotopoulos et al 2017 despite their wide popularity sebal and metric models are limited to experienced users due to the requirement of selecting anchor pixels within an image recently there have been significant efforts to fully automate anchor pixels selection in these models allen et al 2013 bhattarai et al 2017 morton et al 2013 for example allen et al 2013 used a simple statistical approach to group out candidate pixels and automatically identify hot and cold pixels in the metric model bhattarai et al 2017 proposed an optimized way of using an exhaustive search algorithm esa to automate the anchor pixel selection process a current effort is underway to automatically derive landsat based et using metric model on the google earth engine gee based application eeflux based on allen et al 2013 and morton et al 2013 however the gee source code is not publicly available allen et al 2015 and et maps are only available for the us with no options to update coarse resolution 12 5 km meteorological inputs which typically degrades the performance of seb models bhattarai et al 2018 an r package olmedo et al 2016 is currently available to run metric which do not use the optimized version of hot and pixel selection and requires some predefined area of interests aoi a python version of the metric model is currently under development https github com hectornieto pymetric which also has an option of automating hot and cold pixel using bhattarai et al 2017 similarly a python version of sebal jaafar and ahmad 2019 is currently under development however a matlab version of fully automated sebal and metric models is not currently available an attempt to create matlab toolbox for sebal application was made by atasevera et al 2013 however the process was not fully automated and is not available to the public in this paper we develop a new matlab based graphical user interface gui based toolbox for the application of fully automated versions of the sebal and metric models in landsat modis or other thermal sensors with this gui we aim to address some of the existing challenges in sebal metric implementations such as the tedious process of anchor pixels selection need of expertise to run the models uncertainty in weather inputs and bring the model within the domain of new and inexperienced users 2 methods 2 1 brief descriptions of the sebal and metric models 2 r n r s 1 α ε o r ld r lu 3 g r n t s 273 15 α 0 0038α 0 0074α 2 1 0 98ndvi 4 4 h ρ a c pdt r ah the residual form of seb equation is used in sebal and metric models i e le r n g h r n is computed using the net radiation balance equation eq 2 while g is computed as a small proportion of r n eq 3 bastiaanssen 2000 details on r n and g estimations can be found in allen et al 2007b the key component of sebal and metric model is self calibration of h using an iterative process based on manually or automatically selected hot dry and bare agricultural field and cold well irrigated croplands pixels a major difference between sebal and metric is that le at the cold pixel is equal to available energy in sebal or h 0 while in metric cold pixel et is considered to be 5 greater than alfalfa reference et allen et al 2007b in both models h is estimated by simultaneously solving equations for h aerodynamic resistance for heat transfer r ah and frictional velocity u as described in allen et al 2007b allen et al 2011 and bhattarai et al 2016 2 2 the landmod et mapper the landmod et mapper gui is an et mapping toolbox fig 1 designed to automatically implement sebal and metric models efficiently by users with any level of prior model experiences the matlab software and license and preferably version 2017a and beyond are required to open the gui however no prior matlab coding experience is required to run the tool the automation of anchor pixels uses a modified version of bhattarai et al 2017 that eliminates the need of having a reference weather station within the image instead gridded weather data or scalar values applicable for small regions are used the automation of hot and cold pixel starts with the selection of candidate pixels based on a simple decision tree classifier and an exhaustive search used to select a subset of pixels that could potentially be selected as hot and cold pixels the final hot and cold pixel is based on the ranking of each pixel based on its lst and ndvi values the pixel with highest lst and lowest ndvi value is selected as the hot pixel while the pixel with the lowest lst and highest ndvi is taken as the cold pixel the automatically selected hot and cold pixels are used to internally calibrate h and follow the stabilization correction procedures explained in allen et al 2011 le is then used to estimate evaporative fraction in sebal or reference et fraction etrf which is assumed to be constant during the day to produce daily et maps as described in allen et al 2011 and bhattarai et al 2017 2 3 structure of the landmod et mapper the toolbox can be divided into two sections 1 model inputs and 2 model outputs the model input part is further divided into 5 subsections image metadata inputs surface and cloud cover information weather inputs remote sensing inputs and weather and image information several parameters and constants i e processing parameters constants and hot and cold pixel selection parameters are automatically populated based on satellite type landsat or modis the remotely sensed inputs include lst ndvi albedo and emissivity which are either available as derived products e g https modis gsfc nasa gov data dataprod last visited october 10 2018 or computed using individual bands jiménez muñoz and sobrino 2003 liang 2001 tasumi et al 2008 the main reason for using these derived remotely sensed products rather than the individual bands as input is because there are several methods to derive lst albedo and emissivity from landsats bhattarai et al 2016 sobrino et al 2004 tasumi et al 2008 teixeira et al 2009 such an option makes the toolbox more applicable for other thermal sensors from which these parameters could be derived e g advanced spaceborne thermal emission and reflection radiometer aster detailed descriptions of all other inputs and outputs are provided in the file about landmod et mapper pdf provided with the toolbox see data and code availability because lst is the key input in these models it is required that lst input is in geotiff format from which matlab will extract referencing information to write outputs in the same format the model outputs can be saved in defined output folder i e output path and output files are named based on the parameter e g le for le appended with model type and yeardoy of the input image the toolbox also allows for the visualization of key model outputs le and daily et 2 3 1 application of the landmod et mapper for the demonstration purpose we applied landmod et mapper in a highly studied ameriflux site in nebraska that covers three eddy covariance ec towers us ne1 lat 41 1651 and lon 96 4766 usne2 lat 41 16487 and lon 96 4701 and usne3 lat 41 17967 and lon 96 43965 over croplands fig 2 readers are referred to verma et al 2005 for details on instrumentation operation and maintenance data processing and quality control of ec tower at these sites hourly and daily weather data solar radiation temperature wind speed and relative humidity were obtained from five automated weather data network awdn managed by the high plains regional climate center hprcc https hprcc unl edu awdn php last visited on october 15 2018 inverse distance weighting idw method was used to create weather grids based on instantaneous and daily weather variables from the five awdn stations fig 2 a total of five near cloud free landsat and modis images doy 199 215 267 287 and 311 during the 2006 maize growing season were used in this study the key remotely sensed inputs data source or derivation methods used in this study are listed in table 1 2 4 model evaluation we aggregated half hourly flux from the three ameriflux sites to convert into daily average le and then daily et et le λ where λ is the latent heat of vaporization k j kg 1 for evaluation of the et models based on landsat and modis inputs daily et from eeflux was also used to compare the relative performance of the models for the five clear sky modis and landsat image acquisition days models were evaluated based on commonly used statistical metrics such as root mean squared error rmse the coefficient of determination r 2 mean absolute error mae and percent bias error pbias moriasi et al 2007 3 results and discussion 3 1 et maps from the landmod et mapper toolbox fig 3 demonstrates the et mapping capability of the landmod et mapper toolbox here landsat and modis derived daily et maps for the yeardoy 2006215 using the landmodet mapper toolbox are shown the difference in spatial resolution is clearly evident as modis is coarser resolution and typically used for regional scale et mapping while landsat can provide field scale et 30 m however the spatial pattern of daily et is similar across all models and scales 3 2 performance evaluation of daily et estimates from the landmod et mapper comparison of daily et estimates from the landmod et mapper and observed et at the three ameriflux sites in ne suggests that the metric and sebal models are capable of predicting et with reasonable accuracies r 2 from 0 78 to 0 89 and rmse from 0 91 to 1 54 mm day 1 fig 4 in particular both models performed much better when landsat inputs were used as shown in fig 4 for example pbias values were within 7 metric and 3 sebal when landsat images were used as compared to the pbias values of 13 and 14 from sebal and metric respectively when modis images were used fig 4 the better performance of the models when landsat images were used could be attributed to the fact that these two models were initially developed for use in moderate resolution thermal images i e landsat aster waters et al 2002 where the anchor pixels are likely to be better representatives of the extreme conditions i e hot dry and cold wet in the image and on the ground i e 30 m 30 m in landsat vs 1 km 1 km in modis in addition a pixel value extracted based on the location of a flux tower within an image have lesser chances of being contaminated from neighboring pixels in landsat than in modis even in a large field representing a single land cover type e g croplands in our case spatial heterogeneity in lst a key input in the seb based et models can exist based on the actual soil moisture conditions for example a modis lst pixel represents an aggregated lst values from small fields within the 1 km 1 km area which could be quite different than the actual lst on the small fields that have contrasting moisture conditions than neighboring pixels mallick et al 2014 2015 stoy et al 2013 hence daily et values from modis pixels may not be as representative of actual ground conditions i e flux towers as in landsat this could be a reason that despite the same models tools were used landsat derived et estimates were found to be more accurate than those from modis other potential reasons include the differences in values and associated biases in other remotely sensed input variables such as ndvi albedo and emissivity between the two sensors notably the toolbox derived et estimates from the landsat images were closer to the observed et than the eeflux et estimates that were derived using the same landsat images fig 4 this difference could be the differences in submodels used in eeflux and landmod et mapper toolbox e g lst albedo emissivity and surface roughness derivations however model codes used in eeflux were not publicly available for further investigation another key reason also reported in recent studies bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 could be the difference between the weather inputs in these two et modeling approaches for example eeflux based metric model uses coarse resolution weather inputs such as nldas and gridmet abatzoglou 2013 mitchell et al 2004 while the high quality weather station data from awdn was used in the landmod et mapper toolbox however eeflux captured the higher magnitude 7 mm day 1 of observed daily et for the yeardoy 2006215 much better than the sebal and metric models in the landmod et toolbox on this specific date the mean daily et from the three sites was 7 15 mm day 1 which was underestimated by 19 and 22 by the landsat based sebal and metric models respectively this could be justified by the potential underestimation of et at the hot pixel i e et assigned as zero or close to zero as precipitation 0 1 mm preceded two days prior to the landsat image acquisition date i e 2006215 because of the antecedent moisture in the soil et from the hot pixel may not be zero which would underestimate et from all pixels within the image in addition this could also increase evaporation from bare soil and leaves which were not captured by these models conversely for the same day daily et from eeflux was within 1 of observed daily et which indicates that the antecedent moisture conditions may be better represented in the eeflux based metric model it could also be the positive biases in the solar radiation and hence the daily etr from the 12 5 km nldas and the 4 km gridmet data bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 used in eeflux for example daily etr from nldas gridmet data was nearly 50 greater than those from the awdn station data for the yeardoy 2006215 this positive bias is also reflected in an overall overestimation 26 of observed et by eeflux fig 4 however for cases when daily et values were relatively low 1 5 mm day 1 eeflux underestimated daily et under such conditions the toolbox derived daily et showed much better agreement with observed et fig 4 the inconsistency of eeflux derived et at a field scale as in this study could be attributed to biases in the coarse resolution gridded data bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 that were designed for more regional or country scale implementation our results suggest that while high quality weather data is crucial for improving the performance of the sebal and metric models despite some uncertainties associated with these models e g scale effects representation of extreme conditions in the landmod et mapper toolbox users can use high quality reference weather station data to reduce potential biases associated with weather inputs in these models 3 3 efficiency and future application of the landmod et mapper the total processing time taken by the toolbox is dependent on a number of factors such as the size of the image the option to run skin evaporation and the number of models selected to run for example the processing time ranged from 6 s to 580 s to process both models on a 1 km modis scene 204 310 array and a 30 m landsat scene 6141 5861 array with similar spatial domain yeardoy 2006215 when implemented on a 3 4 ghz i 7 processor computer with 48 gb of memory on a windows machine processing time for landsat will be significantly reduced if smaller subsets are used this should be considered a significant improvement in processing time since no prior knowledge of the models or manual selection of hot and cold pixels is required a simple routine to batch process large number of images is presented in the tool description file about landmod et mapper pdf although landsat and modis images were used in this study the landmod et mapper can be ideally used to other thermal sensors such as the aster https asterweb jpl nasa gov and ecostress https ecostress jpl nasa gov as the key remote sensing inputs in the toolbox are derived products from the bands i e albedo ndvi lst and emissivity 4 conclusion we developed a matlab based toolbox named landmod et mapper to run sebal and metric on landsat and modis images for mapping field to regional scale et the landmod et mapper utilizes automated algorithms to fully automate the process of hot and cold pixel selection and implements all parameters of the surface energy balance to produce et maps at the input resolution of the thermal image full automation of these models will allow new users to implement sebal and metric models in an efficient manner that can reduce the potential biases introduced by the manual components in the original models free distribution of landmod et mapper toolbox and associated functions within the metric sebal algorithms could be considered as a step forward for widespread application of these models future studies will test the ability of landmod et mapper on more complex terrains heterogeneous landscapes and diverse agro climatic zones software and data availability landsat modis and weather data were freely available eeflux et outputs are available at https eeflux level1 appspot com matlab codes and instructions for running the landmodet mapper are available in https umich box com s b6ldlf7vvrrmt51mbp2u3l0xmqrl23cj the landmodet mapper toolbox will also be freely distributed through a github public repository https github com nishan3 landmodetmapper acknowledgments we thank high plains regional climate center university of nebraska unl for providing weather data for free use in this study thanks to the u s department of energy s office of science and the principal investigator for the ne flux sites andy suyker unl for the flux data this manuscript has been authored by ut battelle llc under contract no de ac05 00or22725 with the u s department of energy the united states government retains and the publisher by accepting the article for publication acknowledges that the united states government retains a non exclusive paidup irrevocable world wide license to publish or reproduce the published form of this manuscript or allow others to do so for united states government purposes the department of energy will provide public access to these results of federally sponsored research in accordance with the doe public access plan appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 007 
26197,remote sensing based surface energy balance seb models such as seb algorithm for land sebal and mapping evapotranspiration et at high resolution with internalized calibration metric are widely used to monitor et however their operational use is challenged by model complexity and the tedious process of selecting hot and cold pixels we developed a new matlab based et mapping toolbox named landmod et mapper for automated implementation of these models to facilitate their widespread applications among new users the toolbox is demonstrated using one landsat and one moderate resolution imaging spectroradiometer modis terra image covering three ameriflux sites in nebraska u s daily et estimates were comparable with the observed et for five days when near cloud free landsat and modis terra images were available in the 2006 maize growing season the toolbox provides a viable et mapping option to new and inexperienced users with reduced time and labor demands keywords landmod et mapper sebal metric matlab landsat modis 1 introduction the transfer of water vapor from earth s surface to the atmosphere also referred to as evapotranspiration et is an important phenomenon within the land atmosphere interface that regulates the earth s energy and water cycles quantifying et is considered a challenging task given the complex nature of heat and energy exchanges between the land and the atmosphere over the last few decades the evolution of several remote sensing tools especially the development and applications of several land surface temperature lst or t s driven surface energy balance seb algorithms has significantly improved our ability to monitor the process of et kalma et al 2008 liou and kar 2014 in thermal remote sensing based seb model lst is used to define the surface moisture conditions and solve the seb equation eq 1 kalma et al 2008 liou and kar 2014 1 r n le g h where r n g h and le are net radiation soil heat sensible and latent heat fluxes respectively the surface energy balance algorithm for land sebal bastiaanssen et al 1998 and mapping et at high resolution with internalized calibration metric allen et al 2007b are two widely used seb based et models on thermal sensors such as landsat and modis allen et al 2011 bastiaanssen et al 2005 bhattarai et al 2016 sebal pioneered the concept of selecting the hot and cold pixels referred to as anchor pixels hereafter within a remotely sensed image to contextually derive et across all pixels within the image metric is a simple extension of the sebal model in which reference et allen et al 1998 is used to internally calibrate h and was first developed for applications in the us allen et al 2007a 2007b 2011 however metric now has been successfully tested and applied other parts of the world khand et al 2017 madugundu et al 2017 santos et al 2008 spiliotopoulos et al 2017 despite their wide popularity sebal and metric models are limited to experienced users due to the requirement of selecting anchor pixels within an image recently there have been significant efforts to fully automate anchor pixels selection in these models allen et al 2013 bhattarai et al 2017 morton et al 2013 for example allen et al 2013 used a simple statistical approach to group out candidate pixels and automatically identify hot and cold pixels in the metric model bhattarai et al 2017 proposed an optimized way of using an exhaustive search algorithm esa to automate the anchor pixel selection process a current effort is underway to automatically derive landsat based et using metric model on the google earth engine gee based application eeflux based on allen et al 2013 and morton et al 2013 however the gee source code is not publicly available allen et al 2015 and et maps are only available for the us with no options to update coarse resolution 12 5 km meteorological inputs which typically degrades the performance of seb models bhattarai et al 2018 an r package olmedo et al 2016 is currently available to run metric which do not use the optimized version of hot and pixel selection and requires some predefined area of interests aoi a python version of the metric model is currently under development https github com hectornieto pymetric which also has an option of automating hot and cold pixel using bhattarai et al 2017 similarly a python version of sebal jaafar and ahmad 2019 is currently under development however a matlab version of fully automated sebal and metric models is not currently available an attempt to create matlab toolbox for sebal application was made by atasevera et al 2013 however the process was not fully automated and is not available to the public in this paper we develop a new matlab based graphical user interface gui based toolbox for the application of fully automated versions of the sebal and metric models in landsat modis or other thermal sensors with this gui we aim to address some of the existing challenges in sebal metric implementations such as the tedious process of anchor pixels selection need of expertise to run the models uncertainty in weather inputs and bring the model within the domain of new and inexperienced users 2 methods 2 1 brief descriptions of the sebal and metric models 2 r n r s 1 α ε o r ld r lu 3 g r n t s 273 15 α 0 0038α 0 0074α 2 1 0 98ndvi 4 4 h ρ a c pdt r ah the residual form of seb equation is used in sebal and metric models i e le r n g h r n is computed using the net radiation balance equation eq 2 while g is computed as a small proportion of r n eq 3 bastiaanssen 2000 details on r n and g estimations can be found in allen et al 2007b the key component of sebal and metric model is self calibration of h using an iterative process based on manually or automatically selected hot dry and bare agricultural field and cold well irrigated croplands pixels a major difference between sebal and metric is that le at the cold pixel is equal to available energy in sebal or h 0 while in metric cold pixel et is considered to be 5 greater than alfalfa reference et allen et al 2007b in both models h is estimated by simultaneously solving equations for h aerodynamic resistance for heat transfer r ah and frictional velocity u as described in allen et al 2007b allen et al 2011 and bhattarai et al 2016 2 2 the landmod et mapper the landmod et mapper gui is an et mapping toolbox fig 1 designed to automatically implement sebal and metric models efficiently by users with any level of prior model experiences the matlab software and license and preferably version 2017a and beyond are required to open the gui however no prior matlab coding experience is required to run the tool the automation of anchor pixels uses a modified version of bhattarai et al 2017 that eliminates the need of having a reference weather station within the image instead gridded weather data or scalar values applicable for small regions are used the automation of hot and cold pixel starts with the selection of candidate pixels based on a simple decision tree classifier and an exhaustive search used to select a subset of pixels that could potentially be selected as hot and cold pixels the final hot and cold pixel is based on the ranking of each pixel based on its lst and ndvi values the pixel with highest lst and lowest ndvi value is selected as the hot pixel while the pixel with the lowest lst and highest ndvi is taken as the cold pixel the automatically selected hot and cold pixels are used to internally calibrate h and follow the stabilization correction procedures explained in allen et al 2011 le is then used to estimate evaporative fraction in sebal or reference et fraction etrf which is assumed to be constant during the day to produce daily et maps as described in allen et al 2011 and bhattarai et al 2017 2 3 structure of the landmod et mapper the toolbox can be divided into two sections 1 model inputs and 2 model outputs the model input part is further divided into 5 subsections image metadata inputs surface and cloud cover information weather inputs remote sensing inputs and weather and image information several parameters and constants i e processing parameters constants and hot and cold pixel selection parameters are automatically populated based on satellite type landsat or modis the remotely sensed inputs include lst ndvi albedo and emissivity which are either available as derived products e g https modis gsfc nasa gov data dataprod last visited october 10 2018 or computed using individual bands jiménez muñoz and sobrino 2003 liang 2001 tasumi et al 2008 the main reason for using these derived remotely sensed products rather than the individual bands as input is because there are several methods to derive lst albedo and emissivity from landsats bhattarai et al 2016 sobrino et al 2004 tasumi et al 2008 teixeira et al 2009 such an option makes the toolbox more applicable for other thermal sensors from which these parameters could be derived e g advanced spaceborne thermal emission and reflection radiometer aster detailed descriptions of all other inputs and outputs are provided in the file about landmod et mapper pdf provided with the toolbox see data and code availability because lst is the key input in these models it is required that lst input is in geotiff format from which matlab will extract referencing information to write outputs in the same format the model outputs can be saved in defined output folder i e output path and output files are named based on the parameter e g le for le appended with model type and yeardoy of the input image the toolbox also allows for the visualization of key model outputs le and daily et 2 3 1 application of the landmod et mapper for the demonstration purpose we applied landmod et mapper in a highly studied ameriflux site in nebraska that covers three eddy covariance ec towers us ne1 lat 41 1651 and lon 96 4766 usne2 lat 41 16487 and lon 96 4701 and usne3 lat 41 17967 and lon 96 43965 over croplands fig 2 readers are referred to verma et al 2005 for details on instrumentation operation and maintenance data processing and quality control of ec tower at these sites hourly and daily weather data solar radiation temperature wind speed and relative humidity were obtained from five automated weather data network awdn managed by the high plains regional climate center hprcc https hprcc unl edu awdn php last visited on october 15 2018 inverse distance weighting idw method was used to create weather grids based on instantaneous and daily weather variables from the five awdn stations fig 2 a total of five near cloud free landsat and modis images doy 199 215 267 287 and 311 during the 2006 maize growing season were used in this study the key remotely sensed inputs data source or derivation methods used in this study are listed in table 1 2 4 model evaluation we aggregated half hourly flux from the three ameriflux sites to convert into daily average le and then daily et et le λ where λ is the latent heat of vaporization k j kg 1 for evaluation of the et models based on landsat and modis inputs daily et from eeflux was also used to compare the relative performance of the models for the five clear sky modis and landsat image acquisition days models were evaluated based on commonly used statistical metrics such as root mean squared error rmse the coefficient of determination r 2 mean absolute error mae and percent bias error pbias moriasi et al 2007 3 results and discussion 3 1 et maps from the landmod et mapper toolbox fig 3 demonstrates the et mapping capability of the landmod et mapper toolbox here landsat and modis derived daily et maps for the yeardoy 2006215 using the landmodet mapper toolbox are shown the difference in spatial resolution is clearly evident as modis is coarser resolution and typically used for regional scale et mapping while landsat can provide field scale et 30 m however the spatial pattern of daily et is similar across all models and scales 3 2 performance evaluation of daily et estimates from the landmod et mapper comparison of daily et estimates from the landmod et mapper and observed et at the three ameriflux sites in ne suggests that the metric and sebal models are capable of predicting et with reasonable accuracies r 2 from 0 78 to 0 89 and rmse from 0 91 to 1 54 mm day 1 fig 4 in particular both models performed much better when landsat inputs were used as shown in fig 4 for example pbias values were within 7 metric and 3 sebal when landsat images were used as compared to the pbias values of 13 and 14 from sebal and metric respectively when modis images were used fig 4 the better performance of the models when landsat images were used could be attributed to the fact that these two models were initially developed for use in moderate resolution thermal images i e landsat aster waters et al 2002 where the anchor pixels are likely to be better representatives of the extreme conditions i e hot dry and cold wet in the image and on the ground i e 30 m 30 m in landsat vs 1 km 1 km in modis in addition a pixel value extracted based on the location of a flux tower within an image have lesser chances of being contaminated from neighboring pixels in landsat than in modis even in a large field representing a single land cover type e g croplands in our case spatial heterogeneity in lst a key input in the seb based et models can exist based on the actual soil moisture conditions for example a modis lst pixel represents an aggregated lst values from small fields within the 1 km 1 km area which could be quite different than the actual lst on the small fields that have contrasting moisture conditions than neighboring pixels mallick et al 2014 2015 stoy et al 2013 hence daily et values from modis pixels may not be as representative of actual ground conditions i e flux towers as in landsat this could be a reason that despite the same models tools were used landsat derived et estimates were found to be more accurate than those from modis other potential reasons include the differences in values and associated biases in other remotely sensed input variables such as ndvi albedo and emissivity between the two sensors notably the toolbox derived et estimates from the landsat images were closer to the observed et than the eeflux et estimates that were derived using the same landsat images fig 4 this difference could be the differences in submodels used in eeflux and landmod et mapper toolbox e g lst albedo emissivity and surface roughness derivations however model codes used in eeflux were not publicly available for further investigation another key reason also reported in recent studies bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 could be the difference between the weather inputs in these two et modeling approaches for example eeflux based metric model uses coarse resolution weather inputs such as nldas and gridmet abatzoglou 2013 mitchell et al 2004 while the high quality weather station data from awdn was used in the landmod et mapper toolbox however eeflux captured the higher magnitude 7 mm day 1 of observed daily et for the yeardoy 2006215 much better than the sebal and metric models in the landmod et toolbox on this specific date the mean daily et from the three sites was 7 15 mm day 1 which was underestimated by 19 and 22 by the landsat based sebal and metric models respectively this could be justified by the potential underestimation of et at the hot pixel i e et assigned as zero or close to zero as precipitation 0 1 mm preceded two days prior to the landsat image acquisition date i e 2006215 because of the antecedent moisture in the soil et from the hot pixel may not be zero which would underestimate et from all pixels within the image in addition this could also increase evaporation from bare soil and leaves which were not captured by these models conversely for the same day daily et from eeflux was within 1 of observed daily et which indicates that the antecedent moisture conditions may be better represented in the eeflux based metric model it could also be the positive biases in the solar radiation and hence the daily etr from the 12 5 km nldas and the 4 km gridmet data bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 used in eeflux for example daily etr from nldas gridmet data was nearly 50 greater than those from the awdn station data for the yeardoy 2006215 this positive bias is also reflected in an overall overestimation 26 of observed et by eeflux fig 4 however for cases when daily et values were relatively low 1 5 mm day 1 eeflux underestimated daily et under such conditions the toolbox derived daily et showed much better agreement with observed et fig 4 the inconsistency of eeflux derived et at a field scale as in this study could be attributed to biases in the coarse resolution gridded data bhattarai et al 2018 dhungel et al 2019 lewis et al 2014 that were designed for more regional or country scale implementation our results suggest that while high quality weather data is crucial for improving the performance of the sebal and metric models despite some uncertainties associated with these models e g scale effects representation of extreme conditions in the landmod et mapper toolbox users can use high quality reference weather station data to reduce potential biases associated with weather inputs in these models 3 3 efficiency and future application of the landmod et mapper the total processing time taken by the toolbox is dependent on a number of factors such as the size of the image the option to run skin evaporation and the number of models selected to run for example the processing time ranged from 6 s to 580 s to process both models on a 1 km modis scene 204 310 array and a 30 m landsat scene 6141 5861 array with similar spatial domain yeardoy 2006215 when implemented on a 3 4 ghz i 7 processor computer with 48 gb of memory on a windows machine processing time for landsat will be significantly reduced if smaller subsets are used this should be considered a significant improvement in processing time since no prior knowledge of the models or manual selection of hot and cold pixels is required a simple routine to batch process large number of images is presented in the tool description file about landmod et mapper pdf although landsat and modis images were used in this study the landmod et mapper can be ideally used to other thermal sensors such as the aster https asterweb jpl nasa gov and ecostress https ecostress jpl nasa gov as the key remote sensing inputs in the toolbox are derived products from the bands i e albedo ndvi lst and emissivity 4 conclusion we developed a matlab based toolbox named landmod et mapper to run sebal and metric on landsat and modis images for mapping field to regional scale et the landmod et mapper utilizes automated algorithms to fully automate the process of hot and cold pixel selection and implements all parameters of the surface energy balance to produce et maps at the input resolution of the thermal image full automation of these models will allow new users to implement sebal and metric models in an efficient manner that can reduce the potential biases introduced by the manual components in the original models free distribution of landmod et mapper toolbox and associated functions within the metric sebal algorithms could be considered as a step forward for widespread application of these models future studies will test the ability of landmod et mapper on more complex terrains heterogeneous landscapes and diverse agro climatic zones software and data availability landsat modis and weather data were freely available eeflux et outputs are available at https eeflux level1 appspot com matlab codes and instructions for running the landmodet mapper are available in https umich box com s b6ldlf7vvrrmt51mbp2u3l0xmqrl23cj the landmodet mapper toolbox will also be freely distributed through a github public repository https github com nishan3 landmodetmapper acknowledgments we thank high plains regional climate center university of nebraska unl for providing weather data for free use in this study thanks to the u s department of energy s office of science and the principal investigator for the ne flux sites andy suyker unl for the flux data this manuscript has been authored by ut battelle llc under contract no de ac05 00or22725 with the u s department of energy the united states government retains and the publisher by accepting the article for publication acknowledges that the united states government retains a non exclusive paidup irrevocable world wide license to publish or reproduce the published form of this manuscript or allow others to do so for united states government purposes the department of energy will provide public access to these results of federally sponsored research in accordance with the doe public access plan appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 007 
26198,environmental modelling is transitioning from the traditional paradigm that focuses on the model and its quantitative performance to a more holistic paradigm that recognises successful model based outcomes are closely tied to undertaking modelling as a social process not just as a technical procedure this paper redefines evaluation as a multi dimensional and multi perspective concept and proposes a more complete framework for identifying and measuring the effectiveness of modelling that serves the new paradigm under this framework evaluation considers a broader set of success criteria and emphasises the importance of contextual factors in determining the relevance and outcome of the criteria these evaluation criteria are grouped into eight categories project efficiency model accessibility credibility saliency legitimacy satisfaction application and impact evaluation should be part of an iterative and adaptive process that attempts to improve model based outcomes and foster pathways to better futures keywords model evaluation model assessment model performance 1 introduction in the environmental sector modelling serves a variety of interrelated purposes including decision support scientific discovery and social learning badham et al 2019 gober 2018 in the water sector for example it supports a range of water management decisions including infrastructure construction and operations flood control and drought management harvesting and storing water above and below ground maintaining healthy ecosystems and allocation of water for agriculture energy production cities and environmental uses loucks et al 2005 mulligan and ahlfeld 2016 snow et al 2016 sharvelle et al 2017 robert et al 2018 modelling also enables scientific discovery for example about anticipated impacts of climate change on regional hydrological systems cook et al 2015 it can also serve as a vehicle to accrue and share knowledge in a learning process elsawah et al 2015 and build public interest in adaptive management and collective action pahl wostl et al 2010 these modelling functions are increasingly interrelated stemming from the fact that many environmental especially water related problems are recognised as wicked see rittel and webber 1973 in that they are complex intractable contentious and open ended head 2010 evaluation of modelling projects helps improve the modelling when conducted within an ongoing model development process such as that described in phases and steps by badham et al 2019 for integrated water resource management it enables weaknesses to be identified and resolved and can also allow the experience from one modelling project to improve future modelling evaluation of a modelling exercise or project is especially important during an era of climate change globalisation increasing environmental degradation and high uncertainty in general about the future requiring effective adaptation in response to changing circumstances gorddard et al 2016 radhakrishnan et al 2018 ecologists now talk about transitioning ecosystems away from conservation to managing the new normal stein et al 2013 this transition involves enhanced awareness of system change e g water supply demand quality reliability and increased interest in the human dimensions of evolving natural systems success in model building and application for challenging interdisciplinary issues is about more than getting the science and engineering right it is about embedding model building in a social process that links and engages scientists decision makers interest groups and the wider public towards achieving impact beyond merely technical performance of a model e g as addressed by bennett et al 2013 such impact can be as basic as sharing understanding of a problem and as complex as identifying policy changes that yield long term improvements for society ticehurst et al 2011 1 1 towards a new paradigm of modelling and evaluation in the traditional paradigm of modelling and evaluation the focus is on the model itself pianosi et al 2016 knowledge transfer to action is treated as a linear process whereby a model is developed used and then subsequently has organisational or societal impact scientific discovery decision making and social learning are treated as rather separate activities over the last decade or so there has been a transition towards a new process oriented paradigm where those three activities are inextricably intertwined voinov et al 2018 gober 2018 this is a paradigm that we the authors of this present paper have been working extensively within under the new paradigm effectiveness of modelling also includes the ability to link scientific discovery decision making and social learning in the modelling process modelling outcomes are recognised as being highly dependent on the interaction users have with a model and the modelling process in addition to the properties of the model output itself outcomes therefore emerge in a highly iterative and nonlinear process ward et al 2009 the shift to the new paradigm demands that evaluation not only extends beyond assessment of the model but is also an iterative yet systematic process nested within the social process of modelling 1 2 contribution of this paper this paper intends to expand evaluation of modelling to reflect our transition from the old modelling paradigm where focus is on the technicalities of the model itself toward the new paradigm where modelling is a social process that considers more holistic outcomes this work arose from an nsf funded sesync pursuit 1 1 pursuits project at the national socio environmental synthesis center sesync https www sesync org for you educator research themes pursuits funded by the united states national science foundation nsf to integrate understanding of core modelling practices the framework and concepts were developed as part of a workshop process based on participants understanding and supported by literature review the participants have a diverse range of backgrounds covering social and natural sciences public health and computer science and have extensive experience in the development of models for decision and policy support social learning and scientific research this work reflects an iterative process of consensus building rather than a systematic review in section 2 we synthesise existing evaluation literature and argue that current evaluation practices are largely inadequate in both depth and scope which limits their applicability and prospects to improve modelling practices we outline an evaluation process section 3 that goes beyond simply confirming a project s achievements to exploring factors and practices that contributed to its success or failure providing constructive learning that can feedback into current or future projects the overall message is that effectiveness comes down to modelling being a process of change rather than change as an outcome we therefore need to think of evaluation as a nested process in which specific practices are woven together to progressively improve understanding evaluation involves mobilising evaluation criteria that suit the project and evaluation context the context to be considered is described in section 4 in section 5 we expand and present 32 criteria to consider in evaluating modelling ranging from project level to system level outcomes and from technical metrics to indicators of more complex attitudinal behavioural and relational changes this is followed by a brief overview of the common methods used for evaluation in section 6 the primary contribution of this paper is the overarching evaluation process and the comprehensive list of evaluation criteria in providing an overview of criteria and techniques and how they fit together the paper intends to help practitioners make sense of available tools and how they could mobilise these tools for their own needs 2 evaluation barriers gaps and opportunities there are several objectives in conducting a model evaluation in terms of accountability evaluation can provide the research and modelling team as well as funders and other interested parties feedback on whether the project is achieving or has achieved its set goals it can also help demonstrate outcomes from the work from a policy point of view an evaluation will help gauge the merit of the work and assist policy makers in determining how much weight to give project model outputs when making their decisions an evaluation can also help justify expenditure to funders and provide a guide for resource allocation in the future including whether funding should be continued increased or limited evaluating the success of projects is also important for learning sharing and improving the accrual of knowledge despite these potentially large benefits of evaluation a systematic approach to it is not commonly sought 2 1 barriers to evaluation there are several barriers to be surmounted for evaluation to become more commonplace one is the lack of time and resources to conduct them generally projects are funded up to the point of the delivery of the final model and report and in some cases training in the use of the model final project evaluation is rarely budgeted for thereby creating a lack of incentive to do so alexandrov et al 2011 schwanitz 2013 in some cases the reason for not evaluating success may be structural pressures and biases that modellers are subject to for models that have been well received there may be apprehension that further evaluation may uncover shortcomings that undermine the project s performance on the other hand for those models that were not well received there may be reluctance in further scrutinising the work these are not necessarily conscious motivations for avoiding evaluations and may occur despite the best intentions of modellers another key reason for not evaluating success may be the lack of awareness or recognition of its benefits including the view that modelling evaluation is limited to model validation and verification through this narrow validation verification lens evaluation of complex models such as large integrated socio environmental models kelly et al 2013 hamilton et al 2015 can be seen as impractical jakeman et al 2006 schwanitz 2013 this paper expands the definition and conceptualisation of evaluation enabling modellers to see that even if certain aspects of evaluation cannot be performed e g due to lack of data others may be both practical and useful other barriers to evaluation may include the limited availability of expertise in evaluation and the lack of guidance or standard procedures in interpreting and carrying out these evaluations alexandrov et al 2011 this paper intends to help researchers and practitioners overcome these two barriers by providing a framework that guides the characterisation and evaluation of the success of modelling projects 2 2 overview of prior work around evaluating success prior work has included useful categorisations and criteria for success in several settings ranging from policy and systems analysis goeller 1988 project management ika 2009 westerveld 2003 timescales roughley 2009 decision support systems mcintosh et al 2011 merritt et al 2017 environmental management and policy cash et al 2003 white et al 2010 stakeholder equity and representation van voorn et al 2016 and model performance bennett et al 2013 of note is the landmark paper by cash et al 2003 which argued that science and technology are unlikely to be used by decision makers to address environmental problems unless relevant stakeholders see them as credible salient and legitimate discourse has also addressed the value of non quantitative outcomes such as community and capacity building and co learning krueger et al 2012 voinov and bousquet 2010 this existing body of literature defines a diverse set of prior criteria yet each article views success factors through a different lens resulting in the need to synthesise the criteria and assure that a representative set is defined and described cohesively these criteria are further discussed in section 5 here we give a brief overview of some key lines of work model evaluation frameworks factors contributing to project success and evaluation in environmental planning and participatory research there are some available frameworks for evaluating environmental models however these frameworks are highly technical with a focus on characterising the uncertainty and performance of the actual model galelli et al 2014 matott et al 2009 refsgaard et al 2007 these frameworks are not suited to evaluating the broader modelling process including the knowledge building and use processes at the other end of the spectrum generic frameworks for evaluating the success of studies in environmental management can be broadly applicable for assessing the social aspects of modelling e g cash et al 2003 goeller 1988 roughley 2009 however on their own these generic frameworks capture only a limited depth and or scope of criteria and considerations relevant to environmental modelling processes there is a need for a modelling focused evaluation framework that builds on both existing environmental model frameworks and more generic evaluation frameworks and provides adequate depth and scope to allow the full range of modelling practices and outcomes to be considered the current literature on factors contributing to success is similarly often undertaken within a specific scope such as for a type of model or tool or models for a specific purpose examples for the first group are abundant mainly stemming from synthesis of best good practices for different types of modelling such as system dynamics modelling elsawah et al 2017a martinez moyano and richardson 2013 environmental decision support systems mcintosh et al 2011 merritt et al 2017 environmental modelling epa 2009 jakeman et al 2006 process modelling bandara 2007 and bayesian network modelling chen and pollino 2012 the second group of studies is less common where examples include those focusing on factors in modelling that contribute to societal problem solving sterk et al 2011 or factors that contribute to a particular evaluation criteria van voorn et al 2016 the first group being well confined and tailored to the processes of a particular type of modelling may be easier to follow in practice by modellers in contrast factors that are output outcome focused seem to be more general and may not be explicit enough for modellers also the second group of literature tend to have a clearer and broader definition of success in mind but in the first group connection between best good practices and what constitute best or good is not always clearly defined there is a gap in systematically linking modelling context e g purposes interest groups resources available modelling practices and success part of this gap is being addressed by studies examining why models and other scientific information have not been used to their full potential borowski and hare 2007 diez and mcintosh 2009 dilling and lemos 2011 the major takeaway message from these studies is that greater interaction between users and producers of information improves the usability of results there is a need to promote evaluation approaches and techniques that are suited to this iterative knowledge exchange process there is a considerable amount of literature on evaluation processes in the fields of environmental planning and participatory research for example von korff et al 2012 provided an overview of evaluating participatory water management projects syme and sadler 1994 identified six principles for evaluation of stakeholder engagement processes highlighting the importance of agreeing on objectives of the program and the criteria and methodology of evaluation in partnership with stakeholders as well as allocating the resources including evaluators early in the program bellamy et al 2001 developed an integrated systems based framework for the evolution of natural resource management policy initiatives which recognises the multiple levels and nested nature of such policies hassenforder et al 2016b proposed the monitoring and evaluation of participatory planning processes meppp framework that includes the consideration of context process and outputs outcomes however there is little literature that focuses on the evaluation process explicitly for environmental modelling projects 3 evaluation process in the context of environmental modelling under the new paradigm we suggest that evaluation occurs within an adaptive learning and management cycle in which evaluation occurs both repeatedly in time and at different levels of a project e g in designing a stakeholder engagement process planning a modelling focussed workshop and responding to changes dynamically within the workshop itself this is consistent with the principle identified by syme and sadler 1994 that evaluation should influence planning in our case projects on an ongoing basis to provide feedback to this adaptive cycle the emphasis of evaluation must shift from being a summative assessment to formative assessment while there has been some debate about the distinction between these two types of evaluation chen 1996 patton 1996 scriven 1991 the key difference lies in their primary function summative evaluation passes judgement on whether an aspect of the modelling was effective or not e g was x practice appropriate for realizing y whereas formative evaluation generates explanatory information about the gap between the actual and desired performance level for the purpose of learning e g why was x practice appropriate inappropriate for realizing y william and black 1996 although both forms of evaluation can be complementary and valuable more attention is needed on understanding why things went right or wrong i e formative evaluation to guide both conceptual and instrumental improvements in ongoing and future projects such evaluation cycles can occur within different stages of a project and across different projects this cyclic process can be informed by evaluation criteria at various levels of abstraction fig 1 these criteria are described in section 5 the most concrete detailed lower level criteria tend to relate to project level impacts including project efficiency credibility and model accessibility these criteria are expected to influence higher level criteria including the application of the model and satisfaction of stakeholders at a higher level impact is a more abstract concept that typically builds on lower level ideas and emerges at system level potentially in the long term at any point in time the evaluators ultimately form their own overall judgement of the effectiveness of the modelling project it is recognised that bias may exist in the knowledge and perception of the evaluators themselves smith et al 2018 entirely avoiding bias is impossible both in modelling and evaluation however some techniques applicable to modelling can be used in the evaluation process itself for example those that result in a reflective evaluation process whereby in some sense the evaluation is evaluated see e g lahtinen et al 2017 this is part of the motivation for the cyclical process presented in fig 1 which indicates evaluation as an ongoing iterative process rather than a once off activity to describe the evaluation itself we propose an evaluation process table 1 in conjunction with fig 1 that is applicable to projects across the spectrum from the traditional to the emerging modelling paradigm it applies both during ex ante and after ex post the modelling project and is built on previous research aimed at characterising success of models decision support tools and research and management projects in general e g bennett et al 2013 cash et al 2003 goeller 1988 ika 2009 mcintosh et al 2011 roughley 2009 effectiveness can take on different forms and the relevant criteria depends on the project and evaluation contexts overall effectiveness of the project in a sense captures the appropriateness of the modelling approach for achieving the intended objectives including the selection of tools and methods voinov et al 2018 and their implementation the form and function of the evaluation activities described below in section 4 can vary depending on whether it is an ex ante or ex post evaluation and whether the outcomes evaluated are within or beyond the control of the project team the learnings from the evaluation can then be used to improve current and future projects table 1 4 context in applying the evaluation process it is important to consider the project context including the modelling purpose problem characteristics and project constraints section 4 1 as well as the evaluation context section 4 2 which includes the stage of the project at which evaluation is planned and differing levels of influence over outcomes 4 1 project context ultimately the core success of a model is based on the purpose for which it was built harmel et al 2014 at a more general level model purpose can be considered in terms of three broad categories decision support tools participatory tools research tools the purpose of the model strongly influences the relevance of the evaluation criteria used as a decision support tool model effectiveness is related to whether it helped improve the ability of an individual or group to make decisions e g keen 1980 a model can serve as a participatory tool in many forms or degrees of participation akin to the ladder of citizen participation in arnstein 1969 ranging from models based on crowdsourced data to models created by participants as a participatory tool for social learning effectiveness can relate to how well the modelling supported learning or communication among different parties of stakeholders e g smajgl and ward 2013 lastly as a research tool effectiveness is often centred on whether the modelling helped improve the science and understanding of the system duggan 2015 these three categories are not mutually exclusive but instead are increasingly intertwined in modern modelling practices glynn et al 2017 argue that such interconnection is needed for adaptive management of natural resources the characteristics of the problem can also influence the evaluation criteria including the benchmark for success relevant problem characteristics can include the number severity and complexity of issues involved the diversity of stakeholders involved and their interests or priorities and the type of system or the system components entailed for example there would be a lower expectation of accuracy for a model capturing the system dynamics of a large river basin with multiple and diverse socioeconomic and environmental drivers compared to that of a model representing a water balance problem for a small simple undeveloped catchment the resources available to the project including time funding expertise and data should also be factored in during the evaluation such resources can put constraints on what the project can feasibly achieve it would be unreasonable to expect a project with limited resources to achieve the same outcomes as a project with a large budget and access to a wealth of data 4 2 evaluation context evaluation design should take into account the relationship between the evaluation and project outcomes specifically 1 the scale at which outcomes become apparent for the evaluation and 2 the role the evaluation plays in the project how it is to be used or communicated 4 2 1 scale of outcomes and timing of evaluation outcomes of a modelling project can occur at different times and at different levels influencing the evaluation table 2 outcomes include both tangible outputs and other nontangible benefits of the model and modelling process see examples in table 2 following rouwette et al 2002 and roughley 2009 we consider outcomes as occurring at the 1 project level 2 individual level 3 group level or 4 system level as shown in figs 1 and 2 fig 2 adapted from mendoza et al 2013 illustrates that the project team has greatest control over the inner circle of the diagram i e project level outcomes and the degree of control decreases moving from individual level outcomes of those directly involved in the project to group level outcomes and finally to the outer circle containing system level outcomes as outcomes can be time dependent the timing of the evaluation can influence its results table 2 roughley 2009 for example an evaluation that occurs immediately after model delivery may find that no system level outcomes were achieved system level changes may only be detected many years after project completion project level outcomes should be apparent within the timeframe of the project itself individual and group level outcomes can emerge anytime between the short term and long term furthermore given the behavioural and social nature of most individual and group level outcomes they are also subject to change through time the timeframe of outcomes is a function of the project purpose and context while it can be useful to identify this timeframe so that outcomes are appropriately assessed it is subject to uncertainty this uncertainty can be dealt with iteratively within the evaluation process project level outcomes include the delivery of project outputs that are generally agreed on and planned for at the beginning of the project they may comprise products such as a functional model or activities such as the provision of training project level outcomes may also include criteria related to the quality of the model for example model validity and the representation of uncertainty outcomes at the individual level refer to the impression or effect of the model on individual end users participants or clients individual level outcomes may include whether the model was perceived as useful or effective at achieving its intended purpose e g supporting decision making or whether it provided any new insight or understanding or led to a change of behaviour it recognises that the same model may have different levels of usage or success on different people white et al 2010 hunka et al 2013 group level outcomes refer to effects of the modelling on the group of participants or stakeholders as a whole these outcomes which are particularly relevant for participatory tools can consist of an exchange or alignment of views consensus on an issue or solution building networks establishing trusting relationships between stakeholders and increased quality of communication between different stakeholder groups forgie and richardson 2007 gray et al 2017 system level outcomes relate to changes that occur in the organisation institution community or system as a result of the modelling thereby referring to outcomes beyond the direct control of the model project team end users and engaged participants for example the modelling may prompt changes in how a government agency assesses or manages a resource including changes to their workflow or processes or their organisational structure halbe et al 2018 the modelling may have indirectly contributed to changes in attitudes and behaviours in the community for example through someone influential in the community who was exposed to and gained new insight from the model diez and mcintosh 2011 system level outcomes also include changes that occur to parts of the system e g the environmental asset or resource as a result of interventions that were influenced by the modelling these system level changes tend to be indirect outcomes positioned on the outer circle of influence fig 2 they are difficult to measure difficult for the modelling team to control roughley 2009 and therefore the most difficult to evaluate there are challenges in evaluating system level changes related to difficulties in attributing impact and limits to affecting change for the former challenge establishing causality can be difficult particularly for complex systems which are subject to a multitude of dynamic processes and for indirect outcomes the second challenge refers to limits to the influence that research based tools can have on the ground regardless of the quality of the model and its underlying science mcintosh et al 2011 not only would the model be just one line of evidence its impact can be limited depending on the politics in play including the power of individual stakeholders for practical reasons particularly when project resources are limited the scope of evaluation is typically bound to the inner circles of influence we advocate an alternative approach to evaluation for system level outcomes that examines the impact pathway based on the theory of change weiss 1995 using this approach the team explicitly maps out the impact pathway i e assumptions about the process through which change occurs toward expected outcomes douthwaite et al 2003 this impact pathway represents the theory of how the team sees the project outputs achieving those system level outcomes it helps the team or stakeholders tease out their assumptions and test their validity deliberately thinking about how and why change can happen from the modelling project will help identify factors along each impact pathway that the project team can and cannot influence this helps the project team to identify and dedicate activities and resources to enable the desired change schuetz et al 2017 for example capacity building and maintenance and support of models may be intermediate steps along the impact pathway that are within the project team s influence the theory of change approach can help identify intermediate outcomes which are indicators to track progress towards the desired outcomes douthwaite et al 2003 4 2 2 role of evaluation within a project as discussed early in the paper there can be different motivations for conducting an evaluation including exploring project impacts deepening understanding of the system improving modelling and other methodological practices improving and sharing knowledge assessing merit of the work and providing transparency by justifying expenditure furthermore the evaluation can be intended for different parties including the project team i e self reflection the funders stakeholders and or other researchers and practitioners the purpose of the evaluation including its motivation and who it is intended for will help determine whose point of view see hassenforder et al 2016b the evaluators need to consider when measuring the individual criteria ideally evaluation should be considered from the planning stage of the project including budgeting adequate time and resources to carry out evaluation activities throughout the project as well as post project considering evaluation and identifying criteria from the beginning also helps to provide better clarity to both the modeller and client about what the modelling is trying to achieve the contextual factors such as modelling purpose problem characteristics and project constraints section 4 1 determine the relative importance of various criteria described in section 5 in addition to the evaluation purpose evaluation design is also guided by the stage of the project at which it will be performed and how the evaluation can be used within the project the use of evaluation results relies on their interpretation and communication interpreting results is a process of linking facts or points collected through data analyses to the purposes and questions that drove the evaluation through this process information turns into evidence that demonstrates progress and success of the project as well as learnings and suggestions for future improvements the use of evaluation results may be either summative or formative in a summative evaluation one may summarise what aspects of each individual criteria have been done well or poorly we may also wish to draw overall conclusions on what types of success criteria the project has achieved and where it may have fallen short in a formative evaluation emphasis is on explanation in which why questions will be asked for example if the results are positive and confirm project achievements what external factors and or practices were undertaken by the modelling team that contributed to the success if the results are negative and contradict the planned objectives what were the factors that contributed to the failure and what could have been done differently evaluation activities conducted while the project is ongoing help assess progress towards objectives and provide feedback to improve the methodology or practices if required evaluation of all criteria should be applicable both ex ante and ex post however given the timing of ex ante evaluations they tend to seek metrics that are only indicative of progress and anticipated outcomes given how the project is tracking to serve a formative function the evaluation should not only provide evidence of a gap between actual and desired performance levels for that point of time but also identify ways to help close the gap william and black 1996 thus with ongoing evaluation the modelling is carried out in an adaptive learning cycle if progress is not tracking towards desired outcomes practices are adapted accordingly evaluation at regular intervals of the modelling process can help identify potential issues as they emerge this enables corrective action to be applied before it becomes a more serious problem requiring major amendments later in the project warren 2014 if evaluation activities only commence later in the project there is less opportunity for evaluation to improve and influence the project outcomes while evaluations conducted ex post cannot improve the project itself they can provide valuable information to improve future projects with the project complete many outcomes are final e g project level outcomes however other outcomes may take several years after the project to become apparent e g some group level outcomes and many system level outcomes and others may vary with time e g related to the use or application of the model evaluation may feed into mechanisms to help design future projects the role of the evaluation may also evolve during a project it is typically useful to at least informally reflect on or evaluate the evaluation checking for bias whether criteria were realistic attainable revisiting the timing of the evaluation and who carried it out the credibility of the information used as evidence may also be revisited for example bark et al 2016 evaluated a large integrated project aimed at assessing ecological and economic benefits of environmental water in the murray darling basin in australia several types of information were gathered including anonymous survey facilitated workshop and bibliometric analysis of publications this ensures multiple perspectives and lines of evidences are used to support interpretation of the data against evaluation questions 5 evaluation criteria we have collated 32 criteria for evaluating the success of modelling projects fig 1 based on existing literature and the collective experience of the authors the criteria are grouped into eight categories project efficiency credibility salience legitimacy model accessibility application satisfaction and impact the following subsections describe each of the criteria and the contexts where they may be important or not relevant our framework intends to provide the full possible scope within which environmental models can be evaluated however it is not expected that projects will assess all 32 criteria at a high level of detail nevertheless we do propose that all criteria are at least discussed when planning an evaluation these criteria will vary in importance depending on the project and evaluation contexts see section 4 and should be prioritised on a case by case basis additionally multiple authors recognise that perceived deficiencies in just one of these interrelated criteria can undermine the overall effectiveness or success of the modelling effort cash et al 2003 kunseler et al 2015 for example engaging more stakeholders in the process may lead to greater legitimacy and salience but it may also decrease the credibility if the science is no longer viewed to be impartial achieving success therefore requires a balancing of tradeoffs across criteria van voorn et al 2016 while it is not feasible to capture the vastly different cases of environmental modelling projects we suggest the following considerations that may be useful when prioritising criteria recognise project constraints which necessitates prioritisation or trade offs among the criteria the most common constraints are related to project efficiency such as time and cost constraints identify criteria that are critical to the project objectives identify criteria that enhance the project objective these criteria may not be critical but enhance the use and outcomes of the project including that of the critical criteria identify criteria that have little relevance to a particular context for example stakeholder communication and consensus may not be important for a biophysical model developed for scientific research here we provide three hypothetical examples of prioritising our criteria for three different types of projects development of decision support systems dss participatory modelling and development of research models for biophysical systems table 3 note that in general the prioritisation of the criteria should be undertaken and agreed on by all parties in the project with consideration of the project and evaluation contexts in addition we should allow the prioritisation to evolve as we enter different stages of a project 5 1 project efficiency historically project management was framed around the three constraints of time cost and quality ika 2009 the understanding of quality has broadened in recent years and is addressed by the remaining 30 success criteria to varying degrees therefore this section concerns only time and cost punctuality and costs are the key aspects of project efficiency the delivery of the project without considering the quality of the deliverables they are also easily measured and probably the only completely objective success criteria efficiency criteria are relatively generic and relevant for almost all modelling projects punctuality concerns whether the work was completed by the project deadline typically there will be several deliverables at different stages of the project such as a model draft paper final recommendation while all projects have or should have target dates for planning purposes only some projects have external reasons for these target dates if the main purpose of the model is to support a decision with a set deadline or provide input to another research project then the timing impacts on the model s effectiveness not only the efficiency it may be necessary to reduce the project scope or make other compromises to meet such a deadline and a model that cannot be applied as intended may be deemed unsuccessful questions of underutilisation or overload should also be considered in the punctuality criteria efficient delivery of a project involves resources including specialist skills being available at the time they are required during the evaluation critical shortages can be identified so that future projects can consider the ordering of activities that require the scarce resources cost criteria concern whether the project was completed within budget as with punctuality the evaluation should consider the allocation of costs to different components of the project identifying where the component cost is more or less than expected and why time costs and quality can be traded for example additional functions may be added to a model as stakeholders become familiar with how models can be used but such scope changes impact on the timing and cost of the project such trading is linked to client satisfaction with the deliverables section 5 7 and involvement in the design see for example extreme programming or other agile project management approaches beck and andres 2005 5 2 credibility given that modelling is the foundation for evaluating the system of interest for decision making it is fundamental that stakeholders perceive the model and modelling process as technically and scientifically valid we consider credibility in terms of five criteria theoretical basis of both the modelling process and model credibility of model inputs testability of implementation match to observed behaviour and adequate treatment of uncertainty measures of many of these criteria have been to some degree formalised for example with good modelling practices e g anderson et al 2015 badham et al 2019 and concepts of evaluating model reliability refsgaard and henriksen 2004 nrc 2012 broadly speaking these measures do not provide yes no answers nrc 2012 moreover the evaluator should bear in mind expectations of different users hunka et al 2013 tradeoffs between them and the possibility of changes in expectations over time credibility is fundamentally about whether stakeholders trust that the model and results can be used as purported when minimising evaluation effort it may be possible to conclude that because the modelling process is scientifically valid and the system sufficiently understood model outputs are likely to be credible scientific validity of the modelling process may be based on acceptance that the modeller has used accepted or justifiable methods voinov et al 2018 including for data and software management as well as quality assurance what is considered acceptable may not have agreement among stakeholders and credibility of the process may be influenced by the modeller s perceived legitimacy section 5 4 determinations of acceptance of methods typically rely on how widespread the methods are used and discussions of the pros and cons of their use which is adjunct to model transparency section 5 5 it is notable that in an integrated assessment modelling process a high degree of stakeholder participation throughout the modelling process facilitates development of credibility aumann 2011 and is likely to influence the role of the considerations listed here 5 2 1 theoretical basis evaluating the theoretical basis of a quantitative model itself involves determining whether concepts structure and parameterisation schemes are scientifically justified because the natural system is unknowably complex an evaluation of the model basis is to some extent subjective at a minimum the conceptual model must form an acceptable approximation of the modelled system the extent to which the quantitative model incorporates high degrees of conceptual model complexity is driven by the problem being addressed jakeman et al 2006 a theoretical evaluation involves checking all relevant underpinnings used in the model construction and that model assumptions invoked are justified justification may take the form of formal model confirmation e g refsgaard and henriksen 2004 comparison to other models in similar settings or a check that the model fits client or end user expectations when justification is needed it should support that 1 the use of the assumptions in the specific circumstances the model is applied 2 the arguments used are sound and 3 the assumptions used are not biased toward a modelling outcome if the theoretical basis of a model is highly uncertain an associated analysis might instead explore the effect of alternative assumptions parameterisation schemes structures or conceptualisations e g bankes 1993 clark et al 2011 5 2 2 credibility of inputs adjunct to evaluating the theoretical aspects those model inputs selected for modelling must also be credible the inputs should be representative of the drivers of the system and be suited for the required model scenarios this does not necessarily mean they directly reflect what is expected in the field they may capture hypothetical what if situations finally the inputs should be technically correct without omissions or errors that are not acknowledged 5 2 3 testability of implementation the implementation of the model needs to be reliable in its running and output and technically valid verification benefits from being able to examine the code e g open source code as well as from a hierarchical testing approach starting with unit tests benchmark problems and analytical solutions nrc 2012 if not already verified by others evidence that the algorithms solve the salient mathematical equations should be provided e g nrc 2012 when executed the software outputs must adequately capture the conceptual model and reflect descriptions from the model domain the most current version of the software should be used to reduce potential artefacts from bugs in the software and solutions should be replicable and reproducible bugs are inevitable in all software including high quality commercial software mcconnell 2004 refsgaard and henriksen 2004 therefore in addition to checking inputs and comparing outputs to observed data internal consistency checks such as assertions and unit testing can be valuable in detecting bugs and ensuring the quality of the model code crout et al 2008 homès 2011 5 2 4 match to observed behaviour stakeholder acceptance of the model is commonly decided in part by its ability to simulate what was observed within the natural system typically a model that approximates observed system behaviour well has higher acceptance than one that does not though other aspects may be more important depending on the context olsson and andersson 2006 to increase acceptance of the model for scenario testing this may also mean that behaviour is evaluated outside of conditions specified for calibration e g for droughts and other extreme conditions nrc 2012 klemeš 1986 formal history matching performance metrics bennett et al 2013 objectively quantify the degree of fit between observations and the model s simulated equivalent outputs history matching metrics may be difficult to construct in highly complex problems where data is scarce unavailable and where the model is numerically unstable or when the model runtimes are extremely long future behaviour is notably fundamentally unknown for example in global climate change models schwanitz 2013 jakeman et al 2006 note that comprehensive evaluation of behaviour is rarely possible or perhaps even appropriate for large integrated models yet even then stakeholders or experts may be able to identify aspects that are unrealistic or judge whether differences from observations are tolerable for the modelling purpose these judgement might be codified as stylized facts describing system behaviours that need to be reproduced schwanitz 2013 minimum performance requirements or fitness for purpose criteria haasnoot et al 2014 parker 2009 5 2 5 treatment of uncertainty for model outputs generated in prediction or forecasting mode assessment of past behaviour typically needs to be complemented by quantification of uncertainty in the actual predictions of interest guillaume et al 2016 addressing uncertainty requires assessment of variation across many model realisations of possible model inputs for a given structure and in some cases different model conceptualisations and related structures that is one model realisation cannot be considered a full representation of consolidated knowledge bankes 1993 maier et al 2016 more broadly model uncertainty needs to adequately acknowledge alternative paths that could lead to different modelling outcomes lahtinen et al 2017 and adequately and legitimately address disagreements as they arise what constitutes adequate treatment of uncertainty is highly problem specific but it is generally recognised that formal uncertainty evaluation provides indirect benefits such as increasing the depth of analysis see guillaume et al 2017 uncertainty quantification can provide better understanding of forecast accuracy see nrc 2012 which provides for more informed evaluations of risk and reliability exploration of sources of uncertainty can be a source of innovation and scientific discovery brugnach et al 2008 p 65 for example model non uniqueness can be examined by performing identifiability analysis on hypothetical data that might be collected in the future doherty and hunt 2009 and help evaluate worth of future data collection e g fienen et al 2010 some model problems benefit from expressing confidence intervals around a prediction forecast and there are metrics for measuring quality of uncertainty bounds laio and tamea 2006 gneiting et al 2007 xiong et al 2009 likewise methods are available to test robustness of management actions herman et al 2015 and a multitude of tools and approaches for working with uncertainty refsgaard et al 2007 matott et al 2009 van der sluijs et al 2005 jakeman et al 2006 in specific domains there may be guidelines or stated protocols for evaluating the treatment of uncertainty but typically each modelling project will have its own criteria for determining whether adequate consideration is given to whether alternative paths might have resulted in different outcomes 5 3 salience in terms of modelling salience refers to the potential usefulness of the model and or modelling process to the end user can the model help address users questions of interest how likely are decisionmakers to integrate results into policy decisions salience is critical to all model and evaluation purposes the actual use and impact of the model is further discussed under application and impact the focus here is on the purpose of the modelling is the model relevant did end users provide input into the design of the modelling and is it timely this corresponds to the three criteria relevance end user input and timeliness 5 3 1 relevance science methods and outputs need to link to local issues relevant to stakeholders if a model is not relevant to addressing the end user questions whether that be related to decision making or scientific research it cannot be deemed successful as put by lusiana et al 2011 perfect models that only answer irrelevant questions in users perspectives have limited utility salience relates not only to the inclusion of important input and output variables but also to their adequate representation including appropriate spatial and temporal extents and resolutions that capture the variables this criterion therefore relates closely to the modelling being fit for purpose a central tenet of good modelling practice jakeman et al 2006 5 3 2 end user input end user engagement is often considered critical for ensuring relevance of model results the usa national research council asserted that inadequate progress has been made in synthesizing research results assessing impacts of climate change on human systems or providing knowledge to support decision making and risk analysis nrc 2007 reasons included a lack of meaningful interaction between scientists and decision makers and difficulty in interpreting scientific information and results and translating them into recommendations for action dunn and laing 2017 came to similar conclusions about the disconnection between research and policy more recently rather than assuming stakeholder needs are known it is useful to have users at the discussion table to frame the problem initially or establishing two way iterative engagement between producers and users to build trust and better understand the needs of policy makers dilling and lemos 2011 furthermore end user engagement is important from a social learning perspective which is the idea that people learn in groups this has emerged as imperative for mediating the science policy divide gober 2018 glynn et al 2017 managing environmental systems in an era of uncertainty requires the capacity to learn from experience synthesise different types of knowledge and experiences and view policies as learning experiments folke et al 2005 from a water resource perspective this means greater interaction and mutual learning from scientists and water managers the need for social learning implies new roles for scientists in the water management process moving from providers of scientific tools and insights to partners in the use of tools and insights for policy and adaptation decision making pahl wostl 2009 pahl wostl et al 2010 direct end user engagement may be beneficial including co authorship between scientists and decision makers however it is not always appropriate for modellers to engage directly with users instead engagement might be structured through knowledge brokers or boundary organisations who can negotiate tensions and facilitate useful exchange between scientists and decision makers linking science and decision making and building collaboration and cooperation white et al 2008 crona and parker 2012 boundary agents help ensure that scientists provide information that fits the given policy context boundary objects such as water resource models are an obvious way for the two groups to work together but uneven power relations and the institutional differences between academic and public sector employment can stymie their role in mediating interests of the two groups white et al 2010 5 3 3 timeliness even where modelling is in principle relevant and end users are appropriately engaged the timeliness of scientific activities needs to be right cash et al 2003 if modelling exercises are run or model results are published at an inconvenient or inopportune time practically or politically then they may be less likely to be salient or have an impact in a policy context timing needs to fit in the policy decision window when the need for change is widely acknowledged and participants feel they can make a difference huitema and meijerink 2010 this is not to say that modelling should not proceed outside those times indeed often modelling exercises need to have occurred prior to the decision window in order for model results to be available rather the purpose and design of the project and its evaluation should be adjusted to reflect these timing constraints for example a modelling exercise that loses its salience due to political events can still be effective if it instead aims to ready materials for the next decision window and the evaluation needs to reflect this new aim 5 4 legitimacy legitimacy is the extent to which decision makers or stakeholders feel that the science or model was developed and presented in an open and unbiased way respectful of divergent points of view in the community cash et al 2003 this criteria includes the acceptance of the authority of the modelling process to influence decision making based on lockwood et al 2010 legitimacy is closely related to notions of fairness and justice syme et al 1999 it is critical for all models particularly when there is a human dimension involved which is the case for any model focussed on decision support without legitimacy of the model subsequent scientific advice and decisions may also not be perceived as legitimate legitimacy may often be observed retrospectively through increasing commitment of decision makers from exploratory conversations and brokering the pros and cons of potential decisions to later events that mobilise action on agreed upon policy we focus here on early indicators inclusion lack of bias and trust 5 4 1 inclusion stakeholders need to feel that the modelling process has included them and or their perspectives the presentation of scientific results and model outputs is inherently a political process and therefore one that must reflect a community s divergent viewpoints increased acceptance of resultant management decisions is part of the motivation of engaging stakeholders throughout the process from the early stage of defining the problem and identifying priorities and constraints through to interpreting model results and involving them in the process as partners jakeman et al 2006 röckmann et al 2012 scenarios are often considered a powerful method of engagement particularly focussed on alternative visions of the future and outcomes of competing policy decisions larsen and gunnarsson östling 2009 stakeholders may also judge legitimacy based on the inclusion of others does the modelling draw on a wide range of opinion and input from stakeholders including community representatives minorities and indigenous groups water decisions for example are inherently valued based and they reflect the meaning and purpose of water to different groups in society underlying values about water stem from beliefs about human rights to water economic efficiency social equity environmental protection provision for future generations and the role of government as well as aesthetic and spiritual concerns today s water policy decisions reflect deep seated beliefs about the rights and responsibilities of individuals and groups in society and the role of science in decision making gober 2018 incorporating the range of beliefs about water from a community reflects the legitimacy of the decision making process in that community 5 4 2 lack of bias stakeholders should be included in an unbiased way bias in the model can be perceived if it reflects goals or perspectives held only by one group of stakeholders or preconceptions held by the modeller or disregards those of another stakeholder group white et al 2010 this does not necessarily mean however that every perspective needs to be given equal voice rather stakeholders need to be included in a fair way which may depend on the size of each stakeholder group affected their stake in the issue or formal rules about standing or admissibility in a legal setting legitimacy rests on the capacity to muster a representative cohort of decision makers and the public on their terms 5 4 3 trust legitimacy is fundamentally about accepting others contributions to decision making meaning that trust plays an important role trust is about the willingness of those in a dependent relationship to rely on each other sharp and curtis 2014 this applies not just between researchers and other stakeholders but also within a research team individuals vary in their predisposition to trust others but their willingness to rely on others is also based on their assessments of the trustworthiness of others trustworthiness is based on assessments of ability integrity do they hold exhibit desirable values and benevolence to what extent do they consider my interests mayer et al 1995 trust may take time to form and can be influenced by previous experiences with not only those individuals involved but also their institutions or related groups e g water experts or modellers in general olsson and andersson 2006 considerations around trust may be related to trust in a model or those doing the modelling assessment of legitimacy may wish to consider both 5 5 model accessibility 5 5 1 input and output accessibility and model transparency and traceability the utility of the model strongly depends on its accessibility in terms of the usability of the model and its outputs and how well they are understood we consider three criteria relevant to model accessibility in the immediate to short term and another three criteria described later relevant in the medium to long term the immediate to short term criteria are input accessibility which relates to the ease of use of the model by the intended end user to perform the task for which it was designed including the effort required to preprocess data as model input output accessibility which relates to whether the model results can be understood again to the intended audience and model transparency which refers to whether the inner workings of the model are available to users model transparency includes the accessibility of the theory and assumptions underpinning the model to enable a deeper interpretation of the model results comprehensive documentation of the rationale of the model its development process the intended area of application and its limitations can reduce uncertainty about how the model can be applied crout et al 2008 key to these three short term accessibility criteria is ensuring the model and its outputs are suited to the target audience whether they be decision makers scientists or community members these criteria are relevant to all models regardless of the project context the model should be designed to bridge the gap between the technological aspects of the model and the cognitive aspects of end users shaped by their background and technical levels this bridging can be achieved for example through the design of a user friendly software interface gui and provision of a non technical e g written in plain english user manual for operating the model and interpreting results mcintosh et al 2011 if the system is non intuitive to the end user and difficult to navigate long term adoption especially with staff turnover may not be achieved even if training is provided in the beginning others have also found that the complexity of models may contribute to model rejection kolkman et al 2016 on the other hand it has also been argued that a user interface that is too simplistic can reduce the transparency of the analyses occurring within environmental models undermining the user s satisfaction that the complexity of the problem has been adequately captured matthews et al 2011 stirling 2010 this suggests the importance of matching the model s degree of complexity and transparency with the user s capacity and expectations gilbert et al 2018 for some users to trust the model it may be important that it not be a black box and users are able to access and trace the logic of its complex inner workings this may be through documentation ideally model accessibility should be tested by end users continuously throughout the development process and before the model is delivered i e formative evaluation user acceptance testing to allow modifications to the design of the model to better suit end user requirements otaduy and diaz 2017 these accessibility criteria may not be perceived as important in many evaluation contexts in comparison to more outcome based e g system level criteria however model accessibility is critical to its use and may be the underlying factor determining whether or not a model is actually used and has subsequent impact 5 5 2 reusability flexibility and ease of maintenance the three shorter term criteria discussed above section 5 5 1 then interplay in the medium to long term through influencing model reusability flexibility and ease of maintenance the importance of these additional criteria varies depending on the purpose of the model reusability refers to both i running and re running the model and ii the action of repurposing the model for other applications and contexts flexibility on the other hand refers to the ease with which modifications can be made to include additional processes or exclude less relevant processes to better fit a model for its purpose ease of maintenance is defined as an attribute of the model that enables defects or issues to be identified and resolved with minimal effort on the part of the model maintainer this can be achieved through the use of software testing principals including the creation and maintenance of a test suite which aids in alerting the maintainer when a change to the model causes adverse effects or has unintended consequences crout et al 2008 homès 2011 model reusability hinges on the technical implementation details of the model how it was developed and how well its use is documented holzworth et al 2010 a model cannot be considered reusable if it cannot be applied to a similar but new context without significant modification to the underlying code similarly insufficient user documentation hinders model reusability as the model cannot be reapplied to a new context without the user having prior knowledge of how to do so an example of model transparency affecting reusability flexibility plays an important role in the medium term as poor model flexibility negatively impacts development velocity the speed at which improvements and modifications can be made an inflexible model structure hinders the ability to incorporate new information knowledge and data such as those that may come to light through an iterative development process krause and flügel 2005 formetta et al 2014 in the longer term lack of flexibility compromises model reusability as relevant processes may not be adequately captured for the model s intended purpose it is not advocated here that all models be made reusable or flexible and expending considerable energy on ensuring ease of maintenance may not be appropriate these all depend on the given modelling purpose however the benefits of models that may be repurposed and adjusted for different contexts is increasingly acknowledged by the environmental modelling community de kok et al 2015 approaching model development in this manner increases a model s flexibility of use repurposing a research tool for use in participatory or decision support contexts is better achieved if code and processes are documented and changes to the code base do not adversely and unnecessarily propagate throughout the model structure as a beneficial side effect such ancillary support processes increase a model s ease of maintainability however adopting development approaches to support reusability and flexibility is often a secondary concern de kok et al 2015 hutton et al 2016 these accessibility criteria may not be a factor in cases where use of the model beyond its initial purpose is not intended this may be in cases where a single context specific model is agreed to by end users prior to the delivery of the model it is notoriously difficult and costly however to introduce reusability flexibility and ease of maintenance after the fact such difficulties are well documented in both domains of software and model development giving rise to iterative development practices as evidenced by jakeman et al 2006 larman and basili 2003 where in line with the purpose of model development the criteria of model reusability flexibility and ease of maintenance should ideally be considered from the beginning of the development process 5 6 application this group of criteria concerns the application of the model and the direct impact of its use our first two criteria in this group correspond to the components of utilisation success proposed by goeller 1988 instrumental use which is the use of the model by the intended end users for the intended purpose and conceptual use which we refer to as system understanding i e improved understanding of the system or problem as a result of model use or involvement in the modelling process the third criterion work productivity considers whether the model results in improved work effectiveness or efficiency for the end user if work productivity is not improved there may be no advantage nor incentive to adopt the model the relevance of the other three criteria in this group depends on the model purpose stakeholder communication considers whether the modelling process helped facilitate communication between stakeholders including an exchange of viewpoints and understanding of other participants stakeholder consensus considers whether the modelling process helped stakeholders or at least the participants arrive at a shared view of the problem or actions required and decision making considers whether the modelling process or results influenced actions taken to address the problem including increased commitment to address the problem these application criteria correspond to individual and group level criteria the first three criteria instrumental use system understanding and work productivity are expected to be relevant to most contexts how these criteria are interpreted and assessed is highly dependent on the model purpose the stakeholder communication and consensus and decision criteria are relevant to models serving participatory and decision support purposes it may be possible to assess all five application criteria shortly after the delivery of the model however some of the criteria may be subject to change over time so an evaluation of the criteria in the medium to long term may also be appropriate for example the end user may take several months or longer before they are comfortable with using the model to its full capacity or the participatory exercise may have led to initial contact between stakeholders with a notable improvement in communication between the parties occurring long after project completion conversely apparent success in the instrumental use of the model or work productivity may change over time for example if the model becomes outdated and is too difficult for end users to update therefore other criteria such as accessibility may be tied to these application criteria these application criteria can also be assessed in terms of the available project resources for example the evaluation may consider whether these outcomes could have been achieved more easily or cheaply i e efficiently using another approach such consideration may be particularly relevant if the evaluation purpose is to justify expenditure 5 7 satisfaction the success of a model can also be gauged by the appraisal of the end product and modelling process by the different groups of people associated with the project or the modelled problem including the end user or client who funded the project the project team stakeholders or independent reviewers in many ways project satisfaction is an aggregate measure of all criteria perceived as important by the individual or group as with any summative judgement this assessment will be influenced by the respondent s personal attributes e g values beliefs personal norms knowledge and skills as well as their experience with the model including their level of engagement with the process and their understanding and expectations of the model and or modelling process olsson and andersson 2006 hunka et al 2013 the purpose of the model as well as the purpose of the evaluation will determine the value of the respective satisfaction criteria i e whose satisfaction is important for instance for a research tool independent satisfaction e g expert peer review may be most important for a decision support tool for operational management end user satisfaction is fundamental but a decision support tool for management of more controversial issues such as water allocation may require satisfaction by stakeholders such as the affected communities on the other hand stakeholders engaged with the participatory modelling process may provide valuable feedback on the social learning achievements of the project the satisfaction of the project team may be useful for evaluating the value of methodological practices but may be considered too biased for assessing the overall merits of the work satisfaction can be assessed at or after completion of the project if this appraisal is undertaken shortly after the project is delivered the detailed aspects of the project are more likely to be recalled however many outcomes particularly system level impacts may yet be realised on the other hand satisfaction appraisals conducted many years after project completion may be able to capture more types of outcomes as well as information on long term model usage or changes however as time goes on it may be more difficult to engage with the relevant people for example staff members originally engaged with the project may have left the organisation 5 8 impact this final group of criteria concerns the more system level outcomes of the model community understanding and attitudes refers to whether the model helped improve awareness knowledge or confidence in science or influenced the attitudes or behaviours of the wider organisation or community system outcomes considers whether the model has led to changes in the problem situation system outcomes tend to be indirect such is the case where the modelling or model results influenced a decision that was implemented and had on the ground outcomes finally science impact refers to whether the modelling generated new insights in the research field this may include improved understandings in the methodology e g modelling approach the field of application or across disciplines these criteria tend to be in the outer edge of the circles of influence of the project fig 2 and therefore difficult to affect as well as to evaluate the impact of the model is not only contingent on the application of the model but also various external factors often beyond the control of the project team e g politics natural processes other competing socioeconomic objectives which give rise to the challenges of attributing impact and limits to affecting change moreover models are typically just one of many lines of evidence used in decision making and in scientific and participatory contexts even very good models may fail to make an impact due to other factors for instance a model that leads to an agreement to major reductions in water extractions may result in no positive outcomes in the environment due to drought conditions similarly there are challenges associated with translating system understanding to changes in behaviour particularly at a community level kollmuss and agyeman 2002 the relevance of the criteria are dependent on the purpose of the model these impact criteria are likely to be best assessed in the longer term as it is unlikely that outcomes will be achieved immediately in addressing the difficulties in attributing impact it may be most appropriate to map out the impact pathway douthwaite et al 2003 see section 4 2 1 and identify and assess those intermediate outcomes that are somewhat within the project team s influence 6 overview of evaluation methods there is a wide range of methods that can be used to collect data for evaluation harvey 1998 boaz et al 2008 which reflects the fact that there is no single best method several factors are to be considered when selecting data collection methods such as what is the objective of the evaluation what are the resources time cost skills available for the evaluation what are the constraints that may determine the evaluation e g cultural and political conditions it is often the case that the researcher will need to combine more than one data collection method in a mixed method approach to complement and compare results from different methods table 4 gives an overview of the evaluation methods along with their resource requirements strengths and limitations 7 conclusion our proposed framework embraces a more complete perspective on evaluation extending beyond an assessment of the model product to consider the entire modelling process it emphasises the flexibility and interactivity of the social process that takes place when models are developed applied and shared with stakeholders the whole process of model development application and communication ultimately affects whether knowledge and models are used for decision making and or achieve useful impact in other non technical ways to serve the new process oriented paradigm of modelling and evaluation our framework characterises effectiveness as a multi dimensional and multi perspective concept covered by 32 criteria these evaluation criteria range from project level to system level outcomes and from quantitative measures of the technical validity of the model to more complex indicators such as consideration of if and how the modelling process has affected attitudes and behaviours of end users or beyond each model and project has a unique context and purpose and as such there cannot be a standard benchmark against which to judge their effectiveness rather for each case the evaluation methods and criteria are determined by the project and evaluation contexts including the aims priorities and constraints of the project and the evaluation purpose and the scale of outcomes of interest there may be value in building a database of modelling evaluations e g checklist or narratives under each criteria to facilitate learning across projects especially those with similar contexts the evaluation process is described as an iterative process nested within an adaptive learning and management cycle to promote constructive learning that can feedback into the ongoing project and future endeavours to improve outcomes it is critical that evaluation be factored into project plans and budgets scientific discovery decision making and social learning have become increasingly intertwined in modelling processes within the field of managing natural resources therefore evaluation should be part of an ongoing exchange between producers and users of knowledge including modellers and decision makers to improve model based outcomes and promote pathways towards positive futures acknowledgements this work was supported by the sesync socio environmental synthesis center core modelling practices in iwrm project under funding received by the national science foundation dbi 1052875 joseph guillaume was supported by academy of finland funded project wasco grant no 305471 and emil aaltonen foundation funded project eat less water the authors thank four anonymous reviewers and alexey voinov for their useful comments appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 008 
26198,environmental modelling is transitioning from the traditional paradigm that focuses on the model and its quantitative performance to a more holistic paradigm that recognises successful model based outcomes are closely tied to undertaking modelling as a social process not just as a technical procedure this paper redefines evaluation as a multi dimensional and multi perspective concept and proposes a more complete framework for identifying and measuring the effectiveness of modelling that serves the new paradigm under this framework evaluation considers a broader set of success criteria and emphasises the importance of contextual factors in determining the relevance and outcome of the criteria these evaluation criteria are grouped into eight categories project efficiency model accessibility credibility saliency legitimacy satisfaction application and impact evaluation should be part of an iterative and adaptive process that attempts to improve model based outcomes and foster pathways to better futures keywords model evaluation model assessment model performance 1 introduction in the environmental sector modelling serves a variety of interrelated purposes including decision support scientific discovery and social learning badham et al 2019 gober 2018 in the water sector for example it supports a range of water management decisions including infrastructure construction and operations flood control and drought management harvesting and storing water above and below ground maintaining healthy ecosystems and allocation of water for agriculture energy production cities and environmental uses loucks et al 2005 mulligan and ahlfeld 2016 snow et al 2016 sharvelle et al 2017 robert et al 2018 modelling also enables scientific discovery for example about anticipated impacts of climate change on regional hydrological systems cook et al 2015 it can also serve as a vehicle to accrue and share knowledge in a learning process elsawah et al 2015 and build public interest in adaptive management and collective action pahl wostl et al 2010 these modelling functions are increasingly interrelated stemming from the fact that many environmental especially water related problems are recognised as wicked see rittel and webber 1973 in that they are complex intractable contentious and open ended head 2010 evaluation of modelling projects helps improve the modelling when conducted within an ongoing model development process such as that described in phases and steps by badham et al 2019 for integrated water resource management it enables weaknesses to be identified and resolved and can also allow the experience from one modelling project to improve future modelling evaluation of a modelling exercise or project is especially important during an era of climate change globalisation increasing environmental degradation and high uncertainty in general about the future requiring effective adaptation in response to changing circumstances gorddard et al 2016 radhakrishnan et al 2018 ecologists now talk about transitioning ecosystems away from conservation to managing the new normal stein et al 2013 this transition involves enhanced awareness of system change e g water supply demand quality reliability and increased interest in the human dimensions of evolving natural systems success in model building and application for challenging interdisciplinary issues is about more than getting the science and engineering right it is about embedding model building in a social process that links and engages scientists decision makers interest groups and the wider public towards achieving impact beyond merely technical performance of a model e g as addressed by bennett et al 2013 such impact can be as basic as sharing understanding of a problem and as complex as identifying policy changes that yield long term improvements for society ticehurst et al 2011 1 1 towards a new paradigm of modelling and evaluation in the traditional paradigm of modelling and evaluation the focus is on the model itself pianosi et al 2016 knowledge transfer to action is treated as a linear process whereby a model is developed used and then subsequently has organisational or societal impact scientific discovery decision making and social learning are treated as rather separate activities over the last decade or so there has been a transition towards a new process oriented paradigm where those three activities are inextricably intertwined voinov et al 2018 gober 2018 this is a paradigm that we the authors of this present paper have been working extensively within under the new paradigm effectiveness of modelling also includes the ability to link scientific discovery decision making and social learning in the modelling process modelling outcomes are recognised as being highly dependent on the interaction users have with a model and the modelling process in addition to the properties of the model output itself outcomes therefore emerge in a highly iterative and nonlinear process ward et al 2009 the shift to the new paradigm demands that evaluation not only extends beyond assessment of the model but is also an iterative yet systematic process nested within the social process of modelling 1 2 contribution of this paper this paper intends to expand evaluation of modelling to reflect our transition from the old modelling paradigm where focus is on the technicalities of the model itself toward the new paradigm where modelling is a social process that considers more holistic outcomes this work arose from an nsf funded sesync pursuit 1 1 pursuits project at the national socio environmental synthesis center sesync https www sesync org for you educator research themes pursuits funded by the united states national science foundation nsf to integrate understanding of core modelling practices the framework and concepts were developed as part of a workshop process based on participants understanding and supported by literature review the participants have a diverse range of backgrounds covering social and natural sciences public health and computer science and have extensive experience in the development of models for decision and policy support social learning and scientific research this work reflects an iterative process of consensus building rather than a systematic review in section 2 we synthesise existing evaluation literature and argue that current evaluation practices are largely inadequate in both depth and scope which limits their applicability and prospects to improve modelling practices we outline an evaluation process section 3 that goes beyond simply confirming a project s achievements to exploring factors and practices that contributed to its success or failure providing constructive learning that can feedback into current or future projects the overall message is that effectiveness comes down to modelling being a process of change rather than change as an outcome we therefore need to think of evaluation as a nested process in which specific practices are woven together to progressively improve understanding evaluation involves mobilising evaluation criteria that suit the project and evaluation context the context to be considered is described in section 4 in section 5 we expand and present 32 criteria to consider in evaluating modelling ranging from project level to system level outcomes and from technical metrics to indicators of more complex attitudinal behavioural and relational changes this is followed by a brief overview of the common methods used for evaluation in section 6 the primary contribution of this paper is the overarching evaluation process and the comprehensive list of evaluation criteria in providing an overview of criteria and techniques and how they fit together the paper intends to help practitioners make sense of available tools and how they could mobilise these tools for their own needs 2 evaluation barriers gaps and opportunities there are several objectives in conducting a model evaluation in terms of accountability evaluation can provide the research and modelling team as well as funders and other interested parties feedback on whether the project is achieving or has achieved its set goals it can also help demonstrate outcomes from the work from a policy point of view an evaluation will help gauge the merit of the work and assist policy makers in determining how much weight to give project model outputs when making their decisions an evaluation can also help justify expenditure to funders and provide a guide for resource allocation in the future including whether funding should be continued increased or limited evaluating the success of projects is also important for learning sharing and improving the accrual of knowledge despite these potentially large benefits of evaluation a systematic approach to it is not commonly sought 2 1 barriers to evaluation there are several barriers to be surmounted for evaluation to become more commonplace one is the lack of time and resources to conduct them generally projects are funded up to the point of the delivery of the final model and report and in some cases training in the use of the model final project evaluation is rarely budgeted for thereby creating a lack of incentive to do so alexandrov et al 2011 schwanitz 2013 in some cases the reason for not evaluating success may be structural pressures and biases that modellers are subject to for models that have been well received there may be apprehension that further evaluation may uncover shortcomings that undermine the project s performance on the other hand for those models that were not well received there may be reluctance in further scrutinising the work these are not necessarily conscious motivations for avoiding evaluations and may occur despite the best intentions of modellers another key reason for not evaluating success may be the lack of awareness or recognition of its benefits including the view that modelling evaluation is limited to model validation and verification through this narrow validation verification lens evaluation of complex models such as large integrated socio environmental models kelly et al 2013 hamilton et al 2015 can be seen as impractical jakeman et al 2006 schwanitz 2013 this paper expands the definition and conceptualisation of evaluation enabling modellers to see that even if certain aspects of evaluation cannot be performed e g due to lack of data others may be both practical and useful other barriers to evaluation may include the limited availability of expertise in evaluation and the lack of guidance or standard procedures in interpreting and carrying out these evaluations alexandrov et al 2011 this paper intends to help researchers and practitioners overcome these two barriers by providing a framework that guides the characterisation and evaluation of the success of modelling projects 2 2 overview of prior work around evaluating success prior work has included useful categorisations and criteria for success in several settings ranging from policy and systems analysis goeller 1988 project management ika 2009 westerveld 2003 timescales roughley 2009 decision support systems mcintosh et al 2011 merritt et al 2017 environmental management and policy cash et al 2003 white et al 2010 stakeholder equity and representation van voorn et al 2016 and model performance bennett et al 2013 of note is the landmark paper by cash et al 2003 which argued that science and technology are unlikely to be used by decision makers to address environmental problems unless relevant stakeholders see them as credible salient and legitimate discourse has also addressed the value of non quantitative outcomes such as community and capacity building and co learning krueger et al 2012 voinov and bousquet 2010 this existing body of literature defines a diverse set of prior criteria yet each article views success factors through a different lens resulting in the need to synthesise the criteria and assure that a representative set is defined and described cohesively these criteria are further discussed in section 5 here we give a brief overview of some key lines of work model evaluation frameworks factors contributing to project success and evaluation in environmental planning and participatory research there are some available frameworks for evaluating environmental models however these frameworks are highly technical with a focus on characterising the uncertainty and performance of the actual model galelli et al 2014 matott et al 2009 refsgaard et al 2007 these frameworks are not suited to evaluating the broader modelling process including the knowledge building and use processes at the other end of the spectrum generic frameworks for evaluating the success of studies in environmental management can be broadly applicable for assessing the social aspects of modelling e g cash et al 2003 goeller 1988 roughley 2009 however on their own these generic frameworks capture only a limited depth and or scope of criteria and considerations relevant to environmental modelling processes there is a need for a modelling focused evaluation framework that builds on both existing environmental model frameworks and more generic evaluation frameworks and provides adequate depth and scope to allow the full range of modelling practices and outcomes to be considered the current literature on factors contributing to success is similarly often undertaken within a specific scope such as for a type of model or tool or models for a specific purpose examples for the first group are abundant mainly stemming from synthesis of best good practices for different types of modelling such as system dynamics modelling elsawah et al 2017a martinez moyano and richardson 2013 environmental decision support systems mcintosh et al 2011 merritt et al 2017 environmental modelling epa 2009 jakeman et al 2006 process modelling bandara 2007 and bayesian network modelling chen and pollino 2012 the second group of studies is less common where examples include those focusing on factors in modelling that contribute to societal problem solving sterk et al 2011 or factors that contribute to a particular evaluation criteria van voorn et al 2016 the first group being well confined and tailored to the processes of a particular type of modelling may be easier to follow in practice by modellers in contrast factors that are output outcome focused seem to be more general and may not be explicit enough for modellers also the second group of literature tend to have a clearer and broader definition of success in mind but in the first group connection between best good practices and what constitute best or good is not always clearly defined there is a gap in systematically linking modelling context e g purposes interest groups resources available modelling practices and success part of this gap is being addressed by studies examining why models and other scientific information have not been used to their full potential borowski and hare 2007 diez and mcintosh 2009 dilling and lemos 2011 the major takeaway message from these studies is that greater interaction between users and producers of information improves the usability of results there is a need to promote evaluation approaches and techniques that are suited to this iterative knowledge exchange process there is a considerable amount of literature on evaluation processes in the fields of environmental planning and participatory research for example von korff et al 2012 provided an overview of evaluating participatory water management projects syme and sadler 1994 identified six principles for evaluation of stakeholder engagement processes highlighting the importance of agreeing on objectives of the program and the criteria and methodology of evaluation in partnership with stakeholders as well as allocating the resources including evaluators early in the program bellamy et al 2001 developed an integrated systems based framework for the evolution of natural resource management policy initiatives which recognises the multiple levels and nested nature of such policies hassenforder et al 2016b proposed the monitoring and evaluation of participatory planning processes meppp framework that includes the consideration of context process and outputs outcomes however there is little literature that focuses on the evaluation process explicitly for environmental modelling projects 3 evaluation process in the context of environmental modelling under the new paradigm we suggest that evaluation occurs within an adaptive learning and management cycle in which evaluation occurs both repeatedly in time and at different levels of a project e g in designing a stakeholder engagement process planning a modelling focussed workshop and responding to changes dynamically within the workshop itself this is consistent with the principle identified by syme and sadler 1994 that evaluation should influence planning in our case projects on an ongoing basis to provide feedback to this adaptive cycle the emphasis of evaluation must shift from being a summative assessment to formative assessment while there has been some debate about the distinction between these two types of evaluation chen 1996 patton 1996 scriven 1991 the key difference lies in their primary function summative evaluation passes judgement on whether an aspect of the modelling was effective or not e g was x practice appropriate for realizing y whereas formative evaluation generates explanatory information about the gap between the actual and desired performance level for the purpose of learning e g why was x practice appropriate inappropriate for realizing y william and black 1996 although both forms of evaluation can be complementary and valuable more attention is needed on understanding why things went right or wrong i e formative evaluation to guide both conceptual and instrumental improvements in ongoing and future projects such evaluation cycles can occur within different stages of a project and across different projects this cyclic process can be informed by evaluation criteria at various levels of abstraction fig 1 these criteria are described in section 5 the most concrete detailed lower level criteria tend to relate to project level impacts including project efficiency credibility and model accessibility these criteria are expected to influence higher level criteria including the application of the model and satisfaction of stakeholders at a higher level impact is a more abstract concept that typically builds on lower level ideas and emerges at system level potentially in the long term at any point in time the evaluators ultimately form their own overall judgement of the effectiveness of the modelling project it is recognised that bias may exist in the knowledge and perception of the evaluators themselves smith et al 2018 entirely avoiding bias is impossible both in modelling and evaluation however some techniques applicable to modelling can be used in the evaluation process itself for example those that result in a reflective evaluation process whereby in some sense the evaluation is evaluated see e g lahtinen et al 2017 this is part of the motivation for the cyclical process presented in fig 1 which indicates evaluation as an ongoing iterative process rather than a once off activity to describe the evaluation itself we propose an evaluation process table 1 in conjunction with fig 1 that is applicable to projects across the spectrum from the traditional to the emerging modelling paradigm it applies both during ex ante and after ex post the modelling project and is built on previous research aimed at characterising success of models decision support tools and research and management projects in general e g bennett et al 2013 cash et al 2003 goeller 1988 ika 2009 mcintosh et al 2011 roughley 2009 effectiveness can take on different forms and the relevant criteria depends on the project and evaluation contexts overall effectiveness of the project in a sense captures the appropriateness of the modelling approach for achieving the intended objectives including the selection of tools and methods voinov et al 2018 and their implementation the form and function of the evaluation activities described below in section 4 can vary depending on whether it is an ex ante or ex post evaluation and whether the outcomes evaluated are within or beyond the control of the project team the learnings from the evaluation can then be used to improve current and future projects table 1 4 context in applying the evaluation process it is important to consider the project context including the modelling purpose problem characteristics and project constraints section 4 1 as well as the evaluation context section 4 2 which includes the stage of the project at which evaluation is planned and differing levels of influence over outcomes 4 1 project context ultimately the core success of a model is based on the purpose for which it was built harmel et al 2014 at a more general level model purpose can be considered in terms of three broad categories decision support tools participatory tools research tools the purpose of the model strongly influences the relevance of the evaluation criteria used as a decision support tool model effectiveness is related to whether it helped improve the ability of an individual or group to make decisions e g keen 1980 a model can serve as a participatory tool in many forms or degrees of participation akin to the ladder of citizen participation in arnstein 1969 ranging from models based on crowdsourced data to models created by participants as a participatory tool for social learning effectiveness can relate to how well the modelling supported learning or communication among different parties of stakeholders e g smajgl and ward 2013 lastly as a research tool effectiveness is often centred on whether the modelling helped improve the science and understanding of the system duggan 2015 these three categories are not mutually exclusive but instead are increasingly intertwined in modern modelling practices glynn et al 2017 argue that such interconnection is needed for adaptive management of natural resources the characteristics of the problem can also influence the evaluation criteria including the benchmark for success relevant problem characteristics can include the number severity and complexity of issues involved the diversity of stakeholders involved and their interests or priorities and the type of system or the system components entailed for example there would be a lower expectation of accuracy for a model capturing the system dynamics of a large river basin with multiple and diverse socioeconomic and environmental drivers compared to that of a model representing a water balance problem for a small simple undeveloped catchment the resources available to the project including time funding expertise and data should also be factored in during the evaluation such resources can put constraints on what the project can feasibly achieve it would be unreasonable to expect a project with limited resources to achieve the same outcomes as a project with a large budget and access to a wealth of data 4 2 evaluation context evaluation design should take into account the relationship between the evaluation and project outcomes specifically 1 the scale at which outcomes become apparent for the evaluation and 2 the role the evaluation plays in the project how it is to be used or communicated 4 2 1 scale of outcomes and timing of evaluation outcomes of a modelling project can occur at different times and at different levels influencing the evaluation table 2 outcomes include both tangible outputs and other nontangible benefits of the model and modelling process see examples in table 2 following rouwette et al 2002 and roughley 2009 we consider outcomes as occurring at the 1 project level 2 individual level 3 group level or 4 system level as shown in figs 1 and 2 fig 2 adapted from mendoza et al 2013 illustrates that the project team has greatest control over the inner circle of the diagram i e project level outcomes and the degree of control decreases moving from individual level outcomes of those directly involved in the project to group level outcomes and finally to the outer circle containing system level outcomes as outcomes can be time dependent the timing of the evaluation can influence its results table 2 roughley 2009 for example an evaluation that occurs immediately after model delivery may find that no system level outcomes were achieved system level changes may only be detected many years after project completion project level outcomes should be apparent within the timeframe of the project itself individual and group level outcomes can emerge anytime between the short term and long term furthermore given the behavioural and social nature of most individual and group level outcomes they are also subject to change through time the timeframe of outcomes is a function of the project purpose and context while it can be useful to identify this timeframe so that outcomes are appropriately assessed it is subject to uncertainty this uncertainty can be dealt with iteratively within the evaluation process project level outcomes include the delivery of project outputs that are generally agreed on and planned for at the beginning of the project they may comprise products such as a functional model or activities such as the provision of training project level outcomes may also include criteria related to the quality of the model for example model validity and the representation of uncertainty outcomes at the individual level refer to the impression or effect of the model on individual end users participants or clients individual level outcomes may include whether the model was perceived as useful or effective at achieving its intended purpose e g supporting decision making or whether it provided any new insight or understanding or led to a change of behaviour it recognises that the same model may have different levels of usage or success on different people white et al 2010 hunka et al 2013 group level outcomes refer to effects of the modelling on the group of participants or stakeholders as a whole these outcomes which are particularly relevant for participatory tools can consist of an exchange or alignment of views consensus on an issue or solution building networks establishing trusting relationships between stakeholders and increased quality of communication between different stakeholder groups forgie and richardson 2007 gray et al 2017 system level outcomes relate to changes that occur in the organisation institution community or system as a result of the modelling thereby referring to outcomes beyond the direct control of the model project team end users and engaged participants for example the modelling may prompt changes in how a government agency assesses or manages a resource including changes to their workflow or processes or their organisational structure halbe et al 2018 the modelling may have indirectly contributed to changes in attitudes and behaviours in the community for example through someone influential in the community who was exposed to and gained new insight from the model diez and mcintosh 2011 system level outcomes also include changes that occur to parts of the system e g the environmental asset or resource as a result of interventions that were influenced by the modelling these system level changes tend to be indirect outcomes positioned on the outer circle of influence fig 2 they are difficult to measure difficult for the modelling team to control roughley 2009 and therefore the most difficult to evaluate there are challenges in evaluating system level changes related to difficulties in attributing impact and limits to affecting change for the former challenge establishing causality can be difficult particularly for complex systems which are subject to a multitude of dynamic processes and for indirect outcomes the second challenge refers to limits to the influence that research based tools can have on the ground regardless of the quality of the model and its underlying science mcintosh et al 2011 not only would the model be just one line of evidence its impact can be limited depending on the politics in play including the power of individual stakeholders for practical reasons particularly when project resources are limited the scope of evaluation is typically bound to the inner circles of influence we advocate an alternative approach to evaluation for system level outcomes that examines the impact pathway based on the theory of change weiss 1995 using this approach the team explicitly maps out the impact pathway i e assumptions about the process through which change occurs toward expected outcomes douthwaite et al 2003 this impact pathway represents the theory of how the team sees the project outputs achieving those system level outcomes it helps the team or stakeholders tease out their assumptions and test their validity deliberately thinking about how and why change can happen from the modelling project will help identify factors along each impact pathway that the project team can and cannot influence this helps the project team to identify and dedicate activities and resources to enable the desired change schuetz et al 2017 for example capacity building and maintenance and support of models may be intermediate steps along the impact pathway that are within the project team s influence the theory of change approach can help identify intermediate outcomes which are indicators to track progress towards the desired outcomes douthwaite et al 2003 4 2 2 role of evaluation within a project as discussed early in the paper there can be different motivations for conducting an evaluation including exploring project impacts deepening understanding of the system improving modelling and other methodological practices improving and sharing knowledge assessing merit of the work and providing transparency by justifying expenditure furthermore the evaluation can be intended for different parties including the project team i e self reflection the funders stakeholders and or other researchers and practitioners the purpose of the evaluation including its motivation and who it is intended for will help determine whose point of view see hassenforder et al 2016b the evaluators need to consider when measuring the individual criteria ideally evaluation should be considered from the planning stage of the project including budgeting adequate time and resources to carry out evaluation activities throughout the project as well as post project considering evaluation and identifying criteria from the beginning also helps to provide better clarity to both the modeller and client about what the modelling is trying to achieve the contextual factors such as modelling purpose problem characteristics and project constraints section 4 1 determine the relative importance of various criteria described in section 5 in addition to the evaluation purpose evaluation design is also guided by the stage of the project at which it will be performed and how the evaluation can be used within the project the use of evaluation results relies on their interpretation and communication interpreting results is a process of linking facts or points collected through data analyses to the purposes and questions that drove the evaluation through this process information turns into evidence that demonstrates progress and success of the project as well as learnings and suggestions for future improvements the use of evaluation results may be either summative or formative in a summative evaluation one may summarise what aspects of each individual criteria have been done well or poorly we may also wish to draw overall conclusions on what types of success criteria the project has achieved and where it may have fallen short in a formative evaluation emphasis is on explanation in which why questions will be asked for example if the results are positive and confirm project achievements what external factors and or practices were undertaken by the modelling team that contributed to the success if the results are negative and contradict the planned objectives what were the factors that contributed to the failure and what could have been done differently evaluation activities conducted while the project is ongoing help assess progress towards objectives and provide feedback to improve the methodology or practices if required evaluation of all criteria should be applicable both ex ante and ex post however given the timing of ex ante evaluations they tend to seek metrics that are only indicative of progress and anticipated outcomes given how the project is tracking to serve a formative function the evaluation should not only provide evidence of a gap between actual and desired performance levels for that point of time but also identify ways to help close the gap william and black 1996 thus with ongoing evaluation the modelling is carried out in an adaptive learning cycle if progress is not tracking towards desired outcomes practices are adapted accordingly evaluation at regular intervals of the modelling process can help identify potential issues as they emerge this enables corrective action to be applied before it becomes a more serious problem requiring major amendments later in the project warren 2014 if evaluation activities only commence later in the project there is less opportunity for evaluation to improve and influence the project outcomes while evaluations conducted ex post cannot improve the project itself they can provide valuable information to improve future projects with the project complete many outcomes are final e g project level outcomes however other outcomes may take several years after the project to become apparent e g some group level outcomes and many system level outcomes and others may vary with time e g related to the use or application of the model evaluation may feed into mechanisms to help design future projects the role of the evaluation may also evolve during a project it is typically useful to at least informally reflect on or evaluate the evaluation checking for bias whether criteria were realistic attainable revisiting the timing of the evaluation and who carried it out the credibility of the information used as evidence may also be revisited for example bark et al 2016 evaluated a large integrated project aimed at assessing ecological and economic benefits of environmental water in the murray darling basin in australia several types of information were gathered including anonymous survey facilitated workshop and bibliometric analysis of publications this ensures multiple perspectives and lines of evidences are used to support interpretation of the data against evaluation questions 5 evaluation criteria we have collated 32 criteria for evaluating the success of modelling projects fig 1 based on existing literature and the collective experience of the authors the criteria are grouped into eight categories project efficiency credibility salience legitimacy model accessibility application satisfaction and impact the following subsections describe each of the criteria and the contexts where they may be important or not relevant our framework intends to provide the full possible scope within which environmental models can be evaluated however it is not expected that projects will assess all 32 criteria at a high level of detail nevertheless we do propose that all criteria are at least discussed when planning an evaluation these criteria will vary in importance depending on the project and evaluation contexts see section 4 and should be prioritised on a case by case basis additionally multiple authors recognise that perceived deficiencies in just one of these interrelated criteria can undermine the overall effectiveness or success of the modelling effort cash et al 2003 kunseler et al 2015 for example engaging more stakeholders in the process may lead to greater legitimacy and salience but it may also decrease the credibility if the science is no longer viewed to be impartial achieving success therefore requires a balancing of tradeoffs across criteria van voorn et al 2016 while it is not feasible to capture the vastly different cases of environmental modelling projects we suggest the following considerations that may be useful when prioritising criteria recognise project constraints which necessitates prioritisation or trade offs among the criteria the most common constraints are related to project efficiency such as time and cost constraints identify criteria that are critical to the project objectives identify criteria that enhance the project objective these criteria may not be critical but enhance the use and outcomes of the project including that of the critical criteria identify criteria that have little relevance to a particular context for example stakeholder communication and consensus may not be important for a biophysical model developed for scientific research here we provide three hypothetical examples of prioritising our criteria for three different types of projects development of decision support systems dss participatory modelling and development of research models for biophysical systems table 3 note that in general the prioritisation of the criteria should be undertaken and agreed on by all parties in the project with consideration of the project and evaluation contexts in addition we should allow the prioritisation to evolve as we enter different stages of a project 5 1 project efficiency historically project management was framed around the three constraints of time cost and quality ika 2009 the understanding of quality has broadened in recent years and is addressed by the remaining 30 success criteria to varying degrees therefore this section concerns only time and cost punctuality and costs are the key aspects of project efficiency the delivery of the project without considering the quality of the deliverables they are also easily measured and probably the only completely objective success criteria efficiency criteria are relatively generic and relevant for almost all modelling projects punctuality concerns whether the work was completed by the project deadline typically there will be several deliverables at different stages of the project such as a model draft paper final recommendation while all projects have or should have target dates for planning purposes only some projects have external reasons for these target dates if the main purpose of the model is to support a decision with a set deadline or provide input to another research project then the timing impacts on the model s effectiveness not only the efficiency it may be necessary to reduce the project scope or make other compromises to meet such a deadline and a model that cannot be applied as intended may be deemed unsuccessful questions of underutilisation or overload should also be considered in the punctuality criteria efficient delivery of a project involves resources including specialist skills being available at the time they are required during the evaluation critical shortages can be identified so that future projects can consider the ordering of activities that require the scarce resources cost criteria concern whether the project was completed within budget as with punctuality the evaluation should consider the allocation of costs to different components of the project identifying where the component cost is more or less than expected and why time costs and quality can be traded for example additional functions may be added to a model as stakeholders become familiar with how models can be used but such scope changes impact on the timing and cost of the project such trading is linked to client satisfaction with the deliverables section 5 7 and involvement in the design see for example extreme programming or other agile project management approaches beck and andres 2005 5 2 credibility given that modelling is the foundation for evaluating the system of interest for decision making it is fundamental that stakeholders perceive the model and modelling process as technically and scientifically valid we consider credibility in terms of five criteria theoretical basis of both the modelling process and model credibility of model inputs testability of implementation match to observed behaviour and adequate treatment of uncertainty measures of many of these criteria have been to some degree formalised for example with good modelling practices e g anderson et al 2015 badham et al 2019 and concepts of evaluating model reliability refsgaard and henriksen 2004 nrc 2012 broadly speaking these measures do not provide yes no answers nrc 2012 moreover the evaluator should bear in mind expectations of different users hunka et al 2013 tradeoffs between them and the possibility of changes in expectations over time credibility is fundamentally about whether stakeholders trust that the model and results can be used as purported when minimising evaluation effort it may be possible to conclude that because the modelling process is scientifically valid and the system sufficiently understood model outputs are likely to be credible scientific validity of the modelling process may be based on acceptance that the modeller has used accepted or justifiable methods voinov et al 2018 including for data and software management as well as quality assurance what is considered acceptable may not have agreement among stakeholders and credibility of the process may be influenced by the modeller s perceived legitimacy section 5 4 determinations of acceptance of methods typically rely on how widespread the methods are used and discussions of the pros and cons of their use which is adjunct to model transparency section 5 5 it is notable that in an integrated assessment modelling process a high degree of stakeholder participation throughout the modelling process facilitates development of credibility aumann 2011 and is likely to influence the role of the considerations listed here 5 2 1 theoretical basis evaluating the theoretical basis of a quantitative model itself involves determining whether concepts structure and parameterisation schemes are scientifically justified because the natural system is unknowably complex an evaluation of the model basis is to some extent subjective at a minimum the conceptual model must form an acceptable approximation of the modelled system the extent to which the quantitative model incorporates high degrees of conceptual model complexity is driven by the problem being addressed jakeman et al 2006 a theoretical evaluation involves checking all relevant underpinnings used in the model construction and that model assumptions invoked are justified justification may take the form of formal model confirmation e g refsgaard and henriksen 2004 comparison to other models in similar settings or a check that the model fits client or end user expectations when justification is needed it should support that 1 the use of the assumptions in the specific circumstances the model is applied 2 the arguments used are sound and 3 the assumptions used are not biased toward a modelling outcome if the theoretical basis of a model is highly uncertain an associated analysis might instead explore the effect of alternative assumptions parameterisation schemes structures or conceptualisations e g bankes 1993 clark et al 2011 5 2 2 credibility of inputs adjunct to evaluating the theoretical aspects those model inputs selected for modelling must also be credible the inputs should be representative of the drivers of the system and be suited for the required model scenarios this does not necessarily mean they directly reflect what is expected in the field they may capture hypothetical what if situations finally the inputs should be technically correct without omissions or errors that are not acknowledged 5 2 3 testability of implementation the implementation of the model needs to be reliable in its running and output and technically valid verification benefits from being able to examine the code e g open source code as well as from a hierarchical testing approach starting with unit tests benchmark problems and analytical solutions nrc 2012 if not already verified by others evidence that the algorithms solve the salient mathematical equations should be provided e g nrc 2012 when executed the software outputs must adequately capture the conceptual model and reflect descriptions from the model domain the most current version of the software should be used to reduce potential artefacts from bugs in the software and solutions should be replicable and reproducible bugs are inevitable in all software including high quality commercial software mcconnell 2004 refsgaard and henriksen 2004 therefore in addition to checking inputs and comparing outputs to observed data internal consistency checks such as assertions and unit testing can be valuable in detecting bugs and ensuring the quality of the model code crout et al 2008 homès 2011 5 2 4 match to observed behaviour stakeholder acceptance of the model is commonly decided in part by its ability to simulate what was observed within the natural system typically a model that approximates observed system behaviour well has higher acceptance than one that does not though other aspects may be more important depending on the context olsson and andersson 2006 to increase acceptance of the model for scenario testing this may also mean that behaviour is evaluated outside of conditions specified for calibration e g for droughts and other extreme conditions nrc 2012 klemeš 1986 formal history matching performance metrics bennett et al 2013 objectively quantify the degree of fit between observations and the model s simulated equivalent outputs history matching metrics may be difficult to construct in highly complex problems where data is scarce unavailable and where the model is numerically unstable or when the model runtimes are extremely long future behaviour is notably fundamentally unknown for example in global climate change models schwanitz 2013 jakeman et al 2006 note that comprehensive evaluation of behaviour is rarely possible or perhaps even appropriate for large integrated models yet even then stakeholders or experts may be able to identify aspects that are unrealistic or judge whether differences from observations are tolerable for the modelling purpose these judgement might be codified as stylized facts describing system behaviours that need to be reproduced schwanitz 2013 minimum performance requirements or fitness for purpose criteria haasnoot et al 2014 parker 2009 5 2 5 treatment of uncertainty for model outputs generated in prediction or forecasting mode assessment of past behaviour typically needs to be complemented by quantification of uncertainty in the actual predictions of interest guillaume et al 2016 addressing uncertainty requires assessment of variation across many model realisations of possible model inputs for a given structure and in some cases different model conceptualisations and related structures that is one model realisation cannot be considered a full representation of consolidated knowledge bankes 1993 maier et al 2016 more broadly model uncertainty needs to adequately acknowledge alternative paths that could lead to different modelling outcomes lahtinen et al 2017 and adequately and legitimately address disagreements as they arise what constitutes adequate treatment of uncertainty is highly problem specific but it is generally recognised that formal uncertainty evaluation provides indirect benefits such as increasing the depth of analysis see guillaume et al 2017 uncertainty quantification can provide better understanding of forecast accuracy see nrc 2012 which provides for more informed evaluations of risk and reliability exploration of sources of uncertainty can be a source of innovation and scientific discovery brugnach et al 2008 p 65 for example model non uniqueness can be examined by performing identifiability analysis on hypothetical data that might be collected in the future doherty and hunt 2009 and help evaluate worth of future data collection e g fienen et al 2010 some model problems benefit from expressing confidence intervals around a prediction forecast and there are metrics for measuring quality of uncertainty bounds laio and tamea 2006 gneiting et al 2007 xiong et al 2009 likewise methods are available to test robustness of management actions herman et al 2015 and a multitude of tools and approaches for working with uncertainty refsgaard et al 2007 matott et al 2009 van der sluijs et al 2005 jakeman et al 2006 in specific domains there may be guidelines or stated protocols for evaluating the treatment of uncertainty but typically each modelling project will have its own criteria for determining whether adequate consideration is given to whether alternative paths might have resulted in different outcomes 5 3 salience in terms of modelling salience refers to the potential usefulness of the model and or modelling process to the end user can the model help address users questions of interest how likely are decisionmakers to integrate results into policy decisions salience is critical to all model and evaluation purposes the actual use and impact of the model is further discussed under application and impact the focus here is on the purpose of the modelling is the model relevant did end users provide input into the design of the modelling and is it timely this corresponds to the three criteria relevance end user input and timeliness 5 3 1 relevance science methods and outputs need to link to local issues relevant to stakeholders if a model is not relevant to addressing the end user questions whether that be related to decision making or scientific research it cannot be deemed successful as put by lusiana et al 2011 perfect models that only answer irrelevant questions in users perspectives have limited utility salience relates not only to the inclusion of important input and output variables but also to their adequate representation including appropriate spatial and temporal extents and resolutions that capture the variables this criterion therefore relates closely to the modelling being fit for purpose a central tenet of good modelling practice jakeman et al 2006 5 3 2 end user input end user engagement is often considered critical for ensuring relevance of model results the usa national research council asserted that inadequate progress has been made in synthesizing research results assessing impacts of climate change on human systems or providing knowledge to support decision making and risk analysis nrc 2007 reasons included a lack of meaningful interaction between scientists and decision makers and difficulty in interpreting scientific information and results and translating them into recommendations for action dunn and laing 2017 came to similar conclusions about the disconnection between research and policy more recently rather than assuming stakeholder needs are known it is useful to have users at the discussion table to frame the problem initially or establishing two way iterative engagement between producers and users to build trust and better understand the needs of policy makers dilling and lemos 2011 furthermore end user engagement is important from a social learning perspective which is the idea that people learn in groups this has emerged as imperative for mediating the science policy divide gober 2018 glynn et al 2017 managing environmental systems in an era of uncertainty requires the capacity to learn from experience synthesise different types of knowledge and experiences and view policies as learning experiments folke et al 2005 from a water resource perspective this means greater interaction and mutual learning from scientists and water managers the need for social learning implies new roles for scientists in the water management process moving from providers of scientific tools and insights to partners in the use of tools and insights for policy and adaptation decision making pahl wostl 2009 pahl wostl et al 2010 direct end user engagement may be beneficial including co authorship between scientists and decision makers however it is not always appropriate for modellers to engage directly with users instead engagement might be structured through knowledge brokers or boundary organisations who can negotiate tensions and facilitate useful exchange between scientists and decision makers linking science and decision making and building collaboration and cooperation white et al 2008 crona and parker 2012 boundary agents help ensure that scientists provide information that fits the given policy context boundary objects such as water resource models are an obvious way for the two groups to work together but uneven power relations and the institutional differences between academic and public sector employment can stymie their role in mediating interests of the two groups white et al 2010 5 3 3 timeliness even where modelling is in principle relevant and end users are appropriately engaged the timeliness of scientific activities needs to be right cash et al 2003 if modelling exercises are run or model results are published at an inconvenient or inopportune time practically or politically then they may be less likely to be salient or have an impact in a policy context timing needs to fit in the policy decision window when the need for change is widely acknowledged and participants feel they can make a difference huitema and meijerink 2010 this is not to say that modelling should not proceed outside those times indeed often modelling exercises need to have occurred prior to the decision window in order for model results to be available rather the purpose and design of the project and its evaluation should be adjusted to reflect these timing constraints for example a modelling exercise that loses its salience due to political events can still be effective if it instead aims to ready materials for the next decision window and the evaluation needs to reflect this new aim 5 4 legitimacy legitimacy is the extent to which decision makers or stakeholders feel that the science or model was developed and presented in an open and unbiased way respectful of divergent points of view in the community cash et al 2003 this criteria includes the acceptance of the authority of the modelling process to influence decision making based on lockwood et al 2010 legitimacy is closely related to notions of fairness and justice syme et al 1999 it is critical for all models particularly when there is a human dimension involved which is the case for any model focussed on decision support without legitimacy of the model subsequent scientific advice and decisions may also not be perceived as legitimate legitimacy may often be observed retrospectively through increasing commitment of decision makers from exploratory conversations and brokering the pros and cons of potential decisions to later events that mobilise action on agreed upon policy we focus here on early indicators inclusion lack of bias and trust 5 4 1 inclusion stakeholders need to feel that the modelling process has included them and or their perspectives the presentation of scientific results and model outputs is inherently a political process and therefore one that must reflect a community s divergent viewpoints increased acceptance of resultant management decisions is part of the motivation of engaging stakeholders throughout the process from the early stage of defining the problem and identifying priorities and constraints through to interpreting model results and involving them in the process as partners jakeman et al 2006 röckmann et al 2012 scenarios are often considered a powerful method of engagement particularly focussed on alternative visions of the future and outcomes of competing policy decisions larsen and gunnarsson östling 2009 stakeholders may also judge legitimacy based on the inclusion of others does the modelling draw on a wide range of opinion and input from stakeholders including community representatives minorities and indigenous groups water decisions for example are inherently valued based and they reflect the meaning and purpose of water to different groups in society underlying values about water stem from beliefs about human rights to water economic efficiency social equity environmental protection provision for future generations and the role of government as well as aesthetic and spiritual concerns today s water policy decisions reflect deep seated beliefs about the rights and responsibilities of individuals and groups in society and the role of science in decision making gober 2018 incorporating the range of beliefs about water from a community reflects the legitimacy of the decision making process in that community 5 4 2 lack of bias stakeholders should be included in an unbiased way bias in the model can be perceived if it reflects goals or perspectives held only by one group of stakeholders or preconceptions held by the modeller or disregards those of another stakeholder group white et al 2010 this does not necessarily mean however that every perspective needs to be given equal voice rather stakeholders need to be included in a fair way which may depend on the size of each stakeholder group affected their stake in the issue or formal rules about standing or admissibility in a legal setting legitimacy rests on the capacity to muster a representative cohort of decision makers and the public on their terms 5 4 3 trust legitimacy is fundamentally about accepting others contributions to decision making meaning that trust plays an important role trust is about the willingness of those in a dependent relationship to rely on each other sharp and curtis 2014 this applies not just between researchers and other stakeholders but also within a research team individuals vary in their predisposition to trust others but their willingness to rely on others is also based on their assessments of the trustworthiness of others trustworthiness is based on assessments of ability integrity do they hold exhibit desirable values and benevolence to what extent do they consider my interests mayer et al 1995 trust may take time to form and can be influenced by previous experiences with not only those individuals involved but also their institutions or related groups e g water experts or modellers in general olsson and andersson 2006 considerations around trust may be related to trust in a model or those doing the modelling assessment of legitimacy may wish to consider both 5 5 model accessibility 5 5 1 input and output accessibility and model transparency and traceability the utility of the model strongly depends on its accessibility in terms of the usability of the model and its outputs and how well they are understood we consider three criteria relevant to model accessibility in the immediate to short term and another three criteria described later relevant in the medium to long term the immediate to short term criteria are input accessibility which relates to the ease of use of the model by the intended end user to perform the task for which it was designed including the effort required to preprocess data as model input output accessibility which relates to whether the model results can be understood again to the intended audience and model transparency which refers to whether the inner workings of the model are available to users model transparency includes the accessibility of the theory and assumptions underpinning the model to enable a deeper interpretation of the model results comprehensive documentation of the rationale of the model its development process the intended area of application and its limitations can reduce uncertainty about how the model can be applied crout et al 2008 key to these three short term accessibility criteria is ensuring the model and its outputs are suited to the target audience whether they be decision makers scientists or community members these criteria are relevant to all models regardless of the project context the model should be designed to bridge the gap between the technological aspects of the model and the cognitive aspects of end users shaped by their background and technical levels this bridging can be achieved for example through the design of a user friendly software interface gui and provision of a non technical e g written in plain english user manual for operating the model and interpreting results mcintosh et al 2011 if the system is non intuitive to the end user and difficult to navigate long term adoption especially with staff turnover may not be achieved even if training is provided in the beginning others have also found that the complexity of models may contribute to model rejection kolkman et al 2016 on the other hand it has also been argued that a user interface that is too simplistic can reduce the transparency of the analyses occurring within environmental models undermining the user s satisfaction that the complexity of the problem has been adequately captured matthews et al 2011 stirling 2010 this suggests the importance of matching the model s degree of complexity and transparency with the user s capacity and expectations gilbert et al 2018 for some users to trust the model it may be important that it not be a black box and users are able to access and trace the logic of its complex inner workings this may be through documentation ideally model accessibility should be tested by end users continuously throughout the development process and before the model is delivered i e formative evaluation user acceptance testing to allow modifications to the design of the model to better suit end user requirements otaduy and diaz 2017 these accessibility criteria may not be perceived as important in many evaluation contexts in comparison to more outcome based e g system level criteria however model accessibility is critical to its use and may be the underlying factor determining whether or not a model is actually used and has subsequent impact 5 5 2 reusability flexibility and ease of maintenance the three shorter term criteria discussed above section 5 5 1 then interplay in the medium to long term through influencing model reusability flexibility and ease of maintenance the importance of these additional criteria varies depending on the purpose of the model reusability refers to both i running and re running the model and ii the action of repurposing the model for other applications and contexts flexibility on the other hand refers to the ease with which modifications can be made to include additional processes or exclude less relevant processes to better fit a model for its purpose ease of maintenance is defined as an attribute of the model that enables defects or issues to be identified and resolved with minimal effort on the part of the model maintainer this can be achieved through the use of software testing principals including the creation and maintenance of a test suite which aids in alerting the maintainer when a change to the model causes adverse effects or has unintended consequences crout et al 2008 homès 2011 model reusability hinges on the technical implementation details of the model how it was developed and how well its use is documented holzworth et al 2010 a model cannot be considered reusable if it cannot be applied to a similar but new context without significant modification to the underlying code similarly insufficient user documentation hinders model reusability as the model cannot be reapplied to a new context without the user having prior knowledge of how to do so an example of model transparency affecting reusability flexibility plays an important role in the medium term as poor model flexibility negatively impacts development velocity the speed at which improvements and modifications can be made an inflexible model structure hinders the ability to incorporate new information knowledge and data such as those that may come to light through an iterative development process krause and flügel 2005 formetta et al 2014 in the longer term lack of flexibility compromises model reusability as relevant processes may not be adequately captured for the model s intended purpose it is not advocated here that all models be made reusable or flexible and expending considerable energy on ensuring ease of maintenance may not be appropriate these all depend on the given modelling purpose however the benefits of models that may be repurposed and adjusted for different contexts is increasingly acknowledged by the environmental modelling community de kok et al 2015 approaching model development in this manner increases a model s flexibility of use repurposing a research tool for use in participatory or decision support contexts is better achieved if code and processes are documented and changes to the code base do not adversely and unnecessarily propagate throughout the model structure as a beneficial side effect such ancillary support processes increase a model s ease of maintainability however adopting development approaches to support reusability and flexibility is often a secondary concern de kok et al 2015 hutton et al 2016 these accessibility criteria may not be a factor in cases where use of the model beyond its initial purpose is not intended this may be in cases where a single context specific model is agreed to by end users prior to the delivery of the model it is notoriously difficult and costly however to introduce reusability flexibility and ease of maintenance after the fact such difficulties are well documented in both domains of software and model development giving rise to iterative development practices as evidenced by jakeman et al 2006 larman and basili 2003 where in line with the purpose of model development the criteria of model reusability flexibility and ease of maintenance should ideally be considered from the beginning of the development process 5 6 application this group of criteria concerns the application of the model and the direct impact of its use our first two criteria in this group correspond to the components of utilisation success proposed by goeller 1988 instrumental use which is the use of the model by the intended end users for the intended purpose and conceptual use which we refer to as system understanding i e improved understanding of the system or problem as a result of model use or involvement in the modelling process the third criterion work productivity considers whether the model results in improved work effectiveness or efficiency for the end user if work productivity is not improved there may be no advantage nor incentive to adopt the model the relevance of the other three criteria in this group depends on the model purpose stakeholder communication considers whether the modelling process helped facilitate communication between stakeholders including an exchange of viewpoints and understanding of other participants stakeholder consensus considers whether the modelling process helped stakeholders or at least the participants arrive at a shared view of the problem or actions required and decision making considers whether the modelling process or results influenced actions taken to address the problem including increased commitment to address the problem these application criteria correspond to individual and group level criteria the first three criteria instrumental use system understanding and work productivity are expected to be relevant to most contexts how these criteria are interpreted and assessed is highly dependent on the model purpose the stakeholder communication and consensus and decision criteria are relevant to models serving participatory and decision support purposes it may be possible to assess all five application criteria shortly after the delivery of the model however some of the criteria may be subject to change over time so an evaluation of the criteria in the medium to long term may also be appropriate for example the end user may take several months or longer before they are comfortable with using the model to its full capacity or the participatory exercise may have led to initial contact between stakeholders with a notable improvement in communication between the parties occurring long after project completion conversely apparent success in the instrumental use of the model or work productivity may change over time for example if the model becomes outdated and is too difficult for end users to update therefore other criteria such as accessibility may be tied to these application criteria these application criteria can also be assessed in terms of the available project resources for example the evaluation may consider whether these outcomes could have been achieved more easily or cheaply i e efficiently using another approach such consideration may be particularly relevant if the evaluation purpose is to justify expenditure 5 7 satisfaction the success of a model can also be gauged by the appraisal of the end product and modelling process by the different groups of people associated with the project or the modelled problem including the end user or client who funded the project the project team stakeholders or independent reviewers in many ways project satisfaction is an aggregate measure of all criteria perceived as important by the individual or group as with any summative judgement this assessment will be influenced by the respondent s personal attributes e g values beliefs personal norms knowledge and skills as well as their experience with the model including their level of engagement with the process and their understanding and expectations of the model and or modelling process olsson and andersson 2006 hunka et al 2013 the purpose of the model as well as the purpose of the evaluation will determine the value of the respective satisfaction criteria i e whose satisfaction is important for instance for a research tool independent satisfaction e g expert peer review may be most important for a decision support tool for operational management end user satisfaction is fundamental but a decision support tool for management of more controversial issues such as water allocation may require satisfaction by stakeholders such as the affected communities on the other hand stakeholders engaged with the participatory modelling process may provide valuable feedback on the social learning achievements of the project the satisfaction of the project team may be useful for evaluating the value of methodological practices but may be considered too biased for assessing the overall merits of the work satisfaction can be assessed at or after completion of the project if this appraisal is undertaken shortly after the project is delivered the detailed aspects of the project are more likely to be recalled however many outcomes particularly system level impacts may yet be realised on the other hand satisfaction appraisals conducted many years after project completion may be able to capture more types of outcomes as well as information on long term model usage or changes however as time goes on it may be more difficult to engage with the relevant people for example staff members originally engaged with the project may have left the organisation 5 8 impact this final group of criteria concerns the more system level outcomes of the model community understanding and attitudes refers to whether the model helped improve awareness knowledge or confidence in science or influenced the attitudes or behaviours of the wider organisation or community system outcomes considers whether the model has led to changes in the problem situation system outcomes tend to be indirect such is the case where the modelling or model results influenced a decision that was implemented and had on the ground outcomes finally science impact refers to whether the modelling generated new insights in the research field this may include improved understandings in the methodology e g modelling approach the field of application or across disciplines these criteria tend to be in the outer edge of the circles of influence of the project fig 2 and therefore difficult to affect as well as to evaluate the impact of the model is not only contingent on the application of the model but also various external factors often beyond the control of the project team e g politics natural processes other competing socioeconomic objectives which give rise to the challenges of attributing impact and limits to affecting change moreover models are typically just one of many lines of evidence used in decision making and in scientific and participatory contexts even very good models may fail to make an impact due to other factors for instance a model that leads to an agreement to major reductions in water extractions may result in no positive outcomes in the environment due to drought conditions similarly there are challenges associated with translating system understanding to changes in behaviour particularly at a community level kollmuss and agyeman 2002 the relevance of the criteria are dependent on the purpose of the model these impact criteria are likely to be best assessed in the longer term as it is unlikely that outcomes will be achieved immediately in addressing the difficulties in attributing impact it may be most appropriate to map out the impact pathway douthwaite et al 2003 see section 4 2 1 and identify and assess those intermediate outcomes that are somewhat within the project team s influence 6 overview of evaluation methods there is a wide range of methods that can be used to collect data for evaluation harvey 1998 boaz et al 2008 which reflects the fact that there is no single best method several factors are to be considered when selecting data collection methods such as what is the objective of the evaluation what are the resources time cost skills available for the evaluation what are the constraints that may determine the evaluation e g cultural and political conditions it is often the case that the researcher will need to combine more than one data collection method in a mixed method approach to complement and compare results from different methods table 4 gives an overview of the evaluation methods along with their resource requirements strengths and limitations 7 conclusion our proposed framework embraces a more complete perspective on evaluation extending beyond an assessment of the model product to consider the entire modelling process it emphasises the flexibility and interactivity of the social process that takes place when models are developed applied and shared with stakeholders the whole process of model development application and communication ultimately affects whether knowledge and models are used for decision making and or achieve useful impact in other non technical ways to serve the new process oriented paradigm of modelling and evaluation our framework characterises effectiveness as a multi dimensional and multi perspective concept covered by 32 criteria these evaluation criteria range from project level to system level outcomes and from quantitative measures of the technical validity of the model to more complex indicators such as consideration of if and how the modelling process has affected attitudes and behaviours of end users or beyond each model and project has a unique context and purpose and as such there cannot be a standard benchmark against which to judge their effectiveness rather for each case the evaluation methods and criteria are determined by the project and evaluation contexts including the aims priorities and constraints of the project and the evaluation purpose and the scale of outcomes of interest there may be value in building a database of modelling evaluations e g checklist or narratives under each criteria to facilitate learning across projects especially those with similar contexts the evaluation process is described as an iterative process nested within an adaptive learning and management cycle to promote constructive learning that can feedback into the ongoing project and future endeavours to improve outcomes it is critical that evaluation be factored into project plans and budgets scientific discovery decision making and social learning have become increasingly intertwined in modelling processes within the field of managing natural resources therefore evaluation should be part of an ongoing exchange between producers and users of knowledge including modellers and decision makers to improve model based outcomes and promote pathways towards positive futures acknowledgements this work was supported by the sesync socio environmental synthesis center core modelling practices in iwrm project under funding received by the national science foundation dbi 1052875 joseph guillaume was supported by academy of finland funded project wasco grant no 305471 and emil aaltonen foundation funded project eat less water the authors thank four anonymous reviewers and alexey voinov for their useful comments appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 008 
26199,reliable models predicting soil organic carbon soc evolution are required to better manage cropping systems with the objectives of mitigating climate change and improving soil quality in this study data from 60 selected long term field trials conducted in arable systems in france were used to evaluate a revised version of amg model integrating a new mineralization submodel the drivers of soc evolution identified using random forest analysis were consistent with those considered in amg the model with its default parameterization simulated accurately the changes in soc stocks over time the relative model error rrmse 5 3 being comparable to the measurement error cv 4 3 model performance was little affected by the choice of plant c input estimation method but was improved by a site specific optimization of soc pool partitioning amg shows a good potential for predicting soc evolution in scenarios varying in climate soil properties and crop management keywords soil organic carbon mineralization soil carbon storage carbon inputs amg model 1 introduction soils are fundamental to many provisioning and regulating ecosystem services the prediction of which requires improving our understanding of soil processes and their modeling smith et al 2015 vereecken et al 2016 in agricultural systems soil organic matter som plays a crucial role in soil structure quality and fertility for crop production tiessen et al 1994 reeves 1997 som also constitutes an important reservoir of carbon c whose dynamics can significantly impact the global c cycle heimann and reichstein 2008 soil organic carbon soc can act as a sink or source of atmospheric c and has therefore the potential of mitigating climate change by increasing c storage in agricultural soils paustian et al 1997 2016 leading to the recent 4 per mille initiative www 4p1000 org croplands which are depleted in soc compared to grasslands and forests smith 2008 poeplau et al 2011 have a great potential for c sequestration lal and bruce 1999 smith 2004 soc dynamics in arable systems is mainly driven by i c inputs into soils from crop residues and organic amendments generating newly formed som kuzyakov and domanski 2000 mandal et al 2007 maillard and angers 2014 and ii c outputs due to som decomposition and erosion the unbalance between these two opposite fluxes determines soil c decline or accumulation an accurate estimation of c inputs and the consideration of the relevant drivers of som mineralization and stabilization are therefore needed to better predict soc stock evolutions which are primarily under the influence of pedoclimatic conditions and agricultural practices stockmann et al 2013 dignac et al 2017 soc turns over slowly and variations in soc stocks can only be reliably detected on the mid or long term in most cases there is consequently a need for long term experiments ltes to calibrate and validate mathematical models able to reproduce accurately soc dynamics and reliably predict future soc evolutions numerous and various soil biogeochemical models featuring different levels of complexity have been designed to simulate soc dynamics falloon and smith 2000 manzoni and porporato 2009 campbell and paustian 2015 these models can be used to predict soc stock evolution better understand their driving factors and test methods and hypotheses regarding i estimates of plant c inputs into soils taghizadeh toosi et al 2016 keel et al 2017 and ii mineralization of som and its partitioning into functional c pools zimmermann et al 2007 herbst et al 2018 among the diversity of soil c models simple process oriented models may have some advantages compared to more complex ones or organism oriented models stockmann et al 2013 they require a lower number of input variables and have been designed to simulate soc evolutions with a reduced set of functions and parameters reflecting the main processes driving soc dynamics they can be applied to a larger number of experiments and or over longer time and spatial scales when correctly calibrated they may represent a good compromise between complexity and reliability for general applications and could be used as decision support tools to help managing soc in arable systems the aim of this study was to enhance the reliability of amg a simple model simulating soil c at annual time steps andriulo et al 1999 in predicting soc stock evolution in topsoils from arable cropping systems amg was previously shown to satisfactorily simulate the effects of straw residue export on soc in various cropping systems and pedoclimatic conditions saffih hdadi and mary 2008 and the effects of alternative arable systems autret et al 2016 it was also used as a tool for designing innovative cropping systems colnenne david and doré 2015 dufossé et al 2016 in this work we evaluated a revised version of amg in which was implemented a new model of som mineralization calibrated for the prediction of n mineralization in arable soils clivot et al 2017 we hypothesized that the main identified driving factors of soil organic n mineralization could apply for the prediction of soc mineralization due to a tight soil c and n coupling zaehle 2013 and could also improve the modeling of soc dynamics we analyzed the impact of two major sources of uncertainty in soc modeling using several methods related to i estimation of aboveground ag and belowground bg plant c inputs and ii partitioning of total soc between active and stable pools and the relevance of these methods for amg model 2 material and methods 2 1 experimental sites in a first step we compiled all the available ltes carried out in arable cropping systems in france by research teams or extension services since 1970 in which soc had been measured at several dates they represented 455 treatments spread over 53 sites we then selected the most reliable experiments by applying the following criteria number of replicates 3 number of measurement dates 3 experiment duration 8 years mean coefficient of variation of soc measurements 10 rock fragment content nil or measured the selection leads to a reduced dataset of 60 treatments located in 20 sites fig 1 covering however a large diversity of pedoclimatic conditions table s1 crop rotation types and practices table s2 representative of most french arable systems the field experiments were carried out between 1970 and 2015 lasting between 8 and 41 years median value of 22 years table 1 the mean annual temperature observed during the field trials ranged from 9 9 to 13 5 c median value of 11 0 c the annual precipitation ranged from 637 to 1285 mm median 753 mm and potential evapotranspiration from 637 to 947 mm median 721 mm the field trials exhibited contrasting soil physicochemical parameters the clay content ranged from 43 to 308 g kg 1 median 214 g kg 1 silt content from 95 to 781 g kg 1 median 528 g kg 1 sand content from 12 to 791 g kg 1 median 140 g kg 1 and caco3 content of soils varied from 0 to 781 g kg 1 median 0 g kg 1 soil ph varied between 5 6 and 8 3 median 6 8 bulk density ranged from 1 20 to 1 52 g cm 3 median 1 40 g cm 3 initial soil organic c soc stocks in the topsoils ploughed layer 0 20 to 0 30 cm varied widely from 25 to 105 t c ha 1 median 44 t c ha 1 cropping systems encountered in the 60 treatments were cereal based rotations with legumes and or oilseed crops 32 of the cropping systems grain maize winter wheat rotations 27 rotations with silage maize 23 including 3 out of 14 treatments in monoculture grain maize monocultures 10 cereals sugarbeet rotations with legumes and or rapeseed 7 and 1 treatment was a bare fallow soil winter cover crops were occasionally grown in 10 treatments 17 on 3 different sites straw residues were regularly exported in 38 of the treatments and returned to soil in 62 of them exogenous organic matters eom were applied as manure or slurry in 11 treatments 18 from 5 different sites crops were grown with conventional n rate applications providing a positive n balance in most situations seven sites included variations in p or k fertilization rate but they did not reveal major effects on yield or aboveground plant biomass production conventional tillage with full inversion ploughing was conducted in all treatments except 6 treatments from the boig site where soils were maintained under no till past land use of the investigated sites was cropland except the 5 treatments from the kerb site which were previously under sown grassland details on cropping systems can be found in table s2 2 2 soil physicochemical analyses for each field trial top soil layers were sampled in 3 4 replicates on several occasions to determine soil physicochemical characteristics and soc stocks the sampling depth varied between 20 and 30 cm median 28 cm and was equal or greater than the greatest ploughing depth recorded during the study for each soil characterization several soil cores were collected and mixed together to obtain a representative composite sample particle size distribution was determined on non decarbonated soil samples using the pipette method according to nf iso 11277 soil caco3 content was quantified by a volumetric method following nf iso 10693 and soil ph was measured at a 1 5 soil water ratio nf iso 10390 soil bulk density bd was determined either by the cylinder method or the gamma radiation method blake 1965 or estimated according to the soil pedological class the determination of soil organic c soc was performed by colorimetry after sulfochromic oxidation nf iso 14235 soil organic n son was quantified following nf iso 11261 by using the kjeldahl method after sulfuric acid digestion in the later years the dry combustion method was used to determine total c and n at some sites the two different methods were shown to produce very close estimates of soc and son concentrations dimassi et al 2014 and were therefore not distinguished later the soc stock qc expressed in t c ha 1 at the considered soil depth z m was calculated as follows poeplau et al 2017 1 q c z c z b d 1 r f 10 where c is the soc content g c kg 1 bd is the bulk density of fine earth g cm 3 and r f the volumetric fraction of rock fragments 2 mm unaccounted for in the analysis 2 3 climatic data for each experimental site mean annual air temperature c and annual cumulative precipitation mm and potential evapotranspiration pet in mm penman 1948 were calculated using daily data obtained from the closest weather station the distance between the experimental sites and the weather stations varied from 0 to 55 km on average 11 km 2 4 amg model 2 4 1 model description amg is a model designed to simulate soil c dynamics at an annual time step andriulo et al 1999 saffih hdadi and mary 2008 the model considers three organic matter om compartments fresh om fom coming from crop residues or organic amendments which can be decomposed or humified and som which is divided into active c a and stable c pools c s humified fom is allocated to c a which is affected by the mineralization process c s is considered completely recalcitrant to mineralization during the prediction time 100 yrs amg can be described by this set of equations 2 q c q c s q c a 3 d q c a d t i m i h i k q c a where qc is the total soc stock t ha 1 qc a and qc s are the c stocks of the active and stable c pools t ha 1 respectively m i is the annual c input from organic residue i t ha 1 yr 1 h is its humification coefficient the fraction of c inputs which is incorporated in som after 1 year and k is the mineralization rate constant of the active c pool yr 1 the model allows simulating separately the c originating from c3 or c4 crops using 13c natural isotopic abundance measurements appendix a 2 4 2 soc pool partitioning in the default parameterization the initial proportion of the stable pool c s c 0 was set at 65 of total c for conditions of land use with a long term arable history saffih hdadi and mary 2008 in the case of arable soils with a long term grassland history c s c 0 was assumed to be lower as suggested by huggins et al 1998 and was set by default at 40 of initial soc content this value corresponding to the lower limit of optimum values found earlier for simulating soc evolutions with amg saffih hdadi and mary 2008 2 4 3 environmental functions in amgv1 the mineralization rate k of the active c pool depends on climatic conditions and soil characteristics and is calculated using environmental functions as follows 4 k a m g v 1 k 0 f t f h f a f c a c o 3 where k 0 is the potential mineralization rate yr 1 f t is a function of mean annual air temperature c and f h is a function used as a proxy to describe the effects of soil moisture f h is a function of the annual water inputs precipitation and irrigation water and pet f a and f caco 3 are reduction rate functions of clay and caco3 contents on som mineralization respectively in amgv2 we implemented the model of som mineralization recently developed for the prediction of n mineralization in arable soils clivot et al 2017 so that the mineralization rate k is calculated in this modified version following this equation 5 k a m g v 2 k 0 f t f h f a f c a c o 3 f p h f c n where f t f h f a and f caco 3 are the same functions than in amgv1 the parameter values of f a and f caco 3 differing slightly between the two versions in amgv2 the additional functions f ph and f c n describe the effects of soil ph increasing function and c n ratio gaussian function on som mineralization the soil functions f a and f caco 3 and their associated parameters in amgv1 are similar to those used in the v8 5 and earlier version of the stics model coucheney et al 2015 while those in amgv2 are corresponding to the mineralization model developed in clivot et al 2017 except the parameterization of f caco 3 which has been optimized independently using mineralized n data in chalky soils unpublished data the potential mineralization rate k 0 was the only parameter optimized with amg for the calibration of each version of the model all the functions and parameters are detailed in supplementary material appendix a 2 4 4 calculation of carbon inputs we adapted to french experimental data the approach described in bolinder et al 2007 to calculate relative annual c allocation coefficients in the different plant parts in order to estimate aboveground ag and belowground bg c inputs from crops residues plant aboveground c was calculated according to measured dry matter yield y p expressed in t ha 1 yr 1 and mean harvest index hi grain to aerial biomass including grain ratio obtained from a compilation of data from french experiments plant c in straw and stubble c s s was calculated using a c content of 0 44 g g 1 in the aboveground plant material redin et al 2014 6 c s s y p 1 h i h i 0 44 aboveground c inputs c ag depend on the fraction of c s s p s s that is returned to the soil 7 c a g p s s c s s p s s value being equal to1 when all crop residues are left in the field or lower than 1 when a part of c s s is exported p s s values were determined for the different crops in case of straw residues export p se and correspond to the fraction of c s s represented by stubble and chaff that is left to the soil p se values for the different crops are reported in table s3 for bg input estimates two c pools were calculated 1 plant c in roots c r and 2 plant c in extra root material c e which corresponds to organic matter deriving from root turnover and root exudates c r for the different crops were calculated using shoot to root ratios sr compiled in bolinder et al 2007 and completed by french experimental data assuming a c content of 0 40 g g 1 in the bg plant material boiffin et al 1986 lower than in ag crop residues buyanovsky and wagner 1986 8 c r y p s r h i 0 40 extra root c inputs were calculated following the assumption made by bolinder et al 2007 9 c e 0 65 c r in order to estimate bg inputs we used the asymptotic equation of gale and grigal 1987 to determine the cumulative bg input fraction bg f from the soil surface to a considered depth cm 10 b g f d e p t h 1 β d e p t h where β is a crop specific parameter determined using the root distributions for temperate agricultural crops reported in fan et al 2016 calculated β values are reported in table s3 the depth was set at 30 cm to calculate bg inputs c bg 11 c b g b g f 30 c r c e calculated bg inputs expressed in t c ha 1 were further corrected for site specific considered depth 20 30 cm in this study by the amg model relative annual c allocation coefficients obtained for the crops encountered in our experiments are reported in table s3 c inputs from exogenous organic matter eom were calculated according to the amount of organic amendment applied and to measured c content conversion coefficients and were expressed in t c ha 1 2 4 5 humification coefficients humification coefficients of ag crop residues were calculated as in the stics model coucheney et al 2015 using their specific average c n ratio machet et al 2017 and the functions and parameterization described in justes et al 2009 low c n ratio of crop residues promoting humification the calculated humification coefficients ranging from 0 22 for a c n ratio of 82 to 0 31 for a c n ratio of 22 for the different crops are reported in table s3 we assumed that root derived c contributed more to stored soc than the same amount of c derived from ag crop residues balesdent and balabane 1996 ghafoor et al 2017 kätterer et al 2011 we calculated a value of 0 39 for the humification coefficient of bg inputs both using the data of balesdent and balabane 1996 and kristiansen et al 2005 with 13c tracing and root incubation experiments described in justes et al 2009 it corresponds to a relative contribution of bg material to humified c 26 77 greater than that of ag residues this range is in accordance with the data compiled by rasse et al 2005 who found an average of 30 increase of humification coefficient for root compared to shoot material in incubation studies humification coefficients of diverse eoms were determined by soil incubations and inverse modeling in amg simulations performed on field experiments they were used for the parameterization of eoms applied into soils of this study humification coefficients used were 0 52 and 0 53 for bovine and pig manure respectively and 0 50 and 0 15 for bovine and pig slurry respectively bouthier et al 2014 2 5 model simulations 2 5 1 modeling steps prior to simulations of soc stock evolutions with amg model we first used random forest rf regression analysis as a mean to identify relevant variables hapfelmeier and ulm 2013 driving soc stock change rates in our experiments soc stock change rate as the response variable was calculated as the slope of the linear regression of soc stocks against time in each trial selected input variables for the rf analysis were related to climatic conditions mean annual temperature cumulative precipitation and pet soil characteristics initial soc stock soil ph c n ratio clay silt sand and caco3 contents and agricultural practices frequencies in the rotation of straw residue export bare fallow or winter cover crops and mean annual eom applications rf was run in r software version 3 3 0 r core team 2016 using the randomforest package liaw and wiener 2002 the number of trees being set to ntree 100 000 to ensure convergence while the other parameters were set to their default values the performance in predicting soc stock change rates by rf was compared with that obtained with the two model versions amgv1 and amgv2 against the database after this first step in which we analyzed soc stock change rates we focused on the simulations of soil c stocks with amg model the quality of prediction of amgv1 and amgv2 was compared to the soc evolution measured in the 60 field trials using amgv2 we evaluated the effects of alternative methods for estimating plant c inputs 2 5 2 and for setting the initial stable c pool proportion 2 5 3 we also performed a sensitivity analysis of amgv2 outputs to the different input variables see part 2 6 2 2 5 2 assessment of plant c inputs using amgv2 we evaluated the effects of alternative methods for estimating plant c inputs keel et al 2017 have pointed out the importance of the method of calculation of c inputs in modeling performance we compared three methods for estimating aboveground plant c inputs r a1 and a2 and three methods for calculating belowground crop residues b1 b3 in the reference method r detailed in part 2 4 4 fixed hi values were used to calculate aboveground c inputs cag regardless of crop yields in method a1 harvest index was calculated as a function of crop yield using coefficients from fan et al 2017 who found linear correlations between hi and crop yields and suggested that these relationships should improve estimations of crop residue inputs in cold continental climates method a2 was similar to a1 but used local coefficients for four major crops wheat winter barley maize and pea derived from french experimental data the bolinder approach was used for crop species which were not referenced by fan et al 2017 all coefficients are reported in table s4 recent studies suggested that belowground inputs cbg should be estimated regardless of crop yield or aboveground biomass using crop specific fixed values and or dependent on farming systems taghizadeh toosi et al 2016 hirte et al 2017 hu et al 2018 in the three methods b aboveground inputs c ag were calculated using the reference approach while bg input estimates c bg were fixed for each crop species in method b1 c bg was calculated for each crop as the average of all cbg estimates obtained for this crop in our database with the reference approach method b2 was similar but c bg was decreased by 50 whereas it was increased by 50 in method b3 in order to account for uncertainties on the shoot root ratio estimates which show a coefficient of variation close to 50 bolinder et al 2007 in all three methods the belowground estimates included the dead root material c r and the extra root material c e the latter being assumed to represent 65 of root material as proposed by bolinder et al 2007 the potential mineralization rate k 0 was re optimized for each method 2 5 3 assessment of the size of the stable c pool using amgv2 we compared three methods m1 m3 of parameterization of the initial stable pool fraction c s c 0 in method m1 fixed values of c s c 0 were compared with those often recommended in other models as previously performed in saffih hdadi and mary 2008 we compared three values covering the range of usually reported values 65 40 and 10 for soils with a long term arable history the proportion was reduced by 40 in soils with a long term grassland history for each parameter set the potential mineralization rate k 0 was optimized giving three different k 0 values in method m2 we tested the hypothesis that c s c 0 is not constant but rather a decreasing function of soc stock suggesting that the active c pool could be proportionally higher in soils with high soc content we evaluated this hypothesis using the following empirical function 12 c s c 0 p s e p q c 0 where qc 0 is the initial soc stock t c ha 1 the parameter p was set at one of three values 0 001 0 005 and 0 010 and the parameter p s the proportion of c s c 0 for very low soc stocks was optimized each time while k 0 was fixed at its default value in method m3 c s c 0 was optimized separately in each of the 20 sites assuming that all treatments of the same site had a similar stable c pool using each of the three values of parameter k 0 determined in method m1 2 6 model evaluation 2 6 1 statistical criteria statistical measurements of agreement between observed soc stock change rates and predictions made by the rf and amg models were performed by calculating the mean difference md simulated minus observed value the modeling efficiency ef the index of agreement d1 the root mean squared error rmse and the relative root mean squared error rrmse smith et al 1996 wallach 2006 willmott et al 1985 the average values of md and rmse obtained in each experiment were used to calibrate the potential mineralization rate k 0 which has to be optimized for each version of the model a trial and error method was applied to determine the k 0 value that allowed to minimize both criteria the same procedure was performed to determine the best values of parameters that were optimized when assessing the different c input calculation methods and when optimizing the c pool partitioning the predictive quality of amgv1 and amgv2 models was assessed by calculating the root mean squared error of prediction rmsep using leave one out cross validation stone 1974 the evaluation was carried out each time on one site excluded from the calibration of k 0 which was optimized using the data of the 19 remaining sites the mean rmsep of the 20 situations was computed to compare the predictive quality of amgv1 et amgv2 the coefficient of variation cv of measured soc stocks was used to compare the measurement error with the relative model error rrmse 2 6 2 sensitivity analysis to input variables we adapted the method conducted by poeplau 2016 for the sensitivity analysis of rothc model we analyzed the sensitivity of amgv2 outputs to a 20 increase in several variables related to c inputs crop yields aboveground and belowground c inputs and som mineralization rainfall pet initial size of the active c pool soil c n ratio clay and caco3 contents except for temperature and ph which were increased by 2 c and 1 unit respectively to this end we simulated the soc stock evolutions of reference scenarios for all 60 treatments over an extended period of 100 years we calculated for each treatment the difference in soc stocks at the end of the simulation steady state between a modified scenario increase of a variable and the reference one and analyzed the variations observed for the 60 treatments on model outputs 3 results 3 1 drivers and prediction of soc stock change rates for the 60 treatments measured soc stock changes ranged from 24 0 to 7 1 t c ha 1 between the start and the end of experiments table 1 annual soc stock change rates varied from 1 01 to 0 45 t c ha 1 yr 1 the median and mean rates were 0 08 and 0 20 t c ha 1 yr 1 respectively the linear regression made to calculate these rates is meaningful since the rmse was small 1 2 t c ha 1 compared to the mean standard deviation of measurements 2 3 t c ha 1 indicating that the general evolution of soc was more or less linear over time the distribution of soc change rates was skewed towards negative values fig 2 the interval 0 1 0 1 t c ha 1 yr 1 corresponds to the mean standard deviation of measurements and can be considered as a soc stock stability range it represented 42 of situations soc declined in 49 of situations and soc increase occurred in the remaining 10 of situations the random forest rf analysis revealed that the initial c stock was the most important variable in predicting soc stock change rate fig 3 a indeed the two variables are negatively correlated pearson r 0 59 p 0 001 the variables related to climate precipitation pet and temperature were the second most important factor followed by the management of crop residues and soil parameters clay ph and c n the remaining input variables had less importance in the rf model applied on our dataset significant correlations were found between soc stock change rate and precipitation r 0 44 p 0 001 and pet r 0 37 p 0 01 but no clear relationship was found with the other variables measured rates of soc stock change were compared with predicted rates either by the rf model fig 3b or by simulations performed by amg models amgv1 fig 3c and amgv2 fig 3d the closeness of fit to the 1 1 line shows that there was no marked bias in the predictions made by the three models md varying between 0 00 and 0 05 t c ha 1 yr 1 the range of predicted rates was narrower for rf than for measured values overall the statistical criteria revealed that amgv2 performed better in predicting soc stock change rates than rf and amgv1 showing a higher modeling efficiency ef and index of agreement d1 and a lower modeling error rmse 3 2 modeling soc stock dynamics with amg model an example of soc stock evolution and simulation performed by amgv2 on one experiment at the boigneville site is illustrated in fig 4 the model reproduced well the dynamics of total soc stocks accounting for the effects of straw residue export which led to a slight decrease in c stock between 1982 and 1994 and the change in crop rotation which occurred in 1998 it also simulated satisfactorily the evolution of c stocks originating from c3 and c4 crops particularly the decrease in c4 stock after changing the 2 year wheat maize rotation to a 4 year rotation without c4 crops the ability of amgv1 and amgv2 to predict soc stock evolution was evaluated in the 60 field treatments fig 5 fig 5a and b shows the absence of marked bias in the simulation of total soc stock with both model versions fig 5c and d shows that there was no increase in model error over time for the different c stocks simulated by both amg versions the mean modeling error was lower for amgv2 than for amgv1 rmse being respectively 2 6 and 3 2 t c ha 1 for total soc stocks the mean modeling error for c3 stocks was also smaller for amgv2 md 0 5 and rmse 2 9 t c ha 1 than for amgv1 md 1 1 and rmse 3 9 t c ha 1 the predictive quality of amgv2 was better than that of amgv1 rmsep being respectively 2 7 and 3 5 t c ha 1 for total soc stocks when estimated using a cross validation method compared to amgv1 the modified version amgv2 including the new mineralization function established on a completely independent dataset was found to improve the prediction of soc evolutions on long term experiments amgv2 was also tested on the database reported by saffih hdadi and mary 2008 we obtained a similar quality of fit than that found by these authors with the previous amg version mean rmse of 1 6 t c ha 1 for both versions all results validated the reliability of this new version which was therefore used in the following analyses 3 3 sensitivity analysis of amgv2 model the sensitivity analysis of amgv2 was conducted on steady state situations the reference scenario simulating the 60 treatments over a 100 year period predicted that the proportion of active pool c would reach an asymptotic value close to the initial value 35 of total c for situations either with no export of straw biomass or with straw removal but receiving eom applications fig s1 the proportion of active c would on average stabilize around 20 of soc for situations with systematic straw residue removal the final soc stocks simulated for this reference scenario were compared with those obtained in alternative scenarios in which one variable related to c input or som mineralization depending on climate and soil properties was increased the mean soc difference at steady state between the alternative and reference scenarios ranged from 4 1 to 2 7 t c ha 1 depending on the input variable modified fig 6 variations in crop yield had a rather marked effect on soc stocks mean 2 7 t c ha 1 and corresponded to the sum of aboveground and belowground c effects the model was particularly sensitive to changes in temperature soil ph and c n ratio whereas changes in precipitation and pet affected very little the soc stocks the largest variability between sites in model response concerned soil ph the initial size of the active c pool was also an important factor determining soc stock at steady state this emphasizes the importance of the variables with the largest uncertainty i e plant c inputs calculated from crop yields and the initial soc pool partitioning 3 4 impact of alternative methods for estimating plant c inputs we evaluated the effect of alternative methods for estimating ag and bg plant c inputs on soc modeling with amgv2 compared to the reference r table 2 method a1 which considered variable harvest indexes depending on crop yields increased slightly model error for the simulation of soil c stocks rmse being of 2 6 vs 2 8 t c ha 1 for r and a1 methods respectively method a2 which used local coefficients for calculating harvest indexes produced slightly better simulations rmse 2 7 t c ha 1 than a1 but did not improve soc simulation compared to the reference the alternative method of calculation of belowground inputs in which root biomass was assumed to be only species dependent did not affect much the quality of fit as can be seen with method b1 however when root biomass was reduced by 50 method b2 soc stock predictions were slightly improved for total soc rmse 2 5 t c ha 1 and particularly for c4 stocks for which the bias observed in the reference method disappeared conversely a 50 increase in root c input method b3 resulted in a poor quality of fit both for total soc and c4 stocks it must be noticed that the reduction of root input in method b2 is accompanied by a reduction in the potential mineralization rate k 0 which drops from 0 29 to 0 24 yr 1 3 5 impact of alternative methods for initializing the stable soc pool three alternative methods m1 m3 were assessed using amgv2 for setting the size of the initial stable soc pool table 3 method m1 compares the effects of three values for the initial stable pool proportion c s c 0 results show that decreasing c s c 0 from the default value of 0 65 for sites with long term arable history to 0 40 or 0 10 decreased the quality of fit for the simulations of total soc particularly for c3 and c4 stocks increasing both the bias and the rmse the mineralization rates k 0 optimized for each initial c s c 0 value 0 65 0 40 and 0 10 dropped from 0 29 to 0 17 and 0 11 yr 1 respectively in method m2 we tested the hypothesis that c s c 0 could be a decreasing exponential function of soc stock one parameter of this function p was fixed and the other p s was optimized this hypothesis proved to be inappropriate since model performance declined compared to the reference whatever the value of parameter p the quality of fit decreased gradually as the slope of the exponential function increased in method m3 the size of the stable c pool was supposed to be site specific the optimized mineralization rates k 0 obtained in method m1 were used as fixed parameters whereas c s c 0 was optimized for each site this assumption resulted in a decreased model error for the simulations of total soc stocks compared to the reference approach whatever the k 0 value the rmse obtained with the default k 0 value of 0 29 yr 1 was 1 8 t c ha 1 lower than those obtained for k 0 values of 0 17 and 0 11 yr 1 rmse 2 0 and 2 4 t c ha 1 respectively in addition these alternative k 0 values corresponding to low values of c s c 0 did not allow to simulate c3 and c4 stocks and generated an important bias on each stock up to 3 5 t c ha 1 the variability of c s c 0 values optimized on each site for each k 0 value is shown in fig 7 the median c s c 0 values obtained for the 20 sites 0 63 0 37 and 0 08 were close to the single values initially applied to all sites 0 65 0 40 and 0 10 the variability of c s c 0 between sites was much lower for the default value of k 0 0 29 yr 1 than for the two other settings 4 discussion 4 1 observed soc evolution in arable cropping systems the dataset considered in this study covers a period ranging from 1970 to 2015 the average being a 24 year period 1980 2003 it covers the diversity of arable cropping systems practiced in france during these years with regard to crop rotations tillage practices crop residue management n fertilization and crop yields during the more recent years an evolution towards a higher frequency of catch crop cultivation and a slight reduction in tillage operations and intensity was observed our results showed on average a slight decrease in soc stocks mean rate of change 0 20 t c ha 1 yr 1 this decrease could be attributed to the legacy effect of conversion from grass to arable land over the past 25 years with comparatively lower organic matter restitution levels in many regions the areas devoted to permanent meadows have declined regularly as exemplified in the seine normandie basin between 1971 and 2013 in north of france beaudoin et al 2018 steinmann et al 2016 observed a drastic decline under arable crops in germany between 1989 and 2015 which was also mainly attributed to grassland conversion to cropland this is consistent with other results obtained on conventional arable systems under temperate climate for example saffih hdadi and mary 2007 gathered a set of 391 agricultural fields monitored several times in picardie northern france during the 1970 1997 period and found a mean decrease rate of 0 08 t c ha 1 yr 1 in belgium goidts and van wesemael 2007 reported a decrease of 0 11 t c ha 1 yr 1 in arable crops during 50 years 1955 2005 confirmed by meersmans et al 2011 who observed a mean decrease of 0 09 t c ha 1 yr 1 from 1960 to 2006 4 2 drivers of soc dynamics the main drivers of soc dynamics identified by rf were the soil characteristics initial soc stock texture the agricultural practices residue management cover crops eom and the climate precipitation temperature the initial soc stock was a main factor as shown by the rf analysis and the negative correlation between soc change rates and the initial soc stock such a strong negative relationship was already pointed out by goidts and van wesemael 2007 zhao et al 2013 and luo et al 2017 it suggests that soils with the highest soc contents with past grassland or having received important amounts of eom were not yet at equilibrium and are still declining this is consistent with oberholzer et al 2014 who found that soc content was still declining even 60 years after the conversion of grassland to cropland post et al 2008 have pointed out the importance of an accurate determination of initial soc stock in the propagation of uncertainty in som models residue management straw removal vs retention was also an important factor identified by both rf and amg model this confirms the results obtained by saffih and mary 2008 and liu et al 2014 reducing residue removal increased soc in most wheat cropping systems studied in australia by zhao et al 2013 and luo et al 2017 the impact of climatic factors was more surprising the temperature effect was consistent between rf analysis and amg model but not precipitation which was an influent factor in rf but not in amg this apparent contradiction is due to the fact that precipitation was strongly correlated with initial soc content r 0 59 p 0 001 in fact running the rf analysis without this variable explained as much variance than with it the small sensitivity of amg model reflects the moderate range of water balance p pet varied from 290 to 595 mm yr 1 in all sites without dry situations such as described by luo et al 2017 indeed we confirmed the absence of improvement in model performance when recalibrating this function taghizadeh toosi et al 2014 also found that there was no need to account for moisture effects in the c tool model to simulate the data obtained in three ltes of northern europe finally two other soil characteristics were identified as being influent on soc evolution the c n ratio and soil ph both were identified in this study by the random forest analysis and previously as drivers of organic n mineralization for more discussion see clivot et al 2017 justifying the implementation of these variables and their effect in amgv2 the model could simulate the ltes without considering nitrogen n availability as a possible driver of soc evolution as suggested by the c n stoichiometry observed in som composition van groenigen et al 2017 this may result from the positive n surplus observed in most of our experiments but a possible limitation should be considered in other experiments particularly those receiving low n inputs 4 3 reliability of amg model the new amg version was found to better predict soc stock change rates than rf and amgv1 the general evolution of soc was found to be more or less linear over time however on the contrary to amg rf is a statistical model which cannot capture subtle changes in soc through time since rf as used in this study cannot take into account annual variations of climate and c inputs in amgv2 the implementation of two additional variables soil ph and c n ratio previously identified as drivers of som mineralization clivot et al 2017 but not considered in amgv1 slightly improved the quality of soc predictions since the relative root mean square error rrmse decreased from 6 1 for amgv1 to 5 3 for amgv2 this result was obtained with a common set of parameters for all sites without any site specific calibration this model error was only slightly greater than the mean coefficient of variation of measurements which was 4 3 furthermore the model error did not increase with time showing that there was no significant drift over time the model error is comparable to that obtained on other ltes with other models smith et al 1997 compared nine models on 7 ltes and found a rrmse varying between 6 5 and 10 for the best 6 models falloon and smith 2002 simulated 6 ltes and obtained a mean rrmse of 6 8 for century and 9 9 for rothc the ccb model franko et al 2011 evaluated on 40 sites in central europe showed a mean rrmse of 8 5 taghizadeh toosi et al 2014 evaluated the c tool model on 3 ltes in northern europe and obtained a mean rrmse of 6 1 for topsoils using the century model dimassi et al 2018 obtained a rrmse of 13 1 on a subset of our database with 6 ltes datasets including 13c natural tracing experiments with c4 and c3 plants are essential to better evaluate som models because they allow to characterize separately the decrease in old som and the increase in newly formed som balesdent 1996 the amg model was shown to simulate well the evolution of c3 and c4 stocks in the experiments which included c4 plants showing its ability to simulate the two components of soc change 4 4 uncertainties in plant c input estimates c input estimates in our study are close to those obtained in comparable climatic conditions reported by wiesmeier et al 2014 in germany for cereals 3 2 vs 3 1 t c ha 1 yr 1 and for other crops 2 7 vs 2 3 t c ha 1 yr 1 these inputs which represent annually 5 3 of soc on average include uncertainties on aboveground inputs particularly on the harvest index the model performance was little sensitive to the method of calculation the model did not perform better when using a variable hi calibrated with french references compared to the original bolinder method with a fixed hi comparing five different methods keel et al 2017 also found that the bolinder method gave the best predictions of soc evolution using the c tool model however the greatest uncertainties about c input are those relating to belowground c for root biomass estimates we found little difference in model performance when using allometric equations r or fixed biomass b1 taghizadeh toosi et al 2016 made the same comparison with the c tool model and obtained a better quality of fit when using the fixed root biomass option recent studies suggest that root biomass could be independent of aerial biomass questioning the rationale of allometric relationships hirte et al 2018 found that n fertilization rate affects the below above ground ratio of wheat and maize but does not modify the belowground c inputs komainda et al 2018 found no effect of n fertilization on root biomass and turnover in two cultivars of maize hu et al 2018 even found larger root biomass of cereals and catch crops in organic farming than in conventional systems in spite of a lower aerial biomass therefore using a fixed amount of root biomass depending on crop species only seems to be a preferable option for simulating soc evolution concerning the bg inputs our results show that model performance including the prediction of c4 stocks markedly declined when increasing bg inputs beyond the default fixed root biomass method b1 this indicates that the contribution of root and extra root material 65 of root material i e 40 of bg inputs to the humified c input is set at its maximum and could even be overestimated a similar conclusion on extra root c was drawn by poeplau 2016 with the rothc model while results from a recent field study hirte et al 2018 suggest that the proportion of rhizodeposition of total bg inputs for maize and wheat should be higher on average 55 in the topsoil for net rhizodeposition c than the widely adopted value of 40 however besides the uncertainty on the amount of extra root material deposited it should be noticed that the humification coefficient applied to this fraction in our model is equivalent to that of roots whereas root exudates are very labile substances and might contribute less to soc formation 4 5 initializing the size of the stable soc pool the sensitivity analysis indicated that the initial setting of the inert soc pool had a large impact on model outputs confirming previous studies e g puhlmann et al 2007 the site specific adjustment of soc pools gave better simulations than default parameterization since the rrmse reduced from 5 3 to 3 7 as previously observed with century and rothc models falloon and smith 2002 however the lack of information on the past land use particularly the grassland history did not allow us to calculate a more precise initial partitioning of soc between pools during the calibration phase the optimization of the size of the recalcitrant c pool either inert or having a residence time greater than 1000 years is highly dependent on the value of the potential rate constant of the active c pool because both are correlated the strong correlation between the two parameters may even result in equifinality i e leading to similar model performance for widely varying paired parameter values luo et al 2016 this was not the case with our dataset and model since the model error increased significantly particularly for the c4 stocks simulations when the initial stable pool fraction was reduced from 65 to 10 the mean value found in optimizing the site specific c s c 0 was 60 18 for sites with a long term arable history and was found to be lower i e 47 for the site with long term grassland history this result confirms the default parameterization established earlier saffih hdadi and mary 2008 chemical methods have been proposed to characterize the more stable soc fractions with a limited success helfrich et al 2007 von lützow et al 2007 combining particle size fractionation and chemical analysis was more successful in separating soc into fractions with different turnover rates poeplau et al 2018 and in matching measurable c fractions and model pools zimmermann et al 2007 herbst et al 2018 new methods such as thermal analysis are also promising they could allow identifying fractions having a residence time of about 20 years soucémarianadin et al 2018 these latter corresponding to the residence time in our experiments varying from 7 to 26 years data from long term bare fallow experiments barré et al 2010 can also be combined with thermal analysis to quantify the size of centennially persistent soc pool cécillon et al 2018 in order to better calibrate soil c models 5 conclusion the modified version of amg model including the new function of som mineralization was found to improve the prediction of soc evolution compared to the previous version the model could simulate soc stock dynamics in ltes conducted in french conventional arable systems with a mean relative model error of 5 3 the results strengthen the importance of soc pool partitioning and therefore the need of methods that would allow to measure functional c fractions to better initialize soil c model simulations the model performance appeared to be little sensitive to the method of plant c input estimation considering root c inputs independent of aerial biomass production as shown by recent studies was found to perform as well as allometric relationships suggesting that using a fixed amount of root biomass depending on crop species should be preferred in the model amg demonstrates a good potential for predicting soc evolution in scenarios varying in climate soil properties and management for conventional arable cropping systems the next objective will be to improve the ability of amg for modeling other systems such as low input or organic systems cropping systems including perennial species or permanent grasslands in order to extend the validity domain of the model to simulate contrasting agricultural systems acknowledgements we are very grateful to g briffaux b decoopman c dominiarczyk i felix a gavaland j grall d hanocq c herre j labreuche p maugrion y messmer c montagnier c morel j p prevot and e venet for their contribution to field experiments and soil analyses we thank m levert b blin f ganteuil f desheulles d jousseaume and c mametz for their contribution to the database development s cadoux and a s perrin for providing data on oleaginous and proteaginous crops f ferchaud for helpful comments on the manuscript this work was performed in partnership with the sas pivert www institut pivert com it was supported by the french government anr 001 01 and the genesys wp1 p13 solebiom project we also thank the four reviewers for their constructive evaluation of the manuscript appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 004 appendix a model description and environmental functions and parameters used in amgv1 and amgv2 models a 1 model description amg is a model designed to simulate soil c dynamics at an annual time step andriulo et al 1999 saffih hdadi and mary 2008 the model considers three organic matter om compartments fresh om fom coming from crop residues or organic amendments which can be decomposed or humified and som which is divided into active c a and stable c pools c s amg can be described by this set of equations 2 q c q c s q c a 3 d q c a d t i m i h i k q c a where qc is the total soc stock t ha 1 qc a and qc s are the c stocks of the active and stable c pools t ha 1 respectively m i is the annual c input from organic residue i t ha 1 yr 1 h is its humification coefficient and k is the mineralization rate constant of the active c pool yr 1 the model allows simulating separately the c originating from c3 or c4 crops using 13c natural isotopic abundance measurements the c stocks originating from c3 qc 3 and c4 qc 4 crops were calculated using the following equations balesdent et al 1987 s1 q c 3 δ 13 c s δ 13 c 4 δ 13 c 3 δ 13 c 4 q c s2 q c 4 δ 13 c s δ 13 c 3 δ 13 c 4 δ 13 c 3 q c where δ 13 c s is the measured 13c isotopic composition in the soil and δ 13 c 3 and δ 13 c 4 are the isotopic compositions of c3 and c4 crops in the rotation respectively the isotopic signatures defined in the model parameters for c3 and c4 residues are directly applied to their humified fractions the isotopic signatures of c3 and c4 humified plant residues were set by default at 27 5 and 12 5 of δ13c respectively these values are close to those reported for c3 and c4 plants and we assume that δ13c of som is about equal to that of plant materials from which it is derived balesdent et al 1987 the proportion of qc 4 being part of the stable c compartment at the start of the experiment pc 4s can be specified in the model or optimized to define the distribution of c originating from c4 crops between the active qc 4a and stable pools qc 4s s3 q c 4 s p c 4 s q c 4 s4 q c 4 a q c 4 q c 4 s the partitioning of c originating from c3 crops between the active qc 3a and stable pools qc 3s was therefore calculated as follows s5 q c 3 a q c a q c 4 a s6 q c 3 s q c s q c 4 s a 2 environmental functions and parameters in amgv1 and amgv2 the mineralization rate k of the active c pool is calculated using environmental functions following these equations 4 k a m g v 1 k 0 f t f h f a f c a c o 3 5 k a m g v 2 k 0 f t f h f a f c a c o 3 f p h f c n where k 0 is the potential mineralization rate in yr 1 set at 0 165 and 0 290 for amgv1 and amgv2 respectively in both amg versions f t is a function of mean annual air temperature t c s7 f t a t 1 b t exp c t t with f t 0 if t 0 s8 and b t a t 1 exp c t t r e f with a t 25 c t 0 120 k 1 and t ref 15 c f h is a function used as a proxy to describe the effects of soil moisture these effects are calculated in f h as a function of the difference between cumulative annual water inputs precipitation p and irrigation water iw and potential evapotranspiration pet in mm s9 f h 1 1 a h exp b h p p e t i w 1000 with a h 3 0 10 2 and b h 5 247 m 1 function f a and f caco 3 are describing the effects of clay a and caco3 caco 3 contents g kg 1 on som mineralization respectively s10 f a exp a m a with a m 2 720 10 3 and 2 519 10 3 g kg 1 in amgv1 and amgv2 respectively s11 f c a c o 3 1 1 c m c a c o 3 with c m 1 67 10 3 and 1 50 10 3 g kg 1 in amgv1 and amgv2 respectively in amgv2 the additional functions f ph and f c n are describing the effects of soil ph and c n ratio on som mineralization s12 f p h exp a p h p h b p h 2 with a ph 0 112 and b ph 8 5 s13 f c n 0 8 exp a c n c n b c n 2 0 2 with a cn 0 060 and b cn 11 
26199,reliable models predicting soil organic carbon soc evolution are required to better manage cropping systems with the objectives of mitigating climate change and improving soil quality in this study data from 60 selected long term field trials conducted in arable systems in france were used to evaluate a revised version of amg model integrating a new mineralization submodel the drivers of soc evolution identified using random forest analysis were consistent with those considered in amg the model with its default parameterization simulated accurately the changes in soc stocks over time the relative model error rrmse 5 3 being comparable to the measurement error cv 4 3 model performance was little affected by the choice of plant c input estimation method but was improved by a site specific optimization of soc pool partitioning amg shows a good potential for predicting soc evolution in scenarios varying in climate soil properties and crop management keywords soil organic carbon mineralization soil carbon storage carbon inputs amg model 1 introduction soils are fundamental to many provisioning and regulating ecosystem services the prediction of which requires improving our understanding of soil processes and their modeling smith et al 2015 vereecken et al 2016 in agricultural systems soil organic matter som plays a crucial role in soil structure quality and fertility for crop production tiessen et al 1994 reeves 1997 som also constitutes an important reservoir of carbon c whose dynamics can significantly impact the global c cycle heimann and reichstein 2008 soil organic carbon soc can act as a sink or source of atmospheric c and has therefore the potential of mitigating climate change by increasing c storage in agricultural soils paustian et al 1997 2016 leading to the recent 4 per mille initiative www 4p1000 org croplands which are depleted in soc compared to grasslands and forests smith 2008 poeplau et al 2011 have a great potential for c sequestration lal and bruce 1999 smith 2004 soc dynamics in arable systems is mainly driven by i c inputs into soils from crop residues and organic amendments generating newly formed som kuzyakov and domanski 2000 mandal et al 2007 maillard and angers 2014 and ii c outputs due to som decomposition and erosion the unbalance between these two opposite fluxes determines soil c decline or accumulation an accurate estimation of c inputs and the consideration of the relevant drivers of som mineralization and stabilization are therefore needed to better predict soc stock evolutions which are primarily under the influence of pedoclimatic conditions and agricultural practices stockmann et al 2013 dignac et al 2017 soc turns over slowly and variations in soc stocks can only be reliably detected on the mid or long term in most cases there is consequently a need for long term experiments ltes to calibrate and validate mathematical models able to reproduce accurately soc dynamics and reliably predict future soc evolutions numerous and various soil biogeochemical models featuring different levels of complexity have been designed to simulate soc dynamics falloon and smith 2000 manzoni and porporato 2009 campbell and paustian 2015 these models can be used to predict soc stock evolution better understand their driving factors and test methods and hypotheses regarding i estimates of plant c inputs into soils taghizadeh toosi et al 2016 keel et al 2017 and ii mineralization of som and its partitioning into functional c pools zimmermann et al 2007 herbst et al 2018 among the diversity of soil c models simple process oriented models may have some advantages compared to more complex ones or organism oriented models stockmann et al 2013 they require a lower number of input variables and have been designed to simulate soc evolutions with a reduced set of functions and parameters reflecting the main processes driving soc dynamics they can be applied to a larger number of experiments and or over longer time and spatial scales when correctly calibrated they may represent a good compromise between complexity and reliability for general applications and could be used as decision support tools to help managing soc in arable systems the aim of this study was to enhance the reliability of amg a simple model simulating soil c at annual time steps andriulo et al 1999 in predicting soc stock evolution in topsoils from arable cropping systems amg was previously shown to satisfactorily simulate the effects of straw residue export on soc in various cropping systems and pedoclimatic conditions saffih hdadi and mary 2008 and the effects of alternative arable systems autret et al 2016 it was also used as a tool for designing innovative cropping systems colnenne david and doré 2015 dufossé et al 2016 in this work we evaluated a revised version of amg in which was implemented a new model of som mineralization calibrated for the prediction of n mineralization in arable soils clivot et al 2017 we hypothesized that the main identified driving factors of soil organic n mineralization could apply for the prediction of soc mineralization due to a tight soil c and n coupling zaehle 2013 and could also improve the modeling of soc dynamics we analyzed the impact of two major sources of uncertainty in soc modeling using several methods related to i estimation of aboveground ag and belowground bg plant c inputs and ii partitioning of total soc between active and stable pools and the relevance of these methods for amg model 2 material and methods 2 1 experimental sites in a first step we compiled all the available ltes carried out in arable cropping systems in france by research teams or extension services since 1970 in which soc had been measured at several dates they represented 455 treatments spread over 53 sites we then selected the most reliable experiments by applying the following criteria number of replicates 3 number of measurement dates 3 experiment duration 8 years mean coefficient of variation of soc measurements 10 rock fragment content nil or measured the selection leads to a reduced dataset of 60 treatments located in 20 sites fig 1 covering however a large diversity of pedoclimatic conditions table s1 crop rotation types and practices table s2 representative of most french arable systems the field experiments were carried out between 1970 and 2015 lasting between 8 and 41 years median value of 22 years table 1 the mean annual temperature observed during the field trials ranged from 9 9 to 13 5 c median value of 11 0 c the annual precipitation ranged from 637 to 1285 mm median 753 mm and potential evapotranspiration from 637 to 947 mm median 721 mm the field trials exhibited contrasting soil physicochemical parameters the clay content ranged from 43 to 308 g kg 1 median 214 g kg 1 silt content from 95 to 781 g kg 1 median 528 g kg 1 sand content from 12 to 791 g kg 1 median 140 g kg 1 and caco3 content of soils varied from 0 to 781 g kg 1 median 0 g kg 1 soil ph varied between 5 6 and 8 3 median 6 8 bulk density ranged from 1 20 to 1 52 g cm 3 median 1 40 g cm 3 initial soil organic c soc stocks in the topsoils ploughed layer 0 20 to 0 30 cm varied widely from 25 to 105 t c ha 1 median 44 t c ha 1 cropping systems encountered in the 60 treatments were cereal based rotations with legumes and or oilseed crops 32 of the cropping systems grain maize winter wheat rotations 27 rotations with silage maize 23 including 3 out of 14 treatments in monoculture grain maize monocultures 10 cereals sugarbeet rotations with legumes and or rapeseed 7 and 1 treatment was a bare fallow soil winter cover crops were occasionally grown in 10 treatments 17 on 3 different sites straw residues were regularly exported in 38 of the treatments and returned to soil in 62 of them exogenous organic matters eom were applied as manure or slurry in 11 treatments 18 from 5 different sites crops were grown with conventional n rate applications providing a positive n balance in most situations seven sites included variations in p or k fertilization rate but they did not reveal major effects on yield or aboveground plant biomass production conventional tillage with full inversion ploughing was conducted in all treatments except 6 treatments from the boig site where soils were maintained under no till past land use of the investigated sites was cropland except the 5 treatments from the kerb site which were previously under sown grassland details on cropping systems can be found in table s2 2 2 soil physicochemical analyses for each field trial top soil layers were sampled in 3 4 replicates on several occasions to determine soil physicochemical characteristics and soc stocks the sampling depth varied between 20 and 30 cm median 28 cm and was equal or greater than the greatest ploughing depth recorded during the study for each soil characterization several soil cores were collected and mixed together to obtain a representative composite sample particle size distribution was determined on non decarbonated soil samples using the pipette method according to nf iso 11277 soil caco3 content was quantified by a volumetric method following nf iso 10693 and soil ph was measured at a 1 5 soil water ratio nf iso 10390 soil bulk density bd was determined either by the cylinder method or the gamma radiation method blake 1965 or estimated according to the soil pedological class the determination of soil organic c soc was performed by colorimetry after sulfochromic oxidation nf iso 14235 soil organic n son was quantified following nf iso 11261 by using the kjeldahl method after sulfuric acid digestion in the later years the dry combustion method was used to determine total c and n at some sites the two different methods were shown to produce very close estimates of soc and son concentrations dimassi et al 2014 and were therefore not distinguished later the soc stock qc expressed in t c ha 1 at the considered soil depth z m was calculated as follows poeplau et al 2017 1 q c z c z b d 1 r f 10 where c is the soc content g c kg 1 bd is the bulk density of fine earth g cm 3 and r f the volumetric fraction of rock fragments 2 mm unaccounted for in the analysis 2 3 climatic data for each experimental site mean annual air temperature c and annual cumulative precipitation mm and potential evapotranspiration pet in mm penman 1948 were calculated using daily data obtained from the closest weather station the distance between the experimental sites and the weather stations varied from 0 to 55 km on average 11 km 2 4 amg model 2 4 1 model description amg is a model designed to simulate soil c dynamics at an annual time step andriulo et al 1999 saffih hdadi and mary 2008 the model considers three organic matter om compartments fresh om fom coming from crop residues or organic amendments which can be decomposed or humified and som which is divided into active c a and stable c pools c s humified fom is allocated to c a which is affected by the mineralization process c s is considered completely recalcitrant to mineralization during the prediction time 100 yrs amg can be described by this set of equations 2 q c q c s q c a 3 d q c a d t i m i h i k q c a where qc is the total soc stock t ha 1 qc a and qc s are the c stocks of the active and stable c pools t ha 1 respectively m i is the annual c input from organic residue i t ha 1 yr 1 h is its humification coefficient the fraction of c inputs which is incorporated in som after 1 year and k is the mineralization rate constant of the active c pool yr 1 the model allows simulating separately the c originating from c3 or c4 crops using 13c natural isotopic abundance measurements appendix a 2 4 2 soc pool partitioning in the default parameterization the initial proportion of the stable pool c s c 0 was set at 65 of total c for conditions of land use with a long term arable history saffih hdadi and mary 2008 in the case of arable soils with a long term grassland history c s c 0 was assumed to be lower as suggested by huggins et al 1998 and was set by default at 40 of initial soc content this value corresponding to the lower limit of optimum values found earlier for simulating soc evolutions with amg saffih hdadi and mary 2008 2 4 3 environmental functions in amgv1 the mineralization rate k of the active c pool depends on climatic conditions and soil characteristics and is calculated using environmental functions as follows 4 k a m g v 1 k 0 f t f h f a f c a c o 3 where k 0 is the potential mineralization rate yr 1 f t is a function of mean annual air temperature c and f h is a function used as a proxy to describe the effects of soil moisture f h is a function of the annual water inputs precipitation and irrigation water and pet f a and f caco 3 are reduction rate functions of clay and caco3 contents on som mineralization respectively in amgv2 we implemented the model of som mineralization recently developed for the prediction of n mineralization in arable soils clivot et al 2017 so that the mineralization rate k is calculated in this modified version following this equation 5 k a m g v 2 k 0 f t f h f a f c a c o 3 f p h f c n where f t f h f a and f caco 3 are the same functions than in amgv1 the parameter values of f a and f caco 3 differing slightly between the two versions in amgv2 the additional functions f ph and f c n describe the effects of soil ph increasing function and c n ratio gaussian function on som mineralization the soil functions f a and f caco 3 and their associated parameters in amgv1 are similar to those used in the v8 5 and earlier version of the stics model coucheney et al 2015 while those in amgv2 are corresponding to the mineralization model developed in clivot et al 2017 except the parameterization of f caco 3 which has been optimized independently using mineralized n data in chalky soils unpublished data the potential mineralization rate k 0 was the only parameter optimized with amg for the calibration of each version of the model all the functions and parameters are detailed in supplementary material appendix a 2 4 4 calculation of carbon inputs we adapted to french experimental data the approach described in bolinder et al 2007 to calculate relative annual c allocation coefficients in the different plant parts in order to estimate aboveground ag and belowground bg c inputs from crops residues plant aboveground c was calculated according to measured dry matter yield y p expressed in t ha 1 yr 1 and mean harvest index hi grain to aerial biomass including grain ratio obtained from a compilation of data from french experiments plant c in straw and stubble c s s was calculated using a c content of 0 44 g g 1 in the aboveground plant material redin et al 2014 6 c s s y p 1 h i h i 0 44 aboveground c inputs c ag depend on the fraction of c s s p s s that is returned to the soil 7 c a g p s s c s s p s s value being equal to1 when all crop residues are left in the field or lower than 1 when a part of c s s is exported p s s values were determined for the different crops in case of straw residues export p se and correspond to the fraction of c s s represented by stubble and chaff that is left to the soil p se values for the different crops are reported in table s3 for bg input estimates two c pools were calculated 1 plant c in roots c r and 2 plant c in extra root material c e which corresponds to organic matter deriving from root turnover and root exudates c r for the different crops were calculated using shoot to root ratios sr compiled in bolinder et al 2007 and completed by french experimental data assuming a c content of 0 40 g g 1 in the bg plant material boiffin et al 1986 lower than in ag crop residues buyanovsky and wagner 1986 8 c r y p s r h i 0 40 extra root c inputs were calculated following the assumption made by bolinder et al 2007 9 c e 0 65 c r in order to estimate bg inputs we used the asymptotic equation of gale and grigal 1987 to determine the cumulative bg input fraction bg f from the soil surface to a considered depth cm 10 b g f d e p t h 1 β d e p t h where β is a crop specific parameter determined using the root distributions for temperate agricultural crops reported in fan et al 2016 calculated β values are reported in table s3 the depth was set at 30 cm to calculate bg inputs c bg 11 c b g b g f 30 c r c e calculated bg inputs expressed in t c ha 1 were further corrected for site specific considered depth 20 30 cm in this study by the amg model relative annual c allocation coefficients obtained for the crops encountered in our experiments are reported in table s3 c inputs from exogenous organic matter eom were calculated according to the amount of organic amendment applied and to measured c content conversion coefficients and were expressed in t c ha 1 2 4 5 humification coefficients humification coefficients of ag crop residues were calculated as in the stics model coucheney et al 2015 using their specific average c n ratio machet et al 2017 and the functions and parameterization described in justes et al 2009 low c n ratio of crop residues promoting humification the calculated humification coefficients ranging from 0 22 for a c n ratio of 82 to 0 31 for a c n ratio of 22 for the different crops are reported in table s3 we assumed that root derived c contributed more to stored soc than the same amount of c derived from ag crop residues balesdent and balabane 1996 ghafoor et al 2017 kätterer et al 2011 we calculated a value of 0 39 for the humification coefficient of bg inputs both using the data of balesdent and balabane 1996 and kristiansen et al 2005 with 13c tracing and root incubation experiments described in justes et al 2009 it corresponds to a relative contribution of bg material to humified c 26 77 greater than that of ag residues this range is in accordance with the data compiled by rasse et al 2005 who found an average of 30 increase of humification coefficient for root compared to shoot material in incubation studies humification coefficients of diverse eoms were determined by soil incubations and inverse modeling in amg simulations performed on field experiments they were used for the parameterization of eoms applied into soils of this study humification coefficients used were 0 52 and 0 53 for bovine and pig manure respectively and 0 50 and 0 15 for bovine and pig slurry respectively bouthier et al 2014 2 5 model simulations 2 5 1 modeling steps prior to simulations of soc stock evolutions with amg model we first used random forest rf regression analysis as a mean to identify relevant variables hapfelmeier and ulm 2013 driving soc stock change rates in our experiments soc stock change rate as the response variable was calculated as the slope of the linear regression of soc stocks against time in each trial selected input variables for the rf analysis were related to climatic conditions mean annual temperature cumulative precipitation and pet soil characteristics initial soc stock soil ph c n ratio clay silt sand and caco3 contents and agricultural practices frequencies in the rotation of straw residue export bare fallow or winter cover crops and mean annual eom applications rf was run in r software version 3 3 0 r core team 2016 using the randomforest package liaw and wiener 2002 the number of trees being set to ntree 100 000 to ensure convergence while the other parameters were set to their default values the performance in predicting soc stock change rates by rf was compared with that obtained with the two model versions amgv1 and amgv2 against the database after this first step in which we analyzed soc stock change rates we focused on the simulations of soil c stocks with amg model the quality of prediction of amgv1 and amgv2 was compared to the soc evolution measured in the 60 field trials using amgv2 we evaluated the effects of alternative methods for estimating plant c inputs 2 5 2 and for setting the initial stable c pool proportion 2 5 3 we also performed a sensitivity analysis of amgv2 outputs to the different input variables see part 2 6 2 2 5 2 assessment of plant c inputs using amgv2 we evaluated the effects of alternative methods for estimating plant c inputs keel et al 2017 have pointed out the importance of the method of calculation of c inputs in modeling performance we compared three methods for estimating aboveground plant c inputs r a1 and a2 and three methods for calculating belowground crop residues b1 b3 in the reference method r detailed in part 2 4 4 fixed hi values were used to calculate aboveground c inputs cag regardless of crop yields in method a1 harvest index was calculated as a function of crop yield using coefficients from fan et al 2017 who found linear correlations between hi and crop yields and suggested that these relationships should improve estimations of crop residue inputs in cold continental climates method a2 was similar to a1 but used local coefficients for four major crops wheat winter barley maize and pea derived from french experimental data the bolinder approach was used for crop species which were not referenced by fan et al 2017 all coefficients are reported in table s4 recent studies suggested that belowground inputs cbg should be estimated regardless of crop yield or aboveground biomass using crop specific fixed values and or dependent on farming systems taghizadeh toosi et al 2016 hirte et al 2017 hu et al 2018 in the three methods b aboveground inputs c ag were calculated using the reference approach while bg input estimates c bg were fixed for each crop species in method b1 c bg was calculated for each crop as the average of all cbg estimates obtained for this crop in our database with the reference approach method b2 was similar but c bg was decreased by 50 whereas it was increased by 50 in method b3 in order to account for uncertainties on the shoot root ratio estimates which show a coefficient of variation close to 50 bolinder et al 2007 in all three methods the belowground estimates included the dead root material c r and the extra root material c e the latter being assumed to represent 65 of root material as proposed by bolinder et al 2007 the potential mineralization rate k 0 was re optimized for each method 2 5 3 assessment of the size of the stable c pool using amgv2 we compared three methods m1 m3 of parameterization of the initial stable pool fraction c s c 0 in method m1 fixed values of c s c 0 were compared with those often recommended in other models as previously performed in saffih hdadi and mary 2008 we compared three values covering the range of usually reported values 65 40 and 10 for soils with a long term arable history the proportion was reduced by 40 in soils with a long term grassland history for each parameter set the potential mineralization rate k 0 was optimized giving three different k 0 values in method m2 we tested the hypothesis that c s c 0 is not constant but rather a decreasing function of soc stock suggesting that the active c pool could be proportionally higher in soils with high soc content we evaluated this hypothesis using the following empirical function 12 c s c 0 p s e p q c 0 where qc 0 is the initial soc stock t c ha 1 the parameter p was set at one of three values 0 001 0 005 and 0 010 and the parameter p s the proportion of c s c 0 for very low soc stocks was optimized each time while k 0 was fixed at its default value in method m3 c s c 0 was optimized separately in each of the 20 sites assuming that all treatments of the same site had a similar stable c pool using each of the three values of parameter k 0 determined in method m1 2 6 model evaluation 2 6 1 statistical criteria statistical measurements of agreement between observed soc stock change rates and predictions made by the rf and amg models were performed by calculating the mean difference md simulated minus observed value the modeling efficiency ef the index of agreement d1 the root mean squared error rmse and the relative root mean squared error rrmse smith et al 1996 wallach 2006 willmott et al 1985 the average values of md and rmse obtained in each experiment were used to calibrate the potential mineralization rate k 0 which has to be optimized for each version of the model a trial and error method was applied to determine the k 0 value that allowed to minimize both criteria the same procedure was performed to determine the best values of parameters that were optimized when assessing the different c input calculation methods and when optimizing the c pool partitioning the predictive quality of amgv1 and amgv2 models was assessed by calculating the root mean squared error of prediction rmsep using leave one out cross validation stone 1974 the evaluation was carried out each time on one site excluded from the calibration of k 0 which was optimized using the data of the 19 remaining sites the mean rmsep of the 20 situations was computed to compare the predictive quality of amgv1 et amgv2 the coefficient of variation cv of measured soc stocks was used to compare the measurement error with the relative model error rrmse 2 6 2 sensitivity analysis to input variables we adapted the method conducted by poeplau 2016 for the sensitivity analysis of rothc model we analyzed the sensitivity of amgv2 outputs to a 20 increase in several variables related to c inputs crop yields aboveground and belowground c inputs and som mineralization rainfall pet initial size of the active c pool soil c n ratio clay and caco3 contents except for temperature and ph which were increased by 2 c and 1 unit respectively to this end we simulated the soc stock evolutions of reference scenarios for all 60 treatments over an extended period of 100 years we calculated for each treatment the difference in soc stocks at the end of the simulation steady state between a modified scenario increase of a variable and the reference one and analyzed the variations observed for the 60 treatments on model outputs 3 results 3 1 drivers and prediction of soc stock change rates for the 60 treatments measured soc stock changes ranged from 24 0 to 7 1 t c ha 1 between the start and the end of experiments table 1 annual soc stock change rates varied from 1 01 to 0 45 t c ha 1 yr 1 the median and mean rates were 0 08 and 0 20 t c ha 1 yr 1 respectively the linear regression made to calculate these rates is meaningful since the rmse was small 1 2 t c ha 1 compared to the mean standard deviation of measurements 2 3 t c ha 1 indicating that the general evolution of soc was more or less linear over time the distribution of soc change rates was skewed towards negative values fig 2 the interval 0 1 0 1 t c ha 1 yr 1 corresponds to the mean standard deviation of measurements and can be considered as a soc stock stability range it represented 42 of situations soc declined in 49 of situations and soc increase occurred in the remaining 10 of situations the random forest rf analysis revealed that the initial c stock was the most important variable in predicting soc stock change rate fig 3 a indeed the two variables are negatively correlated pearson r 0 59 p 0 001 the variables related to climate precipitation pet and temperature were the second most important factor followed by the management of crop residues and soil parameters clay ph and c n the remaining input variables had less importance in the rf model applied on our dataset significant correlations were found between soc stock change rate and precipitation r 0 44 p 0 001 and pet r 0 37 p 0 01 but no clear relationship was found with the other variables measured rates of soc stock change were compared with predicted rates either by the rf model fig 3b or by simulations performed by amg models amgv1 fig 3c and amgv2 fig 3d the closeness of fit to the 1 1 line shows that there was no marked bias in the predictions made by the three models md varying between 0 00 and 0 05 t c ha 1 yr 1 the range of predicted rates was narrower for rf than for measured values overall the statistical criteria revealed that amgv2 performed better in predicting soc stock change rates than rf and amgv1 showing a higher modeling efficiency ef and index of agreement d1 and a lower modeling error rmse 3 2 modeling soc stock dynamics with amg model an example of soc stock evolution and simulation performed by amgv2 on one experiment at the boigneville site is illustrated in fig 4 the model reproduced well the dynamics of total soc stocks accounting for the effects of straw residue export which led to a slight decrease in c stock between 1982 and 1994 and the change in crop rotation which occurred in 1998 it also simulated satisfactorily the evolution of c stocks originating from c3 and c4 crops particularly the decrease in c4 stock after changing the 2 year wheat maize rotation to a 4 year rotation without c4 crops the ability of amgv1 and amgv2 to predict soc stock evolution was evaluated in the 60 field treatments fig 5 fig 5a and b shows the absence of marked bias in the simulation of total soc stock with both model versions fig 5c and d shows that there was no increase in model error over time for the different c stocks simulated by both amg versions the mean modeling error was lower for amgv2 than for amgv1 rmse being respectively 2 6 and 3 2 t c ha 1 for total soc stocks the mean modeling error for c3 stocks was also smaller for amgv2 md 0 5 and rmse 2 9 t c ha 1 than for amgv1 md 1 1 and rmse 3 9 t c ha 1 the predictive quality of amgv2 was better than that of amgv1 rmsep being respectively 2 7 and 3 5 t c ha 1 for total soc stocks when estimated using a cross validation method compared to amgv1 the modified version amgv2 including the new mineralization function established on a completely independent dataset was found to improve the prediction of soc evolutions on long term experiments amgv2 was also tested on the database reported by saffih hdadi and mary 2008 we obtained a similar quality of fit than that found by these authors with the previous amg version mean rmse of 1 6 t c ha 1 for both versions all results validated the reliability of this new version which was therefore used in the following analyses 3 3 sensitivity analysis of amgv2 model the sensitivity analysis of amgv2 was conducted on steady state situations the reference scenario simulating the 60 treatments over a 100 year period predicted that the proportion of active pool c would reach an asymptotic value close to the initial value 35 of total c for situations either with no export of straw biomass or with straw removal but receiving eom applications fig s1 the proportion of active c would on average stabilize around 20 of soc for situations with systematic straw residue removal the final soc stocks simulated for this reference scenario were compared with those obtained in alternative scenarios in which one variable related to c input or som mineralization depending on climate and soil properties was increased the mean soc difference at steady state between the alternative and reference scenarios ranged from 4 1 to 2 7 t c ha 1 depending on the input variable modified fig 6 variations in crop yield had a rather marked effect on soc stocks mean 2 7 t c ha 1 and corresponded to the sum of aboveground and belowground c effects the model was particularly sensitive to changes in temperature soil ph and c n ratio whereas changes in precipitation and pet affected very little the soc stocks the largest variability between sites in model response concerned soil ph the initial size of the active c pool was also an important factor determining soc stock at steady state this emphasizes the importance of the variables with the largest uncertainty i e plant c inputs calculated from crop yields and the initial soc pool partitioning 3 4 impact of alternative methods for estimating plant c inputs we evaluated the effect of alternative methods for estimating ag and bg plant c inputs on soc modeling with amgv2 compared to the reference r table 2 method a1 which considered variable harvest indexes depending on crop yields increased slightly model error for the simulation of soil c stocks rmse being of 2 6 vs 2 8 t c ha 1 for r and a1 methods respectively method a2 which used local coefficients for calculating harvest indexes produced slightly better simulations rmse 2 7 t c ha 1 than a1 but did not improve soc simulation compared to the reference the alternative method of calculation of belowground inputs in which root biomass was assumed to be only species dependent did not affect much the quality of fit as can be seen with method b1 however when root biomass was reduced by 50 method b2 soc stock predictions were slightly improved for total soc rmse 2 5 t c ha 1 and particularly for c4 stocks for which the bias observed in the reference method disappeared conversely a 50 increase in root c input method b3 resulted in a poor quality of fit both for total soc and c4 stocks it must be noticed that the reduction of root input in method b2 is accompanied by a reduction in the potential mineralization rate k 0 which drops from 0 29 to 0 24 yr 1 3 5 impact of alternative methods for initializing the stable soc pool three alternative methods m1 m3 were assessed using amgv2 for setting the size of the initial stable soc pool table 3 method m1 compares the effects of three values for the initial stable pool proportion c s c 0 results show that decreasing c s c 0 from the default value of 0 65 for sites with long term arable history to 0 40 or 0 10 decreased the quality of fit for the simulations of total soc particularly for c3 and c4 stocks increasing both the bias and the rmse the mineralization rates k 0 optimized for each initial c s c 0 value 0 65 0 40 and 0 10 dropped from 0 29 to 0 17 and 0 11 yr 1 respectively in method m2 we tested the hypothesis that c s c 0 could be a decreasing exponential function of soc stock one parameter of this function p was fixed and the other p s was optimized this hypothesis proved to be inappropriate since model performance declined compared to the reference whatever the value of parameter p the quality of fit decreased gradually as the slope of the exponential function increased in method m3 the size of the stable c pool was supposed to be site specific the optimized mineralization rates k 0 obtained in method m1 were used as fixed parameters whereas c s c 0 was optimized for each site this assumption resulted in a decreased model error for the simulations of total soc stocks compared to the reference approach whatever the k 0 value the rmse obtained with the default k 0 value of 0 29 yr 1 was 1 8 t c ha 1 lower than those obtained for k 0 values of 0 17 and 0 11 yr 1 rmse 2 0 and 2 4 t c ha 1 respectively in addition these alternative k 0 values corresponding to low values of c s c 0 did not allow to simulate c3 and c4 stocks and generated an important bias on each stock up to 3 5 t c ha 1 the variability of c s c 0 values optimized on each site for each k 0 value is shown in fig 7 the median c s c 0 values obtained for the 20 sites 0 63 0 37 and 0 08 were close to the single values initially applied to all sites 0 65 0 40 and 0 10 the variability of c s c 0 between sites was much lower for the default value of k 0 0 29 yr 1 than for the two other settings 4 discussion 4 1 observed soc evolution in arable cropping systems the dataset considered in this study covers a period ranging from 1970 to 2015 the average being a 24 year period 1980 2003 it covers the diversity of arable cropping systems practiced in france during these years with regard to crop rotations tillage practices crop residue management n fertilization and crop yields during the more recent years an evolution towards a higher frequency of catch crop cultivation and a slight reduction in tillage operations and intensity was observed our results showed on average a slight decrease in soc stocks mean rate of change 0 20 t c ha 1 yr 1 this decrease could be attributed to the legacy effect of conversion from grass to arable land over the past 25 years with comparatively lower organic matter restitution levels in many regions the areas devoted to permanent meadows have declined regularly as exemplified in the seine normandie basin between 1971 and 2013 in north of france beaudoin et al 2018 steinmann et al 2016 observed a drastic decline under arable crops in germany between 1989 and 2015 which was also mainly attributed to grassland conversion to cropland this is consistent with other results obtained on conventional arable systems under temperate climate for example saffih hdadi and mary 2007 gathered a set of 391 agricultural fields monitored several times in picardie northern france during the 1970 1997 period and found a mean decrease rate of 0 08 t c ha 1 yr 1 in belgium goidts and van wesemael 2007 reported a decrease of 0 11 t c ha 1 yr 1 in arable crops during 50 years 1955 2005 confirmed by meersmans et al 2011 who observed a mean decrease of 0 09 t c ha 1 yr 1 from 1960 to 2006 4 2 drivers of soc dynamics the main drivers of soc dynamics identified by rf were the soil characteristics initial soc stock texture the agricultural practices residue management cover crops eom and the climate precipitation temperature the initial soc stock was a main factor as shown by the rf analysis and the negative correlation between soc change rates and the initial soc stock such a strong negative relationship was already pointed out by goidts and van wesemael 2007 zhao et al 2013 and luo et al 2017 it suggests that soils with the highest soc contents with past grassland or having received important amounts of eom were not yet at equilibrium and are still declining this is consistent with oberholzer et al 2014 who found that soc content was still declining even 60 years after the conversion of grassland to cropland post et al 2008 have pointed out the importance of an accurate determination of initial soc stock in the propagation of uncertainty in som models residue management straw removal vs retention was also an important factor identified by both rf and amg model this confirms the results obtained by saffih and mary 2008 and liu et al 2014 reducing residue removal increased soc in most wheat cropping systems studied in australia by zhao et al 2013 and luo et al 2017 the impact of climatic factors was more surprising the temperature effect was consistent between rf analysis and amg model but not precipitation which was an influent factor in rf but not in amg this apparent contradiction is due to the fact that precipitation was strongly correlated with initial soc content r 0 59 p 0 001 in fact running the rf analysis without this variable explained as much variance than with it the small sensitivity of amg model reflects the moderate range of water balance p pet varied from 290 to 595 mm yr 1 in all sites without dry situations such as described by luo et al 2017 indeed we confirmed the absence of improvement in model performance when recalibrating this function taghizadeh toosi et al 2014 also found that there was no need to account for moisture effects in the c tool model to simulate the data obtained in three ltes of northern europe finally two other soil characteristics were identified as being influent on soc evolution the c n ratio and soil ph both were identified in this study by the random forest analysis and previously as drivers of organic n mineralization for more discussion see clivot et al 2017 justifying the implementation of these variables and their effect in amgv2 the model could simulate the ltes without considering nitrogen n availability as a possible driver of soc evolution as suggested by the c n stoichiometry observed in som composition van groenigen et al 2017 this may result from the positive n surplus observed in most of our experiments but a possible limitation should be considered in other experiments particularly those receiving low n inputs 4 3 reliability of amg model the new amg version was found to better predict soc stock change rates than rf and amgv1 the general evolution of soc was found to be more or less linear over time however on the contrary to amg rf is a statistical model which cannot capture subtle changes in soc through time since rf as used in this study cannot take into account annual variations of climate and c inputs in amgv2 the implementation of two additional variables soil ph and c n ratio previously identified as drivers of som mineralization clivot et al 2017 but not considered in amgv1 slightly improved the quality of soc predictions since the relative root mean square error rrmse decreased from 6 1 for amgv1 to 5 3 for amgv2 this result was obtained with a common set of parameters for all sites without any site specific calibration this model error was only slightly greater than the mean coefficient of variation of measurements which was 4 3 furthermore the model error did not increase with time showing that there was no significant drift over time the model error is comparable to that obtained on other ltes with other models smith et al 1997 compared nine models on 7 ltes and found a rrmse varying between 6 5 and 10 for the best 6 models falloon and smith 2002 simulated 6 ltes and obtained a mean rrmse of 6 8 for century and 9 9 for rothc the ccb model franko et al 2011 evaluated on 40 sites in central europe showed a mean rrmse of 8 5 taghizadeh toosi et al 2014 evaluated the c tool model on 3 ltes in northern europe and obtained a mean rrmse of 6 1 for topsoils using the century model dimassi et al 2018 obtained a rrmse of 13 1 on a subset of our database with 6 ltes datasets including 13c natural tracing experiments with c4 and c3 plants are essential to better evaluate som models because they allow to characterize separately the decrease in old som and the increase in newly formed som balesdent 1996 the amg model was shown to simulate well the evolution of c3 and c4 stocks in the experiments which included c4 plants showing its ability to simulate the two components of soc change 4 4 uncertainties in plant c input estimates c input estimates in our study are close to those obtained in comparable climatic conditions reported by wiesmeier et al 2014 in germany for cereals 3 2 vs 3 1 t c ha 1 yr 1 and for other crops 2 7 vs 2 3 t c ha 1 yr 1 these inputs which represent annually 5 3 of soc on average include uncertainties on aboveground inputs particularly on the harvest index the model performance was little sensitive to the method of calculation the model did not perform better when using a variable hi calibrated with french references compared to the original bolinder method with a fixed hi comparing five different methods keel et al 2017 also found that the bolinder method gave the best predictions of soc evolution using the c tool model however the greatest uncertainties about c input are those relating to belowground c for root biomass estimates we found little difference in model performance when using allometric equations r or fixed biomass b1 taghizadeh toosi et al 2016 made the same comparison with the c tool model and obtained a better quality of fit when using the fixed root biomass option recent studies suggest that root biomass could be independent of aerial biomass questioning the rationale of allometric relationships hirte et al 2018 found that n fertilization rate affects the below above ground ratio of wheat and maize but does not modify the belowground c inputs komainda et al 2018 found no effect of n fertilization on root biomass and turnover in two cultivars of maize hu et al 2018 even found larger root biomass of cereals and catch crops in organic farming than in conventional systems in spite of a lower aerial biomass therefore using a fixed amount of root biomass depending on crop species only seems to be a preferable option for simulating soc evolution concerning the bg inputs our results show that model performance including the prediction of c4 stocks markedly declined when increasing bg inputs beyond the default fixed root biomass method b1 this indicates that the contribution of root and extra root material 65 of root material i e 40 of bg inputs to the humified c input is set at its maximum and could even be overestimated a similar conclusion on extra root c was drawn by poeplau 2016 with the rothc model while results from a recent field study hirte et al 2018 suggest that the proportion of rhizodeposition of total bg inputs for maize and wheat should be higher on average 55 in the topsoil for net rhizodeposition c than the widely adopted value of 40 however besides the uncertainty on the amount of extra root material deposited it should be noticed that the humification coefficient applied to this fraction in our model is equivalent to that of roots whereas root exudates are very labile substances and might contribute less to soc formation 4 5 initializing the size of the stable soc pool the sensitivity analysis indicated that the initial setting of the inert soc pool had a large impact on model outputs confirming previous studies e g puhlmann et al 2007 the site specific adjustment of soc pools gave better simulations than default parameterization since the rrmse reduced from 5 3 to 3 7 as previously observed with century and rothc models falloon and smith 2002 however the lack of information on the past land use particularly the grassland history did not allow us to calculate a more precise initial partitioning of soc between pools during the calibration phase the optimization of the size of the recalcitrant c pool either inert or having a residence time greater than 1000 years is highly dependent on the value of the potential rate constant of the active c pool because both are correlated the strong correlation between the two parameters may even result in equifinality i e leading to similar model performance for widely varying paired parameter values luo et al 2016 this was not the case with our dataset and model since the model error increased significantly particularly for the c4 stocks simulations when the initial stable pool fraction was reduced from 65 to 10 the mean value found in optimizing the site specific c s c 0 was 60 18 for sites with a long term arable history and was found to be lower i e 47 for the site with long term grassland history this result confirms the default parameterization established earlier saffih hdadi and mary 2008 chemical methods have been proposed to characterize the more stable soc fractions with a limited success helfrich et al 2007 von lützow et al 2007 combining particle size fractionation and chemical analysis was more successful in separating soc into fractions with different turnover rates poeplau et al 2018 and in matching measurable c fractions and model pools zimmermann et al 2007 herbst et al 2018 new methods such as thermal analysis are also promising they could allow identifying fractions having a residence time of about 20 years soucémarianadin et al 2018 these latter corresponding to the residence time in our experiments varying from 7 to 26 years data from long term bare fallow experiments barré et al 2010 can also be combined with thermal analysis to quantify the size of centennially persistent soc pool cécillon et al 2018 in order to better calibrate soil c models 5 conclusion the modified version of amg model including the new function of som mineralization was found to improve the prediction of soc evolution compared to the previous version the model could simulate soc stock dynamics in ltes conducted in french conventional arable systems with a mean relative model error of 5 3 the results strengthen the importance of soc pool partitioning and therefore the need of methods that would allow to measure functional c fractions to better initialize soil c model simulations the model performance appeared to be little sensitive to the method of plant c input estimation considering root c inputs independent of aerial biomass production as shown by recent studies was found to perform as well as allometric relationships suggesting that using a fixed amount of root biomass depending on crop species should be preferred in the model amg demonstrates a good potential for predicting soc evolution in scenarios varying in climate soil properties and management for conventional arable cropping systems the next objective will be to improve the ability of amg for modeling other systems such as low input or organic systems cropping systems including perennial species or permanent grasslands in order to extend the validity domain of the model to simulate contrasting agricultural systems acknowledgements we are very grateful to g briffaux b decoopman c dominiarczyk i felix a gavaland j grall d hanocq c herre j labreuche p maugrion y messmer c montagnier c morel j p prevot and e venet for their contribution to field experiments and soil analyses we thank m levert b blin f ganteuil f desheulles d jousseaume and c mametz for their contribution to the database development s cadoux and a s perrin for providing data on oleaginous and proteaginous crops f ferchaud for helpful comments on the manuscript this work was performed in partnership with the sas pivert www institut pivert com it was supported by the french government anr 001 01 and the genesys wp1 p13 solebiom project we also thank the four reviewers for their constructive evaluation of the manuscript appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2019 04 004 appendix a model description and environmental functions and parameters used in amgv1 and amgv2 models a 1 model description amg is a model designed to simulate soil c dynamics at an annual time step andriulo et al 1999 saffih hdadi and mary 2008 the model considers three organic matter om compartments fresh om fom coming from crop residues or organic amendments which can be decomposed or humified and som which is divided into active c a and stable c pools c s amg can be described by this set of equations 2 q c q c s q c a 3 d q c a d t i m i h i k q c a where qc is the total soc stock t ha 1 qc a and qc s are the c stocks of the active and stable c pools t ha 1 respectively m i is the annual c input from organic residue i t ha 1 yr 1 h is its humification coefficient and k is the mineralization rate constant of the active c pool yr 1 the model allows simulating separately the c originating from c3 or c4 crops using 13c natural isotopic abundance measurements the c stocks originating from c3 qc 3 and c4 qc 4 crops were calculated using the following equations balesdent et al 1987 s1 q c 3 δ 13 c s δ 13 c 4 δ 13 c 3 δ 13 c 4 q c s2 q c 4 δ 13 c s δ 13 c 3 δ 13 c 4 δ 13 c 3 q c where δ 13 c s is the measured 13c isotopic composition in the soil and δ 13 c 3 and δ 13 c 4 are the isotopic compositions of c3 and c4 crops in the rotation respectively the isotopic signatures defined in the model parameters for c3 and c4 residues are directly applied to their humified fractions the isotopic signatures of c3 and c4 humified plant residues were set by default at 27 5 and 12 5 of δ13c respectively these values are close to those reported for c3 and c4 plants and we assume that δ13c of som is about equal to that of plant materials from which it is derived balesdent et al 1987 the proportion of qc 4 being part of the stable c compartment at the start of the experiment pc 4s can be specified in the model or optimized to define the distribution of c originating from c4 crops between the active qc 4a and stable pools qc 4s s3 q c 4 s p c 4 s q c 4 s4 q c 4 a q c 4 q c 4 s the partitioning of c originating from c3 crops between the active qc 3a and stable pools qc 3s was therefore calculated as follows s5 q c 3 a q c a q c 4 a s6 q c 3 s q c s q c 4 s a 2 environmental functions and parameters in amgv1 and amgv2 the mineralization rate k of the active c pool is calculated using environmental functions following these equations 4 k a m g v 1 k 0 f t f h f a f c a c o 3 5 k a m g v 2 k 0 f t f h f a f c a c o 3 f p h f c n where k 0 is the potential mineralization rate in yr 1 set at 0 165 and 0 290 for amgv1 and amgv2 respectively in both amg versions f t is a function of mean annual air temperature t c s7 f t a t 1 b t exp c t t with f t 0 if t 0 s8 and b t a t 1 exp c t t r e f with a t 25 c t 0 120 k 1 and t ref 15 c f h is a function used as a proxy to describe the effects of soil moisture these effects are calculated in f h as a function of the difference between cumulative annual water inputs precipitation p and irrigation water iw and potential evapotranspiration pet in mm s9 f h 1 1 a h exp b h p p e t i w 1000 with a h 3 0 10 2 and b h 5 247 m 1 function f a and f caco 3 are describing the effects of clay a and caco3 caco 3 contents g kg 1 on som mineralization respectively s10 f a exp a m a with a m 2 720 10 3 and 2 519 10 3 g kg 1 in amgv1 and amgv2 respectively s11 f c a c o 3 1 1 c m c a c o 3 with c m 1 67 10 3 and 1 50 10 3 g kg 1 in amgv1 and amgv2 respectively in amgv2 the additional functions f ph and f c n are describing the effects of soil ph and c n ratio on som mineralization s12 f p h exp a p h p h b p h 2 with a ph 0 112 and b ph 8 5 s13 f c n 0 8 exp a c n c n b c n 2 0 2 with a cn 0 060 and b cn 11 
