index,text
4105,seawater intrusion swi is becoming one of the major environmental issues in more and more coastal areas around the world understanding the current swi situation and forming research consensus are of great significance for further studies and coastal water resources management in this study we analyzed the swi associated literature available from the science of citation index expanded scie bibliographic database by using citespace to further excavate existing research achievement we explored a new method for identifying global geographic distributions of 501 coastal cities where swi has been reported it can be found that swi is more likely to occur in well recharged major basins recharge rate 100 300 mm a or local shallow aquifers with high population density according to current reports about 32 of the coastal metropolitan cities population 1 million within 150 km from coastline have been threatened there was a 20 fold increase rate in the number of papers related to swi compared to that in general science and technology the united states of america china australia were the top 3 contributors in swi scope contributed 46 4 of the total number of articles more than 600 researches were supported by chinese funds which made china become the second contributor but the number of citations per chinese article was the lowest among the top 10 contributors by co citation analysis we identified top 5 articles and elaborated the background knowledge by taking top 10 co cited articles as example a series of keywords with high co occurrence were identified their meanings and relations were stated and graphically illustrated as a keyword swi frequently appears in the following five research directions analysis of the location or morphology of fresh and salt water interface the prediction of groundwater quality the geothermal circulation and tectonic activities the coastal mangrove wetlands protection and the management of water resources in coastal zones we critically evaluated the bibliometric results and reviewed future opportunities and challenges for this field with the development of new technology and the accumulation the improvement of coastal environment will certainly benefit from the study of swi keywords citespace coastal zone seawater intrusion coastal groundwater bibliometrics 1 introduction coastal zone is a transitional zone between ocean and land which plays a unique ecological role on linking marine and terrestrial hydrological ecosystems ferguson and gleeson 2012 about 40 of the world s population lives within 100 km from the coastline un 2017 with the intensification of climate change and human activities the water resource security has been an acute problem in coastal zones rahman et al 2017 seawater intrusion or saltwater intrusion swi has become one of the main threats to the safety of freshwater supply in coastal zones white et al 2007 swi currently threatens more than 100 countries and regions around the world including the nile delta the mekong delta east and south asia the mediterranean area and north america barlow and reichard 2010 abd elhamid et al 2016 han and currell 2018 vu et al 2018 palacios et al 2020 swi refers to the subsurface migration of seawater into fresh aquifers which mainly caused by excessive groundwater exploitation and also involved in rising sea levels and changing climates werner et al 2013 swi can be distinguished by the significant high total dissolved solids tds which caused by enrichment solutes in seawater such as chloride or sodium seenipandi et al 2019 as early as a century ago classical ghyben herzberg formula had been proposed to quantitatively study the relationship between brackish and fresh groundwater in coastal zones drabbe and ghyben 1889 herzberg 1901 verruijt 1968 it was widely used to determine the location of fresh saline water interface controlled by the unconfined groundwater level then hubbert 1940 and bear 1979 put forward a strict mathematical description for the limitations of this formula post et al 2018 from then on researchers have been trying to characterize the saltwater wedge shape and measure the degree of groundwater salinization as a significant symbol of swi researches bear et al 1999 addressed the variable density and hydrodynamic dispersion problem nowadays a complex swi research system has formed and extended to many specific branches such as coastal water management strategy groundwater resource protection submarine groundwater discharge sgd field monitoring technologies hydrochemical and isotopic issues and numerical simulation the swi process has also been increasingly recognized especially the surface and ground water interaction and seawater induction are now considered to have significant effects on groundwater salinization ferguson and gleeson 2012 cao et al 2020 the research methods include but are not limited to field investigation laboratory experiments analytical solution and numerical simulations after years of geological survey and environmental monitoring swi researches accumulated massive information on a global scale and applied numerous new technology a concern for researchers has come up that is to find hot topics and to distinguish potential breakthrough directions post 2005 mabrouk et al 2013 hussain et al 2019 bibliometric is one of statistical methods for analyzing the impact of research outputs from literature in recent years many forms of software have been developed which bring more and more bibliometric application in different research scopes leydesdorff and bihui 2005 garfield 2009 in the field of ecology and hydrology bibliometric method has been used to investigate advance in various topics such as global groundwater research niu et al 2014 stable isotope of precipitation research wei et al 2019 urban development and ecological safety research qing 2015 and global research in sustainable development hassan et al 2014 the analysis of research status and the prediction of research hotspots can play a guiding role on further research compared with the traditional methods of literature review bibliometrics can allow scholars to quickly understand the target research field and identify the basic knowledge in the field knowledge of the discipline s history which might have to take years of exploration in the past is now relatively concise as a common tool in literature metrology citespace is a literature statistic and visualization software developed by dr chaomei chen from drexel university based on java platform chen 2006 citespace can be used to map knowledge of specific science and technology fields according to the citation information of the scientific literature intuitively presenting the information panorama in the scientific field and identifying the key article potential research hotspots and frontier directions chen 2006 the co citation analysis by the citespace can generate and visualize the co citation network from the set equal time interval slices quantitatively and visually judge the key work and breakthrough progress in the research field through the pivotal points turning points and other characteristics of the co citation network chen 2004 highly co cited papers can be regarded as a weathervane of academic development in a research field interdisciplinary researchers can conveniently establish coherence of ideas and constructs with other participants in a target discipline by strategically selecting high co citation information trujillo and long 2018 co citation analysis transforms the cognitive process which originally requires a lot of knowledge accumulation and rich field experience into the recognition and search of the structure interaction intersection and evolution of the visual co citation network so as to accelerate the researchers cognition of the field and promote the development of the field chen et al 2015 a large number of studies have verified the reliability of the convincing results of citespace chen 2006 chen et al 2010 meanwhile citespace based literature measurement is also limited by the ability of searching and statistics the results obtained by semantic analysis are sometimes fragmented and need to be identified with professional knowledge at present there have been many outstanding reviews on the situation identification mechanism and management of swi mabrouk et al 2013 werner et al 2013 shi and jiao 2014 ketabchi et al 2016 parizi et al 2019 however the vast amount of information still has the potential to be quantitatively exploited further this study aims to introduce the cognitive background and the opportunity of global swi researches based on the bibliometric analyses the objectives of this study are to i introduce a method to compile and map the distribution of reported swi cities and analyze its relationship with aquifer recharge condition and local population ii identify the development characteristic of swi research and evaluate national research outputs iii summarize the background knowledge research trend and hot issues and iv analyze research opportunities and challenges according to the keyword clustering 2 method and data sources science of citation index expanded scie bibliographic database was used as a retrieval source although scie database is only a part of human innovation it is highly reliable because all published articles have undergone rigorous peer review and almost all the bibliometric analysis will consider this database hence the scie database has been a metric of scientific accomplishment in most fields of human creativity kostoff et al 2000 li et al 2009 to ensure the retrieved data were as comprehensive and focus as possible the terms seawater intrusion and saltwater intrusion were used any literature that contained these words in title keyword lists or abstracts was recorded the retrieval period was 1970 2019 recorded literature was exported with title author abstract key words and references information to organize the local database the literature data were last updated on january 2 2020 the data retrieval method of annual total subjects publication volume was the same but the keyword retrieval can be changed to search by years of publication the co occurrence analysis including co word co occurrence of keywords and co citation co occurrence of references and authors was implemented by the citespace 5 5 r2 the time slice was set as 3 years and data selection criteria was top 50 which means only the top 50 of most cited or occurred items from each slice were selected for analysis the locations of existing study areas were obtained by matching the city names globally with the title or abstract database formed by 4 252 article this process was conducted by jupyterlab based on python all world cities names appearing in the title or abstract database were recorded then cities more than 150 km from the shoreline were excluded by using arcgis 10 2 due to the complex composition of cities names it is still necessary to do manual screening for the remaining cities after the above mentioned processing fig s1 3 results and discussion 3 1 research outputs trend related disciplines and study area identification according to the citation analysis report from 1970 to 2019 more than 59 000 000 papers collected by web of science wos core database the general science and technology takes only 50 years to develop from publishing 342 773 articles 1970 a year to 2 852 866 articles 2019 fig 1 in an age of information explosion the study related to swi is a little more than a speck at the foot of the knowledge mountain for individuals however 4252 article in the target field which have been cited 73 505 times were still difficult to traverse after de duplicated by the citespace 4160 articles were obtained with 115 610 references in the retrieval period from january 1970 to january 2020 fig 1 as can be seen from fig 1 the number of published papers and the citation frequency on swi field have been dramatically increased in recent years since the early studies on swi were sporadic in the retrieval period the number of the published papers in the recent 10 years 2010 2019 is 100 times that in 1970 1980 and the amount of published papers in the past10 years accounted for 65 in the past50 years in contrast the publication volume of general science and technology in the past 10 years is only 5 times that of 1970 1980 this rapid growth which goes beyond general technological developments is dominated by several factors firstly on the demand side with the rapidly economic development and population growth more and more environmental problems e g groundwater depletion land subsidence water pollution appear in coastal areas konikow and kendy 2005 ferguson and gleeson 2012 the increasing demand for freshwater resources has resulted in groundwater over exploitation following by the occurrence of swi secondly the research on swi has been further deepened with the exploration of new technologies especially the application of isotopic and geophysical methods supplement of high precision data on larger spatial and temporal scales the swi processes have been further understood beaujean et al 2014 xiong et al 2018 al rahbi et al 2020 swi related studies involve wide ranges of disciplines which are often mutually contained and interrelated fig 2 swi can be affected by multiple factors including vertical leaching caused by inundation subsurface lateral intrusion sea level rise slr tidal fluctuation geological structures and human activities technically swi study requires coordination and application of different technical means including the physical chemical and biological methods sylus and ramesh 2013 the wide range of disciplines brings both challenges and opportunities to the swi study during the retrieval period the earliest swirelated paper described the morphological distribution of the saltwater interface in the stratified aquifer and provided the analytical solution under steady state öztürk 1970 collins and gelhar 1971 it exhibits the initial phase of swi researches which focused on solving the mathematical problems of location and morphology of fresh salt water interface in specific conceptual models with the help of web of science built in analysis tools the most cited article svensen et al 2004 in the whole download literatures reported that mantle derived material intruded into carbon rich deposits in the northeast atlantic resulting in the explosive release of methane further led to extreme global warming that triggered the eocene werner et al 2013 reviewed the current situation and challenges of swi problem ranking second in the list of highly cited articles the third list describes the impact of climate change on coastal areas and the impact of these factors on the seagrass growth and ecological effects short and neckles 1999 but these high citations are based on the global bibliographic library not the specific field of swi these articles are widely accepted work related to swi but should not be directly considered as the backbone of swi or intensive discussed topics the recognition of core literature on a specific scope depends on the co citation of citespace white et al 2004 by the end of 2019 swi had been reported in at least 501 cities worldwide fig 3 it can be obtained by matching the global city database and the database composed by titles and abstracts of swi related literature since researchers rarely mention other locations outside the target study area in the abstract and title this result can be considered as the location of global swi hazards compared with the traditional literature review method this bibliometric method can greatly improve the accuracy and comprehensiveness of the research area distribution based on the identified locations of swi we can explore the geographical characteristics of this hazard in more detail globally about 30 cities with swi crisis are distributed in local shallow aquifers fig 4 this is partly influenced by aquifer capacity which tends to be low in local and shallow aquifers on the other hand about 28 cities with swi crisis are distributed in major groundwater basins with relatively good recharge conditions 100 300 mm a most of these cities are densely populated areas it suggests that on a global scale the large demand for fresh water in populated areas is one of the main inducements for swi meanwhile swi remains a serious problem for metropolitan cities of the 501 cities that have reported swi 108 cities have population more than one million occupied 22 there are only 333 cities with a population of more than one million within 150 km from the shoreline which means that at least 32 of the world s coastal metropolitan cities are suffering from swi crisis fig 5 however the proportion is only 2 for cities with population less than 50 000 this difference further emphasizes the decisive influence of population and socio economic development on swi table s1 3 2 distribution and cooperation of research power according to the collected literature scholars interested in swi were widely distributed in more than 100 countries and regions the top 10 countries for total published articles are shown in table 1 because an article may contain authors from different countries regions the records of published papers by country region will exceed the total number of published papers the number of published papers can be regarded as a measure of a country s research strength from 1970 to 2019 the united states published the most articles in the swi scope with a total of 1017 papers accounting for 23 9 of the entire publications china ranked second with 628 published articles which account for 14 8 of the total number of publications australia was in third place with 328 publications accounting for 7 7 the following sequences are italy india germany france spain japan canada etc table 1 these countries all have advanced scientific research competitiveness and have important coastal cities or economic zones facing the swi threat in addition a cooperation analysis between countries was also conducted fig 6 shows the number of published papers and cooperation relationships between major research countries and regions cooperation is defined as the authors addresses in two or more countries or regions appearing simultaneously in a single article the close connection between each node indicates frequent exchanges and extensive sharing and cooperation between various countries in the world the purple circle outside the country s name indicates that the country has a high centrality fig 6 this exhibits that these countries are the core nodes of international cooperation these countries e g the united states and australia can be considered to play a leading role in international cooperation in the swi field among the top 10 contributors china india japan and canada are still relatively passive in international cooperation fund is one of the basic supports for scientific researches the national natural science foundation of china ranked first as a single institution with outputs of 330 papers it is followed by 139 studies funded by the u s national science foundation and 64 by the european union the fund output relationship can reflect the current levels of investment and output situation in different countries china s support is relatively concentrated and strong which is closely related to china s complex water resources problems along 18 400 km continental coastline it has an urgent need to assess potential water challenge at a national level in recent years it s important to note that although the amount of chinese articles is very large the number of citations per papers for chinese articles is the lowest among the top 10 contributors and china is still not a dominant player in international cooperation this emphasizes that chinese scholars still need to enhance the influence of articles and international cooperation in the future in addition the h index defined as h papers among the country s publications np that has at least h citations of china is not very low 41 the third of top 10 this indicates that chinese scholars also contributed quite a few of high quality papers however some studies received relatively less attention resulting in a low average citation rate in addition to explore the comprehensive distribution of research power the database can also be used to understand the research situation in any subfield of swi for example what is the difference between swi researches in carbonate aquifer and porous aquifer within the established retrieval range it can be found that 2334 papers have mentioned aquifer in the title keywords or abstract while 407 and 341 have specifically mentioned karst or carbonate aquifer and quaternary or porous aquifer respectively the top three high np countries about karst or carbonate aquifer aquifers refer to usa italy and france while the top three countries of studying quaternary or porous medium aquifers refer to usa china and france respectively although this is only a simple application for retrieving the scoped database the retrieval results are qualitative rather than quantitative because quite a few scholars do not emphasize the aquifer type in the title key words or abstract but in the introduction of the study area to some extent this reflects the swi situation in different regions it also indicates that in the more specific subfields of swi the strength of national and regional research is somewhat redistributed based on local natural situation 3 3 core literature and basic knowledge the number of citations is an important index to evaluate the influence of articles however citation frequency directly obtained from scie database refers to total citation times of the paper but the cited paper does not necessarily belong to the target retrieval field chen 2014 for example the study of anomalous coastal methane emissions that triggered the early eocene is not only revelatory in the study of swi but also widely mentioned in other environmental ecological and geological fields resulting in a high number of citations therefore highly cited literature may be associated with swi problem but not necessary to be the basic and acknowledged information boyack and klavans 2010 to identify the core research of the swi theme citation network of a local database which exports swi related literature information was rebuilt by using the citespace fig 7 all 4160 de duplicated literatures were used for co citation analysis top 10 co citation literature and top 5 co citation literature were shown in table 2 and table s2 respectively according to the co citation network fig 7 the groups can be mainly divided into 9 clusters with that clustering results less than 10 articles in clustering structure will be discard the main clusters include slr swi phenomena surrogate model clustering groundwater salinization saline groundwater viscosity dependent flow saltwater flushing saltwater upconing and conceptual model these clustering tags are displayed according to the frequency of keywords therefore these may represent features of the clusters high cited papers focus on slr swi phenomena and surrogate models the topics of the most co cited papers usually exhibit the hotspots of the core research fields which has strong reference significance boyack and klavans 2010 chang et al 2015 in the analysis of co citation one of the top ten influential papers belongs to the review category werner conducted a comprehensive review and outlook on swi in 2013 introducing the main processes and influencing factors of swi common measurement methods prediction and management and looking into the challenges facing this field werner et al 2013 some regional comprehensive reports also have high impact the swi status and processes in the european aquifers and islands were summarized by custodio 2010 the mechanism and extent of swi formation and following management measures were also summarized for north america barlow and reichard 2010 due to high research competitiveness and early research time in these regions these summary reports are very instructive as the most critical factor leading to a changing hydrodynamic environment in coastal zones slr related researches occupied half of the ten high co cited literature the impact of slr on flux controlled systems and head controlled systems have been theoretically investigated werner and simmons 2009 showing that the flux system is more durable than the constant head cases at the same degree of slr the study highlights the role of inland boundary conditions in order to address the question of whether swi is more sensitive to human activity or more vulnerable to slr ferguson and gleeson compared the swi extent caused by groundwater extraction with that induced by the slr the results show that human water use may be mainly responsible for the swi occurrence slr may lead to relevant serious groundwater salinization when land surface inundation happens in some areas with low hydraulic gradient the long term slr seems will not lead to worse swi situation under the condition of constant freshwater recharge and the saltwater wedge might be pushed back to the original position through lifting process chang et al 2011 oude essink et al 2010 have established a three dimensional solute transport model for coastal groundwater in netherlands taking climate change and human activities into account including slr land subsidence recharge changes and other factors it can provide a strong guidance for the establishment and display of numerical models in coastal areas ketabchi et al 2016 evaluated and quantified the changes in the toe position of saltwater wedge under the influence of slr through analytical and numerical models it showed that land surface inundation resulted from slr was an important factor controlling the aggravation of groundwater salinization in two other influential papers werner et al 2013 described the vulnerability of swi to slr climate change and changes in groundwater vulnerability under different boundary conditions by combining numerical simulation model meta model and the multiple objective optimization algorithm dhar and datta 2009 developed a set of methodologies to generate initial solutions which may significantly improve the efficiency of coastal water management in general swi processes are closely affected by the boundary and discharge recharge conditions of aquifers human activities also play important roles in modifying the swi processes 3 4 research evolution and frontier as the key summary of the academic papers keywords are the core and essence of a paper changes in keywords are indicative of research hotspots li and chen 2016 abbas et al 2019 the principle of co word analysis is that there must be a relationship between words or nominal phrases appearing in an article he 1999 two keywords that appear in the one article form a keyword pair by counting the keyword pairs occurrences frequent in the entire local database a network of keyword pairs can be built radhakrishnan et al 2017 generally the most co occurrence frequent keywords are core knowledge of the focused research scope the burst keyword refers to a rapid increase of cited frequent in a short time which indicates the potential research hotspots trends or frontier chen 2006 he et al 2019a zhang et al 2020 the top 20 keywords and nominal phrases with high burst value were screened out and presented in table 3 by connecting multiple keywords different hot topics can be classified as the most discussed topic slr has the highest burst value occurrence frequency and a long discussion period fig 8 slr relevant research stems from some concerns about climate change it was initially thought that rising sea levels would inevitably lead to more serious swi however further studies indicate that many other factors may be the dominant factors in swi process such as land surface slope recharge rate surface inundation aquifer thickness and groundwater exploitation mahmoodzadeh et al 2014 ketabchi et al 2016 movement of fresh salt water interface is dominated by regional hydraulic system so the impact of a single factor is various in different places werner and simmons 2009 subsurface solute transport is the core problem of swi which focuses on the migration distance and reaction moreover solute transport adsorption degradation and mixing processes always accompany variable density flow problem werner et al 2013 the variable density flow issue is usually considered in the application of numerical simulation and analytical solutions meanwhile the differences of aquifer permeability and boundary conditions which are caused by the formation structure and sedimentary characteristics may be combined with the features of local groundwater salinization to form the variable density flow problem of a coastal aquifer system ketabchi et al 2016 hence it needs to emphasize the accuracy of hydrogeological investigation on field scale resistivity can be detected by electrical resistance tomography ert method which is efficient and inexpensive to visualize the subsurface stratigraphic structure and salt distribution by recognizing the resistivity change martínez et al 2009 ogilvy et al 2009 palacios et al 2020 as a cost effective and large scale available tool for field measurement similar geophysical methods e g airborne electromagnetics have been applied on swi investigation mills et al 1988 robinson et al 2008 pedersen et al 2017 however almost all geophysical methods need an inversion process to calibrate the received signals to other sourced parameters of formation structure or salinity distribution beaujean et al 2014 steklova and haber 2017 torres martinez et al 2019 the challenge of this process is often caused by heterogeneity of aquifer systems nguyen et al 2009 in addition environmental tracers have been applied to investigate the subsurface hydrological and hydrochemical processes leibundgut et al 2011 combined with hydrochemical data solute sources can be traced and the groundwater age can be estimated which is helpful for describing groundwater flow system constructing conceptual model and inferring pollution migration processes bear et al 1999 bouchaou et al 2008 zuber et al 2011 han and currell 2018 another important research direction is the vulnerability evaluation of coastal areas swi is considered to be affected by both human activities and climate change such as groundwater recharge groundwater exploitation and aquifer characteristics hence most of these researches use multiple index assessment such as galdit which is an acronym for six indicators including g groundwater occurrence aquifer type a aquifer hydraulic conductivity l length of fresh water level above sea level d distance from the shoreline i impact of existing status and t thickness of aquifer lobo ferreira et al 2005 recinos et al 2015 parizi et al 2019 based on the above index analysis regional assessment can be carried out however a change in one condition may have a chain reaction it is also of great importance to establish hydrological hydrogeological models for key areas as for the word plain swi is more common in coastal plain area where the hydraulic gradient relatively low the groundwater depression formed and the threat of slr seawater is not only easy to intrude into the aquifer laterally but also may inundate the low slope plain ferguson and gleeson 2012 ketabchi et al 2016 yu et al 2016 circulation and discharge are two keywords belong to sgd issue subsurface freshwater discharge may be an important source of nutrient for offshore region moore 2010 oceanic tide can change the hydrodynamic condition that constitutes a unique salinity cycle in coastal areas kuan et al 2012 yu et al 2019 in a deep time frame geothermal circulation in coastal areas is also an important problem in hydrogeology which may be an important factor of climate change svensen et al 2004 optimization refers to some optimization of swi prevention and control measures such as building estuary dams underground dams and redistributing extraction wells layout abarca et al 2006 with the introduction of new optimization methods and the improvement of computing method machine learning and meta models e g artificial neural network have been more and more applied in this field dhar and datta 2009 roy and datta 2018 in addition growth should refer to the population growth with the increase of population the demand for freshwater resources gradually increases which brings potential water demand or pollution pressure to the sustainable development of coastal areas barlow and reichard 2010 ferguson and gleeson 2012 shi and jiao 2014 kalaoun et al 2018 fresh groundwater resources sustain the rapid increasing water demand in coastal zones especially in semi arid and arid coastal regions post et al 2013 mahlknecht et al 2017 alfarrah and walraevens 2018 growth may also refer to a method to identify swi events through the growth ring in the research on mangroves in coastal zones yanosky et al 1995 according to these above mentioned keywords a schematic figure describing main problem and research directions can be proposed fig 9 clustering can be formed according to the co occurrence relationship between keywords the research directions research methods and some typical research areas can be further understood table 4 the clustering results form 5 clustering labels and the clustering names are porous media groundwater quality hydrothermal circulation recovery potential and swi citespace uses the silhouette as an index to measure the homogeneity of clusters chen 2016 when the silhouette score is higher than 0 7 the relationship of keywords in cluster is highly close rousseeuw 1987 in this study the silhouette scores of each cluster are 0 80 0 68 0 87 0 90 and 0 78 respectively as there are more than 30 keywords only the first 15 keywords under each cluster are selected and shown in table 4 cluster id 0 mainly points to analytical solution or numerical simulation study on determining the location and morphology of the interface of salt and fresh water in the porous media it specifically targets the henry problem which is characterized by variable density and variable viscosity fluid tidal influence is another hot topic for the simulation study cluster id 1 points to the problems related to groundwater quality in coastal areas including prediction of water quality changes by numerical models and identification of factors of water quality changes by isotope means cluster id 2 indicates the related research on geothermal circulation and the material circulation in offshore areas the tectonic movement that occurs in a particular stratigraphic structure can drive salt water to displace some of the original materials in the stratum resulting in greenhouse gas emissions and other consequences which may be an important factor in climate change cluster id 3 is identified for showing the ecological influence of swi especially the impact of salinity changes on plants in coastal estuary or mangrove wetland cluster id 4 refers to some relevant studies to explore different factors or water management policy from the degree of swi this kind of research aims at exploring reasonable management methods to realize sustainable utilization of groundwater resources in coastal areas it can be found that swi appears with many different types of keywords especially among the above mentioned five directions hydrothermal circulation and recovery potential are not usually included in the previous review inevitably swi start to be widely considered in the fields composed by those words this is an extension of the swi issue towards the geological and ecological scope it is also a new opportunity that scholars concerned with swi issues should seize 3 5 limitations and prospects an important point needs to be noted that citespace is essentially a statistical and semantic analysis software the representation of hot keywords is based on the frequency of a particular word or phrase appears in the entire local database li and chen 2016 it leads to the fact that keywords with high burst value and high frequency are the hottest topics and even controversial topics in this field by this way some of the default basic knowledge will not be expressed because there is less argument for example the decline in groundwater levels caused by unconscionable pumping is the direct driven factor controlling swi in most coastal areas however due to the acquiescence to this conclusion the keyword pumping does not appear in the ranks of high co occurrence it may result in ignoring some commonly held assumptions this phenomenon reminds the importance of reading above mentioned highly co cited references although the analysis according to citation relations and semantic recognition in this paper is repeatable and verifiable limitations still exist for example groundwater age plays an important role in understanding the mechanism of swi however the groundwater ages are usually obtained by environmental tracers or numerical modelling it can be emphasized by counting the co occurrence frequency to show the importance of generic concepts e g environmental tracers or modelling and reduce the embodiment degree of specific concept e g groundwater age in semantic co occurrence analysis as the citespace provides a platform to investigate new ideas chen 2004 one should keep in mind that all the hot issues and methods are existing knowledge the innovation may be originated from experiences but also controlled by intelligence we can predict that existing branches of the knowledge path could be enriched in the future but it cannot be expected to predict where or when the next breakthrough will occur to fix this problem a prospect on swi would be especially crucial generally the narrow sense swi researches toward the following field the processes measurement prediction and management of swi werner et al 2013 due to the heterogeneity of complex stratum structure there is a significant gap between laboratory experiment or mathematic solution and field scale investigation on the swi processes for example the shapes of saltwater distribution characterized by ert method are usually quite different from that obtained from the sandbox analog models kazakis et al 2016 it may be limited by the calibration of ert method beaujean et al 2014 but more complex conditions such as the coastal rivers wetland land use change abandoned wells or even the biological activities have more or less impact on swi processes carabin and dassargues 1999 han et al 2015 yuan et al 2016 mastrocicco et al 2019 cao et al 2020 more laboratory model scenarios empirical summaries and improvements in the accuracy of field observations are still needed to reduce the gap between theoretical and practical studies on the other hand it should be noted that the sgd and swi are complementary processes their interactions and joint responses to other factors e g tides and climate change need to be further understood prieto 2005 taniguchi et al 2006 fang et al 2021 with the understanding of sgd the control of swi is no longer limited to protect terrestrial fresh water resources but focuses on the coastal solute cycle the critical role of sgd in nearshore waters requires a strategic balance when considering disaster mitigation from swi swarzenski et al 2001 moosdorf and oehler 2017 utsunomiya et al 2017 montiel et al 2019 zhou et al 2019 an ideal situation is to maintain stable coastal ecosystems without contaminating freshwater by seawater or impeding proper nutrient excrement moore 2010 a large number of studies have preliminarily elucidated the hydrodynamic variations and global solute flux of sgd li and wang 2015 moosdorf et al 2015 santos et al 2021 however some processes based on long term monitoring remain to be reported such as the seasonal changes in sgd driven fluxes and river driven fluxes the behavior of nutrients and emerging pollutants in coastal environment and the role of sgd in ecosystem services sugimoto et al 2016 utsunomiya et al 2017 mckenzie et al 2020 szymczycha et al 2020 in terms of swi measurement it is no longer unrealistic to comprehensively obtain information such as salinity distribution groundwater residence time solute transport path and salt source by combining water level monitoring hydrochemistry environmental tracers and hydrogeological conditions guo and huang 2003 saravanan et al 2019 zeynolabedin and ghiassi 2019 cao et al 2020 however one problem that cannot be ignored is that a large length of the global coastline is poorly monitored werner et al 2013 convenient and economical underground information sensing method is almost indispensable for the future swi research at present the airborne geophysical method has been explored in large scale long term monitoring of swi in many places including denmark the netherlands the usa and china jørgensen et al 2012 delsman et al 2018 goebel et al 2019 he et al 2019b different numerical models based on variable density flow have been developed to predict swi one of the main problems of numerical models is that the initial and boundary conditions sometimes have to be simplified such as the ocean boundary is set as a fixed head werner and simmons 2009 watson et al 2010 webb and howard 2011 this does not mean that the current models are disconnected from reality but that we are learning from them meanwhile there are more directions to be considered in organizing regional water management strategies through models in addition there is still no quantitative method to judge whether a simplified conceptual model is reasonable or not for simulation for example differences in the impact of slr have been demonstrated in head controlled systems and flux controlled systems werner and simmons 2009 but how to define land boundaries is usually data based or completely subjective carrera et al 2010 in particular it is a challenge to simulate the development of swi taking into account geological heterogeneity and transient conditions another question related to swi prediction is whether the swi evolution will differ on different timescales especially under the long time processes effects such as water rock interaction liu et al 2008 park et al 2012 and what are the characteristics and linkages of swi on the day month and year scales under the changes of tidal precipitation population economic activities and climate as a global environmental issue the impact of climate change and human activities on swi is an essential issue to be well monitored and further investigated sherif and singh 1999 jayathunga et al 2020 sithara et al 2020 although swi control is no longer an unsolvable problem in engineering the reversal process may take a very long time oude essink 2001 berger and gientke 2020 wu et al 2020 some areas have adapted their water management practices to meet local resource economic and environmental requirements javadi et al 2015 walther et al 2020 han et al 2021 yang et al 2021 optimizing coastal zone management strategies to ensure long term water security will also be an important issue multidisciplinary cooperation plays an indispensable role in the swi study swi is not only a hydrological problem but also a problem related to social and economic development giordana and montginoul 2006 swi research offers basic information for more comprehensive researches such as pollution control and ecosystem maintain herbert et al 2018 ma et al 2020 mckenzie et al 2020 meanwhile the further understanding of swi process also depends on the progress of technology and methods in other basic subjects the combination of any discipline e g geology oceanography engineering and economics with swi problems is not surprising and often leads to exciting results for example the diversity of the microbial community in the salt freshwater transition zone was high chen et al 2019 this not only improves the understanding of coastal microorganisms but also confirms that bacteria can be regarded as a potential indicator of swi solving the swi problem also requires a deep geographical interpretation how does swi affect human society and coastal ecosystem how the human society and ecosystem generate feedback these problems can t be solved without the intersection of social science and economics the solution to the swi problem depends on a variety of data to form a complete chain of evidences although numerous institutions and local governments have reported a large amount of data and analysis results there is still no proper platform to verify and summarize these data systematically this situation limits the utilization of the existing data making it difficult to analyze the swi process on a large spatial scale or dynamically track the salinity change an appropriate international data platform is within reach and will be beneficial 4 conclusions a bibliometric analysis of global swi research during 1970 2019 was conducted by using citespace the research outputs trend related disciplines and global study areas were identified the contributions of difference countries in swi issue were critically evaluated co citation and keywords co occurrence were used to clarify the core literature background knowledge and research branches the opportunities and challenges were summarized 501 coastal cities have reported swi crisis around the world about 58 of these cities locate at well recharged major basins recharge rate 100 300 mm a or local shallow aquifers population density is one of the controlling factors that leads to swi and swi tends to occur in coastal cities with large populations about 32 of coastal metropolitan cities are threatened by swi crisis while this proportion is only 2 for coastal cities with population less than 50 000 the increase rate of swi related papers is 20 times greater than that of general science and technology the united states of america china and australia contributed 46 4 of the total number of swi related articles although the second largest number of researches with has been financially supported by china some papers still failed to attract appropriate academic attention resulting in a relatively low average citation by contrast china s influence in this research field needs to be further improved combined the top 5 of core literature and top 10 core literature the basic directions and methods have been reviewed the measurement simulation predication and management of swi form the main branch of swi research which relay on the hydrodynamic chemical isotopic analysis and numerical simulation with the increasingly concerning about climate change in scientific community the impact of slr is the most widely discussed topic meanwhile swi is frequently mentioned in the aspect of coastal mangrove wetlands protection and geothermal circulation this highlights the extension of swi research into geological and ecological directions which bring both the challenges and opportunities for scholars ultimately swi is a hydrological problem driven by the development of human society and economy coastal counties around the world are likely to suffer its hazard the global swi crisis may be even more challenging when coupled with climate change despite more than 50 years of research the current worldwide swi have not been well monitored and some fundamental problem still exists it is expected that the global research efforts can be well collaborated to understand better coastal groundwater flow and solute transport processes to avoid environmental degradation of coastal systems and to enhance the global coastal water security declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was financially supported by the strategic priority research program of the chinese academy of sciences grant no xda13010303 and the outstanding member program of the youth innovation promotion association cas grant no 2012040 the manuscript was greatly benefited from the constructive comments from dr vincent e a post federal institute for geosciences and natural resources bgr hanover germany we also thank the editor and the anonymous reviewers for their valuable comments which significantly helped us to improve the manuscript quality appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126844 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4105,seawater intrusion swi is becoming one of the major environmental issues in more and more coastal areas around the world understanding the current swi situation and forming research consensus are of great significance for further studies and coastal water resources management in this study we analyzed the swi associated literature available from the science of citation index expanded scie bibliographic database by using citespace to further excavate existing research achievement we explored a new method for identifying global geographic distributions of 501 coastal cities where swi has been reported it can be found that swi is more likely to occur in well recharged major basins recharge rate 100 300 mm a or local shallow aquifers with high population density according to current reports about 32 of the coastal metropolitan cities population 1 million within 150 km from coastline have been threatened there was a 20 fold increase rate in the number of papers related to swi compared to that in general science and technology the united states of america china australia were the top 3 contributors in swi scope contributed 46 4 of the total number of articles more than 600 researches were supported by chinese funds which made china become the second contributor but the number of citations per chinese article was the lowest among the top 10 contributors by co citation analysis we identified top 5 articles and elaborated the background knowledge by taking top 10 co cited articles as example a series of keywords with high co occurrence were identified their meanings and relations were stated and graphically illustrated as a keyword swi frequently appears in the following five research directions analysis of the location or morphology of fresh and salt water interface the prediction of groundwater quality the geothermal circulation and tectonic activities the coastal mangrove wetlands protection and the management of water resources in coastal zones we critically evaluated the bibliometric results and reviewed future opportunities and challenges for this field with the development of new technology and the accumulation the improvement of coastal environment will certainly benefit from the study of swi keywords citespace coastal zone seawater intrusion coastal groundwater bibliometrics 1 introduction coastal zone is a transitional zone between ocean and land which plays a unique ecological role on linking marine and terrestrial hydrological ecosystems ferguson and gleeson 2012 about 40 of the world s population lives within 100 km from the coastline un 2017 with the intensification of climate change and human activities the water resource security has been an acute problem in coastal zones rahman et al 2017 seawater intrusion or saltwater intrusion swi has become one of the main threats to the safety of freshwater supply in coastal zones white et al 2007 swi currently threatens more than 100 countries and regions around the world including the nile delta the mekong delta east and south asia the mediterranean area and north america barlow and reichard 2010 abd elhamid et al 2016 han and currell 2018 vu et al 2018 palacios et al 2020 swi refers to the subsurface migration of seawater into fresh aquifers which mainly caused by excessive groundwater exploitation and also involved in rising sea levels and changing climates werner et al 2013 swi can be distinguished by the significant high total dissolved solids tds which caused by enrichment solutes in seawater such as chloride or sodium seenipandi et al 2019 as early as a century ago classical ghyben herzberg formula had been proposed to quantitatively study the relationship between brackish and fresh groundwater in coastal zones drabbe and ghyben 1889 herzberg 1901 verruijt 1968 it was widely used to determine the location of fresh saline water interface controlled by the unconfined groundwater level then hubbert 1940 and bear 1979 put forward a strict mathematical description for the limitations of this formula post et al 2018 from then on researchers have been trying to characterize the saltwater wedge shape and measure the degree of groundwater salinization as a significant symbol of swi researches bear et al 1999 addressed the variable density and hydrodynamic dispersion problem nowadays a complex swi research system has formed and extended to many specific branches such as coastal water management strategy groundwater resource protection submarine groundwater discharge sgd field monitoring technologies hydrochemical and isotopic issues and numerical simulation the swi process has also been increasingly recognized especially the surface and ground water interaction and seawater induction are now considered to have significant effects on groundwater salinization ferguson and gleeson 2012 cao et al 2020 the research methods include but are not limited to field investigation laboratory experiments analytical solution and numerical simulations after years of geological survey and environmental monitoring swi researches accumulated massive information on a global scale and applied numerous new technology a concern for researchers has come up that is to find hot topics and to distinguish potential breakthrough directions post 2005 mabrouk et al 2013 hussain et al 2019 bibliometric is one of statistical methods for analyzing the impact of research outputs from literature in recent years many forms of software have been developed which bring more and more bibliometric application in different research scopes leydesdorff and bihui 2005 garfield 2009 in the field of ecology and hydrology bibliometric method has been used to investigate advance in various topics such as global groundwater research niu et al 2014 stable isotope of precipitation research wei et al 2019 urban development and ecological safety research qing 2015 and global research in sustainable development hassan et al 2014 the analysis of research status and the prediction of research hotspots can play a guiding role on further research compared with the traditional methods of literature review bibliometrics can allow scholars to quickly understand the target research field and identify the basic knowledge in the field knowledge of the discipline s history which might have to take years of exploration in the past is now relatively concise as a common tool in literature metrology citespace is a literature statistic and visualization software developed by dr chaomei chen from drexel university based on java platform chen 2006 citespace can be used to map knowledge of specific science and technology fields according to the citation information of the scientific literature intuitively presenting the information panorama in the scientific field and identifying the key article potential research hotspots and frontier directions chen 2006 the co citation analysis by the citespace can generate and visualize the co citation network from the set equal time interval slices quantitatively and visually judge the key work and breakthrough progress in the research field through the pivotal points turning points and other characteristics of the co citation network chen 2004 highly co cited papers can be regarded as a weathervane of academic development in a research field interdisciplinary researchers can conveniently establish coherence of ideas and constructs with other participants in a target discipline by strategically selecting high co citation information trujillo and long 2018 co citation analysis transforms the cognitive process which originally requires a lot of knowledge accumulation and rich field experience into the recognition and search of the structure interaction intersection and evolution of the visual co citation network so as to accelerate the researchers cognition of the field and promote the development of the field chen et al 2015 a large number of studies have verified the reliability of the convincing results of citespace chen 2006 chen et al 2010 meanwhile citespace based literature measurement is also limited by the ability of searching and statistics the results obtained by semantic analysis are sometimes fragmented and need to be identified with professional knowledge at present there have been many outstanding reviews on the situation identification mechanism and management of swi mabrouk et al 2013 werner et al 2013 shi and jiao 2014 ketabchi et al 2016 parizi et al 2019 however the vast amount of information still has the potential to be quantitatively exploited further this study aims to introduce the cognitive background and the opportunity of global swi researches based on the bibliometric analyses the objectives of this study are to i introduce a method to compile and map the distribution of reported swi cities and analyze its relationship with aquifer recharge condition and local population ii identify the development characteristic of swi research and evaluate national research outputs iii summarize the background knowledge research trend and hot issues and iv analyze research opportunities and challenges according to the keyword clustering 2 method and data sources science of citation index expanded scie bibliographic database was used as a retrieval source although scie database is only a part of human innovation it is highly reliable because all published articles have undergone rigorous peer review and almost all the bibliometric analysis will consider this database hence the scie database has been a metric of scientific accomplishment in most fields of human creativity kostoff et al 2000 li et al 2009 to ensure the retrieved data were as comprehensive and focus as possible the terms seawater intrusion and saltwater intrusion were used any literature that contained these words in title keyword lists or abstracts was recorded the retrieval period was 1970 2019 recorded literature was exported with title author abstract key words and references information to organize the local database the literature data were last updated on january 2 2020 the data retrieval method of annual total subjects publication volume was the same but the keyword retrieval can be changed to search by years of publication the co occurrence analysis including co word co occurrence of keywords and co citation co occurrence of references and authors was implemented by the citespace 5 5 r2 the time slice was set as 3 years and data selection criteria was top 50 which means only the top 50 of most cited or occurred items from each slice were selected for analysis the locations of existing study areas were obtained by matching the city names globally with the title or abstract database formed by 4 252 article this process was conducted by jupyterlab based on python all world cities names appearing in the title or abstract database were recorded then cities more than 150 km from the shoreline were excluded by using arcgis 10 2 due to the complex composition of cities names it is still necessary to do manual screening for the remaining cities after the above mentioned processing fig s1 3 results and discussion 3 1 research outputs trend related disciplines and study area identification according to the citation analysis report from 1970 to 2019 more than 59 000 000 papers collected by web of science wos core database the general science and technology takes only 50 years to develop from publishing 342 773 articles 1970 a year to 2 852 866 articles 2019 fig 1 in an age of information explosion the study related to swi is a little more than a speck at the foot of the knowledge mountain for individuals however 4252 article in the target field which have been cited 73 505 times were still difficult to traverse after de duplicated by the citespace 4160 articles were obtained with 115 610 references in the retrieval period from january 1970 to january 2020 fig 1 as can be seen from fig 1 the number of published papers and the citation frequency on swi field have been dramatically increased in recent years since the early studies on swi were sporadic in the retrieval period the number of the published papers in the recent 10 years 2010 2019 is 100 times that in 1970 1980 and the amount of published papers in the past10 years accounted for 65 in the past50 years in contrast the publication volume of general science and technology in the past 10 years is only 5 times that of 1970 1980 this rapid growth which goes beyond general technological developments is dominated by several factors firstly on the demand side with the rapidly economic development and population growth more and more environmental problems e g groundwater depletion land subsidence water pollution appear in coastal areas konikow and kendy 2005 ferguson and gleeson 2012 the increasing demand for freshwater resources has resulted in groundwater over exploitation following by the occurrence of swi secondly the research on swi has been further deepened with the exploration of new technologies especially the application of isotopic and geophysical methods supplement of high precision data on larger spatial and temporal scales the swi processes have been further understood beaujean et al 2014 xiong et al 2018 al rahbi et al 2020 swi related studies involve wide ranges of disciplines which are often mutually contained and interrelated fig 2 swi can be affected by multiple factors including vertical leaching caused by inundation subsurface lateral intrusion sea level rise slr tidal fluctuation geological structures and human activities technically swi study requires coordination and application of different technical means including the physical chemical and biological methods sylus and ramesh 2013 the wide range of disciplines brings both challenges and opportunities to the swi study during the retrieval period the earliest swirelated paper described the morphological distribution of the saltwater interface in the stratified aquifer and provided the analytical solution under steady state öztürk 1970 collins and gelhar 1971 it exhibits the initial phase of swi researches which focused on solving the mathematical problems of location and morphology of fresh salt water interface in specific conceptual models with the help of web of science built in analysis tools the most cited article svensen et al 2004 in the whole download literatures reported that mantle derived material intruded into carbon rich deposits in the northeast atlantic resulting in the explosive release of methane further led to extreme global warming that triggered the eocene werner et al 2013 reviewed the current situation and challenges of swi problem ranking second in the list of highly cited articles the third list describes the impact of climate change on coastal areas and the impact of these factors on the seagrass growth and ecological effects short and neckles 1999 but these high citations are based on the global bibliographic library not the specific field of swi these articles are widely accepted work related to swi but should not be directly considered as the backbone of swi or intensive discussed topics the recognition of core literature on a specific scope depends on the co citation of citespace white et al 2004 by the end of 2019 swi had been reported in at least 501 cities worldwide fig 3 it can be obtained by matching the global city database and the database composed by titles and abstracts of swi related literature since researchers rarely mention other locations outside the target study area in the abstract and title this result can be considered as the location of global swi hazards compared with the traditional literature review method this bibliometric method can greatly improve the accuracy and comprehensiveness of the research area distribution based on the identified locations of swi we can explore the geographical characteristics of this hazard in more detail globally about 30 cities with swi crisis are distributed in local shallow aquifers fig 4 this is partly influenced by aquifer capacity which tends to be low in local and shallow aquifers on the other hand about 28 cities with swi crisis are distributed in major groundwater basins with relatively good recharge conditions 100 300 mm a most of these cities are densely populated areas it suggests that on a global scale the large demand for fresh water in populated areas is one of the main inducements for swi meanwhile swi remains a serious problem for metropolitan cities of the 501 cities that have reported swi 108 cities have population more than one million occupied 22 there are only 333 cities with a population of more than one million within 150 km from the shoreline which means that at least 32 of the world s coastal metropolitan cities are suffering from swi crisis fig 5 however the proportion is only 2 for cities with population less than 50 000 this difference further emphasizes the decisive influence of population and socio economic development on swi table s1 3 2 distribution and cooperation of research power according to the collected literature scholars interested in swi were widely distributed in more than 100 countries and regions the top 10 countries for total published articles are shown in table 1 because an article may contain authors from different countries regions the records of published papers by country region will exceed the total number of published papers the number of published papers can be regarded as a measure of a country s research strength from 1970 to 2019 the united states published the most articles in the swi scope with a total of 1017 papers accounting for 23 9 of the entire publications china ranked second with 628 published articles which account for 14 8 of the total number of publications australia was in third place with 328 publications accounting for 7 7 the following sequences are italy india germany france spain japan canada etc table 1 these countries all have advanced scientific research competitiveness and have important coastal cities or economic zones facing the swi threat in addition a cooperation analysis between countries was also conducted fig 6 shows the number of published papers and cooperation relationships between major research countries and regions cooperation is defined as the authors addresses in two or more countries or regions appearing simultaneously in a single article the close connection between each node indicates frequent exchanges and extensive sharing and cooperation between various countries in the world the purple circle outside the country s name indicates that the country has a high centrality fig 6 this exhibits that these countries are the core nodes of international cooperation these countries e g the united states and australia can be considered to play a leading role in international cooperation in the swi field among the top 10 contributors china india japan and canada are still relatively passive in international cooperation fund is one of the basic supports for scientific researches the national natural science foundation of china ranked first as a single institution with outputs of 330 papers it is followed by 139 studies funded by the u s national science foundation and 64 by the european union the fund output relationship can reflect the current levels of investment and output situation in different countries china s support is relatively concentrated and strong which is closely related to china s complex water resources problems along 18 400 km continental coastline it has an urgent need to assess potential water challenge at a national level in recent years it s important to note that although the amount of chinese articles is very large the number of citations per papers for chinese articles is the lowest among the top 10 contributors and china is still not a dominant player in international cooperation this emphasizes that chinese scholars still need to enhance the influence of articles and international cooperation in the future in addition the h index defined as h papers among the country s publications np that has at least h citations of china is not very low 41 the third of top 10 this indicates that chinese scholars also contributed quite a few of high quality papers however some studies received relatively less attention resulting in a low average citation rate in addition to explore the comprehensive distribution of research power the database can also be used to understand the research situation in any subfield of swi for example what is the difference between swi researches in carbonate aquifer and porous aquifer within the established retrieval range it can be found that 2334 papers have mentioned aquifer in the title keywords or abstract while 407 and 341 have specifically mentioned karst or carbonate aquifer and quaternary or porous aquifer respectively the top three high np countries about karst or carbonate aquifer aquifers refer to usa italy and france while the top three countries of studying quaternary or porous medium aquifers refer to usa china and france respectively although this is only a simple application for retrieving the scoped database the retrieval results are qualitative rather than quantitative because quite a few scholars do not emphasize the aquifer type in the title key words or abstract but in the introduction of the study area to some extent this reflects the swi situation in different regions it also indicates that in the more specific subfields of swi the strength of national and regional research is somewhat redistributed based on local natural situation 3 3 core literature and basic knowledge the number of citations is an important index to evaluate the influence of articles however citation frequency directly obtained from scie database refers to total citation times of the paper but the cited paper does not necessarily belong to the target retrieval field chen 2014 for example the study of anomalous coastal methane emissions that triggered the early eocene is not only revelatory in the study of swi but also widely mentioned in other environmental ecological and geological fields resulting in a high number of citations therefore highly cited literature may be associated with swi problem but not necessary to be the basic and acknowledged information boyack and klavans 2010 to identify the core research of the swi theme citation network of a local database which exports swi related literature information was rebuilt by using the citespace fig 7 all 4160 de duplicated literatures were used for co citation analysis top 10 co citation literature and top 5 co citation literature were shown in table 2 and table s2 respectively according to the co citation network fig 7 the groups can be mainly divided into 9 clusters with that clustering results less than 10 articles in clustering structure will be discard the main clusters include slr swi phenomena surrogate model clustering groundwater salinization saline groundwater viscosity dependent flow saltwater flushing saltwater upconing and conceptual model these clustering tags are displayed according to the frequency of keywords therefore these may represent features of the clusters high cited papers focus on slr swi phenomena and surrogate models the topics of the most co cited papers usually exhibit the hotspots of the core research fields which has strong reference significance boyack and klavans 2010 chang et al 2015 in the analysis of co citation one of the top ten influential papers belongs to the review category werner conducted a comprehensive review and outlook on swi in 2013 introducing the main processes and influencing factors of swi common measurement methods prediction and management and looking into the challenges facing this field werner et al 2013 some regional comprehensive reports also have high impact the swi status and processes in the european aquifers and islands were summarized by custodio 2010 the mechanism and extent of swi formation and following management measures were also summarized for north america barlow and reichard 2010 due to high research competitiveness and early research time in these regions these summary reports are very instructive as the most critical factor leading to a changing hydrodynamic environment in coastal zones slr related researches occupied half of the ten high co cited literature the impact of slr on flux controlled systems and head controlled systems have been theoretically investigated werner and simmons 2009 showing that the flux system is more durable than the constant head cases at the same degree of slr the study highlights the role of inland boundary conditions in order to address the question of whether swi is more sensitive to human activity or more vulnerable to slr ferguson and gleeson compared the swi extent caused by groundwater extraction with that induced by the slr the results show that human water use may be mainly responsible for the swi occurrence slr may lead to relevant serious groundwater salinization when land surface inundation happens in some areas with low hydraulic gradient the long term slr seems will not lead to worse swi situation under the condition of constant freshwater recharge and the saltwater wedge might be pushed back to the original position through lifting process chang et al 2011 oude essink et al 2010 have established a three dimensional solute transport model for coastal groundwater in netherlands taking climate change and human activities into account including slr land subsidence recharge changes and other factors it can provide a strong guidance for the establishment and display of numerical models in coastal areas ketabchi et al 2016 evaluated and quantified the changes in the toe position of saltwater wedge under the influence of slr through analytical and numerical models it showed that land surface inundation resulted from slr was an important factor controlling the aggravation of groundwater salinization in two other influential papers werner et al 2013 described the vulnerability of swi to slr climate change and changes in groundwater vulnerability under different boundary conditions by combining numerical simulation model meta model and the multiple objective optimization algorithm dhar and datta 2009 developed a set of methodologies to generate initial solutions which may significantly improve the efficiency of coastal water management in general swi processes are closely affected by the boundary and discharge recharge conditions of aquifers human activities also play important roles in modifying the swi processes 3 4 research evolution and frontier as the key summary of the academic papers keywords are the core and essence of a paper changes in keywords are indicative of research hotspots li and chen 2016 abbas et al 2019 the principle of co word analysis is that there must be a relationship between words or nominal phrases appearing in an article he 1999 two keywords that appear in the one article form a keyword pair by counting the keyword pairs occurrences frequent in the entire local database a network of keyword pairs can be built radhakrishnan et al 2017 generally the most co occurrence frequent keywords are core knowledge of the focused research scope the burst keyword refers to a rapid increase of cited frequent in a short time which indicates the potential research hotspots trends or frontier chen 2006 he et al 2019a zhang et al 2020 the top 20 keywords and nominal phrases with high burst value were screened out and presented in table 3 by connecting multiple keywords different hot topics can be classified as the most discussed topic slr has the highest burst value occurrence frequency and a long discussion period fig 8 slr relevant research stems from some concerns about climate change it was initially thought that rising sea levels would inevitably lead to more serious swi however further studies indicate that many other factors may be the dominant factors in swi process such as land surface slope recharge rate surface inundation aquifer thickness and groundwater exploitation mahmoodzadeh et al 2014 ketabchi et al 2016 movement of fresh salt water interface is dominated by regional hydraulic system so the impact of a single factor is various in different places werner and simmons 2009 subsurface solute transport is the core problem of swi which focuses on the migration distance and reaction moreover solute transport adsorption degradation and mixing processes always accompany variable density flow problem werner et al 2013 the variable density flow issue is usually considered in the application of numerical simulation and analytical solutions meanwhile the differences of aquifer permeability and boundary conditions which are caused by the formation structure and sedimentary characteristics may be combined with the features of local groundwater salinization to form the variable density flow problem of a coastal aquifer system ketabchi et al 2016 hence it needs to emphasize the accuracy of hydrogeological investigation on field scale resistivity can be detected by electrical resistance tomography ert method which is efficient and inexpensive to visualize the subsurface stratigraphic structure and salt distribution by recognizing the resistivity change martínez et al 2009 ogilvy et al 2009 palacios et al 2020 as a cost effective and large scale available tool for field measurement similar geophysical methods e g airborne electromagnetics have been applied on swi investigation mills et al 1988 robinson et al 2008 pedersen et al 2017 however almost all geophysical methods need an inversion process to calibrate the received signals to other sourced parameters of formation structure or salinity distribution beaujean et al 2014 steklova and haber 2017 torres martinez et al 2019 the challenge of this process is often caused by heterogeneity of aquifer systems nguyen et al 2009 in addition environmental tracers have been applied to investigate the subsurface hydrological and hydrochemical processes leibundgut et al 2011 combined with hydrochemical data solute sources can be traced and the groundwater age can be estimated which is helpful for describing groundwater flow system constructing conceptual model and inferring pollution migration processes bear et al 1999 bouchaou et al 2008 zuber et al 2011 han and currell 2018 another important research direction is the vulnerability evaluation of coastal areas swi is considered to be affected by both human activities and climate change such as groundwater recharge groundwater exploitation and aquifer characteristics hence most of these researches use multiple index assessment such as galdit which is an acronym for six indicators including g groundwater occurrence aquifer type a aquifer hydraulic conductivity l length of fresh water level above sea level d distance from the shoreline i impact of existing status and t thickness of aquifer lobo ferreira et al 2005 recinos et al 2015 parizi et al 2019 based on the above index analysis regional assessment can be carried out however a change in one condition may have a chain reaction it is also of great importance to establish hydrological hydrogeological models for key areas as for the word plain swi is more common in coastal plain area where the hydraulic gradient relatively low the groundwater depression formed and the threat of slr seawater is not only easy to intrude into the aquifer laterally but also may inundate the low slope plain ferguson and gleeson 2012 ketabchi et al 2016 yu et al 2016 circulation and discharge are two keywords belong to sgd issue subsurface freshwater discharge may be an important source of nutrient for offshore region moore 2010 oceanic tide can change the hydrodynamic condition that constitutes a unique salinity cycle in coastal areas kuan et al 2012 yu et al 2019 in a deep time frame geothermal circulation in coastal areas is also an important problem in hydrogeology which may be an important factor of climate change svensen et al 2004 optimization refers to some optimization of swi prevention and control measures such as building estuary dams underground dams and redistributing extraction wells layout abarca et al 2006 with the introduction of new optimization methods and the improvement of computing method machine learning and meta models e g artificial neural network have been more and more applied in this field dhar and datta 2009 roy and datta 2018 in addition growth should refer to the population growth with the increase of population the demand for freshwater resources gradually increases which brings potential water demand or pollution pressure to the sustainable development of coastal areas barlow and reichard 2010 ferguson and gleeson 2012 shi and jiao 2014 kalaoun et al 2018 fresh groundwater resources sustain the rapid increasing water demand in coastal zones especially in semi arid and arid coastal regions post et al 2013 mahlknecht et al 2017 alfarrah and walraevens 2018 growth may also refer to a method to identify swi events through the growth ring in the research on mangroves in coastal zones yanosky et al 1995 according to these above mentioned keywords a schematic figure describing main problem and research directions can be proposed fig 9 clustering can be formed according to the co occurrence relationship between keywords the research directions research methods and some typical research areas can be further understood table 4 the clustering results form 5 clustering labels and the clustering names are porous media groundwater quality hydrothermal circulation recovery potential and swi citespace uses the silhouette as an index to measure the homogeneity of clusters chen 2016 when the silhouette score is higher than 0 7 the relationship of keywords in cluster is highly close rousseeuw 1987 in this study the silhouette scores of each cluster are 0 80 0 68 0 87 0 90 and 0 78 respectively as there are more than 30 keywords only the first 15 keywords under each cluster are selected and shown in table 4 cluster id 0 mainly points to analytical solution or numerical simulation study on determining the location and morphology of the interface of salt and fresh water in the porous media it specifically targets the henry problem which is characterized by variable density and variable viscosity fluid tidal influence is another hot topic for the simulation study cluster id 1 points to the problems related to groundwater quality in coastal areas including prediction of water quality changes by numerical models and identification of factors of water quality changes by isotope means cluster id 2 indicates the related research on geothermal circulation and the material circulation in offshore areas the tectonic movement that occurs in a particular stratigraphic structure can drive salt water to displace some of the original materials in the stratum resulting in greenhouse gas emissions and other consequences which may be an important factor in climate change cluster id 3 is identified for showing the ecological influence of swi especially the impact of salinity changes on plants in coastal estuary or mangrove wetland cluster id 4 refers to some relevant studies to explore different factors or water management policy from the degree of swi this kind of research aims at exploring reasonable management methods to realize sustainable utilization of groundwater resources in coastal areas it can be found that swi appears with many different types of keywords especially among the above mentioned five directions hydrothermal circulation and recovery potential are not usually included in the previous review inevitably swi start to be widely considered in the fields composed by those words this is an extension of the swi issue towards the geological and ecological scope it is also a new opportunity that scholars concerned with swi issues should seize 3 5 limitations and prospects an important point needs to be noted that citespace is essentially a statistical and semantic analysis software the representation of hot keywords is based on the frequency of a particular word or phrase appears in the entire local database li and chen 2016 it leads to the fact that keywords with high burst value and high frequency are the hottest topics and even controversial topics in this field by this way some of the default basic knowledge will not be expressed because there is less argument for example the decline in groundwater levels caused by unconscionable pumping is the direct driven factor controlling swi in most coastal areas however due to the acquiescence to this conclusion the keyword pumping does not appear in the ranks of high co occurrence it may result in ignoring some commonly held assumptions this phenomenon reminds the importance of reading above mentioned highly co cited references although the analysis according to citation relations and semantic recognition in this paper is repeatable and verifiable limitations still exist for example groundwater age plays an important role in understanding the mechanism of swi however the groundwater ages are usually obtained by environmental tracers or numerical modelling it can be emphasized by counting the co occurrence frequency to show the importance of generic concepts e g environmental tracers or modelling and reduce the embodiment degree of specific concept e g groundwater age in semantic co occurrence analysis as the citespace provides a platform to investigate new ideas chen 2004 one should keep in mind that all the hot issues and methods are existing knowledge the innovation may be originated from experiences but also controlled by intelligence we can predict that existing branches of the knowledge path could be enriched in the future but it cannot be expected to predict where or when the next breakthrough will occur to fix this problem a prospect on swi would be especially crucial generally the narrow sense swi researches toward the following field the processes measurement prediction and management of swi werner et al 2013 due to the heterogeneity of complex stratum structure there is a significant gap between laboratory experiment or mathematic solution and field scale investigation on the swi processes for example the shapes of saltwater distribution characterized by ert method are usually quite different from that obtained from the sandbox analog models kazakis et al 2016 it may be limited by the calibration of ert method beaujean et al 2014 but more complex conditions such as the coastal rivers wetland land use change abandoned wells or even the biological activities have more or less impact on swi processes carabin and dassargues 1999 han et al 2015 yuan et al 2016 mastrocicco et al 2019 cao et al 2020 more laboratory model scenarios empirical summaries and improvements in the accuracy of field observations are still needed to reduce the gap between theoretical and practical studies on the other hand it should be noted that the sgd and swi are complementary processes their interactions and joint responses to other factors e g tides and climate change need to be further understood prieto 2005 taniguchi et al 2006 fang et al 2021 with the understanding of sgd the control of swi is no longer limited to protect terrestrial fresh water resources but focuses on the coastal solute cycle the critical role of sgd in nearshore waters requires a strategic balance when considering disaster mitigation from swi swarzenski et al 2001 moosdorf and oehler 2017 utsunomiya et al 2017 montiel et al 2019 zhou et al 2019 an ideal situation is to maintain stable coastal ecosystems without contaminating freshwater by seawater or impeding proper nutrient excrement moore 2010 a large number of studies have preliminarily elucidated the hydrodynamic variations and global solute flux of sgd li and wang 2015 moosdorf et al 2015 santos et al 2021 however some processes based on long term monitoring remain to be reported such as the seasonal changes in sgd driven fluxes and river driven fluxes the behavior of nutrients and emerging pollutants in coastal environment and the role of sgd in ecosystem services sugimoto et al 2016 utsunomiya et al 2017 mckenzie et al 2020 szymczycha et al 2020 in terms of swi measurement it is no longer unrealistic to comprehensively obtain information such as salinity distribution groundwater residence time solute transport path and salt source by combining water level monitoring hydrochemistry environmental tracers and hydrogeological conditions guo and huang 2003 saravanan et al 2019 zeynolabedin and ghiassi 2019 cao et al 2020 however one problem that cannot be ignored is that a large length of the global coastline is poorly monitored werner et al 2013 convenient and economical underground information sensing method is almost indispensable for the future swi research at present the airborne geophysical method has been explored in large scale long term monitoring of swi in many places including denmark the netherlands the usa and china jørgensen et al 2012 delsman et al 2018 goebel et al 2019 he et al 2019b different numerical models based on variable density flow have been developed to predict swi one of the main problems of numerical models is that the initial and boundary conditions sometimes have to be simplified such as the ocean boundary is set as a fixed head werner and simmons 2009 watson et al 2010 webb and howard 2011 this does not mean that the current models are disconnected from reality but that we are learning from them meanwhile there are more directions to be considered in organizing regional water management strategies through models in addition there is still no quantitative method to judge whether a simplified conceptual model is reasonable or not for simulation for example differences in the impact of slr have been demonstrated in head controlled systems and flux controlled systems werner and simmons 2009 but how to define land boundaries is usually data based or completely subjective carrera et al 2010 in particular it is a challenge to simulate the development of swi taking into account geological heterogeneity and transient conditions another question related to swi prediction is whether the swi evolution will differ on different timescales especially under the long time processes effects such as water rock interaction liu et al 2008 park et al 2012 and what are the characteristics and linkages of swi on the day month and year scales under the changes of tidal precipitation population economic activities and climate as a global environmental issue the impact of climate change and human activities on swi is an essential issue to be well monitored and further investigated sherif and singh 1999 jayathunga et al 2020 sithara et al 2020 although swi control is no longer an unsolvable problem in engineering the reversal process may take a very long time oude essink 2001 berger and gientke 2020 wu et al 2020 some areas have adapted their water management practices to meet local resource economic and environmental requirements javadi et al 2015 walther et al 2020 han et al 2021 yang et al 2021 optimizing coastal zone management strategies to ensure long term water security will also be an important issue multidisciplinary cooperation plays an indispensable role in the swi study swi is not only a hydrological problem but also a problem related to social and economic development giordana and montginoul 2006 swi research offers basic information for more comprehensive researches such as pollution control and ecosystem maintain herbert et al 2018 ma et al 2020 mckenzie et al 2020 meanwhile the further understanding of swi process also depends on the progress of technology and methods in other basic subjects the combination of any discipline e g geology oceanography engineering and economics with swi problems is not surprising and often leads to exciting results for example the diversity of the microbial community in the salt freshwater transition zone was high chen et al 2019 this not only improves the understanding of coastal microorganisms but also confirms that bacteria can be regarded as a potential indicator of swi solving the swi problem also requires a deep geographical interpretation how does swi affect human society and coastal ecosystem how the human society and ecosystem generate feedback these problems can t be solved without the intersection of social science and economics the solution to the swi problem depends on a variety of data to form a complete chain of evidences although numerous institutions and local governments have reported a large amount of data and analysis results there is still no proper platform to verify and summarize these data systematically this situation limits the utilization of the existing data making it difficult to analyze the swi process on a large spatial scale or dynamically track the salinity change an appropriate international data platform is within reach and will be beneficial 4 conclusions a bibliometric analysis of global swi research during 1970 2019 was conducted by using citespace the research outputs trend related disciplines and global study areas were identified the contributions of difference countries in swi issue were critically evaluated co citation and keywords co occurrence were used to clarify the core literature background knowledge and research branches the opportunities and challenges were summarized 501 coastal cities have reported swi crisis around the world about 58 of these cities locate at well recharged major basins recharge rate 100 300 mm a or local shallow aquifers population density is one of the controlling factors that leads to swi and swi tends to occur in coastal cities with large populations about 32 of coastal metropolitan cities are threatened by swi crisis while this proportion is only 2 for coastal cities with population less than 50 000 the increase rate of swi related papers is 20 times greater than that of general science and technology the united states of america china and australia contributed 46 4 of the total number of swi related articles although the second largest number of researches with has been financially supported by china some papers still failed to attract appropriate academic attention resulting in a relatively low average citation by contrast china s influence in this research field needs to be further improved combined the top 5 of core literature and top 10 core literature the basic directions and methods have been reviewed the measurement simulation predication and management of swi form the main branch of swi research which relay on the hydrodynamic chemical isotopic analysis and numerical simulation with the increasingly concerning about climate change in scientific community the impact of slr is the most widely discussed topic meanwhile swi is frequently mentioned in the aspect of coastal mangrove wetlands protection and geothermal circulation this highlights the extension of swi research into geological and ecological directions which bring both the challenges and opportunities for scholars ultimately swi is a hydrological problem driven by the development of human society and economy coastal counties around the world are likely to suffer its hazard the global swi crisis may be even more challenging when coupled with climate change despite more than 50 years of research the current worldwide swi have not been well monitored and some fundamental problem still exists it is expected that the global research efforts can be well collaborated to understand better coastal groundwater flow and solute transport processes to avoid environmental degradation of coastal systems and to enhance the global coastal water security declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was financially supported by the strategic priority research program of the chinese academy of sciences grant no xda13010303 and the outstanding member program of the youth innovation promotion association cas grant no 2012040 the manuscript was greatly benefited from the constructive comments from dr vincent e a post federal institute for geosciences and natural resources bgr hanover germany we also thank the editor and the anonymous reviewers for their valuable comments which significantly helped us to improve the manuscript quality appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126844 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4106,forecasting of hydrologic extremes across a range of timescales is critical for minimizing the socio economic costs of these events regression based prediction is commonly adopted even in operational forecasting systems often necessitating the use of distributional transformations to improve model specifications one of the issues in such predictions however is the marked differences that distinguish the frequency spectrum of the hydrologic response from the predictor variables used this raises the question of whether there exists an optimal predictor variable transformation that can mimic the frequency spectrum embedded in the observed response variable series the present paper discusses the need to transform predictor variables to improve hydrologic forecasts and specifically focuses on the frequency domain of the variables involved a number of alternatives using wavelet based approaches are presented as a means of transforming the variance associated with different frequency bands in each predictor variable the limitations and advantages of these transformations are summarized and demonstrated using synthetic examples a stepwise variance transformation framework is further proposed that facilitates transformations of the residual error from a given predictor variable conditioned on existing or pre identified predictor variables results of the stepwise framework demonstrate that the response is better characterized using both synthetic case studies and when applied to forecasting the el niño southern oscillation enso over long lead times keywords hydrologic forecasting wavelets transformations regression 1 introduction hydrologic time series are often positively skewed with a larger proportion of low values and very few high to extreme values using a predictive model that adopts as predictors variables that are more evenly distributed creates difficulties in modelling especially when linear predictive alternatives are used it is for this reason that we adopt distributional transformations as is the case when relating total dissolved solids tds concentrations and streamflow where the discharge will often be logarithmically transformed mosteller and tukey 1977 such a transformation is often sufficient to ensure a distributional correspondence between the response and associated predictors but is inadequate if these variables exist as a time series and there is a mismatch in their respective frequency spectrums consider for instance the teleconnection between the el niño southern oscillation enso and rainfall the association of which has been studied extensively in the literature d arrigo et al 2005 pui et al 2012 torrence and compo 1998 westra and sharma 2010 here a simple linear model is not sufficient to relate the two because the response rainfall exhibits a markedly different spectrum to the predictors as such for many complex natural systems formulating a simple predictive model becomes challenging especially when there exists no physical rationale to adopt an explicit or implicit transformation of the variables that define the system there are three key reasons we use variable transformations as a means of improving model specification 1 to simplify the patterns in the variable e g more symmetric or constant by removing known modes of variability including random noise 2 to allow relationships between variables to be expressed using simpler often linear models and 3 to force the spectrum of the predictor variables to exhibit a greater consistency with that of the response being modelled helsel and hirsch 2002 hyndman and athanasopoulos 2014 jiang sharma et al 2020 mcinerney et al 2017 wu et al 2019 table 1 lists a variety of mathematical transformations that have been adopted for hydrological applications in the past these include transformations that modify the probability distribution such as logarithmic reciprocal and box cox box and cox 1964 mainly applied to the response y note that log and reciprocal transformations are variants of the box cox transformation when λ 1 0 and λ 1 1 respectively the log sinh transformation has also been proposed to address heteroskedasticity often resulting from a box cox transformation wang et al 2012 table 1 also includes a variance transformation jiang sharma et al 2020 which was developed to refine the spectral representation of predictor variables and phase randomization as a related means of surrogate data generation brunner et al 2019 chavez and cazelles 2019 schreiber and schmitz 2000 both defined in the frequency domain which forms the focus of our study in all cases transformations aim to assist in the specification of a more accurate and stable predictive model fig 1 illustrates two different transformations for a nonlinear system where predictors and the response have markedly different spectral properties the nonlinear dataset is characterized by the rössler system with a k nearest neighbor knn regression model more details are provided in section 3 4 the log transformation in the temporal domain and a recently developed variance transformation in the frequency domain are demonstrated it is observed that the transformation in the spectrum allows a balanced representation of both regression diagnostics and spectral attributes not only residuals are close to normality although heteroscedasticity still exists but fitted values are more similar to observations in both the spectral and temporal domains it is worth noting that the residuals of log transformation are in their original space and the synthetic experiment is constructed to illustrate the merit of the spectral transformation when there is a significant mismatch in the spectrum of the predictors and the response in this study we focus on the variance transformation approach in the frequency domain to further explore its applicability for hydrologic forecasting as discussed in jiang sharma et al 2020 one of the most common ways to characterize the spectrum of a time series is the discrete wavelet transform dwt dwt can decompose the original signal into sub time series representing information at a range of frequencies which captures periodicity short and long term dependence and non stationarity that exist in the original signal if these decomposed sub time series are used in a data driven model there can be significant improvements in prediction accuracy nourani et al 2014 sang 2013 however the dwt decomposed components at any point in time are calculated using future information as well as past information du et al 2017 quilty and adamowski 2018 this means that dwt cannot be used in forecasting applications where future information on the predictors is not available in contrast to dwt the maximal overlap dwt modwt decomposes the time series independent of future information and a secondary benefit is that it does not require time series to be of dyadic length percival and walden 2000 another alternative to these approaches algorithme à trous at also has no dependence on future information and one of its characteristics is that the decomposed sub time series is redundant but captures the main feature and variability of the original time series dutilleux 1990 fowler 2005 more details on the difference and advantages of each wavelet transform mentioned above are provided in section 2 there are two common means of using decomposed sub time series from any wavelet transform in system modeling and forecasting the direct approach nguyen and nabney 2010 uses the decomposed sub times series to predict the target response e g kişi 2011 rashid et al 2018 the multi component approach first uses decomposed sub time series to forecast decomposed components of the target response at the equivalent scales and then aggregates these sub time series predictions e g rathinasamy et al 2014 shafaei and kisi 2016 in addition to these approaches a new technique namely variance transformation was developed to improve the predictability of a response by transforming the weights assigned to each of the decomposed frequency components in the predictor and thus forming a new predictor variable that improves the prediction of the response jiang sharma et al 2020 the key assumption of this method is that if the predictor and the corresponding response have similar spectral properties the predictive model using the transformed predictor will exhibit better accuracy this method was initially developed based on the dwt and was then extended to include the modwt so that it could be used in forecasting without requiring future information on the predictor jiang rashid et al 2020 in this study three further contributions to the method are proposed firstly the theoretical formulation of variance transformation using at is introduced and tested on a synthetic dynamical system model secondly the original method transformed each predictor individually based on its relationship with the response here a stepwise variance transformation approach is proposed which transforms the predictor variables according to the residual of the response conditional on pre existing predictors it is hypothesized that the stepwise transformation further improve the prediction accuracy even when the predictor variables and the associated response have matching spectral attributes finally we comprehensively investigate whether the newly developed stepwise variance transformation approach can improve long lead forecasting of enso the remainder of the paper is organized as follows section 2 reviews wavelet transforms of dwt modwt and at to provide a better understanding of their implications on the variance transformation technique in section 3 the variance transformation technique derived from dwt and modwt is reviewed and extended to include at section 4 introduces the stepwise variance transformation and compares it against the direct variance transformation method the capability of the stepwise variance transformation framework in a real world forecasting example is demonstrated in section 5 summary and conclusions are presented in section 6 2 wavelet transforms this section provides some basic concepts and introduces notations for readers with limited knowledge about wavelet transforms wavelet transforms are used to characterize the spectrum of time series the variance transformation method of jiang sharma et al 2020 uses wavelet transforms and modifies predictor variable time series to better match a response variable in the frequency domain this is unlike the box cox and related transformations in table 1 which attempt to modify the distributional representation of the variable with smaller changes to the spectrum in this section we review and summarize the characteristics of dwt modwt and at respectively to motivate extending the variance transformation method to at dwt can be implemented in two ways either through additive decomposition also known as multiresolution analysis or via variance or energy decomposition the variance transformation method is based on the multiresolution analysis mra and thus when we use dwt hereafter in the paper it refers to dwt mra given a discrete data sample x x 0 x 1 x n 1 t the dwt of the time series by decomposing the signal into wavelet and scaling coefficients is given by percival and walden 2000 1 w w x where w is a vector of dwt coefficients n 1 and w is the n n orthonormal transform matrix the reconstruction of the original data set can be achieved by the equation aussem et al 1998 percival and walden 2000 2 x w t w j 1 j d j a j where w can be partitioned as w d 1 d j a j including detail coefficients d j and approximation coefficients a j n is the sample size while j is the maximum decomposition level d j is the reconstructed details while a j is the reconstructed approximations thus the reconstruction matrix is given by r d 1 d j a j with a dimension of n j 1 and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t this leads to additive decomposition which is known as multiresolution analysis the modwt is a variant of the dwt and modwt decomposes the original time series x into a n j 1 matrix of wavelet and scaling coefficients w d 1 d j a j with the associated standard deviation matrix being i σ d 1 σ d j σ a j t similarly at can decompose the original time series into a n j 1 matrix of w a d 1 a d j a a j a and the associated standard deviation matrix is given by i a σ d 1 a σ d j a σ a j a t it is noted that dyadic down sampling is avoided in the modwt and at resulting in wavelet and scaling coefficients that have the same length as the original time series so that their coefficients matrix w have a different dimension from w the coefficients matrix of dwt walden 2001 the mathematical formulations of all three types of wavelet transforms are presented by quilty and adamowski 2018 and percival and walden 2000 and readers are referred to their work for more detailed information here we provide a general discussion on all three methods including their strengths and drawbacks which are summarized in table 2 the main benefit of using dwt mra is that it ensures both additive decomposition and variance decomposition these two features are required to find the theoretically optimal variance transformation jiang sharma et al 2020 discussed in the next section however the major challenge in using dwt mra for predictions is that it depends on future data to decompose the original time series into the frequency domain modwt and at decompositions are both independent of future information and are therefore appropriate for forecasting applications the second drawback of dwt mra is that it requires a dyadic sample size whilst modwt and at have no restrictions in terms of sample size although modwt and at have advantages over dwt mra on these two points they only partially meet the requirements for an optimal variance transformation modwt only preserves variance in the decomposition while at only permits additive decomposition however the logic of variance transformation can still be applied using either method but the resulting transformed variable could be dramatically different from the original time series e g the variance of the time series theoretically modwt is preferable to at since it ensures variance decomposition so that it aligns with the key idea of variance transformation i e redistributing variance across the frequency domain while at gives more redundant information of the original time series however the redundancy of information in the decomposition has many advantages in real applications and an example demonstrating these has been included in section 3 4 as discussed by quilty and adamowski 2018 there are a number of wavelet filters that have associated benefits and drawbacks in representing the variable time series in the frequency domain when a haar wavelet filter is used modwt and at are equivalent resulting in the same wavelet and scaling coefficients more importantly with the haar wavelet modwt and thus also at preserve variance and additive decomposition as a result the proposed variance transformation technique can be applied to modwt and at however there is a risk that the haar filter may not properly characterize the spectrum of variables of interest and thus we also consider in section 3 the implications of different choices of the filter however the advantage of modwt or at in being independent of future information makes their use very attractive consequently when we adopt the haar wavelet filter for modwt and at hereafter it will be referred to as modwt at due to their equivalence in the remainder of our presentation fig 2 illustrates how the decomposition varies for the three wavelet transforms i e dwt modwt and at using the target response from the forecasting example presented in section 5 i e time series of enso index niño3 4 the variance in the original time series red line is concentrated at low frequencies high to low frequency shown from upper to lower panels a long wavelet filter daubechies 8 for short db8 or d16 is used to demonstrate the difference between the decompositions in the frequency domain for reference the equivalence of modwt and at when using the haar wavelet filter is given in figure s 1 of the supporting information note that the time series is padded with zeros to bring the sample size to the next higher power of two i e dyadic sample size which is necessary for dwt in this study 3 variance transformation technique the dwt based variance transformation technique was introduced by jiang sharma et al 2020 and is briefly reviewed in section 3 1 the solution to dwt requiring future information was addressed by jiang rashid et al 2020 using modwt and here we introduce the mathematical basis of the at based approach a synthetic dataset generated from the rössler system is used to compare the three alternatives of variance transformation finally a short summary of all three wavelet based variance transformation methods is given 3 1 variance transformation using dwt as described previously dwt decomposes the original time series x into a vector of wavelet and scaling coefficients w d 1 d j a j with a dimension of n 1 reconstructed details and approximations using wavelet and scaling coefficients are given by r d 1 d j a j with a dimension of n j 1 and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t the resultant r is also called dwt mra in the form of matrix multiplication the original time series x can be expressed as x r i where r is the standardized reconstruction matrix our objective is to find a transformed predictor variable x using the rotated variance structure α following the direction of covariance vector c between the variable set y r y is the associated response of x this can be written as jiang sharma et al 2020 3 x r α α σ x c 4 c 1 n 1 y t r s y d 1 s y d j s y a j where c is the normalized covariance vector of c basically the transformed predictor x is obtained by redistributing the variance in its spectrum whilst ensuring the resulting variance of transformed time series x is the same as the original predictor x in the end a theoretical optimal prediction accuracy as measured by root mean square error rmse can be derived as jiang sharma et al 2020 5 rms e min n 1 n σ y 2 c 2 where σ y denotes the standard deviation of the response y and denotes the norm of a vector in euclidean space as can be seen in equation 5 both the positive and negative signs of covariance can result in the same optimal prediction accuracy however the sign of covariance affects how the transformed predictor variables behave and we found that the transformed predictor variables sometimes show trends physically inconsistent with observations if only the positive sign of covariance is used the correct sign for the covariance is that it should match the sign of its associated correlation coefficient an auto selection process to achieve this is therefore recommended and has been applied to all variance transformation alternatives discussed in this study the implementation of the auto selection process ensures the trend of the transformed predictor is consistent with observations 3 2 variance transformation using modwt as discussed in section 2 modwt a modified version of dwt has no limitation on the sample size and has no future data dependence nason and von sachs 1999 modwt decomposes the original time series x into a n j 1 matrix of wavelet and scaling coefficients w d 1 d j a j and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t modwt always preserves the variance decomposition which provides a way to investigate and transform the variance structure of the coefficient matrix w it is mentioned that the coefficients matrix w decomposed from dwt has a dimension of n 1 while the coefficients matrix w from modwt has a dimension of n j 1 this is another reason it can be used for the variance transformation directly consequently using the covariance c between the variable set y w the variance transformed x can be obtained by jiang rashid et al 2020 6 x w α α σ x c where w is the standardized coefficients matrix w note that although the variance decomposition is ensured with the modwt it cannot lead to the same variance as present in the original time series since the decomposed components are not additive after the transformation even when the haar wavelet filter is used 3 3 variance transformation using at algorithme à trous introduced by holschneider et al 1990 and shensa 1992 is a wavelet transform algorithm designed to overcome the problems that occur in dwt associated with data reduction due to down sampling and future data dependence at is a redundant transform because the decomposed time series is computed by repeated filtering with a maximal sampling rate at all dyadic scales and the inherent redundancy of this transform has many advantages in applications so taking a j level decompositions of an original time series of size n for example at can decompose the original time series of x into a n j 1 matrix of w a d 1 a d j a a j a and the associated standard deviation matrix is given by i a σ d 1 a σ d j a σ a j a t therefore the proposed variance transformation using at can be expressed as 7 x w a α α σ x c where c is the normalized covariance vector of c between the variable set y w a as mentioned in section 2 at ensures additive decomposition but violates the variance decomposition this means that the variance transformation in equation 7 could lead to a transformed variable with the substantially increased variance due to the redundant information included in the decomposition the implications for this increased variance are considered in the case study presented next alternatively the transformed variable could be rescaled to match the variance of the original time series where appropriate for any particular predictive models 3 4 application to synthetic examples synthetic datasets generated from statistical models with known attributes give opportunities to evaluate the effectiveness of a method or algorithm in this study the rössler system a dynamical system that exhibits chaotic dynamics proposed by rössler 1976 was used to investigate the proposed methods the rössler system is defined by the following three differential equations 8 dx dt y z dy dt x a y dz dt b z x c the chaotic system includes three constant parameters namely a b and c the values of a 0 2 b 0 2 and c 5 7 are commonly used harrington and van gorder 2017 strogatz 2000 and it is initialized from a given condition of 2 10 0 2 the rössler system generates a dependent variable set xt yt zt where xt and yt are used as predictor variables while zt is considered as the corresponding response an illustration of the rössler system in phase space and time domain is presented in fig 3 in the experiment the dynamical system is further complicated by adding gaussian white noise ɛ to each generated time series where ε n 0 0 1 2 all synthetic time series in this section have the same sample size of n 100 000 and the first half of the data is used as the calibration dataset while the second half is used as the validation dataset variance transformation is carried out after the data partition and the derived covariance from the calibration set is then transferred to the validation set along with the fitted predictive model the knn regression from beygelzimer et al 2006 is used here as the predictive model using the generated data seen above illustrations of how three different types of wavelet based transformations perform using two different wavelet filters haar and db8 are given in figs 4 and 5 respectively the increased variance of transformed predictors is observed for the at based approach using both haar and db8 wavelet filter but it will not affect the final prediction performance using regression based models as is the case presented here see the following results although the transformed predictors from the modwt based approach with db8 are able to match the variance of the original predictor it fails to characterize the predictor variables properly in terms of the dwt based approach the transformed predictor of y using either haar or db8 wavelet presents an inconsistent pattern with the original variable last it is clear that wavelet transforms investigated here have minor issues of characterizing predictors at the beginning of the time series this is the curse of wavelet transforms resulting from boundary related issues investigated and addressed in jiang rashid et al 2020 a radar chart showing three metrics including rmse standard deviation and correlation for all three types of wavelet based models using original and transformed predictor variables is presented in fig 6 note that since the haar wavelet filter is adopted modwt and at are equivalent to each other and the observation is included here mainly for indicating what the optimal value for the standard deviation in terms of calibration models using transformed predictor variables perform similarly for all three alternatives and they are better than models using original predictor variables for validation all wavelet based models outperform the reference model in both correlation and rmse it is noted that there is an exceptionally good correlation in the validation results for the modwt at based approach which is most likely due to the rössler system characteristics i e the modeled response zt has a large number of low values as well as the trade off among the three metrics this trade off has been well described and discussed through mse decomposition gupta et al 2009 different wavelet transforms characterize the spectrum of variables differently resulting in different transformed predict variables seen in fig 4 and the modwt at based approach works better than dwt in this dynamic system what we show above is a case under ideal conditions with sufficiently long data samples however this rarely happens in reality furthermore there are many other practical issues related to wavelet transforms such as the selection of wavelet filters and the decomposition level in fig 7 we have assessed the sensitivity of the approach to the choice of wavelet family by using the db8 wavelet filter as shown in fig 5 when a longer wavelet filter is used dwt and modwt are not able to characterize the spectrum of the predictor well and show comparable performance in all three metrics however the at based model has higher correlation and lower rmse than the other two methods since its redundant decomposition allows the preservation of high frequency information even when a longer wavelet filter is adopted therefore the introduction of at based variance transformation is valuable when wider wavelet filters are required and are more likely to characterize the process of interest well for example an instantaneous process with polynomials of high order coefficients such as a constant linear quadratic components etc maheswaran and khosa 2012 in closing the above results investigate the model performance across different wavelet based variance transformation approaches their limitations and advantages over each other have been discussed in detail a comparison against the traditional wavelet forecasting approaches i e direct and multi component approaches which use decomposed frequency components as predictors is included in text s 1 of the supporting information 4 variance transformation framework in this section we first present the variance transformation technique as a generalized model specification framework that uses a stepwise approach to implement the transformation secondly we compare and highlight the difference between the stepwise transformation and direct transformation using a synthetic example generated from an autoregressive model with multiple predictor variables 4 1 stepwise variance transformation the variance transformation technique is designed for regression problems where the aim is to better match the spectrum of the predictors with the response variable thus the transformation of predictor variables can be based on the original response with each predictor variable individually an alternative approach in the case of multiple predictors is to consider the transformation of a particular predictor based on the residual information in the response given existing predictor variables that have already been selected for use in the model a stepwise selection logic calculating partial informational correlation pic based on mutual information in information theory was introduced by sharma 2000 and sharma and mehrotra 2014 and it is now combined with the variance transformation resulting in stepwise variance transformation an overall flowchart of the proposed framework is provided in fig 8 this framework has been implemented in an r library named wavelet system prediction wasp and more details can be found in jiang rashid et al 2020 the first step is to transform each predictor variable corresponding to the response individually second the first significant predictor i e the first order predictor is identified which is the predictor with the strongest dependence between the transformed predictor and response using pic next residual information in the response and predictors is calculated conditioned on the pre identified predictors and then higher order predictor variables are obtained by transforming their residuals in predictors with respect to the residual in the response this process is repeated until a pre specified number of predictors have been selected or until the remaining residuals of predictors have no further dependence with the response residual although there are many options to calculate the residual in the response of interest residuals here are computed by using knn leave one out cross validation to help illustrate this process the stepwise variance transformation process can be formulated as equation 9 as follows 9 x g x z y z where g denotes the variance transformation operation represented in the previous section and z represents the pre existing predictor s it is clear that when z is empty the transformed predictor variable is the first order predictor while when z is not empty it is a higher order predictor variable the above processes summarize the stepwise variance transformation table 3 shows an illustration of both variance transformation vt and stepwise variance transformation svt approaches we use three predictor variables here but there is no mathematical limit to the number of predictor variables clearly the proposed two approaches share the same first order predictor but otherwise they are different although the same order of x 1 x 2 and x 3 is shown in the table the actual order that the predictors are selected is likely to be different for the higher order predictors this is because the svt method transforms the residual information conditioned on the previously identified predictors such that the transformed predictors are different from the vt method an example of the first and second order predictors using the real world example can be found in section 5 4 2 application to synthetic examples the autoregressive model of order nine ar9 is adopted here to assess the performance of vt and svt respectively the equation of the ar9 model is given by sharma 2000 10 x t 0 3 x t 1 0 6 x t 4 0 5 x t 9 ε t where ε is random gaussian noise with zero mean and unit standard deviation for each dataset x t was arbitrarily initialized and a total of n 500 data points were generated and the first 500 points were discarded to reduce the effects of arbitrary initializations nine candidate inputs x t 1 x t 2 and x t 9 were generated with only three of these x t 1 x t 4 and x t 9 needed in the ar9 model a total number n of 1024 samples are generated and the first half of the data is used for calibration while the second half is used for validation similarly transformation is applied after the data partition and the knn model is used as the predictive model the dyadic sample size is used to remove any boundary effects dwt was used as the basis of wavelet transform for both vt and svt with the haar wavelet filter adopted under this controlled environment we can isolate the impacts of the stepwise transformation logic three models were run one with original predictors referred to as standard approach std one with vt predictors and finally a model with the svt predictors table 4 presents the results of predictor selection in terms of the number of times a predictor is identified out of 100 realizations and the total number of predictors identified using original and transformed predictors the true predictors of ar9 x t 1 x t 4 and x t 9 are identified in 100 of the realizations using all models however many additional predictor variables are selected using the vt approach and a handful of additional predictor variables are identified by the std approach while svt performs between the two because both vt and svt force predictors to be more similar to the associated response this leads to higher dependence between the predictors and response and thus more significant predictors are identified however the svt approach tends to select fewer predictors than vt as predictor variables are transformed based on the residual information in the response meaning that fewer predictors are needed to characterize the response table s 1 presents the general agreement that exists between the pic scores between calibration and validation averaged across predictors and synthetic realizations indicating the appropriate goodness of fit achieved in the process of defining the prediction model in addition svt has the best performance as measured by rmse among the three models in both calibration and validation fig 9 based on the one sided two sample kolmogorov smirnov test the rmse values from the svt model are significantly smaller than that of std and vt with p values of 0 0004 and 0 001 respectively it is worth noting that in terms of prediction accuracy there are only incremental improvements over std using the proposed vt technique this is mainly due to the nature of the ar9 system where the spectral properties of the predictor and response are quite similar since the predictors in the system are lagged values of the response jiang sharma et al 2020 the svt approach not only shows further improved prediction accuracy but also has advantages over the vt approach in terms of true predictor identification these advantages of svt will be further demonstrated using a real world example in the next section 5 application to forecasting enso long lead enso forecasting over the niño3 4 region is used as a real world example in this study we adopted wind stress and temperature variables as regression predictors as they have been used in a range of enso forecasting works dijkstra et al 2019 petrova et al 2019 we have adopted the same regression predictors over three different regions in the equatorial area as given by petrova et al 2019 and details of these variables are given in table s 2 the monthly time series of these variables are the averaged values over the three regions the sea surface temperature datasets used for the predictors are noaa ersst v4 the zonal wind stress is derived from icoads data provided by the noaa oar esrl psl boulder colorado usa the subsurface temperature dataset used for the subsurface ocean predictors is the subsurface temperature and salinity analyses dataset by ishii et al 2005 and subsurface temperature variables are extracted at depths of 50 100 150 200 250 300 400 and 500 m the monthly anomalies of niño3 4 are derived from monthly sea surface temperature values of hadley centre global ice and sea surface temperature hadisst datasets rayner et al 2003 in total the entire dataset includes the target response i e niño3 4 and 30 predictor variables i e wind stress and temperature variables at a range of depths for each of the three regions the data is partitioned into two subsets training period 1960 93 and testing period 1994 2012 this temporal division is due to the improved data quality and coverage of ocean subsurface variables by tropical ocean global atmosphere program toga in 1994 petrova et al 2019 this is a retrospective experiment and the forecast skills have been assessed using both correlation and rmse for a range of lead times up to 24 months the dynamical linear model dlm is used for forecasting in this study and concurrent predictor variables are adopted as covariates in the model and it can be written as petris 2010 11 y t f t θ t v t v t n 0 v t θ t g t θ t 1 w t w t n 0 w t where θ t is the unobserved state vector while y t is the observed data that is the target response here f t g t v t and w t are real matrices of the appropriate dimension according to y t and θ t equation 11 can also be cast into a component form including trend seasonal and covariate i e predictor variable components the dlm model can be easily defined within the framework of the dlm r package petris 2010 and the time invariant dlm with three components i e trend seasonal and covariate components was used as the predictive model here the forecasting model used here is a general forecasting model which is different from the model proposed by petrova et al 2019 specifically designed for niño prediction based on the enso dynamics however the merit of models using transformed predictor variables will be demonstrated as long as the same baseline model is adopted in addition the transformed predictor variables are obtained using modwt at based variance transformation and therefore no future information is required for forecasting the haar wavelet filter is used here so modwt and at are equivalent to each other significant predictor variables are identified using the original and transformed predictor variables respectively with these identified significant drivers the target response niño3 4 is predicted using the dlm model table 5 summarizes the predictor selection using std vt and svt approaches two common predictor variables have been identified as the significant variables by three approaches and transformed predictors associated with their original time series are given in fig 10 first the two identified predictors zonal wind stress and subsurface temperature are transformed by filtering out irrelevant information with both vt and svt approaches it is apparent that transformed predictor variables are smoother particularly for the predictor variable of zonal wind stress second vt and svt share the same first order predictor variable and the second predictor from the vt model was also selected as the second order predictor in the svt method however the second order predictor by svt is obtained from transformed residual information conditioned on the pre existing predictor variable i e the first order predictor thus it has a completely different range and variability compared to the predictor used in the vt and std models transformed variables have same trend but with larger variance than untransformed variable and vt transformed temperature variable has larger variance than svt transformed variable fig 11 presents the predictive accuracy including both rmse and correlation against lead time l given the same predictor variables the model using transformed predictor variables has better performance for both metrics more importantly the comparison between vt and svt approach demonstrates the capability of the stepwise variance transformation by transforming the predictor variable according to the residual in response conditioned on identified or pre existing predictor variables as a result the svt predictor variables can characterize the response better even with the same identified predictor variables better forecast skills than what petrova et al 2019 have shown are observed which is likely due to the concurrent predictor variables up to the current time of t are used in this study instead of lagged predictor variables at times of t 1 t 2 and t l adopted in their work the objective of this study is to demonstrate the improvement in the predictability of niño3 4 by using transformed predictor variables given the same forecasting model and this has been clearly shown in the example another important feature of the proposed method is that the forecast skills deteriorate more slowly with increasing lead time than the reference model this again shows the value of the variance transformation technique as it can preserve important features of the predictors across longer timescales the stepwise approach shows consistent higher skills and slower deteriorations across lead times than the std and vt approaches 6 summary and conclusions in many natural systems particularly in the field of hydro climatology it is well acknowledged that long term oscillations or low frequency variabilities exist and this forms the motivation for improving predictive capability using the proposed variance transformation technique our proposed approach investigates the frequency domain wherein the original time series is transformed with a new variance structure across its spectrum with respect to a chosen response the introduction of at as the wavelet transformation alternative provides an additional choice of characterizing the spectral domain and provides advantages over other wavelet alternatives when a longer wavelet filter is required this especially has an impact on the prediction of instantaneous processes e g floods storms and bushfires in hydro climatology an important issue with wide implications for the discipline and the communities that are affected another contribution of the work is the proposed stepwise variance transformation framework which has advantages over the direct variance transformation approach in terms of both selection and prediction accuracy especially for complex natural systems where multiple predictor variables are needed applications to both synthetic and real examples demonstrate the merits of the wavelet based transformation technique and the capability of stepwise variance transformation there are unique aspects of the proposed variance transformation technique no matter which wavelet transform is used as the underlying basis the first feature that must be noted is that the method identifies a unique variance transformation for each decomposed sub time series the transformation being shown to result in optimal predictive accuracy with respect to a chosen response the second feature is that the proposed method can identify additional meaningful drivers using the transformed predictor variables given the need for predictor selection as is the case presented in our real example the third feature is that the proposed method is a generic alternative potentially applicable in modelling any natural system theoretically the dwt based method leads to the best performance of proposed alternatives since it always fulfills the requirements of both additive and variance decomposition as long as orthogonal wavelets are used however the modwt and at based alternatives provide values in certain systems as shown in this study furthermore these extensions have allowed applications in a forecasting setting and the potential usage in long lead time forecasts such as the enso example given here is very promising climate model simulations from decadal prediction experiments choudhury et al 2019 could be another scenario where these extensions can be applied for forecasting applications more conventional downscaling mehrotra and sharma 2006 or conditional generation alternatives that use exogenous covariates roderick et al 2019 wasko and sharma 2017 generated using climate models are also likely to be benefitted while their performance largely depends on how well they can characterize the spectrum of variables of interest it is preferable to use the dwt based method when predictor variables can be simulated into the future the emerging problem such as the assessment of climate change to the hydro climatological system is a perfect example where climate model simulations are used to study impacts across affected various sectors e g renewable resources water resources agriculture etc in closing it is worth noting that we have implemented the dwt modwt and at based variance transformation and stepwise variance transformation in the r package wasp wavelet system prediction wasp is an open source tool with sufficient help files and can be downloaded from the web site at http www hydrology unsw edu au software wasp a practical application of the software is given by jiang rashid et al 2020 credit authorship contribution statement ze jiang conceptualization methodology software validation formal analysis writing original draft writing review editing visualization ashish sharma conceptualization methodology validation resources writing review editing visualization supervision project administration fiona johnson conceptualization methodology validation resources writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the australian research council linkage grant lp150100548 and crown lands water division department of industry nsw australia the sea surface temperature datasets used for the predictors are noaa ersst v4 at https psl noaa gov data gridded data noaa ersst html the subsurface temperature dataset used for the subsurface ocean predictors is the subsurface temperature and salinity analyses dataset by ishii et al 2005 archived at https rda ucar edu datasets ds285 3 the zonal wind stress is derived from icoads data provided by the noaa oar esrl psl boulder colorado usa from their web site at https www psl noaa gov data gridded data coads 2deg html the monthly anomalies of niño3 4 are derived from monthly sea surface temperature values of hadley centre global ice and sea surface temperature hadisst datasets rayner et al 2003 available at https www psl noaa gov gcos wgsp timeseries appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126816 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4106,forecasting of hydrologic extremes across a range of timescales is critical for minimizing the socio economic costs of these events regression based prediction is commonly adopted even in operational forecasting systems often necessitating the use of distributional transformations to improve model specifications one of the issues in such predictions however is the marked differences that distinguish the frequency spectrum of the hydrologic response from the predictor variables used this raises the question of whether there exists an optimal predictor variable transformation that can mimic the frequency spectrum embedded in the observed response variable series the present paper discusses the need to transform predictor variables to improve hydrologic forecasts and specifically focuses on the frequency domain of the variables involved a number of alternatives using wavelet based approaches are presented as a means of transforming the variance associated with different frequency bands in each predictor variable the limitations and advantages of these transformations are summarized and demonstrated using synthetic examples a stepwise variance transformation framework is further proposed that facilitates transformations of the residual error from a given predictor variable conditioned on existing or pre identified predictor variables results of the stepwise framework demonstrate that the response is better characterized using both synthetic case studies and when applied to forecasting the el niño southern oscillation enso over long lead times keywords hydrologic forecasting wavelets transformations regression 1 introduction hydrologic time series are often positively skewed with a larger proportion of low values and very few high to extreme values using a predictive model that adopts as predictors variables that are more evenly distributed creates difficulties in modelling especially when linear predictive alternatives are used it is for this reason that we adopt distributional transformations as is the case when relating total dissolved solids tds concentrations and streamflow where the discharge will often be logarithmically transformed mosteller and tukey 1977 such a transformation is often sufficient to ensure a distributional correspondence between the response and associated predictors but is inadequate if these variables exist as a time series and there is a mismatch in their respective frequency spectrums consider for instance the teleconnection between the el niño southern oscillation enso and rainfall the association of which has been studied extensively in the literature d arrigo et al 2005 pui et al 2012 torrence and compo 1998 westra and sharma 2010 here a simple linear model is not sufficient to relate the two because the response rainfall exhibits a markedly different spectrum to the predictors as such for many complex natural systems formulating a simple predictive model becomes challenging especially when there exists no physical rationale to adopt an explicit or implicit transformation of the variables that define the system there are three key reasons we use variable transformations as a means of improving model specification 1 to simplify the patterns in the variable e g more symmetric or constant by removing known modes of variability including random noise 2 to allow relationships between variables to be expressed using simpler often linear models and 3 to force the spectrum of the predictor variables to exhibit a greater consistency with that of the response being modelled helsel and hirsch 2002 hyndman and athanasopoulos 2014 jiang sharma et al 2020 mcinerney et al 2017 wu et al 2019 table 1 lists a variety of mathematical transformations that have been adopted for hydrological applications in the past these include transformations that modify the probability distribution such as logarithmic reciprocal and box cox box and cox 1964 mainly applied to the response y note that log and reciprocal transformations are variants of the box cox transformation when λ 1 0 and λ 1 1 respectively the log sinh transformation has also been proposed to address heteroskedasticity often resulting from a box cox transformation wang et al 2012 table 1 also includes a variance transformation jiang sharma et al 2020 which was developed to refine the spectral representation of predictor variables and phase randomization as a related means of surrogate data generation brunner et al 2019 chavez and cazelles 2019 schreiber and schmitz 2000 both defined in the frequency domain which forms the focus of our study in all cases transformations aim to assist in the specification of a more accurate and stable predictive model fig 1 illustrates two different transformations for a nonlinear system where predictors and the response have markedly different spectral properties the nonlinear dataset is characterized by the rössler system with a k nearest neighbor knn regression model more details are provided in section 3 4 the log transformation in the temporal domain and a recently developed variance transformation in the frequency domain are demonstrated it is observed that the transformation in the spectrum allows a balanced representation of both regression diagnostics and spectral attributes not only residuals are close to normality although heteroscedasticity still exists but fitted values are more similar to observations in both the spectral and temporal domains it is worth noting that the residuals of log transformation are in their original space and the synthetic experiment is constructed to illustrate the merit of the spectral transformation when there is a significant mismatch in the spectrum of the predictors and the response in this study we focus on the variance transformation approach in the frequency domain to further explore its applicability for hydrologic forecasting as discussed in jiang sharma et al 2020 one of the most common ways to characterize the spectrum of a time series is the discrete wavelet transform dwt dwt can decompose the original signal into sub time series representing information at a range of frequencies which captures periodicity short and long term dependence and non stationarity that exist in the original signal if these decomposed sub time series are used in a data driven model there can be significant improvements in prediction accuracy nourani et al 2014 sang 2013 however the dwt decomposed components at any point in time are calculated using future information as well as past information du et al 2017 quilty and adamowski 2018 this means that dwt cannot be used in forecasting applications where future information on the predictors is not available in contrast to dwt the maximal overlap dwt modwt decomposes the time series independent of future information and a secondary benefit is that it does not require time series to be of dyadic length percival and walden 2000 another alternative to these approaches algorithme à trous at also has no dependence on future information and one of its characteristics is that the decomposed sub time series is redundant but captures the main feature and variability of the original time series dutilleux 1990 fowler 2005 more details on the difference and advantages of each wavelet transform mentioned above are provided in section 2 there are two common means of using decomposed sub time series from any wavelet transform in system modeling and forecasting the direct approach nguyen and nabney 2010 uses the decomposed sub times series to predict the target response e g kişi 2011 rashid et al 2018 the multi component approach first uses decomposed sub time series to forecast decomposed components of the target response at the equivalent scales and then aggregates these sub time series predictions e g rathinasamy et al 2014 shafaei and kisi 2016 in addition to these approaches a new technique namely variance transformation was developed to improve the predictability of a response by transforming the weights assigned to each of the decomposed frequency components in the predictor and thus forming a new predictor variable that improves the prediction of the response jiang sharma et al 2020 the key assumption of this method is that if the predictor and the corresponding response have similar spectral properties the predictive model using the transformed predictor will exhibit better accuracy this method was initially developed based on the dwt and was then extended to include the modwt so that it could be used in forecasting without requiring future information on the predictor jiang rashid et al 2020 in this study three further contributions to the method are proposed firstly the theoretical formulation of variance transformation using at is introduced and tested on a synthetic dynamical system model secondly the original method transformed each predictor individually based on its relationship with the response here a stepwise variance transformation approach is proposed which transforms the predictor variables according to the residual of the response conditional on pre existing predictors it is hypothesized that the stepwise transformation further improve the prediction accuracy even when the predictor variables and the associated response have matching spectral attributes finally we comprehensively investigate whether the newly developed stepwise variance transformation approach can improve long lead forecasting of enso the remainder of the paper is organized as follows section 2 reviews wavelet transforms of dwt modwt and at to provide a better understanding of their implications on the variance transformation technique in section 3 the variance transformation technique derived from dwt and modwt is reviewed and extended to include at section 4 introduces the stepwise variance transformation and compares it against the direct variance transformation method the capability of the stepwise variance transformation framework in a real world forecasting example is demonstrated in section 5 summary and conclusions are presented in section 6 2 wavelet transforms this section provides some basic concepts and introduces notations for readers with limited knowledge about wavelet transforms wavelet transforms are used to characterize the spectrum of time series the variance transformation method of jiang sharma et al 2020 uses wavelet transforms and modifies predictor variable time series to better match a response variable in the frequency domain this is unlike the box cox and related transformations in table 1 which attempt to modify the distributional representation of the variable with smaller changes to the spectrum in this section we review and summarize the characteristics of dwt modwt and at respectively to motivate extending the variance transformation method to at dwt can be implemented in two ways either through additive decomposition also known as multiresolution analysis or via variance or energy decomposition the variance transformation method is based on the multiresolution analysis mra and thus when we use dwt hereafter in the paper it refers to dwt mra given a discrete data sample x x 0 x 1 x n 1 t the dwt of the time series by decomposing the signal into wavelet and scaling coefficients is given by percival and walden 2000 1 w w x where w is a vector of dwt coefficients n 1 and w is the n n orthonormal transform matrix the reconstruction of the original data set can be achieved by the equation aussem et al 1998 percival and walden 2000 2 x w t w j 1 j d j a j where w can be partitioned as w d 1 d j a j including detail coefficients d j and approximation coefficients a j n is the sample size while j is the maximum decomposition level d j is the reconstructed details while a j is the reconstructed approximations thus the reconstruction matrix is given by r d 1 d j a j with a dimension of n j 1 and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t this leads to additive decomposition which is known as multiresolution analysis the modwt is a variant of the dwt and modwt decomposes the original time series x into a n j 1 matrix of wavelet and scaling coefficients w d 1 d j a j with the associated standard deviation matrix being i σ d 1 σ d j σ a j t similarly at can decompose the original time series into a n j 1 matrix of w a d 1 a d j a a j a and the associated standard deviation matrix is given by i a σ d 1 a σ d j a σ a j a t it is noted that dyadic down sampling is avoided in the modwt and at resulting in wavelet and scaling coefficients that have the same length as the original time series so that their coefficients matrix w have a different dimension from w the coefficients matrix of dwt walden 2001 the mathematical formulations of all three types of wavelet transforms are presented by quilty and adamowski 2018 and percival and walden 2000 and readers are referred to their work for more detailed information here we provide a general discussion on all three methods including their strengths and drawbacks which are summarized in table 2 the main benefit of using dwt mra is that it ensures both additive decomposition and variance decomposition these two features are required to find the theoretically optimal variance transformation jiang sharma et al 2020 discussed in the next section however the major challenge in using dwt mra for predictions is that it depends on future data to decompose the original time series into the frequency domain modwt and at decompositions are both independent of future information and are therefore appropriate for forecasting applications the second drawback of dwt mra is that it requires a dyadic sample size whilst modwt and at have no restrictions in terms of sample size although modwt and at have advantages over dwt mra on these two points they only partially meet the requirements for an optimal variance transformation modwt only preserves variance in the decomposition while at only permits additive decomposition however the logic of variance transformation can still be applied using either method but the resulting transformed variable could be dramatically different from the original time series e g the variance of the time series theoretically modwt is preferable to at since it ensures variance decomposition so that it aligns with the key idea of variance transformation i e redistributing variance across the frequency domain while at gives more redundant information of the original time series however the redundancy of information in the decomposition has many advantages in real applications and an example demonstrating these has been included in section 3 4 as discussed by quilty and adamowski 2018 there are a number of wavelet filters that have associated benefits and drawbacks in representing the variable time series in the frequency domain when a haar wavelet filter is used modwt and at are equivalent resulting in the same wavelet and scaling coefficients more importantly with the haar wavelet modwt and thus also at preserve variance and additive decomposition as a result the proposed variance transformation technique can be applied to modwt and at however there is a risk that the haar filter may not properly characterize the spectrum of variables of interest and thus we also consider in section 3 the implications of different choices of the filter however the advantage of modwt or at in being independent of future information makes their use very attractive consequently when we adopt the haar wavelet filter for modwt and at hereafter it will be referred to as modwt at due to their equivalence in the remainder of our presentation fig 2 illustrates how the decomposition varies for the three wavelet transforms i e dwt modwt and at using the target response from the forecasting example presented in section 5 i e time series of enso index niño3 4 the variance in the original time series red line is concentrated at low frequencies high to low frequency shown from upper to lower panels a long wavelet filter daubechies 8 for short db8 or d16 is used to demonstrate the difference between the decompositions in the frequency domain for reference the equivalence of modwt and at when using the haar wavelet filter is given in figure s 1 of the supporting information note that the time series is padded with zeros to bring the sample size to the next higher power of two i e dyadic sample size which is necessary for dwt in this study 3 variance transformation technique the dwt based variance transformation technique was introduced by jiang sharma et al 2020 and is briefly reviewed in section 3 1 the solution to dwt requiring future information was addressed by jiang rashid et al 2020 using modwt and here we introduce the mathematical basis of the at based approach a synthetic dataset generated from the rössler system is used to compare the three alternatives of variance transformation finally a short summary of all three wavelet based variance transformation methods is given 3 1 variance transformation using dwt as described previously dwt decomposes the original time series x into a vector of wavelet and scaling coefficients w d 1 d j a j with a dimension of n 1 reconstructed details and approximations using wavelet and scaling coefficients are given by r d 1 d j a j with a dimension of n j 1 and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t the resultant r is also called dwt mra in the form of matrix multiplication the original time series x can be expressed as x r i where r is the standardized reconstruction matrix our objective is to find a transformed predictor variable x using the rotated variance structure α following the direction of covariance vector c between the variable set y r y is the associated response of x this can be written as jiang sharma et al 2020 3 x r α α σ x c 4 c 1 n 1 y t r s y d 1 s y d j s y a j where c is the normalized covariance vector of c basically the transformed predictor x is obtained by redistributing the variance in its spectrum whilst ensuring the resulting variance of transformed time series x is the same as the original predictor x in the end a theoretical optimal prediction accuracy as measured by root mean square error rmse can be derived as jiang sharma et al 2020 5 rms e min n 1 n σ y 2 c 2 where σ y denotes the standard deviation of the response y and denotes the norm of a vector in euclidean space as can be seen in equation 5 both the positive and negative signs of covariance can result in the same optimal prediction accuracy however the sign of covariance affects how the transformed predictor variables behave and we found that the transformed predictor variables sometimes show trends physically inconsistent with observations if only the positive sign of covariance is used the correct sign for the covariance is that it should match the sign of its associated correlation coefficient an auto selection process to achieve this is therefore recommended and has been applied to all variance transformation alternatives discussed in this study the implementation of the auto selection process ensures the trend of the transformed predictor is consistent with observations 3 2 variance transformation using modwt as discussed in section 2 modwt a modified version of dwt has no limitation on the sample size and has no future data dependence nason and von sachs 1999 modwt decomposes the original time series x into a n j 1 matrix of wavelet and scaling coefficients w d 1 d j a j and the associated standard deviation matrix is given by i σ d 1 σ d j σ a j t modwt always preserves the variance decomposition which provides a way to investigate and transform the variance structure of the coefficient matrix w it is mentioned that the coefficients matrix w decomposed from dwt has a dimension of n 1 while the coefficients matrix w from modwt has a dimension of n j 1 this is another reason it can be used for the variance transformation directly consequently using the covariance c between the variable set y w the variance transformed x can be obtained by jiang rashid et al 2020 6 x w α α σ x c where w is the standardized coefficients matrix w note that although the variance decomposition is ensured with the modwt it cannot lead to the same variance as present in the original time series since the decomposed components are not additive after the transformation even when the haar wavelet filter is used 3 3 variance transformation using at algorithme à trous introduced by holschneider et al 1990 and shensa 1992 is a wavelet transform algorithm designed to overcome the problems that occur in dwt associated with data reduction due to down sampling and future data dependence at is a redundant transform because the decomposed time series is computed by repeated filtering with a maximal sampling rate at all dyadic scales and the inherent redundancy of this transform has many advantages in applications so taking a j level decompositions of an original time series of size n for example at can decompose the original time series of x into a n j 1 matrix of w a d 1 a d j a a j a and the associated standard deviation matrix is given by i a σ d 1 a σ d j a σ a j a t therefore the proposed variance transformation using at can be expressed as 7 x w a α α σ x c where c is the normalized covariance vector of c between the variable set y w a as mentioned in section 2 at ensures additive decomposition but violates the variance decomposition this means that the variance transformation in equation 7 could lead to a transformed variable with the substantially increased variance due to the redundant information included in the decomposition the implications for this increased variance are considered in the case study presented next alternatively the transformed variable could be rescaled to match the variance of the original time series where appropriate for any particular predictive models 3 4 application to synthetic examples synthetic datasets generated from statistical models with known attributes give opportunities to evaluate the effectiveness of a method or algorithm in this study the rössler system a dynamical system that exhibits chaotic dynamics proposed by rössler 1976 was used to investigate the proposed methods the rössler system is defined by the following three differential equations 8 dx dt y z dy dt x a y dz dt b z x c the chaotic system includes three constant parameters namely a b and c the values of a 0 2 b 0 2 and c 5 7 are commonly used harrington and van gorder 2017 strogatz 2000 and it is initialized from a given condition of 2 10 0 2 the rössler system generates a dependent variable set xt yt zt where xt and yt are used as predictor variables while zt is considered as the corresponding response an illustration of the rössler system in phase space and time domain is presented in fig 3 in the experiment the dynamical system is further complicated by adding gaussian white noise ɛ to each generated time series where ε n 0 0 1 2 all synthetic time series in this section have the same sample size of n 100 000 and the first half of the data is used as the calibration dataset while the second half is used as the validation dataset variance transformation is carried out after the data partition and the derived covariance from the calibration set is then transferred to the validation set along with the fitted predictive model the knn regression from beygelzimer et al 2006 is used here as the predictive model using the generated data seen above illustrations of how three different types of wavelet based transformations perform using two different wavelet filters haar and db8 are given in figs 4 and 5 respectively the increased variance of transformed predictors is observed for the at based approach using both haar and db8 wavelet filter but it will not affect the final prediction performance using regression based models as is the case presented here see the following results although the transformed predictors from the modwt based approach with db8 are able to match the variance of the original predictor it fails to characterize the predictor variables properly in terms of the dwt based approach the transformed predictor of y using either haar or db8 wavelet presents an inconsistent pattern with the original variable last it is clear that wavelet transforms investigated here have minor issues of characterizing predictors at the beginning of the time series this is the curse of wavelet transforms resulting from boundary related issues investigated and addressed in jiang rashid et al 2020 a radar chart showing three metrics including rmse standard deviation and correlation for all three types of wavelet based models using original and transformed predictor variables is presented in fig 6 note that since the haar wavelet filter is adopted modwt and at are equivalent to each other and the observation is included here mainly for indicating what the optimal value for the standard deviation in terms of calibration models using transformed predictor variables perform similarly for all three alternatives and they are better than models using original predictor variables for validation all wavelet based models outperform the reference model in both correlation and rmse it is noted that there is an exceptionally good correlation in the validation results for the modwt at based approach which is most likely due to the rössler system characteristics i e the modeled response zt has a large number of low values as well as the trade off among the three metrics this trade off has been well described and discussed through mse decomposition gupta et al 2009 different wavelet transforms characterize the spectrum of variables differently resulting in different transformed predict variables seen in fig 4 and the modwt at based approach works better than dwt in this dynamic system what we show above is a case under ideal conditions with sufficiently long data samples however this rarely happens in reality furthermore there are many other practical issues related to wavelet transforms such as the selection of wavelet filters and the decomposition level in fig 7 we have assessed the sensitivity of the approach to the choice of wavelet family by using the db8 wavelet filter as shown in fig 5 when a longer wavelet filter is used dwt and modwt are not able to characterize the spectrum of the predictor well and show comparable performance in all three metrics however the at based model has higher correlation and lower rmse than the other two methods since its redundant decomposition allows the preservation of high frequency information even when a longer wavelet filter is adopted therefore the introduction of at based variance transformation is valuable when wider wavelet filters are required and are more likely to characterize the process of interest well for example an instantaneous process with polynomials of high order coefficients such as a constant linear quadratic components etc maheswaran and khosa 2012 in closing the above results investigate the model performance across different wavelet based variance transformation approaches their limitations and advantages over each other have been discussed in detail a comparison against the traditional wavelet forecasting approaches i e direct and multi component approaches which use decomposed frequency components as predictors is included in text s 1 of the supporting information 4 variance transformation framework in this section we first present the variance transformation technique as a generalized model specification framework that uses a stepwise approach to implement the transformation secondly we compare and highlight the difference between the stepwise transformation and direct transformation using a synthetic example generated from an autoregressive model with multiple predictor variables 4 1 stepwise variance transformation the variance transformation technique is designed for regression problems where the aim is to better match the spectrum of the predictors with the response variable thus the transformation of predictor variables can be based on the original response with each predictor variable individually an alternative approach in the case of multiple predictors is to consider the transformation of a particular predictor based on the residual information in the response given existing predictor variables that have already been selected for use in the model a stepwise selection logic calculating partial informational correlation pic based on mutual information in information theory was introduced by sharma 2000 and sharma and mehrotra 2014 and it is now combined with the variance transformation resulting in stepwise variance transformation an overall flowchart of the proposed framework is provided in fig 8 this framework has been implemented in an r library named wavelet system prediction wasp and more details can be found in jiang rashid et al 2020 the first step is to transform each predictor variable corresponding to the response individually second the first significant predictor i e the first order predictor is identified which is the predictor with the strongest dependence between the transformed predictor and response using pic next residual information in the response and predictors is calculated conditioned on the pre identified predictors and then higher order predictor variables are obtained by transforming their residuals in predictors with respect to the residual in the response this process is repeated until a pre specified number of predictors have been selected or until the remaining residuals of predictors have no further dependence with the response residual although there are many options to calculate the residual in the response of interest residuals here are computed by using knn leave one out cross validation to help illustrate this process the stepwise variance transformation process can be formulated as equation 9 as follows 9 x g x z y z where g denotes the variance transformation operation represented in the previous section and z represents the pre existing predictor s it is clear that when z is empty the transformed predictor variable is the first order predictor while when z is not empty it is a higher order predictor variable the above processes summarize the stepwise variance transformation table 3 shows an illustration of both variance transformation vt and stepwise variance transformation svt approaches we use three predictor variables here but there is no mathematical limit to the number of predictor variables clearly the proposed two approaches share the same first order predictor but otherwise they are different although the same order of x 1 x 2 and x 3 is shown in the table the actual order that the predictors are selected is likely to be different for the higher order predictors this is because the svt method transforms the residual information conditioned on the previously identified predictors such that the transformed predictors are different from the vt method an example of the first and second order predictors using the real world example can be found in section 5 4 2 application to synthetic examples the autoregressive model of order nine ar9 is adopted here to assess the performance of vt and svt respectively the equation of the ar9 model is given by sharma 2000 10 x t 0 3 x t 1 0 6 x t 4 0 5 x t 9 ε t where ε is random gaussian noise with zero mean and unit standard deviation for each dataset x t was arbitrarily initialized and a total of n 500 data points were generated and the first 500 points were discarded to reduce the effects of arbitrary initializations nine candidate inputs x t 1 x t 2 and x t 9 were generated with only three of these x t 1 x t 4 and x t 9 needed in the ar9 model a total number n of 1024 samples are generated and the first half of the data is used for calibration while the second half is used for validation similarly transformation is applied after the data partition and the knn model is used as the predictive model the dyadic sample size is used to remove any boundary effects dwt was used as the basis of wavelet transform for both vt and svt with the haar wavelet filter adopted under this controlled environment we can isolate the impacts of the stepwise transformation logic three models were run one with original predictors referred to as standard approach std one with vt predictors and finally a model with the svt predictors table 4 presents the results of predictor selection in terms of the number of times a predictor is identified out of 100 realizations and the total number of predictors identified using original and transformed predictors the true predictors of ar9 x t 1 x t 4 and x t 9 are identified in 100 of the realizations using all models however many additional predictor variables are selected using the vt approach and a handful of additional predictor variables are identified by the std approach while svt performs between the two because both vt and svt force predictors to be more similar to the associated response this leads to higher dependence between the predictors and response and thus more significant predictors are identified however the svt approach tends to select fewer predictors than vt as predictor variables are transformed based on the residual information in the response meaning that fewer predictors are needed to characterize the response table s 1 presents the general agreement that exists between the pic scores between calibration and validation averaged across predictors and synthetic realizations indicating the appropriate goodness of fit achieved in the process of defining the prediction model in addition svt has the best performance as measured by rmse among the three models in both calibration and validation fig 9 based on the one sided two sample kolmogorov smirnov test the rmse values from the svt model are significantly smaller than that of std and vt with p values of 0 0004 and 0 001 respectively it is worth noting that in terms of prediction accuracy there are only incremental improvements over std using the proposed vt technique this is mainly due to the nature of the ar9 system where the spectral properties of the predictor and response are quite similar since the predictors in the system are lagged values of the response jiang sharma et al 2020 the svt approach not only shows further improved prediction accuracy but also has advantages over the vt approach in terms of true predictor identification these advantages of svt will be further demonstrated using a real world example in the next section 5 application to forecasting enso long lead enso forecasting over the niño3 4 region is used as a real world example in this study we adopted wind stress and temperature variables as regression predictors as they have been used in a range of enso forecasting works dijkstra et al 2019 petrova et al 2019 we have adopted the same regression predictors over three different regions in the equatorial area as given by petrova et al 2019 and details of these variables are given in table s 2 the monthly time series of these variables are the averaged values over the three regions the sea surface temperature datasets used for the predictors are noaa ersst v4 the zonal wind stress is derived from icoads data provided by the noaa oar esrl psl boulder colorado usa the subsurface temperature dataset used for the subsurface ocean predictors is the subsurface temperature and salinity analyses dataset by ishii et al 2005 and subsurface temperature variables are extracted at depths of 50 100 150 200 250 300 400 and 500 m the monthly anomalies of niño3 4 are derived from monthly sea surface temperature values of hadley centre global ice and sea surface temperature hadisst datasets rayner et al 2003 in total the entire dataset includes the target response i e niño3 4 and 30 predictor variables i e wind stress and temperature variables at a range of depths for each of the three regions the data is partitioned into two subsets training period 1960 93 and testing period 1994 2012 this temporal division is due to the improved data quality and coverage of ocean subsurface variables by tropical ocean global atmosphere program toga in 1994 petrova et al 2019 this is a retrospective experiment and the forecast skills have been assessed using both correlation and rmse for a range of lead times up to 24 months the dynamical linear model dlm is used for forecasting in this study and concurrent predictor variables are adopted as covariates in the model and it can be written as petris 2010 11 y t f t θ t v t v t n 0 v t θ t g t θ t 1 w t w t n 0 w t where θ t is the unobserved state vector while y t is the observed data that is the target response here f t g t v t and w t are real matrices of the appropriate dimension according to y t and θ t equation 11 can also be cast into a component form including trend seasonal and covariate i e predictor variable components the dlm model can be easily defined within the framework of the dlm r package petris 2010 and the time invariant dlm with three components i e trend seasonal and covariate components was used as the predictive model here the forecasting model used here is a general forecasting model which is different from the model proposed by petrova et al 2019 specifically designed for niño prediction based on the enso dynamics however the merit of models using transformed predictor variables will be demonstrated as long as the same baseline model is adopted in addition the transformed predictor variables are obtained using modwt at based variance transformation and therefore no future information is required for forecasting the haar wavelet filter is used here so modwt and at are equivalent to each other significant predictor variables are identified using the original and transformed predictor variables respectively with these identified significant drivers the target response niño3 4 is predicted using the dlm model table 5 summarizes the predictor selection using std vt and svt approaches two common predictor variables have been identified as the significant variables by three approaches and transformed predictors associated with their original time series are given in fig 10 first the two identified predictors zonal wind stress and subsurface temperature are transformed by filtering out irrelevant information with both vt and svt approaches it is apparent that transformed predictor variables are smoother particularly for the predictor variable of zonal wind stress second vt and svt share the same first order predictor variable and the second predictor from the vt model was also selected as the second order predictor in the svt method however the second order predictor by svt is obtained from transformed residual information conditioned on the pre existing predictor variable i e the first order predictor thus it has a completely different range and variability compared to the predictor used in the vt and std models transformed variables have same trend but with larger variance than untransformed variable and vt transformed temperature variable has larger variance than svt transformed variable fig 11 presents the predictive accuracy including both rmse and correlation against lead time l given the same predictor variables the model using transformed predictor variables has better performance for both metrics more importantly the comparison between vt and svt approach demonstrates the capability of the stepwise variance transformation by transforming the predictor variable according to the residual in response conditioned on identified or pre existing predictor variables as a result the svt predictor variables can characterize the response better even with the same identified predictor variables better forecast skills than what petrova et al 2019 have shown are observed which is likely due to the concurrent predictor variables up to the current time of t are used in this study instead of lagged predictor variables at times of t 1 t 2 and t l adopted in their work the objective of this study is to demonstrate the improvement in the predictability of niño3 4 by using transformed predictor variables given the same forecasting model and this has been clearly shown in the example another important feature of the proposed method is that the forecast skills deteriorate more slowly with increasing lead time than the reference model this again shows the value of the variance transformation technique as it can preserve important features of the predictors across longer timescales the stepwise approach shows consistent higher skills and slower deteriorations across lead times than the std and vt approaches 6 summary and conclusions in many natural systems particularly in the field of hydro climatology it is well acknowledged that long term oscillations or low frequency variabilities exist and this forms the motivation for improving predictive capability using the proposed variance transformation technique our proposed approach investigates the frequency domain wherein the original time series is transformed with a new variance structure across its spectrum with respect to a chosen response the introduction of at as the wavelet transformation alternative provides an additional choice of characterizing the spectral domain and provides advantages over other wavelet alternatives when a longer wavelet filter is required this especially has an impact on the prediction of instantaneous processes e g floods storms and bushfires in hydro climatology an important issue with wide implications for the discipline and the communities that are affected another contribution of the work is the proposed stepwise variance transformation framework which has advantages over the direct variance transformation approach in terms of both selection and prediction accuracy especially for complex natural systems where multiple predictor variables are needed applications to both synthetic and real examples demonstrate the merits of the wavelet based transformation technique and the capability of stepwise variance transformation there are unique aspects of the proposed variance transformation technique no matter which wavelet transform is used as the underlying basis the first feature that must be noted is that the method identifies a unique variance transformation for each decomposed sub time series the transformation being shown to result in optimal predictive accuracy with respect to a chosen response the second feature is that the proposed method can identify additional meaningful drivers using the transformed predictor variables given the need for predictor selection as is the case presented in our real example the third feature is that the proposed method is a generic alternative potentially applicable in modelling any natural system theoretically the dwt based method leads to the best performance of proposed alternatives since it always fulfills the requirements of both additive and variance decomposition as long as orthogonal wavelets are used however the modwt and at based alternatives provide values in certain systems as shown in this study furthermore these extensions have allowed applications in a forecasting setting and the potential usage in long lead time forecasts such as the enso example given here is very promising climate model simulations from decadal prediction experiments choudhury et al 2019 could be another scenario where these extensions can be applied for forecasting applications more conventional downscaling mehrotra and sharma 2006 or conditional generation alternatives that use exogenous covariates roderick et al 2019 wasko and sharma 2017 generated using climate models are also likely to be benefitted while their performance largely depends on how well they can characterize the spectrum of variables of interest it is preferable to use the dwt based method when predictor variables can be simulated into the future the emerging problem such as the assessment of climate change to the hydro climatological system is a perfect example where climate model simulations are used to study impacts across affected various sectors e g renewable resources water resources agriculture etc in closing it is worth noting that we have implemented the dwt modwt and at based variance transformation and stepwise variance transformation in the r package wasp wavelet system prediction wasp is an open source tool with sufficient help files and can be downloaded from the web site at http www hydrology unsw edu au software wasp a practical application of the software is given by jiang rashid et al 2020 credit authorship contribution statement ze jiang conceptualization methodology software validation formal analysis writing original draft writing review editing visualization ashish sharma conceptualization methodology validation resources writing review editing visualization supervision project administration fiona johnson conceptualization methodology validation resources writing review editing visualization supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the australian research council linkage grant lp150100548 and crown lands water division department of industry nsw australia the sea surface temperature datasets used for the predictors are noaa ersst v4 at https psl noaa gov data gridded data noaa ersst html the subsurface temperature dataset used for the subsurface ocean predictors is the subsurface temperature and salinity analyses dataset by ishii et al 2005 archived at https rda ucar edu datasets ds285 3 the zonal wind stress is derived from icoads data provided by the noaa oar esrl psl boulder colorado usa from their web site at https www psl noaa gov data gridded data coads 2deg html the monthly anomalies of niño3 4 are derived from monthly sea surface temperature values of hadley centre global ice and sea surface temperature hadisst datasets rayner et al 2003 available at https www psl noaa gov gcos wgsp timeseries appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126816 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4107,in regions with lack of hydrological and hydraulic data a spatial flood modeling and mapping is an opportunity for the urban authorities to predict the spatial distribution and the intensity of the flooding it helps decision makers to develop effective flood prevention and management plans in this study flood inventory data were prepared based on the historical and field surveys data by sari municipality and regional water company of mazandaran iran the collected flood data accompanied with different variables digital elevation model and slope have been considered as topographic variables land use land cover precipitation curve number distance to river distance to channel and depth to groundwater as environmental variables were applied to novel hybridized model based on neural network and swarm intelligence grey wolf algorithm nn sgw to map flood inundation several confusion matrix criteria were used for accuracy evaluation by cutoff dependent and independent metrics e g efficiency e positive predictive value ppv negative predictive value npv area under the receiver operating characteristic curve auc the accuracy of the flood inundation map produced by the nn sgw model was compared with that of maps produced by four state of the art benchmark models random forest rf logistic model tree lmt classification and regression trees cart and j48 decision tree j48dt the nn sgw model outperformed all benchmark models in both training e 90 5 ppv 93 7 npv 87 3 auc 96 3 and validation e 79 4 ppv 85 3 npv 73 5 auc 88 2 as the nn sgw model produced the most accurate flood inundation map it can be employed for robust flood contingency planning based on the obtained results from nn sgw model distance from channel distance from river and depth to groundwater were identified as the most important variables for spatial prediction of urban flood inundation this work can serve as a basis for future studies seeking to predict flood susceptibility in urban areas using hybridized machine learning ml models and can also be applied in other urban areas where flood inundation presents a pressing challenge and there are some problems regarding required model and availability of input data keywords flood inundation flood inventory gis nn sgw model confusion matrix 1 introduction floods occur due to a sudden rise in river water levels caused by snowmelt or intense precipitation peyravi et al 2019 or to failure of a hydraulic structure e g ashley and ashley 2008 catastrophic local flooding has been reported throughout the world e g the giofyros river in greece in 1994 the aude river in france in 1999 and the trisanna river in austria in 2005 marchi et al 2010 previous studies have considered flooding as a natural hazard in fluvial systems and have examined flash floods along floodplains hosseini et al 2020 but less attention has been paid to urban flooding chen et al 2009 urban areas are prone to flooding owing to their widespread use of impervious materials for rooftops streets and roads schubert and sanders 2012 pirnia et al 2019 which is known to increase the volume and rate of surface runoff shuster et al 2005 du et al 2015 climate change and its impact on the intensity of rainfall chang et al 2010 sea level rise hallegatte et al 2011 and inefficiency of old infrastructures can further increase the frequency of urban flood disasters schubert and sanders 2012 moreover increasing the population and urbanization are leading to expand urban areas in the flood prone areas which magnifies the scale of damage caused by urban flooding neumann et al 2015 the most damaging consequences of urban flooding can be contamination with sewage water traffic jams disruption of water and power supply damage to transportation systems infrastructure failure injury and loss of life jonkman and vrijling 2008 spatial modeling and mapping of the urban flood help the urban authorities to predict the spatial distribution of the flooding zones and its intensity therefore decision makers and authorities could develop effective flood prevention and management plans using a well developed systematic framework and optimized models torres et al 2014 recently several attempts have been made to analyze the interactions between urbanized areas and drainage infrastructures and the impact on surface runoff schmitt et al 2004 chen et al 2009 darabi et al 2019 progress in computational methods and availability of spatial data now permit more accurate modeling of the dynamic processes of flooding and urban flood prediction mitigation and risk management fewtrell et al 2008 model optimization is vital when one optimum solution needs to be identified among others marler and arora 2004 and it is especially important when analytical methods cannot solve the problem within the required time deb 2012 for example meta heuristic algorithms can be combined to exploit their advantages and overcome their weaknesses and thus obtain more accurate results yagiura and ibaraki 2001 several attempts have been made to construct hybrid optimized models by utilizing different existing models e g genetic algorithm ga and ant colony optimization aco liu et al 2017 simulated annealing sa and particle swarm optimization pso javidrad and nazari 2017 sa and whale optimization algorithm woa mafarja and mirjalili 2017 or pso and grey wolf optimizer gwo şenel et al 2019 these hybrid optimized models utilize the abilities of one algorithm to neutralize the deficiencies of another e g the inability of ga for local searches can be solved by combining it with the bee algorithm ba şenel et al 2019 artificial neural network ann models have been utilized in different engineering fields due to the strength of neural networks in non linearity and data driven aspects beside of the well documented advantages for using ann e g low cost of the model construction and flexible capability on input output mapping for complex systems which make it extensively used for prediction of dynamic variables such as geographical information the main mentioned drawbacks of ann are the large amounts of the training data required particularly for manners with many layers extensive training time high probability of over fitting and difficulty of interpreting chen et al 2020 optimization of ann is required to overcome its main shortcomings which are lack of explanatory power in the trained networks due to their complex structure and over fitting problems wen et al 2019 sessarego et al 2020 following the previous study darabi et al 2019 and using data provided by darabi et al 2019 the aim of this study was to utilize and compare the four commonly used ml algorithms including random forest rf logistic model tree lmt classification and regression trees cart j48 decision tree j48dt with new optimized ann model for spatial prediction of urban flooding with the swarm intelligence grey wolf sgw algorithm as a heuristic technique inspired by bird flocking wolf pack hunting and their social psychology le et al 2009 this can be led to reduce the number of inputs to the ann and select the most effective conditioning variables 2 study area the study area is sari city located in northern iran extended between 35 58 39 to 36 50 12 north and 52 56 42 to 53 59 32 east where is characterized as lowland with altitude ranges between 9 and 82 m above sea level a s l fig 1 the city occupies an area of approximately 42 km2 and it is the second major city in the mazandaran province it is the capital of mazandaran province with a population of 296 417 according to the 2016 census the city is characterized by built up areas in the center surrounded by agricultural land small areas of orchards and different types of natural environment mean annual precipitation in the region is 734 mm and mean annual temperature is 13 6 c darabi et al 2019 the city is located in the outlet of the tajan basin the city of sari receives most of the surface runoff by the rainy streams due to its location and is bordered by high mountains to the south of the tajan river passing through the eastern part of the city in the recent years one of the main causes of the flooding over the sari city were river floods sharifinia 2019 during each year prolonged heavy precipitation importantly created large volumes of surface runoff which triggered a significantly the urban flood over the sari city in addition the city of sari is characterized as lowland and it has few drainage networks and most of them have been constructed for several years ago which are old and have low capacity therefore the surface runoff flow cannot be discharged in time when heavy precipitation occurs which leads to serious water accumulation and make inundated areas abdi et al 2019 hydro climate data for the present study were used from the iranian meteorological organization irimo for sari synoptic station 3 methodology 3 1 urban flood locations in situ analyses and sampling all available historical data on floods was used as auxiliary data flood and non flood locations during the several past flood events also flood inventory data were obtained by historical and field surveys data which were conducted by sari municipality and regional water company of mazandaran to identify flooded areas and non flooded areas during high intensity precipitation table 1 shows the available historical database 2007 2016 and collected field survey databases 2017 2019 on floods two equal sets of points were identified randomly for both categories of flood and non flood areas therefore 113 locations for each category were recorded using a global positioning system gps device each set is divided into training 70 of data 79 points and testing 30 of data 34 points groups the flood locations were allocated by a value of 1 and non flood locations were assigned by a value of 0 all historical database for flooded areas which were updated and employed in the current study have been already used in the previous study by darabi et al 2019 3 2 conditioning variables in flood inundation mapping eight conditioning factors were tested in flood susceptibility mapping elevation slope distance to channel distance to river land use land cover precipitation curve number cn and depth to groundwater all urban flood conditioning factors which used in this study have been already applied in the previous study by darabi et al 2019 precipitation data on daily precipitation from meteorological for 16 stations in mazandaran province obtained from irimo for 1989 2018 period were applied to extract a spatial rainfall map by applying the kriging interpolation method in arcgis gis 10 5 the mean annual precipitation varied from 722 mm in the east to 745 mm in the west and northwest of the study area fig 2 a land use land cover the land use land cover map was obtained from sari city authority darabi et al 2019 based on the land use data fig 2b seven categories of land cover were recognized residential road street open space agricultural bare land orchard and water body river digital elevation model dem a dem with 5 m resolution was prepared in arcgis 10 5 by applying the kriging interpolation method of interpolation points fig 2c the attitude of the sari city ranges from 9 m asl in the north and northeast to 82 m asl in the south the database of the elevation was obtained from sari municipality slope slope percent plays an important role in flood susceptibility as it affects runoff velocity and intensity of flow a slope percent map 5 m was prepared using the dem in arcgis 10 5 slope percent was divided into four classes 2 2 4 4 6 and 6 based on the classification used by sari city authority fig 2d curve number cn curve number is a function based on hydrological conditions and land use land cover soil type and moisture which was first developed by uscs or united states soil conservation service land use land cover and hydrological soil group hsg maps of the sari city were used to prepare a cn map in arcgis 10 5 fig 2e by the arccn runoff tool darabi et al 2019 distance to river distance to river has an important role in flood prone areas in riversides distance to the tajan river which passes through the east of sari city was extracted using the euclidean distance module in arcgis 10 5 fig 2f distance to channel surface water is collected by urban channels which should have sufficient capacity to drain all surface water from the city the channels in sari city do not have such capacity so it is very important to consider distance to channels as a flood conditioning factor distance to channel was extracted using the euclidean distance module in arcgis 10 5 fig 2g depth to groundwater in urban areas depth to groundwater level significantly affects surface water runoff howard and gerber 2018 in this study depth to groundwater data were obtained from the irimo and groundwater level map were extracted from 28 piezometric wells by the interpolation method by integrated distance weighting idw in arcgis 10 5 fig 2h 3 3 machine learning ml algorithms machine learning ml aims to develop methods and algorithms to learn and forecast data ml algorithms are important for several reasons e g they can i handle complex systems with huge data ii solve specialized problems by specialized ml methods iii be used for forecasting and classification purposes and iv be applied to describe the performance of the data input with respect to historical data records demolli et al 2019 in this study four commonly used ml algorithms including random forest rf logistic model tree lmt classification and regression trees cart j48 decision tree j48dt were employed as standard or benchmark models for judging the performance of the novel hybridized model 3 3 1 random forest rf the concept of random forest rf was first proposed by ho 1998 and extended by breiman 2001 rf as a powerful ensemble ml algorithm was developed by the combination of regression and classification methods and statistical theory tan et al 2020 it can be employed for many predicted trends and the average prediction of decision trees xing et al 2019 the rf algorithm has been employed in different fields such as land cover classification using remote sensing data and flood risk and hazard mapping zhao et al 2018 the algorithm has two main advantages that improve the accuracy of prediction i its ability to handle huge datasets with a nonparametric and robust method and correlated conditional variables and ii its capacity for variable importance assessments using a random arrangement of the variables by comparison and evaluation of each variable in the prediction results for its importance zhao et al 2018 3 3 2 j48 decision tree j48dt j48 decision tree j48dt is a new classification tree based technique that has been employed in only a few studies predictive ability of the algorithm has been assessed and validated in a previous study using statistical and receiver operating characteristic roc curve methods pham et al 2017 for binary classification variables here flood or non flood locations j48dt creates a tree which includes a root node and internal branch and leaf nodes the root node consists of the input dataset the internal branch nodes relate to the decision function and the leaf nodes indicate the production of a specified contribution of the dataset compared with other decision tree models j48dt is considered best in terms of classification accuracy which is trained in two steps i building and ii pruning the classification tree zhao and zhang 2008 3 3 3 classification and regression tree cart classification and regression tree cart is a recursive partitioning algorithm that used to predict continuous dependent and categorical predictor conditioning factors zhao et al 2016 cart which was proposed for the first time by breiman et al 1984 has gained in popularity during recent years however because of overfitting and high sensitivity of cart to minor changes in all training input data it is viewed as an unstable ml algorithm erdal and karakurt 2013 3 3 4 logistic model tree lmt logistic model tree lmt a ml algorithm suggested by landwehr et al 2003 is a hybrid classification model combining logistic regression lr with decision tree dt functions which can boost the precision of prediction chen et al 2017 in lmt variable splitting is performed with the maximum information ratio obtained for splitting categorical and numerical variables with c specific values the node has c child nodes and two child nodes respectively lee and jun 2018 for pruning the nodes of the tree the lmt algorithm employs a logit boost function to set up the logistic regression method and it uses cross validation to discover multiple logit boost iterations to stop overfitting of all training input data arabameri et al 2020 3 3 5 artificial neural network ann models neural network models are a set of meta heuristic population based optimization algorithms computational nn models have been broadly employed in different scientific fields for prediction purposes in most cases madsen et al 2017 zhang et al 2020 the ann model has strong self learning self compatibility fitness error tolerance and extension capabilities inspired by biological nervous systems it shows high performance in fitting multivariate analysis by better learning efficiency zhao et al 2019 the purpose of ann model optimization is to get an optimum solution shirwaikar et al 2019 within the data mining field the ann algorithm has been used to solve many practical problems in this study it was used for urban flood susceptibility mapping 3 3 6 swarm intelligence algorithm the swarm intelligence algorithm is one of the major popular optimization models applied by researchers in different subfields arani et al 2013 yang 2014 during recent years the swarm intelligence algorithm has been used to imitate behavior in nature şenel et al 2019 e g to understand crowd behavior in biological systems qasim and bhatti 2019 it is one of a family of nature inspired modeling approaches based on the collective behavior of social swarms in nature e g honeybees ant colonies birds fish however the swarm intelligence algorithm seeks to identify an optimal result from the social actions of many individuals mosa et al 2019 according to the premise that individuals interactions lead to intelligent behaviors at group level zedadra et al 2018 it comprises three steps i initialize the swarm of predictor variables as dimensional space ii set parameters of the swarm algorithm e g maximum iteration and population and iii predict a robustness value and randomly determine the primary best situation bui et al 2019 3 3 7 grey wolf optimizer gwo grey wolf optimizer is a novel bionic population based and heuristic optimization algorithm that forms a pyramid with the most influential wolf at the remaining wolves in descendant importance in lower situations bui et al 2019 gwo was developed by mirjalili et al 2014 according to the social hunting nature of grey wolves it mathematically mimics the social leadership hierarchy and hunting behavior based on the grey wolves working together to detention prey with a clear cooperation the gwo algorithm for predation is divided into three stages encircling hunting and attacking long 2016 niu et al 2019 gwo with its low number of parameters and ease of implementation has faster evolutionary programming and faster convergence than the swarm intelligence algorithm daniel et al 2017 gwo was effectively applied in a forest fire research by bui et al 2019 search agents wolves in gwo as swarm based algorithms are arbitrarily situated in the d dimensional space after each iteration the positioned and fitness values of wolves search agents are updated the optimal solution to the problem at hand is the final location of the top wolf bui et al 2019 3 4 designing and proposing a neural network model optimized by swarm intelligence and grey wolf algorithms ann sgw optimization of models is important to achieve an optimum solution in a complicated d dimensional space when the problem solving needs too much time optimized approaches can help however an overall optimized algorithm is not guaranteed şenel et al 2019 optimization is also a crucial activity in model design allowing programmers and planners to produce better designs which can save time and costs many optimization problems in engineering are complex and difficult to solve with conventional optimization models such as mathematical programming by hybridizing a model with different algorithms it is possible to combine the advantages of the algorithms and produce a better optimized model cui and bai 2019 jia et al 2019 in this study an ann model was optimized using novel optimizer algorithms swarm intelligence and gwo in a parallel computing approach to improve spatial prediction of urban inundation susceptibility the optimized model ann sgw was used to recognize the most flood prone areas in the study city compared with actual data the proposed ann sgw model has a simple construction with a low number of factors and simulations avoiding the complexity of large scale networks and combines the advantages of swarm intelligence and gwo with those of ann 3 5 loss function and optimization algorithm the ann model was first generated for spatial prediction of urban flooding and then optimized using the sgw algorithms the purpose of optimization was to search and identify the best weights of the model in which the difference between flood inventory data and predicted flood locations is minimized the difference was determined using a loss function lof designed as follows bui et al 2019 1 l o f 1 n p r e d i t a g i n where p r e d i is predicted flood in the ann model output t a g i is the actual flood measured value and n is the number of total flood locations used parameters used in the sgw algorithm were g0 100 α 20 ω 0 5 c1 1 c2 3 and population size 5 as suggested by jayaprakasam et al 2015 the training process was run for 200 iterations 3 6 model assessment and benchmark model comparison in statistical analysis of data mining techniques a known error matrix is the confusion matrix which allows the performance of supervised models to be assessed here we used nine different cutoff dependent metrics from the confusion matrix namely true positive and negative tp and tn false positive and false negative fp and fn positive and negative predictive values ppv and npv sensitivity specificity and efficiency the four elements of the confusion matrix are tp tn fp and fn frattini et al 2010 sensitivity true positive rate tpr see equation 2 specificity false positive rate fpr see equation 3 and efficiency e equation 4 determine the proportion of actual flooded locations that are accurately identified the other cutoff dependent metrics used ppv and npv are the ratio of positive and negative results respectively in statistical analysis equations 5 and 6 and thus explain model performance by applying primary statistical criteria tp and tn in the confusion matrix fletcher et al 2018 using the pmt tool all cutoff dependent metrics used for model performance assessment were applied rahmati et al 2019 area under the curve receiver operating characteristic curve auc roc a cutoff independent metric was also used equation 7 as it is effective in organizing models and assessing their performance visually fawcett 2006 it is known as a decisive metric where values closer to 100 indicate better performance of a model pontius and schneider 2001 2 s e n s i t i v i t y 3 s p e c i f i c i t y fp fp t n 4 efficiency tp t n tp t n f p f n 5 ppv tp tp f p 6 npv tn tn f n 7 auc 0 1 f f p r d f p r 1 0 1 f t p r d t p r 4 results 4 1 training the ann sgw model and performance assessment the results for goodness of fit of the ann sgw model are shown in table 2 among the cutoff dependent evaluation metrics the value obtained for ppv npv sensitivity specificity and efficiency in the training step was 93 7 87 3 88 1 93 2 and 90 5 respectively the results of the confusion matrix criteria indicate a considerable arrangement between the trained model and observed dataset auc a cutoff independent metric had a value of 96 3 in this step reflecting high fitting skill of the ann sgw model there was therefore agreement between the cutoff dependent and independent metrics as regards performance of the model however goodness of fit individually estimates how well the model fits the training dataset and cannot be used for determining the ability of the model in prediction tehrany et al 2015 a testing step is needed to determine the predictive performance in the validation step the ann sgw model showed considerably maximum predictive performance based on both the cutoff independent metrics ppv 85 3 npv 73 5 sensitivity 76 3 specificity 83 3 efficiency 79 4 and the cutoff independent metric auc 88 2 and evaluation criteria table 2 fig 3 the validation results obviously demonstrated robust arrangement between observed values i e reference data and predicted values by the ann sgw model following rahmati et al 2020 the predictive performance of ann sgw can be classified as very good 80 auc 90 4 2 comparison of the ann sgw model with benchmark models to confirm the performance of the ann sgw model its predictive ability was compared with that of four commonly used benchmark models rf lmt cart j48dt among these rf showed the highest accuracy in the training step in terms of both the cutoff dependent ppv 87 3 npv 72 2 sensitivity 75 8 specificity 85 1 efficiency 79 7 and cutoff independent auc 89 4 evaluation metrics table 3 it was followed by lmt ppv 84 8 npv 69 6 sensitivity 73 6 specificity 82 1 efficiency 77 2 auc 80 and then j48dt ppv 87 3 npv 63 3 sensitivity 70 4 specificity 83 3 efficiency 75 3 auc 72 9 and cart ppv 77 2 npv 67 1 sensitivity 70 1 specificity 74 6 efficiency 72 1 auc 72 2 therefore agreement was obtained between observed values and values predicted by the benchmark models in the training step importantly comparison of all results indicated that the ann sgw model had the highest goodness of fit followed by rf lmt j48dt and cart the validation results for the benchmark models are shown in table 4 and fig 4 again rf outperformed the other benchmark models based on cutoff dependent ppv 94 12 npv 58 82 sensitivity 69 57 specificity 90 91 efficiency 76 47 and cutoff independent auc 88 1 evaluation metrics it was followed by lmt ppv 91 18 npv 55 88 sensitivity 67 39 specificity 86 39 efficiency 73 53 auc 75 6 and then cart auc 69 8 and j48dt auc 69 7 therefore the proposed ann sgw model auc 88 2 had higher predictive performance than all benchmark models based on both cutoff dependent and independent assessment metrics 4 3 variable importance since the ann sgw model showed the highest accuracy in both the training and testing dataset importance of the variable has been calculated by the ann sgw model fig 5 illustrates the relative importance ri of predictor variables in spatial modeling of urban flood susceptibility distance from channel distance from river and depth to groundwater had the greatest importance in urban inundation with ri equal to 31 22 and 19 respectively they were followed by precipitation ri 11 land use ri 10 and curve number ri 7 4 4 urban inundation susceptibility mapping the urban flood inundation maps were generated by the ann sgw and benchmark models are shown in fig 6 and fig 7 upon preliminary review distribution of high flood susceptibility zones seemed to be clearly distinguished over the sari city especially all the proposed ann sgw and benchmark models revealed a comparatively similar pattern of flood susceptibility in the sari city fig 6 and fig 7 central northern western and southwestern parts of sari city fell under highly flood susceptible areas while eastern southern and southeastern parts showed significantly fewer flood susceptibility zones 5 discussion 5 1 urban flood mapping approaches flood prediction in urban environments is important for urban planners and policymakers in order to reduce susceptibility to future floods kim et al 2015 different methodologies for urban flood assessment were considered and discussed by previous researchers using probabilistic and deterministic approaches di baldassarre et al 2009 high resolution of topographic modeling abily et al 2016 hydrodynamic numerical modeling glenis et al 2018 costabile et al 2020 dong et al 2021 recently numerous works have been conducted to improve the predictive capacity of the one dimensional urban flood modeling but so far it is noticeable that these attempts are still far from a satisfactory application of these models in urban flood prediction for example eini et al 2020 assessed the hazard and vulnerability of urban flood using maximum entropy maxent and genetic algorithm rule set production garp algorithms that have been used by previous researchers darabi et al 2019 without any optimization and hybridization while andaryani et al 2021 evaluated the prediction ability of artificial neural network ann algorithms as a one dimensional flood modelling coupled with hard and soft supervised classification algorithms using three multi layer perceptron mlp fuzzy adaptive resonance theory fart self organizing map som algorithms with different activation functions of sigmoidal linear commitment typicality mlp s and mlp l had slightly higher accuracy and less time consuming despite the contribution of these studies to the science of flood modelling their main issue was to optimize the ml algorithms which can be accompanied by urban flood modelling and highlight uncertainty of flood mapping in one dimension in this study ml techniques in the field of urban flood inundation modelling are applied to facilitate the critical discussion over sari city specifically different flood susceptibility maps were extracted for the study area the flood susceptibility maps were derived by applying rf j48dt cart and lmt models the derived urban flood maps were then compared to the novel hybridized ann sgw as fifth map and the pros and cons of the above mentioned ml algorithms were discussed below 5 2 comparing flood susceptibility maps a novel hybridized ann sgw model for spatial prediction of urban flooding was developed in this study and the resulting map was compared based on different statistical evaluation criteria with maps produced by benchmark models the results demonstrated that the ann sgw model had an excellent performance in flood prone prediction artificial ann models have a powerful ability to predict flood susceptibility as confirmed previously by falah et al 2019 importantly excellent performance of the rf and lmt models in flood susceptibility mapping has been demonstrated previously resulting in strong recommendations for their use as best available models lee et al 2017 pourghasemi et al 2020 demonstrated that in addition to showing outstanding performance in predicting flood susceptibility the rf model can also be used for multi hazard modeling at a regional scale however the results obtained in the present study showed that our novel ann sgw model outperformed rf and other benchmark models in general the sgw meta heuristic algorithm enhances the standalone ann model by narrowing the deviation between predicted and actual values according to the literature the ann model has some problems such as poor generalization ability for unseen data weaker scalability when using several variable types and it needs training to operate and often requires numerous recalibrations piotrowski and napiorkowski 2013 ahmad et al 2014 in this study the sgw algorithm overcame these challenges and the ann sgw model revealed excellent performance computational and robustness speed as found previously for the gwo algorithm by komaki and kayvanfar 2015 guha et al 2016 also found gwo to be useful in enhancing model performance gwo is a novel nature inspired metaheuristic swarm intelligent algorithm and it needs low number of parameters and ease of implementation faster evolutionary programming and quicker convergence than the other swarm intelligence algorithms such as particle swarm optimization pso firefly algorithm fa bat algorithm ba cuckoo search cs ant colony optimization aco artificial bee colony abc and many other algorithms which are recently added to swarm intelligent algorithms are salp swarm algorithm ssa moth flame optimization mfo harris hawks optimization hho squirrel search ss and whale optimization algorithm woa gupta and deep 2020 it has received lots of interest from the heuristic algorithm community for its superior optimization capacity it is also easy to trap into the local optimum when solving complex and multimodal functions gwo has shown potential to solve several real life applications and it was effectively applied in different research areas such as forest fire by bui et al 2019 water resource system over the irrigation areas support vector machine model was optimized based on the gwo gwo svm by liu et al 2020 for optimization of water resources allocation in transboundary river basins by yu and lu 2018 also it has been successfully applied into various global optimization requirements due to its advantage of few control parameters in economic studies jayabarathi et al 2016 landslide susceptibility modeling panahi et al 2020 feature selection hu et al 2020 groundwater contamination and remediation majumder and eldho 2020 and streamflow prediction tikhamarine et al 2020 bui et al 2019 developed a hybridized model based on swarm intelligence model for flood mapping and found that the swarm intelligence algorithm enhanced the predictive skill of the model our novel model can construct a valid flood susceptibility map for urban areas where a hydraulic dataset is lacking it can thus assist in robust flood contingency planning for urban areas importantly for urban areas where flooding presents a pressing challenge the proposed model can be utilized to protect main applied scopes of social and environmental 5 3 variable importance credible information of the relationship between target variables i e urban flood events and predictor variables can help decision makers but these relations are still rather complex and poorly evaluated feng et al 2015 this study tried to bridge this research gap the ann sgw model which had the highest accuracy of all models tested in this study demonstrated that distance from channel distance from river and depth to groundwater were the most important variables for spatial prediction of flood susceptibility in sari city this is useful information for urban planning studies and resolves the problematic of data scarcity by allowing the analyst to focus on important predictor variables ahmadisharaf et al 2016 the results are consistent with our previous finding obtained using genetic algorithm rule set production garp that distance from channel and distance from river had the highest importance in urban flood inundation darabi et al 2019 similarly fernández and lutz 2010 found distance from channel had greatest importance in spatial modeling of flooding in urban areas while ouma and tateishi 2014 found that distance to drainage system is the main factor in urban flooding however according to bui et al 2019 the relative importance of variables for a flood modelling is generally has been influenced by the model structure such that predictor variables making a large influence in a model might provide less information for another and vice versa for instance in the present study and in a previous study by fernández and lutz 2010 cn determined by cover type was the least important predictor variable whereas in our previous study with the garp model cn provided useful information for urban flood modeling darabi et al 2019 it worth mentioning that the dynamic of the conditioning variables in flood inundation mapping leads to different results over time e g precipitation and depth to groundwater 6 conclusions floods have great threats to communities and its property specifically in densely populated urban areas where increasing the impermeable surfaces leads to intensify floods by increasing surface runoff since in developing countries hydraulic and hydrological data are not available over the urban environments and lack of required data is the main issue in urban flood modeling this study set out to develop a robust hybridized model for spatial prediction of urban flood inundation as inspiration and insight for future studies and plans in next urban flood monitoring and mitigation strategies also urban flood inundation identifies the most vulnerable areas based on physical characteristics that determine the propensity for flooding it is an important element of flood mitigation and prevention strategies a novel hybridized model ann sgw was developed and evaluated using statistical evaluation metrics and compared with several benchmark machine learning models the degree of importance of topographic environmental variables was evaluated using the ann sgw model this work can serve as a basis for future studies seeking to predict flood susceptibility in urban areas using hybridized machine learning models and can also be applied in other urban areas where flood inundation presents a pressing challenge also the results of this study can help decision makers attendant investments out of dangerous zones e g riverian zone save property and lives as well as guarantee that investments consider flood events in urban environments with high density population as well as multiple infrastructure such as hospitals schools and service networks our novel hybridized model is an important scientific contribution to development of a powerful model for spatial prediction of flooding in urban environments and the main conclusions of current study can be summarized as the ann sgw model achieved strong predictive capacities outperforming all four benchmark models tested the presented ann sgw model is recommended to use by local and regional municipality agencies to identify flood prone areas and plan to mitigate future flood events the analysis presented in this study provides a valuable screening of urban areas and can easily be modified to incorporate other conditions with other spatio temporal resolutions since the simplicity of flood models is a primary purpose the employed approaches in the current study were not sophisticated with regard to required model and availability of input data therefore it can effortlessly be employed in other areas credit authorship contribution statement hamid darabi conceptualization formal analysis investigation funding acquisition data acquisition methodology software writing original draft writing review editing project administration ali torabi haghighi supervision writing review editing omid rahmati conceptualization methodology software writing original draft writing review editing abolfazl jalali shahrood writing original draft writing review editing sajad rouzbeh data acquisition biswajeet pradhan writing review editing dieu tien bui conceptualization methodology software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the maa ja vesitekniikan tuki r y mvtt to which the authorswould like to express their deep gratitude and authorswould like to thank sari municipality and regional water company of mazandaran for providing relevant data 
4107,in regions with lack of hydrological and hydraulic data a spatial flood modeling and mapping is an opportunity for the urban authorities to predict the spatial distribution and the intensity of the flooding it helps decision makers to develop effective flood prevention and management plans in this study flood inventory data were prepared based on the historical and field surveys data by sari municipality and regional water company of mazandaran iran the collected flood data accompanied with different variables digital elevation model and slope have been considered as topographic variables land use land cover precipitation curve number distance to river distance to channel and depth to groundwater as environmental variables were applied to novel hybridized model based on neural network and swarm intelligence grey wolf algorithm nn sgw to map flood inundation several confusion matrix criteria were used for accuracy evaluation by cutoff dependent and independent metrics e g efficiency e positive predictive value ppv negative predictive value npv area under the receiver operating characteristic curve auc the accuracy of the flood inundation map produced by the nn sgw model was compared with that of maps produced by four state of the art benchmark models random forest rf logistic model tree lmt classification and regression trees cart and j48 decision tree j48dt the nn sgw model outperformed all benchmark models in both training e 90 5 ppv 93 7 npv 87 3 auc 96 3 and validation e 79 4 ppv 85 3 npv 73 5 auc 88 2 as the nn sgw model produced the most accurate flood inundation map it can be employed for robust flood contingency planning based on the obtained results from nn sgw model distance from channel distance from river and depth to groundwater were identified as the most important variables for spatial prediction of urban flood inundation this work can serve as a basis for future studies seeking to predict flood susceptibility in urban areas using hybridized machine learning ml models and can also be applied in other urban areas where flood inundation presents a pressing challenge and there are some problems regarding required model and availability of input data keywords flood inundation flood inventory gis nn sgw model confusion matrix 1 introduction floods occur due to a sudden rise in river water levels caused by snowmelt or intense precipitation peyravi et al 2019 or to failure of a hydraulic structure e g ashley and ashley 2008 catastrophic local flooding has been reported throughout the world e g the giofyros river in greece in 1994 the aude river in france in 1999 and the trisanna river in austria in 2005 marchi et al 2010 previous studies have considered flooding as a natural hazard in fluvial systems and have examined flash floods along floodplains hosseini et al 2020 but less attention has been paid to urban flooding chen et al 2009 urban areas are prone to flooding owing to their widespread use of impervious materials for rooftops streets and roads schubert and sanders 2012 pirnia et al 2019 which is known to increase the volume and rate of surface runoff shuster et al 2005 du et al 2015 climate change and its impact on the intensity of rainfall chang et al 2010 sea level rise hallegatte et al 2011 and inefficiency of old infrastructures can further increase the frequency of urban flood disasters schubert and sanders 2012 moreover increasing the population and urbanization are leading to expand urban areas in the flood prone areas which magnifies the scale of damage caused by urban flooding neumann et al 2015 the most damaging consequences of urban flooding can be contamination with sewage water traffic jams disruption of water and power supply damage to transportation systems infrastructure failure injury and loss of life jonkman and vrijling 2008 spatial modeling and mapping of the urban flood help the urban authorities to predict the spatial distribution of the flooding zones and its intensity therefore decision makers and authorities could develop effective flood prevention and management plans using a well developed systematic framework and optimized models torres et al 2014 recently several attempts have been made to analyze the interactions between urbanized areas and drainage infrastructures and the impact on surface runoff schmitt et al 2004 chen et al 2009 darabi et al 2019 progress in computational methods and availability of spatial data now permit more accurate modeling of the dynamic processes of flooding and urban flood prediction mitigation and risk management fewtrell et al 2008 model optimization is vital when one optimum solution needs to be identified among others marler and arora 2004 and it is especially important when analytical methods cannot solve the problem within the required time deb 2012 for example meta heuristic algorithms can be combined to exploit their advantages and overcome their weaknesses and thus obtain more accurate results yagiura and ibaraki 2001 several attempts have been made to construct hybrid optimized models by utilizing different existing models e g genetic algorithm ga and ant colony optimization aco liu et al 2017 simulated annealing sa and particle swarm optimization pso javidrad and nazari 2017 sa and whale optimization algorithm woa mafarja and mirjalili 2017 or pso and grey wolf optimizer gwo şenel et al 2019 these hybrid optimized models utilize the abilities of one algorithm to neutralize the deficiencies of another e g the inability of ga for local searches can be solved by combining it with the bee algorithm ba şenel et al 2019 artificial neural network ann models have been utilized in different engineering fields due to the strength of neural networks in non linearity and data driven aspects beside of the well documented advantages for using ann e g low cost of the model construction and flexible capability on input output mapping for complex systems which make it extensively used for prediction of dynamic variables such as geographical information the main mentioned drawbacks of ann are the large amounts of the training data required particularly for manners with many layers extensive training time high probability of over fitting and difficulty of interpreting chen et al 2020 optimization of ann is required to overcome its main shortcomings which are lack of explanatory power in the trained networks due to their complex structure and over fitting problems wen et al 2019 sessarego et al 2020 following the previous study darabi et al 2019 and using data provided by darabi et al 2019 the aim of this study was to utilize and compare the four commonly used ml algorithms including random forest rf logistic model tree lmt classification and regression trees cart j48 decision tree j48dt with new optimized ann model for spatial prediction of urban flooding with the swarm intelligence grey wolf sgw algorithm as a heuristic technique inspired by bird flocking wolf pack hunting and their social psychology le et al 2009 this can be led to reduce the number of inputs to the ann and select the most effective conditioning variables 2 study area the study area is sari city located in northern iran extended between 35 58 39 to 36 50 12 north and 52 56 42 to 53 59 32 east where is characterized as lowland with altitude ranges between 9 and 82 m above sea level a s l fig 1 the city occupies an area of approximately 42 km2 and it is the second major city in the mazandaran province it is the capital of mazandaran province with a population of 296 417 according to the 2016 census the city is characterized by built up areas in the center surrounded by agricultural land small areas of orchards and different types of natural environment mean annual precipitation in the region is 734 mm and mean annual temperature is 13 6 c darabi et al 2019 the city is located in the outlet of the tajan basin the city of sari receives most of the surface runoff by the rainy streams due to its location and is bordered by high mountains to the south of the tajan river passing through the eastern part of the city in the recent years one of the main causes of the flooding over the sari city were river floods sharifinia 2019 during each year prolonged heavy precipitation importantly created large volumes of surface runoff which triggered a significantly the urban flood over the sari city in addition the city of sari is characterized as lowland and it has few drainage networks and most of them have been constructed for several years ago which are old and have low capacity therefore the surface runoff flow cannot be discharged in time when heavy precipitation occurs which leads to serious water accumulation and make inundated areas abdi et al 2019 hydro climate data for the present study were used from the iranian meteorological organization irimo for sari synoptic station 3 methodology 3 1 urban flood locations in situ analyses and sampling all available historical data on floods was used as auxiliary data flood and non flood locations during the several past flood events also flood inventory data were obtained by historical and field surveys data which were conducted by sari municipality and regional water company of mazandaran to identify flooded areas and non flooded areas during high intensity precipitation table 1 shows the available historical database 2007 2016 and collected field survey databases 2017 2019 on floods two equal sets of points were identified randomly for both categories of flood and non flood areas therefore 113 locations for each category were recorded using a global positioning system gps device each set is divided into training 70 of data 79 points and testing 30 of data 34 points groups the flood locations were allocated by a value of 1 and non flood locations were assigned by a value of 0 all historical database for flooded areas which were updated and employed in the current study have been already used in the previous study by darabi et al 2019 3 2 conditioning variables in flood inundation mapping eight conditioning factors were tested in flood susceptibility mapping elevation slope distance to channel distance to river land use land cover precipitation curve number cn and depth to groundwater all urban flood conditioning factors which used in this study have been already applied in the previous study by darabi et al 2019 precipitation data on daily precipitation from meteorological for 16 stations in mazandaran province obtained from irimo for 1989 2018 period were applied to extract a spatial rainfall map by applying the kriging interpolation method in arcgis gis 10 5 the mean annual precipitation varied from 722 mm in the east to 745 mm in the west and northwest of the study area fig 2 a land use land cover the land use land cover map was obtained from sari city authority darabi et al 2019 based on the land use data fig 2b seven categories of land cover were recognized residential road street open space agricultural bare land orchard and water body river digital elevation model dem a dem with 5 m resolution was prepared in arcgis 10 5 by applying the kriging interpolation method of interpolation points fig 2c the attitude of the sari city ranges from 9 m asl in the north and northeast to 82 m asl in the south the database of the elevation was obtained from sari municipality slope slope percent plays an important role in flood susceptibility as it affects runoff velocity and intensity of flow a slope percent map 5 m was prepared using the dem in arcgis 10 5 slope percent was divided into four classes 2 2 4 4 6 and 6 based on the classification used by sari city authority fig 2d curve number cn curve number is a function based on hydrological conditions and land use land cover soil type and moisture which was first developed by uscs or united states soil conservation service land use land cover and hydrological soil group hsg maps of the sari city were used to prepare a cn map in arcgis 10 5 fig 2e by the arccn runoff tool darabi et al 2019 distance to river distance to river has an important role in flood prone areas in riversides distance to the tajan river which passes through the east of sari city was extracted using the euclidean distance module in arcgis 10 5 fig 2f distance to channel surface water is collected by urban channels which should have sufficient capacity to drain all surface water from the city the channels in sari city do not have such capacity so it is very important to consider distance to channels as a flood conditioning factor distance to channel was extracted using the euclidean distance module in arcgis 10 5 fig 2g depth to groundwater in urban areas depth to groundwater level significantly affects surface water runoff howard and gerber 2018 in this study depth to groundwater data were obtained from the irimo and groundwater level map were extracted from 28 piezometric wells by the interpolation method by integrated distance weighting idw in arcgis 10 5 fig 2h 3 3 machine learning ml algorithms machine learning ml aims to develop methods and algorithms to learn and forecast data ml algorithms are important for several reasons e g they can i handle complex systems with huge data ii solve specialized problems by specialized ml methods iii be used for forecasting and classification purposes and iv be applied to describe the performance of the data input with respect to historical data records demolli et al 2019 in this study four commonly used ml algorithms including random forest rf logistic model tree lmt classification and regression trees cart j48 decision tree j48dt were employed as standard or benchmark models for judging the performance of the novel hybridized model 3 3 1 random forest rf the concept of random forest rf was first proposed by ho 1998 and extended by breiman 2001 rf as a powerful ensemble ml algorithm was developed by the combination of regression and classification methods and statistical theory tan et al 2020 it can be employed for many predicted trends and the average prediction of decision trees xing et al 2019 the rf algorithm has been employed in different fields such as land cover classification using remote sensing data and flood risk and hazard mapping zhao et al 2018 the algorithm has two main advantages that improve the accuracy of prediction i its ability to handle huge datasets with a nonparametric and robust method and correlated conditional variables and ii its capacity for variable importance assessments using a random arrangement of the variables by comparison and evaluation of each variable in the prediction results for its importance zhao et al 2018 3 3 2 j48 decision tree j48dt j48 decision tree j48dt is a new classification tree based technique that has been employed in only a few studies predictive ability of the algorithm has been assessed and validated in a previous study using statistical and receiver operating characteristic roc curve methods pham et al 2017 for binary classification variables here flood or non flood locations j48dt creates a tree which includes a root node and internal branch and leaf nodes the root node consists of the input dataset the internal branch nodes relate to the decision function and the leaf nodes indicate the production of a specified contribution of the dataset compared with other decision tree models j48dt is considered best in terms of classification accuracy which is trained in two steps i building and ii pruning the classification tree zhao and zhang 2008 3 3 3 classification and regression tree cart classification and regression tree cart is a recursive partitioning algorithm that used to predict continuous dependent and categorical predictor conditioning factors zhao et al 2016 cart which was proposed for the first time by breiman et al 1984 has gained in popularity during recent years however because of overfitting and high sensitivity of cart to minor changes in all training input data it is viewed as an unstable ml algorithm erdal and karakurt 2013 3 3 4 logistic model tree lmt logistic model tree lmt a ml algorithm suggested by landwehr et al 2003 is a hybrid classification model combining logistic regression lr with decision tree dt functions which can boost the precision of prediction chen et al 2017 in lmt variable splitting is performed with the maximum information ratio obtained for splitting categorical and numerical variables with c specific values the node has c child nodes and two child nodes respectively lee and jun 2018 for pruning the nodes of the tree the lmt algorithm employs a logit boost function to set up the logistic regression method and it uses cross validation to discover multiple logit boost iterations to stop overfitting of all training input data arabameri et al 2020 3 3 5 artificial neural network ann models neural network models are a set of meta heuristic population based optimization algorithms computational nn models have been broadly employed in different scientific fields for prediction purposes in most cases madsen et al 2017 zhang et al 2020 the ann model has strong self learning self compatibility fitness error tolerance and extension capabilities inspired by biological nervous systems it shows high performance in fitting multivariate analysis by better learning efficiency zhao et al 2019 the purpose of ann model optimization is to get an optimum solution shirwaikar et al 2019 within the data mining field the ann algorithm has been used to solve many practical problems in this study it was used for urban flood susceptibility mapping 3 3 6 swarm intelligence algorithm the swarm intelligence algorithm is one of the major popular optimization models applied by researchers in different subfields arani et al 2013 yang 2014 during recent years the swarm intelligence algorithm has been used to imitate behavior in nature şenel et al 2019 e g to understand crowd behavior in biological systems qasim and bhatti 2019 it is one of a family of nature inspired modeling approaches based on the collective behavior of social swarms in nature e g honeybees ant colonies birds fish however the swarm intelligence algorithm seeks to identify an optimal result from the social actions of many individuals mosa et al 2019 according to the premise that individuals interactions lead to intelligent behaviors at group level zedadra et al 2018 it comprises three steps i initialize the swarm of predictor variables as dimensional space ii set parameters of the swarm algorithm e g maximum iteration and population and iii predict a robustness value and randomly determine the primary best situation bui et al 2019 3 3 7 grey wolf optimizer gwo grey wolf optimizer is a novel bionic population based and heuristic optimization algorithm that forms a pyramid with the most influential wolf at the remaining wolves in descendant importance in lower situations bui et al 2019 gwo was developed by mirjalili et al 2014 according to the social hunting nature of grey wolves it mathematically mimics the social leadership hierarchy and hunting behavior based on the grey wolves working together to detention prey with a clear cooperation the gwo algorithm for predation is divided into three stages encircling hunting and attacking long 2016 niu et al 2019 gwo with its low number of parameters and ease of implementation has faster evolutionary programming and faster convergence than the swarm intelligence algorithm daniel et al 2017 gwo was effectively applied in a forest fire research by bui et al 2019 search agents wolves in gwo as swarm based algorithms are arbitrarily situated in the d dimensional space after each iteration the positioned and fitness values of wolves search agents are updated the optimal solution to the problem at hand is the final location of the top wolf bui et al 2019 3 4 designing and proposing a neural network model optimized by swarm intelligence and grey wolf algorithms ann sgw optimization of models is important to achieve an optimum solution in a complicated d dimensional space when the problem solving needs too much time optimized approaches can help however an overall optimized algorithm is not guaranteed şenel et al 2019 optimization is also a crucial activity in model design allowing programmers and planners to produce better designs which can save time and costs many optimization problems in engineering are complex and difficult to solve with conventional optimization models such as mathematical programming by hybridizing a model with different algorithms it is possible to combine the advantages of the algorithms and produce a better optimized model cui and bai 2019 jia et al 2019 in this study an ann model was optimized using novel optimizer algorithms swarm intelligence and gwo in a parallel computing approach to improve spatial prediction of urban inundation susceptibility the optimized model ann sgw was used to recognize the most flood prone areas in the study city compared with actual data the proposed ann sgw model has a simple construction with a low number of factors and simulations avoiding the complexity of large scale networks and combines the advantages of swarm intelligence and gwo with those of ann 3 5 loss function and optimization algorithm the ann model was first generated for spatial prediction of urban flooding and then optimized using the sgw algorithms the purpose of optimization was to search and identify the best weights of the model in which the difference between flood inventory data and predicted flood locations is minimized the difference was determined using a loss function lof designed as follows bui et al 2019 1 l o f 1 n p r e d i t a g i n where p r e d i is predicted flood in the ann model output t a g i is the actual flood measured value and n is the number of total flood locations used parameters used in the sgw algorithm were g0 100 α 20 ω 0 5 c1 1 c2 3 and population size 5 as suggested by jayaprakasam et al 2015 the training process was run for 200 iterations 3 6 model assessment and benchmark model comparison in statistical analysis of data mining techniques a known error matrix is the confusion matrix which allows the performance of supervised models to be assessed here we used nine different cutoff dependent metrics from the confusion matrix namely true positive and negative tp and tn false positive and false negative fp and fn positive and negative predictive values ppv and npv sensitivity specificity and efficiency the four elements of the confusion matrix are tp tn fp and fn frattini et al 2010 sensitivity true positive rate tpr see equation 2 specificity false positive rate fpr see equation 3 and efficiency e equation 4 determine the proportion of actual flooded locations that are accurately identified the other cutoff dependent metrics used ppv and npv are the ratio of positive and negative results respectively in statistical analysis equations 5 and 6 and thus explain model performance by applying primary statistical criteria tp and tn in the confusion matrix fletcher et al 2018 using the pmt tool all cutoff dependent metrics used for model performance assessment were applied rahmati et al 2019 area under the curve receiver operating characteristic curve auc roc a cutoff independent metric was also used equation 7 as it is effective in organizing models and assessing their performance visually fawcett 2006 it is known as a decisive metric where values closer to 100 indicate better performance of a model pontius and schneider 2001 2 s e n s i t i v i t y 3 s p e c i f i c i t y fp fp t n 4 efficiency tp t n tp t n f p f n 5 ppv tp tp f p 6 npv tn tn f n 7 auc 0 1 f f p r d f p r 1 0 1 f t p r d t p r 4 results 4 1 training the ann sgw model and performance assessment the results for goodness of fit of the ann sgw model are shown in table 2 among the cutoff dependent evaluation metrics the value obtained for ppv npv sensitivity specificity and efficiency in the training step was 93 7 87 3 88 1 93 2 and 90 5 respectively the results of the confusion matrix criteria indicate a considerable arrangement between the trained model and observed dataset auc a cutoff independent metric had a value of 96 3 in this step reflecting high fitting skill of the ann sgw model there was therefore agreement between the cutoff dependent and independent metrics as regards performance of the model however goodness of fit individually estimates how well the model fits the training dataset and cannot be used for determining the ability of the model in prediction tehrany et al 2015 a testing step is needed to determine the predictive performance in the validation step the ann sgw model showed considerably maximum predictive performance based on both the cutoff independent metrics ppv 85 3 npv 73 5 sensitivity 76 3 specificity 83 3 efficiency 79 4 and the cutoff independent metric auc 88 2 and evaluation criteria table 2 fig 3 the validation results obviously demonstrated robust arrangement between observed values i e reference data and predicted values by the ann sgw model following rahmati et al 2020 the predictive performance of ann sgw can be classified as very good 80 auc 90 4 2 comparison of the ann sgw model with benchmark models to confirm the performance of the ann sgw model its predictive ability was compared with that of four commonly used benchmark models rf lmt cart j48dt among these rf showed the highest accuracy in the training step in terms of both the cutoff dependent ppv 87 3 npv 72 2 sensitivity 75 8 specificity 85 1 efficiency 79 7 and cutoff independent auc 89 4 evaluation metrics table 3 it was followed by lmt ppv 84 8 npv 69 6 sensitivity 73 6 specificity 82 1 efficiency 77 2 auc 80 and then j48dt ppv 87 3 npv 63 3 sensitivity 70 4 specificity 83 3 efficiency 75 3 auc 72 9 and cart ppv 77 2 npv 67 1 sensitivity 70 1 specificity 74 6 efficiency 72 1 auc 72 2 therefore agreement was obtained between observed values and values predicted by the benchmark models in the training step importantly comparison of all results indicated that the ann sgw model had the highest goodness of fit followed by rf lmt j48dt and cart the validation results for the benchmark models are shown in table 4 and fig 4 again rf outperformed the other benchmark models based on cutoff dependent ppv 94 12 npv 58 82 sensitivity 69 57 specificity 90 91 efficiency 76 47 and cutoff independent auc 88 1 evaluation metrics it was followed by lmt ppv 91 18 npv 55 88 sensitivity 67 39 specificity 86 39 efficiency 73 53 auc 75 6 and then cart auc 69 8 and j48dt auc 69 7 therefore the proposed ann sgw model auc 88 2 had higher predictive performance than all benchmark models based on both cutoff dependent and independent assessment metrics 4 3 variable importance since the ann sgw model showed the highest accuracy in both the training and testing dataset importance of the variable has been calculated by the ann sgw model fig 5 illustrates the relative importance ri of predictor variables in spatial modeling of urban flood susceptibility distance from channel distance from river and depth to groundwater had the greatest importance in urban inundation with ri equal to 31 22 and 19 respectively they were followed by precipitation ri 11 land use ri 10 and curve number ri 7 4 4 urban inundation susceptibility mapping the urban flood inundation maps were generated by the ann sgw and benchmark models are shown in fig 6 and fig 7 upon preliminary review distribution of high flood susceptibility zones seemed to be clearly distinguished over the sari city especially all the proposed ann sgw and benchmark models revealed a comparatively similar pattern of flood susceptibility in the sari city fig 6 and fig 7 central northern western and southwestern parts of sari city fell under highly flood susceptible areas while eastern southern and southeastern parts showed significantly fewer flood susceptibility zones 5 discussion 5 1 urban flood mapping approaches flood prediction in urban environments is important for urban planners and policymakers in order to reduce susceptibility to future floods kim et al 2015 different methodologies for urban flood assessment were considered and discussed by previous researchers using probabilistic and deterministic approaches di baldassarre et al 2009 high resolution of topographic modeling abily et al 2016 hydrodynamic numerical modeling glenis et al 2018 costabile et al 2020 dong et al 2021 recently numerous works have been conducted to improve the predictive capacity of the one dimensional urban flood modeling but so far it is noticeable that these attempts are still far from a satisfactory application of these models in urban flood prediction for example eini et al 2020 assessed the hazard and vulnerability of urban flood using maximum entropy maxent and genetic algorithm rule set production garp algorithms that have been used by previous researchers darabi et al 2019 without any optimization and hybridization while andaryani et al 2021 evaluated the prediction ability of artificial neural network ann algorithms as a one dimensional flood modelling coupled with hard and soft supervised classification algorithms using three multi layer perceptron mlp fuzzy adaptive resonance theory fart self organizing map som algorithms with different activation functions of sigmoidal linear commitment typicality mlp s and mlp l had slightly higher accuracy and less time consuming despite the contribution of these studies to the science of flood modelling their main issue was to optimize the ml algorithms which can be accompanied by urban flood modelling and highlight uncertainty of flood mapping in one dimension in this study ml techniques in the field of urban flood inundation modelling are applied to facilitate the critical discussion over sari city specifically different flood susceptibility maps were extracted for the study area the flood susceptibility maps were derived by applying rf j48dt cart and lmt models the derived urban flood maps were then compared to the novel hybridized ann sgw as fifth map and the pros and cons of the above mentioned ml algorithms were discussed below 5 2 comparing flood susceptibility maps a novel hybridized ann sgw model for spatial prediction of urban flooding was developed in this study and the resulting map was compared based on different statistical evaluation criteria with maps produced by benchmark models the results demonstrated that the ann sgw model had an excellent performance in flood prone prediction artificial ann models have a powerful ability to predict flood susceptibility as confirmed previously by falah et al 2019 importantly excellent performance of the rf and lmt models in flood susceptibility mapping has been demonstrated previously resulting in strong recommendations for their use as best available models lee et al 2017 pourghasemi et al 2020 demonstrated that in addition to showing outstanding performance in predicting flood susceptibility the rf model can also be used for multi hazard modeling at a regional scale however the results obtained in the present study showed that our novel ann sgw model outperformed rf and other benchmark models in general the sgw meta heuristic algorithm enhances the standalone ann model by narrowing the deviation between predicted and actual values according to the literature the ann model has some problems such as poor generalization ability for unseen data weaker scalability when using several variable types and it needs training to operate and often requires numerous recalibrations piotrowski and napiorkowski 2013 ahmad et al 2014 in this study the sgw algorithm overcame these challenges and the ann sgw model revealed excellent performance computational and robustness speed as found previously for the gwo algorithm by komaki and kayvanfar 2015 guha et al 2016 also found gwo to be useful in enhancing model performance gwo is a novel nature inspired metaheuristic swarm intelligent algorithm and it needs low number of parameters and ease of implementation faster evolutionary programming and quicker convergence than the other swarm intelligence algorithms such as particle swarm optimization pso firefly algorithm fa bat algorithm ba cuckoo search cs ant colony optimization aco artificial bee colony abc and many other algorithms which are recently added to swarm intelligent algorithms are salp swarm algorithm ssa moth flame optimization mfo harris hawks optimization hho squirrel search ss and whale optimization algorithm woa gupta and deep 2020 it has received lots of interest from the heuristic algorithm community for its superior optimization capacity it is also easy to trap into the local optimum when solving complex and multimodal functions gwo has shown potential to solve several real life applications and it was effectively applied in different research areas such as forest fire by bui et al 2019 water resource system over the irrigation areas support vector machine model was optimized based on the gwo gwo svm by liu et al 2020 for optimization of water resources allocation in transboundary river basins by yu and lu 2018 also it has been successfully applied into various global optimization requirements due to its advantage of few control parameters in economic studies jayabarathi et al 2016 landslide susceptibility modeling panahi et al 2020 feature selection hu et al 2020 groundwater contamination and remediation majumder and eldho 2020 and streamflow prediction tikhamarine et al 2020 bui et al 2019 developed a hybridized model based on swarm intelligence model for flood mapping and found that the swarm intelligence algorithm enhanced the predictive skill of the model our novel model can construct a valid flood susceptibility map for urban areas where a hydraulic dataset is lacking it can thus assist in robust flood contingency planning for urban areas importantly for urban areas where flooding presents a pressing challenge the proposed model can be utilized to protect main applied scopes of social and environmental 5 3 variable importance credible information of the relationship between target variables i e urban flood events and predictor variables can help decision makers but these relations are still rather complex and poorly evaluated feng et al 2015 this study tried to bridge this research gap the ann sgw model which had the highest accuracy of all models tested in this study demonstrated that distance from channel distance from river and depth to groundwater were the most important variables for spatial prediction of flood susceptibility in sari city this is useful information for urban planning studies and resolves the problematic of data scarcity by allowing the analyst to focus on important predictor variables ahmadisharaf et al 2016 the results are consistent with our previous finding obtained using genetic algorithm rule set production garp that distance from channel and distance from river had the highest importance in urban flood inundation darabi et al 2019 similarly fernández and lutz 2010 found distance from channel had greatest importance in spatial modeling of flooding in urban areas while ouma and tateishi 2014 found that distance to drainage system is the main factor in urban flooding however according to bui et al 2019 the relative importance of variables for a flood modelling is generally has been influenced by the model structure such that predictor variables making a large influence in a model might provide less information for another and vice versa for instance in the present study and in a previous study by fernández and lutz 2010 cn determined by cover type was the least important predictor variable whereas in our previous study with the garp model cn provided useful information for urban flood modeling darabi et al 2019 it worth mentioning that the dynamic of the conditioning variables in flood inundation mapping leads to different results over time e g precipitation and depth to groundwater 6 conclusions floods have great threats to communities and its property specifically in densely populated urban areas where increasing the impermeable surfaces leads to intensify floods by increasing surface runoff since in developing countries hydraulic and hydrological data are not available over the urban environments and lack of required data is the main issue in urban flood modeling this study set out to develop a robust hybridized model for spatial prediction of urban flood inundation as inspiration and insight for future studies and plans in next urban flood monitoring and mitigation strategies also urban flood inundation identifies the most vulnerable areas based on physical characteristics that determine the propensity for flooding it is an important element of flood mitigation and prevention strategies a novel hybridized model ann sgw was developed and evaluated using statistical evaluation metrics and compared with several benchmark machine learning models the degree of importance of topographic environmental variables was evaluated using the ann sgw model this work can serve as a basis for future studies seeking to predict flood susceptibility in urban areas using hybridized machine learning models and can also be applied in other urban areas where flood inundation presents a pressing challenge also the results of this study can help decision makers attendant investments out of dangerous zones e g riverian zone save property and lives as well as guarantee that investments consider flood events in urban environments with high density population as well as multiple infrastructure such as hospitals schools and service networks our novel hybridized model is an important scientific contribution to development of a powerful model for spatial prediction of flooding in urban environments and the main conclusions of current study can be summarized as the ann sgw model achieved strong predictive capacities outperforming all four benchmark models tested the presented ann sgw model is recommended to use by local and regional municipality agencies to identify flood prone areas and plan to mitigate future flood events the analysis presented in this study provides a valuable screening of urban areas and can easily be modified to incorporate other conditions with other spatio temporal resolutions since the simplicity of flood models is a primary purpose the employed approaches in the current study were not sophisticated with regard to required model and availability of input data therefore it can effortlessly be employed in other areas credit authorship contribution statement hamid darabi conceptualization formal analysis investigation funding acquisition data acquisition methodology software writing original draft writing review editing project administration ali torabi haghighi supervision writing review editing omid rahmati conceptualization methodology software writing original draft writing review editing abolfazl jalali shahrood writing original draft writing review editing sajad rouzbeh data acquisition biswajeet pradhan writing review editing dieu tien bui conceptualization methodology software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by the maa ja vesitekniikan tuki r y mvtt to which the authorswould like to express their deep gratitude and authorswould like to thank sari municipality and regional water company of mazandaran for providing relevant data 
4108,with the severe shortages and increasing demands of water and energy resources water and energy system analysis and management have attracted more and more attentions recently in this study a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe is developed for supporting integrated planning of water and energy nexus at a regional scale the developed pfrwe model has improved upon the existing methods for water energy nexus through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework robustness of the model and solution processes will be improved including optimality robustness and feasibility robustness based on the preferences of decision makers application of the pfrwe model to a real world case study in liaoning province china has tested its applicability in regional water energy nexus system management optimal decisions on the amounts of water production and electricity generation new power and water plants construction the types of new power and water plants amounts of water consumption for electricity generation amounts of electricity consumption for water production and amounts of imported electricity are obtained tradeoffs between robustness and water production electricity generation imported electricity and expected total system profit are analyzed by comparing the solutions of the pfrwe model and the deterministic model it is found that the pfrwe model has advantages in maintaining feasibility and reducing variations of objective value under higher robustness or optimizing objective value under lower robustness keywords water energy nexus fuzzy uncertainty robustness nonlinear mixed integer optimization 1 introduction with the rapid growth of population and economics global demands for both water and energy resources have sharply increased in the past years bazilian et al 2011 gold and webber 2015 water and energy have close connection and interdependence which is named water energy nexus wen or sometimes referred to energy intensity ei bauer et al 2014 rabia et al 2015 water resources are required in the processes of energy production transportation and consumption water withdraw supply delivery consumption draining and treatment require energy it is estimated that approximately 15 of the total global generated water is used for energy and approximately 8 of the generated energy globally is used for water tsolas et al 2018 however many of the existing policies and decisions didn t consider water and energy as a whole leading to their ineffectiveness in management of these two types of resources further resource shortages and even environmental damage integrated management of water and energy is an important means of saving resources ensuring sustainable economic development and reducing adverse environmental impacts previously numerous crisp mathematical models were developed for water and energy system planning and management basheer and ahmed elagib 2019 campana et al 2018 ding et al 2020 gjorgiev and sansavini 2017 hong et al 2019 inas et al 2017 li 2018 zhang and vesselinov 2017 however these models did not consider the possible impacts of the parameters with subjective uncertainties on the modeling solutions loucks and van beek 2017 to deal with the subjective uncertainties brought by incomplete knowledge and imprecise information from decision makers or experts the fuzzy possibilistic programming fpp was developed and applied chen et al 2019 chen et al 2020 dai et al 2014 lu et al 2018 sun et al 2019 yu et al 2016 zhang and vesselinov 2016 in fpp uncertain parameters are of vagueness and ambiguity and can be expressed as fuzzy sets characterized by a fuzzy membership characteristic function for example yu et al 2020 combined fpp with copula based random programming and interval parameter programming to help decision makers identify the desired electricity supply patterns and analyze interactions between water resources availability and electricity consumption in water energy nexus system yu et al 2020 in addition the constraints of the model may become less stringent with the changing external conditions and be allowed to be violated within a tolerance range meseguer et al 2006 the fuzzy flexible programming flp can take into account the issues of violating model constraints abdelaziz et al 2004 lee and wen 1996 li and huang 2009 tsakiris and spiliotis 2004 zhang and rong 2010 in flp fuzzy uncertainties exist in the constraints which means the constraints can be partially satisfied for example li et al 2013 integrated flp and interval linear programming to identify the optimal power coal blending process based on a consideration of national standard for coals in burning boilers li et al 2013 zhou et al 2013 integrated flp inexact linear programming and multi objective programming for dealing with industrial structure optimization problems under uncertainty zhou et al 2013 although fpp and flp can handle the fuzzy uncertainties in the parameters and the constraints respectively they are not effective in dealing with the robustness of the solutions which is desired by decision makers without robustness the optimal value of objective function will have great difference from each other and the solution will become infeasible under different chosen values of fuzzy parameters thus decision makers are always more satisfied with robust model and solution processes robust programming provides a viable option for tackling the abovementioned issue it can make sure the optimal value of the objective function to be close to optimal values under all possible values of uncertainty parameters and ensure the solution to remain in feasible regions given different values of uncertain parameters by introducing the concepts of optimality robustness and feasibility robustness robust programming has been widely developed and applied in a number of fields such as supply and transportation planning of liquefied natural gas lng sangaiah et al 2020 sustainable sugarcane to bioethanol supply chain network design gilani et al 2020 planning of fast charging stations zhou et al 2020 seaport dry port network design tsao and thanh 2019 water quality management zhou et al 2019 closed loop supply chain network design ghahremani nahr et al 2019 agricultural water resources allocation fu et al 2018 flood management ding et al 2017 many studies have applied robust programming to the fields of water and energy system planning for example zhang et al 2009 developed a robust chance constrained fuzzy possibilistic programming rcfpp model by combining fuzzy possibilistic programming with fuzzy robust programming and chance constrained programming for water quality management within an agricultural system zhang et al 2009 yu et al 2017 proposed a robust flexible probabilistic programming rfpp method by combining robust flexible programming with chance constrained programming and interval parameter programming for planning municipal energy system yu et al 2017 however few of them was applied to water energy nexus system and combined with fuzzy programming in this study by integrating fuzzy possibilistic programming fuzzy flexible programming and robust programming into a general framework robust solutions are obtained under fuzzy uncertainties the objective of this study is to develop a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe for supporting integrated planning of water and energy nexus at a regional scale the developed pfrwe model has improved upon the existing methods for water energy nexus through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework fuzzy uncertainties existing in the modeling parameters and the constraints will be effectively quantified nonlinearity of the pfrwe model will be dealt with using a linearization method making the model suitable for large scale practical applications robustness of the model and solution processes will be improved including optimality robustness and feasibility robustness by dynamic adjustment of the penalty on the deviation between optimal objection under present uncertainty and hard worst case and the satisfaction on the designed constraints based on the preferences of decision makers optimal decisions on the amounts of water production and electricity generation whether to construct new power and water plants the types of new power and water plants amounts of water consumption for electricity generation amounts of electricity consumption for water production and amounts of imported electricity will be obtained the proposed pfrwe model will be applied to a real world case study in liaoning province china to demonstrate its applicability tradeoffs between robustness and expected total system profit water production electricity generation and imported electricity are analyzed the results obtained from the pfrwe model are helpful for planning and management of water energy nexus systems in practices to show the advantages of the pfrwe model in enhancing the robustness solutions of the pfrwe model and deterministic model are compared 2 model development 2 1 problem description a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe has been developed based on the water energy nexus shown in fig 1 to generate the optimal solutions for sustainable development of water and energy resources in the pfrwe model four types of water resources i e surface water groundwater desalinated sea water and recycle water and eight types of energy resources i e coal fired gas fired nuclear power biomass solar power wind power hydropower plants and imported electricity are considered the interdependence between water and energy such as water consumptions for primary energy extraction and electricity generation and electricity consumptions for water production is analyzed the fuzzy uncertainties existing in costs allowances resources demands availability and maximum productivity capabilities of water and power plants are quantified through triangular fuzzy membership functions the planning issues include i new power and water plants construction decision ii types of new power plants and new water plants iii quantity of electricity generation and water production iv quantity of water for electricity generation and electricity for water production and v amounts of imported electricity 2 2 model formulation the pfrwe model is formulated for water energy nexus management at a regional scale decision variables include continuous decision variables such as total amounts of water production in each water plant total amounts of electricity generation in each power plant amounts of water supplied to each power plant amounts of electricity supplied to each water plant quantity of water or electricity generation for social demand and amounts of imported electricity imported water is calculated in available surface water and integer decision variables for indicating whether to construct the new power or water plants 1 yes 0 no all the nomenclatures are listed in appendix a the management objective of the pfrwe model is to maximize expected total system profit which includes 1 allowance for the construction of new power plants f 1 2 allowance for the construction of new water plants f 2 3 cost for construction of new power plants f 3 4 cost for construction of new water plants f 4 5 allowance for electricity generation f 5 6 allowance for water production f 6 7 variable costs for electricity generation such as cost of water consumption in power plants and cost of other resources materials and labor services f 7 8 variable costs for water production including cost of electricity consumption in water plants and cost of other resources materials and labor services f 8 9 electricity selling revenues f 9 10 water selling revenues f 10 and 11 cost for imported electricity f 11 the formulas of the objective function are presented in appendix b b1 b12 the parameters of objective function are shown in fig 2 the index shows the meaning of the parameters superscripts subscripts and the parameters of allowance prices and costs are also shown in different rectangles the variables are displayed in three parts 1 water and power plant production and construction variables 2 variables related to imported electricity and 3 water and electricity for social demand the plus and minus sign above the arrow represents the contribution made by the parameters the plus sign represents that the parameters increase the total system profit and the minus sign is the opposite the specific part of f 1 f 10 is marked below the arrow the constraints in the pfrwe model are summarized in table 1 and the formulas are presented in appendix b b13 b33 the relationships among the modeling parameters in the constraints are shown in fig 3 2 3 solution method the pfrwe model can be reformulated as a general nonlinear robust possibilistic flexible programming model without loss of generalization as follows min c 1 u c 2 v s t a u b aeq u 0 1 v 0 1 u 0 where u te p i p o ew p i p q j q oo ew p i p q l q on y q l q eo p i p o tw q j q o we q j q p i p oo we q j q p k p on x p k p wo q j q o te p k p n x p k p ew p k p q j q no x p k p ew p k p q l q nn y q l q x p k p eo p k p n x p k p tw q l q n y q l q we q l q p i p no y q l q we q l q p k p nn x p k p y q l q wo q l q n y q l q v x p k p y q l q u could be divided into linear and nonlinear parts linear part includes te p i p o ew p i p q j q oo eo p i p o tw q j q o we q j q p i p oo wo q j q o while nonlinear part consists of ew p i p q l q on y q l q we q j q p k p on x p k p te p k p n x p k p ew p k p q j q no x p k p ew p k p q l q nn y q l q x p k p eo p k p n x p k p tw q l q n y q l q we q l q p i p no y q l q we q l q p k p nn x p k p y q l q wo q l q n y q l q in the pfrwe model many parameters related to costs and allowance are uncertain and imprecise and expressed as fuzzy sets due to their fluctuations and vagueness such as pre pr w q fc e p k p n vc e p i p o vc e p k p n fc w q l q n vc w q j q o vc w q l q n tr e p tr w q ae p p and aw p q without loss of generality these fuzzy parameters are expressed as triangular fuzzy numbers some parameters related to resources demand and maximum availability of resources are also fuzzy parameters such as wds wdd and ted in addition the upper limit of available resources and the maximum productivity of the plants are of fuzzy features such as ba e p me p p ba w q me c p i p o me c p k p n mw c q j q o and mw c q l q n that is since demands for resources will fluctuate due to population changes and economic growth leading to difficulty in estimation of upper limit of available resources and maximum generation capability of water and power plants the partial constraints of the pfrwe model include fuzzy inequality expressed as symbol representing fuzzy version of for addressing fuzzy relationships that means that the constraints are linguistically formulated and will be satisfied to a certain flexibility extent which is also called soft or flexible constraints pishvaee et al 2012 pishvaee and khalaf 2016 according to the methods proposed by pishvaee et al 2012 and pishvaee and khalaf 2016 model 1 is converted into the following formulations pishvaee et al 2012 pishvaee and khalaf 2016 min c 1 p c 1 m c 1 o 3 u c 2 p c 2 m c 2 o 3 v π c 1 o u c 1 p c 1 m c 1 o 3 u c 1 o v c 1 p c 1 m c 1 o 3 v φ ρ b p b m 2 1 ρ b m b o 2 b p γ t m t t 3 1 α s t au ρ b p b m 2 1 ρ b m b o 2 t m t t 3 1 α aeq u 0 v 0 1 u 0 0 5 ρ 1 2 0 α 1 the first term of the objective function represents the expected total system profit the second term of the objective function is a control of the deviation between the expected optimal value and the actual value that may exist such a control is achieved through the penalty π on the difference between the expected total system profit and the worst case the greater the penalty the less the influence of the fuzzy parameters on the obtained optimal value of the objective function the third term of the objective function represents a control of the deviation between the expected values of fuzzy parameters and the possible values the stricter the control the greater the penalty corresponding to a larger φ on the difference between the expected values of fuzzy parameters and the worst case of them it will lead to a more feasible solutions under any possible values of the parameters the last term of the objective function represents the punishment on violation of the constraints with a greater punishment the optimal solutions will remain feasible for more stringent constraints the first term on the right hand side of the inequality constraints allows for uncertainty in values for parameter vector and the second term allows for flexibility in satisfying the constraints feasibility robustness ensures that the solution remain feasible for almost all possible values of uncertain parameters optimality robustness makes sure that the value of objective function will remain close to the optimal value or have minimum undesirable deviation from the optimal value for almost all possible values of uncertain parameters in order to deal with the nonlinearity in variable u the linearization methods are applied assume that β is a continuous variable as for non linear multiplication of variables of β x or β y a non negative continuous variable ε β x or ε β y will be introduced as follows pishvaee and khalaf 2016 3 ε m x ε m x 1 β ε β ε 0 where m is an appropriate large number pishvaee and khalaf 2016 which should be a positive number greater than β to guarantee ε β x based on eq 3 if x 0 ε 0 β x if x 1 ε β β x by extending the linearization method of β x non linear multiplication of variables β x y will be linearized through two continuous variables including τ β x and β x y τ y θ or τ β y and β x y τ x θ 4 τ m x τ m x 1 β τ β θ m y θ m y 1 τ θ τ τ 0 θ 0 or 5 τ m y τ m y 1 β τ β θ m x θ m x 1 τ θ τ τ 0 θ 0 model 2 is thus converted into the linear programming model which can be easily solved the specific conversion steps are shown in supplementary materials the solution processes are summarized as follows step 1 obtain the information of uncertain parameters and fuzzy constraints and their fuzzy membership functions identify the values of feasibility robustness controllers and optimality robustness controller step 2 formulate the pfrwe model a nonlinear regional scale water energy nexus management model with fuzzy parameters and constraints step 3 transform pfrwe model into model 2 step 4 use linearization method to transform the nonlinear programming model 2 to a linear programming model which can be easily solved step 5 given the values of π φ and γ obtain the solutions of pfrwe model step 6 repeat step 5 to obtain the different solutions of the pfrwe model by dynamically adjusting the values of π φ and γ to control optimality robustness and feasibility robustness the flowchart of the pfrwe model is shown in fig 4 optimal solutions with enhanced robustness will be obtained for supporting water energy nexus management under fuzzy uncertainty a robust solution means the one with the characteristics of both feasibility robustness and optimality robustness feasibility robustness ensures that the solution remain feasible for almost all possible values of uncertain parameters optimality robustness makes sure that the value of objective function will remain close to the optimal value or have minimum undesirable deviation from the optimal value for almost all possible values of uncertain parameters pishvaee et al 2012 pishvaee and khalaf 2016 soyster 1973 the pfrwe model is coded in matlab r2017b with a low computational requirement which costs 10 67 s for each run 3 case study 3 1 data collection the developed pfrwe model is applied to a real world case study in liaoning province china to demonstrate its applicability liaoning province is located in the southern part of northeastern china with a total area of 148 600 square kilometers as shown in fig 5 it is bordering the yellow sea and bohai sea to the south and yalu river to the southeast based on the unique geographical location and distinctive resource distribution the study area is divided into four regions including the eastern region the southern region the western region and the northern region the eastern region includes benxi city and dandong city with the yalu river and the taizi river flowing through surface water and hydropower resources are sufficient for hydropower development the eastern region is suitable for nuclear power development since dandong city is close to the yellow sea and has stable geological structure it is also the only natural gas production area within the province the southern region covers panjin city yingkou city and dalian city with liao river and raoyang river flowing through adjacent to the bohai sea to the west and the yellow sea to the east dalian city has a nuclear power station the western region includes fuxin city jinzhou city chaoyang city and huludao city where light and wind energy are abundant for electricity generation with stable geological structure and advantageous location adjacent to the bohai sea huludao city and jinzhou city have the potential to develop nuclear power the main water resource in the western region is groundwater the northern region consists of tieling city shenyang city fushun city liaoyang city and anshan city locating inland with liao river and hun river flowing through desalinated sea water is an alternative water resource for meeting the ever increasing demands as of 2019 the total population of the eastern southern western and northern regions were 4 09 million 10 86 million 10 30 million and 18 44 million respectively with a total gdp of 160 31 billion 98 62 billion 304 34 billion and 979 52 billion respectively the northern region has the largest population with good economic development while the eastern region has the least population and poor economic development the relevant data used in this study is collected from public government reports news media reports and published literature bakken et al 2013a bakken et al 2013b china electric power news 2015 dalian municipal people s government 2019 development and reform commission of china 2011 dong 2014 edenhofer et al 2011 general office of the people s government of liaoning province 2017 gong et al 2008 heuberger et al 2017 liaoning provincial department of finance et al 2012 jiang 2013 lampert et al 2015 li 2006 mielke et al 2010 national energy board 2011 statistics bureau of liaoning province 2017 water resources department of liaoning province 2014 wu 2015 news media reports are shown in web reference new energy division 2018 china energy news 2019 china gas network 2017 china power news 2013 china thermal power network 2012 china water network 2018 liaoshen evening news 2017 polaris power network news center 2016 parameters of selling total demands allowances available water resources and available primary energy resources are shown in tables c1 c2 c3 and c4 the percentage of freshwater for electricity generation in all gas fired and biomass power plants is 100 while it is zero in all nuclear power plants all coal fired power plants use 100 of freshwater except four plants the fifth and sixth existing in the southern region the seventh existing in the eastern region and the first new in the western region plants which consume 35 20 30 and 30 of freshwater respectively that is since the four power plants are close to sea and it is easy for them to acquire freshwater resources using sea water desalination the maximum percentage of imported electricity is assumed to be 100 of total electricity demand primary energy resources represent the consumed energy for electricity generation including coal natural gas uranium and biomass for coal fired gas fired nuclear and biomass power plants respectively all uranium is supplied from outside the province for solar power wind power and hydropower maximum availabilities of primary energy resources represent capacity limitation of available solar radiation energy convertible wind energy and hydropower table c5 shows the parameters related to primary energy in most cases hydropower generation is a significant water consumer through evaporation from hydropower facilities and artificial water reservoirs in this study water consumption for unit hydropower generation is calculated as 209 00 10 3 m 3 kwh mekonnen and hoekstra 2012 the proportion of surface water groundwater desalination water and recycled water for both electricity production and primary energy production is 57 40 39 40 0 08 and 3 12 respectively only surface water is used for hydropower generation biomass electricity generation uses botany and waste as raw materials and the associated water consumptions are mainly for crop cultivation however in this study water consumption for biomass electricity generation will not be calculated since the raw materials are from agricultural wastes and domestic garbage tables c6 and c7 show the parameters related to the existing and new power plants tables c8 and c9 list the parameters related to maximum generation capacity of the existing and new water plants variable cost for unit water production in the existing and new water plants and fixed cost for building the new water plants average electricity line loss rate for social demand is 5 00 and average leakage rate of water pipe network for social demand is 15 00 electricity line loss rates from power plants to water plants and water pipe leakage rates from water plants to power plants are estimated by distance as shown in table c10 tables c1 c10 are listed in appendix c 3 2 results analyses 3 2 1 solutions obtained from the pfrwe model by adjustment of the values of the robustness controllers including π for optimality robustness and φ and γ for feasibility robustness different sets of optimal solutions can be obtained using the developed pfrwe model based on the preferences of decision makers exemplary analyses of precise solutions under π 1 and φ γ 0 2 are provided in the supplementary materials and the main conclusions are summarized a liaoning province has sufficient water production but insufficient electricity generation with 6 9 of total electricity consumption coming from imported electricity b coal fired power generation method will not be preferred but still an important way c development of gas fired power will be limited although it is more environmentally friendly compared to coal fired power due to the low purity and reserves of nature gas imperfect transportation system and relatively high price d nuclear power generation will be dominant due to its advantages in large power generation capacity low emissions of environmental pollutants stable power supply regardless of seasonal impacts and low demands of freshwater resources e hydropower is rarely developed during the planning period since the available hydraulic potential of the water system has been almost exploited f surface water is the main resource due to its abundance from multiple rivers flowing through liaoning province g groundwater is used in the areas far away from the rivers due to the higher costs for extracting surface water and potential water pollution caused by long distance transportation h in order to increase resource utilization efficiency and reduce pollution recycled water will be another important water resource i no desalinated sea water plant will be newly constructed during the planning period in liaoning province due to its market disadvantages 3 2 2 tradeoffs between robustness and water production electricity generation and imported electricity different sets of optimal solutions for water production electricity generation and imported electricity can be obtained using the pfrwe model through adjustment of optimality and feasibility robustness controllers when adjusting the robustness controller value in interval π 6 φ 0 6 and γ 0 6 expected total system profits have insignificant difference thus only optimal planning on water energy production and imported electricity under π 0 6 φ 0 0 6 and γ 0 0 6 are analyzed and presented in details in this section fig 6 shows the total electricity generation and water production under different optimality and feasibility robustness under fixed feasibility robustness φ γ 0 2 as shown in fig 6 a with the increased requirements of optimality robustness the optimal amounts of total electricity generation and total water production in liaoning province are less under a higher optimality robustness requirement corresponding to a higher π value the reduced production will lead to the decreases of energy resource consumptions associated water consumptions for power plants pollutant emissions during the electricity production process water resources consumptions and electricity consumptions for water production thus the solutions under higher optimality robustness controller values are more conducive to resource saving and environmental protection especially when π increases from 4 to 6 optimal amounts of total electricity generation in the study area will sharply decrease the results indicate that the changes of electricity generation are more obvious under different optimality robustness than water production in liaoning province similarly under a fixed optimality robustness of π 2 both total electricity generation and total water production in liaoning province decrease as values of φ and γ increase corresponding to prioritization of feasibility robustness as shown in fig 6 b the results as shown in fig 6 indicate slighter changes of optimal production of water and energy under different feasibility robustness than optimality robustness fig 7 shows electricity generation and water production in the existing and new plants under different optimality and feasibility robustness under fixed feasibility robustness controllers of φ and γ as the requirements for optimality robustness π increase the optimal planning of biomass and solar power generation in the existing and new power plants will firstly reduce due to their high dependence on unit electricity production allowance while coal fired power generation will be the last to disappear since the construction of new power plants has high costs and is susceptible to various factors such as regulations and policies the construction of new power plants will reduce under a higher optimality robustness requirement as the value of π increases to 4 only coal fired power will be generated in the new power plants while the types of the existing power plants involve coal fired nuclear wind and hydropower ones the results indicate that the changes of construction and production in the new power plants are more significant than those in the existing power plants under different optimality robustness requirements as shown in fig 7 a and c under a fixed optimality robustness of π compared with fixed feasibility robustness there are slighter changes of power generation in the existing and new power plants under different feasibility robustness as shown in fig 7 b and d changes of water production in the existing and new water plants are relatively smaller than those of electricity generation under different optimality robustness and feasibility robustness variations of water production patterns in the existing and new water plants will not be significant as optimality and feasibility robustness controllers vary fig 8 shows the imported electricity under different robustness different from electricity generation in liaoning province optimal quantity of imported electricity will grow rapidly with the increased demand of optimality robustness π that s since imported electricity has purchasing costs and is affected only by the uncertain parameter of electricity price while electricity generation involves multiple uncertain parameters in liaoning province in order to reduce the risk of total system profit s deviation from its expected optimal value under almost all uncertain parameters demand of imported electricity will gradually increase as optimality robustness requirement increases quantity of imported electricity will also increase under high requirement of feasibility robustness however the optimal quantity of imported electricity will remain more stable under different requirements of feasibility robustness than optimality robustness 3 2 3 tradeoffs between robustness and expected total system profit fig 9 shows the relationships among expected total system profit optimality robustness controller π and feasibility robustness controllers φ and γ the parameter of π controls the optimality robustness representing the tolerance of the deviation between the worst possible total system profit and the expected total system profit the larger the value of π corresponding to a smaller deviation between the worst possible total system profit and its expected optimal total system profit under different values of uncertain parameters the higher optimality robustness however with the increase of π meaning the reduced risk of total profit s deviation from its expected optimal value total system profit will decrease thus a higher optimality robustness represents the risk averse attitudes of decision makers as shown in fig 9 under the fixed feasibility robustness of φ and γ expected total system profit will decrease as π increases which means the risk averse solutions with more imported electricity less water and power plant constructions and less water and electricity production since the income from imported electricity is far less than the revenues from water and electricity production expected total system profit will decrease both the parameters of φ and γ control the feasibility robustness φ represents a punishment on the bias between the chosen values of right hand side fuzzy parameters of the flexible constraints and its smallest possible value such as minimum resources availability and γ means a punishment on violation of the flexible constraints a larger value of φ corresponds to smaller values of right hand side fuzzy parameters of the flexible constraints and a larger value of γ indicates a smaller tolerance of violation of the flexible constraints with the increase of φ and γ feasibility robustness will increase and the risk of violation of the flexible constraints will decrease which guarantees the obtained solutions to remain feasible under almost all uncertain values of fuzzy parameters and constraints however as shown in fig 9 under a given π expected total system profit will decrease as φ and γ increase in this study φ and γ indicate the punishment of unsatisfied water and energy resources availability water and energy demands and maximum water and energy generation capability if decision makers prefer the reduced risk of violating the flexible constraints such as resources availability demands and maximum generation capability i e a higher feasibility robustness less water and electricity will be produced resulting in a decreased expected total system profit and resources consumption using the developed pfrwe model tradeoffs between economic objectives and system failure risks of total profit s deviating from its expected optimal value and violating the flexible constraints can be effectively quantified although a maximum total system profit is preferred by decision makers the system failure risks will be the highest corresponding to the lowest robustness accepting a lower total system profit will enhance the system robustness and reduce the system failure risks as the increase of robustness expected total profit water energy nexus system in liaoning province will transition from a gain to a loss and eventually stabilize at a loss of approximately rmb 73 00 109 shown in fig 9 by adjustment of optimality and feasibility robustness controllers different sets of optimal solutions can be obtained based on the preferences of decision makers to support water energy nexus management in practices 3 2 4 comparison with the deterministic model the developed pfrwe model is compared to a deterministic model which represents a situation where all fuzzy parameters are set with the values at the highest membership degree of 1 and at the same time fuzzy constraints are assumed to be fully satisfied results from the deterministic model with the expected total profit of rmb 5 16 109 while the expected total profit from the pfrwe model is rmb 15 28 109 under π 1 and φ γ 0 2 under the low preference for robustness the expected total system profit obtained from the pfrwe is higher than that from the deterministic model at the same time total social demands are not fully satisfied and improvement of production technologies are required to save costs the increased electricity generation and decreased imported electricity also led to the increased expected total system profit in the pfrwe model the comparison of optimal water production and electricity generation between the deterministic model and pfrwe model under π 1 and φ γ 0 2 are shown in fig 10 optimal total electricity consumption obtained from the pfrwe model is 161436 50 106 kwh year among which the consumed imported electricity is 11146 05 106 kwh year accounting for 6 90 of the total electricity consumption for the deterministic model optimal total electricity consumption is 165341 60 106 kwh year while imported electricity account for 15 16 equal to 25073 40 106 kwh year from fig 10 the production structure in each region is similar for example the planning results of both the pfrwe model and the deterministic model show that electricity generated by nuclear power is the most in the eastern region followed by coal fired power and hydropower generation gas power generation is also an important form of power generation in the eastern region however the results of the two models are different in amounts using the pfrwe model the total electricity generation in the eastern region is 45 61 106 kwh year which is 3 24 106 kwh year more than that from the deterministic model according to the planning results of the pfrwe model the total electricity generation in the southern western and northern regions are 48 45 106 kwh year 39 62 106 kwh year and 16 61 106 kwh year respectively all of which are higher than those from the deterministic model corresponding to 45 67 106 kwh year 36 70 106 kwh year and 15 63 106 kwh year respectively those are since the pfrwe model considers the possibility of improving technology or management in power plants to increase generation capacity water production structures from the pfrwe model and deterministic model are also similar the comparison results indicate that amounts of water production from the deterministic model are higher than those from the pfrwe model in all regions due to more social demands and electricity generation demands using the pfrwe model amounts of water production in the eastern southern western and northern regions are 344 30 106 m3 year 833 35 106 m3 year 545 95 106 m3 year and 1459 76 106 m3 year respectively while using the deterministic model they are 345 65 106 m3 year 836 80 106 m3 year 548 86 106 m3 year and 1555 53 106 m3 year respectively fig 11 shows the electricity consumption for water production and water consumption for electricity generation in four regions obtained from the deterministic model and pfrwe model under π 1 and φ γ 0 2 the consumed electricity is generated in each region and can be transmitted to water plants in other regions for water production as shown in fig 11 water consumption for electricity generation in the western region is the most while in the eastern region it is the least coal fired power generation has the largest water consumption for unit electricity production followed by nuclear power generation and then biomass and gas fired power generation nuclear power plants do not consume freshwater resources since they are generally built on the seashore with their own desalination facilities the amounts of water consumption for electricity production in liaoning province mostly depend on the production capacity of coal fired power plants the southern and the western regions have almost same amounts of power generation but different water consumption since coal fired power plants use sea water as an alternative water source for power generation in the southern region electricity consumption for water generation is the most in the northern region and the least in the eastern region from fig 11 water consumption for electricity generation planned by the pfrwe model is more than that planned by the deterministic model more detailed solutions obtained from the deterministic model and pfrwe model under π 1 and φ γ 0 2 are provided in supplementary materials in fact the deterministic model is a special case of the pfrwe model and offers no flexibility in decision support for water energy nexus management in practices only a set of solutions are generated by using the deterministic model for supporting decision making related to construction of different types of new water and power plants quantity of water production and electricity generation water consumptions for electricity generation electricity consumptions for water production and amounts of imported electricity the feasibility of optimal solutions obtained by the deterministic model and pfrwe model under three different scenarios i e the worst case the best case and the most possible case are compared under the worst scenario the fuzzy constraints should be strictly met and the values of parameters correspond to the smaller one at the lowest membership degree of 0 this means that the external environment is expected the worst with the least available resources and production capacity as well as the highest production costs and demands the most possible case is the same as assumed in the deterministic model the best case corresponds to the loosest constraints where the values of parameters are assumed to be the highest one at the lowest membership degree of 0 the feasibility is expressed by the constraint satisfaction of every group of fuzzy constraints b13 b29 and b30 b32 which is calculated as follows c o n s t r a i n t s a t i s f a c t i o n number o f s a t i s f i e d c o n s t r a i n t s number o f t o t a l c o n s t r a i n t s 100 for example the fuzzy constraint group b13 representing i p 1 n p te p i p o k p 1 r p te p k p n x p k p ec r p 1 i p e p ba e p p 1 2 3 4 includes 4 constraints since p 1 p 2 p 3 p 4 if two of them are satisfied the constraint satisfaction of fuzzy constraint group b13 is 2 4 100 50 fig 12 shows the comparison of constraint satisfaction of the optimal solutions from the deterministic model and pfrwe model with different optimality robustness and feasibility robustness since available resource constraints i e b13 b16 and drinking water demand constraints i e b31 are always satisfied under all three cases fig 12 only shows the variations of the constraint satisfaction of plants production capacity i e b17 b20 total electricity demand i e b30 and total water demand i e b32 as shown in fig 12 a constraints b17 b20 have low constraint satisfaction except under π 4 φ γ 0 3 and π 6 φ γ 0 3 in the pfrwe model thus increasing the optimality robustness can enhance the feasibility of the results the low constraint satisfaction in b17 b20 indicates a high possibility that the water and electricity production will not meet the expectations and the solutions correspond to a greater risk of infeasibility the unreachable production will also lead to deviations in constraints satisfaction calculation of demand constraints b30 b32 from fig 12 b under the most possible case the solutions of the deterministic model will meet all the constraints and so as prfwe model under π 2 φ γ 0 9 when feasibility robustness maintains at a low value such as φ γ 0 3 the constraints cannot be fully satisfied even under a high optimality robustness increasing feasible robustness can make the constraints be fully satisfied even under lower optimal robustness requirements such as π 2 as shown in fig 12 c all solutions from the deterministic model and prfwe model are feasible except three conditions the prfwe model under π 0 φ γ 0 0 3 and under π 2 φ γ 0 0 3 take a little infeasibility risk in constraints b17 while the prfwe model under π 2 φ γ 0 takes more risks in violating constraints b17 b19 and b20 thus under the best case the feasibility robustness has more effects on model feasibility under all three cases increasing only the optimality robustness or feasibility robustness can improve the performance of model in feasibility risk taking increasing feasible robustness can effectively reduce the risk of infeasibility under all the most possible case and the best case it is not enough to improve the feasibility under the worst case only by increasing the feasible robustness where improving optimality robustness together is desired thus the stronger the robustness the higher the possibility that the solutions remain feasible the results indicate that the pfrwe model can offer more flexibility in feasibility risk taking and perform better under higher robustness such as π 6 φ γ 0 9 than the deterministic model fig 13 shows the optimal total system profit obtained from the deterministic model and the pfrwe model the difference between the maximum and minimum values of the total system profit corresponding to the solutions of the deterministic model the pfrwe model under π 0 φ γ 0 and prfwe model under π 2 φ γ 0 3 are very similar among them the deterministic model has the least total system profit under the most possible case with the increase of robustness requirements the difference between the maximum and minimum values of the optimal total system profit obtained from the pfrwe model gradually decreases and so as the optimal value under the most possible case compared to the deterministic model the pfrwe model can provide solutions with higher total system profit or solutions with little variations of total system profit it can also provide the most preferable solutions to satisfy the needs of decision makers with varying demands in balancing the tradeoffs between economic objectives and robustness 4 conclusions in this study a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe has been developed for supporting integrated water energy nexus planning and management at a regional scale the pfrwe model has improved upon the existing water energy nexus management methods through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework it can deal with not only fuzzy uncertainties in the modeling parameters and the constraints but also the robustness of the model and the solutions by introducing feasibility robustness and optimality robustness the pfrwe model can provide effective decision support for planning of electricity generation and water production as well as construction of new water and power plants in the water energy nexus management at a regional scale under fuzzy uncertainties the developed pfrwe model has been applied to a real world case study in liaoning province china to test its applicability optimal solutions for construction decisions of new power and water plants types of new power and water plants quantity of electricity generation and water production water consumptions for electricity generation electricity consumptions for water production and amounts of imported electricity are obtained the developed pfrwe model can effectively quantify tradeoffs between expected total system profit and model s robustness results show that the changes of electricity generation are more obvious under different robustness than water production as robustness controllers including optimality and feasibility robustness vary variations of water production patterns in the existing and new water plants will not be significant while electricity generation patterns in the existing and new power plants dose compared with fixed feasibility robustness there are slighter changes of power generation in the existing and new power plants under different feasibility robustness under a fixed optimality robustness of π the higher optimality robustness and feasibility robustness corresponding to the higher risk averse attitudes of decision makers the less expected total system profit decision makers may obtain a variety of optimal solutions for water energy nexus management in practices based on their preferences by dynamically adjusting optimality and feasibility robustness controllers the stronger the robustness the higher the probability that the solution remains feasible and pfrwe model can provide better solutions than deterministic model on feasibility the pfrwe model can also provide solutions with higher expected total system profit or solutions with little variations on expected total system profit than the deterministic model thus pfrwe model can also provide the most preferable solutions to satisfy the needs of decision makers with varying demands in balancing the tradeoffs between economic objectives and robustness although the pfrwe model can generate robust solutions and deal with fuzzy uncertainties simultaneously in water energy nexus it has some limitations and can be further improved firstly climate change may have impacts on water and energy production on the one hand global warming may lead to insufficient fresh water supply the reduced availability of freshwater resources under climate change will lead to the closure of water intensive power plants such as coal fired and gas fired power plants where a large amount of water is required for cooling purposes on the other hand the chinese government has set stricter air pollutant emission standards in response to climate change the pfrwe model can be extended in the future to address the water energy climate nexus issues through consideration of greenhouse gas emission control and resource demand and availability under various changing climatic scenarios secondly the pfrwe model may further address the whole life cycle analyses of water energy nexus processes instead of their production and transportation one of the examples is although photovoltaic has no water consumption at its production and transportation stages it consumes approximately 28 2 gal mwh of water from the whole life cycle point of view meldrum et al 2013 incorporation of life cycle analysis into the pfrwe model will have the potential to improve its applicability in practices finally more complex uncertainties such as stochastic nature in the modeling parameters and relationships can be considered in the extensions of the pfrwe model the pfrwe model can also be applied in water energy nexus planning in other regions credit authorship contribution statement chen chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing xiaodong zhang conceptualization methodology writing review editing supervision shuguang wang supervision writing review editing huayong zhang investigation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we much appreciate the support from national natural science foundation of china no 51779132 we would like to also thank editor associate editor and three anonymous reviewers for their insightful comments and suggestions to improve the manuscript appendix a index p types of power plants p 1 coal fired p 2 gas fired p 3 nuclear p 4 biomass p 5 solar p 6 wind p 7 hydropower q types of water plants q 1 surface water q 2 groundwater q 3 desalinated sea water q 4 recycled water n p total number of type p of the existing power plants i p number of type p of the existing power plant i p 1 n p m q total number of type q of the existing water plants j q number of type q of the existing water plant j q 1 m q r p total number of type p of the new power plants k p number of type p of the new power plant k p 1 r p s q total number of type q of the new water plants l q number of type q of the new water plant l q 1 s q variables x p k p an integer variable for indicating whether to construct the k p th p type new power plant 1 yes 0 no y q l q an integer variable for indicating whether to construct the l q th q type new water plant 1 yes 0 no ew p i p q j q oo quantity of electricity supply from the i p th type p existing power plants to the j q th type q existing water plants kwh year ew p k p q j q no quantity of electricity supply from the k p th type p new power plant to the j q th type q existing water plant kwh year ew p i p q l q on quantity of electricity supply from the i p th type p existing power plants to the l q th type q new water plants kwh year ew p k p q l q nn quantity of electricity supply from the k p th type p new power plant to the l q th type q new water plant kwh year eo p i p o quantity of electricity supply for social demand from the i p th type p existing power plant kwh year eo p k p n quantity of electricity supply for social demand from the k p th type p new power plant kwh year ie q j q o quantity of imported electricity for the j q th type q existing water plant kwh year ie q l q n quantity of imported electricity for the l q th type q new water plant kwh year id quantity of imported electricity from outside provinces for social demand except imported electricity for water production kwh year tw q j q o total water production of the j q th type q existing water plant m 3 year te p i p o total electricity generation of the i p th type p existing power plant kwh year tw q l q n total water production in the l q th type q new water plant m 3 year te p k p n total electricity generation in the k p th type p new power plant kwh year we q j q p i p oo quantity of water supplied from the j q th type q existing water plant to the i p th type p existing power plant m 3 year we q l q p i p no quantity of water supply from the l q th type q new water plant to the i p th type p existing power plant m 3 year we q j q p k p on quantity of water supplied from the j q th type q existing water plant to the k p th type p new power plant m 3 year we q l q p k p nn quantity of water supply from the l q th type q new water plant to the k p th type p new power plant m 3 year wo q j q o quantity of water supply for social demand from the j q th type q existing water plant m 3 year wo q l q n quantity of water supply for social demand from the l q th type q new water plant m 3 year parameters ae p p allowance for constructing the new power plant with type p expressed as fuzzy parameters rmb aw p q allowance for constructing the new water plant with type q expressed as fuzzy parameters rmb ba e p available energy resources for type p electricity generation expressed as fuzzy parameters p 1 2 3 4 tce 1 10 3 ton of standard coal equivalent ba w q availability of water resources q expressed as fuzzy parameters q 1 2 3 4 m 3 year ecr p primary energy resources consumption for unit electricity generation p 1 2 3 4 tce kwh for p 1 2 4 g uranium fuel kwh for p 3 ell p i p o average electricity line loss rate for social demand from the i p th type p existing power plant ell p k p n average electricity line loss rate for social demand from the k p th type p new power plant elw q j q o average leakage rate of water pipe network for social demand from the j q th type q existing power plant elw q l q n average leakage rate of water pipe network for social demand in the l q th type q new power plant euw q j q o average electricity consumption for unit water production in the j q th type q existing power plant kwh m 3 euw q l q n average electricity consumption for unit water production in the l q th type q new power plant kwh m 3 fc e p k p n fixed cost for building the k p th type p new power plant expressed as fuzzy parameters rmb fc w q l q n fixed cost for building the l q th type q new water plant expressed as fuzzy parameters rmb fwe p i p o the percentage of freshwater among total water demand for electricity generation in the i p th type p existing power plant fwe p k p n the percentage of freshwater among total water demand for electricity generation in the k p type p new power plant fwp pq the proportion of type q water demand among total water demand in type p primary energy production ipe p the ratio of type p imported primary energy resources to total primary energy demand p 1 2 3 4 llr p i p q j q oo electricity line loss rate from the i p th type p existing power plant to the j q th type q existing water plant llr p k p q j q no electricity line loss rate from the k p th type p new power plant to the j q th type q existing water plant llr p i p q l q on electricity line loss rate from the i p th type p existing power plants to the l q th type q new water plant llr p k p q l q nn electricity line loss rate from the k p th type p new power plant to the l q th type q new water plant me p p maximum electricity production by type p power plants which is expressed as fuzzy parameters and calculated based on generation capacity of type p power plants p 5 solar power p 6 wind power and p 7 hydropower kwh year me c p i p o maximum generation capacity of the i p th type p existing power plant expressed as fuzzy parameters kwh year me c p k p n maximum generation capacity of the k p th type p new power plant expressed as fuzzy parameters kwh year mie maximum available percentage of imported electricity among total electricity demand mw c q j q o maximum generation capacity of the j q th type q existing water plant expressed as fuzzy parameters m 3 year mw c q l q n maximum generation capacity of the l q th type q new water plant expressed as fuzzy parameters m 3 year nlw q j q p i p oo leakage rate of water pipe network from the j q th type q existing water plant to the i p th type p existing power plant nlw q l q p i p no leakage rate of water pipe network from the l q th type q new water plant to the i p th type p existing power plant nlw q j q p k p on leakage rate of water pipe network from the j q th type q existing water plant to the k p th type p new power plant nlw q l q p k p nn leakage rate of water pipe network from the l q th type q new water plant to the k p th type p new power plant pkw qp i p o the proportion of type q water consumption among total freshwater demand for electricity production in the i p th type p existing power plant pkw qp k p n the proportion of type q water consumption among total freshwater demand for electricity production in the k p th type p existing power plant pre selling price of electricity expressed as fuzzy parameters rmb kwh pr w q selling price of water with type q expressed as fuzzy parameters rmb m 3 ted total electricity demand expressed as fuzzy parameters kwh year tr e p allowance for unit electricity generation with type p expressed as fuzzy parameters rmb kwh tr w q allowance for unit type q water generation expressed as fuzzy parameters rmb m 3 vc e p i p o variable cost for unit electricity production in the i p th type p existing power plant which does not include cooling water fee from the water plants expressed as fuzzy parameters rmb kwh vc e p k p n variable cost for unit electricity production in the k p th type p new power plant which does not include cooling water fee from the water plants expressed as fuzzy parameters rmb kwh vc w q j q o variable cost for unit water production in the j q th type q existing water plant which does not include cost of electricity from power plants for water collection and treatment expressed as fuzzy parameters rmb m 3 vc w q l q n variable cost for unit water production in the l q th type q new water plant which does not include cost of electricity from power plants for water collection and treatment expressed as fuzzy parameters rmb m 3 wcc p water consumption coefficient in type p primary energy production m3 tce for p 1 2 3 4 m 3 kwh for p 5 6 7 wdd total drinking water demand expressed as fuzzy parameter m 3 year wds total water demand expressed as fuzzy parameter m 3 year wue p i p o average water consumption for unit electricity production in the i p th type p existing power plant m 3 kwh wue p k p n average water consumption for unit electricity generation in the k p th type p new power plant m 3 kwh appendix b the management objective is to maximize the total system profit as follows b1 m a x t o t a l s y s t e m p r o f i t f 1 f 2 f 3 f 4 f 5 f 6 f 7 f 8 f 9 f 10 f 11 allowance for the construction of new power plants b2 f 1 p 1 7 k p 1 r p aep p x p k p allowance for the construction of new water plants b3 f 2 q 1 4 l q 1 s q awp q y q l q cost for construction of new power plants b4 f 3 p 1 7 k p 1 r p fce p k p n x p k p cost for construction of new water plants b5 f 4 q 1 4 l q 1 s q fcw q l q n y q l q allowance for electricity generation b6 f 5 p 1 7 k p 1 r p tre p te p i p o te p k p n x p k p allowance for water production b7 f 6 q 1 4 l q 1 s q trw q tw q j q o tw q l q n y q l q variable costs for electricity generation such as cost of water consumption in power plants and cost of other resources materials and labor services b8 f 7 p 1 7 i p 1 n p q 1 4 pkw qp i p o prw q wue p i p o fwe p i p o vce p i p o te p i p o p 1 7 k p 1 r p q 1 4 pkw qp i p n prw q wue p k p n fwe p k p n vce p k p n te p k p n x p k p variable costs for water production such as cost of electricity consumption in water plants and cost of other resources materials and labor services b9 f 8 q 1 4 l q 1 s q pre euw q j q o vcw q j q o tw q j q o q 1 4 l q 1 s q pre euw q l q n vcw q l q n tw q l q n y q l q electricity selling revenues b10 f 9 p 1 7 i p 1 n p pre q 1 4 j q 1 m q 1 llr p i p q j q oo ew p i p q j q oo q 1 4 l q 1 s q 1 llr p i p q l q on ew p i p q l q on y q l q 1 ell p i p o eo p i p o p 1 7 k p 1 r p pre q 1 4 j q 1 m q 1 llr p k p q j q no ew p k p q j q no q 1 4 l q 1 s q 1 llr p k p q l q nn ew p k p q l q nn y q l q 1 ell p k p n eo p k p n x p k p water selling revenues b11 f 10 q 1 4 l q 1 s q prw q p 1 4 i p 1 n p 1 nlw q j q p i p oo we q j q p i p oo p 1 4 k p 1 r p 1 nlw q j q p k p on we q j q p k p on x p k p 1 elw q j q o wo q j q o q 1 4 l q 1 s q prw q p 1 4 i p 1 n p 1 nlw q l q p i p no we q l q p i p no p 1 4 k p 1 r p 1 nlw q l q p k p nn we q l q p k p nn x p k p 1 elw q l q n wo q l q n y q l q cost for imported electricity b12 f 11 pre i d the constraints of the pfrwe model include constraints of energy availability the sum of primary energy resources such as coal gas uranium and biomass except imported energy should not be greater than the available energy resources within the study region as follows b13 i p 1 n p te p i p o k p 1 r p te p k p n x p k p ecr p 1 ipe p bae p p 1 2 3 4 the power generation capacity of solar power wind power and hydropower are respectively constrained by the number of effective hours of light throughout the year b14 i p 1 n p te p i p o k p 1 r p te p k p n x p k p mep p p 5 6 7 the capacity of solar power electricity generation is computed based on annual effective available illumination hours and average conversion efficiency the capacity of wind power electricity generation is calculated based on wind energy density and accumulated annual hours of available wind energy the capacity of hydropower power electricity generation is determined based on potential energy of rivers and lakes constraints of water availability the amounts of consumed water resources for primary energy mining and refining electricity generation in the power plants and water production in the water plants should not exceed the availability of each type of water resources b15 j 1 1 m 1 tw 1 j 1 o l 1 1 s 1 tw 1 l 1 n y 1 l 1 p 1 2 3 i p 1 n p te p i p o ecr p 1 ipe p wcc p fwp p 1 p 1 2 3 k p 1 r p te p k p n x p k p ecr p 1 ipe p wcc p fwp p 1 i 7 1 n 7 te 7 i 7 o k 7 1 r 7 te 7 k 7 n x p k p wcc 7 baw 1 b16 j q 1 m q tw q j q o l q 1 s q tw q l q n y q l q p 1 2 3 i p 1 n p te p i p o ecr p 1 ipe p wcc p fwp pq p 1 2 3 k p 1 r p te p k p n x p k p ecr p 1 ipe p wcc p fwp pq baw q q 2 4 total water consumption for primary energy mining and refining is determined depending on total electricity generation primary energy resources consumption for unit electricity generation and water consumption coefficient in primary energy production constraints of maximum generation capacity of every power plants b17 te p i p o mec p i p o p 1 2 3 4 5 6 7 i p 1 n p b18 te p k p n mec p k p n p 1 2 3 4 5 6 7 k p 1 r p constraints of maximum generation capacity of every water plants b19 t w q j q o mw c q j q o q 1 2 3 4 j q 1 m q b20 t w q l q n mw c q l q n q 1 2 3 4 l q 1 s q balance equation of electricity supply and demand the amounts of electricity generation should be equal to total electricity consumption including electricity demand for all water plants and social demand b21 te p i p o q 1 4 j q 1 m q ew p i p q j q oo q 1 4 l q 1 s q ew p i p q l q on y q l q eo p i p o p 1 2 3 4 5 6 7 i p 1 n p b22 te p k p n x p k p q 1 4 j q 1 m q ew p k p q j q no q 1 4 l q 1 s q ew p k p q l q nn y q l q eo p k p n x p k p p 1 2 3 4 5 6 7 k p 1 r p balance equation of water supply and demand the amounts of water production should be equal to total water consumption including water demand for all power plants and social demand b23 tw q j q o p 1 7 i p 1 n p we q j q p i p oo p 1 7 k p 1 r p we q j q p k p on x p k p wo q j q o q 1 2 3 4 j q 1 m q b24 tw q l q n y q l q p 1 7 i p 1 n p we q l q p i p no p 1 7 k p 1 r p we q l q p k p nn x p k p wo q l q n y q l q q 1 2 3 4 l q 1 s q balance of water demand for electricity generation the amounts of water delivered to power plants except pipe leakage should be equal to water demand for electricity generation b25 q 1 4 j q 1 m q 1 nlw q j q p i p oo we q j q p i p oo q 1 4 l q 1 s q 1 nlw q l q p i p no we q l q p i p no y q l q te p i p o wue p i p o fwe p i p o p 1 2 3 4 i p 1 n p b26 q 1 4 j q 1 m q 1 nlw q j q p k p on we q j q p k p on q 1 4 l q 1 s q 1 nlw q l q p k p nn we q l q p k p nn y q l q x p k p te p k p n wue p k p n fwe p k p n x p k p p 1 2 3 4 k p 1 r p balance of electricity demand for water generation the amounts of electricity delivered to water plants except line loss should be equal to electricity demand for water generation b27 p 1 7 i p 1 n p 1 llr p i p q j q oo ew p i p q j q oo p 1 7 k p 1 r p 1 l l r p k p q j q no ew p k p q j q no x p k p ie q j q o tw q j q o euw q j q o q 1 2 3 4 j q 1 m q b28 p 1 7 i p 1 n p 1 llr p i p q l q on ew p i p q l q on p 1 7 k p 1 r p 1 llr p k p q l q nn ew p k p q l q nn x p k p ie q l q n y q l q tw q l q n euw q l q n y q l q q 1 2 3 4 l q 1 s q constraints of availability of imported electricity the total amounts of imported electricity for both water generation and social demand should not be larger than the maximum available imported electricity b29 q 1 4 j q 1 m q i e q j q o q 1 4 l q 1 s q i e q l q n y q l q i d m i e ted constraints of total water demand total water demand should be less than or equal to total water production except water for electricity generation and loss caused by leakage b30 wds q 1 4 j q 1 m q 1 e l w q j q o w o q j q o q 1 4 l q 1 s q 1 e l w q l q n w o q l q n y q l q constraints of drinking water demand drinking water is only produced in surface water plants groundwater plants and desalinated sea water plants the recycled water plants will not produce drinking water due to environmental regulations and water quality control standards the total drinking water demand should not be greater than total water production from surface water plants groundwater plants and desalinated sea water plants except leakage loss b31 wdd q 1 3 j q 1 m q 1 e l w q j q o w o q j q o q 1 3 l q 1 s q 1 e l w q l q n w o q l q n y q l q constraints of total electricity demand total electricity demand should be less than or equal to electricity generation except electricity for water production and line loss b32 ted p 1 7 i p 1 n p 1 e l l p i p o e o p i p o p 1 7 k p 1 r p 1 e l l p k p n e o p k p n x p k p i d technical constraints x p k p y q l q 0 1 te p i p o 0 te p k p n 0 tw q j q o 0 tw q l q n 0 ew p i p q j q oo 0 ew p k p q j q no 0 ew p i p q l q on 0 ew p k p q l q nn 0 eo p i p o 0 eo p k p n 0 we q j q p i p oo 0 we q l q p i p no 0 we q j q p k p on 0 we q l q p k p nn 0 wo q j q o 0 wo q l q n 0 ie q j q o 0 ie q l q n 0 b33 id 0 appendix c appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126852 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
4108,with the severe shortages and increasing demands of water and energy resources water and energy system analysis and management have attracted more and more attentions recently in this study a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe is developed for supporting integrated planning of water and energy nexus at a regional scale the developed pfrwe model has improved upon the existing methods for water energy nexus through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework robustness of the model and solution processes will be improved including optimality robustness and feasibility robustness based on the preferences of decision makers application of the pfrwe model to a real world case study in liaoning province china has tested its applicability in regional water energy nexus system management optimal decisions on the amounts of water production and electricity generation new power and water plants construction the types of new power and water plants amounts of water consumption for electricity generation amounts of electricity consumption for water production and amounts of imported electricity are obtained tradeoffs between robustness and water production electricity generation imported electricity and expected total system profit are analyzed by comparing the solutions of the pfrwe model and the deterministic model it is found that the pfrwe model has advantages in maintaining feasibility and reducing variations of objective value under higher robustness or optimizing objective value under lower robustness keywords water energy nexus fuzzy uncertainty robustness nonlinear mixed integer optimization 1 introduction with the rapid growth of population and economics global demands for both water and energy resources have sharply increased in the past years bazilian et al 2011 gold and webber 2015 water and energy have close connection and interdependence which is named water energy nexus wen or sometimes referred to energy intensity ei bauer et al 2014 rabia et al 2015 water resources are required in the processes of energy production transportation and consumption water withdraw supply delivery consumption draining and treatment require energy it is estimated that approximately 15 of the total global generated water is used for energy and approximately 8 of the generated energy globally is used for water tsolas et al 2018 however many of the existing policies and decisions didn t consider water and energy as a whole leading to their ineffectiveness in management of these two types of resources further resource shortages and even environmental damage integrated management of water and energy is an important means of saving resources ensuring sustainable economic development and reducing adverse environmental impacts previously numerous crisp mathematical models were developed for water and energy system planning and management basheer and ahmed elagib 2019 campana et al 2018 ding et al 2020 gjorgiev and sansavini 2017 hong et al 2019 inas et al 2017 li 2018 zhang and vesselinov 2017 however these models did not consider the possible impacts of the parameters with subjective uncertainties on the modeling solutions loucks and van beek 2017 to deal with the subjective uncertainties brought by incomplete knowledge and imprecise information from decision makers or experts the fuzzy possibilistic programming fpp was developed and applied chen et al 2019 chen et al 2020 dai et al 2014 lu et al 2018 sun et al 2019 yu et al 2016 zhang and vesselinov 2016 in fpp uncertain parameters are of vagueness and ambiguity and can be expressed as fuzzy sets characterized by a fuzzy membership characteristic function for example yu et al 2020 combined fpp with copula based random programming and interval parameter programming to help decision makers identify the desired electricity supply patterns and analyze interactions between water resources availability and electricity consumption in water energy nexus system yu et al 2020 in addition the constraints of the model may become less stringent with the changing external conditions and be allowed to be violated within a tolerance range meseguer et al 2006 the fuzzy flexible programming flp can take into account the issues of violating model constraints abdelaziz et al 2004 lee and wen 1996 li and huang 2009 tsakiris and spiliotis 2004 zhang and rong 2010 in flp fuzzy uncertainties exist in the constraints which means the constraints can be partially satisfied for example li et al 2013 integrated flp and interval linear programming to identify the optimal power coal blending process based on a consideration of national standard for coals in burning boilers li et al 2013 zhou et al 2013 integrated flp inexact linear programming and multi objective programming for dealing with industrial structure optimization problems under uncertainty zhou et al 2013 although fpp and flp can handle the fuzzy uncertainties in the parameters and the constraints respectively they are not effective in dealing with the robustness of the solutions which is desired by decision makers without robustness the optimal value of objective function will have great difference from each other and the solution will become infeasible under different chosen values of fuzzy parameters thus decision makers are always more satisfied with robust model and solution processes robust programming provides a viable option for tackling the abovementioned issue it can make sure the optimal value of the objective function to be close to optimal values under all possible values of uncertainty parameters and ensure the solution to remain in feasible regions given different values of uncertain parameters by introducing the concepts of optimality robustness and feasibility robustness robust programming has been widely developed and applied in a number of fields such as supply and transportation planning of liquefied natural gas lng sangaiah et al 2020 sustainable sugarcane to bioethanol supply chain network design gilani et al 2020 planning of fast charging stations zhou et al 2020 seaport dry port network design tsao and thanh 2019 water quality management zhou et al 2019 closed loop supply chain network design ghahremani nahr et al 2019 agricultural water resources allocation fu et al 2018 flood management ding et al 2017 many studies have applied robust programming to the fields of water and energy system planning for example zhang et al 2009 developed a robust chance constrained fuzzy possibilistic programming rcfpp model by combining fuzzy possibilistic programming with fuzzy robust programming and chance constrained programming for water quality management within an agricultural system zhang et al 2009 yu et al 2017 proposed a robust flexible probabilistic programming rfpp method by combining robust flexible programming with chance constrained programming and interval parameter programming for planning municipal energy system yu et al 2017 however few of them was applied to water energy nexus system and combined with fuzzy programming in this study by integrating fuzzy possibilistic programming fuzzy flexible programming and robust programming into a general framework robust solutions are obtained under fuzzy uncertainties the objective of this study is to develop a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe for supporting integrated planning of water and energy nexus at a regional scale the developed pfrwe model has improved upon the existing methods for water energy nexus through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework fuzzy uncertainties existing in the modeling parameters and the constraints will be effectively quantified nonlinearity of the pfrwe model will be dealt with using a linearization method making the model suitable for large scale practical applications robustness of the model and solution processes will be improved including optimality robustness and feasibility robustness by dynamic adjustment of the penalty on the deviation between optimal objection under present uncertainty and hard worst case and the satisfaction on the designed constraints based on the preferences of decision makers optimal decisions on the amounts of water production and electricity generation whether to construct new power and water plants the types of new power and water plants amounts of water consumption for electricity generation amounts of electricity consumption for water production and amounts of imported electricity will be obtained the proposed pfrwe model will be applied to a real world case study in liaoning province china to demonstrate its applicability tradeoffs between robustness and expected total system profit water production electricity generation and imported electricity are analyzed the results obtained from the pfrwe model are helpful for planning and management of water energy nexus systems in practices to show the advantages of the pfrwe model in enhancing the robustness solutions of the pfrwe model and deterministic model are compared 2 model development 2 1 problem description a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe has been developed based on the water energy nexus shown in fig 1 to generate the optimal solutions for sustainable development of water and energy resources in the pfrwe model four types of water resources i e surface water groundwater desalinated sea water and recycle water and eight types of energy resources i e coal fired gas fired nuclear power biomass solar power wind power hydropower plants and imported electricity are considered the interdependence between water and energy such as water consumptions for primary energy extraction and electricity generation and electricity consumptions for water production is analyzed the fuzzy uncertainties existing in costs allowances resources demands availability and maximum productivity capabilities of water and power plants are quantified through triangular fuzzy membership functions the planning issues include i new power and water plants construction decision ii types of new power plants and new water plants iii quantity of electricity generation and water production iv quantity of water for electricity generation and electricity for water production and v amounts of imported electricity 2 2 model formulation the pfrwe model is formulated for water energy nexus management at a regional scale decision variables include continuous decision variables such as total amounts of water production in each water plant total amounts of electricity generation in each power plant amounts of water supplied to each power plant amounts of electricity supplied to each water plant quantity of water or electricity generation for social demand and amounts of imported electricity imported water is calculated in available surface water and integer decision variables for indicating whether to construct the new power or water plants 1 yes 0 no all the nomenclatures are listed in appendix a the management objective of the pfrwe model is to maximize expected total system profit which includes 1 allowance for the construction of new power plants f 1 2 allowance for the construction of new water plants f 2 3 cost for construction of new power plants f 3 4 cost for construction of new water plants f 4 5 allowance for electricity generation f 5 6 allowance for water production f 6 7 variable costs for electricity generation such as cost of water consumption in power plants and cost of other resources materials and labor services f 7 8 variable costs for water production including cost of electricity consumption in water plants and cost of other resources materials and labor services f 8 9 electricity selling revenues f 9 10 water selling revenues f 10 and 11 cost for imported electricity f 11 the formulas of the objective function are presented in appendix b b1 b12 the parameters of objective function are shown in fig 2 the index shows the meaning of the parameters superscripts subscripts and the parameters of allowance prices and costs are also shown in different rectangles the variables are displayed in three parts 1 water and power plant production and construction variables 2 variables related to imported electricity and 3 water and electricity for social demand the plus and minus sign above the arrow represents the contribution made by the parameters the plus sign represents that the parameters increase the total system profit and the minus sign is the opposite the specific part of f 1 f 10 is marked below the arrow the constraints in the pfrwe model are summarized in table 1 and the formulas are presented in appendix b b13 b33 the relationships among the modeling parameters in the constraints are shown in fig 3 2 3 solution method the pfrwe model can be reformulated as a general nonlinear robust possibilistic flexible programming model without loss of generalization as follows min c 1 u c 2 v s t a u b aeq u 0 1 v 0 1 u 0 where u te p i p o ew p i p q j q oo ew p i p q l q on y q l q eo p i p o tw q j q o we q j q p i p oo we q j q p k p on x p k p wo q j q o te p k p n x p k p ew p k p q j q no x p k p ew p k p q l q nn y q l q x p k p eo p k p n x p k p tw q l q n y q l q we q l q p i p no y q l q we q l q p k p nn x p k p y q l q wo q l q n y q l q v x p k p y q l q u could be divided into linear and nonlinear parts linear part includes te p i p o ew p i p q j q oo eo p i p o tw q j q o we q j q p i p oo wo q j q o while nonlinear part consists of ew p i p q l q on y q l q we q j q p k p on x p k p te p k p n x p k p ew p k p q j q no x p k p ew p k p q l q nn y q l q x p k p eo p k p n x p k p tw q l q n y q l q we q l q p i p no y q l q we q l q p k p nn x p k p y q l q wo q l q n y q l q in the pfrwe model many parameters related to costs and allowance are uncertain and imprecise and expressed as fuzzy sets due to their fluctuations and vagueness such as pre pr w q fc e p k p n vc e p i p o vc e p k p n fc w q l q n vc w q j q o vc w q l q n tr e p tr w q ae p p and aw p q without loss of generality these fuzzy parameters are expressed as triangular fuzzy numbers some parameters related to resources demand and maximum availability of resources are also fuzzy parameters such as wds wdd and ted in addition the upper limit of available resources and the maximum productivity of the plants are of fuzzy features such as ba e p me p p ba w q me c p i p o me c p k p n mw c q j q o and mw c q l q n that is since demands for resources will fluctuate due to population changes and economic growth leading to difficulty in estimation of upper limit of available resources and maximum generation capability of water and power plants the partial constraints of the pfrwe model include fuzzy inequality expressed as symbol representing fuzzy version of for addressing fuzzy relationships that means that the constraints are linguistically formulated and will be satisfied to a certain flexibility extent which is also called soft or flexible constraints pishvaee et al 2012 pishvaee and khalaf 2016 according to the methods proposed by pishvaee et al 2012 and pishvaee and khalaf 2016 model 1 is converted into the following formulations pishvaee et al 2012 pishvaee and khalaf 2016 min c 1 p c 1 m c 1 o 3 u c 2 p c 2 m c 2 o 3 v π c 1 o u c 1 p c 1 m c 1 o 3 u c 1 o v c 1 p c 1 m c 1 o 3 v φ ρ b p b m 2 1 ρ b m b o 2 b p γ t m t t 3 1 α s t au ρ b p b m 2 1 ρ b m b o 2 t m t t 3 1 α aeq u 0 v 0 1 u 0 0 5 ρ 1 2 0 α 1 the first term of the objective function represents the expected total system profit the second term of the objective function is a control of the deviation between the expected optimal value and the actual value that may exist such a control is achieved through the penalty π on the difference between the expected total system profit and the worst case the greater the penalty the less the influence of the fuzzy parameters on the obtained optimal value of the objective function the third term of the objective function represents a control of the deviation between the expected values of fuzzy parameters and the possible values the stricter the control the greater the penalty corresponding to a larger φ on the difference between the expected values of fuzzy parameters and the worst case of them it will lead to a more feasible solutions under any possible values of the parameters the last term of the objective function represents the punishment on violation of the constraints with a greater punishment the optimal solutions will remain feasible for more stringent constraints the first term on the right hand side of the inequality constraints allows for uncertainty in values for parameter vector and the second term allows for flexibility in satisfying the constraints feasibility robustness ensures that the solution remain feasible for almost all possible values of uncertain parameters optimality robustness makes sure that the value of objective function will remain close to the optimal value or have minimum undesirable deviation from the optimal value for almost all possible values of uncertain parameters in order to deal with the nonlinearity in variable u the linearization methods are applied assume that β is a continuous variable as for non linear multiplication of variables of β x or β y a non negative continuous variable ε β x or ε β y will be introduced as follows pishvaee and khalaf 2016 3 ε m x ε m x 1 β ε β ε 0 where m is an appropriate large number pishvaee and khalaf 2016 which should be a positive number greater than β to guarantee ε β x based on eq 3 if x 0 ε 0 β x if x 1 ε β β x by extending the linearization method of β x non linear multiplication of variables β x y will be linearized through two continuous variables including τ β x and β x y τ y θ or τ β y and β x y τ x θ 4 τ m x τ m x 1 β τ β θ m y θ m y 1 τ θ τ τ 0 θ 0 or 5 τ m y τ m y 1 β τ β θ m x θ m x 1 τ θ τ τ 0 θ 0 model 2 is thus converted into the linear programming model which can be easily solved the specific conversion steps are shown in supplementary materials the solution processes are summarized as follows step 1 obtain the information of uncertain parameters and fuzzy constraints and their fuzzy membership functions identify the values of feasibility robustness controllers and optimality robustness controller step 2 formulate the pfrwe model a nonlinear regional scale water energy nexus management model with fuzzy parameters and constraints step 3 transform pfrwe model into model 2 step 4 use linearization method to transform the nonlinear programming model 2 to a linear programming model which can be easily solved step 5 given the values of π φ and γ obtain the solutions of pfrwe model step 6 repeat step 5 to obtain the different solutions of the pfrwe model by dynamically adjusting the values of π φ and γ to control optimality robustness and feasibility robustness the flowchart of the pfrwe model is shown in fig 4 optimal solutions with enhanced robustness will be obtained for supporting water energy nexus management under fuzzy uncertainty a robust solution means the one with the characteristics of both feasibility robustness and optimality robustness feasibility robustness ensures that the solution remain feasible for almost all possible values of uncertain parameters optimality robustness makes sure that the value of objective function will remain close to the optimal value or have minimum undesirable deviation from the optimal value for almost all possible values of uncertain parameters pishvaee et al 2012 pishvaee and khalaf 2016 soyster 1973 the pfrwe model is coded in matlab r2017b with a low computational requirement which costs 10 67 s for each run 3 case study 3 1 data collection the developed pfrwe model is applied to a real world case study in liaoning province china to demonstrate its applicability liaoning province is located in the southern part of northeastern china with a total area of 148 600 square kilometers as shown in fig 5 it is bordering the yellow sea and bohai sea to the south and yalu river to the southeast based on the unique geographical location and distinctive resource distribution the study area is divided into four regions including the eastern region the southern region the western region and the northern region the eastern region includes benxi city and dandong city with the yalu river and the taizi river flowing through surface water and hydropower resources are sufficient for hydropower development the eastern region is suitable for nuclear power development since dandong city is close to the yellow sea and has stable geological structure it is also the only natural gas production area within the province the southern region covers panjin city yingkou city and dalian city with liao river and raoyang river flowing through adjacent to the bohai sea to the west and the yellow sea to the east dalian city has a nuclear power station the western region includes fuxin city jinzhou city chaoyang city and huludao city where light and wind energy are abundant for electricity generation with stable geological structure and advantageous location adjacent to the bohai sea huludao city and jinzhou city have the potential to develop nuclear power the main water resource in the western region is groundwater the northern region consists of tieling city shenyang city fushun city liaoyang city and anshan city locating inland with liao river and hun river flowing through desalinated sea water is an alternative water resource for meeting the ever increasing demands as of 2019 the total population of the eastern southern western and northern regions were 4 09 million 10 86 million 10 30 million and 18 44 million respectively with a total gdp of 160 31 billion 98 62 billion 304 34 billion and 979 52 billion respectively the northern region has the largest population with good economic development while the eastern region has the least population and poor economic development the relevant data used in this study is collected from public government reports news media reports and published literature bakken et al 2013a bakken et al 2013b china electric power news 2015 dalian municipal people s government 2019 development and reform commission of china 2011 dong 2014 edenhofer et al 2011 general office of the people s government of liaoning province 2017 gong et al 2008 heuberger et al 2017 liaoning provincial department of finance et al 2012 jiang 2013 lampert et al 2015 li 2006 mielke et al 2010 national energy board 2011 statistics bureau of liaoning province 2017 water resources department of liaoning province 2014 wu 2015 news media reports are shown in web reference new energy division 2018 china energy news 2019 china gas network 2017 china power news 2013 china thermal power network 2012 china water network 2018 liaoshen evening news 2017 polaris power network news center 2016 parameters of selling total demands allowances available water resources and available primary energy resources are shown in tables c1 c2 c3 and c4 the percentage of freshwater for electricity generation in all gas fired and biomass power plants is 100 while it is zero in all nuclear power plants all coal fired power plants use 100 of freshwater except four plants the fifth and sixth existing in the southern region the seventh existing in the eastern region and the first new in the western region plants which consume 35 20 30 and 30 of freshwater respectively that is since the four power plants are close to sea and it is easy for them to acquire freshwater resources using sea water desalination the maximum percentage of imported electricity is assumed to be 100 of total electricity demand primary energy resources represent the consumed energy for electricity generation including coal natural gas uranium and biomass for coal fired gas fired nuclear and biomass power plants respectively all uranium is supplied from outside the province for solar power wind power and hydropower maximum availabilities of primary energy resources represent capacity limitation of available solar radiation energy convertible wind energy and hydropower table c5 shows the parameters related to primary energy in most cases hydropower generation is a significant water consumer through evaporation from hydropower facilities and artificial water reservoirs in this study water consumption for unit hydropower generation is calculated as 209 00 10 3 m 3 kwh mekonnen and hoekstra 2012 the proportion of surface water groundwater desalination water and recycled water for both electricity production and primary energy production is 57 40 39 40 0 08 and 3 12 respectively only surface water is used for hydropower generation biomass electricity generation uses botany and waste as raw materials and the associated water consumptions are mainly for crop cultivation however in this study water consumption for biomass electricity generation will not be calculated since the raw materials are from agricultural wastes and domestic garbage tables c6 and c7 show the parameters related to the existing and new power plants tables c8 and c9 list the parameters related to maximum generation capacity of the existing and new water plants variable cost for unit water production in the existing and new water plants and fixed cost for building the new water plants average electricity line loss rate for social demand is 5 00 and average leakage rate of water pipe network for social demand is 15 00 electricity line loss rates from power plants to water plants and water pipe leakage rates from water plants to power plants are estimated by distance as shown in table c10 tables c1 c10 are listed in appendix c 3 2 results analyses 3 2 1 solutions obtained from the pfrwe model by adjustment of the values of the robustness controllers including π for optimality robustness and φ and γ for feasibility robustness different sets of optimal solutions can be obtained using the developed pfrwe model based on the preferences of decision makers exemplary analyses of precise solutions under π 1 and φ γ 0 2 are provided in the supplementary materials and the main conclusions are summarized a liaoning province has sufficient water production but insufficient electricity generation with 6 9 of total electricity consumption coming from imported electricity b coal fired power generation method will not be preferred but still an important way c development of gas fired power will be limited although it is more environmentally friendly compared to coal fired power due to the low purity and reserves of nature gas imperfect transportation system and relatively high price d nuclear power generation will be dominant due to its advantages in large power generation capacity low emissions of environmental pollutants stable power supply regardless of seasonal impacts and low demands of freshwater resources e hydropower is rarely developed during the planning period since the available hydraulic potential of the water system has been almost exploited f surface water is the main resource due to its abundance from multiple rivers flowing through liaoning province g groundwater is used in the areas far away from the rivers due to the higher costs for extracting surface water and potential water pollution caused by long distance transportation h in order to increase resource utilization efficiency and reduce pollution recycled water will be another important water resource i no desalinated sea water plant will be newly constructed during the planning period in liaoning province due to its market disadvantages 3 2 2 tradeoffs between robustness and water production electricity generation and imported electricity different sets of optimal solutions for water production electricity generation and imported electricity can be obtained using the pfrwe model through adjustment of optimality and feasibility robustness controllers when adjusting the robustness controller value in interval π 6 φ 0 6 and γ 0 6 expected total system profits have insignificant difference thus only optimal planning on water energy production and imported electricity under π 0 6 φ 0 0 6 and γ 0 0 6 are analyzed and presented in details in this section fig 6 shows the total electricity generation and water production under different optimality and feasibility robustness under fixed feasibility robustness φ γ 0 2 as shown in fig 6 a with the increased requirements of optimality robustness the optimal amounts of total electricity generation and total water production in liaoning province are less under a higher optimality robustness requirement corresponding to a higher π value the reduced production will lead to the decreases of energy resource consumptions associated water consumptions for power plants pollutant emissions during the electricity production process water resources consumptions and electricity consumptions for water production thus the solutions under higher optimality robustness controller values are more conducive to resource saving and environmental protection especially when π increases from 4 to 6 optimal amounts of total electricity generation in the study area will sharply decrease the results indicate that the changes of electricity generation are more obvious under different optimality robustness than water production in liaoning province similarly under a fixed optimality robustness of π 2 both total electricity generation and total water production in liaoning province decrease as values of φ and γ increase corresponding to prioritization of feasibility robustness as shown in fig 6 b the results as shown in fig 6 indicate slighter changes of optimal production of water and energy under different feasibility robustness than optimality robustness fig 7 shows electricity generation and water production in the existing and new plants under different optimality and feasibility robustness under fixed feasibility robustness controllers of φ and γ as the requirements for optimality robustness π increase the optimal planning of biomass and solar power generation in the existing and new power plants will firstly reduce due to their high dependence on unit electricity production allowance while coal fired power generation will be the last to disappear since the construction of new power plants has high costs and is susceptible to various factors such as regulations and policies the construction of new power plants will reduce under a higher optimality robustness requirement as the value of π increases to 4 only coal fired power will be generated in the new power plants while the types of the existing power plants involve coal fired nuclear wind and hydropower ones the results indicate that the changes of construction and production in the new power plants are more significant than those in the existing power plants under different optimality robustness requirements as shown in fig 7 a and c under a fixed optimality robustness of π compared with fixed feasibility robustness there are slighter changes of power generation in the existing and new power plants under different feasibility robustness as shown in fig 7 b and d changes of water production in the existing and new water plants are relatively smaller than those of electricity generation under different optimality robustness and feasibility robustness variations of water production patterns in the existing and new water plants will not be significant as optimality and feasibility robustness controllers vary fig 8 shows the imported electricity under different robustness different from electricity generation in liaoning province optimal quantity of imported electricity will grow rapidly with the increased demand of optimality robustness π that s since imported electricity has purchasing costs and is affected only by the uncertain parameter of electricity price while electricity generation involves multiple uncertain parameters in liaoning province in order to reduce the risk of total system profit s deviation from its expected optimal value under almost all uncertain parameters demand of imported electricity will gradually increase as optimality robustness requirement increases quantity of imported electricity will also increase under high requirement of feasibility robustness however the optimal quantity of imported electricity will remain more stable under different requirements of feasibility robustness than optimality robustness 3 2 3 tradeoffs between robustness and expected total system profit fig 9 shows the relationships among expected total system profit optimality robustness controller π and feasibility robustness controllers φ and γ the parameter of π controls the optimality robustness representing the tolerance of the deviation between the worst possible total system profit and the expected total system profit the larger the value of π corresponding to a smaller deviation between the worst possible total system profit and its expected optimal total system profit under different values of uncertain parameters the higher optimality robustness however with the increase of π meaning the reduced risk of total profit s deviation from its expected optimal value total system profit will decrease thus a higher optimality robustness represents the risk averse attitudes of decision makers as shown in fig 9 under the fixed feasibility robustness of φ and γ expected total system profit will decrease as π increases which means the risk averse solutions with more imported electricity less water and power plant constructions and less water and electricity production since the income from imported electricity is far less than the revenues from water and electricity production expected total system profit will decrease both the parameters of φ and γ control the feasibility robustness φ represents a punishment on the bias between the chosen values of right hand side fuzzy parameters of the flexible constraints and its smallest possible value such as minimum resources availability and γ means a punishment on violation of the flexible constraints a larger value of φ corresponds to smaller values of right hand side fuzzy parameters of the flexible constraints and a larger value of γ indicates a smaller tolerance of violation of the flexible constraints with the increase of φ and γ feasibility robustness will increase and the risk of violation of the flexible constraints will decrease which guarantees the obtained solutions to remain feasible under almost all uncertain values of fuzzy parameters and constraints however as shown in fig 9 under a given π expected total system profit will decrease as φ and γ increase in this study φ and γ indicate the punishment of unsatisfied water and energy resources availability water and energy demands and maximum water and energy generation capability if decision makers prefer the reduced risk of violating the flexible constraints such as resources availability demands and maximum generation capability i e a higher feasibility robustness less water and electricity will be produced resulting in a decreased expected total system profit and resources consumption using the developed pfrwe model tradeoffs between economic objectives and system failure risks of total profit s deviating from its expected optimal value and violating the flexible constraints can be effectively quantified although a maximum total system profit is preferred by decision makers the system failure risks will be the highest corresponding to the lowest robustness accepting a lower total system profit will enhance the system robustness and reduce the system failure risks as the increase of robustness expected total profit water energy nexus system in liaoning province will transition from a gain to a loss and eventually stabilize at a loss of approximately rmb 73 00 109 shown in fig 9 by adjustment of optimality and feasibility robustness controllers different sets of optimal solutions can be obtained based on the preferences of decision makers to support water energy nexus management in practices 3 2 4 comparison with the deterministic model the developed pfrwe model is compared to a deterministic model which represents a situation where all fuzzy parameters are set with the values at the highest membership degree of 1 and at the same time fuzzy constraints are assumed to be fully satisfied results from the deterministic model with the expected total profit of rmb 5 16 109 while the expected total profit from the pfrwe model is rmb 15 28 109 under π 1 and φ γ 0 2 under the low preference for robustness the expected total system profit obtained from the pfrwe is higher than that from the deterministic model at the same time total social demands are not fully satisfied and improvement of production technologies are required to save costs the increased electricity generation and decreased imported electricity also led to the increased expected total system profit in the pfrwe model the comparison of optimal water production and electricity generation between the deterministic model and pfrwe model under π 1 and φ γ 0 2 are shown in fig 10 optimal total electricity consumption obtained from the pfrwe model is 161436 50 106 kwh year among which the consumed imported electricity is 11146 05 106 kwh year accounting for 6 90 of the total electricity consumption for the deterministic model optimal total electricity consumption is 165341 60 106 kwh year while imported electricity account for 15 16 equal to 25073 40 106 kwh year from fig 10 the production structure in each region is similar for example the planning results of both the pfrwe model and the deterministic model show that electricity generated by nuclear power is the most in the eastern region followed by coal fired power and hydropower generation gas power generation is also an important form of power generation in the eastern region however the results of the two models are different in amounts using the pfrwe model the total electricity generation in the eastern region is 45 61 106 kwh year which is 3 24 106 kwh year more than that from the deterministic model according to the planning results of the pfrwe model the total electricity generation in the southern western and northern regions are 48 45 106 kwh year 39 62 106 kwh year and 16 61 106 kwh year respectively all of which are higher than those from the deterministic model corresponding to 45 67 106 kwh year 36 70 106 kwh year and 15 63 106 kwh year respectively those are since the pfrwe model considers the possibility of improving technology or management in power plants to increase generation capacity water production structures from the pfrwe model and deterministic model are also similar the comparison results indicate that amounts of water production from the deterministic model are higher than those from the pfrwe model in all regions due to more social demands and electricity generation demands using the pfrwe model amounts of water production in the eastern southern western and northern regions are 344 30 106 m3 year 833 35 106 m3 year 545 95 106 m3 year and 1459 76 106 m3 year respectively while using the deterministic model they are 345 65 106 m3 year 836 80 106 m3 year 548 86 106 m3 year and 1555 53 106 m3 year respectively fig 11 shows the electricity consumption for water production and water consumption for electricity generation in four regions obtained from the deterministic model and pfrwe model under π 1 and φ γ 0 2 the consumed electricity is generated in each region and can be transmitted to water plants in other regions for water production as shown in fig 11 water consumption for electricity generation in the western region is the most while in the eastern region it is the least coal fired power generation has the largest water consumption for unit electricity production followed by nuclear power generation and then biomass and gas fired power generation nuclear power plants do not consume freshwater resources since they are generally built on the seashore with their own desalination facilities the amounts of water consumption for electricity production in liaoning province mostly depend on the production capacity of coal fired power plants the southern and the western regions have almost same amounts of power generation but different water consumption since coal fired power plants use sea water as an alternative water source for power generation in the southern region electricity consumption for water generation is the most in the northern region and the least in the eastern region from fig 11 water consumption for electricity generation planned by the pfrwe model is more than that planned by the deterministic model more detailed solutions obtained from the deterministic model and pfrwe model under π 1 and φ γ 0 2 are provided in supplementary materials in fact the deterministic model is a special case of the pfrwe model and offers no flexibility in decision support for water energy nexus management in practices only a set of solutions are generated by using the deterministic model for supporting decision making related to construction of different types of new water and power plants quantity of water production and electricity generation water consumptions for electricity generation electricity consumptions for water production and amounts of imported electricity the feasibility of optimal solutions obtained by the deterministic model and pfrwe model under three different scenarios i e the worst case the best case and the most possible case are compared under the worst scenario the fuzzy constraints should be strictly met and the values of parameters correspond to the smaller one at the lowest membership degree of 0 this means that the external environment is expected the worst with the least available resources and production capacity as well as the highest production costs and demands the most possible case is the same as assumed in the deterministic model the best case corresponds to the loosest constraints where the values of parameters are assumed to be the highest one at the lowest membership degree of 0 the feasibility is expressed by the constraint satisfaction of every group of fuzzy constraints b13 b29 and b30 b32 which is calculated as follows c o n s t r a i n t s a t i s f a c t i o n number o f s a t i s f i e d c o n s t r a i n t s number o f t o t a l c o n s t r a i n t s 100 for example the fuzzy constraint group b13 representing i p 1 n p te p i p o k p 1 r p te p k p n x p k p ec r p 1 i p e p ba e p p 1 2 3 4 includes 4 constraints since p 1 p 2 p 3 p 4 if two of them are satisfied the constraint satisfaction of fuzzy constraint group b13 is 2 4 100 50 fig 12 shows the comparison of constraint satisfaction of the optimal solutions from the deterministic model and pfrwe model with different optimality robustness and feasibility robustness since available resource constraints i e b13 b16 and drinking water demand constraints i e b31 are always satisfied under all three cases fig 12 only shows the variations of the constraint satisfaction of plants production capacity i e b17 b20 total electricity demand i e b30 and total water demand i e b32 as shown in fig 12 a constraints b17 b20 have low constraint satisfaction except under π 4 φ γ 0 3 and π 6 φ γ 0 3 in the pfrwe model thus increasing the optimality robustness can enhance the feasibility of the results the low constraint satisfaction in b17 b20 indicates a high possibility that the water and electricity production will not meet the expectations and the solutions correspond to a greater risk of infeasibility the unreachable production will also lead to deviations in constraints satisfaction calculation of demand constraints b30 b32 from fig 12 b under the most possible case the solutions of the deterministic model will meet all the constraints and so as prfwe model under π 2 φ γ 0 9 when feasibility robustness maintains at a low value such as φ γ 0 3 the constraints cannot be fully satisfied even under a high optimality robustness increasing feasible robustness can make the constraints be fully satisfied even under lower optimal robustness requirements such as π 2 as shown in fig 12 c all solutions from the deterministic model and prfwe model are feasible except three conditions the prfwe model under π 0 φ γ 0 0 3 and under π 2 φ γ 0 0 3 take a little infeasibility risk in constraints b17 while the prfwe model under π 2 φ γ 0 takes more risks in violating constraints b17 b19 and b20 thus under the best case the feasibility robustness has more effects on model feasibility under all three cases increasing only the optimality robustness or feasibility robustness can improve the performance of model in feasibility risk taking increasing feasible robustness can effectively reduce the risk of infeasibility under all the most possible case and the best case it is not enough to improve the feasibility under the worst case only by increasing the feasible robustness where improving optimality robustness together is desired thus the stronger the robustness the higher the possibility that the solutions remain feasible the results indicate that the pfrwe model can offer more flexibility in feasibility risk taking and perform better under higher robustness such as π 6 φ γ 0 9 than the deterministic model fig 13 shows the optimal total system profit obtained from the deterministic model and the pfrwe model the difference between the maximum and minimum values of the total system profit corresponding to the solutions of the deterministic model the pfrwe model under π 0 φ γ 0 and prfwe model under π 2 φ γ 0 3 are very similar among them the deterministic model has the least total system profit under the most possible case with the increase of robustness requirements the difference between the maximum and minimum values of the optimal total system profit obtained from the pfrwe model gradually decreases and so as the optimal value under the most possible case compared to the deterministic model the pfrwe model can provide solutions with higher total system profit or solutions with little variations of total system profit it can also provide the most preferable solutions to satisfy the needs of decision makers with varying demands in balancing the tradeoffs between economic objectives and robustness 4 conclusions in this study a nonlinear mixed possibilistic flexible robust water energy nexus model named pfrwe has been developed for supporting integrated water energy nexus planning and management at a regional scale the pfrwe model has improved upon the existing water energy nexus management methods through incorporation of fuzzy flexible programming fuzzy possibilistic programming robust programming and mixed integer nonlinear programming into a general framework it can deal with not only fuzzy uncertainties in the modeling parameters and the constraints but also the robustness of the model and the solutions by introducing feasibility robustness and optimality robustness the pfrwe model can provide effective decision support for planning of electricity generation and water production as well as construction of new water and power plants in the water energy nexus management at a regional scale under fuzzy uncertainties the developed pfrwe model has been applied to a real world case study in liaoning province china to test its applicability optimal solutions for construction decisions of new power and water plants types of new power and water plants quantity of electricity generation and water production water consumptions for electricity generation electricity consumptions for water production and amounts of imported electricity are obtained the developed pfrwe model can effectively quantify tradeoffs between expected total system profit and model s robustness results show that the changes of electricity generation are more obvious under different robustness than water production as robustness controllers including optimality and feasibility robustness vary variations of water production patterns in the existing and new water plants will not be significant while electricity generation patterns in the existing and new power plants dose compared with fixed feasibility robustness there are slighter changes of power generation in the existing and new power plants under different feasibility robustness under a fixed optimality robustness of π the higher optimality robustness and feasibility robustness corresponding to the higher risk averse attitudes of decision makers the less expected total system profit decision makers may obtain a variety of optimal solutions for water energy nexus management in practices based on their preferences by dynamically adjusting optimality and feasibility robustness controllers the stronger the robustness the higher the probability that the solution remains feasible and pfrwe model can provide better solutions than deterministic model on feasibility the pfrwe model can also provide solutions with higher expected total system profit or solutions with little variations on expected total system profit than the deterministic model thus pfrwe model can also provide the most preferable solutions to satisfy the needs of decision makers with varying demands in balancing the tradeoffs between economic objectives and robustness although the pfrwe model can generate robust solutions and deal with fuzzy uncertainties simultaneously in water energy nexus it has some limitations and can be further improved firstly climate change may have impacts on water and energy production on the one hand global warming may lead to insufficient fresh water supply the reduced availability of freshwater resources under climate change will lead to the closure of water intensive power plants such as coal fired and gas fired power plants where a large amount of water is required for cooling purposes on the other hand the chinese government has set stricter air pollutant emission standards in response to climate change the pfrwe model can be extended in the future to address the water energy climate nexus issues through consideration of greenhouse gas emission control and resource demand and availability under various changing climatic scenarios secondly the pfrwe model may further address the whole life cycle analyses of water energy nexus processes instead of their production and transportation one of the examples is although photovoltaic has no water consumption at its production and transportation stages it consumes approximately 28 2 gal mwh of water from the whole life cycle point of view meldrum et al 2013 incorporation of life cycle analysis into the pfrwe model will have the potential to improve its applicability in practices finally more complex uncertainties such as stochastic nature in the modeling parameters and relationships can be considered in the extensions of the pfrwe model the pfrwe model can also be applied in water energy nexus planning in other regions credit authorship contribution statement chen chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing xiaodong zhang conceptualization methodology writing review editing supervision shuguang wang supervision writing review editing huayong zhang investigation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we much appreciate the support from national natural science foundation of china no 51779132 we would like to also thank editor associate editor and three anonymous reviewers for their insightful comments and suggestions to improve the manuscript appendix a index p types of power plants p 1 coal fired p 2 gas fired p 3 nuclear p 4 biomass p 5 solar p 6 wind p 7 hydropower q types of water plants q 1 surface water q 2 groundwater q 3 desalinated sea water q 4 recycled water n p total number of type p of the existing power plants i p number of type p of the existing power plant i p 1 n p m q total number of type q of the existing water plants j q number of type q of the existing water plant j q 1 m q r p total number of type p of the new power plants k p number of type p of the new power plant k p 1 r p s q total number of type q of the new water plants l q number of type q of the new water plant l q 1 s q variables x p k p an integer variable for indicating whether to construct the k p th p type new power plant 1 yes 0 no y q l q an integer variable for indicating whether to construct the l q th q type new water plant 1 yes 0 no ew p i p q j q oo quantity of electricity supply from the i p th type p existing power plants to the j q th type q existing water plants kwh year ew p k p q j q no quantity of electricity supply from the k p th type p new power plant to the j q th type q existing water plant kwh year ew p i p q l q on quantity of electricity supply from the i p th type p existing power plants to the l q th type q new water plants kwh year ew p k p q l q nn quantity of electricity supply from the k p th type p new power plant to the l q th type q new water plant kwh year eo p i p o quantity of electricity supply for social demand from the i p th type p existing power plant kwh year eo p k p n quantity of electricity supply for social demand from the k p th type p new power plant kwh year ie q j q o quantity of imported electricity for the j q th type q existing water plant kwh year ie q l q n quantity of imported electricity for the l q th type q new water plant kwh year id quantity of imported electricity from outside provinces for social demand except imported electricity for water production kwh year tw q j q o total water production of the j q th type q existing water plant m 3 year te p i p o total electricity generation of the i p th type p existing power plant kwh year tw q l q n total water production in the l q th type q new water plant m 3 year te p k p n total electricity generation in the k p th type p new power plant kwh year we q j q p i p oo quantity of water supplied from the j q th type q existing water plant to the i p th type p existing power plant m 3 year we q l q p i p no quantity of water supply from the l q th type q new water plant to the i p th type p existing power plant m 3 year we q j q p k p on quantity of water supplied from the j q th type q existing water plant to the k p th type p new power plant m 3 year we q l q p k p nn quantity of water supply from the l q th type q new water plant to the k p th type p new power plant m 3 year wo q j q o quantity of water supply for social demand from the j q th type q existing water plant m 3 year wo q l q n quantity of water supply for social demand from the l q th type q new water plant m 3 year parameters ae p p allowance for constructing the new power plant with type p expressed as fuzzy parameters rmb aw p q allowance for constructing the new water plant with type q expressed as fuzzy parameters rmb ba e p available energy resources for type p electricity generation expressed as fuzzy parameters p 1 2 3 4 tce 1 10 3 ton of standard coal equivalent ba w q availability of water resources q expressed as fuzzy parameters q 1 2 3 4 m 3 year ecr p primary energy resources consumption for unit electricity generation p 1 2 3 4 tce kwh for p 1 2 4 g uranium fuel kwh for p 3 ell p i p o average electricity line loss rate for social demand from the i p th type p existing power plant ell p k p n average electricity line loss rate for social demand from the k p th type p new power plant elw q j q o average leakage rate of water pipe network for social demand from the j q th type q existing power plant elw q l q n average leakage rate of water pipe network for social demand in the l q th type q new power plant euw q j q o average electricity consumption for unit water production in the j q th type q existing power plant kwh m 3 euw q l q n average electricity consumption for unit water production in the l q th type q new power plant kwh m 3 fc e p k p n fixed cost for building the k p th type p new power plant expressed as fuzzy parameters rmb fc w q l q n fixed cost for building the l q th type q new water plant expressed as fuzzy parameters rmb fwe p i p o the percentage of freshwater among total water demand for electricity generation in the i p th type p existing power plant fwe p k p n the percentage of freshwater among total water demand for electricity generation in the k p type p new power plant fwp pq the proportion of type q water demand among total water demand in type p primary energy production ipe p the ratio of type p imported primary energy resources to total primary energy demand p 1 2 3 4 llr p i p q j q oo electricity line loss rate from the i p th type p existing power plant to the j q th type q existing water plant llr p k p q j q no electricity line loss rate from the k p th type p new power plant to the j q th type q existing water plant llr p i p q l q on electricity line loss rate from the i p th type p existing power plants to the l q th type q new water plant llr p k p q l q nn electricity line loss rate from the k p th type p new power plant to the l q th type q new water plant me p p maximum electricity production by type p power plants which is expressed as fuzzy parameters and calculated based on generation capacity of type p power plants p 5 solar power p 6 wind power and p 7 hydropower kwh year me c p i p o maximum generation capacity of the i p th type p existing power plant expressed as fuzzy parameters kwh year me c p k p n maximum generation capacity of the k p th type p new power plant expressed as fuzzy parameters kwh year mie maximum available percentage of imported electricity among total electricity demand mw c q j q o maximum generation capacity of the j q th type q existing water plant expressed as fuzzy parameters m 3 year mw c q l q n maximum generation capacity of the l q th type q new water plant expressed as fuzzy parameters m 3 year nlw q j q p i p oo leakage rate of water pipe network from the j q th type q existing water plant to the i p th type p existing power plant nlw q l q p i p no leakage rate of water pipe network from the l q th type q new water plant to the i p th type p existing power plant nlw q j q p k p on leakage rate of water pipe network from the j q th type q existing water plant to the k p th type p new power plant nlw q l q p k p nn leakage rate of water pipe network from the l q th type q new water plant to the k p th type p new power plant pkw qp i p o the proportion of type q water consumption among total freshwater demand for electricity production in the i p th type p existing power plant pkw qp k p n the proportion of type q water consumption among total freshwater demand for electricity production in the k p th type p existing power plant pre selling price of electricity expressed as fuzzy parameters rmb kwh pr w q selling price of water with type q expressed as fuzzy parameters rmb m 3 ted total electricity demand expressed as fuzzy parameters kwh year tr e p allowance for unit electricity generation with type p expressed as fuzzy parameters rmb kwh tr w q allowance for unit type q water generation expressed as fuzzy parameters rmb m 3 vc e p i p o variable cost for unit electricity production in the i p th type p existing power plant which does not include cooling water fee from the water plants expressed as fuzzy parameters rmb kwh vc e p k p n variable cost for unit electricity production in the k p th type p new power plant which does not include cooling water fee from the water plants expressed as fuzzy parameters rmb kwh vc w q j q o variable cost for unit water production in the j q th type q existing water plant which does not include cost of electricity from power plants for water collection and treatment expressed as fuzzy parameters rmb m 3 vc w q l q n variable cost for unit water production in the l q th type q new water plant which does not include cost of electricity from power plants for water collection and treatment expressed as fuzzy parameters rmb m 3 wcc p water consumption coefficient in type p primary energy production m3 tce for p 1 2 3 4 m 3 kwh for p 5 6 7 wdd total drinking water demand expressed as fuzzy parameter m 3 year wds total water demand expressed as fuzzy parameter m 3 year wue p i p o average water consumption for unit electricity production in the i p th type p existing power plant m 3 kwh wue p k p n average water consumption for unit electricity generation in the k p th type p new power plant m 3 kwh appendix b the management objective is to maximize the total system profit as follows b1 m a x t o t a l s y s t e m p r o f i t f 1 f 2 f 3 f 4 f 5 f 6 f 7 f 8 f 9 f 10 f 11 allowance for the construction of new power plants b2 f 1 p 1 7 k p 1 r p aep p x p k p allowance for the construction of new water plants b3 f 2 q 1 4 l q 1 s q awp q y q l q cost for construction of new power plants b4 f 3 p 1 7 k p 1 r p fce p k p n x p k p cost for construction of new water plants b5 f 4 q 1 4 l q 1 s q fcw q l q n y q l q allowance for electricity generation b6 f 5 p 1 7 k p 1 r p tre p te p i p o te p k p n x p k p allowance for water production b7 f 6 q 1 4 l q 1 s q trw q tw q j q o tw q l q n y q l q variable costs for electricity generation such as cost of water consumption in power plants and cost of other resources materials and labor services b8 f 7 p 1 7 i p 1 n p q 1 4 pkw qp i p o prw q wue p i p o fwe p i p o vce p i p o te p i p o p 1 7 k p 1 r p q 1 4 pkw qp i p n prw q wue p k p n fwe p k p n vce p k p n te p k p n x p k p variable costs for water production such as cost of electricity consumption in water plants and cost of other resources materials and labor services b9 f 8 q 1 4 l q 1 s q pre euw q j q o vcw q j q o tw q j q o q 1 4 l q 1 s q pre euw q l q n vcw q l q n tw q l q n y q l q electricity selling revenues b10 f 9 p 1 7 i p 1 n p pre q 1 4 j q 1 m q 1 llr p i p q j q oo ew p i p q j q oo q 1 4 l q 1 s q 1 llr p i p q l q on ew p i p q l q on y q l q 1 ell p i p o eo p i p o p 1 7 k p 1 r p pre q 1 4 j q 1 m q 1 llr p k p q j q no ew p k p q j q no q 1 4 l q 1 s q 1 llr p k p q l q nn ew p k p q l q nn y q l q 1 ell p k p n eo p k p n x p k p water selling revenues b11 f 10 q 1 4 l q 1 s q prw q p 1 4 i p 1 n p 1 nlw q j q p i p oo we q j q p i p oo p 1 4 k p 1 r p 1 nlw q j q p k p on we q j q p k p on x p k p 1 elw q j q o wo q j q o q 1 4 l q 1 s q prw q p 1 4 i p 1 n p 1 nlw q l q p i p no we q l q p i p no p 1 4 k p 1 r p 1 nlw q l q p k p nn we q l q p k p nn x p k p 1 elw q l q n wo q l q n y q l q cost for imported electricity b12 f 11 pre i d the constraints of the pfrwe model include constraints of energy availability the sum of primary energy resources such as coal gas uranium and biomass except imported energy should not be greater than the available energy resources within the study region as follows b13 i p 1 n p te p i p o k p 1 r p te p k p n x p k p ecr p 1 ipe p bae p p 1 2 3 4 the power generation capacity of solar power wind power and hydropower are respectively constrained by the number of effective hours of light throughout the year b14 i p 1 n p te p i p o k p 1 r p te p k p n x p k p mep p p 5 6 7 the capacity of solar power electricity generation is computed based on annual effective available illumination hours and average conversion efficiency the capacity of wind power electricity generation is calculated based on wind energy density and accumulated annual hours of available wind energy the capacity of hydropower power electricity generation is determined based on potential energy of rivers and lakes constraints of water availability the amounts of consumed water resources for primary energy mining and refining electricity generation in the power plants and water production in the water plants should not exceed the availability of each type of water resources b15 j 1 1 m 1 tw 1 j 1 o l 1 1 s 1 tw 1 l 1 n y 1 l 1 p 1 2 3 i p 1 n p te p i p o ecr p 1 ipe p wcc p fwp p 1 p 1 2 3 k p 1 r p te p k p n x p k p ecr p 1 ipe p wcc p fwp p 1 i 7 1 n 7 te 7 i 7 o k 7 1 r 7 te 7 k 7 n x p k p wcc 7 baw 1 b16 j q 1 m q tw q j q o l q 1 s q tw q l q n y q l q p 1 2 3 i p 1 n p te p i p o ecr p 1 ipe p wcc p fwp pq p 1 2 3 k p 1 r p te p k p n x p k p ecr p 1 ipe p wcc p fwp pq baw q q 2 4 total water consumption for primary energy mining and refining is determined depending on total electricity generation primary energy resources consumption for unit electricity generation and water consumption coefficient in primary energy production constraints of maximum generation capacity of every power plants b17 te p i p o mec p i p o p 1 2 3 4 5 6 7 i p 1 n p b18 te p k p n mec p k p n p 1 2 3 4 5 6 7 k p 1 r p constraints of maximum generation capacity of every water plants b19 t w q j q o mw c q j q o q 1 2 3 4 j q 1 m q b20 t w q l q n mw c q l q n q 1 2 3 4 l q 1 s q balance equation of electricity supply and demand the amounts of electricity generation should be equal to total electricity consumption including electricity demand for all water plants and social demand b21 te p i p o q 1 4 j q 1 m q ew p i p q j q oo q 1 4 l q 1 s q ew p i p q l q on y q l q eo p i p o p 1 2 3 4 5 6 7 i p 1 n p b22 te p k p n x p k p q 1 4 j q 1 m q ew p k p q j q no q 1 4 l q 1 s q ew p k p q l q nn y q l q eo p k p n x p k p p 1 2 3 4 5 6 7 k p 1 r p balance equation of water supply and demand the amounts of water production should be equal to total water consumption including water demand for all power plants and social demand b23 tw q j q o p 1 7 i p 1 n p we q j q p i p oo p 1 7 k p 1 r p we q j q p k p on x p k p wo q j q o q 1 2 3 4 j q 1 m q b24 tw q l q n y q l q p 1 7 i p 1 n p we q l q p i p no p 1 7 k p 1 r p we q l q p k p nn x p k p wo q l q n y q l q q 1 2 3 4 l q 1 s q balance of water demand for electricity generation the amounts of water delivered to power plants except pipe leakage should be equal to water demand for electricity generation b25 q 1 4 j q 1 m q 1 nlw q j q p i p oo we q j q p i p oo q 1 4 l q 1 s q 1 nlw q l q p i p no we q l q p i p no y q l q te p i p o wue p i p o fwe p i p o p 1 2 3 4 i p 1 n p b26 q 1 4 j q 1 m q 1 nlw q j q p k p on we q j q p k p on q 1 4 l q 1 s q 1 nlw q l q p k p nn we q l q p k p nn y q l q x p k p te p k p n wue p k p n fwe p k p n x p k p p 1 2 3 4 k p 1 r p balance of electricity demand for water generation the amounts of electricity delivered to water plants except line loss should be equal to electricity demand for water generation b27 p 1 7 i p 1 n p 1 llr p i p q j q oo ew p i p q j q oo p 1 7 k p 1 r p 1 l l r p k p q j q no ew p k p q j q no x p k p ie q j q o tw q j q o euw q j q o q 1 2 3 4 j q 1 m q b28 p 1 7 i p 1 n p 1 llr p i p q l q on ew p i p q l q on p 1 7 k p 1 r p 1 llr p k p q l q nn ew p k p q l q nn x p k p ie q l q n y q l q tw q l q n euw q l q n y q l q q 1 2 3 4 l q 1 s q constraints of availability of imported electricity the total amounts of imported electricity for both water generation and social demand should not be larger than the maximum available imported electricity b29 q 1 4 j q 1 m q i e q j q o q 1 4 l q 1 s q i e q l q n y q l q i d m i e ted constraints of total water demand total water demand should be less than or equal to total water production except water for electricity generation and loss caused by leakage b30 wds q 1 4 j q 1 m q 1 e l w q j q o w o q j q o q 1 4 l q 1 s q 1 e l w q l q n w o q l q n y q l q constraints of drinking water demand drinking water is only produced in surface water plants groundwater plants and desalinated sea water plants the recycled water plants will not produce drinking water due to environmental regulations and water quality control standards the total drinking water demand should not be greater than total water production from surface water plants groundwater plants and desalinated sea water plants except leakage loss b31 wdd q 1 3 j q 1 m q 1 e l w q j q o w o q j q o q 1 3 l q 1 s q 1 e l w q l q n w o q l q n y q l q constraints of total electricity demand total electricity demand should be less than or equal to electricity generation except electricity for water production and line loss b32 ted p 1 7 i p 1 n p 1 e l l p i p o e o p i p o p 1 7 k p 1 r p 1 e l l p k p n e o p k p n x p k p i d technical constraints x p k p y q l q 0 1 te p i p o 0 te p k p n 0 tw q j q o 0 tw q l q n 0 ew p i p q j q oo 0 ew p k p q j q no 0 ew p i p q l q on 0 ew p k p q l q nn 0 eo p i p o 0 eo p k p n 0 we q j q p i p oo 0 we q l q p i p no 0 we q j q p k p on 0 we q l q p k p nn 0 wo q j q o 0 wo q l q n 0 ie q j q o 0 ie q l q n 0 b33 id 0 appendix c appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126852 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
4109,accounting for freshwater resources and monitoring floods are vital functions for societies throughout the world remote sensing methods offer great prospects to expand stream monitoring in developing countries and to smaller headwater streams that are largely ungauged worldwide this study evaluates the potential to estimate discharge using eight radar units that have been installed over streams in diverse hydrologic and hydraulic settings across the united states the research highlights error characteristics associated with the measurements of stage using pulsed wave radars mean channel velocity from continuous wave doppler radars and their combined use to estimate discharge at sites that were collocated with conventional streamgauges potential stage biases caused by the thermal expansion and contraction of supporting structures due to diurnal temperature changes were examined a dry concrete flume showed the temperature dependent stage variations were no more than 2 cm surface velocity retrievals needed to be adjusted to represent the mean channel velocity when estimating discharge different approaches were evaluated and application of two different depth dependent adjustment factors was found to yield the most accurate estimates this study found that it is possible to get accurate discharge estimates from noncontact radar measurements providing cost effective solutions for remote sensing of ungauged streams lastly radar measurements of the raw variables i e stage and surface velocity can be used in an early alerting context to detect flash floods in ungauged streams keywords flash floods noncontact streamgauging remote sensing uncertainty estimation 1 introduction stream discharge estimates are of paramount importance for stormwater management flood forecasting estimating sediment load for water quality water resources management navigation recreation and endangered species protection and management conventional streamgauges such as those operated and maintained by the u s geological survey usgs provide measurements of water depth eberts et al 2018 to compute the discharge an empirical relation is established between the stage which is the measured water depth plus bed elevation and discharge to compute a stage discharge rating these rating curves require manual in situ measurements of the variables to compute discharge i e distribution of flow velocity stream cross section stage over a wide range of river flow conditions buchanan and somers 1969 technicians collect these data approximately every six weeks using a combination of current meters and hydroacoustic devices instream and near bank vegetation changes and sediment deposition and scour which can become enhanced during floods can change the shape of a previously surveyed cross section and the associated rating curve mason and weiger 1995 changes in the hydraulics and channel cross section require regular visits and instream measurements remote sensing has increasingly become a more desired alternative to manual surveying and conventional in situ measurement techniques because remote sensing instruments do not need to be in contact with the water moramarco et al 2019 remote sensing instruments provide increased safety to the technicians and are less likely to be lost during major floods than fixed traditional streamgauging equipment in addition to providing the potential for less expensive operations and maintenance fulton et al 2020 remote sensing technologies used to estimate discharge in streams include cameras and radars image analysis using cameras such as the large scale particle image velocimetry lspiv technique have demonstrated the capability of estimating surface velocities in streams fujita et al 1998 creutin et al 2003 muste et al 2008 stringent procedures are followed to ensure usable image quality in long wide natural channels and operational applications are challenged by bandwidth requirements for transmitting video kim et al 2007 tauro et al 2017 detert 2021 provides a set of guidelines to help users improve their procedures for performing image based surface velocity measurements after its first introduction in 2000 various noncontact radar techniques have been utilized for stage and surface velocity measurements costa et al 2000 instruments include a helicopter mounted radar an x band pulsed radar coherent microwave systems continuous wave microwave monostatic uhf doppler and pulsed doppler microwave radar lee et al 2002 melcher et al 2002 plant et al 2005 costa et al 2006 these studies were primarily experimental and demonstrate the basic measurements of stage and surface velocity in rivers until now very few research studies have assessed the uncertainty of noncontact measurements with radars welber et al 2016 fulton et al 2020 our study is a component of the larger automated noncontact hydrologic observations in rivers project anchor https www nssl noaa gov projects anchor that was originally motivated by the noncontact radar based discharge estimates presented in costa et al 2006 in the present study we use a stream radar unit that integrates two noncontact radar methods to retrieve both the stage and surface water velocity of a stream simultaneously eight stream radars have been installed on bridges culverts and cables throughout the united states and provided year round measurements with a typical temporal resolution of 5 10 min the objectives of this study are as follows 1 to identify and quantify the error in stage measurements by the nadir pointing pulsed wave radar 2 to optimize the correction for translating surface water velocities from the doppler radar to a mean channel velocity needed to compute discharge from noncontact measurements and 3 to assess the sensors capabilities to detect the rapid onset of flooding events in ungauged basins section 2 describes the physical settings of the radar deployments and the methods used for deriving discharge section 3 identifies sources of measurement uncertainty and quantifies them section 3 also reveals the characteristics of a major flash flooding event conclusions from the study and a discussion are summarized in section 4 2 methods and materials 2 1 study area to represent a variety of meteorological hydrologic and hydraulic characteristics eight stream radars have been installed on cables culverts and bridges across streams at locations in four states in the united states as shown in fig 1 three are installed in texas two each in arizona and oklahoma and one in colorado site selection was based on several factors including proximity to a conventional streamgauge a need for monitoring cellular network signal strength site security and access and hydraulic suitability of the site for monitoring these constraints permitted testing of the radars for a variety of hydrologic and hydraulic settings the radars were installed on a bridge in an urban setting fig 2 a b above a small natural channel in a rural setting fig 2c d on an instrumented flume in the desert fig 2e f on a bridge above a river with frequent morphological changes fig 2g h above a small creek upstream from a popular summer camp fig 2i j on a box culvert over a spring fed creek fig 2k l above an engineered urban channel fig 2m n and above a stream on a railway bridge fig 2o p in general it took two to three people a few hours to install the sensors the basin areas for these streams range from 2 to 3676 km2 and are characterized by different land use settings including forested urban and desert table 1 the 5 or 10 minute logging rate is user defined cherry creek is a tributary of the south platte river that runs near denver colorado fig 2a the area of the basin is 1059 km2 according to the national land cover database 2011 nlcd 2011 homer et al 2015 land use in the upper part of the basin is mostly vegetation e g herbaceous and shrub scrub whereas the lower part is a developed area where the site is located the relative proportions of sand silt and clay are 53 9 29 7 and 16 4 respectively as per conus soil datasets miller and white 1998 the area has a mean basin slope of 7 9 the mean annual precipitation from 1981 to 2010 at the radar location is 404 mm prism 2004 the stream radar is mounted on a bridge here fig 2b and situated approximately 60 m upstream from a usgs streamgauge id 06713500 mill creek runs through rural johnston county oklahoma the basin area is 124 km2 fig 2c the nlcd 2011 land use of the area is mostly herbaceous and hay pasture lands the soil texture has a relative proportion of sand silt and clay as 27 42 3 and 30 7 respectively the area has a mean basin slope of 3 2 and the mean annual precipitation near the radar location is 1027 mm per year the radar is cable mounted fig 5 and has a usgs streamgauge approximately 30 m upstream from its position id 07331200 the stream radar at walnut gulch is part of the dense instrumentation comprising the u s department of agriculture usda agricultural research service s walnut gulch experimental watershed in southeast arizona water moves through a concrete flume here and the size of the contributing area is 7 8 km2 fig 2e the primary land use type of the basin is desert vegetation e g shrub and herbaceous the relative proportions of sand silt and clay are 58 29 6 and 12 4 respectively the basin has a moderately sloping mean gradient of about 12 1 the mean annual precipitation amount is 356 mm the radar is mounted on a bridge fig 2f and collocated with a conventional usda streamgauge discharge data are provided only during events and can be just a few episodes per year during the monsoon paria river is a tributary of the colorado river that runs from southern utah towards northern arizona it has a very large basin area of approximately 3676 km2 for the radar location fig 2g the upper part of the basin has some vegetation land usages but the rest of the area is mostly barren desert land for soil texture the relative proportions of sand silt and clay are 56 23 3 and 14 7 respectively the basin has a high mean slope of 20 9 the area near the radar has a very low mean annual precipitation of 185 mm the radar is mounted on a bridge fig 2h and has a usgs streamgauge id 09382000 about 1 2 km upstream from its position because of this distance between the usgs streamgauge and the stream radar it is not considered to be collocated to conduct direct discharge comparisons falls creek originates from the springs of the arbuckle simpson aquifer and flows towards the northeast into the washita river in oklahoma the size of the basin area for the stream radar location is 15 1 km2 fig 2i the land uses mostly include grassland and different types of forest e g evergreen and deciduous the relative proportions of sand silt and clay are 23 63 and 14 respectively the mean basin slope is 7 and mean annual precipitation is approximately 1000 mm the radar is cable mounted fig 2j and not collocated with any other streamgauge sessom creek is a spring creek that drains to the san marcos river in texas water moves through a concrete box culvert the contributing area at stream radar s location is only 1 6 km2 fig 2k land uses involve mostly development open space and evergreen forest the soil texture has a relative proportion of sand silt and clay as 24 5 25 5 and 50 respectively the mean basin slope is 11 6 and mean annual precipitation near the radar location is about 861 mm the radar is mounted on a culvert as shown in fig 2l and there is no other streamgauge near the site location austin north is sited on a tributary of walnut creek which flows southeast into the colorado river in austin texas the basin area for the stream radar location is 4 3 km2 fig 2m the land uses of the area involve open space and moderate degrees of development the relative proportions of sand silt and clay are 22 9 26 2 and 51 0 respectively the mean basin slope is 5 and the mean annual precipitation is about 862 mm the stream radar is mounted on a box culvert which supports a train bridge fig 2n and it is not collocated with any other streamgauge the austin south unit is placed above west bouldin creek which flows northeast until it reaches the colorado river in austin texas the radar location has a basin area of 4 6 km2 fig 2o the area is a developed one that involves both open space and intense development soil texture has a relative proportion of sand silt and clay as 17 8 32 5 and 49 8 respectively the basin has a mean slope of 7 7 and mean annual precipitation is 856 mm near the radar location the radar is mounted on a train bridge fig 2p and there is no other streamgauge here 2 2 noncontact measurement principles the stream radar units evaluated in this study are manufactured by sommer messtechnik and alternatively known by their model name rq 30 the stage radar uses a pulsed 26 ghz microwave radar with a 10 beamwidth pointing in the nadir direction the radar can operate from 0 to 15 m above the stream or 0 35 m depending on the specific unit stream velocities are measured using a continuous wave 24 ghz doppler radar with a 12 beamwidth and can look either in the upstream or downstream direction of the channel at a fixed 56 angle off nadir the stage radar has a vertical resolution of 1 mm while the velocity radar has a resolution of 1 mm s 1 the velocity sensor can operate in scenarios where the distance to the water surface is 0 5 35 m both units are powered by a single 12 v 15 amp hr battery that is charged using a 30 w solar panel data are typically logged every 5 10 min and transmitted hourly using cellular data communications the hyquest solutions ip datalogger iris 350fx datalogger has an alerting feature that automatically increases the frequency of data logging and transmitting to 1 min when thresholds are and can send sms text messages 2 2 1 water level measurement for water level measurement the radar sensor transmits a short microwave pulsed signal to the stream and receives its echo as the pulse reflects off the water surface the time lag between sending and receiving the signal is directly proportional to the distance between the sensor and water surface and is determined as below 1 h ct 2 where h is the distance between the water surface to the sensor m c is the speed of light m s 1 and t is the measured time s of the two way travel distance of the pulse the distance e between the bottom of the sensor and a ground reference level corresponding to the mean of the channel bottom elevation gz is measured when the unit is installed fig 3 bridges culverts and cables experience thermal expansion and contraction throughout the day as they heat and cool in response to atmospheric diurnal temperature changes these thermal expansions contractions may cause the radar to move from its original position leading to a deviation from the actual stage measurements to evaluate this effect stage data are selected during periods with steady base flow and two such periods are chosen to confirm the consistency of the behavior throughout the whole timeseries for each station air temperature data are collected from the local climatological data lcd database of national oceanic and atmospheric administration noaa noaa 2019 which typically records temperature at airports table 2 it is assumed in this study that air temperature measured at the closest airport is representative of the temperature experienced at the stream radar location while more accurate measurements could be made at the site or obtained from a nearby personal weather station the distances from the stream radar to the nearest surface weather station varied from 6 8 km to as far as 73 5 km finally stage and air temperature data are evaluated for each steady base flow period 2 2 2 surface velocity measurement the surface velocity measurement is based on the principle of surface scattering and the doppler shift the radar sensor transmits a signal to the stream at fixed angle of 56 off nadir this signal is backscattered by the movement of the small surface waves that occur on the water surface and are assumed to be propagating in various directions but all riding on the large scale motion on the water various means have been demonstrated to retrieve water surface velocity from surface scattering and doppler shift plant et al 2005 fulton et al 2020 here we present the physical basis for retrieving the surface velocity while the sommer manufacturer applies their own spectral analysis to the signal and retrieval algorithm the lengths of these short waves are determined by the bragg resonance condition plant et al 2005 as 2 λ b λ 2 s i n θ where λ b is the wavelength of the resonant water wave i e the bragg wave m λ is the wavelength of the radar beam m and θ is incidence angle degree when we use the values associated to the k band radar i e λ 1 25 cm θ 56 we find a wavelength associated to the small surface wave scatterers on the water surface of 0 75 cm when the transmitted signal returns to the sensor there is a motion induced frequency shift due to the doppler effect by calculating the shift in frequency the surface velocity is computed as follows fulton and ostrowski 2008 3 v f d λ b where v is the surface velocity m s f d is the radar measured doppler shift in frequency hz or s 1 and λ b is the wavelength of the resonant water wave m the radar sensor measures surface velocities of the illuminated footprint via a 12 beamwidth this area increases with the distance between the water surface and the sensor from the velocity distribution of the illuminated area the doppler spectrum is created analyzed and used by the algorithm to report the velocity the sensor can detect movement both towards and away from the sensor and the shift in frequency depends on this direction for better detection the water body requires observable disturbances at the surface minimum disturbances can also be produced by wind or rain costa et al 2006 wind drift can bias surface velocity measurements depending on site characteristics such as in a narrow valley a stream with low hydraulic gradient and with surface velocities less than 0 15 m s fulton et al 2020 in the fulton et al 2020 study they use an anemometer collocated with a stream radar and then propose a wind drift correction scheme the correction scheme is based on the prandtl von karman wind velocity distribution the component of the wind vector component that is in the direction of the stream and the stream radar s orientation is then added or subtracted to arrive at the wind corrected surface velocity value high wind speeds can also potentially affect measurements from the cableway mounted systems by altering their verticality the computation of velocity in the rq 30 takes into account the inclination of the sensor as measured by an onboard inclinometer for fixed mounts this inclination measurement is performed once first measurement after a reboot or config file change for cableway mounted radars a new inclination measurement is applied with each velocity measurement this mostly accounts for gradual movement of the mounting points as cables and supporting structures expand contract and branches grow cables are installed with high tension to avoid high frequency swing but in the case of high winds causing inclination changes on the order of the measurement time this will be reflected as a low value in the quality parameter that is logged for every velocity measurement the quality parameter is based on the doppler spectrum and reflects the sharpness of the peak velocity and the signal to noise ratio negative quality values indicate poor quality velocity measurements and these data are rejected when comparing to collocated station data 2 3 discharge computation from the conservation of mass theory volumetric discharge is computed as below 4 q v a where q is the discharge m3 s v is the mean channel velocity m s and a is the wetted cross sectional area m2 the vertical velocity distribution in natural open channel flows is characterized by a velocity dip below the free surface and can be modeled by a modified log wake law guo and julien 2008 quick changes of velocity are mainly observed near the channel bottom and banks it is generally assumed that the depth mean velocity of a channel can be found at 0 6 times the depth below the water surface for relatively shallow channels or from the mean of the velocities found at 0 2 and 0 8 times the depth below the surface for deep channels for example if a channel has a total water depth of 10 m then the depth mean velocity can be estimated at a depth of 6 m below the surface or from the mean of the velocities at depths of 2 and 8 m below the surface mean channel velocity for a natural channel can be estimated from the surface velocity by multiplying it by a constant rantz 1982 therefore discharge from radar observations at any time step i is computed as below 5 q i k g v i a i where qi is the discharge m3 s kg is a global k coefficient that relates the surface velocity to mean channel velocity vi is the surface velocity m s and ai is the wetted cross sectional area m2 2 3 1 determination of k value a k coefficient of 0 85 to 0 90 is used to translate a surface velocity to a mean vertical velocity rantz 1982 this assumes the vertical velocity profile can be approximated using a logarithmic distribution or power law however if the vertical velocity distribution is non standard where the maximum velocity occurs at depth a different coefficient is required for each vertical in the channel cross section although multiple studies accept the validity of the default value for natural channels from recent experiments it is found that the actual value of k depends on the roughness of the bed material the place where the measurement is made and reynolds number costa et al 2000 melcher et al 2002 costa et al 2006 le coz et al 2012 welber et al 2016 also secondary currents presence of vegetation or tidal fluctuations can affect k johnson cowen 2017 considering different criteria numerous k values have been recommended such as 0 85 and 0 93 for base flow and high flow conditions respectively harpold et al 2006 0 79 to 0 93 depending on the roughness condition of the channel bed polatel 2006 0 75 to 0 83 for high flow situations in mountain channels jodeau et al 2008 0 79 to 1 72 in compound or irregular channels sun et al 2010 0 72 to 0 79 for channel bed consisting of gravel dramais et al 2011 0 86 to 1 18 due to secondary currents gunawan et al 2012 0 82 to 0 93 for varying reynolds number johnson cowen 2016 and so on a cross section averaged k coefficient or global k coefficient i e kg in equation 5 is needed to compute discharge if there is only a single surface velocity measurement available along a given stream cross section this is the case with the fixed deployment of the stream radars given the larger roughness values and shallower depths near the banks global k coefficients are expected to be lower than the local k coefficients reported above welber et al 2016 examined the differences between global and local k coefficients and found that the variability of the global values is considerably smaller than the local values moreover they found that the global k coefficients obtained in smoother channels fall into the range of the local k coefficients of 0 80 0 91 with a mean of 0 86 an alternative but related approach to relate surface velocities measured by the stream radar to mean channel velocities is based on the entropy or probability concept using the ϕ parameter chiu and chiou 1986 chiu 1987 chiu 1989 this concept is based on an assumed velocity distribution and is adaptable to cross sections where the maximum velocities are found either at the surface or below the surface fulton et al 2020 directly validated the ϕ parameters used to convert radar measured velocities to mean velocities using conventional in situ measurements they found values for the ϕ parameter ranging from 0 52 to 0 78 which yielded very close agreement to mean velocities from conventional mechanical current meters or hydroacoustics moreover ϕ does not vary with stage velocity discharge bed form or approach angle which makes ϕ valuable when dealing with temporal changes in physically based models fulton et al 2020 to optimize the k values for all three collocated stations the following multi objective function is developed the intention is to develop a function that considers the entire time series as well as event based statistics relevant for flooding the developed objective function is 6 ψ 1 3 n s e 1 3 1 ve 100 1 3 1 pe 100 where ψ is a dimensionless quantity that is expected to vary between 0 and 1 nse is the nash sutcliffe efficiency for whole time series ve is the mean volumetric error of an event and pe is the mean error in peak value of an event the multi objective function is designed to equally weight errors in event based peak flow volume and the nse describing the agreement for the entire time series nse is a metric used frequently in hydrology to describe how well two time series covary and is well suited objective function for this type of analysis servat and dezetter 1991 legates and mccabe 1999 use of nse is also recommended by asce 1993 and chosen to represent the overall accuracy level of the measurements in this study the event based metrics of mean volumetric error ve and peak flow error pe and are computed as below 7 ve 1 n i 1 n a b s v p i v o i v o i where vp i is the volume of the i th event integrated under the hydrograph of radar estimated discharge m3 vo i is the volume of the i th event integrated under the hydrograph of conventional discharge m3 n is the total number of events and abs operator indicates the absolute value of the variables within the bracket 8 pe 1 n i 1 n a b s p p i p o i p o i where pp i is the peak flow value of the i th event of radar estimated discharge m3 s and po i is the peak flow value of the i th event of conventional discharge m3 s for each collocated station this study computes the multi objective function using both single k and double k values for all the trials with k values a code is developed in python and the methods below are considered during computation we note that the guidance for default values generally apply to local k coefficients and we apply these findings to represent global k values with the understanding that there can be differences due to the influences of bed roughness radar illumination area and water depth the previous studies show local k values can vary roughly from 0 7 to 1 0 even greater than 1 0 based on the channel and flow conditions however for single k optimization this study varies the k value from 0 7 to 1 0 with a trial increment of 0 001 the double k optimization is based on the work of hauet et al 2018 with this method a threshold of water depth limit is set first and then two different k values are assigned for the depths above and below the threshold for cherry creek and mill creek this threshold is varied from 1 8 to 2 1 m as they are natural channels under each threshold of depth the lower k value for depths lower than the threshold is varied from 0 75 to 0 85 while higher the higher k value for depths higher than the threshold is varied from 0 9 to 1 0 the increments for depth threshold and k value are 0 003 m and 0 001 respectively because walnut gulch uses a concrete supercritical flume this k value is varied from 0 85 to 1 0 with an increment of 0 001 following the work of hauet et al 2018 2 3 2 calculation of wetted cross sectional area discharge estimates using the stage velocity radar data assume that there is a stable cross section changes to the bathymetry can have a negative effect on the discharge estimates therefore at first surveys are conducted to find a stable channel bottom for each site and then the cross sections are established at the selected location of the channel a cross section of any channel is measured using a conventional total station surveying method the vertical elevations along the line where the radar makes stage measurements are recorded by a total station survey relative to the reference level e g point of zero flow corresponding to the channel bottom or lower to allow for scour however in the case of mill creek the elevation of the floodplain at its left bank is complemented from a 1 m resolution digital elevation model dem usgs 2020 and then merged with the surveyed datapoints to complete the cross section cross section data e g station and elevation with respect to north american vertical datum of 1988 of a channel are further loaded into an online calculator nws 2020 that gives the corresponding wetted area for any water depth for each site wetted areas corresponding to a range of water depths are determined where the range varies from the minimum recorded stage value for that station to the maximum one with an increment of 0 03 0 06 m finally an equation is developed from the best fit of these data points and for any i th stage value ai is derived from the equation for cherry creek a stage area rating curve is provided by the usgs it is noted that stage area and stage discharge ratings would be affected by changes to the channel bathymetry caused by sediment deposition or scour vegetation growth etc the site selection for the stream radars considered the stability of the channel bottom in cases where the channel bathymetry may be evolving a stage velocity rating curve using the stream radar variables would need to be developed and monitored a sudden shift in the stage velocity relation could be indicative of change in the channel s cross section which would bias the calculation of the discharge alternatively the channel bathymetry can be regularly surveyed or even retrieved using remote sensing approaches such as a bank to bank scanning light detection and ranging lidar as proposed in gourley 2017 with this measurement the wetted cross sectional area and thus discharge will be more accurate than inferred under the assumption of a static cross section 3 results and discussions 3 1 uncertainty in stage measurements fig 4 shows the time series of radar measured stage and temperature for two of the bridge mounted radars cherry creek walnut gulch a cable mounted radar mill creek and a radar mounted on a concrete box culvert austin north the bridge and cable mounted radars generally exhibit positive correlations with air temperature fig 4a c while the culvert at austin south has a weaker negative correlation fig 4d it is believed that with an increase in temperature expansion of the bridge materials causes the bridge deck and cables to slightly sag which results in the radar deflecting downward from its original position yielding an apparent higher stage this would cause the distance between the radar and the water surface h in fig 3 to decrease resulting in an overestimation of stage the opposite would occur when the air temperature cools and the bridge materials contract in the case of falls creek it was discovered that a collocated water treatment plant regularly pumps water from the creek that potentially affects the steady state of base flow conditions and the positive correlation with temperature was not observed the radar at austin south is mounted on a wooden train bridge that produces vibration due to frequent trains crossing of the bridge as a result the stage records become noisy for this station at irregular intervals and correlation of stage with temperature cannot be readily observed to further quantify the correlation between stage and temperature the correlation coefficient r between these two variables is computed table 3 for cherry creek mill creek walnut gulch and paria river r varies between 0 526 and 0 804 which indicates a moderate positive correlation between stage and air temperature although falls creek has a cable mounted radar the r values during the two base flow periods are 0 155 and 0 139 indicating no correlation as previously mentioned this is due to the effect on base flow conditions caused by the pumping from the water treatment plant as for the two box culverts at sessom creek and austin north they both show weaker negative correlations the stage records at austin south have little correlation with air temperature r 0 023 and 0 330 during stable base flow conditions due to the added vibration of the bridge the analysis conducted herein was to assess potential effects of the mounting structures on the stage data measured by the radars given that walnut gulch is a normally dry wash we analyze the stage and temperature data during time periods for which there was zero observed flow this analysis provides an indication of the temperature dependence of the stage data in the absence of any water in the stream the diurnal temperature range results in an apparent stage change of approximately 2 cm owing to the thermal expansion of concrete of the supporting bridge over the concrete flume stage data from the collocated usgs stations at cherry creek and mill creek are provided for base flow periods the stages at these sites could potentially be affected by temperature dependent changes in the supporting structures and water in the underlying streams the usgs stations at mill creek and cherry creek use conventional gas purge bubbler systems note that their time series are independent from the radar measurements or structures used for mounting them curiously the two conventional gauges also show a diurnal temperature dependence of the stage the usgs data indicate a daily variation in the observed stage as high as 3 cm at cherry creek fig 4a and approximately 1 cm at mill creek fig 4c the stream radar diurnal variations in stage are the same as the usgs observations at cherry creek and approximately 2 cm at mill creek or 1 cm greater than the usgs observations it is plausible that these observed stage changes are due to urban and rural outdoor water uses respectively during the summer months the coefficients of volume expansion for steel and concrete are similar to one another at 35 10 6 c 1 on the other hand the coefficient of volume expansion for water is 210 10 6 c 1 or approximately six times greater than the expansion potential of the supporting materials it is difficult to quantify the uncertainty in the stream radar stage measurements when there is water in the channel nevertheless from the comparisons provided in this analysis including those from a dry concrete flume at walnut gulch we can estimate the diurnal variation caused by the thermal expansion of the supporting structures to be within 2 cm 3 2 uncertainty with k value 3 2 1 discharge comparison with default global k value 0 85 prior to estimating discharge radar retrieved velocities can be compared to in situ measurements using conventional current meters or hydroacoustics at multiple depths along the stream cross section the reader is referred to the fulton et al 2020 study that conducted velocity validations using the same type of stream radars as used in this study in our case kg values are initially applied using a default value and later optimized using the conventional discharge measurements as a constraint for the three stream radars that are collocated with conventional streamgauges discharge is estimated by reducing the measured surface velocity using a default kg factor of 0 85 we note that this value has been suggested as a default for local k values and not necessarily a global k value nevertheless it provides a starting point for estimating discharge this value is then multiplied by the wetted cross sectional area which is computed from the stage measurements combined with the stream s cross section as described in section 2 3 table 4 provides the statistical results when comparing to discharge from the conventional streamgauges for the entire time series listed in table 1 table 4 shows that the radar observations of all the collocated stations are quite accurate in providing the discharge estimates when compared to their respective streamgauge data the sample sizes vary owing to different hydroclimatologies sensor reporting frequencies and length of period over which the sensor was operational the usgs data at mill creek oklahoma were considered provisional for a three month period in the spring of 2018 but were later approved following this study s analysis period further many low flow cases were not considered in the analysis due to poor quality velocity measurements from the stream radar the sample size at walnut gulch is even smaller due to the episodic nature of flows in the dry wash during the monsoon in all cases the radar sensors yield nse and r values close to 1 0 and the nb values are generally small with a slight high bias at the cherry creek site the data are also presented in the form of scatterplots in fig 5 these results are representative of the sensors capability of estimating discharge without any parameter tuning on streams with a measured or known stable cross section one objective of the anchor project is to assess the sensors capabilities of detecting rapid onset flooding in vulnerable areas to provide early alerting to local authorities fig 6 compares times series of discharge from the stream radars to the conventional gauges for several high flow events while the statistical comparisons for the entire time series indicate very close agreement with the conventional gauges we can identify the following discrepancies in the event based comparisons 1 underestimation in peak flow values 2 underestimation in the total water volume integrated throughout the high flow event and 3 high frequency fluctuations in the stream radar discharge values regarding the event based underestimation of both peak flows and volume one potential reason could be an improper setting of the ground reference level gz which is meant to be the mean of the channel bottom elevation as illustrated in fig 3 this setting would result in bias that would affect the entire time series at both high and low flows the event based hydrographs in fig 6 indicate however that the discharge estimates generally agree at the beginning and end of the events yet the peak flows are still underestimated by the stream radar this stage dependent bias is evaluated in more detail in the next section conventional gauges represent the event dynamics from stage measurements that are then converted to discharge using a rating curve in the case of the stream radars the time varying velocity and stage data are both used to compute discharge the fluctuations in the stream radar hydrographs are found to be caused by the velocity measurements and not the stage the noise in the surface velocity retrievals can be caused by small waves initiated by wind and or rain secondary currents and potentially some slight swinging of the instrument for the cable mounted radars nevertheless these fluctuations are deemed random errors and are assumed to not cause bias these random errors can be mitigated by using a smoothing window on the velocity or discharge data 3 2 2 sensitivity analysis for global k value the prior analyses indicate that while the stream radars yield discharge values with default kg values that agree quite well with conventional gauges e g nse close to 1 there are non negligible peak flow and volumetric errors during flood events more specifically the radar driven discharge estimates are accurate during low flows but underestimate during high flow events prior studies i e harpold et al 2006 hauet et al 2018 have recommended the use of two k values to represent base flow and high flow conditions lower k values are recommended for base flows when the roughness of the stream bed has more effect on the surface velocities at high flows the roughness from the bed materials is less influential on the surface water velocities so in the following we explore the optimization of two k values for each site applied in a global sense the approach adopted herein is to simultaneously quantify the event based hydrograph errors and also consider the accuracy of the discharge estimates for the entire time series table 5 shows the global k values that maximize the multi objective function for each collocated station for all the stations the results are improved due to double kg value optimization for single kg optimization kg varies between 0 78 and 0 91 while for double kg it varies between 0 75 and 0 96 in general the highest ψ values are obtained for double kg optimization although the relative differences between the results for two different kg values are very small fig 7 shows scatter plots of the radar estimated and measured discharge from the collocated stations similar to fig 5 the radar estimated discharges in fig 5 are using the global k values of 0 85 while fig 7 shows the values for the optimized single and double kg values the values yielded from the double kg scheme are closer to the diagonal for all three stations this applies to both high and low flows for cherry creek the optimized single kg value 0 78 is found to be less than the default one and it reduced the ve and pe error by almost 4 with an increase in the nse score for double kg optimization the threshold depth limit differs by only 0 12 m from the recommended value 2 m by hauet et al 2018 for the kg values the higher one 0 89 is very close to their recommended value of 0 9 whereas the lower one 0 75 slightly deviates from the recommended value of 0 8 the ve error is almost halved and pe is also reduced by 4 because the total number of events is 26 for cherry creek this is a substantial improvement in hydrograph errors and therefore these kg values can represent the whole timeseries well as for mill creek the single kg value 0 83 is slightly lower than the default 0 85 and the nse ve and pe scores do not change that much from the results found with the default however the double kg value provides higher nse score as well as lower ve and pe scores the threshold of depth limit 1 9 m is only slightly lower than the recommended 2 0 m threshold the lower kg value is very close to 0 8 while the higher kg value is 0 96 for walnut gulch the optimized single kg value 0 91 is similar to the recommended value 0 9 by hauet et al 2018 however the event based errors do not change that much from the default kg derived errors for double kg optimization the kg value is quite similar 0 85 to the default one when the depth is less than 0 9 m and for greater depths the optimized kg value is found to be 1 0 with the use of these two kg values ve becomes less than 1 pe is almost halved and nse approaches 1 0 0 979 with the increase of water level channel bed roughness in a concrete flume is expected to have less effect on mean channel velocity and therefore a kg value close to 1 0 for depths above 0 9 m is physically realistic the prospects for using the sensors to quantify discharge on previously ungauged basins is promising our results indicate that the use of a single default kg value of 0 85 will yield nse values greater than 0 9 indicating very low error covariance there is some modest benefit with the optimization approach in reducing the event based peak flow and total volume errors which requires in situ measurements not unlike the need to establish a rating curve in conventional gauging however the next section explores the use of the stage and velocity measurements with no in situ measurements required a priori 3 3 early detection of flooding events one objective of the stream radar units is to assess the capability of detecting rapid onset flooding events in ungauged basins where there are vulnerable assets downstream one such setting is the falls creek stream radar placed upstream from a camp near davis oklahoma gourley 2017 the camp hosts as many as 7500 children teenagers and staff at a given time during the summer months on 18 june 2015 the region was struck by heavy rainfall up to 800 mm from a re intensifying tropical storm bill in the camp a bus was submerged and some campers were isolated for more than a day in coordination with the camp director the unit was installed on the stream upstream from the camp in march 2017 with the intention to provide early alerting the datalogger nominally logs data every 10 min and transmits them every hour the datalogger was initially programmed with subjective alert thresholds for stage exceeding 1 22 m or velocity exceeding 1 22 m s 1 when the stage or velocity exceeds the alert threshold data are logged and transmitted every 5 min note that this frequency can be increased to data logging and transmission every 1 min when in alarm status on 19 20 may 2017 severe weather affected the region resulting in a tornado warning issued by the local national weather service forecast office and heavy rainfall rates over the basin the time series plot of radar measured surface velocity and stage in fig 8 indicates the velocity exceeded the alert threshold at 0300 utc and the stage exceeded its threshold at 0315 utc the rate of the river stage increase was 2 57 m hr 1 interestingly the velocity first exceeded the alert threshold and preceded the associated rise in stage by approximately 30 min this offset in the rising limbs of the velocity and stage hydrographs is attributed to a celerity effect caused by inertial accelerations and or a pressure gradient from a non negligible slope in the water surface in fact the stage discharge hysteresis is discussed in detail in muste et al 2020 unsteady flow conditions arise when the stage varies rapidly during events that cause substantial slopes in the water surface relative to the channel bed slope situations of extreme rainfall falling on relatively flat terrain can yield the hysteretic behavior from analytical considerations muste et al 2020 also show that a direct manifestation of unsteady flows is phase sequencing between the time series of velocity discharge and stage in that order this phase sequencing has rarely been reported in field measurements rowinski et al 2000 given the early arrival of the velocity wave the stream radar combined with the alerting features of the data logger enabled more timely identification of an impending rapid onset flooding event downstream following the event the project team visited the radar to survey high water marks and assess the condition of the stream radar fig 2j the stream had risen to the height of the bottom of the unit itself upon inspection it was discovered that despite the damage that was incurred to the radars housing the waterproofing of the individual radars in the unit succeeded so that they continued to operate throughout and after the event nevertheless debris flowing down the stream impinged upon the supporting cables causing great tension on the housing and resulted in the damage shown in fig 9 the mounting was subsequently fortified to prevent stress on the housing in the future and the unit was raised from its original position furthermore the datalogger was programmed to alert on the following thresholds 0 91 m 0 91 m s 1 1 52 m 1 52 m s 1 2 13 m 2 13 m s 1 if any of these thresholds are exceeded then the data logging and transmitting frequency is increased to 5 min and sms alerts are sent to local stakeholders this event demonstrated that a stream radar unit could be used as an indicator of flash flooding at an ungauged vulnerable location without the need for cross section surveys in situ measurements for developing the rating curve or even establishment of bankfull flooding thresholds moreover the real time capabilities of data delivery and sms alerting enabled the measurements of surface velocity and stage to be useful without the need for estimating discharge in fact it could be argued that these variables lend themselves to be more understandable and thus useful to stakeholders 4 discussion and conclusions to evaluate the effectiveness of remote sensing technologies in noncontact measurement of stream variables water level and surface velocity eight stream radars have been installed at high priority locations across the united states the radars are mounted on bridges culverts and cables and have provided measurements for at least 1 year with a temporal resolution of 5 10 min the eight streams represent a variety of hydrologic hydraulic and hydroclimatological characteristics and three of them are collocated with conventional streamgauges this study is part of the automated noncontact hydrologic observations in rivers anchor project and aims to identify and characterize errors in the raw measurements to optimize correction factors so the data can be used to estimate discharge and to assess whether the real time transmission of alerts based on stage and surface velocity measurements can be useful in an early alerting context potential biases were assessed on stage measurement due to diurnal temperature changes causing expansion and contraction of the supporting bridges cables and culverts for bridge and cable mounted systems these stage measurements would be biased in direct correlation with temperature in the cases of bridges and cables the sensor could sag closer to the water surface giving the impression of an increase in stage the opposite could occur with the culvert mounted units we compared stage data from the stream radars to observations from collocated conventional bubbler streamgauges at cherry creek colorado and mill creek oklahoma these independent usgs streamgauges also showed a diurnal fluctuation in stage which is attributable to outdoor water uses during the summer months the stream radar had the same fluctuations as the usgs observations at cherry creek and had about 1 cm more variation than the usgs stage measurements at mill creek it is difficult to quantify the uncertainty in stream radar stage measurements caused by thermal expansion of the supporting structures when water is present in the channel the coefficient of volume expansion with water is approximately six times larger than with either steel or concrete and as we saw in our analyses outdoor water uses can result in actual diurnal fluctuations in stage without a detailed analysis of the thermal properties of the culverts bridges and cableways it is difficult to definitively quantify the effect of thermal expansion on stage at all sites however stage variations were assessed at walnut gulch arizona when the concrete flume was completely dry the maximum temperature induced stage change was found to be 2 cm at this site and the other collocated sites showed that the stage variations were not greater than this amount lastly when estimating discharge surface velocity retrievals during low flow periods must consider ambient wind velocities as they can become biased discharge comparisons at the collocated stations show that the use of a kg value of 0 85 to convert surface velocities to represent a mean channel velocity yield nse values greater than 0 9 during substantial flooding events peak flow values are underestimated the concept of using double kg values which is normally applied to convert surface velocities to depth averaged velocities for different stages and hydraulic conditions by hauet et al 2018 is a valid approach to get accurate results across the spectrum of flows including low flows and floods with the optimized kg values the statistical metrics indicate that the radar based discharge estimates can be as accurate as in situ conventional streamgauges and have acceptable event based hydrograph errors less than 10 volumetric and peak value error during floods nevertheless the kg value optimization requires a collocated conventional streamgauge which comes with the costs of regular visits to establish the stage discharge rating curve our results at three sites reveal that the use of a single default k value of 0 85 to be considered as a global k value yield nse values greater than 0 9 indicating the degree of accuracy that can be obtained without the requirement of in situ measurements of velocity profiles the use of the single default k value nominally reported to convert surface velocities to depth averaged values applied here to represent the mean channel velocity may be a bit fortuitous for the three collocated sites one would expect lower global k values to represent mean channel velocity compared to the local k values reported in the literature in the case of walnut gulch arizona the concrete flume represents a very smooth channel so that the local k value can approximate the mean across the cross section which agrees with results reported in welber et al 2016 in the case of cherry creek colorado the unit was situated on a bridge approximately 6 m above the water surface given the 12 beamwidth of the doppler radar and 56 off nadir pointing angle the radar illuminates more than 50 of the stream s width this means that the inferred global k includes a representative distribution of surface velocities across the stream and thus can approximate the local k values reported in the literature in the case of mill creek oklahoma the radar was situated at a location in the channel during base flow conditions where the largest surface velocities were expected see fig 2d however the channel is not as straight as desired at this location and it is plausible that the radar measures surface velocities that are not the maxima along the cross section this results in the retrieved velocity to approximate a mean surface velocity rather than the maximum considerations of the radar siting that include the area illuminated in the stream affect the quality of the discharge estimates in this study five out of the eight anchor stream radars are situated over ungauged streams these serve different purposes including low flow monitoring of a spring fed creek for sustaining endangered species on sessom creek texas monitoring high flows that affect bridges carrying trains austin south and austin north texas and detecting flash floods above vulnerable camping areas falls creek oklahoma in the latter case it was demonstrated that the sensors are capable of detecting surface velocities and river stages that pose hazards to life and property there was a notable phase sequencing between the surface velocity and stage indicative of unsteady flows caused by a large slope in the water surface relative to the mild channel bed slope it turns out this observation would be valuable in an early alerting context alert thresholds based on stage and velocity values can be subjectively determined for a given site input to the datalogger and then used to increase the data logging and transmitting frequency and to alert local authorities and stakeholders by sending them sms text messages further the early alerting capabilities do not necessarily require detailed cross section surveys or optimized k values to estimate discharges the measurements of stage and surface velocity are sufficient based on experience gained throughout the anchor project we provide some insights that can maximize data quality and quantity siting an instrument is key to its success the channel would need to have uniform relatively straight flow at the chosen site and a stable cross section further a site would need to have adequate cellular network coverage for transmitting the data there are instances in which radio transmitters are being used to send the signal up to a ridge location where there is better cellular data coverage the batteries are charged with a solar panel so having good visibility toward the equator improves the power budgeting optimal siting of the units also needs to consider the degree of public access to reduce the instances of vandalism in closing this study provides experiences gained at diverse locations and will hopefully motivate future studies and efforts to promote additional sensing of earth s freshwater resources credit authorship contribution statement mushfiqur rahman khan formal analysis writing original draft jonathan j gourley conceptualization supervision writing review editing jorge a duarte data curation software humberto vergara project administration daniel wasielewski funding acquisition investigation resources pierre alain ayral investigation resources john w fulton conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding was provided by noaa office of oceanic and atmospheric research under noaa university of oklahoma cooperative agreement na16oar4320115 and na16oar4590234 u s department of commerce any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government the authors declare no conflicts of interest and the funders had no role in the design of the study in the collection analyses or interpretation of data in the writing of the manuscript or in the decision to publish the results the manuscript was greatly improved following the constructive comments from three independent reviewers and internal reviews supplied by the usgs data availability the air temperature data used in this study were obtained from the noaa national center for environmental information at the following location https www ncdc noaa gov data access land based station data land based datasets quality controlled local climatological data qclcd all usgs data used for validation can be obtained online https doi org 10 5066 f7p55kjn the time series data for all eight stations analyzed in this study and their specific locations have been placed in the public domain doi 10 5281 zenodo 4526127 
4109,accounting for freshwater resources and monitoring floods are vital functions for societies throughout the world remote sensing methods offer great prospects to expand stream monitoring in developing countries and to smaller headwater streams that are largely ungauged worldwide this study evaluates the potential to estimate discharge using eight radar units that have been installed over streams in diverse hydrologic and hydraulic settings across the united states the research highlights error characteristics associated with the measurements of stage using pulsed wave radars mean channel velocity from continuous wave doppler radars and their combined use to estimate discharge at sites that were collocated with conventional streamgauges potential stage biases caused by the thermal expansion and contraction of supporting structures due to diurnal temperature changes were examined a dry concrete flume showed the temperature dependent stage variations were no more than 2 cm surface velocity retrievals needed to be adjusted to represent the mean channel velocity when estimating discharge different approaches were evaluated and application of two different depth dependent adjustment factors was found to yield the most accurate estimates this study found that it is possible to get accurate discharge estimates from noncontact radar measurements providing cost effective solutions for remote sensing of ungauged streams lastly radar measurements of the raw variables i e stage and surface velocity can be used in an early alerting context to detect flash floods in ungauged streams keywords flash floods noncontact streamgauging remote sensing uncertainty estimation 1 introduction stream discharge estimates are of paramount importance for stormwater management flood forecasting estimating sediment load for water quality water resources management navigation recreation and endangered species protection and management conventional streamgauges such as those operated and maintained by the u s geological survey usgs provide measurements of water depth eberts et al 2018 to compute the discharge an empirical relation is established between the stage which is the measured water depth plus bed elevation and discharge to compute a stage discharge rating these rating curves require manual in situ measurements of the variables to compute discharge i e distribution of flow velocity stream cross section stage over a wide range of river flow conditions buchanan and somers 1969 technicians collect these data approximately every six weeks using a combination of current meters and hydroacoustic devices instream and near bank vegetation changes and sediment deposition and scour which can become enhanced during floods can change the shape of a previously surveyed cross section and the associated rating curve mason and weiger 1995 changes in the hydraulics and channel cross section require regular visits and instream measurements remote sensing has increasingly become a more desired alternative to manual surveying and conventional in situ measurement techniques because remote sensing instruments do not need to be in contact with the water moramarco et al 2019 remote sensing instruments provide increased safety to the technicians and are less likely to be lost during major floods than fixed traditional streamgauging equipment in addition to providing the potential for less expensive operations and maintenance fulton et al 2020 remote sensing technologies used to estimate discharge in streams include cameras and radars image analysis using cameras such as the large scale particle image velocimetry lspiv technique have demonstrated the capability of estimating surface velocities in streams fujita et al 1998 creutin et al 2003 muste et al 2008 stringent procedures are followed to ensure usable image quality in long wide natural channels and operational applications are challenged by bandwidth requirements for transmitting video kim et al 2007 tauro et al 2017 detert 2021 provides a set of guidelines to help users improve their procedures for performing image based surface velocity measurements after its first introduction in 2000 various noncontact radar techniques have been utilized for stage and surface velocity measurements costa et al 2000 instruments include a helicopter mounted radar an x band pulsed radar coherent microwave systems continuous wave microwave monostatic uhf doppler and pulsed doppler microwave radar lee et al 2002 melcher et al 2002 plant et al 2005 costa et al 2006 these studies were primarily experimental and demonstrate the basic measurements of stage and surface velocity in rivers until now very few research studies have assessed the uncertainty of noncontact measurements with radars welber et al 2016 fulton et al 2020 our study is a component of the larger automated noncontact hydrologic observations in rivers project anchor https www nssl noaa gov projects anchor that was originally motivated by the noncontact radar based discharge estimates presented in costa et al 2006 in the present study we use a stream radar unit that integrates two noncontact radar methods to retrieve both the stage and surface water velocity of a stream simultaneously eight stream radars have been installed on bridges culverts and cables throughout the united states and provided year round measurements with a typical temporal resolution of 5 10 min the objectives of this study are as follows 1 to identify and quantify the error in stage measurements by the nadir pointing pulsed wave radar 2 to optimize the correction for translating surface water velocities from the doppler radar to a mean channel velocity needed to compute discharge from noncontact measurements and 3 to assess the sensors capabilities to detect the rapid onset of flooding events in ungauged basins section 2 describes the physical settings of the radar deployments and the methods used for deriving discharge section 3 identifies sources of measurement uncertainty and quantifies them section 3 also reveals the characteristics of a major flash flooding event conclusions from the study and a discussion are summarized in section 4 2 methods and materials 2 1 study area to represent a variety of meteorological hydrologic and hydraulic characteristics eight stream radars have been installed on cables culverts and bridges across streams at locations in four states in the united states as shown in fig 1 three are installed in texas two each in arizona and oklahoma and one in colorado site selection was based on several factors including proximity to a conventional streamgauge a need for monitoring cellular network signal strength site security and access and hydraulic suitability of the site for monitoring these constraints permitted testing of the radars for a variety of hydrologic and hydraulic settings the radars were installed on a bridge in an urban setting fig 2 a b above a small natural channel in a rural setting fig 2c d on an instrumented flume in the desert fig 2e f on a bridge above a river with frequent morphological changes fig 2g h above a small creek upstream from a popular summer camp fig 2i j on a box culvert over a spring fed creek fig 2k l above an engineered urban channel fig 2m n and above a stream on a railway bridge fig 2o p in general it took two to three people a few hours to install the sensors the basin areas for these streams range from 2 to 3676 km2 and are characterized by different land use settings including forested urban and desert table 1 the 5 or 10 minute logging rate is user defined cherry creek is a tributary of the south platte river that runs near denver colorado fig 2a the area of the basin is 1059 km2 according to the national land cover database 2011 nlcd 2011 homer et al 2015 land use in the upper part of the basin is mostly vegetation e g herbaceous and shrub scrub whereas the lower part is a developed area where the site is located the relative proportions of sand silt and clay are 53 9 29 7 and 16 4 respectively as per conus soil datasets miller and white 1998 the area has a mean basin slope of 7 9 the mean annual precipitation from 1981 to 2010 at the radar location is 404 mm prism 2004 the stream radar is mounted on a bridge here fig 2b and situated approximately 60 m upstream from a usgs streamgauge id 06713500 mill creek runs through rural johnston county oklahoma the basin area is 124 km2 fig 2c the nlcd 2011 land use of the area is mostly herbaceous and hay pasture lands the soil texture has a relative proportion of sand silt and clay as 27 42 3 and 30 7 respectively the area has a mean basin slope of 3 2 and the mean annual precipitation near the radar location is 1027 mm per year the radar is cable mounted fig 5 and has a usgs streamgauge approximately 30 m upstream from its position id 07331200 the stream radar at walnut gulch is part of the dense instrumentation comprising the u s department of agriculture usda agricultural research service s walnut gulch experimental watershed in southeast arizona water moves through a concrete flume here and the size of the contributing area is 7 8 km2 fig 2e the primary land use type of the basin is desert vegetation e g shrub and herbaceous the relative proportions of sand silt and clay are 58 29 6 and 12 4 respectively the basin has a moderately sloping mean gradient of about 12 1 the mean annual precipitation amount is 356 mm the radar is mounted on a bridge fig 2f and collocated with a conventional usda streamgauge discharge data are provided only during events and can be just a few episodes per year during the monsoon paria river is a tributary of the colorado river that runs from southern utah towards northern arizona it has a very large basin area of approximately 3676 km2 for the radar location fig 2g the upper part of the basin has some vegetation land usages but the rest of the area is mostly barren desert land for soil texture the relative proportions of sand silt and clay are 56 23 3 and 14 7 respectively the basin has a high mean slope of 20 9 the area near the radar has a very low mean annual precipitation of 185 mm the radar is mounted on a bridge fig 2h and has a usgs streamgauge id 09382000 about 1 2 km upstream from its position because of this distance between the usgs streamgauge and the stream radar it is not considered to be collocated to conduct direct discharge comparisons falls creek originates from the springs of the arbuckle simpson aquifer and flows towards the northeast into the washita river in oklahoma the size of the basin area for the stream radar location is 15 1 km2 fig 2i the land uses mostly include grassland and different types of forest e g evergreen and deciduous the relative proportions of sand silt and clay are 23 63 and 14 respectively the mean basin slope is 7 and mean annual precipitation is approximately 1000 mm the radar is cable mounted fig 2j and not collocated with any other streamgauge sessom creek is a spring creek that drains to the san marcos river in texas water moves through a concrete box culvert the contributing area at stream radar s location is only 1 6 km2 fig 2k land uses involve mostly development open space and evergreen forest the soil texture has a relative proportion of sand silt and clay as 24 5 25 5 and 50 respectively the mean basin slope is 11 6 and mean annual precipitation near the radar location is about 861 mm the radar is mounted on a culvert as shown in fig 2l and there is no other streamgauge near the site location austin north is sited on a tributary of walnut creek which flows southeast into the colorado river in austin texas the basin area for the stream radar location is 4 3 km2 fig 2m the land uses of the area involve open space and moderate degrees of development the relative proportions of sand silt and clay are 22 9 26 2 and 51 0 respectively the mean basin slope is 5 and the mean annual precipitation is about 862 mm the stream radar is mounted on a box culvert which supports a train bridge fig 2n and it is not collocated with any other streamgauge the austin south unit is placed above west bouldin creek which flows northeast until it reaches the colorado river in austin texas the radar location has a basin area of 4 6 km2 fig 2o the area is a developed one that involves both open space and intense development soil texture has a relative proportion of sand silt and clay as 17 8 32 5 and 49 8 respectively the basin has a mean slope of 7 7 and mean annual precipitation is 856 mm near the radar location the radar is mounted on a train bridge fig 2p and there is no other streamgauge here 2 2 noncontact measurement principles the stream radar units evaluated in this study are manufactured by sommer messtechnik and alternatively known by their model name rq 30 the stage radar uses a pulsed 26 ghz microwave radar with a 10 beamwidth pointing in the nadir direction the radar can operate from 0 to 15 m above the stream or 0 35 m depending on the specific unit stream velocities are measured using a continuous wave 24 ghz doppler radar with a 12 beamwidth and can look either in the upstream or downstream direction of the channel at a fixed 56 angle off nadir the stage radar has a vertical resolution of 1 mm while the velocity radar has a resolution of 1 mm s 1 the velocity sensor can operate in scenarios where the distance to the water surface is 0 5 35 m both units are powered by a single 12 v 15 amp hr battery that is charged using a 30 w solar panel data are typically logged every 5 10 min and transmitted hourly using cellular data communications the hyquest solutions ip datalogger iris 350fx datalogger has an alerting feature that automatically increases the frequency of data logging and transmitting to 1 min when thresholds are and can send sms text messages 2 2 1 water level measurement for water level measurement the radar sensor transmits a short microwave pulsed signal to the stream and receives its echo as the pulse reflects off the water surface the time lag between sending and receiving the signal is directly proportional to the distance between the sensor and water surface and is determined as below 1 h ct 2 where h is the distance between the water surface to the sensor m c is the speed of light m s 1 and t is the measured time s of the two way travel distance of the pulse the distance e between the bottom of the sensor and a ground reference level corresponding to the mean of the channel bottom elevation gz is measured when the unit is installed fig 3 bridges culverts and cables experience thermal expansion and contraction throughout the day as they heat and cool in response to atmospheric diurnal temperature changes these thermal expansions contractions may cause the radar to move from its original position leading to a deviation from the actual stage measurements to evaluate this effect stage data are selected during periods with steady base flow and two such periods are chosen to confirm the consistency of the behavior throughout the whole timeseries for each station air temperature data are collected from the local climatological data lcd database of national oceanic and atmospheric administration noaa noaa 2019 which typically records temperature at airports table 2 it is assumed in this study that air temperature measured at the closest airport is representative of the temperature experienced at the stream radar location while more accurate measurements could be made at the site or obtained from a nearby personal weather station the distances from the stream radar to the nearest surface weather station varied from 6 8 km to as far as 73 5 km finally stage and air temperature data are evaluated for each steady base flow period 2 2 2 surface velocity measurement the surface velocity measurement is based on the principle of surface scattering and the doppler shift the radar sensor transmits a signal to the stream at fixed angle of 56 off nadir this signal is backscattered by the movement of the small surface waves that occur on the water surface and are assumed to be propagating in various directions but all riding on the large scale motion on the water various means have been demonstrated to retrieve water surface velocity from surface scattering and doppler shift plant et al 2005 fulton et al 2020 here we present the physical basis for retrieving the surface velocity while the sommer manufacturer applies their own spectral analysis to the signal and retrieval algorithm the lengths of these short waves are determined by the bragg resonance condition plant et al 2005 as 2 λ b λ 2 s i n θ where λ b is the wavelength of the resonant water wave i e the bragg wave m λ is the wavelength of the radar beam m and θ is incidence angle degree when we use the values associated to the k band radar i e λ 1 25 cm θ 56 we find a wavelength associated to the small surface wave scatterers on the water surface of 0 75 cm when the transmitted signal returns to the sensor there is a motion induced frequency shift due to the doppler effect by calculating the shift in frequency the surface velocity is computed as follows fulton and ostrowski 2008 3 v f d λ b where v is the surface velocity m s f d is the radar measured doppler shift in frequency hz or s 1 and λ b is the wavelength of the resonant water wave m the radar sensor measures surface velocities of the illuminated footprint via a 12 beamwidth this area increases with the distance between the water surface and the sensor from the velocity distribution of the illuminated area the doppler spectrum is created analyzed and used by the algorithm to report the velocity the sensor can detect movement both towards and away from the sensor and the shift in frequency depends on this direction for better detection the water body requires observable disturbances at the surface minimum disturbances can also be produced by wind or rain costa et al 2006 wind drift can bias surface velocity measurements depending on site characteristics such as in a narrow valley a stream with low hydraulic gradient and with surface velocities less than 0 15 m s fulton et al 2020 in the fulton et al 2020 study they use an anemometer collocated with a stream radar and then propose a wind drift correction scheme the correction scheme is based on the prandtl von karman wind velocity distribution the component of the wind vector component that is in the direction of the stream and the stream radar s orientation is then added or subtracted to arrive at the wind corrected surface velocity value high wind speeds can also potentially affect measurements from the cableway mounted systems by altering their verticality the computation of velocity in the rq 30 takes into account the inclination of the sensor as measured by an onboard inclinometer for fixed mounts this inclination measurement is performed once first measurement after a reboot or config file change for cableway mounted radars a new inclination measurement is applied with each velocity measurement this mostly accounts for gradual movement of the mounting points as cables and supporting structures expand contract and branches grow cables are installed with high tension to avoid high frequency swing but in the case of high winds causing inclination changes on the order of the measurement time this will be reflected as a low value in the quality parameter that is logged for every velocity measurement the quality parameter is based on the doppler spectrum and reflects the sharpness of the peak velocity and the signal to noise ratio negative quality values indicate poor quality velocity measurements and these data are rejected when comparing to collocated station data 2 3 discharge computation from the conservation of mass theory volumetric discharge is computed as below 4 q v a where q is the discharge m3 s v is the mean channel velocity m s and a is the wetted cross sectional area m2 the vertical velocity distribution in natural open channel flows is characterized by a velocity dip below the free surface and can be modeled by a modified log wake law guo and julien 2008 quick changes of velocity are mainly observed near the channel bottom and banks it is generally assumed that the depth mean velocity of a channel can be found at 0 6 times the depth below the water surface for relatively shallow channels or from the mean of the velocities found at 0 2 and 0 8 times the depth below the surface for deep channels for example if a channel has a total water depth of 10 m then the depth mean velocity can be estimated at a depth of 6 m below the surface or from the mean of the velocities at depths of 2 and 8 m below the surface mean channel velocity for a natural channel can be estimated from the surface velocity by multiplying it by a constant rantz 1982 therefore discharge from radar observations at any time step i is computed as below 5 q i k g v i a i where qi is the discharge m3 s kg is a global k coefficient that relates the surface velocity to mean channel velocity vi is the surface velocity m s and ai is the wetted cross sectional area m2 2 3 1 determination of k value a k coefficient of 0 85 to 0 90 is used to translate a surface velocity to a mean vertical velocity rantz 1982 this assumes the vertical velocity profile can be approximated using a logarithmic distribution or power law however if the vertical velocity distribution is non standard where the maximum velocity occurs at depth a different coefficient is required for each vertical in the channel cross section although multiple studies accept the validity of the default value for natural channels from recent experiments it is found that the actual value of k depends on the roughness of the bed material the place where the measurement is made and reynolds number costa et al 2000 melcher et al 2002 costa et al 2006 le coz et al 2012 welber et al 2016 also secondary currents presence of vegetation or tidal fluctuations can affect k johnson cowen 2017 considering different criteria numerous k values have been recommended such as 0 85 and 0 93 for base flow and high flow conditions respectively harpold et al 2006 0 79 to 0 93 depending on the roughness condition of the channel bed polatel 2006 0 75 to 0 83 for high flow situations in mountain channels jodeau et al 2008 0 79 to 1 72 in compound or irregular channels sun et al 2010 0 72 to 0 79 for channel bed consisting of gravel dramais et al 2011 0 86 to 1 18 due to secondary currents gunawan et al 2012 0 82 to 0 93 for varying reynolds number johnson cowen 2016 and so on a cross section averaged k coefficient or global k coefficient i e kg in equation 5 is needed to compute discharge if there is only a single surface velocity measurement available along a given stream cross section this is the case with the fixed deployment of the stream radars given the larger roughness values and shallower depths near the banks global k coefficients are expected to be lower than the local k coefficients reported above welber et al 2016 examined the differences between global and local k coefficients and found that the variability of the global values is considerably smaller than the local values moreover they found that the global k coefficients obtained in smoother channels fall into the range of the local k coefficients of 0 80 0 91 with a mean of 0 86 an alternative but related approach to relate surface velocities measured by the stream radar to mean channel velocities is based on the entropy or probability concept using the ϕ parameter chiu and chiou 1986 chiu 1987 chiu 1989 this concept is based on an assumed velocity distribution and is adaptable to cross sections where the maximum velocities are found either at the surface or below the surface fulton et al 2020 directly validated the ϕ parameters used to convert radar measured velocities to mean velocities using conventional in situ measurements they found values for the ϕ parameter ranging from 0 52 to 0 78 which yielded very close agreement to mean velocities from conventional mechanical current meters or hydroacoustics moreover ϕ does not vary with stage velocity discharge bed form or approach angle which makes ϕ valuable when dealing with temporal changes in physically based models fulton et al 2020 to optimize the k values for all three collocated stations the following multi objective function is developed the intention is to develop a function that considers the entire time series as well as event based statistics relevant for flooding the developed objective function is 6 ψ 1 3 n s e 1 3 1 ve 100 1 3 1 pe 100 where ψ is a dimensionless quantity that is expected to vary between 0 and 1 nse is the nash sutcliffe efficiency for whole time series ve is the mean volumetric error of an event and pe is the mean error in peak value of an event the multi objective function is designed to equally weight errors in event based peak flow volume and the nse describing the agreement for the entire time series nse is a metric used frequently in hydrology to describe how well two time series covary and is well suited objective function for this type of analysis servat and dezetter 1991 legates and mccabe 1999 use of nse is also recommended by asce 1993 and chosen to represent the overall accuracy level of the measurements in this study the event based metrics of mean volumetric error ve and peak flow error pe and are computed as below 7 ve 1 n i 1 n a b s v p i v o i v o i where vp i is the volume of the i th event integrated under the hydrograph of radar estimated discharge m3 vo i is the volume of the i th event integrated under the hydrograph of conventional discharge m3 n is the total number of events and abs operator indicates the absolute value of the variables within the bracket 8 pe 1 n i 1 n a b s p p i p o i p o i where pp i is the peak flow value of the i th event of radar estimated discharge m3 s and po i is the peak flow value of the i th event of conventional discharge m3 s for each collocated station this study computes the multi objective function using both single k and double k values for all the trials with k values a code is developed in python and the methods below are considered during computation we note that the guidance for default values generally apply to local k coefficients and we apply these findings to represent global k values with the understanding that there can be differences due to the influences of bed roughness radar illumination area and water depth the previous studies show local k values can vary roughly from 0 7 to 1 0 even greater than 1 0 based on the channel and flow conditions however for single k optimization this study varies the k value from 0 7 to 1 0 with a trial increment of 0 001 the double k optimization is based on the work of hauet et al 2018 with this method a threshold of water depth limit is set first and then two different k values are assigned for the depths above and below the threshold for cherry creek and mill creek this threshold is varied from 1 8 to 2 1 m as they are natural channels under each threshold of depth the lower k value for depths lower than the threshold is varied from 0 75 to 0 85 while higher the higher k value for depths higher than the threshold is varied from 0 9 to 1 0 the increments for depth threshold and k value are 0 003 m and 0 001 respectively because walnut gulch uses a concrete supercritical flume this k value is varied from 0 85 to 1 0 with an increment of 0 001 following the work of hauet et al 2018 2 3 2 calculation of wetted cross sectional area discharge estimates using the stage velocity radar data assume that there is a stable cross section changes to the bathymetry can have a negative effect on the discharge estimates therefore at first surveys are conducted to find a stable channel bottom for each site and then the cross sections are established at the selected location of the channel a cross section of any channel is measured using a conventional total station surveying method the vertical elevations along the line where the radar makes stage measurements are recorded by a total station survey relative to the reference level e g point of zero flow corresponding to the channel bottom or lower to allow for scour however in the case of mill creek the elevation of the floodplain at its left bank is complemented from a 1 m resolution digital elevation model dem usgs 2020 and then merged with the surveyed datapoints to complete the cross section cross section data e g station and elevation with respect to north american vertical datum of 1988 of a channel are further loaded into an online calculator nws 2020 that gives the corresponding wetted area for any water depth for each site wetted areas corresponding to a range of water depths are determined where the range varies from the minimum recorded stage value for that station to the maximum one with an increment of 0 03 0 06 m finally an equation is developed from the best fit of these data points and for any i th stage value ai is derived from the equation for cherry creek a stage area rating curve is provided by the usgs it is noted that stage area and stage discharge ratings would be affected by changes to the channel bathymetry caused by sediment deposition or scour vegetation growth etc the site selection for the stream radars considered the stability of the channel bottom in cases where the channel bathymetry may be evolving a stage velocity rating curve using the stream radar variables would need to be developed and monitored a sudden shift in the stage velocity relation could be indicative of change in the channel s cross section which would bias the calculation of the discharge alternatively the channel bathymetry can be regularly surveyed or even retrieved using remote sensing approaches such as a bank to bank scanning light detection and ranging lidar as proposed in gourley 2017 with this measurement the wetted cross sectional area and thus discharge will be more accurate than inferred under the assumption of a static cross section 3 results and discussions 3 1 uncertainty in stage measurements fig 4 shows the time series of radar measured stage and temperature for two of the bridge mounted radars cherry creek walnut gulch a cable mounted radar mill creek and a radar mounted on a concrete box culvert austin north the bridge and cable mounted radars generally exhibit positive correlations with air temperature fig 4a c while the culvert at austin south has a weaker negative correlation fig 4d it is believed that with an increase in temperature expansion of the bridge materials causes the bridge deck and cables to slightly sag which results in the radar deflecting downward from its original position yielding an apparent higher stage this would cause the distance between the radar and the water surface h in fig 3 to decrease resulting in an overestimation of stage the opposite would occur when the air temperature cools and the bridge materials contract in the case of falls creek it was discovered that a collocated water treatment plant regularly pumps water from the creek that potentially affects the steady state of base flow conditions and the positive correlation with temperature was not observed the radar at austin south is mounted on a wooden train bridge that produces vibration due to frequent trains crossing of the bridge as a result the stage records become noisy for this station at irregular intervals and correlation of stage with temperature cannot be readily observed to further quantify the correlation between stage and temperature the correlation coefficient r between these two variables is computed table 3 for cherry creek mill creek walnut gulch and paria river r varies between 0 526 and 0 804 which indicates a moderate positive correlation between stage and air temperature although falls creek has a cable mounted radar the r values during the two base flow periods are 0 155 and 0 139 indicating no correlation as previously mentioned this is due to the effect on base flow conditions caused by the pumping from the water treatment plant as for the two box culverts at sessom creek and austin north they both show weaker negative correlations the stage records at austin south have little correlation with air temperature r 0 023 and 0 330 during stable base flow conditions due to the added vibration of the bridge the analysis conducted herein was to assess potential effects of the mounting structures on the stage data measured by the radars given that walnut gulch is a normally dry wash we analyze the stage and temperature data during time periods for which there was zero observed flow this analysis provides an indication of the temperature dependence of the stage data in the absence of any water in the stream the diurnal temperature range results in an apparent stage change of approximately 2 cm owing to the thermal expansion of concrete of the supporting bridge over the concrete flume stage data from the collocated usgs stations at cherry creek and mill creek are provided for base flow periods the stages at these sites could potentially be affected by temperature dependent changes in the supporting structures and water in the underlying streams the usgs stations at mill creek and cherry creek use conventional gas purge bubbler systems note that their time series are independent from the radar measurements or structures used for mounting them curiously the two conventional gauges also show a diurnal temperature dependence of the stage the usgs data indicate a daily variation in the observed stage as high as 3 cm at cherry creek fig 4a and approximately 1 cm at mill creek fig 4c the stream radar diurnal variations in stage are the same as the usgs observations at cherry creek and approximately 2 cm at mill creek or 1 cm greater than the usgs observations it is plausible that these observed stage changes are due to urban and rural outdoor water uses respectively during the summer months the coefficients of volume expansion for steel and concrete are similar to one another at 35 10 6 c 1 on the other hand the coefficient of volume expansion for water is 210 10 6 c 1 or approximately six times greater than the expansion potential of the supporting materials it is difficult to quantify the uncertainty in the stream radar stage measurements when there is water in the channel nevertheless from the comparisons provided in this analysis including those from a dry concrete flume at walnut gulch we can estimate the diurnal variation caused by the thermal expansion of the supporting structures to be within 2 cm 3 2 uncertainty with k value 3 2 1 discharge comparison with default global k value 0 85 prior to estimating discharge radar retrieved velocities can be compared to in situ measurements using conventional current meters or hydroacoustics at multiple depths along the stream cross section the reader is referred to the fulton et al 2020 study that conducted velocity validations using the same type of stream radars as used in this study in our case kg values are initially applied using a default value and later optimized using the conventional discharge measurements as a constraint for the three stream radars that are collocated with conventional streamgauges discharge is estimated by reducing the measured surface velocity using a default kg factor of 0 85 we note that this value has been suggested as a default for local k values and not necessarily a global k value nevertheless it provides a starting point for estimating discharge this value is then multiplied by the wetted cross sectional area which is computed from the stage measurements combined with the stream s cross section as described in section 2 3 table 4 provides the statistical results when comparing to discharge from the conventional streamgauges for the entire time series listed in table 1 table 4 shows that the radar observations of all the collocated stations are quite accurate in providing the discharge estimates when compared to their respective streamgauge data the sample sizes vary owing to different hydroclimatologies sensor reporting frequencies and length of period over which the sensor was operational the usgs data at mill creek oklahoma were considered provisional for a three month period in the spring of 2018 but were later approved following this study s analysis period further many low flow cases were not considered in the analysis due to poor quality velocity measurements from the stream radar the sample size at walnut gulch is even smaller due to the episodic nature of flows in the dry wash during the monsoon in all cases the radar sensors yield nse and r values close to 1 0 and the nb values are generally small with a slight high bias at the cherry creek site the data are also presented in the form of scatterplots in fig 5 these results are representative of the sensors capability of estimating discharge without any parameter tuning on streams with a measured or known stable cross section one objective of the anchor project is to assess the sensors capabilities of detecting rapid onset flooding in vulnerable areas to provide early alerting to local authorities fig 6 compares times series of discharge from the stream radars to the conventional gauges for several high flow events while the statistical comparisons for the entire time series indicate very close agreement with the conventional gauges we can identify the following discrepancies in the event based comparisons 1 underestimation in peak flow values 2 underestimation in the total water volume integrated throughout the high flow event and 3 high frequency fluctuations in the stream radar discharge values regarding the event based underestimation of both peak flows and volume one potential reason could be an improper setting of the ground reference level gz which is meant to be the mean of the channel bottom elevation as illustrated in fig 3 this setting would result in bias that would affect the entire time series at both high and low flows the event based hydrographs in fig 6 indicate however that the discharge estimates generally agree at the beginning and end of the events yet the peak flows are still underestimated by the stream radar this stage dependent bias is evaluated in more detail in the next section conventional gauges represent the event dynamics from stage measurements that are then converted to discharge using a rating curve in the case of the stream radars the time varying velocity and stage data are both used to compute discharge the fluctuations in the stream radar hydrographs are found to be caused by the velocity measurements and not the stage the noise in the surface velocity retrievals can be caused by small waves initiated by wind and or rain secondary currents and potentially some slight swinging of the instrument for the cable mounted radars nevertheless these fluctuations are deemed random errors and are assumed to not cause bias these random errors can be mitigated by using a smoothing window on the velocity or discharge data 3 2 2 sensitivity analysis for global k value the prior analyses indicate that while the stream radars yield discharge values with default kg values that agree quite well with conventional gauges e g nse close to 1 there are non negligible peak flow and volumetric errors during flood events more specifically the radar driven discharge estimates are accurate during low flows but underestimate during high flow events prior studies i e harpold et al 2006 hauet et al 2018 have recommended the use of two k values to represent base flow and high flow conditions lower k values are recommended for base flows when the roughness of the stream bed has more effect on the surface velocities at high flows the roughness from the bed materials is less influential on the surface water velocities so in the following we explore the optimization of two k values for each site applied in a global sense the approach adopted herein is to simultaneously quantify the event based hydrograph errors and also consider the accuracy of the discharge estimates for the entire time series table 5 shows the global k values that maximize the multi objective function for each collocated station for all the stations the results are improved due to double kg value optimization for single kg optimization kg varies between 0 78 and 0 91 while for double kg it varies between 0 75 and 0 96 in general the highest ψ values are obtained for double kg optimization although the relative differences between the results for two different kg values are very small fig 7 shows scatter plots of the radar estimated and measured discharge from the collocated stations similar to fig 5 the radar estimated discharges in fig 5 are using the global k values of 0 85 while fig 7 shows the values for the optimized single and double kg values the values yielded from the double kg scheme are closer to the diagonal for all three stations this applies to both high and low flows for cherry creek the optimized single kg value 0 78 is found to be less than the default one and it reduced the ve and pe error by almost 4 with an increase in the nse score for double kg optimization the threshold depth limit differs by only 0 12 m from the recommended value 2 m by hauet et al 2018 for the kg values the higher one 0 89 is very close to their recommended value of 0 9 whereas the lower one 0 75 slightly deviates from the recommended value of 0 8 the ve error is almost halved and pe is also reduced by 4 because the total number of events is 26 for cherry creek this is a substantial improvement in hydrograph errors and therefore these kg values can represent the whole timeseries well as for mill creek the single kg value 0 83 is slightly lower than the default 0 85 and the nse ve and pe scores do not change that much from the results found with the default however the double kg value provides higher nse score as well as lower ve and pe scores the threshold of depth limit 1 9 m is only slightly lower than the recommended 2 0 m threshold the lower kg value is very close to 0 8 while the higher kg value is 0 96 for walnut gulch the optimized single kg value 0 91 is similar to the recommended value 0 9 by hauet et al 2018 however the event based errors do not change that much from the default kg derived errors for double kg optimization the kg value is quite similar 0 85 to the default one when the depth is less than 0 9 m and for greater depths the optimized kg value is found to be 1 0 with the use of these two kg values ve becomes less than 1 pe is almost halved and nse approaches 1 0 0 979 with the increase of water level channel bed roughness in a concrete flume is expected to have less effect on mean channel velocity and therefore a kg value close to 1 0 for depths above 0 9 m is physically realistic the prospects for using the sensors to quantify discharge on previously ungauged basins is promising our results indicate that the use of a single default kg value of 0 85 will yield nse values greater than 0 9 indicating very low error covariance there is some modest benefit with the optimization approach in reducing the event based peak flow and total volume errors which requires in situ measurements not unlike the need to establish a rating curve in conventional gauging however the next section explores the use of the stage and velocity measurements with no in situ measurements required a priori 3 3 early detection of flooding events one objective of the stream radar units is to assess the capability of detecting rapid onset flooding events in ungauged basins where there are vulnerable assets downstream one such setting is the falls creek stream radar placed upstream from a camp near davis oklahoma gourley 2017 the camp hosts as many as 7500 children teenagers and staff at a given time during the summer months on 18 june 2015 the region was struck by heavy rainfall up to 800 mm from a re intensifying tropical storm bill in the camp a bus was submerged and some campers were isolated for more than a day in coordination with the camp director the unit was installed on the stream upstream from the camp in march 2017 with the intention to provide early alerting the datalogger nominally logs data every 10 min and transmits them every hour the datalogger was initially programmed with subjective alert thresholds for stage exceeding 1 22 m or velocity exceeding 1 22 m s 1 when the stage or velocity exceeds the alert threshold data are logged and transmitted every 5 min note that this frequency can be increased to data logging and transmission every 1 min when in alarm status on 19 20 may 2017 severe weather affected the region resulting in a tornado warning issued by the local national weather service forecast office and heavy rainfall rates over the basin the time series plot of radar measured surface velocity and stage in fig 8 indicates the velocity exceeded the alert threshold at 0300 utc and the stage exceeded its threshold at 0315 utc the rate of the river stage increase was 2 57 m hr 1 interestingly the velocity first exceeded the alert threshold and preceded the associated rise in stage by approximately 30 min this offset in the rising limbs of the velocity and stage hydrographs is attributed to a celerity effect caused by inertial accelerations and or a pressure gradient from a non negligible slope in the water surface in fact the stage discharge hysteresis is discussed in detail in muste et al 2020 unsteady flow conditions arise when the stage varies rapidly during events that cause substantial slopes in the water surface relative to the channel bed slope situations of extreme rainfall falling on relatively flat terrain can yield the hysteretic behavior from analytical considerations muste et al 2020 also show that a direct manifestation of unsteady flows is phase sequencing between the time series of velocity discharge and stage in that order this phase sequencing has rarely been reported in field measurements rowinski et al 2000 given the early arrival of the velocity wave the stream radar combined with the alerting features of the data logger enabled more timely identification of an impending rapid onset flooding event downstream following the event the project team visited the radar to survey high water marks and assess the condition of the stream radar fig 2j the stream had risen to the height of the bottom of the unit itself upon inspection it was discovered that despite the damage that was incurred to the radars housing the waterproofing of the individual radars in the unit succeeded so that they continued to operate throughout and after the event nevertheless debris flowing down the stream impinged upon the supporting cables causing great tension on the housing and resulted in the damage shown in fig 9 the mounting was subsequently fortified to prevent stress on the housing in the future and the unit was raised from its original position furthermore the datalogger was programmed to alert on the following thresholds 0 91 m 0 91 m s 1 1 52 m 1 52 m s 1 2 13 m 2 13 m s 1 if any of these thresholds are exceeded then the data logging and transmitting frequency is increased to 5 min and sms alerts are sent to local stakeholders this event demonstrated that a stream radar unit could be used as an indicator of flash flooding at an ungauged vulnerable location without the need for cross section surveys in situ measurements for developing the rating curve or even establishment of bankfull flooding thresholds moreover the real time capabilities of data delivery and sms alerting enabled the measurements of surface velocity and stage to be useful without the need for estimating discharge in fact it could be argued that these variables lend themselves to be more understandable and thus useful to stakeholders 4 discussion and conclusions to evaluate the effectiveness of remote sensing technologies in noncontact measurement of stream variables water level and surface velocity eight stream radars have been installed at high priority locations across the united states the radars are mounted on bridges culverts and cables and have provided measurements for at least 1 year with a temporal resolution of 5 10 min the eight streams represent a variety of hydrologic hydraulic and hydroclimatological characteristics and three of them are collocated with conventional streamgauges this study is part of the automated noncontact hydrologic observations in rivers anchor project and aims to identify and characterize errors in the raw measurements to optimize correction factors so the data can be used to estimate discharge and to assess whether the real time transmission of alerts based on stage and surface velocity measurements can be useful in an early alerting context potential biases were assessed on stage measurement due to diurnal temperature changes causing expansion and contraction of the supporting bridges cables and culverts for bridge and cable mounted systems these stage measurements would be biased in direct correlation with temperature in the cases of bridges and cables the sensor could sag closer to the water surface giving the impression of an increase in stage the opposite could occur with the culvert mounted units we compared stage data from the stream radars to observations from collocated conventional bubbler streamgauges at cherry creek colorado and mill creek oklahoma these independent usgs streamgauges also showed a diurnal fluctuation in stage which is attributable to outdoor water uses during the summer months the stream radar had the same fluctuations as the usgs observations at cherry creek and had about 1 cm more variation than the usgs stage measurements at mill creek it is difficult to quantify the uncertainty in stream radar stage measurements caused by thermal expansion of the supporting structures when water is present in the channel the coefficient of volume expansion with water is approximately six times larger than with either steel or concrete and as we saw in our analyses outdoor water uses can result in actual diurnal fluctuations in stage without a detailed analysis of the thermal properties of the culverts bridges and cableways it is difficult to definitively quantify the effect of thermal expansion on stage at all sites however stage variations were assessed at walnut gulch arizona when the concrete flume was completely dry the maximum temperature induced stage change was found to be 2 cm at this site and the other collocated sites showed that the stage variations were not greater than this amount lastly when estimating discharge surface velocity retrievals during low flow periods must consider ambient wind velocities as they can become biased discharge comparisons at the collocated stations show that the use of a kg value of 0 85 to convert surface velocities to represent a mean channel velocity yield nse values greater than 0 9 during substantial flooding events peak flow values are underestimated the concept of using double kg values which is normally applied to convert surface velocities to depth averaged velocities for different stages and hydraulic conditions by hauet et al 2018 is a valid approach to get accurate results across the spectrum of flows including low flows and floods with the optimized kg values the statistical metrics indicate that the radar based discharge estimates can be as accurate as in situ conventional streamgauges and have acceptable event based hydrograph errors less than 10 volumetric and peak value error during floods nevertheless the kg value optimization requires a collocated conventional streamgauge which comes with the costs of regular visits to establish the stage discharge rating curve our results at three sites reveal that the use of a single default k value of 0 85 to be considered as a global k value yield nse values greater than 0 9 indicating the degree of accuracy that can be obtained without the requirement of in situ measurements of velocity profiles the use of the single default k value nominally reported to convert surface velocities to depth averaged values applied here to represent the mean channel velocity may be a bit fortuitous for the three collocated sites one would expect lower global k values to represent mean channel velocity compared to the local k values reported in the literature in the case of walnut gulch arizona the concrete flume represents a very smooth channel so that the local k value can approximate the mean across the cross section which agrees with results reported in welber et al 2016 in the case of cherry creek colorado the unit was situated on a bridge approximately 6 m above the water surface given the 12 beamwidth of the doppler radar and 56 off nadir pointing angle the radar illuminates more than 50 of the stream s width this means that the inferred global k includes a representative distribution of surface velocities across the stream and thus can approximate the local k values reported in the literature in the case of mill creek oklahoma the radar was situated at a location in the channel during base flow conditions where the largest surface velocities were expected see fig 2d however the channel is not as straight as desired at this location and it is plausible that the radar measures surface velocities that are not the maxima along the cross section this results in the retrieved velocity to approximate a mean surface velocity rather than the maximum considerations of the radar siting that include the area illuminated in the stream affect the quality of the discharge estimates in this study five out of the eight anchor stream radars are situated over ungauged streams these serve different purposes including low flow monitoring of a spring fed creek for sustaining endangered species on sessom creek texas monitoring high flows that affect bridges carrying trains austin south and austin north texas and detecting flash floods above vulnerable camping areas falls creek oklahoma in the latter case it was demonstrated that the sensors are capable of detecting surface velocities and river stages that pose hazards to life and property there was a notable phase sequencing between the surface velocity and stage indicative of unsteady flows caused by a large slope in the water surface relative to the mild channel bed slope it turns out this observation would be valuable in an early alerting context alert thresholds based on stage and velocity values can be subjectively determined for a given site input to the datalogger and then used to increase the data logging and transmitting frequency and to alert local authorities and stakeholders by sending them sms text messages further the early alerting capabilities do not necessarily require detailed cross section surveys or optimized k values to estimate discharges the measurements of stage and surface velocity are sufficient based on experience gained throughout the anchor project we provide some insights that can maximize data quality and quantity siting an instrument is key to its success the channel would need to have uniform relatively straight flow at the chosen site and a stable cross section further a site would need to have adequate cellular network coverage for transmitting the data there are instances in which radio transmitters are being used to send the signal up to a ridge location where there is better cellular data coverage the batteries are charged with a solar panel so having good visibility toward the equator improves the power budgeting optimal siting of the units also needs to consider the degree of public access to reduce the instances of vandalism in closing this study provides experiences gained at diverse locations and will hopefully motivate future studies and efforts to promote additional sensing of earth s freshwater resources credit authorship contribution statement mushfiqur rahman khan formal analysis writing original draft jonathan j gourley conceptualization supervision writing review editing jorge a duarte data curation software humberto vergara project administration daniel wasielewski funding acquisition investigation resources pierre alain ayral investigation resources john w fulton conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding was provided by noaa office of oceanic and atmospheric research under noaa university of oklahoma cooperative agreement na16oar4320115 and na16oar4590234 u s department of commerce any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government the authors declare no conflicts of interest and the funders had no role in the design of the study in the collection analyses or interpretation of data in the writing of the manuscript or in the decision to publish the results the manuscript was greatly improved following the constructive comments from three independent reviewers and internal reviews supplied by the usgs data availability the air temperature data used in this study were obtained from the noaa national center for environmental information at the following location https www ncdc noaa gov data access land based station data land based datasets quality controlled local climatological data qclcd all usgs data used for validation can be obtained online https doi org 10 5066 f7p55kjn the time series data for all eight stations analyzed in this study and their specific locations have been placed in the public domain doi 10 5281 zenodo 4526127 
