index,text
5410,in the last decades advancements in computational science have greatly expanded the use of artificial neural networks anns in hydrogeology including applications on groundwater forecast variable selection extended lead times and regime specific analysis however ann model performance often omits the sensitivity to observational uncertainties in hydroclimate forcings the goal of this paper is to implement a data driven modeling framework for assessing the sensitivity of ann based groundwater forecasts to the uncertainties in observational inputs across space time and hydrological regimes the objectives are two folded the first objective is to couple an ann model with the pawn sensitivity analysis sa the second objective is to evaluate the scale and process dependent sensitivities of groundwater forecasts to hydroclimate inputs computing the sensitivity index in groundwater wells 1 across the whole time series for the global sensitivity analysis 2 across the output sub regions with conditions of water deficit and water surplus for the regional sensitivity analysis and 3 at each time step for the time varying sensitivity analysis the implementation of the ann pawn occurs in 68 wells across the northern high plains aquifer usa with pre time step rainfall evapotranspiration snowmelt streamflow and groundwater measurements as inputs results show that evapotranspiration and rainfall are the major sources of uncertainty with the latter being particularly relevant in water surplus conditions and the former in water deficit conditions the time varying sensitivity analysis leads to the identification of localized sensitivities to other sources of uncertainty as snowmelt in spring or river flow during the annual peak period at the groundwater level keywords groundwater forecasts artificial neural network uncertainty sensitivity analysis 1 introduction in the past century the growing access to pumping technologies and aquifer mapping has evidenced the role groundwater gw plays in securing food production and sustaining population growth konikow and kendy 2005 agriculture consumes about 90 of the world s green water and about 40 of irrigated water comes from groundwater withdrawals aeschbach hertig and gleeson 2012 the pressure exerted on global groundwater storage has led to global aquifers depletion at rates of about 283 km3y 1 pokhrel et al 2012 a value that represents an increase of 120 for the one observed in the 1960s wada et al 2010 contrary to common perceptions gw depletion is not limited to arid and semi arid regions but also occurs in humid areas of the world one of the best documented cases is the high plains aquifer hpa in the united states the hpa located in a temperate subtropical area has lost about 250 km3 of water in the past 60 years corresponding to about 8 of the initial storage scanlon et al 2012 thus effective water management is an unavoidable task which could be achieved through a range of mechanisms such as improved crop water use efficiency kukal and irmak 2017 irrigation scheduling kang et al 2000 and reservoir operation optimization galelli and soncini sessa 2010 in irrigated agriculture water resources re allocations are typically planned semi seasonally or seasonally with the aim of optimizing water use efficiency maintaining soil field capacity and sustaining water systems amaranto et al 2019 hence the successful implementation of seasonal water management strategies and irrigation scheduling relies on the ability to anticipate the future state of the gw system in response to various hydro climatic and anthropogenic factors coppola et al 2005 data driven models ddms can be used for such forecasting purposes ddms are well recognized techniques that extract the input output relationship from data without requiring the complete characterization of a system developments of computational sciences have greatly expanded their application domain to hydrogeological systems and ddms have been used successfully for groundwater forecasts in many studies one of the first applications of ddms was implemented by coulibaly et al 2001 who tested and compared different ann architectures for groundwater forecasting in burkina faso a few years later daliakopoulos et al 2005 investigated the most suitable ann architecture for predicting the gw level finding that the most accurate model was a standard feed forward neural network more recent studies include tapoglou et al 2014 who simulated groundwater level variations across the isar river using a combination of ann and kriging bavaria germany they found that this hybrid approach can be used successfully in aquifers where the hydrogeological information is constrained mohanty et al 2015 used ann to simultaneously forecast the weekly groundwater level at multiple sites up to a maximum of a month they found a significant decrease in performance for an increase in lead time barzegar et al 2017 compared the ability of wavelet group data handling and extreme learning machines to forecast gw level three months ahead concluding that the best performances can be obtained by the latter guzman et al 2017 and wunsch et al 2018 forecasted daily gw level variations in a well in the mississippi river valley aquifer and germany by using nonlinear autoregressive neural networks narx their results showed the potential of narx to predict gw levels effectively amaranto et al 2018 compared the ability of five different ddms to forecast seasonal 1 to 4 month gw levels across hydrological regimes they found that the error of all the ddms increased during intra seasonal water deficits amaranto et al 2019 implemented an artificial neural network instance based learning framework called multi model combination mumoc to forecast gw levels in three hundred wells across the high plains aquifer in response to irrigation demands and hydro climatic inputs the implementation of mumoc led to finding that modeling performances were strongly affected by precipitation and evapotranspiration and that mumoc outperformed and artificial neural network model in a single well especially in areas where observations were abundant nonetheless ddms do not require a complete hydrogeological characterization of the gw system the performance of for example ann models is sensitive to input measurements such discrepancies in the inputs can be attributed to operational errors systematic bias the geographical distance between weather stations and the monitoring wells or the combination of the factors above these observational uncertainties propagate through the model leading to a decrease in predicting accuracy or a problematic interpretation of the results the latter is more ddm specific given their intrinsic black box nature in areas where gw is used for irrigation supply and water allocation is scheduled ahead of time according to the projected water availability it is critical to understand the dominant drivers of the gw model s dynamics in other words it is crucial to identify which variables need to be known with higher accuracy and what effects the uncertainties of those variables have on the model outputs and forecast errors thus assessing the sensitivity of forecasting accuracy to observational uncertainty still represents a significant challenge for modelers and water managers which can be addressed by global sensitivity analysis gsa techniques modeling results might also be sensitive to different observational uncertainties i e for different inputs in different hydrogeological conditions corzo and solomatine 2007 a separate sensitivity analysis per each regime hereafter referred to as regional sensitivity analysis is recommended usually global sensitivity analysis methods use performance metrics aggregated over the whole simulation time series which might lead to a significant loss of information regarding local behavior that might be of great interest pianosi et al 2015 aggregating and performing sa at each time step time varying sensitivity analysis tvsa is a viable option for recovering significant sensitivity to input uncertainty at specific instants in time the goal for this study is to implement a framework for assessing a data driven groundwater forecast one month sensitivity to multiple observational uncertainties in hydroclimate inputs rainfall evapotranspiration snowmelt river flow and groundwater measurements across space and time and for different hydrological regimes the objectives are two folded the first objective is to develop an ann based full fledged framework including an input variable lag selection and then we couple it with the global sa method called pawn pianosi and wagener 2015 the second objective is to evaluate the scale and process dependent sensitivities of groundwater forecasts to hydroclimate inputs computing the sensitivity index in groundwater wells 1 across the whole time series for the global sensitivity analysis 2 across the output sub regions with conditions of water deficit and water surplus for the regional sensitivity analysis and 3 at each time step for the time varying sensitivity analysis the testbeds for the current experiment are 68 wells across the northern high plains aquifer the authors carried deterministic analyses to characterize the spatial distribution of the error in groundwater forecasts in a previous study amaranto et al 2019 which is not further discussed in this manuscript 2 methodology 2 1 methodological framework to achieve the objectives described above we apply the methodological framework outlined in fig 1 to each of the wells selected for the analysis in the first step the hydroclimatic data rainfall evapotranspiration river discharge snowmelt and groundwater level data are divided into training and test sets data division here we optimize the split between the training set and the test set to ensure that both sets fit approximately the same statistical distribution using the training and test average and standard deviation as optimization criteria then the training minimum and maximum are used to normalize the data between 0 and 1 data transformation to select the most relevant lag times we apply a model based input variable selection ivs procedure using artificial neural networks as models to the training set the training set is then further split into a proper training set and a cross validation set this procedure referred here as cross validation is implemented to optimize the number of nodes in the ann hidden layer using the rmse in the cross validation set as criteria to be minimized unlike traditional applications of data driven models the test set is not just used to test the performance of the model but also to evaluate the sensitivity of the model s accuracy to input uncertainty to implement this approach we characterize each of the sources of uncertainty and then we perform several perturbations on each of the inputs time series in the test set accordingly the perturbed input data are then iteratively sampled following a density based sensitivity analysis scheme proposed by pianosi and wagener 2015 called pawn pawn uses the difference between the conditional and the unconditional distributions of the output metric rmse in our case to measure the sensitivity to different uncertain inputs for each input combination sample the ann model is run and the rmse on the test set is used to evaluate the model s performance then the difference between the unconditional and conditional distributions of the rmse is used to compute the pawn sensitivity indices in three conditions first to assess the overall effect of data uncertainties on model performance the pawn indices are computed for the rmse calculated over the whole time series in each of the 68 wells under analysis second to estimate the impact of data uncertainties in water deficit and surplus conditions the pawn indices are computed for the rmse of the data points below the 10 quantile of the water level hydrograph deficit and above the 90 quantile surplus see amaranto et al 2018 for a more detailed description finally to assess how the relative influence of different variables changes over time we compute the pawn indices for the rmse evaluated at each time step with a moving window centered around the time step itself since the number of output time series in this paper is one per well 68 in total for simplicity the time varying sa analysis is limited to two representative groundwater level time series further details about each of the blocks in fig 1 are provided in the following sections 2 2 data division and transformation to assure that data come from the same population bhattacharya et al 2007 the theory of ddm requires the statistical distributions of the training and the test sets to be approximately the same first we implement an iterative process of random selection to achieve the statistical homogeneity between the training and test sets then we compare their distributions and select the split providing the closest statistical distribution one drawback of this procedure is the inability to reproduce modeling results in consequence we chose to constrain the iterative randomization of the splits by limiting the search of the test set only to consecutive years corresponding to 30 of the total number of time steps for example if we are supposed to have 30 years of data the first nine years of the data are selected as the test set and the remaining 21 years of data as the training set the statistical distributions of the two sets are compared using their mean and standard deviation and the result is stored in the second iteration the test set is composed of the second to tenth year time steps and so on the maximum statistical similarity is ensured by choosing the split s s that satisfies the following rule 1 s a r g m i n s μ r s 1 2 σ r s 1 2 where where μ r and σ r are the ratios between means and standard deviations of the training and the testing set outputs after normalization respectively and the optimal split s s is selected by solving the eq 1 through an exhaustive search procedure after selecting the optimum split the minimum and the maximum of the training set are used to normalize the data in the interval 0 1 2 3 selection of lags for the input variables in building ddms a key step consists in the selection of relevant and adequately lagged input variables a procedure commonly referred to as input variable selection ivs often this is done by exhaustively testing all the possible combinations of properly lagged variables however due to the often high number of candidates the ivs procedure frequently becomes an optimization problem aimed at minimizing the trade off between being computationally efficient i e testing the least possible number of combinations and finding the best input candidate i e testing them all several studies have tried to address this problem among them a genetic algorithm and general regression neural network gagrnn proposed by bowden et al 2005 a tree based iterative search method developed by galelli and castelletti 2013 and a partial mutual information based algorithm may et al 2008 elshorbagy et al 2010a a good variety of ivs methods is available in the literature see for example galelli et al 2014 for a review considering our objective to evaluate the sensitivity of the groundwater forecasts to the uncertainties in the inputs we include all the candidate input variables once in this study then the problem is limited to selecting the proper lag for each input rainfall evapotranspiration river discharge and snowmelt to select the optimal lag for each variable we perform a constrained ann based exhaustive search ces the ces algorithm iteratively tests any possible lag combination among the variables each of them taken at one specific lag at the time in other words considering the four inputs mentioned above and four lags from t to t 4 per input the ces generates 256 44 potential input candidates each candidate includes rainfall evapotranspiration snowmelt and streamflow only referred to as flow from here on once in a lag going from t to t 4 for what concerns the fifth input current groundwater level we use only the last groundwater observation available gw t this choice is based on the fact that for this specific input the lag 1 was the one maximizing the average mutual information with the model s output gw t 1 for each of the candidates an ann model is fitted on the training set the rmse in the cross validation set was selected as optimization objective to be minimized in the search of the best input subset 2 4 artificial neural networks multilayer perceptron mlp haykin 2004 neural networks are a machine learning technique that has been widely used in water related studies see for example elshorbagy et al 2010b abrahart et al 2012 an mlp consists in an input layer a hidden layer and an output layer the first has the sole purpose of distributing the inputs further the nodes in the hidden layer usually depend on the complexity of the system analyzed but also on the number of input neurons the number of nodes in the output layer is often one or equal to the number of outputs the connections between layers are associated with weights w a sigmoidal transfer function in the nodes of the hidden and often of the output layer s ensures the nonlinearity of the mlp 2 5 characterization of the sources of uncertainty one of the objectives of this study is to assess the relative contribution of the uncertainties of the inputs on the accuracy of a data driven model hence the uncertainties in the observational inputs are divided into five categories 1 the uncertainty in the rainfall observations 2 the uncertainty in the evapotranspiration time series 3 the uncertainty in snowmelt observations 4 the uncertainty in streamflow time series and 5 the uncertainty in groundwater level observations used to both feed the model autoregressive input and evaluate it output data uncertainty here is treated similarly as in pianosi and wagener 2015 in particular rainfall uncertainty was characterized assuming that the measurement error is multiplicative and the extent of the error changes differently in every rainfall event this procedure called storm dependent rainfall depth multiplier was first proposed and adopted by kavetski et al 2003 2006 we assume a maximum observational rainfall error of 40 therefore the corresponding storm dependent multipliers are extracted by a uniform distribution within the range 0 6 1 4 for evapotranspiration and snowmelt error we assume a constant multiplier through the whole time series drawing it from a uniform distribution over 0 7 1 3 i e assuming a maximum error of 30 these error percentages were decided by computing the average monthly coefficient of variation with respect to the climatology defined here as the monthly cyclostationary average an additive error model was used to perturbing the flow data here the errors are represented by a zero mean autocorrelated heteroscedastic gaussian process hgp the variance of the error model is considered linearly dependent on the flow schoups and vrugt 2010 the two parameters of this model are set to maintain the maximum error in flow observations at 20 in 99 of the cases groundwater observations time series were treated similarly but the hgp was fitted to the groundwater variations rather than to the measurements themselves to ensure that the measurement error is proportional to the difference in hydraulic head change and not to its absolute value 2 6 evaluation scheme to evaluate the contribution of each input to the performance of the model we use three different aggregation schemes of the forecasting errors first to identify the global contribution of the various inputs over time in each well in the study area we compute the root mean squared error rmse over the whole time series second to assess the input importance in different hydrological conditions we compute the rmse over the region of the water levels above the upper 90 and below the lower 10 quantile of the water level hydrograph finally to assess the temporal evolution of the inputs relative influence we compute the rmse at each time step over a moving window centered on that time step 2 rmse t 1 2 w 1 k t w t w gw k sim gw k obs 2 where w is the semi length of the moving window t is the time step on which the window is centered and gw k sim and gw k obs are respectively the simulated and observed groundwater levels on day k 2 7 the pawn sensitivity analysis to assess the relative contribution of each input to the accuracy of the forecasts we use a distribution based sensitivity analysis method proposed by pianosi and wagener 2015 and called pawn the choice of this particular sensitivity method lies in its easy applicability to nonlinear models and its independence from the type of output distributions for example symmetric multimodal or highly skewed furthermore it has shown to provide robust results for a relatively low sample size zadeh et al 2017 pianosi and wagener 2016 as other distribution based methods pawn measures the sensitivity of the output y the rmse in our case to variations of an input x i the time series of a particular hydrometeorological variable by the distance between the unconditional distribution of y obtained by varying all the inputs and the conditional distribution obtained when all the inputs change but x i here the conditional and unconditional distributions are approximated by their empirical distribution functions the distance between distributions is measured by the kolmogorov smirnov statistic computed as follows 3 k s x i max y f y y f y x i y x i where f y y is the empirical unconditional distribution of y and f y x i y x i is the empirical conditional distribution of y when the ith input is kept fixed at the nominal value x i since ks is dependent on such nominal value the pawn method considers ks statistics over a prescribed number of nominal values and then extracts their maximum as follows 4 s i max x i k s x i by definition all the ks x i values and consequently the sensitivity indices s i vary in the range 0 1 the closer the unconditional distribution f y y is to the conditional ones f y x i y x i the smaller the ks x i values and therefore the smaller the sensitivity of y to x i and vice versa 3 experimental setup 3 1 artificial neural networks to maximize the forecast performance it is important to optimize the number of nodes in the hidden layer of the mlp here the number of neurons was selected individually in each of the 68 wells under analysis within the interval 5 17 the mlp were trained by using the resilient backpropagation algorithm using the r package rsnns bergmeir and benítez 2012 3 2 pawn as mentioned above the pawn index estimates the sensitivity of the model output to a given input by the difference between the unconditional and the conditional cumulative distribution functions cdfs of the output the unconditional cdf is approximated here by the empirical distribution of n u output samples obtained by sampling the whole input feasibility space similarly the conditional cdfs are approximated by the empirical distributions of n c output evaluations per each input these evaluations require iterative sampling all the inputs but x i which is kept fixed to a nominal value since the index is dependent on the nominal value at which x i is fixed we repeat the evaluations using n different nominal values for x i consequently being m the number of variables the total number of model evaluations required to compute the pawn indices for m inputs is n u n c n m the values of n u n c and n are fixed by trial and error to 5000 3000 and 20 respectively leading to a total number of model evaluations equal to 305 000 per well and an average confidence interval size obtained with 50 bootstraps around the sensitivity index of 0 02 the numerical implementation of the pawn sampling and evaluation for our application is schematized in fig 2 to obtain the unconditional distribution of y we randomly sample each of the input factors 5000 times each of these 5000 samples corresponds to a dataset containing one perturbed time series of rainfall evapotranspiration snowmelt discharge and current gw level these input datasets are fed iteratively into the ann model which will therefore produce 5000 time series of gw level forecasts then by comparing gw forecasts and observations we obtain 5000 realizations of the model performances i e 5000 values of rmse or 5000 rmse values at each time step in case of tvsa which are used to approximate the unconditional distribution the steps required for the numerical approximation of the conditional distributions are represented in the bottom part of fig 2 for the sake of simplicity fig 2 refers to only one of the inputs in this case rainfall but the procedure for the other inputs remains the same first we randomly sample one conditional rainfall time series then we generate 3000 random samples of the other time series and we iteratively run the model in this case the rainfall time series is fixed while snowmelt discharge evapotranspiration and gw level time series change at each of the 3000 iterations the 3000 rmse values associated with the model forecasts time series are then used to approximate the conditional distributions then we apply eq 3 to compute the ks statistic we rerun the experiment as many times as the number of conditioning values 20 in the current analysis and we compute the pawn index as in eq 4 to achieve the specific objectives of this study we compute the pawn indices for the rmse calculated over 1 the whole time series 2 water scarcity and abundance conditions and 3 at each time step using a window semi length of three months w 3 months also a six month window is tested the pawn analysis is implemented using an r adaptation of the safe toolbox pianosi et al 2015 4 material 4 1 case study and dataset the study area in the high plains aquifer hp fig 3 a extends for about 450 000 km2 the largest aquifer in the united states over eight states south dakota nebraska colorado kansas oklahoma wyoming new mexico and texas since the 1950s the aquifer has been intensively exploited by irrigation and now ranks first in the united states for groundwater withdrawal in the last 30 years water levels in the hp have shown declines of more than 30 m these declines caused a saturated thickness reduction in some areas kansas and texas in particular of more than 50 scanlon et al 2012 the total gw depletion in the hp in the past 70 years is about 8 of the total groundwater storage the area under investigation is the northern portion of the high plains fig 3b e which occupies about 37 167 000 km2 of the total aquifer area it is crossed by the platte river which drains northeast colorado southeast wyoming and central nebraska before merging into the missouri river eschner 1983 here the aquifer is constituted by unconsolidated quaternary alluvial deposits and is mainly in unsaturated conditions with total saturated thickness ranging from 400 m in the central part to less than 50 m in the west mcguire 2015 irrigation measured in terms of percentage of irrigated area ozdogan and gutman 2008 is particularly developed in the eastern part and alongside the platte river fig 3b with corn and soybeans being the most cultivated crops the irrigation system is usually a center pivot sprinkler according to wen and chen 2006 the number of registered irrigation wells grew from 1200 in 1936 to about 100 000 in 2007 serving about 85 of the state s irrigation land rainfall fig 3d follows a west to east gradient with a minimum of about 27 mm month near the border with wyoming to a maximum of about 70 mm month on the eastern side of the aquifer the maximum net recharge rate of the aquifer occurs in the east part of nebraska mainly rainfall driven and alongside the platte river and it is of about 22 mm y houston et al 2011 the contribution of the platte river to aquifer recharge is also evident from fig 3e where it is possible to observe how the area close to the river is the one characterized by the highest rise in the gw level in the past 70 years gw level increases are also frequent in the north central part of the state where low irrigation intensity and high saturated aquifer thickness might be considered the main drivers of the aquifer recharge water level decrease is particularly severe in the southeast and in the southwest monthly estimation of rainfall p mm month evapotranspiration mm month and snowmelt mm month were obtained by the global land data assimilation system gldas rodell et al 2004 with a spatial resolution of 1 8 degree latitude longitude about 15 15 km gw in meters below land surface and discharge q m3 d in the hp aquifer data were provided by the usgs 2015 we filtered the complete usgs gw database to exclude stations with an observation period of fewer than ten years of data 120 observations and missing data higher than 25 within the 1980 2018 period after the implementation of the filter 68 wells remained available for analysis fig 3c streamflow data were gathered from the stream gauges closest to the selected monitoring wells 5 results and discussion 5 1 spatial global sensitivity to data uncertainty fig 4 shows the spatial distribution of the sensitivity index for each of the five variables assessed in this study by looking at the chart and in table 1 it is easy to notice the strong impact that rainfall and evapotranspiration uncertainties have on ann performances in contrast the contribution of snowmelt is practically negligible one possible explanation for this might lie in the fact that while fig 4 shows aggregated results for the whole time series snowmelt is a phenomenon that usually occurs only a few months a year in february march and april see amaranto et al 2019 for additional elements its contribution is limited to this time frame therefore while its impact on the model s performances in a time step might be relevant its overall contribution appears to be much lower also the interaction of snowmelt with the upper soil layers is well known and it is unlikely that in locations where the aquifer is deeper this variable might have any influence on groundwater dynamics fig 5 shows the variables producing the highest and the second highest value of the pawn index in each of the wells analyzed analyzing fig 4 fig 5 and table 1 one can see that overall evapotranspiration μpawn 0 56 rainfall μpawn 0 49 and river flow μpawn 0 3 are the three dominant variables governing model performances in particular evapotranspiration was the most relevant variable in 37 wells 54 of the cases and the second most relevant in another 19 wells 27 of the total followed by rainfall the most pertinent input in 21 wells 31 of the whole and the second most relevant in 30 40 of the total and river flow most relevant input in 9 wells 13 of the total second most appropriate in 12 wells 17 of the total by comparing fig 5 and fig 3b we see that evapotranspiration uncertainties seem to mainly affect the performance of the models in regions where irrigation intensity is higher orange and red areas in fig 3b the influence of flows can be more robust near rivers but flow measurement stations were not always available near wells to effectively couple the discharge time series with the groundwater levels on the other hand the influence of rainfall on groundwater level changes can be particularly relevant along the platte river 5 2 regional sensitivity analysis for water availability regimes fig 6 shows the input variables responsible for the highest uncertainty in forecasts during water surplus left panel and water deficit right panel conditions by looking at the figure on the left one can notice the increased relevance of snowmelt rainfall and flow this close relationship between surface water based variables and groundwater levels is probably because the upper quantile corresponds to the hydrograph section associated with the water level peak usually occurring between february and april during those months snowmelt occurs and recharges the aquifer as a consequence snowmelt becomes the most relevant input variable in water abundance conditions in six of the wells under analysis a situation in which the overall sensitivity analysis never occurred march and april are also the months when maximum rainfall usually occurs and when forecast sensitivity to precipitation uncertainty is the most relevant in 26 of the wells besides the higher water level in the upper quantile favors river seepage which is inversely proportional to the distance between river sediment and groundwater level and consequently sensitivity to flow data uncertainty increases with flow being the most important source of uncertainty in 16 wells as expected the left panel in fig 6 also shows how relevant is the decrease in evapotranspiration when there is a water surplus for example the relationship between evapotranspiration and crop water demand and it is maximum during the crop growing season is more evident later on in the year causing a significant intra annual water level depletion at the same time fig 6 shows how evapotranspiration is by far the primary source of forecast uncertainty in the lower quantile of the water level hydrograph overall 44 out of the 68 wells about 65 of the total wells assessed had et associated with the highest pawn value as stated above et is at its maximum during the crop growing season when significant gw depletions also occur in particular and as we will see in the following sections the peak in et usually occurs in august which is also the month corresponding to the yearly minimum in groundwater level and the maximum drawdown consequently uncertainty in evapotranspiration inputs can propagate from et to the forecasts of groundwater levels this propagation is more evident during months in the lower quantile and when the forecast sensitivity to evapotranspiration becomes the most relevant among all inputs analyzed in this study 5 3 time varying sensitivity to input data uncertainty regarding the temporal variability of the pawn index fig 7 shows the time series february 1991 october 2001 of the gw level red line in the plot and the pawn index grayscale rectangles in one of the monitoring wells mw1 red box in fig 5a the location of mw1 is near the lower republican river in the southern part of nebraska fig 3c in mw1 the aquifer is relatively shallow the average groundwater depth is 2 m allowing surface water and groundwater to interact the initial portion of the time series shows a keen sensitivity of flow observational uncertainties on modeling error with flow influence being particularly relevant during the rising limb of the water table level hydrograph as can be seen in the figure snowmelt has a periodical control with peaks on the pawn index regularly occurring between february and april when snowmelt occurs this influence seems to confirm the previous finding that despite the low overall sensitivity to snowmelt there are instances in time when this variable at least marginally influences modeling performances however snowmelt influence dissipates in the second half of the time series from 1997 when the pattern in groundwater levels also changes staring in 1997 groundwater depletion during the growing season appears to be much more acute on average five times greater than the depletion rates occurring between 1991 and 1996 this increased depletion might cause groundwater level changes occurring deeper from the surface in the spring reducing the effect of snowmelt on the model error at the same time the model exhibits an increase in the sensitivity to evapotranspiration during the crop growing season the best possible explanation for this period is an increase in groundwater use for irrigation in essence crop irrigation requirements and consequently evapotranspiration govern the groundwater variability in the season when irrigation takes place hence an increase in irrigation water use might lead to more considerable influence of evapotranspiration uncertainties on modeling performances fig 8 shows the time varying pawn index for mw2 in the blue box of fig 5a as in mw1 snowmelt likely influences the strong seasonality in the figure however unlike in the previous case the influence of river flow on mw2 appears to be more seasonal rather than a continuous effect along with the time series the deeper water level might explain this effect in mw2 which varies from a minimum of about 10 m in march and april to a maximum of about 19 m in august and september in comparison to mw1 s shallow groundwater level the only time when any interaction between the surface water and groundwater emerges is when the spring recharge might be responsible for bringing the water table level closer to the surface practically no interaction between the two occurs through the rest of the year in the case of mw2 the performance of the model looks to be entirely driven by rainfall and evapotranspiration with the latter showing an increasing influence in the second portion of the time series between march 2000 and december 2005 as in the previous case the increased influence of evapotranspiration coincides with much deeper water tables during the growing season for instance after the summer of 2000 the water level experienced a drastic depletion in the water table during summer which decreased the autumn spring recovery typically observed in the previous five years furthermore the water level starts showing a low depletion trend during which the influence of rainfall decreases and the influence of evapotranspiration consistently increases 5 3 1 effect of changing the window size fig 9 illustrates an unclear increase in the window in mw2 for the sensitivity of groundwater changes to rainfall and evapotranspiration when w 6 months the time series has two sections one section 1995 2000 predominantly rainfall driven and another section 2000 2005 evapotranspiration driven also fig 9 indicates that the effect of snowmelt and flow becomes practically negligible throughout the time series this result might be explained by the fact that both variables have a significant impact on modeling results only for limited and specific times the effect of flow was relevant only around march april while the snowmelt effect was detectable only around february march these months also correspond to the only time of the year when snowmelt 2 mm day is comparable to rainfall 1 8 mm day by increasing the window length the estimated sensitivity index for those months contrasts with the low sensitivity obtained in the months before february and after april thus an apparent combination of conditions makes the contribution of flow and snowmelt practically undetectable at the same time rainfall and evapotranspiration lead to a more regular sensitivity index characterized by fewer variations between one time step and the following in essence drastic changes in the pawn index such as the one occurring for evapotranspiration in march and april 2007 or the one for rainfall in march 2000 are attenuated and become practically negligible 6 conclusions in this study we implemented a sa framework to better understand the sensitivity of ann errors to input observational uncertainties in groundwater forecast as a product of the coupling ann sa we conclude the following overall evapotranspiration μpawn 0 56 and rainfall μpawn 0 49 were the most relevant inputs in particular evapotranspiration appeared to be particularly relevant in areas with higher irrigation intensity whereas the rainfall effect was detectable especially in the platte river area modeling errors were not sensitive to the groundwater level measurement error in any of the case studies results for flow were difficult to interpret since flow stations were unavailable for coupling with the time series at all 68 wells however the flow effect was higher in the geographic proximity to the platte and lower republican rivers the contribution of snowmelt to the changes in groundwater levels was practically negligible across the studied area average pawn index 0 12 two factors might drive this effect the first factor is that snowmelt occurs one to two months in any given year and the second factor is that the performance of the model might be relevant in a single time step but the effect is much lower throughout the whole time series regional sa results showed that evapotranspiration is the most relevant variable in water scarcity conditions 10 quantile of the water level hydrograph it showed in fact to dominate the error dynamics in about 65 of the wells in the study area in contrast rainfall was the most important in water surplus 90 quantile being the major sources of uncertainty in 40 of the analyzed wells sensitivity to snowmelt and flow also showed an increase in the upper quantile the time varying sa was able to register information that otherwise would have been lost by applying sa to the whole time series for example the analysis of the constrained window shows that the effect of snowmelt is significant at the beginning of spring with peaks of sensitivity index up to 0 62 also evapotranspiration proved influential in seasons when the groundwater depletion was particularly severe while at other times flow or rainfall was the most relevant variables increasing the window size led to less variability in the results and consequently to a less qualitative interpretation additionally it hides potentially relevant information such as the effect of snowmelt and river seepage in the spring in summary the present study evidence how complex phenomena govern the ann ability to predict gw availability in irrigated areas in the land surface and the subsurface and across different spatial hydrological and temporal scales accurate estimations of evapotranspiration are critical since it was identified as the primary source of uncertainty in the forecast of groundwater levels furthermore regional and time varying sensitivity analyses tailored for specific water regimes were able to identify the importance of other forcing inputs e g rainfall in water surplus and snowmelt at the beginning of the year which could not be captured when those errors were averaged over the entire time series these analyses are recommended in order to raise awareness of the multiple sources of uncertainty and their roles in governing specific hydrological conditions and during particular periods 7 limitations and future recommendations this study is limited by the lack of real world pumping data which were not available for the case study area and by the use of proxies such as evapotranspiration to simulate crop water requirements using pumping data would have provided more information on how human intervention shapes model performance furthermore the selection of the feasibility space for the perturbed input was empirically established when possible this choice should be made based on information about the error available perhaps from local institutions the analyses of the tvsa indicate how a different window convey different information a suggestion is to investigate various sizes to capture the full range of sensitivities across time scales also sa results might be sensitive to the choice of the model here we used artificial neural networks to forecast gw levels and gsa to estimate the effect of data uncertainty on the model s performance the choice of a different model perhaps physically based might lead to different results the use of a physically based model coupled with an analysis not based on error metrics such as the presented here might likewise provide insights on how the physical system and not the model s error is sensitive to uncertainties in forcings and parameters therefore further research on coupling physically and data driven models should might lead estimate the contributions of the multiple sources of uncertainty in sub seasonal forecasts of groundwater levels credit authorship contribution statement alessandro amaranto conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization francesca pianosi methodology software formal analysis investigation writing review editing visualization dimitri solomatine formal analysis investigation writing review editing gerald corzo formal analysis investigation writing review editing francisco munoz arriola conceptualization methodology formal analysis investigation resources data curation writing review editing visualization supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the support provided by the robert b daugherty water for food global institute at the university of nebraska and the university of nebraska lincoln institute of agriculture and natural resources agricultural research division some research ideas and components were also developed within the framework of the usda national institute of food and agriculture hatch project neb 21 166 accession no 1009760 and neb 21 176 accession no 1015252 and grant no 17 77 30006 of the russian science foundation post processed input data and experiments results can be founded in https github com alessandroamaranto hp sa 
5410,in the last decades advancements in computational science have greatly expanded the use of artificial neural networks anns in hydrogeology including applications on groundwater forecast variable selection extended lead times and regime specific analysis however ann model performance often omits the sensitivity to observational uncertainties in hydroclimate forcings the goal of this paper is to implement a data driven modeling framework for assessing the sensitivity of ann based groundwater forecasts to the uncertainties in observational inputs across space time and hydrological regimes the objectives are two folded the first objective is to couple an ann model with the pawn sensitivity analysis sa the second objective is to evaluate the scale and process dependent sensitivities of groundwater forecasts to hydroclimate inputs computing the sensitivity index in groundwater wells 1 across the whole time series for the global sensitivity analysis 2 across the output sub regions with conditions of water deficit and water surplus for the regional sensitivity analysis and 3 at each time step for the time varying sensitivity analysis the implementation of the ann pawn occurs in 68 wells across the northern high plains aquifer usa with pre time step rainfall evapotranspiration snowmelt streamflow and groundwater measurements as inputs results show that evapotranspiration and rainfall are the major sources of uncertainty with the latter being particularly relevant in water surplus conditions and the former in water deficit conditions the time varying sensitivity analysis leads to the identification of localized sensitivities to other sources of uncertainty as snowmelt in spring or river flow during the annual peak period at the groundwater level keywords groundwater forecasts artificial neural network uncertainty sensitivity analysis 1 introduction in the past century the growing access to pumping technologies and aquifer mapping has evidenced the role groundwater gw plays in securing food production and sustaining population growth konikow and kendy 2005 agriculture consumes about 90 of the world s green water and about 40 of irrigated water comes from groundwater withdrawals aeschbach hertig and gleeson 2012 the pressure exerted on global groundwater storage has led to global aquifers depletion at rates of about 283 km3y 1 pokhrel et al 2012 a value that represents an increase of 120 for the one observed in the 1960s wada et al 2010 contrary to common perceptions gw depletion is not limited to arid and semi arid regions but also occurs in humid areas of the world one of the best documented cases is the high plains aquifer hpa in the united states the hpa located in a temperate subtropical area has lost about 250 km3 of water in the past 60 years corresponding to about 8 of the initial storage scanlon et al 2012 thus effective water management is an unavoidable task which could be achieved through a range of mechanisms such as improved crop water use efficiency kukal and irmak 2017 irrigation scheduling kang et al 2000 and reservoir operation optimization galelli and soncini sessa 2010 in irrigated agriculture water resources re allocations are typically planned semi seasonally or seasonally with the aim of optimizing water use efficiency maintaining soil field capacity and sustaining water systems amaranto et al 2019 hence the successful implementation of seasonal water management strategies and irrigation scheduling relies on the ability to anticipate the future state of the gw system in response to various hydro climatic and anthropogenic factors coppola et al 2005 data driven models ddms can be used for such forecasting purposes ddms are well recognized techniques that extract the input output relationship from data without requiring the complete characterization of a system developments of computational sciences have greatly expanded their application domain to hydrogeological systems and ddms have been used successfully for groundwater forecasts in many studies one of the first applications of ddms was implemented by coulibaly et al 2001 who tested and compared different ann architectures for groundwater forecasting in burkina faso a few years later daliakopoulos et al 2005 investigated the most suitable ann architecture for predicting the gw level finding that the most accurate model was a standard feed forward neural network more recent studies include tapoglou et al 2014 who simulated groundwater level variations across the isar river using a combination of ann and kriging bavaria germany they found that this hybrid approach can be used successfully in aquifers where the hydrogeological information is constrained mohanty et al 2015 used ann to simultaneously forecast the weekly groundwater level at multiple sites up to a maximum of a month they found a significant decrease in performance for an increase in lead time barzegar et al 2017 compared the ability of wavelet group data handling and extreme learning machines to forecast gw level three months ahead concluding that the best performances can be obtained by the latter guzman et al 2017 and wunsch et al 2018 forecasted daily gw level variations in a well in the mississippi river valley aquifer and germany by using nonlinear autoregressive neural networks narx their results showed the potential of narx to predict gw levels effectively amaranto et al 2018 compared the ability of five different ddms to forecast seasonal 1 to 4 month gw levels across hydrological regimes they found that the error of all the ddms increased during intra seasonal water deficits amaranto et al 2019 implemented an artificial neural network instance based learning framework called multi model combination mumoc to forecast gw levels in three hundred wells across the high plains aquifer in response to irrigation demands and hydro climatic inputs the implementation of mumoc led to finding that modeling performances were strongly affected by precipitation and evapotranspiration and that mumoc outperformed and artificial neural network model in a single well especially in areas where observations were abundant nonetheless ddms do not require a complete hydrogeological characterization of the gw system the performance of for example ann models is sensitive to input measurements such discrepancies in the inputs can be attributed to operational errors systematic bias the geographical distance between weather stations and the monitoring wells or the combination of the factors above these observational uncertainties propagate through the model leading to a decrease in predicting accuracy or a problematic interpretation of the results the latter is more ddm specific given their intrinsic black box nature in areas where gw is used for irrigation supply and water allocation is scheduled ahead of time according to the projected water availability it is critical to understand the dominant drivers of the gw model s dynamics in other words it is crucial to identify which variables need to be known with higher accuracy and what effects the uncertainties of those variables have on the model outputs and forecast errors thus assessing the sensitivity of forecasting accuracy to observational uncertainty still represents a significant challenge for modelers and water managers which can be addressed by global sensitivity analysis gsa techniques modeling results might also be sensitive to different observational uncertainties i e for different inputs in different hydrogeological conditions corzo and solomatine 2007 a separate sensitivity analysis per each regime hereafter referred to as regional sensitivity analysis is recommended usually global sensitivity analysis methods use performance metrics aggregated over the whole simulation time series which might lead to a significant loss of information regarding local behavior that might be of great interest pianosi et al 2015 aggregating and performing sa at each time step time varying sensitivity analysis tvsa is a viable option for recovering significant sensitivity to input uncertainty at specific instants in time the goal for this study is to implement a framework for assessing a data driven groundwater forecast one month sensitivity to multiple observational uncertainties in hydroclimate inputs rainfall evapotranspiration snowmelt river flow and groundwater measurements across space and time and for different hydrological regimes the objectives are two folded the first objective is to develop an ann based full fledged framework including an input variable lag selection and then we couple it with the global sa method called pawn pianosi and wagener 2015 the second objective is to evaluate the scale and process dependent sensitivities of groundwater forecasts to hydroclimate inputs computing the sensitivity index in groundwater wells 1 across the whole time series for the global sensitivity analysis 2 across the output sub regions with conditions of water deficit and water surplus for the regional sensitivity analysis and 3 at each time step for the time varying sensitivity analysis the testbeds for the current experiment are 68 wells across the northern high plains aquifer the authors carried deterministic analyses to characterize the spatial distribution of the error in groundwater forecasts in a previous study amaranto et al 2019 which is not further discussed in this manuscript 2 methodology 2 1 methodological framework to achieve the objectives described above we apply the methodological framework outlined in fig 1 to each of the wells selected for the analysis in the first step the hydroclimatic data rainfall evapotranspiration river discharge snowmelt and groundwater level data are divided into training and test sets data division here we optimize the split between the training set and the test set to ensure that both sets fit approximately the same statistical distribution using the training and test average and standard deviation as optimization criteria then the training minimum and maximum are used to normalize the data between 0 and 1 data transformation to select the most relevant lag times we apply a model based input variable selection ivs procedure using artificial neural networks as models to the training set the training set is then further split into a proper training set and a cross validation set this procedure referred here as cross validation is implemented to optimize the number of nodes in the ann hidden layer using the rmse in the cross validation set as criteria to be minimized unlike traditional applications of data driven models the test set is not just used to test the performance of the model but also to evaluate the sensitivity of the model s accuracy to input uncertainty to implement this approach we characterize each of the sources of uncertainty and then we perform several perturbations on each of the inputs time series in the test set accordingly the perturbed input data are then iteratively sampled following a density based sensitivity analysis scheme proposed by pianosi and wagener 2015 called pawn pawn uses the difference between the conditional and the unconditional distributions of the output metric rmse in our case to measure the sensitivity to different uncertain inputs for each input combination sample the ann model is run and the rmse on the test set is used to evaluate the model s performance then the difference between the unconditional and conditional distributions of the rmse is used to compute the pawn sensitivity indices in three conditions first to assess the overall effect of data uncertainties on model performance the pawn indices are computed for the rmse calculated over the whole time series in each of the 68 wells under analysis second to estimate the impact of data uncertainties in water deficit and surplus conditions the pawn indices are computed for the rmse of the data points below the 10 quantile of the water level hydrograph deficit and above the 90 quantile surplus see amaranto et al 2018 for a more detailed description finally to assess how the relative influence of different variables changes over time we compute the pawn indices for the rmse evaluated at each time step with a moving window centered around the time step itself since the number of output time series in this paper is one per well 68 in total for simplicity the time varying sa analysis is limited to two representative groundwater level time series further details about each of the blocks in fig 1 are provided in the following sections 2 2 data division and transformation to assure that data come from the same population bhattacharya et al 2007 the theory of ddm requires the statistical distributions of the training and the test sets to be approximately the same first we implement an iterative process of random selection to achieve the statistical homogeneity between the training and test sets then we compare their distributions and select the split providing the closest statistical distribution one drawback of this procedure is the inability to reproduce modeling results in consequence we chose to constrain the iterative randomization of the splits by limiting the search of the test set only to consecutive years corresponding to 30 of the total number of time steps for example if we are supposed to have 30 years of data the first nine years of the data are selected as the test set and the remaining 21 years of data as the training set the statistical distributions of the two sets are compared using their mean and standard deviation and the result is stored in the second iteration the test set is composed of the second to tenth year time steps and so on the maximum statistical similarity is ensured by choosing the split s s that satisfies the following rule 1 s a r g m i n s μ r s 1 2 σ r s 1 2 where where μ r and σ r are the ratios between means and standard deviations of the training and the testing set outputs after normalization respectively and the optimal split s s is selected by solving the eq 1 through an exhaustive search procedure after selecting the optimum split the minimum and the maximum of the training set are used to normalize the data in the interval 0 1 2 3 selection of lags for the input variables in building ddms a key step consists in the selection of relevant and adequately lagged input variables a procedure commonly referred to as input variable selection ivs often this is done by exhaustively testing all the possible combinations of properly lagged variables however due to the often high number of candidates the ivs procedure frequently becomes an optimization problem aimed at minimizing the trade off between being computationally efficient i e testing the least possible number of combinations and finding the best input candidate i e testing them all several studies have tried to address this problem among them a genetic algorithm and general regression neural network gagrnn proposed by bowden et al 2005 a tree based iterative search method developed by galelli and castelletti 2013 and a partial mutual information based algorithm may et al 2008 elshorbagy et al 2010a a good variety of ivs methods is available in the literature see for example galelli et al 2014 for a review considering our objective to evaluate the sensitivity of the groundwater forecasts to the uncertainties in the inputs we include all the candidate input variables once in this study then the problem is limited to selecting the proper lag for each input rainfall evapotranspiration river discharge and snowmelt to select the optimal lag for each variable we perform a constrained ann based exhaustive search ces the ces algorithm iteratively tests any possible lag combination among the variables each of them taken at one specific lag at the time in other words considering the four inputs mentioned above and four lags from t to t 4 per input the ces generates 256 44 potential input candidates each candidate includes rainfall evapotranspiration snowmelt and streamflow only referred to as flow from here on once in a lag going from t to t 4 for what concerns the fifth input current groundwater level we use only the last groundwater observation available gw t this choice is based on the fact that for this specific input the lag 1 was the one maximizing the average mutual information with the model s output gw t 1 for each of the candidates an ann model is fitted on the training set the rmse in the cross validation set was selected as optimization objective to be minimized in the search of the best input subset 2 4 artificial neural networks multilayer perceptron mlp haykin 2004 neural networks are a machine learning technique that has been widely used in water related studies see for example elshorbagy et al 2010b abrahart et al 2012 an mlp consists in an input layer a hidden layer and an output layer the first has the sole purpose of distributing the inputs further the nodes in the hidden layer usually depend on the complexity of the system analyzed but also on the number of input neurons the number of nodes in the output layer is often one or equal to the number of outputs the connections between layers are associated with weights w a sigmoidal transfer function in the nodes of the hidden and often of the output layer s ensures the nonlinearity of the mlp 2 5 characterization of the sources of uncertainty one of the objectives of this study is to assess the relative contribution of the uncertainties of the inputs on the accuracy of a data driven model hence the uncertainties in the observational inputs are divided into five categories 1 the uncertainty in the rainfall observations 2 the uncertainty in the evapotranspiration time series 3 the uncertainty in snowmelt observations 4 the uncertainty in streamflow time series and 5 the uncertainty in groundwater level observations used to both feed the model autoregressive input and evaluate it output data uncertainty here is treated similarly as in pianosi and wagener 2015 in particular rainfall uncertainty was characterized assuming that the measurement error is multiplicative and the extent of the error changes differently in every rainfall event this procedure called storm dependent rainfall depth multiplier was first proposed and adopted by kavetski et al 2003 2006 we assume a maximum observational rainfall error of 40 therefore the corresponding storm dependent multipliers are extracted by a uniform distribution within the range 0 6 1 4 for evapotranspiration and snowmelt error we assume a constant multiplier through the whole time series drawing it from a uniform distribution over 0 7 1 3 i e assuming a maximum error of 30 these error percentages were decided by computing the average monthly coefficient of variation with respect to the climatology defined here as the monthly cyclostationary average an additive error model was used to perturbing the flow data here the errors are represented by a zero mean autocorrelated heteroscedastic gaussian process hgp the variance of the error model is considered linearly dependent on the flow schoups and vrugt 2010 the two parameters of this model are set to maintain the maximum error in flow observations at 20 in 99 of the cases groundwater observations time series were treated similarly but the hgp was fitted to the groundwater variations rather than to the measurements themselves to ensure that the measurement error is proportional to the difference in hydraulic head change and not to its absolute value 2 6 evaluation scheme to evaluate the contribution of each input to the performance of the model we use three different aggregation schemes of the forecasting errors first to identify the global contribution of the various inputs over time in each well in the study area we compute the root mean squared error rmse over the whole time series second to assess the input importance in different hydrological conditions we compute the rmse over the region of the water levels above the upper 90 and below the lower 10 quantile of the water level hydrograph finally to assess the temporal evolution of the inputs relative influence we compute the rmse at each time step over a moving window centered on that time step 2 rmse t 1 2 w 1 k t w t w gw k sim gw k obs 2 where w is the semi length of the moving window t is the time step on which the window is centered and gw k sim and gw k obs are respectively the simulated and observed groundwater levels on day k 2 7 the pawn sensitivity analysis to assess the relative contribution of each input to the accuracy of the forecasts we use a distribution based sensitivity analysis method proposed by pianosi and wagener 2015 and called pawn the choice of this particular sensitivity method lies in its easy applicability to nonlinear models and its independence from the type of output distributions for example symmetric multimodal or highly skewed furthermore it has shown to provide robust results for a relatively low sample size zadeh et al 2017 pianosi and wagener 2016 as other distribution based methods pawn measures the sensitivity of the output y the rmse in our case to variations of an input x i the time series of a particular hydrometeorological variable by the distance between the unconditional distribution of y obtained by varying all the inputs and the conditional distribution obtained when all the inputs change but x i here the conditional and unconditional distributions are approximated by their empirical distribution functions the distance between distributions is measured by the kolmogorov smirnov statistic computed as follows 3 k s x i max y f y y f y x i y x i where f y y is the empirical unconditional distribution of y and f y x i y x i is the empirical conditional distribution of y when the ith input is kept fixed at the nominal value x i since ks is dependent on such nominal value the pawn method considers ks statistics over a prescribed number of nominal values and then extracts their maximum as follows 4 s i max x i k s x i by definition all the ks x i values and consequently the sensitivity indices s i vary in the range 0 1 the closer the unconditional distribution f y y is to the conditional ones f y x i y x i the smaller the ks x i values and therefore the smaller the sensitivity of y to x i and vice versa 3 experimental setup 3 1 artificial neural networks to maximize the forecast performance it is important to optimize the number of nodes in the hidden layer of the mlp here the number of neurons was selected individually in each of the 68 wells under analysis within the interval 5 17 the mlp were trained by using the resilient backpropagation algorithm using the r package rsnns bergmeir and benítez 2012 3 2 pawn as mentioned above the pawn index estimates the sensitivity of the model output to a given input by the difference between the unconditional and the conditional cumulative distribution functions cdfs of the output the unconditional cdf is approximated here by the empirical distribution of n u output samples obtained by sampling the whole input feasibility space similarly the conditional cdfs are approximated by the empirical distributions of n c output evaluations per each input these evaluations require iterative sampling all the inputs but x i which is kept fixed to a nominal value since the index is dependent on the nominal value at which x i is fixed we repeat the evaluations using n different nominal values for x i consequently being m the number of variables the total number of model evaluations required to compute the pawn indices for m inputs is n u n c n m the values of n u n c and n are fixed by trial and error to 5000 3000 and 20 respectively leading to a total number of model evaluations equal to 305 000 per well and an average confidence interval size obtained with 50 bootstraps around the sensitivity index of 0 02 the numerical implementation of the pawn sampling and evaluation for our application is schematized in fig 2 to obtain the unconditional distribution of y we randomly sample each of the input factors 5000 times each of these 5000 samples corresponds to a dataset containing one perturbed time series of rainfall evapotranspiration snowmelt discharge and current gw level these input datasets are fed iteratively into the ann model which will therefore produce 5000 time series of gw level forecasts then by comparing gw forecasts and observations we obtain 5000 realizations of the model performances i e 5000 values of rmse or 5000 rmse values at each time step in case of tvsa which are used to approximate the unconditional distribution the steps required for the numerical approximation of the conditional distributions are represented in the bottom part of fig 2 for the sake of simplicity fig 2 refers to only one of the inputs in this case rainfall but the procedure for the other inputs remains the same first we randomly sample one conditional rainfall time series then we generate 3000 random samples of the other time series and we iteratively run the model in this case the rainfall time series is fixed while snowmelt discharge evapotranspiration and gw level time series change at each of the 3000 iterations the 3000 rmse values associated with the model forecasts time series are then used to approximate the conditional distributions then we apply eq 3 to compute the ks statistic we rerun the experiment as many times as the number of conditioning values 20 in the current analysis and we compute the pawn index as in eq 4 to achieve the specific objectives of this study we compute the pawn indices for the rmse calculated over 1 the whole time series 2 water scarcity and abundance conditions and 3 at each time step using a window semi length of three months w 3 months also a six month window is tested the pawn analysis is implemented using an r adaptation of the safe toolbox pianosi et al 2015 4 material 4 1 case study and dataset the study area in the high plains aquifer hp fig 3 a extends for about 450 000 km2 the largest aquifer in the united states over eight states south dakota nebraska colorado kansas oklahoma wyoming new mexico and texas since the 1950s the aquifer has been intensively exploited by irrigation and now ranks first in the united states for groundwater withdrawal in the last 30 years water levels in the hp have shown declines of more than 30 m these declines caused a saturated thickness reduction in some areas kansas and texas in particular of more than 50 scanlon et al 2012 the total gw depletion in the hp in the past 70 years is about 8 of the total groundwater storage the area under investigation is the northern portion of the high plains fig 3b e which occupies about 37 167 000 km2 of the total aquifer area it is crossed by the platte river which drains northeast colorado southeast wyoming and central nebraska before merging into the missouri river eschner 1983 here the aquifer is constituted by unconsolidated quaternary alluvial deposits and is mainly in unsaturated conditions with total saturated thickness ranging from 400 m in the central part to less than 50 m in the west mcguire 2015 irrigation measured in terms of percentage of irrigated area ozdogan and gutman 2008 is particularly developed in the eastern part and alongside the platte river fig 3b with corn and soybeans being the most cultivated crops the irrigation system is usually a center pivot sprinkler according to wen and chen 2006 the number of registered irrigation wells grew from 1200 in 1936 to about 100 000 in 2007 serving about 85 of the state s irrigation land rainfall fig 3d follows a west to east gradient with a minimum of about 27 mm month near the border with wyoming to a maximum of about 70 mm month on the eastern side of the aquifer the maximum net recharge rate of the aquifer occurs in the east part of nebraska mainly rainfall driven and alongside the platte river and it is of about 22 mm y houston et al 2011 the contribution of the platte river to aquifer recharge is also evident from fig 3e where it is possible to observe how the area close to the river is the one characterized by the highest rise in the gw level in the past 70 years gw level increases are also frequent in the north central part of the state where low irrigation intensity and high saturated aquifer thickness might be considered the main drivers of the aquifer recharge water level decrease is particularly severe in the southeast and in the southwest monthly estimation of rainfall p mm month evapotranspiration mm month and snowmelt mm month were obtained by the global land data assimilation system gldas rodell et al 2004 with a spatial resolution of 1 8 degree latitude longitude about 15 15 km gw in meters below land surface and discharge q m3 d in the hp aquifer data were provided by the usgs 2015 we filtered the complete usgs gw database to exclude stations with an observation period of fewer than ten years of data 120 observations and missing data higher than 25 within the 1980 2018 period after the implementation of the filter 68 wells remained available for analysis fig 3c streamflow data were gathered from the stream gauges closest to the selected monitoring wells 5 results and discussion 5 1 spatial global sensitivity to data uncertainty fig 4 shows the spatial distribution of the sensitivity index for each of the five variables assessed in this study by looking at the chart and in table 1 it is easy to notice the strong impact that rainfall and evapotranspiration uncertainties have on ann performances in contrast the contribution of snowmelt is practically negligible one possible explanation for this might lie in the fact that while fig 4 shows aggregated results for the whole time series snowmelt is a phenomenon that usually occurs only a few months a year in february march and april see amaranto et al 2019 for additional elements its contribution is limited to this time frame therefore while its impact on the model s performances in a time step might be relevant its overall contribution appears to be much lower also the interaction of snowmelt with the upper soil layers is well known and it is unlikely that in locations where the aquifer is deeper this variable might have any influence on groundwater dynamics fig 5 shows the variables producing the highest and the second highest value of the pawn index in each of the wells analyzed analyzing fig 4 fig 5 and table 1 one can see that overall evapotranspiration μpawn 0 56 rainfall μpawn 0 49 and river flow μpawn 0 3 are the three dominant variables governing model performances in particular evapotranspiration was the most relevant variable in 37 wells 54 of the cases and the second most relevant in another 19 wells 27 of the total followed by rainfall the most pertinent input in 21 wells 31 of the whole and the second most relevant in 30 40 of the total and river flow most relevant input in 9 wells 13 of the total second most appropriate in 12 wells 17 of the total by comparing fig 5 and fig 3b we see that evapotranspiration uncertainties seem to mainly affect the performance of the models in regions where irrigation intensity is higher orange and red areas in fig 3b the influence of flows can be more robust near rivers but flow measurement stations were not always available near wells to effectively couple the discharge time series with the groundwater levels on the other hand the influence of rainfall on groundwater level changes can be particularly relevant along the platte river 5 2 regional sensitivity analysis for water availability regimes fig 6 shows the input variables responsible for the highest uncertainty in forecasts during water surplus left panel and water deficit right panel conditions by looking at the figure on the left one can notice the increased relevance of snowmelt rainfall and flow this close relationship between surface water based variables and groundwater levels is probably because the upper quantile corresponds to the hydrograph section associated with the water level peak usually occurring between february and april during those months snowmelt occurs and recharges the aquifer as a consequence snowmelt becomes the most relevant input variable in water abundance conditions in six of the wells under analysis a situation in which the overall sensitivity analysis never occurred march and april are also the months when maximum rainfall usually occurs and when forecast sensitivity to precipitation uncertainty is the most relevant in 26 of the wells besides the higher water level in the upper quantile favors river seepage which is inversely proportional to the distance between river sediment and groundwater level and consequently sensitivity to flow data uncertainty increases with flow being the most important source of uncertainty in 16 wells as expected the left panel in fig 6 also shows how relevant is the decrease in evapotranspiration when there is a water surplus for example the relationship between evapotranspiration and crop water demand and it is maximum during the crop growing season is more evident later on in the year causing a significant intra annual water level depletion at the same time fig 6 shows how evapotranspiration is by far the primary source of forecast uncertainty in the lower quantile of the water level hydrograph overall 44 out of the 68 wells about 65 of the total wells assessed had et associated with the highest pawn value as stated above et is at its maximum during the crop growing season when significant gw depletions also occur in particular and as we will see in the following sections the peak in et usually occurs in august which is also the month corresponding to the yearly minimum in groundwater level and the maximum drawdown consequently uncertainty in evapotranspiration inputs can propagate from et to the forecasts of groundwater levels this propagation is more evident during months in the lower quantile and when the forecast sensitivity to evapotranspiration becomes the most relevant among all inputs analyzed in this study 5 3 time varying sensitivity to input data uncertainty regarding the temporal variability of the pawn index fig 7 shows the time series february 1991 october 2001 of the gw level red line in the plot and the pawn index grayscale rectangles in one of the monitoring wells mw1 red box in fig 5a the location of mw1 is near the lower republican river in the southern part of nebraska fig 3c in mw1 the aquifer is relatively shallow the average groundwater depth is 2 m allowing surface water and groundwater to interact the initial portion of the time series shows a keen sensitivity of flow observational uncertainties on modeling error with flow influence being particularly relevant during the rising limb of the water table level hydrograph as can be seen in the figure snowmelt has a periodical control with peaks on the pawn index regularly occurring between february and april when snowmelt occurs this influence seems to confirm the previous finding that despite the low overall sensitivity to snowmelt there are instances in time when this variable at least marginally influences modeling performances however snowmelt influence dissipates in the second half of the time series from 1997 when the pattern in groundwater levels also changes staring in 1997 groundwater depletion during the growing season appears to be much more acute on average five times greater than the depletion rates occurring between 1991 and 1996 this increased depletion might cause groundwater level changes occurring deeper from the surface in the spring reducing the effect of snowmelt on the model error at the same time the model exhibits an increase in the sensitivity to evapotranspiration during the crop growing season the best possible explanation for this period is an increase in groundwater use for irrigation in essence crop irrigation requirements and consequently evapotranspiration govern the groundwater variability in the season when irrigation takes place hence an increase in irrigation water use might lead to more considerable influence of evapotranspiration uncertainties on modeling performances fig 8 shows the time varying pawn index for mw2 in the blue box of fig 5a as in mw1 snowmelt likely influences the strong seasonality in the figure however unlike in the previous case the influence of river flow on mw2 appears to be more seasonal rather than a continuous effect along with the time series the deeper water level might explain this effect in mw2 which varies from a minimum of about 10 m in march and april to a maximum of about 19 m in august and september in comparison to mw1 s shallow groundwater level the only time when any interaction between the surface water and groundwater emerges is when the spring recharge might be responsible for bringing the water table level closer to the surface practically no interaction between the two occurs through the rest of the year in the case of mw2 the performance of the model looks to be entirely driven by rainfall and evapotranspiration with the latter showing an increasing influence in the second portion of the time series between march 2000 and december 2005 as in the previous case the increased influence of evapotranspiration coincides with much deeper water tables during the growing season for instance after the summer of 2000 the water level experienced a drastic depletion in the water table during summer which decreased the autumn spring recovery typically observed in the previous five years furthermore the water level starts showing a low depletion trend during which the influence of rainfall decreases and the influence of evapotranspiration consistently increases 5 3 1 effect of changing the window size fig 9 illustrates an unclear increase in the window in mw2 for the sensitivity of groundwater changes to rainfall and evapotranspiration when w 6 months the time series has two sections one section 1995 2000 predominantly rainfall driven and another section 2000 2005 evapotranspiration driven also fig 9 indicates that the effect of snowmelt and flow becomes practically negligible throughout the time series this result might be explained by the fact that both variables have a significant impact on modeling results only for limited and specific times the effect of flow was relevant only around march april while the snowmelt effect was detectable only around february march these months also correspond to the only time of the year when snowmelt 2 mm day is comparable to rainfall 1 8 mm day by increasing the window length the estimated sensitivity index for those months contrasts with the low sensitivity obtained in the months before february and after april thus an apparent combination of conditions makes the contribution of flow and snowmelt practically undetectable at the same time rainfall and evapotranspiration lead to a more regular sensitivity index characterized by fewer variations between one time step and the following in essence drastic changes in the pawn index such as the one occurring for evapotranspiration in march and april 2007 or the one for rainfall in march 2000 are attenuated and become practically negligible 6 conclusions in this study we implemented a sa framework to better understand the sensitivity of ann errors to input observational uncertainties in groundwater forecast as a product of the coupling ann sa we conclude the following overall evapotranspiration μpawn 0 56 and rainfall μpawn 0 49 were the most relevant inputs in particular evapotranspiration appeared to be particularly relevant in areas with higher irrigation intensity whereas the rainfall effect was detectable especially in the platte river area modeling errors were not sensitive to the groundwater level measurement error in any of the case studies results for flow were difficult to interpret since flow stations were unavailable for coupling with the time series at all 68 wells however the flow effect was higher in the geographic proximity to the platte and lower republican rivers the contribution of snowmelt to the changes in groundwater levels was practically negligible across the studied area average pawn index 0 12 two factors might drive this effect the first factor is that snowmelt occurs one to two months in any given year and the second factor is that the performance of the model might be relevant in a single time step but the effect is much lower throughout the whole time series regional sa results showed that evapotranspiration is the most relevant variable in water scarcity conditions 10 quantile of the water level hydrograph it showed in fact to dominate the error dynamics in about 65 of the wells in the study area in contrast rainfall was the most important in water surplus 90 quantile being the major sources of uncertainty in 40 of the analyzed wells sensitivity to snowmelt and flow also showed an increase in the upper quantile the time varying sa was able to register information that otherwise would have been lost by applying sa to the whole time series for example the analysis of the constrained window shows that the effect of snowmelt is significant at the beginning of spring with peaks of sensitivity index up to 0 62 also evapotranspiration proved influential in seasons when the groundwater depletion was particularly severe while at other times flow or rainfall was the most relevant variables increasing the window size led to less variability in the results and consequently to a less qualitative interpretation additionally it hides potentially relevant information such as the effect of snowmelt and river seepage in the spring in summary the present study evidence how complex phenomena govern the ann ability to predict gw availability in irrigated areas in the land surface and the subsurface and across different spatial hydrological and temporal scales accurate estimations of evapotranspiration are critical since it was identified as the primary source of uncertainty in the forecast of groundwater levels furthermore regional and time varying sensitivity analyses tailored for specific water regimes were able to identify the importance of other forcing inputs e g rainfall in water surplus and snowmelt at the beginning of the year which could not be captured when those errors were averaged over the entire time series these analyses are recommended in order to raise awareness of the multiple sources of uncertainty and their roles in governing specific hydrological conditions and during particular periods 7 limitations and future recommendations this study is limited by the lack of real world pumping data which were not available for the case study area and by the use of proxies such as evapotranspiration to simulate crop water requirements using pumping data would have provided more information on how human intervention shapes model performance furthermore the selection of the feasibility space for the perturbed input was empirically established when possible this choice should be made based on information about the error available perhaps from local institutions the analyses of the tvsa indicate how a different window convey different information a suggestion is to investigate various sizes to capture the full range of sensitivities across time scales also sa results might be sensitive to the choice of the model here we used artificial neural networks to forecast gw levels and gsa to estimate the effect of data uncertainty on the model s performance the choice of a different model perhaps physically based might lead to different results the use of a physically based model coupled with an analysis not based on error metrics such as the presented here might likewise provide insights on how the physical system and not the model s error is sensitive to uncertainties in forcings and parameters therefore further research on coupling physically and data driven models should might lead estimate the contributions of the multiple sources of uncertainty in sub seasonal forecasts of groundwater levels credit authorship contribution statement alessandro amaranto conceptualization methodology software validation formal analysis investigation data curation writing original draft visualization francesca pianosi methodology software formal analysis investigation writing review editing visualization dimitri solomatine formal analysis investigation writing review editing gerald corzo formal analysis investigation writing review editing francisco munoz arriola conceptualization methodology formal analysis investigation resources data curation writing review editing visualization supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the support provided by the robert b daugherty water for food global institute at the university of nebraska and the university of nebraska lincoln institute of agriculture and natural resources agricultural research division some research ideas and components were also developed within the framework of the usda national institute of food and agriculture hatch project neb 21 166 accession no 1009760 and neb 21 176 accession no 1015252 and grant no 17 77 30006 of the russian science foundation post processed input data and experiments results can be founded in https github com alessandroamaranto hp sa 
5411,data assimilation is well suited for merging observed and simulated values to improve hydrologic forecasts typically observation data that is assimilated into hydrologic models can be obtained from in situ gauges radar and remote sensing in an urban environment the benefits of soil moisture assimilation are not clearly defined this work aims to identify the feasible imperviousness range at which it is advantageous to assimilate remotely sensed soil moisture to improve hydrologic forecasting in an urban watershed a synthetic experiment was set up to simulate the retrieval of soil moisture onto a spatial grid and assimilate it into a hydrologic model sub catchments were set up such that they would represent areas within that retrieval grid with varying levels of development multiple rainfall events were simulated with forecasts of up to 12 hours for each sub catchment the results of these simulations indicate that when areal average soil moisture is assimilated into an urban sub catchment model which has a level of impervious that exceeds a threshold value there is a decrease in model forecast performance indicating that soil moisture assimilation is no longer beneficial a quick way to determine the imperviousness threshold was then derived using a modified nrcs cn method which matches the results of the synthetic experiments this methodology was then further tested using real world urban watersheds and shown to be a valid approach that can be used to quickly determine whether soil moisture assimilation would be beneficial for the watershed of interest in general this work has shown that hydrologic forecasting in an urban watershed can benefit from soil moisture assimilation even when imperviousness reaches 65 75 additionally this work found a quick way to validate further if soil moisture assimilation is beneficial using some simple watershed characteristics 1 introduction in hydrologic modeling data assimilation methods are used to assimilate observation data obtained from in situ gauges or remote sensing methods into models to improve state and parameter estimates for better forecasts moradkhani 2008 moradkhani et al 2005a 2005b reichle 2008 there are several data assimilation methods which have been used with hydrologic models to improve forecasts some common ones being the extended kalman filter sun et al 2015 wishner et al 1969 the ensemble kalman filter enkf evensen 1994 thiboult and anctil 2015 vrugt et al 2006 and the particle filter dechant and moradkhani 2014 gordon et al 1993 moradkhani et al 2005a each assimilation method has been shown to improve forecasts by integrating available observations into the model while also accounting for uncertainty in both the observations and the model remote sensing techniques can provide informative variables for hydrologic modeling such as snow depth snow water equivalent and soil moisture andreadis and lettenmaier 2006 moradkhani 2008 remote sensing soil moisture data products are available from satellite missions such as the advanced microwave scanning radiometer for earth observation science amsr e njoku et al 2003 the advanced scatterometer ascat bartalis et al 2007 the soil moisture active passive smap entekhabi et al 2008 and the soil moisture and ocean salinity smos kerr et al 2010 remotely sensed soil moisture data sets for example have been used in many data assimilation studies and have been shown to improve hydrologic forecasts alvarez garreton et al 2015 dziubanski and franz 2016 leach et al 2018 moradkhani 2008 these studies have focused on the assimilation of soil moisture into large and or rural basins with little urban development where they found that soil moisture assimilation can improve hydrologic model performance alvarez garreton et al 2015 leroux et al 2016 massari et al 2015 and combined streamflow and soil moisture assimilation can reduce bias and improve performance of modeled soil moisture lee et al 2011 samuel et al 2014 however they have rarely been used to improve urban hydrologic forecasting leach et al 2018 soil moisture plays an important role in the hydrologic cycle by controlling the partition between runoff and infiltration kornelsen and coulibaly 2014 moradkhani 2008 antecedent soil moisture can directly influence surface runoff and by properly accounting for the antecedent soil moisture conditions rainfall runoff modeling can be improved nishat et al 2010 however antecedent soil moisture has also been shown to have less influence in urban watersheds for small precipitation events when runoff is dominated by the impervious area s contribution boyd et al 1993 miller and viessman 1972 and large events where the rainfall volume dominates the runoff nishat et al 2010 these studies then indicate that there is a range of storm events which could be better simulated through better quantification of the soil moisture in an urban watershed the role of soil moisture in rainfall runoff modeling is often under valued in urban areas due to the influence of impervious surfaces the lack of studies which investigate the assimilation of soil moisture within urban catchments can likely be attributed to the level of impervious surfaces within those watersheds however even in highly urbanized watersheds soil moisture assimilation has been shown to improve hydrologic forecasts leach et al 2018 this is possible since watersheds considered highly urbanized still have pervious areas in which antecedent soil moisture conditions have influence these areas can easily be revealed through image analysis such as spectrally unmixing multi band earth images like those available from the landsat missions the work presented here will attempt to identify a potential limiting threshold for the level of development imperviousness which will aid in determining whether it is useful to assimilate soil moisture data when modeling an urban watershed to our knowledge this has not been done previously for the analysis herein the enkf data assimilation method was chosen due to its relative simplicity and ease of use a synthetic experiment was used to represent the assimilation of remotely sensed soil moisture into similar watersheds with various levels of development this synthetic experiment aided in identifying the limiting imperviousness threshold and in developing an efficient method for identifying the threshold using available information about the watershed the experiment is meant to emulate urban catchments which can vary widely in their levels of development the goal of this work is to determine the impact that the percent of impervious surface in a watershed has on soil moisture assimilation and at what impervious percentage threshold the impact occurs this threshold identification method will then be applied to selected real world watersheds to aid in validating its accuracy and generalizability 2 methodology 2 1 hydrologic models 2 1 1 storm water management model the storm water management model swmm was used for this study swmm is an established semi distributed model for event based and continuous simulation in semi urban and urban watersheds within swmm sub catchments are represented by a non linear reservoir model and runoff is solved for through conservation of mass and the manning equation 1 d t i e f q 2 q 1 49 w s 1 2 an d d s 5 3 where d is the depth t is the timestep i is the rate of rainfall and snowmelt e is the surface evaporation rate f is the infiltration rate q is the runoff rate w is the characteristic width s is the average slope a is the surface area of the sub catchment n is the surface roughness and ds is the depression storage swmm sub catchments are also partitioned into sub areas of pervious surface or impervious surface with or without depression storage which can also be subject to flow re routing in which some fraction of runoff from one sub area gets routed through the other there are also multiple infiltration methods available for use within swmm green ampt was used for this study an optional two layer groundwater component unsaturated upper zone and saturated lower zone and an optional three layer snowmelt component plowable snow pervious area snow and impervious area snow the interested reader can find more information on swmm from rossman and huber 2016 2 1 2 nrcs curve number the natural resources conservation service nrcs curve number cn method is an empirical model that relates precipitation volume to direct runoff it can be defined through the following equations nrcs 2004 3 s 25400 cn 254 4 i a c s 5 q r i a 2 r i a s r i a 0 r i a where s is the maximum potential soil moisture storage mm ia is the initial abstraction mm c is the ratio of ia to s and has been shown to range from 0 05 to 0 2 for this study 0 1 was used lim et al 2006 cn is the nrcs curve number which is an empirical parameter related to soil type and land use r is the rainfall and snowmelt volume mm and q is the direct runoff mm the cn model was set up to be analogous to how sub areas are partitioned in swmm sub catchments fig 1 b instead of having one model with a cn being the weighted average of the impervious and pervious areas two nrcs cn models were created where the cn for the impervious area was 95 and the cn for the pervious area was 50 this set up was chosen so that the internal routing from the impervious to the pervious area could be accounted for the direct runoff from the pervious sub area would then be a function of the routed runoff from the impervious sub area and the total runoff that leaves the watershed is the sum of the direct runoff from the pervious sub area and the non routed direct runoff from the impervious sub area 2 2 the ensemble kalman filter since it is a conventional data assimilation method and due to its relative ease of implementation the ensemble kalman filter enkf evensen 2003 1994 was used for these analyses the general formulations of the enkf for state updating are as follows evensen 2003 moradkhani et al 2005b 6 p t b x t b x t b x t b x t b t n 1 7 q t h t x t b x t b y t y t 8 p t b h t t x t b x t b n 1 q t t σ t x y c o v x t y t 9 h t p t b h t t q t q t t n 1 σ t y y c o v y t y t 10 k t p t b h t t h t p t b h t t r t 1 σ t x y σ t y y r t 1 11 x j t a x j t b k t y t ε j t y j t where n is the number of ensemble members j subscript is the ensemble member t superscript is the transpose operator h is the observation operator t subscript the time step x is the state estimate x is the state vector k is the kalman gain b superscript is the background estimate a superscript is the analysis estimate pb is the background covariance matrix r is the observation uncertainty y is the observation being assimilated y is the simulated observation y is the simulated observation vector and ε is zero mean random noise these equations are repeated every time step that observations are available for assimilation until the final time step has been reached for these analyses the assimilated observation was the areal average soil moisture and it was used to update the swmm s states whenever observations were available 2 3 experiment design two experiments were set up to develop a quick method for determining the limiting imperviousness threshold of a sub catchment at which soil moisture assimilation would be no longer beneficial the first experiment used synthetic watersheds in swmm to evaluate the method under ideal conditions and then a surrogate model was created using the nrcs cn method which could be quickly used to identify the imperviousness threshold using simple watershed characteristics the second experiment involved modeling real watersheds using swmm assimilating smos l2 soil moisture into swmm using the enkf and then checking if the surrogate model threshold value would be consistent with them as well 2 3 1 synthetic experiment the synthetic data assimilation experiment was used to explore the benefit of assimilating remotely sensed areal average soil moisture data for use in event forecasting synthetic soil moisture was generated to represent retrieved soil moisture values similar to those from ascat smap or smos data retrieved through remote sensing methods are mapped to regular discrete global grids dgg bartalis et al 2007 entekhabi et al 2008 kerr et al 2012 2010 wagner et al 1999 the icosahedral snyder equal area isea grid being one of them for example the smos data retrievals are mapped onto the isea4h9 grid which is a 15 km hexagonal dgg illustrated in fig 1 is an example of a hexagonal dgg as well as a simple example of how the imperviousness of a watershed could vary within a grid cell the synthetic areal average soil moisture generated for these analyses are meant to emulate this type of retrieved data since it has been shown that the smos data can be directly used on the 15 km dgg despite the spatial discrepancy between the grid and the instrument s resolution al bitar et al 2012 dumedah et al 2014 kerr et al 2010 the experiment was meant to simulate the areal average soil moisture that would be retrieved over some urban area two synthetic test basins of different sizes were developed for these analyses test basin 1 tb1 has an area similar to a small town whereas test basin 2 tb2 was set to have the area of an average neighborhood each test basin had 20 near identical sub catchments within them where each sub catchment contains a different level of development represented as their impervious percentage fig 1a the test basins were also set up to have different aquifer characteristics with tb1 and tb2 having those of silt loam and sandy clay loam respectively the different synthetic basins were used to help show that the method applies to multiple cases the parameter values used for the synthetic urban sub catchments and their descriptions are listed in table 1 the chosen parameter values are also similar to existing urban watersheds liu et al 2013 the synthetic experiment flowchart is illustrated in fig 2 the precipitation data set used to force the models contains eight years of hourly data and was from a rain gauge located in toronto ontario this precipitation data set was chosen since it could provide real world precipitation depths event durations and inter event times by forcing the models with hourly precipitation synthetic observations of runoff and soil moisture were generated for each sub catchment in each test basin the areal average soil moisture was calculated for each test basin by taking the average of the synthetic soil moisture observations that were generated for each sub catchment the areal average soil moisture values were then perturbed to represent an observation error of 20 percent in this case only random measurement error was used since systematic errors should be removed from observations before they are assimilated reichle 2008 this average soil moisture was assimilated into the hydrologic models which were set up to represent multiple sub catchments within a retrieval grid this method was repeated with 25 50 and 75 percent of impervious runoff being routed internally to the pervious area first before contributing to total runoff to set up the assimilation experiment precipitation events were first identified for each runoff routing scheme these events were chosen by identifying high flow events that occurred ignoring the first year of generated synthetic observations this was done so that the model states would be stabilized and each storm event s synthetic runoff observations would have had at least one year of spin up doing this provided 58 67 precipitation events depending on the basin and routing scheme to account for uncertainty due to different initial conditions a data assimilation run was set up for each event that modeled a seven day window centered around each peak in which the synthetic areal average soil moisture observations were assimilated at each timestep after each assimilation step the swmm was run 12 h ahead to determine the influence that the soil moisture assimilation had on the short term forecast within the urban sub catchment additionally this forecast horizon allowed for determining how long the soil moisture assimilation would influence the predicted runoff after running the synthetic data assimilation experiment the performance of the swmm models was evaluated to determine the relationship between soil moisture assimilation in urban catchments and imperviousness this comparison was done to determine if there would be a change in performance related to catchment imperviousness the results of the swmm data assimilation runs were then further compared with the nrcs cn model to provide further insight into the results specifically the point at which model performance would change the nrcs cn model setup used here would act as a surrogate model which could then quickly identify the imperviousness threshold value using sub catchment characteristics 2 3 2 real world experiment to confirm that the synthetic experiments results and threshold method are consistent with real world data the method was then tested using several urban watersheds the 121 watersheds classified as urban in dudley et al 2019 were used for testing these watersheds had a high level of developed land cover 10 to 100 percent and low level of agricultural land cover 0 4 to 2 percent hourly streamflow data for each watershed were obtained using the r studio package dataretrieval de cicco et al 2018 the ncep cpc stage 4 precipitation dataset which contains 4 km gridded hourly data generated from gauge and radar data was used for precipitation forcing cooperative distributed interactive atmospheric catalog system et al 2000 hourly temperature was obtained from the local climatological data lcd dataset through national oceanic and atmospheric administration noaa and soil moisture observations for each watershed were the smos l2 soil moisture imperviousness percentage for each watershed was determined using the national land cover database nlcd 2016 urban imperviousness dataset yang et al 2018 the nlcd 2016 database provides impervious surface percent for the conus on 30 30 meter pixels yang et al 2018 reported that the overall agreement of land use pixel identification ranged from 70 to mid 80 in the eastern united states more specifically they reported that the pixels which identify developed areas which were used to determine the imperviousness of a pixel were mislabeled 18 to 50 of the time this uncertainty will be accounted for when calculating the imperviousness threshold for each watershed the forcing datasets were preprocessed and filtered based on their level of missing data if more than 5 of the precipitation and temperature were missing for a grid or gauge it was omitted from the analysis and if less than 5 of the data was missing it was infilled using simple linear regression the infilled data was then converted to mean areal precipitation and temperature data map and mat respectively using the thiessen polygon method the smos soil moisture data were filtered based on its probability of radio frequency interference and its data quality index values when they exceed 0 1 the data is removed kornelsen et al 2016 after filtering there were 43 urban watersheds of the original 121 that had adequate data for the experiment their locations are shown in fig 3 these watersheds range in size from 11 55 to 198 91 square kilometers falcone 2011 their level of development ranges from 10 to 100 percent dudley et al 2019 and their level of imperviousness ranges from 1 to 55 percent yang et al 2018 https www mrlc gov data each watershed was modeled using the swmm each of the real world urban watersheds was modeled in a lumped fashion within the swmm additionally unlike the synthetic swmm watershed setups the snowmelt routine was included for the real watersheds since they were calibrated by running the model continuously the parameters which were calibrated for each urban watershed are listed in table 2 the dynamically dimensioned search dds algorithm tolson and shoemaker 2007 was used to calibrate the selected urban watersheds with a calibration period of 2009 01 01 to 2011 12 31 2008 was used for spin up and a validation period of 2012 01 01 to 2014 12 31 the nash volume efficiency nve cost function was used samuel et al 2012 with modified weights placing more emphasis on peak flows 12 nve 0 3 n s e 0 1 v e 0 2 nse log 0 5 nse sqr where nse is the nash sutcliffe efficiency nash and sutcliffe 1970 ve is the volume error nselog is the nse calculated using log transformed streamflow and nsesqr is the nse calculated using squared streamflow once the watersheds were calibrated the data assimilation experiment was set up to assimilate smos l2 soil moisture into each swmm model the assimilation was performed during the same time period as the model validation for comparison the nrcs cn surrogate model was then set up for each real watershed and the results were evaluated to determine if the fast threshold identification method is consistent with real data 2 4 performance metrics to determine the impact soil moisture assimilation had on the short term forecast the following performance metrics were used the kling gupta efficiency kge gupta et al 2009 bias root mean square error rmse and mean continuous ranked probability score crps matheson and winkler 1976 better performance is indicated when bias crps and rmse approach zero and when kge approaches unity the metrics are defined as follows 13 kge 1 r 1 2 α 1 2 β 1 2 14 bias e y y 15 rmse 1 n t 1 n y t y t 2 1 2 16 c r p s f y 1 n t 1 n f y t 1 y t y t 2 d y where r is the linear correlation coefficient between the simulated and synthetic observed runoff values α is the measure of relative variability in the simulated and synthetic observed values β is the ratio between the simulated and observed values y t is the observed runoff at time t y t is the simulated streamflow at time t n is the number of time steps in the event f y t is the cumulative distribution function of the forecast and 1 y t y t is the heaviside step function that provides a value of 1 if the predicted value is larger than the observed and 0 otherwise 3 results and discussion 3 1 synthetic urban watershed results the results of the synthetic experiments where 50 of the impervious flow was routed are illustrated in figs 4 and 5 from the figures the kge bias rmse and crps are all shown to have similar performances these results show how the model performance changes with imperviousness and forecast horizon after the states are updated with areal average soil moisture figs 4 and 5 allows for visualizing how far the update s influence propagates forward in the forecast from these results it appears that there is an impervious threshold beyond which assimilating areal average soil moisture is not beneficial and may negatively impact the model s performance the results also show that when the basin is almost entirely impervious the effects on the model s performance caused by the assimilation are negligible within two hours while at lower imperviousness percentages the effects can last several hours longer these results are caused by the update increasing the water in the sub areas particularly the very high impervious subareas 95 99 by an amount larger than they can store so it instead runs off immediately causing a large but limited effect in the forecast to further analyze the results several statistical tests were performed to determine if parametric or nonparametric tests should be used to analyse the results the jarque bera jb test for normality was used the jb test showed that the results from the synthetic experiment were not normally distributed indicating that nonparametric tests should be used to further evaluate them the mann kendall mk trend test was utilized to determine if the decrease in performance was statistically significant for each forecast horizon the results of the mk test were summarized in table 3 the mk test showed that there was a significantly decreasing trend in performance as imperviousness increased on average for all the performance metrics which diminished as the forecast horizon increased this indicated that there was a decrease in performance caused when the areal average soil moisture was assimilated into basins with higher imperviousness finally the kruskal wallis kw test was used to determine at what impervious percent a significant decrease in performance was seen the kw indicated that there was a significant decrease in performance when the imperviousness was greater than 90 percent from visual inspection of the results illustrated in figs 4 and 5 the impact of the soil moisture assimilation was noticeable when the imperviousness is greater than 75 percent however the kw test showed that the soil moisture assimilation significantly impacted the performance when the imperviousness was greater than 90 percent when considering these results it is important also to note that synthetic experiments tend to have higher performances therefore this threshold should be lower than the point at which the kw test shows significant declination in performance the visual inspection of the results then led to the suggested general threshold value of 75 percent watershed imperviousness when 50 percent of impervious sub area runoff is rerouted to the pervious sub area beyond which it is not beneficial to assimilate soil moisture in an urban model the previously discussed analysis focused on the results from when 50 percent of impervious sub area runoff was first routed to the pervious sub area before contributing to total runoff of the watershed similar results are shown when that routing percentage is 25 and 75 however the thresholds are shifted to higher 85 and lower 65 imperviousness values respectively to determine the cause of the impervious threshold value and why it is shifted when the routing percentage changes a simple example was set up using the nrcs cn method the ratio of runoff from the impervious fraction qimp of a sub catchment to total runoff qtot of a watershed was determined for the different levels of connectivity of impervious to pervious sub areas within the sub catchments and for different rainfall volumes the threshold values were then found to correlate well to where the maximum of the qimp qtot ratio was as a function of imperviousness and percent routed these thresholds are illustrated with vertical lines in fig 6 beyond the threshold value the performances of the modeled events begin to degrade which is shown by the interquartile range of kge performance beginning to decline in performance beyond the thresholds these thresholds exist because the effects that soil moisture from the pervious sub area have on the total runoff are small compared to the runoff being routed to the pervious sub area from the impervious sub area of the sub catchment the larger this connection between pervious and impervious areas is the lower the impervious percent of the basin has to be before the influence of soil moisture is no longer meaningful 3 2 real urban watershed results the calibration and validation results for the real urban watersheds are summarized in fig 7 from fig 7 we see that the performance during the calibration period is similar to that of the validation period for most of the watersheds additionally we see that many of the urban watersheds were modeled by swmm reasonably well however only watersheds which obtained a minimum kge value of 0 6 were chosen for the data assimilation experiment the justification for this kge value was that the threshold method requires the routed parameter to be very well calibrated unlike for the calibration and validation periods where the performance metrics were calculated from a continuous time series the data assimilation results were evaluated based on the performance of the 12 h immediately following each soil moisture assimilation this was done so that the real world watersheds would be evaluated similarly to the synthetic watersheds and to observe how the soil moisture assimilation would influence the short term forecast illustrated in fig 8 are the predicted threshold ranges which are similar to where the qimp qtot graphs in fig 6 reach their maximum values as a function of precipitation which rarely exceeds 75 mm and routed the description of routed can be found in table 2 the percent impervious estimate was also included in this figure for comparison to the derived threshold range to account for the uncertainty in the percent impervious estimate the imperviousness was assumed to be up to 25 percent larger or smaller for each watershed this assumption was then used to determine whether there would be a negative impact when assimilating remotely sensed soil moisture into the urban watershed model evaluation of the data assimilation results to determine if there was a significant impact or not was performed as follows first the difference between the open loop model and the data assimilation results was taken for each forecast step out to 12 h next the mk test for significant trend was used to determine if there was a significantly increasing trend in those residuals which would indicate that immediately after assimilation there was a performance drop that diminished over time the predicted and actual impacts are illustrated in the confusion matrix in fig 8 from the confusion matrix we see that the overall accuracy of the method is 87 and type i errors occur 18 of the time there are no type ii errors in general the surrogate model accurately predicted all the watersheds which would be negatively impacted from assimilating remotely sensed soil moisture while also having a false discovery rate of 33 however it should be noted that the imperviousness threshold range is dependent on the routed parameter which needed to be calibrated and therefore may not be the actual value for the watershed due to equifinality there is also the assumed parameter value of c 0 1 in eq 4 which if increased or decreased will cause the threshold to shift down or up respectively finally there may be some additional uncertainties that influence the results based on the structural error of the swmm or due choosing to model each watershed as lumped instead of semi distributed these results suggest that using the surrogate nrcs cn method is a quick way to determine if assimilating remotely sensed soil moisture into an urban model will be beneficial additionally they show that there is a limiting imperviousness threshold that should be considered before using assimilating remotely sensed soil moisture data for the real world urban watersheds the general threshold is suggested to be about 65 percent imperviousness this is due to the expected precipitation event volumes which occur in the synthetic experiment the proposed threshold was about 75 percent imperviousness therefore depending on precipitation and actual basin characteristics it can be expected that the threshold of imperviousness could be in the range of 65 to 75 the implication of this work was to show that remotely sensed soil moisture data is a viable source of observational data for assimilation in urban catchments so long as those catchments do not exceed the impervious threshold this is beneficial because often models of urban catchments do not have associated streamflow gauges which can provide observations for streamflow data assimilation this allows for remotely sensed soil moisture data to be assimilated into the urban catchment model to provide more accurate states for performing a forecast 4 conclusions the results for the synthetic basin experiment identified an imperviousness threshold up to which soil moisture assimilation is useful in urban watersheds and beyond which it is not as beneficial this threshold was shown to be a function of watershed imperviousness precipitation volume and the connectivity between pervious and impervious sub areas in a watershed we found that for the synthetic case the assimilation of soil moisture had little impact on the model performance at the lower impervious levels which was to be expected since the difference between the simulated and synthetic soil moistures should be negligible it was also shown that the assimilation of areal average soil moisture when the imperviousness of the catchment was beyond the threshold value could cause the model s performance to deteriorate additionally we found that the threshold method is reasonably consistent when using real world data we conclude that in general it is feasible to assimilate areal average soil moisture data into a model of an urban watershed as long as the imperviousness of the watershed is below the threshold value of 65 impervious this threshold can then be refined further on a case by case basis if the impervious percentage of the watershed exceeds the threshold the modeler will need to adjust their assimilationstrategy for soil moisture data as it may begin to degrade model performance otherwise credit authorship contribution statement james m leach conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization paulin coulibaly resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the natural sciences and engineering research council of canada nserc canadian floodnet grant number netgp 451456 the authors would like to thank the anonymous reviewers for their comments and suggestions that have helped to improve the manuscript 
5411,data assimilation is well suited for merging observed and simulated values to improve hydrologic forecasts typically observation data that is assimilated into hydrologic models can be obtained from in situ gauges radar and remote sensing in an urban environment the benefits of soil moisture assimilation are not clearly defined this work aims to identify the feasible imperviousness range at which it is advantageous to assimilate remotely sensed soil moisture to improve hydrologic forecasting in an urban watershed a synthetic experiment was set up to simulate the retrieval of soil moisture onto a spatial grid and assimilate it into a hydrologic model sub catchments were set up such that they would represent areas within that retrieval grid with varying levels of development multiple rainfall events were simulated with forecasts of up to 12 hours for each sub catchment the results of these simulations indicate that when areal average soil moisture is assimilated into an urban sub catchment model which has a level of impervious that exceeds a threshold value there is a decrease in model forecast performance indicating that soil moisture assimilation is no longer beneficial a quick way to determine the imperviousness threshold was then derived using a modified nrcs cn method which matches the results of the synthetic experiments this methodology was then further tested using real world urban watersheds and shown to be a valid approach that can be used to quickly determine whether soil moisture assimilation would be beneficial for the watershed of interest in general this work has shown that hydrologic forecasting in an urban watershed can benefit from soil moisture assimilation even when imperviousness reaches 65 75 additionally this work found a quick way to validate further if soil moisture assimilation is beneficial using some simple watershed characteristics 1 introduction in hydrologic modeling data assimilation methods are used to assimilate observation data obtained from in situ gauges or remote sensing methods into models to improve state and parameter estimates for better forecasts moradkhani 2008 moradkhani et al 2005a 2005b reichle 2008 there are several data assimilation methods which have been used with hydrologic models to improve forecasts some common ones being the extended kalman filter sun et al 2015 wishner et al 1969 the ensemble kalman filter enkf evensen 1994 thiboult and anctil 2015 vrugt et al 2006 and the particle filter dechant and moradkhani 2014 gordon et al 1993 moradkhani et al 2005a each assimilation method has been shown to improve forecasts by integrating available observations into the model while also accounting for uncertainty in both the observations and the model remote sensing techniques can provide informative variables for hydrologic modeling such as snow depth snow water equivalent and soil moisture andreadis and lettenmaier 2006 moradkhani 2008 remote sensing soil moisture data products are available from satellite missions such as the advanced microwave scanning radiometer for earth observation science amsr e njoku et al 2003 the advanced scatterometer ascat bartalis et al 2007 the soil moisture active passive smap entekhabi et al 2008 and the soil moisture and ocean salinity smos kerr et al 2010 remotely sensed soil moisture data sets for example have been used in many data assimilation studies and have been shown to improve hydrologic forecasts alvarez garreton et al 2015 dziubanski and franz 2016 leach et al 2018 moradkhani 2008 these studies have focused on the assimilation of soil moisture into large and or rural basins with little urban development where they found that soil moisture assimilation can improve hydrologic model performance alvarez garreton et al 2015 leroux et al 2016 massari et al 2015 and combined streamflow and soil moisture assimilation can reduce bias and improve performance of modeled soil moisture lee et al 2011 samuel et al 2014 however they have rarely been used to improve urban hydrologic forecasting leach et al 2018 soil moisture plays an important role in the hydrologic cycle by controlling the partition between runoff and infiltration kornelsen and coulibaly 2014 moradkhani 2008 antecedent soil moisture can directly influence surface runoff and by properly accounting for the antecedent soil moisture conditions rainfall runoff modeling can be improved nishat et al 2010 however antecedent soil moisture has also been shown to have less influence in urban watersheds for small precipitation events when runoff is dominated by the impervious area s contribution boyd et al 1993 miller and viessman 1972 and large events where the rainfall volume dominates the runoff nishat et al 2010 these studies then indicate that there is a range of storm events which could be better simulated through better quantification of the soil moisture in an urban watershed the role of soil moisture in rainfall runoff modeling is often under valued in urban areas due to the influence of impervious surfaces the lack of studies which investigate the assimilation of soil moisture within urban catchments can likely be attributed to the level of impervious surfaces within those watersheds however even in highly urbanized watersheds soil moisture assimilation has been shown to improve hydrologic forecasts leach et al 2018 this is possible since watersheds considered highly urbanized still have pervious areas in which antecedent soil moisture conditions have influence these areas can easily be revealed through image analysis such as spectrally unmixing multi band earth images like those available from the landsat missions the work presented here will attempt to identify a potential limiting threshold for the level of development imperviousness which will aid in determining whether it is useful to assimilate soil moisture data when modeling an urban watershed to our knowledge this has not been done previously for the analysis herein the enkf data assimilation method was chosen due to its relative simplicity and ease of use a synthetic experiment was used to represent the assimilation of remotely sensed soil moisture into similar watersheds with various levels of development this synthetic experiment aided in identifying the limiting imperviousness threshold and in developing an efficient method for identifying the threshold using available information about the watershed the experiment is meant to emulate urban catchments which can vary widely in their levels of development the goal of this work is to determine the impact that the percent of impervious surface in a watershed has on soil moisture assimilation and at what impervious percentage threshold the impact occurs this threshold identification method will then be applied to selected real world watersheds to aid in validating its accuracy and generalizability 2 methodology 2 1 hydrologic models 2 1 1 storm water management model the storm water management model swmm was used for this study swmm is an established semi distributed model for event based and continuous simulation in semi urban and urban watersheds within swmm sub catchments are represented by a non linear reservoir model and runoff is solved for through conservation of mass and the manning equation 1 d t i e f q 2 q 1 49 w s 1 2 an d d s 5 3 where d is the depth t is the timestep i is the rate of rainfall and snowmelt e is the surface evaporation rate f is the infiltration rate q is the runoff rate w is the characteristic width s is the average slope a is the surface area of the sub catchment n is the surface roughness and ds is the depression storage swmm sub catchments are also partitioned into sub areas of pervious surface or impervious surface with or without depression storage which can also be subject to flow re routing in which some fraction of runoff from one sub area gets routed through the other there are also multiple infiltration methods available for use within swmm green ampt was used for this study an optional two layer groundwater component unsaturated upper zone and saturated lower zone and an optional three layer snowmelt component plowable snow pervious area snow and impervious area snow the interested reader can find more information on swmm from rossman and huber 2016 2 1 2 nrcs curve number the natural resources conservation service nrcs curve number cn method is an empirical model that relates precipitation volume to direct runoff it can be defined through the following equations nrcs 2004 3 s 25400 cn 254 4 i a c s 5 q r i a 2 r i a s r i a 0 r i a where s is the maximum potential soil moisture storage mm ia is the initial abstraction mm c is the ratio of ia to s and has been shown to range from 0 05 to 0 2 for this study 0 1 was used lim et al 2006 cn is the nrcs curve number which is an empirical parameter related to soil type and land use r is the rainfall and snowmelt volume mm and q is the direct runoff mm the cn model was set up to be analogous to how sub areas are partitioned in swmm sub catchments fig 1 b instead of having one model with a cn being the weighted average of the impervious and pervious areas two nrcs cn models were created where the cn for the impervious area was 95 and the cn for the pervious area was 50 this set up was chosen so that the internal routing from the impervious to the pervious area could be accounted for the direct runoff from the pervious sub area would then be a function of the routed runoff from the impervious sub area and the total runoff that leaves the watershed is the sum of the direct runoff from the pervious sub area and the non routed direct runoff from the impervious sub area 2 2 the ensemble kalman filter since it is a conventional data assimilation method and due to its relative ease of implementation the ensemble kalman filter enkf evensen 2003 1994 was used for these analyses the general formulations of the enkf for state updating are as follows evensen 2003 moradkhani et al 2005b 6 p t b x t b x t b x t b x t b t n 1 7 q t h t x t b x t b y t y t 8 p t b h t t x t b x t b n 1 q t t σ t x y c o v x t y t 9 h t p t b h t t q t q t t n 1 σ t y y c o v y t y t 10 k t p t b h t t h t p t b h t t r t 1 σ t x y σ t y y r t 1 11 x j t a x j t b k t y t ε j t y j t where n is the number of ensemble members j subscript is the ensemble member t superscript is the transpose operator h is the observation operator t subscript the time step x is the state estimate x is the state vector k is the kalman gain b superscript is the background estimate a superscript is the analysis estimate pb is the background covariance matrix r is the observation uncertainty y is the observation being assimilated y is the simulated observation y is the simulated observation vector and ε is zero mean random noise these equations are repeated every time step that observations are available for assimilation until the final time step has been reached for these analyses the assimilated observation was the areal average soil moisture and it was used to update the swmm s states whenever observations were available 2 3 experiment design two experiments were set up to develop a quick method for determining the limiting imperviousness threshold of a sub catchment at which soil moisture assimilation would be no longer beneficial the first experiment used synthetic watersheds in swmm to evaluate the method under ideal conditions and then a surrogate model was created using the nrcs cn method which could be quickly used to identify the imperviousness threshold using simple watershed characteristics the second experiment involved modeling real watersheds using swmm assimilating smos l2 soil moisture into swmm using the enkf and then checking if the surrogate model threshold value would be consistent with them as well 2 3 1 synthetic experiment the synthetic data assimilation experiment was used to explore the benefit of assimilating remotely sensed areal average soil moisture data for use in event forecasting synthetic soil moisture was generated to represent retrieved soil moisture values similar to those from ascat smap or smos data retrieved through remote sensing methods are mapped to regular discrete global grids dgg bartalis et al 2007 entekhabi et al 2008 kerr et al 2012 2010 wagner et al 1999 the icosahedral snyder equal area isea grid being one of them for example the smos data retrievals are mapped onto the isea4h9 grid which is a 15 km hexagonal dgg illustrated in fig 1 is an example of a hexagonal dgg as well as a simple example of how the imperviousness of a watershed could vary within a grid cell the synthetic areal average soil moisture generated for these analyses are meant to emulate this type of retrieved data since it has been shown that the smos data can be directly used on the 15 km dgg despite the spatial discrepancy between the grid and the instrument s resolution al bitar et al 2012 dumedah et al 2014 kerr et al 2010 the experiment was meant to simulate the areal average soil moisture that would be retrieved over some urban area two synthetic test basins of different sizes were developed for these analyses test basin 1 tb1 has an area similar to a small town whereas test basin 2 tb2 was set to have the area of an average neighborhood each test basin had 20 near identical sub catchments within them where each sub catchment contains a different level of development represented as their impervious percentage fig 1a the test basins were also set up to have different aquifer characteristics with tb1 and tb2 having those of silt loam and sandy clay loam respectively the different synthetic basins were used to help show that the method applies to multiple cases the parameter values used for the synthetic urban sub catchments and their descriptions are listed in table 1 the chosen parameter values are also similar to existing urban watersheds liu et al 2013 the synthetic experiment flowchart is illustrated in fig 2 the precipitation data set used to force the models contains eight years of hourly data and was from a rain gauge located in toronto ontario this precipitation data set was chosen since it could provide real world precipitation depths event durations and inter event times by forcing the models with hourly precipitation synthetic observations of runoff and soil moisture were generated for each sub catchment in each test basin the areal average soil moisture was calculated for each test basin by taking the average of the synthetic soil moisture observations that were generated for each sub catchment the areal average soil moisture values were then perturbed to represent an observation error of 20 percent in this case only random measurement error was used since systematic errors should be removed from observations before they are assimilated reichle 2008 this average soil moisture was assimilated into the hydrologic models which were set up to represent multiple sub catchments within a retrieval grid this method was repeated with 25 50 and 75 percent of impervious runoff being routed internally to the pervious area first before contributing to total runoff to set up the assimilation experiment precipitation events were first identified for each runoff routing scheme these events were chosen by identifying high flow events that occurred ignoring the first year of generated synthetic observations this was done so that the model states would be stabilized and each storm event s synthetic runoff observations would have had at least one year of spin up doing this provided 58 67 precipitation events depending on the basin and routing scheme to account for uncertainty due to different initial conditions a data assimilation run was set up for each event that modeled a seven day window centered around each peak in which the synthetic areal average soil moisture observations were assimilated at each timestep after each assimilation step the swmm was run 12 h ahead to determine the influence that the soil moisture assimilation had on the short term forecast within the urban sub catchment additionally this forecast horizon allowed for determining how long the soil moisture assimilation would influence the predicted runoff after running the synthetic data assimilation experiment the performance of the swmm models was evaluated to determine the relationship between soil moisture assimilation in urban catchments and imperviousness this comparison was done to determine if there would be a change in performance related to catchment imperviousness the results of the swmm data assimilation runs were then further compared with the nrcs cn model to provide further insight into the results specifically the point at which model performance would change the nrcs cn model setup used here would act as a surrogate model which could then quickly identify the imperviousness threshold value using sub catchment characteristics 2 3 2 real world experiment to confirm that the synthetic experiments results and threshold method are consistent with real world data the method was then tested using several urban watersheds the 121 watersheds classified as urban in dudley et al 2019 were used for testing these watersheds had a high level of developed land cover 10 to 100 percent and low level of agricultural land cover 0 4 to 2 percent hourly streamflow data for each watershed were obtained using the r studio package dataretrieval de cicco et al 2018 the ncep cpc stage 4 precipitation dataset which contains 4 km gridded hourly data generated from gauge and radar data was used for precipitation forcing cooperative distributed interactive atmospheric catalog system et al 2000 hourly temperature was obtained from the local climatological data lcd dataset through national oceanic and atmospheric administration noaa and soil moisture observations for each watershed were the smos l2 soil moisture imperviousness percentage for each watershed was determined using the national land cover database nlcd 2016 urban imperviousness dataset yang et al 2018 the nlcd 2016 database provides impervious surface percent for the conus on 30 30 meter pixels yang et al 2018 reported that the overall agreement of land use pixel identification ranged from 70 to mid 80 in the eastern united states more specifically they reported that the pixels which identify developed areas which were used to determine the imperviousness of a pixel were mislabeled 18 to 50 of the time this uncertainty will be accounted for when calculating the imperviousness threshold for each watershed the forcing datasets were preprocessed and filtered based on their level of missing data if more than 5 of the precipitation and temperature were missing for a grid or gauge it was omitted from the analysis and if less than 5 of the data was missing it was infilled using simple linear regression the infilled data was then converted to mean areal precipitation and temperature data map and mat respectively using the thiessen polygon method the smos soil moisture data were filtered based on its probability of radio frequency interference and its data quality index values when they exceed 0 1 the data is removed kornelsen et al 2016 after filtering there were 43 urban watersheds of the original 121 that had adequate data for the experiment their locations are shown in fig 3 these watersheds range in size from 11 55 to 198 91 square kilometers falcone 2011 their level of development ranges from 10 to 100 percent dudley et al 2019 and their level of imperviousness ranges from 1 to 55 percent yang et al 2018 https www mrlc gov data each watershed was modeled using the swmm each of the real world urban watersheds was modeled in a lumped fashion within the swmm additionally unlike the synthetic swmm watershed setups the snowmelt routine was included for the real watersheds since they were calibrated by running the model continuously the parameters which were calibrated for each urban watershed are listed in table 2 the dynamically dimensioned search dds algorithm tolson and shoemaker 2007 was used to calibrate the selected urban watersheds with a calibration period of 2009 01 01 to 2011 12 31 2008 was used for spin up and a validation period of 2012 01 01 to 2014 12 31 the nash volume efficiency nve cost function was used samuel et al 2012 with modified weights placing more emphasis on peak flows 12 nve 0 3 n s e 0 1 v e 0 2 nse log 0 5 nse sqr where nse is the nash sutcliffe efficiency nash and sutcliffe 1970 ve is the volume error nselog is the nse calculated using log transformed streamflow and nsesqr is the nse calculated using squared streamflow once the watersheds were calibrated the data assimilation experiment was set up to assimilate smos l2 soil moisture into each swmm model the assimilation was performed during the same time period as the model validation for comparison the nrcs cn surrogate model was then set up for each real watershed and the results were evaluated to determine if the fast threshold identification method is consistent with real data 2 4 performance metrics to determine the impact soil moisture assimilation had on the short term forecast the following performance metrics were used the kling gupta efficiency kge gupta et al 2009 bias root mean square error rmse and mean continuous ranked probability score crps matheson and winkler 1976 better performance is indicated when bias crps and rmse approach zero and when kge approaches unity the metrics are defined as follows 13 kge 1 r 1 2 α 1 2 β 1 2 14 bias e y y 15 rmse 1 n t 1 n y t y t 2 1 2 16 c r p s f y 1 n t 1 n f y t 1 y t y t 2 d y where r is the linear correlation coefficient between the simulated and synthetic observed runoff values α is the measure of relative variability in the simulated and synthetic observed values β is the ratio between the simulated and observed values y t is the observed runoff at time t y t is the simulated streamflow at time t n is the number of time steps in the event f y t is the cumulative distribution function of the forecast and 1 y t y t is the heaviside step function that provides a value of 1 if the predicted value is larger than the observed and 0 otherwise 3 results and discussion 3 1 synthetic urban watershed results the results of the synthetic experiments where 50 of the impervious flow was routed are illustrated in figs 4 and 5 from the figures the kge bias rmse and crps are all shown to have similar performances these results show how the model performance changes with imperviousness and forecast horizon after the states are updated with areal average soil moisture figs 4 and 5 allows for visualizing how far the update s influence propagates forward in the forecast from these results it appears that there is an impervious threshold beyond which assimilating areal average soil moisture is not beneficial and may negatively impact the model s performance the results also show that when the basin is almost entirely impervious the effects on the model s performance caused by the assimilation are negligible within two hours while at lower imperviousness percentages the effects can last several hours longer these results are caused by the update increasing the water in the sub areas particularly the very high impervious subareas 95 99 by an amount larger than they can store so it instead runs off immediately causing a large but limited effect in the forecast to further analyze the results several statistical tests were performed to determine if parametric or nonparametric tests should be used to analyse the results the jarque bera jb test for normality was used the jb test showed that the results from the synthetic experiment were not normally distributed indicating that nonparametric tests should be used to further evaluate them the mann kendall mk trend test was utilized to determine if the decrease in performance was statistically significant for each forecast horizon the results of the mk test were summarized in table 3 the mk test showed that there was a significantly decreasing trend in performance as imperviousness increased on average for all the performance metrics which diminished as the forecast horizon increased this indicated that there was a decrease in performance caused when the areal average soil moisture was assimilated into basins with higher imperviousness finally the kruskal wallis kw test was used to determine at what impervious percent a significant decrease in performance was seen the kw indicated that there was a significant decrease in performance when the imperviousness was greater than 90 percent from visual inspection of the results illustrated in figs 4 and 5 the impact of the soil moisture assimilation was noticeable when the imperviousness is greater than 75 percent however the kw test showed that the soil moisture assimilation significantly impacted the performance when the imperviousness was greater than 90 percent when considering these results it is important also to note that synthetic experiments tend to have higher performances therefore this threshold should be lower than the point at which the kw test shows significant declination in performance the visual inspection of the results then led to the suggested general threshold value of 75 percent watershed imperviousness when 50 percent of impervious sub area runoff is rerouted to the pervious sub area beyond which it is not beneficial to assimilate soil moisture in an urban model the previously discussed analysis focused on the results from when 50 percent of impervious sub area runoff was first routed to the pervious sub area before contributing to total runoff of the watershed similar results are shown when that routing percentage is 25 and 75 however the thresholds are shifted to higher 85 and lower 65 imperviousness values respectively to determine the cause of the impervious threshold value and why it is shifted when the routing percentage changes a simple example was set up using the nrcs cn method the ratio of runoff from the impervious fraction qimp of a sub catchment to total runoff qtot of a watershed was determined for the different levels of connectivity of impervious to pervious sub areas within the sub catchments and for different rainfall volumes the threshold values were then found to correlate well to where the maximum of the qimp qtot ratio was as a function of imperviousness and percent routed these thresholds are illustrated with vertical lines in fig 6 beyond the threshold value the performances of the modeled events begin to degrade which is shown by the interquartile range of kge performance beginning to decline in performance beyond the thresholds these thresholds exist because the effects that soil moisture from the pervious sub area have on the total runoff are small compared to the runoff being routed to the pervious sub area from the impervious sub area of the sub catchment the larger this connection between pervious and impervious areas is the lower the impervious percent of the basin has to be before the influence of soil moisture is no longer meaningful 3 2 real urban watershed results the calibration and validation results for the real urban watersheds are summarized in fig 7 from fig 7 we see that the performance during the calibration period is similar to that of the validation period for most of the watersheds additionally we see that many of the urban watersheds were modeled by swmm reasonably well however only watersheds which obtained a minimum kge value of 0 6 were chosen for the data assimilation experiment the justification for this kge value was that the threshold method requires the routed parameter to be very well calibrated unlike for the calibration and validation periods where the performance metrics were calculated from a continuous time series the data assimilation results were evaluated based on the performance of the 12 h immediately following each soil moisture assimilation this was done so that the real world watersheds would be evaluated similarly to the synthetic watersheds and to observe how the soil moisture assimilation would influence the short term forecast illustrated in fig 8 are the predicted threshold ranges which are similar to where the qimp qtot graphs in fig 6 reach their maximum values as a function of precipitation which rarely exceeds 75 mm and routed the description of routed can be found in table 2 the percent impervious estimate was also included in this figure for comparison to the derived threshold range to account for the uncertainty in the percent impervious estimate the imperviousness was assumed to be up to 25 percent larger or smaller for each watershed this assumption was then used to determine whether there would be a negative impact when assimilating remotely sensed soil moisture into the urban watershed model evaluation of the data assimilation results to determine if there was a significant impact or not was performed as follows first the difference between the open loop model and the data assimilation results was taken for each forecast step out to 12 h next the mk test for significant trend was used to determine if there was a significantly increasing trend in those residuals which would indicate that immediately after assimilation there was a performance drop that diminished over time the predicted and actual impacts are illustrated in the confusion matrix in fig 8 from the confusion matrix we see that the overall accuracy of the method is 87 and type i errors occur 18 of the time there are no type ii errors in general the surrogate model accurately predicted all the watersheds which would be negatively impacted from assimilating remotely sensed soil moisture while also having a false discovery rate of 33 however it should be noted that the imperviousness threshold range is dependent on the routed parameter which needed to be calibrated and therefore may not be the actual value for the watershed due to equifinality there is also the assumed parameter value of c 0 1 in eq 4 which if increased or decreased will cause the threshold to shift down or up respectively finally there may be some additional uncertainties that influence the results based on the structural error of the swmm or due choosing to model each watershed as lumped instead of semi distributed these results suggest that using the surrogate nrcs cn method is a quick way to determine if assimilating remotely sensed soil moisture into an urban model will be beneficial additionally they show that there is a limiting imperviousness threshold that should be considered before using assimilating remotely sensed soil moisture data for the real world urban watersheds the general threshold is suggested to be about 65 percent imperviousness this is due to the expected precipitation event volumes which occur in the synthetic experiment the proposed threshold was about 75 percent imperviousness therefore depending on precipitation and actual basin characteristics it can be expected that the threshold of imperviousness could be in the range of 65 to 75 the implication of this work was to show that remotely sensed soil moisture data is a viable source of observational data for assimilation in urban catchments so long as those catchments do not exceed the impervious threshold this is beneficial because often models of urban catchments do not have associated streamflow gauges which can provide observations for streamflow data assimilation this allows for remotely sensed soil moisture data to be assimilated into the urban catchment model to provide more accurate states for performing a forecast 4 conclusions the results for the synthetic basin experiment identified an imperviousness threshold up to which soil moisture assimilation is useful in urban watersheds and beyond which it is not as beneficial this threshold was shown to be a function of watershed imperviousness precipitation volume and the connectivity between pervious and impervious sub areas in a watershed we found that for the synthetic case the assimilation of soil moisture had little impact on the model performance at the lower impervious levels which was to be expected since the difference between the simulated and synthetic soil moistures should be negligible it was also shown that the assimilation of areal average soil moisture when the imperviousness of the catchment was beyond the threshold value could cause the model s performance to deteriorate additionally we found that the threshold method is reasonably consistent when using real world data we conclude that in general it is feasible to assimilate areal average soil moisture data into a model of an urban watershed as long as the imperviousness of the watershed is below the threshold value of 65 impervious this threshold can then be refined further on a case by case basis if the impervious percentage of the watershed exceeds the threshold the modeler will need to adjust their assimilationstrategy for soil moisture data as it may begin to degrade model performance otherwise credit authorship contribution statement james m leach conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization paulin coulibaly resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the natural sciences and engineering research council of canada nserc canadian floodnet grant number netgp 451456 the authors would like to thank the anonymous reviewers for their comments and suggestions that have helped to improve the manuscript 
5412,flood risk increases with climate change and rapid urbanization which urgently needs to improve the capacity of urban drainage systems in the study a staged optimization model considering climate change and hydrological model uncertainty socu was proposed for urban drainage system design the socu model refers to the construction of drainage system by stages instead of traditional implement once plans which was established based on an integration of staged optimization policy urban hydrological model generalized likelihood uncertainty estimation glue method and chance constrained programming ccp model the staged optimization policy was employed to deal with the uncertainty of climate change the glue method was adopted to analyze the uncertainty of urban hydrological model established by pcswmm considering the uncertainty from urban hydrological simulation the ccp model one of the main methods of stochastic mathematical programming was used to deal with the uncertainty of the optimization model subsequently a case study of the haidian island of hainan province in china was used to demonstrate the proposed model the result shows that the optimal investment is 183 million yuan with a pumping capacity of 28 3 m3 s for the first stage and 38 4 m3 s for the next stage the socu model is not only more flexible to adapt to climate change but also is economically efficient 10 lower than implement once plans the urban drainage system design obtained from the socu model is more reliable and robust than traditional implement once plans since the climate change and hydrological model uncertainty are simultaneously taken into account furthermore the investment increases from 166 million yuan to 195 million yuan when the flood constraint satisfaction probability increases from 0 75 to 0 95 therefore the model could provide richer decision making information than traditional implement once plans and help decision makers seek a trade off between system investment and acceptable flood damage the study outcomes provide a reliable optimization model for urban drainage design and may have profound implications and contributions for urban flood management keywords urban flood management drainage system design staged optimization model uncertainty analysis 1 introduction floods are serious threats to life and property around the world barati et al 2012 lian et al 2017 with climate change flood risk will increase in the future lian et al 2013 zheng et al 2014 jenkins et al 2017 he et al 2018 he et al 2019 which will cause extensive economic losses and social problems as well as health issues worldwide in china approximately 200 cities and towns suffer from urban flooding hazards every year according to statistical data 62 of the 351 investigated cities have suffered from urban flooding during 2008 to 2010 xu et al 2018d for example typhoon rammasun hit haikou of hainan province in july 2014 which claimed eight lives and caused nearly 9 billion yuan 1 30 billion dollar economic losses due to heavy daily rainfall similar disaster cases can also be found in many other cities such as beijing xu et al 2018a shanghai yin et al 2016a and so on the intensified flood hazards demand the urgent needs to improve the capacity of urban drainage systems li et al 2015 yu et al 2017 yazdi et al 2016 mohammadiun et al 2018 however excessive drainage systems will increase investment and insufficient drainage systems will cause flooding losses therefore it is necessary to develop a cost effective drainage design to achieve a better trade off between flood prevention goals and investment optimization models have been widely adopted to tackle such trade off problems in drainage system design muleta and boulos 2007 presented a multi objective optimization model for urban drainage system design to minimize design costs and maximize system performance maharjan et al 2009 described a staged cost optimization tool based on the hydraulic performance one dimension hydraulic model of the drainage system and to determine optimal intervention timings and responses over the analysis period but the uncertainties of hydraulic model and optimization model were not considered li et al 2015 developed a framework for the design of detention tank network based on the storm water management model swmm and a modified particle swarm optimizer and duan et al 2016 further analyzed the uncertainty and sensitivity of the framework cimorelli et al 2016 described a procedure integrating hydrologic model and genetic algorithm for the evaluation of the optimal number position configuration and sizes of detention tanks in urban drainage networks to comply with the local design requirements wang et al 2017 presented a two stage optimization framework to find an optimal scheme for storage tanks using swmm mohammadiun et al 2018 developed a stochastic framework to design rehabilitate urban stormwater drainage systems based on a resilient approach in order to design rehabilitate of usdss considering the related probabilities of external and internal unexpected conditions of loading the above researches demonstrate that the optimization model is an effective way for seeking cost effective solutions in urban drainage system design however there are still some challenges to make the optimization model more reliable first the effect of climate changes on urban drainage design has been rarely considered in existing optimization model climate change is expected to increase the intensity and frequency of extreme rainfall frei et al 1998 ipcc 2014 it causes that the design criteria of urban drainage systems based on statistical analysis of past rainfall events cannot meet the drainage requirements under climate change conditions mailhot and duchesne 2010 thus it is necessary to evaluate the effect of climate changes on drainage system design second hydrological models are widely used in the optimization model but the uncertainty of the hydrological model has been rarely considered in drainage designs the hydrological model uncertainty usually originates from the uncertainty of input data e g rainfall hydrological parameters e g sub catchment characteristic width conduit roughness and model structure extensive studies e g beven and binley 1992 perrin et al 2001 fang and ball 2007 sun et al 2014 have demonstrated that the uncertainty of hydrological models would have a great impact on simulation output tackling these uncertainties is important to help obtain reliable design solutions therefore it is meaningful to take account of the effect of climate change and hydrological model uncertainty on urban drainage system design to deal with the uncertainty of climate change the staged optimization policy was employed to urban drainage system design which refers to the construction of drainage systems by stages implemented at regular time periods rather than traditional implement once plans maharjan et al 2009 for example to meet drainage requirements in 2050 the first method is that all drainage facilities e g pump stations and storage tanks are implemented in the first year e g 2020 and the drainage capacity is calculated by the design rainfall in 2050 under climate change the second method is that drainage facilities are implemented in two stages the first stage 2020 2035 is to determine the drainage capacity by the design rainfall in 2035 then supplemental drainage facilities can be implemented and designed based on historical rainfall before 2035 instead of 2020 in the second stage 2035 2050 which could reduce the uncertainty caused by rainfall obviously the second method is not only more flexible as they allow the decision makers to keep options open against uncertainties due to the climate change but also is economically efficient in terms of net present value in this study we proposed a staged optimization model considering climate change and hydrological model uncertainty socu to flexibly adapt to climate change and improve the reliability of urban drainage systems the model could help decision makers to better understand the potential effects of climate change and hydrological model uncertainty on drainage design and seek a trade off between system investment and acceptable flood damage a case study of haidian island haikou was used to demonstrate the proposed model section 2 describes the materials and methods including the framework of socu model and the introduction of the case study section 3 presents the results and discussion with final conclusions presented in section 4 2 materials and methods 2 1 socu modelling framework the framework of socu model was presented in fig 1 the steps required to be carried out to accomplish the socu modelling were described in the following sections 2 1 1 step 1 hydrological modelling data preparing and analysis of design rainfall under climate change the required data of socu model includes basic data of hydrological model calibration data of the model and the projected design rainfall the basic data of hydrological model includes elevation data river data e g river cross section and the distance between cross sections conduit data e g junction depth conduit size etc and long term rainfall observations the calibration data of hydrological model refers to the observations of historical flood events e g inundation depth and rainfall the projected design rainfall under climate change is used as input data for the urban hydrological model at different time steps generally future design rainfall can be obtained from global or regional circulation model wilby et al 1998 tian et al 2016 and statistical analysis mailhot and duchesne 2010 ahammed et al 2014 in the study design rainfall under climate change was calculated by statistical analysis and the detail steps are described in section 2 2 1 2 1 2 step 2 urban hydrological model uncertainty analysis the urban hydrological model was established to evaluate the capability of the drainage system of a city numerous commercial software models e g mike software dhi 2011 swmm rossman 2015 pcswmm paule mercado et al 2017 and so on are available to simulate the hydrological and hydraulic process of flooding in this study a two dimensional inundation model pcswmm was employed pcswmm developed by chi canada was widely applied in the simulation of surface hydrological processes and drainage network flows denault et al 2006 meierdiercks et al 2010 ahiablame and shakya 2016 xu et al 2018b the dynamic wave method akbari and barati 2012 barati et al 2013 was used to calculate the hydraulic simulation of the drainage conduit uncertainty is an attribute of the hydrological model which comes from model structural errors observation data errors input errors parameter errors etc correctly evaluating the uncertainty of hydrological model is of great significance in improving the accuracy of urban flood simulation thorndahl et al 2008 in the study the generalized likelihood uncertainty estimation glue method was applied for uncertainty analysis which has been widely applied in the field of hydrology beven and binley 1992 thorndahl et al 2008 freni et al 2009 sun et al 2014 the main steps of the glue method are as follows 1 determining value ranges of parameters and their prior distributions e g uniform distributions 2 randomly sampling parameter sets using a monte carlo mc technique and running the hydrological model with the generated samples 3 defining the likelihood function and calculating the likelihood measures for each parameter set in the study the likelihood function was defined as follows thorndahl et al 2008 1 l θ k 1 n exp s k o k 2 o k 2 where l denotes the likelihood value θ denotes the uncertain parameter sets sk denotes the simulated inundation depth at the kth site ok denotes the observed inundation depth at the kth site n denotes the number of observations 4 selecting valid parameter sets e g likelihood values are higher than 0 9 and resampling according to the likelihood values to obtain the marginal posterior distribution of uncertain parameters 2 1 3 step 3 establishment of socu model 1 objective function the design objective of socu model is to minimize the total cost including the investment cost of drainage facilities and flood damages the investment cost of drainage facilities mainly refer to the sum of investment cost in different time steps for a staged optimization model with m time steps the investment cost can be defined as follows 2 ic j 1 m i 1 s c i p v i i d j where ic denotes the total present investment cost pvi denotes the capacity of the ith drainage facility e g pump station storage tank and so on ci denotes the unit cost of ith drainage facility s denotes the number of drainage facility idj denotes the investment discount factor for each time step j which can be calculated by following equation maharjan et al 2009 3 i d j 1 1 r j 1 δ t δ t 2 where t denotes time duration of each time step r denotes the discount rate in this study the flood damage is computed in terms of expected annual damage eq 4 4 ead f 0 d f d f where ead is the expected annual damage d f is the flood damage caused by the flood event with the occurrence frequency f in order to simplify the calculations the continuous integral of eq 4 is written as a series of return periods 5 year 10 year 20 year and 50 year according to maharjan et al 2009 and xu et al 2018a thus the flood damage function can be expressed as 5 fc j 1 m i 1 p v i 1 v i 2 c f 1 r i 1 r i 1 j f d j 6 f d j i 0 δ t 1 1 1 r j 1 δ t i where fc denotes the total present flood damage m denotes the number of time steps p denotes the number of discretized return periods 5 year 10 year 20 year 50 year ri denotes the ith return period of the flood event vi denotes the inundation volume by the flood event with the return period of ri cf denotes the flood unit cost fdj denotes the flood discount factor for each time step j thus the objective function total cost function can be described as 7 z min ic f c 2 chance constrained programming model considering the uncertainty from urban hydrological simulation uncertain parameters e g sub catchment characteristic width w and conduit roughness n are usually quantitatively represented as stochastic distributions he et al 2006 xie et al 2011 bastin et al 2013 dong et al 2015 therefore a chance constrained programming ccp model one of the main methods of stochastic mathematical programming was employed to deal with the uncertainty of the optimization model the ccp model is applicable to solve the reliability problem of satisfying system constraints under uncertain conditions which can provide information on the trade off between the total investment and the risk of being flooded which would be valuable to decision makers a typical ccp model can be formulated as follows charnes and cooper 1963 8 min f x ξ subject to 9 h x 0 i 1 2 k 10 pr g j x ξ 0 α j j 1 2 q where f denotes the objective function x denotes the decision variable ξ denotes the stochastic parameter h denotes the constraint function without stochastic parameters g denotes the constraint function with stochastic parameters α denotes constraint satisfaction probability k denotes the total number of deterministic constraints q denotes the total number of stochastic constraints in this study the socu model for urban drainage system design could be written as follows based on the above objective function and ccp model 11 m i n z j 1 m i 1 s c i p v i i d j j 1 m i 1 p v i 1 v i 2 c f 1 r i 1 r i 1 j f d j subject to 12 pr q p v ξ r p γ ξ r p α 13 i 1 s c i p v i j b u j 14 0 p v i δ i where pr denotes the probability of satisfying the stochastic constraint q denotes total surcharging volume calculated by the hydrological model ξ denotes the stochastic parameters e g sub catchment characteristic width and conduit roughness representing the uncertainty associated with the hydrological model which are posterior uncertain parameters derived by mc based glue method rp denotes the design rainfall in different time steps under the climate change condition γ denotes the acceptable surcharging volume i e surcharge threshold α denotes constraint satisfaction probability buj denotes the maximum investment amount during jth time step δi denotes the maximum capacity of the ith drainage facility pr could be calculated as follows 15 pr n k n t where nt denotes the number of calculation conditions of the hydrological model nk denotes the number of calculation conditions which satisfy the constraint of q γ 2 1 4 step 4 execution of socu model a heuristic technique genetic algorithm ga was employed to solve the socu model which is one of the most widely used techniques for optimal stormwater management planning zhen et al 2004 maharjan et al 2009 cimorelli et al 2016 xu et al 2018a the ga is a global search technique based on the procedure of initiation selection crossover and mutation in the study the ga was programmed in the matlab environment and real number based chromosomes were adopted the parameters of the model were determined by trial and error and the values recommended in relevant studies xu et al 2018a a population size of 20 a generation size of 400 a crossover probability of 0 7 and a mutation probability of 0 3 were set in the optimization model 2 2 case study 2 2 1 study area and data in order to test the proposed optimization scheme haidian island located in the northern part of haikou in hainan province china was taken as a case study the terrain of haidian island is relatively flat fig 2 and this area is one of regions most seriously and frequently influenced by typhoons in china therefore it is prone to floods due to flat terrain and the effect of typhoons xu et al 2018c xu et al 2019 the data used in this study include elevation data river data conduit data rainfall data and observations of historical flood events elevation data was accessed from the institute of geographic sciences and natural resources research chinese academy of sciences http www resdc cn default aspx river data and conduit data were provided by haikou municipal water authority observations of historical storm events were obtained through field investigation during typhoon rammasun on july 2014 long term rainfall observations were obtained from the china meteorological administration meteorological data center http data cma cn data cdcdetail datacode a 0012 0001 html the design rainfall in different time steps was calculated by statistical analysis method since global or regional circulation models require lots of meteorological data and have great uncertainty technical details of design rainfall analysis method can be found in mailhot and duchesne 2010 this method assumes that the parameter of rainfall distribution e g generalized extreme value function is linear interpolation according to the historical rainfall data firstly the generalized extreme values gev function was used to describe rainfall distribution with location parameter ξ 122 51 scale parameter α 46 78 and shape parameter k 0 115 in haidian island the design rainfall e g the return period of 5 year 10 year 20 year 50 year in 2012 was calculated by the above gev function the temporal distribution of the design rainfall was the same as that of the rainfall event on july 18 2014 based on the severe flooding scenario then considering climate change the location parameter ξ is a linear function of time and the increase rate b 2 53 mm year according to the historical rainfall data and the design rainfall in 2020 and 2030 can be calculated table 1 fig 2c presents the design rainfall process with the return period of 50 years in different time steps the projected maximum value of hour rainfall will increase about 13 from 100 mm h to 113 mm h in consideration of climate change in 2030 which will cause worse flood conditions therefore it is necessary to take account of the effect of climate change on urban drainage system design 2 2 2 urban hydrological model uncertainty analysis based on glue method the pcswmm model of haidian island has been described and calibrated in xu et al 2018b the glue method was applied for uncertainty analysis considering that the objective of this study is to evaluate the effect of urban hydrological model uncertainty on drainage design sub catchment characteristic width w and conduit roughness n which are the most sensitive parameters for the hydrological model were selected for uncertainty analysis based on the sensitivity test and the recommendation of previous literatures zaghloul 1983 zhao et al 2009 since the sub catchment characteristic width varies in different sub catchments the relative percentage change of w was employed for uncertainty analysis the uniform distributions were adopted as prior distributions since prior ranges of parameter sets should be broad enough to cover all possible parameter values and to reflect substantial uncertainty in parameters sun et al 2014 the value ranges of w and n were set to 0 5 to 3 0 and 0 005 to 0 03 respectively based on the recommended ranges from relevant references rossman 2015 a total of 1000 parameter sets were sampled from prior distributions using a monte carlo technique the likelihood values of parameter sets being higher than 0 9 were accepted as posterior samples fig 3 illustrates the scatter plots of likelihood values and sub catchment characteristic width and conduit roughness as shown in fig 3 the likelihood values both have obvious peak values with the increase of w and n indicating that these parameters are significantly sensitive to the hydrological model and have large influences on the simulation output these posterior samples can be used to calculate the probability of satisfying the stochastic constraint in eq 12 2 2 3 model setup according to the guidelines of urban drainage design released by ministry of housing and urban rural development of people s republic of china http www mohurd gov cn wjfb 201306 t20 130627 214142 html the drainage system in haidian island was designed to handle a 50 year rainfall event before 2030 and the design base year was set to 2012 in this study for convenience of methodology demonstration the drainage facility was implemented in two stages including short term 2020 and long term 2030 construction in our previous work lian et al 2017 pumping facilities were effective and economical choices in haidian island due to the flat terrain fig 2b and high tide blocking therefore pumping facilities were adopted in haidian island the locations of the pumping facilities were selected in the highest flood risk areas based on our previous work xu et al 2018b additionally in haidian island the dongpo lake i e storage a in fig 6b and qiuhai lake i e storage b in fig 6b have been planned as storage projects by haikou municipal water authority and the storage capacity of the dongpo lake and qiuhai lake is 126 000 m3 and 389 000 m3 respectively xu et al 2018b in the optimization model a variety of parameters need to be set as model inputs including the unit cost of the pumping facility c the discount rate r the flood unit cost cf the acceptable surcharging volume γ constraint satisfaction probability α the maximum investment amount bu1 and bu2 the maximum capacity of the pumping facility δ these parameters were determined based on the actual circumstances of the study area field investigation and recommendations from relevant references 1 c and r were set to 3 million yuan and 0 08 respectively based on recommendations from relevant references lian et al 2017 xu et al 2018a 2 cf was set to 258 yuan surveyed by two flooding events in the study area in october 2010 and july 2014 3 γ and δ were initially set as 600 000 m3 and 80 m3 s respectively based on trial and error 4 α was initially set as 0 9 5 bu1 and bu2 were assumed to 0 8 billion yuan and 1 0 billion yuan respectively according to the local financial investment plan the sensitivity of above parameters was also explored in this study in the optimization model the submerged volume vi calculated by pcswmm changes with the capacity of drainage systems i e the decision variable of the optimization model to facilitate the connection between the optimization model and pcswmm model following methods can be adopted 1 before running the optimization model the relationship between submerged volume and the capacity of drainage systems can be fitted by a regression equation through a large number of hydraulic simulations then the fitted equation is substituted into the optimization model 2 in each solution evaluated by ga the hydraulic behavior of the drainage system is simulated by the pcswmm model and then extract the necessary information e g submerged volume from pcswmm model to the optimization model since the computation time of pcswmm model is relatively long e g the average computation time is about 5 h on a pc with single cpui5 3 2 ghz configuration the first way was adopted in this study to efficiently achieve the numerical optimization process under uncertainty conditions the fitted equations between submerged volume v and the capacity of drainage systems pv are described in table 2 3 results and discussions 3 1 optimal solution of socu model a number of different trials with different random seeds are used to ascertain the robustness of the optimization model the 10 trials in fig 4 are the representative of different trials in order to describe optimal pumping capacity and corresponding total present cost fig 4 shows that the total present costs of the optimization model are all located at around 185 million yuan the optimal total present cost is 183 million yuan trial 6 with the flood cost of 78 million yuan 43 and the investment cost of 105 million yuan 57 shown in fig 5 the optimal solution shows that a pumping capacity of 28 3 m3 s should be constructed in 2012 2020 and then extended to 38 4 m3 s in 2020 2030 the pumping capacity of 28 3 m3 s and 38 4 m3 s refer to the sum of the capacities of pump stations c g in fig 6 b the location and the distribution ratio of the pumping capacity of pump stations c g were determined based on our previous work xu et al 2018b as shown in fig 6b inundation depths are extremely low after implementing the above new drainage facilities when compared with those in fig 6a thus the new drainage system for this area will be able to handle a 50 year rainfall event in 2030 as shown in fig 5 if drainage facilities were completely implemented in the first year to handle a 50 year rainfall event in 2030 i e implement once design the total present cost i e investment cost was more than 200 million yuan which was much higher than that of socu model since the time value of money was taken into account thus the staged design is a significant financial saving and this is only one of advantages of this approach the staged design can also make the decision making more flexible as it is possible for decision makers to revise some decisions made today according to more sufficient information on a future date for example for a project with 50 year life span e g from 2020 year to 2070 year the drainage facilities which are adequate at the beginning of the project may not be able to meet the drainage requirements at 2050 year because of climate change hence supplemental drainage facilities e g pumps and storage tanks can be implemented and designed based on historical rainfall before 2050 year instead of 2020 year which could reduce the uncertainty caused by rainfall 3 2 influence of climate change and hydrological model uncertainty in order to improve the reliability of urban drainage design the climate change and hydrological model uncertainty were taken into account in the optimization model for urban drainage designs as we all known climate change has an influence on rainfall and the investment of drainage system but the quantification of the influence is a question worth exploring fig 7 illustrates the comparison of the total present cost under the climate change and stationarity scenario the total present cost would increase from 121 million yuan to 127 million yuan under stationarity scenario and from 166 million yuan to 195 million yuan under climate change scenario respectively when the constraint satisfaction probability increases from 0 75 to 0 95 the total present cost under climate change scenario would increase on average 1 4 times than that under present scenario it reveals that climate change has a respectively significant influence on the investment of drainage system furthermore the solutions under stationarity scenario would inevitably lead to the flood risk under future climate change conditions when the stationarity solutions are implemented but with increased rainfall due to climate change the surcharging probabilities i e the total surcharging volume exceeds the corresponding threshold were all higher than 50 as shown in fig 7 grey bar which demonstrates that the solution with consideration of climate change is more reliable fig 8 shows the influence of hydrological model uncertainty on the drainage design the total present cost of the deterministic optimization model i e without considering hydrological model uncertainty is 147 million yuan which is lower than the result of socu model 183 million yuan the deterministic solutions would lead to flooding problems due to the hydrological model uncertainty and the surcharging probability is 52 which indicates that although the deterministic model saves some investment cost the model results lack sufficient reliability 3 3 influence of constraint satisfaction probability and surcharge threshold the socu model not only has the above mentioned reliability but also could provide richer decision making information for decision makers fig 9 presents the relationship between constraint satisfaction probability i e system safety probability and total system investment obviously the total present cost would increase with an increase of the constraint satisfaction probability when the constraint satisfaction probability increases from 0 75 to 0 95 the total present cost increases from 166 million yuan to 195 million yuan which could help decision makers conduct a trade off analysis between total system investment and the flooding risk for instance when the constraint satisfaction probability increases from 0 75 to 0 85 the total present cost increases slowly in haidian island however the total present cost increases obviously when the constraint satisfaction probability increases from 0 85 to 0 95 therefore in order to achieve a high level of system safety and save the investment the constraint satisfaction probability of 0 85 is recommended similar decision making information for decision makers can also be given in fig 10 fig 10 shows the relationship between surcharge threshold i e the threshold of total surcharge volume and system investment the maximum surcharge volume was taken as 680000 m3 by the high flood risk area described in xu et al 2018b and the allowed maximum submerged depth i e 0 3 m in yin et al 2016a with the increase of the surcharge threshold the total present cost decreases from 183 million to 147 million yuan which was mainly due to the decrease of drainage facility investment cost furthermore the total present cost increase greatly from 151 million yuan to 183 million yuan when the surcharge threshold decrease from 640 000 m3 to 600 000 m3 whereas the total present cost only increase slightly from 147 million yuan to 151 million yuan with the decrease of the surcharge threshold from 680 000 m3 to 640 000 m3 it indicates that it is more economical to set the surcharge threshold as 640 000 m3 for the haidian island 3 4 socu model parameter sensitivity analysis in the optimization model some parameters were initially determined according to the actual circumstances of the study area field investigation and recommendations from relevant references when these parameters change it may have an influence on the optimization cost function thus the sensitivity analysis of these parameters including flood unit cost pump unit cost the discount rate and rainfall increase rate needs to be carried out as shown in fig 11 the total present cost would increase linearly with the increase of the flood unit cost and the pump unit cost when the discount rate increases from 0 02 to 0 12 the total present cost shows a logarithmic decrease from 364 million yuan to 128 million yuan with the increase in rainfall increase rate an exponential increase of the total present cost is observed through the fitted exponential equation decision makers could evaluate the climate change effects on the drainage system investment for instance the total present cost increases 80 million yuan when the rainfall increase rate is 10 furthermore the total present costs would change with a specific trend in terms of the data parameters changing which illustrates that the trends of the model s features are not affected by the assumptions 3 5 advantages and deficiencies of the proposed model in the study a staged optimization model considering climate change and hydrological model uncertainty was proposed for urban drainage design in addition to the advantages mentioned above the proposed model has the potential to be widely applied for other types of drainage designs e g storage tanks design drainage conduit size design and so on however the proposed approach also has certain deficiencies first climate change and rapid urbanization both have an effect on rainfall and land surface in this study underlying surface change was not considered in urban hydrological model due to data constraints and the uncertainty of design rainfall in the climate change estimates has not been taken into account this is also our future work when we use the staged optimization model for other areas second the limitation of indirect economic data in the study area restricts the quantification of flood damages the flooding cost includes economic losses and non economic losses the economic losses mainly refer to financial cost the non economic losses include huge social environmental costs and sometimes even loss of life referring to maharjan et al 2009 and xu et al 2018a the financial cost was taken into account since indirect economic losses are difficult to quantify a future research work would be to improve the accurate quantification of the flood damage finally for convenience of methodology demonstration and considering the actual circumstances of the study area only two stages and pumping facility were analyzed in this study more stages and more types of drainage facilities e g increase drainage conduit size improve flow capacity of rivers and so on are required to be explored in the future work 4 conclusions the optimization model is an effective way for seeking cost effective solutions in urban drainage system design however the previous optimization models rarely take climate change and urban hydrological model uncertainty into consideration in this study a more reliable optimization model i e socu model for urban drainage design was proposed based on an integration of staged optimization policy urban hydrological model mc based glue method ccp model and heuristic algorithm first the required data of the socu model were collected and the projected design rainfall in future conditions was analyzed as input data for urban hydrological model in different time steps second a two dimensional inundation model of the study area was established by pcsmm and the uncertainty of the hydrological model was investigated based on glue method third considering the uncertainty from urban hydrological simulation as well as the effects of climate change on designed rainfall a ccp model was employed to deal with uncertainty of the optimization model the posterior samples of hydrological parameters obtained from glue method were used to calculate the probability of satisfying the stochastic constraint finally genetic algorithm was adopted to solve the socu model due to its easy implementation simplicity and efficiency in application subsequently a case study of the haidian island was used to demonstrate the proposed model the result shows that the socu model not only has more flexibility to adapt to climate change but also is a significant financial saving 10 lower than traditional implement once plan since the climate change and hydrological model uncertainty were simultaneously considered the urban drainage system design obtained from the socu model would be more reliable and robust furthermore the proposed model could help decision makers better understand the potential effects of climate change and hydrological model uncertainty on drainage design and seek a trade off between system investment and acceptable flood damage the study outcomes may have profound implications and contributions for urban flood management credit authorship contribution statement hongshi xu conceptualization methodology software writing original draft writing review editing visualization chao ma methodology validation investigation writing review editing funding acquisition kui xu conceptualization software writing original draft writing review editing jijian lian validation resources funding acquisition yan long visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was supported by national key research and development program of china 2018yfc1508005 national natural science foundation of china 51679159 51722906 the science fund for creative research groups of the national natural science foundation of china 51621092 and the program of introducing talents of discipline to universities b14012 additionally our cordial gratitude should be extended to the editor and three anonymous reviewers for their professional and pertinent comments and suggestions which are greatly helpful for further quality improvement of this manuscript 
5412,flood risk increases with climate change and rapid urbanization which urgently needs to improve the capacity of urban drainage systems in the study a staged optimization model considering climate change and hydrological model uncertainty socu was proposed for urban drainage system design the socu model refers to the construction of drainage system by stages instead of traditional implement once plans which was established based on an integration of staged optimization policy urban hydrological model generalized likelihood uncertainty estimation glue method and chance constrained programming ccp model the staged optimization policy was employed to deal with the uncertainty of climate change the glue method was adopted to analyze the uncertainty of urban hydrological model established by pcswmm considering the uncertainty from urban hydrological simulation the ccp model one of the main methods of stochastic mathematical programming was used to deal with the uncertainty of the optimization model subsequently a case study of the haidian island of hainan province in china was used to demonstrate the proposed model the result shows that the optimal investment is 183 million yuan with a pumping capacity of 28 3 m3 s for the first stage and 38 4 m3 s for the next stage the socu model is not only more flexible to adapt to climate change but also is economically efficient 10 lower than implement once plans the urban drainage system design obtained from the socu model is more reliable and robust than traditional implement once plans since the climate change and hydrological model uncertainty are simultaneously taken into account furthermore the investment increases from 166 million yuan to 195 million yuan when the flood constraint satisfaction probability increases from 0 75 to 0 95 therefore the model could provide richer decision making information than traditional implement once plans and help decision makers seek a trade off between system investment and acceptable flood damage the study outcomes provide a reliable optimization model for urban drainage design and may have profound implications and contributions for urban flood management keywords urban flood management drainage system design staged optimization model uncertainty analysis 1 introduction floods are serious threats to life and property around the world barati et al 2012 lian et al 2017 with climate change flood risk will increase in the future lian et al 2013 zheng et al 2014 jenkins et al 2017 he et al 2018 he et al 2019 which will cause extensive economic losses and social problems as well as health issues worldwide in china approximately 200 cities and towns suffer from urban flooding hazards every year according to statistical data 62 of the 351 investigated cities have suffered from urban flooding during 2008 to 2010 xu et al 2018d for example typhoon rammasun hit haikou of hainan province in july 2014 which claimed eight lives and caused nearly 9 billion yuan 1 30 billion dollar economic losses due to heavy daily rainfall similar disaster cases can also be found in many other cities such as beijing xu et al 2018a shanghai yin et al 2016a and so on the intensified flood hazards demand the urgent needs to improve the capacity of urban drainage systems li et al 2015 yu et al 2017 yazdi et al 2016 mohammadiun et al 2018 however excessive drainage systems will increase investment and insufficient drainage systems will cause flooding losses therefore it is necessary to develop a cost effective drainage design to achieve a better trade off between flood prevention goals and investment optimization models have been widely adopted to tackle such trade off problems in drainage system design muleta and boulos 2007 presented a multi objective optimization model for urban drainage system design to minimize design costs and maximize system performance maharjan et al 2009 described a staged cost optimization tool based on the hydraulic performance one dimension hydraulic model of the drainage system and to determine optimal intervention timings and responses over the analysis period but the uncertainties of hydraulic model and optimization model were not considered li et al 2015 developed a framework for the design of detention tank network based on the storm water management model swmm and a modified particle swarm optimizer and duan et al 2016 further analyzed the uncertainty and sensitivity of the framework cimorelli et al 2016 described a procedure integrating hydrologic model and genetic algorithm for the evaluation of the optimal number position configuration and sizes of detention tanks in urban drainage networks to comply with the local design requirements wang et al 2017 presented a two stage optimization framework to find an optimal scheme for storage tanks using swmm mohammadiun et al 2018 developed a stochastic framework to design rehabilitate urban stormwater drainage systems based on a resilient approach in order to design rehabilitate of usdss considering the related probabilities of external and internal unexpected conditions of loading the above researches demonstrate that the optimization model is an effective way for seeking cost effective solutions in urban drainage system design however there are still some challenges to make the optimization model more reliable first the effect of climate changes on urban drainage design has been rarely considered in existing optimization model climate change is expected to increase the intensity and frequency of extreme rainfall frei et al 1998 ipcc 2014 it causes that the design criteria of urban drainage systems based on statistical analysis of past rainfall events cannot meet the drainage requirements under climate change conditions mailhot and duchesne 2010 thus it is necessary to evaluate the effect of climate changes on drainage system design second hydrological models are widely used in the optimization model but the uncertainty of the hydrological model has been rarely considered in drainage designs the hydrological model uncertainty usually originates from the uncertainty of input data e g rainfall hydrological parameters e g sub catchment characteristic width conduit roughness and model structure extensive studies e g beven and binley 1992 perrin et al 2001 fang and ball 2007 sun et al 2014 have demonstrated that the uncertainty of hydrological models would have a great impact on simulation output tackling these uncertainties is important to help obtain reliable design solutions therefore it is meaningful to take account of the effect of climate change and hydrological model uncertainty on urban drainage system design to deal with the uncertainty of climate change the staged optimization policy was employed to urban drainage system design which refers to the construction of drainage systems by stages implemented at regular time periods rather than traditional implement once plans maharjan et al 2009 for example to meet drainage requirements in 2050 the first method is that all drainage facilities e g pump stations and storage tanks are implemented in the first year e g 2020 and the drainage capacity is calculated by the design rainfall in 2050 under climate change the second method is that drainage facilities are implemented in two stages the first stage 2020 2035 is to determine the drainage capacity by the design rainfall in 2035 then supplemental drainage facilities can be implemented and designed based on historical rainfall before 2035 instead of 2020 in the second stage 2035 2050 which could reduce the uncertainty caused by rainfall obviously the second method is not only more flexible as they allow the decision makers to keep options open against uncertainties due to the climate change but also is economically efficient in terms of net present value in this study we proposed a staged optimization model considering climate change and hydrological model uncertainty socu to flexibly adapt to climate change and improve the reliability of urban drainage systems the model could help decision makers to better understand the potential effects of climate change and hydrological model uncertainty on drainage design and seek a trade off between system investment and acceptable flood damage a case study of haidian island haikou was used to demonstrate the proposed model section 2 describes the materials and methods including the framework of socu model and the introduction of the case study section 3 presents the results and discussion with final conclusions presented in section 4 2 materials and methods 2 1 socu modelling framework the framework of socu model was presented in fig 1 the steps required to be carried out to accomplish the socu modelling were described in the following sections 2 1 1 step 1 hydrological modelling data preparing and analysis of design rainfall under climate change the required data of socu model includes basic data of hydrological model calibration data of the model and the projected design rainfall the basic data of hydrological model includes elevation data river data e g river cross section and the distance between cross sections conduit data e g junction depth conduit size etc and long term rainfall observations the calibration data of hydrological model refers to the observations of historical flood events e g inundation depth and rainfall the projected design rainfall under climate change is used as input data for the urban hydrological model at different time steps generally future design rainfall can be obtained from global or regional circulation model wilby et al 1998 tian et al 2016 and statistical analysis mailhot and duchesne 2010 ahammed et al 2014 in the study design rainfall under climate change was calculated by statistical analysis and the detail steps are described in section 2 2 1 2 1 2 step 2 urban hydrological model uncertainty analysis the urban hydrological model was established to evaluate the capability of the drainage system of a city numerous commercial software models e g mike software dhi 2011 swmm rossman 2015 pcswmm paule mercado et al 2017 and so on are available to simulate the hydrological and hydraulic process of flooding in this study a two dimensional inundation model pcswmm was employed pcswmm developed by chi canada was widely applied in the simulation of surface hydrological processes and drainage network flows denault et al 2006 meierdiercks et al 2010 ahiablame and shakya 2016 xu et al 2018b the dynamic wave method akbari and barati 2012 barati et al 2013 was used to calculate the hydraulic simulation of the drainage conduit uncertainty is an attribute of the hydrological model which comes from model structural errors observation data errors input errors parameter errors etc correctly evaluating the uncertainty of hydrological model is of great significance in improving the accuracy of urban flood simulation thorndahl et al 2008 in the study the generalized likelihood uncertainty estimation glue method was applied for uncertainty analysis which has been widely applied in the field of hydrology beven and binley 1992 thorndahl et al 2008 freni et al 2009 sun et al 2014 the main steps of the glue method are as follows 1 determining value ranges of parameters and their prior distributions e g uniform distributions 2 randomly sampling parameter sets using a monte carlo mc technique and running the hydrological model with the generated samples 3 defining the likelihood function and calculating the likelihood measures for each parameter set in the study the likelihood function was defined as follows thorndahl et al 2008 1 l θ k 1 n exp s k o k 2 o k 2 where l denotes the likelihood value θ denotes the uncertain parameter sets sk denotes the simulated inundation depth at the kth site ok denotes the observed inundation depth at the kth site n denotes the number of observations 4 selecting valid parameter sets e g likelihood values are higher than 0 9 and resampling according to the likelihood values to obtain the marginal posterior distribution of uncertain parameters 2 1 3 step 3 establishment of socu model 1 objective function the design objective of socu model is to minimize the total cost including the investment cost of drainage facilities and flood damages the investment cost of drainage facilities mainly refer to the sum of investment cost in different time steps for a staged optimization model with m time steps the investment cost can be defined as follows 2 ic j 1 m i 1 s c i p v i i d j where ic denotes the total present investment cost pvi denotes the capacity of the ith drainage facility e g pump station storage tank and so on ci denotes the unit cost of ith drainage facility s denotes the number of drainage facility idj denotes the investment discount factor for each time step j which can be calculated by following equation maharjan et al 2009 3 i d j 1 1 r j 1 δ t δ t 2 where t denotes time duration of each time step r denotes the discount rate in this study the flood damage is computed in terms of expected annual damage eq 4 4 ead f 0 d f d f where ead is the expected annual damage d f is the flood damage caused by the flood event with the occurrence frequency f in order to simplify the calculations the continuous integral of eq 4 is written as a series of return periods 5 year 10 year 20 year and 50 year according to maharjan et al 2009 and xu et al 2018a thus the flood damage function can be expressed as 5 fc j 1 m i 1 p v i 1 v i 2 c f 1 r i 1 r i 1 j f d j 6 f d j i 0 δ t 1 1 1 r j 1 δ t i where fc denotes the total present flood damage m denotes the number of time steps p denotes the number of discretized return periods 5 year 10 year 20 year 50 year ri denotes the ith return period of the flood event vi denotes the inundation volume by the flood event with the return period of ri cf denotes the flood unit cost fdj denotes the flood discount factor for each time step j thus the objective function total cost function can be described as 7 z min ic f c 2 chance constrained programming model considering the uncertainty from urban hydrological simulation uncertain parameters e g sub catchment characteristic width w and conduit roughness n are usually quantitatively represented as stochastic distributions he et al 2006 xie et al 2011 bastin et al 2013 dong et al 2015 therefore a chance constrained programming ccp model one of the main methods of stochastic mathematical programming was employed to deal with the uncertainty of the optimization model the ccp model is applicable to solve the reliability problem of satisfying system constraints under uncertain conditions which can provide information on the trade off between the total investment and the risk of being flooded which would be valuable to decision makers a typical ccp model can be formulated as follows charnes and cooper 1963 8 min f x ξ subject to 9 h x 0 i 1 2 k 10 pr g j x ξ 0 α j j 1 2 q where f denotes the objective function x denotes the decision variable ξ denotes the stochastic parameter h denotes the constraint function without stochastic parameters g denotes the constraint function with stochastic parameters α denotes constraint satisfaction probability k denotes the total number of deterministic constraints q denotes the total number of stochastic constraints in this study the socu model for urban drainage system design could be written as follows based on the above objective function and ccp model 11 m i n z j 1 m i 1 s c i p v i i d j j 1 m i 1 p v i 1 v i 2 c f 1 r i 1 r i 1 j f d j subject to 12 pr q p v ξ r p γ ξ r p α 13 i 1 s c i p v i j b u j 14 0 p v i δ i where pr denotes the probability of satisfying the stochastic constraint q denotes total surcharging volume calculated by the hydrological model ξ denotes the stochastic parameters e g sub catchment characteristic width and conduit roughness representing the uncertainty associated with the hydrological model which are posterior uncertain parameters derived by mc based glue method rp denotes the design rainfall in different time steps under the climate change condition γ denotes the acceptable surcharging volume i e surcharge threshold α denotes constraint satisfaction probability buj denotes the maximum investment amount during jth time step δi denotes the maximum capacity of the ith drainage facility pr could be calculated as follows 15 pr n k n t where nt denotes the number of calculation conditions of the hydrological model nk denotes the number of calculation conditions which satisfy the constraint of q γ 2 1 4 step 4 execution of socu model a heuristic technique genetic algorithm ga was employed to solve the socu model which is one of the most widely used techniques for optimal stormwater management planning zhen et al 2004 maharjan et al 2009 cimorelli et al 2016 xu et al 2018a the ga is a global search technique based on the procedure of initiation selection crossover and mutation in the study the ga was programmed in the matlab environment and real number based chromosomes were adopted the parameters of the model were determined by trial and error and the values recommended in relevant studies xu et al 2018a a population size of 20 a generation size of 400 a crossover probability of 0 7 and a mutation probability of 0 3 were set in the optimization model 2 2 case study 2 2 1 study area and data in order to test the proposed optimization scheme haidian island located in the northern part of haikou in hainan province china was taken as a case study the terrain of haidian island is relatively flat fig 2 and this area is one of regions most seriously and frequently influenced by typhoons in china therefore it is prone to floods due to flat terrain and the effect of typhoons xu et al 2018c xu et al 2019 the data used in this study include elevation data river data conduit data rainfall data and observations of historical flood events elevation data was accessed from the institute of geographic sciences and natural resources research chinese academy of sciences http www resdc cn default aspx river data and conduit data were provided by haikou municipal water authority observations of historical storm events were obtained through field investigation during typhoon rammasun on july 2014 long term rainfall observations were obtained from the china meteorological administration meteorological data center http data cma cn data cdcdetail datacode a 0012 0001 html the design rainfall in different time steps was calculated by statistical analysis method since global or regional circulation models require lots of meteorological data and have great uncertainty technical details of design rainfall analysis method can be found in mailhot and duchesne 2010 this method assumes that the parameter of rainfall distribution e g generalized extreme value function is linear interpolation according to the historical rainfall data firstly the generalized extreme values gev function was used to describe rainfall distribution with location parameter ξ 122 51 scale parameter α 46 78 and shape parameter k 0 115 in haidian island the design rainfall e g the return period of 5 year 10 year 20 year 50 year in 2012 was calculated by the above gev function the temporal distribution of the design rainfall was the same as that of the rainfall event on july 18 2014 based on the severe flooding scenario then considering climate change the location parameter ξ is a linear function of time and the increase rate b 2 53 mm year according to the historical rainfall data and the design rainfall in 2020 and 2030 can be calculated table 1 fig 2c presents the design rainfall process with the return period of 50 years in different time steps the projected maximum value of hour rainfall will increase about 13 from 100 mm h to 113 mm h in consideration of climate change in 2030 which will cause worse flood conditions therefore it is necessary to take account of the effect of climate change on urban drainage system design 2 2 2 urban hydrological model uncertainty analysis based on glue method the pcswmm model of haidian island has been described and calibrated in xu et al 2018b the glue method was applied for uncertainty analysis considering that the objective of this study is to evaluate the effect of urban hydrological model uncertainty on drainage design sub catchment characteristic width w and conduit roughness n which are the most sensitive parameters for the hydrological model were selected for uncertainty analysis based on the sensitivity test and the recommendation of previous literatures zaghloul 1983 zhao et al 2009 since the sub catchment characteristic width varies in different sub catchments the relative percentage change of w was employed for uncertainty analysis the uniform distributions were adopted as prior distributions since prior ranges of parameter sets should be broad enough to cover all possible parameter values and to reflect substantial uncertainty in parameters sun et al 2014 the value ranges of w and n were set to 0 5 to 3 0 and 0 005 to 0 03 respectively based on the recommended ranges from relevant references rossman 2015 a total of 1000 parameter sets were sampled from prior distributions using a monte carlo technique the likelihood values of parameter sets being higher than 0 9 were accepted as posterior samples fig 3 illustrates the scatter plots of likelihood values and sub catchment characteristic width and conduit roughness as shown in fig 3 the likelihood values both have obvious peak values with the increase of w and n indicating that these parameters are significantly sensitive to the hydrological model and have large influences on the simulation output these posterior samples can be used to calculate the probability of satisfying the stochastic constraint in eq 12 2 2 3 model setup according to the guidelines of urban drainage design released by ministry of housing and urban rural development of people s republic of china http www mohurd gov cn wjfb 201306 t20 130627 214142 html the drainage system in haidian island was designed to handle a 50 year rainfall event before 2030 and the design base year was set to 2012 in this study for convenience of methodology demonstration the drainage facility was implemented in two stages including short term 2020 and long term 2030 construction in our previous work lian et al 2017 pumping facilities were effective and economical choices in haidian island due to the flat terrain fig 2b and high tide blocking therefore pumping facilities were adopted in haidian island the locations of the pumping facilities were selected in the highest flood risk areas based on our previous work xu et al 2018b additionally in haidian island the dongpo lake i e storage a in fig 6b and qiuhai lake i e storage b in fig 6b have been planned as storage projects by haikou municipal water authority and the storage capacity of the dongpo lake and qiuhai lake is 126 000 m3 and 389 000 m3 respectively xu et al 2018b in the optimization model a variety of parameters need to be set as model inputs including the unit cost of the pumping facility c the discount rate r the flood unit cost cf the acceptable surcharging volume γ constraint satisfaction probability α the maximum investment amount bu1 and bu2 the maximum capacity of the pumping facility δ these parameters were determined based on the actual circumstances of the study area field investigation and recommendations from relevant references 1 c and r were set to 3 million yuan and 0 08 respectively based on recommendations from relevant references lian et al 2017 xu et al 2018a 2 cf was set to 258 yuan surveyed by two flooding events in the study area in october 2010 and july 2014 3 γ and δ were initially set as 600 000 m3 and 80 m3 s respectively based on trial and error 4 α was initially set as 0 9 5 bu1 and bu2 were assumed to 0 8 billion yuan and 1 0 billion yuan respectively according to the local financial investment plan the sensitivity of above parameters was also explored in this study in the optimization model the submerged volume vi calculated by pcswmm changes with the capacity of drainage systems i e the decision variable of the optimization model to facilitate the connection between the optimization model and pcswmm model following methods can be adopted 1 before running the optimization model the relationship between submerged volume and the capacity of drainage systems can be fitted by a regression equation through a large number of hydraulic simulations then the fitted equation is substituted into the optimization model 2 in each solution evaluated by ga the hydraulic behavior of the drainage system is simulated by the pcswmm model and then extract the necessary information e g submerged volume from pcswmm model to the optimization model since the computation time of pcswmm model is relatively long e g the average computation time is about 5 h on a pc with single cpui5 3 2 ghz configuration the first way was adopted in this study to efficiently achieve the numerical optimization process under uncertainty conditions the fitted equations between submerged volume v and the capacity of drainage systems pv are described in table 2 3 results and discussions 3 1 optimal solution of socu model a number of different trials with different random seeds are used to ascertain the robustness of the optimization model the 10 trials in fig 4 are the representative of different trials in order to describe optimal pumping capacity and corresponding total present cost fig 4 shows that the total present costs of the optimization model are all located at around 185 million yuan the optimal total present cost is 183 million yuan trial 6 with the flood cost of 78 million yuan 43 and the investment cost of 105 million yuan 57 shown in fig 5 the optimal solution shows that a pumping capacity of 28 3 m3 s should be constructed in 2012 2020 and then extended to 38 4 m3 s in 2020 2030 the pumping capacity of 28 3 m3 s and 38 4 m3 s refer to the sum of the capacities of pump stations c g in fig 6 b the location and the distribution ratio of the pumping capacity of pump stations c g were determined based on our previous work xu et al 2018b as shown in fig 6b inundation depths are extremely low after implementing the above new drainage facilities when compared with those in fig 6a thus the new drainage system for this area will be able to handle a 50 year rainfall event in 2030 as shown in fig 5 if drainage facilities were completely implemented in the first year to handle a 50 year rainfall event in 2030 i e implement once design the total present cost i e investment cost was more than 200 million yuan which was much higher than that of socu model since the time value of money was taken into account thus the staged design is a significant financial saving and this is only one of advantages of this approach the staged design can also make the decision making more flexible as it is possible for decision makers to revise some decisions made today according to more sufficient information on a future date for example for a project with 50 year life span e g from 2020 year to 2070 year the drainage facilities which are adequate at the beginning of the project may not be able to meet the drainage requirements at 2050 year because of climate change hence supplemental drainage facilities e g pumps and storage tanks can be implemented and designed based on historical rainfall before 2050 year instead of 2020 year which could reduce the uncertainty caused by rainfall 3 2 influence of climate change and hydrological model uncertainty in order to improve the reliability of urban drainage design the climate change and hydrological model uncertainty were taken into account in the optimization model for urban drainage designs as we all known climate change has an influence on rainfall and the investment of drainage system but the quantification of the influence is a question worth exploring fig 7 illustrates the comparison of the total present cost under the climate change and stationarity scenario the total present cost would increase from 121 million yuan to 127 million yuan under stationarity scenario and from 166 million yuan to 195 million yuan under climate change scenario respectively when the constraint satisfaction probability increases from 0 75 to 0 95 the total present cost under climate change scenario would increase on average 1 4 times than that under present scenario it reveals that climate change has a respectively significant influence on the investment of drainage system furthermore the solutions under stationarity scenario would inevitably lead to the flood risk under future climate change conditions when the stationarity solutions are implemented but with increased rainfall due to climate change the surcharging probabilities i e the total surcharging volume exceeds the corresponding threshold were all higher than 50 as shown in fig 7 grey bar which demonstrates that the solution with consideration of climate change is more reliable fig 8 shows the influence of hydrological model uncertainty on the drainage design the total present cost of the deterministic optimization model i e without considering hydrological model uncertainty is 147 million yuan which is lower than the result of socu model 183 million yuan the deterministic solutions would lead to flooding problems due to the hydrological model uncertainty and the surcharging probability is 52 which indicates that although the deterministic model saves some investment cost the model results lack sufficient reliability 3 3 influence of constraint satisfaction probability and surcharge threshold the socu model not only has the above mentioned reliability but also could provide richer decision making information for decision makers fig 9 presents the relationship between constraint satisfaction probability i e system safety probability and total system investment obviously the total present cost would increase with an increase of the constraint satisfaction probability when the constraint satisfaction probability increases from 0 75 to 0 95 the total present cost increases from 166 million yuan to 195 million yuan which could help decision makers conduct a trade off analysis between total system investment and the flooding risk for instance when the constraint satisfaction probability increases from 0 75 to 0 85 the total present cost increases slowly in haidian island however the total present cost increases obviously when the constraint satisfaction probability increases from 0 85 to 0 95 therefore in order to achieve a high level of system safety and save the investment the constraint satisfaction probability of 0 85 is recommended similar decision making information for decision makers can also be given in fig 10 fig 10 shows the relationship between surcharge threshold i e the threshold of total surcharge volume and system investment the maximum surcharge volume was taken as 680000 m3 by the high flood risk area described in xu et al 2018b and the allowed maximum submerged depth i e 0 3 m in yin et al 2016a with the increase of the surcharge threshold the total present cost decreases from 183 million to 147 million yuan which was mainly due to the decrease of drainage facility investment cost furthermore the total present cost increase greatly from 151 million yuan to 183 million yuan when the surcharge threshold decrease from 640 000 m3 to 600 000 m3 whereas the total present cost only increase slightly from 147 million yuan to 151 million yuan with the decrease of the surcharge threshold from 680 000 m3 to 640 000 m3 it indicates that it is more economical to set the surcharge threshold as 640 000 m3 for the haidian island 3 4 socu model parameter sensitivity analysis in the optimization model some parameters were initially determined according to the actual circumstances of the study area field investigation and recommendations from relevant references when these parameters change it may have an influence on the optimization cost function thus the sensitivity analysis of these parameters including flood unit cost pump unit cost the discount rate and rainfall increase rate needs to be carried out as shown in fig 11 the total present cost would increase linearly with the increase of the flood unit cost and the pump unit cost when the discount rate increases from 0 02 to 0 12 the total present cost shows a logarithmic decrease from 364 million yuan to 128 million yuan with the increase in rainfall increase rate an exponential increase of the total present cost is observed through the fitted exponential equation decision makers could evaluate the climate change effects on the drainage system investment for instance the total present cost increases 80 million yuan when the rainfall increase rate is 10 furthermore the total present costs would change with a specific trend in terms of the data parameters changing which illustrates that the trends of the model s features are not affected by the assumptions 3 5 advantages and deficiencies of the proposed model in the study a staged optimization model considering climate change and hydrological model uncertainty was proposed for urban drainage design in addition to the advantages mentioned above the proposed model has the potential to be widely applied for other types of drainage designs e g storage tanks design drainage conduit size design and so on however the proposed approach also has certain deficiencies first climate change and rapid urbanization both have an effect on rainfall and land surface in this study underlying surface change was not considered in urban hydrological model due to data constraints and the uncertainty of design rainfall in the climate change estimates has not been taken into account this is also our future work when we use the staged optimization model for other areas second the limitation of indirect economic data in the study area restricts the quantification of flood damages the flooding cost includes economic losses and non economic losses the economic losses mainly refer to financial cost the non economic losses include huge social environmental costs and sometimes even loss of life referring to maharjan et al 2009 and xu et al 2018a the financial cost was taken into account since indirect economic losses are difficult to quantify a future research work would be to improve the accurate quantification of the flood damage finally for convenience of methodology demonstration and considering the actual circumstances of the study area only two stages and pumping facility were analyzed in this study more stages and more types of drainage facilities e g increase drainage conduit size improve flow capacity of rivers and so on are required to be explored in the future work 4 conclusions the optimization model is an effective way for seeking cost effective solutions in urban drainage system design however the previous optimization models rarely take climate change and urban hydrological model uncertainty into consideration in this study a more reliable optimization model i e socu model for urban drainage design was proposed based on an integration of staged optimization policy urban hydrological model mc based glue method ccp model and heuristic algorithm first the required data of the socu model were collected and the projected design rainfall in future conditions was analyzed as input data for urban hydrological model in different time steps second a two dimensional inundation model of the study area was established by pcsmm and the uncertainty of the hydrological model was investigated based on glue method third considering the uncertainty from urban hydrological simulation as well as the effects of climate change on designed rainfall a ccp model was employed to deal with uncertainty of the optimization model the posterior samples of hydrological parameters obtained from glue method were used to calculate the probability of satisfying the stochastic constraint finally genetic algorithm was adopted to solve the socu model due to its easy implementation simplicity and efficiency in application subsequently a case study of the haidian island was used to demonstrate the proposed model the result shows that the socu model not only has more flexibility to adapt to climate change but also is a significant financial saving 10 lower than traditional implement once plan since the climate change and hydrological model uncertainty were simultaneously considered the urban drainage system design obtained from the socu model would be more reliable and robust furthermore the proposed model could help decision makers better understand the potential effects of climate change and hydrological model uncertainty on drainage design and seek a trade off between system investment and acceptable flood damage the study outcomes may have profound implications and contributions for urban flood management credit authorship contribution statement hongshi xu conceptualization methodology software writing original draft writing review editing visualization chao ma methodology validation investigation writing review editing funding acquisition kui xu conceptualization software writing original draft writing review editing jijian lian validation resources funding acquisition yan long visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was supported by national key research and development program of china 2018yfc1508005 national natural science foundation of china 51679159 51722906 the science fund for creative research groups of the national natural science foundation of china 51621092 and the program of introducing talents of discipline to universities b14012 additionally our cordial gratitude should be extended to the editor and three anonymous reviewers for their professional and pertinent comments and suggestions which are greatly helpful for further quality improvement of this manuscript 
5413,the hydrological regimes in permafrost dominated catchments have unique characteristics however studies based on plot scale experiments of runoff generation processes and the factors influencing these processes are limited on the tibetan plateau which is experiencing rapid warming and permafrost degradation runoff generation processes were studied on a standard runoff plot 5 20 m in a permafrost dominated catchment on the tibetan plateau with an alpine meadow cover to analyze these processes during the spring summer transition period from mid may to early june and in the summer months of june and july the discharge including surface and subsurface runoff the soil hydrothermal and moisture conditions and the meteorological conditions were monitored from may 2018 to may 2019 partial least squares path modeling was used to identify the influencing factors in the two time periods the lateral subsurface flow at 30 60 cm depth accounted for the majority of the discharge from the runoff plot 99 and showed a sharp increase when the soil water contents of the thawed soil layers exceeded a threshold value that varied from 0 41 to 0 52 during the spring summer transition period the lateral subsurface flow at 30 60 cm depth was promoted by both event precipitation and the antecedent precipitation with an average runoff ratio of 1 7 indicating that the antecedent moisture condition maintained by the underlying permafrost drives runoff generation via meltwater from snow and frozen soil in the summer months the lateral subsurface flow at 30 60 cm depth was directly promoted by event precipitation especially the moderate precipitation that occurred in this period with a reduced runoff ratio of 0 5 as a result of deepening of the thawed soil layer from 30 to 60 cm enhanced evapotranspiration and an increased soil water storage capacity caused by an increase of air temperature and the soil temperature prediction models obtained via multiple linear regressions of the identified influencing factors were able to accurately estimate the discharge this study shows the important role of lateral subsurface flow in runoff generation processes in this permafrost area and the most important influencing factors in different seasons abbreviations amc antecedent moisture condition ap antecedent precipitation swc soil water content ssf subsurface flow sswl saturated soil water level sws soil water storage keywords permafrost dominated catchments influencing factors runoff generation processes subsurface flow 1 introduction the hydrological regimes of permafrost catchments are influenced by the air temperature through ground freeze thaw processes which alter the soil properties that are associated with the hydrology walvoord and kurylyk 2016 lafrenière and lamoureux 2019 the freezing state of soils has a remarkable influence on hydrological processes due to the low hydraulic conductivity of the frozen layers walvoord and kurylyk 2016 the seasonal change in the thawed depth has a strong control on flow pathways and the export of water from the hillslope to streamflow woo and guan 2006 helbig et al 2013 rogger et al 2017 the hydrological regimes in permafrost catchments therefore have unique characteristics that alter the near surface drainage resulting in the weak connections between the surface water system and the deep groundwater system tetzlaff et al 2015 and the higher export of runoff from the hillslope to stream channels in permafrost catchments than in non permafrost catchments woo et al 2008 rogger et al 2017 coles and mcdonnell 2018 studies have shown that recent climate warming and permafrost degradation have significantly altered the hydrological regimes in permafrost catchments quinton and baltzer 2013 connon et al 2014 streletskiy et al 2015 walvoord and kurylyk 2016 the advance of the initial thawing time of surface frozen soil might lead to an increase in the infiltration of snowmelt and hence a decrease in spring runoff scherler et al 2010 walvoord and kurylyk 2016 the thickening of the active layer could lead to an increase in the soil storage capacity and a decrease in streamflow in permafrost dominated catchments carey and debeer 2008 kurylyk et al 2016 sjöberg et al 2016 the complete disappearance of permafrost would reduce flood peaks and increase runoff during the recession rogger et al 2017 the tibetan plateau tp is the only region on earth where permafrost is present at mid latitudes the permafrost catchments on the tp are sensitive to the rapid increase in temperature over the past five decades twice of the global average yao et al 2004 2019 wang et al 2009a 2010 zhang et al 2020 and the total area of thermally degraded permafrost in 2000s is only 88 of the permafrost area observed in the 1960s ran et al 2018 as the headwater area of more than ten large asiatic rivers including the yangtze yellow and ganges rivers the water storage and supply functions of the tp are facing great challenges under the recent accelerating warming and permafrost degradation which is unprecedented in the last few thousand years immerzeel et al 2010 yao et al 2012 2015 2019 wu et al 2015 the complex runoff generation processes in permafrost dominated catchments may also be associated with changes in the characteristics of precipitation and the threshold effect in the relationship between the soil water content swc and runoff tetzlaff et al 2015 walvoord and kurylyk 2016 precipitation has a controlling role on the changes in the runoff in permafrost dominated catchments on the tp with a limited contribution from glacial meltwater zhang et al 2011 2013 liu et al 2014 gao et al 2018 the threshold relationship between the swc and runoff suggests that hillslope runoff or streamflow may show a sharp increase after the swc has exceeded a specific threshold value this threshold effect which has been reported in forested e g farrick and branfireun 2014 agricultural radatz et al 2013 and headwater catchments e g ali et al 2015 challenges the hydrological model in which the generation of hillslope runoff or the response of streamflow to rainfall or snowmelt is linear mcdonnell 2003 2013 hydrometric observation at the plot scale is a basic effective and widely used method to study runoff generation processes and the factors influencing these processes freer et al 2002 zhao et al 2013 tromp van meerveld et al 2015 rushlow and godsey 2017 hu et al 2020 however there has only been a limited number of studies of runoff generation processes in permafrost catchments on the tp due to the harsh natural conditions this study aimed 1 to identify the main runoff generation pattern and the redistribution of precipitation in runoff generation processes 2 to understand the threshold effect based on the relationship between the swc and discharge from the runoff plot and 3 to quantify the influences of various factors on discharge from the runoff plot and to determine the most important factors in the spring summer transition period and the summer months 2 site description the study area is located in the yakou catchment 1 5 km2 qinghai province china this is a permafrost dominated catchment in the middle segment of qilian mountain and has a continental climate fig 1 a according to the three year observational data january 2015 december 2017 at the yakou automatic weather station liu et al 2018 che et al 2019 the annual average temperature is about 4 7 c with the minimum and maximum monthly temperatures occurring in january and july respectively fig 1b the average annual precipitation is about 405 mm with the majority of precipitation 84 occurring in the period from may to september fig 1c snowfall and rainfall are the main forms of precipitation from november to the following mid may and from early june to september respectively and alternate in the other months li et al 2009 the monthly average air temperature was 0 c from june to september fig 1b the observation period of this study was therefore divided into two periods 1 a spring summer transition period from mid may to early june and 2 the summer months from early june to september fig 1a shows that the main land cover and soil type change with the hillslope position with alpine swamp meadow and organic cryic gleysols in the riparian zone alpine meadows and mat cryic cambisols on the middle slope and alpine desert and cryogenic cambisols on the up slope the soil thickness also varies greatly along the slope being shallow on the steep up slope 20 but thick on gentle or lower terrain such as in the riparian zone 7 the vegetation cover decreases with increasing elevation with about 98 90 and 60 in the riparian zone on the middle slope and on the up slope respectively there is a wide distribution of permafrost in the south facing catchments such as the yakou catchment on the northeastern tibetan plateau as a result of the thin snow cover in winter by contrast the permafrost in an adjacent catchment about 140 km away is 10 m thick wang et al 2013 the maximum thickness of the thawed soil layer in the yakou catchment ranges from about 100 cm in the riparian zone to about 160 cm at the top slope at an elevation of 4147 m where the initial thawing of the surface soil starts around mid may li et al 2009 xiao et al 2020 the hydrothermal conditions of frozen soil have been a noticeable influence on streamflow generation processes yang et al 1993 the surface soil moisture and streamflow increase greatly with the input of snowmelt during the period of thaw yang et al 1992 the streamflow at the outlet of the yakou catchment is entirely frozen from november to the following april thawed water begins to flow under the thick ice in early may and the thaw is complete in june 3 materials and methods a standard runoff plot was constructed to observe surface runoff and lateral subsurface flow ssf at two depths the swc soil temperature and sswl were also observed the precipitation and air temperature were observed at the top of yakou catchment the observations were carried out from may 12 2018 to may 9 2019 3 1 runoff plot and observations a standard runoff plot 5 m wide and 20 m along the hillslope was constructed on the middle slope of the yakou catchment at an elevation of 4000 m fig 1a tin plates were placed vertically around the boundary of the runoff plot at 60 cm depth three header tanks were installed at three depths at the surface and at 30 and 60 cm at the outlet of the plot the selection of the depths was based on the different soil layers a sod layer and humus layer at 0 30 cm and a leached layer and illuvial layer at 30 60 cm depth the surface runoff lateral ssf at 0 30 cm and lateral ssf at 30 60 cm depth were collected separately at the outlet and recorded automatically by tipping bucket flow meters with a maximum resolution of 1 s xyz i northeast institute of geography and agroecology chinese academy of sciences the shallow ssf was supra permafrost water in the thawed soil layer a detailed description and figures of the observations of the runoff plot discharge can be found in xiao et al 2020 3 2 observations of precipitation swc soil temperature and sswl both liquid and solid precipitation at the yakou meteorological station were measured by storage type rain gages t200b geonor norway fig 1a a vertical soil profile was established next to the standard runoff plot to measure the swc and soil temperature soil temperature and moisture sensors ech2o 5tm decagon usa were installed at depths of 5 10 20 40 and 60 cm the volumetric swc and soil temperature were recorded every 30 min by the sensors and the recorded data were stored in a data logger em50 decagon usa the measurement accuracies were 0 03 m3 m 3 for the volumetric swc and 0 1 c for the soil temperature the profile was backfilled with the excavated soils after the installation of the sensors the continuous change in the sswl was recorded at the bottom of a 1 m deep monitoring well next to the standard runoff plot using a hobo water level logger u20 001 04 onset usa at 30 min intervals the sswl was only monitored from june 4 to september 30 2018 because the bottom of the saturated soil water well was frozen during the rest of the time 3 3 determination of the antecedent moisture condition runoff ratio and soil water storage previous studies used either the antecedent runoff plot discharge or ap e g inamdar and mitchell 2007 james and roulet 2007 farrick and branfireun 2014 von freyberg et al 2014 as the proxy for the antecedent moisture conditions amcs in this study because the discharge from the runoff plot was intermittent the ap proxy which showed more signals was chosen according to inamdar and mitchell 2007 the ap index is defined as the cumulative precipitation within the previous five and ten days ap5 and ap10 and can therefore be used to represent the amcs to further analyze the influence of antecedent snowfall or rainfall on discharge from the runoff plot the runoff ratio of the runoff plot discharge was calculated by the runoff discharge depth mm runoff discharge volume divided by the plot area divided by precipitation mm during a certain time period the soil water storage sws above a depth of 60 cm was calculated by the following equation hu et al 2009 1 sws i 1 n sw c i d i where n 5 is the number of observed depths i e 5 10 20 40 and 60 cm representing the corresponding soil layers i e 0 5 5 10 10 20 20 40 and 40 60 cm swci is the volumetric swc at the ith soil layer di is the soil depth of the ith soil layer the unit of sws is mm 3 4 partial least squares path modeling and multiple linear regressions partial least squares path modeling pls pm was used to analyze the influence of various factors on the discharge from the runoff plot pls pm is the partial least squares approach to structural equation modeling and provides a framework for analyzing multiple relationships among a set of blocks of variables or data tables sanchez 2013 the analysis of pls pm was completed using the pls pm package in r there are two kinds of variables in pls pm a manifest variable that can be measured or observed directly a latent variable which is referred to as a solo manifest variable or several manifest variables there are two kinds of model in pls pm an inner model a structural model representing the relationship among latent variables and an outer model a measurement model to define which manifest variables of the data set are associated with which latent variables sanchez 2013 ravand and baghaei 2016 the structural model proposed in this study consists of six latent variables runoff precipitation the soil moisture condition smc air temperature soil temperature and the amc each latent variable is referred by the solo manifest variable or several manifest variables for example the daily precipitation mm and the daily lateral ssf l at 30 60 cm depth are associated with precipitation and runoff respectively the daily average swcs m3 m 3 at 0 30 and 30 60 cm depth the daily average sws mm at 0 60 cm depth and the daily average sswl cm are associated with the smc the daily average maximum and minimum air temperature c and daily accumulated positive temperatures above 0 c c are associated with the air temperature the daily average soil temperature c at 0 30 cm and 30 60 cm depth are associated with the soil temperature ap5 and ap10 mm are associated with the amc the path diagram of pls pm including manifest and latent variables is shown in fig 2 p r st at and apt 0 c represent precipitation runoff soil temperature air temperature and accumulated positive temperatures above 0 c respectively in the results of the pls pm the influences among the latent variables were represented by a combination of the estimated value and the p value separately in the two time periods sanchez 2013 ravand and baghaei 2016 multiple linear regressions mlrs were used to build the prediction model of the dependent variable i e the discharge of lateral ssf at 30 60 cm depth using two or more independent variables the independent variables in this study included the daily precipitation mm the daily average swc m3 m 3 at 0 30 and 30 60 cm depth the daily average sws mm at 0 60 cm depth the daily average sswl cm the daily average maximum and minimum air temperatures c the daily accumulated positive temperatures above 0 c c the daily average soil temperature c at 0 30 and 30 60 cm depth and ap5 and ap10 mm a linear regression model was fitted to the data to determine the relationships between the daily lateral ssf at 30 60 cm depth and the independent variables and a stepwise regression method were applied in mlrs using spss for windows version 22 0 spss inc spss statistics 22 0 all the independent variables were taken as input variables and one or more independent variables were retained in the prediction models in the spss output r2 of the prediction model represents the proportion of the total variation in the n observed values of the dependent variable that is explained by the overall regression model the higher the value of r2 the better the model fits the data ghani and ahmad 2010 therefore the model with a higher r2 and p 0 05 was used to determine the relationships between the daily lateral ssf at 30 60 cm depth and the independent variables 4 results 4 1 time series of runoff plot discharge precipitation air temperature soil temperature and smc the air temperature showed both diurnal fluctuation and seasonal variations with the annual maximum in late july fig 3 a the night time air temperature was mainly 0 c during june july and august under the influence of the air temperature the soil temperatures of the shallow layers at 5 10 and 20 cm depth showed a higher temporal variation than the soil temperatures of the lower layers at 40 and 60 cm depth fig 3b the soil temperatures of the shallow layers reached the annual maximum in late july synchronized with the air temperature whereas soil temperatures of the lower layers reached the annual maximum about one month later in early september before mid september the deeper the soil depth then the lower the daily average soil temperature this order was reversed after mid september the distribution of precipitation was uneven during the observation period fig 3a moderate or heavier precipitation i e the daily precipitation daily precipitation 10 mm mainly occurred in two periods in mid may and from mid july to early august fig 3a the swc in each layer showed a sharp increase at the time of initial thawing fig 3b c indicating the supply of thawed soil water after thawing the fluctuation in the swc especially in the shallow layers was mainly in response to the infiltration of precipitation evapotranspiration and the drainage of soil water the relatively stable swc of the thawed lower layers indicated the limited impact of evapotranspiration and the potential balance between infiltration and soil water drainage the missing soil temperatures and soil water content data for the 60 cm soil layer from june 1 to june 28 2018 in fig 3b and c might be due to the poor contact between the soil sensor and the surrounding soil during the thawing processes the sswl showed abrupt fluctuations the negative values represent the distance of the water surface below the ground surface fig 3d the rising limbs of the sswl curve were sharper than the recession limbs which indicated the response to the intermittent supply of water from precipitation and the slower but continuous consumption of water via evapotranspiration and the drainage of soil water the maximum sswl rose to 28 cm below the ground surface and decreased to lower than 100 cm below the ground surface where the data logger was installed surface runoff was the main pattern of the discharge from the runoff plot from early march to early may 2019 fig 3d under the influence of the low air temperature and the thin layer of thawed soil comparison of the runoff components above 60 cm from may to july 2018 showed little surface runoff and the lateral ssf at 0 30 cm but the dominance of the lateral ssf at 30 60 cm depth which showed a strong variation figs 3c and 4 h with the input of precipitation and the temporal variation of smc such as the swc and sswl fig 4 compares the monthly data for the lateral ssf runoff ratio and other variables because the soil temperatures indicated that the observed soil layers were frozen from october 2018 to may 2019 fig 4b c only the active subsurface hydrological activities from may to september 2018 are discussed here with the appearance of positive air temperature and thus snowmelt and the initial thawing of the surface soil layer in may a lateral ssf was generated at 30 60 cm depth with the highest runoff ratio fig 4a d h and i with a similar amount of precipitation but thawing of the deeper soil layers and increasing swc and sws both the lateral ssf and runoff ratio at 30 60 cm depth decreased in june fig 4b i the peak of the lateral ssf at 30 60 cm depth promoted by moderate or heavy rainfall was observed in july with a sharp increase in precipitation but the runoff ratio was close to the june value and lower than the may value as a result of the increase in the swc and sws fig 4d i the average runoff ratios in the spring summer transition period of may and summer months of june and july were 1 7 and 0 5 respectively the precipitation was relatively high in august and september fig 4d but the contemporaneous lateral ssf at 30 60 cm depth and the runoff ratio were extremely low figs 3c and 4i the decreasing trend of precipitation from july to september fig 4d and the increase in the air temperature and soil temperatures of each soil layer figs 3a b and 4a c might have led to the low lateral ssf and runoff ratio during this period the disappearance of the lateral ssf at 30 60 cm depth in august could be due to the thawing of the deeper soil layer and deepening of the lateral ssf which could not be observed by the installed instruments this was verified by the reappearance of the lateral ssf at 30 60 cm depth in september with the increased sswl figs 3d and 4h it is therefore suggested that instruments should be installed at a deeper depth in future studies for the complete measurement of discharge from this runoff plot 4 2 threshold relationship between runoff and smc the relationship between runoff and smc was shown in fig 5 the red and black dots represent the results observed during the spring summer transition period from mid may to early june and the summer months from early june to the end of july respectively the vertical red and black dashed lines represent the threshold values of swcs and sws for the sharp increases in lateral the ssf at 30 60 cm depth during the spring summer transition period and the summer months respectively a clear obvious threshold effect and strong non linearity were seen in the relationship between the lateral ssf at 30 60 cm depth and the smc the swc in each soil layer the sws and the sswl especially during the summer months fig 5 black dots with the increase in smc the lateral ssf at 30 60 cm depth was at a stable and low value until the smc exceeded a threshold value and began to increase sharply the threshold values were roughly 0 41 0 52 0 47 0 43 and 0 42 for the swcs at 5 10 20 40 and 60 cm depth respectively and 370 mm for the sws fig 5 black dashed lines the threshold value for each soil layer in the summer months was close to the saturated swc and were 0 54 0 07 0 66 0 05 0 57 0 05 0 59 0 10 and 0 47 0 08 for the soil layers at 10 20 30 40 and 60 cm depth respectively xiao et al 2020 this indicates that the lateral ssf at 30 60 cm depth began to increase sharply after the smc reached saturation and the lateral ssf might be the main form of soil water drainage under this condition the relationship between the lateral ssf at 30 60 cm depth and the sswl also showed a clear threshold effect and the threshold value for the sswl related to the ssf at 30 60 cm depth was 75 cm fig 5g the relationship between the lateral ssf discharge at 30 60 cm depth and the sswl from mid may to june is not shown in fig 5g because the bottom of the saturated soil water well was frozen during this period the lateral ssf discharge at 30 60 cm depth might be high under low smc conditions such as when the swcs of all soil layers were low during the spring summer transition period fig 5a f red dots and the low swcs of the 40 and 60 cm depth soil layers during the summer months fig 5d e specifically the lateral ssf discharge at 30 60 cm depth showed sharp increases when the swcs at 5 10 20 40 and 60 cm depth reached roughly 0 34 0 17 0 17 0 18 and 0 22 and 220 mm for the sws fig 5 red dashed lines during the spring summer transition period and when the swcs at 40 and 60 cm reached roughly 0 23 during the summer months fig 5d e the threshold values of each soil layer during the spring summer transition period were lower than the threshold values of each soil layer during the summer months this might be due to the frozen state of each soil layer during the spring summer transition period and the 40 and 60 cm soil layers in june therefore the impermeable effect of the freezing front and the recharge of the infiltrated snowmelt and rainfall promoted lateral ssf at 30 60 cm depth when part of the soil layers was still frozen fig 4i the amcs during the summer month of july were separated into two conditions a higher amc with ap5 10 mm and a lower amc with ap5 10 mm fig 6 shows that the daily sswl and lateral ssf at 30 60 cm depth under the higher amc blue dots were generally higher than those under the lower amc black dots for the same daily precipitation condition this shows that a higher amc could lead to a higher sswl and lateral ssf at 30 60 cm depth during summer months with strong evapotranspiration the sswl increased noticeably with relatively low daily precipitation fig 6a daily precipitation 0 4 mm whereas the heavy lateral ssf at 30 60 cm depth only occurred with relatively high daily precipitation fig 6b daily precipitation from 8 to 20 mm the sswl increased first and then the saturated soil water was pushed out by infiltrated precipitation to generate the lateral ssf the high amc and sswl conditions were the precondition for the heavy lateral ssf at 30 60 cm depth the lateral ssf at 30 60 cm depth was absent under high sswls from august to september fig 3d which indicated that the lateral ssf was weak or shifted to the lower soil layers following the thickening of the active layer 4 3 results of pls pm and mlrs because the observed discharge from the runoff plot mainly occurred from mid may to the end of july the data set for this period was used in the pls pm and mlrs the results of the pls pm for the spring summer transition period and for the summer months from early june to the end of july are shown separately in fig 7 as shown in fig 7 the numbers and asterisks adjacent to the arrows represent estimated values and the significance of correlation the blue and red arrows represent positive and negative correlations respectively significant p 0 05 and highly significant p 0 01 correlations are represented by asterisks and double asterisks respectively gof represents the overall goodness of fit of pls pm the precipitation and the amc during the spring summer transition period showed highly significant p 0 01 strong influences on runoff with similar estimated values 0 54 and 0 46 for precipitation and amc respectively indicating that both event precipitation and the amc i e both rainfall and snowmelt were important factors in the generation of runoff during this period fig 7a the air temperature showed a highly significant p 0 01 influence on the soil temperature with an estimated value of 0 23 and the soil temperature showed a highly significant p 0 01 strong influence on the smc with a high estimated value of 0 90 showing that the increase in the soil moisture condition was driven by the thawing of frozen soil as the air temperature increased the soil temperature showed a non significant p 0 05 negative correlation with runoff with a low estimated value 0 28 and the smc showed a non significant p 0 05 weak positive influence on runoff with a low estimated value 0 06 verifying that the water released by thawing soil mainly supplied the smc instead of runoff fig 7b shows the results of the pls pm for the summer months from early june to the end of july the precipitation had a highly significant p 0 01 influence on runoff with a high estimated value 0 81 indicating that event precipitation was the most important factor in the generation of lateral ssf at 30 60 cm depth in this time period the amc showed a highly significant p 0 01 influence on the smc with an estimated value of 0 36 and precipitation showed a significant p 0 05 influence on the smc with a lower estimated value 0 15 showing that the amc facilitated by precipitation controlled the smc during the period under the influence of strong evapotranspiration the air temperature showed a highly significant p 0 01 strong influence on the soil temperature with a high estimated value 0 82 and the soil temperature showed a non significant p 0 05 negative influence on runoff with a low estimated value 0 04 showing that the increase in soil temperature had a negative effect on runoff during this period this might be due to the strong evaporation and expanding sws via the deepening of freezing front driven by the high air and soil temperatures based on the pls pm results the important factors directly influencing the lateral ssf at 30 60 cm depth were identified as precipitation and amc during the spring summer transition period and precipitation during the summer months the daily lateral ssf at 30 60 cm depth was further fitted with the independent variables using mlrs through screening the retained independent variables were in agreement with those of the pls pm in the prediction models for the spring summer transition period 2 ss f 30 60 c m 12 7 85 9 p 28 3 a p 5 r 2 0 57 p 0 05 if s m c s m c threshold v a l u e 0 if s m c s m c threshold v a l u e and the summer months 3 ss f 30 60 c m 141 5 161 6 p r 2 0 78 p 0 05 if s m c s m c threshold v a l u e 0 if s m c s m c threshold v a l u e the equations expressed the influence of precipitation daily precipitation and amc ap5 on the runoff well with relatively high r2 values 0 57 and 0 78 for the spring summer transition period and the summer months from early june to the end of july respectively and a low p value 0 05 these variables could therefore be used to accurately estimate the discharge from the runoff plot 5 discussion 5 1 runoff generation processes precipitation and meltwater redistribution and threshold effects from mid may to july 2018 the total lateral ssf at 30 60 cm depth was 223 8 mm which accounted for 99 6 of the total runoff this indicates that the soil layers at 30 60 cm depth were a hydrologically active layer in the runoff plot with underlying permafrost a schematic figure illustrating the hydrological regimes of the runoff plot was shown in fig 8 the runoff plot discharge ceased under the dry conditions during the spring summer transition period fig 8a or transferred to deeper soil layers with relatively slow velocity during the summer months fig 8b due to the absence of the saturated soil water at the 0 60 cm depth soil layers as a result of the continuous soil drainage or evapotranspiration under wet conditions the lateral ssf at 30 60 cm depth was promoted by the impermeable effect of the freezing front and the recharge of the infiltrated snowmelt and rainfall during the spring summer transition period fig 8c and the high sswl as a result of the input of moderate or heavy rainfall in the summer months fig 8d the dominant pattern of the lateral ssf at 30 60 cm depth and the high runoff ratios were consistent with other studies in subarctic regions i e the runoff in many permafrost catchments is dominated by the near surface drainage woo et al 2008 koch et al 2013 tetzlaff et al 2015 orgogozo et al 2019 many studies have emphasized the important role of high elevation permafrost regions in the runoff generation processes of the tp wang et al 2009b 2019 niu et al 2011 gao et al 2016 wang et al 2009b showed that the streamflow generated from the alpine cryosphere above 3600 m a s l accounted for 80 2 of the total runoff from qilian mountain which is located in the northeast of the tp wang et al 2009a showed that the runoff ratio of streamflow was about 0 6 for the time period from may to june in a permafrost watershed on the tp in this study the average runoff ratio of the runoff plot during the spring summer transition period from mid may to early june was relatively high at 1 7 fig 4i this high runoff ratio could be attributed to the controlling effects of frozen soil and meltwater from the cryosphere the frozen soil acted as an impermeable layer to promote runoff ratio and the meltwater from frozen soil provided an extra source of water for the generation of discharge from the runoff plot the threshold effect is widely observed in the catchments with different characteristics and the threshold values varied with soil properties such as the soil bulk density the saturated hydraulic conductivity the soil porosity and the saturated swc spence 2010 penna et al 2011 tarasova et al 2018 for example penna et al 2011 found that in the italian alps which are characterized by steep hillslopes and alpine grasslands the threshold value of the volumetric swc at 0 30 cm depth related to streamflow was about 0 45 the hillslope became hydrologically active and contributed to streamflow once the soil moisture threshold had been exceeded and the hillslope water table showed a large increase radatz et al 2013 found that in the southwestern wisconsin agricultural watershed which is characterized by a warm and humid climate and deep loess deposits streamflow showed a threshold response after the antecedent swc reached 0 39 and the threshold was related to about 0 80 of the total porosity in a tropical dry forest catchment near the pacific coast of central mexico streamflow started to generate after the volumetric swc at 100 cm depth reached a threshold value of 0 26 this threshold value was lower than the saturated swc which was related to the highly drainable porosities throughout the 100 cm soil profile farrick and branfireun 2014 the lateral ssf at 30 60 cm depth increased sharply after the sswl rose to the shallow soil layers and the swc exceeded the threshold values fig 8c d the threshold values of the swc in this study varied from 0 41 to 0 52 fig 5a e which are close to the 0 45 recorded by penna et al 2011 this might be due to the similar runoff generation mechanism and the grassland ecosystem in both this study and penna et al 2011 the lateral hillslope runoff was generated after the hillslope water table rose to the highly permeable shallow soil layers where the soil water at shallow depths reached its field capacity in this study the lateral ssf at 30 60 cm depth showed a sharp increase after the sswl maintained by the underlying permafrost increased in this soil layer fig 5g the dominant direction of soil water movement switched from vertical flow under dry amcs to lateral flow under wet amcs fig 6b in the summer months when the observed soil layers 0 60 cm gradually thawed the runoff ratios of the lateral ssf at 30 60 cm depth were lower than the values during the spring summer transition period fig 4i the sws and swc of the observed soil layers during the spring summer transition period were lower than the values in the summer months fig 4e g this might be because some of the soil layers were still frozen and only the unfrozen soil water could be measured by the applied soil temperature and moisture sensors ech2o 5tm decagon usa this is the first time that a threshold effect in the relationship between runoff and swc has been observed in a permafrost dominated catchment on the tp this threshold effect should therefore be considered in hydrological models applied to catchments controlled by freeze thaw processes the threshold values for the swc related to the sharp increase in hillslope runoff or streamflow should be set up separately that is the threshold values of the swc might be low during the spring summer transition period and the threshold values of the swc are mainly related to the saturated swc during the summer months 5 2 impact factors of runoff generation processes permafrost degradation and changes in precipitation characteristics su et al 2016 projected that the annual precipitation on the tp will increase by 5 0 10 0 from 2011 to 2040 and by 10 0 20 0 from 2041 to 2070 zou and zhou 2013 projected an increase in both the mean precipitation index the total precipitation on wet days and the extreme precipitation index on the tp from 2016 to 2040 under the rcp8 5 scenario based on the results of the pls pm and mlrs an increase in the annual precipitation and the frequency of extreme precipitation would lead to an increase in runoff event precipitation was the most important factor in influencing discharge from the runoff plot and could increase the discharge during the spring summer transition period fig 7a and summer months fig 7b this is consistent with previous studies showing that runoff may increase sharply with heavy event precipitation input and precipitation intensity fu et al 2013 ali et al 2015 penna et al 2015 saffarpour et al 2016 gao et al 2018 gao et al 2018 showed that the swc changes along with the antecedent precipitation ap and thus the frequency of summer precipitation on the tp could change the saturated soil water level sswl the low precipitation events without runoff were generally correlated with a lower swc in this study an increase in annual precipitation could increase the smc especially in the summer months with strong evapotranspiration fig 7b and heavy precipitation could increase the discharge from the runoff plot by increasing the threshold response of the lateral ssf at 30 60 cm depth to the smc figs 5 and 6 the discharge from the runoff plot increased with an increase in the amount of precipitation and the amc eqs 2 and 3 therefore a change in the characteristics of precipitation might change the runoff generation processes and lead to an increase in runoff in permafrost dominated catchments the increase of soil temperature as a result of the warming climate will have a direct and negative effect on runoff fig 7 the lateral ssf at 30 60 cm depth and the runoff ratio were lower in the summer months than during the spring summer transition period figs 3d and 4h i these results are consistent with studies showing that the increase in air temperature over the coming decades might decrease the runoff from permafrost catchments on the tp for example wang et al 2018 projected that evapotranspiration in the upper heihe river basin in the northeast of the tibetan plateau will increase by about 0 9 mm and runoff will decrease by about 1 3 mm with an increase in the depth of the active layer of 1 cm under the rcp 4 5 emission scenario this could be related to an increase in both evapotranspiration and the soil storage capacity caused by the advance in the initial thawing time of the frozen soil or to the increase in the thickness of the thawed soil layer this would lead to a decrease in the runoff ratio of permafrost catchments and the supply of water from permafrost regions to downstream areas simulation research using ground penetrating radar in a two dimensional cross section of the ground showed that the seasonal variability of subsurface flow is expected to decrease under climate warming while runoff would first increase and then decrease as the permafrost degradation progresses further to total melting frampton et al 2011 2013 studies in temperate humid catchments with shallow soils have shown that water conductivity often decreases with depth as a result of an increase in the bulk density of the soil or a decrease in soil porosity weiler and mcdonnell 2004 weiler et al 2005 in this study area the saturated hydraulic conductivity showed a decreasing trend from a soil depth of 10 to 60 cm and the main flow pathway could become deeper as the thickness of the active layer increases as a result of the degradation of permafrost xiao et al 2020 the flow rate of the lateral ssf in the lower soil layers is relatively low due to the low saturated hydraulic conductivity of the deeper soil layers which would lead to a decrease in the supply of water from the permafrost dominated hillslope to the stream channels the streamflow observed by hydrological stations has shown a decreasing trend on the southern and eastern tp and a slight increase in the central tp since the 1980s yang et al 2011 2014 yao et al 2019 the variation in streamflow might result from a combination of multiple influencing factors such as precipitation glaciers permafrost lakes snow and climate change yang et al 2014 yao et al 2015 2019 this study suggests that the runoff ratio of permafrost dominated catchments might decrease with an increase in air temperature rise and the degradation of permafrost but the projected increase in the precipitation amount and extreme frequency of precipitation in future decades might counteract the inhibiting effect of the projected increase in temperature 6 conclusions the runoff generation processes and the factors influencing them in a permafrost dominated catchment were investigated using a standard runoff plot based on hydrometric observations the 30 60 cm depth lateral ssf accounted for 99 discharge from the runoff plot during both the spring summer transition period around mid may and the summer months of june and july the lateral ssf at 30 60 cm depth showed sharp increases when the swcs of the thawed soil layers exceeded threshold values that varied from 0 41 to 0 52 precipitation and the amc have strong direct influences on the discharge from the runoff plot during the spring summer transition period indicating that the amc maintained by the underlying permafrost drives the generation of runoff via meltwater from snow and frozen soil by contrast the discharge from the runoff plot in the summer months was mainly promoted by moderate and heavy rainfall the air temperature had a negative influence on the discharge from the runoff plot by increasing the thickness of the thawed soil layer and the soil storage capacity leading to a decrease in the runoff ratio of the ssf at 30 60 cm depth from 1 7 during the spring summer transition period when some of the soil layers were still frozen to 0 5 in the summer months the increase in the thickness of the active layer deepened the flow pathway of lateral ssf and therefore reduced the runoff originating from the permafrost catchments to downstream areas the constructed mlrs models were able to accurately estimate the discharge from the runoff plot during the spring summer transition period and in the summer months verifying the controlling influence of the event precipitation and the ap in the generation of runoff in this permafrost dominated catchment the runoff generation processes in permafrost dominated catchments have complex runoff recharge characteristics and influencing factors further experiments are therefore needed to observe discharge from the runoff plot under different climate change scenarios leading to different thicknesses of the thawed soil layer different smcs and different inputs from precipitation to determine the influence of climate change on runoff generation processes in permafrost dominated catchments 7 data availability statement the data that support the findings of this study are available from the corresponding author upon reasonable request credit authorship contribution statement xiong xiao data curation methodology software writing original draft writing review editing fan zhang supervision writing review editing tao che data curation investigation xiaonan shi writing review editing chen zeng data curation investigation guanxing wang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was funded by the strategic priority research program of the chinese academy of sciences xda20060202 and the national natural science foundation of china 41571274 and 41877081 
5413,the hydrological regimes in permafrost dominated catchments have unique characteristics however studies based on plot scale experiments of runoff generation processes and the factors influencing these processes are limited on the tibetan plateau which is experiencing rapid warming and permafrost degradation runoff generation processes were studied on a standard runoff plot 5 20 m in a permafrost dominated catchment on the tibetan plateau with an alpine meadow cover to analyze these processes during the spring summer transition period from mid may to early june and in the summer months of june and july the discharge including surface and subsurface runoff the soil hydrothermal and moisture conditions and the meteorological conditions were monitored from may 2018 to may 2019 partial least squares path modeling was used to identify the influencing factors in the two time periods the lateral subsurface flow at 30 60 cm depth accounted for the majority of the discharge from the runoff plot 99 and showed a sharp increase when the soil water contents of the thawed soil layers exceeded a threshold value that varied from 0 41 to 0 52 during the spring summer transition period the lateral subsurface flow at 30 60 cm depth was promoted by both event precipitation and the antecedent precipitation with an average runoff ratio of 1 7 indicating that the antecedent moisture condition maintained by the underlying permafrost drives runoff generation via meltwater from snow and frozen soil in the summer months the lateral subsurface flow at 30 60 cm depth was directly promoted by event precipitation especially the moderate precipitation that occurred in this period with a reduced runoff ratio of 0 5 as a result of deepening of the thawed soil layer from 30 to 60 cm enhanced evapotranspiration and an increased soil water storage capacity caused by an increase of air temperature and the soil temperature prediction models obtained via multiple linear regressions of the identified influencing factors were able to accurately estimate the discharge this study shows the important role of lateral subsurface flow in runoff generation processes in this permafrost area and the most important influencing factors in different seasons abbreviations amc antecedent moisture condition ap antecedent precipitation swc soil water content ssf subsurface flow sswl saturated soil water level sws soil water storage keywords permafrost dominated catchments influencing factors runoff generation processes subsurface flow 1 introduction the hydrological regimes of permafrost catchments are influenced by the air temperature through ground freeze thaw processes which alter the soil properties that are associated with the hydrology walvoord and kurylyk 2016 lafrenière and lamoureux 2019 the freezing state of soils has a remarkable influence on hydrological processes due to the low hydraulic conductivity of the frozen layers walvoord and kurylyk 2016 the seasonal change in the thawed depth has a strong control on flow pathways and the export of water from the hillslope to streamflow woo and guan 2006 helbig et al 2013 rogger et al 2017 the hydrological regimes in permafrost catchments therefore have unique characteristics that alter the near surface drainage resulting in the weak connections between the surface water system and the deep groundwater system tetzlaff et al 2015 and the higher export of runoff from the hillslope to stream channels in permafrost catchments than in non permafrost catchments woo et al 2008 rogger et al 2017 coles and mcdonnell 2018 studies have shown that recent climate warming and permafrost degradation have significantly altered the hydrological regimes in permafrost catchments quinton and baltzer 2013 connon et al 2014 streletskiy et al 2015 walvoord and kurylyk 2016 the advance of the initial thawing time of surface frozen soil might lead to an increase in the infiltration of snowmelt and hence a decrease in spring runoff scherler et al 2010 walvoord and kurylyk 2016 the thickening of the active layer could lead to an increase in the soil storage capacity and a decrease in streamflow in permafrost dominated catchments carey and debeer 2008 kurylyk et al 2016 sjöberg et al 2016 the complete disappearance of permafrost would reduce flood peaks and increase runoff during the recession rogger et al 2017 the tibetan plateau tp is the only region on earth where permafrost is present at mid latitudes the permafrost catchments on the tp are sensitive to the rapid increase in temperature over the past five decades twice of the global average yao et al 2004 2019 wang et al 2009a 2010 zhang et al 2020 and the total area of thermally degraded permafrost in 2000s is only 88 of the permafrost area observed in the 1960s ran et al 2018 as the headwater area of more than ten large asiatic rivers including the yangtze yellow and ganges rivers the water storage and supply functions of the tp are facing great challenges under the recent accelerating warming and permafrost degradation which is unprecedented in the last few thousand years immerzeel et al 2010 yao et al 2012 2015 2019 wu et al 2015 the complex runoff generation processes in permafrost dominated catchments may also be associated with changes in the characteristics of precipitation and the threshold effect in the relationship between the soil water content swc and runoff tetzlaff et al 2015 walvoord and kurylyk 2016 precipitation has a controlling role on the changes in the runoff in permafrost dominated catchments on the tp with a limited contribution from glacial meltwater zhang et al 2011 2013 liu et al 2014 gao et al 2018 the threshold relationship between the swc and runoff suggests that hillslope runoff or streamflow may show a sharp increase after the swc has exceeded a specific threshold value this threshold effect which has been reported in forested e g farrick and branfireun 2014 agricultural radatz et al 2013 and headwater catchments e g ali et al 2015 challenges the hydrological model in which the generation of hillslope runoff or the response of streamflow to rainfall or snowmelt is linear mcdonnell 2003 2013 hydrometric observation at the plot scale is a basic effective and widely used method to study runoff generation processes and the factors influencing these processes freer et al 2002 zhao et al 2013 tromp van meerveld et al 2015 rushlow and godsey 2017 hu et al 2020 however there has only been a limited number of studies of runoff generation processes in permafrost catchments on the tp due to the harsh natural conditions this study aimed 1 to identify the main runoff generation pattern and the redistribution of precipitation in runoff generation processes 2 to understand the threshold effect based on the relationship between the swc and discharge from the runoff plot and 3 to quantify the influences of various factors on discharge from the runoff plot and to determine the most important factors in the spring summer transition period and the summer months 2 site description the study area is located in the yakou catchment 1 5 km2 qinghai province china this is a permafrost dominated catchment in the middle segment of qilian mountain and has a continental climate fig 1 a according to the three year observational data january 2015 december 2017 at the yakou automatic weather station liu et al 2018 che et al 2019 the annual average temperature is about 4 7 c with the minimum and maximum monthly temperatures occurring in january and july respectively fig 1b the average annual precipitation is about 405 mm with the majority of precipitation 84 occurring in the period from may to september fig 1c snowfall and rainfall are the main forms of precipitation from november to the following mid may and from early june to september respectively and alternate in the other months li et al 2009 the monthly average air temperature was 0 c from june to september fig 1b the observation period of this study was therefore divided into two periods 1 a spring summer transition period from mid may to early june and 2 the summer months from early june to september fig 1a shows that the main land cover and soil type change with the hillslope position with alpine swamp meadow and organic cryic gleysols in the riparian zone alpine meadows and mat cryic cambisols on the middle slope and alpine desert and cryogenic cambisols on the up slope the soil thickness also varies greatly along the slope being shallow on the steep up slope 20 but thick on gentle or lower terrain such as in the riparian zone 7 the vegetation cover decreases with increasing elevation with about 98 90 and 60 in the riparian zone on the middle slope and on the up slope respectively there is a wide distribution of permafrost in the south facing catchments such as the yakou catchment on the northeastern tibetan plateau as a result of the thin snow cover in winter by contrast the permafrost in an adjacent catchment about 140 km away is 10 m thick wang et al 2013 the maximum thickness of the thawed soil layer in the yakou catchment ranges from about 100 cm in the riparian zone to about 160 cm at the top slope at an elevation of 4147 m where the initial thawing of the surface soil starts around mid may li et al 2009 xiao et al 2020 the hydrothermal conditions of frozen soil have been a noticeable influence on streamflow generation processes yang et al 1993 the surface soil moisture and streamflow increase greatly with the input of snowmelt during the period of thaw yang et al 1992 the streamflow at the outlet of the yakou catchment is entirely frozen from november to the following april thawed water begins to flow under the thick ice in early may and the thaw is complete in june 3 materials and methods a standard runoff plot was constructed to observe surface runoff and lateral subsurface flow ssf at two depths the swc soil temperature and sswl were also observed the precipitation and air temperature were observed at the top of yakou catchment the observations were carried out from may 12 2018 to may 9 2019 3 1 runoff plot and observations a standard runoff plot 5 m wide and 20 m along the hillslope was constructed on the middle slope of the yakou catchment at an elevation of 4000 m fig 1a tin plates were placed vertically around the boundary of the runoff plot at 60 cm depth three header tanks were installed at three depths at the surface and at 30 and 60 cm at the outlet of the plot the selection of the depths was based on the different soil layers a sod layer and humus layer at 0 30 cm and a leached layer and illuvial layer at 30 60 cm depth the surface runoff lateral ssf at 0 30 cm and lateral ssf at 30 60 cm depth were collected separately at the outlet and recorded automatically by tipping bucket flow meters with a maximum resolution of 1 s xyz i northeast institute of geography and agroecology chinese academy of sciences the shallow ssf was supra permafrost water in the thawed soil layer a detailed description and figures of the observations of the runoff plot discharge can be found in xiao et al 2020 3 2 observations of precipitation swc soil temperature and sswl both liquid and solid precipitation at the yakou meteorological station were measured by storage type rain gages t200b geonor norway fig 1a a vertical soil profile was established next to the standard runoff plot to measure the swc and soil temperature soil temperature and moisture sensors ech2o 5tm decagon usa were installed at depths of 5 10 20 40 and 60 cm the volumetric swc and soil temperature were recorded every 30 min by the sensors and the recorded data were stored in a data logger em50 decagon usa the measurement accuracies were 0 03 m3 m 3 for the volumetric swc and 0 1 c for the soil temperature the profile was backfilled with the excavated soils after the installation of the sensors the continuous change in the sswl was recorded at the bottom of a 1 m deep monitoring well next to the standard runoff plot using a hobo water level logger u20 001 04 onset usa at 30 min intervals the sswl was only monitored from june 4 to september 30 2018 because the bottom of the saturated soil water well was frozen during the rest of the time 3 3 determination of the antecedent moisture condition runoff ratio and soil water storage previous studies used either the antecedent runoff plot discharge or ap e g inamdar and mitchell 2007 james and roulet 2007 farrick and branfireun 2014 von freyberg et al 2014 as the proxy for the antecedent moisture conditions amcs in this study because the discharge from the runoff plot was intermittent the ap proxy which showed more signals was chosen according to inamdar and mitchell 2007 the ap index is defined as the cumulative precipitation within the previous five and ten days ap5 and ap10 and can therefore be used to represent the amcs to further analyze the influence of antecedent snowfall or rainfall on discharge from the runoff plot the runoff ratio of the runoff plot discharge was calculated by the runoff discharge depth mm runoff discharge volume divided by the plot area divided by precipitation mm during a certain time period the soil water storage sws above a depth of 60 cm was calculated by the following equation hu et al 2009 1 sws i 1 n sw c i d i where n 5 is the number of observed depths i e 5 10 20 40 and 60 cm representing the corresponding soil layers i e 0 5 5 10 10 20 20 40 and 40 60 cm swci is the volumetric swc at the ith soil layer di is the soil depth of the ith soil layer the unit of sws is mm 3 4 partial least squares path modeling and multiple linear regressions partial least squares path modeling pls pm was used to analyze the influence of various factors on the discharge from the runoff plot pls pm is the partial least squares approach to structural equation modeling and provides a framework for analyzing multiple relationships among a set of blocks of variables or data tables sanchez 2013 the analysis of pls pm was completed using the pls pm package in r there are two kinds of variables in pls pm a manifest variable that can be measured or observed directly a latent variable which is referred to as a solo manifest variable or several manifest variables there are two kinds of model in pls pm an inner model a structural model representing the relationship among latent variables and an outer model a measurement model to define which manifest variables of the data set are associated with which latent variables sanchez 2013 ravand and baghaei 2016 the structural model proposed in this study consists of six latent variables runoff precipitation the soil moisture condition smc air temperature soil temperature and the amc each latent variable is referred by the solo manifest variable or several manifest variables for example the daily precipitation mm and the daily lateral ssf l at 30 60 cm depth are associated with precipitation and runoff respectively the daily average swcs m3 m 3 at 0 30 and 30 60 cm depth the daily average sws mm at 0 60 cm depth and the daily average sswl cm are associated with the smc the daily average maximum and minimum air temperature c and daily accumulated positive temperatures above 0 c c are associated with the air temperature the daily average soil temperature c at 0 30 cm and 30 60 cm depth are associated with the soil temperature ap5 and ap10 mm are associated with the amc the path diagram of pls pm including manifest and latent variables is shown in fig 2 p r st at and apt 0 c represent precipitation runoff soil temperature air temperature and accumulated positive temperatures above 0 c respectively in the results of the pls pm the influences among the latent variables were represented by a combination of the estimated value and the p value separately in the two time periods sanchez 2013 ravand and baghaei 2016 multiple linear regressions mlrs were used to build the prediction model of the dependent variable i e the discharge of lateral ssf at 30 60 cm depth using two or more independent variables the independent variables in this study included the daily precipitation mm the daily average swc m3 m 3 at 0 30 and 30 60 cm depth the daily average sws mm at 0 60 cm depth the daily average sswl cm the daily average maximum and minimum air temperatures c the daily accumulated positive temperatures above 0 c c the daily average soil temperature c at 0 30 and 30 60 cm depth and ap5 and ap10 mm a linear regression model was fitted to the data to determine the relationships between the daily lateral ssf at 30 60 cm depth and the independent variables and a stepwise regression method were applied in mlrs using spss for windows version 22 0 spss inc spss statistics 22 0 all the independent variables were taken as input variables and one or more independent variables were retained in the prediction models in the spss output r2 of the prediction model represents the proportion of the total variation in the n observed values of the dependent variable that is explained by the overall regression model the higher the value of r2 the better the model fits the data ghani and ahmad 2010 therefore the model with a higher r2 and p 0 05 was used to determine the relationships between the daily lateral ssf at 30 60 cm depth and the independent variables 4 results 4 1 time series of runoff plot discharge precipitation air temperature soil temperature and smc the air temperature showed both diurnal fluctuation and seasonal variations with the annual maximum in late july fig 3 a the night time air temperature was mainly 0 c during june july and august under the influence of the air temperature the soil temperatures of the shallow layers at 5 10 and 20 cm depth showed a higher temporal variation than the soil temperatures of the lower layers at 40 and 60 cm depth fig 3b the soil temperatures of the shallow layers reached the annual maximum in late july synchronized with the air temperature whereas soil temperatures of the lower layers reached the annual maximum about one month later in early september before mid september the deeper the soil depth then the lower the daily average soil temperature this order was reversed after mid september the distribution of precipitation was uneven during the observation period fig 3a moderate or heavier precipitation i e the daily precipitation daily precipitation 10 mm mainly occurred in two periods in mid may and from mid july to early august fig 3a the swc in each layer showed a sharp increase at the time of initial thawing fig 3b c indicating the supply of thawed soil water after thawing the fluctuation in the swc especially in the shallow layers was mainly in response to the infiltration of precipitation evapotranspiration and the drainage of soil water the relatively stable swc of the thawed lower layers indicated the limited impact of evapotranspiration and the potential balance between infiltration and soil water drainage the missing soil temperatures and soil water content data for the 60 cm soil layer from june 1 to june 28 2018 in fig 3b and c might be due to the poor contact between the soil sensor and the surrounding soil during the thawing processes the sswl showed abrupt fluctuations the negative values represent the distance of the water surface below the ground surface fig 3d the rising limbs of the sswl curve were sharper than the recession limbs which indicated the response to the intermittent supply of water from precipitation and the slower but continuous consumption of water via evapotranspiration and the drainage of soil water the maximum sswl rose to 28 cm below the ground surface and decreased to lower than 100 cm below the ground surface where the data logger was installed surface runoff was the main pattern of the discharge from the runoff plot from early march to early may 2019 fig 3d under the influence of the low air temperature and the thin layer of thawed soil comparison of the runoff components above 60 cm from may to july 2018 showed little surface runoff and the lateral ssf at 0 30 cm but the dominance of the lateral ssf at 30 60 cm depth which showed a strong variation figs 3c and 4 h with the input of precipitation and the temporal variation of smc such as the swc and sswl fig 4 compares the monthly data for the lateral ssf runoff ratio and other variables because the soil temperatures indicated that the observed soil layers were frozen from october 2018 to may 2019 fig 4b c only the active subsurface hydrological activities from may to september 2018 are discussed here with the appearance of positive air temperature and thus snowmelt and the initial thawing of the surface soil layer in may a lateral ssf was generated at 30 60 cm depth with the highest runoff ratio fig 4a d h and i with a similar amount of precipitation but thawing of the deeper soil layers and increasing swc and sws both the lateral ssf and runoff ratio at 30 60 cm depth decreased in june fig 4b i the peak of the lateral ssf at 30 60 cm depth promoted by moderate or heavy rainfall was observed in july with a sharp increase in precipitation but the runoff ratio was close to the june value and lower than the may value as a result of the increase in the swc and sws fig 4d i the average runoff ratios in the spring summer transition period of may and summer months of june and july were 1 7 and 0 5 respectively the precipitation was relatively high in august and september fig 4d but the contemporaneous lateral ssf at 30 60 cm depth and the runoff ratio were extremely low figs 3c and 4i the decreasing trend of precipitation from july to september fig 4d and the increase in the air temperature and soil temperatures of each soil layer figs 3a b and 4a c might have led to the low lateral ssf and runoff ratio during this period the disappearance of the lateral ssf at 30 60 cm depth in august could be due to the thawing of the deeper soil layer and deepening of the lateral ssf which could not be observed by the installed instruments this was verified by the reappearance of the lateral ssf at 30 60 cm depth in september with the increased sswl figs 3d and 4h it is therefore suggested that instruments should be installed at a deeper depth in future studies for the complete measurement of discharge from this runoff plot 4 2 threshold relationship between runoff and smc the relationship between runoff and smc was shown in fig 5 the red and black dots represent the results observed during the spring summer transition period from mid may to early june and the summer months from early june to the end of july respectively the vertical red and black dashed lines represent the threshold values of swcs and sws for the sharp increases in lateral the ssf at 30 60 cm depth during the spring summer transition period and the summer months respectively a clear obvious threshold effect and strong non linearity were seen in the relationship between the lateral ssf at 30 60 cm depth and the smc the swc in each soil layer the sws and the sswl especially during the summer months fig 5 black dots with the increase in smc the lateral ssf at 30 60 cm depth was at a stable and low value until the smc exceeded a threshold value and began to increase sharply the threshold values were roughly 0 41 0 52 0 47 0 43 and 0 42 for the swcs at 5 10 20 40 and 60 cm depth respectively and 370 mm for the sws fig 5 black dashed lines the threshold value for each soil layer in the summer months was close to the saturated swc and were 0 54 0 07 0 66 0 05 0 57 0 05 0 59 0 10 and 0 47 0 08 for the soil layers at 10 20 30 40 and 60 cm depth respectively xiao et al 2020 this indicates that the lateral ssf at 30 60 cm depth began to increase sharply after the smc reached saturation and the lateral ssf might be the main form of soil water drainage under this condition the relationship between the lateral ssf at 30 60 cm depth and the sswl also showed a clear threshold effect and the threshold value for the sswl related to the ssf at 30 60 cm depth was 75 cm fig 5g the relationship between the lateral ssf discharge at 30 60 cm depth and the sswl from mid may to june is not shown in fig 5g because the bottom of the saturated soil water well was frozen during this period the lateral ssf discharge at 30 60 cm depth might be high under low smc conditions such as when the swcs of all soil layers were low during the spring summer transition period fig 5a f red dots and the low swcs of the 40 and 60 cm depth soil layers during the summer months fig 5d e specifically the lateral ssf discharge at 30 60 cm depth showed sharp increases when the swcs at 5 10 20 40 and 60 cm depth reached roughly 0 34 0 17 0 17 0 18 and 0 22 and 220 mm for the sws fig 5 red dashed lines during the spring summer transition period and when the swcs at 40 and 60 cm reached roughly 0 23 during the summer months fig 5d e the threshold values of each soil layer during the spring summer transition period were lower than the threshold values of each soil layer during the summer months this might be due to the frozen state of each soil layer during the spring summer transition period and the 40 and 60 cm soil layers in june therefore the impermeable effect of the freezing front and the recharge of the infiltrated snowmelt and rainfall promoted lateral ssf at 30 60 cm depth when part of the soil layers was still frozen fig 4i the amcs during the summer month of july were separated into two conditions a higher amc with ap5 10 mm and a lower amc with ap5 10 mm fig 6 shows that the daily sswl and lateral ssf at 30 60 cm depth under the higher amc blue dots were generally higher than those under the lower amc black dots for the same daily precipitation condition this shows that a higher amc could lead to a higher sswl and lateral ssf at 30 60 cm depth during summer months with strong evapotranspiration the sswl increased noticeably with relatively low daily precipitation fig 6a daily precipitation 0 4 mm whereas the heavy lateral ssf at 30 60 cm depth only occurred with relatively high daily precipitation fig 6b daily precipitation from 8 to 20 mm the sswl increased first and then the saturated soil water was pushed out by infiltrated precipitation to generate the lateral ssf the high amc and sswl conditions were the precondition for the heavy lateral ssf at 30 60 cm depth the lateral ssf at 30 60 cm depth was absent under high sswls from august to september fig 3d which indicated that the lateral ssf was weak or shifted to the lower soil layers following the thickening of the active layer 4 3 results of pls pm and mlrs because the observed discharge from the runoff plot mainly occurred from mid may to the end of july the data set for this period was used in the pls pm and mlrs the results of the pls pm for the spring summer transition period and for the summer months from early june to the end of july are shown separately in fig 7 as shown in fig 7 the numbers and asterisks adjacent to the arrows represent estimated values and the significance of correlation the blue and red arrows represent positive and negative correlations respectively significant p 0 05 and highly significant p 0 01 correlations are represented by asterisks and double asterisks respectively gof represents the overall goodness of fit of pls pm the precipitation and the amc during the spring summer transition period showed highly significant p 0 01 strong influences on runoff with similar estimated values 0 54 and 0 46 for precipitation and amc respectively indicating that both event precipitation and the amc i e both rainfall and snowmelt were important factors in the generation of runoff during this period fig 7a the air temperature showed a highly significant p 0 01 influence on the soil temperature with an estimated value of 0 23 and the soil temperature showed a highly significant p 0 01 strong influence on the smc with a high estimated value of 0 90 showing that the increase in the soil moisture condition was driven by the thawing of frozen soil as the air temperature increased the soil temperature showed a non significant p 0 05 negative correlation with runoff with a low estimated value 0 28 and the smc showed a non significant p 0 05 weak positive influence on runoff with a low estimated value 0 06 verifying that the water released by thawing soil mainly supplied the smc instead of runoff fig 7b shows the results of the pls pm for the summer months from early june to the end of july the precipitation had a highly significant p 0 01 influence on runoff with a high estimated value 0 81 indicating that event precipitation was the most important factor in the generation of lateral ssf at 30 60 cm depth in this time period the amc showed a highly significant p 0 01 influence on the smc with an estimated value of 0 36 and precipitation showed a significant p 0 05 influence on the smc with a lower estimated value 0 15 showing that the amc facilitated by precipitation controlled the smc during the period under the influence of strong evapotranspiration the air temperature showed a highly significant p 0 01 strong influence on the soil temperature with a high estimated value 0 82 and the soil temperature showed a non significant p 0 05 negative influence on runoff with a low estimated value 0 04 showing that the increase in soil temperature had a negative effect on runoff during this period this might be due to the strong evaporation and expanding sws via the deepening of freezing front driven by the high air and soil temperatures based on the pls pm results the important factors directly influencing the lateral ssf at 30 60 cm depth were identified as precipitation and amc during the spring summer transition period and precipitation during the summer months the daily lateral ssf at 30 60 cm depth was further fitted with the independent variables using mlrs through screening the retained independent variables were in agreement with those of the pls pm in the prediction models for the spring summer transition period 2 ss f 30 60 c m 12 7 85 9 p 28 3 a p 5 r 2 0 57 p 0 05 if s m c s m c threshold v a l u e 0 if s m c s m c threshold v a l u e and the summer months 3 ss f 30 60 c m 141 5 161 6 p r 2 0 78 p 0 05 if s m c s m c threshold v a l u e 0 if s m c s m c threshold v a l u e the equations expressed the influence of precipitation daily precipitation and amc ap5 on the runoff well with relatively high r2 values 0 57 and 0 78 for the spring summer transition period and the summer months from early june to the end of july respectively and a low p value 0 05 these variables could therefore be used to accurately estimate the discharge from the runoff plot 5 discussion 5 1 runoff generation processes precipitation and meltwater redistribution and threshold effects from mid may to july 2018 the total lateral ssf at 30 60 cm depth was 223 8 mm which accounted for 99 6 of the total runoff this indicates that the soil layers at 30 60 cm depth were a hydrologically active layer in the runoff plot with underlying permafrost a schematic figure illustrating the hydrological regimes of the runoff plot was shown in fig 8 the runoff plot discharge ceased under the dry conditions during the spring summer transition period fig 8a or transferred to deeper soil layers with relatively slow velocity during the summer months fig 8b due to the absence of the saturated soil water at the 0 60 cm depth soil layers as a result of the continuous soil drainage or evapotranspiration under wet conditions the lateral ssf at 30 60 cm depth was promoted by the impermeable effect of the freezing front and the recharge of the infiltrated snowmelt and rainfall during the spring summer transition period fig 8c and the high sswl as a result of the input of moderate or heavy rainfall in the summer months fig 8d the dominant pattern of the lateral ssf at 30 60 cm depth and the high runoff ratios were consistent with other studies in subarctic regions i e the runoff in many permafrost catchments is dominated by the near surface drainage woo et al 2008 koch et al 2013 tetzlaff et al 2015 orgogozo et al 2019 many studies have emphasized the important role of high elevation permafrost regions in the runoff generation processes of the tp wang et al 2009b 2019 niu et al 2011 gao et al 2016 wang et al 2009b showed that the streamflow generated from the alpine cryosphere above 3600 m a s l accounted for 80 2 of the total runoff from qilian mountain which is located in the northeast of the tp wang et al 2009a showed that the runoff ratio of streamflow was about 0 6 for the time period from may to june in a permafrost watershed on the tp in this study the average runoff ratio of the runoff plot during the spring summer transition period from mid may to early june was relatively high at 1 7 fig 4i this high runoff ratio could be attributed to the controlling effects of frozen soil and meltwater from the cryosphere the frozen soil acted as an impermeable layer to promote runoff ratio and the meltwater from frozen soil provided an extra source of water for the generation of discharge from the runoff plot the threshold effect is widely observed in the catchments with different characteristics and the threshold values varied with soil properties such as the soil bulk density the saturated hydraulic conductivity the soil porosity and the saturated swc spence 2010 penna et al 2011 tarasova et al 2018 for example penna et al 2011 found that in the italian alps which are characterized by steep hillslopes and alpine grasslands the threshold value of the volumetric swc at 0 30 cm depth related to streamflow was about 0 45 the hillslope became hydrologically active and contributed to streamflow once the soil moisture threshold had been exceeded and the hillslope water table showed a large increase radatz et al 2013 found that in the southwestern wisconsin agricultural watershed which is characterized by a warm and humid climate and deep loess deposits streamflow showed a threshold response after the antecedent swc reached 0 39 and the threshold was related to about 0 80 of the total porosity in a tropical dry forest catchment near the pacific coast of central mexico streamflow started to generate after the volumetric swc at 100 cm depth reached a threshold value of 0 26 this threshold value was lower than the saturated swc which was related to the highly drainable porosities throughout the 100 cm soil profile farrick and branfireun 2014 the lateral ssf at 30 60 cm depth increased sharply after the sswl rose to the shallow soil layers and the swc exceeded the threshold values fig 8c d the threshold values of the swc in this study varied from 0 41 to 0 52 fig 5a e which are close to the 0 45 recorded by penna et al 2011 this might be due to the similar runoff generation mechanism and the grassland ecosystem in both this study and penna et al 2011 the lateral hillslope runoff was generated after the hillslope water table rose to the highly permeable shallow soil layers where the soil water at shallow depths reached its field capacity in this study the lateral ssf at 30 60 cm depth showed a sharp increase after the sswl maintained by the underlying permafrost increased in this soil layer fig 5g the dominant direction of soil water movement switched from vertical flow under dry amcs to lateral flow under wet amcs fig 6b in the summer months when the observed soil layers 0 60 cm gradually thawed the runoff ratios of the lateral ssf at 30 60 cm depth were lower than the values during the spring summer transition period fig 4i the sws and swc of the observed soil layers during the spring summer transition period were lower than the values in the summer months fig 4e g this might be because some of the soil layers were still frozen and only the unfrozen soil water could be measured by the applied soil temperature and moisture sensors ech2o 5tm decagon usa this is the first time that a threshold effect in the relationship between runoff and swc has been observed in a permafrost dominated catchment on the tp this threshold effect should therefore be considered in hydrological models applied to catchments controlled by freeze thaw processes the threshold values for the swc related to the sharp increase in hillslope runoff or streamflow should be set up separately that is the threshold values of the swc might be low during the spring summer transition period and the threshold values of the swc are mainly related to the saturated swc during the summer months 5 2 impact factors of runoff generation processes permafrost degradation and changes in precipitation characteristics su et al 2016 projected that the annual precipitation on the tp will increase by 5 0 10 0 from 2011 to 2040 and by 10 0 20 0 from 2041 to 2070 zou and zhou 2013 projected an increase in both the mean precipitation index the total precipitation on wet days and the extreme precipitation index on the tp from 2016 to 2040 under the rcp8 5 scenario based on the results of the pls pm and mlrs an increase in the annual precipitation and the frequency of extreme precipitation would lead to an increase in runoff event precipitation was the most important factor in influencing discharge from the runoff plot and could increase the discharge during the spring summer transition period fig 7a and summer months fig 7b this is consistent with previous studies showing that runoff may increase sharply with heavy event precipitation input and precipitation intensity fu et al 2013 ali et al 2015 penna et al 2015 saffarpour et al 2016 gao et al 2018 gao et al 2018 showed that the swc changes along with the antecedent precipitation ap and thus the frequency of summer precipitation on the tp could change the saturated soil water level sswl the low precipitation events without runoff were generally correlated with a lower swc in this study an increase in annual precipitation could increase the smc especially in the summer months with strong evapotranspiration fig 7b and heavy precipitation could increase the discharge from the runoff plot by increasing the threshold response of the lateral ssf at 30 60 cm depth to the smc figs 5 and 6 the discharge from the runoff plot increased with an increase in the amount of precipitation and the amc eqs 2 and 3 therefore a change in the characteristics of precipitation might change the runoff generation processes and lead to an increase in runoff in permafrost dominated catchments the increase of soil temperature as a result of the warming climate will have a direct and negative effect on runoff fig 7 the lateral ssf at 30 60 cm depth and the runoff ratio were lower in the summer months than during the spring summer transition period figs 3d and 4h i these results are consistent with studies showing that the increase in air temperature over the coming decades might decrease the runoff from permafrost catchments on the tp for example wang et al 2018 projected that evapotranspiration in the upper heihe river basin in the northeast of the tibetan plateau will increase by about 0 9 mm and runoff will decrease by about 1 3 mm with an increase in the depth of the active layer of 1 cm under the rcp 4 5 emission scenario this could be related to an increase in both evapotranspiration and the soil storage capacity caused by the advance in the initial thawing time of the frozen soil or to the increase in the thickness of the thawed soil layer this would lead to a decrease in the runoff ratio of permafrost catchments and the supply of water from permafrost regions to downstream areas simulation research using ground penetrating radar in a two dimensional cross section of the ground showed that the seasonal variability of subsurface flow is expected to decrease under climate warming while runoff would first increase and then decrease as the permafrost degradation progresses further to total melting frampton et al 2011 2013 studies in temperate humid catchments with shallow soils have shown that water conductivity often decreases with depth as a result of an increase in the bulk density of the soil or a decrease in soil porosity weiler and mcdonnell 2004 weiler et al 2005 in this study area the saturated hydraulic conductivity showed a decreasing trend from a soil depth of 10 to 60 cm and the main flow pathway could become deeper as the thickness of the active layer increases as a result of the degradation of permafrost xiao et al 2020 the flow rate of the lateral ssf in the lower soil layers is relatively low due to the low saturated hydraulic conductivity of the deeper soil layers which would lead to a decrease in the supply of water from the permafrost dominated hillslope to the stream channels the streamflow observed by hydrological stations has shown a decreasing trend on the southern and eastern tp and a slight increase in the central tp since the 1980s yang et al 2011 2014 yao et al 2019 the variation in streamflow might result from a combination of multiple influencing factors such as precipitation glaciers permafrost lakes snow and climate change yang et al 2014 yao et al 2015 2019 this study suggests that the runoff ratio of permafrost dominated catchments might decrease with an increase in air temperature rise and the degradation of permafrost but the projected increase in the precipitation amount and extreme frequency of precipitation in future decades might counteract the inhibiting effect of the projected increase in temperature 6 conclusions the runoff generation processes and the factors influencing them in a permafrost dominated catchment were investigated using a standard runoff plot based on hydrometric observations the 30 60 cm depth lateral ssf accounted for 99 discharge from the runoff plot during both the spring summer transition period around mid may and the summer months of june and july the lateral ssf at 30 60 cm depth showed sharp increases when the swcs of the thawed soil layers exceeded threshold values that varied from 0 41 to 0 52 precipitation and the amc have strong direct influences on the discharge from the runoff plot during the spring summer transition period indicating that the amc maintained by the underlying permafrost drives the generation of runoff via meltwater from snow and frozen soil by contrast the discharge from the runoff plot in the summer months was mainly promoted by moderate and heavy rainfall the air temperature had a negative influence on the discharge from the runoff plot by increasing the thickness of the thawed soil layer and the soil storage capacity leading to a decrease in the runoff ratio of the ssf at 30 60 cm depth from 1 7 during the spring summer transition period when some of the soil layers were still frozen to 0 5 in the summer months the increase in the thickness of the active layer deepened the flow pathway of lateral ssf and therefore reduced the runoff originating from the permafrost catchments to downstream areas the constructed mlrs models were able to accurately estimate the discharge from the runoff plot during the spring summer transition period and in the summer months verifying the controlling influence of the event precipitation and the ap in the generation of runoff in this permafrost dominated catchment the runoff generation processes in permafrost dominated catchments have complex runoff recharge characteristics and influencing factors further experiments are therefore needed to observe discharge from the runoff plot under different climate change scenarios leading to different thicknesses of the thawed soil layer different smcs and different inputs from precipitation to determine the influence of climate change on runoff generation processes in permafrost dominated catchments 7 data availability statement the data that support the findings of this study are available from the corresponding author upon reasonable request credit authorship contribution statement xiong xiao data curation methodology software writing original draft writing review editing fan zhang supervision writing review editing tao che data curation investigation xiaonan shi writing review editing chen zeng data curation investigation guanxing wang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was funded by the strategic priority research program of the chinese academy of sciences xda20060202 and the national natural science foundation of china 41571274 and 41877081 
5414,data sharing plays a fundamental role in providing data resources for geographic modeling and simulation although there are many successful cases of data sharing through the web current practices for sharing data mostly focus on data publication using metadata at the file level which requires identifying restructuring and synthesizing raw data files for further usage in hydrology because the same hydrological information is often stored in data files with different formats modelers should identify the required information from multisource data sets and then customize data requirements for their applications however these data customization tasks are difficult to repeat which leads to repetitive labor this paper presents a data sharing method that provides a solution for data manipulation based on a structured data description model rather than raw data files with the structured data description model multisource hydrological data can be accessed and processed in a unified way and published as data services using a designed data server this study also proposes a data configuration manager to customize data requirements through an interactive programming tool which can help in using the data services in addition a component based data viewer is developed for the visualization of multisource data in a sharable visualization scheme a case study that involves sharing and applying hydrological data is designed to examine the applicability and feasibility of the proposed data sharing method keywords data sharing data configuration hydrological data hydrological modeling and simulation 1 introduction geographic modeling is an effective way to explore geographical processes and understand geographical rules demeritt wainwright 2005 granell et al 2013 lü et al 2019 geographic data record the intrinsic information related to geographic phenomena and processes which serve as the inputs for geographic simulations with the development of geographic modeling researchers and governments have produced huge geographic data in various disciplines and domains due to the high cost of data collection and the complexity of data processing data sharing has become one of the key tasks in the field of geomodeling beran and piasecki 2009 chen et al 2009a b voinov and cerco 2010 abdallah and rosenberg 2019 xue et al 2019 with the development of information technology it the methods of data acquisition by users have passed through following approximate stages 1 in the early days of computer development data was usually stored in files and there was no effective way to manage large amounts of data users typically shared data by copying the data files peng 2005 although this method of data sharing is direct and flexible it is inefficient and inconvenient for managing and copying big datasets 2 with the popularization of databases more and more data resources have been stored in databases databases provide not only an effective way to manage massive data resources but also unified interfaces through which users can access these resources gogu et al 2001 horsburgh et al 2008 however a specific database normally has its own specific data description model which requires data contributors or users to follow specific specifications for sharing or accessing the data for example arcgis https www esri com zh cn home which is a widely used software system in geographic information systems gis provides two lightweight databases i e file and personal geodatabases although arcgis provides interfaces through which users can share and access data in these databases users should have some amount of familiarity with these databases to access the required data 3 with the development of web technology users can easily access distributed data resources through the internet peng 2005 markert et al 2019 mcdonald et al 2019 in the web environment data contributors upload data files into a data storage server and describe these data resources with specific description specifications morsy et al 2017 then users can search and access the data through metadata information examples include the hydrologic information system cuahsi his http his cuahsi org developed by the consortium of universities for the advancement of hydrologic science inc cuahsi this system offers web services tools standards and procedures that enhance access to data for hydrological analyses whitenack 2010 hydroshare https www hydroshare org landingpage is a well known platform for sharing discovering and tracing hydrological data horsburgh et al 2016b furthermore many studies have been conducted on web based data sharing peng 2005 zhang et al 2007 ames et al 2012 han et al 2012 2014 horsburgh et al 2009 zhu et al 2017 zhu and yang 2019 due to the openness and convenience of web technology more and more data has been shared in the web environment jones et al 2016 markert et al 2019 mcdonald et al 2019 web based data sharing methods have provided the foundation for data sharing in the open web environment and the possibility for users with different backgrounds to access vast data resources however current data sharing methods have mainly focused on data publication using metadata at the file level which requires identifying restructuring and synthesizing raw data files for further usage abdallah and rosenberg 2019 moreover these data configuration efforts are difficult to reuse which causes repetitive labor hydrological modeling has also suffered from these problems in the data sharing process laituri and sternlieb 2014 miller et al 2004 maidment 2016 abdallah and rosenberg 2019 hydrologic modeling and simulation often involve problem driven research that typically requires multisource and multiformat data for different research purposes the hydrological data e g observed data reanalysis data etc may come from different data collection devices models and data analysis systems and may be stored in different formats currently the data storage or description methods can be divided into two categories 1 common data description specifications examples include waterml https www opengeospatial org standards waterml which isa standard information model developed by the open geospatial consortium ogc for organizing hydrological observation data kadlec et al 2015 the observation data model odm which provides a consistent format for point based environmental observation data storage and retrieval in a relational database horsburgh et al 2008 2016a and the water management data model wamdam which organizes and stores water management data from multiple sources using contextual metadata and controlled vocabularies abdallah and rosenberg 2019 2 proprietary file formats are used by examples including the storm water management model swmm https www epa gov water research storm water management model swmm hydraplatform http umwrg github io hydraplatform and riverware zagona et al 2001 and all of these models use their own rules to organize the data customized txt files comma separated value csv files and microsoft excel files are usually employed by individual researchers to develop their own models due to the different research backgrounds among researchers the above two data description methods mainly focus on the data description itself which cannot emphasize the specific hydrological information contained in the data for example depending on the decisions of the data producers hydrologic variables e g runoff evaporation and wind speed can be stored in various data formats before users can extract the required information they must be familiar with the corresponding data formats which increases the cost for users to obtain specific data moreover the heterogeneity and diversity of hydrological data make it difficult for users to customize their data requirements and application specific data customization efforts are difficult to reuse for example a swat model which is a comprehensive physically based hydrological model requires a variety of data for its execution such as dem data from the study area soil data land use data and meteorological data mcdonald et al 2019 https swat tamu edu media 19754 swat io 2009 pdf shared data is an important data source for users who lack in situ observed data meteorological data e g precipitation and temperature are required as the drivers of the swat model and the preparation process of such data is moderately tedious specifically the national climatic data center ncdc https www ncdc noaa gov provides an open ftp server from which users can download climatic data sets e g temperature precipitation air pressure and dew point temperature data ftp ftp ncdc noaa gov pub data noaa isd lite first users need to download the required data files and be familiar with the data organization structure according to their metadata second the required information needs to be extracted from the downloaded raw data files and processed following specific data requirements e g missing values should be denoted as 99 and the data must be temporally continuous finally the extracted data need to be organized in a swat compatible data format these data customization processes are unavoidable for users relying on shared data however these application related data customization efforts are highly repetitive for many users of the swat model running similar simulations this article introduces a data sharing method which can improve the data usability in the open web environment in this study the information contained in hydrological data can be described using the universal data exchange udx model in a clear and structured way and can provide data to users through data services rather than through downloading raw data files users can request the required data by invoking corresponding data services in the designed data server without considering the raw data sources moreover the proposed data configuration manager provides an interactive programming tool for data customization additionally a component based data viewer is developed to display different types of hydrological information in a shareable visualization scheme the remainder of this article is structured as follows the conceptual framework of the proposed data sharing method is introduced in section 2 section 3 introduces the design and implementation of the proposed data sharing method in section 4 a case study involving the sharing and application of hydrological data is applied finally conclusions and future works are presented in section 5 2 conceptual framework of the proposed data sharing method the purpose of data sharing is to use available data to the greatest possible extent because the ease of use of data is rarely considered in most data sharing methods a data sharing method that can improve the availability and usability of data in the open web environment is urgently needed fig 1 shows the conceptual framework of the proposed data sharing method which includes three components a data server a data configuration manager and a data viewer the udx model is designed to describe heterogeneous data in a clear and structured way yue et al 2015 unlike other data models e g ascii grid geotiff netcdf and geojson the udx model is a self explanatory data description model with a hierarchical structure that is easy to understand as shown in fig 2 raw evaporation data are stored in a plain text file that contains the site information number name and position and evaporation values at each site the top and bottom panels show the structured expression of information in the udx model compared to the raw data file the information expressed by the udx model can be easily interpreted by users the information stored in the raw data files may use different organizational structures different formats but the structured expression of the information can remain the same when the information is published as data services users can access the required information without accessing the raw data files which improves the efficiency of data access the sources of hydrological data are diverse and can be divided into three categories data files databases and data shared by online platforms each of the data sources contains abundant hydrological data generally users must identify and extract the required data from these data sources through different access approaches which makes it hard to reuse the data access logics in this article data servers are designed for publishing the information contained in multisource data sets as data services to provide a unified approach for users to access the required data additionally data extraction methods are developed to extract specific information from raw data sources and publish the information via data services for example the runoff data extraction method evaporation data extraction method and precipitation extraction method can be used to extract corresponding information from a climate data source users can selectivelyrequest the required data by invoking the corresponding extraction methods without considering the data organizational structure of the raw data sources compared to the process in upload download mode users can access the required data without downloading the files in this approach which avoids unnecessary manual data manipulations of raw data files due to the various data requirements of different applications the data requested from data services should be reprocessed before use in specific applications the current practices for processing data are mostly associated with application specific data manipulations that are difficult to perform multiple times in this article the information provided by data services isdescribed by the udx model which can easily be operated with udx application programmers interfaces apis considering the flexibility and independence of data processing the data configuration manager designs a python based software development kit sdk for users to customize their own data requirements the sdk includes data server interfaces udx apis and utility functions which provide the standard interfaces for data configuration a data configuration process can be packaged as a data configuration package that can be reused by others in this design approach the data configuration package can be developed by distributed contributors data configuration managers can manage these packages and provide an open platform for users to reuse and share data configuration packages which avoids duplicating data configuration efforts data visualization is a key step in hydrological modeling and simulation and provides a direct way to visualize hydrological data kao et al 2011 horsburgh and reeder 2014 jones et al 2016 for both observation data and model output data there is a need to visualize the information associated with these data different information types require different visualization methods for example observation sites can be visualized with 2d maps and runoff data can be visualized with charts such as bar graphs and line graphs there is not a one size fits all visualization method for all types of hydrological information the data viewer provides a component based data visualization method for visualizing multiple types of information in a visualization scheme each component can implement a kind of visualization requirement and several visual components can be combined to form a visualization scheme the data viewer also supports sharing the visual scheme with the click ofabutton with the data viewer the data visualization methods can be reused which avoids the need for tedious efforts for visualization customization insummary the proposed data sharing method decouples the processes of data publication data configuration and data application which enables these three subprocesses to be independently developed thus they can be flexibly combined to meet the data requirements of various applications 3 implementation of the data sharing method this section introduces the framework designfor the data sharing method yue et al 2019 proposed the udx model for describing the heterogenous data in a structured way which provides a common data view through which users can understand the data wang et al 2018 employed a udx model to describe the data requirements of models and provided a series of methods for operating udx data e g mapping between raw data and udx data and transforming different types of udx data finally producing specific udx data for driving models however this article focuses on a data sharing method that helps users easily access the hydrological information contained in raw data resources the udx model is employed as a medium for describing specific hydrological information which provides the foundation for users to customize their data requirements and conduct visualization analysis the udx data operation mechanisms were introduced in previous studies thus this article will not cover these topics 3 1 data service publication in a comprehensive hydrological simulation the required data usually come from multiple data sources these data sources may be shared through different data sharing methods requiring time intensive efforts for user access the commonly used data sources in hydrology are summarized below 1 data files a data file is the storage medium for most data in hydrology data is usually stored in common data description specifications or proprietary file formats as mentioned in section 1 although most of these data formats are expressed as data files the data organization structures are different for the common data formats there are generally several specialized parsing libraries to read write the data such as the geospatial data abstraction library ogr simple features library gdal ogr http www gdal org which is used to read raster and vector data netcdf provides corresponding libraries https www unidata ucar edu downloads netcdf index jsp for data reading and extraction for proprietary file formats users need to manually write code to read the data and extract the required information according to the data organizational structure 2 databases due to the powerful data management and retrieval capabilities of databases geographic data are usually stored in databases different types of databases are suitable for storing different types of information data that are associated with data fields are usually stored in a relational database such as a postgresql https www postgresql org oracle https www oracle com index html or mysql https www mysql com database in hydrology odm and wamdam use a relational database to store hydrological data nonrelationaldatabases are typically used to store big data that require a rapid response and such databases include mongodb https www mongodb com hbase https hbase apache org and neo4j https neo4j com generally the structured query language sql is used to query data stored in databases 3 data provided by online data sharing platforms online sharing platforms are among the most important data sources for scientific research in addition to the web based data sharing platforms introduced in section 1 there are several online real time data sharing platforms available such as that operated by the water resources department of jiangxi province china http www jxsl gov cn slxxhw jhsq which provides real time rainfall and water level data the national urban air quality real time release platform of china http 106 37 208 233 20035 provides real time air monitoring data some platforms provide file based data sources that require users to download data files while others provide interfaces through which users can request data for the latter users must request a data stream through a hypertext transport protocol http request and then extract the required information based on the above analysis whether writing code to parse customized data formats or invoking apis to extract specific information these data manipulation processes are related to specific data sources and are difficult for others to reuse because data sources are heterogeneous and variable the information contained in data sources can be extracted and published via data services which would reduce the difficulty of accessing data there are three steps in the data service publication process information identification data extraction and description and data publication as shown in fig 3 first specific hydrological information can be identified from raw data sources in fig 3 for example land use evaporation and soil depth information are stored in data files with different formats the river flow and water level data are from online data sharing platforms the precipitation and dew point temperature data are stored in different databases different users may require different hydrological information for various applications thus they need to identify the required data according to the metadata descriptions of these data sources second the information is extracted and described via the udx model fig 4 shows the process of extracting information by the proposed data extraction method different data sources can employ different data reading writing interfaces to extract specific information as mentioned above then the extracted data can be described by the udx model and operated by udx apis through the data extraction method users can request different types of hydrological data and different levels of information the method can be developed using mainstream programming languages such as java c and python with the corresponding versions of the udx apis developed in this article https gitee com ogms udxapis git in addition the data extraction methods can be reused by different users which reduces the duplicated labor required for accessing the data third the information is published via a data service in the data server through data services users can access the required hydrological information without considering the raw data sources the data server is a lightweight server for hosting data services and data extraction methods in the open web environment users can deploy the data server on their own servers and upload their data sources and corresponding data extraction methods to establish data services for sharing their data then others can invoke the data extraction method to request the required data from the data server 3 2 data configuration 3 2 1 python based sdk the data configuration sdk provides reusable data manipulation tasks for users to customize their data requirements for specific applications python https www python org is a widely used object oriented language that provides a flexible and concise architecture for efficient processing in this article the data configuration sdk is based on python and includes three parts as shown in fig 5 data server interfaces are designed to establish an information exchange channel between data servers and applications udxserver py mainly provides a connection to a data server and obtains the data service list from that data server dataservice py represents the basic metadata of a data service such as the specific hydrologic information that the data service can provide extractmtd py contains the code invoking the data extraction method hosted on the data server and returns the required data config py maintains the global variableand configuration information of the sdk the auxiliary functions contain three modules which provide practical functionalities that can significantly improve the efficiency of data configuration in the proposed data sharing method user related data is stored in their own user space in the data server the fileio module provides interfaces for writing data files into their user space or reading data files from their user space to improve the interoperability of the udx model and python the datatypeconvertor module provides interfaces for information exchange between udx data and python data structures for example the function topythonlist udxtype can easily transform the real array type in udx data to the list type in python the utils module includes several utility functions such as math related functions and functions for data processing the udx apis contain the interfaces for udx data operation as shown in table 1 these apis enable flexible operations for udx data nodes which can be classified into two categories operations related to the udx node structures and operations related to the udx node values the former can locate a specific data node or change the udx data structure to form a new one the latter allows users to read write data node values such as by implementing reprojection or data calibration processes with these apis users can flexibly operate udx data nodes which is a more efficient process compared to operations involving raw data files 3 2 2 data configuration manager the data configuration sdk provides the standard interfaces for accessing data services and operating the requested data to reduce the difficulty of data configuration and reuse data configuration methods a data configuration manager based on the data configuration sdk is designed in this article as shown in fig 6 the data configuration manager has three functionalities providing an interactive programming workspace for data configuration managing data configuration packages and providing customized data for various applications e g model invocation data analysis and data visualization jupyter notebook https jupyter org is a web app that provides an interactive programming environment for editing testing and running python as well as r ruby and c code in real time because data configuration tasks are labor and time consuming and are difficult to repeat the jupyter notebook is introduced which allows users to customize their data requirements online and then publish the data configuration methods as data configuration packages to be reused by others to customize specific data requirements users must follow three steps data requesting data operation and data saving based on the sdk here an example is given to illustrate the process of data configuration to extract the specific study area from dem data polygon shapefile data can be used to clip the area the dem data and the shapefile data can be requested from the data server using data server interfaces then the clipping operation can be implemented by a third party data processing library such as the python version of the gdal the gdal can be installed by users in the jupyter programming environment technically users can install any third part library to implement their configuration tasks finally theoutput files i e the specific study area of the data clipping task are stored on the data server and can be downloaded directly for specific applications according to users data application requirements the output files can be saved as any data format for example if the application can receive udx data as input users can output udx data expressed by xml in this article otherwise they can output specific data formats to drive their applications the data configuration process can be saved as a data configuration script which can be invoked independently in the python environment notably users can download the data configuration script and run it as long as the python environment is installed the data configuration scripts can be packaged into a data configuration package for reuse any contributors can upload their data configuration packages to the data configuration manager and share them with other users in addition these data configuration packages can be integrated into other applications which is a benefit of the modular design concept 3 3 data visualization data visualization is one of the important steps in hydrological analyses additionally data visualization is an effective way to examine simulation results the different hydrological information contained in hydrological data sets must be visualized in different styles although there are many excellent web visualization libraries and tools available no single platform can meet all potential visualization requirements generally users must customize data visualization methods for specific visualization requirements however due to the diversity of hydrological applications visualization customization results are often difficult to reuse the data viewer provides a component based data visualization method to enable multiple types of hydrological information to be visualized in a visualization scheme as shown in fig 7 the data services provided by distributed data servers are employed as input data for the data viewer inside each visual component the data provided by data services can be parsed into detailed visual elements such as single data values one dimensional arrays and multidimensional arrays these elements can be assembled as specific data structures and then associated with the visual engine of the current visual component for example the bar component may employ a two dimensional array as the input inside the component the two dimensional data are parsed from incoming data and then assembled in the data format that the visual engine supports finally a two dimensional array with a specific data format will be bound to the bar chart visual engine many visualization libraries and tools such as echarts https www echartsjs com zh index html d3 js https d3js org leaflet https leafletjs com and three js https threejs org can be encapsulated into visual components as visual engines to drive data visualization the visualization capability of the visual component is dependent on its developers technically developers can customize arbitrarily complex visual components as long as they conform to the designed data exchange interfaces the visualization component is the basic component of the data viewer and each component can visualize one specific type of information there are three types of visual components designed in the data viewer chart components image components and text components a chart component is used to visualize data and image and text components are used to provide supplementaryinformation for the visualization scheme according to the visualization requirements multiple visual components can be coupled to form a comprehensive visualization scheme which can display multiple information types in one visualization view for example in a hydrological simulation the output data include river flow evaporation and runoff information the bar component can be used to display the river flow and the line component can be used to visualize river runoff information the image component and the text component can provide descriptive information about the simulation these related visual components can form a visualization scheme of the simulation results which can be easily shared with others withakeystroke 4 case study in this section a case study that includes hydrological data sharing configuration and visualization is introduced to examine the practicality of the proposed data sharing method in section 4 1 hydrological data from different sources are published as services on the data server section 4 2 focuses on data configuration for driving the water flow for lake catchments watlac model and the simulated results that contain different types of hydrological information are then visualized in a visualization scheme the prototype system designed in this case study can be accessed at https ogms gitee io datasharing 4 1 hydrological data publication poyang lake is the largest freshwater lake in china jiangxi province many hydrological studies have been conducted in the poyang lake basin to prevent the ecological environment from deteriorating in recent years in this section we publish a series of related hydrological data on a data server to provide fast access to these data for hydrological simulations as shown in fig 3 in section 3 1 these data come from different sources the land use evaporation and soil depth data are stored in data files the water resources department of jiangxi province http www jxsl gov cn slxxhw jhsq provides real time river flow and water level data at different sites in jiangxi province additionally mongodb provides annual precipitation data dew point temperature data and wind data for china as well as other data sets from 2010 to 2018 in fig 8 observation site information and precipitation data stored in mongodb publication are taken as an example three data extraction methods siteinfoextraction precipitationextractionbysiteperyear and precipitationextractionbyyearpersite are developed for extracting the site data and precipitation data from mongodb and then the extracted data are described by the udx model subsequently these methods are published to the data server which can be accessed by others users can simply call the data extraction methods to acquire the corresponding data without considering the sources of the data in this case the data extraction methods are developed in python and the python versions of the interfaces are used to access mongodb and operate the udx model 4 2 data configuration and data visualization 4 2 1 data configuration the watlac model was developed by the nanjing institute of geography limnology chinese academy of sciences zhang and li 2009 ye et al 2011 as shown in fig 9 the model mainly focuses on the simulation of surface soil and underground hydrological processes in this section the watlac model is employed to simulate hydrological process in the poyang lake basin and changes in the volume of lake water the model is published on the opengms platform chen et al 2011 2019 wen et al 2013 2017 yue et al 2015 2016 zhang et al 2019 which can be accessed online http geomodeling njnu edu cn modelitem e4f3f129 de8f 4721 96db 8c50e8054fa5 there are three types of input data geospatial data meteorological data and groundwater data for the model in section 4 1 we have published some of these data as data services land use soil data site position rainfall and evaporation data in this section these data services will be used to configure specific data formats for driving the watlac model in fig 10 evaporation data configuration is taken as an example the site position and evaporation data are requested from the data server and are employed to customize the input data for driving the watlac model as shown in the left panel the data configuration scripts can be published as data configuration packages that can be shared with others in the data configuration manager as shown in the upper right panel in this section the land use soil site position rainfall and evaporation data are configured in the data configuration manager the data files generated by the data configuration methods can be used to drive the watlac model directly 4 2 2 data visualization in this study we have designed several visual components in the data viewer such as a 2d map component line chart component and pie chart component in fig 10 the lower right panel shows the data viewer which visualizes a portion of the output results from the watlac model such as the site position runoff land use and evaporation in the 2d map component the line chart containing the runoff data is displayed when the user clicks the blue markers which refer to site positions the evaporation data at each site is displayed in the line chart and the land use data is displayed in the pie chart component with the data configuration manager users can easily reuse the packages contributed by others which reduces the difficulty of preparing data for hydrological simulations the data viewer also provides a flexible and effective way to visualize multiple information types using visual components which enables the possibility of sharing visualization methods 5 conclusions discussions and future work the purpose of the proposed data sharing method is to improve the usability of hydrological data resources this method provides the following specific contributions to data sharing studies first this study helps users gain easy access to their required data through data services provided by the data server the designed data configuration manager and data viewer provide effective methods for users to configure their data requirements and visualize the data which could increase data usability moreover the proposed data sharing method can separate the whole data sharing process into three subprocesses i e data publication data configuration and data application which would lead to the improvement of sharing and interoperability among distributed data resources although the watlac model is employed to examine the feasibility of the proposed data sharing method the shared data can also be applied to other models and applications on one hand the designed framework enables the public to participate in the data sharing process in the foreseeable future not only data resources but also data processing methods could be shared in the framework massive data resources data and corresponding processing methods provide the possibility of customizing specific data requirements on the other hand the udx model is employed to provide a common data view through which users can understand the data users can focus on their own data requirements rather than on complex data parsing and transformation works these works can be implemented in data extraction methods or third party data processing libraries provided by professionals in this way the framework simplifies the data preparation process required for users to drive specific applications in short the proposed data sharing method has improved the usability of shared data which would improve the efficiency of hydrological modeling and simulation the following issues are worth exploring in future studies to support comprehensive hydrological modeling and simulation 1 high level interfaces are required to improve the efficiency of data manipulation tasks the underlying interfaces designed in the data configuration sdk require largechunksofcode for manipulating the udx data which is not straightforward for data configuration package contributors 2 reusable and automated data manipulation tools need to be developed to improve the efficiency of data processing time consuming data manipulations are unavoidable in using shared data although the proposed data sharing method provides a more efficient way of reusing data manipulation efforts the processes of data extraction and configuration are still time and labor intensive 3 robustness of the data viewer is necessary because hydrological data are usually big data their visualization is generally difficult in a web application although specific visual components can be developed for data according to their specific types the method still has its maximum limit for visualization to handle big data a series of data reduction technologies are necessary for efficient data visualization such as the data compression level of detail lod and progressive transmission strategies for data credit authorship contribution statement jin wang methodology writing original draft software writing review editing min chen conceptualization funding acquisition guonian lü supervision songshan yue investigation resources yongning wen project administration zhenxu lan visualization shuo zhang data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we appreciate the detailed suggestions and comments from the secretariat and the anonymous reviewers a special thanks to qi zhang state key laboratory of lake science and environment nanjing institute of geography and limnology for providing the watlac model in the study case we also express heartfelt thanks to the other members of the opengms team http opengmsteam com this work was supported by the nsf for excellent young scholars of china under grant number 41622108 the natural science foundation of china grant no 41701441 and u1811464 and priority academic program development of jiangsu higher education institutions under grant 164320h116 
5414,data sharing plays a fundamental role in providing data resources for geographic modeling and simulation although there are many successful cases of data sharing through the web current practices for sharing data mostly focus on data publication using metadata at the file level which requires identifying restructuring and synthesizing raw data files for further usage in hydrology because the same hydrological information is often stored in data files with different formats modelers should identify the required information from multisource data sets and then customize data requirements for their applications however these data customization tasks are difficult to repeat which leads to repetitive labor this paper presents a data sharing method that provides a solution for data manipulation based on a structured data description model rather than raw data files with the structured data description model multisource hydrological data can be accessed and processed in a unified way and published as data services using a designed data server this study also proposes a data configuration manager to customize data requirements through an interactive programming tool which can help in using the data services in addition a component based data viewer is developed for the visualization of multisource data in a sharable visualization scheme a case study that involves sharing and applying hydrological data is designed to examine the applicability and feasibility of the proposed data sharing method keywords data sharing data configuration hydrological data hydrological modeling and simulation 1 introduction geographic modeling is an effective way to explore geographical processes and understand geographical rules demeritt wainwright 2005 granell et al 2013 lü et al 2019 geographic data record the intrinsic information related to geographic phenomena and processes which serve as the inputs for geographic simulations with the development of geographic modeling researchers and governments have produced huge geographic data in various disciplines and domains due to the high cost of data collection and the complexity of data processing data sharing has become one of the key tasks in the field of geomodeling beran and piasecki 2009 chen et al 2009a b voinov and cerco 2010 abdallah and rosenberg 2019 xue et al 2019 with the development of information technology it the methods of data acquisition by users have passed through following approximate stages 1 in the early days of computer development data was usually stored in files and there was no effective way to manage large amounts of data users typically shared data by copying the data files peng 2005 although this method of data sharing is direct and flexible it is inefficient and inconvenient for managing and copying big datasets 2 with the popularization of databases more and more data resources have been stored in databases databases provide not only an effective way to manage massive data resources but also unified interfaces through which users can access these resources gogu et al 2001 horsburgh et al 2008 however a specific database normally has its own specific data description model which requires data contributors or users to follow specific specifications for sharing or accessing the data for example arcgis https www esri com zh cn home which is a widely used software system in geographic information systems gis provides two lightweight databases i e file and personal geodatabases although arcgis provides interfaces through which users can share and access data in these databases users should have some amount of familiarity with these databases to access the required data 3 with the development of web technology users can easily access distributed data resources through the internet peng 2005 markert et al 2019 mcdonald et al 2019 in the web environment data contributors upload data files into a data storage server and describe these data resources with specific description specifications morsy et al 2017 then users can search and access the data through metadata information examples include the hydrologic information system cuahsi his http his cuahsi org developed by the consortium of universities for the advancement of hydrologic science inc cuahsi this system offers web services tools standards and procedures that enhance access to data for hydrological analyses whitenack 2010 hydroshare https www hydroshare org landingpage is a well known platform for sharing discovering and tracing hydrological data horsburgh et al 2016b furthermore many studies have been conducted on web based data sharing peng 2005 zhang et al 2007 ames et al 2012 han et al 2012 2014 horsburgh et al 2009 zhu et al 2017 zhu and yang 2019 due to the openness and convenience of web technology more and more data has been shared in the web environment jones et al 2016 markert et al 2019 mcdonald et al 2019 web based data sharing methods have provided the foundation for data sharing in the open web environment and the possibility for users with different backgrounds to access vast data resources however current data sharing methods have mainly focused on data publication using metadata at the file level which requires identifying restructuring and synthesizing raw data files for further usage abdallah and rosenberg 2019 moreover these data configuration efforts are difficult to reuse which causes repetitive labor hydrological modeling has also suffered from these problems in the data sharing process laituri and sternlieb 2014 miller et al 2004 maidment 2016 abdallah and rosenberg 2019 hydrologic modeling and simulation often involve problem driven research that typically requires multisource and multiformat data for different research purposes the hydrological data e g observed data reanalysis data etc may come from different data collection devices models and data analysis systems and may be stored in different formats currently the data storage or description methods can be divided into two categories 1 common data description specifications examples include waterml https www opengeospatial org standards waterml which isa standard information model developed by the open geospatial consortium ogc for organizing hydrological observation data kadlec et al 2015 the observation data model odm which provides a consistent format for point based environmental observation data storage and retrieval in a relational database horsburgh et al 2008 2016a and the water management data model wamdam which organizes and stores water management data from multiple sources using contextual metadata and controlled vocabularies abdallah and rosenberg 2019 2 proprietary file formats are used by examples including the storm water management model swmm https www epa gov water research storm water management model swmm hydraplatform http umwrg github io hydraplatform and riverware zagona et al 2001 and all of these models use their own rules to organize the data customized txt files comma separated value csv files and microsoft excel files are usually employed by individual researchers to develop their own models due to the different research backgrounds among researchers the above two data description methods mainly focus on the data description itself which cannot emphasize the specific hydrological information contained in the data for example depending on the decisions of the data producers hydrologic variables e g runoff evaporation and wind speed can be stored in various data formats before users can extract the required information they must be familiar with the corresponding data formats which increases the cost for users to obtain specific data moreover the heterogeneity and diversity of hydrological data make it difficult for users to customize their data requirements and application specific data customization efforts are difficult to reuse for example a swat model which is a comprehensive physically based hydrological model requires a variety of data for its execution such as dem data from the study area soil data land use data and meteorological data mcdonald et al 2019 https swat tamu edu media 19754 swat io 2009 pdf shared data is an important data source for users who lack in situ observed data meteorological data e g precipitation and temperature are required as the drivers of the swat model and the preparation process of such data is moderately tedious specifically the national climatic data center ncdc https www ncdc noaa gov provides an open ftp server from which users can download climatic data sets e g temperature precipitation air pressure and dew point temperature data ftp ftp ncdc noaa gov pub data noaa isd lite first users need to download the required data files and be familiar with the data organization structure according to their metadata second the required information needs to be extracted from the downloaded raw data files and processed following specific data requirements e g missing values should be denoted as 99 and the data must be temporally continuous finally the extracted data need to be organized in a swat compatible data format these data customization processes are unavoidable for users relying on shared data however these application related data customization efforts are highly repetitive for many users of the swat model running similar simulations this article introduces a data sharing method which can improve the data usability in the open web environment in this study the information contained in hydrological data can be described using the universal data exchange udx model in a clear and structured way and can provide data to users through data services rather than through downloading raw data files users can request the required data by invoking corresponding data services in the designed data server without considering the raw data sources moreover the proposed data configuration manager provides an interactive programming tool for data customization additionally a component based data viewer is developed to display different types of hydrological information in a shareable visualization scheme the remainder of this article is structured as follows the conceptual framework of the proposed data sharing method is introduced in section 2 section 3 introduces the design and implementation of the proposed data sharing method in section 4 a case study involving the sharing and application of hydrological data is applied finally conclusions and future works are presented in section 5 2 conceptual framework of the proposed data sharing method the purpose of data sharing is to use available data to the greatest possible extent because the ease of use of data is rarely considered in most data sharing methods a data sharing method that can improve the availability and usability of data in the open web environment is urgently needed fig 1 shows the conceptual framework of the proposed data sharing method which includes three components a data server a data configuration manager and a data viewer the udx model is designed to describe heterogeneous data in a clear and structured way yue et al 2015 unlike other data models e g ascii grid geotiff netcdf and geojson the udx model is a self explanatory data description model with a hierarchical structure that is easy to understand as shown in fig 2 raw evaporation data are stored in a plain text file that contains the site information number name and position and evaporation values at each site the top and bottom panels show the structured expression of information in the udx model compared to the raw data file the information expressed by the udx model can be easily interpreted by users the information stored in the raw data files may use different organizational structures different formats but the structured expression of the information can remain the same when the information is published as data services users can access the required information without accessing the raw data files which improves the efficiency of data access the sources of hydrological data are diverse and can be divided into three categories data files databases and data shared by online platforms each of the data sources contains abundant hydrological data generally users must identify and extract the required data from these data sources through different access approaches which makes it hard to reuse the data access logics in this article data servers are designed for publishing the information contained in multisource data sets as data services to provide a unified approach for users to access the required data additionally data extraction methods are developed to extract specific information from raw data sources and publish the information via data services for example the runoff data extraction method evaporation data extraction method and precipitation extraction method can be used to extract corresponding information from a climate data source users can selectivelyrequest the required data by invoking the corresponding extraction methods without considering the data organizational structure of the raw data sources compared to the process in upload download mode users can access the required data without downloading the files in this approach which avoids unnecessary manual data manipulations of raw data files due to the various data requirements of different applications the data requested from data services should be reprocessed before use in specific applications the current practices for processing data are mostly associated with application specific data manipulations that are difficult to perform multiple times in this article the information provided by data services isdescribed by the udx model which can easily be operated with udx application programmers interfaces apis considering the flexibility and independence of data processing the data configuration manager designs a python based software development kit sdk for users to customize their own data requirements the sdk includes data server interfaces udx apis and utility functions which provide the standard interfaces for data configuration a data configuration process can be packaged as a data configuration package that can be reused by others in this design approach the data configuration package can be developed by distributed contributors data configuration managers can manage these packages and provide an open platform for users to reuse and share data configuration packages which avoids duplicating data configuration efforts data visualization is a key step in hydrological modeling and simulation and provides a direct way to visualize hydrological data kao et al 2011 horsburgh and reeder 2014 jones et al 2016 for both observation data and model output data there is a need to visualize the information associated with these data different information types require different visualization methods for example observation sites can be visualized with 2d maps and runoff data can be visualized with charts such as bar graphs and line graphs there is not a one size fits all visualization method for all types of hydrological information the data viewer provides a component based data visualization method for visualizing multiple types of information in a visualization scheme each component can implement a kind of visualization requirement and several visual components can be combined to form a visualization scheme the data viewer also supports sharing the visual scheme with the click ofabutton with the data viewer the data visualization methods can be reused which avoids the need for tedious efforts for visualization customization insummary the proposed data sharing method decouples the processes of data publication data configuration and data application which enables these three subprocesses to be independently developed thus they can be flexibly combined to meet the data requirements of various applications 3 implementation of the data sharing method this section introduces the framework designfor the data sharing method yue et al 2019 proposed the udx model for describing the heterogenous data in a structured way which provides a common data view through which users can understand the data wang et al 2018 employed a udx model to describe the data requirements of models and provided a series of methods for operating udx data e g mapping between raw data and udx data and transforming different types of udx data finally producing specific udx data for driving models however this article focuses on a data sharing method that helps users easily access the hydrological information contained in raw data resources the udx model is employed as a medium for describing specific hydrological information which provides the foundation for users to customize their data requirements and conduct visualization analysis the udx data operation mechanisms were introduced in previous studies thus this article will not cover these topics 3 1 data service publication in a comprehensive hydrological simulation the required data usually come from multiple data sources these data sources may be shared through different data sharing methods requiring time intensive efforts for user access the commonly used data sources in hydrology are summarized below 1 data files a data file is the storage medium for most data in hydrology data is usually stored in common data description specifications or proprietary file formats as mentioned in section 1 although most of these data formats are expressed as data files the data organization structures are different for the common data formats there are generally several specialized parsing libraries to read write the data such as the geospatial data abstraction library ogr simple features library gdal ogr http www gdal org which is used to read raster and vector data netcdf provides corresponding libraries https www unidata ucar edu downloads netcdf index jsp for data reading and extraction for proprietary file formats users need to manually write code to read the data and extract the required information according to the data organizational structure 2 databases due to the powerful data management and retrieval capabilities of databases geographic data are usually stored in databases different types of databases are suitable for storing different types of information data that are associated with data fields are usually stored in a relational database such as a postgresql https www postgresql org oracle https www oracle com index html or mysql https www mysql com database in hydrology odm and wamdam use a relational database to store hydrological data nonrelationaldatabases are typically used to store big data that require a rapid response and such databases include mongodb https www mongodb com hbase https hbase apache org and neo4j https neo4j com generally the structured query language sql is used to query data stored in databases 3 data provided by online data sharing platforms online sharing platforms are among the most important data sources for scientific research in addition to the web based data sharing platforms introduced in section 1 there are several online real time data sharing platforms available such as that operated by the water resources department of jiangxi province china http www jxsl gov cn slxxhw jhsq which provides real time rainfall and water level data the national urban air quality real time release platform of china http 106 37 208 233 20035 provides real time air monitoring data some platforms provide file based data sources that require users to download data files while others provide interfaces through which users can request data for the latter users must request a data stream through a hypertext transport protocol http request and then extract the required information based on the above analysis whether writing code to parse customized data formats or invoking apis to extract specific information these data manipulation processes are related to specific data sources and are difficult for others to reuse because data sources are heterogeneous and variable the information contained in data sources can be extracted and published via data services which would reduce the difficulty of accessing data there are three steps in the data service publication process information identification data extraction and description and data publication as shown in fig 3 first specific hydrological information can be identified from raw data sources in fig 3 for example land use evaporation and soil depth information are stored in data files with different formats the river flow and water level data are from online data sharing platforms the precipitation and dew point temperature data are stored in different databases different users may require different hydrological information for various applications thus they need to identify the required data according to the metadata descriptions of these data sources second the information is extracted and described via the udx model fig 4 shows the process of extracting information by the proposed data extraction method different data sources can employ different data reading writing interfaces to extract specific information as mentioned above then the extracted data can be described by the udx model and operated by udx apis through the data extraction method users can request different types of hydrological data and different levels of information the method can be developed using mainstream programming languages such as java c and python with the corresponding versions of the udx apis developed in this article https gitee com ogms udxapis git in addition the data extraction methods can be reused by different users which reduces the duplicated labor required for accessing the data third the information is published via a data service in the data server through data services users can access the required hydrological information without considering the raw data sources the data server is a lightweight server for hosting data services and data extraction methods in the open web environment users can deploy the data server on their own servers and upload their data sources and corresponding data extraction methods to establish data services for sharing their data then others can invoke the data extraction method to request the required data from the data server 3 2 data configuration 3 2 1 python based sdk the data configuration sdk provides reusable data manipulation tasks for users to customize their data requirements for specific applications python https www python org is a widely used object oriented language that provides a flexible and concise architecture for efficient processing in this article the data configuration sdk is based on python and includes three parts as shown in fig 5 data server interfaces are designed to establish an information exchange channel between data servers and applications udxserver py mainly provides a connection to a data server and obtains the data service list from that data server dataservice py represents the basic metadata of a data service such as the specific hydrologic information that the data service can provide extractmtd py contains the code invoking the data extraction method hosted on the data server and returns the required data config py maintains the global variableand configuration information of the sdk the auxiliary functions contain three modules which provide practical functionalities that can significantly improve the efficiency of data configuration in the proposed data sharing method user related data is stored in their own user space in the data server the fileio module provides interfaces for writing data files into their user space or reading data files from their user space to improve the interoperability of the udx model and python the datatypeconvertor module provides interfaces for information exchange between udx data and python data structures for example the function topythonlist udxtype can easily transform the real array type in udx data to the list type in python the utils module includes several utility functions such as math related functions and functions for data processing the udx apis contain the interfaces for udx data operation as shown in table 1 these apis enable flexible operations for udx data nodes which can be classified into two categories operations related to the udx node structures and operations related to the udx node values the former can locate a specific data node or change the udx data structure to form a new one the latter allows users to read write data node values such as by implementing reprojection or data calibration processes with these apis users can flexibly operate udx data nodes which is a more efficient process compared to operations involving raw data files 3 2 2 data configuration manager the data configuration sdk provides the standard interfaces for accessing data services and operating the requested data to reduce the difficulty of data configuration and reuse data configuration methods a data configuration manager based on the data configuration sdk is designed in this article as shown in fig 6 the data configuration manager has three functionalities providing an interactive programming workspace for data configuration managing data configuration packages and providing customized data for various applications e g model invocation data analysis and data visualization jupyter notebook https jupyter org is a web app that provides an interactive programming environment for editing testing and running python as well as r ruby and c code in real time because data configuration tasks are labor and time consuming and are difficult to repeat the jupyter notebook is introduced which allows users to customize their data requirements online and then publish the data configuration methods as data configuration packages to be reused by others to customize specific data requirements users must follow three steps data requesting data operation and data saving based on the sdk here an example is given to illustrate the process of data configuration to extract the specific study area from dem data polygon shapefile data can be used to clip the area the dem data and the shapefile data can be requested from the data server using data server interfaces then the clipping operation can be implemented by a third party data processing library such as the python version of the gdal the gdal can be installed by users in the jupyter programming environment technically users can install any third part library to implement their configuration tasks finally theoutput files i e the specific study area of the data clipping task are stored on the data server and can be downloaded directly for specific applications according to users data application requirements the output files can be saved as any data format for example if the application can receive udx data as input users can output udx data expressed by xml in this article otherwise they can output specific data formats to drive their applications the data configuration process can be saved as a data configuration script which can be invoked independently in the python environment notably users can download the data configuration script and run it as long as the python environment is installed the data configuration scripts can be packaged into a data configuration package for reuse any contributors can upload their data configuration packages to the data configuration manager and share them with other users in addition these data configuration packages can be integrated into other applications which is a benefit of the modular design concept 3 3 data visualization data visualization is one of the important steps in hydrological analyses additionally data visualization is an effective way to examine simulation results the different hydrological information contained in hydrological data sets must be visualized in different styles although there are many excellent web visualization libraries and tools available no single platform can meet all potential visualization requirements generally users must customize data visualization methods for specific visualization requirements however due to the diversity of hydrological applications visualization customization results are often difficult to reuse the data viewer provides a component based data visualization method to enable multiple types of hydrological information to be visualized in a visualization scheme as shown in fig 7 the data services provided by distributed data servers are employed as input data for the data viewer inside each visual component the data provided by data services can be parsed into detailed visual elements such as single data values one dimensional arrays and multidimensional arrays these elements can be assembled as specific data structures and then associated with the visual engine of the current visual component for example the bar component may employ a two dimensional array as the input inside the component the two dimensional data are parsed from incoming data and then assembled in the data format that the visual engine supports finally a two dimensional array with a specific data format will be bound to the bar chart visual engine many visualization libraries and tools such as echarts https www echartsjs com zh index html d3 js https d3js org leaflet https leafletjs com and three js https threejs org can be encapsulated into visual components as visual engines to drive data visualization the visualization capability of the visual component is dependent on its developers technically developers can customize arbitrarily complex visual components as long as they conform to the designed data exchange interfaces the visualization component is the basic component of the data viewer and each component can visualize one specific type of information there are three types of visual components designed in the data viewer chart components image components and text components a chart component is used to visualize data and image and text components are used to provide supplementaryinformation for the visualization scheme according to the visualization requirements multiple visual components can be coupled to form a comprehensive visualization scheme which can display multiple information types in one visualization view for example in a hydrological simulation the output data include river flow evaporation and runoff information the bar component can be used to display the river flow and the line component can be used to visualize river runoff information the image component and the text component can provide descriptive information about the simulation these related visual components can form a visualization scheme of the simulation results which can be easily shared with others withakeystroke 4 case study in this section a case study that includes hydrological data sharing configuration and visualization is introduced to examine the practicality of the proposed data sharing method in section 4 1 hydrological data from different sources are published as services on the data server section 4 2 focuses on data configuration for driving the water flow for lake catchments watlac model and the simulated results that contain different types of hydrological information are then visualized in a visualization scheme the prototype system designed in this case study can be accessed at https ogms gitee io datasharing 4 1 hydrological data publication poyang lake is the largest freshwater lake in china jiangxi province many hydrological studies have been conducted in the poyang lake basin to prevent the ecological environment from deteriorating in recent years in this section we publish a series of related hydrological data on a data server to provide fast access to these data for hydrological simulations as shown in fig 3 in section 3 1 these data come from different sources the land use evaporation and soil depth data are stored in data files the water resources department of jiangxi province http www jxsl gov cn slxxhw jhsq provides real time river flow and water level data at different sites in jiangxi province additionally mongodb provides annual precipitation data dew point temperature data and wind data for china as well as other data sets from 2010 to 2018 in fig 8 observation site information and precipitation data stored in mongodb publication are taken as an example three data extraction methods siteinfoextraction precipitationextractionbysiteperyear and precipitationextractionbyyearpersite are developed for extracting the site data and precipitation data from mongodb and then the extracted data are described by the udx model subsequently these methods are published to the data server which can be accessed by others users can simply call the data extraction methods to acquire the corresponding data without considering the sources of the data in this case the data extraction methods are developed in python and the python versions of the interfaces are used to access mongodb and operate the udx model 4 2 data configuration and data visualization 4 2 1 data configuration the watlac model was developed by the nanjing institute of geography limnology chinese academy of sciences zhang and li 2009 ye et al 2011 as shown in fig 9 the model mainly focuses on the simulation of surface soil and underground hydrological processes in this section the watlac model is employed to simulate hydrological process in the poyang lake basin and changes in the volume of lake water the model is published on the opengms platform chen et al 2011 2019 wen et al 2013 2017 yue et al 2015 2016 zhang et al 2019 which can be accessed online http geomodeling njnu edu cn modelitem e4f3f129 de8f 4721 96db 8c50e8054fa5 there are three types of input data geospatial data meteorological data and groundwater data for the model in section 4 1 we have published some of these data as data services land use soil data site position rainfall and evaporation data in this section these data services will be used to configure specific data formats for driving the watlac model in fig 10 evaporation data configuration is taken as an example the site position and evaporation data are requested from the data server and are employed to customize the input data for driving the watlac model as shown in the left panel the data configuration scripts can be published as data configuration packages that can be shared with others in the data configuration manager as shown in the upper right panel in this section the land use soil site position rainfall and evaporation data are configured in the data configuration manager the data files generated by the data configuration methods can be used to drive the watlac model directly 4 2 2 data visualization in this study we have designed several visual components in the data viewer such as a 2d map component line chart component and pie chart component in fig 10 the lower right panel shows the data viewer which visualizes a portion of the output results from the watlac model such as the site position runoff land use and evaporation in the 2d map component the line chart containing the runoff data is displayed when the user clicks the blue markers which refer to site positions the evaporation data at each site is displayed in the line chart and the land use data is displayed in the pie chart component with the data configuration manager users can easily reuse the packages contributed by others which reduces the difficulty of preparing data for hydrological simulations the data viewer also provides a flexible and effective way to visualize multiple information types using visual components which enables the possibility of sharing visualization methods 5 conclusions discussions and future work the purpose of the proposed data sharing method is to improve the usability of hydrological data resources this method provides the following specific contributions to data sharing studies first this study helps users gain easy access to their required data through data services provided by the data server the designed data configuration manager and data viewer provide effective methods for users to configure their data requirements and visualize the data which could increase data usability moreover the proposed data sharing method can separate the whole data sharing process into three subprocesses i e data publication data configuration and data application which would lead to the improvement of sharing and interoperability among distributed data resources although the watlac model is employed to examine the feasibility of the proposed data sharing method the shared data can also be applied to other models and applications on one hand the designed framework enables the public to participate in the data sharing process in the foreseeable future not only data resources but also data processing methods could be shared in the framework massive data resources data and corresponding processing methods provide the possibility of customizing specific data requirements on the other hand the udx model is employed to provide a common data view through which users can understand the data users can focus on their own data requirements rather than on complex data parsing and transformation works these works can be implemented in data extraction methods or third party data processing libraries provided by professionals in this way the framework simplifies the data preparation process required for users to drive specific applications in short the proposed data sharing method has improved the usability of shared data which would improve the efficiency of hydrological modeling and simulation the following issues are worth exploring in future studies to support comprehensive hydrological modeling and simulation 1 high level interfaces are required to improve the efficiency of data manipulation tasks the underlying interfaces designed in the data configuration sdk require largechunksofcode for manipulating the udx data which is not straightforward for data configuration package contributors 2 reusable and automated data manipulation tools need to be developed to improve the efficiency of data processing time consuming data manipulations are unavoidable in using shared data although the proposed data sharing method provides a more efficient way of reusing data manipulation efforts the processes of data extraction and configuration are still time and labor intensive 3 robustness of the data viewer is necessary because hydrological data are usually big data their visualization is generally difficult in a web application although specific visual components can be developed for data according to their specific types the method still has its maximum limit for visualization to handle big data a series of data reduction technologies are necessary for efficient data visualization such as the data compression level of detail lod and progressive transmission strategies for data credit authorship contribution statement jin wang methodology writing original draft software writing review editing min chen conceptualization funding acquisition guonian lü supervision songshan yue investigation resources yongning wen project administration zhenxu lan visualization shuo zhang data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we appreciate the detailed suggestions and comments from the secretariat and the anonymous reviewers a special thanks to qi zhang state key laboratory of lake science and environment nanjing institute of geography and limnology for providing the watlac model in the study case we also express heartfelt thanks to the other members of the opengms team http opengmsteam com this work was supported by the nsf for excellent young scholars of china under grant number 41622108 the natural science foundation of china grant no 41701441 and u1811464 and priority academic program development of jiangsu higher education institutions under grant 164320h116 
