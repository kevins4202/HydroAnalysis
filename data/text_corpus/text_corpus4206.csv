index,text
21030,mechanism of hydrodynamic aggregation of swimmers is an intriguing problem which is usually studied by the immersed boundary ib method in this paper a loosely coupled partitioned algorithm is used to simulate this fluid structure interaction fsi problem specifically flow field is simulated by finite volume method and structure field is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam first of all this algorithm is validated through simulating collective behavior of two actively moving two dimensional 2d flexible plates in tandem configuration driven by the harmonic plunging motions of their leading edges with identical frequency and amplitude then the hydrodynamic aggregations of multiple two or three 2d flexible plates in side by side configuration are studied it is found that two different stable configurations alternate leading mode al and staggered following mode sf are formed spontaneously in two parallel flexible plates and are determined by the lateral spacing between them in three parallel plates scenario the middle plate follows behind in sf mode while the other two plates present al and sf modes with different lateral spacings accordingly besides the flow details in different configurations are illustrated and the corresponding propulsive properties velocity input power and efficiency of plates are discussed keywords hydrodynamic aggregation fluid structure interaction loosely coupled partitioned algorithm flexible plates 1 introduction the phenomenon of aggregation of animals in fluid is ubiquitous in our daily life such as bird flocks and fish schools it is commonly recognized that this collective behavior of animals provides benefit for reproduction feeding and defense against predators scientific observation method was applied by biologists and explanations of collective behavior were given qualitatively from the aspect of survival supplies and environmental demands humston et al 2000 moyle et al 2004 olson et al 2013 however those qualitative interpretations cannot meet the need of cognition of this natural phenomenon and then the speculations that the aggregations of the group help to save energy expenditure and are spontaneously formed as the consequence of flow mediated interaction are proposed which draw the attention of researchers aerodynamic theory was adopted by lissaman and schollenberger 1970 to predict the relative positions of large migration birds such as goose in v formations it was found that the rear individuals could exploit the upward wash generated by the front birds weihs 1973 analyzed the von kármán vortex theoretically and indicated that the rear fish positioned midway would be driven by the vortex generated by the two fishes in the preceding row of the diamond configuration however partridge and pitcher 1979 pointed out that little biological evidence of hydrodynamic advantage in the diamond pattern was found live animal tests are also applied weimerskirch et al 2001 measured wing beat frequency and heart rate of 8 great white pelicans in v formations and the data of rear birds obtained were 11 4 14 5 lower than those of the leading pelican svendsen et al 2003 also found that the flapping frequency in schooling roach was 11 6 lower than that of fish swimming alone under experimental conditions liao et al 2003a 2003b experimentally compared the hydrodynamic behavior of a trout in uniform flow and wake flow of d section cylinder quantitative flow visualization and electromyography showed that trout would exploit vortices of the cylinder and reduced muscle activity was detected this same phenomenon was also seen in the experiment by beal et al 2006 portugal et al 2014 used global positioning system gps to record positions and wing flapping frequencies of 14 ibises during migratory flight and found that v configuration was preferred even though position adjustments of some individuals heart rate flapping frequency and muscle activity only provide circumstantial evidences of energy expenditure in collective behavior in order to get more direct data such as force and propulsive efficiency many bionic experiments beal et al 2006 lauder et al 2007 wang 2010 becker et al 2015 were adopted which could be divided into two categories for example ristroph and zhang 2008 studied the flow induced flapping problem of two flexible flags in different configurations and found that the leading flag enjoyed a significant drag reduction of up to 50 while force on the following flag increased this first kind of bionic experiment did not take the self propelled motion of flexible bodies into consideration boschitsch et al 2014 and ramananarivo et al 2016 investigated the thrust propulsive efficiency and velocity of multiple self propelled rigid bodies in tandem configuration and indicated that the propulsive efficiency increased up to 50 if proper longitudinal spacing was chosen and flow mediated interaction between rigid bodies determined the different collective formations this second kind of test discussed collective behavior of multiple rigid bodies without consideration of flexibility of animals it can be seen that the bionic experiment of hydrodynamic aggregation of self propelled flexible plates is needed in order to describe the collective behavior of animals more accurately which is not an easy task under the existing experimental conditions now compared to the experimental method numerical simulation provides an economic way to study this fsi problem of collective behavior with the development of computational technology and different numerical methods besides flow details obtained are helpful to analyze the flow mediated interaction which helps to illustrate the mechanism by which different collective modes are formed zhu and peskin 2003 and huang et al 2007 used the immersed boundary ib method to study the flow induced flapping problem of two parallel flexible filaments in uniform flow two different oscillation modes in phase and out of phase modes emerged due to the different flow mediated interactions determined by the lateral spacing the same ib method was also adopted to discuss two flexible filaments in tandem configuration jia and yin 2008 zhu 2009 it was found that both force on the rear filament and its flapping amplitude were larger than those of the leading filament panel method and mode superposition method were applied to study the flow induced problem of two flexible plates in different configurations wang 2010 and results about force amplitude and hydrodynamic modes were given uddin et al 2015 adopted the ib method to investigate the hydrodynamic performance of the active flapping flexible flag in the wake flow of the leading flow induced flapping flags both the slalom mode and interception mode were formed due to the vortex body interactions corresponding to the low and high drag situations respectively zhang et al 2020 proposed a loosely coupled scheme based on the platform of commercial computational fluid dynamics software fluent version 13 0 1 for the flow induced flapping problem of flexible plates the flexible bodies are fixed in uniform flow in these above investigations it is different from the realistic movements of bird and fish in which active motion is obtained by the self propelled flexible bodies zhu et al 2014 started to use ib method to discuss the hydrodynamic aggregation of two tandem self propelled flexible filaments driven by the same forced heaving motions of their leading edges compact and regular configurations were formed passively due to the vortex body interaction and vortex locking mechanism was proposed to explain the mechanism of those two different collective behaviors compact configuration consumes more energy to achieve the higher propulsive speed the same phenomenon was illustrated in the study of multiple up to eight self propelled flexible plates in tandem configuration by ib method peng et al 2018a besides peng et al 2018b used the same ib method to investigate the collective behavior of two parallel self propelled flexible plates the spontaneously formed staggered following sf mode alternate leading al mode and moving abreast ma mode were presented among which sf and ma modes achieve higher propulsive speed under more input power it can be seen from the above numerical simulations that the fsi problem of collective behavior is extensively solved by the ib method ib method is a comparatively new way to deal with the coupling surface in fsi problem it is usually combined with the prescribed computational fluid dynamic codes based on lattice boltzmann method rather than some commercial computational fluid dynamics software which puts forward a high requirement for researchers to study collective behaviors therefore it can also be seen from the above numerical simulations that the investigation of hydrodynamic aggregation of self propelled flexible plates the realistic collective behavior of animal in different configurations is rare until now the purposes of the current work are twofold first the proposed loosely coupled partitioned algorithm based on the commercial computational fluid dynamics software for the flow induced flapping problem of flexible plates in our previous work zhang et al 2020 is modified for the fsi problem of collective behavior of self propelled flexible plates in this algorithm momentum equation is added to describe the longitudinal movement of the flexible plates driven by its own thrust and the inextensibility condition of the plates is complemented second hydrodynamic aggregation of self propelled system of multiple two or three parallel flexible plates is investigated the flexible plates move freely in the longitudinal direction under the thrust induced by the prescribed heaving motion of their leading edges in the lateral direction different collective modes are formed spontaneously flow details force and propulsive properties are also discussed in order to explain the mechanism and energy cost of those hydrodynamic aggregation modes the remainder of this paper is arranged as follows section 2 presents governing equations of the fluid structure coupling system in section 3 the numerical simulation method and loosely coupling partitioned algorithm are illustrated section 4 describes the verification of this algorithm by simulating two self propelled flexible plates in tandem configuration section 5 presents the applications of the modified loosely coupled partitioned algorithm in the study of hydrodynamic aggregation of multiple flexible plates in side by side configuration conclusions are drawn in section 6 2 governing equations as shown in fig 1 let x and y be the coordinates in horizontal and vertical directions respectively a viscous impressible fluid domain ω f is considered in which two or three parallel 2d flexible plates structure domains represented by ω s are embedded the clamped leading edges of flexible plates undertake the harmonic plunging motion in lateral direction and the forces formed by the interaction with fluid self propulsion drive the plates to move in horizontal direction freely the forced heaving motions of the leading edges are prescribed by y t acos 2πft with a being the identical heaving amplitude and f the frequency the 2d flexible plate of thickness h and length l h l is modeled as euler bernoulli beam the lateral spacing between the leading edges of plates is d which maintains constant during motion the longitudinal spacing between the leading edges of plates is h t which is initially set as h 0 h t 0 0 if not specified and then determined by flow mediated interaction between parallel plates during simulation this simple setting of thin elastic plates is extensively used to study the collective behavior of actively moving swimmers zhu et al 2014 peng et al 2018a 2018b 2 1 governing equations of fluid the flow of a viscid incompressible fluid is governed by the conservation of mass and momentum the navier stokes equations are as follows 1a u f 0 i n ω f 0 t 1b ρ f u f t ρ f u f u f p f μ 2 u f ρ f g f i n ω f 0 t where u f ρ f p f μ g f are the fluid velocity vector density pressure dynamic viscosity and external applied body force vector respectively to complete the system appropriate initial and boundary conditions are need 2a u t 0 f 0 i n ω 0 f 2b u f u i o n γ i 0 t 2c u f 0 o n γ w 0 t where the fluid velocity condition u i applied on the interfaces γ i ω f ω s between fluid domain and structure domain is described by the movement of the plates the no slip shear condition is adopted on the stationary walls γ w 2 2 governing equations of structure the governing equation of flexible plate in zhu et al 2014 and peng et al 2018a 2018b is analyzed it is found that although the structural stretching rigidity of plate is of big value the shear deformation equals to zero and then the shear force is of finite value about zero the governing equation could be decoupled the dynamic equilibriums of the thin 2d flexible plates in x and y directions are approximated through momentum equation and bending vibration equation of the euler bernoulli beam respectively 3a ρ l 2 x s t t 2 f x s t i n ω s 0 t 3b ρ l 2 y s t t e i 4 y s t s 4 f y s t i n ω s 0 t with ρ l ρ s h i h 3 12 where ρ l e ρ s and i are the linear density young s modulus density and inertia moment of the structure respectively s is the lagrangian coordinate along the plate x s t x s t y s t is the position vector of the plates and f s t f x s t f y s t is lagrangian force vector on the plates by the fluid the inextensibility condition of the plates is adopted as 3c x s x s 1 i n ω s 0 t the governing equations are complemented by the following appropriate initial and boundary conditions 4a x s 0 x s 0 y s 0 i n ω 0 s 4b x s 0 t x s 0 t y s 0 t i n ω 0 s 4c y 0 t y t y i i 1 2 3 on γ l 0 t 4d f s t p f s t n f o n γ i 0 t where y i i 1 2 3 is the equilibrium positions of heaving motions of plates 1 2 and 3 γ l is the clamped leading edge of the plate p f s t defines the traction force on the interface γ i and n f is the unit outward normal vector it is not a user defined value but obtained from the fluid solution 2 3 interface γ i is the fluid structure coupling surface through which two different fields fluid and structure interact with each other it can be seen from eqs 2b and 4d that the interface condition applied on one field is dictated by the behavior of the other fluid field produces hydrodynamic force that alters the dynamic condition of the structure field and this dynamic behavior of structure in turn provides kinematic condition that influences the fluid field on γ i the whole fsi system should satisfy both velocity and traction continuities as follows 5 u i x s t t o n γ i 0 t 6 p f s t n f f s t n s o n γ i 0 t where n s is the unit outward normal vector 3 loosely coupled partitioned algorithm the strong added mass effect of the slender shaped flexible plates h l mentioned in the flow induced flapping problem of flexible plates in our early work zhang et al 2020 should be considered in the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates in addition the longitudinal movement of flexible plates driven by their prescribed heaving leading edges should also be solved for the added mass effect idelsohn et al 2009 indicated that it caused numerical difficulties in various fluid structure coupled algorithms such as instability non convergence in order to overcome these numerical difficulties various strongly coupled partitioned algorithms causin et al 2005 wang 2010 sudhakar and wall 2018 are proposed however search of the open literatures indicates that the loosely coupled partitioned algorithm considering strong added mass effect is rare liu et al 2014 once proposed a stable second order scheme based on the loosely coupled partitioned algorithm in consideration of the high computational cost of sub iterations in the strongly coupled partitioned algorithms e g 50 sub iterations are needed in wang 2010 the stable loosely coupled partitioned algorithm is particularly appealing in terms of its efficiency without sub iterations enlighten by the method of artificial added mass causin et al 2005 förster et al 2007 yvin et al 2018 zhang et al 2019a 2019b zhang et al 2020 proposed a loosely coupled partitioned algorithm on the platform of fluent version 13 0 1 for the flow induced flapping problem of flexible plates for the longitudinal movement of flexible plates driven by their prescribed heaving leading edges momentum equation is added as well as the prescribed heaving motion of leading edges to sum up the proposed loosely coupled partitioned algorithm zhang et al 2020 is modified for the hydrodynamic aggregation of parallel self propelled flexible plates with momentum equation and prescribed heaving motion of leading edges being complemented in this paper specifically fluid domain is simulated by finite volume method fvm structure domain is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam in the longitudinal and lateral direction respectively 3 1 fluid fvm integrates the transport equation on a control volume basis yielding a discrete equation satisfying the conservation law as follows 7 v ρ f φ t d v ρ f φ u f n s d s γ φ φ n s d s v s φ d v where φ represents a scalar quantity in the unsteady conservation equation v and s are an arbitrary control volume and its corresponding surfaces respectively n s is the normal vector of the surfaces γ φ is the diffusion coefficient for φ s φ is the source of φ per unit volume the time derivative term in eq 7 is defined in temporal discretization for transient simulations first order implicit time integration is applied 8 φ n 1 φ n δ t f φ n 1 where φ n and φ n 1 represent the values at the current time step and the next time step respectively the function f incorporates any spatial discretization once flow details are obtained the hydrodynamic force on the flexible plates is obtained through integrating pressure along the length of the plate and the spatial discretization form is expressed as 9 f p f s t n f δ s 3 2 structure once the longitudinal hydrodynamic force on the plate is obtained through eq 9 eq 3a can be solved by the direct integral method the longitudinal velocity and displacement of plate are obtained to solve eq 3b boundary conditions for the clamped leading edges and free ends of self propelled flexible plates are needed 10a y 0 t y t y i x 0 t s 1 0 3 y 0 t s 3 0 10b 2 y l t s 2 0 3 y l t s 3 0 the initial conditions are as follows 11 x s 0 s y 0 y i x s 0 t 0 0 where eqs 10 and 11 are the specific descriptions for eqs 4a 4c of the euler bernoulli beam it can be seen that the leading edges undertaking the forced heaving motion provide different boundary conditions from the flow induced flapping problem in zhang et al 2020 the lateral displacement of flexible plates is expressed as 12 y s t y t y i y s t with eq 12 being substituted eq 3b is rewritten as 13 ρ l 2 y s t t 2 e i 4 y s t s 4 f y s t ρ l 2 y t t 2 i n ω s 0 t it can be seen from the second item in the right side of eq 13 that the prescribed heaving motion of leading edges provides an external force on the flexible plates and then the model superposition method is applied to solve eq 13 with the passive displacement y s t being expressed as 14 y s t ϕ j s q j t the calculation process refers to the corresponding content in zhang et al 2020 solutions are given as follows 15 ϕ j s cos β j s cosh β j s cos β j l cosh β j l sin β j l sinh β j l sin β j s sinh β j s 16 q j t 1 m j ω j 0 t p j τ sin ω j t τ d τ q j 0 cos ω j t q j t ω j t sin ω j t with β 1 l 1 875 β 2 l 4 694 β 3 l 7 855 β j l j 0 5 π j 4 m j 0 l ϕ j 2 s ρ l d s ω j β j 2 e i ρ l p j t 0 l ϕ j s f y s t ρ l 2 y t t d s where β j is constant coefficient m j p j t are the generalized mass and generalized force respectively ω j is inherent frequency in addition the strong added mass effect should be considered artificial added mass method causin et al 2005 förster et al 2007 yvin et al 2018 zhang et al 2019a 2019b is adopted the frequency dependent theoretical added mass λ j 2ρ f β j as obtained in beummelen 2009 jaiman et al 2014 of 2d flexible plate is added and then the inherent frequency generalized mass and generalized force change to m j 0 l ϕ j 2 s ρ l λ j d s ω j β j 2 e i ρ l λ j p j t 0 l ϕ j s f y s t ρ l 2 y t t λ j ϕ j s 2 q j t 2 d s then the vertical displacement of the flexible plate is obtained by 17 y s t y t y i ϕ j s q j t in order to maintain the inextensibility condition of the plate the spatial discretization form of eq 3c is expressed as 18 x s x s δ x δ s δ y δ s δ x δ s δ y δ s δ x 2 δ s 2 δ y 2 δ s 2 1 once the lateral displacement is obtained through eq 17 the longitudinal displacement of plate due to the inextensibility condition can be solved through eq 18 those structural displacements are transferred to the fluid domain through dynamic mesh technology in fluent version 13 0 1 in order to ensure the fluid structure interaction specifically both smoothing setting spring constant factor as 1 and remeshing setting maximum cell skewness as 0 7 mesh update methods sas ip 2010 are adopted in this paper 3 3 algorithm the same coupling steps zhang et al 2020 from time level t n to t n 1 are described in algorithm 1 as follows algorithm 1 loosely coupled partitioned algorithm based on fluent version 13 0 1 1 start from known solutions u f u f n x s t x s t n x s t t x s t n t at time t n 2 advance from time level t n to t n 1 a obtain p f n by solving fluid equation eq 1 b define the structural position x s t n 1 by solving structural equation eq 3 c update the fluid field accordingly using dynamic mesh technology and the flow chart is shown in fig 2 it can be seen that the modified loosely coupled partitioned algorithm for the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates has two advantages first this modified algorithm is developed based on the commercial computational fluid dynamics software fluent version 13 0 1 which lowers the skill threshold compared to the extensively used ib method for researchers to study collective behaviors second the governing equations of fluid and structure fields are solved only once at each time step the loosely coupled partitioned algorithm retains and carries numerical errors at each time step without reducing them through sub iterations as the strongly coupled partitioned algorithm wang 2010 does which makes this algorithm very sufficient in this paper more concerns are put on acquiring the desired accuracy by this more economic loosely coupled partitioned algorithm in solving fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates 4 verification of the loosely coupled partitioned algorithm to validate the present loosely coupled partitioned algorithm hydrodynamic behavior of two self propelled flexible plates in tandem configuration is simulated and the results are compared with the solutions by the ib method zhu et al 2014 the characteristic length l velocity u ref 2πaf and density ρ f are applied to normalize the above mathematical formulations the dimensionless parameters are defined as follows the linear mass ratio of the plates and the fluid m ρ l ρ f l the reynolds number re ρ f u ref l μ the bending stiffness k ei ρ f u2 refl 3 heaving amplitude a a l the lateral spacing d d l the longitudinal spacing h h l the numerical cases of m 0 2 re 200 k 0 8 a 0 5 d 0 and h 0 8 or 9 in zhu et al 2014 are simulated to illustrate the accuracy of the modified algorithm h 0 represents the initial longitudinal spacing between two tandem plates computational domain and boundary conditions refer to fig 1 based on our convergence studies with different computational domains the size of the fluid domain is set as 60l 30l 20l 20l in the x and y directions fig 3 a shows the obtained pressure contour it can be seen that there is undisturbed fluid around the boundaries of domain and then the blockage effect of no slip stationary walls γ w on the actively moving plates is negligible hybrid grid is used for spatial discretization of the fluid domain fig 3 b shows the grid system in which mesh unstructured triangular grid around the thin plates is refined minimum grid length δl min 0 02l in order capture the details of the flow the time step size δt 0 01s about 0 001t is used for the simulation of fluid flow and the deformation of plates t 1 f is the period of the heaving motion of the leading edges the maximum number j max 5 of natural modes of the flexible plates is chosen fig 4 shows the forward velocity time history curves and separation distance time history curves of plates obtained by the present loosely coupled partitioned algorithm and the ib method two plates move forwards with the same velocity from t t 0 to 2 and then for h 0 8 case the following plate catches up with the leading plate by a sudden acceleration before the separation distance of two plates finally reaches the equilibrium value h l l 5 for h 0 9 case the following plate falls behind the leading plate by a sudden deceleration before their longitudinal separation distance reaches the equilibrium value h l l 11 it can also be seen that although there are some discrepancies from t t 2 to 4 the computed values are overall in good agreement with each other especially after t t 5 when the stable hydrodynamic aggregation of two tandem flexible is obtained the discrepancies of streamwise velocity and longitudinal distance from t t 2 to 4 may come from two aspects the approximated expression of flexible plates and numerical errors of the loosely coupled partitioned algorithm without sub iterations those discrepancies have no distinct influence on the stable hydrodynamic aggregation of two tandem plates at last the desired accuracy is obtained by the present loosely coupled partitioned algorithm besides mesh sensitivity analysis temporal convergence analysis and mode truncation study are performed in which another two different grid systems with δl min 0 01l and δl min 0 04l two different time step sizes δt 0 002s and δt 0 05s and two different numbers of natural modes j max 3 and j max 10 are studied respectively the results are presented in fig 5 the comparison of the obtained stable streamwise velocity time history curves indicates that numerical results are monotonically convergent with the decrease of minimum grid length and time step size as well as the increase of number of natural modes grid system with minimum edge length of δl min 0 02l time step size δt 0 01s and number of natural modes j max 5 produce enough accurate results and are adopted in the following works if not otherwise specified 5 application to multiple parallel flexible plates in this section collective behaviors of multiple two or three self propelled flexible plates in side by side configuration are simulated by the modified loosely coupled partitioned algorithm as one of the simplest group configurations for the basic element of collective behaviors two parallel self propelled flexible plates were studied by the ib method peng et al 2018b the effects of bending stiffness k and lateral spacing d on the hydrodynamic schooling were also discussed systematically which would not be studied again the emphasis of this present paper is on the hydrodynamic aggregation of parallel flexible plates of proper bending stiffness k with more realistic lateral spacing d hua et al 2013 indicated that the bending stiffness of a fish was usually o 1 the non dimensional parameters are chosen as m 0 2 re 200 k 0 8 a 0 5 and h 0 0 two moderate lateral spacings d 0 9 and d 0 55 are used to avoid the vanishing of flow mediated interaction between flexible plates and the collisions of flexible bodies in the large and narrow lateral spacing situations respectively 5 1 hydrodynamic schooling of two parallel flexible plates hydrodynamic schooling of two parallel self propelled flexible plates the lower positioned plate 1 and the upper positioned plate 2 is investigated 5 1 1 d 0 9 case fig 6 a and b show the time histories of longitudinal velocity difference u 12 t u 1 t u 2 t and separation distance h 12 t x 1 s 0 t x 2 s 0 t between these two plates where u i t and x i s 0 t i 1 2 denote the velocities and positions of the leading edges of plate 1 and plate 2 in the horizontal direction respectively velocity difference u 12 t oscillates around zero with the same amplitude about 0 7u ref eventually which results in the periodical changes of separation distance h 12 t with average value equals to zero during one forced heaving motion cycle t 1 f it indicates that two self propelled flexible plates move forward by an alternate leading al way in the horizontal direction four typical phases in one heaving motion period as shown in fig 7 a d are chosen to illustrate the above mentioned hydrodynamic aggregation modes as well as the vortices contour the leading edges of self propelled plates flap from their positive maximum amplitudes at t t 0 4 to negative maximum amplitudes at t t 1 2 and then move upwards to their equilibrium positions the positions with the prescribed heaving motion y t 0 at t t 3 4 in the lateral direction the leading position is taken up by the actively moving plate 2 from t t 0 4 to t t 1 4 after which is replaced by plate 1 in the longitudinal direction corresponding to al mode two parallel shear layers detached from the lower surfaces of the trailing edges of flexible plates at t t 1 4 start to mix together at t t 1 2 and then a positive vortice represented by red colour forms a negative vortice represented by blue colour is generated by the two parallel shear layers detached from the upper surfaces of the trailing edges from t t 3 4 to t t 1 0 4 the reversed kármán vortex street is presented in the wake flow for corresponding flow fields in one complete period please refer to the supplementary movie 1 for d 0 9 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 1 1 movie 1 in order to understand the mechanism by which the al collective behavior is formed vortices and pressure distributions on the surfaces of flexible plates are discussed in the following pressure contours at four typical instants are shown in fig 8 in which red and blue colours denote the positive and negative pressures respectively the far field pressure is set as zero and the pressures are normalized by p ref ρ f u 2 ref at the beginning of down stroke from the maximum positive amplitude at t t 0 4 shear layers formed start to separate from the lower surfaces of two plates as seen in fig 7 a where two low pressure areas are generated as shown in fig 8 a combined with the comparative higher pressure on the upper surfaces both two plates experience net drag force at this moment fig 9 a displays that f x 0 at t t 0 4 the flow mediated interaction in the area between the upper surface of plate 1 and lower surface of plate 2 makes pressure on the upper surface of plate 1 much smaller than that on the upper surface of plate 2 so the drag force on plate 1 at around t t 0 4 is smaller than that on plate 2 as seen in fig 9 a as two plates stroke down further from t t 1 4 to t t 1 2 the shear layers formed on the lower surfaces detach from the trailing edges of plates and at the meantime another two parallel shear layers start to generate at the leading edges and gradually separate from the upper surfaces of plates as seen in fig 7 b and c fig 8 b and c show that low pressure regions are formed where the separation of shear layers the generation of vortice happens combined with the action of high pressure regions around the lower surfaces the resultant forces on the plates are the thrust f x 0 at t t 1 4 and the net drag f x 0 at t t 1 2 as shown in fig 9 a it indicates that pressure distribution and deformation of flexible plates are the co determinants of the direction of resultant force in addition the flow mediated interaction in the area between the upper surface of plate 1 and lower surface of plate 2 again makes pressure on the lower surface of plate 2 much smaller than that on the lower surface of plate 1 therefore both the absolute values of thrust and drag on plate 2 are lower than those on plate 1 at around t t 1 4 and t t 1 2 as displayed in fig 9 a due to the generated larger thrust at t t 1 4 plate 1 lagged behind starts to catch up with plate 2 at t t 3 4 two flexible plates leave theirs corresponding equilibrium positions y t 0 and flap upwards those movements are symmetric with the motions of two plates at t t 1 4 at which plates leave theirs corresponding equilibrium positions and stroke down the analyses of vortices pressure and force refer to the above discuss at t t 1 4 the larger thrust formed at t t 3 4 as seen in fig 9 a drives plate 2 to chase up plate 1 5 1 2 d 0 55 case fig 6 c and d show that u 12 t and h 12 t evolve gradually to periodic states after t t 5 unequal amplitudes of velocity difference are about 0 4u ref and 0 3u ref separation distance changes with peak value of 0 3l and valley value larger than zero it means that one plate plate 1 falls behind another plate plate 2 in a staggered following sf mode which is also illustrated in fig 7 e h that plate 1 always lags behind plate 2 with the changing longitudinal separation distance the reversed kármán vortex street is also presented in the wake flow and its formation process is the same as that in d 0 9 case compared to the corresponding vortices contours in d 0 9 case fig 7 a d the strong flow mediated interaction in d 0 55 case fig 7 e h makes the shear layers detached much thicker which leads to the bigger size of mixed vortices for corresponding flow fields in one complete period please refer to the supplementary movie 2 for d 0 55 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 2 2 movie 2 the analyses in the d 0 9 case indicate that the flow mediated interaction between two flexible plates decreases the pressure difference of the upper and lower surfaces of the plate this lead to a speculation that the stronger the interaction the smaller the pressure difference which is proved through the comparison between fig 8 f and b the generated smaller thrust of plate 1 at t t 1 4 in d 0 55 case as seen in fig 9 b cannot drive it to surpass plate 2 as it does in d 0 9 case as seen in fig 9 a and then the larger thrust on the plate 2 at t t 3 4 as seen in fig 9 b helps keep its leading position this explains the mechanism by which the sf collective behavior is formed it can be seen from the above researches that the obtained hydrodynamic behaviors of two parallel flexible plates al mode in d 0 9 case and sf mode in d 0 55 case by the loosely coupled partitioned algorithm present the same two main collective modes as those by the ib method peng et al 2018b for the al mode in d 0 9 case the results longitudinal separation distance vortices contour and pressure contour are similar to those obtained in peng et al 2018b this also verifies the loosely coupled partitioned algorithm to some extent for the sf mode in d 0 55 case the results longitudinal separation distance vortices contour and pressure contour are totally different from those in peng et al 2018b due to the different bending stiffness and lateral spacing of flexible plates specifically two flexible plates still present parallel configuration minimum longitudinal separation distance equals to zero h 12 min l 0 in our study rather than behave like one single and longer plate h 12 min l 1 2 in peng et al 2018b and the reversed kármán vortex street is presented in the wake flow with those two main collective modes of two parallel flexible plates obtained one more plate is added in order to find the hydrodynamic behaviors of three parallel flexible plates with those two different lateral spacings d 0 9 and d 0 55 in the following section 5 2 hydrodynamic schooling of three parallel flexible plates hydrodynamic aggregation of three self propelled flexible plates the lower positioned plate 1 the middle positioned plate 2 and the upper positioned plate 3 in side by side configuration is studied 5 2 1 d 0 9 case three velocity differences u ij t u i t u j t are presented in fig 10 a and b as well as the corresponding longitudinal separation distances h ij t x i s 0 t x j s 0 t i j 1 2 3 with i j they all evolve gradually to periodic states after t t 5 history curves of velocity differences fluctuate around zero with different amplitudes the comparison of figs 10 a and fig 6 a shows that the values of velocity differences in three flexible plates cases are larger than those in two flexible plates cases fig 10 b illustrates that h 12 t is smaller than zero h 23 t is larger than zero and h 13 t oscillates with peak value larger than zero and valley value smaller than zero it indicates that plate 2 moves forward following plates 1 and 3 with a staggered configuration and plates 1 and 3 take up an al mode in the horizontal direction compared to the values of separation distances in fig 6 b the longitudinal distances between the leading edges of three flexible plates are larger than those of two flexible plates vortices contour of three self propelled flexible plates at four typical instants t t 0 4 1 4 1 2 and 3 4 is illustrated in fig 11 as well as the relative positions of those plates fig 11 a d show that the upper positioned plate 3 moves ahead of the lower positioned plate 1 from t t 0 to t t 1 4 and then be caught up by plate 1 from t t 1 2 to t t 3 4 corresponding to the al mode the middle positioned plate 2 falls behind in the sf mode it can be seen that the lower positioned plate 1 and the upper positioned plate 3 present the same hydrodynamic aggregation mode as plates 1 and 2 do in the two parallel plates case seen in section 5 1 1 different from the emergence of the reversed kármán vortex street in the two parallel plates cases as shown in fig 7 a d the vortices contour in the three parallel plates case as seen in fig 11 a d is more complicated although the same two shear layers generate on the lower and upper surfaces of each plate during one forced heaving motion cycle the mixing process of those detached shear layers in the three parallel plates case is different the shear layer is named after its plate on which it forms and positive denoted by red colour and negative denoted by blue colour values are also separated fig 11 a b shows that negative shear layers 2 and 3 mix with leaving negative shear layer 1 alone and fig 11 c d illustrates that positive shear layers 1 and 2 mix with leaving positive 3 alone for corresponding flow fields in one complete period please refer to the supplementary movie 3 for d 0 9 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 3 3 movie 3 pressure contours of three parallel plates are presented in fig 12 the discussion of pressure distributions on the lower and upper positioned plates 1 and 3 refers to the corresponding content in section 5 1 1 because they present the same hydrodynamic aggregation mode al mode in d 0 9 case as plates 1 and 2 do in the two parallel plates case the mechanism by which the middle positioned plate 2 follows the upper positioned plate 3 and lower positioned plate 1 in the sf mode is explained as follows fig 12 a c show that the middle positioned plate 2 is influenced by the flow mediated interaction from both the lower and upper positioned plates 1 and 3 so the pressure difference on the lower and upper surfaces of plate 2 is the lowest among these three parallel plates and plate 2 experiences the lowest drag f x 0 at t t 0 4 and t t 1 2 as shown in fig 13 a fig 12 b shows that the stronger flow mediated interaction happens in the region between plate 2 and plate 3 than the area between plate 2 and plate 1 which leads to that pressure difference on plate 3 is smaller than plate 2 so the larger thrust formed as seen in fig 13 a drive plate 2 to chase up plate 3 at around t t 1 4 the similar flow mediated interaction emerges in fig 12 d in which pressure difference on plate 1 is smaller than plate 2 so the larger thrust as shown in fig 13 a drives plate 2 to chase up plate 1 at around t t 3 4 it can also be seen from fig 12 b d that the largest pressure differences are on plate 1 and plate 3 respectively the largest thrust as seen in fig 13 a generated helps plates 1 and 3 to take up the leading position 5 2 2 d 0 55 case as presented in fig 10 d h 12 t fluctuates around zero and both h 13 t and h 23 t are larger than zero it indicates that plates 1 and 2 move forward in an al mode and follow plate 3 in an sf mode fig 11 e h also display that the lower positioned plate 1 moves forward following the middle positioned plate 2 from t t 0 to t t 1 4 after which plate 1 surpasses plate 2 corresponding to the al mode the upper positioned plate 3 always takes the leading position with plates 1 and 2 following behind in the sf mode it can be seen that the lower positioned plate 1 and the upper positioned plate 3 also present the same hydrodynamic aggregation mode as plates 1 and 2 do in the two parallel plates case seen in section 5 1 2 the sf modes are formed in d 0 55 case different from the emergence of the reversed kármán vortex street in the two parallel plates cases as shown in fig 7 e h the vortices contour in the three parallel plates case as seen in fig 11 e h is also more complicated two kinds of mixing process of detached shear layers occur the first mixing type is shown in fig 11 g and h that the positive shear layers 1 2 and 3 mix together the second mixing type is seen in fig 11 h the detached negative shear layer 3 passes the upper surface of plate 2 at t t 3 4 and falls far behind the mixed negative shear layers 1 and 2 from t t 1 0 4 to t t 1 1 2 as shown in fig 11 e f g for corresponding flow fields in one complete period please refer to the supplementary movie 4 for d 0 55 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 4 4 movie 4 the discussion of pressure distributions on the lower and upper positioned plates 1 and 3 refers to the corresponding content in section 5 1 2 because they present the same hydrodynamic aggregation mode sf mode in d 0 55 case as plates 1 and 2 do in the two parallel plates case as indicated in the three parallel plates case with d 0 9 the flow mediated interaction from both the lower and upper positioned plates 1 and 3 would decrease the pressure difference on the lower and upper surfaces of plate 2 and then its corresponding maximum thrust is the lowest among those three flexible plates under this simple analysis it seems that plate 2 would fall behind however fig 13 b shows that the maximum thrust on the plate 2 at about t t 3 4 is similar to the maximum thrust on plate 1 at t t 1 4 the complicated flow mediated interaction is the cause it can be seen from fig 11 h that the detached shear layer 3 passes the upper surface of plate 2 behind which an extremely high pressure distribution is formed as seen in fig 12 h the generated large thrust drives the plate 2 surpass plate 1 from t t 0 4 to 1 4 this explains why plate 2 does not always fall behind as it does in d 0 9 case and plates 1 and 2 move forward in the al mode 5 3 plate performance three parameters propulsive speed input power and propulsive efficiency are extensively used to quantify the schooling performance of each plate zhu et al 2014 peng et al 2018a 2018b the mean propulsive speed u i i 1 2 3 is defined as the average forward speed of the leading edge of flexible plates 1 2 or 3 i e 19 u i 1 t t t t x i 0 t t d t the average input power p i is required to produce both the flapping and forward movements i e 20 p i 1 t t t t 0 l f i s t x i s t t d s d t the ratio of the kinetic energy and the input power during a heaving motion cycle is the propulsive efficiency η i i e 21 η i 1 2 ρ l l u i 2 p i t table 1 presents the propulsive properties of each plate in different cases the input power is normalized by p ref ρ f u 3 refl the data of an isolated plate zhu et al 2014 are also given for comparison it can be seen that multiple self propelled flexible plates in side by side configuration move forward with lower velocities and efficiencies than an isolated plate this conclusion explains why parallel swimmers are rare in nature expect for the racing swimmers in the pool when three parallel flexible plates undergo the identical heaving motion the preferred v configuration in nature does not emerge the middle positioned plate 2 lags behind and consumes more input power to achieve the same forward velocity as the lower and upper positioned plates this gives a hint from the opposite angle that the role of leader in v formations is always taken by the strongest one of the group besides three flexible plates have higher propulsive speed than two flexible plates under the nearly same or smaller input power which puts forward a speculation that energy benefits are obtained if more individuals participate in hydrodynamic aggregation even in this undesired parallel configuration more flexible plates are needed to verify this speculation which is our future work 6 conclusions the present contribution is concern with the modification of a previously proposed loosely coupled partitioned algorithm zhang et al 2020 for the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates the commercial cfd solver fluent version 13 0 1 is extended with a dedicated user defined function udf in which structure field is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam as well as the inextensible condition of flexible plates is complemented hydrodynamic schooling of two self propelled flexible plates in tandem configuration is simulated by the modified loosely coupled partitioned algorithm comparison of the time history of streamwise velocity and longitudinal separation distance to the solutions by the extensively used ib method verifies the accuracy of this algorithm and then this algorithm is adopted to study the hydrodynamic aggregation of multiple two or three self propelled flexible plates in side by side configuration two typical collective modes are formed spontaneously in two self propelled flexible plates with different lateral spacings d i e the al mode in d 0 9 case and sf mode in d 0 55 case in three parallel plates cases the lower and upper positioned plates present the same hydrodynamic aggregation modes the al and sf modes as in two parallel plates cases and the middle positioned plate lags behind in the sf configuration the flow details vortices and pressure distribution are analyzed in order to understand the mechanism by which different hydrodynamic schooling modes are formed it is found that the low pressure region forms where the separation of shear layers occurs and the flow mediate interaction between plates leads to the different pressure distributions on the plates those two factors co determine the hydrodynamic schooling of parallel self propelled plates finally the propulsive performance of parallel plates is discussed compared to the isolated plate self propelled flexible plates in side by side configuration present lower propulsive speeds and efficiencies this explains why parallel swimmers are rarely seen in nature the preferred v formation in nature is not obtained in three parallel self propelled plates and the middle positioned plate should consume more energy in order to be the leading goose besides three self propelled plates have higher propulsive speeds and efficiencies than two self propelled plates it puts forward a speculation that energy benefits are achieved in collective behavior if more individuals participate although only two or three parallel flexible plates with two different lateral spacings are investigated this study may still shed some light on the cognition of the collective behaviors in natural system the hydrodynamic aggregation of swimmers in nature is more complicated due to the precisely controlled amount lateral spacings and different self propelled motions of individuals more flexible plates of different properties such as different length bending stiffness undergoing heaving motions with different amplitudes and lateral spacings are our future work in order to find the energy beneficial collective mode over the solitary swimming mode credit authorship contribution statement chizhong wang visualization investigation jianglong sun writing review editing de xie writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the present work is supported by the major project for special technology innovation of hubei province grant no 2019aaa041 the national natural science foundation of china grant no 51679097 and the china postdoctoral science foundation grant no 2019m652650 
21030,mechanism of hydrodynamic aggregation of swimmers is an intriguing problem which is usually studied by the immersed boundary ib method in this paper a loosely coupled partitioned algorithm is used to simulate this fluid structure interaction fsi problem specifically flow field is simulated by finite volume method and structure field is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam first of all this algorithm is validated through simulating collective behavior of two actively moving two dimensional 2d flexible plates in tandem configuration driven by the harmonic plunging motions of their leading edges with identical frequency and amplitude then the hydrodynamic aggregations of multiple two or three 2d flexible plates in side by side configuration are studied it is found that two different stable configurations alternate leading mode al and staggered following mode sf are formed spontaneously in two parallel flexible plates and are determined by the lateral spacing between them in three parallel plates scenario the middle plate follows behind in sf mode while the other two plates present al and sf modes with different lateral spacings accordingly besides the flow details in different configurations are illustrated and the corresponding propulsive properties velocity input power and efficiency of plates are discussed keywords hydrodynamic aggregation fluid structure interaction loosely coupled partitioned algorithm flexible plates 1 introduction the phenomenon of aggregation of animals in fluid is ubiquitous in our daily life such as bird flocks and fish schools it is commonly recognized that this collective behavior of animals provides benefit for reproduction feeding and defense against predators scientific observation method was applied by biologists and explanations of collective behavior were given qualitatively from the aspect of survival supplies and environmental demands humston et al 2000 moyle et al 2004 olson et al 2013 however those qualitative interpretations cannot meet the need of cognition of this natural phenomenon and then the speculations that the aggregations of the group help to save energy expenditure and are spontaneously formed as the consequence of flow mediated interaction are proposed which draw the attention of researchers aerodynamic theory was adopted by lissaman and schollenberger 1970 to predict the relative positions of large migration birds such as goose in v formations it was found that the rear individuals could exploit the upward wash generated by the front birds weihs 1973 analyzed the von kármán vortex theoretically and indicated that the rear fish positioned midway would be driven by the vortex generated by the two fishes in the preceding row of the diamond configuration however partridge and pitcher 1979 pointed out that little biological evidence of hydrodynamic advantage in the diamond pattern was found live animal tests are also applied weimerskirch et al 2001 measured wing beat frequency and heart rate of 8 great white pelicans in v formations and the data of rear birds obtained were 11 4 14 5 lower than those of the leading pelican svendsen et al 2003 also found that the flapping frequency in schooling roach was 11 6 lower than that of fish swimming alone under experimental conditions liao et al 2003a 2003b experimentally compared the hydrodynamic behavior of a trout in uniform flow and wake flow of d section cylinder quantitative flow visualization and electromyography showed that trout would exploit vortices of the cylinder and reduced muscle activity was detected this same phenomenon was also seen in the experiment by beal et al 2006 portugal et al 2014 used global positioning system gps to record positions and wing flapping frequencies of 14 ibises during migratory flight and found that v configuration was preferred even though position adjustments of some individuals heart rate flapping frequency and muscle activity only provide circumstantial evidences of energy expenditure in collective behavior in order to get more direct data such as force and propulsive efficiency many bionic experiments beal et al 2006 lauder et al 2007 wang 2010 becker et al 2015 were adopted which could be divided into two categories for example ristroph and zhang 2008 studied the flow induced flapping problem of two flexible flags in different configurations and found that the leading flag enjoyed a significant drag reduction of up to 50 while force on the following flag increased this first kind of bionic experiment did not take the self propelled motion of flexible bodies into consideration boschitsch et al 2014 and ramananarivo et al 2016 investigated the thrust propulsive efficiency and velocity of multiple self propelled rigid bodies in tandem configuration and indicated that the propulsive efficiency increased up to 50 if proper longitudinal spacing was chosen and flow mediated interaction between rigid bodies determined the different collective formations this second kind of test discussed collective behavior of multiple rigid bodies without consideration of flexibility of animals it can be seen that the bionic experiment of hydrodynamic aggregation of self propelled flexible plates is needed in order to describe the collective behavior of animals more accurately which is not an easy task under the existing experimental conditions now compared to the experimental method numerical simulation provides an economic way to study this fsi problem of collective behavior with the development of computational technology and different numerical methods besides flow details obtained are helpful to analyze the flow mediated interaction which helps to illustrate the mechanism by which different collective modes are formed zhu and peskin 2003 and huang et al 2007 used the immersed boundary ib method to study the flow induced flapping problem of two parallel flexible filaments in uniform flow two different oscillation modes in phase and out of phase modes emerged due to the different flow mediated interactions determined by the lateral spacing the same ib method was also adopted to discuss two flexible filaments in tandem configuration jia and yin 2008 zhu 2009 it was found that both force on the rear filament and its flapping amplitude were larger than those of the leading filament panel method and mode superposition method were applied to study the flow induced problem of two flexible plates in different configurations wang 2010 and results about force amplitude and hydrodynamic modes were given uddin et al 2015 adopted the ib method to investigate the hydrodynamic performance of the active flapping flexible flag in the wake flow of the leading flow induced flapping flags both the slalom mode and interception mode were formed due to the vortex body interactions corresponding to the low and high drag situations respectively zhang et al 2020 proposed a loosely coupled scheme based on the platform of commercial computational fluid dynamics software fluent version 13 0 1 for the flow induced flapping problem of flexible plates the flexible bodies are fixed in uniform flow in these above investigations it is different from the realistic movements of bird and fish in which active motion is obtained by the self propelled flexible bodies zhu et al 2014 started to use ib method to discuss the hydrodynamic aggregation of two tandem self propelled flexible filaments driven by the same forced heaving motions of their leading edges compact and regular configurations were formed passively due to the vortex body interaction and vortex locking mechanism was proposed to explain the mechanism of those two different collective behaviors compact configuration consumes more energy to achieve the higher propulsive speed the same phenomenon was illustrated in the study of multiple up to eight self propelled flexible plates in tandem configuration by ib method peng et al 2018a besides peng et al 2018b used the same ib method to investigate the collective behavior of two parallel self propelled flexible plates the spontaneously formed staggered following sf mode alternate leading al mode and moving abreast ma mode were presented among which sf and ma modes achieve higher propulsive speed under more input power it can be seen from the above numerical simulations that the fsi problem of collective behavior is extensively solved by the ib method ib method is a comparatively new way to deal with the coupling surface in fsi problem it is usually combined with the prescribed computational fluid dynamic codes based on lattice boltzmann method rather than some commercial computational fluid dynamics software which puts forward a high requirement for researchers to study collective behaviors therefore it can also be seen from the above numerical simulations that the investigation of hydrodynamic aggregation of self propelled flexible plates the realistic collective behavior of animal in different configurations is rare until now the purposes of the current work are twofold first the proposed loosely coupled partitioned algorithm based on the commercial computational fluid dynamics software for the flow induced flapping problem of flexible plates in our previous work zhang et al 2020 is modified for the fsi problem of collective behavior of self propelled flexible plates in this algorithm momentum equation is added to describe the longitudinal movement of the flexible plates driven by its own thrust and the inextensibility condition of the plates is complemented second hydrodynamic aggregation of self propelled system of multiple two or three parallel flexible plates is investigated the flexible plates move freely in the longitudinal direction under the thrust induced by the prescribed heaving motion of their leading edges in the lateral direction different collective modes are formed spontaneously flow details force and propulsive properties are also discussed in order to explain the mechanism and energy cost of those hydrodynamic aggregation modes the remainder of this paper is arranged as follows section 2 presents governing equations of the fluid structure coupling system in section 3 the numerical simulation method and loosely coupling partitioned algorithm are illustrated section 4 describes the verification of this algorithm by simulating two self propelled flexible plates in tandem configuration section 5 presents the applications of the modified loosely coupled partitioned algorithm in the study of hydrodynamic aggregation of multiple flexible plates in side by side configuration conclusions are drawn in section 6 2 governing equations as shown in fig 1 let x and y be the coordinates in horizontal and vertical directions respectively a viscous impressible fluid domain ω f is considered in which two or three parallel 2d flexible plates structure domains represented by ω s are embedded the clamped leading edges of flexible plates undertake the harmonic plunging motion in lateral direction and the forces formed by the interaction with fluid self propulsion drive the plates to move in horizontal direction freely the forced heaving motions of the leading edges are prescribed by y t acos 2πft with a being the identical heaving amplitude and f the frequency the 2d flexible plate of thickness h and length l h l is modeled as euler bernoulli beam the lateral spacing between the leading edges of plates is d which maintains constant during motion the longitudinal spacing between the leading edges of plates is h t which is initially set as h 0 h t 0 0 if not specified and then determined by flow mediated interaction between parallel plates during simulation this simple setting of thin elastic plates is extensively used to study the collective behavior of actively moving swimmers zhu et al 2014 peng et al 2018a 2018b 2 1 governing equations of fluid the flow of a viscid incompressible fluid is governed by the conservation of mass and momentum the navier stokes equations are as follows 1a u f 0 i n ω f 0 t 1b ρ f u f t ρ f u f u f p f μ 2 u f ρ f g f i n ω f 0 t where u f ρ f p f μ g f are the fluid velocity vector density pressure dynamic viscosity and external applied body force vector respectively to complete the system appropriate initial and boundary conditions are need 2a u t 0 f 0 i n ω 0 f 2b u f u i o n γ i 0 t 2c u f 0 o n γ w 0 t where the fluid velocity condition u i applied on the interfaces γ i ω f ω s between fluid domain and structure domain is described by the movement of the plates the no slip shear condition is adopted on the stationary walls γ w 2 2 governing equations of structure the governing equation of flexible plate in zhu et al 2014 and peng et al 2018a 2018b is analyzed it is found that although the structural stretching rigidity of plate is of big value the shear deformation equals to zero and then the shear force is of finite value about zero the governing equation could be decoupled the dynamic equilibriums of the thin 2d flexible plates in x and y directions are approximated through momentum equation and bending vibration equation of the euler bernoulli beam respectively 3a ρ l 2 x s t t 2 f x s t i n ω s 0 t 3b ρ l 2 y s t t e i 4 y s t s 4 f y s t i n ω s 0 t with ρ l ρ s h i h 3 12 where ρ l e ρ s and i are the linear density young s modulus density and inertia moment of the structure respectively s is the lagrangian coordinate along the plate x s t x s t y s t is the position vector of the plates and f s t f x s t f y s t is lagrangian force vector on the plates by the fluid the inextensibility condition of the plates is adopted as 3c x s x s 1 i n ω s 0 t the governing equations are complemented by the following appropriate initial and boundary conditions 4a x s 0 x s 0 y s 0 i n ω 0 s 4b x s 0 t x s 0 t y s 0 t i n ω 0 s 4c y 0 t y t y i i 1 2 3 on γ l 0 t 4d f s t p f s t n f o n γ i 0 t where y i i 1 2 3 is the equilibrium positions of heaving motions of plates 1 2 and 3 γ l is the clamped leading edge of the plate p f s t defines the traction force on the interface γ i and n f is the unit outward normal vector it is not a user defined value but obtained from the fluid solution 2 3 interface γ i is the fluid structure coupling surface through which two different fields fluid and structure interact with each other it can be seen from eqs 2b and 4d that the interface condition applied on one field is dictated by the behavior of the other fluid field produces hydrodynamic force that alters the dynamic condition of the structure field and this dynamic behavior of structure in turn provides kinematic condition that influences the fluid field on γ i the whole fsi system should satisfy both velocity and traction continuities as follows 5 u i x s t t o n γ i 0 t 6 p f s t n f f s t n s o n γ i 0 t where n s is the unit outward normal vector 3 loosely coupled partitioned algorithm the strong added mass effect of the slender shaped flexible plates h l mentioned in the flow induced flapping problem of flexible plates in our early work zhang et al 2020 should be considered in the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates in addition the longitudinal movement of flexible plates driven by their prescribed heaving leading edges should also be solved for the added mass effect idelsohn et al 2009 indicated that it caused numerical difficulties in various fluid structure coupled algorithms such as instability non convergence in order to overcome these numerical difficulties various strongly coupled partitioned algorithms causin et al 2005 wang 2010 sudhakar and wall 2018 are proposed however search of the open literatures indicates that the loosely coupled partitioned algorithm considering strong added mass effect is rare liu et al 2014 once proposed a stable second order scheme based on the loosely coupled partitioned algorithm in consideration of the high computational cost of sub iterations in the strongly coupled partitioned algorithms e g 50 sub iterations are needed in wang 2010 the stable loosely coupled partitioned algorithm is particularly appealing in terms of its efficiency without sub iterations enlighten by the method of artificial added mass causin et al 2005 förster et al 2007 yvin et al 2018 zhang et al 2019a 2019b zhang et al 2020 proposed a loosely coupled partitioned algorithm on the platform of fluent version 13 0 1 for the flow induced flapping problem of flexible plates for the longitudinal movement of flexible plates driven by their prescribed heaving leading edges momentum equation is added as well as the prescribed heaving motion of leading edges to sum up the proposed loosely coupled partitioned algorithm zhang et al 2020 is modified for the hydrodynamic aggregation of parallel self propelled flexible plates with momentum equation and prescribed heaving motion of leading edges being complemented in this paper specifically fluid domain is simulated by finite volume method fvm structure domain is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam in the longitudinal and lateral direction respectively 3 1 fluid fvm integrates the transport equation on a control volume basis yielding a discrete equation satisfying the conservation law as follows 7 v ρ f φ t d v ρ f φ u f n s d s γ φ φ n s d s v s φ d v where φ represents a scalar quantity in the unsteady conservation equation v and s are an arbitrary control volume and its corresponding surfaces respectively n s is the normal vector of the surfaces γ φ is the diffusion coefficient for φ s φ is the source of φ per unit volume the time derivative term in eq 7 is defined in temporal discretization for transient simulations first order implicit time integration is applied 8 φ n 1 φ n δ t f φ n 1 where φ n and φ n 1 represent the values at the current time step and the next time step respectively the function f incorporates any spatial discretization once flow details are obtained the hydrodynamic force on the flexible plates is obtained through integrating pressure along the length of the plate and the spatial discretization form is expressed as 9 f p f s t n f δ s 3 2 structure once the longitudinal hydrodynamic force on the plate is obtained through eq 9 eq 3a can be solved by the direct integral method the longitudinal velocity and displacement of plate are obtained to solve eq 3b boundary conditions for the clamped leading edges and free ends of self propelled flexible plates are needed 10a y 0 t y t y i x 0 t s 1 0 3 y 0 t s 3 0 10b 2 y l t s 2 0 3 y l t s 3 0 the initial conditions are as follows 11 x s 0 s y 0 y i x s 0 t 0 0 where eqs 10 and 11 are the specific descriptions for eqs 4a 4c of the euler bernoulli beam it can be seen that the leading edges undertaking the forced heaving motion provide different boundary conditions from the flow induced flapping problem in zhang et al 2020 the lateral displacement of flexible plates is expressed as 12 y s t y t y i y s t with eq 12 being substituted eq 3b is rewritten as 13 ρ l 2 y s t t 2 e i 4 y s t s 4 f y s t ρ l 2 y t t 2 i n ω s 0 t it can be seen from the second item in the right side of eq 13 that the prescribed heaving motion of leading edges provides an external force on the flexible plates and then the model superposition method is applied to solve eq 13 with the passive displacement y s t being expressed as 14 y s t ϕ j s q j t the calculation process refers to the corresponding content in zhang et al 2020 solutions are given as follows 15 ϕ j s cos β j s cosh β j s cos β j l cosh β j l sin β j l sinh β j l sin β j s sinh β j s 16 q j t 1 m j ω j 0 t p j τ sin ω j t τ d τ q j 0 cos ω j t q j t ω j t sin ω j t with β 1 l 1 875 β 2 l 4 694 β 3 l 7 855 β j l j 0 5 π j 4 m j 0 l ϕ j 2 s ρ l d s ω j β j 2 e i ρ l p j t 0 l ϕ j s f y s t ρ l 2 y t t d s where β j is constant coefficient m j p j t are the generalized mass and generalized force respectively ω j is inherent frequency in addition the strong added mass effect should be considered artificial added mass method causin et al 2005 förster et al 2007 yvin et al 2018 zhang et al 2019a 2019b is adopted the frequency dependent theoretical added mass λ j 2ρ f β j as obtained in beummelen 2009 jaiman et al 2014 of 2d flexible plate is added and then the inherent frequency generalized mass and generalized force change to m j 0 l ϕ j 2 s ρ l λ j d s ω j β j 2 e i ρ l λ j p j t 0 l ϕ j s f y s t ρ l 2 y t t λ j ϕ j s 2 q j t 2 d s then the vertical displacement of the flexible plate is obtained by 17 y s t y t y i ϕ j s q j t in order to maintain the inextensibility condition of the plate the spatial discretization form of eq 3c is expressed as 18 x s x s δ x δ s δ y δ s δ x δ s δ y δ s δ x 2 δ s 2 δ y 2 δ s 2 1 once the lateral displacement is obtained through eq 17 the longitudinal displacement of plate due to the inextensibility condition can be solved through eq 18 those structural displacements are transferred to the fluid domain through dynamic mesh technology in fluent version 13 0 1 in order to ensure the fluid structure interaction specifically both smoothing setting spring constant factor as 1 and remeshing setting maximum cell skewness as 0 7 mesh update methods sas ip 2010 are adopted in this paper 3 3 algorithm the same coupling steps zhang et al 2020 from time level t n to t n 1 are described in algorithm 1 as follows algorithm 1 loosely coupled partitioned algorithm based on fluent version 13 0 1 1 start from known solutions u f u f n x s t x s t n x s t t x s t n t at time t n 2 advance from time level t n to t n 1 a obtain p f n by solving fluid equation eq 1 b define the structural position x s t n 1 by solving structural equation eq 3 c update the fluid field accordingly using dynamic mesh technology and the flow chart is shown in fig 2 it can be seen that the modified loosely coupled partitioned algorithm for the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates has two advantages first this modified algorithm is developed based on the commercial computational fluid dynamics software fluent version 13 0 1 which lowers the skill threshold compared to the extensively used ib method for researchers to study collective behaviors second the governing equations of fluid and structure fields are solved only once at each time step the loosely coupled partitioned algorithm retains and carries numerical errors at each time step without reducing them through sub iterations as the strongly coupled partitioned algorithm wang 2010 does which makes this algorithm very sufficient in this paper more concerns are put on acquiring the desired accuracy by this more economic loosely coupled partitioned algorithm in solving fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates 4 verification of the loosely coupled partitioned algorithm to validate the present loosely coupled partitioned algorithm hydrodynamic behavior of two self propelled flexible plates in tandem configuration is simulated and the results are compared with the solutions by the ib method zhu et al 2014 the characteristic length l velocity u ref 2πaf and density ρ f are applied to normalize the above mathematical formulations the dimensionless parameters are defined as follows the linear mass ratio of the plates and the fluid m ρ l ρ f l the reynolds number re ρ f u ref l μ the bending stiffness k ei ρ f u2 refl 3 heaving amplitude a a l the lateral spacing d d l the longitudinal spacing h h l the numerical cases of m 0 2 re 200 k 0 8 a 0 5 d 0 and h 0 8 or 9 in zhu et al 2014 are simulated to illustrate the accuracy of the modified algorithm h 0 represents the initial longitudinal spacing between two tandem plates computational domain and boundary conditions refer to fig 1 based on our convergence studies with different computational domains the size of the fluid domain is set as 60l 30l 20l 20l in the x and y directions fig 3 a shows the obtained pressure contour it can be seen that there is undisturbed fluid around the boundaries of domain and then the blockage effect of no slip stationary walls γ w on the actively moving plates is negligible hybrid grid is used for spatial discretization of the fluid domain fig 3 b shows the grid system in which mesh unstructured triangular grid around the thin plates is refined minimum grid length δl min 0 02l in order capture the details of the flow the time step size δt 0 01s about 0 001t is used for the simulation of fluid flow and the deformation of plates t 1 f is the period of the heaving motion of the leading edges the maximum number j max 5 of natural modes of the flexible plates is chosen fig 4 shows the forward velocity time history curves and separation distance time history curves of plates obtained by the present loosely coupled partitioned algorithm and the ib method two plates move forwards with the same velocity from t t 0 to 2 and then for h 0 8 case the following plate catches up with the leading plate by a sudden acceleration before the separation distance of two plates finally reaches the equilibrium value h l l 5 for h 0 9 case the following plate falls behind the leading plate by a sudden deceleration before their longitudinal separation distance reaches the equilibrium value h l l 11 it can also be seen that although there are some discrepancies from t t 2 to 4 the computed values are overall in good agreement with each other especially after t t 5 when the stable hydrodynamic aggregation of two tandem flexible is obtained the discrepancies of streamwise velocity and longitudinal distance from t t 2 to 4 may come from two aspects the approximated expression of flexible plates and numerical errors of the loosely coupled partitioned algorithm without sub iterations those discrepancies have no distinct influence on the stable hydrodynamic aggregation of two tandem plates at last the desired accuracy is obtained by the present loosely coupled partitioned algorithm besides mesh sensitivity analysis temporal convergence analysis and mode truncation study are performed in which another two different grid systems with δl min 0 01l and δl min 0 04l two different time step sizes δt 0 002s and δt 0 05s and two different numbers of natural modes j max 3 and j max 10 are studied respectively the results are presented in fig 5 the comparison of the obtained stable streamwise velocity time history curves indicates that numerical results are monotonically convergent with the decrease of minimum grid length and time step size as well as the increase of number of natural modes grid system with minimum edge length of δl min 0 02l time step size δt 0 01s and number of natural modes j max 5 produce enough accurate results and are adopted in the following works if not otherwise specified 5 application to multiple parallel flexible plates in this section collective behaviors of multiple two or three self propelled flexible plates in side by side configuration are simulated by the modified loosely coupled partitioned algorithm as one of the simplest group configurations for the basic element of collective behaviors two parallel self propelled flexible plates were studied by the ib method peng et al 2018b the effects of bending stiffness k and lateral spacing d on the hydrodynamic schooling were also discussed systematically which would not be studied again the emphasis of this present paper is on the hydrodynamic aggregation of parallel flexible plates of proper bending stiffness k with more realistic lateral spacing d hua et al 2013 indicated that the bending stiffness of a fish was usually o 1 the non dimensional parameters are chosen as m 0 2 re 200 k 0 8 a 0 5 and h 0 0 two moderate lateral spacings d 0 9 and d 0 55 are used to avoid the vanishing of flow mediated interaction between flexible plates and the collisions of flexible bodies in the large and narrow lateral spacing situations respectively 5 1 hydrodynamic schooling of two parallel flexible plates hydrodynamic schooling of two parallel self propelled flexible plates the lower positioned plate 1 and the upper positioned plate 2 is investigated 5 1 1 d 0 9 case fig 6 a and b show the time histories of longitudinal velocity difference u 12 t u 1 t u 2 t and separation distance h 12 t x 1 s 0 t x 2 s 0 t between these two plates where u i t and x i s 0 t i 1 2 denote the velocities and positions of the leading edges of plate 1 and plate 2 in the horizontal direction respectively velocity difference u 12 t oscillates around zero with the same amplitude about 0 7u ref eventually which results in the periodical changes of separation distance h 12 t with average value equals to zero during one forced heaving motion cycle t 1 f it indicates that two self propelled flexible plates move forward by an alternate leading al way in the horizontal direction four typical phases in one heaving motion period as shown in fig 7 a d are chosen to illustrate the above mentioned hydrodynamic aggregation modes as well as the vortices contour the leading edges of self propelled plates flap from their positive maximum amplitudes at t t 0 4 to negative maximum amplitudes at t t 1 2 and then move upwards to their equilibrium positions the positions with the prescribed heaving motion y t 0 at t t 3 4 in the lateral direction the leading position is taken up by the actively moving plate 2 from t t 0 4 to t t 1 4 after which is replaced by plate 1 in the longitudinal direction corresponding to al mode two parallel shear layers detached from the lower surfaces of the trailing edges of flexible plates at t t 1 4 start to mix together at t t 1 2 and then a positive vortice represented by red colour forms a negative vortice represented by blue colour is generated by the two parallel shear layers detached from the upper surfaces of the trailing edges from t t 3 4 to t t 1 0 4 the reversed kármán vortex street is presented in the wake flow for corresponding flow fields in one complete period please refer to the supplementary movie 1 for d 0 9 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 1 1 movie 1 in order to understand the mechanism by which the al collective behavior is formed vortices and pressure distributions on the surfaces of flexible plates are discussed in the following pressure contours at four typical instants are shown in fig 8 in which red and blue colours denote the positive and negative pressures respectively the far field pressure is set as zero and the pressures are normalized by p ref ρ f u 2 ref at the beginning of down stroke from the maximum positive amplitude at t t 0 4 shear layers formed start to separate from the lower surfaces of two plates as seen in fig 7 a where two low pressure areas are generated as shown in fig 8 a combined with the comparative higher pressure on the upper surfaces both two plates experience net drag force at this moment fig 9 a displays that f x 0 at t t 0 4 the flow mediated interaction in the area between the upper surface of plate 1 and lower surface of plate 2 makes pressure on the upper surface of plate 1 much smaller than that on the upper surface of plate 2 so the drag force on plate 1 at around t t 0 4 is smaller than that on plate 2 as seen in fig 9 a as two plates stroke down further from t t 1 4 to t t 1 2 the shear layers formed on the lower surfaces detach from the trailing edges of plates and at the meantime another two parallel shear layers start to generate at the leading edges and gradually separate from the upper surfaces of plates as seen in fig 7 b and c fig 8 b and c show that low pressure regions are formed where the separation of shear layers the generation of vortice happens combined with the action of high pressure regions around the lower surfaces the resultant forces on the plates are the thrust f x 0 at t t 1 4 and the net drag f x 0 at t t 1 2 as shown in fig 9 a it indicates that pressure distribution and deformation of flexible plates are the co determinants of the direction of resultant force in addition the flow mediated interaction in the area between the upper surface of plate 1 and lower surface of plate 2 again makes pressure on the lower surface of plate 2 much smaller than that on the lower surface of plate 1 therefore both the absolute values of thrust and drag on plate 2 are lower than those on plate 1 at around t t 1 4 and t t 1 2 as displayed in fig 9 a due to the generated larger thrust at t t 1 4 plate 1 lagged behind starts to catch up with plate 2 at t t 3 4 two flexible plates leave theirs corresponding equilibrium positions y t 0 and flap upwards those movements are symmetric with the motions of two plates at t t 1 4 at which plates leave theirs corresponding equilibrium positions and stroke down the analyses of vortices pressure and force refer to the above discuss at t t 1 4 the larger thrust formed at t t 3 4 as seen in fig 9 a drives plate 2 to chase up plate 1 5 1 2 d 0 55 case fig 6 c and d show that u 12 t and h 12 t evolve gradually to periodic states after t t 5 unequal amplitudes of velocity difference are about 0 4u ref and 0 3u ref separation distance changes with peak value of 0 3l and valley value larger than zero it means that one plate plate 1 falls behind another plate plate 2 in a staggered following sf mode which is also illustrated in fig 7 e h that plate 1 always lags behind plate 2 with the changing longitudinal separation distance the reversed kármán vortex street is also presented in the wake flow and its formation process is the same as that in d 0 9 case compared to the corresponding vortices contours in d 0 9 case fig 7 a d the strong flow mediated interaction in d 0 55 case fig 7 e h makes the shear layers detached much thicker which leads to the bigger size of mixed vortices for corresponding flow fields in one complete period please refer to the supplementary movie 2 for d 0 55 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 2 2 movie 2 the analyses in the d 0 9 case indicate that the flow mediated interaction between two flexible plates decreases the pressure difference of the upper and lower surfaces of the plate this lead to a speculation that the stronger the interaction the smaller the pressure difference which is proved through the comparison between fig 8 f and b the generated smaller thrust of plate 1 at t t 1 4 in d 0 55 case as seen in fig 9 b cannot drive it to surpass plate 2 as it does in d 0 9 case as seen in fig 9 a and then the larger thrust on the plate 2 at t t 3 4 as seen in fig 9 b helps keep its leading position this explains the mechanism by which the sf collective behavior is formed it can be seen from the above researches that the obtained hydrodynamic behaviors of two parallel flexible plates al mode in d 0 9 case and sf mode in d 0 55 case by the loosely coupled partitioned algorithm present the same two main collective modes as those by the ib method peng et al 2018b for the al mode in d 0 9 case the results longitudinal separation distance vortices contour and pressure contour are similar to those obtained in peng et al 2018b this also verifies the loosely coupled partitioned algorithm to some extent for the sf mode in d 0 55 case the results longitudinal separation distance vortices contour and pressure contour are totally different from those in peng et al 2018b due to the different bending stiffness and lateral spacing of flexible plates specifically two flexible plates still present parallel configuration minimum longitudinal separation distance equals to zero h 12 min l 0 in our study rather than behave like one single and longer plate h 12 min l 1 2 in peng et al 2018b and the reversed kármán vortex street is presented in the wake flow with those two main collective modes of two parallel flexible plates obtained one more plate is added in order to find the hydrodynamic behaviors of three parallel flexible plates with those two different lateral spacings d 0 9 and d 0 55 in the following section 5 2 hydrodynamic schooling of three parallel flexible plates hydrodynamic aggregation of three self propelled flexible plates the lower positioned plate 1 the middle positioned plate 2 and the upper positioned plate 3 in side by side configuration is studied 5 2 1 d 0 9 case three velocity differences u ij t u i t u j t are presented in fig 10 a and b as well as the corresponding longitudinal separation distances h ij t x i s 0 t x j s 0 t i j 1 2 3 with i j they all evolve gradually to periodic states after t t 5 history curves of velocity differences fluctuate around zero with different amplitudes the comparison of figs 10 a and fig 6 a shows that the values of velocity differences in three flexible plates cases are larger than those in two flexible plates cases fig 10 b illustrates that h 12 t is smaller than zero h 23 t is larger than zero and h 13 t oscillates with peak value larger than zero and valley value smaller than zero it indicates that plate 2 moves forward following plates 1 and 3 with a staggered configuration and plates 1 and 3 take up an al mode in the horizontal direction compared to the values of separation distances in fig 6 b the longitudinal distances between the leading edges of three flexible plates are larger than those of two flexible plates vortices contour of three self propelled flexible plates at four typical instants t t 0 4 1 4 1 2 and 3 4 is illustrated in fig 11 as well as the relative positions of those plates fig 11 a d show that the upper positioned plate 3 moves ahead of the lower positioned plate 1 from t t 0 to t t 1 4 and then be caught up by plate 1 from t t 1 2 to t t 3 4 corresponding to the al mode the middle positioned plate 2 falls behind in the sf mode it can be seen that the lower positioned plate 1 and the upper positioned plate 3 present the same hydrodynamic aggregation mode as plates 1 and 2 do in the two parallel plates case seen in section 5 1 1 different from the emergence of the reversed kármán vortex street in the two parallel plates cases as shown in fig 7 a d the vortices contour in the three parallel plates case as seen in fig 11 a d is more complicated although the same two shear layers generate on the lower and upper surfaces of each plate during one forced heaving motion cycle the mixing process of those detached shear layers in the three parallel plates case is different the shear layer is named after its plate on which it forms and positive denoted by red colour and negative denoted by blue colour values are also separated fig 11 a b shows that negative shear layers 2 and 3 mix with leaving negative shear layer 1 alone and fig 11 c d illustrates that positive shear layers 1 and 2 mix with leaving positive 3 alone for corresponding flow fields in one complete period please refer to the supplementary movie 3 for d 0 9 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 3 3 movie 3 pressure contours of three parallel plates are presented in fig 12 the discussion of pressure distributions on the lower and upper positioned plates 1 and 3 refers to the corresponding content in section 5 1 1 because they present the same hydrodynamic aggregation mode al mode in d 0 9 case as plates 1 and 2 do in the two parallel plates case the mechanism by which the middle positioned plate 2 follows the upper positioned plate 3 and lower positioned plate 1 in the sf mode is explained as follows fig 12 a c show that the middle positioned plate 2 is influenced by the flow mediated interaction from both the lower and upper positioned plates 1 and 3 so the pressure difference on the lower and upper surfaces of plate 2 is the lowest among these three parallel plates and plate 2 experiences the lowest drag f x 0 at t t 0 4 and t t 1 2 as shown in fig 13 a fig 12 b shows that the stronger flow mediated interaction happens in the region between plate 2 and plate 3 than the area between plate 2 and plate 1 which leads to that pressure difference on plate 3 is smaller than plate 2 so the larger thrust formed as seen in fig 13 a drive plate 2 to chase up plate 3 at around t t 1 4 the similar flow mediated interaction emerges in fig 12 d in which pressure difference on plate 1 is smaller than plate 2 so the larger thrust as shown in fig 13 a drives plate 2 to chase up plate 1 at around t t 3 4 it can also be seen from fig 12 b d that the largest pressure differences are on plate 1 and plate 3 respectively the largest thrust as seen in fig 13 a generated helps plates 1 and 3 to take up the leading position 5 2 2 d 0 55 case as presented in fig 10 d h 12 t fluctuates around zero and both h 13 t and h 23 t are larger than zero it indicates that plates 1 and 2 move forward in an al mode and follow plate 3 in an sf mode fig 11 e h also display that the lower positioned plate 1 moves forward following the middle positioned plate 2 from t t 0 to t t 1 4 after which plate 1 surpasses plate 2 corresponding to the al mode the upper positioned plate 3 always takes the leading position with plates 1 and 2 following behind in the sf mode it can be seen that the lower positioned plate 1 and the upper positioned plate 3 also present the same hydrodynamic aggregation mode as plates 1 and 2 do in the two parallel plates case seen in section 5 1 2 the sf modes are formed in d 0 55 case different from the emergence of the reversed kármán vortex street in the two parallel plates cases as shown in fig 7 e h the vortices contour in the three parallel plates case as seen in fig 11 e h is also more complicated two kinds of mixing process of detached shear layers occur the first mixing type is shown in fig 11 g and h that the positive shear layers 1 2 and 3 mix together the second mixing type is seen in fig 11 h the detached negative shear layer 3 passes the upper surface of plate 2 at t t 3 4 and falls far behind the mixed negative shear layers 1 and 2 from t t 1 0 4 to t t 1 1 2 as shown in fig 11 e f g for corresponding flow fields in one complete period please refer to the supplementary movie 4 for d 0 55 case supplementary video related to this article can be found at https doi org 10 1016 j oceaneng 2021 108703 the following is the supplementary data related to this article movie 4 4 movie 4 the discussion of pressure distributions on the lower and upper positioned plates 1 and 3 refers to the corresponding content in section 5 1 2 because they present the same hydrodynamic aggregation mode sf mode in d 0 55 case as plates 1 and 2 do in the two parallel plates case as indicated in the three parallel plates case with d 0 9 the flow mediated interaction from both the lower and upper positioned plates 1 and 3 would decrease the pressure difference on the lower and upper surfaces of plate 2 and then its corresponding maximum thrust is the lowest among those three flexible plates under this simple analysis it seems that plate 2 would fall behind however fig 13 b shows that the maximum thrust on the plate 2 at about t t 3 4 is similar to the maximum thrust on plate 1 at t t 1 4 the complicated flow mediated interaction is the cause it can be seen from fig 11 h that the detached shear layer 3 passes the upper surface of plate 2 behind which an extremely high pressure distribution is formed as seen in fig 12 h the generated large thrust drives the plate 2 surpass plate 1 from t t 0 4 to 1 4 this explains why plate 2 does not always fall behind as it does in d 0 9 case and plates 1 and 2 move forward in the al mode 5 3 plate performance three parameters propulsive speed input power and propulsive efficiency are extensively used to quantify the schooling performance of each plate zhu et al 2014 peng et al 2018a 2018b the mean propulsive speed u i i 1 2 3 is defined as the average forward speed of the leading edge of flexible plates 1 2 or 3 i e 19 u i 1 t t t t x i 0 t t d t the average input power p i is required to produce both the flapping and forward movements i e 20 p i 1 t t t t 0 l f i s t x i s t t d s d t the ratio of the kinetic energy and the input power during a heaving motion cycle is the propulsive efficiency η i i e 21 η i 1 2 ρ l l u i 2 p i t table 1 presents the propulsive properties of each plate in different cases the input power is normalized by p ref ρ f u 3 refl the data of an isolated plate zhu et al 2014 are also given for comparison it can be seen that multiple self propelled flexible plates in side by side configuration move forward with lower velocities and efficiencies than an isolated plate this conclusion explains why parallel swimmers are rare in nature expect for the racing swimmers in the pool when three parallel flexible plates undergo the identical heaving motion the preferred v configuration in nature does not emerge the middle positioned plate 2 lags behind and consumes more input power to achieve the same forward velocity as the lower and upper positioned plates this gives a hint from the opposite angle that the role of leader in v formations is always taken by the strongest one of the group besides three flexible plates have higher propulsive speed than two flexible plates under the nearly same or smaller input power which puts forward a speculation that energy benefits are obtained if more individuals participate in hydrodynamic aggregation even in this undesired parallel configuration more flexible plates are needed to verify this speculation which is our future work 6 conclusions the present contribution is concern with the modification of a previously proposed loosely coupled partitioned algorithm zhang et al 2020 for the fsi problem of hydrodynamic aggregation of parallel self propelled flexible plates the commercial cfd solver fluent version 13 0 1 is extended with a dedicated user defined function udf in which structure field is approximated by solving the momentum equation and bending vibration equation of euler bernoulli beam as well as the inextensible condition of flexible plates is complemented hydrodynamic schooling of two self propelled flexible plates in tandem configuration is simulated by the modified loosely coupled partitioned algorithm comparison of the time history of streamwise velocity and longitudinal separation distance to the solutions by the extensively used ib method verifies the accuracy of this algorithm and then this algorithm is adopted to study the hydrodynamic aggregation of multiple two or three self propelled flexible plates in side by side configuration two typical collective modes are formed spontaneously in two self propelled flexible plates with different lateral spacings d i e the al mode in d 0 9 case and sf mode in d 0 55 case in three parallel plates cases the lower and upper positioned plates present the same hydrodynamic aggregation modes the al and sf modes as in two parallel plates cases and the middle positioned plate lags behind in the sf configuration the flow details vortices and pressure distribution are analyzed in order to understand the mechanism by which different hydrodynamic schooling modes are formed it is found that the low pressure region forms where the separation of shear layers occurs and the flow mediate interaction between plates leads to the different pressure distributions on the plates those two factors co determine the hydrodynamic schooling of parallel self propelled plates finally the propulsive performance of parallel plates is discussed compared to the isolated plate self propelled flexible plates in side by side configuration present lower propulsive speeds and efficiencies this explains why parallel swimmers are rarely seen in nature the preferred v formation in nature is not obtained in three parallel self propelled plates and the middle positioned plate should consume more energy in order to be the leading goose besides three self propelled plates have higher propulsive speeds and efficiencies than two self propelled plates it puts forward a speculation that energy benefits are achieved in collective behavior if more individuals participate although only two or three parallel flexible plates with two different lateral spacings are investigated this study may still shed some light on the cognition of the collective behaviors in natural system the hydrodynamic aggregation of swimmers in nature is more complicated due to the precisely controlled amount lateral spacings and different self propelled motions of individuals more flexible plates of different properties such as different length bending stiffness undergoing heaving motions with different amplitudes and lateral spacings are our future work in order to find the energy beneficial collective mode over the solitary swimming mode credit authorship contribution statement chizhong wang visualization investigation jianglong sun writing review editing de xie writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the present work is supported by the major project for special technology innovation of hubei province grant no 2019aaa041 the national natural science foundation of china grant no 51679097 and the china postdoctoral science foundation grant no 2019m652650 
21031,a three dimensional fully nonlinear time domain method is introduced to simulate ship advancing in regular and irregular waves with forward speed the mixed eulerian lagrangian mel method and boundary element method are adopted to solve the boundary value problem spring analogy method is utilized to guarantee the optimization mesh of the transient free surface and wetted hull body a local coordinate system is introduced and the fully nonlinear disturbed wave is separated from the total wave auxiliary functions are deduced to decouple the strongly nonlinear hydrodynamic forces and ship motion then the motion and velocity potential can be updated with the fourth order runge kutta method a 13500 teu container ship is chosen to verify the numerical codes the numerical results in regular waves and irregular waves are both in good agreement with experimental data the instantaneous pressure distribution around wetted body surface and wave elevation on the free surface of dangerous moments are presented and the strongly nonlinear states in the harsh irregular waves are analyzed keywords wave body interaction fully nonlinear boundary conditions mel method auxiliary functions method irregular waves 1 introduction in real sea conditions large amplitude waves may occur due to the wave superposition of several sinusoidal waves even though the significant wave height is small thus the states of ship motion and hydrodynamic forces in such irregular waves usually be much more severe and complicated than those in regular waves the extreme waves usually occur suddenly which leads to severe impact on the ship in quite short time and then the pressure around the hull changes rapidly capturing the instantaneous stress state and predicting the motion and hydrodynamic forces of these dangerous moments are of essential importance to the safety design of the hull thus a fully nonlinear boundary element method which demonstrates the transient pressure distribution around the wetted body and wave elevation on the free surface in time domain is introduced to predict the vertical motion and bending moment of ship advancing in waves in the present paper the mixed eulerian lagrangian method proposed by longuet higgins and cokelet 1976 is utilized in which the boundary values are calculated in eulerian frame and then the boundary conditions are upadated in lagrangian frame four node isoparametric element method are utilized to solve the boundary value problem the mel method and boundary element method bem with different orders have been applied to solve various hydrodynamic problems successfully for years like water entry sun and wu 2013a b water exit ni and wu 2017 wu et al 2018 wave body interaction koo and kim 2007 yan and ma 2007 abbasnia and guedes soares 2018a and ship wave problems abbasnia and guedes soares 2018b 2019 an auxiliary functions method deduced by wu et al 2004 is introduced to decouple the acceleration and hydrodynamic forces of the hull the time derivative of velocity potential φ t is an essential term when calculating the hydrodynamic forces and can directly affect the numerical accuracy among the numerical techniques acceleration potential method is generally recommended for strongly nonlinear interaction problem in which φ t satisfies laplace equation and can be solved by boudary conditions koo and kim 2004 lee et al 2013 the present auxiliary function method is essentially the same with the acceleration potential method in which φ t is decomposed into harmonic auxiliary functions and the problem is settled by solving auxiliary functions the main advantage is that auxiliary functions are mutally independent and can be solved through parallel computation thus the simulation efficiency is improved this method is verified to be effetive in solving the body wave interaction wang et al 2017 sun et al 2019 in comparison with previous linear and partially nonlinear method the free surface conditions of fully nonlinear method are satisfied on the transient free surface instead of average free surface and the hydrodynamic forces are calculated instantaneously by the pressure around wetted hull surface the method can reflect the real state of a ship advancing in waves there have been some researchers attempting to apply fully nonlinear method to ships mola et al 2014 have presented a model for ship hydrodynamics simulation employing fully nonlinear free surface boundary conditions and selected the kvlcc2 and the kcs hulls as test cases but only the wave profiles on the hulls at selected forward speeds in calm water are presented abbasnia and guedes soares 2018b have utilized the high order boundary element method hobem to simulate a wigley ship advancing in still water under fully nonlinear boundary conditions the wave elevation results coincide with the published numerical results and experimental data then they compared the wave elevation and wave making resistance of the wigley ship in different froude numbers using both linear and fully nonlinear method the wave making resistance curve of fully nonlinear method seem to coincide better with experimental data than that of linear method and the hybrid model abbasnia and guedes soares 2019 the above research objectives are either floating bodies with simple geometric shape or mathematical ship form in calm water the hydrodynamic problems of the interaction between the actual ship and irregular waves have been solved mainly by linear and body nonlinear method in recent years rajendran et al 2016a adopted both partially and fully body nonlinear methods to simulate a cruise ship in irregular waves generally the partially body nonlinear method can highly estimate the sagging bending moments for the large amplitude waves the fully body nonlinear method performs better in higher sea state but slightly overestimates the hogging moments of small amplitude waves vásquez et al 2016 carried out model tests of a bulk carrier and a roll on roll off ship in irregular waves and compared the results with numerical calculation by a partially nonlinear method it s concluded that the geometry properties can have notable influence on the bending moments in extreme waves besides the partially nonlinear method can t predict the sagging moments with strong nonlinearity accurately which is also proposed by rajendran et al 2016b clauss and klein 2016 found the large bow flares and freeboard heights can contribute significantly to the vertical bending moment vbm especially the sagging mement of ship in extreme waves it s quite a big challenge to apply fully nonlinear method to the actual ship advancing in irregular waves due to the complicated geometric hull form large amplitude incident wave as well as the highly disturbed wave 2 mathematical formulation and numerical method 2 1 initial boundary value problem as shown in fig 1 three right handed cartesian coordinate systems are introduced to describe the interaction between wave and ship where o x y z is earth fixed with o x y on the initial undisturbed wave surface and o z axis pointing upwards o x y z is moving with the forward speed u of the ship and g x y z is body fixed with its origin located at the gravity center of the ship at the initial moment o x y z and o x y z coincide with each other and parallel to g x y z considering only vertical heave and pitch motion the conversion relationship of coordinates in o x y z and g x y z can be expressed as eq 1 1 x y z x g y g z g 0 0 η 3 cos η 5 0 sin η 5 0 1 0 sin η 5 0 cos η 5 x y z in which x g y g z g is the initial coordinates of the gravity center g in o x y z system η 3 η 5 are the translational and rotational displacements of the ship in o x y z and represent heave and pitch motion the fluid is assumed inviscid and impressible the flow is irrotational then the velocity potential φ satisfies laplace equation in the domain 2 2 φ 0 on the body surface s 0 according to the impermeable condition the following equation holds 3 φ n u η 3 η 5 r b n in which u u 0 0 η 3 0 0 η 3 η 5 0 η 5 0 r b x x g y y g z z g η 3 r b n n 4 n 5 n 6 where the unite normal vector n n 1 n 2 n 3 is oriented outward of the fluid on the free surface boundary s f the eulerian kinematic and dynamic free surface conditions in o x y z coordinate system can be written as li 2016 4 ζ t φ z φ x u ζ x φ y ζ y 5 φ t φ φ 2 g z φ x u where ζ is the total wave elevation t is the partial derivative with respect to time in view of the ship of a constant speed u on the far field surface s there exists little disturbed wave therefore the potential tends to that of the incident wave φ i 6 φ n φ i n at the initial moment the free surface is undisturbed so the following equations hold on s f 7 φ φ i ζ ζ i where ζ i is the wave elevation of the incident waves 2 2 separation of irregular incident waves and fully nonlinear disturbed waves the long crested irregular waves in head sea can be generated with linear superposition principle dai et al 2007 8 ζ i n 1 n a n cos k n x ω e n t ψ n ω e n ω e k n u where n is the total number of the sinusoidal waves k n ω n ω e n ψ n present the wave number the natural frequency the encountering frequency and the phase of n t h wave respectively correspondingly the velocity potential can be expressed as 9 φ i n 1 n a n g ω n e k n z sin k n x ω e n t ψ n a wave separation method is introduced to decouple the incident wave and the fully nonlinear disturbed wave assuming that the total wave can be separated into the incident part and the disturbed part the following equation holds on 10 ζ ζ i ζ d φ φ i φ d where the subscript d represent the terms of disturbed wave the disturbed velocity potential also satisfies the laplace equation which can be obtained by solving the boundary integral equations according to the impenetrable condition in eq 3 φ d n can be expressed as eq 11 11 φ d n u η 3 η 5 r b n φ i n u η 3 η 5 r b φ i n on the free surface s f the ship advancing in irregular waves may cause severe disturbed wave with substantial steepness ζ x and ζ y near the body which can easily accumulate the numerical error and break down the calculation process thus a new local coordinate system o ˆ x ˆ y ˆ z ˆ is introduced in which o ˆ x ˆ and o ˆ y ˆ axes lie on the free surface along the tangential directions of the mesh o ˆ z ˆ axis is normal to o ˆ x ˆ y ˆ and oriented outward the free surface the sketch of the local free surface is presented in fig 2 only for the nodes on waterline the o ˆ z ˆ directions are along the radial directions of the mesh on the body surface combined with the mel method beck 1994 the nodes are restricted to move along the normal direction in the local coordinate system the coordinates of nodes in o ˆ x ˆ y ˆ z ˆ can be converted by those in o x y z as eq 12 12 x ˆ y ˆ z ˆ l x ˆ x l x ˆ y l x ˆ z l y ˆ x l y ˆ y l y ˆ z l z ˆ x l z ˆ y l z ˆ z x y z in which l x ˆ x l x ˆ y l x ˆ z l y ˆ x l y ˆ y l y ˆ z and l z ˆ x l z ˆ y l z ˆ z are the unite vectors of axis o ˆ x ˆ o ˆ y ˆ and o ˆ z ˆ in the o x y z respectively the kinematic free surface condition still applies in the local coordinate system so eq 4 can be converted into 13 ζ ˆ t φ z ˆ u l z ˆ x ζ ˆ x ˆ φ z ˆ u l x ˆ x ζ ˆ y ˆ φ y ˆ u l y ˆ x x ˆ t 0 y ˆ t 0 then x ˆ t y ˆ t and ζ ˆ t in o ˆ x ˆ y ˆ z ˆ can be transferred to x t y t and ζ t in o x y z system by using eq 12 and ζ d t can be obtained by eq 14 14 ζ d t ζ t ζ i t in which 15 ζ i t φ i z ζ i x φ i x u 0 x t ζ i y φ i y y t the disturbed velocity potential can be expressed by the mel method 16 δ φ d δ t φ d t φ d x x t φ d y y t φ d z ζ t where δ φ d δ t is a material derivative and means the variance of φ d with respect to t including the space change due to x t y t and ζ t the disturbed potential can be updated by 17 δ φ d δ t g z d 0 5 φ d φ d φ d x u 0 φ d x x t φ d y y t φ d z ζ t 2 3 discretization of boundary integration equation through green s identity the governing equation in eq 2 can be converted into the following integral equation 18 a p φ d p g p q φ d q n q φ d q g p q n q d s q in which a p is the solid angle at point p eatock taylor et al 2008 green function g 1 r p q where r p q is the distance between points q and p quadrilateral panels are chosen to discretize the boundary surface and 4 node isoparametric element method are adopted for each element we have 19 r x i y j z k k 1 4 h k μ ν r k 20 φ d k 1 4 h k μ ν φ d k in which μ and v are the local coordinates valuing between 0 and 1 h k represents the shape functions and can be expressed as eq 21 21 h 1 1 4 1 μ 1 ν h 2 1 4 1 μ 1 ν h 3 1 4 1 μ 1 ν h 4 1 4 1 μ 1 ν substitute eq 20 and eq 21 into eq 18 then we have 22 a p φ d p n 1 n e 1 1 1 1 1 r p q k 1 4 h k μ ν φ d n q k q j n μ ν d μ d ν n 1 n e 1 1 1 1 n q 1 r p q k 1 4 h k μ ν φ d k q j n μ ν d μ d ν where n e is the total number of elements on the boundaries j n μ ν is the jacobian transformation write eq 22 into matrix form we have 23 h n d n d φ d n d 1 g n d n d φ d n n d 1 in which n d is number of nodes since the terms φ d on the free surface and φ d n on the solid surface are already known adjust the equation to put these terms to the right side and the other unknown terms to the left side then the φ d on the solid surface and φ d n on free surface can be obtained by solving the matrix equations 2 4 decoupling of ship motion and hydrodynamic forces according to the bernoulli equation hydrodynamic pressure p can be expressed as 24 p p φ t 1 2 φ φ g z where g is the acceleration of gravity then integrate the above pressure all over the wetted surface hydrodynamic forces and moments of the ship can be obtained 25 f i s 0 p n i d s i 3 5 according to newton s second law 26 m η f f e where m m 0 0 i 22 is the mass matrix m is the total mass of the ship and i 22 is the vertical moment of inertia f represents the matrix of vertical hydrodynamic force and moment f e is the matrix of vertical external force and moment it s evident that once the term φ t is known the hydrodynamic forces and acceleration can be obtained an auxiliary functions method is adopted here the term φ t is harmonic and is expressed by auxiliary functions which can be obtained by solving the boundary value problem the body surface boundary condition proposed by wu 1998 is altered with forward speed along with heave and pitch motion 27 φ t n u η 3 η 5 r b n u η 3 φ n η 5 n r b u η 3 φ η 3 n 3 η 5 n 5 u η 3 φ n η 5 n r b u η 3 φ the auxiliary functions χ 3 χ 5 and χ 7 are introduced and φ t can be written as 28 φ t η 3 χ 3 η 5 χ 5 u η 3 φ η 5 r b u η 3 φ χ 7 the auxiliary functions satisfy eq 29 on the body surface s 0 29 χ 3 n n 3 χ 5 n n 5 χ 7 n 0 substitute eq 28 into the bernoulli equation the following equation can be deduced on the free surface sf 30 χ 3 0 χ 5 0 χ 7 1 2 φ 2 g z u η 3 φ η 5 r b u η 3 φ as regard far away control surface 31 φ t n φ i t n φ i t n substitute eq 28 into eq 31 we have 32 χ 3 n 0 χ 5 n 0 χ 7 n φ i t n u η 3 φ n η 5 r b u η 3 φ n χ 3 χ 5 and χ 7 can be solved with eqs 29 30 and 32 substitute the auxiliary functions into the bernoulli equation we have 33 p ρ η 3 χ 3 η 5 χ 5 u η 3 φ η 5 r b u η 3 φ χ 7 1 2 φ φ g z substitute eq 33 into eq 25 then 34 f i s 0 ρ χ 3 n i d s η 3 s 0 ρ χ 5 n i d s η 5 f i i 3 5 35 f i s 0 ρ u η 3 φ η 5 r b u η 3 φ χ 7 φ φ 2 g z n i d s the first two terms in eq 34 indicate the inertial forces of the added mass and they can be expressed as matrix form m a η 35 in which 36 m a s b ρ χ 3 n 3 d s s b ρ χ 5 n 3 d s s b ρ χ 3 n 5 d s s b ρ χ 5 n 5 d s substitute eq 36 into eq 26 we have 37 m m a η 35 f 35 where f 35 f 3 f 5 therefore the acceleration of vertical motion can be acquired and the motion and hydrodynamic forces are decoupled then the velocity and displacement can be updated with the classical fourth order runge kutta 4rk method 2 5 technique for mesh optimization once the mesh is ruined the fully nonlinear time marching process of simulation will break down it s quite important to adopt effective technique to guarantee the mesh during simulation the original mesh on the body surface is generated by cubic spline method and the original mesh on the free surface increases proportionally by 1 04 times the dense mesh near the hull can guarantee the accuracy of the calculation and the total mesh number is not so large to ensure good efficiency poisson equations are utilized to make the mesh on the free surface orthogonal to the waterline which can improve the mesh quality significantly especially for the mesh near the bow and stern regions thomas and middlecoff 1980 a spring analogy method is introduced to optimize the mesh accordingly ma and yan 2009 zhou et al 2015 the principle of this method is to consider the segment between two adjacent nodes as spring where the elastic force can adjust the displacement the total force of the node i can be described as eq 38 38 f i j 1 n i k i j δ r j δ r i where node j represents the adjacent node of node i n i is the number of adjacent nodes of node i and k i j is the stiffness coefficient between node i and j when the node i moves to a new position the total force is zero and then 39 δ r i k 1 j 1 n i k i j δ r j k j 1 n i k k i j the new position can be written as 40 r i r i o l d δ r i besides a five point smoothing method is applied to readjust the coordinates and the velocity potential of some deformed elements in the time marching process if there are m nodes taking the velocity potential as an example the value of one node can be interpolated by itself and adjacent four nodes 41 φ 1 1 70 69 φ 1 4 φ 2 6 φ 3 4 φ 4 φ 5 42 φ 2 1 35 2 φ 1 27 φ 2 12 φ 3 8 φ 4 2 φ 5 43 φ i 1 70 3 φ i 2 12 φ i 1 17 φ i 12 φ i 1 3 φ i 2 44 φ m 1 1 35 2 φ m 4 8 φ m 3 12 φ m 2 27 φ m 1 2 φ m 45 φ m 1 70 φ m 4 4 φ m 3 6 φ m 2 4 φ m 1 69 φ m where φ i and φ i are the values before and after smoothing respectively it should be noted that the smoothing method should not be applied frequently and is used every ten steps in the paper 2 6 flow chart of numerical simulation the flow chart of the numerical simulation is listed in fig 3 3 numerical application 3 1 verification example a 13500 teu container ship is chosen to verify the numerical method the main particulars of this container ship are shown in table 1 and the plan lines are presented in fig 4 3 2 convergence study a convergence study is carried out before the numerical calculation the whole boundaries are meshed in circumferential and radiational directions as shown in fig 5 the radial nodes on the half cross section and free surface are marked as n 1 and n 2 the circumferential nodes on the free surface is n 0 and the radius of the domain is r in the paper n 1 is set to 11 from experience and n 0 is decided by the aspect ratio α the case of f n 0 1 h 7 m λ l 1 0 is selected as the verification condition figs 6 8 show the convergency study with domain radius radial nodes and circumferential nodes on the free surface respectively the time histories of heave and pitch motion all coincide while the curve of vbm with the smallest radial nodes n 2 5 n 1 separate from the other curves with a slight difference as illustrated in fig 7 therefore the present numerical method is convergent with domain radius and mesh if the mesh density on both radial and circumferential directions is guaranteed convergence study about the time steps is also carried out as shown in fig 9 on the basis of convergence study the numerical cases in the following parts adopt r 4 l n 2 6 n 1 α 2 0 in addition it s meaningful to give precise run time of the three dimensional fully nonlinear numerical method as a reference the numerical model is achieved by fortran codes and open mp parallel program is utilized locally to calculate the coefficient matrix and of boundary integration equation in eq 23 table 2 presents the detailed run time of cases with different grids in which are the run time of one time step without and with openmp parallel codes respectively and respectively mean the time consumed on calculating the coefficient matrix in a single runge kutta step without and with parallel program there are four runge kutta steps in each time step generally the run time is positively related to the total nodes the parallel codes can improve calculation efficiency of the openmp applied part dramatically but openmp program is used locally the efficiency can be only improved by about 30 for the present program by intel core i7 8700 cpu 3 2 ghz 16 gb ram 3 3 comparison and analysis of regular waves the numerical method is tested and validated in small regular waves firstly considering the large scale of the 13500teu container ship a series of cases with wave height corresponding to are carried out the numerical calculation results are compared with the experimental data from china classification society ccs the time histories of heave pitch and vbm of numerical simulation are presented in fig 10 where wave height and the ratio of wavelength to the length between perpendiculars fig 10 c shows the hogging moment and sagging moment the mean bending moment is the average of the hogging value and sagging value and the amplitude is the absolute difference between the mean value and the hogging or sagging value there are few nonlinear components in the heave and pitch motion while the waveforms of vbm show nonlinearity evidently and the separation between the hogging and sagging bending moment is observed the absolute value of sagging bending moment is 6825 mn m which is nearly 36 larger than the hogging bending moment 5023 mn m to figure out the asymmetry of the hogging values and sagging values steady results of are calculated and presented in fig 10 it s verified that navigation effects can arouse the sinkage and trim in still water fonseca and guedes soares 2004 in figs 10 a and 6 b the values of mean motion are less than those of sinkage and trim however advancing in waves can increase the asymetry of vbm as shown in fig 10 c thus it s inferred the asymetry of sagging and hogging motion and loads are mainly caused by the nonlinearity of body nonlinearity the navigation effects and wave body interaction fig 11 shows the comparison of experimental and numerical vbm results at midship with different the amplitudes of numerical results are generally in compliance with experimental data the data of experiment and numerical simulation both reach the maximum values when and the experimental peak is about 5 2 higher than that of the numerical simulation there are some approximations and influence factors in scaled ship model tests such as the beam assumption the similarity of mass distribution and rigidity scale effect wall effect and so on while in numerical calculation the real ship instead of the scaled model is used as simulation target under these circumstances the tendency and maximum value of numerical simulation can be considered to coincide quite well with those of experimental data and thus the presented method is verified the heave and pitch motion of numerical simulation with different are presented in fig 12 when is less than 1 2 the pitch motion increases with the wavelength and decrease slowly with wavelength when is larger than 1 2 generally the heave motion increases with the wavelength and there is a jump from 0 68 m to 1 86 m between and the wave elevation and pressure distribution at the moments when heave motion reaches the minimum and maximum values with and are presented in figs 13 and 14 the total wave elevation in sagging states are larger than those in hogging states in fig 13 and they are all much larger than the height of incident wave when wave trough propagates to the midship wave climbing along with the bow and stern is remarkable and the ship is in trim by bow when the wave crest is around the middle area the wave elevation near midship is the significant and the ship is in trim by stern generally the wave elevation on the free surface seem to be similar of the cases and while the pressure distribution can reflect the differences more specifically since the present method is fully nonlinear a case of 5th stokes wave fenton 1985 is presented and compared with the results of airy wave the wave height is chosen as 12 m with the maximum and minimum of stokes wave are 6 33 m and 5 67 m respectively as fig 15 shown the differences of heave and pitch motion between the two waves are obvious in which the amplitude of heave motion of stokes wave is 9 1 larger than that of airy wave and the ratio is about 4 7 for pitch motion 3 4 comparison and analysis of irregular waves the time histories of the incident wave heights of two irregular wave cases are picked from the experiment as shown in fig 16 a and b the froude number average cross zero period and significant wave height of two cases are presented in table 3 in case 1 the ship advances in a moderate sea state with low speed while both sea states and navigation speed are high in case 2 the wave amplitude the frequency and the phase of each sub wave for the irregular waves are obtained with the fast fourier transform fft thus the incident waves in numerical simulation can be superposed with eq 8 and the numerical procedure can be performed to simulate the ship navigating in a specific irregular wave as shown in figs 17 and 18 the variation and the magnitude of the numerical results conform well to that of the experiment for experimental data the maximum responses emerge between 60 and 80s and the largest bending moment reaches 4670 mn m for case1 for case 2 the largest two peaks of vbm occur at around and which is consistent with the time records of wave height comparing case 1 and 2 the maximal magnitute of vbm is over twice that of case 1 and the increase of vbm is much predominant than that of sigficant wave height the reason is that the navigation speed of case 2 is much larger than case 1 both the nagivation speed and significant wave height are of key importance to wave loads as presented in figs 19 and 20 the heave and pitch motion of numerical simulation peak at different time instants and the tendency of heave motion is more similar to that of the wave height in fig 16 for case 2 the maximum of heave motion can be quite severe which should be paid attention to analyze the wave elevation and stress states of ship at different instants typical moments of cases 1 and 2 are selected as shown in figs 17 and 18 respectively the moment and represent the instants when the vbm reaches the minimum value and maximums value and are chosen to compare the maximum and minimum of the dangerous period and the normal period in which the vbm at reaches the minimum of the picked period and vbm at is maximal the free surface elevation and pressure distribution of the moment in both cases are presented in for case 1 when wave trough creeps to the midship at the bow and stern are at the two local crests of the wave at this time the vbm at midship reaches a minus peak indicating that the middle area of the ship is in a sagging stress state that is quite different from the standard sagging in the regular wave case as shown in figs 13 c and 14 c for the regular waves the sagging stress state appears on the whole ship however the sagging is somewhat local between at in figs 21 a and 22 a the wave crest creeps to the midship and the bow rises slightly the maximal pressure at is about 20 kpa lower than that at at this time the midship is in a hogging stress state at a local area at and the pressure peaks are close to that at and but the vbm is much smaller suggesting that the maximum pressure is not a key factor for the determination of the vbm it can be found that the change of waterline is much gentle at and which may be the main influence factor for the vbm for case 2 the froude number and the wave height increase and the crossing zero period changes the wave elevation and pressure distribution of case 2 at the moments are shown in figs 23 and 24 the process of the ship entering and exiting water is simulated in the time domain at when the wave propagates to the bow region it climbs along the hull and water may impact the bow leading to severe heave motion and loads the variation of waterline is very dramatic and the midship is in a critical sagging stress state at the ship is nearly lifted from the water due to the wave force the fore part of the ship is in a sagging stress state the aft part is in a hogging stress state and heave motion reaches the maximum the draught along the whole ship is small but the maximum value of pressure is over 160 kpa which is greatly larger than the static pressure term in other words the dynamic pressure occupies a substantial proportion the wave elevation and pressure distribution at and are still much more significant than those in case 1 it can be noticed that the maximum pressure value in case 2 is about 40 kpa larger than that of case 1 but the amplitude of vbm is almost twice that of case 1 it s mainly caused by the differences of stress state and wave elevation overall the stress state is more complicated than that in the regular wave case usually two or more states can be found along with the ship at a time instant and it is hard to find a standard hogging or sagging stress state along with the whole ship sun et al 2015 beck 1994 ni et al 2015 ya and ma 2007 wang et al 2017 4 conclusion a fully nonlinear time domain method is presented in this paper to simulate ship advancing with forward speed in waves during the numerical simulation the instantaneous pressure distribution around wetted body surface and wave elevation on the free surface of dangerous moments are presented the strongly nonlinear stress states in harsh irregular waves are analyzed the results of a 13500 teu container ship advancing in regular waves and irregular waves are compared with the experimental data to verify the numerical method the present method is convergent with respect to computational domain mesh density on radial and circumferential directions as well as time steps the following conclusions can be drawn 1 there are few nonlinear components in heave and pitch motion in the regular wave cases while the wave forms of vbm show distinct nonlinearity generally the nonlinearity mainly appears as the asymmetry of hogging and sagging values which is caused by the navigating effect the body nonlinearity and the wave body interaction 2 the presented vbm results of 5th stokes waves are quite close to those of airy waves while the heave and pitch motion of the former are larger 3 from the comparison between the extreme values of the most dangerous period and a common period in harsh irregular waves it can be found that the vbm of the former can be over twice that of the latter besides the vbm can be easily affected by the pressure distribution even if the range of values varies a little sometimes it s challenging to find a standard hogging or sagging stress state along the whole ship for there may be two waves passing simultaneously sometimes the whole ship is lifted the draught along the hull is small but the dynamic pressure is tremendous which may lead to structure damage or even make the ship capsized the strongly nonlinear phenomena like slamming water entry and water exit are easily occurred in the extreme sea condition the fully nonlinear method in this paper captures the critical state and can help to predict motion and loads in harsh irregular waves credit authorship contribution statement ying tang software validation writing original draft writing review editing shi li sun methodology formal analysis writing review editing funding acquisition hui long ren resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51679045 and the fundamental research funds for the central universities 3072020cf0106 the experimental results are provided by china classification society ccs 
21031,a three dimensional fully nonlinear time domain method is introduced to simulate ship advancing in regular and irregular waves with forward speed the mixed eulerian lagrangian mel method and boundary element method are adopted to solve the boundary value problem spring analogy method is utilized to guarantee the optimization mesh of the transient free surface and wetted hull body a local coordinate system is introduced and the fully nonlinear disturbed wave is separated from the total wave auxiliary functions are deduced to decouple the strongly nonlinear hydrodynamic forces and ship motion then the motion and velocity potential can be updated with the fourth order runge kutta method a 13500 teu container ship is chosen to verify the numerical codes the numerical results in regular waves and irregular waves are both in good agreement with experimental data the instantaneous pressure distribution around wetted body surface and wave elevation on the free surface of dangerous moments are presented and the strongly nonlinear states in the harsh irregular waves are analyzed keywords wave body interaction fully nonlinear boundary conditions mel method auxiliary functions method irregular waves 1 introduction in real sea conditions large amplitude waves may occur due to the wave superposition of several sinusoidal waves even though the significant wave height is small thus the states of ship motion and hydrodynamic forces in such irregular waves usually be much more severe and complicated than those in regular waves the extreme waves usually occur suddenly which leads to severe impact on the ship in quite short time and then the pressure around the hull changes rapidly capturing the instantaneous stress state and predicting the motion and hydrodynamic forces of these dangerous moments are of essential importance to the safety design of the hull thus a fully nonlinear boundary element method which demonstrates the transient pressure distribution around the wetted body and wave elevation on the free surface in time domain is introduced to predict the vertical motion and bending moment of ship advancing in waves in the present paper the mixed eulerian lagrangian method proposed by longuet higgins and cokelet 1976 is utilized in which the boundary values are calculated in eulerian frame and then the boundary conditions are upadated in lagrangian frame four node isoparametric element method are utilized to solve the boundary value problem the mel method and boundary element method bem with different orders have been applied to solve various hydrodynamic problems successfully for years like water entry sun and wu 2013a b water exit ni and wu 2017 wu et al 2018 wave body interaction koo and kim 2007 yan and ma 2007 abbasnia and guedes soares 2018a and ship wave problems abbasnia and guedes soares 2018b 2019 an auxiliary functions method deduced by wu et al 2004 is introduced to decouple the acceleration and hydrodynamic forces of the hull the time derivative of velocity potential φ t is an essential term when calculating the hydrodynamic forces and can directly affect the numerical accuracy among the numerical techniques acceleration potential method is generally recommended for strongly nonlinear interaction problem in which φ t satisfies laplace equation and can be solved by boudary conditions koo and kim 2004 lee et al 2013 the present auxiliary function method is essentially the same with the acceleration potential method in which φ t is decomposed into harmonic auxiliary functions and the problem is settled by solving auxiliary functions the main advantage is that auxiliary functions are mutally independent and can be solved through parallel computation thus the simulation efficiency is improved this method is verified to be effetive in solving the body wave interaction wang et al 2017 sun et al 2019 in comparison with previous linear and partially nonlinear method the free surface conditions of fully nonlinear method are satisfied on the transient free surface instead of average free surface and the hydrodynamic forces are calculated instantaneously by the pressure around wetted hull surface the method can reflect the real state of a ship advancing in waves there have been some researchers attempting to apply fully nonlinear method to ships mola et al 2014 have presented a model for ship hydrodynamics simulation employing fully nonlinear free surface boundary conditions and selected the kvlcc2 and the kcs hulls as test cases but only the wave profiles on the hulls at selected forward speeds in calm water are presented abbasnia and guedes soares 2018b have utilized the high order boundary element method hobem to simulate a wigley ship advancing in still water under fully nonlinear boundary conditions the wave elevation results coincide with the published numerical results and experimental data then they compared the wave elevation and wave making resistance of the wigley ship in different froude numbers using both linear and fully nonlinear method the wave making resistance curve of fully nonlinear method seem to coincide better with experimental data than that of linear method and the hybrid model abbasnia and guedes soares 2019 the above research objectives are either floating bodies with simple geometric shape or mathematical ship form in calm water the hydrodynamic problems of the interaction between the actual ship and irregular waves have been solved mainly by linear and body nonlinear method in recent years rajendran et al 2016a adopted both partially and fully body nonlinear methods to simulate a cruise ship in irregular waves generally the partially body nonlinear method can highly estimate the sagging bending moments for the large amplitude waves the fully body nonlinear method performs better in higher sea state but slightly overestimates the hogging moments of small amplitude waves vásquez et al 2016 carried out model tests of a bulk carrier and a roll on roll off ship in irregular waves and compared the results with numerical calculation by a partially nonlinear method it s concluded that the geometry properties can have notable influence on the bending moments in extreme waves besides the partially nonlinear method can t predict the sagging moments with strong nonlinearity accurately which is also proposed by rajendran et al 2016b clauss and klein 2016 found the large bow flares and freeboard heights can contribute significantly to the vertical bending moment vbm especially the sagging mement of ship in extreme waves it s quite a big challenge to apply fully nonlinear method to the actual ship advancing in irregular waves due to the complicated geometric hull form large amplitude incident wave as well as the highly disturbed wave 2 mathematical formulation and numerical method 2 1 initial boundary value problem as shown in fig 1 three right handed cartesian coordinate systems are introduced to describe the interaction between wave and ship where o x y z is earth fixed with o x y on the initial undisturbed wave surface and o z axis pointing upwards o x y z is moving with the forward speed u of the ship and g x y z is body fixed with its origin located at the gravity center of the ship at the initial moment o x y z and o x y z coincide with each other and parallel to g x y z considering only vertical heave and pitch motion the conversion relationship of coordinates in o x y z and g x y z can be expressed as eq 1 1 x y z x g y g z g 0 0 η 3 cos η 5 0 sin η 5 0 1 0 sin η 5 0 cos η 5 x y z in which x g y g z g is the initial coordinates of the gravity center g in o x y z system η 3 η 5 are the translational and rotational displacements of the ship in o x y z and represent heave and pitch motion the fluid is assumed inviscid and impressible the flow is irrotational then the velocity potential φ satisfies laplace equation in the domain 2 2 φ 0 on the body surface s 0 according to the impermeable condition the following equation holds 3 φ n u η 3 η 5 r b n in which u u 0 0 η 3 0 0 η 3 η 5 0 η 5 0 r b x x g y y g z z g η 3 r b n n 4 n 5 n 6 where the unite normal vector n n 1 n 2 n 3 is oriented outward of the fluid on the free surface boundary s f the eulerian kinematic and dynamic free surface conditions in o x y z coordinate system can be written as li 2016 4 ζ t φ z φ x u ζ x φ y ζ y 5 φ t φ φ 2 g z φ x u where ζ is the total wave elevation t is the partial derivative with respect to time in view of the ship of a constant speed u on the far field surface s there exists little disturbed wave therefore the potential tends to that of the incident wave φ i 6 φ n φ i n at the initial moment the free surface is undisturbed so the following equations hold on s f 7 φ φ i ζ ζ i where ζ i is the wave elevation of the incident waves 2 2 separation of irregular incident waves and fully nonlinear disturbed waves the long crested irregular waves in head sea can be generated with linear superposition principle dai et al 2007 8 ζ i n 1 n a n cos k n x ω e n t ψ n ω e n ω e k n u where n is the total number of the sinusoidal waves k n ω n ω e n ψ n present the wave number the natural frequency the encountering frequency and the phase of n t h wave respectively correspondingly the velocity potential can be expressed as 9 φ i n 1 n a n g ω n e k n z sin k n x ω e n t ψ n a wave separation method is introduced to decouple the incident wave and the fully nonlinear disturbed wave assuming that the total wave can be separated into the incident part and the disturbed part the following equation holds on 10 ζ ζ i ζ d φ φ i φ d where the subscript d represent the terms of disturbed wave the disturbed velocity potential also satisfies the laplace equation which can be obtained by solving the boundary integral equations according to the impenetrable condition in eq 3 φ d n can be expressed as eq 11 11 φ d n u η 3 η 5 r b n φ i n u η 3 η 5 r b φ i n on the free surface s f the ship advancing in irregular waves may cause severe disturbed wave with substantial steepness ζ x and ζ y near the body which can easily accumulate the numerical error and break down the calculation process thus a new local coordinate system o ˆ x ˆ y ˆ z ˆ is introduced in which o ˆ x ˆ and o ˆ y ˆ axes lie on the free surface along the tangential directions of the mesh o ˆ z ˆ axis is normal to o ˆ x ˆ y ˆ and oriented outward the free surface the sketch of the local free surface is presented in fig 2 only for the nodes on waterline the o ˆ z ˆ directions are along the radial directions of the mesh on the body surface combined with the mel method beck 1994 the nodes are restricted to move along the normal direction in the local coordinate system the coordinates of nodes in o ˆ x ˆ y ˆ z ˆ can be converted by those in o x y z as eq 12 12 x ˆ y ˆ z ˆ l x ˆ x l x ˆ y l x ˆ z l y ˆ x l y ˆ y l y ˆ z l z ˆ x l z ˆ y l z ˆ z x y z in which l x ˆ x l x ˆ y l x ˆ z l y ˆ x l y ˆ y l y ˆ z and l z ˆ x l z ˆ y l z ˆ z are the unite vectors of axis o ˆ x ˆ o ˆ y ˆ and o ˆ z ˆ in the o x y z respectively the kinematic free surface condition still applies in the local coordinate system so eq 4 can be converted into 13 ζ ˆ t φ z ˆ u l z ˆ x ζ ˆ x ˆ φ z ˆ u l x ˆ x ζ ˆ y ˆ φ y ˆ u l y ˆ x x ˆ t 0 y ˆ t 0 then x ˆ t y ˆ t and ζ ˆ t in o ˆ x ˆ y ˆ z ˆ can be transferred to x t y t and ζ t in o x y z system by using eq 12 and ζ d t can be obtained by eq 14 14 ζ d t ζ t ζ i t in which 15 ζ i t φ i z ζ i x φ i x u 0 x t ζ i y φ i y y t the disturbed velocity potential can be expressed by the mel method 16 δ φ d δ t φ d t φ d x x t φ d y y t φ d z ζ t where δ φ d δ t is a material derivative and means the variance of φ d with respect to t including the space change due to x t y t and ζ t the disturbed potential can be updated by 17 δ φ d δ t g z d 0 5 φ d φ d φ d x u 0 φ d x x t φ d y y t φ d z ζ t 2 3 discretization of boundary integration equation through green s identity the governing equation in eq 2 can be converted into the following integral equation 18 a p φ d p g p q φ d q n q φ d q g p q n q d s q in which a p is the solid angle at point p eatock taylor et al 2008 green function g 1 r p q where r p q is the distance between points q and p quadrilateral panels are chosen to discretize the boundary surface and 4 node isoparametric element method are adopted for each element we have 19 r x i y j z k k 1 4 h k μ ν r k 20 φ d k 1 4 h k μ ν φ d k in which μ and v are the local coordinates valuing between 0 and 1 h k represents the shape functions and can be expressed as eq 21 21 h 1 1 4 1 μ 1 ν h 2 1 4 1 μ 1 ν h 3 1 4 1 μ 1 ν h 4 1 4 1 μ 1 ν substitute eq 20 and eq 21 into eq 18 then we have 22 a p φ d p n 1 n e 1 1 1 1 1 r p q k 1 4 h k μ ν φ d n q k q j n μ ν d μ d ν n 1 n e 1 1 1 1 n q 1 r p q k 1 4 h k μ ν φ d k q j n μ ν d μ d ν where n e is the total number of elements on the boundaries j n μ ν is the jacobian transformation write eq 22 into matrix form we have 23 h n d n d φ d n d 1 g n d n d φ d n n d 1 in which n d is number of nodes since the terms φ d on the free surface and φ d n on the solid surface are already known adjust the equation to put these terms to the right side and the other unknown terms to the left side then the φ d on the solid surface and φ d n on free surface can be obtained by solving the matrix equations 2 4 decoupling of ship motion and hydrodynamic forces according to the bernoulli equation hydrodynamic pressure p can be expressed as 24 p p φ t 1 2 φ φ g z where g is the acceleration of gravity then integrate the above pressure all over the wetted surface hydrodynamic forces and moments of the ship can be obtained 25 f i s 0 p n i d s i 3 5 according to newton s second law 26 m η f f e where m m 0 0 i 22 is the mass matrix m is the total mass of the ship and i 22 is the vertical moment of inertia f represents the matrix of vertical hydrodynamic force and moment f e is the matrix of vertical external force and moment it s evident that once the term φ t is known the hydrodynamic forces and acceleration can be obtained an auxiliary functions method is adopted here the term φ t is harmonic and is expressed by auxiliary functions which can be obtained by solving the boundary value problem the body surface boundary condition proposed by wu 1998 is altered with forward speed along with heave and pitch motion 27 φ t n u η 3 η 5 r b n u η 3 φ n η 5 n r b u η 3 φ η 3 n 3 η 5 n 5 u η 3 φ n η 5 n r b u η 3 φ the auxiliary functions χ 3 χ 5 and χ 7 are introduced and φ t can be written as 28 φ t η 3 χ 3 η 5 χ 5 u η 3 φ η 5 r b u η 3 φ χ 7 the auxiliary functions satisfy eq 29 on the body surface s 0 29 χ 3 n n 3 χ 5 n n 5 χ 7 n 0 substitute eq 28 into the bernoulli equation the following equation can be deduced on the free surface sf 30 χ 3 0 χ 5 0 χ 7 1 2 φ 2 g z u η 3 φ η 5 r b u η 3 φ as regard far away control surface 31 φ t n φ i t n φ i t n substitute eq 28 into eq 31 we have 32 χ 3 n 0 χ 5 n 0 χ 7 n φ i t n u η 3 φ n η 5 r b u η 3 φ n χ 3 χ 5 and χ 7 can be solved with eqs 29 30 and 32 substitute the auxiliary functions into the bernoulli equation we have 33 p ρ η 3 χ 3 η 5 χ 5 u η 3 φ η 5 r b u η 3 φ χ 7 1 2 φ φ g z substitute eq 33 into eq 25 then 34 f i s 0 ρ χ 3 n i d s η 3 s 0 ρ χ 5 n i d s η 5 f i i 3 5 35 f i s 0 ρ u η 3 φ η 5 r b u η 3 φ χ 7 φ φ 2 g z n i d s the first two terms in eq 34 indicate the inertial forces of the added mass and they can be expressed as matrix form m a η 35 in which 36 m a s b ρ χ 3 n 3 d s s b ρ χ 5 n 3 d s s b ρ χ 3 n 5 d s s b ρ χ 5 n 5 d s substitute eq 36 into eq 26 we have 37 m m a η 35 f 35 where f 35 f 3 f 5 therefore the acceleration of vertical motion can be acquired and the motion and hydrodynamic forces are decoupled then the velocity and displacement can be updated with the classical fourth order runge kutta 4rk method 2 5 technique for mesh optimization once the mesh is ruined the fully nonlinear time marching process of simulation will break down it s quite important to adopt effective technique to guarantee the mesh during simulation the original mesh on the body surface is generated by cubic spline method and the original mesh on the free surface increases proportionally by 1 04 times the dense mesh near the hull can guarantee the accuracy of the calculation and the total mesh number is not so large to ensure good efficiency poisson equations are utilized to make the mesh on the free surface orthogonal to the waterline which can improve the mesh quality significantly especially for the mesh near the bow and stern regions thomas and middlecoff 1980 a spring analogy method is introduced to optimize the mesh accordingly ma and yan 2009 zhou et al 2015 the principle of this method is to consider the segment between two adjacent nodes as spring where the elastic force can adjust the displacement the total force of the node i can be described as eq 38 38 f i j 1 n i k i j δ r j δ r i where node j represents the adjacent node of node i n i is the number of adjacent nodes of node i and k i j is the stiffness coefficient between node i and j when the node i moves to a new position the total force is zero and then 39 δ r i k 1 j 1 n i k i j δ r j k j 1 n i k k i j the new position can be written as 40 r i r i o l d δ r i besides a five point smoothing method is applied to readjust the coordinates and the velocity potential of some deformed elements in the time marching process if there are m nodes taking the velocity potential as an example the value of one node can be interpolated by itself and adjacent four nodes 41 φ 1 1 70 69 φ 1 4 φ 2 6 φ 3 4 φ 4 φ 5 42 φ 2 1 35 2 φ 1 27 φ 2 12 φ 3 8 φ 4 2 φ 5 43 φ i 1 70 3 φ i 2 12 φ i 1 17 φ i 12 φ i 1 3 φ i 2 44 φ m 1 1 35 2 φ m 4 8 φ m 3 12 φ m 2 27 φ m 1 2 φ m 45 φ m 1 70 φ m 4 4 φ m 3 6 φ m 2 4 φ m 1 69 φ m where φ i and φ i are the values before and after smoothing respectively it should be noted that the smoothing method should not be applied frequently and is used every ten steps in the paper 2 6 flow chart of numerical simulation the flow chart of the numerical simulation is listed in fig 3 3 numerical application 3 1 verification example a 13500 teu container ship is chosen to verify the numerical method the main particulars of this container ship are shown in table 1 and the plan lines are presented in fig 4 3 2 convergence study a convergence study is carried out before the numerical calculation the whole boundaries are meshed in circumferential and radiational directions as shown in fig 5 the radial nodes on the half cross section and free surface are marked as n 1 and n 2 the circumferential nodes on the free surface is n 0 and the radius of the domain is r in the paper n 1 is set to 11 from experience and n 0 is decided by the aspect ratio α the case of f n 0 1 h 7 m λ l 1 0 is selected as the verification condition figs 6 8 show the convergency study with domain radius radial nodes and circumferential nodes on the free surface respectively the time histories of heave and pitch motion all coincide while the curve of vbm with the smallest radial nodes n 2 5 n 1 separate from the other curves with a slight difference as illustrated in fig 7 therefore the present numerical method is convergent with domain radius and mesh if the mesh density on both radial and circumferential directions is guaranteed convergence study about the time steps is also carried out as shown in fig 9 on the basis of convergence study the numerical cases in the following parts adopt r 4 l n 2 6 n 1 α 2 0 in addition it s meaningful to give precise run time of the three dimensional fully nonlinear numerical method as a reference the numerical model is achieved by fortran codes and open mp parallel program is utilized locally to calculate the coefficient matrix and of boundary integration equation in eq 23 table 2 presents the detailed run time of cases with different grids in which are the run time of one time step without and with openmp parallel codes respectively and respectively mean the time consumed on calculating the coefficient matrix in a single runge kutta step without and with parallel program there are four runge kutta steps in each time step generally the run time is positively related to the total nodes the parallel codes can improve calculation efficiency of the openmp applied part dramatically but openmp program is used locally the efficiency can be only improved by about 30 for the present program by intel core i7 8700 cpu 3 2 ghz 16 gb ram 3 3 comparison and analysis of regular waves the numerical method is tested and validated in small regular waves firstly considering the large scale of the 13500teu container ship a series of cases with wave height corresponding to are carried out the numerical calculation results are compared with the experimental data from china classification society ccs the time histories of heave pitch and vbm of numerical simulation are presented in fig 10 where wave height and the ratio of wavelength to the length between perpendiculars fig 10 c shows the hogging moment and sagging moment the mean bending moment is the average of the hogging value and sagging value and the amplitude is the absolute difference between the mean value and the hogging or sagging value there are few nonlinear components in the heave and pitch motion while the waveforms of vbm show nonlinearity evidently and the separation between the hogging and sagging bending moment is observed the absolute value of sagging bending moment is 6825 mn m which is nearly 36 larger than the hogging bending moment 5023 mn m to figure out the asymmetry of the hogging values and sagging values steady results of are calculated and presented in fig 10 it s verified that navigation effects can arouse the sinkage and trim in still water fonseca and guedes soares 2004 in figs 10 a and 6 b the values of mean motion are less than those of sinkage and trim however advancing in waves can increase the asymetry of vbm as shown in fig 10 c thus it s inferred the asymetry of sagging and hogging motion and loads are mainly caused by the nonlinearity of body nonlinearity the navigation effects and wave body interaction fig 11 shows the comparison of experimental and numerical vbm results at midship with different the amplitudes of numerical results are generally in compliance with experimental data the data of experiment and numerical simulation both reach the maximum values when and the experimental peak is about 5 2 higher than that of the numerical simulation there are some approximations and influence factors in scaled ship model tests such as the beam assumption the similarity of mass distribution and rigidity scale effect wall effect and so on while in numerical calculation the real ship instead of the scaled model is used as simulation target under these circumstances the tendency and maximum value of numerical simulation can be considered to coincide quite well with those of experimental data and thus the presented method is verified the heave and pitch motion of numerical simulation with different are presented in fig 12 when is less than 1 2 the pitch motion increases with the wavelength and decrease slowly with wavelength when is larger than 1 2 generally the heave motion increases with the wavelength and there is a jump from 0 68 m to 1 86 m between and the wave elevation and pressure distribution at the moments when heave motion reaches the minimum and maximum values with and are presented in figs 13 and 14 the total wave elevation in sagging states are larger than those in hogging states in fig 13 and they are all much larger than the height of incident wave when wave trough propagates to the midship wave climbing along with the bow and stern is remarkable and the ship is in trim by bow when the wave crest is around the middle area the wave elevation near midship is the significant and the ship is in trim by stern generally the wave elevation on the free surface seem to be similar of the cases and while the pressure distribution can reflect the differences more specifically since the present method is fully nonlinear a case of 5th stokes wave fenton 1985 is presented and compared with the results of airy wave the wave height is chosen as 12 m with the maximum and minimum of stokes wave are 6 33 m and 5 67 m respectively as fig 15 shown the differences of heave and pitch motion between the two waves are obvious in which the amplitude of heave motion of stokes wave is 9 1 larger than that of airy wave and the ratio is about 4 7 for pitch motion 3 4 comparison and analysis of irregular waves the time histories of the incident wave heights of two irregular wave cases are picked from the experiment as shown in fig 16 a and b the froude number average cross zero period and significant wave height of two cases are presented in table 3 in case 1 the ship advances in a moderate sea state with low speed while both sea states and navigation speed are high in case 2 the wave amplitude the frequency and the phase of each sub wave for the irregular waves are obtained with the fast fourier transform fft thus the incident waves in numerical simulation can be superposed with eq 8 and the numerical procedure can be performed to simulate the ship navigating in a specific irregular wave as shown in figs 17 and 18 the variation and the magnitude of the numerical results conform well to that of the experiment for experimental data the maximum responses emerge between 60 and 80s and the largest bending moment reaches 4670 mn m for case1 for case 2 the largest two peaks of vbm occur at around and which is consistent with the time records of wave height comparing case 1 and 2 the maximal magnitute of vbm is over twice that of case 1 and the increase of vbm is much predominant than that of sigficant wave height the reason is that the navigation speed of case 2 is much larger than case 1 both the nagivation speed and significant wave height are of key importance to wave loads as presented in figs 19 and 20 the heave and pitch motion of numerical simulation peak at different time instants and the tendency of heave motion is more similar to that of the wave height in fig 16 for case 2 the maximum of heave motion can be quite severe which should be paid attention to analyze the wave elevation and stress states of ship at different instants typical moments of cases 1 and 2 are selected as shown in figs 17 and 18 respectively the moment and represent the instants when the vbm reaches the minimum value and maximums value and are chosen to compare the maximum and minimum of the dangerous period and the normal period in which the vbm at reaches the minimum of the picked period and vbm at is maximal the free surface elevation and pressure distribution of the moment in both cases are presented in for case 1 when wave trough creeps to the midship at the bow and stern are at the two local crests of the wave at this time the vbm at midship reaches a minus peak indicating that the middle area of the ship is in a sagging stress state that is quite different from the standard sagging in the regular wave case as shown in figs 13 c and 14 c for the regular waves the sagging stress state appears on the whole ship however the sagging is somewhat local between at in figs 21 a and 22 a the wave crest creeps to the midship and the bow rises slightly the maximal pressure at is about 20 kpa lower than that at at this time the midship is in a hogging stress state at a local area at and the pressure peaks are close to that at and but the vbm is much smaller suggesting that the maximum pressure is not a key factor for the determination of the vbm it can be found that the change of waterline is much gentle at and which may be the main influence factor for the vbm for case 2 the froude number and the wave height increase and the crossing zero period changes the wave elevation and pressure distribution of case 2 at the moments are shown in figs 23 and 24 the process of the ship entering and exiting water is simulated in the time domain at when the wave propagates to the bow region it climbs along the hull and water may impact the bow leading to severe heave motion and loads the variation of waterline is very dramatic and the midship is in a critical sagging stress state at the ship is nearly lifted from the water due to the wave force the fore part of the ship is in a sagging stress state the aft part is in a hogging stress state and heave motion reaches the maximum the draught along the whole ship is small but the maximum value of pressure is over 160 kpa which is greatly larger than the static pressure term in other words the dynamic pressure occupies a substantial proportion the wave elevation and pressure distribution at and are still much more significant than those in case 1 it can be noticed that the maximum pressure value in case 2 is about 40 kpa larger than that of case 1 but the amplitude of vbm is almost twice that of case 1 it s mainly caused by the differences of stress state and wave elevation overall the stress state is more complicated than that in the regular wave case usually two or more states can be found along with the ship at a time instant and it is hard to find a standard hogging or sagging stress state along with the whole ship sun et al 2015 beck 1994 ni et al 2015 ya and ma 2007 wang et al 2017 4 conclusion a fully nonlinear time domain method is presented in this paper to simulate ship advancing with forward speed in waves during the numerical simulation the instantaneous pressure distribution around wetted body surface and wave elevation on the free surface of dangerous moments are presented the strongly nonlinear stress states in harsh irregular waves are analyzed the results of a 13500 teu container ship advancing in regular waves and irregular waves are compared with the experimental data to verify the numerical method the present method is convergent with respect to computational domain mesh density on radial and circumferential directions as well as time steps the following conclusions can be drawn 1 there are few nonlinear components in heave and pitch motion in the regular wave cases while the wave forms of vbm show distinct nonlinearity generally the nonlinearity mainly appears as the asymmetry of hogging and sagging values which is caused by the navigating effect the body nonlinearity and the wave body interaction 2 the presented vbm results of 5th stokes waves are quite close to those of airy waves while the heave and pitch motion of the former are larger 3 from the comparison between the extreme values of the most dangerous period and a common period in harsh irregular waves it can be found that the vbm of the former can be over twice that of the latter besides the vbm can be easily affected by the pressure distribution even if the range of values varies a little sometimes it s challenging to find a standard hogging or sagging stress state along the whole ship for there may be two waves passing simultaneously sometimes the whole ship is lifted the draught along the hull is small but the dynamic pressure is tremendous which may lead to structure damage or even make the ship capsized the strongly nonlinear phenomena like slamming water entry and water exit are easily occurred in the extreme sea condition the fully nonlinear method in this paper captures the critical state and can help to predict motion and loads in harsh irregular waves credit authorship contribution statement ying tang software validation writing original draft writing review editing shi li sun methodology formal analysis writing review editing funding acquisition hui long ren resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51679045 and the fundamental research funds for the central universities 3072020cf0106 the experimental results are provided by china classification society ccs 
21032,to effectively improve system autonomy increase fault tolerant resilience solve low payload capacity and short endurance time of unmanned surface vehicles usvs there s a trend to deploy multiple usvs as a formation fleet the formation path planning algorithms are essential to generate optimal trajectories and provide practical collision avoidance maneuvers to efficiently navigate the usv fleet to ensure the optimality rationality and path continuity of the formation trajectories this paper presents a novel deterministic algorithm named multiple sub target artificial potential field mtapf based on an improved apf the mtapf belongs to the local path planning algorithm which refers to the global optimal path generated by an improved heuristic a algorithm and the optimal path is divided by this algorithm into multiple sub target points to form sub target point sequence the mtapf can greatly reduce the probability that usvs will fall into the local minimum and help usvs to get out of the local minimum by switching target points as an underactuated system the usv is restricted by various motion constraints and the mtapf is presented to make the generated path compliant with usv s dynamics and orientation restrictions the proposed algorithm is validated on simulations and proven to work effectively in different environments keywords usv formation a global path planning multiple sub target apf local path planning usv dynamics 1 introduction in recent years with the benefits of autonomy technology as well as the driving demand of autonomous vehicles collaborate with each other there has been an increasing development of unmanned surface vehicles usvs the applications of usvs include military utilizations such as sea patrol bertaska et al 2015 and coastal guarding han et al 2015 as well as civilian or scientific deployments such as environmental monitoring sharma et al 2014 and bathymetric survey rimon and koditschek 1992a however current usv platforms are greatly limited for low payload capacity and short endurance times under complex tasks multiple vehicles as a formation fleet that allows cooperative operations to be deployed will be the trend of current and future usv operations in some specific tasks maintaining proper formation can improve work efficiency speed up the completion of target tasks reduce system consumption and enhance the robustness of usv formation fleet system for usv cooperative operation it is especially important to march according to an optimal path with the highest efficiency and robustness a formation path planning strategy to be studied needs to meet the following indicators qu et al 2008 rationality any returned path is reasonable or any path is executable for controlling usv formation fleet operations completeness if there is a collision free path from a starting point to an end point an algorithm can be found if there is no path in the environment a planning failure will be reported optimality the planned path is optimal for a certain measurement such as time distance or energy consumption real time the formation path planning algorithm can be performed in real time which can respond quickly and meet time requirements the cooperative formation controls are focused on how to maintain or track the desired positions and orientations relative to a defined reference point shojaei 2015 the control strategies including the leader follower control chen et al 2010 the virtual structure approach mehrjerdi et al 2011 and the behavior based formation control oberleithner et al 2012 are widely used in some high level autonomous behaviors such as collision avoidance can also be fulfilled by adding additional controllers mahacek et al 2012 fig 1 describes the control strategies which is the core of maintaining the performance of the formation the red star indicates the target point the dashed line indicates the ideal path and the blue arrow indicates data interaction the collaborative control system composed of multiple usvs can be divided into three types centralized distributed and hybrid jialiang 2012 centralized control refers to the integration of mission planning information and formation information into one of usvs the usv is used as the leader other usvs act as the followers the leader coordinates the action of each follower to keep a formation to reach a target point the shortcoming of this control system is that once the leader has an unexpected situation in the formation the entire formation will be disbanded and the task cannot be completed therefore the control strategy has less robustness and fault tolerant resilience distributed control is that each usv has the ability of independently receiving commands and analysis each usv can decide the action according to own wishes and communicate with the monitoring center on the shore to report information such as the location and velocity at the time because they cannot communicate with each other the coordination efficiency of multiple usvs is low and local conflicts are easy to occur which will cause that the overall situation is poor hybrid control system takes into account the advantages of centralized and distributed control strategies such as agility flexibility and reliability the continuity and robustness are better which can meet the needs of multiple usvs collaborative work generally speaking a hierarchical structure of usv formation system consists of three layers i e task coordination layer formation path planning layer and task execution layer which is shown in fig 2 the task coordination layer transmits planning information such as the usv formation information and the each usv position information to the formation path planning layer the formation path planning layer sends the planned position expected heading and velocity of the planned sub target points to the task execution layer and motion control can be accomplished by the controller feedback mechanisms are set up among all levels to correct deviations the task coordination layer is responsible for all task assignments formation information configuration formation design and initialization of each usv control system a global path planning and a real time local path planning are performed according to the environmental information obtained by sensors in the formation path planning layer according to the feedback information of the path planning the execution layer of each usv controls the usv to perform propeller propulsion and turning the formation path planning is a complicated task and can be viewed as a multi objective optimization problem the planned trajectory should be optimized in terms of several aspects such as total distance navigation time and energy consumption although formation path planning methods for unmanned aerial vehicle uav unmanned ground vehicle ugv and mobile robots are studied qiu and duan 2014 zuo et al 2016 there is few works focused on developing a robust formation path planning algorithm for usvs liu and bucknall 2015 obstacles like islands and buoys in the ocean increase the complexity and difficulty of formation path planning thus the planned path must be smooth continuous and feasible and dynamic constraints should also be considered when the usv marches according to the planned path the nature of usv formation path planning is an optimization process of multiple objectives which is more complicated than single vehicle path planning liu and bucknall 2015 the formation path planning needs to consider internal collision avoidance formation shape keeping cooperation behavior formation shape change and total path distance to achieve formation path planning a number of different approaches have been proposed which can be categorized as two disciplines liu and bucknall 2015 heuristic approach deterministic approach the heuristic method can be used to speed up the process of finding a satisfactory solution liu and bucknall 2015 cheekuang et al 2009 in general the heuristic method requires a large amount of computation and long computation time and is rarely used in applications where real time requirements are high since the heuristic method does not follow a rigorous process the results generally vary the process is mostly uncertain so it has a high degree of randomness the usv is researched in this paper the propeller is used for forward driving and the rudder is used for heading control different specifications of the usv have different endurance capabilities the listed path planning algorithms in this paper are not only limited to the usv but also other equipment a number of heuristic algorithms such as genetic algorithm particle swarm optimization and ant colony asexual reproduction optimization have been researched wang et al 2019 a novel hybrid diversity particle swarm optimization pso and time optimal control approach was proposed for multiple unmanned aerial vehicles multi uavs formation reconfiguration in dynamic and complicated environments bai et al 2009 this method belongs to a heuristic algorithm which can find a feasible path in a complex environment the path is more optional and can meet the optimal solution of a certain principle however the forming process of the formation shape is only considered the maintenance of the formation is not premeditated in these algorithms and this algorithm needs a large amount of calculation and time an improved genetic algorithm with co evolutionary strategy was put forward for the global path planning of multiple mobile robots qu et al 2013 the global path planning algorithm can be used to ensure that the path is optimal in some respects but it does not meet real time requirement in addition there are some hybrid algorithms such as combining an ant colony algorithm with an apf algorithm the local force factor of the apf was converted into spreading pheromones in the ant searching process liu et al 2015 and the ant colony algorithm focused on subspace search with high fitness this algorithm can solve the problems of slow convergence speed in ant colony algorithm and the local optimum in artificial potential field method however the ultimate goal of this algorithm is to obtain a global path which does not give an optimal principle a fast marching method fmm was employed to generate trajectories for mobile robot formation garrido et al 2011 gomez et al 2013 an improved fmm was used to deal with the collision avoidance problem of moving vessels in a practical maritime environment liu and bucknall 2015 the fmm algorithm provides a good smoothness and continuity path however it still does not fully address the dynamic constraints especially without considering the vehicles heading angles qu et al 2008 and the planning path is not optimal a novel angular rate constrained algorithm was proposed based on theta kim et al 2014 which was a grid based method and was similar to a the feasible points in the space were redefined by introducing the turning rate of the usv however long calculation time was needed the deterministic algorithms have the characteristics of search completeness and consistency the apf is becoming a main method due to its easy implementation and good collision avoidance liu and bucknall 2016 the apf method was initially used to plan the global optimal trajectory for an individual robot in an obstacle environment perdereau et al 2002 rimon and koditschek 1992b a motion planning and obstacle avoidance of multiple hybrid driven underwater glider hug formation using the apf method and kane s method was presented yang et al 2011 the hug uses the net buoyancy and attitude angle adjustment to obtain propulsion it consumes little energy when adjusting the net buoyancy and attitude angle which shows the characteristics of high efficiency and long endurance up to thousands of kilometers the hug formation with an apf was regarded as a multi body system in which the hug was constrained by the virtual forces derived from the apf the problems of collision and the global minimum point were solved by a dynamic artificial potential field dapf based on the local information niizuma et al 2015 the apf is a local path planning algorithm and has the advantages of real time planning and stable formation shape but the planned path is not optimal the main drawback of the apf is suffering from the local minima problem once the formation falls into the local minimum area and the usv receives the same amount of gravity and repulsive force the formation will not be able to march and the mission will fail the formation algorithms and main features are shown in table 1 the deterministic algorithm considers the path planning problem from the conventional perspectives and not to consider simultaneously time cost distance cost and obstacle avoidance qu et al 2008 the heuristic path planning algorithm is not able to rigorously maintain the formation shape the uncertainty and randomness of the heuristic search makes the path hard follow a predefined shape and the heuristic path planning suffers from incompleteness and inaccuracy of search results liu and bucknall 2015 a multiple sub target artificial potential field mtapf is put forward in this paper which combines an improved a heuristic global path planning algorithm and an improved apf deterministic algorithm the improved a heuristic global path planning algorithm is used to generate the optimal path and the optimal path is divided into multiple sub target point sequence the improved apf deterministic algorithm is used to keep the formation shape in the local path planning the referenced optimal path makes the formation have higher motion efficiency during obstacle avoidance the marching path is more continuous smooth and complete the mtapf can greatly reduce the probability of the formation falling into the local minimum and help usvs to get out of the local minimum by switching the target point when two obstacles approach the formation can pass through the narrow passage by using the mtapf the orientation of usv at the start of the march and the feasible constrained route within the vehicle s turning capability have been considered in the mtapf path planning algorithm the rest of the paper is organized as follows section 2 describes the global path planning strategy based on the improved a algorithm section 3 gives the local path planning algorithm based on the improved apf section 4 puts forward the usv formation path planning algorithm based on the mtapf section 5 verifies the proposed algorithms and strategies section 6 concludes this paper and discusses the future work 2 the global path search algorithm based on the improved a the proposed hybrid path planning algorithm is mainly composed of two parts global path planning algorithm and local formation path planning algorithm in this section the improved a is used as the global path planning algorithm to generate an optimal path which guides the usv formation to reach the target point quickly and safely furthermore the comparison between traditional a and the proposed improved a is carried out 2 1 traditional a for global path planning a is an informed incremental heuristic search algorithm or a popular variant of best first search the algorithm was firstly published in 1968 hart et al 1972 a formation path planning framework with the a algorithm was firstly proposed for unmanned ground vehicles in a dynamic environment as a classical grid based methodology the a has been widely applied in different shapes and forms a heuristic method is used to search towards the goal position in the a algorithm the a algorithm can find the shortest path by using an edge cost and a heuristic based on the euclidean distance hao and agrawal 2005 although the a algorithm can ensure to generate the shortest path the smoothness and continuity of the path need be improved to strictly follow the shortest path meanwhile the a algorithm can still not fully solve the dynamic constraint problem especially without considering the vehicles heading angle change under the condition of the vehicle s dynamics the local path planning of the formation need refer to the path generated by the global path planning algorithm to improve the smoothness and continuity of the path in each iteration of its main loop the a need determine which node to extend which bases on the cost of the path and the estimated cost of extending the path all the way to the goal point specifically the a selects the path that minimizes 1 f n g n h n where n is the next node on the path g n is the cost of the path from the starting node to n and h n is a heuristic function that estimates the cost of the cheapest path from n to the goal node if the heuristic function is admissible this means that the a can return a least cost path from the starting node to the goal node and it will never overestimate the actual cost to arrive at the goal node a typical implementation of the a is to repeatedly select the minimum estimated cost node to be expanded by using a priority queue this algorithm can divide all the found nodes into two sets open this priority queue is known as an open set and is the set of currently found nodes that are yet not evaluated closed the node set has already been evaluated fig 3 gives the flow chart of the a algorithm at each step of the algorithm execution the node with the lowest value f x is removed from the queue and these neighbors that are not in closed are added to the queue and the values of f and g are updated the algorithm will stop until the queue is empty or a goal node is found in the queue h is zero at the goal node so f value is the cost of the shortest path after running this algorithm the end node will point to its previous node until the previous node of some nodes becomes the starting node 2 2 the improved a algorithm traditional a algorithm cannot guarantee the safety of the vehicle and has a large amount of calculation it does not consider the shortcomings of the turning cost and the redundant path points therefore the following improvements are carried out a reduce search points near obstacles and keep a safe distance to avoid collision traditional a algorithm converts the map into a binary map and then obtains a gird map but it does not simplify the grid near an obstacle in the search process not only the search area is increased but also the obtained path is closer to the obstacle the safety of the usv cannot be guaranteed when avoiding obstacles b the maximum search distance and maximum path length constraint are shown in fig 4 which limits maximum search distance to reduce search range and shorten search time during the search process the straight line distance from the starting point to the target point is defined as the maximum distance l m d and l m p is the maximum path length through the node the added search constraints are 2 h n k l m d f n λ l m p where k and λ are the scale factors c the turning cost h δ is added into the heuristic function to avoid frequent turns of the usv and improve the smoothness of the path to reduce the path turning points and avoid the roundabout and frequent turning of the usv the turning cost is added into the heuristic function 3 f n g n h n h δ d a trajectory optimization algorithm is proposed to optimize the generated trajectory eliminate redundant points and shorten the path length the obtained path is equally divided by the optimization algorithm it is determined as a redundant path point by judging if there are obstacles around each path point the running processes and the planned paths based on the a algorithm and the improved a algorithm is shown in fig 5 it can be seen from fig 5 a and c that the number of nodes based on the improved a algorithm is less and the distance from the obstacles is larger the red path is optimized by the trajectory optimization algorithm and the blue path is not optimal path in fig 5 d it can be seen from fig 5 b and d that the path length based on the improved a algorithm is shorter the operation information of the a algorithm is given in table 2 compared with the improvement before the path length has been reduced by 3 2 the search time has been reduced by 30 5 and the number of search nodes has been reduced by 9 3 for the planned path the a algorithm can ensure the shortest path and is optimal from the perspective of distance however the a algorithm does not fully consider the dynamic constraints of usvs especially heading angle changes the formation local planning path refers to the global path rather than strictly following the global path which improves the smoothness and continuity of the planned path 3 the local path planning algorithm based on the improved apf the optimal path obtained by the global path planning algorithm is divided into multiple sub target point sequences and the formation shape is formed and maintained well considering the obstacles the local path planning algorithm is presented the traditional apf and the proposed improved apf are discussed in detail in this section 3 1 traditional and the improved apf for path planning as a deterministic path planning algorithm the apf algorithm has the advantages of more maturation more efficiency and simple mathematical calculation and has been widely used as an effective local path planning algorithm the apf constructs a potential field in the working environment of mobile robot and the mobile robot is affected by gravitational field of the target and a repulsion of surrounding obstacles kuppan chetty et al 2012 however when using traditional apf for path planning there are mainly three problems a because traditional artificial potential field method uses a virtual force to control the movement of a usv when two obstacles are close to each other the usv may not be able to pass through the narrow passage in addition the obstacle and the target point are on the same line the force control of the usv can only move repeatedly on the straight line but cannot reach the target point b in the case of only one target point when a usv has not arrived the gravity of the target point to the usv is likely be equal to the repulsive force of the obstacle to the vehicle when the resultant force is zero the usv will fall into local minimum and stop marching c in the case of only one target point although the trajectory of the usv conforms to the dynamic limitation its trajectory does not satisfy the optimal conditions such as the shortest path and the least time during the travel process it is greatly affected by environmental factors in view of the shortcomings of traditional apf algorithm the following improvements are performed a the gravitational field of the target to the usv and the repulsive field of the obstacle to the usv are transformed into potential field strength the traditional vector force control is replaced by the calculation of potential field strength b combined with the improved a algorithm a novel mtapf algorithm is put forward in the path planning of the usv the sequence of sub target points is formed by dividing multi target points which greatly reduces the probability that a usv falls into a local minimum even if the usv falls into local minimum and the velocity of the usv is close to zero at this time finding the next target point in the sequence of sub target points as the current target point can help the usv get out of the local minimum c the division of multi target points refers to the global optimal path obtained by the improved a algorithm so that the usv formation trajectory can be optimized under the condition of satisfying the dynamic constraints of the usv 3 2 the improved apf model through the above improved measurements an improved apf model is established the gravitational potential field model of goal point to moving usv is 4 u a t t r λ a t t r ρ x g k sin θ x g cos θ x g where ρ x g is the distance from current point x x y to goal point g x y λ a t t r is a scaling factor for gravitational potential field and has a minimum amount λ min a t t r which is greater than zero k 2 5 is an index of calculating field θ x g is an angle between current point x x y and goal point g x y the repulsive potential field model of goal point to moving usv is 5 u r e p u λ r e p u 1 ρ x o k sin θ x o cos θ x o where ρ x o is the distance from current point x x y to obstacle point o x y λ r e p u is a scaling factor for repulsive potential field and has a minimum amount λ min repu which is greater than zero k 2 is an index of calculating potential field θ x o is an angle between current point x x y and obstacle point o x y the obstacle is respectively located in the front left right left front right front of the usv the angle between the usv and the obstacle should also be changed 6 u t o t a l u a t t r u r e p u where u a t t r is the gravitational potential filed u r e p u is the repulsive potential field and u t o t a l is the total potential field under the action of the total potential field the usv begins to march with the kinetic model fig 6 a shows an empty 500 500 pixel map fig 6 b gives the change process of the total potential field the potential value is given by equation 6 and the solid brown line is the path generated by the apf fig 6 c and d give the change of gravitational potential field and the repulsive potential field respectively the gravitational potential value and the repulsive potential value are respectively calculated by using equations 4 and 5 during the formation process due to the different total potential fields are received by a single usv it may happen that a certain usv in the formation cannot reach the goal point in time and multiple usvs in the formation may collide the cooperation of multiple usvs in the formation will be discussed in detail in the next section 4 the usv formation path planning based on the mtapf and the improved a algorithm in this section a dynamic model of the usv is used as the motion simulation plant for the proposed control algorithm the global path planning control the improved a algorithm and the local multiple sub target artificial potential field mtapf considering the dynamic constraints are combined as the hybrid path planning algorithm and the control process is described in detail 4 1 the motion equation of the usv when an usv moves on a horizontal plane it is usually described as consisting of three free moving parts surge sway and yaw wang and xu 2020 the 3 degree of freedoms dofs nonlinear dynamic model of the usv can be expressed as 7 η j η v 8 m v c v v d v v τ where η x y ψ τ is a position vector v u v r τ is a velocity vector τ is a control input j η is a transformation matrix between an earth fixed frame and a body fixed frame m is an inertia matrix c is a coriolis and centripetal matrix d is a linear damping matrix the parameters are defined as follows j η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r c 0 0 m y v v m x g y r r 0 0 m x u u m y v v m x g y r r m x u u 0 d x u 0 0 0 y v y r 0 n v n r equation 8 is transformed into the earth fixed frame which can be expressed as 9 m η η η c η v η η d η v η η τ η where m η η j τ η m j 1 η c η v η j τ η c v m j 1 η j η j 1 η τ η j τ η τ d η v η j τ η d v j 1 η equation 9 is rewritten as the following format 10 η m η 1 η j τ η τ c η η d η η assuming that u j η m 1 τ is a virtual control variable then equation 10 can be expressed as 11 η m η 1 η c η η d η η u as the usv is underactuated and the vehicle can only be controlled in the surge and yaw motions the surge velocity u is taken into account and specified as 12 u u max where u max is a maximum surge velocity in addition the usv has a limited turning capability thus the vehicle s yaw rate is 13 r r max where r max is the maximum yaw rate of the usv 4 2 the dynamic constraints and priority strategy of the usv the usv is underactuated during most of operation time which makes it have low maneuverability and motion flexibility liu and bucknall 2016 special consideration should be given to a heading angle problem the usv s turning angle is shown in fig 7 a and the turning angle δ is described as 14 δ r max δ t where δ t is the control interval time the path considering the usv dynamic constraints is shown in fig 7 b where the dashed line indicates the path without dynamic constraints because of the limitation of turning ability the usv is limited under the dynamic conditions which will result in an undesirable path therefore the dynamic characteristics of the usv must be considered when planning the usv path the smoothness and continuity of the path should be considered in addition it is also considered whether the dynamic constraints of the usv are met especially the initial heading angle the usv s position and the heading angle are random during the usv deployment when the formation shape is formed each usv moves toward a target point which is as shown in fig 8 a the solid line is the path of the usv with dynamic limitation and the dash line is the path of the usv without dynamic limitation considering the dynamic constraints the simulation results are more realistic therefore to verify the importance of dynamic constraints dynamic constraints and non dynamic constraints need be distinguished when the usv starts to deploy its position and heading are not in accordance with the expectation therefore the positions and the heading angles of the various usvs are random before the formations shape is formed when the distance between two usvs is too close collisions may occur the priority strategy is adopted to avoid collisions during the formation forming process as seen in fig 8 b the yellow usv is the leader and the green usv farthest from the leader is designated as sub follower when the distance between the sub follower and the follower the blue usv is small the velocity of sub follower is slow in contrast the sub follower starts to accelerate 4 3 the mtapf algorithm for the usv formation forming and path planning the mtapf is multiple sub target apf algorithm based on the improved apf algorithm when the formation plans paths the mtapf algorithm refers to the path generated by the improved a algorithm and then divides multi target points to form a sub target point sequence in the stage of the formation forming an algorithm based on the mtapf is proposed and the flow chart of the algorithm is shown in fig 9 when the algorithm starts to work the initial heading angle of each usv is first read leader follower approach is used to design the formation shape and one usv from the formation is selected to guide the motion of the formation the second step is to get the leader s target point position and calculate the follower s target points according to the formation parameters the mtapf is then applied to each usv to generate the appropriate trajectory based on the assigned target point path tracking control is executed by each usv until the target point is reached the trajectory tracking tasks will be performed after the trajectories are generated it is assumed that each usv has a trajectory tracking controller such that its individual path can be perfectly tracked without errors the assumption is reasonable and has been applied to formation path planning álvarez et al 2015 fig 10 gives the flow chart of the formation path planning algorithm which is developed based on the mtapf and uses a binary map step one define the usvs starting points and goal points and read the information of each usv because usvs have random initial heading angles and positions step two execute the formation shape forming algorithm step three once the formation shape is finished and each usv has arrived the starting point the improved a algorithm starts a global path planning algorithm to obtain an optimal path and sub target point sequence step four the mtapf algorithm starts a local formation path planning algorithm based on the dynamic constraints of the usv algorithm 1 is the mtapf algorithm in algorithm 1 m is the initialized map p s t a r t is the starting point and p g o a l is the target point for different usvs in the formation the starting point and the target point are different which facilitates the formation of the formation p l o c a t i o n is the current position point of each usv p h e a d i n g is the current heading of each usv and the path set is the set of various path points after the formation is formed the improved a global path planning algorithm is used to obtain a global path and the sub target points of the target path can be obtained by dividing the global path before reaching the final target point taking the sub target point as the current formation target point the mtapf algorithm is used to advance to reach the final target point algorithm 1 multiple sub target artificial potential field algorithm image 1 5 algorithm validations this section discusses and analyses the simulation results under two different environments the main indicators of the comparison results are arriving the target point the length of the path and time to complete the task real time the smoothness and continuity of the path when the formation is planned the planned path and trajectory tracking must meet the dynamic characteristics of the usv the obstacles are described in black color in all simulation results 5 1 formation path planning in a complex environment the formation path planning in a complex environment is shown in fig 11 when the apf algorithm is used for the local path planning the formation cannot refer to the path in fig 11 a the lengths of the path are long and the smoothness of the formation path is poor the global path planning based on the improved a algorithm is shown in fig 11 b and the blue path is the generated optimal path it can be clearly seen that the optimal path is relatively short and smooth the local path planning based on the mtapf is shown in fig 12 a which refers to the global planning path by using the improved a algorithm where the red line is the trajectory of the leader the blue line is that of the follower 1 and the green line is that of the follower 2 fig 12 b d give the total potential field the gravitational potential field and the repulsive potential field respectively it can be seen that the length of the formation path is short and the continuity and smoothness of the formation path are high when the improved a algorithm is used for the global path planning and the mtapf algorithm is used for the local path planning fig 13 gives the velocity and the heading curves of the leader the followers 1 and 2 in the formation the comparison results are given in table 3 the path length with the improved a algorithm is 30 2 less than that with the apf algorithm moreover the path with mtapf algorithm is reduced by a maximum of 8 1 compared with the apf algorithm n a means that no path planning is performed in table 3 a global optimal reference path can be obtained only once thus there is no need to perform plan planning again in the case of a long voyage the effect of the algorithm will be more obvious table 4 gives the information of each usv in this simulation 5 2 formation path planning in a narrow passage the formation marching in a narrow intricate environment is shown in fig 14 it can be seen from fig 14 a that the formation based on traditional apf cannot pass through the narrow passageway when the repulsive potential is greater than the gravitational potential the formation is trapped in the local space when the repulsive potential is equal to the gravitational potential in some field the formation will fall into a local minimum and stop marching thus the above mentioned problems must be considered when the formation performs tasks in a centralized control system when the leader in the formation falls into a local minimum or fails the entire formation will be paralyzed in this paper a hybrid control system is adopted which increases the robustness and reliability of the system fig 14 b gives the global planning path by using the improved a algorithm the mtapf algorithm path and potential field in narrow complex environment are show in fig 5 fig 15 a gives the local planning path based on the mtapf in a narrow complex environment which refers to the global planning path by using the improved a algorithm fig 15 b gives the formation paths in the total potential field the formation passes through the narrow passageway smoothly with continuous trajectory when forming the formation shape the position and the heading of each usv are randomly distributed after the formation the formation begins to march when constructing a local planning path the priority strategy is adopted to prevent collision fig 15 c d gives the gravitational potential field and the repulsive potential field respectively it can be seen from fig 15 d that the closer the usv is to the obstacle the greater the repulsion potential fig 16 gives the velocity and the heading curves of the leader the followers 1 and 2 in the formation the formation path lengths of usvs in a narrow environment under different algorithms are given in table 5 the apf algorithm cannot be used to reach the target point through a narrow passage the n a indicates that there is no path length and the path planning is not completed the formation can be carried out with the a and mtapf algorithms because the voyage is longer the path length is correspondingly longer table 6 gives the random configuration parameters of the usv formation the difference from table 4 is that the initial heading and position of each usv are random 6 conclusions and future works a new mtapf algorithm based on the improved apf was put forward and the formation path selection of the usv robustness and reliability in marching were analyzed in this paper the improved a algorithm was adopted to obtain the optimal path and the mtapf algorithm was used to carry out the local path planning which ensured the forming of the formation shape the maintenance of formation shape and the robustness and reliability of formation under the premise of satisfying the dynamic characteristics of the usvs the continuity and the smoothness of the path were assured when constructing a local planning path a priority strategy was used to prevent from colliding with each other a hybrid control system was adopted and the leader follower control strategy controls the formation collaboration of multiple usvs simulation results verified the effectiveness of the proposed algorithm in terms of the future work the proposed algorithms will be implemented on the practical usv platforms and the global and the local path planning controllers will be designed after the prototype is completed sea trials will be performed besides the practical vehicle is verified the dynamic environment need be deeply researched which includes various moving ships associated with different encounter situations in addition the dynamic environment can also refer to the varying environment that may be affected by ocean conditions such as currents and tides in the dynamic environment the path planning and collision avoidance strategies of the usv formation will be the main work in future credit authorship contribution statement hongqiang sang conceptualization data curation formal analysis funding acquisition yusong you investigation methodology formal analysis project administration validation visualization writing review editing xiujun sun formal analysis resources supervision funding acquisition ying zhou formal analysis software roles writing original draft fen liu formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by tianjin natural science foundation no 18jczdjc40100 major scientific and technological innovation projects of shandong province no 2019jzzy020701 the national key research and development plan of china no 2017yfc0305902 wenhai program of qingdao national laboratory for marine science and technology no 2017whzzb0101 and the program for innovative research team in university of tianjin no td13 5037 
21032,to effectively improve system autonomy increase fault tolerant resilience solve low payload capacity and short endurance time of unmanned surface vehicles usvs there s a trend to deploy multiple usvs as a formation fleet the formation path planning algorithms are essential to generate optimal trajectories and provide practical collision avoidance maneuvers to efficiently navigate the usv fleet to ensure the optimality rationality and path continuity of the formation trajectories this paper presents a novel deterministic algorithm named multiple sub target artificial potential field mtapf based on an improved apf the mtapf belongs to the local path planning algorithm which refers to the global optimal path generated by an improved heuristic a algorithm and the optimal path is divided by this algorithm into multiple sub target points to form sub target point sequence the mtapf can greatly reduce the probability that usvs will fall into the local minimum and help usvs to get out of the local minimum by switching target points as an underactuated system the usv is restricted by various motion constraints and the mtapf is presented to make the generated path compliant with usv s dynamics and orientation restrictions the proposed algorithm is validated on simulations and proven to work effectively in different environments keywords usv formation a global path planning multiple sub target apf local path planning usv dynamics 1 introduction in recent years with the benefits of autonomy technology as well as the driving demand of autonomous vehicles collaborate with each other there has been an increasing development of unmanned surface vehicles usvs the applications of usvs include military utilizations such as sea patrol bertaska et al 2015 and coastal guarding han et al 2015 as well as civilian or scientific deployments such as environmental monitoring sharma et al 2014 and bathymetric survey rimon and koditschek 1992a however current usv platforms are greatly limited for low payload capacity and short endurance times under complex tasks multiple vehicles as a formation fleet that allows cooperative operations to be deployed will be the trend of current and future usv operations in some specific tasks maintaining proper formation can improve work efficiency speed up the completion of target tasks reduce system consumption and enhance the robustness of usv formation fleet system for usv cooperative operation it is especially important to march according to an optimal path with the highest efficiency and robustness a formation path planning strategy to be studied needs to meet the following indicators qu et al 2008 rationality any returned path is reasonable or any path is executable for controlling usv formation fleet operations completeness if there is a collision free path from a starting point to an end point an algorithm can be found if there is no path in the environment a planning failure will be reported optimality the planned path is optimal for a certain measurement such as time distance or energy consumption real time the formation path planning algorithm can be performed in real time which can respond quickly and meet time requirements the cooperative formation controls are focused on how to maintain or track the desired positions and orientations relative to a defined reference point shojaei 2015 the control strategies including the leader follower control chen et al 2010 the virtual structure approach mehrjerdi et al 2011 and the behavior based formation control oberleithner et al 2012 are widely used in some high level autonomous behaviors such as collision avoidance can also be fulfilled by adding additional controllers mahacek et al 2012 fig 1 describes the control strategies which is the core of maintaining the performance of the formation the red star indicates the target point the dashed line indicates the ideal path and the blue arrow indicates data interaction the collaborative control system composed of multiple usvs can be divided into three types centralized distributed and hybrid jialiang 2012 centralized control refers to the integration of mission planning information and formation information into one of usvs the usv is used as the leader other usvs act as the followers the leader coordinates the action of each follower to keep a formation to reach a target point the shortcoming of this control system is that once the leader has an unexpected situation in the formation the entire formation will be disbanded and the task cannot be completed therefore the control strategy has less robustness and fault tolerant resilience distributed control is that each usv has the ability of independently receiving commands and analysis each usv can decide the action according to own wishes and communicate with the monitoring center on the shore to report information such as the location and velocity at the time because they cannot communicate with each other the coordination efficiency of multiple usvs is low and local conflicts are easy to occur which will cause that the overall situation is poor hybrid control system takes into account the advantages of centralized and distributed control strategies such as agility flexibility and reliability the continuity and robustness are better which can meet the needs of multiple usvs collaborative work generally speaking a hierarchical structure of usv formation system consists of three layers i e task coordination layer formation path planning layer and task execution layer which is shown in fig 2 the task coordination layer transmits planning information such as the usv formation information and the each usv position information to the formation path planning layer the formation path planning layer sends the planned position expected heading and velocity of the planned sub target points to the task execution layer and motion control can be accomplished by the controller feedback mechanisms are set up among all levels to correct deviations the task coordination layer is responsible for all task assignments formation information configuration formation design and initialization of each usv control system a global path planning and a real time local path planning are performed according to the environmental information obtained by sensors in the formation path planning layer according to the feedback information of the path planning the execution layer of each usv controls the usv to perform propeller propulsion and turning the formation path planning is a complicated task and can be viewed as a multi objective optimization problem the planned trajectory should be optimized in terms of several aspects such as total distance navigation time and energy consumption although formation path planning methods for unmanned aerial vehicle uav unmanned ground vehicle ugv and mobile robots are studied qiu and duan 2014 zuo et al 2016 there is few works focused on developing a robust formation path planning algorithm for usvs liu and bucknall 2015 obstacles like islands and buoys in the ocean increase the complexity and difficulty of formation path planning thus the planned path must be smooth continuous and feasible and dynamic constraints should also be considered when the usv marches according to the planned path the nature of usv formation path planning is an optimization process of multiple objectives which is more complicated than single vehicle path planning liu and bucknall 2015 the formation path planning needs to consider internal collision avoidance formation shape keeping cooperation behavior formation shape change and total path distance to achieve formation path planning a number of different approaches have been proposed which can be categorized as two disciplines liu and bucknall 2015 heuristic approach deterministic approach the heuristic method can be used to speed up the process of finding a satisfactory solution liu and bucknall 2015 cheekuang et al 2009 in general the heuristic method requires a large amount of computation and long computation time and is rarely used in applications where real time requirements are high since the heuristic method does not follow a rigorous process the results generally vary the process is mostly uncertain so it has a high degree of randomness the usv is researched in this paper the propeller is used for forward driving and the rudder is used for heading control different specifications of the usv have different endurance capabilities the listed path planning algorithms in this paper are not only limited to the usv but also other equipment a number of heuristic algorithms such as genetic algorithm particle swarm optimization and ant colony asexual reproduction optimization have been researched wang et al 2019 a novel hybrid diversity particle swarm optimization pso and time optimal control approach was proposed for multiple unmanned aerial vehicles multi uavs formation reconfiguration in dynamic and complicated environments bai et al 2009 this method belongs to a heuristic algorithm which can find a feasible path in a complex environment the path is more optional and can meet the optimal solution of a certain principle however the forming process of the formation shape is only considered the maintenance of the formation is not premeditated in these algorithms and this algorithm needs a large amount of calculation and time an improved genetic algorithm with co evolutionary strategy was put forward for the global path planning of multiple mobile robots qu et al 2013 the global path planning algorithm can be used to ensure that the path is optimal in some respects but it does not meet real time requirement in addition there are some hybrid algorithms such as combining an ant colony algorithm with an apf algorithm the local force factor of the apf was converted into spreading pheromones in the ant searching process liu et al 2015 and the ant colony algorithm focused on subspace search with high fitness this algorithm can solve the problems of slow convergence speed in ant colony algorithm and the local optimum in artificial potential field method however the ultimate goal of this algorithm is to obtain a global path which does not give an optimal principle a fast marching method fmm was employed to generate trajectories for mobile robot formation garrido et al 2011 gomez et al 2013 an improved fmm was used to deal with the collision avoidance problem of moving vessels in a practical maritime environment liu and bucknall 2015 the fmm algorithm provides a good smoothness and continuity path however it still does not fully address the dynamic constraints especially without considering the vehicles heading angles qu et al 2008 and the planning path is not optimal a novel angular rate constrained algorithm was proposed based on theta kim et al 2014 which was a grid based method and was similar to a the feasible points in the space were redefined by introducing the turning rate of the usv however long calculation time was needed the deterministic algorithms have the characteristics of search completeness and consistency the apf is becoming a main method due to its easy implementation and good collision avoidance liu and bucknall 2016 the apf method was initially used to plan the global optimal trajectory for an individual robot in an obstacle environment perdereau et al 2002 rimon and koditschek 1992b a motion planning and obstacle avoidance of multiple hybrid driven underwater glider hug formation using the apf method and kane s method was presented yang et al 2011 the hug uses the net buoyancy and attitude angle adjustment to obtain propulsion it consumes little energy when adjusting the net buoyancy and attitude angle which shows the characteristics of high efficiency and long endurance up to thousands of kilometers the hug formation with an apf was regarded as a multi body system in which the hug was constrained by the virtual forces derived from the apf the problems of collision and the global minimum point were solved by a dynamic artificial potential field dapf based on the local information niizuma et al 2015 the apf is a local path planning algorithm and has the advantages of real time planning and stable formation shape but the planned path is not optimal the main drawback of the apf is suffering from the local minima problem once the formation falls into the local minimum area and the usv receives the same amount of gravity and repulsive force the formation will not be able to march and the mission will fail the formation algorithms and main features are shown in table 1 the deterministic algorithm considers the path planning problem from the conventional perspectives and not to consider simultaneously time cost distance cost and obstacle avoidance qu et al 2008 the heuristic path planning algorithm is not able to rigorously maintain the formation shape the uncertainty and randomness of the heuristic search makes the path hard follow a predefined shape and the heuristic path planning suffers from incompleteness and inaccuracy of search results liu and bucknall 2015 a multiple sub target artificial potential field mtapf is put forward in this paper which combines an improved a heuristic global path planning algorithm and an improved apf deterministic algorithm the improved a heuristic global path planning algorithm is used to generate the optimal path and the optimal path is divided into multiple sub target point sequence the improved apf deterministic algorithm is used to keep the formation shape in the local path planning the referenced optimal path makes the formation have higher motion efficiency during obstacle avoidance the marching path is more continuous smooth and complete the mtapf can greatly reduce the probability of the formation falling into the local minimum and help usvs to get out of the local minimum by switching the target point when two obstacles approach the formation can pass through the narrow passage by using the mtapf the orientation of usv at the start of the march and the feasible constrained route within the vehicle s turning capability have been considered in the mtapf path planning algorithm the rest of the paper is organized as follows section 2 describes the global path planning strategy based on the improved a algorithm section 3 gives the local path planning algorithm based on the improved apf section 4 puts forward the usv formation path planning algorithm based on the mtapf section 5 verifies the proposed algorithms and strategies section 6 concludes this paper and discusses the future work 2 the global path search algorithm based on the improved a the proposed hybrid path planning algorithm is mainly composed of two parts global path planning algorithm and local formation path planning algorithm in this section the improved a is used as the global path planning algorithm to generate an optimal path which guides the usv formation to reach the target point quickly and safely furthermore the comparison between traditional a and the proposed improved a is carried out 2 1 traditional a for global path planning a is an informed incremental heuristic search algorithm or a popular variant of best first search the algorithm was firstly published in 1968 hart et al 1972 a formation path planning framework with the a algorithm was firstly proposed for unmanned ground vehicles in a dynamic environment as a classical grid based methodology the a has been widely applied in different shapes and forms a heuristic method is used to search towards the goal position in the a algorithm the a algorithm can find the shortest path by using an edge cost and a heuristic based on the euclidean distance hao and agrawal 2005 although the a algorithm can ensure to generate the shortest path the smoothness and continuity of the path need be improved to strictly follow the shortest path meanwhile the a algorithm can still not fully solve the dynamic constraint problem especially without considering the vehicles heading angle change under the condition of the vehicle s dynamics the local path planning of the formation need refer to the path generated by the global path planning algorithm to improve the smoothness and continuity of the path in each iteration of its main loop the a need determine which node to extend which bases on the cost of the path and the estimated cost of extending the path all the way to the goal point specifically the a selects the path that minimizes 1 f n g n h n where n is the next node on the path g n is the cost of the path from the starting node to n and h n is a heuristic function that estimates the cost of the cheapest path from n to the goal node if the heuristic function is admissible this means that the a can return a least cost path from the starting node to the goal node and it will never overestimate the actual cost to arrive at the goal node a typical implementation of the a is to repeatedly select the minimum estimated cost node to be expanded by using a priority queue this algorithm can divide all the found nodes into two sets open this priority queue is known as an open set and is the set of currently found nodes that are yet not evaluated closed the node set has already been evaluated fig 3 gives the flow chart of the a algorithm at each step of the algorithm execution the node with the lowest value f x is removed from the queue and these neighbors that are not in closed are added to the queue and the values of f and g are updated the algorithm will stop until the queue is empty or a goal node is found in the queue h is zero at the goal node so f value is the cost of the shortest path after running this algorithm the end node will point to its previous node until the previous node of some nodes becomes the starting node 2 2 the improved a algorithm traditional a algorithm cannot guarantee the safety of the vehicle and has a large amount of calculation it does not consider the shortcomings of the turning cost and the redundant path points therefore the following improvements are carried out a reduce search points near obstacles and keep a safe distance to avoid collision traditional a algorithm converts the map into a binary map and then obtains a gird map but it does not simplify the grid near an obstacle in the search process not only the search area is increased but also the obtained path is closer to the obstacle the safety of the usv cannot be guaranteed when avoiding obstacles b the maximum search distance and maximum path length constraint are shown in fig 4 which limits maximum search distance to reduce search range and shorten search time during the search process the straight line distance from the starting point to the target point is defined as the maximum distance l m d and l m p is the maximum path length through the node the added search constraints are 2 h n k l m d f n λ l m p where k and λ are the scale factors c the turning cost h δ is added into the heuristic function to avoid frequent turns of the usv and improve the smoothness of the path to reduce the path turning points and avoid the roundabout and frequent turning of the usv the turning cost is added into the heuristic function 3 f n g n h n h δ d a trajectory optimization algorithm is proposed to optimize the generated trajectory eliminate redundant points and shorten the path length the obtained path is equally divided by the optimization algorithm it is determined as a redundant path point by judging if there are obstacles around each path point the running processes and the planned paths based on the a algorithm and the improved a algorithm is shown in fig 5 it can be seen from fig 5 a and c that the number of nodes based on the improved a algorithm is less and the distance from the obstacles is larger the red path is optimized by the trajectory optimization algorithm and the blue path is not optimal path in fig 5 d it can be seen from fig 5 b and d that the path length based on the improved a algorithm is shorter the operation information of the a algorithm is given in table 2 compared with the improvement before the path length has been reduced by 3 2 the search time has been reduced by 30 5 and the number of search nodes has been reduced by 9 3 for the planned path the a algorithm can ensure the shortest path and is optimal from the perspective of distance however the a algorithm does not fully consider the dynamic constraints of usvs especially heading angle changes the formation local planning path refers to the global path rather than strictly following the global path which improves the smoothness and continuity of the planned path 3 the local path planning algorithm based on the improved apf the optimal path obtained by the global path planning algorithm is divided into multiple sub target point sequences and the formation shape is formed and maintained well considering the obstacles the local path planning algorithm is presented the traditional apf and the proposed improved apf are discussed in detail in this section 3 1 traditional and the improved apf for path planning as a deterministic path planning algorithm the apf algorithm has the advantages of more maturation more efficiency and simple mathematical calculation and has been widely used as an effective local path planning algorithm the apf constructs a potential field in the working environment of mobile robot and the mobile robot is affected by gravitational field of the target and a repulsion of surrounding obstacles kuppan chetty et al 2012 however when using traditional apf for path planning there are mainly three problems a because traditional artificial potential field method uses a virtual force to control the movement of a usv when two obstacles are close to each other the usv may not be able to pass through the narrow passage in addition the obstacle and the target point are on the same line the force control of the usv can only move repeatedly on the straight line but cannot reach the target point b in the case of only one target point when a usv has not arrived the gravity of the target point to the usv is likely be equal to the repulsive force of the obstacle to the vehicle when the resultant force is zero the usv will fall into local minimum and stop marching c in the case of only one target point although the trajectory of the usv conforms to the dynamic limitation its trajectory does not satisfy the optimal conditions such as the shortest path and the least time during the travel process it is greatly affected by environmental factors in view of the shortcomings of traditional apf algorithm the following improvements are performed a the gravitational field of the target to the usv and the repulsive field of the obstacle to the usv are transformed into potential field strength the traditional vector force control is replaced by the calculation of potential field strength b combined with the improved a algorithm a novel mtapf algorithm is put forward in the path planning of the usv the sequence of sub target points is formed by dividing multi target points which greatly reduces the probability that a usv falls into a local minimum even if the usv falls into local minimum and the velocity of the usv is close to zero at this time finding the next target point in the sequence of sub target points as the current target point can help the usv get out of the local minimum c the division of multi target points refers to the global optimal path obtained by the improved a algorithm so that the usv formation trajectory can be optimized under the condition of satisfying the dynamic constraints of the usv 3 2 the improved apf model through the above improved measurements an improved apf model is established the gravitational potential field model of goal point to moving usv is 4 u a t t r λ a t t r ρ x g k sin θ x g cos θ x g where ρ x g is the distance from current point x x y to goal point g x y λ a t t r is a scaling factor for gravitational potential field and has a minimum amount λ min a t t r which is greater than zero k 2 5 is an index of calculating field θ x g is an angle between current point x x y and goal point g x y the repulsive potential field model of goal point to moving usv is 5 u r e p u λ r e p u 1 ρ x o k sin θ x o cos θ x o where ρ x o is the distance from current point x x y to obstacle point o x y λ r e p u is a scaling factor for repulsive potential field and has a minimum amount λ min repu which is greater than zero k 2 is an index of calculating potential field θ x o is an angle between current point x x y and obstacle point o x y the obstacle is respectively located in the front left right left front right front of the usv the angle between the usv and the obstacle should also be changed 6 u t o t a l u a t t r u r e p u where u a t t r is the gravitational potential filed u r e p u is the repulsive potential field and u t o t a l is the total potential field under the action of the total potential field the usv begins to march with the kinetic model fig 6 a shows an empty 500 500 pixel map fig 6 b gives the change process of the total potential field the potential value is given by equation 6 and the solid brown line is the path generated by the apf fig 6 c and d give the change of gravitational potential field and the repulsive potential field respectively the gravitational potential value and the repulsive potential value are respectively calculated by using equations 4 and 5 during the formation process due to the different total potential fields are received by a single usv it may happen that a certain usv in the formation cannot reach the goal point in time and multiple usvs in the formation may collide the cooperation of multiple usvs in the formation will be discussed in detail in the next section 4 the usv formation path planning based on the mtapf and the improved a algorithm in this section a dynamic model of the usv is used as the motion simulation plant for the proposed control algorithm the global path planning control the improved a algorithm and the local multiple sub target artificial potential field mtapf considering the dynamic constraints are combined as the hybrid path planning algorithm and the control process is described in detail 4 1 the motion equation of the usv when an usv moves on a horizontal plane it is usually described as consisting of three free moving parts surge sway and yaw wang and xu 2020 the 3 degree of freedoms dofs nonlinear dynamic model of the usv can be expressed as 7 η j η v 8 m v c v v d v v τ where η x y ψ τ is a position vector v u v r τ is a velocity vector τ is a control input j η is a transformation matrix between an earth fixed frame and a body fixed frame m is an inertia matrix c is a coriolis and centripetal matrix d is a linear damping matrix the parameters are defined as follows j η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 m m x u 0 0 0 m y v m x g y r 0 m x g y r i z n r c 0 0 m y v v m x g y r r 0 0 m x u u m y v v m x g y r r m x u u 0 d x u 0 0 0 y v y r 0 n v n r equation 8 is transformed into the earth fixed frame which can be expressed as 9 m η η η c η v η η d η v η η τ η where m η η j τ η m j 1 η c η v η j τ η c v m j 1 η j η j 1 η τ η j τ η τ d η v η j τ η d v j 1 η equation 9 is rewritten as the following format 10 η m η 1 η j τ η τ c η η d η η assuming that u j η m 1 τ is a virtual control variable then equation 10 can be expressed as 11 η m η 1 η c η η d η η u as the usv is underactuated and the vehicle can only be controlled in the surge and yaw motions the surge velocity u is taken into account and specified as 12 u u max where u max is a maximum surge velocity in addition the usv has a limited turning capability thus the vehicle s yaw rate is 13 r r max where r max is the maximum yaw rate of the usv 4 2 the dynamic constraints and priority strategy of the usv the usv is underactuated during most of operation time which makes it have low maneuverability and motion flexibility liu and bucknall 2016 special consideration should be given to a heading angle problem the usv s turning angle is shown in fig 7 a and the turning angle δ is described as 14 δ r max δ t where δ t is the control interval time the path considering the usv dynamic constraints is shown in fig 7 b where the dashed line indicates the path without dynamic constraints because of the limitation of turning ability the usv is limited under the dynamic conditions which will result in an undesirable path therefore the dynamic characteristics of the usv must be considered when planning the usv path the smoothness and continuity of the path should be considered in addition it is also considered whether the dynamic constraints of the usv are met especially the initial heading angle the usv s position and the heading angle are random during the usv deployment when the formation shape is formed each usv moves toward a target point which is as shown in fig 8 a the solid line is the path of the usv with dynamic limitation and the dash line is the path of the usv without dynamic limitation considering the dynamic constraints the simulation results are more realistic therefore to verify the importance of dynamic constraints dynamic constraints and non dynamic constraints need be distinguished when the usv starts to deploy its position and heading are not in accordance with the expectation therefore the positions and the heading angles of the various usvs are random before the formations shape is formed when the distance between two usvs is too close collisions may occur the priority strategy is adopted to avoid collisions during the formation forming process as seen in fig 8 b the yellow usv is the leader and the green usv farthest from the leader is designated as sub follower when the distance between the sub follower and the follower the blue usv is small the velocity of sub follower is slow in contrast the sub follower starts to accelerate 4 3 the mtapf algorithm for the usv formation forming and path planning the mtapf is multiple sub target apf algorithm based on the improved apf algorithm when the formation plans paths the mtapf algorithm refers to the path generated by the improved a algorithm and then divides multi target points to form a sub target point sequence in the stage of the formation forming an algorithm based on the mtapf is proposed and the flow chart of the algorithm is shown in fig 9 when the algorithm starts to work the initial heading angle of each usv is first read leader follower approach is used to design the formation shape and one usv from the formation is selected to guide the motion of the formation the second step is to get the leader s target point position and calculate the follower s target points according to the formation parameters the mtapf is then applied to each usv to generate the appropriate trajectory based on the assigned target point path tracking control is executed by each usv until the target point is reached the trajectory tracking tasks will be performed after the trajectories are generated it is assumed that each usv has a trajectory tracking controller such that its individual path can be perfectly tracked without errors the assumption is reasonable and has been applied to formation path planning álvarez et al 2015 fig 10 gives the flow chart of the formation path planning algorithm which is developed based on the mtapf and uses a binary map step one define the usvs starting points and goal points and read the information of each usv because usvs have random initial heading angles and positions step two execute the formation shape forming algorithm step three once the formation shape is finished and each usv has arrived the starting point the improved a algorithm starts a global path planning algorithm to obtain an optimal path and sub target point sequence step four the mtapf algorithm starts a local formation path planning algorithm based on the dynamic constraints of the usv algorithm 1 is the mtapf algorithm in algorithm 1 m is the initialized map p s t a r t is the starting point and p g o a l is the target point for different usvs in the formation the starting point and the target point are different which facilitates the formation of the formation p l o c a t i o n is the current position point of each usv p h e a d i n g is the current heading of each usv and the path set is the set of various path points after the formation is formed the improved a global path planning algorithm is used to obtain a global path and the sub target points of the target path can be obtained by dividing the global path before reaching the final target point taking the sub target point as the current formation target point the mtapf algorithm is used to advance to reach the final target point algorithm 1 multiple sub target artificial potential field algorithm image 1 5 algorithm validations this section discusses and analyses the simulation results under two different environments the main indicators of the comparison results are arriving the target point the length of the path and time to complete the task real time the smoothness and continuity of the path when the formation is planned the planned path and trajectory tracking must meet the dynamic characteristics of the usv the obstacles are described in black color in all simulation results 5 1 formation path planning in a complex environment the formation path planning in a complex environment is shown in fig 11 when the apf algorithm is used for the local path planning the formation cannot refer to the path in fig 11 a the lengths of the path are long and the smoothness of the formation path is poor the global path planning based on the improved a algorithm is shown in fig 11 b and the blue path is the generated optimal path it can be clearly seen that the optimal path is relatively short and smooth the local path planning based on the mtapf is shown in fig 12 a which refers to the global planning path by using the improved a algorithm where the red line is the trajectory of the leader the blue line is that of the follower 1 and the green line is that of the follower 2 fig 12 b d give the total potential field the gravitational potential field and the repulsive potential field respectively it can be seen that the length of the formation path is short and the continuity and smoothness of the formation path are high when the improved a algorithm is used for the global path planning and the mtapf algorithm is used for the local path planning fig 13 gives the velocity and the heading curves of the leader the followers 1 and 2 in the formation the comparison results are given in table 3 the path length with the improved a algorithm is 30 2 less than that with the apf algorithm moreover the path with mtapf algorithm is reduced by a maximum of 8 1 compared with the apf algorithm n a means that no path planning is performed in table 3 a global optimal reference path can be obtained only once thus there is no need to perform plan planning again in the case of a long voyage the effect of the algorithm will be more obvious table 4 gives the information of each usv in this simulation 5 2 formation path planning in a narrow passage the formation marching in a narrow intricate environment is shown in fig 14 it can be seen from fig 14 a that the formation based on traditional apf cannot pass through the narrow passageway when the repulsive potential is greater than the gravitational potential the formation is trapped in the local space when the repulsive potential is equal to the gravitational potential in some field the formation will fall into a local minimum and stop marching thus the above mentioned problems must be considered when the formation performs tasks in a centralized control system when the leader in the formation falls into a local minimum or fails the entire formation will be paralyzed in this paper a hybrid control system is adopted which increases the robustness and reliability of the system fig 14 b gives the global planning path by using the improved a algorithm the mtapf algorithm path and potential field in narrow complex environment are show in fig 5 fig 15 a gives the local planning path based on the mtapf in a narrow complex environment which refers to the global planning path by using the improved a algorithm fig 15 b gives the formation paths in the total potential field the formation passes through the narrow passageway smoothly with continuous trajectory when forming the formation shape the position and the heading of each usv are randomly distributed after the formation the formation begins to march when constructing a local planning path the priority strategy is adopted to prevent collision fig 15 c d gives the gravitational potential field and the repulsive potential field respectively it can be seen from fig 15 d that the closer the usv is to the obstacle the greater the repulsion potential fig 16 gives the velocity and the heading curves of the leader the followers 1 and 2 in the formation the formation path lengths of usvs in a narrow environment under different algorithms are given in table 5 the apf algorithm cannot be used to reach the target point through a narrow passage the n a indicates that there is no path length and the path planning is not completed the formation can be carried out with the a and mtapf algorithms because the voyage is longer the path length is correspondingly longer table 6 gives the random configuration parameters of the usv formation the difference from table 4 is that the initial heading and position of each usv are random 6 conclusions and future works a new mtapf algorithm based on the improved apf was put forward and the formation path selection of the usv robustness and reliability in marching were analyzed in this paper the improved a algorithm was adopted to obtain the optimal path and the mtapf algorithm was used to carry out the local path planning which ensured the forming of the formation shape the maintenance of formation shape and the robustness and reliability of formation under the premise of satisfying the dynamic characteristics of the usvs the continuity and the smoothness of the path were assured when constructing a local planning path a priority strategy was used to prevent from colliding with each other a hybrid control system was adopted and the leader follower control strategy controls the formation collaboration of multiple usvs simulation results verified the effectiveness of the proposed algorithm in terms of the future work the proposed algorithms will be implemented on the practical usv platforms and the global and the local path planning controllers will be designed after the prototype is completed sea trials will be performed besides the practical vehicle is verified the dynamic environment need be deeply researched which includes various moving ships associated with different encounter situations in addition the dynamic environment can also refer to the varying environment that may be affected by ocean conditions such as currents and tides in the dynamic environment the path planning and collision avoidance strategies of the usv formation will be the main work in future credit authorship contribution statement hongqiang sang conceptualization data curation formal analysis funding acquisition yusong you investigation methodology formal analysis project administration validation visualization writing review editing xiujun sun formal analysis resources supervision funding acquisition ying zhou formal analysis software roles writing original draft fen liu formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by tianjin natural science foundation no 18jczdjc40100 major scientific and technological innovation projects of shandong province no 2019jzzy020701 the national key research and development plan of china no 2017yfc0305902 wenhai program of qingdao national laboratory for marine science and technology no 2017whzzb0101 and the program for innovative research team in university of tianjin no td13 5037 
21033,a computational fluid dynamics cfd based unsteady reynolds averaged navier stokes and volume of fluid model solver is adopted to estimate ship motion responses in bi directional cross waves the characteristics of cross waves are analyzed theoretically and by cfd verification at first then ship nonlinear motion responses and green water on deck induced by cross waves are systematically analyzed by adopting a s175 containership model sailing in different cross wave conditions such as various wave lengths wave heading angles and forward speeds finally ship safe navigational strategy is explored and corresponding operational guidance is proposed to ensure the safety of ships when encountering cross waves keywords ship hydrodynamics seakeeping multi directional wave cross sea cfd 1 introduction ship seakeeping performance has long been an important research topic in the field of naval architecture and ocean engineering almost all the existing numerical and experimental methods have focused on investigating ship motions in 2d uni directional regular or irregular waves real ships operate in ocean waves during their whole life period realistic ocean waves are however 3d short crested or multi directional with wave components propagating in different directions it is known that the directional spreading of wave has a significant influence on the loads and motions experienced by ship nwogu 1989 therefore an in depth understanding of ship motion behavior in multi directional waves is fundamental for accurate prediction of real ships motion behavior in realistic ocean waves the initial studies on irregular waves have considered single wave systems that are properly modelled by wave spectra however many sea states found at sea are more complex and they can be composed by one spectrum representing the local wind sea and a second one representing a swell system that is arriving from a storm generated a distance away this creates a double peak spectrum guedes soares 1984 which was shown to be relatively frequent at sea lucas et al 2011 the wave systems can come from the same direction but most often they come from different directions the influence of wave systems coming from different directions and having different directional spreading has been studied by teixeira and guedes soares 2009 who looked at the long term and extreme wave loads in those conditions and their influence to ship structural reliability when the wind or swell waves come from two orthogonal directions meeting in a common sea area then cross waves also called square waves will be generated this is a situation not much studied but which occurs in some cases as shown in fig 1 1 2 3 the cross waves may pose a threat to the navigational safety of passing ships for example ship may experience large amplitude roll pitch coupled motion and this will further result in green water on deck fonseca and guedes soares 2005 slamming event wang et al 2016 asymmetrical water entry wang and guedes soares 2013 and structural strength issues corak et al 2018 this paper focuses on investigating ship motion in the most classical and representative multi directional wave case i e in orthogonal cross waves this study also has practical application values in evaluating ship navigational safety when subject to cross seas and could provide some useful operational guidance for captains investigations of the hydrodynamic behavior of fixed marine structure interacting with multi directional wave can be found in some works xu et al 2019 investigated the wave loads on a vertically fixed cylinder in multi directional random wave by desingularized boundary integral equation method dbiem ji et al 2015 investigated the wave loads on an array of bottom mounted vertical cylinders in multi directional random wave both theoretically and experimentally song and tao 2007 investigated the general 3d short crested wave interaction with a concentric two cylinder system by potential flow theory wang 2006 studied the wave loads on a semicircular breakwater in 2d and 3d random waves both theoretically and experimentally the methods in the literature are not applicable for the estimation of ship motion since 3d radiation is not considered some existing publications have focused on investigating the motion behavior of ships or floating structures in short crested waves the majority of the related works were conducted by potential flow theory or model tests jiao et al 2019 investigated ship motions and loads in different short crested wave fields by 2d spectral analysis method in combination with frequency domain hydrodynamic theory and the influence of wave directionality on ship motion and load responses has also been systemically analyzed jiao et al 2018 conducted large scale model seakeeping measurements in coastal waves in order to obtain more realistic ship motion responses in short crested sea waves renaud et al 2008 studied the second order wave loads on an lng carrier in mono chromatic and bi chromatic cross waves by hydrostar software and tank model test zheng et al 2009 investigated the difference of ship motion responses in long crested and short crested irregular waves by 3d potential flow theory and tank model test till now different numerical methods have been developed in a large number of studies to predict wave induced ship motion responses in regular waves hirdaris et al 2014 2016 rajendran et al 2016 potential flow theory ranging from simple 2d strip theory salvesen et al 1970 to 3d panel method singh and sen 2007 also with different levels of nonlinearity taken into consideration has been widely used for several decades due to their obvious advantages such as high computational efficiency calculations in frequency domain are faster and are useful in providing preliminary insights in the early design of ships cakici and aydin 2014 a ship in rough weather is subjected to various nonlinearities due to large amplitude motion and complex body geometry which requires investigations in time domain to model them accurately sen 2002 guedes soares et al 2008 watanabe and guedes soares 1999 conducted a benchmark study by comparing different nonlinear time domain codes for evaluating wave induced vertical bending moments of ships some complex flow physics and phenomena such as flow separation fluid splash and viscous effects cannot be reproduced in the framework of potential flow theory with the development of computer science and technology computational fluid dynamics cfd methods making use of reynolds averaged navier stokes rans equations are becoming increasingly popular and mature which has the potential of assisting in ship design and evaluation some strongly nonlinear issues that caused by high forward speed large amplitude motions and violent free surface flow can be well addressed by cfd method deng et al 2019 investigated added resistance and motion response of a trimaran in head regular waves based on rans method javanmardi et al 2008 developed a cfd code to investigate the hydrodynamic resistance and maneuvering of a trimaran with wigley body form in the conditions of different outrigger positions bhushan et al 2009 conducted model and full scale unsteady rans simulations of ship resistance powering seakeeping and maneuvering islam and guedes soares 2019 studied the effect of trim on container ship resistance at different ship speeds and drafts a cfd technique has turned out to be reliable in simulating wave induced ship motions in uni directional wave tezdogan et al 2016 although tremendous advances have been made in the cfd simulations of ship motion responses in uni directional wave investigations of ship motion in multi directional wave that simulated by cfd are rarely seen methods of multi directional wave simulation by cfd tools have been reported by some researchers wang et al 2018a simulated directional irregular waves by open source cfd wave model reef3d park et al 2004 reproduced fully nonlinear multi directional waves by use of a viscous 3d numerical wave tank simulation technique and calculated the hydrodynamic forces on an advancing ship cao and wan 2014 developed a three dimensional multi directional nonlinear numerical wave tank by using the two phase hydrodynamic flow solver naoe foam sjtu which was in house developed based on the open source toolbox openfoam wang et al 2018b calculated the wave forces on a fixed cylinder in a multi directional irregular wave field by the cfd model reef3d cfd technique has shown good performance in the simulation of 3d complex sea states which provides opportunity for the simulation of ship motions in complex sea states this study conducts a comprehensive cfd numerical simulation of ship motion in cross waves this paper is organized in a following way in the next section section 2 the cfd based basic governing equations and the established numerical model and method are reported in section 3 the involved research conditions are determined and described in section 4 characteristics of cross wave are systematically analyzed by theoretical deduction and cfd simulation the motion response behaviors of a s175 ship model in different cross wave conditions are systemically investigated in section 5 the safe operational guidance of ship when encountering cross wave is investigated and proposed in section 6 main conclusions obtained from this study are summarized in section 7 2 numerical model setup 2 1 ship model description a standard ship model of s175 containership is used for investigation in this study numerical modeling and calculation are conducted in model scale with a scale ratio of 1 40 which was determined to be in accordance with the cfd numerical or tank physical model of s175 containership used in a large number of references e g lakshmynarayanana and temarel 2020 datta and guedes soares 2020 fonseca and guedes soares 2004a fonseca and guedes soares 2004b the body plan of the s175 hull is shown in fig 2 main particulars of the ship and model are listed in table 1 where lcg denotes longitudinal center of gravity vcg denotes vertical center of gravity ap denotes after perpendicular bl denotes baseline the longitudinal mass distribution of the model which was determined to satisfy the displacement longitudinal floating state and radius of gyration of the ship is shown in fig 3 in the figure x 0 coincides with after perpendicular and x l coincides with forward perpendicular 2 2 basic governing equations the numerical simulations are conducted using finite volume method fvm based cfd technique the fluid is assumed to be 3d incompressible and viscous the governing equations for the continuity condition and momentum conservation condition are respectively expressed as follows 1 u i x i 0 2 ρ u i t ρ x j u i u j p x i x j μ u i x j ρ u i u j ρ g i where u i and u j i j 1 2 3 are the time mean value of velocity x i and x j i j 1 2 3 are spatial coordinate component ρ is fluid density p is mean pressure μ is kinematic viscosity coefficient ρ u i u j is reynolds stress and g i is gravitational acceleration in the i th direction unsteady reynolds averaged navier stokes urans method is used to solve the turbulent flow a realizable k ε eddy viscosity model with two layer all y wall function is selected in this work 3 ρ k t ρ k u i x i x j μ u t σ k k x j g k ρ ε 4 ρ ε t ρ ε u i x i x j μ u t σ ε ε x j ρ c 1 e ε ρ c 2 ε 2 k ν ε where the coefficients c 1 and c 2 represent functions of average flow and turbulence properties the reynolds stresses can be calculated using the well known boussinesq s isotropic eddy viscosity hypothesis 5 ρ u i u j μ t u i x j u j x i 2 3 ρ k δ i j where the eddy viscosity μ t is expressed as follows 6 μ t ρ c μ k 2 ε where c μ is a dimensionless constant the volume of fluid vof model is used to model the free surface interactions of water and air the volume of fraction is governed by the following equation 7 α t u i α x i 0 where u i is the fluid velocity α is the fraction of fluid in each cell when α 1 the cell is filled with water when α 0 the cell is filled with air and when α 0 5 represents the cell is filled with 50 water and 50 air 2 3 numerical method and details the flow around the model hull is simulated by rans based cfd code star ccm which enables three dimensional vof model simulations to capture the free surface between air and water the motion of the ship in waves is an unsteady process compared with large eddy simulation les and direct numerical simulation dns the unsteady rans method provides a good compromise between robustness computational cost and accuracy in order to simulate ship motions in multi directional wave a cuboid numerical wave tank was established with a dimension of 22 m long by 20 m wide by 15 m deep 10 m water and 5 m air the extension of the fluid domain with respect to the ship model are approximately 2 3l x 2 7l 2 3l y 2 3l 2 3l z 1 1l for length width and depth respectively the dimensions were conservatively determined to be greater than the recommendations of ittc 2011 so as to achieve better simulation results the origin of the coordinate system coincides with the intersection point of the after perpendicular waterline plane and symmetrical plane of ship the positive x axis points to ship bow y axis points to port side and z axis points to the sky the general view of the fluid domain including the model hull and the notations of boundary conditions is shown in fig 4 in order to realize the generation and propagation of waves from any arbitrary direction the boundary conditions are set as described in the following the velocity inlet is applied at the four sidewalls of the fluid domain so as to ensure that the fluid velocity on these boundaries is in accordance with the specified velocity of the cross waves a velocity inlet is also applied at the bottom of the fluid domain so as to define the wave fluid velocity on the bottom boundary a pressure outlet is applied at the top boundary which presents static pressure in the sky no slip wall was applied at the body surface a momentum source term is adopted for the generation of multi directional waves wave reflection can be eliminated by forcing the wave profile in the wave forcing region of the tank it is noted that no symmetry plane is adopted due to the asymmetry of incident wave and ship motions this would therefore increase the computational burden mesh generation was performed using the built in automated meshing toolbox of star ccm for the case of λ l 1 the flow domain is discretized by a mesh with approximately 4 million cells in total which includes 3 5 million cells in the background region and 0 5 million in the overset region trimmed hexahedral meshes are used for volume grid generation as shown in fig 5 the overset mesh approach which creates two different regions i e background region and overset region is adopted to simulate ship motion in waves the overset region has a dimension of 5 1 m long 1 2 m wide and 0 9 m high a prism layer was used to generate the boundary layer grid around the no slip body surface a boundary layer mesh of 5 cells near the hull is selected y value lies in 30 60 the meshes on the hull surface viewed from the side and bottom are shown in fig 6 the sensitivity analysis of the influence of mesh number and time step on the simulation results has been conducted in the recent work of huang et al 2020a in this study cross waves are obtained by the superposition of two orthogonal regular waves linear airy non breaking waves are used to simulate the component regular waves in order to avoid pronounced wave decay during their propagating procedure due to numerical dissipation local mesh refinement is applied around the free surface as a compromise between calculation accuracy and efficiency according to the recommendations of ittc 2011 a minimum of 40 cells per wave length and 16 cells per wave height is sufficient to produce a stable wave without obvious wave attenuation a number of 80 cells per wave length is preferable for the case of λ l 1 0 in this study the horizontal range of every regular wave length includes 75 cell layers for the case of λ l 1 0 and 45 150 cell layers was provided for wave length ranging from λ l 0 6 to 2 0 proportionally at least 16 cell layers are contained within the vertical range of wave height fig 7 shows the local view of refined mesh around the free surface of cross waves at the xoz vertical cross section the longitudinal centerline plane y 0 for the case of λ l 1 0 and h λ 0 0274 with the help of the established numerical wave tank and boundary conditions selected component regular waves are able to be generated from any specified direction by using one or two sidewall boundaries for example if the regular wave s propagation direction is parallel with coordinate axis ox or oy only one boundary is used for wave generation if the regular wave s propagation direction is not parallel with coordinate axis the adjacent two boundaries are used for wave generation for the generation of multi directional wave a boundary can be separately used more than once for the configuration of each component wave momentum source term method is adopted to generate multi directional cross waves cd adapco 2019 li et al 2018 the wave force is obtained by introducing a source term into the momentum equation which is expressed as follows 8 q ϕ γ ρ ϕ ϕ where q φ denotes the source term γ denotes forcing factor ρ denotes fluid density φ is the current solution of momentum equation φ is the target solution of momentum equation determined by specified wave shape as seen in fig 8 a the flow domain of wave field is divided into the inner domain and outer domain the wave forcing region the outer domain is defined within the area of 1 2l distance from the four sides of outer boundary a momentum source term is added into the momentum equation i e navier stokes equation within the wave forcing region to formulate the wave pattern and prevent wave reflection the forcing factor γ increases from 0 at the inner outer domain boundary lines to its maximum value of 10 at the outer boundaries of flow domain fig 8b shows the relative distance from the inner navier stokes equations region in the figure the blue region is the inner navier stokes equation region and the gradient region is the outer wave forcing region the realizable k ε two equation turbulence model with near wall function to describe the velocity profile near the wall is used in the numerical simulations the convective terms are discretized using the second order upwind scheme the diffusion terms utilize the central difference scheme the pressure and velocity coupling problem is solved by using the semi implicit method for pressure linked equations simple algorithm the temporal discretization is the second order discretization scheme a high resolution interface capturing hric scheme to compute the evolution of free surface by solving equation for volume fraction of liquid is employed the overset grid and motion region techniques are applied to simulate the motions of the ship in waves a rigid body motion with dynamic fluid body interaction dfbi model is used with 3 dof released to simulate ship heave roll and pitch in waves the dfbi module enabled the rans solver to calculate the wave induced forces acting on the ship hull and to solve the governing equations of rigid body motion in order to reposition the rigid body the established numerical wave tank provides a wide range of applications for the investigation of ship seakeeping in both uni and multi directional waves in a previous work huang et al 2020b the developed cfd algorithm for ship seakeeping prediction has been well validated by comparing with the existing experimental data of ship motions in head regular waves presented by fonseca and guedes soares 2004a however due to lack of experimental data of ship motions in cross waves this paper only provides a preliminary numerical investigation of ship seakeeping performance in cross waves it is worth mentioning that comparative study of ship motions in cross waves and uni directional regular wave has also been conducted in huang et al 2020b 3 research scheme and simulation conditions the cross waves can be described by their two component regular waves in this study the frequency and amplitude of the two component regular waves are assumed to be identical and they are coming from two orthogonal directions in deep water in order to investigate ship motion response in harsh wave conditions the wave height of component regular wave is set at 120 mm full scale 4 8 m wave length to ship length ratio λ l 1 0 is selected for the majority of the cases to obtain ship violent response at or near its resonance frequency ship forward speeds with froude numbers fn 0 and 0 25 are involved for investigation the typical numerical simulation conditions involved in this study are listed in table 2 definition of the heading angle of ship with respect to incident wave is illustrated in fig 9 it is noted that the plane coordinate origin 0 0 is used as a representative point to describe the equation of wave elevation including the initial phase and then the wave elevation at any other locations can be determined cases 1 8 aim to investigate ship motion responses at different wave lengths to ship length ratio λ l 0 6 2 0 when sailing along the route for the harshest wave condition case 9 aims to provide a comparative study on the effect of forward speed on ship motion responses cases 10 13 aim to investigate the influence of wave heading angle on ship motions fig 10 illustrates the initialized cross waves with respect to the ship model for different wave heading cases it is worth mentioning that in the cfd simulations the course angle of the ship with respect to the coordinate system remains unchanged while different wave propagation directions are configured to realize ship wave interaction with different wave headings cases 14 and 15 aim to investigate ship motion response when sailing along the stagnation line and they provide useful operational guidance for ship navigational safety in cross waves in section 6 although the course angle of the ship in cases 14 and 15 is the same as in cases 1 8 the ship will experience the lowest wave elevation when sailing along these two routes since the wave elevation on the centerline of the ship remains zero time step of 0 005 s was set in the numerical simulation procedure which was determined by ensuring the courant friedrichs lewy cfl condition is met the cfd numerical simulations are performed in a single node intel r core i 9 cpu with 18 cores clock speed of 3 0 ghz and 64 gb of physical memory all simulations are run at least 16 s for attaining stable results of ship motion responses in cross waves the required physical time for each simulation condition is roughly 3 days 4 characteristics of cross waves in this section the space and time distributional characteristics of cross waves are theoretically analyzed at first then the monitored wave elevation encountered by ship from cfd simulation are presented and analyzed 4 1 distribution of wave elevation in this study linear airy wave is used for the formulation of the component regular waves the spatial and temporal distribution of wave elevation of mono chromatic cross waves can be directly obtained by linear superposition of its two component regular waves a general formula for the description of the wave elevation of cross wave can be expressed as 9 ζ x y t a cos k x ω t ε 1 a cos k y ω t ε 2 a cos k x ε 1 cos k y ε 2 cos ω t a sin k x ε 1 sin k y ε 2 sin ω t where ζ denotes the spatial wave elevation x and y denote the spatial plane coordinates t denotes time a denotes amplitude of component regular wave k denotes wave number ω denotes frequency ε 1 and ε 2 denote the initial phase of the two component waves for the investigation of wave elevation at any specific point p x y in space eq 9 can be re written in the following format by applying trigonometric function s operation 10 ζ a 2 b 2 sin ω t c where the coefficients a b and c are respectively determined by 11 a a cos k x ε 1 cos k y ε 2 12 b a sin k x ε 1 sin k y ε 2 13 c arctan a b as can be concluded from the above analysis it is clear that the wave elevation at any specific point within the wave field follows a sine function the frequency of the resultant cross waves is identical to the frequency of component regular wave however the amplitude of the resultant wave differs from 0 to 2a for different spatial locations this means that in the cross waves field there exist stagnation points where the wave elevation remains zero and time invariant moreover all the stagnation points that are located at a same horizontal straight line on the free surface compose the stagnation line the maximum wave amplitude within the cross wave field is 2a when considering the forward speed of ship the wave encountered by the ship could be quite different from the in situ observation result the encounter frequency of the component regular waves can be calculated by 14 ω e ω 1 u ω cos β g where ω e denotes wave encounter frequency u denotes ship speed β denotes wave heading angle g denotes acceleration of gravity two typical classifications of ship encounter cross waves are summarized as follows i ship encounter waves are generally non sinusoidal since the encounter frequencies of the two component waves are usually different which would result in bi chromatic behavior of the resultant cross waves in this condition the largest crest or trough value of the encounter waves is constant 2a regardless of ship navigational route but the exact free surface pattern of encounter waves is determined by the ship navigational route i e both course angle and initial position ii when the ship course is symmetrical with respect to the two component waves i e the case of wave heading 45 45 or 135 135 the encounter waves are mono chromatic and sinusoidal since the encounter frequencies of the two component waves are identical in this condition the amplitude of encounter wave differs within the range of 0 2a which is determined by ship s initial spatial position or initial phase difference of waves thus the ship may be subjected to the largest or lowest motion responses in this condition this will be further investigated in section 6 for the operational guidance of safe navigation of ship in cross waves 4 2 analysis of encounter waves in the cfd numerical wave tank an array of wave gauges is arranged around the hull to monitor the free surface elevation top view of the positions of the adopted seven wave gauges with respect to the hull is shown in fig 11 their spatial coordinate positions are gauge 1 5 1 0 gauge 2 5 1 4 gauge 3 5 1 4 gauge 4 2 1875 4 gauge 5 2 1875 4 gauge 6 0 4 gauge 7 0 4 in unit meter it should be noted that in the cfd simulation the wave field has a translation speed with respect to the earth to achieve a reversed ship forward speed thus the wave gauges have a same forward speed with the ship in other words the wave gauges can be regarded as the wave probes installed on carriage to measure encounter waves in tank model tests the encounter waves for ship sailing at different wave headings i e resultant wave headings 0 45 90 135 and 180 is shown in fig 12 the cases for wave length λ l 1 0 and forward speed fn 0 25 are selected for illustration fig 12a shows the time series of the encounter waves in the cases 4 10 11 12 and 13 monitored by the wave gauge 1 ahead of ship bow the label monitored denotes the cfd simulated wave elevation with the effects of wave diffraction and wave making interference caused by the advancing hull the label theoretical denotes the theory value of wave elevation by simple trigonometric function calculation in addition the corresponding frequency domain results obtained by fast fourier transform fft using the time series data are shown in fig 12b as seen from the wave results both the time series and frequency spectral results of the monitored waves show good agreement with the theoretical value which confirms the capability of the developed cfd wave simulation technique the monitored value is slightly higher than the theoretical value especially at the crest and trough peaks the difference is mainly caused by the superposition of diffraction waves ship generated steady waves and radiation waves generally the wave making interference caused by the advancing ship on the incident wave pattern is small since the distance between the ship and wave gauge is long and the wave gauges are positioned in front or at side of the ship rather than in the wake area the time series of the monitored waves also reveals nonlinear behavior such as sharp crest and flat trough due to the relatively large steepness the wave spectra in the cases of wave heading 45 45 and 135 135 are mono peaked since the encounter frequencies of the two component waves are identical however the wave spectra in the remaining three cases are double peaked since the encounter frequencies of the two component waves are not identical a comparison of the encounter frequency of component waves that are obtained by eq 14 against the spectral peak frequency in fig 12 for each case is summarized in table 3 the results indicate that the peak frequency coincides well with the encounter frequency of component wave with largest difference below 5 the time series of wave elevation monitored by different gauges for typical cases 4 10 11 12 and 13 are shown in fig 13 for the cases 4 or 13 the encounter waves monitored by all the seven gauges show sinusoidal pattern with the same frequency while with different amplitude and phase however for the cases 10 11 and 12 the encounter waves show bi chromatic behavior but their largest crest or trough peak values are constant 2a where 2a 120 mm to summarize the numerical simulation results of waves show good agreement with the conclusion by theoretical analysis fig 14 shows the monitored and theoretical wave elevations at gauge 1 for different wave length cases the cases 1 8 the results indicate that the simulated waves show good agreement with the theory value the simulated or monitored wave heights for λ l 0 6 2 0 are identical without pronounced decaying during propagation this therefore would provide reliable wave environment parameter for the subsequent analyses of ship motions 5 ship motions in cross waves in this section ship motion responses in cross waves are systematically analyzed as concluded from the above analysis the cross waves encountered by the ship are symmetrical in the cases 1 9 thus ship motion responses in these conditions are first analyzed due to their regularity and simplicity then ship asymmetrical motion responses in the cases 10 13 are further analyzed to investigate ship motions in different wave headings 5 1 ship motions induced by symmetrical cross waves 5 1 1 influence of wave length a comprehensive comparison of the cfd simulated time series of ship motions induced by symmetrical cross wave wave heading 45 45 with different wave length λ l 0 6 2 0 at ship speed fn 0 25 cases 1 8 is shown in fig 15 the results confirmed that ship heave and pitch motions induced by symmetrical incident waves are regular and sinusoidal for all the wave length cases while the response amplitude differs significantly for different wave length cases the small disturbance of roll may be caused by the cfd numerical error which was introduced during geometric modeling and mesh generation it is noted that an obvious roll event occurred in the case λ l 1 1 around 9 5 s since the cfd simulation time is not long enough in this study the obvious rolling phenomenon occurred in this case will be studied in our further studies to obtain more insightful conclusions the response amplitude operators raos of heave and pitch motions with varying wave length λ l 0 6 2 0 for the wave heading 45 45 at speed fn 0 25 are summarized in fig 16 as is seen from the results the non dimensional amplitude value of heave increases rapidly from λ l 0 6 to 1 0 the largest heave response occurs at λ l 1 1 the heave amplitude appears to be constant with a same value of the resultant wave amplitude 2a for λ l at or greater than 1 5 the largest pitch amplitude occurred at λ l 1 2 which can be explained by the following reason although the effective wave length 2λ 1 697l for ship sailing at wave heading 45 45 is much greater than the resonance wave length approximately ship length l the forward speed largely increases the wave encounter frequency 4 809 rad s and makes it approaching the pitch resonance frequency 4 684 rad s which was obtained from pitch rao in regular wave it is noted that both the crest and trough peaks of time series of ship motion are presented to show the nonlinearity of motion response the difference between peak values of crest and trough for heave is small however the ship experienced obvious trim by bow motion which results in larger crest and lower trough for pitch peak the reason may be twofold i the green water on bow deck affects the floating state of ship ii the forward speed geometric asymmetry of bow and stern and nonlinear dynamic effects contribute to the asymmetry of crest and trough of pitch visual observations of ship motion in the case 5 λ l 1 1 by cfd simulation are shown in fig 17 fig 17a shows the static ship at mean position and the initialized wave pattern at initial time t 0 1 s fig 17b f shows ship large amplitude vertical motion and the corresponding severe slamming and green water on deck event within one wave encounter period the results indicate that there exist significant amount of green water on the full deck during the whole navigational procedure fig 18 shows the free surface elevation and pressure distribution on the wetted hull surface in the case 6 λ l 1 2 where the largest pitch occurred it is evident from the snapshot that the whole bulbous bow emerged with some water attached on the broadsides at t 5 4 s then severe slamming event occurred at t 6 0 s due to large bow down motion when the ship was in a sagging state which also resulted in harsh green water on deck subsequently the largest pressure about 6 3 kpa occurring at the front bulbous bow is much greater than the largest pressure about 3 2 kpa occurring at the keel of stern the graphic results also reveal that the breaking waves and violent free surface flow phenomenon have been successfully captured by the developed cfd model 5 1 2 influence of forward speed a comparison of the time series of ship vertical motions with and without forward speed for fn 0 25 and 0 is shown in fig 19 the results show that the forward speed significantly contributes to the heave amplitude this is because that large amplitude heave motion will occur when the encounter frequency is at or near the resonance frequency however the pitch amplitudes for the two cases are comparable but the vertical acceleration for ship with forward speed is much greater than the zero forward speed case due to the higher encounter frequency therefore the forward speed largely increases the severity of green water and slamming event visual observations of ship motion and green water for the two cases by cfd simulation are comparatively shown in fig 20 no green water on deck occurred in the zero forward speed case 5 2 ship motions in different wave headings 5 2 1 the time series the calculated time series of ship motions i e heave pitch and roll in different wave headings with constant wave length λ l 1 0 at speed fn 0 25 are summarized in fig 21 as seen from the results symmetrical motion responses of ship are obtained in the cases of wave heading 45 45 and 135 135 in these cases the heave and pitch signals are nearly sinusoidal while the roll signal is ignorable and nearly zero this is because the two component incident waves are symmetrical with respect to the ship s centerline and the encounter wave at centerline of ship is regular and sinusoidal however ship motions induced by asymmetrical cross waves in the cases of wave heading 0 90 45 135 and 90 180 reveal obvious irregularity this is because the two component incident waves are asymmetrical with respect to the ship s centerline and the encounter wave at centerline of ship includes two components with different frequencies and they are individually induced by the two component waves in other words both the 0 head component wave and the 90 beam component wave obviously contribute to the ship total heave response the pitch motion is relatively regular since the 90 beam component wave has very little effect on pitch response and the pitch response is therefore mainly induced by the 0 head component wave the ship experienced a very large roll motion approximately 16 deg due to the effect of the 90 beam component waves in the case of wave heading 45 135 both the heave and pitch time series show obvious bi chromatic characteristics because both the two component waves i e the 45 bow quarter component wave and the 135 stern quarter component wave significantly contribute to ship heave or pitch motion the ship initially encountered large amplitude roll motion event afterwards the roll motion tends to be small but at the end of the curve the roll value increased again longer simulation time will be performed in a future work to better understand ship roll motion behavior in asymmetric cross waves in the case of wave heading 90 180 the pitch signal induced by the 90 beam component wave is ignorable small the contribution of the 180 following component wave to the total pitch response is also small since the encounter wave period is relatively large and far from the resonant frequency of ship pitch 5 2 2 statistics and frequency domain results polar plots of the maximum response amplitude labeled as max and root mean square labeled as rms value derived from the time series data for ship motions in different resultant wave headings are summarized in fig 22 note that the angle denotes the resultant wave heading of the two component waves as seen from the results the largest and lowest heave response occurred in the case of resultant head wave 45 45 and resultant following wave 135 135 respectively the largest and lowest pitch response occurred in the case of resultant head wave 45 45 and resultant stern oblique wave 90 180 respectively the largest and lowest roll response occurred in the case of resultant beam wave 45 135 and resultant head or following wave 45 45 or 135 135 respectively the fft is applied to the time series data of ship motions to obtain the corresponding frequency domain information the obtained frequency domain spectra of ship motions which correspond to different wave heading cases are shown in fig 23 the ordinate denotes response amplitude of ship motion the vertical red line in the figure denotes encounter frequency of each component regular wave note that for the roll motion the encounter frequency corresponds to transverse value rather than longitudinal value the peak frequency can be also estimated by eq 14 for the motion spectra it is clear that the response components concentrate around the peaks which correspond to the encounter frequency of the component waves the heave component induced by the following component waves is very small since the wave encounter period is very long the pitch component induced by beam component wave is very small the responses mainly concentrate around their encounter frequency and they are less depended on the natural frequency of ship motion 5 2 3 visual observation of ship wave interaction comparison of the phenomenon of green water on deck for the ship sailing at different wave headings is shown in fig 24 it is seen that the severest green water event occurs when the ship sails at a wave heading 45 45 moderate green water occurs which is mainly due to large roll motion when the ship sailed at a wave heading 45 135 only very slight green water or called deck wetness occurred when the ship sailed at wave heading 0 90 and 135 135 no green water occurred when the ship sailed at wave heading 90 180 due to the small pitch motion the roll stability of ship in cross waves is another reason of concern in addition to the large amplitude vertical motions the largest roll value approached 17 4 in the case of wave heading 45 135 movement details of ship large amplitude roll pitch coupled motion and the resulting green water on deck in this case is depicted in fig 25 the slamming event induced by asymmetrical water entry of bow occurs when the ship is in a state of large roll and pitch simultaneously the green water overtops onto the deck from the port side and the water flows out from the starboard side during the rolling procedure the slamming and green water events in the case of wave heading 45 135 are much milder compared with those in the case of wave heading 45 45 due to the large roll period compared with pitch period 6 safe navigational strategy of ship in cross waves according to the above analysis the ship will probably encounter large amplitude vertical or transverse motion when sailing in cross waves the cross waves will pose a threat to the navigational safety of ship therefore it is of great importance to provide some wise strategy for the operational guidance of ship when operating in cross waves as concluded from section 4 1 in the cross waves field there exist stagnation lines where the wave elevation remains zero and time invariant the ship will experience the lowest wave if it travels along the stagnation lines with this in mind the motions of ship sailing along the stagnation line are investigated in this section fig 26 shows the three different navigational routes selected in the comparative study route 1 corresponds to ship navigational line along the largest wave crest and trough at a wave heading of 45 45 case 4 which has been investigated in section 5 1 and it is aimed to be used as a reference here routes 2 and 3 correspond to ship navigational line along the stagnation line at a wave heading of 45 45 case 14 and 135 135 case 15 respectively note that the ship navigational direction for routes 2 and 3 is opposite it is also noteworthy that in the wave field there exist both ox directional and oy directional stagnation lines the ox directional stagnation lines are steady and they move with a speed of the wave group speed gλ 8π 0 which coincides with ship speed direction however the oy directional stagnation lines are not steady since the transverse speed of their component stagnation points are different therefore only the ox directional stagnation lines are involved for investigation 6 1 comparison of ship motions fig 27 shows a comparison of the time series of ship motion in the three different navigational routes in addition the corresponding maximum response amplitude value labeled as max and root mean square labeled as rms of the time series are summarized and compared in fig 28 the results indicate that the heave and pitch motions for ship sailing in routes 2 and 3 are almost ignorable which are much smaller compared with those in route 1 although the vertical motions of the ship in route 3 are small the roll motion in route 3 is quite obvious with its largest value approaching 19 which would pose a threat to the rolling stability of ship the roll motion in route 3 is much larger than in route 2 which can be explained by the fact that larger roll motion will occur when the encounter frequency is near the natural frequency of roll fig 29 shows the large amplitude roll event of ship sailing along the route 3 at t 4 0 s 6 2 comparison of fluid forces on ship as concluded from the above analysis it is clear that the ship is recommended to travel along route 2 at a relatively high speed and then sail away from the area of cross wave so as to achieve the safest navigational strategy when subjected to cross waves however it should be noted that the ship will experience transverse forces due to the asymmetric distribution of free surface elevation and fluid pressure on the port and starboard sides of the ship when sailing along routes 2 and 3 the ship should resist the transverse force so as to be able to sail along the stagnation line exactly the monitored sailing longitudinal resistance transverse force and yaw moment of ship in the three routes are summarized in fig 30 which is useful for the preliminary evaluation of ship propulsion and maneuverability system fig 31 shows a comparison of the pressure distribution on ship hull bottom for different routes the time when largest longitudinal force occurs is selected for illustration for route 1 the time when largest transverse force occurs is selected for illustration for routes 2 and 3 as can be seen from the insert in fig 30a ship sailing resistances in routes 2 and 3 are comparable and oscillate around a mean value of roughly 20 n however the ship sailing resistance in route 1 is much greater and it oscillates with large amplitude due to the added resistance caused by harsh wave the instantaneous lowest resistance is below zero since the fluid particle does elliptical motion and the fluid at wave trough has a same speed direction as the ship forward speed longitudinal impulse force can be identified from the resistance signal of route 1 due to the effect of bow slamming and green water loads as seen from fig 30b and c the ship transverse force in route 1 is almost negligible due to the asymmetric distribution of fluid pressure on the port and starboard sides of ship however for route 2 and 3 the ship should endure significant transverse force and yaw moment so as to be able to sail along the stagnation line exactly the amplitudes of transverse force or moment for ship in routes 2 and 3 are comparable but the frequency for route 2 is much greater the transverse force and moment can be resisted by proper operation of rudder and side thruster of ship which is beyond the scope of the present paper and can be further investigated from the aspect of ship propulsion and maneuverability in future work moreover since this paper focuses on ship large amplitude motions in very harsh wave condition λ l 1 0 and h l 0 055 the obtained transverse force and moment are quite large in fact for ship sailing in a mild or moderate cross wave the transverse force and moment will be much lower this provides opportunities for ship resisting the transverse force by using rudder and bow and stern thrusters 7 conclusions this paper originally investigates ship motion behavior in bi directional cross waves by cfd tool some useful insight and guidance for the safety operation of ship when encountering cross seas are also provided main conclusions drawn in this study are as follows 1 the in situ monitored wave elevation within a cross wave field follows a mono chromatic sine function the frequency of the resultant waves is the same as the component regular waves but their amplitude differs for different locations when considering ship forward speed the ship encounter waves may be bi chromatic and more complex 2 when the ship experiences a symmetrical cross wave wave induced ship vertical responses are sinusoidal and the roll motion remains zero the forward speed significantly increases the heave amplitude and vertical acceleration when ship sails at wave heading 45 45 the forward speed also largely increases the severity of green water and slamming events the largest heave or pitch response occurs around λ l 1 1 1 2 with forward speed fn 0 25 3 when the ship experiences asymmetrical cross waves ship motion responses would be bi chromatic and can be considered as the superposition of motions induced by two component regular waves the response components concentrate around the encounter frequency of component waves the responses mainly concentrate around their encounter frequencies and they are less depended on the natural frequencies of ship motion 4 when a ship experiencing cross waves it is recommended to travel along the stagnation line with wave heading 45 45 at a relatively high speed and then sail away from the area of cross wave however the ship may resist significant transverse force and yaw moment to be able to sail along the stagnation line exactly and this can be further investigated from the aspects of ship propulsion and maneuverability credit authorship contribution statement jialong jiao conceptualization methodology validation formal analysis investigation resources writing original draft writing review editing visualization project administration songxing huang methodology software validation formal analysis investigation data curation visualization carlos guedes soares resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation of china no 51909096 the pre research field foundation of equipment development department of china no 61402070106 and the guangdong basic and applied basic research foundation no 2020a1515011181 the first author would also like to thank the china scholarship council csc for the financial support of his one year visit to centec at the university of lisbon 
21033,a computational fluid dynamics cfd based unsteady reynolds averaged navier stokes and volume of fluid model solver is adopted to estimate ship motion responses in bi directional cross waves the characteristics of cross waves are analyzed theoretically and by cfd verification at first then ship nonlinear motion responses and green water on deck induced by cross waves are systematically analyzed by adopting a s175 containership model sailing in different cross wave conditions such as various wave lengths wave heading angles and forward speeds finally ship safe navigational strategy is explored and corresponding operational guidance is proposed to ensure the safety of ships when encountering cross waves keywords ship hydrodynamics seakeeping multi directional wave cross sea cfd 1 introduction ship seakeeping performance has long been an important research topic in the field of naval architecture and ocean engineering almost all the existing numerical and experimental methods have focused on investigating ship motions in 2d uni directional regular or irregular waves real ships operate in ocean waves during their whole life period realistic ocean waves are however 3d short crested or multi directional with wave components propagating in different directions it is known that the directional spreading of wave has a significant influence on the loads and motions experienced by ship nwogu 1989 therefore an in depth understanding of ship motion behavior in multi directional waves is fundamental for accurate prediction of real ships motion behavior in realistic ocean waves the initial studies on irregular waves have considered single wave systems that are properly modelled by wave spectra however many sea states found at sea are more complex and they can be composed by one spectrum representing the local wind sea and a second one representing a swell system that is arriving from a storm generated a distance away this creates a double peak spectrum guedes soares 1984 which was shown to be relatively frequent at sea lucas et al 2011 the wave systems can come from the same direction but most often they come from different directions the influence of wave systems coming from different directions and having different directional spreading has been studied by teixeira and guedes soares 2009 who looked at the long term and extreme wave loads in those conditions and their influence to ship structural reliability when the wind or swell waves come from two orthogonal directions meeting in a common sea area then cross waves also called square waves will be generated this is a situation not much studied but which occurs in some cases as shown in fig 1 1 2 3 the cross waves may pose a threat to the navigational safety of passing ships for example ship may experience large amplitude roll pitch coupled motion and this will further result in green water on deck fonseca and guedes soares 2005 slamming event wang et al 2016 asymmetrical water entry wang and guedes soares 2013 and structural strength issues corak et al 2018 this paper focuses on investigating ship motion in the most classical and representative multi directional wave case i e in orthogonal cross waves this study also has practical application values in evaluating ship navigational safety when subject to cross seas and could provide some useful operational guidance for captains investigations of the hydrodynamic behavior of fixed marine structure interacting with multi directional wave can be found in some works xu et al 2019 investigated the wave loads on a vertically fixed cylinder in multi directional random wave by desingularized boundary integral equation method dbiem ji et al 2015 investigated the wave loads on an array of bottom mounted vertical cylinders in multi directional random wave both theoretically and experimentally song and tao 2007 investigated the general 3d short crested wave interaction with a concentric two cylinder system by potential flow theory wang 2006 studied the wave loads on a semicircular breakwater in 2d and 3d random waves both theoretically and experimentally the methods in the literature are not applicable for the estimation of ship motion since 3d radiation is not considered some existing publications have focused on investigating the motion behavior of ships or floating structures in short crested waves the majority of the related works were conducted by potential flow theory or model tests jiao et al 2019 investigated ship motions and loads in different short crested wave fields by 2d spectral analysis method in combination with frequency domain hydrodynamic theory and the influence of wave directionality on ship motion and load responses has also been systemically analyzed jiao et al 2018 conducted large scale model seakeeping measurements in coastal waves in order to obtain more realistic ship motion responses in short crested sea waves renaud et al 2008 studied the second order wave loads on an lng carrier in mono chromatic and bi chromatic cross waves by hydrostar software and tank model test zheng et al 2009 investigated the difference of ship motion responses in long crested and short crested irregular waves by 3d potential flow theory and tank model test till now different numerical methods have been developed in a large number of studies to predict wave induced ship motion responses in regular waves hirdaris et al 2014 2016 rajendran et al 2016 potential flow theory ranging from simple 2d strip theory salvesen et al 1970 to 3d panel method singh and sen 2007 also with different levels of nonlinearity taken into consideration has been widely used for several decades due to their obvious advantages such as high computational efficiency calculations in frequency domain are faster and are useful in providing preliminary insights in the early design of ships cakici and aydin 2014 a ship in rough weather is subjected to various nonlinearities due to large amplitude motion and complex body geometry which requires investigations in time domain to model them accurately sen 2002 guedes soares et al 2008 watanabe and guedes soares 1999 conducted a benchmark study by comparing different nonlinear time domain codes for evaluating wave induced vertical bending moments of ships some complex flow physics and phenomena such as flow separation fluid splash and viscous effects cannot be reproduced in the framework of potential flow theory with the development of computer science and technology computational fluid dynamics cfd methods making use of reynolds averaged navier stokes rans equations are becoming increasingly popular and mature which has the potential of assisting in ship design and evaluation some strongly nonlinear issues that caused by high forward speed large amplitude motions and violent free surface flow can be well addressed by cfd method deng et al 2019 investigated added resistance and motion response of a trimaran in head regular waves based on rans method javanmardi et al 2008 developed a cfd code to investigate the hydrodynamic resistance and maneuvering of a trimaran with wigley body form in the conditions of different outrigger positions bhushan et al 2009 conducted model and full scale unsteady rans simulations of ship resistance powering seakeeping and maneuvering islam and guedes soares 2019 studied the effect of trim on container ship resistance at different ship speeds and drafts a cfd technique has turned out to be reliable in simulating wave induced ship motions in uni directional wave tezdogan et al 2016 although tremendous advances have been made in the cfd simulations of ship motion responses in uni directional wave investigations of ship motion in multi directional wave that simulated by cfd are rarely seen methods of multi directional wave simulation by cfd tools have been reported by some researchers wang et al 2018a simulated directional irregular waves by open source cfd wave model reef3d park et al 2004 reproduced fully nonlinear multi directional waves by use of a viscous 3d numerical wave tank simulation technique and calculated the hydrodynamic forces on an advancing ship cao and wan 2014 developed a three dimensional multi directional nonlinear numerical wave tank by using the two phase hydrodynamic flow solver naoe foam sjtu which was in house developed based on the open source toolbox openfoam wang et al 2018b calculated the wave forces on a fixed cylinder in a multi directional irregular wave field by the cfd model reef3d cfd technique has shown good performance in the simulation of 3d complex sea states which provides opportunity for the simulation of ship motions in complex sea states this study conducts a comprehensive cfd numerical simulation of ship motion in cross waves this paper is organized in a following way in the next section section 2 the cfd based basic governing equations and the established numerical model and method are reported in section 3 the involved research conditions are determined and described in section 4 characteristics of cross wave are systematically analyzed by theoretical deduction and cfd simulation the motion response behaviors of a s175 ship model in different cross wave conditions are systemically investigated in section 5 the safe operational guidance of ship when encountering cross wave is investigated and proposed in section 6 main conclusions obtained from this study are summarized in section 7 2 numerical model setup 2 1 ship model description a standard ship model of s175 containership is used for investigation in this study numerical modeling and calculation are conducted in model scale with a scale ratio of 1 40 which was determined to be in accordance with the cfd numerical or tank physical model of s175 containership used in a large number of references e g lakshmynarayanana and temarel 2020 datta and guedes soares 2020 fonseca and guedes soares 2004a fonseca and guedes soares 2004b the body plan of the s175 hull is shown in fig 2 main particulars of the ship and model are listed in table 1 where lcg denotes longitudinal center of gravity vcg denotes vertical center of gravity ap denotes after perpendicular bl denotes baseline the longitudinal mass distribution of the model which was determined to satisfy the displacement longitudinal floating state and radius of gyration of the ship is shown in fig 3 in the figure x 0 coincides with after perpendicular and x l coincides with forward perpendicular 2 2 basic governing equations the numerical simulations are conducted using finite volume method fvm based cfd technique the fluid is assumed to be 3d incompressible and viscous the governing equations for the continuity condition and momentum conservation condition are respectively expressed as follows 1 u i x i 0 2 ρ u i t ρ x j u i u j p x i x j μ u i x j ρ u i u j ρ g i where u i and u j i j 1 2 3 are the time mean value of velocity x i and x j i j 1 2 3 are spatial coordinate component ρ is fluid density p is mean pressure μ is kinematic viscosity coefficient ρ u i u j is reynolds stress and g i is gravitational acceleration in the i th direction unsteady reynolds averaged navier stokes urans method is used to solve the turbulent flow a realizable k ε eddy viscosity model with two layer all y wall function is selected in this work 3 ρ k t ρ k u i x i x j μ u t σ k k x j g k ρ ε 4 ρ ε t ρ ε u i x i x j μ u t σ ε ε x j ρ c 1 e ε ρ c 2 ε 2 k ν ε where the coefficients c 1 and c 2 represent functions of average flow and turbulence properties the reynolds stresses can be calculated using the well known boussinesq s isotropic eddy viscosity hypothesis 5 ρ u i u j μ t u i x j u j x i 2 3 ρ k δ i j where the eddy viscosity μ t is expressed as follows 6 μ t ρ c μ k 2 ε where c μ is a dimensionless constant the volume of fluid vof model is used to model the free surface interactions of water and air the volume of fraction is governed by the following equation 7 α t u i α x i 0 where u i is the fluid velocity α is the fraction of fluid in each cell when α 1 the cell is filled with water when α 0 the cell is filled with air and when α 0 5 represents the cell is filled with 50 water and 50 air 2 3 numerical method and details the flow around the model hull is simulated by rans based cfd code star ccm which enables three dimensional vof model simulations to capture the free surface between air and water the motion of the ship in waves is an unsteady process compared with large eddy simulation les and direct numerical simulation dns the unsteady rans method provides a good compromise between robustness computational cost and accuracy in order to simulate ship motions in multi directional wave a cuboid numerical wave tank was established with a dimension of 22 m long by 20 m wide by 15 m deep 10 m water and 5 m air the extension of the fluid domain with respect to the ship model are approximately 2 3l x 2 7l 2 3l y 2 3l 2 3l z 1 1l for length width and depth respectively the dimensions were conservatively determined to be greater than the recommendations of ittc 2011 so as to achieve better simulation results the origin of the coordinate system coincides with the intersection point of the after perpendicular waterline plane and symmetrical plane of ship the positive x axis points to ship bow y axis points to port side and z axis points to the sky the general view of the fluid domain including the model hull and the notations of boundary conditions is shown in fig 4 in order to realize the generation and propagation of waves from any arbitrary direction the boundary conditions are set as described in the following the velocity inlet is applied at the four sidewalls of the fluid domain so as to ensure that the fluid velocity on these boundaries is in accordance with the specified velocity of the cross waves a velocity inlet is also applied at the bottom of the fluid domain so as to define the wave fluid velocity on the bottom boundary a pressure outlet is applied at the top boundary which presents static pressure in the sky no slip wall was applied at the body surface a momentum source term is adopted for the generation of multi directional waves wave reflection can be eliminated by forcing the wave profile in the wave forcing region of the tank it is noted that no symmetry plane is adopted due to the asymmetry of incident wave and ship motions this would therefore increase the computational burden mesh generation was performed using the built in automated meshing toolbox of star ccm for the case of λ l 1 the flow domain is discretized by a mesh with approximately 4 million cells in total which includes 3 5 million cells in the background region and 0 5 million in the overset region trimmed hexahedral meshes are used for volume grid generation as shown in fig 5 the overset mesh approach which creates two different regions i e background region and overset region is adopted to simulate ship motion in waves the overset region has a dimension of 5 1 m long 1 2 m wide and 0 9 m high a prism layer was used to generate the boundary layer grid around the no slip body surface a boundary layer mesh of 5 cells near the hull is selected y value lies in 30 60 the meshes on the hull surface viewed from the side and bottom are shown in fig 6 the sensitivity analysis of the influence of mesh number and time step on the simulation results has been conducted in the recent work of huang et al 2020a in this study cross waves are obtained by the superposition of two orthogonal regular waves linear airy non breaking waves are used to simulate the component regular waves in order to avoid pronounced wave decay during their propagating procedure due to numerical dissipation local mesh refinement is applied around the free surface as a compromise between calculation accuracy and efficiency according to the recommendations of ittc 2011 a minimum of 40 cells per wave length and 16 cells per wave height is sufficient to produce a stable wave without obvious wave attenuation a number of 80 cells per wave length is preferable for the case of λ l 1 0 in this study the horizontal range of every regular wave length includes 75 cell layers for the case of λ l 1 0 and 45 150 cell layers was provided for wave length ranging from λ l 0 6 to 2 0 proportionally at least 16 cell layers are contained within the vertical range of wave height fig 7 shows the local view of refined mesh around the free surface of cross waves at the xoz vertical cross section the longitudinal centerline plane y 0 for the case of λ l 1 0 and h λ 0 0274 with the help of the established numerical wave tank and boundary conditions selected component regular waves are able to be generated from any specified direction by using one or two sidewall boundaries for example if the regular wave s propagation direction is parallel with coordinate axis ox or oy only one boundary is used for wave generation if the regular wave s propagation direction is not parallel with coordinate axis the adjacent two boundaries are used for wave generation for the generation of multi directional wave a boundary can be separately used more than once for the configuration of each component wave momentum source term method is adopted to generate multi directional cross waves cd adapco 2019 li et al 2018 the wave force is obtained by introducing a source term into the momentum equation which is expressed as follows 8 q ϕ γ ρ ϕ ϕ where q φ denotes the source term γ denotes forcing factor ρ denotes fluid density φ is the current solution of momentum equation φ is the target solution of momentum equation determined by specified wave shape as seen in fig 8 a the flow domain of wave field is divided into the inner domain and outer domain the wave forcing region the outer domain is defined within the area of 1 2l distance from the four sides of outer boundary a momentum source term is added into the momentum equation i e navier stokes equation within the wave forcing region to formulate the wave pattern and prevent wave reflection the forcing factor γ increases from 0 at the inner outer domain boundary lines to its maximum value of 10 at the outer boundaries of flow domain fig 8b shows the relative distance from the inner navier stokes equations region in the figure the blue region is the inner navier stokes equation region and the gradient region is the outer wave forcing region the realizable k ε two equation turbulence model with near wall function to describe the velocity profile near the wall is used in the numerical simulations the convective terms are discretized using the second order upwind scheme the diffusion terms utilize the central difference scheme the pressure and velocity coupling problem is solved by using the semi implicit method for pressure linked equations simple algorithm the temporal discretization is the second order discretization scheme a high resolution interface capturing hric scheme to compute the evolution of free surface by solving equation for volume fraction of liquid is employed the overset grid and motion region techniques are applied to simulate the motions of the ship in waves a rigid body motion with dynamic fluid body interaction dfbi model is used with 3 dof released to simulate ship heave roll and pitch in waves the dfbi module enabled the rans solver to calculate the wave induced forces acting on the ship hull and to solve the governing equations of rigid body motion in order to reposition the rigid body the established numerical wave tank provides a wide range of applications for the investigation of ship seakeeping in both uni and multi directional waves in a previous work huang et al 2020b the developed cfd algorithm for ship seakeeping prediction has been well validated by comparing with the existing experimental data of ship motions in head regular waves presented by fonseca and guedes soares 2004a however due to lack of experimental data of ship motions in cross waves this paper only provides a preliminary numerical investigation of ship seakeeping performance in cross waves it is worth mentioning that comparative study of ship motions in cross waves and uni directional regular wave has also been conducted in huang et al 2020b 3 research scheme and simulation conditions the cross waves can be described by their two component regular waves in this study the frequency and amplitude of the two component regular waves are assumed to be identical and they are coming from two orthogonal directions in deep water in order to investigate ship motion response in harsh wave conditions the wave height of component regular wave is set at 120 mm full scale 4 8 m wave length to ship length ratio λ l 1 0 is selected for the majority of the cases to obtain ship violent response at or near its resonance frequency ship forward speeds with froude numbers fn 0 and 0 25 are involved for investigation the typical numerical simulation conditions involved in this study are listed in table 2 definition of the heading angle of ship with respect to incident wave is illustrated in fig 9 it is noted that the plane coordinate origin 0 0 is used as a representative point to describe the equation of wave elevation including the initial phase and then the wave elevation at any other locations can be determined cases 1 8 aim to investigate ship motion responses at different wave lengths to ship length ratio λ l 0 6 2 0 when sailing along the route for the harshest wave condition case 9 aims to provide a comparative study on the effect of forward speed on ship motion responses cases 10 13 aim to investigate the influence of wave heading angle on ship motions fig 10 illustrates the initialized cross waves with respect to the ship model for different wave heading cases it is worth mentioning that in the cfd simulations the course angle of the ship with respect to the coordinate system remains unchanged while different wave propagation directions are configured to realize ship wave interaction with different wave headings cases 14 and 15 aim to investigate ship motion response when sailing along the stagnation line and they provide useful operational guidance for ship navigational safety in cross waves in section 6 although the course angle of the ship in cases 14 and 15 is the same as in cases 1 8 the ship will experience the lowest wave elevation when sailing along these two routes since the wave elevation on the centerline of the ship remains zero time step of 0 005 s was set in the numerical simulation procedure which was determined by ensuring the courant friedrichs lewy cfl condition is met the cfd numerical simulations are performed in a single node intel r core i 9 cpu with 18 cores clock speed of 3 0 ghz and 64 gb of physical memory all simulations are run at least 16 s for attaining stable results of ship motion responses in cross waves the required physical time for each simulation condition is roughly 3 days 4 characteristics of cross waves in this section the space and time distributional characteristics of cross waves are theoretically analyzed at first then the monitored wave elevation encountered by ship from cfd simulation are presented and analyzed 4 1 distribution of wave elevation in this study linear airy wave is used for the formulation of the component regular waves the spatial and temporal distribution of wave elevation of mono chromatic cross waves can be directly obtained by linear superposition of its two component regular waves a general formula for the description of the wave elevation of cross wave can be expressed as 9 ζ x y t a cos k x ω t ε 1 a cos k y ω t ε 2 a cos k x ε 1 cos k y ε 2 cos ω t a sin k x ε 1 sin k y ε 2 sin ω t where ζ denotes the spatial wave elevation x and y denote the spatial plane coordinates t denotes time a denotes amplitude of component regular wave k denotes wave number ω denotes frequency ε 1 and ε 2 denote the initial phase of the two component waves for the investigation of wave elevation at any specific point p x y in space eq 9 can be re written in the following format by applying trigonometric function s operation 10 ζ a 2 b 2 sin ω t c where the coefficients a b and c are respectively determined by 11 a a cos k x ε 1 cos k y ε 2 12 b a sin k x ε 1 sin k y ε 2 13 c arctan a b as can be concluded from the above analysis it is clear that the wave elevation at any specific point within the wave field follows a sine function the frequency of the resultant cross waves is identical to the frequency of component regular wave however the amplitude of the resultant wave differs from 0 to 2a for different spatial locations this means that in the cross waves field there exist stagnation points where the wave elevation remains zero and time invariant moreover all the stagnation points that are located at a same horizontal straight line on the free surface compose the stagnation line the maximum wave amplitude within the cross wave field is 2a when considering the forward speed of ship the wave encountered by the ship could be quite different from the in situ observation result the encounter frequency of the component regular waves can be calculated by 14 ω e ω 1 u ω cos β g where ω e denotes wave encounter frequency u denotes ship speed β denotes wave heading angle g denotes acceleration of gravity two typical classifications of ship encounter cross waves are summarized as follows i ship encounter waves are generally non sinusoidal since the encounter frequencies of the two component waves are usually different which would result in bi chromatic behavior of the resultant cross waves in this condition the largest crest or trough value of the encounter waves is constant 2a regardless of ship navigational route but the exact free surface pattern of encounter waves is determined by the ship navigational route i e both course angle and initial position ii when the ship course is symmetrical with respect to the two component waves i e the case of wave heading 45 45 or 135 135 the encounter waves are mono chromatic and sinusoidal since the encounter frequencies of the two component waves are identical in this condition the amplitude of encounter wave differs within the range of 0 2a which is determined by ship s initial spatial position or initial phase difference of waves thus the ship may be subjected to the largest or lowest motion responses in this condition this will be further investigated in section 6 for the operational guidance of safe navigation of ship in cross waves 4 2 analysis of encounter waves in the cfd numerical wave tank an array of wave gauges is arranged around the hull to monitor the free surface elevation top view of the positions of the adopted seven wave gauges with respect to the hull is shown in fig 11 their spatial coordinate positions are gauge 1 5 1 0 gauge 2 5 1 4 gauge 3 5 1 4 gauge 4 2 1875 4 gauge 5 2 1875 4 gauge 6 0 4 gauge 7 0 4 in unit meter it should be noted that in the cfd simulation the wave field has a translation speed with respect to the earth to achieve a reversed ship forward speed thus the wave gauges have a same forward speed with the ship in other words the wave gauges can be regarded as the wave probes installed on carriage to measure encounter waves in tank model tests the encounter waves for ship sailing at different wave headings i e resultant wave headings 0 45 90 135 and 180 is shown in fig 12 the cases for wave length λ l 1 0 and forward speed fn 0 25 are selected for illustration fig 12a shows the time series of the encounter waves in the cases 4 10 11 12 and 13 monitored by the wave gauge 1 ahead of ship bow the label monitored denotes the cfd simulated wave elevation with the effects of wave diffraction and wave making interference caused by the advancing hull the label theoretical denotes the theory value of wave elevation by simple trigonometric function calculation in addition the corresponding frequency domain results obtained by fast fourier transform fft using the time series data are shown in fig 12b as seen from the wave results both the time series and frequency spectral results of the monitored waves show good agreement with the theoretical value which confirms the capability of the developed cfd wave simulation technique the monitored value is slightly higher than the theoretical value especially at the crest and trough peaks the difference is mainly caused by the superposition of diffraction waves ship generated steady waves and radiation waves generally the wave making interference caused by the advancing ship on the incident wave pattern is small since the distance between the ship and wave gauge is long and the wave gauges are positioned in front or at side of the ship rather than in the wake area the time series of the monitored waves also reveals nonlinear behavior such as sharp crest and flat trough due to the relatively large steepness the wave spectra in the cases of wave heading 45 45 and 135 135 are mono peaked since the encounter frequencies of the two component waves are identical however the wave spectra in the remaining three cases are double peaked since the encounter frequencies of the two component waves are not identical a comparison of the encounter frequency of component waves that are obtained by eq 14 against the spectral peak frequency in fig 12 for each case is summarized in table 3 the results indicate that the peak frequency coincides well with the encounter frequency of component wave with largest difference below 5 the time series of wave elevation monitored by different gauges for typical cases 4 10 11 12 and 13 are shown in fig 13 for the cases 4 or 13 the encounter waves monitored by all the seven gauges show sinusoidal pattern with the same frequency while with different amplitude and phase however for the cases 10 11 and 12 the encounter waves show bi chromatic behavior but their largest crest or trough peak values are constant 2a where 2a 120 mm to summarize the numerical simulation results of waves show good agreement with the conclusion by theoretical analysis fig 14 shows the monitored and theoretical wave elevations at gauge 1 for different wave length cases the cases 1 8 the results indicate that the simulated waves show good agreement with the theory value the simulated or monitored wave heights for λ l 0 6 2 0 are identical without pronounced decaying during propagation this therefore would provide reliable wave environment parameter for the subsequent analyses of ship motions 5 ship motions in cross waves in this section ship motion responses in cross waves are systematically analyzed as concluded from the above analysis the cross waves encountered by the ship are symmetrical in the cases 1 9 thus ship motion responses in these conditions are first analyzed due to their regularity and simplicity then ship asymmetrical motion responses in the cases 10 13 are further analyzed to investigate ship motions in different wave headings 5 1 ship motions induced by symmetrical cross waves 5 1 1 influence of wave length a comprehensive comparison of the cfd simulated time series of ship motions induced by symmetrical cross wave wave heading 45 45 with different wave length λ l 0 6 2 0 at ship speed fn 0 25 cases 1 8 is shown in fig 15 the results confirmed that ship heave and pitch motions induced by symmetrical incident waves are regular and sinusoidal for all the wave length cases while the response amplitude differs significantly for different wave length cases the small disturbance of roll may be caused by the cfd numerical error which was introduced during geometric modeling and mesh generation it is noted that an obvious roll event occurred in the case λ l 1 1 around 9 5 s since the cfd simulation time is not long enough in this study the obvious rolling phenomenon occurred in this case will be studied in our further studies to obtain more insightful conclusions the response amplitude operators raos of heave and pitch motions with varying wave length λ l 0 6 2 0 for the wave heading 45 45 at speed fn 0 25 are summarized in fig 16 as is seen from the results the non dimensional amplitude value of heave increases rapidly from λ l 0 6 to 1 0 the largest heave response occurs at λ l 1 1 the heave amplitude appears to be constant with a same value of the resultant wave amplitude 2a for λ l at or greater than 1 5 the largest pitch amplitude occurred at λ l 1 2 which can be explained by the following reason although the effective wave length 2λ 1 697l for ship sailing at wave heading 45 45 is much greater than the resonance wave length approximately ship length l the forward speed largely increases the wave encounter frequency 4 809 rad s and makes it approaching the pitch resonance frequency 4 684 rad s which was obtained from pitch rao in regular wave it is noted that both the crest and trough peaks of time series of ship motion are presented to show the nonlinearity of motion response the difference between peak values of crest and trough for heave is small however the ship experienced obvious trim by bow motion which results in larger crest and lower trough for pitch peak the reason may be twofold i the green water on bow deck affects the floating state of ship ii the forward speed geometric asymmetry of bow and stern and nonlinear dynamic effects contribute to the asymmetry of crest and trough of pitch visual observations of ship motion in the case 5 λ l 1 1 by cfd simulation are shown in fig 17 fig 17a shows the static ship at mean position and the initialized wave pattern at initial time t 0 1 s fig 17b f shows ship large amplitude vertical motion and the corresponding severe slamming and green water on deck event within one wave encounter period the results indicate that there exist significant amount of green water on the full deck during the whole navigational procedure fig 18 shows the free surface elevation and pressure distribution on the wetted hull surface in the case 6 λ l 1 2 where the largest pitch occurred it is evident from the snapshot that the whole bulbous bow emerged with some water attached on the broadsides at t 5 4 s then severe slamming event occurred at t 6 0 s due to large bow down motion when the ship was in a sagging state which also resulted in harsh green water on deck subsequently the largest pressure about 6 3 kpa occurring at the front bulbous bow is much greater than the largest pressure about 3 2 kpa occurring at the keel of stern the graphic results also reveal that the breaking waves and violent free surface flow phenomenon have been successfully captured by the developed cfd model 5 1 2 influence of forward speed a comparison of the time series of ship vertical motions with and without forward speed for fn 0 25 and 0 is shown in fig 19 the results show that the forward speed significantly contributes to the heave amplitude this is because that large amplitude heave motion will occur when the encounter frequency is at or near the resonance frequency however the pitch amplitudes for the two cases are comparable but the vertical acceleration for ship with forward speed is much greater than the zero forward speed case due to the higher encounter frequency therefore the forward speed largely increases the severity of green water and slamming event visual observations of ship motion and green water for the two cases by cfd simulation are comparatively shown in fig 20 no green water on deck occurred in the zero forward speed case 5 2 ship motions in different wave headings 5 2 1 the time series the calculated time series of ship motions i e heave pitch and roll in different wave headings with constant wave length λ l 1 0 at speed fn 0 25 are summarized in fig 21 as seen from the results symmetrical motion responses of ship are obtained in the cases of wave heading 45 45 and 135 135 in these cases the heave and pitch signals are nearly sinusoidal while the roll signal is ignorable and nearly zero this is because the two component incident waves are symmetrical with respect to the ship s centerline and the encounter wave at centerline of ship is regular and sinusoidal however ship motions induced by asymmetrical cross waves in the cases of wave heading 0 90 45 135 and 90 180 reveal obvious irregularity this is because the two component incident waves are asymmetrical with respect to the ship s centerline and the encounter wave at centerline of ship includes two components with different frequencies and they are individually induced by the two component waves in other words both the 0 head component wave and the 90 beam component wave obviously contribute to the ship total heave response the pitch motion is relatively regular since the 90 beam component wave has very little effect on pitch response and the pitch response is therefore mainly induced by the 0 head component wave the ship experienced a very large roll motion approximately 16 deg due to the effect of the 90 beam component waves in the case of wave heading 45 135 both the heave and pitch time series show obvious bi chromatic characteristics because both the two component waves i e the 45 bow quarter component wave and the 135 stern quarter component wave significantly contribute to ship heave or pitch motion the ship initially encountered large amplitude roll motion event afterwards the roll motion tends to be small but at the end of the curve the roll value increased again longer simulation time will be performed in a future work to better understand ship roll motion behavior in asymmetric cross waves in the case of wave heading 90 180 the pitch signal induced by the 90 beam component wave is ignorable small the contribution of the 180 following component wave to the total pitch response is also small since the encounter wave period is relatively large and far from the resonant frequency of ship pitch 5 2 2 statistics and frequency domain results polar plots of the maximum response amplitude labeled as max and root mean square labeled as rms value derived from the time series data for ship motions in different resultant wave headings are summarized in fig 22 note that the angle denotes the resultant wave heading of the two component waves as seen from the results the largest and lowest heave response occurred in the case of resultant head wave 45 45 and resultant following wave 135 135 respectively the largest and lowest pitch response occurred in the case of resultant head wave 45 45 and resultant stern oblique wave 90 180 respectively the largest and lowest roll response occurred in the case of resultant beam wave 45 135 and resultant head or following wave 45 45 or 135 135 respectively the fft is applied to the time series data of ship motions to obtain the corresponding frequency domain information the obtained frequency domain spectra of ship motions which correspond to different wave heading cases are shown in fig 23 the ordinate denotes response amplitude of ship motion the vertical red line in the figure denotes encounter frequency of each component regular wave note that for the roll motion the encounter frequency corresponds to transverse value rather than longitudinal value the peak frequency can be also estimated by eq 14 for the motion spectra it is clear that the response components concentrate around the peaks which correspond to the encounter frequency of the component waves the heave component induced by the following component waves is very small since the wave encounter period is very long the pitch component induced by beam component wave is very small the responses mainly concentrate around their encounter frequency and they are less depended on the natural frequency of ship motion 5 2 3 visual observation of ship wave interaction comparison of the phenomenon of green water on deck for the ship sailing at different wave headings is shown in fig 24 it is seen that the severest green water event occurs when the ship sails at a wave heading 45 45 moderate green water occurs which is mainly due to large roll motion when the ship sailed at a wave heading 45 135 only very slight green water or called deck wetness occurred when the ship sailed at wave heading 0 90 and 135 135 no green water occurred when the ship sailed at wave heading 90 180 due to the small pitch motion the roll stability of ship in cross waves is another reason of concern in addition to the large amplitude vertical motions the largest roll value approached 17 4 in the case of wave heading 45 135 movement details of ship large amplitude roll pitch coupled motion and the resulting green water on deck in this case is depicted in fig 25 the slamming event induced by asymmetrical water entry of bow occurs when the ship is in a state of large roll and pitch simultaneously the green water overtops onto the deck from the port side and the water flows out from the starboard side during the rolling procedure the slamming and green water events in the case of wave heading 45 135 are much milder compared with those in the case of wave heading 45 45 due to the large roll period compared with pitch period 6 safe navigational strategy of ship in cross waves according to the above analysis the ship will probably encounter large amplitude vertical or transverse motion when sailing in cross waves the cross waves will pose a threat to the navigational safety of ship therefore it is of great importance to provide some wise strategy for the operational guidance of ship when operating in cross waves as concluded from section 4 1 in the cross waves field there exist stagnation lines where the wave elevation remains zero and time invariant the ship will experience the lowest wave if it travels along the stagnation lines with this in mind the motions of ship sailing along the stagnation line are investigated in this section fig 26 shows the three different navigational routes selected in the comparative study route 1 corresponds to ship navigational line along the largest wave crest and trough at a wave heading of 45 45 case 4 which has been investigated in section 5 1 and it is aimed to be used as a reference here routes 2 and 3 correspond to ship navigational line along the stagnation line at a wave heading of 45 45 case 14 and 135 135 case 15 respectively note that the ship navigational direction for routes 2 and 3 is opposite it is also noteworthy that in the wave field there exist both ox directional and oy directional stagnation lines the ox directional stagnation lines are steady and they move with a speed of the wave group speed gλ 8π 0 which coincides with ship speed direction however the oy directional stagnation lines are not steady since the transverse speed of their component stagnation points are different therefore only the ox directional stagnation lines are involved for investigation 6 1 comparison of ship motions fig 27 shows a comparison of the time series of ship motion in the three different navigational routes in addition the corresponding maximum response amplitude value labeled as max and root mean square labeled as rms of the time series are summarized and compared in fig 28 the results indicate that the heave and pitch motions for ship sailing in routes 2 and 3 are almost ignorable which are much smaller compared with those in route 1 although the vertical motions of the ship in route 3 are small the roll motion in route 3 is quite obvious with its largest value approaching 19 which would pose a threat to the rolling stability of ship the roll motion in route 3 is much larger than in route 2 which can be explained by the fact that larger roll motion will occur when the encounter frequency is near the natural frequency of roll fig 29 shows the large amplitude roll event of ship sailing along the route 3 at t 4 0 s 6 2 comparison of fluid forces on ship as concluded from the above analysis it is clear that the ship is recommended to travel along route 2 at a relatively high speed and then sail away from the area of cross wave so as to achieve the safest navigational strategy when subjected to cross waves however it should be noted that the ship will experience transverse forces due to the asymmetric distribution of free surface elevation and fluid pressure on the port and starboard sides of the ship when sailing along routes 2 and 3 the ship should resist the transverse force so as to be able to sail along the stagnation line exactly the monitored sailing longitudinal resistance transverse force and yaw moment of ship in the three routes are summarized in fig 30 which is useful for the preliminary evaluation of ship propulsion and maneuverability system fig 31 shows a comparison of the pressure distribution on ship hull bottom for different routes the time when largest longitudinal force occurs is selected for illustration for route 1 the time when largest transverse force occurs is selected for illustration for routes 2 and 3 as can be seen from the insert in fig 30a ship sailing resistances in routes 2 and 3 are comparable and oscillate around a mean value of roughly 20 n however the ship sailing resistance in route 1 is much greater and it oscillates with large amplitude due to the added resistance caused by harsh wave the instantaneous lowest resistance is below zero since the fluid particle does elliptical motion and the fluid at wave trough has a same speed direction as the ship forward speed longitudinal impulse force can be identified from the resistance signal of route 1 due to the effect of bow slamming and green water loads as seen from fig 30b and c the ship transverse force in route 1 is almost negligible due to the asymmetric distribution of fluid pressure on the port and starboard sides of ship however for route 2 and 3 the ship should endure significant transverse force and yaw moment so as to be able to sail along the stagnation line exactly the amplitudes of transverse force or moment for ship in routes 2 and 3 are comparable but the frequency for route 2 is much greater the transverse force and moment can be resisted by proper operation of rudder and side thruster of ship which is beyond the scope of the present paper and can be further investigated from the aspect of ship propulsion and maneuverability in future work moreover since this paper focuses on ship large amplitude motions in very harsh wave condition λ l 1 0 and h l 0 055 the obtained transverse force and moment are quite large in fact for ship sailing in a mild or moderate cross wave the transverse force and moment will be much lower this provides opportunities for ship resisting the transverse force by using rudder and bow and stern thrusters 7 conclusions this paper originally investigates ship motion behavior in bi directional cross waves by cfd tool some useful insight and guidance for the safety operation of ship when encountering cross seas are also provided main conclusions drawn in this study are as follows 1 the in situ monitored wave elevation within a cross wave field follows a mono chromatic sine function the frequency of the resultant waves is the same as the component regular waves but their amplitude differs for different locations when considering ship forward speed the ship encounter waves may be bi chromatic and more complex 2 when the ship experiences a symmetrical cross wave wave induced ship vertical responses are sinusoidal and the roll motion remains zero the forward speed significantly increases the heave amplitude and vertical acceleration when ship sails at wave heading 45 45 the forward speed also largely increases the severity of green water and slamming events the largest heave or pitch response occurs around λ l 1 1 1 2 with forward speed fn 0 25 3 when the ship experiences asymmetrical cross waves ship motion responses would be bi chromatic and can be considered as the superposition of motions induced by two component regular waves the response components concentrate around the encounter frequency of component waves the responses mainly concentrate around their encounter frequencies and they are less depended on the natural frequencies of ship motion 4 when a ship experiencing cross waves it is recommended to travel along the stagnation line with wave heading 45 45 at a relatively high speed and then sail away from the area of cross wave however the ship may resist significant transverse force and yaw moment to be able to sail along the stagnation line exactly and this can be further investigated from the aspects of ship propulsion and maneuverability credit authorship contribution statement jialong jiao conceptualization methodology validation formal analysis investigation resources writing original draft writing review editing visualization project administration songxing huang methodology software validation formal analysis investigation data curation visualization carlos guedes soares resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation of china no 51909096 the pre research field foundation of equipment development department of china no 61402070106 and the guangdong basic and applied basic research foundation no 2020a1515011181 the first author would also like to thank the china scholarship council csc for the financial support of his one year visit to centec at the university of lisbon 
21034,this paper investigates the use of an inerter enhanced vibration absorber the rotational inertia double tuned mass damper ridtmd for damping in plane vibrations of a floating offshore wind turbine fowt first a 17 degree of freedom 17 dof aero hydro servo elastic model for the fowt is developed and verified based on which the damper performance can be evaluated in the time domain td with realisitc load conditions next a reduced order 6 dof model is established for the ridtmd controlled fowt in plane vibrations including rotor mass moment of inertia hydrodynamic added mass as well as stiffness contributions from mooring lines and buoyancy this model enables revealing the dynamics of the coupled spar tower ridtmd system and provides an efficient yet robust procedure for optimal tuning of the fowt mounted ridtmd in the frequency domain fd comparison of the optimal ridtmd and the optimal tmd is performed in both fd and td it is seen that both tmd and ridtmd effectively suppress tower side side vibrations when mounted at the tower top ridtmd consistently outperforms tmd due to the extra dof extra resonance introduced into the device at the cost of slightly larger damper stroke both dampers positively influence spar roll motion and blade edgewise vibration as well keywords inerter tuned mass damper floating wind turbine coupled system frequency domain model aero hydro servo elastic 1 introduction wind turbines are being installed further offshore where the wind speeds are higher and more steady for areas with water depth larger than 60 m floating offshore wind turbines fowts turn out to be the most reasonable solution jonkman 2007 cheng et al 2017 different concepts of floating foundations platforms have been proposed with four of them being most popular spar buoy tension lag tlp barge and semi submersible pérez collazo et al 2015 jonkman and matha 2011 several prototypes with different foundation concepts have already been developed for demonstration purposes including windfloat roddier et al 2010 fukushima floating wind farm fukushima forward 2016 and hywind scotland windeurope 2017 a fowt is a complex coupled system in harsh environmental conditions subjected to aerodynamic hydrodynamic mooring and controller loads the structural vibrations in the blades and supporting structures of fowt are generally larger than those of fixed foundation wind turbines for a same wind turbine model it has been shown that the fatigue damage equivalent loads dels of tower base moment is 1 7 times for spar foundation 2 5 times for tlp and 7 times for barge compared to the monopile foundation jonkman and matha 2010 it is well known that while the out of plane vibrations tower fore aft and blade flap wise vibrations exhibit very high aerodynamic damping the in plane vibrations tower side side and blade edgewise vibrations are very lightly damped due to the negligible aerodynamic damping under normal operational conditions hansen 2007 zhang et al 2014a the motions of the floating platform surge sway heave pitch roll and yaw will increase the tower response due to the effect of large inertia and gravity moreover wind wave misalignment hildebrandt et al 2019 and wave current interaction chen and basu 2019 may further excite the lightly damped in plane fowt vibrations according to the danish wind turbine industry cross wind vibration side side vibration due to wave loading misaligned with wind turbulence often has a significant influence on the fatigue lifespan of offshore wind turbine foundations damgaard et al 2013 besides it also result in increased maintenance which is particularly unfavorable for fowts installed very far offshore hence there is great need to apply vibration suppression control techniques on the fowt for improving its fatigue life stability and survivability there are two types of vibration control techniques for fowts i e aerodynamic control and structural control aerodynamic control utilizes the blade pitch controller to change the rotor aerodynamic thrust larsen and hanson 2007 jonkman 2008 namik and stol 2010 goupee et al 2017 which is mainly effective in mitigating out of plane loads on the tower and platform it is especially promising for suppressing the low frequency platform pitch motion because of the large moment arm from the blades to the spar however it has the drawbacks of increased pitch actuator usage and rotor speed variation as well as no influence on the lightly damped in plance fowt vibrations on the other hand structural control using vibration absorbers turns out to be a promising alternative for fixed foundation wind turbines different types of vibration absorbers have been proposed and investigated including the classic tuned mass damper tmd stewart and lackner 2014 zhang 2020 fitzgerald et al 2013 jiang 2018 the pendulum type absorbers argyriadis and hille 2004 zhang et al 2014b 2014c the tuned liquid dampers colwell and basu 2009 zhang et al 2019 recently viscous type hybrid dampers have also been proposed to be mounted at the tower bottom brodersen and høgsberg 2016 which was also experimentally investigated brodersen et al 2016 employing structural control to fowt is a relatively new and developing area of research lackner and rotea developed a simulation tool based on fast fatigue aerodynamics structures and turbulence with the capability to model pasive semi active and active tmds in fowts lackner and rotea 2011a using this tool passive and active tmds have been investigated for a barge type fowt lackner and rotea 2011b however since the tmd is tuned to the low frequency platform pitch mode the damper stroke turns out to be too large up to 20 m to be practically feasible si et al 2014 carried out a similar study for a spar type fowt where a passive tmd tuned to the pitch mode is installed inside the spar multiple passive tmds were proposed to be installed inside the nacelle and spar of spar type fowts dinh and basu 2015 resulting in tremendous extra mass this concept was further extended to multiple semi active tmds using the short time fourier transform stft algorithm dinh et al 2016 artificial fish swam algorithm has also been proposed for optimizing the multiple passive tmds jin et al 2018 more recently active control of a barge type fowt was investigated using a nacelle installed stroke limited hybrid mass damper hmd hu and he 2017 however the impulsive load from collision between the mass and the limiter might induce unfavorable high frequency vibrations in the tower besides tmds liquid damper is an interesting alternative for vibration damping of fowts a classic tuned liquid column damper tlcd installed in the nacelle has been investigated for suppressing in plane fowt vibrations zhang and høeg 2019 a novel tuned liquid multi column damper tlmcd installed inside the floater was proposed for damping rotational motion of a barge type fowt coudurier et al 2018 moreover multilayer tuned liquid damper tld was also proposed for mitigating platform pitch motion of a spar type fowt ha and cheong 2016 comparing with liquid dampers tmd has the advantages of large effective mass linear behavior for accurate modelling and parameter calibration thus it is normally preferred however most of the previous studies focus on damping the low frequency pitch mode resulting in either a tremendous tmd mass or a very large damper stroke this is due to the fundamental working principle of tmd i e it imparts external damping to the structure though the inertial force that is proportional to ω 2 with ω being the eigenfrequency the tmd is tuned to therefore tmd is very ineffective for damping low frequency motions installing the tmd inside the platform further deteriorates its efficiency in damping pitch motion due to the very small moment arm for generating the damping moment using the aerodynamic control method i e the blade pitch controller will be a much better solution on the other hand the tmd will be much more effective if it is tuned to the relatively high frequency tower mode and is installed at the tower top nacelle recently inerter based vibration absorbers have been extensively investigated for damping vibrations in mechanical or civil engineering structures inerter smith 2002 is a two terminal mechanical device transforming the translational motion into high speed rotational motion leading to a significantly amplified inertial force than that generated by its physical mass papageorgiou and smith 2005 this indicates an apparent mass that is much larger than its physical mass different apparent mass amplification mechanisms for the inerter have been proposed including the rack and pinion mechanism smith 2002 the ball screw mechanism wang et al 2009 and hydraulic mechanism wang et al 2011 the inertial force generated by the device is proportional to the relative acceleration between the terminals with the proportionality constant being termed the inertance different types of inerter based vibration absorbers can be achieved by assembling the inerter with the mass spring and dashpot linear viscous damper elements in different configurations hu and chen 2015 two most popular ones are the tuned inerter damper tid lazar et al 2014 2016 by placing the inerter in series with a parallel spring dashpot element and the tuned mass damper inerter tmdi marian and giaralis 2014 giaralis and taflanidis 2018 by connecting the inerter in series with a classic tmd it has been shown that the tid outperforms the classic viscous damper lazar et al 2016 while the tmdi outperforms the classic tmd marian and giaralis 2014 when one terminal of the inerter is connected to the supporting ground to generate large relative motion between the two terminals of the complete device this is difficult to be achieved in fowts and hence alternative configurations are needed ikago et al 2012 invented a novel mechanical device named the tuned viscous mass damper tvmd it consists of a viscous mass damper vmd and a spring connected in series within the vmd an inerter or rotational inertial mass employing the ball screw amplifying mechanism is connected to a dashpot in parallel a possible design of the vmd has been given in ikago et al 2012 and will be further explained in section 3 of the present paper a similar device named the rotational inertia damper has also been proposed in hwang et al 2007 using the ball screw mechanism in principle other mechanisms such as the rack and pinion mechanism can also be employed for constructing the vmd based on tvmd a novel inerter based vibration absorber the rotational inertia double tuned mass damper ridtmd was proposed garrido et al 2013 the idea of a ridtmd is to replace the dashpot in a classic tmd by a tvmd and therefore the ridtmd can be attached to the structure exactly the same manner as a tmd it has been shown that ridtmd the enhanced tmd outperforms the classic tmd with a same absorber mass on a single degree of freedom sdof system garrido et al 2013 based on the fixed point theory barredo et al 2018 developed closed form formulas for the optimal design of ridtmd again assuming the structure to be a sdof system taking into account the ease of installation and the enhanced performance compared with tmd ridtmd turns out to be a very promising device for vibration suppression of fowts the present paper aims to investigate the performance of a nacelle mounted ridtmd on damping in plane vibrations of a spar type fowt with focus on the lightly damped tower side side vibrations since the fowt is a highly coupled system the previous result for optimal damper calibration garrido et al 2013 barredo et al 2018 cannot be applied here the modeling optimal design and analysis of the fowt mounted ridtmd must be performed based on the coupled system fluid mooring spar tower system rather than the decoupled tower itself first a 17 dof aero hydro servo elastic model is developed for the fowt system taking into consideration the full coupling of blade drivetrain tower spar mooring vibrations as well as fluid structure interaction verified by good agreement with fast this model can be used for performance evaluation of ridtmd in a fully coupled fowt system subject to realistic load conditions by nonlinear time domain td simulations next a reduced order 6 dof model is derived for ridtmd controlled fowt in plane vibrations including spar sway heave and roll motions as well as tower side side vibration stiffness contributions from hydrostatic buoyancy and mooring lines as well as hydrodynamic added mass are included in the system matrices the model enables an efficient and robust procedure for optimal design of fowt mounted ridtmd in the frequency domain fd using random vibration theory where the input spectrum is obtained from the 17 dof model moreover it is found from free vibration analysis that the tower side side frequency can only be accurately captured when accounting for the coupled spar tower vibration the hydrodynamic added mass and the stiffness contributions from buoyancy and mooring lines finally the optimized ridtmd is incorporated into the 17 dof model and nonlinear td simulations are performed to evaluate and compare the performance of ridtmd with that of an optimal tmd results show that the proposed ridtmd outperforms the classic tmd with a same absorber mass in damping tower side side vibrations at the cost of slightly increased but practically feasible damper stroke ridtmd has a positive influence on spar roll and blade edgewise vibration as well 2 17 dof aero hydro servo elastic model for the fowt system a 17 dof aero hydro servo elastic model is developed for the highly coupled fowt system using combined multi body dynamics and modal based methods høeg and zhang 2021 this model takes into account the most important features of a floating wind turbine including coupled spar tower blade drivetrain vibrations time varying system matrices quasi static nonlinear aeroelasticity and wave structure interaction as well as generator and pitch controllers the dofs and coordinate systems frame of references are defined in fig 1 and fig 2 the motions of the floating foundation the spar are specified in the fixed global x 1 x 2 x 3 coordinate system with origin fixed at the cog of the complete fowt system the global cog when the fowt is undisplaced the tower vibrations are specified in the local tower x 1 x 2 x 3 coordinate system with origin fixed at the tower bottom the blade vibrations are specified in the local blade x 1 x 2 x 3 coordinate system one for each blade with origin fixed at the hub center root of the blade the tower height top to bottom is denoted h t and the height from the global cog to the tower bottom is denoted h t both the blades and the tower are modeled as euler benoulli beams with variable mass per unit length and variable bending stiffness while their axial deformations are neglected they are modeled by modal based approach i e generalized coordinates dofs and the corresponding prescribed mode shapes each blade is associated with two dofs q j t and q j 3 t j 1 2 3 denoting the flapwise and edgewise tip displacements respectively the associated mode shapes are prescribed as the undamped fundamental eigenmodes φ f x 3 and φ e x 3 in the flapwise and edgewise directions for a non rotating blade the tower is associated with two translational dofs q 7 t and q 8 t denoting the tower fore aft and side side vibrations respectively and a torsional tower yaw dof q 17 t the associated mode shapes are the undamped fundamental eigenmodes of tower fore aft side side and torsional vibrations φ t f x 3 φ t s x 3 and φ t t x 3 respectively as shown in fig 2 the flexible drivetrain is modeled using st venant torsional theory with two dofs q 9 t and q 10 t denoting the deviations of the angular positions at the hub and at the generator rotor from the nominal angular positions ω 0 t and n ω 0 t respectively with ω 0 being the rated rotational speed of the rotor and n being the gear ratio hence q 9 t and q 10 t indicate the deviations of the rotational speeds at the hub and the generator from the nominal values as a result ω t ω 0 q 9 t is the actual rotor speed and ω g t n ω 0 q 10 t is the actual rotational speed at the generator further the rotor overhang along the main shaft and the height from tower top to the main shaft are denoted s and h s respectively the azimuthal angle of blade j relative to the nacelle can be written as 1 ψ j t ω 0 t q 9 t j 1 2 π 3 j 1 2 3 the floating spar is modeled by six rigid body dofs q 11 t q 12 t q 13 t q 14 t q 15 t and q 16 t denoting surge sway heave roll pitch and yaw motions respectively both the spar motions and tower vibrations will induce velocity contributions to the blade cross sections leading to highly coupled system matrices for example the velocity vector v b j x 3 t of a blade cross section can be obtained as the time derivative of the position vector r b j x 3 t which is expressed in the fixed global x 1 x 2 x 3 coordinate system as 2 r b j x 3 t q 11 t q 12 t q 13 t t f t u t 1 h t t u t 2 h t t h t h t t t o t 0 0 h s t t s 0 0 t b j t u b 1 j x 3 t u b 2 j x 3 t x 3 where t f t t t o t t t and t b j t are the coordinate transformation matrices due to the foundation rotations the tower top rotations the shaft tilt and blade j s rotation respectively høeg and zhang 2021 u t 1 x 3 t and u t 2 x 3 t are the tower fore aft and side side displacement fields and u b 1 j x 3 t and u b 2 j x 3 t are the blade flapwise and edgewise displacement fields in the present study the axial deformations of the blade and the tower are neglected using modal based formulation u b 1 j x 3 t u b 2 j x 3 t u t 1 x 3 t and u t 2 x 3 t are expressed as 3 u b 1 j x 3 t φ f x 3 q j t u b 2 j x 3 t φ e x 3 q j 3 t j 1 2 3 u t 1 x 3 t φ t f x 3 q 7 t u t 2 x 3 t φ t s x 3 q 8 t further the tower top rotations follow directly from u t 1 x 3 t and u t 2 x 3 t based on euler bernolli beam theory these two tower top rotations together with tower top torsion provide components in the transformation matrix t t o t the foundation rotational dofs q 14 t q 15 t and q 16 t provide components in the transformation matrix t f t the velocity vectors for all structural components including v b j x 3 t are derived symbolically in matlab the total kinetic energy t and total potential energy u of the fowt system are formulated høeg and zhang 2021 and they are then inserted into the lagrange equation pars 1979 4 d d t t q t q u q c s q f g e n t f a t f g t f b t f h t f m t which leads to the equations of motion eoms of the 17 dof fowt model 5 m t q t g t c s q t k t q t f g e n t f a t f g t f b t f h t f m t with m t g t k t being the 17 by 17 time variant mass gyroscopic and stiffness matrices respectively they are extracted from the left hand side of the lagrange equation eq 4 by assuming small rotations angles and neglecting second and higher order small terms høeg and zhang 2021 q t is the 17 dimensional dof vector c s is the structural damping matrix f g e n q t t f a q t t f g q t t f b q t f h q t q t t f m q t t are the modal load vectors due to generator controller aerodynamics gravity hydrostatic buoyancy hydrodynamics and mooring lines respectively høeg and zhang 2021 f g e n q t t depends nonlinearly on q t more specifically on q 10 t due to the generator control law f a q t t is obtained by the classic blade element momentum bem theory hansen 2008 with glauert s turbulence wake and prandtl s tip loss corrections nonlinear quasi static aeroelasticity is taken into account by including the velocity components of blade cross section into the calculation of the angle of attack this implies that f a q t t depends nonlinearly on q t the rotational sampled turbulence field is generated zhang et al 2014a with mean wind speed v 0 and turbulence intensity i f b q t depends linearly on q t as will be shown in section 3 f h q t q t t is calculated using morrison s formula taking into account the wave structure interaction faltinsen 1993 f h q t q t t depends linearly on q t and nonlinearly on q t the sea surface elevation is modeled as a zero mean stationary gaussian process from the jonswap spectrum hasselmann et al 1973 the significant wave height and the peak period are denoted h s and t p respectively regarding f m q t t different mooring line models have been established høeg and zhang 2018 including linear spring nonlinear quasi static and lumped mass nonlinear dynamic models in the present study quasi static model is used for performance evaluating of the ritmd in fowt system by means of nonlinear td simulations while linear spring model is used for parametric optimization of ridtmd as will be detailed in section 3 moreover as detailed in høeg and zhang 2021 f b q t can be further written as f b q t f b 0 k h s q t with f b 0 being the static buoyancy load vector with the only non zero component in the heave direction and k h s being the hydrostatic restoring matrix f h q t q t t can be further written as f h q t q t t f h q t t m h a q t with f h q t t being the hydrodynamic load vector due to nonlinear drag and m h a being the hydrodynamic added mass matrix as proposed in jonkman 2010 an additional damping matrix c a d d with non zero components related to spar dofs is also added in order to match the free decay response of the spar from the test data therefore by explicitly introducing these linear dependency relationships the eoms of the 17 dof can be rewritten as 6 m t m h a q t g t c s c a d d q t k t k h s q t f g e n t f a t f g t f b 0 t f h t f m t finally a collective pitch controller activated when the wind speed is above rated is incorporated into the 17 dof model with actuator dynamics modeled by a 1st order filter zhang 2015 the pitch demand is formulated as a gain scheduled pi controller jonkman et al 2009 with feedback from q 9 t and q 9 t finally a variable speed generator controller is incorporated whose generator torque is dependent on the generator speed ω g t jonkman et al 2009 all details of this 17 dof model can be found in høeg and zhang 2021 3 reduced order model for the coupled spar tower ridtmd system 3 1 overview of the reduced order model the 17 dof model represents a time variant system that rules out the use of frequency domain method for the efficient optimization of ridtmd as proposed in pegalajar jurado et al 2018 hegseth and bachynski 2019 a cascading approximation can be applied for establishing frequency domain models of fowt for the preliminary design evaluation and quick load analysis of fowt a similar methodology is used in the present study for the damper optimization in this section a reduced order 6 dof time invariant model is established for in plane vibrations of fowt installed with a ridtmd 4 dofs of the fowt are included i e spar sway heave and roll motions together with the tower side side vibration while the other 2 dofs are for the ridtmd strictly speaking heave motion defined in the x 3 axis should not be regarded as in plane motion however since the heave dof is coupled to the damper dofs as shown below it is included in the reduced order model the rotor blades are assumed rigid and non rotating meaning that the dofs related to the blades and drivetrain are discarded however the lumped mass of the nacelle rotor system and the mass moment of inertia of the rotor should be accounted for in the reduced order model as shown in the following the same notations as in section 2 are used for the selected dofs i e q 12 for sway q 13 for heave q 14 for roll and q 8 for tower side side vibration such a simplified model enables revealing the fundamental mechanism of the coupled spar tower ridtmd system and facilitates an efficient and robust optimization procedure for the fowt mounted ridtmd the linear time invariant property of the 6 dof model makes it possible to apply the frequency domain method for the damper optimization a similar 5 dof model is also established for the spar tower tmd system where only one dof is needed for the tmd optimization of the fowt mounted tmd can be performed following the same procedure as for the 6 dof model this enables performance comparison of the optimal ritmd with optimal tmd on reducing tower vibrations of the fowt in the following only the formulation of the 6 dof model is detailed as mentioned in section 1 the tvmd consists of a vmd and a spring being connected in series one possible design schematic of the vmd is shown in fig 3 a the ball screw mechanism translates the linear motion resulting from the structural vibration into high speed rotational motion of the rotational mass flywheel and the internal tube energy dissipation takes place in the viscous damper due to the relative rotation between the internal tube and the external tube ikago et al 2012 fig 3 b shows the equivalent mechanical model of the vmd i e the inerter and the dashpot are placed in parallel 3 2 kinetic energy and potential energy formulation fig 4 shows the schematic representation of a fowt with rigid non rotating rotor blades equipped with a ridtmd or a tmd at the nacelle top of the tower comparing with fig 1 in this section only in plane vibrations are taken into account and the motion is assumed to be two dimensional here x 2 x 3 is the fixed global coordinate system with origin fixed at cog of the undeformed system and x 2 x 3 is the local tower coordinate system with origin attached to the tower bottom the hydrodstatic buoyancy is acting at the center of buoyancy cob which is h b g distance higher than cog the linear spring model is used for the mooring lines so that a linear system model can be obtained neglecting second and higher order nonlinear terms the velocity vector of a tower cross section is described in the local tower x 2 x 3 coordinate system as 7 v t x 3 t 0 q 12 t h t x 3 q 14 t φ t s x 3 q 8 t q 13 t where h t is the distance from the tower bottom to the origin of the global x 2 x 3 coordinate system φ t s x 3 is the fundamental tower side side mode shape of the decoupled tower as introduced in section 2 evaluating eq 7 at the tower top x 3 h t φ t s h t 1 with h t being the tower height the velocity vector of the nacelle can thus be obtained 8 v n t 0 q 12 t h r q 14 t q 8 t q 13 t where h r h t h t is the distance from the tower top to the origin of the x 2 x 3 coordinate system cog of the undeformed system although the blade dofs are discarded due to the rigid rotor assumption the mass moment of inertia of the rotor will influence the system dynamics and should be accounted for this is done by formulating the velocity vector of a blade cross section in the local blade coordinate system using the similar multi body formulation as in eq 2 for the reduced 6 dof system the velocity vector of a cross section in blade j can be expressed in the local blade coordinate system as 9 v b j x 3 t 0 x 3 θ 1 t q 14 t cos ψ j q 12 t h r q 14 t q 8 t sin ψ j q 13 sin ψ j q 12 t h r q 14 t q 8 t cos ψ j q 13 with x 3 being the distance from the cross section to the hub the azimuthal angle is ψ j ω t j 1 2 π 3 here θ 1 is the tower top rotational speed due to elastic deformation around x 1 axis which is obtained based on euler bernoulli beam theory as 10 θ 1 t φ t s h t q 8 t d t s q 8 t where φ t s h t d φ t s x 3 d x 3 x 3 h t is the first derivative of the tower side side mode shape evaluated at the tower top the constant d t s with the unit m 1 is introduced for compactness as shown in fig 4 the ridtmd is composed of an absorber mass m d attached to the tower top via a spring with spring stiffness k d and a tvmd placed in parallel within the tvmd the spring stiffness of the secondary spring is k 2 the damping coefficient of the dashpot is c 2 and the inertance of the inerter is b d the physical mass of the inerter is negligible comparing with m d and b d in contrast to the classic tmd where only one extra dof is needed for describing its motion two dofs are needed for describing the motion of the ridtmd the displacement of the absorber mass relative to the displaced tower top is denoted u 1 t and the displacement of the inerter relative to the displaced tower top is denoted u 2 t it should be noted that u 2 t also indicates the deformation of the secondary spring k 2 therefore q 12 q 13 q 14 q 8 u 1 t and u 2 t make up the dofs of the 6 dof spar tower ridtmd system neglecting second and higher order nonlinear terms the velocity vectors of the absorber mass and the inerter are written in the local tower coordinate system as 11 v m d t 0 q 12 t h r q 14 t q 8 t u 1 t q 13 t v b d t 0 q 12 t h r q 14 t q 8 t u 2 t q 13 t hence the total kinetic energy of the 6 dof spar tower ridtmd system becomes 12 t 6 d o f 1 2 m n m h v n t 1 2 j 1 3 0 l b μ b x 3 v b j x 3 v b j x 3 d x 3 1 2 0 h t μ x 3 v t x 3 t v t x 3 t d x 3 1 2 m s q 12 2 t q 13 2 t 1 2 j s q 14 2 t 1 2 m d v m d t v m d t 1 2 b d u 1 t u 2 t 2 where m n and m h are the masses of the nacelle and hub respectively μ b x 3 and μ x 3 are the mass per unit length of the blade and the tower respectively m s and j s are the mass and mass moment of inertia of the spar respectively the total potential energy of the system is 13 u 6 d o f 1 2 k 8 q 8 2 t 1 2 k d u 1 2 t 1 2 k 2 u 2 2 t where k 8 is the tower side side modal stiffness written as 14 k 8 k 8 e k 8 g 0 h t e i x 3 d 2 φ t s x 3 d x 3 2 2 d x 3 0 h t g m 0 x 3 h t μ x 3 d x 3 d φ t s x 3 d x 3 2 d x 3 with k 8 e and k 8 g being the elastic and geometric due to gravity contributions to k 8 respectively e i x 3 is the tower side side bending stiffness the hydrostatic buoyancy and the mooring lines contribute to the system stiffness while the added mass from hydrodynamics contributes to the system mass these will be included in subsection 3 3 3 3 equations of motion inserting the kinetic energy and potential energy presented in eqs 12 and 13 into the lagrange equation pars 1979 the equations of motion of this reduced order 6 dof model can be obtained 15 m r r t c r r t k r r t f r a t f r g t f r b t f r h t f r m t where r q 12 q 13 q 14 q 8 u 1 u 2 t is the 6 dimensional dof vector f r a t f r g t f r b t f r h t and f r m t are the 6 dimensional load vectors due to aerodynamics gravity hydrostatic buoyancy hydrodynamics and the mooring system respectively as will be described in the following the mass matrix m r is given by 16 m r m 0 m t m s m d 0 m 0 m d h r m t h t n 3 m 0 n 1 m d m d 0 0 m 0 m t m s m d 0 0 0 0 m 0 m d h r m t h t n 3 0 m 0 m d h r 2 m t h t 2 j t 2 n 3 h t j s j r m 0 m d h r n 1 h t n 2 d t s j r m d h r 0 m 0 n 1 m d 0 m 0 m d h r n 1 h t n 2 d t s j r m 0 m 8 d t s 2 j r m d m d 0 m d 0 m d h r m d m d b d b d 0 0 0 0 b d b d where m 0 m n m h 3 m 0 is the total lumped mass at tower top with m 0 being the mass of each blade m t 0 h t μ x 3 d x 3 is the total mass of the tower j t 0 h t μ x 3 x 3 2 d x 3 is the mass moment of inertia of the tower with respect to the tower bottom j r 3 0 l b μ x 3 x 3 2 d x 3 is the mass moment of inertia of the rotor m 8 0 h t μ x 3 φ t s 2 x 3 d x 3 is the tower side side modal mass n 1 n 2 and n 3 are three constant coefficients defined as 17 n 1 0 h t μ x 3 φ t s x 3 d x 3 n 2 0 h t μ x 3 φ t s x 3 x 3 d x 3 n 3 0 h t μ x 3 x 3 d x 3 the damping matrix c r and stiffness matrix k r are given by 18 c r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 ζ 8 m 8 k 8 0 0 0 0 0 0 c 2 c 2 0 0 0 0 c 2 c 2 k r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k 8 0 0 0 0 0 0 k d 0 0 0 0 0 0 k 2 where ζ 8 is the modal damping ratio of the tower side side mode the corresponding 5 by 5 matrices m r c r and k r for the case of tmd are given in appendix a both the mooring lines and the hydrostatic buoyancy introduce additional stiffness to the fowt system to quantify the stiffness contribution of the mooring lines the linear spring model is employed in this section this is done by linearization around the spar equilibrium position using the catenary formulations jonkman 2010 the mooring system load vector can thus be written as 19 f r m t f r m 0 v 0 k m o o r v 0 r t where f r m 0 v 0 0 f r m 0 v 0 0 0 0 0 t is the static mooring load and k m o o r v 0 is the 6 by 6 stiffness matrix resulted from the mooring lines both dependent on the mean position of the spar thus the mean wind speed v 0 since the mooring line behavior is inherently nonlinear they are obtained by numerical linearization using the catenary solution at a given equilibrium state dependent on v 0 høeg and zhang 2018 it should be noted that since current is not considered in the present paper the influence of waves on the mean position of the spar is negligible waves only influence the motion amplitude so f r m 0 v 0 and k m o o r v 0 can be considered to be only dependent on v 0 the hydrostatic buoyancy load vector f r b t can be expressed as faltinsen 1993 20 f r b t f r b 0 k r h s r t 0 ρ w g v s 0 0 0 0 0 0 0 0 0 0 0 π 4 ρ w g d 1 2 0 0 0 0 0 0 ρ w g h b g v s π d 1 4 64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r t where f r b 0 is the static buoyancy load and k r h s is the stiffness matrix resulted from hydrostatic buoyancy ρ w is the sea water density v s is the displaced water volume volume of the submerged part of spar and d 1 is the spar top diameter the hydrodynamic load vector f r h t is calculated by means of morison s formula faltinsen 1993 along with the strip theory for the spar type fowt the radiation damping in terms of convolution integral is negligible comparing with the viscous damping from morison s formula høeg and zhang 2019 and is thus excluded in the present study the hydrodynamic load per unit length acting at cross section x 3 of the spar in the global x 2 direction is expressed as 21 p r h x 3 t 1 2 ρ w c d d x 3 v r e l x 3 t v r e l x 3 t π 4 ρ w c m d 2 x 3 a w x 3 t π 4 ρ w c m 1 d 2 x 3 a s x 3 t p r h x 3 t π 4 p w c m 1 d 2 x 3 a s x 3 t where p r h x 3 t 1 2 ρ w c d d x 3 v r e l x 3 t v r e l x 3 t π 4 p w c m d 2 x 3 a w x 3 t with c d and c m being the drag and inertia coefficients respectively d x 3 is the spar diameter at location x 3 v r e l x 3 t v w x 3 t v s x 3 t is the relative flow velocity with v w x 3 t being the water particle velocity at location x 2 0 and v s x 3 t q 12 x 3 q 14 being the spar velocity a w x 3 t is the water particle acceleration at location x 2 0 and a s x 3 t q 12 x 3 q 14 is the spar acceleration integrating p r h x 3 t along the submerged part of the spar results in the modal loads work conjugated to dofs q 12 and q 14 to quantify the contributions of the hydrodynamic loads to the system mass in eq 21 p r h x 3 t has been reformulated into two terms the second term after integration leads to the hydrodynamic added mass matrix m r h a 22 m r h a π 4 ρ w c m 1 h b h g d 2 x 3 d x 3 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 d x 3 0 0 0 0 π 12 ρ w d 2 2 0 0 0 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 d x 3 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 2 d x 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where the added mass component π 12 ρ w d 2 2 in the heave direction has been accounted for following haslum et al 1999 with d 2 being the spar bottom diameter h b is the distance from cog to the spar bottom and h g is the distance from cog to the mean sea level msl the first term p r h x 3 t in eq 21 after integration leads to the remaining hydrodynamic load vector 23 f r h y t f r h t c r a d d r t h b h g p r h x 3 t d x 3 π 8 ρ w c d h d 2 2 q 13 t q 13 t h b h g p r h x 3 t x 3 d x 3 0 0 0 c a 2 0 0 0 0 0 0 c a 3 0 0 0 0 0 0 c a 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r t where f r h t is the hydrodynamic load vector resulted from p r h x 3 t and c r a d d is an additional added damping matrix included to match the free decay field data jonkman 2010 by calibrating parameters c a 2 c a 3 c a 4 in f r h t the component in the heave direction the second component is formulated directly using morison s formula with c d h being the heave drag coefficient moreover the load vectors due to aerodynamics and gravity are respectively expressed as 24 f r a t f t s t 0 h r f t s t q a t f t s t d t s q a t 0 0 f r g t 0 m 0 m t m s g m 0 g q 8 t n 1 m 0 g sin q 14 t 0 0 where f t s t is the side side aerodynamic force on the tower top accounting for the influence of structural velocities aeroelasticity q a t is the aerodynamic torque classical bem method has been used for the calculation of f t s t and q a t as explained in section 2 n 1 in f r g t has already been defined in eq 17 therefore the eoms of the 6 dof spar tower ridtmd system in eq 15 become 25 m r m r h a r t c r c r a d d r t k r k r h s k m o o r r t f r a t f r g t f r b 0 f r h t f r m 0 the 6 by 6 frequency response matrix can thus be obtained as 26 h ω ω 2 m r m r h a i ω c r c r a d d k r k r h s k m o o r 1 where i 1 each component of h ω is the corresponding frequency response function the eoms of the 4 dof spar tower system without the damper can be extracted from eq 25 by deactivating the two dofs for ridtmd and eliminating the corresponding components in the matrices the same eoms of the 4 dof system can also be extracted from eq 6 of the 17 dof aero hydro servo elastic fowt model free vibration analysis of the spar tower system without damper can then be performed from which the tower side side angular eigenfrequency ω t s can be obtained for turning ridtmd 3 4 optimization procedure for the fowt mounted ridtmd the eigenfrequencies of the absorber and the inerter are written respectively as 27 ω d k d m d ω 2 k 2 b d next dimensionless parameters are defined to facilitate the parameter optimization the mass ratio and frequency ratio of the absorber m d are denoted μ d and α d while the inertance ratio frequency ratio and damping ratio of the inerter b d are denoted μ 2 α 2 and ζ 2 respectively they are defined as 28 μ d m d m 0 d t s 2 j r m 8 α d ω d ω t s μ 2 b d m 0 d t s 2 j r m 8 α 2 ω 2 ω t s ζ 2 c 2 2 b d k 2 where the tower side side eigenfrequency ω t s needs to be obtained from the eigenvalue analysis of the 4 dof spar tower system the four parameters of the ridtmd to be optimized are α d α 2 μ 2 and ζ 2 while the absorber mass ratio μ d is predetermined by the designer as shown in fig 5 random vibration theory is applied for parameter optimization by minimizing the standard deviation of the tower displacement σ q 8 similar to the procedure in zhang and høeg 2019 first nonlinear td simulation are performed using the 17 dof fowt model with linear spring mooring model subject to different environmental conditions in terms of mean wind speed v 0 turbulence intensity i significant wave height h s and peak period t p for a certain environmental condition n numbers n 50 100 of wind and wave realizations are generated based on which monte carlo simulations are carried out resulting in n time series of the 17 dimensional load vector the 6 dimensional load vector combining all contributions on the r h s of eq 25 can then be extracted from the 17 dimensional load vector to be more specific only the first 4 components of this 6 dimensional load vector are extracted from the 17 dimensional load vector while the last 2 components are always zero because they correspond to the dofs for the damper based on the n time series of the 6 dimensional load vector the 6 6 cross spectral density matrix function s f f ω is obtained in the following form 29 s f f ω s f 12 f 12 ω s f 12 f 13 ω s f 12 f 14 ω s f 12 f 8 ω 0 0 s f 13 f 13 ω s f 13 f 14 ω s f 13 f 8 ω 0 0 s f 14 f 14 ω s f 14 f 8 ω 0 0 s f 8 f 8 ω 0 0 s y m m e t r i c 0 0 0 where the diagonal term is the auto spectral density function and the off diagonal terms is the cross spectral density function between two load components s f f ω is a hermitian matrix meaning that the component s f j f i ω in the lower triangular part non shown in eq 29 is the complex conjugate of component s f i f j ω nielsen and zhang 2017 the diagonal term s f i f i ω and the off diagonal term s f i f j ω can be estimated from ensemble averages as 30 s f i f i ω e f f i ω 2 t s f i f j ω e f f i ω f f j ω t where e is the expectation operator over n samples means complex conjugate and t is the duration of each time series f f i ω denotes the fourier transform of one time series of load f i t using the estimated cross spectral density matrix function s f f ω as input to the 6 dof model the cross spectral density matrix function of the system response r q 12 q 13 q 14 q 8 u 1 u 2 t becomes nielsen and zhang 2017 31 s r r ω h ω s f f ω h t ω where h ω is the 6 dimensional frequency response matrix given by eq 26 the standard deviations of the tower side side displacement is then obtained 32 σ q 8 2 0 s q 8 q 8 ω d ω where s q 8 q 8 ω is the fourth diagonal component of s rr ω the standard deviation of other system responses can be obtained in a similar way optimal ridtmd parameters are determined such that σ q 8 is minimized as illustrated in fig 5 4 numerical results 4 1 verification of the 17 dof model by fast data from the nrel 5 mw reference wind turbine jonkman et al 2009 have been used to calibrate the wind turbine structural model and parameters of the spar type foundation oc3 hywind spar and mooring lines are referenced from jonkman 2010 table 1 summarizes some of the basic system parameters of the spar type fowt investigated in the present paper using the 4th order runge kutta algorithm with a time step of 0 02 s simulations of the 17 dof fowt model have been carried out in the td 1200 s duration for each simulation the steady state responses of the 17 dof fowt model are extracted from the simulation results and compared with those from fast fatigue areodynamics structure and turbulence software jonkman et al 2009 wind speeds ranging from cut in 3 m s to cut out 25 m s are considered the obtained system responses agree well with those from fast and some results are illustrated in fig 6 the upper two figures in fig 6 show the responses of structural components blade tower spar and fig 6 b shows some other quantities of the system including generator speed generator power generator torque rotor speed rotor power rotor thrust rotor torque pitch angle and the tip speed ratio it is seen that except for the spar yaw response the 17 dof model captures all other steady state responses very well both in terms of the changing tendency with wind speed and the exact amplitude the discrepancy in the spar yaw response is probably due to the fact that some nonlinear interactions are missing when exacting the system matrices from the left hand side of the lagrange equation in order to obtain eq 5 this issue is currently being investigated furthermore transient responses to a step input wind speed of 15 m s between the 17 dof model and fast are also compared fig 7 shows the out of plane responses of the fowt including blade flapwise vibration tower fore aft vibration and spar pitch motion the agreement is excellent in both time domain and frequency domain fourier amplitude spectrum fig 8 shows the in plane responses of the fowt including blade edgewise vibration tower side side vibration and spar roll motion in general they also agree well with the results from fast and all dynamics are well captured as seen from the spectral peaks in the fourier amplitude spectra some discrepancies in the tower side side vibration and spar roll motion are mainly due to the slightly different roll frequencies predicted by fast and the 17 dof model this might be attributed to the different drivetrain models used fast and the 17 dof model since the in plane motions are coupled to and influenced by the drivetrain dynamics the results in figs 6 8 indicate that the developed 17 dof model can be considered as a good basis for evaluating the performance of ridtmd and other damping devices on vibration suppression of fowts under realistic environmental load conditions by means of nonlinear td simulations 4 2 free vibration analysis of the uncontrolled spar tower system free vibration analysis of the spar tower system without ridtmd 4 dof system is carried out for better understanding the dynamic property and coupling effect the equations of motion of the 4 dof system is extracted from eq 25 by deactivating the 2 dofs related to ridtmd using data from the nrel 5 mw reference turbine jonkman et al 2009 and the oc3 hywind spar jonkman 2010 the parameters in the 4 dof model are calculated and shown in table 2 eigenvalue analysis of the 4 dof system follows from the equations of motion discarding the damping matrix and external force vectors table 3 illustrates the undamped angular eigenfrequencies for different cases considered the first three rows show the results under three different mean wind speeds v 0 where mode 1 mode 2 mode 3 and mode 4 correspond to sway heave roll and tower side side modes of the coupled system these are the true results obtained from eq 25 taking into account all mass and stiffness contributions it is observed that the eigenfrequencies vary with v 0 especially the sway frequency this is due to the inherently nonlinear nature of the mooring system which provides different stiffness contributions for different equilibrium states as already revealed in souza and bachynski 2019 fig 9 shows the mode shapes corresponding to the case of v 0 15 m s the mode shapes exhibit coupling behavior of the system especially for mode 3 and mode 4 mode 3 is dominantly the spar roll mode but also contains some tower side side component similarly mode 4 dominated by tower side side component contains some spar roll component in fact both modes 3 and modes 4 also very slightly contain sway component on the other hand mode 2 is a pure spar heave mode that excludes sway roll and tower side side motions the results in row four to row eight in table 3 have been obtained with v 0 15 m s the fourth row shows the results of the decoupled system with each eigenfrequency being calculated from the separate dof for example the eigenfrequency of mode 4 is obtained from the tower alone without the spar as in the case of fixed bottom wind turbines comparing the results in row one and row four it is observed that coupling to the spar roll motion when the off diagonal terms in m r are considered leads to a much higher tower side side frequency i e ω t s is shifted from 2 4190 rad s to 3 0105 rad s this should be accounted for when tuning the ridtmd i e the damper should be tuned to the tower side side frequency of the coupled system rather than the decoupled tower results in row five indicate that neglecting the rotor mass moment of inertia j r leads to the over prediction of tower side side frequency i e from 3 0105 rad s to 3 1115 rad s the roll frequency is also slightly over predicted ignoring the hydrodynamic added mass m h a leads to significant over prediction of all system frequencies as indicated by the results in row six furthermore ignoring the stiffness contribution from mooring lines results in under prediction of spar sway and heave frequencies while the tower side side frequency is not influenced the eigenfrequency of mode 1 sway becomes zero due to the fact that the system stiffness matrix becomes singular without the mooring line stiffness based on the above observations it is concluded that the complete format of eq 25 should be used for capturing the dynamics of the coupled system as well as for optimizing the ridtmd 4 3 parametric optimization the optimal design of ridtmd follows from the procedure in section 3 3 three different mass ratios are chosen i e μ d 0 005 0 01 0 02 corresponding to m d 2 04 10 3 kg 4 08 10 3 kg and 8 16 10 3 respectively furthermore two different load conditions lcs have been considered in the optimization 1 lc1 v 0 15 m s i 0 12 h s 4 m t p 10 s 2 lc2 v 0 15 m s i 0 12 h s 8 m t p 5 s for both lcs the angle between the incoming wave and the mean wind direction has been set to be 30 in order to account for the wind wave misalignment in the present study for each lc 100 realizations of the turbulent wind fields and irregular waves are generated based on which monte carlo simulations are performed using the 17 dof model this results in 100 time series of the load vector from which the cross spectral density matrix s ff ω is estimated and then employed as input for the 6 dof system in the fd as explained in fig 5 thus the randomness of the environmental loads is well accounted for in the damper optimization leading to a more robust design minimizing the statistical uncertainties than that based on a single time series table 4 shows the optimal parameters of ridtmd under lc1 as well as the resulting standard deviation of the tower vibration σ q 8 minimized and the standard deviation of damper stroke σ u 1 results of the fowt mounted tmd are also presented for comparison from table 4 the following observations can be made 1 for a same absorber mass ratio μ d the ridtmd consistently outperforms the tmd in reducing tower vibrations smaller value of σ q 8 note that the difference improvement is insignificant for this lc this is partly because the classic tmd is already a very effective vibration absorber and partly because σ q 8 contains contributions from other frequency components on which the vibration absorbers have no effect as will be elaborated in the following subsections this is also revealed by the fact that the increase of μ d leads to insignificant reduction in σ q 8 as well for both ridtmd and tmd 2 on the other hand the damper stroke of ridtmd is consistently larger than that of tmd 3 as μ d increases the optimal values of μ 2 and ζ 2 increase while there is no obvious tendency for α d and α 2 as for tmd the optimal value of α decreases and the optimal value of ζ increases as μ d increases table 5 shows the corresponding results under lc2 since the significant wave height is increased from 4 m to 8 m and the wave peak frequency 1 257 rad s becomes closer to the tower side side frequency the tower side side eigenvibration is much more significantly excited while most observations are similar to those from table 4 the following two differences are highlighted 1 for a given μ d the performance improvement by ridtmd becomes more significant in terms of larger difference in σ q 8 due to the fact that σ q 8 under lc2 is dominantly contributed by the tower side side eigenvibration at which the vibration absorbers are effective 2 under lc2 the optimal values of α d and α 2 decrease as μ d increases this implies that as q 8 t becomes more single mode dominated there is more clear tendency of optimal damper parameters with the change of μ d 4 4 ridtmd performance evaluation in the frequency domain fd in this subsection performance of the optimal ridtmd is evaluated in the fd fig 10 shows the auto spectral density functions in logarithmic scale of the tower side side displacement the spar roll and the damper stroke under lc1 based on eq 31 systems without control with optimal tmd μ d 0 005 and with optimal ridtmd μ d 0 005 are compared with the optimal damper parameters taken from table 4 fig 10 a shows that both tmd and ridtmd effectively suppress the spectral peak at the tower frequency while having no effects on the spectral peaks corresponding to spar roll 0 217 rad s and wave peak frequency 1 257 rad s the optimal ridtmd slightly outperforms the optimal tmd with the same absorber mass ratio in suppressing the spectral peak at tower frequency thus the tower side side vibration q 8 t as already given in table 4 the standard deviation of q 8 t calculated using eq 32 is σ q 8 60 3 mm 54 2 mm reduction ratio 10 1 and 53 9 mm reduction ratio 10 6 for the system without control with tmd and with ridtmd respectively for this load case the reduction ratio by ridtmd is only slightly larger because the spar roll frequency contributes considerably to the tower response which is not influenced by both dampers nevertheless as will be shown below ridtmd consistently outperforms tmd in suppressing the tower frequency component which is still beneficial to the fatigue life of fowt towers fig 10 b shows that the spar roll motion is coupled to the tower side side vibration with one insignificant spectral peak at the tower frequency this peak is also effectively suppressed by both tmd and ridtmd on the other hand the most dominant peak corresponding to roll frequency is hardly influenced although very slightly suppressed by the dampers finally fig 10 c shows the corresponding results of the damper stroke it is seen that the plateau around the tower frequency becomes slightly broader for the ridtmd implying that the damper stroke consisting contributions from all frequencies will turn out the be slightly larger for the fowt mounted ridtmd than the tmd counterpart as indicated by σ u 1 in table 4 to further reveal the mechanism of the dampers fig 11 shows some of the properties of the frequency response matrix given by eq 26 which is independent of the load conditions the same sets of damper parameters as in fig 10 are used fig 11 a shows the dynamic amplification factor daf of q 8 t exhibiting similar features around the tower side side frequency as in fig 10 a on the other hand the peak related to wave frequency is absent and the peak corresponding to spar roll is insignificant further it is clearly observed that tmd leads to double peaks around the tower frequency while ridtmd leads to triple peaks since one more dof is introduced for ridtmd which is actually also the case in fig 10 a fig 10 b shows the phase lag between the absorber motion and the tower side side displacement at the resonance frequency tower side side frequency the phase lag is around 90 for both tmd and ridtmd indicating the fundamental working principle of vibration absorbers in damping structural vibrations the 90 phase lag between the absorber displacement and the tower displacement implies that the absorber acceleration is in phase with the tower velocity and the 4 t h row 5 t h column component m d of m r in eq 16 is thus equivalent to an additional damping term for the tower vibration the performance of both tmd and ridtmd deteriorates as the tower vibrational energy shifts from the resonance frequency the phase lag increases towards 180 with increasing ω and decreases towards 0 with decreasing ω except at two low frequencies where coupling to spar roll and sway take place zhang and høeg 2019 for tmd the phase lag exhibits a gradual transition from 0 to 180 while for ridtmd the transition is much more abrupt around the resonance frequency with an extra change of curvature due to the extra dof introduced to ridtmd fig 12 shows the auto spectral density functions in logarithmic scale of the tower side side displacement the spar roll and the damper stroke under lc2 comparing fig 12 a with fig 10 a the tower side side vibration is now dominated by the tower eigenvibration single mode response due to the unfavorable load condition and the effect of installing vibration absorbers or increasing the absorber mass ratio becomes more significant σ q 8 turns out to be 137 8 mm 98 3 mm reduction ratio 28 7 and 96 2 mm reduction ratio 30 2 for the system without control with tmd and with ridtmd respectively this indicates that a more remarkable performance improvement is provided by ridtmd when the tower is experiencing more resonant vibrations further the increase of damper stroke of ridtmd in fig 12 c turns out to be more significant comparing with fig 10 c as also indicated by σ u 1 in table 5 4 5 ridtmd performance evaluation in the time domain td to verify the fd optimization and to evaluate the performance of ridtmd in a highly coupled fowt system the optimized damper is incorporated into the complete 17 dof model leading to a 19 dof fowt ridtmd model non linear td simulations 1200 s time duration are performed using the generated wind and wave time series with both the pitch controller and generator controller activated note that all the linearizations are avoided here i e nonlinearities in the mooring line aerodynamic and hydrodynamic models are retained fig 13 shows the performance of the optimal ridtmd and tmd on damping fowt vibrations in terms of the time series and the fourier amplitude spectrum under lc1 corresponding to the fd results in fig 10 the tower side side displacement q 8 t shown in fig 13 a is effectively suppressed by both the optimal tmd and ridtmd and ridtmd slightly outperforms its tmd counterpart from the time series the standard deviations of q 8 t are calculated to be 58 2 mm 52 1 mm and 51 6 mm for the system without control with tmd and with ridtmd respectively these values agree reasonably well with those calculated from the fd method in subsection 4 4 the fourier amplitude spectra q 8 ω obtained from the time series exhibit very similar features as from fig 10 a i e ridtmd leads to a further reduction of the spectral peak at the tower frequency and both dampers have no effect on the wave induced peak it is interesting to note that the spectral peak corresponding to spar roll frequency is also slightly suppressed by both tmd and ridtmd the time series in fig 13 b show that the dampers have slightly positive effect on the narrow banded spar roll motion q 14 t as well this is further revealed by the fourier amplitude spectra where the dominating peak at spar roll frequency is slightly lowered by both dampers moreover the influence of the dampers on blade edgewise vibration q 4 t is also evaluated and shown in fig 13 c although negligible both tmd and ridtmd positively affect the edgewise vibration which is favorable since the aerodynamic damping in this mode is normally very low fig 14 compares the relative absorber displacement damper stroke u 1 t under lc1 as seen from the time series in fig 14 a the damper stroke of ridtmd is slightly larger than that of tmd the standard deviations of which are σ u 1 143 8 mm and σ u 1 132 6 mm respectively these values agree reasonably well with those in table 4 the fourier amplitude in fig 14 b actually resembles the auto spectral density function in fig 10 c i e the frequency response of the damper stroke is more broad banded for ridtmd around the tower frequency although the peak frequency response is higher for tmd the overall absorber response is the summation of contributions from all frequencies and thus the damper stroke of ridtmd is slightly higher further it is seen that the absorber motion is dominated by the tower frequency since it s tuned to this frequency but it exhibits frequency components at spar roll frequency and wave peak frequency as well a very small peak at the blade edgewise frequency is also present implying the positive influence provided by the damper on edgewise vibrations it should be noted that the damper stroke is indeed an important design consideration due to the limited space inside the nacelle the damper stroke can be effectively reduced by increasing the mass ratio μ d at the cost of a heavier damper therefore it s a design tradeoff to choose the mass ratio so that the damper stroke is within the allowed value another option is to introduce a certain type of stroke limit mechanism hu and he 2017 in such case the system equation of motion needs to be modified which is beyond the scope of the present paper fig 15 shows the performance of the optimal ridtmd and tmd on damping fowt vibrations under lc2 corresponding to the fd results in fig 12 as seen from fig 15 a more remarkable tower side side eigenvibrations are excited under lc2 as revealed by the dominating spectral peak at the tower frequency the equipped ridtmd or tmd effectively suppresses this peak resulting in significantly reduced tower side side displacement as shown in the time series the standard deviation σ q 8 is decreased from 133 5 mm without control to 98 6 mm with tmd and 95 7 mm with ridtmd respectively again they agree well with the fd results presented in subsection 4 4 thus verifying the developed reduced order model similar to the observations in fig 13 a the dampers also slightly suppress the spectral peak at the spar roll frequency while having no effect on the wave induced spectral peak further the spar roll motion shown in fig 15 b is marginally suppressed by the dampers in fine consistence with fig 13 b finally as shown in fig 15 c the blade edgewise vibration is again positively affected by the dampers due to the coupling between blade edgewise vibration and the tower side side vibration to further reveal the performance of the passive dampers on suppressing tower vibrations at higher wind speeds e g around cut out wind speed a new load case lc3 is defined with v 0 25 m s i 0 02 h s 8 m s and t p 5 s one set of realizations of the turbulent wind field and the irregular wave for lc3 is then generated fig 16 shows the performance of ridtmd and tmd on suppressing vibrations of the fowt subjected to the generated excitations for lc3 where the same damper parameters as in fig 15 are used this means that the dampers used for lc3 are non optimal since they have been optimized for lc2 from fig 16 a it is seen that both non optimal dampers effectively suppress tower side side vibrations for lc3 a high wind speed while the non optimal ridtmd still slightly outperforms the non optimal tmd actually it has also been verified not shown here that if the dampers optimized for lc1 are used for lc2 and lc3 the non optimal ridtmd consistently outperforms the non optimal tmd it should be noted that a general conclusion that the non optimal ridtmd always outperforms the non optimal tmd for all load cases can not be drawn from the above findings nevertheless these results reveal that the performance of the passive ridtmd is quite robust as long as it has been optimized to a realistic environmental condition in practice it is suggested that the most critical environmental condition leading to the largest fatigue damage contribution should be chosen as the load condition for optimizing the damper 5 conclusions this paper investigates a novel inerter enhanced vibration absorber the rotational inertia double tuned mass damper ridtmd for vibration damping of tower side side vibrations in a fowt both a fully coupled 17 dof fowt model and a reduced order 6 dof spar tower ridtmd model have been established the former is employed for performance evaluation of ridtmd on damping fowt vibrations by non linear td simulations the latter is used for better understanding the dynamics of the coupled system as well as robust optimization of ridtmd in the fd it is observed that system dynamics eigenfrequencies mode shapes can only be accurately captured when taking into account the coupled spar tower vibration the rotor mass moment of inertia the hydrodynamic added mass as well as stiffness contributions from the hydrostatic buoyancy and mooring lines these are essential for tuning the ridtmd with varying mean wind speed the spar sway and roll eigenfrequencies change but the tower eigenfrequency is unchanged thus this is of minor importance for tuning the damper the reduced order model enables robust optimization of fowt mounted ridtmd in the fd accounting for the stochastic nature of wind and wave excitations it turns out that the optimal parameters of ridtmd depend on the offshore environmental condition especially the two frequency ratios while the inertance ratio and damping ratio of the inerter are quite invariant from the auto spectral density functions it is seen that the optimal ridtmd consistently outperforms the optimal tmd with a same absorber mass ratio in terms of lowered spectral peak around the tower frequency and smaller standard deviation of q 8 t the curves of dynamic amplification factor more clearly indicate that while tmd leads to double peaks around the tower frequency ridtmd leads to triple peaks due to the extra dof extra resonance introduced to the ridtmd finally the optimally tuned ridtmd has been incorporated into the 17 dof model at the tower top to evaluate the damper performance in a highly coupled fowt system in the td simulation results show that both tmd and ridtmd exhibit encouraging performance in damping vibrations of a fowt under realistic wind and wave loads ridtmd consistently outperforms tmd in damping tower side side vibrations at the cost of slightly increased damper stroke both the spar roll and blade edgewise vibration are very slightly suppressed by the dampers therefore ridtmd is regarded as a promising device for vibration damping of tower vibrations in fowt further the td results agree very well with the fd results and the two models developed in this study can be employed as useful tools for the design and analysis of fotw mounted vibration absorbers credit authorship contribution statement zili zhang conceptualization investigation software writing original draft writing review editing christian høeg software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the supports of aarhus university research foundation under the auff assistant professor starting grant auff e 2017 7 20 and the committee of science and technology of shanghai china grant no 18160712800 are highly appreciated appendix a for the case of tmd the expressions of the 5 dimensional matrices m r c r and k r are given by 33 m r m 0 m t m s m d 0 m 0 m d h r m t h t n 3 m 0 n 1 m d m d 0 m 0 m t m s m d 0 0 0 m 0 m d h r m t h t n 3 0 m 0 m d h r 2 m t h t 2 j t 2 n 3 h t j s j r m 0 m d h r n 1 h t n 2 d t s j r m d h r m 0 n 1 m d 0 m 0 m d h r n 1 h t n 2 d t s j r m 0 m 8 d t s 2 j r m d m d m d 0 m d h r m d m d 34 c r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 ζ 8 m 8 k 8 0 0 0 0 0 c d k r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k 8 0 0 0 0 0 k d 
21034,this paper investigates the use of an inerter enhanced vibration absorber the rotational inertia double tuned mass damper ridtmd for damping in plane vibrations of a floating offshore wind turbine fowt first a 17 degree of freedom 17 dof aero hydro servo elastic model for the fowt is developed and verified based on which the damper performance can be evaluated in the time domain td with realisitc load conditions next a reduced order 6 dof model is established for the ridtmd controlled fowt in plane vibrations including rotor mass moment of inertia hydrodynamic added mass as well as stiffness contributions from mooring lines and buoyancy this model enables revealing the dynamics of the coupled spar tower ridtmd system and provides an efficient yet robust procedure for optimal tuning of the fowt mounted ridtmd in the frequency domain fd comparison of the optimal ridtmd and the optimal tmd is performed in both fd and td it is seen that both tmd and ridtmd effectively suppress tower side side vibrations when mounted at the tower top ridtmd consistently outperforms tmd due to the extra dof extra resonance introduced into the device at the cost of slightly larger damper stroke both dampers positively influence spar roll motion and blade edgewise vibration as well keywords inerter tuned mass damper floating wind turbine coupled system frequency domain model aero hydro servo elastic 1 introduction wind turbines are being installed further offshore where the wind speeds are higher and more steady for areas with water depth larger than 60 m floating offshore wind turbines fowts turn out to be the most reasonable solution jonkman 2007 cheng et al 2017 different concepts of floating foundations platforms have been proposed with four of them being most popular spar buoy tension lag tlp barge and semi submersible pérez collazo et al 2015 jonkman and matha 2011 several prototypes with different foundation concepts have already been developed for demonstration purposes including windfloat roddier et al 2010 fukushima floating wind farm fukushima forward 2016 and hywind scotland windeurope 2017 a fowt is a complex coupled system in harsh environmental conditions subjected to aerodynamic hydrodynamic mooring and controller loads the structural vibrations in the blades and supporting structures of fowt are generally larger than those of fixed foundation wind turbines for a same wind turbine model it has been shown that the fatigue damage equivalent loads dels of tower base moment is 1 7 times for spar foundation 2 5 times for tlp and 7 times for barge compared to the monopile foundation jonkman and matha 2010 it is well known that while the out of plane vibrations tower fore aft and blade flap wise vibrations exhibit very high aerodynamic damping the in plane vibrations tower side side and blade edgewise vibrations are very lightly damped due to the negligible aerodynamic damping under normal operational conditions hansen 2007 zhang et al 2014a the motions of the floating platform surge sway heave pitch roll and yaw will increase the tower response due to the effect of large inertia and gravity moreover wind wave misalignment hildebrandt et al 2019 and wave current interaction chen and basu 2019 may further excite the lightly damped in plane fowt vibrations according to the danish wind turbine industry cross wind vibration side side vibration due to wave loading misaligned with wind turbulence often has a significant influence on the fatigue lifespan of offshore wind turbine foundations damgaard et al 2013 besides it also result in increased maintenance which is particularly unfavorable for fowts installed very far offshore hence there is great need to apply vibration suppression control techniques on the fowt for improving its fatigue life stability and survivability there are two types of vibration control techniques for fowts i e aerodynamic control and structural control aerodynamic control utilizes the blade pitch controller to change the rotor aerodynamic thrust larsen and hanson 2007 jonkman 2008 namik and stol 2010 goupee et al 2017 which is mainly effective in mitigating out of plane loads on the tower and platform it is especially promising for suppressing the low frequency platform pitch motion because of the large moment arm from the blades to the spar however it has the drawbacks of increased pitch actuator usage and rotor speed variation as well as no influence on the lightly damped in plance fowt vibrations on the other hand structural control using vibration absorbers turns out to be a promising alternative for fixed foundation wind turbines different types of vibration absorbers have been proposed and investigated including the classic tuned mass damper tmd stewart and lackner 2014 zhang 2020 fitzgerald et al 2013 jiang 2018 the pendulum type absorbers argyriadis and hille 2004 zhang et al 2014b 2014c the tuned liquid dampers colwell and basu 2009 zhang et al 2019 recently viscous type hybrid dampers have also been proposed to be mounted at the tower bottom brodersen and høgsberg 2016 which was also experimentally investigated brodersen et al 2016 employing structural control to fowt is a relatively new and developing area of research lackner and rotea developed a simulation tool based on fast fatigue aerodynamics structures and turbulence with the capability to model pasive semi active and active tmds in fowts lackner and rotea 2011a using this tool passive and active tmds have been investigated for a barge type fowt lackner and rotea 2011b however since the tmd is tuned to the low frequency platform pitch mode the damper stroke turns out to be too large up to 20 m to be practically feasible si et al 2014 carried out a similar study for a spar type fowt where a passive tmd tuned to the pitch mode is installed inside the spar multiple passive tmds were proposed to be installed inside the nacelle and spar of spar type fowts dinh and basu 2015 resulting in tremendous extra mass this concept was further extended to multiple semi active tmds using the short time fourier transform stft algorithm dinh et al 2016 artificial fish swam algorithm has also been proposed for optimizing the multiple passive tmds jin et al 2018 more recently active control of a barge type fowt was investigated using a nacelle installed stroke limited hybrid mass damper hmd hu and he 2017 however the impulsive load from collision between the mass and the limiter might induce unfavorable high frequency vibrations in the tower besides tmds liquid damper is an interesting alternative for vibration damping of fowts a classic tuned liquid column damper tlcd installed in the nacelle has been investigated for suppressing in plane fowt vibrations zhang and høeg 2019 a novel tuned liquid multi column damper tlmcd installed inside the floater was proposed for damping rotational motion of a barge type fowt coudurier et al 2018 moreover multilayer tuned liquid damper tld was also proposed for mitigating platform pitch motion of a spar type fowt ha and cheong 2016 comparing with liquid dampers tmd has the advantages of large effective mass linear behavior for accurate modelling and parameter calibration thus it is normally preferred however most of the previous studies focus on damping the low frequency pitch mode resulting in either a tremendous tmd mass or a very large damper stroke this is due to the fundamental working principle of tmd i e it imparts external damping to the structure though the inertial force that is proportional to ω 2 with ω being the eigenfrequency the tmd is tuned to therefore tmd is very ineffective for damping low frequency motions installing the tmd inside the platform further deteriorates its efficiency in damping pitch motion due to the very small moment arm for generating the damping moment using the aerodynamic control method i e the blade pitch controller will be a much better solution on the other hand the tmd will be much more effective if it is tuned to the relatively high frequency tower mode and is installed at the tower top nacelle recently inerter based vibration absorbers have been extensively investigated for damping vibrations in mechanical or civil engineering structures inerter smith 2002 is a two terminal mechanical device transforming the translational motion into high speed rotational motion leading to a significantly amplified inertial force than that generated by its physical mass papageorgiou and smith 2005 this indicates an apparent mass that is much larger than its physical mass different apparent mass amplification mechanisms for the inerter have been proposed including the rack and pinion mechanism smith 2002 the ball screw mechanism wang et al 2009 and hydraulic mechanism wang et al 2011 the inertial force generated by the device is proportional to the relative acceleration between the terminals with the proportionality constant being termed the inertance different types of inerter based vibration absorbers can be achieved by assembling the inerter with the mass spring and dashpot linear viscous damper elements in different configurations hu and chen 2015 two most popular ones are the tuned inerter damper tid lazar et al 2014 2016 by placing the inerter in series with a parallel spring dashpot element and the tuned mass damper inerter tmdi marian and giaralis 2014 giaralis and taflanidis 2018 by connecting the inerter in series with a classic tmd it has been shown that the tid outperforms the classic viscous damper lazar et al 2016 while the tmdi outperforms the classic tmd marian and giaralis 2014 when one terminal of the inerter is connected to the supporting ground to generate large relative motion between the two terminals of the complete device this is difficult to be achieved in fowts and hence alternative configurations are needed ikago et al 2012 invented a novel mechanical device named the tuned viscous mass damper tvmd it consists of a viscous mass damper vmd and a spring connected in series within the vmd an inerter or rotational inertial mass employing the ball screw amplifying mechanism is connected to a dashpot in parallel a possible design of the vmd has been given in ikago et al 2012 and will be further explained in section 3 of the present paper a similar device named the rotational inertia damper has also been proposed in hwang et al 2007 using the ball screw mechanism in principle other mechanisms such as the rack and pinion mechanism can also be employed for constructing the vmd based on tvmd a novel inerter based vibration absorber the rotational inertia double tuned mass damper ridtmd was proposed garrido et al 2013 the idea of a ridtmd is to replace the dashpot in a classic tmd by a tvmd and therefore the ridtmd can be attached to the structure exactly the same manner as a tmd it has been shown that ridtmd the enhanced tmd outperforms the classic tmd with a same absorber mass on a single degree of freedom sdof system garrido et al 2013 based on the fixed point theory barredo et al 2018 developed closed form formulas for the optimal design of ridtmd again assuming the structure to be a sdof system taking into account the ease of installation and the enhanced performance compared with tmd ridtmd turns out to be a very promising device for vibration suppression of fowts the present paper aims to investigate the performance of a nacelle mounted ridtmd on damping in plane vibrations of a spar type fowt with focus on the lightly damped tower side side vibrations since the fowt is a highly coupled system the previous result for optimal damper calibration garrido et al 2013 barredo et al 2018 cannot be applied here the modeling optimal design and analysis of the fowt mounted ridtmd must be performed based on the coupled system fluid mooring spar tower system rather than the decoupled tower itself first a 17 dof aero hydro servo elastic model is developed for the fowt system taking into consideration the full coupling of blade drivetrain tower spar mooring vibrations as well as fluid structure interaction verified by good agreement with fast this model can be used for performance evaluation of ridtmd in a fully coupled fowt system subject to realistic load conditions by nonlinear time domain td simulations next a reduced order 6 dof model is derived for ridtmd controlled fowt in plane vibrations including spar sway heave and roll motions as well as tower side side vibration stiffness contributions from hydrostatic buoyancy and mooring lines as well as hydrodynamic added mass are included in the system matrices the model enables an efficient and robust procedure for optimal design of fowt mounted ridtmd in the frequency domain fd using random vibration theory where the input spectrum is obtained from the 17 dof model moreover it is found from free vibration analysis that the tower side side frequency can only be accurately captured when accounting for the coupled spar tower vibration the hydrodynamic added mass and the stiffness contributions from buoyancy and mooring lines finally the optimized ridtmd is incorporated into the 17 dof model and nonlinear td simulations are performed to evaluate and compare the performance of ridtmd with that of an optimal tmd results show that the proposed ridtmd outperforms the classic tmd with a same absorber mass in damping tower side side vibrations at the cost of slightly increased but practically feasible damper stroke ridtmd has a positive influence on spar roll and blade edgewise vibration as well 2 17 dof aero hydro servo elastic model for the fowt system a 17 dof aero hydro servo elastic model is developed for the highly coupled fowt system using combined multi body dynamics and modal based methods høeg and zhang 2021 this model takes into account the most important features of a floating wind turbine including coupled spar tower blade drivetrain vibrations time varying system matrices quasi static nonlinear aeroelasticity and wave structure interaction as well as generator and pitch controllers the dofs and coordinate systems frame of references are defined in fig 1 and fig 2 the motions of the floating foundation the spar are specified in the fixed global x 1 x 2 x 3 coordinate system with origin fixed at the cog of the complete fowt system the global cog when the fowt is undisplaced the tower vibrations are specified in the local tower x 1 x 2 x 3 coordinate system with origin fixed at the tower bottom the blade vibrations are specified in the local blade x 1 x 2 x 3 coordinate system one for each blade with origin fixed at the hub center root of the blade the tower height top to bottom is denoted h t and the height from the global cog to the tower bottom is denoted h t both the blades and the tower are modeled as euler benoulli beams with variable mass per unit length and variable bending stiffness while their axial deformations are neglected they are modeled by modal based approach i e generalized coordinates dofs and the corresponding prescribed mode shapes each blade is associated with two dofs q j t and q j 3 t j 1 2 3 denoting the flapwise and edgewise tip displacements respectively the associated mode shapes are prescribed as the undamped fundamental eigenmodes φ f x 3 and φ e x 3 in the flapwise and edgewise directions for a non rotating blade the tower is associated with two translational dofs q 7 t and q 8 t denoting the tower fore aft and side side vibrations respectively and a torsional tower yaw dof q 17 t the associated mode shapes are the undamped fundamental eigenmodes of tower fore aft side side and torsional vibrations φ t f x 3 φ t s x 3 and φ t t x 3 respectively as shown in fig 2 the flexible drivetrain is modeled using st venant torsional theory with two dofs q 9 t and q 10 t denoting the deviations of the angular positions at the hub and at the generator rotor from the nominal angular positions ω 0 t and n ω 0 t respectively with ω 0 being the rated rotational speed of the rotor and n being the gear ratio hence q 9 t and q 10 t indicate the deviations of the rotational speeds at the hub and the generator from the nominal values as a result ω t ω 0 q 9 t is the actual rotor speed and ω g t n ω 0 q 10 t is the actual rotational speed at the generator further the rotor overhang along the main shaft and the height from tower top to the main shaft are denoted s and h s respectively the azimuthal angle of blade j relative to the nacelle can be written as 1 ψ j t ω 0 t q 9 t j 1 2 π 3 j 1 2 3 the floating spar is modeled by six rigid body dofs q 11 t q 12 t q 13 t q 14 t q 15 t and q 16 t denoting surge sway heave roll pitch and yaw motions respectively both the spar motions and tower vibrations will induce velocity contributions to the blade cross sections leading to highly coupled system matrices for example the velocity vector v b j x 3 t of a blade cross section can be obtained as the time derivative of the position vector r b j x 3 t which is expressed in the fixed global x 1 x 2 x 3 coordinate system as 2 r b j x 3 t q 11 t q 12 t q 13 t t f t u t 1 h t t u t 2 h t t h t h t t t o t 0 0 h s t t s 0 0 t b j t u b 1 j x 3 t u b 2 j x 3 t x 3 where t f t t t o t t t and t b j t are the coordinate transformation matrices due to the foundation rotations the tower top rotations the shaft tilt and blade j s rotation respectively høeg and zhang 2021 u t 1 x 3 t and u t 2 x 3 t are the tower fore aft and side side displacement fields and u b 1 j x 3 t and u b 2 j x 3 t are the blade flapwise and edgewise displacement fields in the present study the axial deformations of the blade and the tower are neglected using modal based formulation u b 1 j x 3 t u b 2 j x 3 t u t 1 x 3 t and u t 2 x 3 t are expressed as 3 u b 1 j x 3 t φ f x 3 q j t u b 2 j x 3 t φ e x 3 q j 3 t j 1 2 3 u t 1 x 3 t φ t f x 3 q 7 t u t 2 x 3 t φ t s x 3 q 8 t further the tower top rotations follow directly from u t 1 x 3 t and u t 2 x 3 t based on euler bernolli beam theory these two tower top rotations together with tower top torsion provide components in the transformation matrix t t o t the foundation rotational dofs q 14 t q 15 t and q 16 t provide components in the transformation matrix t f t the velocity vectors for all structural components including v b j x 3 t are derived symbolically in matlab the total kinetic energy t and total potential energy u of the fowt system are formulated høeg and zhang 2021 and they are then inserted into the lagrange equation pars 1979 4 d d t t q t q u q c s q f g e n t f a t f g t f b t f h t f m t which leads to the equations of motion eoms of the 17 dof fowt model 5 m t q t g t c s q t k t q t f g e n t f a t f g t f b t f h t f m t with m t g t k t being the 17 by 17 time variant mass gyroscopic and stiffness matrices respectively they are extracted from the left hand side of the lagrange equation eq 4 by assuming small rotations angles and neglecting second and higher order small terms høeg and zhang 2021 q t is the 17 dimensional dof vector c s is the structural damping matrix f g e n q t t f a q t t f g q t t f b q t f h q t q t t f m q t t are the modal load vectors due to generator controller aerodynamics gravity hydrostatic buoyancy hydrodynamics and mooring lines respectively høeg and zhang 2021 f g e n q t t depends nonlinearly on q t more specifically on q 10 t due to the generator control law f a q t t is obtained by the classic blade element momentum bem theory hansen 2008 with glauert s turbulence wake and prandtl s tip loss corrections nonlinear quasi static aeroelasticity is taken into account by including the velocity components of blade cross section into the calculation of the angle of attack this implies that f a q t t depends nonlinearly on q t the rotational sampled turbulence field is generated zhang et al 2014a with mean wind speed v 0 and turbulence intensity i f b q t depends linearly on q t as will be shown in section 3 f h q t q t t is calculated using morrison s formula taking into account the wave structure interaction faltinsen 1993 f h q t q t t depends linearly on q t and nonlinearly on q t the sea surface elevation is modeled as a zero mean stationary gaussian process from the jonswap spectrum hasselmann et al 1973 the significant wave height and the peak period are denoted h s and t p respectively regarding f m q t t different mooring line models have been established høeg and zhang 2018 including linear spring nonlinear quasi static and lumped mass nonlinear dynamic models in the present study quasi static model is used for performance evaluating of the ritmd in fowt system by means of nonlinear td simulations while linear spring model is used for parametric optimization of ridtmd as will be detailed in section 3 moreover as detailed in høeg and zhang 2021 f b q t can be further written as f b q t f b 0 k h s q t with f b 0 being the static buoyancy load vector with the only non zero component in the heave direction and k h s being the hydrostatic restoring matrix f h q t q t t can be further written as f h q t q t t f h q t t m h a q t with f h q t t being the hydrodynamic load vector due to nonlinear drag and m h a being the hydrodynamic added mass matrix as proposed in jonkman 2010 an additional damping matrix c a d d with non zero components related to spar dofs is also added in order to match the free decay response of the spar from the test data therefore by explicitly introducing these linear dependency relationships the eoms of the 17 dof can be rewritten as 6 m t m h a q t g t c s c a d d q t k t k h s q t f g e n t f a t f g t f b 0 t f h t f m t finally a collective pitch controller activated when the wind speed is above rated is incorporated into the 17 dof model with actuator dynamics modeled by a 1st order filter zhang 2015 the pitch demand is formulated as a gain scheduled pi controller jonkman et al 2009 with feedback from q 9 t and q 9 t finally a variable speed generator controller is incorporated whose generator torque is dependent on the generator speed ω g t jonkman et al 2009 all details of this 17 dof model can be found in høeg and zhang 2021 3 reduced order model for the coupled spar tower ridtmd system 3 1 overview of the reduced order model the 17 dof model represents a time variant system that rules out the use of frequency domain method for the efficient optimization of ridtmd as proposed in pegalajar jurado et al 2018 hegseth and bachynski 2019 a cascading approximation can be applied for establishing frequency domain models of fowt for the preliminary design evaluation and quick load analysis of fowt a similar methodology is used in the present study for the damper optimization in this section a reduced order 6 dof time invariant model is established for in plane vibrations of fowt installed with a ridtmd 4 dofs of the fowt are included i e spar sway heave and roll motions together with the tower side side vibration while the other 2 dofs are for the ridtmd strictly speaking heave motion defined in the x 3 axis should not be regarded as in plane motion however since the heave dof is coupled to the damper dofs as shown below it is included in the reduced order model the rotor blades are assumed rigid and non rotating meaning that the dofs related to the blades and drivetrain are discarded however the lumped mass of the nacelle rotor system and the mass moment of inertia of the rotor should be accounted for in the reduced order model as shown in the following the same notations as in section 2 are used for the selected dofs i e q 12 for sway q 13 for heave q 14 for roll and q 8 for tower side side vibration such a simplified model enables revealing the fundamental mechanism of the coupled spar tower ridtmd system and facilitates an efficient and robust optimization procedure for the fowt mounted ridtmd the linear time invariant property of the 6 dof model makes it possible to apply the frequency domain method for the damper optimization a similar 5 dof model is also established for the spar tower tmd system where only one dof is needed for the tmd optimization of the fowt mounted tmd can be performed following the same procedure as for the 6 dof model this enables performance comparison of the optimal ritmd with optimal tmd on reducing tower vibrations of the fowt in the following only the formulation of the 6 dof model is detailed as mentioned in section 1 the tvmd consists of a vmd and a spring being connected in series one possible design schematic of the vmd is shown in fig 3 a the ball screw mechanism translates the linear motion resulting from the structural vibration into high speed rotational motion of the rotational mass flywheel and the internal tube energy dissipation takes place in the viscous damper due to the relative rotation between the internal tube and the external tube ikago et al 2012 fig 3 b shows the equivalent mechanical model of the vmd i e the inerter and the dashpot are placed in parallel 3 2 kinetic energy and potential energy formulation fig 4 shows the schematic representation of a fowt with rigid non rotating rotor blades equipped with a ridtmd or a tmd at the nacelle top of the tower comparing with fig 1 in this section only in plane vibrations are taken into account and the motion is assumed to be two dimensional here x 2 x 3 is the fixed global coordinate system with origin fixed at cog of the undeformed system and x 2 x 3 is the local tower coordinate system with origin attached to the tower bottom the hydrodstatic buoyancy is acting at the center of buoyancy cob which is h b g distance higher than cog the linear spring model is used for the mooring lines so that a linear system model can be obtained neglecting second and higher order nonlinear terms the velocity vector of a tower cross section is described in the local tower x 2 x 3 coordinate system as 7 v t x 3 t 0 q 12 t h t x 3 q 14 t φ t s x 3 q 8 t q 13 t where h t is the distance from the tower bottom to the origin of the global x 2 x 3 coordinate system φ t s x 3 is the fundamental tower side side mode shape of the decoupled tower as introduced in section 2 evaluating eq 7 at the tower top x 3 h t φ t s h t 1 with h t being the tower height the velocity vector of the nacelle can thus be obtained 8 v n t 0 q 12 t h r q 14 t q 8 t q 13 t where h r h t h t is the distance from the tower top to the origin of the x 2 x 3 coordinate system cog of the undeformed system although the blade dofs are discarded due to the rigid rotor assumption the mass moment of inertia of the rotor will influence the system dynamics and should be accounted for this is done by formulating the velocity vector of a blade cross section in the local blade coordinate system using the similar multi body formulation as in eq 2 for the reduced 6 dof system the velocity vector of a cross section in blade j can be expressed in the local blade coordinate system as 9 v b j x 3 t 0 x 3 θ 1 t q 14 t cos ψ j q 12 t h r q 14 t q 8 t sin ψ j q 13 sin ψ j q 12 t h r q 14 t q 8 t cos ψ j q 13 with x 3 being the distance from the cross section to the hub the azimuthal angle is ψ j ω t j 1 2 π 3 here θ 1 is the tower top rotational speed due to elastic deformation around x 1 axis which is obtained based on euler bernoulli beam theory as 10 θ 1 t φ t s h t q 8 t d t s q 8 t where φ t s h t d φ t s x 3 d x 3 x 3 h t is the first derivative of the tower side side mode shape evaluated at the tower top the constant d t s with the unit m 1 is introduced for compactness as shown in fig 4 the ridtmd is composed of an absorber mass m d attached to the tower top via a spring with spring stiffness k d and a tvmd placed in parallel within the tvmd the spring stiffness of the secondary spring is k 2 the damping coefficient of the dashpot is c 2 and the inertance of the inerter is b d the physical mass of the inerter is negligible comparing with m d and b d in contrast to the classic tmd where only one extra dof is needed for describing its motion two dofs are needed for describing the motion of the ridtmd the displacement of the absorber mass relative to the displaced tower top is denoted u 1 t and the displacement of the inerter relative to the displaced tower top is denoted u 2 t it should be noted that u 2 t also indicates the deformation of the secondary spring k 2 therefore q 12 q 13 q 14 q 8 u 1 t and u 2 t make up the dofs of the 6 dof spar tower ridtmd system neglecting second and higher order nonlinear terms the velocity vectors of the absorber mass and the inerter are written in the local tower coordinate system as 11 v m d t 0 q 12 t h r q 14 t q 8 t u 1 t q 13 t v b d t 0 q 12 t h r q 14 t q 8 t u 2 t q 13 t hence the total kinetic energy of the 6 dof spar tower ridtmd system becomes 12 t 6 d o f 1 2 m n m h v n t 1 2 j 1 3 0 l b μ b x 3 v b j x 3 v b j x 3 d x 3 1 2 0 h t μ x 3 v t x 3 t v t x 3 t d x 3 1 2 m s q 12 2 t q 13 2 t 1 2 j s q 14 2 t 1 2 m d v m d t v m d t 1 2 b d u 1 t u 2 t 2 where m n and m h are the masses of the nacelle and hub respectively μ b x 3 and μ x 3 are the mass per unit length of the blade and the tower respectively m s and j s are the mass and mass moment of inertia of the spar respectively the total potential energy of the system is 13 u 6 d o f 1 2 k 8 q 8 2 t 1 2 k d u 1 2 t 1 2 k 2 u 2 2 t where k 8 is the tower side side modal stiffness written as 14 k 8 k 8 e k 8 g 0 h t e i x 3 d 2 φ t s x 3 d x 3 2 2 d x 3 0 h t g m 0 x 3 h t μ x 3 d x 3 d φ t s x 3 d x 3 2 d x 3 with k 8 e and k 8 g being the elastic and geometric due to gravity contributions to k 8 respectively e i x 3 is the tower side side bending stiffness the hydrostatic buoyancy and the mooring lines contribute to the system stiffness while the added mass from hydrodynamics contributes to the system mass these will be included in subsection 3 3 3 3 equations of motion inserting the kinetic energy and potential energy presented in eqs 12 and 13 into the lagrange equation pars 1979 the equations of motion of this reduced order 6 dof model can be obtained 15 m r r t c r r t k r r t f r a t f r g t f r b t f r h t f r m t where r q 12 q 13 q 14 q 8 u 1 u 2 t is the 6 dimensional dof vector f r a t f r g t f r b t f r h t and f r m t are the 6 dimensional load vectors due to aerodynamics gravity hydrostatic buoyancy hydrodynamics and the mooring system respectively as will be described in the following the mass matrix m r is given by 16 m r m 0 m t m s m d 0 m 0 m d h r m t h t n 3 m 0 n 1 m d m d 0 0 m 0 m t m s m d 0 0 0 0 m 0 m d h r m t h t n 3 0 m 0 m d h r 2 m t h t 2 j t 2 n 3 h t j s j r m 0 m d h r n 1 h t n 2 d t s j r m d h r 0 m 0 n 1 m d 0 m 0 m d h r n 1 h t n 2 d t s j r m 0 m 8 d t s 2 j r m d m d 0 m d 0 m d h r m d m d b d b d 0 0 0 0 b d b d where m 0 m n m h 3 m 0 is the total lumped mass at tower top with m 0 being the mass of each blade m t 0 h t μ x 3 d x 3 is the total mass of the tower j t 0 h t μ x 3 x 3 2 d x 3 is the mass moment of inertia of the tower with respect to the tower bottom j r 3 0 l b μ x 3 x 3 2 d x 3 is the mass moment of inertia of the rotor m 8 0 h t μ x 3 φ t s 2 x 3 d x 3 is the tower side side modal mass n 1 n 2 and n 3 are three constant coefficients defined as 17 n 1 0 h t μ x 3 φ t s x 3 d x 3 n 2 0 h t μ x 3 φ t s x 3 x 3 d x 3 n 3 0 h t μ x 3 x 3 d x 3 the damping matrix c r and stiffness matrix k r are given by 18 c r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 ζ 8 m 8 k 8 0 0 0 0 0 0 c 2 c 2 0 0 0 0 c 2 c 2 k r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k 8 0 0 0 0 0 0 k d 0 0 0 0 0 0 k 2 where ζ 8 is the modal damping ratio of the tower side side mode the corresponding 5 by 5 matrices m r c r and k r for the case of tmd are given in appendix a both the mooring lines and the hydrostatic buoyancy introduce additional stiffness to the fowt system to quantify the stiffness contribution of the mooring lines the linear spring model is employed in this section this is done by linearization around the spar equilibrium position using the catenary formulations jonkman 2010 the mooring system load vector can thus be written as 19 f r m t f r m 0 v 0 k m o o r v 0 r t where f r m 0 v 0 0 f r m 0 v 0 0 0 0 0 t is the static mooring load and k m o o r v 0 is the 6 by 6 stiffness matrix resulted from the mooring lines both dependent on the mean position of the spar thus the mean wind speed v 0 since the mooring line behavior is inherently nonlinear they are obtained by numerical linearization using the catenary solution at a given equilibrium state dependent on v 0 høeg and zhang 2018 it should be noted that since current is not considered in the present paper the influence of waves on the mean position of the spar is negligible waves only influence the motion amplitude so f r m 0 v 0 and k m o o r v 0 can be considered to be only dependent on v 0 the hydrostatic buoyancy load vector f r b t can be expressed as faltinsen 1993 20 f r b t f r b 0 k r h s r t 0 ρ w g v s 0 0 0 0 0 0 0 0 0 0 0 π 4 ρ w g d 1 2 0 0 0 0 0 0 ρ w g h b g v s π d 1 4 64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r t where f r b 0 is the static buoyancy load and k r h s is the stiffness matrix resulted from hydrostatic buoyancy ρ w is the sea water density v s is the displaced water volume volume of the submerged part of spar and d 1 is the spar top diameter the hydrodynamic load vector f r h t is calculated by means of morison s formula faltinsen 1993 along with the strip theory for the spar type fowt the radiation damping in terms of convolution integral is negligible comparing with the viscous damping from morison s formula høeg and zhang 2019 and is thus excluded in the present study the hydrodynamic load per unit length acting at cross section x 3 of the spar in the global x 2 direction is expressed as 21 p r h x 3 t 1 2 ρ w c d d x 3 v r e l x 3 t v r e l x 3 t π 4 ρ w c m d 2 x 3 a w x 3 t π 4 ρ w c m 1 d 2 x 3 a s x 3 t p r h x 3 t π 4 p w c m 1 d 2 x 3 a s x 3 t where p r h x 3 t 1 2 ρ w c d d x 3 v r e l x 3 t v r e l x 3 t π 4 p w c m d 2 x 3 a w x 3 t with c d and c m being the drag and inertia coefficients respectively d x 3 is the spar diameter at location x 3 v r e l x 3 t v w x 3 t v s x 3 t is the relative flow velocity with v w x 3 t being the water particle velocity at location x 2 0 and v s x 3 t q 12 x 3 q 14 being the spar velocity a w x 3 t is the water particle acceleration at location x 2 0 and a s x 3 t q 12 x 3 q 14 is the spar acceleration integrating p r h x 3 t along the submerged part of the spar results in the modal loads work conjugated to dofs q 12 and q 14 to quantify the contributions of the hydrodynamic loads to the system mass in eq 21 p r h x 3 t has been reformulated into two terms the second term after integration leads to the hydrodynamic added mass matrix m r h a 22 m r h a π 4 ρ w c m 1 h b h g d 2 x 3 d x 3 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 d x 3 0 0 0 0 π 12 ρ w d 2 2 0 0 0 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 d x 3 0 π 4 ρ w c m 1 h b h g d 2 x 3 x 3 2 d x 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where the added mass component π 12 ρ w d 2 2 in the heave direction has been accounted for following haslum et al 1999 with d 2 being the spar bottom diameter h b is the distance from cog to the spar bottom and h g is the distance from cog to the mean sea level msl the first term p r h x 3 t in eq 21 after integration leads to the remaining hydrodynamic load vector 23 f r h y t f r h t c r a d d r t h b h g p r h x 3 t d x 3 π 8 ρ w c d h d 2 2 q 13 t q 13 t h b h g p r h x 3 t x 3 d x 3 0 0 0 c a 2 0 0 0 0 0 0 c a 3 0 0 0 0 0 0 c a 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 r t where f r h t is the hydrodynamic load vector resulted from p r h x 3 t and c r a d d is an additional added damping matrix included to match the free decay field data jonkman 2010 by calibrating parameters c a 2 c a 3 c a 4 in f r h t the component in the heave direction the second component is formulated directly using morison s formula with c d h being the heave drag coefficient moreover the load vectors due to aerodynamics and gravity are respectively expressed as 24 f r a t f t s t 0 h r f t s t q a t f t s t d t s q a t 0 0 f r g t 0 m 0 m t m s g m 0 g q 8 t n 1 m 0 g sin q 14 t 0 0 where f t s t is the side side aerodynamic force on the tower top accounting for the influence of structural velocities aeroelasticity q a t is the aerodynamic torque classical bem method has been used for the calculation of f t s t and q a t as explained in section 2 n 1 in f r g t has already been defined in eq 17 therefore the eoms of the 6 dof spar tower ridtmd system in eq 15 become 25 m r m r h a r t c r c r a d d r t k r k r h s k m o o r r t f r a t f r g t f r b 0 f r h t f r m 0 the 6 by 6 frequency response matrix can thus be obtained as 26 h ω ω 2 m r m r h a i ω c r c r a d d k r k r h s k m o o r 1 where i 1 each component of h ω is the corresponding frequency response function the eoms of the 4 dof spar tower system without the damper can be extracted from eq 25 by deactivating the two dofs for ridtmd and eliminating the corresponding components in the matrices the same eoms of the 4 dof system can also be extracted from eq 6 of the 17 dof aero hydro servo elastic fowt model free vibration analysis of the spar tower system without damper can then be performed from which the tower side side angular eigenfrequency ω t s can be obtained for turning ridtmd 3 4 optimization procedure for the fowt mounted ridtmd the eigenfrequencies of the absorber and the inerter are written respectively as 27 ω d k d m d ω 2 k 2 b d next dimensionless parameters are defined to facilitate the parameter optimization the mass ratio and frequency ratio of the absorber m d are denoted μ d and α d while the inertance ratio frequency ratio and damping ratio of the inerter b d are denoted μ 2 α 2 and ζ 2 respectively they are defined as 28 μ d m d m 0 d t s 2 j r m 8 α d ω d ω t s μ 2 b d m 0 d t s 2 j r m 8 α 2 ω 2 ω t s ζ 2 c 2 2 b d k 2 where the tower side side eigenfrequency ω t s needs to be obtained from the eigenvalue analysis of the 4 dof spar tower system the four parameters of the ridtmd to be optimized are α d α 2 μ 2 and ζ 2 while the absorber mass ratio μ d is predetermined by the designer as shown in fig 5 random vibration theory is applied for parameter optimization by minimizing the standard deviation of the tower displacement σ q 8 similar to the procedure in zhang and høeg 2019 first nonlinear td simulation are performed using the 17 dof fowt model with linear spring mooring model subject to different environmental conditions in terms of mean wind speed v 0 turbulence intensity i significant wave height h s and peak period t p for a certain environmental condition n numbers n 50 100 of wind and wave realizations are generated based on which monte carlo simulations are carried out resulting in n time series of the 17 dimensional load vector the 6 dimensional load vector combining all contributions on the r h s of eq 25 can then be extracted from the 17 dimensional load vector to be more specific only the first 4 components of this 6 dimensional load vector are extracted from the 17 dimensional load vector while the last 2 components are always zero because they correspond to the dofs for the damper based on the n time series of the 6 dimensional load vector the 6 6 cross spectral density matrix function s f f ω is obtained in the following form 29 s f f ω s f 12 f 12 ω s f 12 f 13 ω s f 12 f 14 ω s f 12 f 8 ω 0 0 s f 13 f 13 ω s f 13 f 14 ω s f 13 f 8 ω 0 0 s f 14 f 14 ω s f 14 f 8 ω 0 0 s f 8 f 8 ω 0 0 s y m m e t r i c 0 0 0 where the diagonal term is the auto spectral density function and the off diagonal terms is the cross spectral density function between two load components s f f ω is a hermitian matrix meaning that the component s f j f i ω in the lower triangular part non shown in eq 29 is the complex conjugate of component s f i f j ω nielsen and zhang 2017 the diagonal term s f i f i ω and the off diagonal term s f i f j ω can be estimated from ensemble averages as 30 s f i f i ω e f f i ω 2 t s f i f j ω e f f i ω f f j ω t where e is the expectation operator over n samples means complex conjugate and t is the duration of each time series f f i ω denotes the fourier transform of one time series of load f i t using the estimated cross spectral density matrix function s f f ω as input to the 6 dof model the cross spectral density matrix function of the system response r q 12 q 13 q 14 q 8 u 1 u 2 t becomes nielsen and zhang 2017 31 s r r ω h ω s f f ω h t ω where h ω is the 6 dimensional frequency response matrix given by eq 26 the standard deviations of the tower side side displacement is then obtained 32 σ q 8 2 0 s q 8 q 8 ω d ω where s q 8 q 8 ω is the fourth diagonal component of s rr ω the standard deviation of other system responses can be obtained in a similar way optimal ridtmd parameters are determined such that σ q 8 is minimized as illustrated in fig 5 4 numerical results 4 1 verification of the 17 dof model by fast data from the nrel 5 mw reference wind turbine jonkman et al 2009 have been used to calibrate the wind turbine structural model and parameters of the spar type foundation oc3 hywind spar and mooring lines are referenced from jonkman 2010 table 1 summarizes some of the basic system parameters of the spar type fowt investigated in the present paper using the 4th order runge kutta algorithm with a time step of 0 02 s simulations of the 17 dof fowt model have been carried out in the td 1200 s duration for each simulation the steady state responses of the 17 dof fowt model are extracted from the simulation results and compared with those from fast fatigue areodynamics structure and turbulence software jonkman et al 2009 wind speeds ranging from cut in 3 m s to cut out 25 m s are considered the obtained system responses agree well with those from fast and some results are illustrated in fig 6 the upper two figures in fig 6 show the responses of structural components blade tower spar and fig 6 b shows some other quantities of the system including generator speed generator power generator torque rotor speed rotor power rotor thrust rotor torque pitch angle and the tip speed ratio it is seen that except for the spar yaw response the 17 dof model captures all other steady state responses very well both in terms of the changing tendency with wind speed and the exact amplitude the discrepancy in the spar yaw response is probably due to the fact that some nonlinear interactions are missing when exacting the system matrices from the left hand side of the lagrange equation in order to obtain eq 5 this issue is currently being investigated furthermore transient responses to a step input wind speed of 15 m s between the 17 dof model and fast are also compared fig 7 shows the out of plane responses of the fowt including blade flapwise vibration tower fore aft vibration and spar pitch motion the agreement is excellent in both time domain and frequency domain fourier amplitude spectrum fig 8 shows the in plane responses of the fowt including blade edgewise vibration tower side side vibration and spar roll motion in general they also agree well with the results from fast and all dynamics are well captured as seen from the spectral peaks in the fourier amplitude spectra some discrepancies in the tower side side vibration and spar roll motion are mainly due to the slightly different roll frequencies predicted by fast and the 17 dof model this might be attributed to the different drivetrain models used fast and the 17 dof model since the in plane motions are coupled to and influenced by the drivetrain dynamics the results in figs 6 8 indicate that the developed 17 dof model can be considered as a good basis for evaluating the performance of ridtmd and other damping devices on vibration suppression of fowts under realistic environmental load conditions by means of nonlinear td simulations 4 2 free vibration analysis of the uncontrolled spar tower system free vibration analysis of the spar tower system without ridtmd 4 dof system is carried out for better understanding the dynamic property and coupling effect the equations of motion of the 4 dof system is extracted from eq 25 by deactivating the 2 dofs related to ridtmd using data from the nrel 5 mw reference turbine jonkman et al 2009 and the oc3 hywind spar jonkman 2010 the parameters in the 4 dof model are calculated and shown in table 2 eigenvalue analysis of the 4 dof system follows from the equations of motion discarding the damping matrix and external force vectors table 3 illustrates the undamped angular eigenfrequencies for different cases considered the first three rows show the results under three different mean wind speeds v 0 where mode 1 mode 2 mode 3 and mode 4 correspond to sway heave roll and tower side side modes of the coupled system these are the true results obtained from eq 25 taking into account all mass and stiffness contributions it is observed that the eigenfrequencies vary with v 0 especially the sway frequency this is due to the inherently nonlinear nature of the mooring system which provides different stiffness contributions for different equilibrium states as already revealed in souza and bachynski 2019 fig 9 shows the mode shapes corresponding to the case of v 0 15 m s the mode shapes exhibit coupling behavior of the system especially for mode 3 and mode 4 mode 3 is dominantly the spar roll mode but also contains some tower side side component similarly mode 4 dominated by tower side side component contains some spar roll component in fact both modes 3 and modes 4 also very slightly contain sway component on the other hand mode 2 is a pure spar heave mode that excludes sway roll and tower side side motions the results in row four to row eight in table 3 have been obtained with v 0 15 m s the fourth row shows the results of the decoupled system with each eigenfrequency being calculated from the separate dof for example the eigenfrequency of mode 4 is obtained from the tower alone without the spar as in the case of fixed bottom wind turbines comparing the results in row one and row four it is observed that coupling to the spar roll motion when the off diagonal terms in m r are considered leads to a much higher tower side side frequency i e ω t s is shifted from 2 4190 rad s to 3 0105 rad s this should be accounted for when tuning the ridtmd i e the damper should be tuned to the tower side side frequency of the coupled system rather than the decoupled tower results in row five indicate that neglecting the rotor mass moment of inertia j r leads to the over prediction of tower side side frequency i e from 3 0105 rad s to 3 1115 rad s the roll frequency is also slightly over predicted ignoring the hydrodynamic added mass m h a leads to significant over prediction of all system frequencies as indicated by the results in row six furthermore ignoring the stiffness contribution from mooring lines results in under prediction of spar sway and heave frequencies while the tower side side frequency is not influenced the eigenfrequency of mode 1 sway becomes zero due to the fact that the system stiffness matrix becomes singular without the mooring line stiffness based on the above observations it is concluded that the complete format of eq 25 should be used for capturing the dynamics of the coupled system as well as for optimizing the ridtmd 4 3 parametric optimization the optimal design of ridtmd follows from the procedure in section 3 3 three different mass ratios are chosen i e μ d 0 005 0 01 0 02 corresponding to m d 2 04 10 3 kg 4 08 10 3 kg and 8 16 10 3 respectively furthermore two different load conditions lcs have been considered in the optimization 1 lc1 v 0 15 m s i 0 12 h s 4 m t p 10 s 2 lc2 v 0 15 m s i 0 12 h s 8 m t p 5 s for both lcs the angle between the incoming wave and the mean wind direction has been set to be 30 in order to account for the wind wave misalignment in the present study for each lc 100 realizations of the turbulent wind fields and irregular waves are generated based on which monte carlo simulations are performed using the 17 dof model this results in 100 time series of the load vector from which the cross spectral density matrix s ff ω is estimated and then employed as input for the 6 dof system in the fd as explained in fig 5 thus the randomness of the environmental loads is well accounted for in the damper optimization leading to a more robust design minimizing the statistical uncertainties than that based on a single time series table 4 shows the optimal parameters of ridtmd under lc1 as well as the resulting standard deviation of the tower vibration σ q 8 minimized and the standard deviation of damper stroke σ u 1 results of the fowt mounted tmd are also presented for comparison from table 4 the following observations can be made 1 for a same absorber mass ratio μ d the ridtmd consistently outperforms the tmd in reducing tower vibrations smaller value of σ q 8 note that the difference improvement is insignificant for this lc this is partly because the classic tmd is already a very effective vibration absorber and partly because σ q 8 contains contributions from other frequency components on which the vibration absorbers have no effect as will be elaborated in the following subsections this is also revealed by the fact that the increase of μ d leads to insignificant reduction in σ q 8 as well for both ridtmd and tmd 2 on the other hand the damper stroke of ridtmd is consistently larger than that of tmd 3 as μ d increases the optimal values of μ 2 and ζ 2 increase while there is no obvious tendency for α d and α 2 as for tmd the optimal value of α decreases and the optimal value of ζ increases as μ d increases table 5 shows the corresponding results under lc2 since the significant wave height is increased from 4 m to 8 m and the wave peak frequency 1 257 rad s becomes closer to the tower side side frequency the tower side side eigenvibration is much more significantly excited while most observations are similar to those from table 4 the following two differences are highlighted 1 for a given μ d the performance improvement by ridtmd becomes more significant in terms of larger difference in σ q 8 due to the fact that σ q 8 under lc2 is dominantly contributed by the tower side side eigenvibration at which the vibration absorbers are effective 2 under lc2 the optimal values of α d and α 2 decrease as μ d increases this implies that as q 8 t becomes more single mode dominated there is more clear tendency of optimal damper parameters with the change of μ d 4 4 ridtmd performance evaluation in the frequency domain fd in this subsection performance of the optimal ridtmd is evaluated in the fd fig 10 shows the auto spectral density functions in logarithmic scale of the tower side side displacement the spar roll and the damper stroke under lc1 based on eq 31 systems without control with optimal tmd μ d 0 005 and with optimal ridtmd μ d 0 005 are compared with the optimal damper parameters taken from table 4 fig 10 a shows that both tmd and ridtmd effectively suppress the spectral peak at the tower frequency while having no effects on the spectral peaks corresponding to spar roll 0 217 rad s and wave peak frequency 1 257 rad s the optimal ridtmd slightly outperforms the optimal tmd with the same absorber mass ratio in suppressing the spectral peak at tower frequency thus the tower side side vibration q 8 t as already given in table 4 the standard deviation of q 8 t calculated using eq 32 is σ q 8 60 3 mm 54 2 mm reduction ratio 10 1 and 53 9 mm reduction ratio 10 6 for the system without control with tmd and with ridtmd respectively for this load case the reduction ratio by ridtmd is only slightly larger because the spar roll frequency contributes considerably to the tower response which is not influenced by both dampers nevertheless as will be shown below ridtmd consistently outperforms tmd in suppressing the tower frequency component which is still beneficial to the fatigue life of fowt towers fig 10 b shows that the spar roll motion is coupled to the tower side side vibration with one insignificant spectral peak at the tower frequency this peak is also effectively suppressed by both tmd and ridtmd on the other hand the most dominant peak corresponding to roll frequency is hardly influenced although very slightly suppressed by the dampers finally fig 10 c shows the corresponding results of the damper stroke it is seen that the plateau around the tower frequency becomes slightly broader for the ridtmd implying that the damper stroke consisting contributions from all frequencies will turn out the be slightly larger for the fowt mounted ridtmd than the tmd counterpart as indicated by σ u 1 in table 4 to further reveal the mechanism of the dampers fig 11 shows some of the properties of the frequency response matrix given by eq 26 which is independent of the load conditions the same sets of damper parameters as in fig 10 are used fig 11 a shows the dynamic amplification factor daf of q 8 t exhibiting similar features around the tower side side frequency as in fig 10 a on the other hand the peak related to wave frequency is absent and the peak corresponding to spar roll is insignificant further it is clearly observed that tmd leads to double peaks around the tower frequency while ridtmd leads to triple peaks since one more dof is introduced for ridtmd which is actually also the case in fig 10 a fig 10 b shows the phase lag between the absorber motion and the tower side side displacement at the resonance frequency tower side side frequency the phase lag is around 90 for both tmd and ridtmd indicating the fundamental working principle of vibration absorbers in damping structural vibrations the 90 phase lag between the absorber displacement and the tower displacement implies that the absorber acceleration is in phase with the tower velocity and the 4 t h row 5 t h column component m d of m r in eq 16 is thus equivalent to an additional damping term for the tower vibration the performance of both tmd and ridtmd deteriorates as the tower vibrational energy shifts from the resonance frequency the phase lag increases towards 180 with increasing ω and decreases towards 0 with decreasing ω except at two low frequencies where coupling to spar roll and sway take place zhang and høeg 2019 for tmd the phase lag exhibits a gradual transition from 0 to 180 while for ridtmd the transition is much more abrupt around the resonance frequency with an extra change of curvature due to the extra dof introduced to ridtmd fig 12 shows the auto spectral density functions in logarithmic scale of the tower side side displacement the spar roll and the damper stroke under lc2 comparing fig 12 a with fig 10 a the tower side side vibration is now dominated by the tower eigenvibration single mode response due to the unfavorable load condition and the effect of installing vibration absorbers or increasing the absorber mass ratio becomes more significant σ q 8 turns out to be 137 8 mm 98 3 mm reduction ratio 28 7 and 96 2 mm reduction ratio 30 2 for the system without control with tmd and with ridtmd respectively this indicates that a more remarkable performance improvement is provided by ridtmd when the tower is experiencing more resonant vibrations further the increase of damper stroke of ridtmd in fig 12 c turns out to be more significant comparing with fig 10 c as also indicated by σ u 1 in table 5 4 5 ridtmd performance evaluation in the time domain td to verify the fd optimization and to evaluate the performance of ridtmd in a highly coupled fowt system the optimized damper is incorporated into the complete 17 dof model leading to a 19 dof fowt ridtmd model non linear td simulations 1200 s time duration are performed using the generated wind and wave time series with both the pitch controller and generator controller activated note that all the linearizations are avoided here i e nonlinearities in the mooring line aerodynamic and hydrodynamic models are retained fig 13 shows the performance of the optimal ridtmd and tmd on damping fowt vibrations in terms of the time series and the fourier amplitude spectrum under lc1 corresponding to the fd results in fig 10 the tower side side displacement q 8 t shown in fig 13 a is effectively suppressed by both the optimal tmd and ridtmd and ridtmd slightly outperforms its tmd counterpart from the time series the standard deviations of q 8 t are calculated to be 58 2 mm 52 1 mm and 51 6 mm for the system without control with tmd and with ridtmd respectively these values agree reasonably well with those calculated from the fd method in subsection 4 4 the fourier amplitude spectra q 8 ω obtained from the time series exhibit very similar features as from fig 10 a i e ridtmd leads to a further reduction of the spectral peak at the tower frequency and both dampers have no effect on the wave induced peak it is interesting to note that the spectral peak corresponding to spar roll frequency is also slightly suppressed by both tmd and ridtmd the time series in fig 13 b show that the dampers have slightly positive effect on the narrow banded spar roll motion q 14 t as well this is further revealed by the fourier amplitude spectra where the dominating peak at spar roll frequency is slightly lowered by both dampers moreover the influence of the dampers on blade edgewise vibration q 4 t is also evaluated and shown in fig 13 c although negligible both tmd and ridtmd positively affect the edgewise vibration which is favorable since the aerodynamic damping in this mode is normally very low fig 14 compares the relative absorber displacement damper stroke u 1 t under lc1 as seen from the time series in fig 14 a the damper stroke of ridtmd is slightly larger than that of tmd the standard deviations of which are σ u 1 143 8 mm and σ u 1 132 6 mm respectively these values agree reasonably well with those in table 4 the fourier amplitude in fig 14 b actually resembles the auto spectral density function in fig 10 c i e the frequency response of the damper stroke is more broad banded for ridtmd around the tower frequency although the peak frequency response is higher for tmd the overall absorber response is the summation of contributions from all frequencies and thus the damper stroke of ridtmd is slightly higher further it is seen that the absorber motion is dominated by the tower frequency since it s tuned to this frequency but it exhibits frequency components at spar roll frequency and wave peak frequency as well a very small peak at the blade edgewise frequency is also present implying the positive influence provided by the damper on edgewise vibrations it should be noted that the damper stroke is indeed an important design consideration due to the limited space inside the nacelle the damper stroke can be effectively reduced by increasing the mass ratio μ d at the cost of a heavier damper therefore it s a design tradeoff to choose the mass ratio so that the damper stroke is within the allowed value another option is to introduce a certain type of stroke limit mechanism hu and he 2017 in such case the system equation of motion needs to be modified which is beyond the scope of the present paper fig 15 shows the performance of the optimal ridtmd and tmd on damping fowt vibrations under lc2 corresponding to the fd results in fig 12 as seen from fig 15 a more remarkable tower side side eigenvibrations are excited under lc2 as revealed by the dominating spectral peak at the tower frequency the equipped ridtmd or tmd effectively suppresses this peak resulting in significantly reduced tower side side displacement as shown in the time series the standard deviation σ q 8 is decreased from 133 5 mm without control to 98 6 mm with tmd and 95 7 mm with ridtmd respectively again they agree well with the fd results presented in subsection 4 4 thus verifying the developed reduced order model similar to the observations in fig 13 a the dampers also slightly suppress the spectral peak at the spar roll frequency while having no effect on the wave induced spectral peak further the spar roll motion shown in fig 15 b is marginally suppressed by the dampers in fine consistence with fig 13 b finally as shown in fig 15 c the blade edgewise vibration is again positively affected by the dampers due to the coupling between blade edgewise vibration and the tower side side vibration to further reveal the performance of the passive dampers on suppressing tower vibrations at higher wind speeds e g around cut out wind speed a new load case lc3 is defined with v 0 25 m s i 0 02 h s 8 m s and t p 5 s one set of realizations of the turbulent wind field and the irregular wave for lc3 is then generated fig 16 shows the performance of ridtmd and tmd on suppressing vibrations of the fowt subjected to the generated excitations for lc3 where the same damper parameters as in fig 15 are used this means that the dampers used for lc3 are non optimal since they have been optimized for lc2 from fig 16 a it is seen that both non optimal dampers effectively suppress tower side side vibrations for lc3 a high wind speed while the non optimal ridtmd still slightly outperforms the non optimal tmd actually it has also been verified not shown here that if the dampers optimized for lc1 are used for lc2 and lc3 the non optimal ridtmd consistently outperforms the non optimal tmd it should be noted that a general conclusion that the non optimal ridtmd always outperforms the non optimal tmd for all load cases can not be drawn from the above findings nevertheless these results reveal that the performance of the passive ridtmd is quite robust as long as it has been optimized to a realistic environmental condition in practice it is suggested that the most critical environmental condition leading to the largest fatigue damage contribution should be chosen as the load condition for optimizing the damper 5 conclusions this paper investigates a novel inerter enhanced vibration absorber the rotational inertia double tuned mass damper ridtmd for vibration damping of tower side side vibrations in a fowt both a fully coupled 17 dof fowt model and a reduced order 6 dof spar tower ridtmd model have been established the former is employed for performance evaluation of ridtmd on damping fowt vibrations by non linear td simulations the latter is used for better understanding the dynamics of the coupled system as well as robust optimization of ridtmd in the fd it is observed that system dynamics eigenfrequencies mode shapes can only be accurately captured when taking into account the coupled spar tower vibration the rotor mass moment of inertia the hydrodynamic added mass as well as stiffness contributions from the hydrostatic buoyancy and mooring lines these are essential for tuning the ridtmd with varying mean wind speed the spar sway and roll eigenfrequencies change but the tower eigenfrequency is unchanged thus this is of minor importance for tuning the damper the reduced order model enables robust optimization of fowt mounted ridtmd in the fd accounting for the stochastic nature of wind and wave excitations it turns out that the optimal parameters of ridtmd depend on the offshore environmental condition especially the two frequency ratios while the inertance ratio and damping ratio of the inerter are quite invariant from the auto spectral density functions it is seen that the optimal ridtmd consistently outperforms the optimal tmd with a same absorber mass ratio in terms of lowered spectral peak around the tower frequency and smaller standard deviation of q 8 t the curves of dynamic amplification factor more clearly indicate that while tmd leads to double peaks around the tower frequency ridtmd leads to triple peaks due to the extra dof extra resonance introduced to the ridtmd finally the optimally tuned ridtmd has been incorporated into the 17 dof model at the tower top to evaluate the damper performance in a highly coupled fowt system in the td simulation results show that both tmd and ridtmd exhibit encouraging performance in damping vibrations of a fowt under realistic wind and wave loads ridtmd consistently outperforms tmd in damping tower side side vibrations at the cost of slightly increased damper stroke both the spar roll and blade edgewise vibration are very slightly suppressed by the dampers therefore ridtmd is regarded as a promising device for vibration damping of tower vibrations in fowt further the td results agree very well with the fd results and the two models developed in this study can be employed as useful tools for the design and analysis of fotw mounted vibration absorbers credit authorship contribution statement zili zhang conceptualization investigation software writing original draft writing review editing christian høeg software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the supports of aarhus university research foundation under the auff assistant professor starting grant auff e 2017 7 20 and the committee of science and technology of shanghai china grant no 18160712800 are highly appreciated appendix a for the case of tmd the expressions of the 5 dimensional matrices m r c r and k r are given by 33 m r m 0 m t m s m d 0 m 0 m d h r m t h t n 3 m 0 n 1 m d m d 0 m 0 m t m s m d 0 0 0 m 0 m d h r m t h t n 3 0 m 0 m d h r 2 m t h t 2 j t 2 n 3 h t j s j r m 0 m d h r n 1 h t n 2 d t s j r m d h r m 0 n 1 m d 0 m 0 m d h r n 1 h t n 2 d t s j r m 0 m 8 d t s 2 j r m d m d m d 0 m d h r m d m d 34 c r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 ζ 8 m 8 k 8 0 0 0 0 0 c d k r 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k 8 0 0 0 0 0 k d 
