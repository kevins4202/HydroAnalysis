index,text
23480,unsteady cavitation is an important topic due to its potential to cause huge damage to the hydraulic machinery to control the shedding of cloud cavitation the cavitation over a flat hydrofoil with an obstacle is investigated experimentally and numerically a series of experiments around the flat hydrofoil without with obstacle are carried out to study the evolution of cavitation periodic re entrant jet and large shedding of cloud cavitation are observed in the case without obstacle while the shedding of cloud cavitation in the case with obstacle is much weaker numerical simulations of the 2d unsteady cavitating flows around the hydrofoil are also performed the transient and averaged fields of numerical simulations are presented and compared with the experimental data the results show that in cases without obstacle the averaged cavity length becomes longer with the decrease of the cavitation number while in cases with obstacle there is a range of cavitation number in which the averaged cavity length almost keeps constant the existence of obstacle changes the strength and direction of the transient re entrant jet as well as the pressure distribution at the tail part of the cavity leading to the weaker shedding of the cloud cavitation keywords re entrant jet cloud cavitation obstacle 1 introduction cavitation has received much attention since rayleigh 1917 first introduced the issue of cavitation erosion on ship propeller various cavitation patterns could be observed on the surface of almost any type of hydrofoil as the cavitation number decreases sheet partial cavitation cloud cavitation and super cavitation franc and michel 2004 brennen 2013 partial cavitation is inherently unsteady in nature and causes oscillations of cavity length konno et al 2002 ida 2004 the destabilization process results in the shedding of large bubbly vapor structure called cloud cavitation the collapse of cloud cavitation could generate huge pressure impact and cause damage on the nearby surface numerous observations and investigations of unsteady cavitation have been performed for flows around hydrofoils lush and peters 1982 larrarte et al 1995 callenaere et al 2001 stanley et al 2014 and internal flows such as in orifices and venturis stanley et al 2011 de giorgi et al 2013 abdulaziz 2014 furness and hutton 1975 early mentioned that re entrant jet is the main mechanism of cavitation instability the dynamic behaviors of the cavitation in a venturi type nozzle were studied experimentally since then considerable progresses have been made to prove re entrant jet is the main reason of onset of cloud cavitation lush and skipp 1986 le et al 1993 kawanami et al 1997 sato et al 2013 on the other hand other mechanisms of cavitation instability were also proposed kubota et al 1992 considered that a shear layer separated at the cavity leading edge causes a jet into the cavity surface and then cloud cavitation is generated recently ganesh et al 2016 introduced another mechanism of shock wave accounting for the shedding of the cloud cavitation these new explanations remind us that the destabilization process of partial cavitation is very complicated and besides the mechanism of re entrant jet other instability mechanisms may be dominant under certain conditions many researchers were devoted to study the reason of the generation of re entrant jet two kinds of explanations were proposed one is the collapse of the shedding cloud cavitation generates high pressure near the body the transient pressure difference results in the formation of jet and cavitation instability leroux et al 2004 2005 however other experiments show that the correlation between pressure pulses generated by the cloud collapse and the re entrant jet motion is not obvious coutier delgosha et al 2003 another explanation is the adverse pressure gradient at the end of cavity is the main reason of motion of the re entrant jet callenaere et al 2001 laberteaux and ceccio 2001 if the adverse pressure gradient decreases the shedding of cloud cavitation would be reduced significantly the thickness of the jet which is directly related to the adverse pressure gradient plays an important role in the instability of the cavitation in a case of relatively thin cavity a periodic re entrant jet would be also observed however a strong interaction exists between the cavity interface and the re entrant jet all along its upstream movement small vapor structure would be formed at the wake of the thin cavity stanley et al 2014 callenaere et al 2001 thought that large shedding of cloud cavitation would happen when the ratio of the re entrant jet thickness to the cavity thickness ranges from 15 to 35 several works have paid attention on the inhibition of cavitation and its instability a pioneer work of geometry optimization of hydrofoils was carried out by eppler 1980 their results show that cavitation on hydrofoil can be delayed and reduced due to changing the hydrofoil section yamaguchi et al 1986 introduced this approach to inhibit the cavitation on propeller since then a group of researchers made efforts to improve the related works dang 1998 zeng and kuiper 2009 to control the stability of cavitation the approach of air injection was also considered arndt et al 1995 akbarzadeh and akbarzadeh 2016 considering the phenomenon of periodic re entrant jet kawanami et al 1997 placed an obstacle on a naca type hydrofoil to obstruct the re entrant jet thus to reduce the shedding of cloud cavity as the results show the shedding of cloud cavitation reduces obviously under their experiment condition however few experiments or simulations have been performed to study the relationship between the obstacle and the re entrant jet in present work the cavitation over a flat hydrofoil without with an obstacle is investigated experimentally and numerically respectively the placement of the obstacle is used to inhibit the shedding of cloud cavitation the focus of experiments is on the observations of the cavitation under different conditions 2d numerical simulations are performed to predict the fields of the unsteady cavitating flows the features of the re entrant jet in cases with without the obstacle are presented in addition the correlation between the cavitation behavior and the adverse pressure gradient is discussed 2 method 2 1 experiment condition all the measurements and visualizations are carried out in the cavitation tunnel of zhejiang university the tunnel as shown in fig 1 is an upright close loop structure with height of 5 8 m and width of 5 2 m the test section is about 1000 mm long and has a rectangular area of 200 200 mm the tunnel has the basic functions of pressurization depressurization and degassing for the process of degassing the vacuum pump offers low pressure to eliminate the gas in the water the design water speed is 0 12 m s and minimal pressure is 0 1atm all the experiment parameters such as pressure water speed and cavitation number are controlled by operating an electronic touch screen the angle of attack is adjusted by a control device which has an accuracy of 0 1 the sizes of the used flat hydrofoil as shown in fig 2 are 150 200 12 mm in which the chord length c 150 mm the hydrofoil is fixed at zero angle of attack experiments are performed first for a flat hydrofoil without obstacle then for a flat hydrofoil with a full span obstacle which is 2 mm high and 2 mm wide the obstacle is placed at the location of 0 37c from the leading edge the images of cavitation are recorded by a photron sa4 high speed camera with the frame rate of 5000 fps and the resolution of 1024 800 pixels in the experiments the environment pressure in the tunnel would be reduced to a level around 0 3atm and then the flow speed will be controlled by the axial pump the cavitation number is defined as 1 σ p p v 1 2 ρ u 0 2 where p is the environment pressure p v is the liquid saturation pressure ρ is the density of water and u 0 is the flow speed 2 2 numerical method most numerical models of cavitating flow assume that the fluids are homogeneous and isothermal and employ either an appropriate equation of state coutier delgosha et al 2003 liu et al 2004 or a transport equation merkle et al 1998 kunz et al 2000 morgut et al 2011 chen et al 2015 to calculate the density of the mixture in an equation of state eos model a density pressure dependency is needed to solve the rapid phase change process between two phases numerical methods for eos models always refer to the density based algorithm which is commonly employed in aerodynamics computations song and he 1998 transfer equation model tem employs a phase transfer equation which reflects the mass conservation law typically a pressure based algorithm is used for the computation of cavitating flows with tems kunz et al 2000 senocak and shyy 2002 zhang and khoo 2013 here we present our pressure based numerical method by using schnerr sauer cavitation model schnerr and sauer 2001 simply the governing equations of unsteady turbulent cavitating flows are given by 2 u ρ l 1 ρ v 1 m c ρ m 3 ρ m u t ρ m u u p τ 4 α l t α l u m ρ l where ρ m is the density of mixture 5 ρ m α l ρ l α v ρ v u and p are the averaged filtered velocity and pressure respectively c ρ ρ l 1 ρ v 1 is a coefficient τ τ f τ t is the effective stress tensor τ f is the viscous stress tensor and τ f ρ m u u u u is the subgrid stress tensor the spherical bubble theory by rayleigh has been used in building several cavitation models such as singhal s full cavitation model singhal et al 2002 and sauer s volume fraction model schnerr and sauer 2001 according to rayleigh s bubble theory the phase change rate between two phases can be given by 6 m ρ v 3 α v r b s i g n p p v 2 3 p p v ρ l where p is the local pressure and r b is the local bubble radius and is unknown sauer gave an expression for the bubble size 7 r b α v n 0 4 3 π 1 α v 1 ρ v ρ l 3 which is derived based on the definition of vapor volume fraction with the consideration of bubble size and interaction between bubbles in a local unit a more realistic results for the phase change rate is given by 8 m b 1 α l 2 1 1 α l 1 ρ v ρ l 3 s i g n p p v p p v where 10 b 3 ρ v 4 n 0 π 3 3 2 3 ρ l in order to avoid m 0 for the pure liquid flows α n u c denoting initial nucleus content is added into eq 8 11 m b 1 α l α n u c 2 1 1 α l 1 ρ v ρ l 3 s i g n p p v p p v an implicit pressure based algorithm is developed for the computations of unsteady cavitating flows the key step in our implicit pressure based algorithm is to establish a pressure correction equation the fully implicit treatment for the correction pressure terms is very helpful and in some cases critical to achieve good numerical stability for cavitating flows there is a source term describing the mass change rate in the mass equation the mass change rate also depends on the local pressure distribution like the phase change rate this leads to an obvious difference in developing the pressure equation for cavitating flows the details of the algorithm can be referred to our previous publication zhang and khoo 2013 the above numerical steps are carried out on the numerical platform openfoam which is an open source software library for solving partial differential equations 3 experimental results the observations of evolution of cavitation over hydrofoils without with obstacle are shown in figs 3 and 4 for the case with obstacle the obstacle is placed at the location 0 37c i e 55 5 mm from the leading edge fig 3 shows the top view of motion of cavitation on the flat hydrofoil at the cavitation number 0 703 the flow direction is from left to right and the black region in every image is the hydrofoil the cavitation on the hydrofoil is obviously periodic which includes three stages the growth of the cavity and then the formation of reflow towards to the leading edge finally the shedding and collapsing of cloud cavitation in the downstream fig 3 a c show the growth process of the cavitation after the collapse of the cloud cavitation fig 3 h i in fig 3 c the cavity reaches its maximum of cavity length meanwhile the growth process is accompanied by the formation of the re entrant jet the jet can be early observed in fig 3 b then moves upstream under the cavity finally cuts off the attached cavity near the leading edge fig 3 e small scale shedding can be found at the tail part of the cavity as the re entrant jet moves fig 3 f i show the shedding and collapsing of the cloud cavitation large scale shedding is detected and then a u type cloud cavitation generates and collapses when moving downstream fig 4 shows the evolution of cavitation over a hydrofoil with an obstacle at the cavitation number 0 7 although the cavitation number in this case is very close to that of the case without obstacle here the cavity length is obviously shorter the cavity almost attaches on the hydrofoil in the front of the obstacle weaker re entrant jet can be found in the middle region of the cavity however it is not strong enough to cut off the attached cavity so there is no large scale cavitation shedding small scale cavitation shedding can be observed at the tail part of the cavity during the whole process it seems that the small scale shedding is a result of interaction between the flow and the obstacle an approach of digital image processing is developed to deal with the images by the high speed camera each image is treated as a i j matrix each pixel in the image corresponds to an element in the matrix as the images show the brightness of the white areas represents the strength of cavitation which is quantified by the gray value α i j of each pixel the matrix gray value of the nth image can be defined as 12 a i j n α 1 1 n α 1 2 n α 1 j n α 2 1 n α 2 2 n α 1 j n α i 1 n α i 2 n α i j n thus the mean value μ i j and the standard derivation σ i j of a set of images can be given by 13 μ i j 1 n n 1 n a i j n 14 σ i j 1 n 1 n 1 n a i j n μ i j 2 fig 5 presents the fields of the mean value and standard deviation the left column shows the results without obstacle and the right column are results with obstacle the numbers of used images are up to 2000 the mean value reflects the average distribution of the cavity over several periods and the standard derivation reflects the degree of variation of cavitation as the mean value shows the cavities are almost uniform along the spanwise for the case with obstacle the cavity becomes shorter meantime its brightness reduces which means the cavity is relatively thinner the location of the obstacle can be observed behind which the region of cavitation is very short that means the cavity length is very close to the distance of the obstacle from the leading edge from the standard deviation results we can see that the tail parts of the cavities are both highlight in two cases however for the case without obstacle the brightness and the aggregation degree of the highlight region are stronger this can be attributed to the phenomenon of large scale shedding of cloud cavitation the highlight region in the case with obstacle is a result of small scale shedding it presents a relatively wide distribution behind the obstacle for a better comparison a filtration is performed to show the fields of standard deviation larger than 250 it is obvious that the variation of cavitation in the case without obstacle is much more remarkable to understand the flow fields in details 2d numerical simulations are performed and presented below 4 numerical results the 2d unsteady cavitating flows around flat hydrofoils are simulated with the cavitation number ranging from 0 76 to 0 68 the flow enters the domain with a velocity of 10 m s and exits on the outlet boundary under a fully developed condition where a fixed pressure condition is set the scale of 2d hydrofoil is same as that used in experiments as fig 6 shows the 2d computational mesh has about 500 000 elements and the mesh refinement is performed especially at the leading edge trailing edge and around the obstacle the inlet is 2c from the leading edge and the outlet is 4c from the trailing edge fig 7 shows the evolution of cavitation on the flat hydrofoil at the cavitation number σ 0 7 fig 7 a b are the growth stage of the cavitation a re entrant jet is found under the cavity when the cavity reaches its maximum length the re entrant jet has almost arrived at the middle position of the cavity the whole cavity keeps attached till the re entrant jet arrives upstream and cuts off the cavity see fig 7 d e so there are two parts of cavitation on the surface of the hydrofoil one is the short attached cavity in the vicinity of the leading edge the other is the shedding cavitation moving downstream with the flow developing the attached part is growing while the shedding part is moving and collapsing see fig 7 f and a during the whole process the interaction between the re entrant jet and the cavity interface exists making the cavity surface not so smooth the height of the jet is about a half of the cavity in the experiments at the cavitation number σ 0 703 the flow velocity is u exp 5 8 m s the frequency of the cavity cycle f exp 12 5 h z and the cavity length l exp 93 m m thus we can get s t exp f exp l exp u exp 0 20 in the case of numerical simulation at σ 0 7 the flow velocity is u n u m 10 m s the frequency f n u m 22 h z and the cavity length l n u m 96 m m thus we get s t n u m f n u m l n u m u n u m 0 211 the error is about 5 5 in contrast fig 8 shows the evolution of cavitation on the flat hydrofoil with obstacle at the cavitation number σ 0 7 we can see that the cavitation mainly concentrates in the front of the obstacle although no large scale cavitation shedding happens the flow is still unsteady there is a strong interaction between the re entrant jet and the obstacle it seems that the jet can pass over the obstacle and move upstream however the jet is not strong enough to cut off a big cavity a strong interaction between the re entrant jet and the cavity surface exits so that the cavity surface oscillates dramatically multiple small scale shedding can be detected in one period the averaged vapor fields which are derived by averaging the results more than ten periods are presented in fig 9 for the case without obstacle the cavity length at the cavitation number 0 7 is a little longer than that at the cavitation number 0 72 adding obstacle makes the cavity length shorter and almost constant at the two cavitation numbers more results of cavity length are shown in fig 10 the numerical predictions coincide well with the experimental data in cases without obstacle the cavity length becomes longer with the decrease of the cavitation number however adding an obstacle reduces the cavity length in addition there is a range of cavitation number i e 0 74 to 0 7 in which the cavity length almost keeps constant the constant cavity length is about 67 mm a little longer than the distance of the obstacle from the leading edge 55 5 mm all the above results show that the arrangement of obstacle has an obvious inhibition effect on the mean and transient fields of the cavitation fig 11 shows the transient flow fields in details at the time when the cavity reaches its maximum length including the fields of volume fraction pressure and velocity in the case without obstacle as mentioned previously the re entrant jet has arrived at the middle position of the cavity the jet is driven by a pressure difference at the tail part of the cavity the speed of the liquid jet moving upstream is close to the incoming flow velocity in the case with obstacle the re entrant jet also occurs due to a pressure difference in the wake flow however this pressure difference is relatively small meanwhile the liquid jet is facing a wall of the obstacle so that it changes its direction and becomes slow another velocity field at the following time t b is supplemented in fig 12 at this point the small scale shedding cavitation begins to collapse the re entrant jet is divided into two parts one jet is passing over the obstacle and entering into the region before the obstacle the other is rolling with the small scale shedding cavitation in this way the jet moving upstream becomes weaker as for the pressure difference which is the driving force for the re entrant jet we present more information about the transient and mean pressure distributions along the surfaces fig 13 shows the transient pressure gradients in a cycle sharp peaks are found in the case without obstacle at time t 1 a peak with d p d x 1 5 10 4 is found when the cavity length almost reaches the maximum the existence of obstacle weakens the transient pressure difference in the wake flow the amplitudes of d p d x from time t 0 to t 2 which correspond to the process of the cavity growth are less than 5000 in this case fig 14 shows the transient and mean pressure distributions fig 14 a shows the transient pressure distribution in the case without obstacle in a cycle σ 0 7 statistics results of the pressure are obtained by averaging more than ten periods in the case without obstacle there is a region at the tail part of the cavity in which the pressure increases monotonously this means that the adverse pressure gradient exists in most of the time in the obstacle case the pressure does not increase monotonously in fact there are two local regions in the vicinity of the obstacle having accelerating gradients one is around the obstacle the other is behind the obstacle 5 conclusions in this paper the effects of obstacle on inhibiting the cloud cavitation are studied both experimentally and numerically the images of evolution of cavitation are recorded by a high speed camera an image processing approach is developed to get the mean fields and standard derivations of the images a pressure based algorithm is used for the computations of the unsteady cavitating flows around the 2d flat hydrofoils the investigations focus on the comparisons of differences between the case without obstacle and the case with obstacle both the experiments and the simulations show that there are three stages in the case without obstacle growth of the cavity formation of the re entrant jet and shedding and collapsing of the cloud cavitation the placement of an obstacle on the flat hydrofoil inhibits the region of cavitation as well as the instability of the cavitation only small scale cavitation shedding can be observed in this case it is noted that there is a range of cavitation number i e 0 74 to 0 7 in which the cavity length almost keeps constant and is close to the distance of the obstacle from the leading edge the features of the cavitating flows indicate that the re entrant jet is weaker in the case with obstacle the existence of an obstacle changes the strength and direction of the transient re entrant jet as well as the pressure distribution when the re entrant jet generates behind the obstacle it faces the wall of the obstacle it will be divided into two jets one passing over the obstacle with a small speed the other rolling with the shedding cavitation the adverse pressure gradient at the tail part of the cavity which is the driving force for the re entrant jet also decreases due to the existence of the obstacle in future work an obstacle could be added on the surface of fluid machinery for example the blades of centrifugal pump or axial pump to study the effect of inhibition of cloud cavitation acknowledgement project was supported by the national natural science foundation of china no 11272284 the state key program of national natural science of china no 11332009 and zhejiang provincial natural science foundation of china no ly17a020004 
23480,unsteady cavitation is an important topic due to its potential to cause huge damage to the hydraulic machinery to control the shedding of cloud cavitation the cavitation over a flat hydrofoil with an obstacle is investigated experimentally and numerically a series of experiments around the flat hydrofoil without with obstacle are carried out to study the evolution of cavitation periodic re entrant jet and large shedding of cloud cavitation are observed in the case without obstacle while the shedding of cloud cavitation in the case with obstacle is much weaker numerical simulations of the 2d unsteady cavitating flows around the hydrofoil are also performed the transient and averaged fields of numerical simulations are presented and compared with the experimental data the results show that in cases without obstacle the averaged cavity length becomes longer with the decrease of the cavitation number while in cases with obstacle there is a range of cavitation number in which the averaged cavity length almost keeps constant the existence of obstacle changes the strength and direction of the transient re entrant jet as well as the pressure distribution at the tail part of the cavity leading to the weaker shedding of the cloud cavitation keywords re entrant jet cloud cavitation obstacle 1 introduction cavitation has received much attention since rayleigh 1917 first introduced the issue of cavitation erosion on ship propeller various cavitation patterns could be observed on the surface of almost any type of hydrofoil as the cavitation number decreases sheet partial cavitation cloud cavitation and super cavitation franc and michel 2004 brennen 2013 partial cavitation is inherently unsteady in nature and causes oscillations of cavity length konno et al 2002 ida 2004 the destabilization process results in the shedding of large bubbly vapor structure called cloud cavitation the collapse of cloud cavitation could generate huge pressure impact and cause damage on the nearby surface numerous observations and investigations of unsteady cavitation have been performed for flows around hydrofoils lush and peters 1982 larrarte et al 1995 callenaere et al 2001 stanley et al 2014 and internal flows such as in orifices and venturis stanley et al 2011 de giorgi et al 2013 abdulaziz 2014 furness and hutton 1975 early mentioned that re entrant jet is the main mechanism of cavitation instability the dynamic behaviors of the cavitation in a venturi type nozzle were studied experimentally since then considerable progresses have been made to prove re entrant jet is the main reason of onset of cloud cavitation lush and skipp 1986 le et al 1993 kawanami et al 1997 sato et al 2013 on the other hand other mechanisms of cavitation instability were also proposed kubota et al 1992 considered that a shear layer separated at the cavity leading edge causes a jet into the cavity surface and then cloud cavitation is generated recently ganesh et al 2016 introduced another mechanism of shock wave accounting for the shedding of the cloud cavitation these new explanations remind us that the destabilization process of partial cavitation is very complicated and besides the mechanism of re entrant jet other instability mechanisms may be dominant under certain conditions many researchers were devoted to study the reason of the generation of re entrant jet two kinds of explanations were proposed one is the collapse of the shedding cloud cavitation generates high pressure near the body the transient pressure difference results in the formation of jet and cavitation instability leroux et al 2004 2005 however other experiments show that the correlation between pressure pulses generated by the cloud collapse and the re entrant jet motion is not obvious coutier delgosha et al 2003 another explanation is the adverse pressure gradient at the end of cavity is the main reason of motion of the re entrant jet callenaere et al 2001 laberteaux and ceccio 2001 if the adverse pressure gradient decreases the shedding of cloud cavitation would be reduced significantly the thickness of the jet which is directly related to the adverse pressure gradient plays an important role in the instability of the cavitation in a case of relatively thin cavity a periodic re entrant jet would be also observed however a strong interaction exists between the cavity interface and the re entrant jet all along its upstream movement small vapor structure would be formed at the wake of the thin cavity stanley et al 2014 callenaere et al 2001 thought that large shedding of cloud cavitation would happen when the ratio of the re entrant jet thickness to the cavity thickness ranges from 15 to 35 several works have paid attention on the inhibition of cavitation and its instability a pioneer work of geometry optimization of hydrofoils was carried out by eppler 1980 their results show that cavitation on hydrofoil can be delayed and reduced due to changing the hydrofoil section yamaguchi et al 1986 introduced this approach to inhibit the cavitation on propeller since then a group of researchers made efforts to improve the related works dang 1998 zeng and kuiper 2009 to control the stability of cavitation the approach of air injection was also considered arndt et al 1995 akbarzadeh and akbarzadeh 2016 considering the phenomenon of periodic re entrant jet kawanami et al 1997 placed an obstacle on a naca type hydrofoil to obstruct the re entrant jet thus to reduce the shedding of cloud cavity as the results show the shedding of cloud cavitation reduces obviously under their experiment condition however few experiments or simulations have been performed to study the relationship between the obstacle and the re entrant jet in present work the cavitation over a flat hydrofoil without with an obstacle is investigated experimentally and numerically respectively the placement of the obstacle is used to inhibit the shedding of cloud cavitation the focus of experiments is on the observations of the cavitation under different conditions 2d numerical simulations are performed to predict the fields of the unsteady cavitating flows the features of the re entrant jet in cases with without the obstacle are presented in addition the correlation between the cavitation behavior and the adverse pressure gradient is discussed 2 method 2 1 experiment condition all the measurements and visualizations are carried out in the cavitation tunnel of zhejiang university the tunnel as shown in fig 1 is an upright close loop structure with height of 5 8 m and width of 5 2 m the test section is about 1000 mm long and has a rectangular area of 200 200 mm the tunnel has the basic functions of pressurization depressurization and degassing for the process of degassing the vacuum pump offers low pressure to eliminate the gas in the water the design water speed is 0 12 m s and minimal pressure is 0 1atm all the experiment parameters such as pressure water speed and cavitation number are controlled by operating an electronic touch screen the angle of attack is adjusted by a control device which has an accuracy of 0 1 the sizes of the used flat hydrofoil as shown in fig 2 are 150 200 12 mm in which the chord length c 150 mm the hydrofoil is fixed at zero angle of attack experiments are performed first for a flat hydrofoil without obstacle then for a flat hydrofoil with a full span obstacle which is 2 mm high and 2 mm wide the obstacle is placed at the location of 0 37c from the leading edge the images of cavitation are recorded by a photron sa4 high speed camera with the frame rate of 5000 fps and the resolution of 1024 800 pixels in the experiments the environment pressure in the tunnel would be reduced to a level around 0 3atm and then the flow speed will be controlled by the axial pump the cavitation number is defined as 1 σ p p v 1 2 ρ u 0 2 where p is the environment pressure p v is the liquid saturation pressure ρ is the density of water and u 0 is the flow speed 2 2 numerical method most numerical models of cavitating flow assume that the fluids are homogeneous and isothermal and employ either an appropriate equation of state coutier delgosha et al 2003 liu et al 2004 or a transport equation merkle et al 1998 kunz et al 2000 morgut et al 2011 chen et al 2015 to calculate the density of the mixture in an equation of state eos model a density pressure dependency is needed to solve the rapid phase change process between two phases numerical methods for eos models always refer to the density based algorithm which is commonly employed in aerodynamics computations song and he 1998 transfer equation model tem employs a phase transfer equation which reflects the mass conservation law typically a pressure based algorithm is used for the computation of cavitating flows with tems kunz et al 2000 senocak and shyy 2002 zhang and khoo 2013 here we present our pressure based numerical method by using schnerr sauer cavitation model schnerr and sauer 2001 simply the governing equations of unsteady turbulent cavitating flows are given by 2 u ρ l 1 ρ v 1 m c ρ m 3 ρ m u t ρ m u u p τ 4 α l t α l u m ρ l where ρ m is the density of mixture 5 ρ m α l ρ l α v ρ v u and p are the averaged filtered velocity and pressure respectively c ρ ρ l 1 ρ v 1 is a coefficient τ τ f τ t is the effective stress tensor τ f is the viscous stress tensor and τ f ρ m u u u u is the subgrid stress tensor the spherical bubble theory by rayleigh has been used in building several cavitation models such as singhal s full cavitation model singhal et al 2002 and sauer s volume fraction model schnerr and sauer 2001 according to rayleigh s bubble theory the phase change rate between two phases can be given by 6 m ρ v 3 α v r b s i g n p p v 2 3 p p v ρ l where p is the local pressure and r b is the local bubble radius and is unknown sauer gave an expression for the bubble size 7 r b α v n 0 4 3 π 1 α v 1 ρ v ρ l 3 which is derived based on the definition of vapor volume fraction with the consideration of bubble size and interaction between bubbles in a local unit a more realistic results for the phase change rate is given by 8 m b 1 α l 2 1 1 α l 1 ρ v ρ l 3 s i g n p p v p p v where 10 b 3 ρ v 4 n 0 π 3 3 2 3 ρ l in order to avoid m 0 for the pure liquid flows α n u c denoting initial nucleus content is added into eq 8 11 m b 1 α l α n u c 2 1 1 α l 1 ρ v ρ l 3 s i g n p p v p p v an implicit pressure based algorithm is developed for the computations of unsteady cavitating flows the key step in our implicit pressure based algorithm is to establish a pressure correction equation the fully implicit treatment for the correction pressure terms is very helpful and in some cases critical to achieve good numerical stability for cavitating flows there is a source term describing the mass change rate in the mass equation the mass change rate also depends on the local pressure distribution like the phase change rate this leads to an obvious difference in developing the pressure equation for cavitating flows the details of the algorithm can be referred to our previous publication zhang and khoo 2013 the above numerical steps are carried out on the numerical platform openfoam which is an open source software library for solving partial differential equations 3 experimental results the observations of evolution of cavitation over hydrofoils without with obstacle are shown in figs 3 and 4 for the case with obstacle the obstacle is placed at the location 0 37c i e 55 5 mm from the leading edge fig 3 shows the top view of motion of cavitation on the flat hydrofoil at the cavitation number 0 703 the flow direction is from left to right and the black region in every image is the hydrofoil the cavitation on the hydrofoil is obviously periodic which includes three stages the growth of the cavity and then the formation of reflow towards to the leading edge finally the shedding and collapsing of cloud cavitation in the downstream fig 3 a c show the growth process of the cavitation after the collapse of the cloud cavitation fig 3 h i in fig 3 c the cavity reaches its maximum of cavity length meanwhile the growth process is accompanied by the formation of the re entrant jet the jet can be early observed in fig 3 b then moves upstream under the cavity finally cuts off the attached cavity near the leading edge fig 3 e small scale shedding can be found at the tail part of the cavity as the re entrant jet moves fig 3 f i show the shedding and collapsing of the cloud cavitation large scale shedding is detected and then a u type cloud cavitation generates and collapses when moving downstream fig 4 shows the evolution of cavitation over a hydrofoil with an obstacle at the cavitation number 0 7 although the cavitation number in this case is very close to that of the case without obstacle here the cavity length is obviously shorter the cavity almost attaches on the hydrofoil in the front of the obstacle weaker re entrant jet can be found in the middle region of the cavity however it is not strong enough to cut off the attached cavity so there is no large scale cavitation shedding small scale cavitation shedding can be observed at the tail part of the cavity during the whole process it seems that the small scale shedding is a result of interaction between the flow and the obstacle an approach of digital image processing is developed to deal with the images by the high speed camera each image is treated as a i j matrix each pixel in the image corresponds to an element in the matrix as the images show the brightness of the white areas represents the strength of cavitation which is quantified by the gray value α i j of each pixel the matrix gray value of the nth image can be defined as 12 a i j n α 1 1 n α 1 2 n α 1 j n α 2 1 n α 2 2 n α 1 j n α i 1 n α i 2 n α i j n thus the mean value μ i j and the standard derivation σ i j of a set of images can be given by 13 μ i j 1 n n 1 n a i j n 14 σ i j 1 n 1 n 1 n a i j n μ i j 2 fig 5 presents the fields of the mean value and standard deviation the left column shows the results without obstacle and the right column are results with obstacle the numbers of used images are up to 2000 the mean value reflects the average distribution of the cavity over several periods and the standard derivation reflects the degree of variation of cavitation as the mean value shows the cavities are almost uniform along the spanwise for the case with obstacle the cavity becomes shorter meantime its brightness reduces which means the cavity is relatively thinner the location of the obstacle can be observed behind which the region of cavitation is very short that means the cavity length is very close to the distance of the obstacle from the leading edge from the standard deviation results we can see that the tail parts of the cavities are both highlight in two cases however for the case without obstacle the brightness and the aggregation degree of the highlight region are stronger this can be attributed to the phenomenon of large scale shedding of cloud cavitation the highlight region in the case with obstacle is a result of small scale shedding it presents a relatively wide distribution behind the obstacle for a better comparison a filtration is performed to show the fields of standard deviation larger than 250 it is obvious that the variation of cavitation in the case without obstacle is much more remarkable to understand the flow fields in details 2d numerical simulations are performed and presented below 4 numerical results the 2d unsteady cavitating flows around flat hydrofoils are simulated with the cavitation number ranging from 0 76 to 0 68 the flow enters the domain with a velocity of 10 m s and exits on the outlet boundary under a fully developed condition where a fixed pressure condition is set the scale of 2d hydrofoil is same as that used in experiments as fig 6 shows the 2d computational mesh has about 500 000 elements and the mesh refinement is performed especially at the leading edge trailing edge and around the obstacle the inlet is 2c from the leading edge and the outlet is 4c from the trailing edge fig 7 shows the evolution of cavitation on the flat hydrofoil at the cavitation number σ 0 7 fig 7 a b are the growth stage of the cavitation a re entrant jet is found under the cavity when the cavity reaches its maximum length the re entrant jet has almost arrived at the middle position of the cavity the whole cavity keeps attached till the re entrant jet arrives upstream and cuts off the cavity see fig 7 d e so there are two parts of cavitation on the surface of the hydrofoil one is the short attached cavity in the vicinity of the leading edge the other is the shedding cavitation moving downstream with the flow developing the attached part is growing while the shedding part is moving and collapsing see fig 7 f and a during the whole process the interaction between the re entrant jet and the cavity interface exists making the cavity surface not so smooth the height of the jet is about a half of the cavity in the experiments at the cavitation number σ 0 703 the flow velocity is u exp 5 8 m s the frequency of the cavity cycle f exp 12 5 h z and the cavity length l exp 93 m m thus we can get s t exp f exp l exp u exp 0 20 in the case of numerical simulation at σ 0 7 the flow velocity is u n u m 10 m s the frequency f n u m 22 h z and the cavity length l n u m 96 m m thus we get s t n u m f n u m l n u m u n u m 0 211 the error is about 5 5 in contrast fig 8 shows the evolution of cavitation on the flat hydrofoil with obstacle at the cavitation number σ 0 7 we can see that the cavitation mainly concentrates in the front of the obstacle although no large scale cavitation shedding happens the flow is still unsteady there is a strong interaction between the re entrant jet and the obstacle it seems that the jet can pass over the obstacle and move upstream however the jet is not strong enough to cut off a big cavity a strong interaction between the re entrant jet and the cavity surface exits so that the cavity surface oscillates dramatically multiple small scale shedding can be detected in one period the averaged vapor fields which are derived by averaging the results more than ten periods are presented in fig 9 for the case without obstacle the cavity length at the cavitation number 0 7 is a little longer than that at the cavitation number 0 72 adding obstacle makes the cavity length shorter and almost constant at the two cavitation numbers more results of cavity length are shown in fig 10 the numerical predictions coincide well with the experimental data in cases without obstacle the cavity length becomes longer with the decrease of the cavitation number however adding an obstacle reduces the cavity length in addition there is a range of cavitation number i e 0 74 to 0 7 in which the cavity length almost keeps constant the constant cavity length is about 67 mm a little longer than the distance of the obstacle from the leading edge 55 5 mm all the above results show that the arrangement of obstacle has an obvious inhibition effect on the mean and transient fields of the cavitation fig 11 shows the transient flow fields in details at the time when the cavity reaches its maximum length including the fields of volume fraction pressure and velocity in the case without obstacle as mentioned previously the re entrant jet has arrived at the middle position of the cavity the jet is driven by a pressure difference at the tail part of the cavity the speed of the liquid jet moving upstream is close to the incoming flow velocity in the case with obstacle the re entrant jet also occurs due to a pressure difference in the wake flow however this pressure difference is relatively small meanwhile the liquid jet is facing a wall of the obstacle so that it changes its direction and becomes slow another velocity field at the following time t b is supplemented in fig 12 at this point the small scale shedding cavitation begins to collapse the re entrant jet is divided into two parts one jet is passing over the obstacle and entering into the region before the obstacle the other is rolling with the small scale shedding cavitation in this way the jet moving upstream becomes weaker as for the pressure difference which is the driving force for the re entrant jet we present more information about the transient and mean pressure distributions along the surfaces fig 13 shows the transient pressure gradients in a cycle sharp peaks are found in the case without obstacle at time t 1 a peak with d p d x 1 5 10 4 is found when the cavity length almost reaches the maximum the existence of obstacle weakens the transient pressure difference in the wake flow the amplitudes of d p d x from time t 0 to t 2 which correspond to the process of the cavity growth are less than 5000 in this case fig 14 shows the transient and mean pressure distributions fig 14 a shows the transient pressure distribution in the case without obstacle in a cycle σ 0 7 statistics results of the pressure are obtained by averaging more than ten periods in the case without obstacle there is a region at the tail part of the cavity in which the pressure increases monotonously this means that the adverse pressure gradient exists in most of the time in the obstacle case the pressure does not increase monotonously in fact there are two local regions in the vicinity of the obstacle having accelerating gradients one is around the obstacle the other is behind the obstacle 5 conclusions in this paper the effects of obstacle on inhibiting the cloud cavitation are studied both experimentally and numerically the images of evolution of cavitation are recorded by a high speed camera an image processing approach is developed to get the mean fields and standard derivations of the images a pressure based algorithm is used for the computations of the unsteady cavitating flows around the 2d flat hydrofoils the investigations focus on the comparisons of differences between the case without obstacle and the case with obstacle both the experiments and the simulations show that there are three stages in the case without obstacle growth of the cavity formation of the re entrant jet and shedding and collapsing of the cloud cavitation the placement of an obstacle on the flat hydrofoil inhibits the region of cavitation as well as the instability of the cavitation only small scale cavitation shedding can be observed in this case it is noted that there is a range of cavitation number i e 0 74 to 0 7 in which the cavity length almost keeps constant and is close to the distance of the obstacle from the leading edge the features of the cavitating flows indicate that the re entrant jet is weaker in the case with obstacle the existence of an obstacle changes the strength and direction of the transient re entrant jet as well as the pressure distribution when the re entrant jet generates behind the obstacle it faces the wall of the obstacle it will be divided into two jets one passing over the obstacle with a small speed the other rolling with the shedding cavitation the adverse pressure gradient at the tail part of the cavity which is the driving force for the re entrant jet also decreases due to the existence of the obstacle in future work an obstacle could be added on the surface of fluid machinery for example the blades of centrifugal pump or axial pump to study the effect of inhibition of cloud cavitation acknowledgement project was supported by the national natural science foundation of china no 11272284 the state key program of national natural science of china no 11332009 and zhejiang provincial natural science foundation of china no ly17a020004 
23481,this paper investigates adaptive fault tolerant control and fault reconstruction problem for auv subject to ocean current disturbance and modelling uncertainty at first a virtual closed loop system based adaptive fault tolerant control method is developed in this method the constructed virtual closed loop system is mainly used to deal with the influence of the initial tracking error in an ideal environment and avoid the serious chattering phenomenon in control output then with respect to fault reconstruction in the framework of fault tolerant control an improved second order sliding mode observer is constructed to estimate the thruster fault effect the feedback of the developed observer consists of different functions of the estimation errors including fractional function signature function and integral function etc furthermore the stability analysis is given based on lyapunov theory finally a series of simulations are performed on an over actuated auv for different desired trajectories and different types of thruster faults under the condition of the simulated ocean current environment the comparative simulation results demonstrate the effectiveness and feasibility of the new design keywords autonomous underwater vehicle trajectory tracking second order sliding mode observer fault reconstruction fault tolerant control 1 introduction due to their advantages in terms of reliability and flexibility autonomous underwater vehicles auvs have been widely used for observation of underwater structure and other scientific and commercial missions choi et al 2013 shen et al 2017 yu et al 2017 for example auvs have been used as platforms with survey sensors close to the inspected objects such as reservoir dams to acquire high quality results without other disturbances sun et al 2012 auvs operate in the unknown and complicated ocean environment without any umbilical cable safety and reliability are two most important features for auvs dearden and ernits 2013 hamilton et al 2007 thrusters are the most important propulsion system but also are liable to faults such as entangled fault or impaired fault omerdic and roberts 2004 once thruster fault is occurred control performance may be degraded or even the loss of auvs probably occurs if continuing to operate as before without any alarms zhang et al 2015b many thruster fault diagnosis methods have been developed for auvs classifying into model based diagnosis data driven based quantitative diagnosis and qualitative diagnosis zhang et al 2015a the latter two methods are relatively complicated and in general would take up too many computer resources the model based diagnosis methods are mainly achieved based on observers chu and zhang 2014 in model based fault diagnosis one commonest way corradini et al 2011 is to calculate the residual error between the estimated auv states provided by observers and the real auv states provided by sensors and then to detect isolate and identify thruster fault based on the residual error however in this kind of diagnosis method threshold values are required but also difficult to be determined in priori another typical way is to directly estimate the thruster fault effect by fault reconstruction chu and zhang 2014 in this study fault reconstruction shall be investigated in fault reconstruction research the main procedures can be summarized a sliding mode observer with finite time convergence is built at first to estimate the system states and then the concept equivalent output injection is used to obtain the estimated value of fault effect rahme and meskin 2015 yan and edwards 2007 and alwi et al 2012 investigated fault reconstruction problem in a fixed feedback controller for a nonlinear system with bounded uncertainty or a linear parameter varying system where the sliding mode observer was constructed based on the proportion term and signature term of the estimated output error also fault reconstruction was investigated based on the combination of high gain observer and sliding mode observer for nonlinear system veluvolu et al 2014 where the control input was fixed and the fault effect is independent with control input in order to improve the fault reconstruction precision other observers with faster convergence speed have been applied to estimate the system states chu and zhang 2014 developed a thruster fault reconstruction method on the basis of the terminal sliding mode observe structure in tan et al 2010 and rbf neural network was used to estimate the unknown function in auv model in the whole process of fault reconstruction besides second order sliding mode observer moreno and osorio 2008 was presented based on super twisting algorithm due to its advantage of finite time convergence and the robustness to the bounded disturbances second order sliding mode observers have been applied in fault reconstruction e g a novel fault reconstruction method was given based on second order sliding mode observer with adaptive gains for pem fuel cell air feed system where the fault was independent with control input in this paper fault reconstruction is investigated based on second order sliding mode observer for auvs with thruster faults in auv field the thruster fault effect is related with the controller output in general rather than a simple function only related with time moreover in order to guarantee auv s reliability and safety even in the case of thruster faults adaptive fault tolerant controller with good robustness to unknown thruster faults is used where the thruster fault is considered as a part of the general uncertainty the action of adaptive fault tolerant controller would reduce or even hide the fault thruster effect on the tracking performance it will increase the difficulty of fault reconstruction compared with in the case of the fixed controller based on the above mentioned consideration thruster fault reconstruction is investigated in adaptive fault tolerant control system for auvs the paper develops an adaptive fault tolerant control method based on virtual closed loop system and an improved second order sliding mode observer based thruster fault reconstruction method in the new design at first the adaptive fault tolerant controller is developed by using a virtual closed loop system to separately compensate the effect of the initial tracking error and thruster fault and the difference between the controlled planes in real system and the virtual system is counteracted based on the combination of neural network and pid type compensator and then the thruster fault reconstruction is completed based on the second order sliding mode observer inspired by the observer structure in kommuri et al 2016 in this paper it is assumed that both auv s position and velocity are measurable and in the developed thruster fault reconstruction method we design the feedback law in the observer structure based on the inertial term fractional power function and signature term of the auv s position and velocity estimation errors finally simulations are performed on odin auv and the simulation results demonstrate the effectiveness and feasibility of the new design the paper is organized as follows auv dynamics and problem statement are introduced in section 2 and in section 3 the developed adaptive fault tolerant control method and thruster reconstruction method are presented comprehensively which are verified by simulation results in section 4 finally we draw the conclusions of this paper 2 preliminary work and problem statement the nonlinear auv model subject to ocean current disturbance and thruster fault is described by fossen 2011 zhang et al 2015b 1 η j m η η 1 b g u m η η 1 c r b η η η η c a η η r η r η r d η η r η r η r g η η f η η v c m η η 1 j t b k u f t h where j r 6 6 is the transformation matrix from the inertial frame to the body frame η r 6 1 is auv s position and orientation vector with respect to the inertial frame η r η v c and v c r 6 1 is irrational ocean current vector with respect to the body frame m η η r 6 6 is the mass matrix including added mass effects described in the inertial frame c r b η η η is rigid body coriolis and centripetal matrix described in the inertial frame c a η η r η r is hydrodynamic coriolis and centripetal matrix described in the inertial frame d η η r η r is drag matrix described in the inertial frame g η η is the vector of gravity and buoyancy forces and moments b r 6 m is thruster configuration matrix m is the number of thrusters u r m 1 is the control output acting to thrusters and affected by thruster saturation the control output should satisfy the inequality u min i u i u max i u max i and u min i are the maximum and minimum thrust of the ith thruster can provide k r m m is a diagonal matrix and its element satisfies k i i 0 1 denoting the partial loss of the ith thruster effectiveness f th is the thruster fault effect and is bounded in this paper g r 6 m is assumed to be known and the structure of f η η v c r 6 1 is known but the detailed parameters are unknown however according to the researches of auv model identification such as avila et al 2013 an approximation expression of the function f η η v c when all thrusters are healthy and there are no external disturbances can be derived denoted as f 0 η η 0 based on the historical open loop experiment data and the least square identification method and neural network nn is usually adopted to approximate the unknown function due to its universal approximation ability to the unknown function based on neural network theory the unknown function fun x can be expressed as 2 f u n x w q ε where w is the weighting matrix of the hidden to output layer q is the output of the hidden layer ε is the approximate error and ε h ε h ε is an unknown and positive vector in this paper two kinds of neural network models are used rbfnn in control design and recurrent neural network rnn in fault reconstruction in control design a reference model is used to generate the reference trajectory in general described by 3 η r ω n 2 η r 2 ω n ξ η r ω n 2 η d where η d is the desired trajectory ω n and ξ are positive constant from eq 1 the thruster fault effect f th is a function about the control output rather than independent with the control output in the research of laghrouche et al 2015 the objective of this paper is to design an adaptive fault tolerant control system for auvs and reconstruct estimate the thruster fault effect f th in this control system 3 the developed fault tolerant control strategy and thruster fault reconstruction method in this section at first an adaptive fault tolerant control method is presented based on virtual closed loop system followed by auv learning model based on rnn finally thruster fault reconstruction method is presented based on an adaptive second order sliding mode observer the diagram for the developed adaptive fault tolerant control method and fault reconstruction is shown in fig 1 in fig 1 fault tolerant control is achieved according to a virtual closed loop system where the real auv is not controlled to track the desired trajectory but the output of the virtual closed loop system and the secondary controller is designed to counteract the difference between the constructed auv model and the real auv plane due to modelling uncertainty ocean current and thruster fault meanwhile a rnn is adopted to learn the relationship between the control output and auv states i e the unknown function due to the fast learning ability the auv learning model will be stopped after a certain period furthermore a second order sliding mode observer is constructed based on auv state transformation and another rnn whose structure and weighting values are the same as the auv learning model finally fault reconstruction is completed based on the estimation error of the observer 3 1 adaptive fault tolerant controller design adaptive fault tolerant control can be mainly achieved by two strategies one is to treat the fault effect as a part of the general uncertainty and then to use adaptive theory to estimate the general uncertainty such as wang et al 2015 the other is to assume the rate of the change of the fault effect is zero and to directly estimate the fault effect by adaptive theory in fault tolerant control design such as chadli et al 2013 from the expression of the thruster fault effect shown as eq 1 its magnitude is bounded and the rate of the change is bounded as well but not be zero or close to zero when the control output changes quickly hence this paper is to design the adaptive fault tolerant controller by the first strategy but the initial tracking error has a great influence on the tracking performance of adaptive fault tolerant controller as demonstrated in the later numerical cases in order to reduce the negative effect caused by the initial tracking error and make full use of the constructed auv model a novel adaptive fault tolerant control method is developed based on virtual closed loop system from fig 1 the derived auv approximate model is used to construct a virtual closed loop system and the output of the virtual closed loop system is input to the real auv system as a virtual desired trajectory different from the existing adaptive fault tolerant control law e g wang et al 2015 in virtual closed loop system there is no external disturbance and modelling uncertainty so the controller called primary controller is very easy to design based on fixed gain feedback the primary controller is given by 4 a u 0 0 g a r η 0 η 0 0 f 0 η 0 η 0 0 b r η d 1 2 b r k e 0 e 0 1 2 w e 0 e 0 4 b a r t p p a r p b r λ k b r t p 0 where a r 0 i ω n 2 i 2 ω n ξ i b r 0 ω n 2 i k λ k b r t p w λ w 0 g t p i and 0 are identity and zero matrices respectively of compatible dimensions λ k and λ w are positive constant p is positive definite matrix the superscript denotes pseudo inverse operation the error dynamics e 0 η 0 η r can be expressed 5 e 0 f 0 η 0 η 0 0 ω n 2 x r 2 ω n ξ x r g u 0 ω n 2 η d the proof is very simple and here is omitted so far the design of the virtual closed loop system is completed next the primary controller and another new controller called secondary controller will be combined to control auv to track the output of the virtual closed loop system considering the difference between the controlled plants of these two closed loop systems in this paper rbfnn based secondary controller is designed to estimate the difference between the two controlled plants but there exists approximation error when using nn to estimate an unknown function as mentioned in previous section here we use a generalized saturation function its definition can be found in lopez araujo et al 2015 to compensate the estimation error and avoid the discontinuity in control law as well in this paper the adaptive fault tolerant control law and the adaptive rate are given by 6 u u 0 g w ˆ 1 q 1 g s d k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t 7 a ϕ ˆ λ ϕ e s q 1 t 7 b w ˆ 1 s a ϕ ˆ where k p2 k i2 k d2 are the pid parameters λ φ is a positive constant e s e s1 e s2 e s 1 η η 0 e s 2 η η 0 s d k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t s p k p 2 e s 2 k d 2 e s 2 k i 2 e s 1 d t s p k p 2 e s 1 k i 2 e s 1 d t s a and s p are strictly increasing generalized saturation function q 1 is the output of the hidden layer in rbf neural network and q 1 exp e s m s 2 μ s 2 where the input of the neural network is e s m s and μ s are the known center and width vectors of the radial basis function based on control law 6 and adaptive rate 7 the tracking error can be achieved ultimately uniformly bounded even in presence of the unknown thruster faults and the proof can be completed by selecting the lyapunov function i e v s 1 2 e s t e s λ ϕ 1 i 1 6 j 1 p 0 ϕ i j s a i j r d r and the optimal weight w is constant so the weight w can be expressed by the generalized saturation function i e w s a ϕ in this lyapunov function p denotes the number of columns in the weight matrix w s a i j ϕ i s a i j ϕ ˆ i s a i j ϕ i s a i j ϕ ˆ i and s a i j ϕ i are the elements of s a ϕ ˆ and s a ϕ according to the properties of the generalized saturation function lopez araujo et al 2015 s a i j ϕ i is also a generalized saturation function with strictly increasing property and the term 0 ϕ i j s a i j r d r is larger than zero so the lyapunov function v s is non negative then the proof is simply and can be finished based on lyapunov theory 3 2 auv learning model in this paper fault reconstruction is achieved based on sliding mode observer which also requires the auv dynamic model in this subsection an auv learning model is presented based on recurrent neural network in auv learning model the auv dynamics after thruster fault occurrence should not be learned otherwise the learned value of the unknown function f η η v c would include the thruster fault effect in this paper it is assumed that all the thrusters are healthy at the beginning period and neural network can capture the relationship between the auv s inputs and outputs during this period after this period the learning model stops updating their parameters and by this way the thruster fault effect does not be included in the learned value of the unknown function f η η v c besides as mentioned in section 2 an approximate model of auv dynamics can be obtained off line based on the above consideration shown as fig 2 due to the ability of fast approximation rnn and the expression of f 0 η η 0 are used to learn the unknown function f η η v c where ζ 1 ζ 2 are the auv state after line transformation described in the next subsection and ζ 1 e ζ 2 e are the output of auv learning model based on back propagation neural network the outputs with the one step delay time in both the hidden layer and output layer are used as the input of the first and second recurrent layers respectively the activation function q 2 in hidden layer adaptive rate about weighting matrixes and the estimated expression of f η η v c denoted as f e η η v c according to the auv learning model are shown 8 a q 2 1 1 exp α 1 z β 1 q n 1 γ 1 f 1 n 1 8 b w 2 b 1 z q 2 t α ˆ 2 b 2 z z t w ˆ q α t β ˆ 2 b 3 q n 1 z t w ˆ q β t γ ˆ 2 b 4 f n 1 z t w ˆ q γ t h ˆ 2 b 5 z 12 5 s i g n z 8 c f e η η v c w ˆ 2 q 2 h 1 z f 0 η η 0 where z denotes the difference between the output from auv learning model and the measured auv state after state transformation b i i 1 5 are constants q n 1 and f n 1 denote the value of q 2 and f e η η v c respectively at the previous time instant n 1 and w 2 α 2 β 2 γ 2 are the weighting matrixes of hidden to output layer input to hidden layer hidden to first recurrent layer output to second recurrent layer q α q β and q γ are the partial derivatives of q 2 with respect to αz βq n 1 γf n 1 respectively h 2 z is the compensation term as shown in fig 1 in thruster fault reconstruction system there is an identical model as the auv learning model to provide the estimation value of the unknown function f η η v c but the model in thruster fault reconstruction system does not learn by itself but real time receives the parameters of the auv learning model including weighting matrixes 3 3 thruster fault reconstruction in this subsection a second order adaptive sliding mode observer is developed at first and then the theoretical analysis is given to show the state estimation error and the fault reconstruction error can be finite time convergence to a certain range according to tan et al 2010 a linear coordinate transformation ζ t η η t is introduced and the underwater vehicle s dynamic model eq 1 is rewritten 9 ζ a ζ f ζ 1 ζ 2 f t h g u where ζ ζ 1 t ζ 2 t t a t 2 i t 2 2 t 2 r 12 12 t i 0 t 2 i t 2 d i a g a 1 a 6 α i is a positive constant f ζ 1 ζ 2 0 f η η v c g 0 g f t h 0 f t h the designed second order sliding mode observer is expressed 10 ζ ˆ 1 t 2 ζ ˆ 1 ζ ˆ 2 μ 1 ζ ˆ 2 t 2 2 ζ ˆ 1 t 2 ζ ˆ 2 f ˆ ζ ˆ 1 ζ ˆ 2 g ζ 1 u μ 2 where ζ ˆ 1 and ζ ˆ 2 are the estimation values of ζ 1 and ζ 2 f ˆ ζ ˆ 1 ζ ˆ 2 is the estimation network receiving the information provided by learning model μ 1 and μ 2 are the feedback in the designed observer with respect to the design of the feedback μ 1 and μ 2 inspired by kommuri et al 2016 a modified version of the feedback is presented as eq 11 in order to increase the convergence speed and improve the robustness to the external disturbance and uncertainty 11 μ 1 l 1 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t l 3 p 2 k c k d k e δ 2 d t μ 2 l 2 δ 1 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t where δ 1 ζ ˆ 1 ζ 1 δ 2 ζ ˆ 2 ζ 2 k a k a0 l 4 0 5 k b k b1 k b0 l 4 k c k c0 l 4 2 k d k d0 l 4 k e mk a k b k 1 k 10 l 0 0 5 k 2 k 21 k 20 l 0 k 3 k 30 l 0 2 k 4 k 40 l 0 k 5 mk 1 k 2 k 10 k 20 k 21 k 30 k 40 and k a0 k b0 k b1 k c0 k d0 m l 0 l 3 l 4 are positive constant p 2 is positive definite matrix k b1 t 2 l 1 k 21 t 2 then the dynamic error system is 12 δ 1 t 2 l 1 δ 1 δ 2 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t l 3 p 2 k c k d k e δ 2 d t δ 2 t 2 2 l 2 δ 1 t 2 δ 2 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 k 1 δ 2 0 5 s i g n δ 2 k 3 δ 2 k 4 s i g n δ 2 d t k 2 δ 2 f t h k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t based on the developed second order sliding mode observer 10 11 under the condition i e k c0 k d0 2m 2 5m 2 k b0 k b0 k c0 m 2 3 5m 3 5 k a0 k a0 k b0 k b0 k 30 k 40 2m 2 5m 2 k 20 k 20 k 30 m 2 3 5m 3 5 k 10 k 10 k 20 k 20 m is a constant the estimated auv state error can converge to a small region in a finite time and the estimation of the thruster fault effect f th is given by k 3 δ 2 k 4 s i g n δ 2 d t k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t here we only present the proof about the finite time convergence of the variable φ 2 δ2 since the proof about the finite time convergence of the variables δ1 φ 1 can be completed in the same way eq 12 is rewritten by 13 δ 1 t 2 l 1 δ 1 δ 2 k a δ 1 0 5 s i g n δ 1 k b δ 1 φ 1 φ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 l 3 p 2 k c k d k e δ 2 δ 2 t 2 2 l 2 δ 1 t 2 δ 2 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 φ 2 φ 2 f t h k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 the following candidate lyapunov function is considered 14 v 2 x t p x x where x l 0 1 2 δ 2 1 2 s i g n δ 2 l 0 δ 2 φ 2 p x 1 2 4 k 40 k 10 2 k 10 k 20 k 10 k 10 k 20 k 20 2 2 k 30 k 20 k 10 k 20 2 differentiating the variable x with respect to time yield to 15 x l 0 l 0 1 2 δ 2 1 2 0 5 k 10 2 k 20 0 5 0 0 5 k 10 0 k 40 k 50 0 x l 0 1 5 k 20 0 0 0 5 k 10 k 20 1 0 k 30 0 x 0 5 l 0 1 2 ρ 1 δ 2 1 2 l 0 ρ 1 ρ 2 where ρ 1 t 2 2 l 2 δ 1 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 ρ 2 f t h l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 here it is assumed that ρ 1 δ 1 δ 2 δ 2 ρ 2 δ 3 and δ i i 1 2 3 are unknown positive constant and the time derivative of v 2 is expressed by 16 v 2 l 0 l 0 1 2 δ 2 1 2 x t ω 1 x l 0 x t ω 2 x 2 0 5 l 0 1 2 δ 2 1 2 ρ 1 l 0 ρ 1 ρ 2 p x x where ω 1 k 10 2 2 k 40 k 10 2 0 k 10 0 2 k 30 5 2 m k 20 2 3 k 20 2 m k 20 k 10 3 k 20 2 m k 20 1 ω 2 k 20 k 40 2 k 10 2 0 0 0 k 30 k 20 2 k 20 0 k 20 1 and it has the following inequalities 17 a l 0 1 2 δ 2 1 2 ρ 1 1 0 0 p x x 0 5 l 0 1 2 δ 2 1 2 ρ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 l 0 l 0 1 2 δ 2 1 2 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 δ 2 λ max ω 3 x t x 17 b 2 l 0 ρ 1 0 1 0 p x x l 0 ρ 1 k 10 k 20 k 20 2 2 k 30 k 20 x l 0 δ 1 k 10 k 20 k 20 2 2 k 30 k 20 x δ 2 λ max ω 4 x t x 17 c ρ 2 0 0 1 p x x δ 3 k 10 k 20 2 x where ω 3 4 k 40 k 10 2 0 5 k 10 k 20 0 5 k 10 0 5 k 10 k 20 0 0 0 5 k 10 0 0 ω 4 0 0 5 k 10 k 20 0 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 0 0 5 k 20 0 according to eq 17 the time derivative of v 2 can be further expressed by 18 v 2 l 0 l 0 1 2 δ 2 1 2 λ min ω 1 x 2 l 0 λ min ω 2 x 2 0 5 l 0 l 0 1 2 δ 2 1 2 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 δ 2 λ max ω 3 x 2 l 0 δ 1 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 x δ 2 λ max ω 4 x 2 δ 3 k 10 k 20 2 x l 0 x l 0 1 2 δ 2 1 2 λ min ω 1 x 0 5 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 l 0 δ 1 q 1 λ min 1 2 p x v 2 1 2 δ 3 q 2 λ min 1 2 p x v 2 1 2 l 0 λ min ω 2 λ max p x 0 5 δ 2 λ max ω 3 λ min p x δ 2 λ max ω 4 λ min p x v 2 where q 1 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 q 2 k 10 k 20 2 and then it follows that for x 0 5 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 1 κ λ min ω 1 and the constant κ 0 1 moreno and osorio 2012 19 v 2 l 0 κ λ min ω 1 λ max 1 2 p x l 0 δ 1 q 1 λ min 1 2 p x δ 3 q 2 λ min 1 2 p x ω 5 v 2 1 2 l 0 λ min ω 2 λ max p x 0 5 δ 2 λ max ω 3 λ min p x δ 2 λ max ω 4 λ min p x ω 6 v 2 different from laghrouche et al 2015 a fixed gain l 0 is used in the parameters k 1 k 2 k 3 k 4 k 5 of observer rather than a time varying function because if selecting a time varying function it would bring some difficulties to the proof and also have some problems at the beginning of estimation it can be guaranteed that the variables ω5 and ω6 are positive by selecting the appropriate values of l 0 k 10 k 20 k 30 k 40 k 50 therefore from eq 19 it shows that the variables φ2 δ2 can enter the region in finite time it also means that the estimated expression of the thruster fault effect f th can be presented as k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t 4 simulation in this section an over actuated auv e g odin auv is used to perform simulations to demonstrate the effectiveness of the new design and the existing fault tolerant control law and fault reconstruction method are used to show the advantages of the developed method odin auv is shown in fig 3 a and its dynamic model can be seen in podder and sarkar 2001 there are 8 identical thrusters to provide forces to control auv and its configuration figure is shown in fig 3 b also it is assumed that the magnitude of thrusters is 200n and odin auv s initial position and velocity are η 0 1 0 1 0 1 0 π 18 π 18 π 9 η 0 0 2 0 2 0 2 0 2 0 2 0 2 the ocean current is generated by using a first order gauss markov process fossen 2011 20 m v c μ c m v c ω c where m vc is the magnitude of ocean current velocity with respect to the inertial frame ω c is gaussian white noise with mean value of 1 5 and variance value of 1 μ c 3 also the two angles about ocean current s direction β c sideslip angle and α c angle of attack where β c is generated by the sum of gussian noise with mean of 0 and variance of 50 and α c β c 2 in rbfnn the number of nods in the input layer hidden layer and output layer are 12 30 and 6 respectively and the initial value of the weight w 1 is zero the width of radial basis function is 0 1 and its centers are distributed evenly within the range of 0 1 0 1 in this paper the involved general saturation function is given according to lopez araujo et al 2015 21 s a χ s p χ χ χ l p s i g n χ l p m p l p tanh χ s i g n χ l p m p l p χ l p in the function s a ϕ ˆ the l p and m p are set as 1 and 2 in the functions of s p k p 2 e s 1 k i 2 e s 1 d t and s p k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t the l p and m p are set as 3 3 3 7 7 7 4 4 4 10 10 10 and 7 5 7 5 7 5 17 5 17 5 17 5 10 10 10 25 25 25 respectively other controller parameters are set as ω n 3 ξ 0 8 p 1 5 17 4178 i 6 6 0 8662 i 6 6 0 8662 i 6 6 1 9730 i 6 6 λ k 1 34 0663 λ w 5 λ φ 0 2 k p2 diag 400 400 400 8100 8100 8100 k d2 diag 10 10 10 10 10 10 k i2 diag 2 5 2 5 2 5 2 5 2 5 2 5 in rnn b 1 b 2 b 3 b 4 5 b 5 50 the initial values of w 2 α β γ are selected randomly within the range of 0 5 0 5 the parameters in observer are given as below l 1 2 5 i l 2 0 222 i p 1 1 1546 i p 2 1 4845 i k a0 4p 1 k c0 25 k b0 1 6 k d0 9 8 l 4 1 m 2 k 10 6p 2 k 30 60 k 20 1 12 k 40 10 l 0 4 5 l 3 1 and the initial values of the observer ζ ˆ 1 0 2 2 2 π 9 π 9 2π 9 ζ ˆ 2 0 0 4 0 4 0 4 0 4 0 4 0 4 in order to show the robustness of the new design to the thruster fault effect three common kinds of faults are considered incipient thruster fault intermittent fault and abrupt fault and their expressions are given 22 a k 11 0 t 70 0 29 80 t 70 0 01 sin π 5 t 70 70 t 150 0 29 0 01 sin π 10 t 150 t 150 22 b k 11 0 t 70 0 2 70 t 120 0 120 t 150 0 4 150 t 22 c k 11 0 t 70 f t 70 with f a fixed constant within the range of 0 1 and it is reasonable to assume that there is a period time from the mission start to thruster fault occurrence which can be used for auv model learning in simulations the auv model learning stops at 60th second and the thruster faults occurred from 70th second two typical desired trajectories are considered in simulations spiral trajectory and line trajectory 23 a η d x d y d z d 0 0 0 23 b η d 1 5 0 2 t 2 2 0 0 0 t 100 21 5 2 0 2 t 100 2 0 0 0 100 t 150 21 5 0 2 t 150 8 2 0 0 0 t 150 where x d 4 1 cos 0 15t y d 2sin 0 15t z d 0 2t based on the above mentioned simulation environment the results are shown below fig 4 is the spiral trajectory tracking results for the new design under the condition of 30 incipient fault in t1 thruster from fig 4 a c the tracking performance is satisfactory and there is not obvious chattering phenomenon in the control output from fig 4 d e it shows that the developed method can achieve the fast convergence of auv states estimation although there are large errors at the early stage from fig 4 f the real t1 thruster fault effect mainly focuses on auv s yaw compared with the other dofs while the developed fault reconstruction method can estimate the yaw component of the thruster fault effect with a good precision however on the small components of the thruster effect the reconstruction precision is relatively poor furthermore to demonstrate the developed method is also effective and feasible in other types of thruster fault intermittent fault and abrupt fault are considered in simulations respectively fig 5 is the results of intermittent fault in t1 thruster and figs 6 and 7 are the results in the condition of respectively 20 abrupt fault f 0 2 and 40 abrupt fault f 0 4 in t1 thruster from figs 5 7 the tracking error of the developed fault tolerant controller is also small even in different types of thruster faults in t1 thruster it demonstrates the good robustness of the developed adaptive fault tolerant control law to the unknown thruster fault and from the fault reconstruction results in figs 5 7 the constructed second order sliding mode observer can reconstruct the large component i e yaw component of the thruster fault effect with a good precision same as the first case the developed method has a relatively poor reconstruction precision on the small components of the thruster effect in addition line trajectory is also selected to further evaluate the performance of the new design in this case the incipient fault occurs in t3 thruster figs 8 11 give the results for the new design under different types of thruster faults for comparative purposes two existing methods are considered i e directly adaptive rbfnn based fault tolerant controller in wang et al 2015 and another second order sliding mode observer based fault reconstruction method in laghrouche et al 2015 directly adaptive rbf neural network based fault tolerant controller in wang et al 2015 this comparison case is to demonstrate the effectiveness of the new design in terms of fault accommodation in wang et al 2015 it also treated the thruster fault effect as a part of the general uncertainty and directly used neural network to estimate the unknown function and it adopted boundary layer way to avoid the discontinuity in control law the control law is given 24 a u 0 6 8 g a r η 0 η 0 0 6 1 f 0 η η 0 f e η η b r r φ s a t x e 24 b w 3 a 1 s q 3 t v 3 a 2 x e s t w ˆ q v t m ˆ u a 3 s t w ˆ q m t μ ˆ u a 4 s t w ˆ q μ t φ ˆ a 5 x e where f e η η is the output of rbfnn x e e 1 e 2 q 3 is also output of the hidden layer a 1 a 2 a 5 3 a 3 a 4 2 s e 1 e 2 s a t x e x e ς x e 0 5 s i g n x e x e 0 5 other parameters definition can be found in wang et al 2015 figs 12 and 13 give the corresponding tracking results to figs 4 and 8 for the control law in wang et al 2015 compared with the control output in figs 12 and 13 the chattering phenomenon in figs 4 c and fig 8 c are less serious based on the new design furthermore these comparative results also confirm that the tracking precision after fault occurrence is better for the new control law compared with that in wang et al 2015 another second order sliding mode observer based fault reconstruction method in laghrouche et al 2015 this comparative case is to demonstrate the effectiveness of the new design in terms of fault reconstruction in laghrouche et al 2015 the fault effect was reconstructed based on adaptive second order sliding mode observer and the fault effect is also estimated by using the concept of the equivalent output error injection in this case we use the fixed gain rather than adaptive gain in observer and the fault reconstruction is also completed in the developed fault tolerant control law the second order observer is given as below 25 ζ ˆ 1 t 2 ζ ˆ 1 ζ ˆ 2 l 1 δ 1 l 1 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 d t ζ ˆ 2 t 2 t 2 ζ ˆ 1 t 2 ζ ˆ 2 f ˆ ζ ˆ 1 ζ ˆ 2 g ζ 1 u l 2 δ 1 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 d t where l 1 2 5 i l 2 0 222 i p 1 1 1546 i p 2 1 4845 i t 2 i k a 4p 1 k c 25 k b t 2 l 1 1 6i k d 1 8 k 1 2 4 5 0 5 p 2 k 3 45 4 5 0 5 k 2 t 2 1 4 4 5i k 4 0 5 4 5 and also the estimation expression of the thruster fault effect is given f ˆ t h k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 d t fig 14 and fig 15 show the corresponding reconstruction results to figs 4 and 8 for the fault reconstruction in laghrouche et al 2015 from figs 14 and 15 the large component of the thruster fault effect can be also estimated based on the reconstruction method in laghrouche et al 2015 however these comparative results confirm that the fault reconstruction precision of the new design is better than that in laghrouche et al 2015 on the large component of the thruster fault effect besides the difference of the reconstruction result in yaw and the other degrees of freedom dofs in laghrouche et al 2015 is less obvious than that in the new design these simulation results verify that the developed control law is robust to the external disturbance and different types of thruster faults and has a nice performance in spline or line trajectory tracking and from these results it also can be seen that the fault on t1 or t3 thruster mainly affects odin auv s yaw i e the component of thruster fault effect on yaw is relative large and these fault reconstruction results also confirm that the new design gives good reconstruction result for the relatively large component of thruster fault effect although the reconstruction precision is a little poor for the small components this phenomenon probably is resulted from the facts e g there exists serious coupling among auv s 6 dofs and it is really difficult to reconstruct those small components of the thruster fault effect this problem is also occurred in chu and zhang 2014 seeing again the fault reconstruction results in figs 4 11 compared with the result on yaw the reconstructed results on other auv s dofs are much small mainly being restricted in the range of 1 1 and there are obvious differences between the reconstructed results on yaw and other dofs in practice the purpose of fault reconstruction is to provide information for decision making system such as conducting active fault tolerant control or adjusting the mission online therefore if we want to use the reconstructed result to make a decision one simple and feasible way is to use threshold to reduce wrong behaviours caused by the imprecise fault reconstruction 5 conclusions in this paper a new adaptive fault tolerant control method is developed based on virtual closed loop system for auv with external disturbance modelling uncertainty and the initial tracking error and an improved second order sliding mode observer is constructed for thruster fault reconstruction in the framework of fault tolerant control simulation results on odin auv show that the new design can be robust to the external disturbance and the unknown thruster fault and also the main component of the thruster fault can be reconstructed well compared with the results based on other two methods the new design is more effective in terms of tracking precision chattering reduction of control output and fault reconstruction precision on the large component of the thruster fault effect future research will include the experiment verification on a real auv acknowledgments this work is partial supported by the national natural science foundation of china 51679054 national key r d program of china 2017yfc0305703 and china scholarship council no 201606680036 
23481,this paper investigates adaptive fault tolerant control and fault reconstruction problem for auv subject to ocean current disturbance and modelling uncertainty at first a virtual closed loop system based adaptive fault tolerant control method is developed in this method the constructed virtual closed loop system is mainly used to deal with the influence of the initial tracking error in an ideal environment and avoid the serious chattering phenomenon in control output then with respect to fault reconstruction in the framework of fault tolerant control an improved second order sliding mode observer is constructed to estimate the thruster fault effect the feedback of the developed observer consists of different functions of the estimation errors including fractional function signature function and integral function etc furthermore the stability analysis is given based on lyapunov theory finally a series of simulations are performed on an over actuated auv for different desired trajectories and different types of thruster faults under the condition of the simulated ocean current environment the comparative simulation results demonstrate the effectiveness and feasibility of the new design keywords autonomous underwater vehicle trajectory tracking second order sliding mode observer fault reconstruction fault tolerant control 1 introduction due to their advantages in terms of reliability and flexibility autonomous underwater vehicles auvs have been widely used for observation of underwater structure and other scientific and commercial missions choi et al 2013 shen et al 2017 yu et al 2017 for example auvs have been used as platforms with survey sensors close to the inspected objects such as reservoir dams to acquire high quality results without other disturbances sun et al 2012 auvs operate in the unknown and complicated ocean environment without any umbilical cable safety and reliability are two most important features for auvs dearden and ernits 2013 hamilton et al 2007 thrusters are the most important propulsion system but also are liable to faults such as entangled fault or impaired fault omerdic and roberts 2004 once thruster fault is occurred control performance may be degraded or even the loss of auvs probably occurs if continuing to operate as before without any alarms zhang et al 2015b many thruster fault diagnosis methods have been developed for auvs classifying into model based diagnosis data driven based quantitative diagnosis and qualitative diagnosis zhang et al 2015a the latter two methods are relatively complicated and in general would take up too many computer resources the model based diagnosis methods are mainly achieved based on observers chu and zhang 2014 in model based fault diagnosis one commonest way corradini et al 2011 is to calculate the residual error between the estimated auv states provided by observers and the real auv states provided by sensors and then to detect isolate and identify thruster fault based on the residual error however in this kind of diagnosis method threshold values are required but also difficult to be determined in priori another typical way is to directly estimate the thruster fault effect by fault reconstruction chu and zhang 2014 in this study fault reconstruction shall be investigated in fault reconstruction research the main procedures can be summarized a sliding mode observer with finite time convergence is built at first to estimate the system states and then the concept equivalent output injection is used to obtain the estimated value of fault effect rahme and meskin 2015 yan and edwards 2007 and alwi et al 2012 investigated fault reconstruction problem in a fixed feedback controller for a nonlinear system with bounded uncertainty or a linear parameter varying system where the sliding mode observer was constructed based on the proportion term and signature term of the estimated output error also fault reconstruction was investigated based on the combination of high gain observer and sliding mode observer for nonlinear system veluvolu et al 2014 where the control input was fixed and the fault effect is independent with control input in order to improve the fault reconstruction precision other observers with faster convergence speed have been applied to estimate the system states chu and zhang 2014 developed a thruster fault reconstruction method on the basis of the terminal sliding mode observe structure in tan et al 2010 and rbf neural network was used to estimate the unknown function in auv model in the whole process of fault reconstruction besides second order sliding mode observer moreno and osorio 2008 was presented based on super twisting algorithm due to its advantage of finite time convergence and the robustness to the bounded disturbances second order sliding mode observers have been applied in fault reconstruction e g a novel fault reconstruction method was given based on second order sliding mode observer with adaptive gains for pem fuel cell air feed system where the fault was independent with control input in this paper fault reconstruction is investigated based on second order sliding mode observer for auvs with thruster faults in auv field the thruster fault effect is related with the controller output in general rather than a simple function only related with time moreover in order to guarantee auv s reliability and safety even in the case of thruster faults adaptive fault tolerant controller with good robustness to unknown thruster faults is used where the thruster fault is considered as a part of the general uncertainty the action of adaptive fault tolerant controller would reduce or even hide the fault thruster effect on the tracking performance it will increase the difficulty of fault reconstruction compared with in the case of the fixed controller based on the above mentioned consideration thruster fault reconstruction is investigated in adaptive fault tolerant control system for auvs the paper develops an adaptive fault tolerant control method based on virtual closed loop system and an improved second order sliding mode observer based thruster fault reconstruction method in the new design at first the adaptive fault tolerant controller is developed by using a virtual closed loop system to separately compensate the effect of the initial tracking error and thruster fault and the difference between the controlled planes in real system and the virtual system is counteracted based on the combination of neural network and pid type compensator and then the thruster fault reconstruction is completed based on the second order sliding mode observer inspired by the observer structure in kommuri et al 2016 in this paper it is assumed that both auv s position and velocity are measurable and in the developed thruster fault reconstruction method we design the feedback law in the observer structure based on the inertial term fractional power function and signature term of the auv s position and velocity estimation errors finally simulations are performed on odin auv and the simulation results demonstrate the effectiveness and feasibility of the new design the paper is organized as follows auv dynamics and problem statement are introduced in section 2 and in section 3 the developed adaptive fault tolerant control method and thruster reconstruction method are presented comprehensively which are verified by simulation results in section 4 finally we draw the conclusions of this paper 2 preliminary work and problem statement the nonlinear auv model subject to ocean current disturbance and thruster fault is described by fossen 2011 zhang et al 2015b 1 η j m η η 1 b g u m η η 1 c r b η η η η c a η η r η r η r d η η r η r η r g η η f η η v c m η η 1 j t b k u f t h where j r 6 6 is the transformation matrix from the inertial frame to the body frame η r 6 1 is auv s position and orientation vector with respect to the inertial frame η r η v c and v c r 6 1 is irrational ocean current vector with respect to the body frame m η η r 6 6 is the mass matrix including added mass effects described in the inertial frame c r b η η η is rigid body coriolis and centripetal matrix described in the inertial frame c a η η r η r is hydrodynamic coriolis and centripetal matrix described in the inertial frame d η η r η r is drag matrix described in the inertial frame g η η is the vector of gravity and buoyancy forces and moments b r 6 m is thruster configuration matrix m is the number of thrusters u r m 1 is the control output acting to thrusters and affected by thruster saturation the control output should satisfy the inequality u min i u i u max i u max i and u min i are the maximum and minimum thrust of the ith thruster can provide k r m m is a diagonal matrix and its element satisfies k i i 0 1 denoting the partial loss of the ith thruster effectiveness f th is the thruster fault effect and is bounded in this paper g r 6 m is assumed to be known and the structure of f η η v c r 6 1 is known but the detailed parameters are unknown however according to the researches of auv model identification such as avila et al 2013 an approximation expression of the function f η η v c when all thrusters are healthy and there are no external disturbances can be derived denoted as f 0 η η 0 based on the historical open loop experiment data and the least square identification method and neural network nn is usually adopted to approximate the unknown function due to its universal approximation ability to the unknown function based on neural network theory the unknown function fun x can be expressed as 2 f u n x w q ε where w is the weighting matrix of the hidden to output layer q is the output of the hidden layer ε is the approximate error and ε h ε h ε is an unknown and positive vector in this paper two kinds of neural network models are used rbfnn in control design and recurrent neural network rnn in fault reconstruction in control design a reference model is used to generate the reference trajectory in general described by 3 η r ω n 2 η r 2 ω n ξ η r ω n 2 η d where η d is the desired trajectory ω n and ξ are positive constant from eq 1 the thruster fault effect f th is a function about the control output rather than independent with the control output in the research of laghrouche et al 2015 the objective of this paper is to design an adaptive fault tolerant control system for auvs and reconstruct estimate the thruster fault effect f th in this control system 3 the developed fault tolerant control strategy and thruster fault reconstruction method in this section at first an adaptive fault tolerant control method is presented based on virtual closed loop system followed by auv learning model based on rnn finally thruster fault reconstruction method is presented based on an adaptive second order sliding mode observer the diagram for the developed adaptive fault tolerant control method and fault reconstruction is shown in fig 1 in fig 1 fault tolerant control is achieved according to a virtual closed loop system where the real auv is not controlled to track the desired trajectory but the output of the virtual closed loop system and the secondary controller is designed to counteract the difference between the constructed auv model and the real auv plane due to modelling uncertainty ocean current and thruster fault meanwhile a rnn is adopted to learn the relationship between the control output and auv states i e the unknown function due to the fast learning ability the auv learning model will be stopped after a certain period furthermore a second order sliding mode observer is constructed based on auv state transformation and another rnn whose structure and weighting values are the same as the auv learning model finally fault reconstruction is completed based on the estimation error of the observer 3 1 adaptive fault tolerant controller design adaptive fault tolerant control can be mainly achieved by two strategies one is to treat the fault effect as a part of the general uncertainty and then to use adaptive theory to estimate the general uncertainty such as wang et al 2015 the other is to assume the rate of the change of the fault effect is zero and to directly estimate the fault effect by adaptive theory in fault tolerant control design such as chadli et al 2013 from the expression of the thruster fault effect shown as eq 1 its magnitude is bounded and the rate of the change is bounded as well but not be zero or close to zero when the control output changes quickly hence this paper is to design the adaptive fault tolerant controller by the first strategy but the initial tracking error has a great influence on the tracking performance of adaptive fault tolerant controller as demonstrated in the later numerical cases in order to reduce the negative effect caused by the initial tracking error and make full use of the constructed auv model a novel adaptive fault tolerant control method is developed based on virtual closed loop system from fig 1 the derived auv approximate model is used to construct a virtual closed loop system and the output of the virtual closed loop system is input to the real auv system as a virtual desired trajectory different from the existing adaptive fault tolerant control law e g wang et al 2015 in virtual closed loop system there is no external disturbance and modelling uncertainty so the controller called primary controller is very easy to design based on fixed gain feedback the primary controller is given by 4 a u 0 0 g a r η 0 η 0 0 f 0 η 0 η 0 0 b r η d 1 2 b r k e 0 e 0 1 2 w e 0 e 0 4 b a r t p p a r p b r λ k b r t p 0 where a r 0 i ω n 2 i 2 ω n ξ i b r 0 ω n 2 i k λ k b r t p w λ w 0 g t p i and 0 are identity and zero matrices respectively of compatible dimensions λ k and λ w are positive constant p is positive definite matrix the superscript denotes pseudo inverse operation the error dynamics e 0 η 0 η r can be expressed 5 e 0 f 0 η 0 η 0 0 ω n 2 x r 2 ω n ξ x r g u 0 ω n 2 η d the proof is very simple and here is omitted so far the design of the virtual closed loop system is completed next the primary controller and another new controller called secondary controller will be combined to control auv to track the output of the virtual closed loop system considering the difference between the controlled plants of these two closed loop systems in this paper rbfnn based secondary controller is designed to estimate the difference between the two controlled plants but there exists approximation error when using nn to estimate an unknown function as mentioned in previous section here we use a generalized saturation function its definition can be found in lopez araujo et al 2015 to compensate the estimation error and avoid the discontinuity in control law as well in this paper the adaptive fault tolerant control law and the adaptive rate are given by 6 u u 0 g w ˆ 1 q 1 g s d k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t 7 a ϕ ˆ λ ϕ e s q 1 t 7 b w ˆ 1 s a ϕ ˆ where k p2 k i2 k d2 are the pid parameters λ φ is a positive constant e s e s1 e s2 e s 1 η η 0 e s 2 η η 0 s d k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t s p k p 2 e s 2 k d 2 e s 2 k i 2 e s 1 d t s p k p 2 e s 1 k i 2 e s 1 d t s a and s p are strictly increasing generalized saturation function q 1 is the output of the hidden layer in rbf neural network and q 1 exp e s m s 2 μ s 2 where the input of the neural network is e s m s and μ s are the known center and width vectors of the radial basis function based on control law 6 and adaptive rate 7 the tracking error can be achieved ultimately uniformly bounded even in presence of the unknown thruster faults and the proof can be completed by selecting the lyapunov function i e v s 1 2 e s t e s λ ϕ 1 i 1 6 j 1 p 0 ϕ i j s a i j r d r and the optimal weight w is constant so the weight w can be expressed by the generalized saturation function i e w s a ϕ in this lyapunov function p denotes the number of columns in the weight matrix w s a i j ϕ i s a i j ϕ ˆ i s a i j ϕ i s a i j ϕ ˆ i and s a i j ϕ i are the elements of s a ϕ ˆ and s a ϕ according to the properties of the generalized saturation function lopez araujo et al 2015 s a i j ϕ i is also a generalized saturation function with strictly increasing property and the term 0 ϕ i j s a i j r d r is larger than zero so the lyapunov function v s is non negative then the proof is simply and can be finished based on lyapunov theory 3 2 auv learning model in this paper fault reconstruction is achieved based on sliding mode observer which also requires the auv dynamic model in this subsection an auv learning model is presented based on recurrent neural network in auv learning model the auv dynamics after thruster fault occurrence should not be learned otherwise the learned value of the unknown function f η η v c would include the thruster fault effect in this paper it is assumed that all the thrusters are healthy at the beginning period and neural network can capture the relationship between the auv s inputs and outputs during this period after this period the learning model stops updating their parameters and by this way the thruster fault effect does not be included in the learned value of the unknown function f η η v c besides as mentioned in section 2 an approximate model of auv dynamics can be obtained off line based on the above consideration shown as fig 2 due to the ability of fast approximation rnn and the expression of f 0 η η 0 are used to learn the unknown function f η η v c where ζ 1 ζ 2 are the auv state after line transformation described in the next subsection and ζ 1 e ζ 2 e are the output of auv learning model based on back propagation neural network the outputs with the one step delay time in both the hidden layer and output layer are used as the input of the first and second recurrent layers respectively the activation function q 2 in hidden layer adaptive rate about weighting matrixes and the estimated expression of f η η v c denoted as f e η η v c according to the auv learning model are shown 8 a q 2 1 1 exp α 1 z β 1 q n 1 γ 1 f 1 n 1 8 b w 2 b 1 z q 2 t α ˆ 2 b 2 z z t w ˆ q α t β ˆ 2 b 3 q n 1 z t w ˆ q β t γ ˆ 2 b 4 f n 1 z t w ˆ q γ t h ˆ 2 b 5 z 12 5 s i g n z 8 c f e η η v c w ˆ 2 q 2 h 1 z f 0 η η 0 where z denotes the difference between the output from auv learning model and the measured auv state after state transformation b i i 1 5 are constants q n 1 and f n 1 denote the value of q 2 and f e η η v c respectively at the previous time instant n 1 and w 2 α 2 β 2 γ 2 are the weighting matrixes of hidden to output layer input to hidden layer hidden to first recurrent layer output to second recurrent layer q α q β and q γ are the partial derivatives of q 2 with respect to αz βq n 1 γf n 1 respectively h 2 z is the compensation term as shown in fig 1 in thruster fault reconstruction system there is an identical model as the auv learning model to provide the estimation value of the unknown function f η η v c but the model in thruster fault reconstruction system does not learn by itself but real time receives the parameters of the auv learning model including weighting matrixes 3 3 thruster fault reconstruction in this subsection a second order adaptive sliding mode observer is developed at first and then the theoretical analysis is given to show the state estimation error and the fault reconstruction error can be finite time convergence to a certain range according to tan et al 2010 a linear coordinate transformation ζ t η η t is introduced and the underwater vehicle s dynamic model eq 1 is rewritten 9 ζ a ζ f ζ 1 ζ 2 f t h g u where ζ ζ 1 t ζ 2 t t a t 2 i t 2 2 t 2 r 12 12 t i 0 t 2 i t 2 d i a g a 1 a 6 α i is a positive constant f ζ 1 ζ 2 0 f η η v c g 0 g f t h 0 f t h the designed second order sliding mode observer is expressed 10 ζ ˆ 1 t 2 ζ ˆ 1 ζ ˆ 2 μ 1 ζ ˆ 2 t 2 2 ζ ˆ 1 t 2 ζ ˆ 2 f ˆ ζ ˆ 1 ζ ˆ 2 g ζ 1 u μ 2 where ζ ˆ 1 and ζ ˆ 2 are the estimation values of ζ 1 and ζ 2 f ˆ ζ ˆ 1 ζ ˆ 2 is the estimation network receiving the information provided by learning model μ 1 and μ 2 are the feedback in the designed observer with respect to the design of the feedback μ 1 and μ 2 inspired by kommuri et al 2016 a modified version of the feedback is presented as eq 11 in order to increase the convergence speed and improve the robustness to the external disturbance and uncertainty 11 μ 1 l 1 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t l 3 p 2 k c k d k e δ 2 d t μ 2 l 2 δ 1 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t where δ 1 ζ ˆ 1 ζ 1 δ 2 ζ ˆ 2 ζ 2 k a k a0 l 4 0 5 k b k b1 k b0 l 4 k c k c0 l 4 2 k d k d0 l 4 k e mk a k b k 1 k 10 l 0 0 5 k 2 k 21 k 20 l 0 k 3 k 30 l 0 2 k 4 k 40 l 0 k 5 mk 1 k 2 k 10 k 20 k 21 k 30 k 40 and k a0 k b0 k b1 k c0 k d0 m l 0 l 3 l 4 are positive constant p 2 is positive definite matrix k b1 t 2 l 1 k 21 t 2 then the dynamic error system is 12 δ 1 t 2 l 1 δ 1 δ 2 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t l 3 p 2 k c k d k e δ 2 d t δ 2 t 2 2 l 2 δ 1 t 2 δ 2 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 k 1 δ 2 0 5 s i g n δ 2 k 3 δ 2 k 4 s i g n δ 2 d t k 2 δ 2 f t h k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t based on the developed second order sliding mode observer 10 11 under the condition i e k c0 k d0 2m 2 5m 2 k b0 k b0 k c0 m 2 3 5m 3 5 k a0 k a0 k b0 k b0 k 30 k 40 2m 2 5m 2 k 20 k 20 k 30 m 2 3 5m 3 5 k 10 k 10 k 20 k 20 m is a constant the estimated auv state error can converge to a small region in a finite time and the estimation of the thruster fault effect f th is given by k 3 δ 2 k 4 s i g n δ 2 d t k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t here we only present the proof about the finite time convergence of the variable φ 2 δ2 since the proof about the finite time convergence of the variables δ1 φ 1 can be completed in the same way eq 12 is rewritten by 13 δ 1 t 2 l 1 δ 1 δ 2 k a δ 1 0 5 s i g n δ 1 k b δ 1 φ 1 φ 1 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 l 3 p 2 k c k d k e δ 2 δ 2 t 2 2 l 2 δ 1 t 2 δ 2 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 φ 2 φ 2 f t h k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 the following candidate lyapunov function is considered 14 v 2 x t p x x where x l 0 1 2 δ 2 1 2 s i g n δ 2 l 0 δ 2 φ 2 p x 1 2 4 k 40 k 10 2 k 10 k 20 k 10 k 10 k 20 k 20 2 2 k 30 k 20 k 10 k 20 2 differentiating the variable x with respect to time yield to 15 x l 0 l 0 1 2 δ 2 1 2 0 5 k 10 2 k 20 0 5 0 0 5 k 10 0 k 40 k 50 0 x l 0 1 5 k 20 0 0 0 5 k 10 k 20 1 0 k 30 0 x 0 5 l 0 1 2 ρ 1 δ 2 1 2 l 0 ρ 1 ρ 2 where ρ 1 t 2 2 l 2 δ 1 f ˆ ζ ˆ 1 ζ ˆ 2 f ζ 1 ζ 2 ρ 2 f t h l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 here it is assumed that ρ 1 δ 1 δ 2 δ 2 ρ 2 δ 3 and δ i i 1 2 3 are unknown positive constant and the time derivative of v 2 is expressed by 16 v 2 l 0 l 0 1 2 δ 2 1 2 x t ω 1 x l 0 x t ω 2 x 2 0 5 l 0 1 2 δ 2 1 2 ρ 1 l 0 ρ 1 ρ 2 p x x where ω 1 k 10 2 2 k 40 k 10 2 0 k 10 0 2 k 30 5 2 m k 20 2 3 k 20 2 m k 20 k 10 3 k 20 2 m k 20 1 ω 2 k 20 k 40 2 k 10 2 0 0 0 k 30 k 20 2 k 20 0 k 20 1 and it has the following inequalities 17 a l 0 1 2 δ 2 1 2 ρ 1 1 0 0 p x x 0 5 l 0 1 2 δ 2 1 2 ρ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 l 0 l 0 1 2 δ 2 1 2 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 δ 2 λ max ω 3 x t x 17 b 2 l 0 ρ 1 0 1 0 p x x l 0 ρ 1 k 10 k 20 k 20 2 2 k 30 k 20 x l 0 δ 1 k 10 k 20 k 20 2 2 k 30 k 20 x δ 2 λ max ω 4 x t x 17 c ρ 2 0 0 1 p x x δ 3 k 10 k 20 2 x where ω 3 4 k 40 k 10 2 0 5 k 10 k 20 0 5 k 10 0 5 k 10 k 20 0 0 0 5 k 10 0 0 ω 4 0 0 5 k 10 k 20 0 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 0 0 5 k 20 0 according to eq 17 the time derivative of v 2 can be further expressed by 18 v 2 l 0 l 0 1 2 δ 2 1 2 λ min ω 1 x 2 l 0 λ min ω 2 x 2 0 5 l 0 l 0 1 2 δ 2 1 2 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 x 0 5 δ 2 λ max ω 3 x 2 l 0 δ 1 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 x δ 2 λ max ω 4 x 2 δ 3 k 10 k 20 2 x l 0 x l 0 1 2 δ 2 1 2 λ min ω 1 x 0 5 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 l 0 δ 1 q 1 λ min 1 2 p x v 2 1 2 δ 3 q 2 λ min 1 2 p x v 2 1 2 l 0 λ min ω 2 λ max p x 0 5 δ 2 λ max ω 3 λ min p x δ 2 λ max ω 4 λ min p x v 2 where q 1 0 5 k 10 k 20 k 20 2 2 k 30 0 5 k 20 q 2 k 10 k 20 2 and then it follows that for x 0 5 δ 1 4 k 40 k 10 2 k 10 k 20 k 10 1 κ λ min ω 1 and the constant κ 0 1 moreno and osorio 2012 19 v 2 l 0 κ λ min ω 1 λ max 1 2 p x l 0 δ 1 q 1 λ min 1 2 p x δ 3 q 2 λ min 1 2 p x ω 5 v 2 1 2 l 0 λ min ω 2 λ max p x 0 5 δ 2 λ max ω 3 λ min p x δ 2 λ max ω 4 λ min p x ω 6 v 2 different from laghrouche et al 2015 a fixed gain l 0 is used in the parameters k 1 k 2 k 3 k 4 k 5 of observer rather than a time varying function because if selecting a time varying function it would bring some difficulties to the proof and also have some problems at the beginning of estimation it can be guaranteed that the variables ω5 and ω6 are positive by selecting the appropriate values of l 0 k 10 k 20 k 30 k 40 k 50 therefore from eq 19 it shows that the variables φ2 δ2 can enter the region in finite time it also means that the estimated expression of the thruster fault effect f th can be presented as k 3 δ 2 k 4 s i g n δ 2 k 5 δ 2 0 5 s i g n δ 2 d t l 3 p 2 k c δ 1 k d s i g n δ 1 k e δ 1 0 5 s i g n δ 1 d t 4 simulation in this section an over actuated auv e g odin auv is used to perform simulations to demonstrate the effectiveness of the new design and the existing fault tolerant control law and fault reconstruction method are used to show the advantages of the developed method odin auv is shown in fig 3 a and its dynamic model can be seen in podder and sarkar 2001 there are 8 identical thrusters to provide forces to control auv and its configuration figure is shown in fig 3 b also it is assumed that the magnitude of thrusters is 200n and odin auv s initial position and velocity are η 0 1 0 1 0 1 0 π 18 π 18 π 9 η 0 0 2 0 2 0 2 0 2 0 2 0 2 the ocean current is generated by using a first order gauss markov process fossen 2011 20 m v c μ c m v c ω c where m vc is the magnitude of ocean current velocity with respect to the inertial frame ω c is gaussian white noise with mean value of 1 5 and variance value of 1 μ c 3 also the two angles about ocean current s direction β c sideslip angle and α c angle of attack where β c is generated by the sum of gussian noise with mean of 0 and variance of 50 and α c β c 2 in rbfnn the number of nods in the input layer hidden layer and output layer are 12 30 and 6 respectively and the initial value of the weight w 1 is zero the width of radial basis function is 0 1 and its centers are distributed evenly within the range of 0 1 0 1 in this paper the involved general saturation function is given according to lopez araujo et al 2015 21 s a χ s p χ χ χ l p s i g n χ l p m p l p tanh χ s i g n χ l p m p l p χ l p in the function s a ϕ ˆ the l p and m p are set as 1 and 2 in the functions of s p k p 2 e s 1 k i 2 e s 1 d t and s p k p 2 e s 1 k d 2 e s 2 k i 2 e s 1 d t the l p and m p are set as 3 3 3 7 7 7 4 4 4 10 10 10 and 7 5 7 5 7 5 17 5 17 5 17 5 10 10 10 25 25 25 respectively other controller parameters are set as ω n 3 ξ 0 8 p 1 5 17 4178 i 6 6 0 8662 i 6 6 0 8662 i 6 6 1 9730 i 6 6 λ k 1 34 0663 λ w 5 λ φ 0 2 k p2 diag 400 400 400 8100 8100 8100 k d2 diag 10 10 10 10 10 10 k i2 diag 2 5 2 5 2 5 2 5 2 5 2 5 in rnn b 1 b 2 b 3 b 4 5 b 5 50 the initial values of w 2 α β γ are selected randomly within the range of 0 5 0 5 the parameters in observer are given as below l 1 2 5 i l 2 0 222 i p 1 1 1546 i p 2 1 4845 i k a0 4p 1 k c0 25 k b0 1 6 k d0 9 8 l 4 1 m 2 k 10 6p 2 k 30 60 k 20 1 12 k 40 10 l 0 4 5 l 3 1 and the initial values of the observer ζ ˆ 1 0 2 2 2 π 9 π 9 2π 9 ζ ˆ 2 0 0 4 0 4 0 4 0 4 0 4 0 4 in order to show the robustness of the new design to the thruster fault effect three common kinds of faults are considered incipient thruster fault intermittent fault and abrupt fault and their expressions are given 22 a k 11 0 t 70 0 29 80 t 70 0 01 sin π 5 t 70 70 t 150 0 29 0 01 sin π 10 t 150 t 150 22 b k 11 0 t 70 0 2 70 t 120 0 120 t 150 0 4 150 t 22 c k 11 0 t 70 f t 70 with f a fixed constant within the range of 0 1 and it is reasonable to assume that there is a period time from the mission start to thruster fault occurrence which can be used for auv model learning in simulations the auv model learning stops at 60th second and the thruster faults occurred from 70th second two typical desired trajectories are considered in simulations spiral trajectory and line trajectory 23 a η d x d y d z d 0 0 0 23 b η d 1 5 0 2 t 2 2 0 0 0 t 100 21 5 2 0 2 t 100 2 0 0 0 100 t 150 21 5 0 2 t 150 8 2 0 0 0 t 150 where x d 4 1 cos 0 15t y d 2sin 0 15t z d 0 2t based on the above mentioned simulation environment the results are shown below fig 4 is the spiral trajectory tracking results for the new design under the condition of 30 incipient fault in t1 thruster from fig 4 a c the tracking performance is satisfactory and there is not obvious chattering phenomenon in the control output from fig 4 d e it shows that the developed method can achieve the fast convergence of auv states estimation although there are large errors at the early stage from fig 4 f the real t1 thruster fault effect mainly focuses on auv s yaw compared with the other dofs while the developed fault reconstruction method can estimate the yaw component of the thruster fault effect with a good precision however on the small components of the thruster effect the reconstruction precision is relatively poor furthermore to demonstrate the developed method is also effective and feasible in other types of thruster fault intermittent fault and abrupt fault are considered in simulations respectively fig 5 is the results of intermittent fault in t1 thruster and figs 6 and 7 are the results in the condition of respectively 20 abrupt fault f 0 2 and 40 abrupt fault f 0 4 in t1 thruster from figs 5 7 the tracking error of the developed fault tolerant controller is also small even in different types of thruster faults in t1 thruster it demonstrates the good robustness of the developed adaptive fault tolerant control law to the unknown thruster fault and from the fault reconstruction results in figs 5 7 the constructed second order sliding mode observer can reconstruct the large component i e yaw component of the thruster fault effect with a good precision same as the first case the developed method has a relatively poor reconstruction precision on the small components of the thruster effect in addition line trajectory is also selected to further evaluate the performance of the new design in this case the incipient fault occurs in t3 thruster figs 8 11 give the results for the new design under different types of thruster faults for comparative purposes two existing methods are considered i e directly adaptive rbfnn based fault tolerant controller in wang et al 2015 and another second order sliding mode observer based fault reconstruction method in laghrouche et al 2015 directly adaptive rbf neural network based fault tolerant controller in wang et al 2015 this comparison case is to demonstrate the effectiveness of the new design in terms of fault accommodation in wang et al 2015 it also treated the thruster fault effect as a part of the general uncertainty and directly used neural network to estimate the unknown function and it adopted boundary layer way to avoid the discontinuity in control law the control law is given 24 a u 0 6 8 g a r η 0 η 0 0 6 1 f 0 η η 0 f e η η b r r φ s a t x e 24 b w 3 a 1 s q 3 t v 3 a 2 x e s t w ˆ q v t m ˆ u a 3 s t w ˆ q m t μ ˆ u a 4 s t w ˆ q μ t φ ˆ a 5 x e where f e η η is the output of rbfnn x e e 1 e 2 q 3 is also output of the hidden layer a 1 a 2 a 5 3 a 3 a 4 2 s e 1 e 2 s a t x e x e ς x e 0 5 s i g n x e x e 0 5 other parameters definition can be found in wang et al 2015 figs 12 and 13 give the corresponding tracking results to figs 4 and 8 for the control law in wang et al 2015 compared with the control output in figs 12 and 13 the chattering phenomenon in figs 4 c and fig 8 c are less serious based on the new design furthermore these comparative results also confirm that the tracking precision after fault occurrence is better for the new control law compared with that in wang et al 2015 another second order sliding mode observer based fault reconstruction method in laghrouche et al 2015 this comparative case is to demonstrate the effectiveness of the new design in terms of fault reconstruction in laghrouche et al 2015 the fault effect was reconstructed based on adaptive second order sliding mode observer and the fault effect is also estimated by using the concept of the equivalent output error injection in this case we use the fixed gain rather than adaptive gain in observer and the fault reconstruction is also completed in the developed fault tolerant control law the second order observer is given as below 25 ζ ˆ 1 t 2 ζ ˆ 1 ζ ˆ 2 l 1 δ 1 l 1 k b δ 1 k a δ 1 0 5 s i g n δ 1 k c δ 1 k d s i g n δ 1 d t ζ ˆ 2 t 2 t 2 ζ ˆ 1 t 2 ζ ˆ 2 f ˆ ζ ˆ 1 ζ ˆ 2 g ζ 1 u l 2 δ 1 k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 d t where l 1 2 5 i l 2 0 222 i p 1 1 1546 i p 2 1 4845 i t 2 i k a 4p 1 k c 25 k b t 2 l 1 1 6i k d 1 8 k 1 2 4 5 0 5 p 2 k 3 45 4 5 0 5 k 2 t 2 1 4 4 5i k 4 0 5 4 5 and also the estimation expression of the thruster fault effect is given f ˆ t h k 1 δ 2 0 5 s i g n δ 2 k 2 δ 2 k 3 δ 2 k 4 s i g n δ 2 d t fig 14 and fig 15 show the corresponding reconstruction results to figs 4 and 8 for the fault reconstruction in laghrouche et al 2015 from figs 14 and 15 the large component of the thruster fault effect can be also estimated based on the reconstruction method in laghrouche et al 2015 however these comparative results confirm that the fault reconstruction precision of the new design is better than that in laghrouche et al 2015 on the large component of the thruster fault effect besides the difference of the reconstruction result in yaw and the other degrees of freedom dofs in laghrouche et al 2015 is less obvious than that in the new design these simulation results verify that the developed control law is robust to the external disturbance and different types of thruster faults and has a nice performance in spline or line trajectory tracking and from these results it also can be seen that the fault on t1 or t3 thruster mainly affects odin auv s yaw i e the component of thruster fault effect on yaw is relative large and these fault reconstruction results also confirm that the new design gives good reconstruction result for the relatively large component of thruster fault effect although the reconstruction precision is a little poor for the small components this phenomenon probably is resulted from the facts e g there exists serious coupling among auv s 6 dofs and it is really difficult to reconstruct those small components of the thruster fault effect this problem is also occurred in chu and zhang 2014 seeing again the fault reconstruction results in figs 4 11 compared with the result on yaw the reconstructed results on other auv s dofs are much small mainly being restricted in the range of 1 1 and there are obvious differences between the reconstructed results on yaw and other dofs in practice the purpose of fault reconstruction is to provide information for decision making system such as conducting active fault tolerant control or adjusting the mission online therefore if we want to use the reconstructed result to make a decision one simple and feasible way is to use threshold to reduce wrong behaviours caused by the imprecise fault reconstruction 5 conclusions in this paper a new adaptive fault tolerant control method is developed based on virtual closed loop system for auv with external disturbance modelling uncertainty and the initial tracking error and an improved second order sliding mode observer is constructed for thruster fault reconstruction in the framework of fault tolerant control simulation results on odin auv show that the new design can be robust to the external disturbance and the unknown thruster fault and also the main component of the thruster fault can be reconstructed well compared with the results based on other two methods the new design is more effective in terms of tracking precision chattering reduction of control output and fault reconstruction precision on the large component of the thruster fault effect future research will include the experiment verification on a real auv acknowledgments this work is partial supported by the national natural science foundation of china 51679054 national key r d program of china 2017yfc0305703 and china scholarship council no 201606680036 
23482,the loads stress and strain state of the ship structures are quite complicated under the condition of collision and grounding the failure criteria which are commonly used in numerical simulations of ship collision have limitations in evaluating the failure characteristics of hull steel under complicated stress based on the shell theory complex stress in plate is simplified as plane stress in experiments six different shapes of specimens were designed to study the failure characteristics of high strength hull steel under biaxial stress the specimens were pressed with a hemispherical indenter until destruction under quasi static loading the displacement of specimens midpoint and loading force were recorded the simulation models which considering the mesh size sensitivity and the failure criteria combined with the damage evolution model have been studied a new reasonable formula is proposed to calculate the average failure strain of different mesh size with the application of the average failure strain a bilinear damage evolution model for high strength hull steel in biaxial tension stress is established based on a plastic instable criterion a modified bwh m bwh criterion is proposed the comparison of constant strain cs criterion combined with linear damage evolution model the bwh and m bwh failure criteria which are combined with the bilinear damage evolution model has been performed in the simulations by abaqus user material subroutine vumat although the bwh criterion is more precise than the constant strain criterion in comparison with the experiment results its errors will increase with rising of strain ratio the m bwh criterion improves the accuracy of the simulations when the strain ratio is high keywords failure criterion ship collision biaxial stress quasi static 1 introduction ship collision and grounding accidents will cause damage to hull structures leakage of oil environmental pollution and other serious consequences research on failure mode and failure criterion of hull structures and materials is meaningful for ship design the most commonly used failure criterion in the ship collision simulation is the equivalent plastic strain which is usually decided by uniaxial tension experiment namely the constant strain criterion the equivalent plastic strain ranges from 0 1 to 0 7 in most finite simulation models calle and alves 2015 although the constant strain criterion application is convenient the simulation results are sensitive to the selected failure strain the failure strain is an important parameter for the prediction of structural failure and absorbed energy of the collision many scholars wang et al 2000 glykas et al 2001 kitamura 2002 found that the failure strain has strong influence on ship collision simulation however they chose the failure strain by experience based on barba s law yamada et al 2005 proposed an approximate formula related to mesh size to calculate the true failure strain hogström et al 2009 confirmed that barba s relation is valid for handling stress strain dependence on the length scale used for strain evaluation after necking some similar formulas related to mesh size strain hardening exponent and other parameters are proposed by researchers ehlers et al 2008 alsos et al 2009 ehlers 2010 chose an element length dependent constant strain failure criterion to simulate rupture and proved it to be sufficiently accurate these formulas work well under uniaxial tension stress states some of the recent findings suggest that mesh size has strong influence on failure strain only under uniaxial tension however under plane strain and equi biaxial tension the mesh size dependence is considerably weaker kõrgesaar and romanoff 2014 kõrgesaar et al 2014a and walters 2014 failure strain represents the damage initiation of a material after that the behavior of the material is described by damage evolution simulation models considering the damage evolution of material can avoid abrupt failure and produce better results hogström et al 2009 it is well known that the constant strain criterion has limited precision when the stress states of structures or materials are different from uniaxial tension such as biaxial tension or pure shear wierzbicki et al 2005 ship plates are mainly subject to biaxial tension in collision events and failure takes place mostly between plane strain and equi biaxial tension kõrgesaar and romanoff 2014 kõrgesaar et al 2014b and werner et al 2015 before failure ductile sheet metals often generate necking area in the necking area narrow band of material starts to deform at a significantly higher strain rate than the surrounding material forming limit diagram fld is widely used to predict the onset of local necking in sheet metal forming process graf and hosford 1994 brunet and morestin 2001 however fld is affected by changing strain path which appears in structural collision processes graf and hosford 1994 a stress based criterion called bwh criterion was proposed by alsos et al 2008 the bwh criterion combines the shear stress criterion of bressan and williams 1983 bw criterion with the local necking criterion of hill 1952 it is insensitive to changing stain path and mesh size alsos and amdahl 2009 also calibrated the bwh criterion with a series of indentation experiments of unstiffened panel and different kinds of stiffened panels the discrepancy between simulation and experiment of unstiffened panel was relatively greater than different kinds of stiffened panels the bwh criterion was used to predict the material failure of ship structures and reasonable results were produced hogström et al 2009 ringsberg 2010 in this paper uniaxial tension experiments and a series of biaxial tension experiments were conducted to study the failure characteristics of high strength hull steel under biaxial stress simulation results of the uniaxial and biaxial tension experiments have been studied the simulation models which consider the mesh size sensitivity the failure criteria and the damage evolution model have been studied 2 experiments 2 1 uniaxial tension experiments the uniaxial tension experiments were conducted in accordance with iso 6892 1 2009 a kind of high strength hull steel ah40 was used in these experiments two groups of specimens were processed which are parallel and perpendicular to the rolling direction respectively each group of uniaxial tension experiment was done three times the thickness of the specimens was 4 mm they were fractured by the material stretch test machine at a speed of 3 mm min the average maximum loading force of the experiments is 36 3 kn the engineering stress strain curves were obtained from the experiments then the true stress strain curves can be obtained by eq 1 1 σ t r u e σ e n g 1 ε e n g ε t r u e ln 1 ε e n g the true stress strain curves average of three specimens are illustrated in fig 1 because of rapid section reduction the data of true stress and strain may be inaccurate after the onset of necking that means the decreasing stage of the true stress strain curves can t accurately denote the material behavior this paper adopts power law model to represent the material hardening behavior which is expressed as follows 2 σ k ε n k n are the material strength coefficient and hardening exponent respectively the material constants k 884 and n 0 133 are obtained by the least square method using the hardening stage data of true stress and strain then the true stress strain can be described as 3 σ e ε σ σ s σ s ε ε h k ε n otherwise where e 202 gpa σ s 477 mpa ε h 0 0097 is the equivalent strain when the material starts to harden the strain at the onset of necking is also obtained ε n 0 176 the curve obtained by power law model in fig 1 has good agreement with uniaxial tension experiments fig 1 shows that the specimens perpendicular to the rolling direction pd have greater fracture strain than the rolling direction rd specimens however the onset of necking point yield stress and elastic modulus are almost the same the discrepancy of fracture strain may be caused by different fracture positions of the two groups see fig 2 in the experiments two specimens of the rd group fracture near the clamping end however all specimens of the other group fracture in the middle area the extensometer was installed in the middle area of the specimens a fracture near the clamping end may cause large error because of the disadvantage of extensometer failure strain is an important parameter to evaluate the ductile failure mechanism by numerical simulation because of the limitations of experimental conditions the failure strain of uniaxial tension experiment is hard to be obtained therefore an approximate method is applied based on the assumption of plastic incompressibility the failure strain is indirectly calculated by the necking width of specimens after fracture the calculated failure strain is usually less than the true value because of the release of the elastic strain however the elastic strain is very small with respect to the plastic strain though it is not precise enough the conservative results will be obtained the approximate method is to calculate the strain of width direction by ε w ln w w 0 first and then calculate the failure strain by ε f max 2 ε w the failure strains of the two groups are almost the same see table 1 so the discrepancy in fig 1 can be ignored in the damage evolution model of abaqus there are two values to be set the strain at the initiation of damage failure strain and displacement at fracture when applied in the damage evolution model with different mesh size the failure strain may cause significant influence on the simulation results yamada et al 2005 hogström et al 2009 et al when calibrating the simulation models the failure strain is chosen from ε n to ε f max 2 2 biaxial tension experiments in according with the iso 12004 2 2008 standard the biaxial tension experiments were designed six kinds of specimens with different geometric shapes were shown in fig 3 specimen a was circular and specimens b to f hereinafter grooved specimens were obtained from circular specimens by grooving the thickness of the specimens was also 4 mm the specimens were sandwiched between the blank holder and the die by bolts and subjected to plane normal quasi static load by a diameter of 100 mm hemispherical punch illustrated in fig 4 a kind of lubricating oil was smeared on the contact area of the punch and specimen to reduce the influence of friction the loading system is a force controlled system the loading force was increased 10 kn per minute and the maximum load capacity was 500 kn in reality the punch velocity was about 0 05 mm s much less than the reference standard 1 5 0 5 mm s however a lower velocity is adopted in order to ensure a quasi static condition the loading time history and the displacement time history of specimens were recorded by load sensor and displacement sensor respectively deformation process of the specimens was recorded by a digital camera experiment of each kind of specimen was done three times the displacement of punch and the deformation of specimens increased with increasing load fig 5 illustrates an example damage process under biaxial tension load in the necking area the deformation increased rapidly compared to other areas a moment later after necking a small crack occurred in the center of the necking area and the crack propagated towards both sides rapidly a few milliseconds later the specimen fractured the degree of deformation the form of cracks and the location of failure of six kinds of specimens are shown in fig 6 the fracture sections of the six kinds of specimens are not flat in through thickness direction it suggests that the failure mode of this material may be induced by shear failure under biaxial stress the crack of the circular specimen looks like a circular arc with radius about 3 cm the cracks of the grooved specimens are all along the orientation of the groove with about 2 cm offset from specimen center the loading force displacement curves average of three specimens are shown in fig 7 before fracture the force displacement curves are nearly bilinear with the increase of loading force the slopes of the curves start to have a large value and then change into a lower value smoothly the difference between the previous and subsequent slopes gets smaller and smaller from specimen a to f the onset of fracture can be judged by the abrupt decrease of loading force the fracture force and the displacement decrease from a to f labeled on fig 7 the curve of specimen a has a stable stage in which the loading force is almost unchanged while the displacement increases quickly but this is not apparent in other specimens the grooved specimens are imperfect and have free edges see fig 13 which may accelerate the crack propagation 3 failure criteria 3 1 the constant strain criterion the constant strain criterion considers that materials fail when a material element s equivalent plastic strain ε reaches a critical value ε f expressed as follows 4 ε ε f based on the material incompressibility the plastic equivalent strain ε is defined by 5 ε 2 3 ε 1 2 ε 2 2 ε 3 2 where ε 1 ε 2 ε 3 are the principal strains the equivalent plastic strain of failure is decided by uniaxial tension experiment 3 2 the bwh criterion alsos et al 2008 proposed the bwh criterion combining the bw criterion with the hill criterion it assumes that the material property is isotropic hardening and the stress strain curve of material obeys the power law the material constants k n and the strain rate ratio β ε 2 ε 1 of material element are considered in the bwh criterion expressed as eq 6 the negative β regime of eq 6 is derived from hill s local necking criterion hill supposed that a local neck will generate with an angle to the direction of the σ 1 in such a neck the strain increments along the narrow necking band will be zero the angle may be expressed as ϕ arctan 1 β which is reasonable only for negative β the positive β regime of eq 6 is derived from bressan williams criterion the bw criterion has three basic hypotheses first of all the critical shear direction is through the thickness at which the material element length doesn t change secondly the instability occurs when the local shear stress exceeds the critical value thirdly elastic strains are ignored alsos et al combined these two criteria through critical major principal stress 6 σ 1 2 k 3 1 1 2 β β 2 β 1 2 ε ˆ 1 3 β 2 β 1 1 β n if β 0 2 k 3 2 3 ε ˆ 1 n 1 β 2 β 2 otherwise here ε ˆ 1 is equal to the material hardening exponent n the bwh criterion is a stress based criterion which is used to predict the onset of necking in sheet metal it considers local instability and neglects the bending stress in sheet metal by assuming proportional loading the strain ratio can be expressed as β ε 2 ε 1 ε 2 ε 1 during the experiments the expression of the bwh criterion in stress space is shown in fig 8 using k 884 mpa n 0 133 3 3 the modified bwh criterion the bwh criterion can be divided into two parts one is the negative part of strain ratio and the other part is positive of strain ratio the negative part was derived from hill s local necking criterion expressed as follows 7 σ 1 2 k 3 1 1 2 β β 2 β 1 2 ε ˆ 1 3 β 2 β 1 1 β n if β 0 the positive part was derived from bw criterion expressed as follows 8 σ 1 2 τ c r 1 β 2 β 2 when combining these two criteria alsos just calibrated bw criterion from hill criterion based on continuity at plane strain β 0 consequently the critical shear stress takes the following form 9 τ c r 1 3 k 2 3 ε ˆ 1 n eq 9 describes that the critical shear stress is invariable however this may be inaccurate when the strain ratio changes swift 1952 proposed a plastic instable criterion for biaxial tension sheet swift assumed that instability occurred when the two direction traction increments equaled to zero d t 1 0 and d t 2 0 except for equi biaxial tension it is unrealistic that the two direction traction increments become zero simultaneously it is a suitable way to use d t 1 0 as the instability criterion based on plastic incompressibility and plane stress the swift criterion takes the following form 10 d σ 1 σ 1 d ε 1 using the power law hardening material model the equivalent strain of necking in biaxial tension case can be obtained as 11 ε f 2 n 3 β 2 β 1 from eq 8 eq 9 and eq 11 the positive part of the bwh criterion can be modified as 12 σ 1 2 k 3 2 n 3 β 2 β 1 n 1 β 2 β 2 by combining eq 7 with eq 12 and making ε ˆ 1 equal to the material hardening exponent n a modified bwh criterion is expressed as follows 13 σ 1 2 k 3 1 1 2 β β 2 β 1 2 n 3 β 2 β 1 1 β n β 0 2 3 k 2 n 3 β 2 β 1 n 1 β 2 β 2 β 0 1 in the positive part of strain ratio the maximum principal stress of modified bwh criterion is slightly higher than the bwh criterion illustrated in fig 8 the discrepancy increases with the strain ratio and this will be discussed in section 5 2 2 4 simulation models 4 1 mesh size sensitivity the sensitivity of mesh size is an important problem in the calculation of finite element models there is a necking area with large strain gradients when the specimens are about to fracture when the size of elements is larger than the necking width the strain on the elements located in the necking area is averaged the failure strain changes greatly when the size of elements is smaller than the necking width barba s 1880 proposed an empirical formula to evaluate the engineering failure strain and gauge length based on uniaxial tensile experiments the formula is expressed as follow 14 ε f ε u c w t l where ε f is engineering failure strain ε u is uniform engineering failure strain c is barba s constant w is width of specimen t is thickness of specimen and l is gauge length yamada et al 2005 converted this formula to eq 15 based on the relation of engineering strain and true strain 15 ε f t r u e ln e ε u t r u e c w t l where ε f t r u e is true failure strain ε u t r u e is true necking strain the barba s constant is necessary for these formulas alsos et al 2009 proposed a formula eq 16 based on plastic incompressibility and hill s local necking theory under the assumption that the width of necking area is equal to specimen s thickness 16 ε f n t l e 1 where n is hardening exponent l e is undeformed element length alsos approximation is an engineering approach for quick estimation of failure strain for large shell elements for smaller elements this approach may be improper the previous formulas show that the failure strain tends to infinity when l e or l tends to zero which is unreasonable in mechanics the strain at the occurrence of micro crack is assumed as the failure strain kõrgesaar and romanoff 2013 if there is no micro crack the strain of two material points whose distance is infinitesimally small is in the same order therefore the failure strain of a very small element is finite not infinite this paper assumes that the width of necking area is equal to specimen thickness alsos et al 2009 and the strain in necking area changes linearly see fig 9 when the length of the elements l e is larger than specimen thickness the volume of the shaded area in fig 9 can be expressed as follow 17 v w t l e t assuming that the average failure strain of the element is ε f the maximum strain in necking area is ε f max and the uniform strain out of necking area is ε r then after deformation the volume of the shaded area in fig 9 can be expressed as follow 18 v l e e ε f h w t e ε r here h is the length of necking extent along the tensile direction after deformation based on strain linear assumption h can be calculated by 19 h 2 0 t 2 e ε f max ε f max ε r t 2 x d x according to eq 17 eq 18 and eq 19 the following expression is derived 20 e ε f l e t e ε r t e ε f max e ε r ε f max ε r l e l e t it is assumed that when l e tends to zero the average failure strain of element ε f is equal to ε f max when l e is smaller than t the following expression is derived 21 e ε f e ε f max e ε f max e ε f max e ε r ε f max ε r l e t l e t combining eq 20 and eq 21 the average failure strain of different mesh size is derived 22 e ε f l e t e ε r t e ε f max e ε r ε f max ε r l e l e t e ε f max e ε f max e ε f max e ε r ε f max ε r l e t l e t the alsos formula eq 16 and the new formula in this paper are illustrated in fig 10 when element length l e is larger than t the discrepancy between these two formulas is relatively small less than 13 5 and becoming smaller and smaller as element length increases when element length l e is less than t the discrepancy first decreases and then increases as t decreases the minimum discrepancy is at about l e t 2 the failure strain of alsos formula increases extremely fast with the decrease of mesh size when element length is less than half of the thickness therefore the fracture strain of alsos formula may exceed the maximum failure strain in the necking area however the new formula proposed in this paper can avoid this problem 4 2 damage evolution model it is well known that steel materials usually experience elastic yield strain hardening and necking stage during the process of a tensile experiment the material behavior and damage evolution models are shown in fig 11 when the material reaches the failure point the necking phenomena occurs after that the material enters into the necking stage called damage evolution process the linear model exponential model and piecewise linear model are commonly used to describe the damage evolution process hogström et al 2009 proposed a bilinear model to describe damage evolution process according to hogström s softening model there are two distinct stages of the true stress strain relationship after necking in the beginning of the necking stage the stress increases relatively slow and the section area of specimen reduces relatively small this is called steady necking stage after that stage rapid necking stage which has rapid stress increase and section reduction occurs until final fracture the material used in this paper has similar characteristics with hogström s softening model if the force is unloaded in the steady necking stage fracture may not occur once the material enters the stage of rapid necking fracture is inevitable however the critical point which separates steady necking stage from rapid necking stage is difficult to determine hogström applied a calibrated parameter in his bilinear model kõrgesaar and romanoff 2013 proposed a two stage softening model which regards the beginning of fracture as the critical point the two stage softening model has six material parameters and is inconvenient in application the damage evolution models mentioned above are based on uniaxial tension experiments it is improper when they are applied to biaxial tension stress state the equivalent strain of plane stress state can be expressed as 23 ε b 2 1 β β 2 3 ε 1 where ε b represents the equivalent strain of plane stress state the strain ratio of uniaxial tension stress state is β 1 2 the equivalent strain of uniaxial tension is derived 24 ε u ε 1 where ε u represents the equivalent strain of uniaxial tension for the biaxial tension experiments when a material element reaches the failure point necking it won t fracture immediately because the failure material element is constrained by the surrounding elements due to deformation compatibility the behavior of the material after necking is evaluated by damage evolution model the important parameter of damage evolution model in biaxial tension state is the fracture stain which has not been proposed by former researchers a simplified model is proposed in this paper assume that the major principal strain increments under biaxial and uniaxial tension stress states are equal from necking to final fracture furthermore assume that the strain increments of steady necking stage and rapid necking stage are also equal therefore the failure strain of biaxial tension stress state used in fe simulations can be expressed as 25 ε f b 1 2 ε f u 3 ε n b 2 1 β β 2 ε n b where ε f b represents the failure strain of biaxial tension stress state ε f u represents the failure strain of uniaxial tension stress state which is calculated by eq 22 ε n b represents the equivalent strain at the onset of necking which is predicted by failure criterion the equation can also be applied to uniaxial tension stress state when β is set as 1 2 and ε n b is set as corresponding necking strain 4 3 modeling of experiments the simulation models mainly include material constitutive model loading boundary conditions meshing for damage problems failure criterion failure strain and damage evolution model should be considered in material constitutive model according to uniaxial tensile experiment results the influence of rolling direction on mechanical properties of the high strength hull steel is negligible therefore the simulation models of all experiments use the same material constitutive model the constant strain criterion is defined in abaqus explicit with ductile damage and displacement damage evolution model while the bwh criterion and the modified bwh criteria combined with the bilinear damage evolution model are implemented by user material subroutine which called vumat in abaqus explicit the displacement at fracture of the damage evolution model can be expressed as 26 u d 1 2 l e ε f where u d is the displacement at fracture l e is the fe element s characteristic length and ε f is calculated by eq 25 another important part of simulation models is meshing suitable mesh size and the optimized grid can improve simulation precision and reduce calculation time the specimens are modeled with solid elements and with five elements through the thickness the simulation models of the circular specimen with a series of mesh sizes 1 mm 1 mm 0 8 mm 2 mm 2 mm 0 8 mm 4 mm 4 mm 0 8 mm 8 mm 8 mm 0 8 mm are selected to verify grid convergence if the true time of the experiments were used in the simulations it may take months and is unacceptable therefore quasi static analysis of abaqus explicit is applied and the simulation time is 0 05s more than 10 times of the period of the lowest order mode of the simulation model which is commonly used thus the indenter speed in simulations is about 0 9 m s the die and the punch are assumed as rigid bodies contact between the punch specimen and die is surface to surface using penalty contact method and the friction coefficient is set as 0 05 it is reasonable for contact surface with lubrication the failure criteria used in all simulation models use the same failure strain and failure displacement displacement load is applied the bolt holes and outer edge are fixed and the reaction force of the punch is explored displacement of the punch increases until the specimen is fractured the simulation results are shown in fig 12 it shows that the displacement loading force curves fit well with experiments before fracture it is clear that the mesh is gradually converged from 8 mm to 1 mm the results of mesh size 1 mm and 2 mm are almost the same except the last segment which close to fracture the calculation time and deviation of simulation models are shown in table 2 compared with mesh size 2 mm the precision of mesh size 1 mm improves slightly however its calculation time is over two times longer than mesh size 2 mm considering accuracy and computational efficiency mesh size 2 mm is selected in simulations the influence of different mesh sizes on fracture prediction will be discussed in section 6 after the determination of material constitutive model and mesh dimensions the six kinds of specimens in fig 3 are all modeled for example the simulation models of specimen a and specimen b are shown in fig 13 the specimens are modeled with solid elements of 2 mm 2 mm 0 8 mm in the central area and with five elements through the thickness several variables such as the equivalent strain yield stress strain ratio failure parameter etc are defined in the abaqus vumat subroutine when using the bwh and m bwh criteria because the failure strain of all the biaxial experiments simulations is larger than the uniaxial experiments the failure judgment of the elements is omitted when ε ε n to some extent this method can save some computation time in the vumat subroutine the equivalent strain and strain ratio are expressed as variable sdv1 and sdv14 respectively 5 simulation results in this section the results of the simulations are compared with the experimental results the displacement loading force relationship and the fracture prediction are concerned 5 1 simulation of uniaxial tension experiments some strain states can be expressed by specific strain ratios such as β 1 2 vs uniaxial tension β 0 vs plane strain β 1 vs equi biaxial tension since the m bwh criterion only modifies the positive strain ratio the m bwh is not applied in the simulation of uniaxial tension experiments the simulation results of uniaxial tension experiments are illustrated in fig 14 the stress strain curves of simulation results coincide with experiments until the point of damage occurs and then the damage evolution starts until fracture the curves using cs criterion green lines seem to be closer to the experiments than the curves using the bwh criterion red lines but the maximum loading force of the former is slightly lower than the latter with values of 35 5 k and 35 8 k respectively the latter has closer result to the experiments the maximum stress of the latter is larger than the former it is more reasonable that considering the reduction of section in the necking area in fig 14 the dot dashed lines red thick line and green thin line represent the fracture elements f elements in the simulation model while the dashed lines red thick line and green thin line represent one of the non fracture elements near the necking area it shows that the stress of the non fracture elements n elements drop down suddenly with no more strain increase while the strain of fracture elements increase quickly this phenomenon suggests the localized instability has occurred the material constitutive model applied in simulation models is calibrated well with uniaxial tension experiments considering reduction of section in the necking area the bwh criterion yields better prediction for the onset of failure 5 2 simulation of biaxial tension experiments 5 2 1 variation of strain ratio the strain ratio in structures may vary in different loading cases this section will discuss the variation of strain ratio during the biaxial tension experiments the simulation results of specimen a to f determined by bwh criterion are shown in figs 15 20 the comparison results of figs 15 a 20 a and figs 15 b 20 b show that the crack shape of simulations is similar to the experiments respectively according to the simulation results the circular crack radius of the specimen a is about 1 cm less than experiment results about 3 cm and the distances between the crack and center of the specimens b f are about 1 cm less than experiment results about 2 cm respectively this indicates that the bwh criterion can predict crack shape and position to some extent the discrepancy may be caused by processing error installation error local insufficient lubrication or other factors figs 15 c 20 c show different strain ratio distributions when specimens are about to fracture figs 15 d 20 d show the strain ratio of a fracture element in the loading process figs 15 c 20 c and figs 15 d 20 d indicate that strain ratio varies with position and loading process therefore the failure criteria which are related to strain ratio may have better accuracy such as the bwh and m bwh criteria figs 15 d 20 d show similar wave when punch displacement is less than 10 mm this situation may be caused by specimen catering to circular punch and direction change of the maximum principal strain during the initiation of loading with the increase of punch displacement the strain ratio of the circular specimen is nearly invariable while the strain ratios of the grooved specimens are decreasing in various degrees the specimens strain ratios at failure and fracture points predicted by the bwh criterion and the bilinear damage evolution model are shown in table 3 and they are marked in figs 15 d 20 d as mentioned above the strain ratio varies with position and loading process it indicates that the stain path may vary in different loading cases 5 2 2 fracture prediction section 5 2 1 shows that the strain ratios of specimen a b and c are positive before failure point however the strain ratios of specimen d e and f are negative or nearly zero when close to and after failure point therefore the results of specimen d e and f using bwh criterion and m bwh criterion are almost the same hence only bwh criterion and cs criterion will be compared in these three kinds of specimens the other kinds of specimens will be compared with three criteria considering the mesh size influence of failure strain the cs criterion with scaled according to eq 22 is also studied the simulation results of displacement loading force curves are illustrated in figs 21 26 the experiment data are inaccurate after fracture because the displacement sensor is slanted by the punch after the fracture of specimens therefore comparison and analysis of simulations and experiments are conducted before fracture figs 21 26 show that the displacement loading force curves of three failure criteria are basically the same before fracture there are small differences with experiment results when the loading force is small the simulation curves of specimen a are almost coincident with the experiment results however the discrepancy increases when the loading force exceeds 250 kn this may be explained by the stability decline of hydraulic loading system under high pressure the discrepancy of other specimens may relate with specimen processing error installation error of specimen and sensor or other factors the prediction of fracture point will be discussed below the fracture force and displacement of simulation and experiment results are shown in table 4 the fracture force and displacement errors between experiments and different simulation models are shown in table 5 the errors of none scaled cs criterion increase from specimens f to a the maximum error of fracture force and displacement is 44 9 and 38 9 respectively the errors of specimens a and b are too large others are acceptable according to table 3 the strain ratios of specimen c to f are negative or close to zero hence the none scaled cs criterion is suitable for predicting the failure of material when stain ratio is low or negative however it is improper when strain ratio is high compared with the none cs criterion the fracture force and displacement predicted by the scaled cs criterion is increased in all specimens simulations the errors of specimens a to d are decreased by scaled cs criterion however the errors of specimens e and f are increased the maximum error of fracture force and displacement is 23 9 and 25 3 respectively oh the whole the scaled cs criterion has higher precision in prediction of material fracture than none scaled cs criterion the simulation results using the bwh criterion correspond well with the experiment results the maximum error of fracture force and displacement is the same 21 5 the simulation result of specimen a is very well less than 5 the simulation result error of specimen b is 9 1 larger than the result by scaled cs criterion but 14 7 less than the result by the none scaled cs criterion the error increases from specimen d to f it indicates that the bwh criterion slightly overestimates the capability of material when strain ratio is negative but the results are still in reasonable range oh the whole the bwh criterion has higher precision in prediction of material fracture than scaled cs criterion the simulation results using the m bwh criterion correspond well with the experiment results compared with the bwh criterion the m bwh criterion improves the accuracy of specimen a while the accuracy improvement of other specimens is not obvious because the strain ratios of specimen b and c are close to zero at onset of failure see table 3 however the strain ratio of specimen a is close to one the improvement effect of m bwh criterion increases when strain ratio increases it is not obvious when strain ratio in a low value but it becomes obvious when the strain ratio is high see fig 8 in other words the m bwh improves the accuracy of stress state with high value strain ratio 6 discussion the fracture prediction of the biaxial tension experiments is reproduced well by the scaled cs the bwh and the m bwh criteria the failure strain under different stress states varies for the scaled cs criterion the failure strain is usually derived from uniaxial tension experiment through some scaled methods such as barba s law alsos formula the new formula proposed in this paper and so on these methods show significant mesh size influence applying the cs criterion which scaled by eq 22 the simulation results of circular specimen with different mesh size is shown in fig 27 it shows clearly that the mesh size influence is significant and the accuracy cannot be guaranteed by coarse mesh however when the same failure strain is applied in the simulation models with different mesh size the mesh size influence seems weaker see fig 12 some researchers kõrgesaar and romanoff 2014 kõrgesaar et al 2014a and walters 2014 have found similar results that mesh size dependence is considerably weaker under plane strain and equi biaxial tension so it is not easy to find a suitable failure strain just from uniaxial tension experiment to predict all the fracture of material under different stress states in ship collision scenarios the failure of ship structures takes place mostly between plane strain and equi biaxial tension kõrgesaar and romanoff 2014 kõrgesaar et al 2014b and werner et al 2015 hence applying the cs criterion to study ship collision has inadequate accuracy even the scaled cs criterion for the bwh and the m bwh criteria they consider the distribution of strain state during the process of deformation the simulation results of biaxial tension experiments show that these two criteria work well although a slight underestimate of material under the stress state between plane strain and equi biaxial tension the failure mechanism needs further study in the future 7 conclusions simulations of the uniaxial tension experiments and a series of biaxial tension experiments are studied when a material element reaches the failure point during the loading process it won t fracture immediately but enters into the damage evolution stage therefore the simulation combined with a failure criterion and a damage evolution model will improve accuracy in this paper the simulation models which consider the mesh size sensitivity the failure criteria and the damage evolution model have been studied a new formula to calculate the average failure strain of different mesh size is proposed the new formula and the alsos s formula are consistent with each other when element length is large the average failure stain of alsos formula and other formulas relate to the inverse of mesh size may tend to infinity when mesh size tends to zero this unreasonable result can be modified by the new formula when small elements are used the maximum failure strain derived from uniaxial tension experiments is used in the new formula and a reasonable result is achieved however the new formula has limitations in the stress state between plane strain and equi biaxial tension with the application of the average failure strain calculated by the new formula a bilinear damage evolution model of the material in biaxial tension stress is proposed it is based on two assumptions first the major principal strain increment of biaxial and uniaxial tension stress state is equal from necking to final fracture second the strain increment of steady necking stage and rapid necking stage is also equal the simulation results adopting the bilinear damage evolution model are in good agreement with experiment results the cs criterion has limited precision to predict the material failure behaviors especially in the biaxial stress state with high strain ratio because of it underestimates the load capacity of the material and the stress and strain states of structures under biaxial stress are different in different location while the failure prediction of all elements is the same in the cs criterion the scaled cs criterion improves the precision in predicting the material failure behaviors however it is hard to find a suitable failure strain just from uniaxial tension experiment to predict all the fracture of material under different stress states the bwh criterion describes the stress state of the material using strain ratio a relationship of the maximum principal stress and strain ratio is proposed to predict the onset of failure the results implemented by the bwh criterion are relatively good compared to the cs criterion it can predict the failure tendency of the material under biaxial stress though the bwh criterion has better accuracy than the cs criterion it slightly underestimates the material load capacity on the condition of high strain ratio the m bwh criterion proposed in this paper increases the accuracy of failure prediction when the strain ratio is close to one in the simulation models the failure of each element is determined by current stain ratio therefore the bwh criterion and the m bwh criterion consider the variation of the material s stress and strain state with location and time in ship collision scenarios ship structures usually sustain biaxial stress when the stress in thickness direction is negligible it is reasonable to use the bwh or m bwh criterion to predict the failure of structures if they are applied in the ship collision research the strain rate ratio which is time related is not equal to the strain ratio however it is easy to implement in fem code the strain rate also influences the yield stress which need be considered in fem code other factors such as initial imperfection welding residual stress need be studied in the future acknowledgements the present work is co supported by the chinese government key research project kship ii project knowledge based ship design hyper integrated platform no 201335 and high tech ship research projects sponsored by miit 2016 25 the authors would like to acknowledge the project support 
23482,the loads stress and strain state of the ship structures are quite complicated under the condition of collision and grounding the failure criteria which are commonly used in numerical simulations of ship collision have limitations in evaluating the failure characteristics of hull steel under complicated stress based on the shell theory complex stress in plate is simplified as plane stress in experiments six different shapes of specimens were designed to study the failure characteristics of high strength hull steel under biaxial stress the specimens were pressed with a hemispherical indenter until destruction under quasi static loading the displacement of specimens midpoint and loading force were recorded the simulation models which considering the mesh size sensitivity and the failure criteria combined with the damage evolution model have been studied a new reasonable formula is proposed to calculate the average failure strain of different mesh size with the application of the average failure strain a bilinear damage evolution model for high strength hull steel in biaxial tension stress is established based on a plastic instable criterion a modified bwh m bwh criterion is proposed the comparison of constant strain cs criterion combined with linear damage evolution model the bwh and m bwh failure criteria which are combined with the bilinear damage evolution model has been performed in the simulations by abaqus user material subroutine vumat although the bwh criterion is more precise than the constant strain criterion in comparison with the experiment results its errors will increase with rising of strain ratio the m bwh criterion improves the accuracy of the simulations when the strain ratio is high keywords failure criterion ship collision biaxial stress quasi static 1 introduction ship collision and grounding accidents will cause damage to hull structures leakage of oil environmental pollution and other serious consequences research on failure mode and failure criterion of hull structures and materials is meaningful for ship design the most commonly used failure criterion in the ship collision simulation is the equivalent plastic strain which is usually decided by uniaxial tension experiment namely the constant strain criterion the equivalent plastic strain ranges from 0 1 to 0 7 in most finite simulation models calle and alves 2015 although the constant strain criterion application is convenient the simulation results are sensitive to the selected failure strain the failure strain is an important parameter for the prediction of structural failure and absorbed energy of the collision many scholars wang et al 2000 glykas et al 2001 kitamura 2002 found that the failure strain has strong influence on ship collision simulation however they chose the failure strain by experience based on barba s law yamada et al 2005 proposed an approximate formula related to mesh size to calculate the true failure strain hogström et al 2009 confirmed that barba s relation is valid for handling stress strain dependence on the length scale used for strain evaluation after necking some similar formulas related to mesh size strain hardening exponent and other parameters are proposed by researchers ehlers et al 2008 alsos et al 2009 ehlers 2010 chose an element length dependent constant strain failure criterion to simulate rupture and proved it to be sufficiently accurate these formulas work well under uniaxial tension stress states some of the recent findings suggest that mesh size has strong influence on failure strain only under uniaxial tension however under plane strain and equi biaxial tension the mesh size dependence is considerably weaker kõrgesaar and romanoff 2014 kõrgesaar et al 2014a and walters 2014 failure strain represents the damage initiation of a material after that the behavior of the material is described by damage evolution simulation models considering the damage evolution of material can avoid abrupt failure and produce better results hogström et al 2009 it is well known that the constant strain criterion has limited precision when the stress states of structures or materials are different from uniaxial tension such as biaxial tension or pure shear wierzbicki et al 2005 ship plates are mainly subject to biaxial tension in collision events and failure takes place mostly between plane strain and equi biaxial tension kõrgesaar and romanoff 2014 kõrgesaar et al 2014b and werner et al 2015 before failure ductile sheet metals often generate necking area in the necking area narrow band of material starts to deform at a significantly higher strain rate than the surrounding material forming limit diagram fld is widely used to predict the onset of local necking in sheet metal forming process graf and hosford 1994 brunet and morestin 2001 however fld is affected by changing strain path which appears in structural collision processes graf and hosford 1994 a stress based criterion called bwh criterion was proposed by alsos et al 2008 the bwh criterion combines the shear stress criterion of bressan and williams 1983 bw criterion with the local necking criterion of hill 1952 it is insensitive to changing stain path and mesh size alsos and amdahl 2009 also calibrated the bwh criterion with a series of indentation experiments of unstiffened panel and different kinds of stiffened panels the discrepancy between simulation and experiment of unstiffened panel was relatively greater than different kinds of stiffened panels the bwh criterion was used to predict the material failure of ship structures and reasonable results were produced hogström et al 2009 ringsberg 2010 in this paper uniaxial tension experiments and a series of biaxial tension experiments were conducted to study the failure characteristics of high strength hull steel under biaxial stress simulation results of the uniaxial and biaxial tension experiments have been studied the simulation models which consider the mesh size sensitivity the failure criteria and the damage evolution model have been studied 2 experiments 2 1 uniaxial tension experiments the uniaxial tension experiments were conducted in accordance with iso 6892 1 2009 a kind of high strength hull steel ah40 was used in these experiments two groups of specimens were processed which are parallel and perpendicular to the rolling direction respectively each group of uniaxial tension experiment was done three times the thickness of the specimens was 4 mm they were fractured by the material stretch test machine at a speed of 3 mm min the average maximum loading force of the experiments is 36 3 kn the engineering stress strain curves were obtained from the experiments then the true stress strain curves can be obtained by eq 1 1 σ t r u e σ e n g 1 ε e n g ε t r u e ln 1 ε e n g the true stress strain curves average of three specimens are illustrated in fig 1 because of rapid section reduction the data of true stress and strain may be inaccurate after the onset of necking that means the decreasing stage of the true stress strain curves can t accurately denote the material behavior this paper adopts power law model to represent the material hardening behavior which is expressed as follows 2 σ k ε n k n are the material strength coefficient and hardening exponent respectively the material constants k 884 and n 0 133 are obtained by the least square method using the hardening stage data of true stress and strain then the true stress strain can be described as 3 σ e ε σ σ s σ s ε ε h k ε n otherwise where e 202 gpa σ s 477 mpa ε h 0 0097 is the equivalent strain when the material starts to harden the strain at the onset of necking is also obtained ε n 0 176 the curve obtained by power law model in fig 1 has good agreement with uniaxial tension experiments fig 1 shows that the specimens perpendicular to the rolling direction pd have greater fracture strain than the rolling direction rd specimens however the onset of necking point yield stress and elastic modulus are almost the same the discrepancy of fracture strain may be caused by different fracture positions of the two groups see fig 2 in the experiments two specimens of the rd group fracture near the clamping end however all specimens of the other group fracture in the middle area the extensometer was installed in the middle area of the specimens a fracture near the clamping end may cause large error because of the disadvantage of extensometer failure strain is an important parameter to evaluate the ductile failure mechanism by numerical simulation because of the limitations of experimental conditions the failure strain of uniaxial tension experiment is hard to be obtained therefore an approximate method is applied based on the assumption of plastic incompressibility the failure strain is indirectly calculated by the necking width of specimens after fracture the calculated failure strain is usually less than the true value because of the release of the elastic strain however the elastic strain is very small with respect to the plastic strain though it is not precise enough the conservative results will be obtained the approximate method is to calculate the strain of width direction by ε w ln w w 0 first and then calculate the failure strain by ε f max 2 ε w the failure strains of the two groups are almost the same see table 1 so the discrepancy in fig 1 can be ignored in the damage evolution model of abaqus there are two values to be set the strain at the initiation of damage failure strain and displacement at fracture when applied in the damage evolution model with different mesh size the failure strain may cause significant influence on the simulation results yamada et al 2005 hogström et al 2009 et al when calibrating the simulation models the failure strain is chosen from ε n to ε f max 2 2 biaxial tension experiments in according with the iso 12004 2 2008 standard the biaxial tension experiments were designed six kinds of specimens with different geometric shapes were shown in fig 3 specimen a was circular and specimens b to f hereinafter grooved specimens were obtained from circular specimens by grooving the thickness of the specimens was also 4 mm the specimens were sandwiched between the blank holder and the die by bolts and subjected to plane normal quasi static load by a diameter of 100 mm hemispherical punch illustrated in fig 4 a kind of lubricating oil was smeared on the contact area of the punch and specimen to reduce the influence of friction the loading system is a force controlled system the loading force was increased 10 kn per minute and the maximum load capacity was 500 kn in reality the punch velocity was about 0 05 mm s much less than the reference standard 1 5 0 5 mm s however a lower velocity is adopted in order to ensure a quasi static condition the loading time history and the displacement time history of specimens were recorded by load sensor and displacement sensor respectively deformation process of the specimens was recorded by a digital camera experiment of each kind of specimen was done three times the displacement of punch and the deformation of specimens increased with increasing load fig 5 illustrates an example damage process under biaxial tension load in the necking area the deformation increased rapidly compared to other areas a moment later after necking a small crack occurred in the center of the necking area and the crack propagated towards both sides rapidly a few milliseconds later the specimen fractured the degree of deformation the form of cracks and the location of failure of six kinds of specimens are shown in fig 6 the fracture sections of the six kinds of specimens are not flat in through thickness direction it suggests that the failure mode of this material may be induced by shear failure under biaxial stress the crack of the circular specimen looks like a circular arc with radius about 3 cm the cracks of the grooved specimens are all along the orientation of the groove with about 2 cm offset from specimen center the loading force displacement curves average of three specimens are shown in fig 7 before fracture the force displacement curves are nearly bilinear with the increase of loading force the slopes of the curves start to have a large value and then change into a lower value smoothly the difference between the previous and subsequent slopes gets smaller and smaller from specimen a to f the onset of fracture can be judged by the abrupt decrease of loading force the fracture force and the displacement decrease from a to f labeled on fig 7 the curve of specimen a has a stable stage in which the loading force is almost unchanged while the displacement increases quickly but this is not apparent in other specimens the grooved specimens are imperfect and have free edges see fig 13 which may accelerate the crack propagation 3 failure criteria 3 1 the constant strain criterion the constant strain criterion considers that materials fail when a material element s equivalent plastic strain ε reaches a critical value ε f expressed as follows 4 ε ε f based on the material incompressibility the plastic equivalent strain ε is defined by 5 ε 2 3 ε 1 2 ε 2 2 ε 3 2 where ε 1 ε 2 ε 3 are the principal strains the equivalent plastic strain of failure is decided by uniaxial tension experiment 3 2 the bwh criterion alsos et al 2008 proposed the bwh criterion combining the bw criterion with the hill criterion it assumes that the material property is isotropic hardening and the stress strain curve of material obeys the power law the material constants k n and the strain rate ratio β ε 2 ε 1 of material element are considered in the bwh criterion expressed as eq 6 the negative β regime of eq 6 is derived from hill s local necking criterion hill supposed that a local neck will generate with an angle to the direction of the σ 1 in such a neck the strain increments along the narrow necking band will be zero the angle may be expressed as ϕ arctan 1 β which is reasonable only for negative β the positive β regime of eq 6 is derived from bressan williams criterion the bw criterion has three basic hypotheses first of all the critical shear direction is through the thickness at which the material element length doesn t change secondly the instability occurs when the local shear stress exceeds the critical value thirdly elastic strains are ignored alsos et al combined these two criteria through critical major principal stress 6 σ 1 2 k 3 1 1 2 β β 2 β 1 2 ε ˆ 1 3 β 2 β 1 1 β n if β 0 2 k 3 2 3 ε ˆ 1 n 1 β 2 β 2 otherwise here ε ˆ 1 is equal to the material hardening exponent n the bwh criterion is a stress based criterion which is used to predict the onset of necking in sheet metal it considers local instability and neglects the bending stress in sheet metal by assuming proportional loading the strain ratio can be expressed as β ε 2 ε 1 ε 2 ε 1 during the experiments the expression of the bwh criterion in stress space is shown in fig 8 using k 884 mpa n 0 133 3 3 the modified bwh criterion the bwh criterion can be divided into two parts one is the negative part of strain ratio and the other part is positive of strain ratio the negative part was derived from hill s local necking criterion expressed as follows 7 σ 1 2 k 3 1 1 2 β β 2 β 1 2 ε ˆ 1 3 β 2 β 1 1 β n if β 0 the positive part was derived from bw criterion expressed as follows 8 σ 1 2 τ c r 1 β 2 β 2 when combining these two criteria alsos just calibrated bw criterion from hill criterion based on continuity at plane strain β 0 consequently the critical shear stress takes the following form 9 τ c r 1 3 k 2 3 ε ˆ 1 n eq 9 describes that the critical shear stress is invariable however this may be inaccurate when the strain ratio changes swift 1952 proposed a plastic instable criterion for biaxial tension sheet swift assumed that instability occurred when the two direction traction increments equaled to zero d t 1 0 and d t 2 0 except for equi biaxial tension it is unrealistic that the two direction traction increments become zero simultaneously it is a suitable way to use d t 1 0 as the instability criterion based on plastic incompressibility and plane stress the swift criterion takes the following form 10 d σ 1 σ 1 d ε 1 using the power law hardening material model the equivalent strain of necking in biaxial tension case can be obtained as 11 ε f 2 n 3 β 2 β 1 from eq 8 eq 9 and eq 11 the positive part of the bwh criterion can be modified as 12 σ 1 2 k 3 2 n 3 β 2 β 1 n 1 β 2 β 2 by combining eq 7 with eq 12 and making ε ˆ 1 equal to the material hardening exponent n a modified bwh criterion is expressed as follows 13 σ 1 2 k 3 1 1 2 β β 2 β 1 2 n 3 β 2 β 1 1 β n β 0 2 3 k 2 n 3 β 2 β 1 n 1 β 2 β 2 β 0 1 in the positive part of strain ratio the maximum principal stress of modified bwh criterion is slightly higher than the bwh criterion illustrated in fig 8 the discrepancy increases with the strain ratio and this will be discussed in section 5 2 2 4 simulation models 4 1 mesh size sensitivity the sensitivity of mesh size is an important problem in the calculation of finite element models there is a necking area with large strain gradients when the specimens are about to fracture when the size of elements is larger than the necking width the strain on the elements located in the necking area is averaged the failure strain changes greatly when the size of elements is smaller than the necking width barba s 1880 proposed an empirical formula to evaluate the engineering failure strain and gauge length based on uniaxial tensile experiments the formula is expressed as follow 14 ε f ε u c w t l where ε f is engineering failure strain ε u is uniform engineering failure strain c is barba s constant w is width of specimen t is thickness of specimen and l is gauge length yamada et al 2005 converted this formula to eq 15 based on the relation of engineering strain and true strain 15 ε f t r u e ln e ε u t r u e c w t l where ε f t r u e is true failure strain ε u t r u e is true necking strain the barba s constant is necessary for these formulas alsos et al 2009 proposed a formula eq 16 based on plastic incompressibility and hill s local necking theory under the assumption that the width of necking area is equal to specimen s thickness 16 ε f n t l e 1 where n is hardening exponent l e is undeformed element length alsos approximation is an engineering approach for quick estimation of failure strain for large shell elements for smaller elements this approach may be improper the previous formulas show that the failure strain tends to infinity when l e or l tends to zero which is unreasonable in mechanics the strain at the occurrence of micro crack is assumed as the failure strain kõrgesaar and romanoff 2013 if there is no micro crack the strain of two material points whose distance is infinitesimally small is in the same order therefore the failure strain of a very small element is finite not infinite this paper assumes that the width of necking area is equal to specimen thickness alsos et al 2009 and the strain in necking area changes linearly see fig 9 when the length of the elements l e is larger than specimen thickness the volume of the shaded area in fig 9 can be expressed as follow 17 v w t l e t assuming that the average failure strain of the element is ε f the maximum strain in necking area is ε f max and the uniform strain out of necking area is ε r then after deformation the volume of the shaded area in fig 9 can be expressed as follow 18 v l e e ε f h w t e ε r here h is the length of necking extent along the tensile direction after deformation based on strain linear assumption h can be calculated by 19 h 2 0 t 2 e ε f max ε f max ε r t 2 x d x according to eq 17 eq 18 and eq 19 the following expression is derived 20 e ε f l e t e ε r t e ε f max e ε r ε f max ε r l e l e t it is assumed that when l e tends to zero the average failure strain of element ε f is equal to ε f max when l e is smaller than t the following expression is derived 21 e ε f e ε f max e ε f max e ε f max e ε r ε f max ε r l e t l e t combining eq 20 and eq 21 the average failure strain of different mesh size is derived 22 e ε f l e t e ε r t e ε f max e ε r ε f max ε r l e l e t e ε f max e ε f max e ε f max e ε r ε f max ε r l e t l e t the alsos formula eq 16 and the new formula in this paper are illustrated in fig 10 when element length l e is larger than t the discrepancy between these two formulas is relatively small less than 13 5 and becoming smaller and smaller as element length increases when element length l e is less than t the discrepancy first decreases and then increases as t decreases the minimum discrepancy is at about l e t 2 the failure strain of alsos formula increases extremely fast with the decrease of mesh size when element length is less than half of the thickness therefore the fracture strain of alsos formula may exceed the maximum failure strain in the necking area however the new formula proposed in this paper can avoid this problem 4 2 damage evolution model it is well known that steel materials usually experience elastic yield strain hardening and necking stage during the process of a tensile experiment the material behavior and damage evolution models are shown in fig 11 when the material reaches the failure point the necking phenomena occurs after that the material enters into the necking stage called damage evolution process the linear model exponential model and piecewise linear model are commonly used to describe the damage evolution process hogström et al 2009 proposed a bilinear model to describe damage evolution process according to hogström s softening model there are two distinct stages of the true stress strain relationship after necking in the beginning of the necking stage the stress increases relatively slow and the section area of specimen reduces relatively small this is called steady necking stage after that stage rapid necking stage which has rapid stress increase and section reduction occurs until final fracture the material used in this paper has similar characteristics with hogström s softening model if the force is unloaded in the steady necking stage fracture may not occur once the material enters the stage of rapid necking fracture is inevitable however the critical point which separates steady necking stage from rapid necking stage is difficult to determine hogström applied a calibrated parameter in his bilinear model kõrgesaar and romanoff 2013 proposed a two stage softening model which regards the beginning of fracture as the critical point the two stage softening model has six material parameters and is inconvenient in application the damage evolution models mentioned above are based on uniaxial tension experiments it is improper when they are applied to biaxial tension stress state the equivalent strain of plane stress state can be expressed as 23 ε b 2 1 β β 2 3 ε 1 where ε b represents the equivalent strain of plane stress state the strain ratio of uniaxial tension stress state is β 1 2 the equivalent strain of uniaxial tension is derived 24 ε u ε 1 where ε u represents the equivalent strain of uniaxial tension for the biaxial tension experiments when a material element reaches the failure point necking it won t fracture immediately because the failure material element is constrained by the surrounding elements due to deformation compatibility the behavior of the material after necking is evaluated by damage evolution model the important parameter of damage evolution model in biaxial tension state is the fracture stain which has not been proposed by former researchers a simplified model is proposed in this paper assume that the major principal strain increments under biaxial and uniaxial tension stress states are equal from necking to final fracture furthermore assume that the strain increments of steady necking stage and rapid necking stage are also equal therefore the failure strain of biaxial tension stress state used in fe simulations can be expressed as 25 ε f b 1 2 ε f u 3 ε n b 2 1 β β 2 ε n b where ε f b represents the failure strain of biaxial tension stress state ε f u represents the failure strain of uniaxial tension stress state which is calculated by eq 22 ε n b represents the equivalent strain at the onset of necking which is predicted by failure criterion the equation can also be applied to uniaxial tension stress state when β is set as 1 2 and ε n b is set as corresponding necking strain 4 3 modeling of experiments the simulation models mainly include material constitutive model loading boundary conditions meshing for damage problems failure criterion failure strain and damage evolution model should be considered in material constitutive model according to uniaxial tensile experiment results the influence of rolling direction on mechanical properties of the high strength hull steel is negligible therefore the simulation models of all experiments use the same material constitutive model the constant strain criterion is defined in abaqus explicit with ductile damage and displacement damage evolution model while the bwh criterion and the modified bwh criteria combined with the bilinear damage evolution model are implemented by user material subroutine which called vumat in abaqus explicit the displacement at fracture of the damage evolution model can be expressed as 26 u d 1 2 l e ε f where u d is the displacement at fracture l e is the fe element s characteristic length and ε f is calculated by eq 25 another important part of simulation models is meshing suitable mesh size and the optimized grid can improve simulation precision and reduce calculation time the specimens are modeled with solid elements and with five elements through the thickness the simulation models of the circular specimen with a series of mesh sizes 1 mm 1 mm 0 8 mm 2 mm 2 mm 0 8 mm 4 mm 4 mm 0 8 mm 8 mm 8 mm 0 8 mm are selected to verify grid convergence if the true time of the experiments were used in the simulations it may take months and is unacceptable therefore quasi static analysis of abaqus explicit is applied and the simulation time is 0 05s more than 10 times of the period of the lowest order mode of the simulation model which is commonly used thus the indenter speed in simulations is about 0 9 m s the die and the punch are assumed as rigid bodies contact between the punch specimen and die is surface to surface using penalty contact method and the friction coefficient is set as 0 05 it is reasonable for contact surface with lubrication the failure criteria used in all simulation models use the same failure strain and failure displacement displacement load is applied the bolt holes and outer edge are fixed and the reaction force of the punch is explored displacement of the punch increases until the specimen is fractured the simulation results are shown in fig 12 it shows that the displacement loading force curves fit well with experiments before fracture it is clear that the mesh is gradually converged from 8 mm to 1 mm the results of mesh size 1 mm and 2 mm are almost the same except the last segment which close to fracture the calculation time and deviation of simulation models are shown in table 2 compared with mesh size 2 mm the precision of mesh size 1 mm improves slightly however its calculation time is over two times longer than mesh size 2 mm considering accuracy and computational efficiency mesh size 2 mm is selected in simulations the influence of different mesh sizes on fracture prediction will be discussed in section 6 after the determination of material constitutive model and mesh dimensions the six kinds of specimens in fig 3 are all modeled for example the simulation models of specimen a and specimen b are shown in fig 13 the specimens are modeled with solid elements of 2 mm 2 mm 0 8 mm in the central area and with five elements through the thickness several variables such as the equivalent strain yield stress strain ratio failure parameter etc are defined in the abaqus vumat subroutine when using the bwh and m bwh criteria because the failure strain of all the biaxial experiments simulations is larger than the uniaxial experiments the failure judgment of the elements is omitted when ε ε n to some extent this method can save some computation time in the vumat subroutine the equivalent strain and strain ratio are expressed as variable sdv1 and sdv14 respectively 5 simulation results in this section the results of the simulations are compared with the experimental results the displacement loading force relationship and the fracture prediction are concerned 5 1 simulation of uniaxial tension experiments some strain states can be expressed by specific strain ratios such as β 1 2 vs uniaxial tension β 0 vs plane strain β 1 vs equi biaxial tension since the m bwh criterion only modifies the positive strain ratio the m bwh is not applied in the simulation of uniaxial tension experiments the simulation results of uniaxial tension experiments are illustrated in fig 14 the stress strain curves of simulation results coincide with experiments until the point of damage occurs and then the damage evolution starts until fracture the curves using cs criterion green lines seem to be closer to the experiments than the curves using the bwh criterion red lines but the maximum loading force of the former is slightly lower than the latter with values of 35 5 k and 35 8 k respectively the latter has closer result to the experiments the maximum stress of the latter is larger than the former it is more reasonable that considering the reduction of section in the necking area in fig 14 the dot dashed lines red thick line and green thin line represent the fracture elements f elements in the simulation model while the dashed lines red thick line and green thin line represent one of the non fracture elements near the necking area it shows that the stress of the non fracture elements n elements drop down suddenly with no more strain increase while the strain of fracture elements increase quickly this phenomenon suggests the localized instability has occurred the material constitutive model applied in simulation models is calibrated well with uniaxial tension experiments considering reduction of section in the necking area the bwh criterion yields better prediction for the onset of failure 5 2 simulation of biaxial tension experiments 5 2 1 variation of strain ratio the strain ratio in structures may vary in different loading cases this section will discuss the variation of strain ratio during the biaxial tension experiments the simulation results of specimen a to f determined by bwh criterion are shown in figs 15 20 the comparison results of figs 15 a 20 a and figs 15 b 20 b show that the crack shape of simulations is similar to the experiments respectively according to the simulation results the circular crack radius of the specimen a is about 1 cm less than experiment results about 3 cm and the distances between the crack and center of the specimens b f are about 1 cm less than experiment results about 2 cm respectively this indicates that the bwh criterion can predict crack shape and position to some extent the discrepancy may be caused by processing error installation error local insufficient lubrication or other factors figs 15 c 20 c show different strain ratio distributions when specimens are about to fracture figs 15 d 20 d show the strain ratio of a fracture element in the loading process figs 15 c 20 c and figs 15 d 20 d indicate that strain ratio varies with position and loading process therefore the failure criteria which are related to strain ratio may have better accuracy such as the bwh and m bwh criteria figs 15 d 20 d show similar wave when punch displacement is less than 10 mm this situation may be caused by specimen catering to circular punch and direction change of the maximum principal strain during the initiation of loading with the increase of punch displacement the strain ratio of the circular specimen is nearly invariable while the strain ratios of the grooved specimens are decreasing in various degrees the specimens strain ratios at failure and fracture points predicted by the bwh criterion and the bilinear damage evolution model are shown in table 3 and they are marked in figs 15 d 20 d as mentioned above the strain ratio varies with position and loading process it indicates that the stain path may vary in different loading cases 5 2 2 fracture prediction section 5 2 1 shows that the strain ratios of specimen a b and c are positive before failure point however the strain ratios of specimen d e and f are negative or nearly zero when close to and after failure point therefore the results of specimen d e and f using bwh criterion and m bwh criterion are almost the same hence only bwh criterion and cs criterion will be compared in these three kinds of specimens the other kinds of specimens will be compared with three criteria considering the mesh size influence of failure strain the cs criterion with scaled according to eq 22 is also studied the simulation results of displacement loading force curves are illustrated in figs 21 26 the experiment data are inaccurate after fracture because the displacement sensor is slanted by the punch after the fracture of specimens therefore comparison and analysis of simulations and experiments are conducted before fracture figs 21 26 show that the displacement loading force curves of three failure criteria are basically the same before fracture there are small differences with experiment results when the loading force is small the simulation curves of specimen a are almost coincident with the experiment results however the discrepancy increases when the loading force exceeds 250 kn this may be explained by the stability decline of hydraulic loading system under high pressure the discrepancy of other specimens may relate with specimen processing error installation error of specimen and sensor or other factors the prediction of fracture point will be discussed below the fracture force and displacement of simulation and experiment results are shown in table 4 the fracture force and displacement errors between experiments and different simulation models are shown in table 5 the errors of none scaled cs criterion increase from specimens f to a the maximum error of fracture force and displacement is 44 9 and 38 9 respectively the errors of specimens a and b are too large others are acceptable according to table 3 the strain ratios of specimen c to f are negative or close to zero hence the none scaled cs criterion is suitable for predicting the failure of material when stain ratio is low or negative however it is improper when strain ratio is high compared with the none cs criterion the fracture force and displacement predicted by the scaled cs criterion is increased in all specimens simulations the errors of specimens a to d are decreased by scaled cs criterion however the errors of specimens e and f are increased the maximum error of fracture force and displacement is 23 9 and 25 3 respectively oh the whole the scaled cs criterion has higher precision in prediction of material fracture than none scaled cs criterion the simulation results using the bwh criterion correspond well with the experiment results the maximum error of fracture force and displacement is the same 21 5 the simulation result of specimen a is very well less than 5 the simulation result error of specimen b is 9 1 larger than the result by scaled cs criterion but 14 7 less than the result by the none scaled cs criterion the error increases from specimen d to f it indicates that the bwh criterion slightly overestimates the capability of material when strain ratio is negative but the results are still in reasonable range oh the whole the bwh criterion has higher precision in prediction of material fracture than scaled cs criterion the simulation results using the m bwh criterion correspond well with the experiment results compared with the bwh criterion the m bwh criterion improves the accuracy of specimen a while the accuracy improvement of other specimens is not obvious because the strain ratios of specimen b and c are close to zero at onset of failure see table 3 however the strain ratio of specimen a is close to one the improvement effect of m bwh criterion increases when strain ratio increases it is not obvious when strain ratio in a low value but it becomes obvious when the strain ratio is high see fig 8 in other words the m bwh improves the accuracy of stress state with high value strain ratio 6 discussion the fracture prediction of the biaxial tension experiments is reproduced well by the scaled cs the bwh and the m bwh criteria the failure strain under different stress states varies for the scaled cs criterion the failure strain is usually derived from uniaxial tension experiment through some scaled methods such as barba s law alsos formula the new formula proposed in this paper and so on these methods show significant mesh size influence applying the cs criterion which scaled by eq 22 the simulation results of circular specimen with different mesh size is shown in fig 27 it shows clearly that the mesh size influence is significant and the accuracy cannot be guaranteed by coarse mesh however when the same failure strain is applied in the simulation models with different mesh size the mesh size influence seems weaker see fig 12 some researchers kõrgesaar and romanoff 2014 kõrgesaar et al 2014a and walters 2014 have found similar results that mesh size dependence is considerably weaker under plane strain and equi biaxial tension so it is not easy to find a suitable failure strain just from uniaxial tension experiment to predict all the fracture of material under different stress states in ship collision scenarios the failure of ship structures takes place mostly between plane strain and equi biaxial tension kõrgesaar and romanoff 2014 kõrgesaar et al 2014b and werner et al 2015 hence applying the cs criterion to study ship collision has inadequate accuracy even the scaled cs criterion for the bwh and the m bwh criteria they consider the distribution of strain state during the process of deformation the simulation results of biaxial tension experiments show that these two criteria work well although a slight underestimate of material under the stress state between plane strain and equi biaxial tension the failure mechanism needs further study in the future 7 conclusions simulations of the uniaxial tension experiments and a series of biaxial tension experiments are studied when a material element reaches the failure point during the loading process it won t fracture immediately but enters into the damage evolution stage therefore the simulation combined with a failure criterion and a damage evolution model will improve accuracy in this paper the simulation models which consider the mesh size sensitivity the failure criteria and the damage evolution model have been studied a new formula to calculate the average failure strain of different mesh size is proposed the new formula and the alsos s formula are consistent with each other when element length is large the average failure stain of alsos formula and other formulas relate to the inverse of mesh size may tend to infinity when mesh size tends to zero this unreasonable result can be modified by the new formula when small elements are used the maximum failure strain derived from uniaxial tension experiments is used in the new formula and a reasonable result is achieved however the new formula has limitations in the stress state between plane strain and equi biaxial tension with the application of the average failure strain calculated by the new formula a bilinear damage evolution model of the material in biaxial tension stress is proposed it is based on two assumptions first the major principal strain increment of biaxial and uniaxial tension stress state is equal from necking to final fracture second the strain increment of steady necking stage and rapid necking stage is also equal the simulation results adopting the bilinear damage evolution model are in good agreement with experiment results the cs criterion has limited precision to predict the material failure behaviors especially in the biaxial stress state with high strain ratio because of it underestimates the load capacity of the material and the stress and strain states of structures under biaxial stress are different in different location while the failure prediction of all elements is the same in the cs criterion the scaled cs criterion improves the precision in predicting the material failure behaviors however it is hard to find a suitable failure strain just from uniaxial tension experiment to predict all the fracture of material under different stress states the bwh criterion describes the stress state of the material using strain ratio a relationship of the maximum principal stress and strain ratio is proposed to predict the onset of failure the results implemented by the bwh criterion are relatively good compared to the cs criterion it can predict the failure tendency of the material under biaxial stress though the bwh criterion has better accuracy than the cs criterion it slightly underestimates the material load capacity on the condition of high strain ratio the m bwh criterion proposed in this paper increases the accuracy of failure prediction when the strain ratio is close to one in the simulation models the failure of each element is determined by current stain ratio therefore the bwh criterion and the m bwh criterion consider the variation of the material s stress and strain state with location and time in ship collision scenarios ship structures usually sustain biaxial stress when the stress in thickness direction is negligible it is reasonable to use the bwh or m bwh criterion to predict the failure of structures if they are applied in the ship collision research the strain rate ratio which is time related is not equal to the strain ratio however it is easy to implement in fem code the strain rate also influences the yield stress which need be considered in fem code other factors such as initial imperfection welding residual stress need be studied in the future acknowledgements the present work is co supported by the chinese government key research project kship ii project knowledge based ship design hyper integrated platform no 201335 and high tech ship research projects sponsored by miit 2016 25 the authors would like to acknowledge the project support 
23483,the hydrodynamic performance of the rotated vertical axis tidal current turbine with another two i e surge and yaw in this paper degrees of freedom dof coupled motion in unbounded uniform flow is analysed by the dynamic mesh the effects of the turbine s hydrodynamic loads have been studied and illustrated considering the 3 dof coupled motion numerical results show that 1 the effects of the hydrodynamic load is mainly caused by the surging motion but the effects of the yawing motion is reflected when its frequency is greater than that of the surging 2 there are fluctuations in the envelope curves of the thrust and lateral force rotational and yawing moment coefficients of the turbine and the fluctuation amplitudes have a positive correlation with the surging and yawing motion frequencies 3 the calculation formula of the turbine s hydrodynamic loads coefficients are obtained the results of the hydrodynamic loads calculated by the formulations and cfd numerical simulation show good agreements which verify the calculation formulas reasonably the results of this research can provide relevant data for the hydrodynamic analysis of turbines with multi degree of freedom motion and the structural design keywords tidal current energy vertical axis turbine multi degree of freedom motion hydrodynamic loads coupled motion nomenclature for turbines u uniform incoming flow velocity unit m s u oscillation velocity unit m s a swaying acceleration unit m s2 d turbine diameter unit m r turbine radius unit m n number of blades ω t turbine angular velocity unit rad s θ blade azimuth angle unit rad ξ s surging displacement unit m a s surging amplitude unit m ω s surging frequency unit rad s ξ y yawing angle unit degree a y yawing amplitude unit rad ω y yawing frequency unit rad s u y d dimensionless swaying velocity a y d dimensionless swaying acceleration l y length of yawing arm unit m s c chord length unit m f hydrodynamic load of turbine f x turbine thrust unit n f y lateral force of turbine unit n f t tangential force of blade unit n f n normal force of blade unit n λ tip speed ratio m r turbine rotational torque unit n m m y turbine yawing moment unit n m ρ density of inflow water unit kg m3 1 introduction with increasing demand for energy and concerns for environment protection there have been efforts invested into pursuing clean renewable energy among them tidal current energy liang et al 2013 o rourke et al 2010 has several advantages of sustainability predictability and strong energy intensity therefore there has been an increasing interest in making full use of tidal current energy a tidal current turbine is a device which converts the tidal energy is into electrical energy it is a key component of the entire power system based on the direction of the turbine rotation axis tidal current turbines can be divided into vertical axis turbines vats liu and xiao 2015 xiao et al 2013 li and çalişal 2010 and horizontal axis turbines hats bahaj et al 2007 the vertical axis turbines salter and taylor 2007 have some advantages they can reach higher torque at a lower tip speed ratio and adapt to flow coming from any directions this makes vats useful in some specific condition the platform of tidal current power station tcps is used to support turbines generators and other equipment they will also be people working on the platform the right choice of the support platform for tcps is very important they can be classified as sea bed mounted gravity based systems pile mounted systems and floating moored systems the sea bed system is suitable for shallow water where the effects from wind and wave are much smaller fengmei et al 2013 the pile mounted system is adopted for deeper water 30 60 m and the structure is very firm this type of system is limited by geological conditions for example if the sea bed is too hard to drill the pile mounted system cannot be used the advantages of the floating moored system li 2008 are its easy installation as the system is towed to and then moored at the site it is also easier to remove if a major repair task is needed or if relocation is necessary and more convenient for routine maintenance because most part of the platform is near or above the water surface at sites where sea is deeper and the sea bed is mostly stone the floating system is preferable however the floating platforms can be set into motion by waves and currents and the motion affects the performance of the vertical axis turbine which can be very different form that when the platform is stationary investigation of such a performance is prime purpose of this paper there has been extensive research on interaction on tidal current or wave with complex turbines and the platform such as floating wind turbines tidal current turbines and floating offshore platforms simulations based on computational fluid dynamics and experiments have extensively used in the research three blade horizontal axis tidal turbines were studied by galloway et al galloway et al 2010 in regular waves in deep water the results showed that the time averages of physical parameters for example thrust and torque were identical with and without waves while there transient values differed greatly the fluctuations in thrust increased by 37 and the torque increased by 35 ethan lust et al 2014 carried out a model test wave and without wave on a two blade horizontal turbine in a towing tank the diameter d of the model was 800 mm and the immersion depth was 1 3d and 2 25d the resistance torque and rotational speed were measured the test data showed that the results at the two different immersing depths were similar when a wave existed the thrust and power experienced periodical changes and the oscillation frequency was consistent with the wave frequency under different combinations of rotation speed and waves the oscillations of the test power and resistance were 39 and as high as 79 respectively zhang et al 2015 employed the cfd method to analyse the hydrodynamic performance of a turbine d 0 7 m n 2 subjected to constant inflow with constant speed when the turbine was in forced oscillation they investigated how the hydrodynamic performance of the turbine was influenced by the frequency and amplitude of the surge motion and speed ratio zhang et al 2015 found that the surge phenomenon only weakly influenced the annual electricity output and that when the values of the surge frequency surge amplitude and tip speed ratio increased the oscillation amplitudes of the load coefficients also increased however the surging motion has clear negative impacts on the structural strength and fatigue life of the turbine very little research has been conducted on vertical axis tidal turbines in which the hydrodynamic performance subject to waves and currents has been analysed sheng et al 2016 employed the cfd method to analyse the influence of surge motion on vertical axis turbines based on numerical simulation results a double trigonometric function was developed to fit the time history curves of hydrodynamic derivatives because of the dual frequency characteristics of vertical axis turbines then they used the least squares method to obtain hydrodynamic derivatives of force coefficient the results showed that 1 surge motion results in the periodic variation of peak value of instantaneous hydrodynamic loads and that maximum loads of the turbine increased 2 damping coefficient in surge motion is not dependent on the amplitude phase and frequency of surge motion but is related to the tip speed ratio phase angle of the blade wang et al kai et al 2016 also employed the cfd method to analyse the hydrodynamic performance of a vertical axis turbine at different yawing frequencies the damping and added mass coefficients were calculated and the influence of the yawing frequency on them was investigated the results showed that the hydrodynamic coefficient time varying curves of yawing turbines exhibit an additional fluctuation the amplitude is positively correlated with the yawing frequency and the oscillation amplitudes increase with increasing yawing frequency however the average values of the hydrodynamic coefficients except the power coefficient are only weakly influenced by yawing motion the damping term and the added mass term exert effects of the same level on the loads and moments of vertical axis turbines under yawing motion in an actual situation of a floating tidal current power station yong et al 2012 due to the effect of waves the floating carrier would generate wave induced movements that were generally multiple dof coupled motions causing the turbine to undergo motion with a floating carrier therefore the hydrodynamic characteristics of the turbine will be affected by the wave and turbine motion to make the floating tidal current power station run safely and reliably it is necessary to study the hydrodynamic characteristics of the turbine when it generates movement under the wave condition the hydrodynamic analysis of the vertical axis turbine in a wave current field is very complicated and it is difficult to use cfd software to simulate the wave current field directly hence we simplify the hydrodynamic problems of the vertical axis turbine with multiple dof wave induced movements and put forward the following four assumptions 1 the inflow velocity is a constant with no influence of waves which means that we assume that the tip immersion depth is deep enough 2 the wave effect is however important to the platform and the wave will set the platform into motions 3 in this work though the platform is not actually considered its motion effect on the current turbine is explored 4 the axis of the turbine is vertical to the calm surface and the blades of the turbine are straight so the flow field at each turbine section is similar and can be treated as a 2d flow field based on these assumptions the hydrodynamic problems of the vertical axis turbine with wave motion can be simplified as problems of a 2d turbine with multiple dof simple harmonic motions in a constant tidal current the literature sheng et al 2016 kai et al 2016 reports on the hydrodynamic load of a vertical axis turbine when it generates single degree freedom oscillation and rotation coupled motion and the rules of a hydrodynamic load that is affected by the swaying frequency and swaying amplitude on the basis of the literature and cfd this paper analysed the hydrodynamic load of a vertical axis turbine with 3 dof motion in the unbounded uniform flow using dynamic mesh technology the cfd calculation results of the rotated turbine with single dof surging r s or yawing r y motion are analysed the calculation formulas of hydrodynamic load of the turbine with the 3 dof motion are also obtained the research will focus on the effect laws of the turbine s hydrodynamic load under the condition of co frequency surging and yawing coupled motion and different frequency at a constant rotation speed the result provides relevant data for studying the wave motion response of a floating carrier and designing the turbine structure and control system of the electrical energy 2 fitting formula of the turbine hydrodynamic loads in the working condition the vertical axis turbine is in normal operation and generates a single degree of freedom oscillation movement the hydrodynamic load of the turbine is affected by the rotation and oscillation frequencies according to the features of the turbine hydrodynamic load we select appropriate expressions to fit the hydrodynamic load of the vertical axis turbine the following will introduce a specific calculation method of the fitting formulas when the vertical axis turbine is in the working condition set u and a as the dimensionless oscillation velocity and acceleration respectively the formula is expressed as 1 u u u 2 a a r u 2 the hydrodynamic load coefficient of the turbine with oscillation movement is c f the formula is expressed as 3 c f 2 f ρ u 2 d the hydrodynamic loads depend on the current speed the rotating speed of the turbine and the motion of the platform when the turbine generates small amplitude movement with the platform we can divide the hydrodynamic force into a uniform current hydrodynamic force damping resistance and added mass force the formula is expressed as 4 c f c f u n f u m f a where c f u is the hydrodynamic force coefficient without swaying movement n f and m f are the swaying damping and added mass coefficients respectively according to the characteristics of the vertical axis turbine hydrodynamic load c f u n f and m f in formula 4 can be expanded into the form of trigonometric series 5 c f u c f 0 k 1 c f k sin k n θ ψ f k 6 n f n f 0 k 1 n f k sin k n θ ψ f u k 7 m f m f 0 k 1 m f k sin k n θ ψ f a k therefore the turbine hydrodynamic load coefficient curve can be represented by the following formula 8 c f c f 0 k 1 c f k sin k n θ ψ f k n f 0 k 1 n f k sin k n θ ψ f u k u y d m f 0 k 1 m f k sin k n θ ψ f a k a y d because the flow field of the vertical axis turbine is very complicated with a dynamic stall and wake it is difficult to solve for these coefficients damping coefficient and added mass coefficient directly however the turbine hydrodynamic load coefficient c f in the time domain can be obtained by experiment or cfd numerical simulation if eq 8 reserve finite items the coefficients in eq 8 can be solved by least squares methods 3 cfd simulation for the convenience of subsequent data analysis we explain the expressions of the correlation coefficient as follows 9 thrust coefficient c f x f x 0 5 ρ u 2 d 10 lateral force coefficient c f x f x 0 5 ρ u 2 d c f y f y 0 5 ρ u 2 d 11 tangential force coefficient c f x f x 0 5 ρ u 2 d c f y f y 0 5 ρ u 2 d c f t f t 0 5 ρ u 2 c 12 normal force coefficient c f n f n 0 5 ρ u 2 c 13 turbine rotational moment coefficient c m r m r 0 5 ρ u 2 d r 14 tip speed ratio λ ω t r u 15 turbine yawing moment coefficient c m y m y 0 5 ρ u 2 d l 3 1 building calculation model the vertical axis turbine with airfoil profile naca0018 is used as this simulation model which was developed by the institute of ocean renewable energy system iores at harbin engineering university heu in china the parameters of the turbine are given in table 1 for a small scale vertical axis turbine the velocity of the waves and the response velocity of the tidal current power station can be simplified as the periodic variation of the relative velocity between the turbine and the incoming current the incoming current is taken as uniform in this paper and the shear current is not considered the coordinate systems are given in fig 1 the hydrodynamic loads are calculated by ansys cfx software in the simulation of the vertical axis turbine with the considered 3 dof coupled motion not only the rotational motion but also surging ξ s a s sin ω s t the x direction is the surging direction and yawing ξ y a y sin ω y t the z direction is the yawing direction coupled motion needs to be considered in the numerical simulation to ensure mesh quality in the calculation the whole computational domain is divided into four subdomains rotation surging yawing and deformation domains as shown in fig 2 the rotation domain is within the yawing domain the yawing domain is within the surging domain and the surging domain is next to the deformation domain the distance between the turbine rotation axis and the centre of the yaw is d 2 the length of the entire computational domain is 32d and the width is 16d the distance between the turbine rotational axis and the inlet boundary is 8d 3 2 meshing meshing is a very important aspect of the numerical simulation technique as the grid quality directly affects the accuracy and efficiency of the numerical calculation however it is also one of the most time consuming processes the meshing of the entire computational domain adopts the methods of structured grid and the region closest to the blade was meshed with quadrilateral structured o grids as shown in fig 3 to select a suitable value for y four different heights of the first layer of the turbine s surface mesh were defined and the total number of grids is up to 100 000 table 2 shows the detailed information about the different grid structures and fig 4 compares the tangential and normal force coefficients for the four kinds of meshes the general trends for all four kinds are similar the values for kind 1 and 2 are nearly overlapping and the values for kind 3 and 4 differ only slightly therefore the 2nd kind of meshes is chosen to simulate the vertical axis turbine because of its relatively high accuracy and lower computational cost the movement is realized by dynamic mesh cel code is written using the cfx software according to the movement rule of the blades the location of the grid node in the rotation domain is controlled to satisfy the rotation surging motion and yawing motion requirements to reduce the mesh deformation and ensure the high quality of the mesh in the calculation the yawing domain yaws and surges together with the rotation domain and the surging domain surges together with the rotation and yawing domains in this condition there is no mesh deformation between the surging yawing and rotation domains and compression and tension of the mesh only occur in the deformation domain because of the surging motion of the surging domain but without the warping of the mesh the parameters of the dynamic meshes are set to control the mesh density after compression and tension to ensure the accuracy of the mesh in the flow field 3 3 boundary condition the basic boundary condition settings of the cfd numerical simulation are given as follows the reference atmospheric pressure was established the inlet boundary inlet is a velocity entry given a uniform flow velocity and turbulence parameters the outlet boundary outlet is a pressure outlet with the relative pressure set to 0 the sides of the computational domain are set as free slip walls free slip wall the blade surface is a non slip wall no slip wall the rotation and yawing domains the yawing and surging domains were connected by an interface as well the surging and deformation domains the k ω sst model is adopted as a turbulent model and the transient solver is used the time period during which the blade rotates 3 is adopted as the time step of the entire simulation the time step will affect the convergence of the simulation and cpu computation time in the solution of unsteady state li zhichuan et al 2014 compared the calculation results of four different time step in view of the vertical shaft turbine and find that the calculation results are independent to the time step when the impeller rotation angle is less than or equal to 3 therefore the time period during which the blade rotates 3 is adopted as the time step of the entire simulation in this paper 3 4 validation of the cfd method to confirm the accuracy of the numerical method applied in this paper the ansys cfx was used to simulate the classical vertical axis turbine experiment texas tech university united states strickland et al 1979 in that tunnel experiment the tangential and normal force coefficients of the blades were measured and the turbine used was similar to that used in this paper the diameter of the turbine was 1 22 m the chord length was 0 0914 m and the two blades had a naca symmetric airfoil profile naca0012 the same method used in this paper was adopted to simulate this two bladed vertical axis turbine model fig 5 compares the results solid lines from cfx the experimental results dotted lines and the results dashed lines from texas tech university s dynamic model strickland et al 1979 for a blade azimuth angle of between 270 and 450 the values from cfx and the dynamic model exhibited a goodness of fit and a larger difference with respect to the experimental results the texas tech university results indicate that the hump observed when the blades are rotating downstream of the disk at approximately 360 may be partially due to misalignment errors in the blade mounting therefore when the gap near blade azimuth angles of 360 is disregarded the comparison indicates satisfactory accuracy of the 2d cfx numerical method for vertical axis tidal current turbines 4 analysis of turbine loads during the rotation period of the turbine instantaneous loads are fluctuating periodically and the fluctuation frequency is related to the number of blades the variation loads of the turbine influence the structural strength and fatigue life of the blades so the forces of the turbine must be studied to ensure the safety of the turbine for a long working time the time varying curves of the four coefficients thrust lateral force turbine rotational moment and turbine yaw moment coefficients of the turbine operates under different conditions are shown in figss 6 9 the yawing moment coefficients in figss 6 9 are the torque to the same point the centre of the yaw the history curves of the four coefficients are fluctuating with the 2 times rotation frequency when the turbine is only rotating in a uniform current the maximum and minimum values are not changed so the envelopes of the maximum and minimum values are almost a straight line upper and lower envelope when the turbine is rotating with other motion surging motion yawing motion surging and yawing coupled motion the envelopes of the maximum and minimum values are no longer a straight line but are fluctuating with motion frequency and the turbine load oscillations can be divided into low frequency oscillations corresponding to the motion frequency and high frequency oscillations corresponding to the 2 times rotational frequency when the turbine operates with 3 dof coupled motion the history curves of the four coefficients are similar as when turbine rotates with surging motion so the impact of surging motion is bigger than yawing motion the changes of the turbine force can be expressed by the envelope of the maximum and minimum values of the forces so only the envelope of the maximum and minimum values of the forces is given in the following figures 4 1 co frequency coupled motion to study the hydrodynamic characteristics of a vertical axis turbine with 3 dof co frequency coupled motion we set the turbine rotation around the optimum rotational speed λ 2 5 the yawing amplitude is π 18 the surging amplitude is d 4 0 2 m and the inlet velocity is 1 m s we choose three different frequencies 0 6 rad s 1 0 rad s and 1 4 rad s to calculate and compare the result with the calculation values of the turbine with r y and r s coupled motion fig 10 shows the four coefficients thrust lateral force turbine rotational moment and turbine yawing moment coefficients comparison curve with time under different frequencies the numbers in the graphic legends represent frequencies with units of rad s 0 6 1 0 and 1 4 are the calculation results when the turbine with 3 dof coupled motion s0 6 s1 0 and s1 4 are the calculation results of the turbine with r s coupled motion and y0 6 y1 0 and y1 4 are the calculation results of the turbine with r y coupled motion as shown in fig 10 when the turbine with r s coupled motion the envelope curves of the four coefficients generate clear periodic fluctuations with the turbine surging the fluctuation frequency is consistent with the surging frequency and the fluctuation amplitude increases as the surging frequency increases when the turbine with r y coupled motion the envelope curves of the four coefficients also have fluctuations the fluctuation frequency is consistent with the yawing frequency the fluctuation amplitude increases with the yawing frequency but it is clearly less than the fluctuation amplitude when the turbine with r s coupled motion when the turbine with 3 dof coupled motion the envelope curves of the four coefficients has an obvious fluctuation the fluctuation frequency is consistent with the surging yawing frequency and the fluctuation amplitude increases with the frequency the calculation results of the thrust and turbine rotational moment coefficients are basically similar to the calculation results when the turbine with r s coupled motion the calculation value of the lateral force and turbine yaw moment coefficients are greater than the value when the turbine with r s coupled motion or r y coupled motion and the fluctuation amplitude increases with the frequency this means that surging motion has a more impact on the calculation results than the yawing motion during the process of rotation and co frequency surging and yawing coupled motion of the turbine the change rule of the hydrodynamic load is mainly caused by the surging motion 4 2 different frequency coupled motion to study the vertical axis turbine hydrodynamic characteristics when it with 3 dof coupled motion in different frequency the fixed tip speed ratio of the turbine is 2 5 the yawing amplitude is π 18 and the surging amplitude is d 4 choosing two different frequency combinations surging frequency of 0 6 rad s and yawing frequency of 1 4 rad s surging frequency of 1 4 rad s and yawing frequency of 0 6 rad s to calculate the envelope curves of the thrust coefficient lateral force coefficient turbine rotational moment coefficient and turbine yaw moment coefficient are shown in fig 11 in fig 11 the numbers in the graphic legends represent frequencies in units of rad s s0 6 y1 4 and s1 4 y0 6 are the calculation results of the turbine with 3 dof coupled motion s0 6 and s1 4 are the calculation results of the turbine with r s coupled motion and y0 6 and y1 4 are the calculation results of the turbine with r y coupled motion as shown in fig 11 for the thrust lateral force and turbine rotational moment coefficients when surging frequency is higher 1 4 rad s and the yawing frequency is lower 0 6 rad s the envelope curves of calculation results of the turbine with 3 dof and the calculation results of the turbine only with r s coupled motion are basically the same but when the surging frequency is lower 0 6 rad s and the yawing frequency is higher 1 4 rad s the envelope curves of calculation results have significantly different for the turbine yaw moment coefficient when the surging frequency is higher 1 4 rad s and the yawing frequency is lower 0 6 rad s the fluctuation amplitude of the envelope curves of calculation value of the turbine with 3 dof coupled motion is greater than that when it only with r s or with r y coupled motions and the fluctuation frequency is consistent with the surging frequency when the yawing frequency is higher 1 4 rad s and the surging frequency is lower 0 6 rad s the fluctuation frequency of the envelope curves is consistent with the yawing frequency hence when the turbine with 3 dof coupled motion the change rules of the hydrodynamic load are mainly caused by surging motion but when the yawing frequency is much higher than the surging frequency the effect of the yawing motion will be reflected 5 fitting analysis of hydrodynamic load 5 1 calculation formula of hydrodynamic loads in surging and yawing coupled motion the hydrodynamic load fitting formulas of the vertical axis turbine under the condition of rotation and single degree of freedom oscillation motion which is established in section 2 are employed in this part the calculation values of the four coefficients thrust lateral force turbine rotational moment and turbine yawing moment coefficients of the turbine with r s coupled motion or r y coupled motion consist of two parts one part is basically the same as the value when the turbine only with rotation motion the other part is periodically changes with surging motion or yawing motion hence to foreshadow hydrodynamic research on the vertical axis turbine generating more multi degree of freedom motion this paper studies the four coefficients of the turbine with 3 dof coupled motion and resolves them into three parts as follows 1 the calculation value with only rotation motion 2 the fluctuation value which is related to surging motion and 3 the fluctuation value which is related to the yawing motion the calculation value when the turbine with only rotation motion is easy to obtain the fluctuation value that is related to the surging motion can be calculated by eq 13 16 and the fluctuation value that is related to the yawing motion can be calculated by eq 19 22 the four coefficients calculation formulas of the turbine with 3 dof coupled motion can be obtained as follows 16 dimensionless surging frequency ω s ω s ω t 17 dimensionless surging amplitude a s a s d 18 dimensionless yawing frequency ω y ω y ω t 19 dimensionless surge velocity u s a s ω s u cos ω s t 20 dimensionless surge acceleration a s a s ω s r u 2 sin ω s t 21 dimensionless yaw angular speed u y a y ω y cos ω y t l y u 22 dimensionless yaw angular acceleration a y a y ω y sin ω y t l y u 2 thrust coefficient progression 23 c f x c f x u n f x s u s m f x s a s n f x y ω y m f x y a y c f x 0 k 1 c f x k sin k n θ ψ f x k n f x s 0 k 1 n f x s k sin k n θ ψ f x s u k u s m f x s 0 k 1 m f x s k sin k n θ ψ f x s a k a s n f x y 0 k 1 n f x y k sin k n θ ψ f x y u k ω y m f x y 0 k 1 m f x y k sin k n θ ψ f x y a k a y lateral coefficient progression 24 c f y c f y u n f y s u s m f y s a s n f y y ω y m f y y a y c f y 0 k 1 c f y k sin k n θ ψ f y k n f y s 0 k 1 n f y s k sin k n θ ψ f y s u k u s m f y s 0 k 1 m f y s k sin k n θ ψ f y s a k a s n f y y 0 k 1 n f y y k sin k n θ ψ f y y u k ω y m f y y 0 k 1 m f y y k sin k n θ ψ f y y a k a y turbine rotational moment coefficient progression 25 c m r c m r u n m r s u s m m r s a s n m r y ω y m m r y a y c m r 0 k 1 c m r k sin k n θ ψ m r k n m r s 0 k 1 n m r s k sin k n θ ψ m r s u k u s m m r s 0 k 1 m m r s k sin k n θ ψ m r s a k a s n m r y 0 k 1 n m r y k sin k n θ ψ m r y u k ω y m m r y 0 k 1 m m r y k sin k n θ ψ m r y a k a y turbine yawing moment coefficient progression 26 c m y c m y u n m y s u s m m y s a s n m y y ω y m m y y a y c m y 0 k 1 c m y k sin k n θ ψ m y k n m y s 0 k 1 n m y s k sin k n θ ψ m y s u k u s m m y s 0 k 1 m m y s k sin k n θ ψ m y s a k a s n m y y 0 k 1 n m y y k sin k n θ ψ m y y u k ω y m m y y 0 k 1 m m y y k sin k n θ ψ m y y a k a y 5 2 fitting analysis of hydrodynamic loads in r s coupled motion based on the least squares method theory the cfd numerical simulation results of the turbine with r s coupled motion can be used to solve various coefficients associated with the surging motion of eq 23 26 ω y 0 a y 0 as shown in tables 3 6 the constant and first order terms are given in the tables the surging frequency is 0 means only rotation motion it can be seen from tables 2 5 that the values of the first three terms in different surging frequencies are basically the same as those when the turbine with only rotation motion according to the correlation coefficients of tables 3 6 the thrust lateral force turbine rotational moment and turbine yawing moment coefficients of the turbine with r s coupled motion can be obtained by eq 23 26 ω y 0 a y 0 to verify the accuracy of the fitting formula the four coefficients are calculated and compared with the cfd calculation value when the surging frequency is 1 0 rad s as shown in fig 12 cfd is the cfd calculation value in the figure and fitting is the calculation value by the fitting formula in fig 12 the cfd calculation value basically agrees with the calculation value by the fitting formula which verifies the accuracy of eqs 23 26 used in r s coupled motion 5 3 fitting analysis of the hydrodynamic loads in r y coupled motion based on the least squares method theory the cfd numerical simulation results of the turbine with r y coupled motion can be used to solve various coefficients associated with the yawing motion of eqs 23 26 ω s 0 a s 0 as shown in tables 3 6 the constant and first order terms are given in the tables the yawing frequency is 0 means no yaw motion occurs it can be seen from tables 6 9 that the values of the first three terms in different yawing frequencies are basically the same as those when the turbine with only rotation motion according to the correlation coefficients of tables 7 10 the thrust coefficient lateral force coefficient turbine rotational moment coefficient and turbine yawing moment coefficient when the turbine with r y coupled motion can be obtained by eqs 23 26 ω s 0 a s 0 to verify the accuracy of the fitting formula the four coefficients are calculated and compared with the cfd calculation value when the yawing frequency is 1 0 rad s as shown in fig 13 cfd is the cfd calculation value in the figure and fitting is the calculation value by the fitting formula in fig 13 the cfd calculation value basically agrees with the calculation value by the fitting formula which verifies the accuracy of eqs 23 26 used in r y coupled motion 5 4 validation of the calculation formula of hydrodynamic loads in 3 dof coupled motion according to the fitting coefficient table and eqs 23 26 we can calculate the four coefficients of the turbine with 3 dof coupled motion additionally to verify the accuracy of the calculation formulas we calculate the four coefficients and compare them with the cfd calculation values as shown in fig 14 cfd means cfd calculation value and cal means the calculation value of the calculation formula it can be seen from fig 14 that the cfd calculation values are basically the same as the values of the calculation formula which verifies the accuracy of the calculation formula hence when forecasting the hydrodynamic load of the vertical axis turbine under multi degree motion we can first calculate the hydrodynamic load of the turbine with rotation and the single freedom degree among multi degree of freedom motion and then obtain the coefficient table by eq 8 according to the hydrodynamic load time varying curves finally the approximate value of the hydrodynamic load when the turbine generates multi degree of freedom motion can be obtained by the calculation formulas such as 23 26 to further verify the accuracy of the method we will calculate the hydrodynamic load of the turbine with more multi degree of freedom motion 6 conclusion the cfd method is used to analyse the hydrodynamic characteristics of a vertical axis turbine with 3 dof coupled motion under uniform flow and the results are compared with the hydrodynamic loads of the turbine with r s coupled motion r y coupled motion the results demonstrate the following 1 when the turbine with surging and yawing co frequency coupled motion the envelope curves of the thrust lateral force turbine rotational moment and turbine yawing moment coefficients will be time fluctuating with the fluctuation frequency in accordance with the surging frequency and the fluctuation amplitude increasing with the surging frequency this will affect the structure safety and the fatigue life of the turbine so the design of the structure should be paid attention 2 when the turbine with surging and yawing different frequency coupled motion the change regulation of the hydrodynamic load is mainly caused by the surging motion however when the yawing frequency is much higher than the surging frequency the effect of the yawing motion will be reflected in other words the envelope curves of hydrodynamic load not only have a fluctuation based on the surging frequency but also include a fluctuation based on the yawing frequency 3 the calculation formulas of the thrust lateral force turbine rotational moment and turbine yawing moment coefficients have been obtained when the turbine generates multiple degree of freedom coupled motion and the accuracy of the formula has been verified they can benefit research on the hydrodynamic load when the turbine generates multi degree freedom motion acknowledgement this work was supported by the national science foundation no 51709137 no 51579120 u1706227 it is also supported by the natural science foundation of heilongjiang grant no e2015048 the natural science foundation of jiangsu no bk20161103 
23483,the hydrodynamic performance of the rotated vertical axis tidal current turbine with another two i e surge and yaw in this paper degrees of freedom dof coupled motion in unbounded uniform flow is analysed by the dynamic mesh the effects of the turbine s hydrodynamic loads have been studied and illustrated considering the 3 dof coupled motion numerical results show that 1 the effects of the hydrodynamic load is mainly caused by the surging motion but the effects of the yawing motion is reflected when its frequency is greater than that of the surging 2 there are fluctuations in the envelope curves of the thrust and lateral force rotational and yawing moment coefficients of the turbine and the fluctuation amplitudes have a positive correlation with the surging and yawing motion frequencies 3 the calculation formula of the turbine s hydrodynamic loads coefficients are obtained the results of the hydrodynamic loads calculated by the formulations and cfd numerical simulation show good agreements which verify the calculation formulas reasonably the results of this research can provide relevant data for the hydrodynamic analysis of turbines with multi degree of freedom motion and the structural design keywords tidal current energy vertical axis turbine multi degree of freedom motion hydrodynamic loads coupled motion nomenclature for turbines u uniform incoming flow velocity unit m s u oscillation velocity unit m s a swaying acceleration unit m s2 d turbine diameter unit m r turbine radius unit m n number of blades ω t turbine angular velocity unit rad s θ blade azimuth angle unit rad ξ s surging displacement unit m a s surging amplitude unit m ω s surging frequency unit rad s ξ y yawing angle unit degree a y yawing amplitude unit rad ω y yawing frequency unit rad s u y d dimensionless swaying velocity a y d dimensionless swaying acceleration l y length of yawing arm unit m s c chord length unit m f hydrodynamic load of turbine f x turbine thrust unit n f y lateral force of turbine unit n f t tangential force of blade unit n f n normal force of blade unit n λ tip speed ratio m r turbine rotational torque unit n m m y turbine yawing moment unit n m ρ density of inflow water unit kg m3 1 introduction with increasing demand for energy and concerns for environment protection there have been efforts invested into pursuing clean renewable energy among them tidal current energy liang et al 2013 o rourke et al 2010 has several advantages of sustainability predictability and strong energy intensity therefore there has been an increasing interest in making full use of tidal current energy a tidal current turbine is a device which converts the tidal energy is into electrical energy it is a key component of the entire power system based on the direction of the turbine rotation axis tidal current turbines can be divided into vertical axis turbines vats liu and xiao 2015 xiao et al 2013 li and çalişal 2010 and horizontal axis turbines hats bahaj et al 2007 the vertical axis turbines salter and taylor 2007 have some advantages they can reach higher torque at a lower tip speed ratio and adapt to flow coming from any directions this makes vats useful in some specific condition the platform of tidal current power station tcps is used to support turbines generators and other equipment they will also be people working on the platform the right choice of the support platform for tcps is very important they can be classified as sea bed mounted gravity based systems pile mounted systems and floating moored systems the sea bed system is suitable for shallow water where the effects from wind and wave are much smaller fengmei et al 2013 the pile mounted system is adopted for deeper water 30 60 m and the structure is very firm this type of system is limited by geological conditions for example if the sea bed is too hard to drill the pile mounted system cannot be used the advantages of the floating moored system li 2008 are its easy installation as the system is towed to and then moored at the site it is also easier to remove if a major repair task is needed or if relocation is necessary and more convenient for routine maintenance because most part of the platform is near or above the water surface at sites where sea is deeper and the sea bed is mostly stone the floating system is preferable however the floating platforms can be set into motion by waves and currents and the motion affects the performance of the vertical axis turbine which can be very different form that when the platform is stationary investigation of such a performance is prime purpose of this paper there has been extensive research on interaction on tidal current or wave with complex turbines and the platform such as floating wind turbines tidal current turbines and floating offshore platforms simulations based on computational fluid dynamics and experiments have extensively used in the research three blade horizontal axis tidal turbines were studied by galloway et al galloway et al 2010 in regular waves in deep water the results showed that the time averages of physical parameters for example thrust and torque were identical with and without waves while there transient values differed greatly the fluctuations in thrust increased by 37 and the torque increased by 35 ethan lust et al 2014 carried out a model test wave and without wave on a two blade horizontal turbine in a towing tank the diameter d of the model was 800 mm and the immersion depth was 1 3d and 2 25d the resistance torque and rotational speed were measured the test data showed that the results at the two different immersing depths were similar when a wave existed the thrust and power experienced periodical changes and the oscillation frequency was consistent with the wave frequency under different combinations of rotation speed and waves the oscillations of the test power and resistance were 39 and as high as 79 respectively zhang et al 2015 employed the cfd method to analyse the hydrodynamic performance of a turbine d 0 7 m n 2 subjected to constant inflow with constant speed when the turbine was in forced oscillation they investigated how the hydrodynamic performance of the turbine was influenced by the frequency and amplitude of the surge motion and speed ratio zhang et al 2015 found that the surge phenomenon only weakly influenced the annual electricity output and that when the values of the surge frequency surge amplitude and tip speed ratio increased the oscillation amplitudes of the load coefficients also increased however the surging motion has clear negative impacts on the structural strength and fatigue life of the turbine very little research has been conducted on vertical axis tidal turbines in which the hydrodynamic performance subject to waves and currents has been analysed sheng et al 2016 employed the cfd method to analyse the influence of surge motion on vertical axis turbines based on numerical simulation results a double trigonometric function was developed to fit the time history curves of hydrodynamic derivatives because of the dual frequency characteristics of vertical axis turbines then they used the least squares method to obtain hydrodynamic derivatives of force coefficient the results showed that 1 surge motion results in the periodic variation of peak value of instantaneous hydrodynamic loads and that maximum loads of the turbine increased 2 damping coefficient in surge motion is not dependent on the amplitude phase and frequency of surge motion but is related to the tip speed ratio phase angle of the blade wang et al kai et al 2016 also employed the cfd method to analyse the hydrodynamic performance of a vertical axis turbine at different yawing frequencies the damping and added mass coefficients were calculated and the influence of the yawing frequency on them was investigated the results showed that the hydrodynamic coefficient time varying curves of yawing turbines exhibit an additional fluctuation the amplitude is positively correlated with the yawing frequency and the oscillation amplitudes increase with increasing yawing frequency however the average values of the hydrodynamic coefficients except the power coefficient are only weakly influenced by yawing motion the damping term and the added mass term exert effects of the same level on the loads and moments of vertical axis turbines under yawing motion in an actual situation of a floating tidal current power station yong et al 2012 due to the effect of waves the floating carrier would generate wave induced movements that were generally multiple dof coupled motions causing the turbine to undergo motion with a floating carrier therefore the hydrodynamic characteristics of the turbine will be affected by the wave and turbine motion to make the floating tidal current power station run safely and reliably it is necessary to study the hydrodynamic characteristics of the turbine when it generates movement under the wave condition the hydrodynamic analysis of the vertical axis turbine in a wave current field is very complicated and it is difficult to use cfd software to simulate the wave current field directly hence we simplify the hydrodynamic problems of the vertical axis turbine with multiple dof wave induced movements and put forward the following four assumptions 1 the inflow velocity is a constant with no influence of waves which means that we assume that the tip immersion depth is deep enough 2 the wave effect is however important to the platform and the wave will set the platform into motions 3 in this work though the platform is not actually considered its motion effect on the current turbine is explored 4 the axis of the turbine is vertical to the calm surface and the blades of the turbine are straight so the flow field at each turbine section is similar and can be treated as a 2d flow field based on these assumptions the hydrodynamic problems of the vertical axis turbine with wave motion can be simplified as problems of a 2d turbine with multiple dof simple harmonic motions in a constant tidal current the literature sheng et al 2016 kai et al 2016 reports on the hydrodynamic load of a vertical axis turbine when it generates single degree freedom oscillation and rotation coupled motion and the rules of a hydrodynamic load that is affected by the swaying frequency and swaying amplitude on the basis of the literature and cfd this paper analysed the hydrodynamic load of a vertical axis turbine with 3 dof motion in the unbounded uniform flow using dynamic mesh technology the cfd calculation results of the rotated turbine with single dof surging r s or yawing r y motion are analysed the calculation formulas of hydrodynamic load of the turbine with the 3 dof motion are also obtained the research will focus on the effect laws of the turbine s hydrodynamic load under the condition of co frequency surging and yawing coupled motion and different frequency at a constant rotation speed the result provides relevant data for studying the wave motion response of a floating carrier and designing the turbine structure and control system of the electrical energy 2 fitting formula of the turbine hydrodynamic loads in the working condition the vertical axis turbine is in normal operation and generates a single degree of freedom oscillation movement the hydrodynamic load of the turbine is affected by the rotation and oscillation frequencies according to the features of the turbine hydrodynamic load we select appropriate expressions to fit the hydrodynamic load of the vertical axis turbine the following will introduce a specific calculation method of the fitting formulas when the vertical axis turbine is in the working condition set u and a as the dimensionless oscillation velocity and acceleration respectively the formula is expressed as 1 u u u 2 a a r u 2 the hydrodynamic load coefficient of the turbine with oscillation movement is c f the formula is expressed as 3 c f 2 f ρ u 2 d the hydrodynamic loads depend on the current speed the rotating speed of the turbine and the motion of the platform when the turbine generates small amplitude movement with the platform we can divide the hydrodynamic force into a uniform current hydrodynamic force damping resistance and added mass force the formula is expressed as 4 c f c f u n f u m f a where c f u is the hydrodynamic force coefficient without swaying movement n f and m f are the swaying damping and added mass coefficients respectively according to the characteristics of the vertical axis turbine hydrodynamic load c f u n f and m f in formula 4 can be expanded into the form of trigonometric series 5 c f u c f 0 k 1 c f k sin k n θ ψ f k 6 n f n f 0 k 1 n f k sin k n θ ψ f u k 7 m f m f 0 k 1 m f k sin k n θ ψ f a k therefore the turbine hydrodynamic load coefficient curve can be represented by the following formula 8 c f c f 0 k 1 c f k sin k n θ ψ f k n f 0 k 1 n f k sin k n θ ψ f u k u y d m f 0 k 1 m f k sin k n θ ψ f a k a y d because the flow field of the vertical axis turbine is very complicated with a dynamic stall and wake it is difficult to solve for these coefficients damping coefficient and added mass coefficient directly however the turbine hydrodynamic load coefficient c f in the time domain can be obtained by experiment or cfd numerical simulation if eq 8 reserve finite items the coefficients in eq 8 can be solved by least squares methods 3 cfd simulation for the convenience of subsequent data analysis we explain the expressions of the correlation coefficient as follows 9 thrust coefficient c f x f x 0 5 ρ u 2 d 10 lateral force coefficient c f x f x 0 5 ρ u 2 d c f y f y 0 5 ρ u 2 d 11 tangential force coefficient c f x f x 0 5 ρ u 2 d c f y f y 0 5 ρ u 2 d c f t f t 0 5 ρ u 2 c 12 normal force coefficient c f n f n 0 5 ρ u 2 c 13 turbine rotational moment coefficient c m r m r 0 5 ρ u 2 d r 14 tip speed ratio λ ω t r u 15 turbine yawing moment coefficient c m y m y 0 5 ρ u 2 d l 3 1 building calculation model the vertical axis turbine with airfoil profile naca0018 is used as this simulation model which was developed by the institute of ocean renewable energy system iores at harbin engineering university heu in china the parameters of the turbine are given in table 1 for a small scale vertical axis turbine the velocity of the waves and the response velocity of the tidal current power station can be simplified as the periodic variation of the relative velocity between the turbine and the incoming current the incoming current is taken as uniform in this paper and the shear current is not considered the coordinate systems are given in fig 1 the hydrodynamic loads are calculated by ansys cfx software in the simulation of the vertical axis turbine with the considered 3 dof coupled motion not only the rotational motion but also surging ξ s a s sin ω s t the x direction is the surging direction and yawing ξ y a y sin ω y t the z direction is the yawing direction coupled motion needs to be considered in the numerical simulation to ensure mesh quality in the calculation the whole computational domain is divided into four subdomains rotation surging yawing and deformation domains as shown in fig 2 the rotation domain is within the yawing domain the yawing domain is within the surging domain and the surging domain is next to the deformation domain the distance between the turbine rotation axis and the centre of the yaw is d 2 the length of the entire computational domain is 32d and the width is 16d the distance between the turbine rotational axis and the inlet boundary is 8d 3 2 meshing meshing is a very important aspect of the numerical simulation technique as the grid quality directly affects the accuracy and efficiency of the numerical calculation however it is also one of the most time consuming processes the meshing of the entire computational domain adopts the methods of structured grid and the region closest to the blade was meshed with quadrilateral structured o grids as shown in fig 3 to select a suitable value for y four different heights of the first layer of the turbine s surface mesh were defined and the total number of grids is up to 100 000 table 2 shows the detailed information about the different grid structures and fig 4 compares the tangential and normal force coefficients for the four kinds of meshes the general trends for all four kinds are similar the values for kind 1 and 2 are nearly overlapping and the values for kind 3 and 4 differ only slightly therefore the 2nd kind of meshes is chosen to simulate the vertical axis turbine because of its relatively high accuracy and lower computational cost the movement is realized by dynamic mesh cel code is written using the cfx software according to the movement rule of the blades the location of the grid node in the rotation domain is controlled to satisfy the rotation surging motion and yawing motion requirements to reduce the mesh deformation and ensure the high quality of the mesh in the calculation the yawing domain yaws and surges together with the rotation domain and the surging domain surges together with the rotation and yawing domains in this condition there is no mesh deformation between the surging yawing and rotation domains and compression and tension of the mesh only occur in the deformation domain because of the surging motion of the surging domain but without the warping of the mesh the parameters of the dynamic meshes are set to control the mesh density after compression and tension to ensure the accuracy of the mesh in the flow field 3 3 boundary condition the basic boundary condition settings of the cfd numerical simulation are given as follows the reference atmospheric pressure was established the inlet boundary inlet is a velocity entry given a uniform flow velocity and turbulence parameters the outlet boundary outlet is a pressure outlet with the relative pressure set to 0 the sides of the computational domain are set as free slip walls free slip wall the blade surface is a non slip wall no slip wall the rotation and yawing domains the yawing and surging domains were connected by an interface as well the surging and deformation domains the k ω sst model is adopted as a turbulent model and the transient solver is used the time period during which the blade rotates 3 is adopted as the time step of the entire simulation the time step will affect the convergence of the simulation and cpu computation time in the solution of unsteady state li zhichuan et al 2014 compared the calculation results of four different time step in view of the vertical shaft turbine and find that the calculation results are independent to the time step when the impeller rotation angle is less than or equal to 3 therefore the time period during which the blade rotates 3 is adopted as the time step of the entire simulation in this paper 3 4 validation of the cfd method to confirm the accuracy of the numerical method applied in this paper the ansys cfx was used to simulate the classical vertical axis turbine experiment texas tech university united states strickland et al 1979 in that tunnel experiment the tangential and normal force coefficients of the blades were measured and the turbine used was similar to that used in this paper the diameter of the turbine was 1 22 m the chord length was 0 0914 m and the two blades had a naca symmetric airfoil profile naca0012 the same method used in this paper was adopted to simulate this two bladed vertical axis turbine model fig 5 compares the results solid lines from cfx the experimental results dotted lines and the results dashed lines from texas tech university s dynamic model strickland et al 1979 for a blade azimuth angle of between 270 and 450 the values from cfx and the dynamic model exhibited a goodness of fit and a larger difference with respect to the experimental results the texas tech university results indicate that the hump observed when the blades are rotating downstream of the disk at approximately 360 may be partially due to misalignment errors in the blade mounting therefore when the gap near blade azimuth angles of 360 is disregarded the comparison indicates satisfactory accuracy of the 2d cfx numerical method for vertical axis tidal current turbines 4 analysis of turbine loads during the rotation period of the turbine instantaneous loads are fluctuating periodically and the fluctuation frequency is related to the number of blades the variation loads of the turbine influence the structural strength and fatigue life of the blades so the forces of the turbine must be studied to ensure the safety of the turbine for a long working time the time varying curves of the four coefficients thrust lateral force turbine rotational moment and turbine yaw moment coefficients of the turbine operates under different conditions are shown in figss 6 9 the yawing moment coefficients in figss 6 9 are the torque to the same point the centre of the yaw the history curves of the four coefficients are fluctuating with the 2 times rotation frequency when the turbine is only rotating in a uniform current the maximum and minimum values are not changed so the envelopes of the maximum and minimum values are almost a straight line upper and lower envelope when the turbine is rotating with other motion surging motion yawing motion surging and yawing coupled motion the envelopes of the maximum and minimum values are no longer a straight line but are fluctuating with motion frequency and the turbine load oscillations can be divided into low frequency oscillations corresponding to the motion frequency and high frequency oscillations corresponding to the 2 times rotational frequency when the turbine operates with 3 dof coupled motion the history curves of the four coefficients are similar as when turbine rotates with surging motion so the impact of surging motion is bigger than yawing motion the changes of the turbine force can be expressed by the envelope of the maximum and minimum values of the forces so only the envelope of the maximum and minimum values of the forces is given in the following figures 4 1 co frequency coupled motion to study the hydrodynamic characteristics of a vertical axis turbine with 3 dof co frequency coupled motion we set the turbine rotation around the optimum rotational speed λ 2 5 the yawing amplitude is π 18 the surging amplitude is d 4 0 2 m and the inlet velocity is 1 m s we choose three different frequencies 0 6 rad s 1 0 rad s and 1 4 rad s to calculate and compare the result with the calculation values of the turbine with r y and r s coupled motion fig 10 shows the four coefficients thrust lateral force turbine rotational moment and turbine yawing moment coefficients comparison curve with time under different frequencies the numbers in the graphic legends represent frequencies with units of rad s 0 6 1 0 and 1 4 are the calculation results when the turbine with 3 dof coupled motion s0 6 s1 0 and s1 4 are the calculation results of the turbine with r s coupled motion and y0 6 y1 0 and y1 4 are the calculation results of the turbine with r y coupled motion as shown in fig 10 when the turbine with r s coupled motion the envelope curves of the four coefficients generate clear periodic fluctuations with the turbine surging the fluctuation frequency is consistent with the surging frequency and the fluctuation amplitude increases as the surging frequency increases when the turbine with r y coupled motion the envelope curves of the four coefficients also have fluctuations the fluctuation frequency is consistent with the yawing frequency the fluctuation amplitude increases with the yawing frequency but it is clearly less than the fluctuation amplitude when the turbine with r s coupled motion when the turbine with 3 dof coupled motion the envelope curves of the four coefficients has an obvious fluctuation the fluctuation frequency is consistent with the surging yawing frequency and the fluctuation amplitude increases with the frequency the calculation results of the thrust and turbine rotational moment coefficients are basically similar to the calculation results when the turbine with r s coupled motion the calculation value of the lateral force and turbine yaw moment coefficients are greater than the value when the turbine with r s coupled motion or r y coupled motion and the fluctuation amplitude increases with the frequency this means that surging motion has a more impact on the calculation results than the yawing motion during the process of rotation and co frequency surging and yawing coupled motion of the turbine the change rule of the hydrodynamic load is mainly caused by the surging motion 4 2 different frequency coupled motion to study the vertical axis turbine hydrodynamic characteristics when it with 3 dof coupled motion in different frequency the fixed tip speed ratio of the turbine is 2 5 the yawing amplitude is π 18 and the surging amplitude is d 4 choosing two different frequency combinations surging frequency of 0 6 rad s and yawing frequency of 1 4 rad s surging frequency of 1 4 rad s and yawing frequency of 0 6 rad s to calculate the envelope curves of the thrust coefficient lateral force coefficient turbine rotational moment coefficient and turbine yaw moment coefficient are shown in fig 11 in fig 11 the numbers in the graphic legends represent frequencies in units of rad s s0 6 y1 4 and s1 4 y0 6 are the calculation results of the turbine with 3 dof coupled motion s0 6 and s1 4 are the calculation results of the turbine with r s coupled motion and y0 6 and y1 4 are the calculation results of the turbine with r y coupled motion as shown in fig 11 for the thrust lateral force and turbine rotational moment coefficients when surging frequency is higher 1 4 rad s and the yawing frequency is lower 0 6 rad s the envelope curves of calculation results of the turbine with 3 dof and the calculation results of the turbine only with r s coupled motion are basically the same but when the surging frequency is lower 0 6 rad s and the yawing frequency is higher 1 4 rad s the envelope curves of calculation results have significantly different for the turbine yaw moment coefficient when the surging frequency is higher 1 4 rad s and the yawing frequency is lower 0 6 rad s the fluctuation amplitude of the envelope curves of calculation value of the turbine with 3 dof coupled motion is greater than that when it only with r s or with r y coupled motions and the fluctuation frequency is consistent with the surging frequency when the yawing frequency is higher 1 4 rad s and the surging frequency is lower 0 6 rad s the fluctuation frequency of the envelope curves is consistent with the yawing frequency hence when the turbine with 3 dof coupled motion the change rules of the hydrodynamic load are mainly caused by surging motion but when the yawing frequency is much higher than the surging frequency the effect of the yawing motion will be reflected 5 fitting analysis of hydrodynamic load 5 1 calculation formula of hydrodynamic loads in surging and yawing coupled motion the hydrodynamic load fitting formulas of the vertical axis turbine under the condition of rotation and single degree of freedom oscillation motion which is established in section 2 are employed in this part the calculation values of the four coefficients thrust lateral force turbine rotational moment and turbine yawing moment coefficients of the turbine with r s coupled motion or r y coupled motion consist of two parts one part is basically the same as the value when the turbine only with rotation motion the other part is periodically changes with surging motion or yawing motion hence to foreshadow hydrodynamic research on the vertical axis turbine generating more multi degree of freedom motion this paper studies the four coefficients of the turbine with 3 dof coupled motion and resolves them into three parts as follows 1 the calculation value with only rotation motion 2 the fluctuation value which is related to surging motion and 3 the fluctuation value which is related to the yawing motion the calculation value when the turbine with only rotation motion is easy to obtain the fluctuation value that is related to the surging motion can be calculated by eq 13 16 and the fluctuation value that is related to the yawing motion can be calculated by eq 19 22 the four coefficients calculation formulas of the turbine with 3 dof coupled motion can be obtained as follows 16 dimensionless surging frequency ω s ω s ω t 17 dimensionless surging amplitude a s a s d 18 dimensionless yawing frequency ω y ω y ω t 19 dimensionless surge velocity u s a s ω s u cos ω s t 20 dimensionless surge acceleration a s a s ω s r u 2 sin ω s t 21 dimensionless yaw angular speed u y a y ω y cos ω y t l y u 22 dimensionless yaw angular acceleration a y a y ω y sin ω y t l y u 2 thrust coefficient progression 23 c f x c f x u n f x s u s m f x s a s n f x y ω y m f x y a y c f x 0 k 1 c f x k sin k n θ ψ f x k n f x s 0 k 1 n f x s k sin k n θ ψ f x s u k u s m f x s 0 k 1 m f x s k sin k n θ ψ f x s a k a s n f x y 0 k 1 n f x y k sin k n θ ψ f x y u k ω y m f x y 0 k 1 m f x y k sin k n θ ψ f x y a k a y lateral coefficient progression 24 c f y c f y u n f y s u s m f y s a s n f y y ω y m f y y a y c f y 0 k 1 c f y k sin k n θ ψ f y k n f y s 0 k 1 n f y s k sin k n θ ψ f y s u k u s m f y s 0 k 1 m f y s k sin k n θ ψ f y s a k a s n f y y 0 k 1 n f y y k sin k n θ ψ f y y u k ω y m f y y 0 k 1 m f y y k sin k n θ ψ f y y a k a y turbine rotational moment coefficient progression 25 c m r c m r u n m r s u s m m r s a s n m r y ω y m m r y a y c m r 0 k 1 c m r k sin k n θ ψ m r k n m r s 0 k 1 n m r s k sin k n θ ψ m r s u k u s m m r s 0 k 1 m m r s k sin k n θ ψ m r s a k a s n m r y 0 k 1 n m r y k sin k n θ ψ m r y u k ω y m m r y 0 k 1 m m r y k sin k n θ ψ m r y a k a y turbine yawing moment coefficient progression 26 c m y c m y u n m y s u s m m y s a s n m y y ω y m m y y a y c m y 0 k 1 c m y k sin k n θ ψ m y k n m y s 0 k 1 n m y s k sin k n θ ψ m y s u k u s m m y s 0 k 1 m m y s k sin k n θ ψ m y s a k a s n m y y 0 k 1 n m y y k sin k n θ ψ m y y u k ω y m m y y 0 k 1 m m y y k sin k n θ ψ m y y a k a y 5 2 fitting analysis of hydrodynamic loads in r s coupled motion based on the least squares method theory the cfd numerical simulation results of the turbine with r s coupled motion can be used to solve various coefficients associated with the surging motion of eq 23 26 ω y 0 a y 0 as shown in tables 3 6 the constant and first order terms are given in the tables the surging frequency is 0 means only rotation motion it can be seen from tables 2 5 that the values of the first three terms in different surging frequencies are basically the same as those when the turbine with only rotation motion according to the correlation coefficients of tables 3 6 the thrust lateral force turbine rotational moment and turbine yawing moment coefficients of the turbine with r s coupled motion can be obtained by eq 23 26 ω y 0 a y 0 to verify the accuracy of the fitting formula the four coefficients are calculated and compared with the cfd calculation value when the surging frequency is 1 0 rad s as shown in fig 12 cfd is the cfd calculation value in the figure and fitting is the calculation value by the fitting formula in fig 12 the cfd calculation value basically agrees with the calculation value by the fitting formula which verifies the accuracy of eqs 23 26 used in r s coupled motion 5 3 fitting analysis of the hydrodynamic loads in r y coupled motion based on the least squares method theory the cfd numerical simulation results of the turbine with r y coupled motion can be used to solve various coefficients associated with the yawing motion of eqs 23 26 ω s 0 a s 0 as shown in tables 3 6 the constant and first order terms are given in the tables the yawing frequency is 0 means no yaw motion occurs it can be seen from tables 6 9 that the values of the first three terms in different yawing frequencies are basically the same as those when the turbine with only rotation motion according to the correlation coefficients of tables 7 10 the thrust coefficient lateral force coefficient turbine rotational moment coefficient and turbine yawing moment coefficient when the turbine with r y coupled motion can be obtained by eqs 23 26 ω s 0 a s 0 to verify the accuracy of the fitting formula the four coefficients are calculated and compared with the cfd calculation value when the yawing frequency is 1 0 rad s as shown in fig 13 cfd is the cfd calculation value in the figure and fitting is the calculation value by the fitting formula in fig 13 the cfd calculation value basically agrees with the calculation value by the fitting formula which verifies the accuracy of eqs 23 26 used in r y coupled motion 5 4 validation of the calculation formula of hydrodynamic loads in 3 dof coupled motion according to the fitting coefficient table and eqs 23 26 we can calculate the four coefficients of the turbine with 3 dof coupled motion additionally to verify the accuracy of the calculation formulas we calculate the four coefficients and compare them with the cfd calculation values as shown in fig 14 cfd means cfd calculation value and cal means the calculation value of the calculation formula it can be seen from fig 14 that the cfd calculation values are basically the same as the values of the calculation formula which verifies the accuracy of the calculation formula hence when forecasting the hydrodynamic load of the vertical axis turbine under multi degree motion we can first calculate the hydrodynamic load of the turbine with rotation and the single freedom degree among multi degree of freedom motion and then obtain the coefficient table by eq 8 according to the hydrodynamic load time varying curves finally the approximate value of the hydrodynamic load when the turbine generates multi degree of freedom motion can be obtained by the calculation formulas such as 23 26 to further verify the accuracy of the method we will calculate the hydrodynamic load of the turbine with more multi degree of freedom motion 6 conclusion the cfd method is used to analyse the hydrodynamic characteristics of a vertical axis turbine with 3 dof coupled motion under uniform flow and the results are compared with the hydrodynamic loads of the turbine with r s coupled motion r y coupled motion the results demonstrate the following 1 when the turbine with surging and yawing co frequency coupled motion the envelope curves of the thrust lateral force turbine rotational moment and turbine yawing moment coefficients will be time fluctuating with the fluctuation frequency in accordance with the surging frequency and the fluctuation amplitude increasing with the surging frequency this will affect the structure safety and the fatigue life of the turbine so the design of the structure should be paid attention 2 when the turbine with surging and yawing different frequency coupled motion the change regulation of the hydrodynamic load is mainly caused by the surging motion however when the yawing frequency is much higher than the surging frequency the effect of the yawing motion will be reflected in other words the envelope curves of hydrodynamic load not only have a fluctuation based on the surging frequency but also include a fluctuation based on the yawing frequency 3 the calculation formulas of the thrust lateral force turbine rotational moment and turbine yawing moment coefficients have been obtained when the turbine generates multiple degree of freedom coupled motion and the accuracy of the formula has been verified they can benefit research on the hydrodynamic load when the turbine generates multi degree freedom motion acknowledgement this work was supported by the national science foundation no 51709137 no 51579120 u1706227 it is also supported by the natural science foundation of heilongjiang grant no e2015048 the natural science foundation of jiangsu no bk20161103 
23484,the moving particle semi implicit mps method is a type of meshless lagrangian calculation technique that uses particles to perform calculations instead of meshes this method is straightforward and has a high computational efficiency in this paper a lagrangian model for the numerical simulation of fluid structure interaction problems is proposed in the proposed method both the fluid and the structure are described by the mps the fluid is fully coupled with the solid that can undergo large structural deformations in practical engineering many existing fluid problems involve turbulent flows the large eddy simulation les method is a major means of studying turbulence the modified mps method with the les method is applied in two dimensional dam break problems which validates the use of the mps method for solving fluid structure coupled problems with turbulent flows by taking the meshless advantage of the mps method a preliminary simulation of the plate break problem is carried out and the simulation results are theoretically verified keywords moving particle semi implicit method mps fluid structure interaction fsi large eddy simulation les meshless 1 introduction the coupled fluid structure problem is common in the field of naval architecture and ocean engineering in computational structural mechanics the numerical method which is a type of finite element method is the most widely used in practice however in the study of computational fluid dynamics the finite difference method or finite volume method is primarily adopted therefore both types of numerical methods are required for fluid structure interactions in addition to the coupling between the two methods while conducting a fluid structure coupling analysis the discontinuous interface between the fluid and the solid grid must be taken into account to handle time varying discontinuous interfaces the grid method is generally performed by restructuring the grid in each time step of the calculation to guarantee the consistency of the grid lines with the interface after the deformation for the calculations along the grid the main strategy for accurate calculations is to reconstruct the grid in each position step to ensure that the grid lines are still consistent with the deformation of the interface aside from these numerical difficulties there is decreasing accuracy from grid reconstruction and if there are too many mesh deformations resulting in grid distortion the computation may terminate with a series of particle points instead of a grid structure the fluid solid domain can be represented by lagrangian particles in the meshless method each particle carries a respective physical quantity such as mass velocity and acceleration and those particles interact with each other through the weight function as a result the particles play the role of element or numerical grids in the process free from constraints of a computational grid and completely eliminating the necessity of grid reconstruction are just a few of the advantages of the meshless method in dealing with the discontinuity problems of the fluid solid coupling interface smoothed particle hydrodynamics sph is a fully lagrangian particle method sph is one of the world s earliest true meshless methods which has had significant influence on the follow up meshless methods the sph was originally introduced by gingold gingold and monaghan 1977 and lucy 1977 to simulate astrophysical phenomena currently the sph method is being used in many areas such as multi phase flows monaghan and kocharyan 1995 incompressible flows morris et al 1997 and flow through porous media zhu and fox 2001 the sph method also has been used to simulate problems involved with fluid structure interaction fsi amini et al 2011 the sph method is primarily used for compressible flow calculations for incompressible flow an additional processing is needed to force it to be artificially compressible in the sph method physical quantities are explicitly calculated although the explicit calculation is simple it is difficult to obtain the correct pressure values and the time step is limited by the speed of sound which leads to low computing efficiency however in the mps method which is a new lagrangian particle method and was first proposed in 1996 by koshizuka s and oka y koshizuka et al 1995 koshizuka and oka 1996 models incompressible flows the pressure is implicitly calculated whereas the viscous force and the body force are calculated explicitly this semi implicit algorithm can allow the mps method to accept a larger time step in order to reduce the number of calculations after its initial appearance the mps has been extensively used in various applications and has been widely applied in several research fields for example gotoh gotoh and sakai 1999 simulated wave propagation with the mps method in practical engineering problems many of the problems considering flowing fluids are turbulent flow and the large eddy simulation les method is a major technique for research on turbulence with respect to the ordinary governing equation sub particle scale sps models are added into the les gotoh et al 2001 first developed the static smagorinsky model for the mps method then a similar sps model was adopted in the sph method gingold and monaghan 1977 chikazawa et al 2001 to simulate various types of complex surface flow such as the solitary wave running on a slope by lo and shao 2002 and the wave breaking flow by shao and gotoh 2005 gotoh and sakai 2006 also simulated the multi phase wave flow by the mps method coupled with an sps model pan xujie pan et al 2008 pan and zhang 2008a 2008b researched the primary problems with the mps method he developed a new technique of free surface recognition sun et al sun et al 2015 uses the mps method to simulate the 2d fluid structure interaction problem under laminar flow rao et al robortella et al 2009 simulated the solitary wave interacting with an elastic structure by the mps fem coupled method hwang et al hwang et al 2016 uses the mps method to simulate the sloshing flows in rolling tanks with elastic baffles from the above results it can be seen that the mps method is widely used in the calculation of fluid structure coupling problems however because the method is proposed for a short time the algorithm itself still has some defects the processing of the interface of fluid structure coupling is so complex that it always leads to calculation failure secondly considering mps method is a full lagrangian meshless particle method it always happens that fluid particles cross solid boundary which will affect the precision of numerical calculation in this paper some shortcomings of this method are pointed out and corresponding improvements are made in the algorithm the innovations of this paper are as follow firstly this paper use a bran new calculating procedure to simulate the calculation of fsi problems the calculation process is mainly divided into two steps first the velocity and displacement of all particles fluid particles and solid particles are calculated using a fluid control equation second the velocity and displacement of solid particles are corrected by using the governing equations of elasticity after that the calculation will go into the next cycle the biggest advantage of this method is that it is not necessary to do special processing for the interface in fsi it can simplify the calculation program and improve the calculation efficiency secondly an additional correction procedure to prevent fluid particles from passing through solid boundary is added thirdly in order to make the numerical simulation more close to the actual engineering situation the mps les method coupled with the sub particle scale sps model was applied to simulate the elastic fluid structure coupling calculation mps if and mps vf and mps les are used to simulate the fluid solid coupling of dam break in three different flow states and the results are analyzed and compared fourth mps is a new method of numerical computation which is rarely used in the study of structural damage at present this paper took the meshless advantage of the mps method to do a preliminary simulation of the plate break problem and the simulation results are theoretically verified 2 mps method 2 1 governing equations of the fluid the mps method uses the continuity equation and the navier stokes equations as the governing equations for incompressible flows koshizuka et al 1995 1 u 0 2 d u d t 1 ρ p ν 2 u f in eqs 1 and 2 ρ is the density of the fluid t is the time u is the velocity vector p is the pressure and f is the body forces to combine the mps method with the les we need to introduce the sps reynolds stress into the mps method 3 u m x m 0 4 d u l d t 1 ρ p x l ν 2 u l x m 2 f l x m u l u m in which m is the spatial orientation the parameter with the signifies it is the dominant component of the original parameter u m is the particle scale ps component of u m u m is the sps turbulence component of u m and l is the other spatial orientation in eq 4 the reynolds stress term is determined to be the turbulence effect which is different from eq 2 and the reynolds stress term is always described by the smagorinsky eddy viscosity model as follows 5 u l u m ν t u l x m u m x l 2 3 k δ l m in which ν t is the kinematic eddy viscosity 6 ν t c s δ 2 u l x m u l x m u m x l 1 2 where δ is the initial distance between the particles and c s is a constant value between 0 1 and 0 2 that should satisfy the equation 7 c s 2 c v 3 2 c ε 1 2 in this paper the simulations are considered in the 2d case so the partial differential of the reynolds stress term in eq 4 can be written as follows 8 f s p s x x 2 ν t u x 2 3 k y ν t u y v x 9 f s p s y x ν t u y v x y 2 ν t v y 2 3 k in which f s p s x and f s p s y are the x and y directional component of the partial differential of the reynolds stress term in the 2d simulation the kinematic eddy viscosity can be written as follows 10 ν t c s δ 2 p r 1 2 where the p r in eq 10 is 11 p r 2 u x 2 2 v y 2 u y v x 2 and the k in eq 8 and eq 9 is 12 k c v c ε δ 2 p r the c ε and c v in eq 7 and eq 12 are both constants according to eq 7 the values of c ε c v and c s can be 13 c ε 1 00 14 c v 0 08 15 c s 0 15 finally the governing equations are formulated in the following form 16 u m x m 0 17 d u l d t 1 ρ p x l ν 2 u l x m 2 f l f s p s x f s p s y in the mps method particle interactions are evaluated using a weight function such as 18 w r r e r 1 0 r e r 0 r e r where r is distance between particles and re is the effective radius the particle number density is defined as follows 19 n i j i w r i r j the particle number density is the sum of the weight functions of a particle i that interacts with other particles within some range of particle i the vectors r i and r j are the coordinates of the particles i and j the mps uses the gradient model and the laplacian model to replace the terms of the governing equation which are represented in the following form 20 f i d n 0 j i f i f j r j r i 2 r j r i w r j r i 21 2 f i 2 d λ n 0 j i f j f i w r j r i where d is the spatial dimension and n 0 is the initial particle number density the λ in eq 21 can be acquired as follows 22 λ j i w r j r i r j r i 2 w r j r i the continuity equation of the governing equation requires that the density of the fluid should be constant the mps method keeps n 0 is a constant so that the fluid remains incompressibility in the simulation if the number density n is not equal to n 0 it must be implicitly corrected to n 0 by 23 n n n 0 where n is the correction value related to the velocity correction value u their relations are designated as follows 24 1 δ t n n 0 u where δ t is the increment in time and the velocity correction value can be derived from the implicit pressure gradient 25 u δ t ρ p n 1 the poisson pressure equation is obtained as follows 26 2 p n 1 ρ δ t 2 n i n 0 n 0 the poisson pressure equation can be solved with the incomplete cholesky conjugate gradient method iccg the differential terms of the reynolds stress should be processed with the boundary condition and the body force the iterative formula is written as 27 δ u ν 2 u n f f s p s δ t in which δ u is the first explicit correction value of the velocity u n is the velocity of the last time step f is the body force f s p s is as defined in eq 8 and eq 9 and δ t is the time increment the estimation of velocity u and the coordinate position r are explicitly calculated by 28 u i u i n δ u i 29 r i r i n δ u i δ t the number density for each particle n i is obtained by eq 19 and used in the pressure poisson equation eq 26 the correction velocities are calculated using the pressure of each particle in the next step by 30 u i δ t ρ p i n 1 with the correction velocities obtaining the new velocities u i n 1 and coordinates r i n 1 of the next step of the simulation is accomplished using 31 u n 1 u i u i 32 r n 1 r i u i δ t 2 2 governing equations of the elastomer the control equation of elastomer is as follows chikazawa et al 2001 33 ρ d v α d t x β λ ε r r δ α β 2 μ ε α β 34 ε α β 1 2 u α x β u β x α 35 λ e υ 1 υ 1 2 υ 36 μ e 2 1 υ where ρ is the material density v α is the velocity of the elastomer u is the displacement vector the subscript α and β means the spatial coordinates ε α β is the strain rate tensor the diagonal terms of ε α β represent elongation and contraction per unit length in the various coordinate directions and sometimes called linear strain rates the off diagonal terms of ε α β represents shear deformations that change the relative orientation of line segments initially parallel to coordinate directions the trace ε r r specifies the rate of the volume change per unit volume δ α β is the kronecker operator λ and μ is the lame constant e is young modulus and υ poisson s ratio 37 u i j r i j r r i j 0 38 r cos θ i j sin θ i j sin θ i j cos θ i j 39 θ i j θ i θ j 2 before the calculation the relative position between particle i and j is r i j 0 and the relative position becomes r i j during the calculation the θ i and θ j are the rotation angles to particle i and j r is the rotational determinant and u i j is the variation of the relative positions between the particles 40 σ i j 2 μ ε i j n 2 μ u i j r i j r i j r i j 0 r i j 2 41 τ i j 2 μ ε i j s 2 μ u i j r i j 0 σ i j 42 p λ ε r r i λ d n 0 j i u i j r i j r i j 0 r i j w r i j 0 where σ i j and τ i j are the normal stress and shear stress of particle i and j and p is an isotropic pressure which is obtained at the particle locations which are described by the respective formula 40 41 and 42 in eq 42 d is the number of the space dimensions in the model the acceleration produced by the force between particles is 43 v i t n 2 d ρ i n 0 j i σ i j r i j 0 w r i j 0 44 v i t s 2 d ρ i n 0 j i τ i j r i j 0 w r i j 0 45 v i t p d ρ i n 0 j i p i p j r i j r i j 0 r i j w r i j 0 where v i t s is the shear acceleration v i t n is the normal acceleration and v i t p is the acceleration produced by the pressure the interaction between particles i and j would cause the particles to rotate and the magnitude of the rotation force could be described as follows 46 f i j m i v i j t s 2 m i d ρ i n 0 j i τ i j r i j 0 w r i j 0 the rotating angular acceleration of the particles could be described as follows 47 ω i t 1 2 i i j i r i j f i j where i i is the moment of inertia of particle i updating of the particle angular speed rotation angle translational speed and coordinate position is described as follows 48 ω i n 1 ω i n δ t ω i t n 49 θ i n 1 θ i n δ t ω i n 1 50 v i n 1 v i n δ t v i t n 51 r i n 1 r i n δ t v i n 1 2 3 surface detection the mps method uses the variation of particle density to identify free surfaces as shown in equation 52 52 l 0 in this equation n i is the number density of the particle i at a certain time and the mps theory recommends that l 0 0 001 m choose a number between 0 8 and 0 99 in mps simulations when the particles are on the free surface the neighbors are few so the number density is also low which can be conveniently identified as free surfaces see fig 1 2 4 numerical simulation process the process of the mps les method is adopted to address the fluid structure coupling problem to begin the calculation the properties of the solid particles are ignored and they are treated as fluid particles both the speed and the position of the solid particles are modified in accordance with the elastomer control equation the specific simulation process is shown in fig 2 in the calculation if the fluid particles are too close to the solid particles r i j 0 25 l 0 2 l 0 is the spacing of particles an additional corrections is used to keep a right distance between the fluid particles and the solid particles and at the same time the velocity of the particles is also properly corrected considering that correcting the velocity of the particle too much may affect the calculation the correction value takes the sum of the difference in velocity between the particle and its neighbors in practice this method achieved good results see fig 3 3 results of numerical simulation 3 1 calculation condition dam breaking with elastic structure is the classic case for fluid structure interaction problems there are certain important phenomena with large deformation of free surfaces such as curling and breaking in the process of dam breaking large deformations of the elastic structure are produced under the fluid impact traditional mesh methods have encountered great difficulties in these fluid structure interaction problems with large deformation the mps is a fully lagrangian particle method which can avoid the deterioration of the accuracy due to the mesh distortion caused by large deformations in fluid structure interaction problems and is very convenient to handle the interface between different phases therefore the mps is particularly suitable for fluid structure interaction problems with large deformations the dam breaking model is shown in fig 4 the width and height of the initial water column are 0 2 m and 0 4m respectively a gate is set beside the water column and the dam break flow is formed when the gate is removed the elastic plate is located at x 0 6 m the plate used in this study has a thickness of 0 004 m and a height of 0 1 m the plate elastic modulus is set as 3 2 106pa poisson s ratio as 0 3 and a density of 1 16 times that of water the dam break model was converted to the particle model the results are shown in fig 4 in which the particle spacing is l 0 0 001 m r e 2 1 l 0 and the time step takes 0 00004s in this simulation one markers m 0 088 m are set on the plate for tracking the structural deformation as illustrated in fig 5 3 2 comparison between experimental results and numerical simulation results the mps is applied to compute the position of the leading edges both for the ideal flow and turbulent flow the time history of the leading edges is shown in fig 6 where the mps if stands for the mps ideal flow exp stands for experiments and mps vf represents mps viscous laminar flow the numerical results compared with experimental results walhorn et al 2005 all of the numerical results are in reasonable agreement with only slight differences between them and the experimental results the ideal fluid has not been considered to be viscous thus it collapses faster however in the les models the turbulence is modeled and takes the eddy viscosity into account in addition to the fluid viscosity hence the calculation result with the les model is more closely related to that of the experiment results the time and distance in the figure is non dimensional x x l t t 2 g l the les of dam breakingfluid structure coupling calculation results are shown in fig 7 very large deformation appears at the free water surface in the dam breaking process especially after the flow impacts the elastic plate next the free surface experiences curling and breaking and that plate develops a large deformation under the impact the results of this interaction model will be compared with those of kang ping liao liao et al 2015 the mps les can accurately model the splash created by the free surface impact the curling shape the wrapped air cavitation of the splash entering the water the large deformation of the plastic plate and the oscillations in the plate with time moreover from the shape of the free surface and the deformation of the plate it can be observed that the improved mps method based on the les method can capture the main features of the phenomenon that were observed in experiment comparisons of the displacement in the x direction at markers m between the experimental data liao et al 2015 and the numerical result is shown in fig 8 the figure displays the maximum displacement when the water flow jet passes the plate plate top and is fully attached to the left side of the elastic structure the impact of the water flow causes the elastic structure to start oscillating this oscillation is damped by the water flow located to the left and right of the elastic structure by comparing the results of ideal fluid viscous laminar flow and large eddy simulation it can be seen that the agreement for the results between the mps les and the experiment are very good convergence has always been an important problem in numerical calculations because it shows the quality of the solution this section will analyze the convergence of the mps les method based on the time step where the time step satisfies the cfl condition 53 u max δ t l 0 0 2 where u max is the maximum velocity of the field which is generally estimated to be in the form u max 2 g h for when the dam breaks different time steps are adopted to calculate to solution in order to verify the influence of the time step on the calculation results the time step is set as 2e 5s case 1 3e 5s case 2 and 4e 5s case 3 the displacement curve of the m point in the x direction is shown in fig 9 it is observed that different time steps have little effect on the results of the mps les showing that those results remain remarkable consistent the results of three other simulations corresponding to initial particle spacings of l 0 0 0005 case 1 l 0 0 001 case 2 and l 0 0 002 case 3 are also shown to check the convergence it can be seen from fig 10 that the particle spacing has no great influence on the calculation results and the results of the three cases are almost the same so the numerical results of this method are stable and reliable natural frequency of the first mode is about 3 48hz liao et al 2015 the mps les result of a typical test case is shown in fig 11 which presents the frequency analysis of the structural vibration the plate increases to its positive maximum value rapidly due to the large impacting force in this stage first mode of vibration is mainly excited the excited frequency is 2 91hz it is smaller than the natural frequency due to the added mass effect fig 12 shows the pressure at the m point on the plate it can be observed from the figure that the pressure at the point has a significant oscillation this problem occurs mainly due to the mps algorithm itself and these reasons include random selection of the weight function the free surface of the determination and the particle motion in view of this pressure oscillation phenomenon sueyoshi sueyoshi et al 2008 utilized the area time average technique based on the principle of pressure sensors in the experiment to reduce the pressure oscillation this paper refers to this method to correct the pressure observed in the simulations an interval of 0 005s is chosen for the time average which corresponds to 125 time steps in the simulations of this paper the area average for the particle with index i for the pressure output only averages over itself and two closest particles with index of i 1 and i 1 as shown in eq 54 54 pi 1 pi pi 1 3 the curve after pressure correction is shown in fig 13 and the pressure oscillation is observed to be within the acceptable range see fig 14 fig 13 is a graph of the pressure through the elastic body after the correction during the impacting process there is a clear spike at approximately 0 25s the spike appears when the water just arrived at the point the flow produces significant instantaneous dynamic pressure intensity on the surface with the interactions between the plate particles and the particles of the fluid when the velocity of the fluid particles decreases the instantaneous dynamic pressure on the plate decreases dramatically as the simulation proceeds to 0 3s fluctuations in the static pressures appear these pressures are related to the height from the surface to the point m1 and the peaking data are smaller than the instantaneous dynamic pressure peak at 0 25s 3 3 simulation for damaging the plate using the mps les method the weight function w r is the basis of all other mps les models and represents the force function of the particles with their neighbors the value of the weight function is determined by the distance between the particles the numerical modeling considered when where δ is the calculated deformation between adjacent particles and the weight function w r 0 as the condition for the rupture of the elastic structure the simulation is performed considering only the damage of the plate based on the theoretical method and no consideration is taken on the plastic deformation stage dam break model is shown below the initial water column length and width were 0 292m 0 146m the elastic plate is located at x 0 3 m the plate used in this study has a thickness of 0 008 m and a height of 0 1 m poisson s ratio as 0 3 and a density of 2 5 times that of water the particle spacing l 0 0 002 m the failure of plate simulated by mps method is verified according to the reference cao et al 2009 similar to the cantilever plate the first damage occurs at the fixed end of the plate under the impact of water flow the location of the damage point x 0 is calculated according to the following formula when l 1 2 2 h b x 0 0 13 l 1 l 1 is the height of the fixed end and h b is the thickness of the plate this paper sets the bottom of the particle a fixed end and the height 0 002 by calculations the plates first break down at the bottom and the last second particles from the figs 15 and 16 the result of numerical simulation of damage locations are consistent with the theoretical results so the numerical simulation result is authentic fig 15 indicates that when e 1e6 pa the bottom of the elastic baffle is damaged and the baffle integrity collapses fig 16 indicates that when e 5e5 pa not only is the bottom of the elastic baffle damaged but the central region is also damaged due to the excessive deformation with the decrease in the elastic modulus the damage of the elastic plate will become more intense traditional numerical methods always fail when dealing with this type of damage problems due to excessive deformation at the grid compared to the traditional mesh method the mps les method is more efficient in calculating these damage problems because of its particle based nature 4 conclusions in this paper the fluid structure interaction of dam break model is simulated using a new calculation process based on moving particle semi implicit method with large eddy simulation the improved mps method does not need to distinguish the solid coupling interface greatly simplifying the calculation process in order to prevent the particles from crossing which may cause the calculation terminating the fluid particles and the solid particles are kept at an appropriate distance by additional correction in the calculation process this method avoids particles crossing and ensures that numerical calculations can be carried out successfully based on the sps stress and the smagorinsky eddy viscosity model this paper realized the large eddy simulation of mps method by comparing the calculation results of ideal fluid viscous laminar flow and large eddy simulation it can be seen that the results of the mps les simulation are closest to the experimental results since the mps les method is a lagrange algorithm the mps les method has a great advantage in calculating structural damage in this paper mps les method is used to make a preliminary simulation of the structure break and theoretical verification of the simulation results is carried out the correctness of the numerical simulation results is proved from the above conclusions it can be seen that the mps les method has a very broad prospect in the calculation of fluid structure coupling and structural damage funding this research is supported by the national natural science foundation of china grant number 51479116 and 11272213 
23484,the moving particle semi implicit mps method is a type of meshless lagrangian calculation technique that uses particles to perform calculations instead of meshes this method is straightforward and has a high computational efficiency in this paper a lagrangian model for the numerical simulation of fluid structure interaction problems is proposed in the proposed method both the fluid and the structure are described by the mps the fluid is fully coupled with the solid that can undergo large structural deformations in practical engineering many existing fluid problems involve turbulent flows the large eddy simulation les method is a major means of studying turbulence the modified mps method with the les method is applied in two dimensional dam break problems which validates the use of the mps method for solving fluid structure coupled problems with turbulent flows by taking the meshless advantage of the mps method a preliminary simulation of the plate break problem is carried out and the simulation results are theoretically verified keywords moving particle semi implicit method mps fluid structure interaction fsi large eddy simulation les meshless 1 introduction the coupled fluid structure problem is common in the field of naval architecture and ocean engineering in computational structural mechanics the numerical method which is a type of finite element method is the most widely used in practice however in the study of computational fluid dynamics the finite difference method or finite volume method is primarily adopted therefore both types of numerical methods are required for fluid structure interactions in addition to the coupling between the two methods while conducting a fluid structure coupling analysis the discontinuous interface between the fluid and the solid grid must be taken into account to handle time varying discontinuous interfaces the grid method is generally performed by restructuring the grid in each time step of the calculation to guarantee the consistency of the grid lines with the interface after the deformation for the calculations along the grid the main strategy for accurate calculations is to reconstruct the grid in each position step to ensure that the grid lines are still consistent with the deformation of the interface aside from these numerical difficulties there is decreasing accuracy from grid reconstruction and if there are too many mesh deformations resulting in grid distortion the computation may terminate with a series of particle points instead of a grid structure the fluid solid domain can be represented by lagrangian particles in the meshless method each particle carries a respective physical quantity such as mass velocity and acceleration and those particles interact with each other through the weight function as a result the particles play the role of element or numerical grids in the process free from constraints of a computational grid and completely eliminating the necessity of grid reconstruction are just a few of the advantages of the meshless method in dealing with the discontinuity problems of the fluid solid coupling interface smoothed particle hydrodynamics sph is a fully lagrangian particle method sph is one of the world s earliest true meshless methods which has had significant influence on the follow up meshless methods the sph was originally introduced by gingold gingold and monaghan 1977 and lucy 1977 to simulate astrophysical phenomena currently the sph method is being used in many areas such as multi phase flows monaghan and kocharyan 1995 incompressible flows morris et al 1997 and flow through porous media zhu and fox 2001 the sph method also has been used to simulate problems involved with fluid structure interaction fsi amini et al 2011 the sph method is primarily used for compressible flow calculations for incompressible flow an additional processing is needed to force it to be artificially compressible in the sph method physical quantities are explicitly calculated although the explicit calculation is simple it is difficult to obtain the correct pressure values and the time step is limited by the speed of sound which leads to low computing efficiency however in the mps method which is a new lagrangian particle method and was first proposed in 1996 by koshizuka s and oka y koshizuka et al 1995 koshizuka and oka 1996 models incompressible flows the pressure is implicitly calculated whereas the viscous force and the body force are calculated explicitly this semi implicit algorithm can allow the mps method to accept a larger time step in order to reduce the number of calculations after its initial appearance the mps has been extensively used in various applications and has been widely applied in several research fields for example gotoh gotoh and sakai 1999 simulated wave propagation with the mps method in practical engineering problems many of the problems considering flowing fluids are turbulent flow and the large eddy simulation les method is a major technique for research on turbulence with respect to the ordinary governing equation sub particle scale sps models are added into the les gotoh et al 2001 first developed the static smagorinsky model for the mps method then a similar sps model was adopted in the sph method gingold and monaghan 1977 chikazawa et al 2001 to simulate various types of complex surface flow such as the solitary wave running on a slope by lo and shao 2002 and the wave breaking flow by shao and gotoh 2005 gotoh and sakai 2006 also simulated the multi phase wave flow by the mps method coupled with an sps model pan xujie pan et al 2008 pan and zhang 2008a 2008b researched the primary problems with the mps method he developed a new technique of free surface recognition sun et al sun et al 2015 uses the mps method to simulate the 2d fluid structure interaction problem under laminar flow rao et al robortella et al 2009 simulated the solitary wave interacting with an elastic structure by the mps fem coupled method hwang et al hwang et al 2016 uses the mps method to simulate the sloshing flows in rolling tanks with elastic baffles from the above results it can be seen that the mps method is widely used in the calculation of fluid structure coupling problems however because the method is proposed for a short time the algorithm itself still has some defects the processing of the interface of fluid structure coupling is so complex that it always leads to calculation failure secondly considering mps method is a full lagrangian meshless particle method it always happens that fluid particles cross solid boundary which will affect the precision of numerical calculation in this paper some shortcomings of this method are pointed out and corresponding improvements are made in the algorithm the innovations of this paper are as follow firstly this paper use a bran new calculating procedure to simulate the calculation of fsi problems the calculation process is mainly divided into two steps first the velocity and displacement of all particles fluid particles and solid particles are calculated using a fluid control equation second the velocity and displacement of solid particles are corrected by using the governing equations of elasticity after that the calculation will go into the next cycle the biggest advantage of this method is that it is not necessary to do special processing for the interface in fsi it can simplify the calculation program and improve the calculation efficiency secondly an additional correction procedure to prevent fluid particles from passing through solid boundary is added thirdly in order to make the numerical simulation more close to the actual engineering situation the mps les method coupled with the sub particle scale sps model was applied to simulate the elastic fluid structure coupling calculation mps if and mps vf and mps les are used to simulate the fluid solid coupling of dam break in three different flow states and the results are analyzed and compared fourth mps is a new method of numerical computation which is rarely used in the study of structural damage at present this paper took the meshless advantage of the mps method to do a preliminary simulation of the plate break problem and the simulation results are theoretically verified 2 mps method 2 1 governing equations of the fluid the mps method uses the continuity equation and the navier stokes equations as the governing equations for incompressible flows koshizuka et al 1995 1 u 0 2 d u d t 1 ρ p ν 2 u f in eqs 1 and 2 ρ is the density of the fluid t is the time u is the velocity vector p is the pressure and f is the body forces to combine the mps method with the les we need to introduce the sps reynolds stress into the mps method 3 u m x m 0 4 d u l d t 1 ρ p x l ν 2 u l x m 2 f l x m u l u m in which m is the spatial orientation the parameter with the signifies it is the dominant component of the original parameter u m is the particle scale ps component of u m u m is the sps turbulence component of u m and l is the other spatial orientation in eq 4 the reynolds stress term is determined to be the turbulence effect which is different from eq 2 and the reynolds stress term is always described by the smagorinsky eddy viscosity model as follows 5 u l u m ν t u l x m u m x l 2 3 k δ l m in which ν t is the kinematic eddy viscosity 6 ν t c s δ 2 u l x m u l x m u m x l 1 2 where δ is the initial distance between the particles and c s is a constant value between 0 1 and 0 2 that should satisfy the equation 7 c s 2 c v 3 2 c ε 1 2 in this paper the simulations are considered in the 2d case so the partial differential of the reynolds stress term in eq 4 can be written as follows 8 f s p s x x 2 ν t u x 2 3 k y ν t u y v x 9 f s p s y x ν t u y v x y 2 ν t v y 2 3 k in which f s p s x and f s p s y are the x and y directional component of the partial differential of the reynolds stress term in the 2d simulation the kinematic eddy viscosity can be written as follows 10 ν t c s δ 2 p r 1 2 where the p r in eq 10 is 11 p r 2 u x 2 2 v y 2 u y v x 2 and the k in eq 8 and eq 9 is 12 k c v c ε δ 2 p r the c ε and c v in eq 7 and eq 12 are both constants according to eq 7 the values of c ε c v and c s can be 13 c ε 1 00 14 c v 0 08 15 c s 0 15 finally the governing equations are formulated in the following form 16 u m x m 0 17 d u l d t 1 ρ p x l ν 2 u l x m 2 f l f s p s x f s p s y in the mps method particle interactions are evaluated using a weight function such as 18 w r r e r 1 0 r e r 0 r e r where r is distance between particles and re is the effective radius the particle number density is defined as follows 19 n i j i w r i r j the particle number density is the sum of the weight functions of a particle i that interacts with other particles within some range of particle i the vectors r i and r j are the coordinates of the particles i and j the mps uses the gradient model and the laplacian model to replace the terms of the governing equation which are represented in the following form 20 f i d n 0 j i f i f j r j r i 2 r j r i w r j r i 21 2 f i 2 d λ n 0 j i f j f i w r j r i where d is the spatial dimension and n 0 is the initial particle number density the λ in eq 21 can be acquired as follows 22 λ j i w r j r i r j r i 2 w r j r i the continuity equation of the governing equation requires that the density of the fluid should be constant the mps method keeps n 0 is a constant so that the fluid remains incompressibility in the simulation if the number density n is not equal to n 0 it must be implicitly corrected to n 0 by 23 n n n 0 where n is the correction value related to the velocity correction value u their relations are designated as follows 24 1 δ t n n 0 u where δ t is the increment in time and the velocity correction value can be derived from the implicit pressure gradient 25 u δ t ρ p n 1 the poisson pressure equation is obtained as follows 26 2 p n 1 ρ δ t 2 n i n 0 n 0 the poisson pressure equation can be solved with the incomplete cholesky conjugate gradient method iccg the differential terms of the reynolds stress should be processed with the boundary condition and the body force the iterative formula is written as 27 δ u ν 2 u n f f s p s δ t in which δ u is the first explicit correction value of the velocity u n is the velocity of the last time step f is the body force f s p s is as defined in eq 8 and eq 9 and δ t is the time increment the estimation of velocity u and the coordinate position r are explicitly calculated by 28 u i u i n δ u i 29 r i r i n δ u i δ t the number density for each particle n i is obtained by eq 19 and used in the pressure poisson equation eq 26 the correction velocities are calculated using the pressure of each particle in the next step by 30 u i δ t ρ p i n 1 with the correction velocities obtaining the new velocities u i n 1 and coordinates r i n 1 of the next step of the simulation is accomplished using 31 u n 1 u i u i 32 r n 1 r i u i δ t 2 2 governing equations of the elastomer the control equation of elastomer is as follows chikazawa et al 2001 33 ρ d v α d t x β λ ε r r δ α β 2 μ ε α β 34 ε α β 1 2 u α x β u β x α 35 λ e υ 1 υ 1 2 υ 36 μ e 2 1 υ where ρ is the material density v α is the velocity of the elastomer u is the displacement vector the subscript α and β means the spatial coordinates ε α β is the strain rate tensor the diagonal terms of ε α β represent elongation and contraction per unit length in the various coordinate directions and sometimes called linear strain rates the off diagonal terms of ε α β represents shear deformations that change the relative orientation of line segments initially parallel to coordinate directions the trace ε r r specifies the rate of the volume change per unit volume δ α β is the kronecker operator λ and μ is the lame constant e is young modulus and υ poisson s ratio 37 u i j r i j r r i j 0 38 r cos θ i j sin θ i j sin θ i j cos θ i j 39 θ i j θ i θ j 2 before the calculation the relative position between particle i and j is r i j 0 and the relative position becomes r i j during the calculation the θ i and θ j are the rotation angles to particle i and j r is the rotational determinant and u i j is the variation of the relative positions between the particles 40 σ i j 2 μ ε i j n 2 μ u i j r i j r i j r i j 0 r i j 2 41 τ i j 2 μ ε i j s 2 μ u i j r i j 0 σ i j 42 p λ ε r r i λ d n 0 j i u i j r i j r i j 0 r i j w r i j 0 where σ i j and τ i j are the normal stress and shear stress of particle i and j and p is an isotropic pressure which is obtained at the particle locations which are described by the respective formula 40 41 and 42 in eq 42 d is the number of the space dimensions in the model the acceleration produced by the force between particles is 43 v i t n 2 d ρ i n 0 j i σ i j r i j 0 w r i j 0 44 v i t s 2 d ρ i n 0 j i τ i j r i j 0 w r i j 0 45 v i t p d ρ i n 0 j i p i p j r i j r i j 0 r i j w r i j 0 where v i t s is the shear acceleration v i t n is the normal acceleration and v i t p is the acceleration produced by the pressure the interaction between particles i and j would cause the particles to rotate and the magnitude of the rotation force could be described as follows 46 f i j m i v i j t s 2 m i d ρ i n 0 j i τ i j r i j 0 w r i j 0 the rotating angular acceleration of the particles could be described as follows 47 ω i t 1 2 i i j i r i j f i j where i i is the moment of inertia of particle i updating of the particle angular speed rotation angle translational speed and coordinate position is described as follows 48 ω i n 1 ω i n δ t ω i t n 49 θ i n 1 θ i n δ t ω i n 1 50 v i n 1 v i n δ t v i t n 51 r i n 1 r i n δ t v i n 1 2 3 surface detection the mps method uses the variation of particle density to identify free surfaces as shown in equation 52 52 l 0 in this equation n i is the number density of the particle i at a certain time and the mps theory recommends that l 0 0 001 m choose a number between 0 8 and 0 99 in mps simulations when the particles are on the free surface the neighbors are few so the number density is also low which can be conveniently identified as free surfaces see fig 1 2 4 numerical simulation process the process of the mps les method is adopted to address the fluid structure coupling problem to begin the calculation the properties of the solid particles are ignored and they are treated as fluid particles both the speed and the position of the solid particles are modified in accordance with the elastomer control equation the specific simulation process is shown in fig 2 in the calculation if the fluid particles are too close to the solid particles r i j 0 25 l 0 2 l 0 is the spacing of particles an additional corrections is used to keep a right distance between the fluid particles and the solid particles and at the same time the velocity of the particles is also properly corrected considering that correcting the velocity of the particle too much may affect the calculation the correction value takes the sum of the difference in velocity between the particle and its neighbors in practice this method achieved good results see fig 3 3 results of numerical simulation 3 1 calculation condition dam breaking with elastic structure is the classic case for fluid structure interaction problems there are certain important phenomena with large deformation of free surfaces such as curling and breaking in the process of dam breaking large deformations of the elastic structure are produced under the fluid impact traditional mesh methods have encountered great difficulties in these fluid structure interaction problems with large deformation the mps is a fully lagrangian particle method which can avoid the deterioration of the accuracy due to the mesh distortion caused by large deformations in fluid structure interaction problems and is very convenient to handle the interface between different phases therefore the mps is particularly suitable for fluid structure interaction problems with large deformations the dam breaking model is shown in fig 4 the width and height of the initial water column are 0 2 m and 0 4m respectively a gate is set beside the water column and the dam break flow is formed when the gate is removed the elastic plate is located at x 0 6 m the plate used in this study has a thickness of 0 004 m and a height of 0 1 m the plate elastic modulus is set as 3 2 106pa poisson s ratio as 0 3 and a density of 1 16 times that of water the dam break model was converted to the particle model the results are shown in fig 4 in which the particle spacing is l 0 0 001 m r e 2 1 l 0 and the time step takes 0 00004s in this simulation one markers m 0 088 m are set on the plate for tracking the structural deformation as illustrated in fig 5 3 2 comparison between experimental results and numerical simulation results the mps is applied to compute the position of the leading edges both for the ideal flow and turbulent flow the time history of the leading edges is shown in fig 6 where the mps if stands for the mps ideal flow exp stands for experiments and mps vf represents mps viscous laminar flow the numerical results compared with experimental results walhorn et al 2005 all of the numerical results are in reasonable agreement with only slight differences between them and the experimental results the ideal fluid has not been considered to be viscous thus it collapses faster however in the les models the turbulence is modeled and takes the eddy viscosity into account in addition to the fluid viscosity hence the calculation result with the les model is more closely related to that of the experiment results the time and distance in the figure is non dimensional x x l t t 2 g l the les of dam breakingfluid structure coupling calculation results are shown in fig 7 very large deformation appears at the free water surface in the dam breaking process especially after the flow impacts the elastic plate next the free surface experiences curling and breaking and that plate develops a large deformation under the impact the results of this interaction model will be compared with those of kang ping liao liao et al 2015 the mps les can accurately model the splash created by the free surface impact the curling shape the wrapped air cavitation of the splash entering the water the large deformation of the plastic plate and the oscillations in the plate with time moreover from the shape of the free surface and the deformation of the plate it can be observed that the improved mps method based on the les method can capture the main features of the phenomenon that were observed in experiment comparisons of the displacement in the x direction at markers m between the experimental data liao et al 2015 and the numerical result is shown in fig 8 the figure displays the maximum displacement when the water flow jet passes the plate plate top and is fully attached to the left side of the elastic structure the impact of the water flow causes the elastic structure to start oscillating this oscillation is damped by the water flow located to the left and right of the elastic structure by comparing the results of ideal fluid viscous laminar flow and large eddy simulation it can be seen that the agreement for the results between the mps les and the experiment are very good convergence has always been an important problem in numerical calculations because it shows the quality of the solution this section will analyze the convergence of the mps les method based on the time step where the time step satisfies the cfl condition 53 u max δ t l 0 0 2 where u max is the maximum velocity of the field which is generally estimated to be in the form u max 2 g h for when the dam breaks different time steps are adopted to calculate to solution in order to verify the influence of the time step on the calculation results the time step is set as 2e 5s case 1 3e 5s case 2 and 4e 5s case 3 the displacement curve of the m point in the x direction is shown in fig 9 it is observed that different time steps have little effect on the results of the mps les showing that those results remain remarkable consistent the results of three other simulations corresponding to initial particle spacings of l 0 0 0005 case 1 l 0 0 001 case 2 and l 0 0 002 case 3 are also shown to check the convergence it can be seen from fig 10 that the particle spacing has no great influence on the calculation results and the results of the three cases are almost the same so the numerical results of this method are stable and reliable natural frequency of the first mode is about 3 48hz liao et al 2015 the mps les result of a typical test case is shown in fig 11 which presents the frequency analysis of the structural vibration the plate increases to its positive maximum value rapidly due to the large impacting force in this stage first mode of vibration is mainly excited the excited frequency is 2 91hz it is smaller than the natural frequency due to the added mass effect fig 12 shows the pressure at the m point on the plate it can be observed from the figure that the pressure at the point has a significant oscillation this problem occurs mainly due to the mps algorithm itself and these reasons include random selection of the weight function the free surface of the determination and the particle motion in view of this pressure oscillation phenomenon sueyoshi sueyoshi et al 2008 utilized the area time average technique based on the principle of pressure sensors in the experiment to reduce the pressure oscillation this paper refers to this method to correct the pressure observed in the simulations an interval of 0 005s is chosen for the time average which corresponds to 125 time steps in the simulations of this paper the area average for the particle with index i for the pressure output only averages over itself and two closest particles with index of i 1 and i 1 as shown in eq 54 54 pi 1 pi pi 1 3 the curve after pressure correction is shown in fig 13 and the pressure oscillation is observed to be within the acceptable range see fig 14 fig 13 is a graph of the pressure through the elastic body after the correction during the impacting process there is a clear spike at approximately 0 25s the spike appears when the water just arrived at the point the flow produces significant instantaneous dynamic pressure intensity on the surface with the interactions between the plate particles and the particles of the fluid when the velocity of the fluid particles decreases the instantaneous dynamic pressure on the plate decreases dramatically as the simulation proceeds to 0 3s fluctuations in the static pressures appear these pressures are related to the height from the surface to the point m1 and the peaking data are smaller than the instantaneous dynamic pressure peak at 0 25s 3 3 simulation for damaging the plate using the mps les method the weight function w r is the basis of all other mps les models and represents the force function of the particles with their neighbors the value of the weight function is determined by the distance between the particles the numerical modeling considered when where δ is the calculated deformation between adjacent particles and the weight function w r 0 as the condition for the rupture of the elastic structure the simulation is performed considering only the damage of the plate based on the theoretical method and no consideration is taken on the plastic deformation stage dam break model is shown below the initial water column length and width were 0 292m 0 146m the elastic plate is located at x 0 3 m the plate used in this study has a thickness of 0 008 m and a height of 0 1 m poisson s ratio as 0 3 and a density of 2 5 times that of water the particle spacing l 0 0 002 m the failure of plate simulated by mps method is verified according to the reference cao et al 2009 similar to the cantilever plate the first damage occurs at the fixed end of the plate under the impact of water flow the location of the damage point x 0 is calculated according to the following formula when l 1 2 2 h b x 0 0 13 l 1 l 1 is the height of the fixed end and h b is the thickness of the plate this paper sets the bottom of the particle a fixed end and the height 0 002 by calculations the plates first break down at the bottom and the last second particles from the figs 15 and 16 the result of numerical simulation of damage locations are consistent with the theoretical results so the numerical simulation result is authentic fig 15 indicates that when e 1e6 pa the bottom of the elastic baffle is damaged and the baffle integrity collapses fig 16 indicates that when e 5e5 pa not only is the bottom of the elastic baffle damaged but the central region is also damaged due to the excessive deformation with the decrease in the elastic modulus the damage of the elastic plate will become more intense traditional numerical methods always fail when dealing with this type of damage problems due to excessive deformation at the grid compared to the traditional mesh method the mps les method is more efficient in calculating these damage problems because of its particle based nature 4 conclusions in this paper the fluid structure interaction of dam break model is simulated using a new calculation process based on moving particle semi implicit method with large eddy simulation the improved mps method does not need to distinguish the solid coupling interface greatly simplifying the calculation process in order to prevent the particles from crossing which may cause the calculation terminating the fluid particles and the solid particles are kept at an appropriate distance by additional correction in the calculation process this method avoids particles crossing and ensures that numerical calculations can be carried out successfully based on the sps stress and the smagorinsky eddy viscosity model this paper realized the large eddy simulation of mps method by comparing the calculation results of ideal fluid viscous laminar flow and large eddy simulation it can be seen that the results of the mps les simulation are closest to the experimental results since the mps les method is a lagrange algorithm the mps les method has a great advantage in calculating structural damage in this paper mps les method is used to make a preliminary simulation of the structure break and theoretical verification of the simulation results is carried out the correctness of the numerical simulation results is proved from the above conclusions it can be seen that the mps les method has a very broad prospect in the calculation of fluid structure coupling and structural damage funding this research is supported by the national natural science foundation of china grant number 51479116 and 11272213 
