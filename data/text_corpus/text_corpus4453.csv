index,text
22265,the hydrodynamic interactions between the vessel motion and resonant wave response inside the three dimensional moonpool are studied in the present paper in particular the shift of natural frequencies of a three dimensional moonpool in the fixed and free floating conditions is computed and examined systematically barges with different moonpool dimensions are analyzed to examine how the moonpool configurations affect the shift of resonant frequencies detailed analyses are performed for cases with and without recess numerical computations are performed for regular waves with wave headings θ 0 45 and 90 free surface elevations inside the moonpool with respect to the incident wave frequencies are computed for both fixed and free floating conditions it is observed that natural frequencies of the moonpool in the free floating condition are higher than those in the fixed condition for cases without recess the shift of resonant frequency is more prominent in piston mode resonance in particular for shallow or long moonpools in contrast for cases with a recess the shift of resonant frequency in the first sloshing mode is relatively larger than that in piston mode in addition the effects of motion raos on the free surface elevation inside the moonpool in the free floating condition are also examined it is found that the moonpool resonance can induce a local hump in heave and pitch responses moreover through deriving a modified frozen mode approximation model we reveal that comparing to the fixed condition the vessel motion in the free floating condition yields a reduction in the added mass due to the fluid underneath the moonpool so that the piston mode resonant frequency increases 1 introduction moonpools are vertical openings in a floating body frequently adopted in drilling ships for pipeline laying and in diving support vessels for launching of diving bells and other subsea equipments see faltinsen and timokha 2015 yoo et al 2017 resonant water motion occurs at the natural modes of the moonpool including piston mode where the water inside the moonpool heaves up and down and sloshing modes where the water inside the moonpool moves back and forth between the vertical walls since the resonant fluid motion may lead to significant impact on the hull structure or equipments on the deck it is necessary to accurately predict the resonant frequencies to assist the concept design of the floater and marine operation most of the previous studies on moonpools are based on conditions where the structure is either fixed in incident waves or oscillated harmonically in calm water under the assumption of infinite length and beam of a barge molin 2001 proposed a semi analytical model to predict the resonant frequencies and modal shapes of a three dimensional moonpool in infinite water depth by solving eigenvalue problems based on domain decomposition and galerkin method faltinsen et al 2007 developed a semi analytical method to compute the fluid motions in a two dimensional moonpool and performed experiments for comparison molin et al 2009 carried out model tests to study the gap resonances between two rectangular barges which were rigidly connected to a carriage free surface elevation derived from tests in irregular waves are compared with numerical solutions using a code based on linear potential flow theory zhao et al 2017 investigated the first and higher harmonic components of the resonant fluid response in the gap between two identical fixed rectangular boxes by performing experiments in a wave basin furthermore they made a prediction of amplitude of gap resonances at different gap widths by scaling the linear damping zhao et al 2018 zhang and bandyk 2013 2014 solved the radiation problem in a two layer fluid for rectangular bodies restricted to the upper layer fluid and the surface piercing rectangular bodies respectively xu et al 2019 studied the wave diffraction problem of two dimensional moonpools in a two layer fluid with finite fluid depth recently molin et al 2018 and zhang et al 2019 proposed new models to solve the three dimensional and two dimensional moonpool problems in finite water depth however as discussed in mciver 2005 the natural frequencies of a moonpool in the free floating condition can be different from the solutions computed as the structure is fixed called fixed condition in this paper or in harmonic oscillation conditions with a prescribed motion focusing on piston mode motion in the moonpool and rigid body motions fredriksen et al 2015 studied regular wave induced behavior of a two dimensional floating body with moonpool through experiments and hybrid numerical methods it was found that the piston mode frequency in diffraction problem is almost same as that in radiation but it is larger for the vessel in the free floating condition when exposing to incident waves guo et al 2016 2017 performed experiments for a recessed drillship moonpool and measured wave responses inside the moonpool molin 2017 extended the theoretical model in molin 2001 to compute the resonant frequencies for moonpools with a recess and compared the results with the measurements by guo the prediction of the natural frequencies agreed well with the experiment except for the first sloshing mode frequency newman 2018 investigated the resonant natural modes of the same type of vessel through wamit and used a domain decomposition method with legendre polynomials instead of fourier functions for computing the natural frequencies and added mass coefficients it was found that the shift of natural frequencies in the fixed and free floating condition are small or non existent for the particular hull and moonpool configuration however till now the mechanism of the shift of the natural frequencies and effect of moonpool configurations on the shift are still not well understood which are the motivations of the present study the present paper aims to explore how the moonpool dimensions affect the shift of moonpool resonant frequencies including piston and sloshing modes in the fixed and free floating conditions and understand the mechanism on the shift by building up a modified frozen mode approximation model with the body motion effects being accounted the present paper is organized as follows barges with different dimensions of moonpool are modelled in addition a modified frozen mode approximation model is developed to explain the physics on the shift of the frequencies by accounting for the body motion the radiation diffraction code wamit is employed to compute the free surface elevations inside moonpool in both fixed and free floating conditions and the six degree of freedom motion raos the effects of vessel motions on the moonpool resonances are discussed in detail 2 computational cases barge type vessels with or without recess in a moonpool are modelled with different dimensions the moonpool without recess is shown in fig 1 where the center of the moonpool coincides with that of the barge the origin of the body coordinates is placed at the center of the waterplane inside moonpool the global coordinates coincide with the body fixed coordinates when the vessel is in calm equilibrium the draft of vessel is denoted as d and the length and width are denoted as l and b respectively the moonpool length and width are denoted by l and b respectively the distance from the aft side of moonpool to the midship section is denoted as d two numerical wave probes are placed inside the moonpool to measure the free surface elevation as shown in fig 1 a two wave probes denoted by cp and np are placed inside the moonpool both cp and np are used to identify the piston and symmetric sloshing mode resonances but the anti symmetric sloshing modes can only be captured by the elevation at np inside the moonpool without recess as illustrated in table 1 five different sets of moonpool dimensions are chosen for the cases without recess model 1 is the base model model 2 and model 3 are used to study the effect of draft and model 4 and model 5 are adopted to study the effect of moonpool length to simplify the study the vcg and inertia of all the vessels without recess in moonpool are kept the same as listed in table 2 fig 2 illustrates the vessel with recessed moonpool the center of moonpool is located at 0 4 m behind the midship section of the barge the length and height of recess are denoted as r and h respectively as shown in table 3 five different combinations of dimension are presented model 6 shares the same size as the physical model in guo et al 2016 2017 for comparison compared with model 6 the length of recess is varied in models 7 and 8 and the recess height is varied in models 9 and 10 as shown in fig 2 a three numerical wave probes are placed inside the moonpool to measure the free surface elevations and capture the piston and sloshing mode resonances the wave probe fp is located at the forward end of the moonpool the wave probe cp is located at the center of moonpool and the wave probe ap is placed at the aft side of moonpool the coordinates of fp cp and ap are 21 4 m 0 m 0 m 0 m 0 m 0 m and 22 2 m 0 m 0 m respectively as listed in table 4 the vcg and inertia of all the vessels with a recess in moonpool are kept the same it should be noted that the water depth is assumed to be infinite in all the present cases the fixed condition can be considered as a purely wave diffraction problem while the free floating condition can be considered as a combination of the radiation and diffraction problems when it is in free floating condition the vessel is undergoing six degree of freedom motions in regular incident waves the incident wave amplitude is denoted as a the incident wave heading θ is defined as the angle between the positive x axis of the global coordinate system and the direction in which the incident wave propagates θ 0 45 and 90 are chosen in the present simulations the wave frequency ω is varied from 0 1 rad s to 1 4 rad s correspondingly the free surface elevation η at specific locations and motion raos are obtained as shown in fig 3 about 500 higher order panels are used to discretize the model without recess and 1000 panels for the recessed model the panel size is approximately 3 m in length for simplicity the mass density of these models are set as homogeneous the higher order panel option based on b splines and direct solver option are adopted in addition the irregular frequencies are avoided by adding meshes on the interior free surface which is also generated by wamit numerical convergence is assessed by repeating the computations for increasing number of panels as shown in fig 4 as can be seen the dotted line represents the free surface elevation inside the model discretized by 3 meter long panels and the accuracy is high enough to capture the sloshing mode frequency even in high frequency region 3 frozen mode approximation model with accounting for the body motion in molin 2017 the fluid inside the moonpool was assumed as a solid body or frozen restriction and the influence of the fluid underneath the moonpool was taken as added mass on the dynamic system thus the natural frequency of moonpool can be obtained by analyzing the free heave motion of the frozen restriction further by constraining the heave motion of barge in free floating condition using wamit the predicted piston mode resonant frequency is 0 735 rad s and is the same as that in fixed condition see the detailed results in subsection 4 1 which indicates that the shift of the piston mode is mainly attributed to the heave motion in free floating condition and the other horizontal modes have little effects on the shift therefore the natural frequency of the moonpool in the free floating condition can be qualitatively estimated by accounting for the vessel motion through modifying the body boundary condition the sketch of the present model and coordinate system is illustrated in fig 5 for simplicity we set l 1 l 2 and b 1 b 2 in this paper as shown the whole fluid domain is divided into two subdomains we denote the fluid domain inside the moonpool z d as subdomain i and take the external fluid domain z d as subdomain ii 3 1 two dimensional case to simplify the analyses the problem is treated in two dimensional but the key physics on the shift of the natural frequency should be the similar in the external fluid domain the velocity potential can be written as 1 ϕ e m 1 e m cosh α m z h d cosh α m h sin α m x l 2 where α m m π l 1 l l 2 m π l and m 1 2 are the integers in the present model the velocities at the opening of moonpool and the body motion velocity are different depending on the motion rao and phase shift the ratio of body motion velocity to the mean velocity at opening of the moonpool is denoted as μ by matching the vertical velocity at the common boundary l 2 x l 2 z d of subdomains i and ii we obtain 2 m 1 e m α m tanh α m h sin α m x l 2 1 l 2 x l 2 μ l 2 x l 2 and l 2 x l 2 by multiplying each side with sin α m x l 2 and integrating along x direction over l 2 l 2 we obtain 3 1 2 e m α m tanh α m h l l 2 l 2 μ sin α m x l 2 d x l 2 l 2 sin α m x l 2 d x l 2 l 2 μ sin α m x l 2 d x then the coefficients e m can be determined as 4 e m 2 cos α m l 1 cos α m l 1 l 1 μ μ 1 1 m α m 2 tanh α m h l thus the added mass due to the lower fluid domain z d is obtained as 5 m a l ρ 0 l ϕ e d x 2 ρ n 1 cos α m l 1 cos α m l 1 l 2 1 μ μ 1 1 m cos α m l 1 cos α m l 1 l α m 3 tanh α m h l the heave motion equation of the frozen restriction can be written as 6 ρ l d m a l z ρ g l z 0 thus the piston mode frequency can be estimated as follow 7 ω ρ g l ρ l d m a l 3 2 three dimensional case when the model is extended to three dimensional case the velocity potential in the external fluid domain can be written as 8 ϕ e x y z m 1 n 1 e m n cosh γ m n z d h cosh γ m n h sin α m x l 2 sin β n y b 2 where α m m π l 1 l l 2 β n n π b 1 b b 2 γ m n 2 α m 2 β n 2 and m n 1 2 are the integers by matching the vertical velocity on the common boundary l 2 x l 2 b 2 y b 2 z d of subdomains i and ii we obtain 9 m 1 n 1 e m n γ m n tanh γ m n h sin α m x l 2 sin β n y b 2 1 on s 1 μ on s 2 where s 1 represents the opening at z d and s 2 represents the hull bottom by multiplying each side of eqn 9 with sin α m x l 2 sin β n y b 2 and integrating along x direction over l 2 l 2 and along y direction over b 2 b 2 we obtain 10 1 4 e m n γ m n tanh γ m n h l b s 2 μ sin α m x l 2 sin β n y b 2 d x d y s 1 sin α m x l 2 sin β n y b 2 d x d y then the coefficients e m n can be determined as 11 e m n 4 γ m n tanh γ m n h l b μ 1 m 1 cos α m l 1 cos α m l 1 l cos α m l 1 l cos α m l 1 α m μ 1 n 1 cos β n b 1 cos β n b 1 b cos β n b 1 b cos β n b 1 β n and the added mass due to the lower fluid domain z d is obtained as 12 m a l ρ m 1 n 1 e m n tanh γ m n h cos α m l 2 l 2 cos α m l 2 l 2 α m cos β n b 2 b 2 cos β n b 2 b 2 β n thus the heave motion equation of the frozen restriction can be written as 13 ρ l b d m a l z ρ g l b z 0 then the piston mode frequency can be estimated by 14 ω ρ g l b ρ l b d m a l 4 numerical results the natural frequencies are obtained by searching for the local maxima in the rao of free surface elevation inside the moonpool the first local maximum corresponds to the piston mode and the others are associated with sloshing mode resonances it should be noted that the present study focuses on longitudinal sloshing modes which are more important in the practical application 4 1 moonpool without recess fig 6 illustrates the free surface elevation with respect to the wave frequency at cp and np in different wave directions for model 1 as shown in fig 6 the amplitude of piston mode in free floating condition is larger than those in fixed condition for wave headings θ 0 and 45 but it is smaller in free floating condition for θ 90 we check the phase angles of the heave motion of the barge and observe that the phase of heave motion rao around the piston mode in θ 90 is almost 180 out of phase with those in θ 0 and 45 this may lead to larger cross coupling damping on the wave motion inside the moonpool in free floating condition for θ 90 and further induces less resonant wave motion around the piston mode resonance since vortex shedding at the corner of moonpool is neglected the obtained wave amplitude may be overestimated however the present paper focuses on the shift of resonant frequency which may not be affected significantly by the vortex shedding induced damping see faltinsen et al 2007 three local maxima in the free surface elevation corresponding to three natural frequencies can be found in either fixed or free floating conditions the piston mode frequency in the fixed and free floating conditions are 0 735 rad s and 0 76 rad s respectively the shift is around 3 40 the first sloshing mode frequency in the fixed condition is 0 913 rad s while that in the free floating is about 0 923 rad s with the shift being 1 10 the second sloshing mode frequency is the same 1 18 rad s in both conditions fig 7 presents the heave pitch and roll motion raos denoted by x 3 x 5 and x 4 respectively in different wave directions for model 1 as shown in the figure there is a local maximum at 0 76 rad s in heave rao which corresponds to the piston mode frequency in the free floating condition this suggests that the piston mode resonance can affect heave rao which is similar to the conclusions for a two dimensional moonpool in fredriksen et al 2015 in addition it is observed that there is a local maximum at 0 923 rad s in pitch which corresponds to the first sloshing mode inside moonpool however the local maximum corresponding to the second sloshing mode does not appear in heave rao this may be attributed to the fact that the free surface elevation around the second sloshing mode is too small to affect the heave motion furthermore there are two local maxima around 0 66 rad s in fig 7 a and 0 645 rad s in c which correspond to the heave natural frequencies in θ 0 and 90 respectively both the heave natural frequencies are smaller than the piston mode frequency the difference of natural periods in the two incident directions may be attributed to the fact that the water motion inside moonpool induces negative added mass for the vessel but its magnitude relies on the amplitude of water motion which differs in the two wave headings fig 7 f shows the roll motion rao in θ 90 with additional linear damping being 5 of the critical damping compared with model 1 the draft in model 2 is reduced from 11 m to 4 m fig 8 gives the free surface elevation at cp and np in different wave directions for model 2 again three resonant frequencies are found for both fixed and free floating conditions the piston mode frequency in the fixed and free floating conditions are 0 943 rad s and 1 002 rad s respectively the shift is around 6 26 the first sloshing mode frequency in the fixed condition is 1 090 rad s while that in the free floating condition is 1 097 rad s with the shift being 0 64 the second sloshing mode occurs at 1 283 rad s while that in the free floating condition is 1 285 rad s and lead to a shift being only 0 16 compared with the natural frequencies in model 1 piston mode frequency turns to be larger on account of the decrease of the draft which is consistent with the conclusions in zhang et al 2019 further due to shallower draft the shift of piston mode frequency in model 2 tends to be larger than that in model 1 while the shifts in sloshing mode frequencies are both very small in models 1 and 2 the draft of model 3 is increased to 20 m and fig 9 shows the free surface elevation three resonant frequencies are found for both fixed and free floating conditions as expected the piston mode frequency in the fixed and free floating conditions are 0 598 rad s and 0 613 rad s respectively the shift is 2 51 which is smaller than those in model 1 and model 2 the first sloshing mode frequency in the fixed condition is 0 848 rad s while that in the free floating condition is 0 858 rad s with the shift being 1 18 the second sloshing mode frequencies are the same in both fixed and free floating conditions 1 175 rad s the shifts in piston mode of models 1 2 and 3 are listed in table 5 as the draft decreases the shift in piston mode frequencies increases compared with model 1 the moonpool length in model 4 is reduced to 20 m fig 10 illustrates the free surface elevation and only two resonant frequencies are found for the short moonpool the piston mode frequency in the fixed condition is at 0 765 rad s while that in the free floating condition is at 0 778 rad s the shift is 1 70 which is smaller than that in model 1 the first sloshing mode frequency in the fixed and free floating conditions are 1 255 rad s and 1 260 rad s respectively with the shift being 0 40 the shifts of the sloshing resonant frequencies are both very small in models 1 and 4 in model 5 the moonpool length is increased to 60 m and fig 11 shows the free surface elevation four resonant frequencies are found for fixed and free floating conditions respectively the piston mode frequency in the fixed condition is 0 728 rad s while that in the free floating condition is at 0 760 rad s the shift is 4 40 larger than those in model 1 and model 4 the first sloshing mode frequency in the fixed and free floating conditions occur at 0 850 rad s and 0 858 rad s respectively with the shift being 0 94 the frequencies of the second sloshing mode in both fixed and free floating condition are 1 048 rad s the shifts in piston mode of models 1 4 and 5 are listed in table 6 and are shown to increase with the growth of moonpool length for moonpool without recess the piston mode frequency in the fixed condition is smaller than that in the free floating condition in order to better understand this phenomenon the modified frozen mode approximation proposed in section 3 is adopted for further analyses first fig 12 shows the phase difference between the barge motion and motion of the frozen restriction inside the moonpool as shown in the figure the motion of the frozen restriction and barge are almost 180 out of phase phase shift close to π around the piston mode frequency this means that the velocity ratio μ should be negative fig 13 illustrates the added mass due to the lower fluid with respect to μ in three dimensional cases the added mass is non dimensionalized by m a l 0 when the body is fixed i e μ 0 as can be seen as μ is negative the added mass due to the lower fluid is smaller than that in the fixed condition μ 0 which can induce larger piston mode frequency based on the frozen mode approximation model given in eqn 14 hence the physics on the shift of the piston mode frequency is clarified in fact the added mass with respect to μ in the two dimensional case shows a similar trend which can be adopted to explain the shift shown in fig 5 in fredriksen et al 2015 further it can also help us to understand why the magnitude of shift in shallow draft is relatively larger since the real mass in frozen restriction model is less while the reduction in the added mass from the lower fluid is almost the same it should be noted that although μ may varies at different draft the effect of the mass inside the moonpool is dominant 4 2 moonpool with a recess for moonpool with a recess the present results are compared with those given in molin 2017 and guo et al 2016 which studied a similar problem by eigenfunction matching method and model test respectively model 6 has the same moonpool dimension with that by molin 2017 fig 14 illustrates the variation of the free surface elevations at fp cp and ap it should be noted that the present coordinate system is different from that in guo et al 2016 where wave heading 180 is equivalent to 0 in the present study as can be seen the resonant frequencies in the fixed condition are almost the same as that in the free floating condition for the piston mode the second sloshing mode and the third sloshing mode respectively however there is some difference between the resonant frequencies of the first sloshing mode it should be noted that case studied by molin can be considered as in the fixed condition while the measurements in guo et al 2016 can be considered as in the free floating condition as shown the present results are in excellent agreement with that in molin 2017 and guo et al 2016 except that the predicted first sloshing mode frequency in the fixed condition is still slightly larger than that by molin in order to find out the reason we run an additional case with the same dimension as model 6 except for a larger beam which is the same as the barge length l b fig 15 illustrates the comparison of the free surface elevation raos between the two models at the same wave probe cp as shown the obtained first sloshing mode resonant frequency using square barge model is around 0 78 rad s which is almost same as the solution by molin 2017 it suggests that the beam of the barge can substantially affect the first longitudinal sloshing mode frequency moreover it can be clarified and confirmed that difference between molin s solution and results from wamit in the fixed condition can be attributed to assumption on infinite beam and length in that paper more detailed results are illustrated in fig 16 the resonant frequencies of piston mode in both fixed and free floating conditions are 0 415 rad s the first sloshing mode frequency in the fixed and free floating conditions are 0 803 rad s and 0 820 rad s respectively with the shift being about 2 18 the second sloshing mode frequency in the fixed condition is 1 075 rad s while that in the free floating condition is 1 077 rad s the shift is 0 19 much less than that of the first sloshing mode resonance fig 17 illustrates the heave pitch and roll motion raos in different wave directions for model 6 there is a local maximum at 0 415 rad s in heave motion which is the piston frequency in the free floating condition different from the cases without recess the local maximum at 0 820 rad s corresponding the first sloshing mode resonance in the free floating condition also occurs in the heave rao this implies that the first sloshing mode in the free floating condition has substantial effects on heave motion due to the recess in fact when the heave motion of barge is constrained in free floating condition using wamit the first sloshing mode resonant frequency is 0 805 rad s which is very close to that in fixed condition this indicates that the shift of the first sloshing mode resonant frequency for the present case with recess is mainly caused by the heave motion of the barge this may be because the hydrodynamic pressure along the longitudinal direction of the moonpool is not anti symmetric any more in the presence of a recess due to similar mechanism the pitch motion is also affected by the piston mode resonance in addition there are another two local maxima around 0 67 rad s in fig 17 a and 0 65 rad s in c which correspond to the heave natural frequencies in θ 0 and 90 respectively different from the cases without recess heave natural frequencies in both wave directions are higher than the piston mode frequency compared with model 6 the length of recess in model 7 is reduced to 8 m fig 18 gives the free surface elevation for model 9 as can be found in the plots the piston mode frequency in the fixed and free floating conditions are 0 593 rad s and 0 598 rad s respectively with the shift being 0 843 the first sloshing mode frequency in the fixed condition is 0 825 rad s while that in the free floating condition is 0 843 rad s with the shift being 2 12 the second sloshing mode frequency in the fixed condition is 1 11 rad s almost the same as that in the free floating condition in model 8 the length of recess is reduced to 4 m fig 19 illustrates the free surface elevation with respect to wave frequency for model 8 as can be seen the piston mode frequency in the fixed condition is at 0 690 rad s while that of free floating condition is 0 705 rad s the shift of the frequency is 2 17 the first sloshing mode frequency in the fixed condition is 0 863 rad s while that in the free floating condition is 0 875 rad s the shift of the frequency is 1 40 the resonant frequencies of the second sloshing mode in both fixed and free floating conditions are 1 14 rad s the shifts in the first sloshing mode for these three models are summarized in table 7 by comparing the shifts in these three models it can be concluded that the longer the recess length the larger the shift in the first sloshing mode frequencies in the fixed and free floating condition compared with model 6 the height of recess h is reduced to 5 m in model 9 fig 20 illustrates the free surface elevation with respect to wave frequency for model 9 the piston mode frequency in the fixed condition is 0 470 rad s while that in the free floating condition is 0 473 rad s the shift is 0 64 the first sloshing mode frequency in the fixed condition is 0 825 rad s while that in the free floating condition is 0 845 rad s the shift is 2 42 the natural frequencies of the second sloshing mode in both fixed and free floating conditions are 1 123 rad s in model 10 the height of recess is reduced to 3 m fig 21 illustrates the free surface elevation with respect to wave frequency for model 10 the piston mode frequency in the fixed condition is 0 508 rad s while that in the free floating condition is 0 510 rad s the shift is 0 39 the first sloshing mode frequency in the fixed condition is at 0 838 rad s while that in the free floating condition is 0 858 rad s the shift is 2 39 the natural frequencies of the second sloshing mode in both fixed and free floating conditions are 1 145 rad s the shifts in the first sloshing mode for these three models are summarized in table 8 as expected the shift of the first sloshing mode frequency is not sensitive to recess height 5 conclusions barges with different moonpool dimensions are modelled for wamit computations cases with and without recess are both adopted for analyses free surface elevations heave pitch motion and roll raos are computed in both fixed and free floating conditions the main objective of the present study is to explore how the moonpool dimensions affect the shift of the resonant frequencies in the fixed and free floating vessels and the relation between the moonpool resonances and vessel motion responses in the free floating condition the predicted natural frequencies and shifts in the fixed and free floating conditions of all models are summarized in table a 1 in appendix a by systematic computations and analyses it is observed that the natural frequencies of the moonpool in a free floating condition are higher than that in a fixed condition for both piston and longitudinal sloshing resonance modes in addition it is found that for vessel without recess in moonpool the shift of resonant frequency in the piston mode is larger than that in sloshing modes and the shift in the first sloshing mode is larger than that in the higher order sloshing modes for vessels with a recess the shift of frequency in piston mode is less than that in the first sloshing mode it is found that the shift can be affected by the draft of vessel for moonpool without recess as the draft is reduced the shift in piston mode increases as the length of moonpool increases the shift in piston mode resonance increases but the shift in sloshing modes is almost less than 1 moreover a modified frozen mode approximation is proposed to examine the effects of the body motion it is found body motion causes the reduction in the added mass from the fluid underneath the moonpool and yield an increase in the piston mode frequency moreover it is found the infinite beam assumption in molin s paper may lead to the underestimation of the first longitudinal sloshing mode resonant frequency for the model adopted in the experiments it is found that moonpool resonance can induce local hump in heave and pitch motion raos for vessels without recess in moonpool the resonances in the piston mode and the second sloshing mode have effects on the heave motion while the resonance in the first sloshing mode can only affect the pitch motion for vessels with recess in moonpool resonances in piston mode and the first sloshing mode have effects on both heave and pitch motions the water motion in a piston mode may yield antisymmetric hydrodynamic pressure along the longitudinal direction of the moonpool which leads to the local maximum in heave motion rao similarly the water motion in the first sloshing mode causes the local maximum in pitch motion rao it should be noted that damping due to flow separation is important near the resonant frequency which needs to be investigated in future study the present study is based on the potential flow theory and focuses on the natural frequency instead of response amplitude the nonlinear free surface effects and vortex shedding were not taken into consideration but should be studied in the future we believe the present study can offer offshore engineers some guidance or hints when they make decision on the moonpool configuration considering the difference in the natural frequencies between the fixed and free floating conditions acknowledgements special thanks to prof bernard molin and prof rodney eatock taylor for inspiring discussions and comments with one of the authors xinshu zhang during the iwwwfb 2019 moreover we feel very grateful to prof harry bingham for his help on using the wamit appendix a summary of the results for all cases table a 1 summary of all the cases on the shifts of the piston and the first sloshing mode frequencies in the fixed and free floating conditions table a 1 model no l m b m l m b m d m d m r m h m ω 0 f c ω 0 f f f 0 ω 1 f c ω 1 f f f 1 moonpool without recess 1 180 8 32 2 45 6 11 2 11 22 8 0 735 0 760 3 40 0 913 0 923 1 10 2 180 8 32 2 45 6 11 2 4 22 8 0 943 1 002 6 26 1 090 1 097 0 64 3 180 8 32 2 45 6 11 2 20 22 8 0 598 0 613 2 51 0 848 0 858 1 18 4 180 8 32 2 20 0 11 2 11 22 8 0 765 0 778 1 70 1 255 1 260 0 40 5 180 8 32 2 60 0 11 2 11 22 8 0 728 0 760 4 40 0 850 0 858 0 94 moonpool with a recess 6 180 8 32 2 45 6 11 2 11 22 4 16 0 7 2 0 415 0 415 0 00 0 8025 0 820 2 18 7 180 8 32 2 45 6 11 2 11 22 4 8 0 7 2 0 593 0 598 0 84 0 825 0 8425 2 12 8 180 8 32 2 45 6 11 2 11 22 4 4 0 7 2 0 690 0 705 2 17 0 863 0 875 1 40 9 180 8 32 2 45 6 11 2 11 22 4 16 0 5 0 0 470 0 473 0 53 0 825 0 845 2 42 10 180 8 32 2 45 6 11 2 11 22 4 16 0 3 0 0 508 0 510 0 49 0 838 0 858 2 39 
22265,the hydrodynamic interactions between the vessel motion and resonant wave response inside the three dimensional moonpool are studied in the present paper in particular the shift of natural frequencies of a three dimensional moonpool in the fixed and free floating conditions is computed and examined systematically barges with different moonpool dimensions are analyzed to examine how the moonpool configurations affect the shift of resonant frequencies detailed analyses are performed for cases with and without recess numerical computations are performed for regular waves with wave headings θ 0 45 and 90 free surface elevations inside the moonpool with respect to the incident wave frequencies are computed for both fixed and free floating conditions it is observed that natural frequencies of the moonpool in the free floating condition are higher than those in the fixed condition for cases without recess the shift of resonant frequency is more prominent in piston mode resonance in particular for shallow or long moonpools in contrast for cases with a recess the shift of resonant frequency in the first sloshing mode is relatively larger than that in piston mode in addition the effects of motion raos on the free surface elevation inside the moonpool in the free floating condition are also examined it is found that the moonpool resonance can induce a local hump in heave and pitch responses moreover through deriving a modified frozen mode approximation model we reveal that comparing to the fixed condition the vessel motion in the free floating condition yields a reduction in the added mass due to the fluid underneath the moonpool so that the piston mode resonant frequency increases 1 introduction moonpools are vertical openings in a floating body frequently adopted in drilling ships for pipeline laying and in diving support vessels for launching of diving bells and other subsea equipments see faltinsen and timokha 2015 yoo et al 2017 resonant water motion occurs at the natural modes of the moonpool including piston mode where the water inside the moonpool heaves up and down and sloshing modes where the water inside the moonpool moves back and forth between the vertical walls since the resonant fluid motion may lead to significant impact on the hull structure or equipments on the deck it is necessary to accurately predict the resonant frequencies to assist the concept design of the floater and marine operation most of the previous studies on moonpools are based on conditions where the structure is either fixed in incident waves or oscillated harmonically in calm water under the assumption of infinite length and beam of a barge molin 2001 proposed a semi analytical model to predict the resonant frequencies and modal shapes of a three dimensional moonpool in infinite water depth by solving eigenvalue problems based on domain decomposition and galerkin method faltinsen et al 2007 developed a semi analytical method to compute the fluid motions in a two dimensional moonpool and performed experiments for comparison molin et al 2009 carried out model tests to study the gap resonances between two rectangular barges which were rigidly connected to a carriage free surface elevation derived from tests in irregular waves are compared with numerical solutions using a code based on linear potential flow theory zhao et al 2017 investigated the first and higher harmonic components of the resonant fluid response in the gap between two identical fixed rectangular boxes by performing experiments in a wave basin furthermore they made a prediction of amplitude of gap resonances at different gap widths by scaling the linear damping zhao et al 2018 zhang and bandyk 2013 2014 solved the radiation problem in a two layer fluid for rectangular bodies restricted to the upper layer fluid and the surface piercing rectangular bodies respectively xu et al 2019 studied the wave diffraction problem of two dimensional moonpools in a two layer fluid with finite fluid depth recently molin et al 2018 and zhang et al 2019 proposed new models to solve the three dimensional and two dimensional moonpool problems in finite water depth however as discussed in mciver 2005 the natural frequencies of a moonpool in the free floating condition can be different from the solutions computed as the structure is fixed called fixed condition in this paper or in harmonic oscillation conditions with a prescribed motion focusing on piston mode motion in the moonpool and rigid body motions fredriksen et al 2015 studied regular wave induced behavior of a two dimensional floating body with moonpool through experiments and hybrid numerical methods it was found that the piston mode frequency in diffraction problem is almost same as that in radiation but it is larger for the vessel in the free floating condition when exposing to incident waves guo et al 2016 2017 performed experiments for a recessed drillship moonpool and measured wave responses inside the moonpool molin 2017 extended the theoretical model in molin 2001 to compute the resonant frequencies for moonpools with a recess and compared the results with the measurements by guo the prediction of the natural frequencies agreed well with the experiment except for the first sloshing mode frequency newman 2018 investigated the resonant natural modes of the same type of vessel through wamit and used a domain decomposition method with legendre polynomials instead of fourier functions for computing the natural frequencies and added mass coefficients it was found that the shift of natural frequencies in the fixed and free floating condition are small or non existent for the particular hull and moonpool configuration however till now the mechanism of the shift of the natural frequencies and effect of moonpool configurations on the shift are still not well understood which are the motivations of the present study the present paper aims to explore how the moonpool dimensions affect the shift of moonpool resonant frequencies including piston and sloshing modes in the fixed and free floating conditions and understand the mechanism on the shift by building up a modified frozen mode approximation model with the body motion effects being accounted the present paper is organized as follows barges with different dimensions of moonpool are modelled in addition a modified frozen mode approximation model is developed to explain the physics on the shift of the frequencies by accounting for the body motion the radiation diffraction code wamit is employed to compute the free surface elevations inside moonpool in both fixed and free floating conditions and the six degree of freedom motion raos the effects of vessel motions on the moonpool resonances are discussed in detail 2 computational cases barge type vessels with or without recess in a moonpool are modelled with different dimensions the moonpool without recess is shown in fig 1 where the center of the moonpool coincides with that of the barge the origin of the body coordinates is placed at the center of the waterplane inside moonpool the global coordinates coincide with the body fixed coordinates when the vessel is in calm equilibrium the draft of vessel is denoted as d and the length and width are denoted as l and b respectively the moonpool length and width are denoted by l and b respectively the distance from the aft side of moonpool to the midship section is denoted as d two numerical wave probes are placed inside the moonpool to measure the free surface elevation as shown in fig 1 a two wave probes denoted by cp and np are placed inside the moonpool both cp and np are used to identify the piston and symmetric sloshing mode resonances but the anti symmetric sloshing modes can only be captured by the elevation at np inside the moonpool without recess as illustrated in table 1 five different sets of moonpool dimensions are chosen for the cases without recess model 1 is the base model model 2 and model 3 are used to study the effect of draft and model 4 and model 5 are adopted to study the effect of moonpool length to simplify the study the vcg and inertia of all the vessels without recess in moonpool are kept the same as listed in table 2 fig 2 illustrates the vessel with recessed moonpool the center of moonpool is located at 0 4 m behind the midship section of the barge the length and height of recess are denoted as r and h respectively as shown in table 3 five different combinations of dimension are presented model 6 shares the same size as the physical model in guo et al 2016 2017 for comparison compared with model 6 the length of recess is varied in models 7 and 8 and the recess height is varied in models 9 and 10 as shown in fig 2 a three numerical wave probes are placed inside the moonpool to measure the free surface elevations and capture the piston and sloshing mode resonances the wave probe fp is located at the forward end of the moonpool the wave probe cp is located at the center of moonpool and the wave probe ap is placed at the aft side of moonpool the coordinates of fp cp and ap are 21 4 m 0 m 0 m 0 m 0 m 0 m and 22 2 m 0 m 0 m respectively as listed in table 4 the vcg and inertia of all the vessels with a recess in moonpool are kept the same it should be noted that the water depth is assumed to be infinite in all the present cases the fixed condition can be considered as a purely wave diffraction problem while the free floating condition can be considered as a combination of the radiation and diffraction problems when it is in free floating condition the vessel is undergoing six degree of freedom motions in regular incident waves the incident wave amplitude is denoted as a the incident wave heading θ is defined as the angle between the positive x axis of the global coordinate system and the direction in which the incident wave propagates θ 0 45 and 90 are chosen in the present simulations the wave frequency ω is varied from 0 1 rad s to 1 4 rad s correspondingly the free surface elevation η at specific locations and motion raos are obtained as shown in fig 3 about 500 higher order panels are used to discretize the model without recess and 1000 panels for the recessed model the panel size is approximately 3 m in length for simplicity the mass density of these models are set as homogeneous the higher order panel option based on b splines and direct solver option are adopted in addition the irregular frequencies are avoided by adding meshes on the interior free surface which is also generated by wamit numerical convergence is assessed by repeating the computations for increasing number of panels as shown in fig 4 as can be seen the dotted line represents the free surface elevation inside the model discretized by 3 meter long panels and the accuracy is high enough to capture the sloshing mode frequency even in high frequency region 3 frozen mode approximation model with accounting for the body motion in molin 2017 the fluid inside the moonpool was assumed as a solid body or frozen restriction and the influence of the fluid underneath the moonpool was taken as added mass on the dynamic system thus the natural frequency of moonpool can be obtained by analyzing the free heave motion of the frozen restriction further by constraining the heave motion of barge in free floating condition using wamit the predicted piston mode resonant frequency is 0 735 rad s and is the same as that in fixed condition see the detailed results in subsection 4 1 which indicates that the shift of the piston mode is mainly attributed to the heave motion in free floating condition and the other horizontal modes have little effects on the shift therefore the natural frequency of the moonpool in the free floating condition can be qualitatively estimated by accounting for the vessel motion through modifying the body boundary condition the sketch of the present model and coordinate system is illustrated in fig 5 for simplicity we set l 1 l 2 and b 1 b 2 in this paper as shown the whole fluid domain is divided into two subdomains we denote the fluid domain inside the moonpool z d as subdomain i and take the external fluid domain z d as subdomain ii 3 1 two dimensional case to simplify the analyses the problem is treated in two dimensional but the key physics on the shift of the natural frequency should be the similar in the external fluid domain the velocity potential can be written as 1 ϕ e m 1 e m cosh α m z h d cosh α m h sin α m x l 2 where α m m π l 1 l l 2 m π l and m 1 2 are the integers in the present model the velocities at the opening of moonpool and the body motion velocity are different depending on the motion rao and phase shift the ratio of body motion velocity to the mean velocity at opening of the moonpool is denoted as μ by matching the vertical velocity at the common boundary l 2 x l 2 z d of subdomains i and ii we obtain 2 m 1 e m α m tanh α m h sin α m x l 2 1 l 2 x l 2 μ l 2 x l 2 and l 2 x l 2 by multiplying each side with sin α m x l 2 and integrating along x direction over l 2 l 2 we obtain 3 1 2 e m α m tanh α m h l l 2 l 2 μ sin α m x l 2 d x l 2 l 2 sin α m x l 2 d x l 2 l 2 μ sin α m x l 2 d x then the coefficients e m can be determined as 4 e m 2 cos α m l 1 cos α m l 1 l 1 μ μ 1 1 m α m 2 tanh α m h l thus the added mass due to the lower fluid domain z d is obtained as 5 m a l ρ 0 l ϕ e d x 2 ρ n 1 cos α m l 1 cos α m l 1 l 2 1 μ μ 1 1 m cos α m l 1 cos α m l 1 l α m 3 tanh α m h l the heave motion equation of the frozen restriction can be written as 6 ρ l d m a l z ρ g l z 0 thus the piston mode frequency can be estimated as follow 7 ω ρ g l ρ l d m a l 3 2 three dimensional case when the model is extended to three dimensional case the velocity potential in the external fluid domain can be written as 8 ϕ e x y z m 1 n 1 e m n cosh γ m n z d h cosh γ m n h sin α m x l 2 sin β n y b 2 where α m m π l 1 l l 2 β n n π b 1 b b 2 γ m n 2 α m 2 β n 2 and m n 1 2 are the integers by matching the vertical velocity on the common boundary l 2 x l 2 b 2 y b 2 z d of subdomains i and ii we obtain 9 m 1 n 1 e m n γ m n tanh γ m n h sin α m x l 2 sin β n y b 2 1 on s 1 μ on s 2 where s 1 represents the opening at z d and s 2 represents the hull bottom by multiplying each side of eqn 9 with sin α m x l 2 sin β n y b 2 and integrating along x direction over l 2 l 2 and along y direction over b 2 b 2 we obtain 10 1 4 e m n γ m n tanh γ m n h l b s 2 μ sin α m x l 2 sin β n y b 2 d x d y s 1 sin α m x l 2 sin β n y b 2 d x d y then the coefficients e m n can be determined as 11 e m n 4 γ m n tanh γ m n h l b μ 1 m 1 cos α m l 1 cos α m l 1 l cos α m l 1 l cos α m l 1 α m μ 1 n 1 cos β n b 1 cos β n b 1 b cos β n b 1 b cos β n b 1 β n and the added mass due to the lower fluid domain z d is obtained as 12 m a l ρ m 1 n 1 e m n tanh γ m n h cos α m l 2 l 2 cos α m l 2 l 2 α m cos β n b 2 b 2 cos β n b 2 b 2 β n thus the heave motion equation of the frozen restriction can be written as 13 ρ l b d m a l z ρ g l b z 0 then the piston mode frequency can be estimated by 14 ω ρ g l b ρ l b d m a l 4 numerical results the natural frequencies are obtained by searching for the local maxima in the rao of free surface elevation inside the moonpool the first local maximum corresponds to the piston mode and the others are associated with sloshing mode resonances it should be noted that the present study focuses on longitudinal sloshing modes which are more important in the practical application 4 1 moonpool without recess fig 6 illustrates the free surface elevation with respect to the wave frequency at cp and np in different wave directions for model 1 as shown in fig 6 the amplitude of piston mode in free floating condition is larger than those in fixed condition for wave headings θ 0 and 45 but it is smaller in free floating condition for θ 90 we check the phase angles of the heave motion of the barge and observe that the phase of heave motion rao around the piston mode in θ 90 is almost 180 out of phase with those in θ 0 and 45 this may lead to larger cross coupling damping on the wave motion inside the moonpool in free floating condition for θ 90 and further induces less resonant wave motion around the piston mode resonance since vortex shedding at the corner of moonpool is neglected the obtained wave amplitude may be overestimated however the present paper focuses on the shift of resonant frequency which may not be affected significantly by the vortex shedding induced damping see faltinsen et al 2007 three local maxima in the free surface elevation corresponding to three natural frequencies can be found in either fixed or free floating conditions the piston mode frequency in the fixed and free floating conditions are 0 735 rad s and 0 76 rad s respectively the shift is around 3 40 the first sloshing mode frequency in the fixed condition is 0 913 rad s while that in the free floating is about 0 923 rad s with the shift being 1 10 the second sloshing mode frequency is the same 1 18 rad s in both conditions fig 7 presents the heave pitch and roll motion raos denoted by x 3 x 5 and x 4 respectively in different wave directions for model 1 as shown in the figure there is a local maximum at 0 76 rad s in heave rao which corresponds to the piston mode frequency in the free floating condition this suggests that the piston mode resonance can affect heave rao which is similar to the conclusions for a two dimensional moonpool in fredriksen et al 2015 in addition it is observed that there is a local maximum at 0 923 rad s in pitch which corresponds to the first sloshing mode inside moonpool however the local maximum corresponding to the second sloshing mode does not appear in heave rao this may be attributed to the fact that the free surface elevation around the second sloshing mode is too small to affect the heave motion furthermore there are two local maxima around 0 66 rad s in fig 7 a and 0 645 rad s in c which correspond to the heave natural frequencies in θ 0 and 90 respectively both the heave natural frequencies are smaller than the piston mode frequency the difference of natural periods in the two incident directions may be attributed to the fact that the water motion inside moonpool induces negative added mass for the vessel but its magnitude relies on the amplitude of water motion which differs in the two wave headings fig 7 f shows the roll motion rao in θ 90 with additional linear damping being 5 of the critical damping compared with model 1 the draft in model 2 is reduced from 11 m to 4 m fig 8 gives the free surface elevation at cp and np in different wave directions for model 2 again three resonant frequencies are found for both fixed and free floating conditions the piston mode frequency in the fixed and free floating conditions are 0 943 rad s and 1 002 rad s respectively the shift is around 6 26 the first sloshing mode frequency in the fixed condition is 1 090 rad s while that in the free floating condition is 1 097 rad s with the shift being 0 64 the second sloshing mode occurs at 1 283 rad s while that in the free floating condition is 1 285 rad s and lead to a shift being only 0 16 compared with the natural frequencies in model 1 piston mode frequency turns to be larger on account of the decrease of the draft which is consistent with the conclusions in zhang et al 2019 further due to shallower draft the shift of piston mode frequency in model 2 tends to be larger than that in model 1 while the shifts in sloshing mode frequencies are both very small in models 1 and 2 the draft of model 3 is increased to 20 m and fig 9 shows the free surface elevation three resonant frequencies are found for both fixed and free floating conditions as expected the piston mode frequency in the fixed and free floating conditions are 0 598 rad s and 0 613 rad s respectively the shift is 2 51 which is smaller than those in model 1 and model 2 the first sloshing mode frequency in the fixed condition is 0 848 rad s while that in the free floating condition is 0 858 rad s with the shift being 1 18 the second sloshing mode frequencies are the same in both fixed and free floating conditions 1 175 rad s the shifts in piston mode of models 1 2 and 3 are listed in table 5 as the draft decreases the shift in piston mode frequencies increases compared with model 1 the moonpool length in model 4 is reduced to 20 m fig 10 illustrates the free surface elevation and only two resonant frequencies are found for the short moonpool the piston mode frequency in the fixed condition is at 0 765 rad s while that in the free floating condition is at 0 778 rad s the shift is 1 70 which is smaller than that in model 1 the first sloshing mode frequency in the fixed and free floating conditions are 1 255 rad s and 1 260 rad s respectively with the shift being 0 40 the shifts of the sloshing resonant frequencies are both very small in models 1 and 4 in model 5 the moonpool length is increased to 60 m and fig 11 shows the free surface elevation four resonant frequencies are found for fixed and free floating conditions respectively the piston mode frequency in the fixed condition is 0 728 rad s while that in the free floating condition is at 0 760 rad s the shift is 4 40 larger than those in model 1 and model 4 the first sloshing mode frequency in the fixed and free floating conditions occur at 0 850 rad s and 0 858 rad s respectively with the shift being 0 94 the frequencies of the second sloshing mode in both fixed and free floating condition are 1 048 rad s the shifts in piston mode of models 1 4 and 5 are listed in table 6 and are shown to increase with the growth of moonpool length for moonpool without recess the piston mode frequency in the fixed condition is smaller than that in the free floating condition in order to better understand this phenomenon the modified frozen mode approximation proposed in section 3 is adopted for further analyses first fig 12 shows the phase difference between the barge motion and motion of the frozen restriction inside the moonpool as shown in the figure the motion of the frozen restriction and barge are almost 180 out of phase phase shift close to π around the piston mode frequency this means that the velocity ratio μ should be negative fig 13 illustrates the added mass due to the lower fluid with respect to μ in three dimensional cases the added mass is non dimensionalized by m a l 0 when the body is fixed i e μ 0 as can be seen as μ is negative the added mass due to the lower fluid is smaller than that in the fixed condition μ 0 which can induce larger piston mode frequency based on the frozen mode approximation model given in eqn 14 hence the physics on the shift of the piston mode frequency is clarified in fact the added mass with respect to μ in the two dimensional case shows a similar trend which can be adopted to explain the shift shown in fig 5 in fredriksen et al 2015 further it can also help us to understand why the magnitude of shift in shallow draft is relatively larger since the real mass in frozen restriction model is less while the reduction in the added mass from the lower fluid is almost the same it should be noted that although μ may varies at different draft the effect of the mass inside the moonpool is dominant 4 2 moonpool with a recess for moonpool with a recess the present results are compared with those given in molin 2017 and guo et al 2016 which studied a similar problem by eigenfunction matching method and model test respectively model 6 has the same moonpool dimension with that by molin 2017 fig 14 illustrates the variation of the free surface elevations at fp cp and ap it should be noted that the present coordinate system is different from that in guo et al 2016 where wave heading 180 is equivalent to 0 in the present study as can be seen the resonant frequencies in the fixed condition are almost the same as that in the free floating condition for the piston mode the second sloshing mode and the third sloshing mode respectively however there is some difference between the resonant frequencies of the first sloshing mode it should be noted that case studied by molin can be considered as in the fixed condition while the measurements in guo et al 2016 can be considered as in the free floating condition as shown the present results are in excellent agreement with that in molin 2017 and guo et al 2016 except that the predicted first sloshing mode frequency in the fixed condition is still slightly larger than that by molin in order to find out the reason we run an additional case with the same dimension as model 6 except for a larger beam which is the same as the barge length l b fig 15 illustrates the comparison of the free surface elevation raos between the two models at the same wave probe cp as shown the obtained first sloshing mode resonant frequency using square barge model is around 0 78 rad s which is almost same as the solution by molin 2017 it suggests that the beam of the barge can substantially affect the first longitudinal sloshing mode frequency moreover it can be clarified and confirmed that difference between molin s solution and results from wamit in the fixed condition can be attributed to assumption on infinite beam and length in that paper more detailed results are illustrated in fig 16 the resonant frequencies of piston mode in both fixed and free floating conditions are 0 415 rad s the first sloshing mode frequency in the fixed and free floating conditions are 0 803 rad s and 0 820 rad s respectively with the shift being about 2 18 the second sloshing mode frequency in the fixed condition is 1 075 rad s while that in the free floating condition is 1 077 rad s the shift is 0 19 much less than that of the first sloshing mode resonance fig 17 illustrates the heave pitch and roll motion raos in different wave directions for model 6 there is a local maximum at 0 415 rad s in heave motion which is the piston frequency in the free floating condition different from the cases without recess the local maximum at 0 820 rad s corresponding the first sloshing mode resonance in the free floating condition also occurs in the heave rao this implies that the first sloshing mode in the free floating condition has substantial effects on heave motion due to the recess in fact when the heave motion of barge is constrained in free floating condition using wamit the first sloshing mode resonant frequency is 0 805 rad s which is very close to that in fixed condition this indicates that the shift of the first sloshing mode resonant frequency for the present case with recess is mainly caused by the heave motion of the barge this may be because the hydrodynamic pressure along the longitudinal direction of the moonpool is not anti symmetric any more in the presence of a recess due to similar mechanism the pitch motion is also affected by the piston mode resonance in addition there are another two local maxima around 0 67 rad s in fig 17 a and 0 65 rad s in c which correspond to the heave natural frequencies in θ 0 and 90 respectively different from the cases without recess heave natural frequencies in both wave directions are higher than the piston mode frequency compared with model 6 the length of recess in model 7 is reduced to 8 m fig 18 gives the free surface elevation for model 9 as can be found in the plots the piston mode frequency in the fixed and free floating conditions are 0 593 rad s and 0 598 rad s respectively with the shift being 0 843 the first sloshing mode frequency in the fixed condition is 0 825 rad s while that in the free floating condition is 0 843 rad s with the shift being 2 12 the second sloshing mode frequency in the fixed condition is 1 11 rad s almost the same as that in the free floating condition in model 8 the length of recess is reduced to 4 m fig 19 illustrates the free surface elevation with respect to wave frequency for model 8 as can be seen the piston mode frequency in the fixed condition is at 0 690 rad s while that of free floating condition is 0 705 rad s the shift of the frequency is 2 17 the first sloshing mode frequency in the fixed condition is 0 863 rad s while that in the free floating condition is 0 875 rad s the shift of the frequency is 1 40 the resonant frequencies of the second sloshing mode in both fixed and free floating conditions are 1 14 rad s the shifts in the first sloshing mode for these three models are summarized in table 7 by comparing the shifts in these three models it can be concluded that the longer the recess length the larger the shift in the first sloshing mode frequencies in the fixed and free floating condition compared with model 6 the height of recess h is reduced to 5 m in model 9 fig 20 illustrates the free surface elevation with respect to wave frequency for model 9 the piston mode frequency in the fixed condition is 0 470 rad s while that in the free floating condition is 0 473 rad s the shift is 0 64 the first sloshing mode frequency in the fixed condition is 0 825 rad s while that in the free floating condition is 0 845 rad s the shift is 2 42 the natural frequencies of the second sloshing mode in both fixed and free floating conditions are 1 123 rad s in model 10 the height of recess is reduced to 3 m fig 21 illustrates the free surface elevation with respect to wave frequency for model 10 the piston mode frequency in the fixed condition is 0 508 rad s while that in the free floating condition is 0 510 rad s the shift is 0 39 the first sloshing mode frequency in the fixed condition is at 0 838 rad s while that in the free floating condition is 0 858 rad s the shift is 2 39 the natural frequencies of the second sloshing mode in both fixed and free floating conditions are 1 145 rad s the shifts in the first sloshing mode for these three models are summarized in table 8 as expected the shift of the first sloshing mode frequency is not sensitive to recess height 5 conclusions barges with different moonpool dimensions are modelled for wamit computations cases with and without recess are both adopted for analyses free surface elevations heave pitch motion and roll raos are computed in both fixed and free floating conditions the main objective of the present study is to explore how the moonpool dimensions affect the shift of the resonant frequencies in the fixed and free floating vessels and the relation between the moonpool resonances and vessel motion responses in the free floating condition the predicted natural frequencies and shifts in the fixed and free floating conditions of all models are summarized in table a 1 in appendix a by systematic computations and analyses it is observed that the natural frequencies of the moonpool in a free floating condition are higher than that in a fixed condition for both piston and longitudinal sloshing resonance modes in addition it is found that for vessel without recess in moonpool the shift of resonant frequency in the piston mode is larger than that in sloshing modes and the shift in the first sloshing mode is larger than that in the higher order sloshing modes for vessels with a recess the shift of frequency in piston mode is less than that in the first sloshing mode it is found that the shift can be affected by the draft of vessel for moonpool without recess as the draft is reduced the shift in piston mode increases as the length of moonpool increases the shift in piston mode resonance increases but the shift in sloshing modes is almost less than 1 moreover a modified frozen mode approximation is proposed to examine the effects of the body motion it is found body motion causes the reduction in the added mass from the fluid underneath the moonpool and yield an increase in the piston mode frequency moreover it is found the infinite beam assumption in molin s paper may lead to the underestimation of the first longitudinal sloshing mode resonant frequency for the model adopted in the experiments it is found that moonpool resonance can induce local hump in heave and pitch motion raos for vessels without recess in moonpool the resonances in the piston mode and the second sloshing mode have effects on the heave motion while the resonance in the first sloshing mode can only affect the pitch motion for vessels with recess in moonpool resonances in piston mode and the first sloshing mode have effects on both heave and pitch motions the water motion in a piston mode may yield antisymmetric hydrodynamic pressure along the longitudinal direction of the moonpool which leads to the local maximum in heave motion rao similarly the water motion in the first sloshing mode causes the local maximum in pitch motion rao it should be noted that damping due to flow separation is important near the resonant frequency which needs to be investigated in future study the present study is based on the potential flow theory and focuses on the natural frequency instead of response amplitude the nonlinear free surface effects and vortex shedding were not taken into consideration but should be studied in the future we believe the present study can offer offshore engineers some guidance or hints when they make decision on the moonpool configuration considering the difference in the natural frequencies between the fixed and free floating conditions acknowledgements special thanks to prof bernard molin and prof rodney eatock taylor for inspiring discussions and comments with one of the authors xinshu zhang during the iwwwfb 2019 moreover we feel very grateful to prof harry bingham for his help on using the wamit appendix a summary of the results for all cases table a 1 summary of all the cases on the shifts of the piston and the first sloshing mode frequencies in the fixed and free floating conditions table a 1 model no l m b m l m b m d m d m r m h m ω 0 f c ω 0 f f f 0 ω 1 f c ω 1 f f f 1 moonpool without recess 1 180 8 32 2 45 6 11 2 11 22 8 0 735 0 760 3 40 0 913 0 923 1 10 2 180 8 32 2 45 6 11 2 4 22 8 0 943 1 002 6 26 1 090 1 097 0 64 3 180 8 32 2 45 6 11 2 20 22 8 0 598 0 613 2 51 0 848 0 858 1 18 4 180 8 32 2 20 0 11 2 11 22 8 0 765 0 778 1 70 1 255 1 260 0 40 5 180 8 32 2 60 0 11 2 11 22 8 0 728 0 760 4 40 0 850 0 858 0 94 moonpool with a recess 6 180 8 32 2 45 6 11 2 11 22 4 16 0 7 2 0 415 0 415 0 00 0 8025 0 820 2 18 7 180 8 32 2 45 6 11 2 11 22 4 8 0 7 2 0 593 0 598 0 84 0 825 0 8425 2 12 8 180 8 32 2 45 6 11 2 11 22 4 4 0 7 2 0 690 0 705 2 17 0 863 0 875 1 40 9 180 8 32 2 45 6 11 2 11 22 4 16 0 5 0 0 470 0 473 0 53 0 825 0 845 2 42 10 180 8 32 2 45 6 11 2 11 22 4 16 0 3 0 0 508 0 510 0 49 0 838 0 858 2 39 
22266,based on the linearized long wave equation an analytical solution for wave oscillations within a circular harbor of constant depth over a conical island is obtained the analysis divides the study domain into three regions region i within the harbor region ii over the island and region iii from the island toe to the deep sea in region i the water depth is uniform and the method of separation of variables is used to find the free surface elevation solution in region ii the water depth linearly varies along the radial direction of the island and the method of separation of variables is adopted again to reveal the free surface elevation solution expressed in bessel and hankel functions waves in region iii consist of the incident waves and the scattered waves from the island which are respectively expressed with a fourier cosine series and a sum series of hankel function the final solution is obtained by matching the free surface elevation and its normal derivatives at the interfaces between the three regions to confirm the validity of the analytical solution via adjusting topographical parameters it was further utilized to compare with the existing analytical solutions for wave induced oscillations in a circular harbor of constant depth and the scattering of long waves around a cylindrical island mounted on a conical shoal finally as the topographical features of maug islands resembles the geometry studied in this article the coupled oscillation characteristics for maug islands are examined the existence of the island does aggravate oscillations within the harbor and the features are addressed in details keywords harbor resonance wave oscillations circular harbor conical island analytical solution 1 introduction among the natural disasters related to long period waves harbor oscillations are one of the most frequent disasters around the world long period oscillations associated with resonance can cause excessive movements of moored ships break ships mooring lines and interrupt normal operation of the harbor gao et al 2017 therefore it is of paramount importance to predict accurately the response of a newly designed harbor to incident long period waves from the high sea the issue of harbor oscillations had been extensively addressed including the generation mechanisms and the factors involving in amplification of waves in harbors and bays tsunamis were regarded as one of the common factors exciting larger oscillations in bays inlets and harbors dong et al 2010a vela et al 2014 the term tsunami comes from the japanese term with the literal meaning of harbor wave which may reflect the fact that tsunami waves were first observed in harbors historic records of unexplained and rapid rises of water level in harbors can go back almost 1000 years in japan and they are often associated with tsunamis synolakis 2003 atmospheric disturbances such as atmospheric gravity waves pressure jumps frontal passages squalls can also generate long waves with the same temporal and spatial scales as typical tsunami waves known as meteotsunamis ličer et al 2017 these meteotsunami waves will be resonant amplificated when they arrive at the harbor entrance wijeratne et al 2010 furthermore long waves generated through the nonlinear interaction of wind waves or swell termed infragravity waves can also be responsible for harbor oscillations with typical periods of several minutes present at all times but increasing significantly during storm events commonly arise from infragravity waves incident on the harbor entrance thotagamuwage and pattiaratchi 2014 dong et al 2010b oscillations within bays and harbors depend not only on the characteristics of incident long waves but also on the geometrical features to reveal the influence of the harbor geometry on the amplification of wave oscillation miles and munk 1961 lee 1971 and marcos et al 2005 formulated analytical solutions for simple geometries of uniform water depth within and outside the harbor zelt and raichlen 1990 wang et al 2011a and wang et al 2014 have provided analytical solutions for wave induced oscillations in harbors of variable bathymetries these analytical solutions can help to understand some general properties of oscillations however the geometric shapes and depth profiles for real harbors are more complex and they must yield more complicated oscillations which significantly increases the difficulty in carrying out the theoretical investigation therefore a number of numerical models have been developed to handle oscillations in harbors of complex shapes and bathymetries lee et al 1998 adopted the finite element model of the mild slope equation to study resonance in long beach and los angeles harbor basins losada et al 2008 presented a boussinesq model based on a finite element unstructured grid to analyze transient nonlinear resonance problems in harbors and bays wang et al 2011b developed a boussinesq model to simulate harbor oscillations induced by seafloor movements kumar et al 2013 proposed a boundary element model based on the helmholtz equation and implemented investigations on the pohang new harbor to predict the resonance modes for incident waves with various directions cuomo and guza 2017 proposed a method to estimate harbor oscillations with infragravity periods at marina di carrara from the properties of wind generated incident waves outside the harbor previous studies on harbor oscillations mostly focus on harbors located on the coastline of the mainland however there are quite a number of harbors built over natural or artificial islands when long waves approach water of variable depth they may be greatly amplified by the island therefore it is imperative to further examine the response of a harbor over an island solutions for the problem of waves scattering on islands are mostly based on the shallow water equation and the mild slope equation wave amplification around the island depends on the trapping capability of the island and how factors such as wave periods radii of the island and depth varying parameters etc affect the response characteristics of the island to long waves has been widely examined jung et al 2010 liu and xie 2013 wang et al 2018 zhang and zhu 1994 zhu and zhang 1996 maug islands with the coordinate of 20 2 n 145 13 e are a group of three small uninhabited islands in the commonwealth of the northern mariana island this island group was formed as a result of a volcano that broke through the pacific ocean the three islands have a total area of approximately 2 1 km2 and a maximum elevation of 227 m the submerged caldera has a diameter of approximately 2 2 km the floor of the caldera is around 225 m below sea level and in the middle is a mountain whose summit is only 22 m below sea level as the caldera is protected by the three islands with a gap southward it can be considered as a natural harbor for ship docking as the incident waves will be coordinately responded by the islands and the harbor it is motivated to examine the coupled oscillation characteristics for this new configuration although harbor resonance and wave amplification around islands have been widely explored independently the recognized phenomenon of violent oscillations in a coupled harbor island system still lacks a rigorous theory to provide detailed characteristics in this paper we proposed an analytical model to reveal the interesting features not emerged in the decoupled system the present study restricts the analysis to a circular harbor with constant water depth over a conical island so that the analytical solution can be explicitly obtained the study further makes a further simplifying assumption that the mouth width is small as compared to the wavelength of interest and deduce the analytical solution in section 2 the deduced analytical solution is verified by applying it to the oscillations within a circular harbor of constant water depth and the response of the conical island to long waves in section 3 oscillations within the circular harbor over maug islands are then investigated analytically and the impact of the islands on the response of the harbor is addressed in details in section 4 conclusions are drawn in section 5 2 analytical solution maug islands can be simplified as a circular harbor over a conical island as illustrated in fig 2 the interesting domain is divided into region i region ii and region iii which are respectively the regions within the harbor over the island and the open sea water depth within the harbor and in the open sea keeps constant as h 1 and h 2 respectively whilst in region ii the water depth varies with a constant slope s therefore the water depth in the whole domain can be expressed as 1 h h 1 0 r r 1 s r r 1 r r 2 h 2 r r 2 where h 1 sr 1 and h 2 sr 2 and r 1 and r 2 are the radial distances from the center to the coastline and the island toe respectively it is customary and appropriate to use the linear shallow water equation in harbor oscillation studies synolakis 2003 for oscillations in a circular basin and wave propagation over a conical island it is convenient to use a polar coordinate system r θ with the origin in the center using the expression of the free surface elevation η r θ t ζ r θ exp iσt the linearized long wave equation can be written as 2 r 2 2 ζ r 2 r 1 r h h r ζ r 2 ζ θ 2 σ 2 r 2 g h ζ 0 2 1 in region i within the harbor as the water depth within the harbor is constant eq 2 can be reduced to 3 r 2 2 ζ r 2 r ζ r 2 ζ θ 2 σ 2 r 2 g h ζ 0 considering that waves propagate at θ 0 or θ π respectively so the wave amplitude should be symmetrical with respect to the center line θ 0 thus the solution of eq 3 can be expressed as 4 ζ i r θ n 0 a i n j n k 1 r cos n θ where jn is the first kind bessel function of the nth order k 1 σ g h 1 is the wavenumber and a i n is an arbitrary constant to be determined by matching the conditions at the interface of r r 1 as follows 5 ζ i r r r 1 f θ θ θ 0 0 θ θ 0 there are relationships for the bessel functions 6 j 0 k r r k j 1 k r and 7 j n k r r k j n 1 k r n r j n k r n 1 thus the matching conditions eq 5 can then be expressed as 8 ζ i r r r 1 k 1 a i 0 j 1 k 1 r 1 n 1 a i n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 cos n θ f θ θ θ 0 0 θ θ 0 multiplying eq 8 by cos n θ where n is integer and integrating it with respect to θ from 0 to 2π leads to 9 k 1 a i 0 j 1 k 1 r 1 0 2 π cos n θ d θ 0 2 π n 1 a i n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 cos n θ cos n θ d θ θ 0 θ 0 f θ cos n θ d θ setting n 0 a 0 i can be determined as 10 a i 0 1 2 π k 1 j 1 k 1 r 1 θ 0 θ 0 f θ d θ on the other hand if n n 0 a n i can be evaluated as 11 a i n θ 0 θ 0 f θ cos n θ d θ π k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 n 1 this above formula is formally the same as that for the circular harbor derived by lee 1971 and f θ can be approximated by a constant f if the harbor entrance is assumed very small compared to the wavelength hence eqs 10 and 11 can be transformed to 12 a i n θ 0 f π k 1 j 1 k 1 r 1 n 0 2 sin n θ 0 f π n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 n 1 2 2 in region ii over the island over the island the wave system consists of incident waves from the open sea reflected wave by the harbor wall and radiated waves from the harbor entrance separating the variable as ζ r θ r r θ θ and inserting the expression of the bathymetry 1 into eq 2 yield 13 r 2 r r σ 2 g s r n 2 r 2 r 0 and 14 θ n 2 θ 0 as the island is symmetrical with respect to the center line θ 0 the solution of eq 14 is 15 θ θ a ii n cos n θ where a ii n is an arbitrary constant introducing 16 τ 2 σ g s r 1 2 and 17 r r 1 2 ℝ eq 13 becomes 18 2 ℝ τ 2 τ 1 ℝ τ 1 ν 2 τ 2 ℝ 0 where 19 ν 4 n 2 1 eq 18 is the bessel equation of order ν and its corresponding solution can be expressed as 20 ℝ a ii j ν τ b ii y ν τ where j ν and y ν are the ν th order bessel functions of the first and second kinds respectively and a ii and b ii are constants which can be obtained from the boundary condition and matching relations there are the radiated waves from the harbor entrance each point x y can be considered as a source and the waves scattered from it can be expressed as 21 ζ ii rd x y σ g x y 2 g h 0 1 k 1 r where g x y is the flow of the point x y h0 1 is the 0th order hankel function of the first kind and r 2 x x 2 y y 2 the total radiated waves can be written as 22 ζ ii rd θ 0 θ 0 σ g x y 2 g h 0 1 k 1 r r 1 d θ according to wang et al 2011a g x y can be approximated as a constant g if the harbor entrance is assumed narrow the arc from θ 0 to θ 0 can be further approximated as a straight line segment thus the radiated waves at the entrance can be approximated as 23 ζ ii rd σ g 2 g r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y so the wave field over the island is described by 24 ζ ii n 0 r 1 2 a ii n j ν 2 σ g s 1 2 r 1 2 b ii n y ν 2 σ g s 1 2 r 1 2 cos n θ σ g 2 g r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y 2 3 in region iii the open sea there are incident waves from the open sea ζ iii i r θ and scattered waves by the island ζ iii s r θ the water surface elevation ζ iii r θ may be expressed as 25 ζ iii r θ ζ iii i r θ ζ iii s r θ the incident waves are assumed to be a linear sinusoidal wave train propagating in the positive x direction which can be expressed in terms of fourier cosine series as synolakis 2003 26 ζ iii i r θ a i e i k 2 x a i n 0 i n ε n j n k 2 r cos n θ where a i is the incident wave amplitude k 2 σ g h 2 is the wavenumber ε n is the jacobi symbol defined by 27 ε n 1 n 0 2 n 1 the scattered wave may be expressed as wang et al 2014 28 ζ iii s r θ n 0 a iii n h n k 2 r cos n θ where a n iii is the scattered wave amplitude to be determined h n is the nth order hankel function of the first kind the free surface elevation in the outer region can finally be obtained 29 ζ iii r θ a i n 0 i n ε n j n k 2 r cos n θ n 0 a iii n h n k 2 r cos n θ 2 4 matching and boundary conditions the free surface elevation and its derivative should be continuous at r r 1 θ θ 0 hence 30 ζ i ζ ii θ θ 0 and 31 ζ ii r r r 1 0 θ θ 0 ζ i r r r 1 θ θ 0 similarly the free surface elevation and its derivative should be continuous at r r 2 which requires 32 ζ iii r r 2 ζ ii r r 2 and 33 ζ iii r r r 2 ζ ii r r r 2 the matching condition 32 implies that 34 ζ ii rd r r r 1 ζ i r r r 1 for θ θ 0 for the narrow entrance the matching condition eq 34 can be changed to 35 θ 0 θ 0 ζ ii rd r r r 1 r 1 d θ θ 0 θ 0 ζ i r r r 1 r 1 d θ which yields 36 σ g 2 g θ 0 θ 0 r r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y r r 1 r 1 d θ 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 if the integral along the arc can be approximated as if it is along a straight line segment the derivative of r can be approximated as that of x thus eq 36 becomes 37 σ g 2 g r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 x h 0 1 k 1 x x 2 y y 2 d y r r 1 d y 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 for kr 1 h0 1 kr can be extended asymptotically as wang et al 2011a 38 h 0 1 k r 1 2 i π ln γ k r 2 ο k r 2 where γ 1 7810724 is the exponential of euler s constant inserting eq 38 into eq 37 yields 39 i σ g g π r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 x x x x 2 y y 2 d y d y 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 x x 0 y r 1 sin θ 0 notice that when x x 0 the integral in eq 39 takes the algebraic form 40 r 1 sin θ 0 r 1 sin θ 0 x x x x 2 y y 2 d y y δ y δ x x x x 2 y y 2 d y arctan y y x x y δ y δ π substituting eq 40 into eq 39 leads to 41 g i g θ 0 k 1 a 0 1 σ sin θ 0 j 1 k 1 r 1 i g k 1 σ sin θ 0 n 1 sin n θ 0 2 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 the radiated waves from the harbor are assumed to be limited near the narrow mouth and they can be neglected at θ θ 0 thus the matching condition eq 31 can be changed to 42 r n 0 r 1 2 cos n θ a ii n j ν 2 σ g s 1 2 r 1 2 b ii n y ν 2 σ g s 1 2 r 1 2 r r 1 0 which yields 43 a ii n j ν 2 σ g s 1 2 r 1 1 2 b ii n y ν 2 σ g s 1 2 r 1 1 2 σ g s 1 2 r 1 1 2 a ii n j ν 1 2 σ g s 1 2 r 1 1 2 j ν 1 2 σ g s 1 2 r 1 1 2 b ii n y ν 1 2 σ g s 1 2 r 1 1 2 y ν 1 2 σ g s 1 2 r 1 1 2 0 the matching condition eq 30 can be changed to 44 θ 0 θ 0 ζ ii r 1 d θ θ 0 θ 0 ζ i r 1 d θ or 45 2 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g 2 g θ 0 θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d θ 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 2 sin n θ 0 n a n 1 j n k 1 r 1 using again the integral across a straight line to approximate the integral along the arc eq 45 becomes 46 2 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g 2 g r 1 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d y 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 2 sin n θ 0 n a n 1 j n k 1 r 1 using the approximation eq 38 to substitute the hankel function term in eq 46 we obtain 47 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d y 4 0 2 r 1 sin θ 0 2 r 1 sin θ 0 ξ h 0 1 k 1 ξ d ξ 4 r 1 2 sin 2 θ 0 1 2 i π ln γ k 1 r 1 sin θ 0 2 e 3 2 substituting eq 47 into eq 46 yields 48 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g g r 1 sin 2 θ 0 1 2 i π ln γ k 1 r 1 sin θ 0 2 e 3 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 sin n θ 0 n a n 1 j n k 1 r 1 as the radiated waves are limited to the harbor mouth they can be neglected at the boundary line r r 2 thus the matching condition eq 32 can be rewritten as 49 r 2 1 2 a i i 0 j ν 2 σ g s 1 2 r 2 1 2 b i i 0 y ν 2 σ g s 1 2 r 2 1 2 n 1 r 2 1 2 a i i n j ν 2 σ g s 1 2 r 2 1 2 b i i n y ν 2 σ g s 1 2 r 2 1 2 cos n θ a i ε 0 j 0 k 2 r 2 a iii 0 h 0 k 2 r 2 a i n 1 i n ε n j n k 2 r 2 cos n θ n 1 a iii n h n k 2 r 2 cos n θ which yields 50 r 2 1 2 a i i 0 j ν 2 σ g s 1 2 r 2 1 2 b i i 0 y ν 2 σ g s 1 2 r 2 1 2 a i ε 0 j 0 k 2 r 2 a iii 0 h 0 k 2 r 2 and 51 r 2 1 2 a i i n j ν 2 σ g s 1 2 r 2 1 2 b i i n y ν 2 σ g s 1 2 r 2 1 2 a i i n ε n j n k 2 r 2 a iii n h n k 2 r 2 for n 1 similar approach used in eq 33 gives 52 1 ν 2 r 2 3 2 a 0 ii j ν 2 σ g s r 2 1 2 b 0 ii y ν 2 σ g s r 2 1 2 σ g s r 2 1 a 0 ii j ν 1 2 σ g s r 2 1 2 b 0 ii y ν 1 2 σ g s r 2 1 2 a i k 2 j 0 k 2 r 2 a iii 0 k 2 h 0 k 2 r 2 for n 0 and 53 1 ν 2 r 2 3 2 a n ii j ν 2 σ g s r 2 1 2 b n ii y ν 2 σ g s r 2 1 2 σ g s r 2 1 a n ii j ν 2 σ g s r 2 1 2 b n ii y ν 2 σ g s r 2 1 2 2 a i i n k 2 j n 1 k 2 r 2 2 n a i i n r 2 1 j n k 2 r 2 k 2 a iii n h n 1 k 2 r 2 n r 2 1 a iii n h n k 2 r 2 for n 1 3 comparison with existing analytical solutions as shown in fig 2 when r 1 is very close to r 2 i e h 1 becomes very close to h 2 the island will disappear and the topography will degenerate into a circular harbor of constant depth lee 1971 derived an analytical solution to investigate wave induced oscillations inside harbors with arbitrary geometry and constant depth and further conducted experiments to verify the theory fig 1 to reproduce the experiment of lee 1971 the topographical parameters are adjusted to r 1 0 228 m and r 2 0 229 m which leads to the water depth in the harbor h 1 0 3 m and the water depth in the open sea h 2 0 301 m as the present solution is derived for the narrow harbor entrance the results for the circular harbor with 10 opening are compared in fig 3 the amplification factor f which is defined the ratio of the wave amplitude at any position inside the harbor to twice the incident wave amplitudes is used to identify the response of a harbor to incident waves the present solution agrees fairly well with that of lee 1971 they share the same pattern and the values of the amplification factor are very close to each other since the energy dissipation arising from viscous effects and flow separation around the harbor entrance has not been considered in both theories the analytical values of the peak amplification factor near resonance are obviously larger than the experimental values however the resonant frequencies and the variation patterns of the amplification factor curve shows good consistency between the experimental data and both theories on the other hand when the mouth of the harbor is closed i e the radiation waves from the harbor entrance are excluded our solution degenerates into that for a cylindrical island over on a conical shoal zhu and zhang 1996 have derived an analytical solution for the scattering waves around a cylindrical island mounted on a conical shoal in the open sea of constant depth in order to compare with their results the topographical parameters in their study are utilized i e r 1 10 km h 1 1 33 km and h 2 4 km two different values of r 2 i e r 2 200 km and 80 km are considered which respectively correspond to γ 0 02 and γ 0 05 in the study of zhu and zhang 1996 the incident wave period is set to t 480 s wave run ups along the coastline of the cylindrical island for γ 0 02 and γ 0 05 are plotted in fig 4 the good agreement between two solutions indicates that the present analytic solution can well describe wave propagation over the island 4 oscillations within maug islands the maug islands can be considered as a circular harbor with the radius of r 1 1 1 km and the constant water depth of h 1 70 m located over a conical island with the radius of r 2 5 5 km it is surrounded by an open sea with the constant water depth of h 2 350 m the opening of the harbor is 2θ 0 10 and the constant slope of the island is s 0 0636 as the narrow entrance assumption is satisfied in fig 3 by comparing the analytical solution with experiment results the solution can be used confidently to examine the effect of the island on the harbor response to incident waves in order to examine the effect of the island on the harbor response to incident waves the oscillations in a circular harbor with the radius of r 1 1 km and the constant water depth h 70 m inside and outside are compared in fig 5 regardless of whether the island exists or not oscillations at the frequency of ω 0 009 rad s are evident both at the center and the boundary positions with the angle θ 45 135 and 180 respectively however due to the shoaling effect of the underwater topography of the island on the incident waves the resonant amplifications in the harbor located over the island shows to be larger than those without it the frequencies of ω 0 047 rad s and 0 076 rad s are not obviously amplified by the harbor without the island and the corresponding amplification factors at these four positions are all less than 2 0 which indicates that they don t correspond to the resonant frequencies on the contrary the amplification factors at these two frequencies for the harbor located over the island can reach up to 12 0 an increase of more than 6 times which should be due to the shoaling effect of underwater topography of the island fig 6 the distributions of relative wave amplitude for these three frequencies over the island and within the harbor are also presented in fig 5 as the wavelength of ω 0 009 rad s is close to the radius of the island the island cannot exert an obvious impact on the waves which yields the relatively uniform distribution of wave amplitude over the island the scattering effect of the island is enhanced with the increase of the wave frequency the pattern of partial standing waves becomes more and more evident in front of the harbor furthermore more wave energy is scattered laterally due to refraction and diffraction for these higher frequencies and the scattering wave pattern over the island becomes more complicated the distributions of the wave amplitudes within the harbor are also shown to be distinct for different frequencies the maximum and minimal values occur at different positions and the nodal and antinodal lines present different geometric structures for ω 0 009 rad s i e mode 0 0 of the harbor the amplitude is smallest at the entrance and tends to increase gradually along the incident propagation direction and reaches the peak value at the backwall of the harbor for ω 0 047 rad s i e mode 1 0 a nodal line is observed approximately along x 0 which symmetrically divides wave amplitude distribution inside the harbor into two parts the maximum values are observed at the backwall together with the upper and lower sides of the entrance for ω 0 076 rad s i e mode 2 0 the wave amplitude distribution is almost evenly divided into four parts by two orthogonal nodal lines the minimal value appears at the center and the maximum values appear at the backwall near the entrance and the up and down corners 5 conclusions there are a number of harbors built over natural or artificial islands and the incident waves from the open sea would be jointly affected by the island and the harbor in order to reveal these features an analytical solution for the wave oscillations within a circular harbor of constant depth over a conical island is derived the domain of interest is divided into three regions i e region i within the harbor region ii over the island and region iii from the island toe to the deep sea the free surface elevation in the harbor of constant depth is described as a sum series of the first kind bessel function whereas the water depth varies linearly along the radial direction of the island in region ii the corresponding free surface elevation is described as the combination of the first and second kind bessel functions in the open sea of constant depth the incident and scattered waves are described with a fourier cosine series and a sum series of hankel function respectively it is assumed that the width of the harbor entrance is very small compared to the incident wavelength and furthermore the island is so large that the radiated waves from the harbor entrance are rather small at the toe and can be ignored there the final solution is obtained by matching the free surface elevation and its derivative at the interfaces between the three regions by adjusting the topographical parameters the present analytical solution is used to predict the wave induced oscillations in a circular harbor of constant depth and the scattering of long waves around a cylindrical island mounted on a conical shoal the validity of the present analytical solution is fully proved via comparing the predicting results with the existing analytical solutions of lee 1971 and zhu and zhang 1996 as the topographical features of maug islands resembles the geometry studied in this article the coupled oscillation characteristics for maug islands are examined the distribution of wave amplitude over the island is highly related to both the topographical features and the incident wave frequency for the effects of the topographical features the existence of the island does aggravate oscillations in the harbor the amplification factor is larger for a harbor over the island as compared to harbor without the island at the four positions moreover the shoaling effect of underwater topography of the island on the incident waves shift some resonant frequencies for the effects of the incident wave frequency more complicated wave pattern appears over the island for the higher frequency due to wave refraction and diffraction in addition the wave amplitude distribution within the harbor also depends closely on the incident wave frequency via exciting different resonant modes for different modes the maximum and minimal values occur along with the nodal and anti nodal lines displaying different geometric structures the study is hoped to improve the understanding of oscillations in a harbor island system and to provide preliminary estimates of resonance parameters declaration ofcompeting interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key research and development program of china no 2017yfc1404205 the national natural science foundation of china no 51579090 51609108 and the fundamental research funds for the central universities no 2019b12214 
22266,based on the linearized long wave equation an analytical solution for wave oscillations within a circular harbor of constant depth over a conical island is obtained the analysis divides the study domain into three regions region i within the harbor region ii over the island and region iii from the island toe to the deep sea in region i the water depth is uniform and the method of separation of variables is used to find the free surface elevation solution in region ii the water depth linearly varies along the radial direction of the island and the method of separation of variables is adopted again to reveal the free surface elevation solution expressed in bessel and hankel functions waves in region iii consist of the incident waves and the scattered waves from the island which are respectively expressed with a fourier cosine series and a sum series of hankel function the final solution is obtained by matching the free surface elevation and its normal derivatives at the interfaces between the three regions to confirm the validity of the analytical solution via adjusting topographical parameters it was further utilized to compare with the existing analytical solutions for wave induced oscillations in a circular harbor of constant depth and the scattering of long waves around a cylindrical island mounted on a conical shoal finally as the topographical features of maug islands resembles the geometry studied in this article the coupled oscillation characteristics for maug islands are examined the existence of the island does aggravate oscillations within the harbor and the features are addressed in details keywords harbor resonance wave oscillations circular harbor conical island analytical solution 1 introduction among the natural disasters related to long period waves harbor oscillations are one of the most frequent disasters around the world long period oscillations associated with resonance can cause excessive movements of moored ships break ships mooring lines and interrupt normal operation of the harbor gao et al 2017 therefore it is of paramount importance to predict accurately the response of a newly designed harbor to incident long period waves from the high sea the issue of harbor oscillations had been extensively addressed including the generation mechanisms and the factors involving in amplification of waves in harbors and bays tsunamis were regarded as one of the common factors exciting larger oscillations in bays inlets and harbors dong et al 2010a vela et al 2014 the term tsunami comes from the japanese term with the literal meaning of harbor wave which may reflect the fact that tsunami waves were first observed in harbors historic records of unexplained and rapid rises of water level in harbors can go back almost 1000 years in japan and they are often associated with tsunamis synolakis 2003 atmospheric disturbances such as atmospheric gravity waves pressure jumps frontal passages squalls can also generate long waves with the same temporal and spatial scales as typical tsunami waves known as meteotsunamis ličer et al 2017 these meteotsunami waves will be resonant amplificated when they arrive at the harbor entrance wijeratne et al 2010 furthermore long waves generated through the nonlinear interaction of wind waves or swell termed infragravity waves can also be responsible for harbor oscillations with typical periods of several minutes present at all times but increasing significantly during storm events commonly arise from infragravity waves incident on the harbor entrance thotagamuwage and pattiaratchi 2014 dong et al 2010b oscillations within bays and harbors depend not only on the characteristics of incident long waves but also on the geometrical features to reveal the influence of the harbor geometry on the amplification of wave oscillation miles and munk 1961 lee 1971 and marcos et al 2005 formulated analytical solutions for simple geometries of uniform water depth within and outside the harbor zelt and raichlen 1990 wang et al 2011a and wang et al 2014 have provided analytical solutions for wave induced oscillations in harbors of variable bathymetries these analytical solutions can help to understand some general properties of oscillations however the geometric shapes and depth profiles for real harbors are more complex and they must yield more complicated oscillations which significantly increases the difficulty in carrying out the theoretical investigation therefore a number of numerical models have been developed to handle oscillations in harbors of complex shapes and bathymetries lee et al 1998 adopted the finite element model of the mild slope equation to study resonance in long beach and los angeles harbor basins losada et al 2008 presented a boussinesq model based on a finite element unstructured grid to analyze transient nonlinear resonance problems in harbors and bays wang et al 2011b developed a boussinesq model to simulate harbor oscillations induced by seafloor movements kumar et al 2013 proposed a boundary element model based on the helmholtz equation and implemented investigations on the pohang new harbor to predict the resonance modes for incident waves with various directions cuomo and guza 2017 proposed a method to estimate harbor oscillations with infragravity periods at marina di carrara from the properties of wind generated incident waves outside the harbor previous studies on harbor oscillations mostly focus on harbors located on the coastline of the mainland however there are quite a number of harbors built over natural or artificial islands when long waves approach water of variable depth they may be greatly amplified by the island therefore it is imperative to further examine the response of a harbor over an island solutions for the problem of waves scattering on islands are mostly based on the shallow water equation and the mild slope equation wave amplification around the island depends on the trapping capability of the island and how factors such as wave periods radii of the island and depth varying parameters etc affect the response characteristics of the island to long waves has been widely examined jung et al 2010 liu and xie 2013 wang et al 2018 zhang and zhu 1994 zhu and zhang 1996 maug islands with the coordinate of 20 2 n 145 13 e are a group of three small uninhabited islands in the commonwealth of the northern mariana island this island group was formed as a result of a volcano that broke through the pacific ocean the three islands have a total area of approximately 2 1 km2 and a maximum elevation of 227 m the submerged caldera has a diameter of approximately 2 2 km the floor of the caldera is around 225 m below sea level and in the middle is a mountain whose summit is only 22 m below sea level as the caldera is protected by the three islands with a gap southward it can be considered as a natural harbor for ship docking as the incident waves will be coordinately responded by the islands and the harbor it is motivated to examine the coupled oscillation characteristics for this new configuration although harbor resonance and wave amplification around islands have been widely explored independently the recognized phenomenon of violent oscillations in a coupled harbor island system still lacks a rigorous theory to provide detailed characteristics in this paper we proposed an analytical model to reveal the interesting features not emerged in the decoupled system the present study restricts the analysis to a circular harbor with constant water depth over a conical island so that the analytical solution can be explicitly obtained the study further makes a further simplifying assumption that the mouth width is small as compared to the wavelength of interest and deduce the analytical solution in section 2 the deduced analytical solution is verified by applying it to the oscillations within a circular harbor of constant water depth and the response of the conical island to long waves in section 3 oscillations within the circular harbor over maug islands are then investigated analytically and the impact of the islands on the response of the harbor is addressed in details in section 4 conclusions are drawn in section 5 2 analytical solution maug islands can be simplified as a circular harbor over a conical island as illustrated in fig 2 the interesting domain is divided into region i region ii and region iii which are respectively the regions within the harbor over the island and the open sea water depth within the harbor and in the open sea keeps constant as h 1 and h 2 respectively whilst in region ii the water depth varies with a constant slope s therefore the water depth in the whole domain can be expressed as 1 h h 1 0 r r 1 s r r 1 r r 2 h 2 r r 2 where h 1 sr 1 and h 2 sr 2 and r 1 and r 2 are the radial distances from the center to the coastline and the island toe respectively it is customary and appropriate to use the linear shallow water equation in harbor oscillation studies synolakis 2003 for oscillations in a circular basin and wave propagation over a conical island it is convenient to use a polar coordinate system r θ with the origin in the center using the expression of the free surface elevation η r θ t ζ r θ exp iσt the linearized long wave equation can be written as 2 r 2 2 ζ r 2 r 1 r h h r ζ r 2 ζ θ 2 σ 2 r 2 g h ζ 0 2 1 in region i within the harbor as the water depth within the harbor is constant eq 2 can be reduced to 3 r 2 2 ζ r 2 r ζ r 2 ζ θ 2 σ 2 r 2 g h ζ 0 considering that waves propagate at θ 0 or θ π respectively so the wave amplitude should be symmetrical with respect to the center line θ 0 thus the solution of eq 3 can be expressed as 4 ζ i r θ n 0 a i n j n k 1 r cos n θ where jn is the first kind bessel function of the nth order k 1 σ g h 1 is the wavenumber and a i n is an arbitrary constant to be determined by matching the conditions at the interface of r r 1 as follows 5 ζ i r r r 1 f θ θ θ 0 0 θ θ 0 there are relationships for the bessel functions 6 j 0 k r r k j 1 k r and 7 j n k r r k j n 1 k r n r j n k r n 1 thus the matching conditions eq 5 can then be expressed as 8 ζ i r r r 1 k 1 a i 0 j 1 k 1 r 1 n 1 a i n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 cos n θ f θ θ θ 0 0 θ θ 0 multiplying eq 8 by cos n θ where n is integer and integrating it with respect to θ from 0 to 2π leads to 9 k 1 a i 0 j 1 k 1 r 1 0 2 π cos n θ d θ 0 2 π n 1 a i n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 cos n θ cos n θ d θ θ 0 θ 0 f θ cos n θ d θ setting n 0 a 0 i can be determined as 10 a i 0 1 2 π k 1 j 1 k 1 r 1 θ 0 θ 0 f θ d θ on the other hand if n n 0 a n i can be evaluated as 11 a i n θ 0 θ 0 f θ cos n θ d θ π k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 n 1 this above formula is formally the same as that for the circular harbor derived by lee 1971 and f θ can be approximated by a constant f if the harbor entrance is assumed very small compared to the wavelength hence eqs 10 and 11 can be transformed to 12 a i n θ 0 f π k 1 j 1 k 1 r 1 n 0 2 sin n θ 0 f π n k 1 j n 1 k 1 r 1 n r 1 j n k 1 r 1 n 1 2 2 in region ii over the island over the island the wave system consists of incident waves from the open sea reflected wave by the harbor wall and radiated waves from the harbor entrance separating the variable as ζ r θ r r θ θ and inserting the expression of the bathymetry 1 into eq 2 yield 13 r 2 r r σ 2 g s r n 2 r 2 r 0 and 14 θ n 2 θ 0 as the island is symmetrical with respect to the center line θ 0 the solution of eq 14 is 15 θ θ a ii n cos n θ where a ii n is an arbitrary constant introducing 16 τ 2 σ g s r 1 2 and 17 r r 1 2 ℝ eq 13 becomes 18 2 ℝ τ 2 τ 1 ℝ τ 1 ν 2 τ 2 ℝ 0 where 19 ν 4 n 2 1 eq 18 is the bessel equation of order ν and its corresponding solution can be expressed as 20 ℝ a ii j ν τ b ii y ν τ where j ν and y ν are the ν th order bessel functions of the first and second kinds respectively and a ii and b ii are constants which can be obtained from the boundary condition and matching relations there are the radiated waves from the harbor entrance each point x y can be considered as a source and the waves scattered from it can be expressed as 21 ζ ii rd x y σ g x y 2 g h 0 1 k 1 r where g x y is the flow of the point x y h0 1 is the 0th order hankel function of the first kind and r 2 x x 2 y y 2 the total radiated waves can be written as 22 ζ ii rd θ 0 θ 0 σ g x y 2 g h 0 1 k 1 r r 1 d θ according to wang et al 2011a g x y can be approximated as a constant g if the harbor entrance is assumed narrow the arc from θ 0 to θ 0 can be further approximated as a straight line segment thus the radiated waves at the entrance can be approximated as 23 ζ ii rd σ g 2 g r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y so the wave field over the island is described by 24 ζ ii n 0 r 1 2 a ii n j ν 2 σ g s 1 2 r 1 2 b ii n y ν 2 σ g s 1 2 r 1 2 cos n θ σ g 2 g r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y 2 3 in region iii the open sea there are incident waves from the open sea ζ iii i r θ and scattered waves by the island ζ iii s r θ the water surface elevation ζ iii r θ may be expressed as 25 ζ iii r θ ζ iii i r θ ζ iii s r θ the incident waves are assumed to be a linear sinusoidal wave train propagating in the positive x direction which can be expressed in terms of fourier cosine series as synolakis 2003 26 ζ iii i r θ a i e i k 2 x a i n 0 i n ε n j n k 2 r cos n θ where a i is the incident wave amplitude k 2 σ g h 2 is the wavenumber ε n is the jacobi symbol defined by 27 ε n 1 n 0 2 n 1 the scattered wave may be expressed as wang et al 2014 28 ζ iii s r θ n 0 a iii n h n k 2 r cos n θ where a n iii is the scattered wave amplitude to be determined h n is the nth order hankel function of the first kind the free surface elevation in the outer region can finally be obtained 29 ζ iii r θ a i n 0 i n ε n j n k 2 r cos n θ n 0 a iii n h n k 2 r cos n θ 2 4 matching and boundary conditions the free surface elevation and its derivative should be continuous at r r 1 θ θ 0 hence 30 ζ i ζ ii θ θ 0 and 31 ζ ii r r r 1 0 θ θ 0 ζ i r r r 1 θ θ 0 similarly the free surface elevation and its derivative should be continuous at r r 2 which requires 32 ζ iii r r 2 ζ ii r r 2 and 33 ζ iii r r r 2 ζ ii r r r 2 the matching condition 32 implies that 34 ζ ii rd r r r 1 ζ i r r r 1 for θ θ 0 for the narrow entrance the matching condition eq 34 can be changed to 35 θ 0 θ 0 ζ ii rd r r r 1 r 1 d θ θ 0 θ 0 ζ i r r r 1 r 1 d θ which yields 36 σ g 2 g θ 0 θ 0 r r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y r r 1 r 1 d θ 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 if the integral along the arc can be approximated as if it is along a straight line segment the derivative of r can be approximated as that of x thus eq 36 becomes 37 σ g 2 g r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 x h 0 1 k 1 x x 2 y y 2 d y r r 1 d y 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 for kr 1 h0 1 kr can be extended asymptotically as wang et al 2011a 38 h 0 1 k r 1 2 i π ln γ k r 2 ο k r 2 where γ 1 7810724 is the exponential of euler s constant inserting eq 38 into eq 37 yields 39 i σ g g π r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 x x x x 2 y y 2 d y d y 2 θ 0 k 1 r 1 a 0 1 j 1 k 1 r 1 k 1 r 1 n 1 sin n θ 0 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 x x 0 y r 1 sin θ 0 notice that when x x 0 the integral in eq 39 takes the algebraic form 40 r 1 sin θ 0 r 1 sin θ 0 x x x x 2 y y 2 d y y δ y δ x x x x 2 y y 2 d y arctan y y x x y δ y δ π substituting eq 40 into eq 39 leads to 41 g i g θ 0 k 1 a 0 1 σ sin θ 0 j 1 k 1 r 1 i g k 1 σ sin θ 0 n 1 sin n θ 0 2 n a n 1 j n 1 k 1 r 1 j n 1 k 1 r 1 the radiated waves from the harbor are assumed to be limited near the narrow mouth and they can be neglected at θ θ 0 thus the matching condition eq 31 can be changed to 42 r n 0 r 1 2 cos n θ a ii n j ν 2 σ g s 1 2 r 1 2 b ii n y ν 2 σ g s 1 2 r 1 2 r r 1 0 which yields 43 a ii n j ν 2 σ g s 1 2 r 1 1 2 b ii n y ν 2 σ g s 1 2 r 1 1 2 σ g s 1 2 r 1 1 2 a ii n j ν 1 2 σ g s 1 2 r 1 1 2 j ν 1 2 σ g s 1 2 r 1 1 2 b ii n y ν 1 2 σ g s 1 2 r 1 1 2 y ν 1 2 σ g s 1 2 r 1 1 2 0 the matching condition eq 30 can be changed to 44 θ 0 θ 0 ζ ii r 1 d θ θ 0 θ 0 ζ i r 1 d θ or 45 2 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g 2 g θ 0 θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d θ 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 2 sin n θ 0 n a n 1 j n k 1 r 1 using again the integral across a straight line to approximate the integral along the arc eq 45 becomes 46 2 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g 2 g r 1 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d y 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 2 sin n θ 0 n a n 1 j n k 1 r 1 using the approximation eq 38 to substitute the hankel function term in eq 46 we obtain 47 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 r 1 sin θ 0 h 0 1 k 1 x x 2 y y 2 d y d y 4 0 2 r 1 sin θ 0 2 r 1 sin θ 0 ξ h 0 1 k 1 ξ d ξ 4 r 1 2 sin 2 θ 0 1 2 i π ln γ k 1 r 1 sin θ 0 2 e 3 2 substituting eq 47 into eq 46 yields 48 θ 0 r 1 1 2 a i i 0 j ν 2 σ g s 1 2 r 1 1 2 b i i 0 y ν 2 σ g s 1 2 r 1 1 2 n 1 r 1 1 2 a i i n j ν 2 σ g s 1 2 r 1 1 2 b i i n y ν 2 σ g s 1 2 r 1 1 2 sin n θ 0 n σ g g r 1 sin 2 θ 0 1 2 i π ln γ k 1 r 1 sin θ 0 2 e 3 2 θ 0 a 0 1 j 0 k 1 r 1 m 1 sin n θ 0 n a n 1 j n k 1 r 1 as the radiated waves are limited to the harbor mouth they can be neglected at the boundary line r r 2 thus the matching condition eq 32 can be rewritten as 49 r 2 1 2 a i i 0 j ν 2 σ g s 1 2 r 2 1 2 b i i 0 y ν 2 σ g s 1 2 r 2 1 2 n 1 r 2 1 2 a i i n j ν 2 σ g s 1 2 r 2 1 2 b i i n y ν 2 σ g s 1 2 r 2 1 2 cos n θ a i ε 0 j 0 k 2 r 2 a iii 0 h 0 k 2 r 2 a i n 1 i n ε n j n k 2 r 2 cos n θ n 1 a iii n h n k 2 r 2 cos n θ which yields 50 r 2 1 2 a i i 0 j ν 2 σ g s 1 2 r 2 1 2 b i i 0 y ν 2 σ g s 1 2 r 2 1 2 a i ε 0 j 0 k 2 r 2 a iii 0 h 0 k 2 r 2 and 51 r 2 1 2 a i i n j ν 2 σ g s 1 2 r 2 1 2 b i i n y ν 2 σ g s 1 2 r 2 1 2 a i i n ε n j n k 2 r 2 a iii n h n k 2 r 2 for n 1 similar approach used in eq 33 gives 52 1 ν 2 r 2 3 2 a 0 ii j ν 2 σ g s r 2 1 2 b 0 ii y ν 2 σ g s r 2 1 2 σ g s r 2 1 a 0 ii j ν 1 2 σ g s r 2 1 2 b 0 ii y ν 1 2 σ g s r 2 1 2 a i k 2 j 0 k 2 r 2 a iii 0 k 2 h 0 k 2 r 2 for n 0 and 53 1 ν 2 r 2 3 2 a n ii j ν 2 σ g s r 2 1 2 b n ii y ν 2 σ g s r 2 1 2 σ g s r 2 1 a n ii j ν 2 σ g s r 2 1 2 b n ii y ν 2 σ g s r 2 1 2 2 a i i n k 2 j n 1 k 2 r 2 2 n a i i n r 2 1 j n k 2 r 2 k 2 a iii n h n 1 k 2 r 2 n r 2 1 a iii n h n k 2 r 2 for n 1 3 comparison with existing analytical solutions as shown in fig 2 when r 1 is very close to r 2 i e h 1 becomes very close to h 2 the island will disappear and the topography will degenerate into a circular harbor of constant depth lee 1971 derived an analytical solution to investigate wave induced oscillations inside harbors with arbitrary geometry and constant depth and further conducted experiments to verify the theory fig 1 to reproduce the experiment of lee 1971 the topographical parameters are adjusted to r 1 0 228 m and r 2 0 229 m which leads to the water depth in the harbor h 1 0 3 m and the water depth in the open sea h 2 0 301 m as the present solution is derived for the narrow harbor entrance the results for the circular harbor with 10 opening are compared in fig 3 the amplification factor f which is defined the ratio of the wave amplitude at any position inside the harbor to twice the incident wave amplitudes is used to identify the response of a harbor to incident waves the present solution agrees fairly well with that of lee 1971 they share the same pattern and the values of the amplification factor are very close to each other since the energy dissipation arising from viscous effects and flow separation around the harbor entrance has not been considered in both theories the analytical values of the peak amplification factor near resonance are obviously larger than the experimental values however the resonant frequencies and the variation patterns of the amplification factor curve shows good consistency between the experimental data and both theories on the other hand when the mouth of the harbor is closed i e the radiation waves from the harbor entrance are excluded our solution degenerates into that for a cylindrical island over on a conical shoal zhu and zhang 1996 have derived an analytical solution for the scattering waves around a cylindrical island mounted on a conical shoal in the open sea of constant depth in order to compare with their results the topographical parameters in their study are utilized i e r 1 10 km h 1 1 33 km and h 2 4 km two different values of r 2 i e r 2 200 km and 80 km are considered which respectively correspond to γ 0 02 and γ 0 05 in the study of zhu and zhang 1996 the incident wave period is set to t 480 s wave run ups along the coastline of the cylindrical island for γ 0 02 and γ 0 05 are plotted in fig 4 the good agreement between two solutions indicates that the present analytic solution can well describe wave propagation over the island 4 oscillations within maug islands the maug islands can be considered as a circular harbor with the radius of r 1 1 1 km and the constant water depth of h 1 70 m located over a conical island with the radius of r 2 5 5 km it is surrounded by an open sea with the constant water depth of h 2 350 m the opening of the harbor is 2θ 0 10 and the constant slope of the island is s 0 0636 as the narrow entrance assumption is satisfied in fig 3 by comparing the analytical solution with experiment results the solution can be used confidently to examine the effect of the island on the harbor response to incident waves in order to examine the effect of the island on the harbor response to incident waves the oscillations in a circular harbor with the radius of r 1 1 km and the constant water depth h 70 m inside and outside are compared in fig 5 regardless of whether the island exists or not oscillations at the frequency of ω 0 009 rad s are evident both at the center and the boundary positions with the angle θ 45 135 and 180 respectively however due to the shoaling effect of the underwater topography of the island on the incident waves the resonant amplifications in the harbor located over the island shows to be larger than those without it the frequencies of ω 0 047 rad s and 0 076 rad s are not obviously amplified by the harbor without the island and the corresponding amplification factors at these four positions are all less than 2 0 which indicates that they don t correspond to the resonant frequencies on the contrary the amplification factors at these two frequencies for the harbor located over the island can reach up to 12 0 an increase of more than 6 times which should be due to the shoaling effect of underwater topography of the island fig 6 the distributions of relative wave amplitude for these three frequencies over the island and within the harbor are also presented in fig 5 as the wavelength of ω 0 009 rad s is close to the radius of the island the island cannot exert an obvious impact on the waves which yields the relatively uniform distribution of wave amplitude over the island the scattering effect of the island is enhanced with the increase of the wave frequency the pattern of partial standing waves becomes more and more evident in front of the harbor furthermore more wave energy is scattered laterally due to refraction and diffraction for these higher frequencies and the scattering wave pattern over the island becomes more complicated the distributions of the wave amplitudes within the harbor are also shown to be distinct for different frequencies the maximum and minimal values occur at different positions and the nodal and antinodal lines present different geometric structures for ω 0 009 rad s i e mode 0 0 of the harbor the amplitude is smallest at the entrance and tends to increase gradually along the incident propagation direction and reaches the peak value at the backwall of the harbor for ω 0 047 rad s i e mode 1 0 a nodal line is observed approximately along x 0 which symmetrically divides wave amplitude distribution inside the harbor into two parts the maximum values are observed at the backwall together with the upper and lower sides of the entrance for ω 0 076 rad s i e mode 2 0 the wave amplitude distribution is almost evenly divided into four parts by two orthogonal nodal lines the minimal value appears at the center and the maximum values appear at the backwall near the entrance and the up and down corners 5 conclusions there are a number of harbors built over natural or artificial islands and the incident waves from the open sea would be jointly affected by the island and the harbor in order to reveal these features an analytical solution for the wave oscillations within a circular harbor of constant depth over a conical island is derived the domain of interest is divided into three regions i e region i within the harbor region ii over the island and region iii from the island toe to the deep sea the free surface elevation in the harbor of constant depth is described as a sum series of the first kind bessel function whereas the water depth varies linearly along the radial direction of the island in region ii the corresponding free surface elevation is described as the combination of the first and second kind bessel functions in the open sea of constant depth the incident and scattered waves are described with a fourier cosine series and a sum series of hankel function respectively it is assumed that the width of the harbor entrance is very small compared to the incident wavelength and furthermore the island is so large that the radiated waves from the harbor entrance are rather small at the toe and can be ignored there the final solution is obtained by matching the free surface elevation and its derivative at the interfaces between the three regions by adjusting the topographical parameters the present analytical solution is used to predict the wave induced oscillations in a circular harbor of constant depth and the scattering of long waves around a cylindrical island mounted on a conical shoal the validity of the present analytical solution is fully proved via comparing the predicting results with the existing analytical solutions of lee 1971 and zhu and zhang 1996 as the topographical features of maug islands resembles the geometry studied in this article the coupled oscillation characteristics for maug islands are examined the distribution of wave amplitude over the island is highly related to both the topographical features and the incident wave frequency for the effects of the topographical features the existence of the island does aggravate oscillations in the harbor the amplification factor is larger for a harbor over the island as compared to harbor without the island at the four positions moreover the shoaling effect of underwater topography of the island on the incident waves shift some resonant frequencies for the effects of the incident wave frequency more complicated wave pattern appears over the island for the higher frequency due to wave refraction and diffraction in addition the wave amplitude distribution within the harbor also depends closely on the incident wave frequency via exciting different resonant modes for different modes the maximum and minimal values occur along with the nodal and anti nodal lines displaying different geometric structures the study is hoped to improve the understanding of oscillations in a harbor island system and to provide preliminary estimates of resonance parameters declaration ofcompeting interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national key research and development program of china no 2017yfc1404205 the national natural science foundation of china no 51579090 51609108 and the fundamental research funds for the central universities no 2019b12214 
22267,this paper investigates roll suppression of marine vessels subjected to harmonic wave excitations bifurcation analysis is utilized to describe the stability range in detail where dynamical behaviors including chaos are observed under variations of control parameters adaptive sliding mode control with super twisting algorithm has been introduced to reduce chattering phenomenon of control activity as well as to guarantee roll control accuracy the stability of the complete controlled system with adaptive mechanism has been proven by lyapunov stability theory the key contribution of this work is to show the significant mitigation of chattering with non overestimating gains using a novel sliding model control structure extensive simulation results have been provided to verify the effectiveness of the proposed robust controller against exogenous disturbances finally the adaptive super twisting controller provides rapid convergence on sliding mode variables on roll motions with high accuracy and the chattering has been considerably reduced or almost eliminated to be desired keywords roll oscillation disturbances chattering chaos sliding mode control adaptive super twisting algorithm 1 introduction controlling roll oscillations of a marine vessel is one of crucial issues in modern maritime technology it closely relates to the navigation safety cargo protection structural failure of vessels working efficiency of all crews and comfort of passengers in harsh sea circumstances uncontrolled small ships such as fishing boats and yachts may capsize due to severe roll excitations without proper roll control mechanism even the large passenger ships lost its control in maritime disaster and may result in a substantial loss of life this paper intends to pursue suppressing chaotic roll motions for a barge ship with harmonic excitation using an active controller so far several mechanisms have been developed to control the roll dynamics by means of anti rolling devices such as bilge keels water tanks rudder roll stabilization gyrostabilizers and fin stabilizers moradi and malekizade 2013 wang et al 2017 rudders can be used to reduce the roll motion since it produces an additional roll force and moment to the hull fang et al 2012 it is utilized as one actuator to control both heading and roll angles in case of rudder roll stabilization wang et al 2017 fin stabilizer is considered as one of the most attractive devices despite high cost of installation and additional hull resistance in which a pair of fins are installed on the bottom part of midship it is designed to suppress roll dynamics in case of ships with forward speed or turning operation karakas et al 2012 liang et al 2018a sometimes it is not an effective device since considerable damping will be generated for low speed ships fossen 1994 liang et al 2017 studied the roll damping mechanism of magnus rotating stabilizer for a ship with low speed recently a flapping fin stabilizer is popular for a ship at zero speed fan et al 2009 su et al 2017 zhang et al 2019 these anti rolling devices are closely related to ship dynamical behaviors and the appropriate control method should be selected to achieve satisfactory anti rolling effects in order to apply practical application like a zero speed fin stabilizer for a nonmotorized barge another slave controller has been utilized to trace the master controller su et al 2017 liang et al 2018b for roll reduction based on the zero speed fin stabilizer many of them employ pid and sliding mode on the master controller however one cannot see reasonable performance of the expected control input in advance therefore this study focuses on the robust main controller utilizing rudder actuator only to ensure the chattering free and to reveal the limitation of traditional pid on the nonlinear vessel roll behaviors vessel roll motion represents a significant nonlinearity due to its nonlinear righting arms and gives rich dynamical behaviors such as harmonic sub harmonic oscillation limit cycle and chaotic orbit even in regular beam seas wawrzynski and krata 2016 lee and you 2018 mitra et al 2018 one of the notable nonlinear behaviors is chaotic motion which displays characteristics of sensitive dependence on initial conditions and oscillates irregularly without any uniform pattern roopaei et al 2010 jordan and smith 2007 zaher 2007 because of its complexity and varieties chaotic motion has become an interesting topic in many research areas in turn chaos can be clearly understood by bifurcation analysis representing qualitative change in the activity of a dynamical system generally a bifurcation diagram is possible to show a qualitatively sudden change in system stability as a control parameter is smoothly varied for instance periodic solution periodic windows period doubling routes to chaos in accordance with the bifurcation parameters can be observed through stability diagram the sliding mode control smc is highly regarded as a useful method to make robust control law for nonlinear dynamical systems due to its strength of robustness against parameter uncertainties and exogenous disturbances however one major disadvantage of smc is the well known phenomenon so called chattering which results in the harmful destruction of actuators due to fatigue loads in addition the excessive activities of actuators like rudder and fin stabilizer could bring a substantial loss of stability of the marine vessels as well as cost effective navigation such a chattering phenomenon due to high frequency control switching became the main motivation of emerging second order sliding mode which shows flexibility on the choice of sliding variable higher order smc overcomes the restrictions of traditional smc by removing constraint of relative degree however it is difficult to eliminate completely the chattering in higher order smc since it includes signum structures multiplied by some bounds of uncertainties and its derivatives in advance edwards and shtessel 2016 in addition plestan et al 2010 proposed the adaptive law for an uncertain system without prior information of uncertainties and perturbations recently higher order smc such as twisting and super twisting with adaptation mechanisms have been emerged as an effective solution to reduce the chattering by hiding the switching term in the higher derivatives of the constraint function shtessel et al 2014 2017 babaei et al 2019 pisano 2000 in addition guo et al 2018 studied an adaptive law based on the twisting smc for a hypersonic reentry vehicle affected by disturbances with unknown bounds however this algorithm may result in the increase of control gains and chattering the super twisting algorithm sta boasts its robustness by realizing second order sliding mode without information about derivatives of sliding constraints levant 1993 a continuous control function of sta ensures the convergence of the sliding variable and its derivative in finite time boubzizi et al 2018 sometimes sta may cause overestimate the control gains in the process of ensuring the convergence of tracking errors in case of unknown bounds of uncertainties and faults mohamed et al 2017 shtessel et al 2012 investigated the methodology of the adaptive algorithm applied to the sta that allows the non overestimating control gains in general similar adaptive scheme developed by edwards and shtessel 2016 can be used without the information of allowable adaptive gain and disturbance bounds recently castaneda et al 2017 successfully have shown high performance of adaptive super twisting algorithm asta for an unmanned aerial vehicle this controller provides robustness since it does not require any information on perturbation bound han and pan 2016 proposed a gain scheduled idea based on asta to counteract uncertainties with unknown upper bounds this paper follows the approach of shtessel et al 2012 to overcome the problems of chattering and excessive control gains in suppressing roll oscillation of marine vessel subjected to external beam seas typical first order smc and twisting controller tw are taken into account for comparing the control performance the key contribution of this work is to present the perfect mitigation of chattering without overestimation of control gains against disturbances the stability of the adaptive control method is proved by means of lyapunov theory the simulation results have been presented to verify the effectiveness of the proposed control synthesis the rest of this paper is organized as follows section 2 briefly introduces the system dynamics of rolling ship governed by single degree of freedom sdof in section 3 asta has been applied to suppress roll oscillation and the closed loop stability is formerly proved using lyapunov theory section 4 presents extensive simulation results accompanied by various control algorithms for comparisons first order smc tw sta pid and smc with tanh function against disturbances finally the concluding remarks will be described in section 5 2 mathematical formulation the uncoupled sdof roll motion of a marine vessel in beam seas can be formulated by following nonlinear equation chai et al 2016 1 i 44 a 44 φ b 44 φ δ g z φ f s e a t where φ represents the roll angle rad with roll rate of φ rad s and acceleration of φ rad s2 i 44 and a 44 denote the roll moment of inertia and the hydrodynamic added mass coefficient kg m 2 respectively b 44 represents the linear hydrodynamic and viscous damping coefficient kg m 2 s δ is the displacement of the vessel g z φ is a righting arm which can be polynomial approximation to the restoring moment curve f s e a denotes the wave exciting moment in beam seas and a dot over a variable means differentiation with respect to dimensional time t s jiang et al 1996 the roll motion could be decoupled from the sway motion for the undamped or proportionally damped systems wang 2010 the damping moment is influenced by ship s forward speed ship profile anti roll fins and bilge keels bikdash et al 1994 in addition the damping moment acting on a ship consists of friction damping on the hull eddy shedding damping lift force damping free surface wave damping and bilge keel damping himeno 1981 chakrabarti 2001 since these components are coupled with each other it is difficult to quantify the damping mechanisms by a simplification a linear plus quadratic damping lpqd model is utilized based on a real ship case wang 2009 the nonlinear restoring arm can be approximated as g z φ c 1 φ c 3 φ 3 using the linear and cubic polynomials of φ the linear plus cubic stiffness form is reliable only for moderate values of roll angle 35 malara et al 2014 the moment curve of restoring arm is linearly proportional up to 10 only although the linear part is dominant for small roll angle the nonlinear term is effective as roll motion increases wu and mecue 2008 the nonlinear term in the restoring moment curve is usually considered as the negative value representing a softening property of rolling motion chai et al 2016 in the following the modified restoring moment curve such as a lolled righting arm curve is utilized to exhibit chaotic dynamical behaviors of the marine vessel wang 2010 falzarano 1990 compared with other environmental forces such as currents and winds sea waves have the largest effect on the ship roll motion in general for harmonic roll excitation the external wave f s e a can be expressed as 2 f s e a t h f r o l l ω cos ω t where f r o l l is the rolling moment amplitude n m per unit wave amplitude at a forced angular frequency ω and h is the wave amplitude jiang et al 1996 specifically by adding quadratic damping effect equation 1 can be rewritten as 1 1 we can t see the equation numbers 3 and 4 in the pdf version please check the layout for the manuscritpt 3 i 44 a 44 φ t b 44 φ t b 44 q φ t φ t c 1 δ φ t c 3 δ φ 3 t h f r o l l ω cos ω t where b 44 q is the quadratic damping coefficient for the nonlinear damper particularly a 44 b 44 b 44 q and f r o l l are calculated by the commercial hydrodynamic tribon program wang 2009 equation 3 can be scaled into a non dimensional homoclinic equation form using the perturbation parameter δ falzarano 1990 4 ω n 2 i 44 a 44 c 1 δ x τ ω n b 44 c 1 δ x τ ω n 2 b 44 q c 1 δ x τ x τ x τ c 3 c 1 x 3 τ h f r o l l ω c 1 δ cos ω τ where x τ φ t τ ω n t and ω ω ω n ω describes the ratio of excitation ω to natural angular frequency ω n then the simplified expression can be obtained as 5 x τ δ b 1 δ x τ δ b 2 δ x τ x τ x τ k x 3 τ δ f δ cos ω τ with δ b 1 δ b 44 ω n i 44 a 44 ω n b 44 c 1 δ ω n c 1 δ i 44 a 44 δ b 2 δ b 44 q i 44 a 44 k c 3 c 1 δ f δ h f r o l l ω n 2 i 44 a 44 h f r o l l c 1 δ where δ b 1 δ b 1 δ b 2 δ b 2 and δ f δ f b 1 and b 2 denote the amounts of damping k is the amount of non linearity in the restoring force in this model f represents the amplitude of the external disturbances lee and you 2018 the scaling parameter δ in damping and excitation terms is introduced to elucidate the relative order of its magnitude su and falzarano 2013 roberts and vasta 2000 3 control synthesis of adaptive sliding mode control 3 1 adaptive super twisting sliding mode control algorithm this study presents adaptive super twisting algorithm asta which can be employed to mitigate chattering significantly the active control input u by a roll actuator is computed by the integration of the discontinuous control the super twisting algorithm sta for smc is considered as follows 6 u t λ s sgn s θ θ t w 2 sgn s where the adaptive gains are introduced below 7 λ λ s s t w w s s t 3 2 control synthesis for suppression of ship roll motion by adding the actuation input u in equation 5 the complete control system represents a forced rolling system with active control input by 8 x b 1 x b 2 x x x k x 3 f cos ω τ u where the periodic excitation f cos ω τ is given as a time varying disturbance d in fact an active controller is important to achieve satisfactory anti rolling effect with selecting the state variables as x x 1 and x x 2 the governing equation 8 can be rewritten into the state space representation as follows 10 x a x f x τ b u b 1 d where state vector x system matrices a b b 1 and nonlinear term f are described by 11 x x 1 x 2 a 0 1 1 b 1 b b 1 0 1 f x τ 0 b 2 x 2 x 2 k x 1 3 the control block diagram for the asta is depicted in fig 1 if the tracking error is defined with e x x d then the sliding variable is selected as 12 s p 1 e p 2 e where p 1 and p 2 are positive constants ℜ which can determine the convergence rate of the ship roll system the sliding mode dynamics can be derived as 13 s p 0 p 1 d p 1 u where 14 p 0 p 1 b 1 x 2 b 2 x 2 x 2 x 1 k x 1 3 x d p 2 x 2 x d from the viewpoint of smc theory the main objective of this control problem can be evaluated to ensure the robust stabilization of the sliding mode dynamics asymptotically or s 0 for this purpose the following active controller u is considered 15 u p 0 p 1 1 p 1 u s w where the former part is the equivalent part and the other is switching part thus the sliding mode dynamics in equation 13 can be rewritten as 16 s p 1 d u s w in the switching part the super twisting controller u s w is designed to reach the sliding variable mode with disturbances 17 u s w λ s sgn s θ θ t w 2 sgn s specifically the adaptive gains can be given as follows 18 λ ω 1 γ 1 2 sgn s μ if λ λ m η if λ λ m w 2 ε λ where some parameters ω 1 γ 1 μ η ε are positive constants ℜ and λ m is selected as an arbitrary small positive constant ℜ based on lyapunov stability theory the control synthesis and stability of asta can be proved below theorem 1 consider the uncertain roll system of marine vessel in equation 10 and the sliding variable in equation 12 the roll trajectories of controlled vessel can converge to the desired roll angular position in finite time against disturbances if the active controller 15 and its adaptive gain 18 are successfully implemented proof first consider the sliding mode dynamics in equation 16 and the designed super twisting controller in equation 17 then the sliding mode dynamics can be presented as 19 s 1 λ s sgn s θ p 1 d θ w 2 sgn s for the proof a new state vector z is defined as 20 z z 1 z 2 t s sgn s θ t then equation 20 can be rewritten as 21 z 1 1 2 z 1 λ z 1 z 2 p 1 d z 2 w 2 z 1 z 1 from equation 16 the exogenous disturbance d can be assumed as a bounded function satisfying a following inequality 22 p 1 d α 0 s where α 0 is a positive constant ℜ it can be derived that 23 p 1 d α x t s sgn s α x t z 1 where α x t is a bounded function with 0 α x t α 0 then equation 21 can be rewritten in a vector matrix form 24 z 1 z 2 q z 1 z 1 z 2 where 25 q z 1 1 2 z 1 λ ρ 1 x t 1 w 0 as the second step a lyapunov function candidate is presented to verify the stability of control system given by equation 24 and equation 25 26 v z λ w v 0 z 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 where 27 v 0 z β 4 ε 2 z 1 2 z 2 2 4 ε z 1 z 2 z t g z g β 4 ε 2 2 ε 2 ε 1 28 ε λ λ λ ε w w w in this formulation some parameters β ε λ w are positive constants ℜ satisfying λ λ and w w then the time derivative of the lyapunov function candidate 26 is given as 29 v z λ w z t g z z t g z 1 γ 1 ε λ λ 1 γ 2 ε w w for the first term in equation 29 it can be obtained that 30 v 0 z z t g z z t g z 1 2 z 1 z t j z the matrix j according to the equations 23 and 27 can be calculated that 31 j j 11 j 12 j 21 j 22 with 32 j 11 2 β λ 4 ε 2 ε λ w 2 α β 4 ε 2 j 12 j 21 w 2 ε λ β 4 ε 2 2 ε α j 22 4 ε when the equality w 2 ε λ is selected the matrix j will be a positive semi definite with minimum eigenvalue λ min j 2 ε if the following inequality holds 33 α 1 α 0 β 4 ε 2 β 2 ε α 0 β 4 ε 2 2 8 ε β therefore it can be derived from equation 30 that 34 v 0 z 1 2 z 1 z t j z 2 ε 2 z 1 z t z ε z 1 z 2 for the matrix j with maximum eigenvalue λ max it is bounded by 35 λ min j z 2 z t j z λ max j z 2 now equation 20 can be rewritten as 36 z 2 z 1 2 z 2 2 s z 2 2 and 37 s z v 0 1 2 z λ min 1 2 f finally it can be obtained that 38 v 0 z κ v 0 1 2 where 39 κ ε λ min 1 2 q λ max q by using a well known inequality x 2 y 2 z 2 x y z and combining with equations 29 and 38 the following inequality is obtained 40 v z λ w κ v 0 1 2 ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ 1 γ 1 ε λ λ 1 γ 2 ε w w ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ r v 0 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 1 γ 1 ε λ λ 1 γ 2 ε w w ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ where r min κ ω 1 ω 2 which will return the minimum value in a given list of arguments let v 1 v 0 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 and ξ ε λ 1 γ 1 λ ω 1 2 γ 1 ε w 1 γ 2 w ω 2 2 γ 2 equation 40 can be further described by 41 v z λ w r v 1 1 2 ξ furthermore some conditions should be discussed for the proof when s μ and λ λ m the adaptive gain 19 and the term ξ are respectively computed as 42 λ ω 1 γ 1 2 and 44 ξ ε w 1 γ 2 w ω 2 2 γ 2 by selecting ε ω 2 2 ω 1 γ 2 γ 1 and w 2 ε λ the term ξ 0 can be met meanwhile equation 41 can be rewritten as 45 v z λ w r v 1 1 2 with r 0 therefore the derivative of the lyapunov function is negative define when s μ and λ λ m it can be obtained that λ η note that if λ m is an arbitrary small positive constant ℜ this condition only holds in a short time and the value of λ will increase fast and meet the condition of λ λ m eventually when s μ and λ λ m the adaptive gain 18 and the term ξ are computed as 46 λ ω 1 γ 1 2 and 47 ξ 2 ε λ ω 1 2 γ 1 ε w 2 ε ω 1 γ 2 γ 1 2 ω 2 2 γ 2 clearly it is obtained that ξ 0 and λ 0 then the derivative of the lyapunov function becomes indefinite according to equations 41 and 46 because of λ 0 s will continue to increase until it is larger than μ if the condition s μ is true the s will converge to zero as discussed above which means that the sliding variable s will return to the domain s μ again finally it can be derived that the sliding variable will stay in a domain s μ 0 stably with μ 0 μ 1 in the sliding manifold it is noted that the condition of λ λ m is similar to that of s μ and λ λ m 4 simulation results the proposed smc with asta has been implemented to suppress roll oscillation of a marine vessel this approach is aiming to solve chattering problems with improving control accuracy simultaneously against disturbances the ship parameters of the rolling system used for numerical simulation are listed in table 1 the ship model is a single deck and nonmotorized barge equipped with a double bottom wang 2009 the marine barge is used to make sure that the cargo carrying capability is improved and more bulk can be transferred prior to applying controller nonlinear roll motion will be introduced using a bifurcation diagram in the numerical simulation tests specific control parameters are selected as p 1 10 p 2 5 ρ 1 1 2 r 1 1 r 2 0 1 ω 1 25 γ 1 0 15 ε 0 1 μ 0 01 λ m 0 01 k p 0 6 k i 0 01 k d 0 1 and λ 6 in case of non adaptation particularly the initial conditions of the roll dynamics are chosen as φ 0 φ 0 5 rad 0 1 rad s it is noted that the unexpected external disturbances such as interactions from other ships lead to large additional roll motions and those disturbances might cause eventually cargo damage or operation interruption in this study the total external disturbances considering such as the waves currents winds and interactions will be given as 48 d τ f cos ω τ n kg m a ship rolling without active controller represents complex dynamical behaviors such as multi periodic and chaotic states depending on specific initial conditions fig 2 illustrates the dynamical behaviors for the different values of f with a time period of t where the dynamic responses of roll angle φ at every period of bifurcation parameter are plotted according to the wave amplitude h the barge undergoes different chaotic phenomena the nonlinearity terms in damping and restoring moment curve as well as excitation disturbances cause chaos oscillation as previously mentioned chaotic motion is sensitive to the initial conditions without active controllers this stability diagrams of figs 2 a b and c represent the barge suddenly changes its motion to a prolonged chaos at the end of stable 1 periodic motion or 1t this means that the barge oscillates through one period while wave disturbances will vibrate with one period the barge will remain calm comparatively by the time chaos appears it is observed that chaos occurs near or over ω 1 specifically if the control parameter ω increases for the case of f 0 5 the rolling behaviors exhibit from chaotic to chaotic through the subharmonic motion of 2t at the point of ω 1 15 as illustrated in fig 2 a when the control parameter ω is increased beyond periodic region in fig 2 b for the case of f 0 7 the chaotic orbits of the barge are spread incrementally in the range of ω 1 08 1 23 the stable periodic solutions called the periodic windows can be observed between the chaotic clouds of dots in fig 2 b as the periodic windows decrease in fig 2 c for the case of f 0 9 the chaotic behavior is dominant in the range of ω 1 18 1 28 therefore it is observed that irregular oscillations of the barge are dominant beyond ω 1 05 when the wave amplitude increases nonlinear roll motions can be illustrated using phase plane analysis to describe qualitative characteristics of the roll trajectories as depicted in fig 3 a and fig 10 a fig 3 shows the phase portraits of chaotic motion and time history curves at forcing amplitude f 0 9 and ω 1 25 in the phase plane the coordinates in fig 3 denote roll rate of φ rad s and roll angle φ rad respectively as one can see chaotic behavior the barge oscillates irregularly without any obvious periodicity the uncontrolled cases of figs 2 and 3 are obtained by means of equation 5 nonlinear dynamical behaviors are dominant even though the roll is given by harmonic excitation the control goal is to suppress these irregular oscillations using the proposed asta the controlled cases of the forced roll system with active controller can be achieved by equation 8 in section 3 2 in order to compare the effect of control input same excitation f 0 9 and ω 1 25 is considered both the uncontrolled controlled cases of figs 4 7 and 10 furthermore different excitation will be considered later as shown in figs 9 and 11 two typical controllers such as first order smc twisting controller tw are introduced to compare the control performances in figs 4 7 based on the basic work of shtessel et al 2014 the control input u s m c of first order smc and u t w of tw is designed as follows 49 u s m c t ρ 1 sgn s u t w t r 1 sgn s r 2 sgn s r 1 r 2 0 in addition the case of sta based on the equation 17 is compared with constant gain λ in figs 4 7 the parameters p 1 10 and p 2 5 of the sliding variable s in the equation 12 are equally used for all five controllers first order smc tw sta asta smc with tanh function in fact the gains of ρ 1 1 2 r 1 1 r 2 0 1 and λ 6 in the control algorithms are determined through many simulation tests the simulation results of the controlled roll system using asta are dependent on control parameters understanding of the characteristics of parameters helps to obtain high performance for control system the parameters p 1 p 2 ℜ in sliding variables affect the speed of convergence and the chattering for roll motion in case of increasing p 1 it will make slower convergence on roll angle and higher peak response of roll rate in a transient state by decreasing p 2 the gentle slope of roll angle is changed into a steep incline and peak of roll rate tends to increase negatively since chattering occurs slightly in both of the fore mentioned cases proper sliding variables should be set the parameter of ω 1 relates to maximum overshoot of roll angle and performance of accuracy in case of decreasing value of ω 1 roll angle starting at the initial position tilts towards the inclined direction and immediately returns to suppress roll oscillation accompanied by a slight increase of chattering on the other hand the roll motion leads to performance of inaccuracy by increasing value of ω 1 in addition the parameters γ 1 and ε are mainly related to the smoother responses of sliding variables and control inputs and the parameter μ plays an important role in stability of controller finally the state variables fail to converge in case of increasing value of parameter λ m figs 4 and 5 depict the comparison of time responses of state variables in general nonlinear roll motion in fig 3 can be suppressed by means of all control algorithms except pid controller it can be seen that the barge returns to upright position with the help of active actuators the tw and asta provide a quite similar performance in terms of transient and steady state responses in fig 4 also it s difficult to differentiate between the ship roll responses of first order smc and sta non adaptation although the barge ship initially lists to starboard side 5 due to external disturbances it retains its upright equilibrium condition after the time of τ 8 as shown in fig 4 therefore seafarers on board may work as if in ground whereas roll angles relatively curve in a matched form angular rates in fig 5 exhibit noticeably different forms in the transient state from the magnification zoom of a part of responses in fig 5 one can see a better performance of control accuracy in steady state responses by the proposed asta even if the magnitudes are relatively small sometimes careful contrast of the control responses shows big differences fig 6 depicts control activities for all control algorithms considered first order smc tw sta non adaptation and asta chattering can be observed for the system responses of first order smc in fig 6 a tw in fig 6 b and sta in fig 6 c discontinuous high frequency features are shown in figs 6 a and b in particular it is actually impractical to provide physical actuator signals in mechanical means the high frequency control switching terms ρ 1 sgn s and r 1 sgn s in equation 49 cause chattering in the sliding mode due to discrete time features the switching control law is to drive the state trajectories on the sliding surface regardless of external disturbances as expected discontinuous control activity on the sliding mode yields chattering phenomenon shtessel et al 2014 even though first order smc and tw provide good suppression illustrated in fig 6 chattering occurs in control activities due to their discontinuous switching actions causing actuator fatigue loads in fact these switching control actions may result in the destructive phenomenon of actuators easy damages of other mechanisms and excitations of unmodelled actuator dynamics of second order or greater in case of sta with constant gain it is hard to expect noticeable mitigation of chattering as shown in fig 6 c in contrast with the mentioned three controllers asta shows that chattering is greatly suppressed with a continuous curve reducing fatigue loads and guaranteeing good responses as shown in fig 6 d it should be noted that the chattering reduction is one of crucial tasks when exploiting the advantages of the sliding mode controllers to suppress roll oscillation of nonmotorized barge all aforementioned controllers are based on the concept of sliding variable and sliding surface thus the control activities of fig 6 highly depend on the variation of sliding variable fig 7 represents the sliding variable for all four controllers the sum of position error and velocity error decreases to zero in finite time by all controllers as shown in the magnification zoom the sliding variables of smc and tw draw zigzag motion after arriving at the sliding surface in figs 7 a and b on the contrary the sliding variables of sta and asta demonstrate smooth curve consistently in figs 7 c and d fig 8 shows the controlled phase portraits of roll angle and roll rate using asta the system trajectories can be seen with the starting and ending point in the phase plane as the control gain ω 1 increases the magnitude of trajectories decreases it can be shown that the proposed asta accomplishes the goal of non estimating control gains the controlled rolling response represents insensitive to the initial conditions since roll motion is subject to surface equation itself fig 9 displays the estimated adaptive gains of asta when the amplitude of wave decreases to f 0 5 the magnitude of the adaptive gains also decreases starting at the zero point the gains vary at regular intervals it reveals that adaptation algorithm achieves the control goal without overestimating gains in order to show the superiority of the proposed asta the responses of roll motion using conventional pid are represented the control input u p i d is expressed as 50 u p i d t k p e t k i o t e τ d τ k d d e t d t where k p k i and k d are the proportional integral and derivative gains same disturbance is considered as f 0 9 and ω 1 25 for the case of pid controller the controlled phase portraits by proposed asta in fig 8 clearly demonstrate the starting and ending point however the controlled responses by pid in figs 10 a and b are not improved when comparing with the uncontrolled cases of figs 3 a and b the responses merely decrease with the amplitude affected by the control activity of pid and the barge still exhibits chaotic motions until 750 s as time goes to infinity the controlled rolling system by pid represents a period 2 motion after chaos phenomena irregular behavior of roll angle in fig 10 b transformed into a periodic motion after 750 s also the unstable response can be seen with increased fluctuation from 750 s in fig 10 c the controlled rolling system using pid still possesses a sensitive property depending on the control parameters test results show that pid is not suitable for suppressing nonlinear rolling system due to its strong nonlinearity the control activities will vary depending on the magnitude of disturbances especially in case of the sigmoid function the proposed asta is compared with smc with hyperbolic tangent function under different disturbances of f 0 9 and f 2 1 depicted in fig 11 two different cases of 0 9 cos 1 25 τ and 2 1 cos 1 25 τ are taken into account for disturbances same parameters in previous asta system except increasing control gain of ω 1 50 are adopted in case of f 2 1 also the hyperbolic tangent function tanh is an example of sigmoid functions and it is defined as aghababa and akbari 2012 51 x tanh x ς x e x ς e x ς e x ς e x ς where ς is positive scalar and this influences the steepness of the hyperbolic function for the best performance the parameter ς is selected as 0 05 in case of f 0 9 and ς 0 001 in case of f 2 1 respectively as the disturbance increases the parameter ς also should be adjusted to obtain the better results fig 11 a shows the comparison of roll responses by means of asta and smc with tanh function according to different disturbances in case of f 0 9 both control systems suppress roll motion significantly when f 2 1 the roll responses will put another complexion the proposed asta still compensates it successfully otherwise convergence of state variables by tanh function is proceeding with difficulty if the roll motion is controlled by tanh function chattering is reactivated in case of high disturbances f 2 1 as shown in fig 11 d it is known that severe chattering can be alleviated by means of smooth sigmoid function such as tanh function instead of discontinuous sgn function in fact the hyperbolic tangent function presents strong performance in a condition of low disturbances in case of high disturbances tanh function does not provide the control goal of both convergence rate and chattering mitigation the smc approach of tanh function alone is vulnerable to the disturbances because s trajectories are constrained in vicinity of sliding surface rather than on the surface shtessel et al 2012 accordingly this control mechanism alone is deemed an inappropriate method for marine vessels in navigating ocean environments as well as the nonmotorized barge exposed to severe roll excitation 5 conclusions in this paper robust smc with asta has been presented for suppressing chaotic roll dynamics for the nonmotorized barge in regular beam disturbances prior to synthesizing active controllers the bifurcation techniques are employed to illustrate roll motion analysis in detail on account of the strong nonlinearity of restoring force the crews on board can t be complacent about roll motions specifically it is notable that chaos appeared at the end of stable periodic motion next the robust controller actuated by rudder mechanism has been presented to achieve the control goal of stabilizing vessel roll dynamics in fact the active controlled systems can significantly improve the strengths of common smc synthesis guaranteeing accuracy robustness and simple implementation against external disturbances the performances of the proposed controller asta have been compared with typical first order smc twisting controller tw sta with non adaption pid controller and smc with hyperbolic tangent function simulation results show that the nonmotorized barge listed 5 to side perfectly recovered its upright position using all sliding mode controllers especially asta has successfully resolved the chattering problems as well as ensuring the desired level of control accuracy and robustness however first order smc and tw have failed to prevent chattering due to the presence of discontinuous control structure it is unnecessary to spend excessive control activity possibly leading to fatigue actuator loads since asta effectively provides smoother operations of actuators finally this paper demonstrates that the smc with asta is one of the powerful robust control synthesis for alleviating nonlinear roll motion of marine vessels since it resolves the chattering problems and provides robust performance against significant disturbances appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106724 
22267,this paper investigates roll suppression of marine vessels subjected to harmonic wave excitations bifurcation analysis is utilized to describe the stability range in detail where dynamical behaviors including chaos are observed under variations of control parameters adaptive sliding mode control with super twisting algorithm has been introduced to reduce chattering phenomenon of control activity as well as to guarantee roll control accuracy the stability of the complete controlled system with adaptive mechanism has been proven by lyapunov stability theory the key contribution of this work is to show the significant mitigation of chattering with non overestimating gains using a novel sliding model control structure extensive simulation results have been provided to verify the effectiveness of the proposed robust controller against exogenous disturbances finally the adaptive super twisting controller provides rapid convergence on sliding mode variables on roll motions with high accuracy and the chattering has been considerably reduced or almost eliminated to be desired keywords roll oscillation disturbances chattering chaos sliding mode control adaptive super twisting algorithm 1 introduction controlling roll oscillations of a marine vessel is one of crucial issues in modern maritime technology it closely relates to the navigation safety cargo protection structural failure of vessels working efficiency of all crews and comfort of passengers in harsh sea circumstances uncontrolled small ships such as fishing boats and yachts may capsize due to severe roll excitations without proper roll control mechanism even the large passenger ships lost its control in maritime disaster and may result in a substantial loss of life this paper intends to pursue suppressing chaotic roll motions for a barge ship with harmonic excitation using an active controller so far several mechanisms have been developed to control the roll dynamics by means of anti rolling devices such as bilge keels water tanks rudder roll stabilization gyrostabilizers and fin stabilizers moradi and malekizade 2013 wang et al 2017 rudders can be used to reduce the roll motion since it produces an additional roll force and moment to the hull fang et al 2012 it is utilized as one actuator to control both heading and roll angles in case of rudder roll stabilization wang et al 2017 fin stabilizer is considered as one of the most attractive devices despite high cost of installation and additional hull resistance in which a pair of fins are installed on the bottom part of midship it is designed to suppress roll dynamics in case of ships with forward speed or turning operation karakas et al 2012 liang et al 2018a sometimes it is not an effective device since considerable damping will be generated for low speed ships fossen 1994 liang et al 2017 studied the roll damping mechanism of magnus rotating stabilizer for a ship with low speed recently a flapping fin stabilizer is popular for a ship at zero speed fan et al 2009 su et al 2017 zhang et al 2019 these anti rolling devices are closely related to ship dynamical behaviors and the appropriate control method should be selected to achieve satisfactory anti rolling effects in order to apply practical application like a zero speed fin stabilizer for a nonmotorized barge another slave controller has been utilized to trace the master controller su et al 2017 liang et al 2018b for roll reduction based on the zero speed fin stabilizer many of them employ pid and sliding mode on the master controller however one cannot see reasonable performance of the expected control input in advance therefore this study focuses on the robust main controller utilizing rudder actuator only to ensure the chattering free and to reveal the limitation of traditional pid on the nonlinear vessel roll behaviors vessel roll motion represents a significant nonlinearity due to its nonlinear righting arms and gives rich dynamical behaviors such as harmonic sub harmonic oscillation limit cycle and chaotic orbit even in regular beam seas wawrzynski and krata 2016 lee and you 2018 mitra et al 2018 one of the notable nonlinear behaviors is chaotic motion which displays characteristics of sensitive dependence on initial conditions and oscillates irregularly without any uniform pattern roopaei et al 2010 jordan and smith 2007 zaher 2007 because of its complexity and varieties chaotic motion has become an interesting topic in many research areas in turn chaos can be clearly understood by bifurcation analysis representing qualitative change in the activity of a dynamical system generally a bifurcation diagram is possible to show a qualitatively sudden change in system stability as a control parameter is smoothly varied for instance periodic solution periodic windows period doubling routes to chaos in accordance with the bifurcation parameters can be observed through stability diagram the sliding mode control smc is highly regarded as a useful method to make robust control law for nonlinear dynamical systems due to its strength of robustness against parameter uncertainties and exogenous disturbances however one major disadvantage of smc is the well known phenomenon so called chattering which results in the harmful destruction of actuators due to fatigue loads in addition the excessive activities of actuators like rudder and fin stabilizer could bring a substantial loss of stability of the marine vessels as well as cost effective navigation such a chattering phenomenon due to high frequency control switching became the main motivation of emerging second order sliding mode which shows flexibility on the choice of sliding variable higher order smc overcomes the restrictions of traditional smc by removing constraint of relative degree however it is difficult to eliminate completely the chattering in higher order smc since it includes signum structures multiplied by some bounds of uncertainties and its derivatives in advance edwards and shtessel 2016 in addition plestan et al 2010 proposed the adaptive law for an uncertain system without prior information of uncertainties and perturbations recently higher order smc such as twisting and super twisting with adaptation mechanisms have been emerged as an effective solution to reduce the chattering by hiding the switching term in the higher derivatives of the constraint function shtessel et al 2014 2017 babaei et al 2019 pisano 2000 in addition guo et al 2018 studied an adaptive law based on the twisting smc for a hypersonic reentry vehicle affected by disturbances with unknown bounds however this algorithm may result in the increase of control gains and chattering the super twisting algorithm sta boasts its robustness by realizing second order sliding mode without information about derivatives of sliding constraints levant 1993 a continuous control function of sta ensures the convergence of the sliding variable and its derivative in finite time boubzizi et al 2018 sometimes sta may cause overestimate the control gains in the process of ensuring the convergence of tracking errors in case of unknown bounds of uncertainties and faults mohamed et al 2017 shtessel et al 2012 investigated the methodology of the adaptive algorithm applied to the sta that allows the non overestimating control gains in general similar adaptive scheme developed by edwards and shtessel 2016 can be used without the information of allowable adaptive gain and disturbance bounds recently castaneda et al 2017 successfully have shown high performance of adaptive super twisting algorithm asta for an unmanned aerial vehicle this controller provides robustness since it does not require any information on perturbation bound han and pan 2016 proposed a gain scheduled idea based on asta to counteract uncertainties with unknown upper bounds this paper follows the approach of shtessel et al 2012 to overcome the problems of chattering and excessive control gains in suppressing roll oscillation of marine vessel subjected to external beam seas typical first order smc and twisting controller tw are taken into account for comparing the control performance the key contribution of this work is to present the perfect mitigation of chattering without overestimation of control gains against disturbances the stability of the adaptive control method is proved by means of lyapunov theory the simulation results have been presented to verify the effectiveness of the proposed control synthesis the rest of this paper is organized as follows section 2 briefly introduces the system dynamics of rolling ship governed by single degree of freedom sdof in section 3 asta has been applied to suppress roll oscillation and the closed loop stability is formerly proved using lyapunov theory section 4 presents extensive simulation results accompanied by various control algorithms for comparisons first order smc tw sta pid and smc with tanh function against disturbances finally the concluding remarks will be described in section 5 2 mathematical formulation the uncoupled sdof roll motion of a marine vessel in beam seas can be formulated by following nonlinear equation chai et al 2016 1 i 44 a 44 φ b 44 φ δ g z φ f s e a t where φ represents the roll angle rad with roll rate of φ rad s and acceleration of φ rad s2 i 44 and a 44 denote the roll moment of inertia and the hydrodynamic added mass coefficient kg m 2 respectively b 44 represents the linear hydrodynamic and viscous damping coefficient kg m 2 s δ is the displacement of the vessel g z φ is a righting arm which can be polynomial approximation to the restoring moment curve f s e a denotes the wave exciting moment in beam seas and a dot over a variable means differentiation with respect to dimensional time t s jiang et al 1996 the roll motion could be decoupled from the sway motion for the undamped or proportionally damped systems wang 2010 the damping moment is influenced by ship s forward speed ship profile anti roll fins and bilge keels bikdash et al 1994 in addition the damping moment acting on a ship consists of friction damping on the hull eddy shedding damping lift force damping free surface wave damping and bilge keel damping himeno 1981 chakrabarti 2001 since these components are coupled with each other it is difficult to quantify the damping mechanisms by a simplification a linear plus quadratic damping lpqd model is utilized based on a real ship case wang 2009 the nonlinear restoring arm can be approximated as g z φ c 1 φ c 3 φ 3 using the linear and cubic polynomials of φ the linear plus cubic stiffness form is reliable only for moderate values of roll angle 35 malara et al 2014 the moment curve of restoring arm is linearly proportional up to 10 only although the linear part is dominant for small roll angle the nonlinear term is effective as roll motion increases wu and mecue 2008 the nonlinear term in the restoring moment curve is usually considered as the negative value representing a softening property of rolling motion chai et al 2016 in the following the modified restoring moment curve such as a lolled righting arm curve is utilized to exhibit chaotic dynamical behaviors of the marine vessel wang 2010 falzarano 1990 compared with other environmental forces such as currents and winds sea waves have the largest effect on the ship roll motion in general for harmonic roll excitation the external wave f s e a can be expressed as 2 f s e a t h f r o l l ω cos ω t where f r o l l is the rolling moment amplitude n m per unit wave amplitude at a forced angular frequency ω and h is the wave amplitude jiang et al 1996 specifically by adding quadratic damping effect equation 1 can be rewritten as 1 1 we can t see the equation numbers 3 and 4 in the pdf version please check the layout for the manuscritpt 3 i 44 a 44 φ t b 44 φ t b 44 q φ t φ t c 1 δ φ t c 3 δ φ 3 t h f r o l l ω cos ω t where b 44 q is the quadratic damping coefficient for the nonlinear damper particularly a 44 b 44 b 44 q and f r o l l are calculated by the commercial hydrodynamic tribon program wang 2009 equation 3 can be scaled into a non dimensional homoclinic equation form using the perturbation parameter δ falzarano 1990 4 ω n 2 i 44 a 44 c 1 δ x τ ω n b 44 c 1 δ x τ ω n 2 b 44 q c 1 δ x τ x τ x τ c 3 c 1 x 3 τ h f r o l l ω c 1 δ cos ω τ where x τ φ t τ ω n t and ω ω ω n ω describes the ratio of excitation ω to natural angular frequency ω n then the simplified expression can be obtained as 5 x τ δ b 1 δ x τ δ b 2 δ x τ x τ x τ k x 3 τ δ f δ cos ω τ with δ b 1 δ b 44 ω n i 44 a 44 ω n b 44 c 1 δ ω n c 1 δ i 44 a 44 δ b 2 δ b 44 q i 44 a 44 k c 3 c 1 δ f δ h f r o l l ω n 2 i 44 a 44 h f r o l l c 1 δ where δ b 1 δ b 1 δ b 2 δ b 2 and δ f δ f b 1 and b 2 denote the amounts of damping k is the amount of non linearity in the restoring force in this model f represents the amplitude of the external disturbances lee and you 2018 the scaling parameter δ in damping and excitation terms is introduced to elucidate the relative order of its magnitude su and falzarano 2013 roberts and vasta 2000 3 control synthesis of adaptive sliding mode control 3 1 adaptive super twisting sliding mode control algorithm this study presents adaptive super twisting algorithm asta which can be employed to mitigate chattering significantly the active control input u by a roll actuator is computed by the integration of the discontinuous control the super twisting algorithm sta for smc is considered as follows 6 u t λ s sgn s θ θ t w 2 sgn s where the adaptive gains are introduced below 7 λ λ s s t w w s s t 3 2 control synthesis for suppression of ship roll motion by adding the actuation input u in equation 5 the complete control system represents a forced rolling system with active control input by 8 x b 1 x b 2 x x x k x 3 f cos ω τ u where the periodic excitation f cos ω τ is given as a time varying disturbance d in fact an active controller is important to achieve satisfactory anti rolling effect with selecting the state variables as x x 1 and x x 2 the governing equation 8 can be rewritten into the state space representation as follows 10 x a x f x τ b u b 1 d where state vector x system matrices a b b 1 and nonlinear term f are described by 11 x x 1 x 2 a 0 1 1 b 1 b b 1 0 1 f x τ 0 b 2 x 2 x 2 k x 1 3 the control block diagram for the asta is depicted in fig 1 if the tracking error is defined with e x x d then the sliding variable is selected as 12 s p 1 e p 2 e where p 1 and p 2 are positive constants ℜ which can determine the convergence rate of the ship roll system the sliding mode dynamics can be derived as 13 s p 0 p 1 d p 1 u where 14 p 0 p 1 b 1 x 2 b 2 x 2 x 2 x 1 k x 1 3 x d p 2 x 2 x d from the viewpoint of smc theory the main objective of this control problem can be evaluated to ensure the robust stabilization of the sliding mode dynamics asymptotically or s 0 for this purpose the following active controller u is considered 15 u p 0 p 1 1 p 1 u s w where the former part is the equivalent part and the other is switching part thus the sliding mode dynamics in equation 13 can be rewritten as 16 s p 1 d u s w in the switching part the super twisting controller u s w is designed to reach the sliding variable mode with disturbances 17 u s w λ s sgn s θ θ t w 2 sgn s specifically the adaptive gains can be given as follows 18 λ ω 1 γ 1 2 sgn s μ if λ λ m η if λ λ m w 2 ε λ where some parameters ω 1 γ 1 μ η ε are positive constants ℜ and λ m is selected as an arbitrary small positive constant ℜ based on lyapunov stability theory the control synthesis and stability of asta can be proved below theorem 1 consider the uncertain roll system of marine vessel in equation 10 and the sliding variable in equation 12 the roll trajectories of controlled vessel can converge to the desired roll angular position in finite time against disturbances if the active controller 15 and its adaptive gain 18 are successfully implemented proof first consider the sliding mode dynamics in equation 16 and the designed super twisting controller in equation 17 then the sliding mode dynamics can be presented as 19 s 1 λ s sgn s θ p 1 d θ w 2 sgn s for the proof a new state vector z is defined as 20 z z 1 z 2 t s sgn s θ t then equation 20 can be rewritten as 21 z 1 1 2 z 1 λ z 1 z 2 p 1 d z 2 w 2 z 1 z 1 from equation 16 the exogenous disturbance d can be assumed as a bounded function satisfying a following inequality 22 p 1 d α 0 s where α 0 is a positive constant ℜ it can be derived that 23 p 1 d α x t s sgn s α x t z 1 where α x t is a bounded function with 0 α x t α 0 then equation 21 can be rewritten in a vector matrix form 24 z 1 z 2 q z 1 z 1 z 2 where 25 q z 1 1 2 z 1 λ ρ 1 x t 1 w 0 as the second step a lyapunov function candidate is presented to verify the stability of control system given by equation 24 and equation 25 26 v z λ w v 0 z 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 where 27 v 0 z β 4 ε 2 z 1 2 z 2 2 4 ε z 1 z 2 z t g z g β 4 ε 2 2 ε 2 ε 1 28 ε λ λ λ ε w w w in this formulation some parameters β ε λ w are positive constants ℜ satisfying λ λ and w w then the time derivative of the lyapunov function candidate 26 is given as 29 v z λ w z t g z z t g z 1 γ 1 ε λ λ 1 γ 2 ε w w for the first term in equation 29 it can be obtained that 30 v 0 z z t g z z t g z 1 2 z 1 z t j z the matrix j according to the equations 23 and 27 can be calculated that 31 j j 11 j 12 j 21 j 22 with 32 j 11 2 β λ 4 ε 2 ε λ w 2 α β 4 ε 2 j 12 j 21 w 2 ε λ β 4 ε 2 2 ε α j 22 4 ε when the equality w 2 ε λ is selected the matrix j will be a positive semi definite with minimum eigenvalue λ min j 2 ε if the following inequality holds 33 α 1 α 0 β 4 ε 2 β 2 ε α 0 β 4 ε 2 2 8 ε β therefore it can be derived from equation 30 that 34 v 0 z 1 2 z 1 z t j z 2 ε 2 z 1 z t z ε z 1 z 2 for the matrix j with maximum eigenvalue λ max it is bounded by 35 λ min j z 2 z t j z λ max j z 2 now equation 20 can be rewritten as 36 z 2 z 1 2 z 2 2 s z 2 2 and 37 s z v 0 1 2 z λ min 1 2 f finally it can be obtained that 38 v 0 z κ v 0 1 2 where 39 κ ε λ min 1 2 q λ max q by using a well known inequality x 2 y 2 z 2 x y z and combining with equations 29 and 38 the following inequality is obtained 40 v z λ w κ v 0 1 2 ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ 1 γ 1 ε λ λ 1 γ 2 ε w w ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ r v 0 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 1 γ 1 ε λ λ 1 γ 2 ε w w ω 1 2 γ 1 ε λ ω 2 2 γ 2 ε λ where r min κ ω 1 ω 2 which will return the minimum value in a given list of arguments let v 1 v 0 1 2 γ 1 ε λ 2 1 2 γ 2 ε w 2 and ξ ε λ 1 γ 1 λ ω 1 2 γ 1 ε w 1 γ 2 w ω 2 2 γ 2 equation 40 can be further described by 41 v z λ w r v 1 1 2 ξ furthermore some conditions should be discussed for the proof when s μ and λ λ m the adaptive gain 19 and the term ξ are respectively computed as 42 λ ω 1 γ 1 2 and 44 ξ ε w 1 γ 2 w ω 2 2 γ 2 by selecting ε ω 2 2 ω 1 γ 2 γ 1 and w 2 ε λ the term ξ 0 can be met meanwhile equation 41 can be rewritten as 45 v z λ w r v 1 1 2 with r 0 therefore the derivative of the lyapunov function is negative define when s μ and λ λ m it can be obtained that λ η note that if λ m is an arbitrary small positive constant ℜ this condition only holds in a short time and the value of λ will increase fast and meet the condition of λ λ m eventually when s μ and λ λ m the adaptive gain 18 and the term ξ are computed as 46 λ ω 1 γ 1 2 and 47 ξ 2 ε λ ω 1 2 γ 1 ε w 2 ε ω 1 γ 2 γ 1 2 ω 2 2 γ 2 clearly it is obtained that ξ 0 and λ 0 then the derivative of the lyapunov function becomes indefinite according to equations 41 and 46 because of λ 0 s will continue to increase until it is larger than μ if the condition s μ is true the s will converge to zero as discussed above which means that the sliding variable s will return to the domain s μ again finally it can be derived that the sliding variable will stay in a domain s μ 0 stably with μ 0 μ 1 in the sliding manifold it is noted that the condition of λ λ m is similar to that of s μ and λ λ m 4 simulation results the proposed smc with asta has been implemented to suppress roll oscillation of a marine vessel this approach is aiming to solve chattering problems with improving control accuracy simultaneously against disturbances the ship parameters of the rolling system used for numerical simulation are listed in table 1 the ship model is a single deck and nonmotorized barge equipped with a double bottom wang 2009 the marine barge is used to make sure that the cargo carrying capability is improved and more bulk can be transferred prior to applying controller nonlinear roll motion will be introduced using a bifurcation diagram in the numerical simulation tests specific control parameters are selected as p 1 10 p 2 5 ρ 1 1 2 r 1 1 r 2 0 1 ω 1 25 γ 1 0 15 ε 0 1 μ 0 01 λ m 0 01 k p 0 6 k i 0 01 k d 0 1 and λ 6 in case of non adaptation particularly the initial conditions of the roll dynamics are chosen as φ 0 φ 0 5 rad 0 1 rad s it is noted that the unexpected external disturbances such as interactions from other ships lead to large additional roll motions and those disturbances might cause eventually cargo damage or operation interruption in this study the total external disturbances considering such as the waves currents winds and interactions will be given as 48 d τ f cos ω τ n kg m a ship rolling without active controller represents complex dynamical behaviors such as multi periodic and chaotic states depending on specific initial conditions fig 2 illustrates the dynamical behaviors for the different values of f with a time period of t where the dynamic responses of roll angle φ at every period of bifurcation parameter are plotted according to the wave amplitude h the barge undergoes different chaotic phenomena the nonlinearity terms in damping and restoring moment curve as well as excitation disturbances cause chaos oscillation as previously mentioned chaotic motion is sensitive to the initial conditions without active controllers this stability diagrams of figs 2 a b and c represent the barge suddenly changes its motion to a prolonged chaos at the end of stable 1 periodic motion or 1t this means that the barge oscillates through one period while wave disturbances will vibrate with one period the barge will remain calm comparatively by the time chaos appears it is observed that chaos occurs near or over ω 1 specifically if the control parameter ω increases for the case of f 0 5 the rolling behaviors exhibit from chaotic to chaotic through the subharmonic motion of 2t at the point of ω 1 15 as illustrated in fig 2 a when the control parameter ω is increased beyond periodic region in fig 2 b for the case of f 0 7 the chaotic orbits of the barge are spread incrementally in the range of ω 1 08 1 23 the stable periodic solutions called the periodic windows can be observed between the chaotic clouds of dots in fig 2 b as the periodic windows decrease in fig 2 c for the case of f 0 9 the chaotic behavior is dominant in the range of ω 1 18 1 28 therefore it is observed that irregular oscillations of the barge are dominant beyond ω 1 05 when the wave amplitude increases nonlinear roll motions can be illustrated using phase plane analysis to describe qualitative characteristics of the roll trajectories as depicted in fig 3 a and fig 10 a fig 3 shows the phase portraits of chaotic motion and time history curves at forcing amplitude f 0 9 and ω 1 25 in the phase plane the coordinates in fig 3 denote roll rate of φ rad s and roll angle φ rad respectively as one can see chaotic behavior the barge oscillates irregularly without any obvious periodicity the uncontrolled cases of figs 2 and 3 are obtained by means of equation 5 nonlinear dynamical behaviors are dominant even though the roll is given by harmonic excitation the control goal is to suppress these irregular oscillations using the proposed asta the controlled cases of the forced roll system with active controller can be achieved by equation 8 in section 3 2 in order to compare the effect of control input same excitation f 0 9 and ω 1 25 is considered both the uncontrolled controlled cases of figs 4 7 and 10 furthermore different excitation will be considered later as shown in figs 9 and 11 two typical controllers such as first order smc twisting controller tw are introduced to compare the control performances in figs 4 7 based on the basic work of shtessel et al 2014 the control input u s m c of first order smc and u t w of tw is designed as follows 49 u s m c t ρ 1 sgn s u t w t r 1 sgn s r 2 sgn s r 1 r 2 0 in addition the case of sta based on the equation 17 is compared with constant gain λ in figs 4 7 the parameters p 1 10 and p 2 5 of the sliding variable s in the equation 12 are equally used for all five controllers first order smc tw sta asta smc with tanh function in fact the gains of ρ 1 1 2 r 1 1 r 2 0 1 and λ 6 in the control algorithms are determined through many simulation tests the simulation results of the controlled roll system using asta are dependent on control parameters understanding of the characteristics of parameters helps to obtain high performance for control system the parameters p 1 p 2 ℜ in sliding variables affect the speed of convergence and the chattering for roll motion in case of increasing p 1 it will make slower convergence on roll angle and higher peak response of roll rate in a transient state by decreasing p 2 the gentle slope of roll angle is changed into a steep incline and peak of roll rate tends to increase negatively since chattering occurs slightly in both of the fore mentioned cases proper sliding variables should be set the parameter of ω 1 relates to maximum overshoot of roll angle and performance of accuracy in case of decreasing value of ω 1 roll angle starting at the initial position tilts towards the inclined direction and immediately returns to suppress roll oscillation accompanied by a slight increase of chattering on the other hand the roll motion leads to performance of inaccuracy by increasing value of ω 1 in addition the parameters γ 1 and ε are mainly related to the smoother responses of sliding variables and control inputs and the parameter μ plays an important role in stability of controller finally the state variables fail to converge in case of increasing value of parameter λ m figs 4 and 5 depict the comparison of time responses of state variables in general nonlinear roll motion in fig 3 can be suppressed by means of all control algorithms except pid controller it can be seen that the barge returns to upright position with the help of active actuators the tw and asta provide a quite similar performance in terms of transient and steady state responses in fig 4 also it s difficult to differentiate between the ship roll responses of first order smc and sta non adaptation although the barge ship initially lists to starboard side 5 due to external disturbances it retains its upright equilibrium condition after the time of τ 8 as shown in fig 4 therefore seafarers on board may work as if in ground whereas roll angles relatively curve in a matched form angular rates in fig 5 exhibit noticeably different forms in the transient state from the magnification zoom of a part of responses in fig 5 one can see a better performance of control accuracy in steady state responses by the proposed asta even if the magnitudes are relatively small sometimes careful contrast of the control responses shows big differences fig 6 depicts control activities for all control algorithms considered first order smc tw sta non adaptation and asta chattering can be observed for the system responses of first order smc in fig 6 a tw in fig 6 b and sta in fig 6 c discontinuous high frequency features are shown in figs 6 a and b in particular it is actually impractical to provide physical actuator signals in mechanical means the high frequency control switching terms ρ 1 sgn s and r 1 sgn s in equation 49 cause chattering in the sliding mode due to discrete time features the switching control law is to drive the state trajectories on the sliding surface regardless of external disturbances as expected discontinuous control activity on the sliding mode yields chattering phenomenon shtessel et al 2014 even though first order smc and tw provide good suppression illustrated in fig 6 chattering occurs in control activities due to their discontinuous switching actions causing actuator fatigue loads in fact these switching control actions may result in the destructive phenomenon of actuators easy damages of other mechanisms and excitations of unmodelled actuator dynamics of second order or greater in case of sta with constant gain it is hard to expect noticeable mitigation of chattering as shown in fig 6 c in contrast with the mentioned three controllers asta shows that chattering is greatly suppressed with a continuous curve reducing fatigue loads and guaranteeing good responses as shown in fig 6 d it should be noted that the chattering reduction is one of crucial tasks when exploiting the advantages of the sliding mode controllers to suppress roll oscillation of nonmotorized barge all aforementioned controllers are based on the concept of sliding variable and sliding surface thus the control activities of fig 6 highly depend on the variation of sliding variable fig 7 represents the sliding variable for all four controllers the sum of position error and velocity error decreases to zero in finite time by all controllers as shown in the magnification zoom the sliding variables of smc and tw draw zigzag motion after arriving at the sliding surface in figs 7 a and b on the contrary the sliding variables of sta and asta demonstrate smooth curve consistently in figs 7 c and d fig 8 shows the controlled phase portraits of roll angle and roll rate using asta the system trajectories can be seen with the starting and ending point in the phase plane as the control gain ω 1 increases the magnitude of trajectories decreases it can be shown that the proposed asta accomplishes the goal of non estimating control gains the controlled rolling response represents insensitive to the initial conditions since roll motion is subject to surface equation itself fig 9 displays the estimated adaptive gains of asta when the amplitude of wave decreases to f 0 5 the magnitude of the adaptive gains also decreases starting at the zero point the gains vary at regular intervals it reveals that adaptation algorithm achieves the control goal without overestimating gains in order to show the superiority of the proposed asta the responses of roll motion using conventional pid are represented the control input u p i d is expressed as 50 u p i d t k p e t k i o t e τ d τ k d d e t d t where k p k i and k d are the proportional integral and derivative gains same disturbance is considered as f 0 9 and ω 1 25 for the case of pid controller the controlled phase portraits by proposed asta in fig 8 clearly demonstrate the starting and ending point however the controlled responses by pid in figs 10 a and b are not improved when comparing with the uncontrolled cases of figs 3 a and b the responses merely decrease with the amplitude affected by the control activity of pid and the barge still exhibits chaotic motions until 750 s as time goes to infinity the controlled rolling system by pid represents a period 2 motion after chaos phenomena irregular behavior of roll angle in fig 10 b transformed into a periodic motion after 750 s also the unstable response can be seen with increased fluctuation from 750 s in fig 10 c the controlled rolling system using pid still possesses a sensitive property depending on the control parameters test results show that pid is not suitable for suppressing nonlinear rolling system due to its strong nonlinearity the control activities will vary depending on the magnitude of disturbances especially in case of the sigmoid function the proposed asta is compared with smc with hyperbolic tangent function under different disturbances of f 0 9 and f 2 1 depicted in fig 11 two different cases of 0 9 cos 1 25 τ and 2 1 cos 1 25 τ are taken into account for disturbances same parameters in previous asta system except increasing control gain of ω 1 50 are adopted in case of f 2 1 also the hyperbolic tangent function tanh is an example of sigmoid functions and it is defined as aghababa and akbari 2012 51 x tanh x ς x e x ς e x ς e x ς e x ς where ς is positive scalar and this influences the steepness of the hyperbolic function for the best performance the parameter ς is selected as 0 05 in case of f 0 9 and ς 0 001 in case of f 2 1 respectively as the disturbance increases the parameter ς also should be adjusted to obtain the better results fig 11 a shows the comparison of roll responses by means of asta and smc with tanh function according to different disturbances in case of f 0 9 both control systems suppress roll motion significantly when f 2 1 the roll responses will put another complexion the proposed asta still compensates it successfully otherwise convergence of state variables by tanh function is proceeding with difficulty if the roll motion is controlled by tanh function chattering is reactivated in case of high disturbances f 2 1 as shown in fig 11 d it is known that severe chattering can be alleviated by means of smooth sigmoid function such as tanh function instead of discontinuous sgn function in fact the hyperbolic tangent function presents strong performance in a condition of low disturbances in case of high disturbances tanh function does not provide the control goal of both convergence rate and chattering mitigation the smc approach of tanh function alone is vulnerable to the disturbances because s trajectories are constrained in vicinity of sliding surface rather than on the surface shtessel et al 2012 accordingly this control mechanism alone is deemed an inappropriate method for marine vessels in navigating ocean environments as well as the nonmotorized barge exposed to severe roll excitation 5 conclusions in this paper robust smc with asta has been presented for suppressing chaotic roll dynamics for the nonmotorized barge in regular beam disturbances prior to synthesizing active controllers the bifurcation techniques are employed to illustrate roll motion analysis in detail on account of the strong nonlinearity of restoring force the crews on board can t be complacent about roll motions specifically it is notable that chaos appeared at the end of stable periodic motion next the robust controller actuated by rudder mechanism has been presented to achieve the control goal of stabilizing vessel roll dynamics in fact the active controlled systems can significantly improve the strengths of common smc synthesis guaranteeing accuracy robustness and simple implementation against external disturbances the performances of the proposed controller asta have been compared with typical first order smc twisting controller tw sta with non adaption pid controller and smc with hyperbolic tangent function simulation results show that the nonmotorized barge listed 5 to side perfectly recovered its upright position using all sliding mode controllers especially asta has successfully resolved the chattering problems as well as ensuring the desired level of control accuracy and robustness however first order smc and tw have failed to prevent chattering due to the presence of discontinuous control structure it is unnecessary to spend excessive control activity possibly leading to fatigue actuator loads since asta effectively provides smoother operations of actuators finally this paper demonstrates that the smc with asta is one of the powerful robust control synthesis for alleviating nonlinear roll motion of marine vessels since it resolves the chattering problems and provides robust performance against significant disturbances appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106724 
22268,this study investigates the dynamic vibration and static deformation of a long flexible underwater body suspended from the ocean surface a numerical model is constructed by considering i the structural mechanics ii hydrodynamic forces induced by vortex shedding iii motion mechanics associated with the free bottom end of the suspended body and iv the interactions among i iii numerical computations are performed by applying uniform vertical distributions of the ocean flow speed and a sheared distribution and by varying the weight of the body at the free bottom end comparing the computed results of these cases elucidates the mechanics of the fluid structure interaction of the suspended body in particular the sheared flow velocity profile allows the growth of multiple frequency components of vibrations in the flexible body the frequency multiplicity at a point in the body arises from the vortex induced vibrations excited at that point and those that are excited in other regions then propagate to that point keywords fluid structure interaction suspended body vortex induced vibration wake oscillator model numerical model 1 introduction very long flexible bodies are used to convey oil and gas from the seabed to floating platforms on the ocean surface these flexible bodies are often subjected to factors that excite motions and deformations thereby complicating the process of resource development or production reliable designs are essential in ensuring operational integrity sometimes these bodies are suspended from the ocean surface bai and bai 2005 with their bottom ends hanging free under the water for example when a drilling riser is used in a harsh environment such as an environment prone to high waves its bottom end is intentionally disconnected from the wellhead when the environmental conditions become too severe while its top end remains connected to the floating platform therefore it is critical to ensure safe operation in both suspended and normal conditions the normal condition means that both ends of the flexible body are connected to other bodies in the vicinity previous studies have noted the contribution of hydrodynamic forces to the excitation of vibrations of a suspended body for example patel and jesudansen 1987 experimentally examined the dynamic motion of a free hanging riser and identified the vortex induced force as a source of motion excitation meanwhile using a perturbation technique triantafyllou and triantafyllou 1991 obtained the natural modes of a free hanging string and regarded them as the configuration of responses of the body to excitation in their model test kajiwara and noridomi 2009 observed the vibratory motion of a riser model during re entry operations wenbo et al 2014 constructed a numerical model to simulate the dynamics of a platform and drilling riser in suspended conditions other previous studies have considered external forces other than the vortex induced force acting on a suspended body for example yanbin et al 2014a b analytically examined the static deformation and dynamic motion of a suspended body induced by wind waves and vessel motion honghai et al 2016 analyzed the process wherein vessel motion causes a suspended body to vibrate and wang et al 2012 numerically studied the vibration of suspended bodies excited by vessel motion because of the wind and waves optimal control theory applications to risers during re entry operation have been extensively studied for example shengwei et al 2016 attempted to optimize the re entry of a free hanging riser suzuki et al 1993 1994 used thrusters to actively control the motion of a vessel and deepwater risers and ohtsubo et al 2005 and koterayama et al 2008 used gain scheduled control to improve the re entry operation of a marine riser the preceding literature review shows that compared to the motion of a floating platform in waves vortex induced vibration viv has attracted less attention among researchers interested in the dynamics of suspended bodies nevertheless because poor weather can extend the flexible body suspension time the severity of damage and fatigue accumulation while the body is suspended should be addressed in equal measures as that during operations in normal conditions this study attempts to develop a numerical simulation method to investigate the mechanics of suspended bodies undergoing viv numerical simulation methods were developed to examine the mechanics of risers in normal conditions e g chatjigeorgiou 2008 2010 srinil 2011 yanbin et al 2014b doan and nishi 2015 tsukada and morooka 2016 honghai et al 2016 however a numerical simulation method that is able to serve as a practical approach for the suspended conditions as well as the normal conditions has not been constructed the establishment of such a numerical simulation method would allow long flexible bodies to be designed in a refined way considering the good performances of the finite difference scheme chatjigeorgiou 2008 and the wake oscillator model violette et al 2007 nishi et al 2009 doan and nishi 2015 nishi and doan 2015 for the normal condition this study attempts to develop a numerical computation program applicable to the suspended conditions based on the scheme and model to simulate the suspended conditions the bottom end must be carefully treated while a riser is suspended it often has a small attachment at its bottom end such as the lower marine riser package for a drilling riser bai and bai 2005 or the body attached to the bottom end of a vertical cold water pipe used in ocean thermal energy conversion wilson 2002 the body connected to the bottom end of the long flexible body may change the natural frequencies of the flexible body through changing the tension therefore the bottom end body beb should be regarded as an important design parameter the beb which behaves like an almost rigid body must be modeled as an independent body from the long flexible body above it accordingly the model built in this study involves three sets of mechanics and the interactions between them namely i structural mechanics expressing the elasticity of the suspended body ii fluid mechanics expressing the vortex formation and shedding and iii motion mechanics of the beb incorporating spatial differences is essential when considering the speed of fluid flow around a body that has a vertical length of a few kilometers the viv of the body in a sheared vertical profile of flow speeds is an unresolved issue of interest despite attempts having been undertaken to elucidate the mechanics in sheared flows e g vandiver et al 1996 trim et al 2005 chen et al 2015 nishi and doan 2015 nishi et al 2018 furthermore these studies devoted little attention to the suspended condition therefore this study investigates the following issues by interpreting the results of numerical simulations how the vertical distributions of ocean flow speed affect the response of the suspended body and to what extent the presence of the beb influences the response 2 model description models for the structure 2 1 the vortex induced force 2 2 and the beb 2 3 are described fig 1 these are commonly represented using nonlinear differential equations that govern the temporal evolution of dynamic quantities accordingly the numerical computational method used in this study is built to solve the equations in the time domain these equations are written in terms of i an s coordinate system fixed to the long flexible body and extending from the bottom end s 0 to the top end s l and ii an x y z coordinate system fixed in space fig 2 the variables and parameters used in the equations are listed and defined in table 1 2 1 structural model the structural model represents the deformation of the long flexible body this body is modeled as an euler bernoulli beam whose dynamics are governed by the equations of segment a small part of the body motion and the compatibility relation that ensures the continuity of the beam howell 1992 the equation of motion of a segment of longitudinal length 1 e d s see the box labeled structural model in fig 1 has tangential normal and binormal components written as 1 m u t w θ t v ϕ t cos θ t s s b ω 2 s n ω 3 ω 0 sin ϕ cos θ 1 e r t 2 m v t ϕ t u cos θ w sin θ m a v r t s n s ω 3 t s b tan θ ω 0 cos ϕ 1 e r n 3 m w t v ϕ t sin θ u θ t m a w r t s b s s n ω 3 tan θ t ω 2 ω 0 sin ϕ sin θ 1 e r b where r t r n r b are the components of the external force vector r which contains the gravity r w drag r d added mass r a and vortex induced r viv components 4 1 e r 1 e r w r a r d r viv where 1 e r w and 1 e r a have tangential normal and binormal components described as follows 5 1 e r w ω 0 sin ϕ cos θ cos ϕ sin ϕ cos θ 6 1 e r a m a 0 v r t w r t the notations u r v r w r are the tangential normal and binormal components of the relative velocity defined as u r v r w r u u c v v c w w c where u c v c w c are the tangential normal and binormal components of the flow velocity the drag force 1 e r d has the following tangential normal and binormal components respectively defined as 7 r dt 1 2 ρ w d π c dt u r u r 1 e 8 r dn 1 2 ρ w d c dn v r v r 2 w r 2 1 e 9 r db 1 2 ρ w d c db w r v r 2 w r 2 1 e the vortex induced component 1 e r viv is related to the lift coefficient c l in the following manner 10 r viv 1 2 ρ w d v 2 c l t v c t v c where the temporal variation in c l is calculated based on the vortex induced force model as described in section 2 2 segment bending is determined by the relationship between the bending stiffness tension induced moment and rotational inertia in this model the torsional moment and the rotational inertia are omitted because they are negligible compared to the other terms therefore the moment relationships can be simplified to 11 e i ω 2 s e i ω 3 2 tan θ s b 1 t e a 3 12 e i ω 3 s e i ω 2 ω 3 tan θ s n 1 t e a 3 and the compatibility relationships can be written as 13 u s ω 2 w ω 3 v 1 e a t t 14 v s ω 3 u w tan θ 1 t e a ϕ t cos θ 15 w s ω 3 v tan θ ω 2 u 1 t e a θ t the curvatures ω 2 ω 3 are related to the euler angles as 16 ω 2 θ s 17 ω 3 ϕ s cos θ the added mass is calculated as 18 m a c a ρ w π d 2 2 2 2 model of vortex induced force a bluff body placed in a flowing fluid exhibits vibratory motion e g blevins 1977 which is induced by the periodic generation and shedding of vortices in the downstream region of the body and through the interaction of vortices with the moving body because the section of the long flexible body addressed in this study is bluff the fluid structure interaction is accounted for in the present modeling the dynamics involved in this interaction is represented using the wake oscillator model although this model expresses the vortex dynamics in a simple fashion the essence of the fluid structure interaction mechanics is retained satisfactory performance of this model has been reported when simulating the viv of riser pipes e g violette et al 2007 nishi et al 2018 the time varying lift coefficient c l is governed by the following nonlinear equation 19 c l 2 ζ ω v 1 p f 2 c l 2 c l ω v 2 c l f coup the term f coup on the right hand side of eq 19 is the force exerted by the interaction between the segment motion and the wake oscillator rotation as expressed by 20 f coup f h d 2 l where ḧ denotes the acceleration of the segment motion in the direction perpendicular to the flow the present model assumes that a wake oscillator is attached to a segment fig 3 and the box labeled vortex induced force model in fig 1 the notation ζ is the coefficient that specifies the self excitation intensity of the wake oscillator defined as 21 ζ f d 2 2 π 2 l the notation ω v in the third term on the left hand side in eq 19 is the natural frequency of the wake oscillator this is equivalent to the frequency of the vortex generation and shedding behind a fixed circular cylinder defined as 22 ω v 2 π v 2 q d 2 l the coefficient p represents the nonlinear damping of the wake oscillator defined as 23 p 2 f c l0 2 2 3 model of beb and boundary condition of structural model the beb is connected to the long flexible body and is assumed to be a sphere of diameter d b moving in a fluid its motion is affected by the tension in the flexible body through the action reaction principle the equations of motion of the beb in the space fixed coordinate system fig 2 are written as 24 m s m a x b t cos θ cos ϕ 1 2 ρ w c d s x b u f x b u f 25 m s m a y b t cos θ sin ϕ ρ w v s m s g 1 2 ρ w c d s y b v f y b v f 26 m s m a z b t sin θ 1 2 ρ w c d s z b w f z b w f where u f v f w f are the components of the flow velocity in the space fixed coordinate system and x b y b z b are the beb coordinates in the space fixed coordinate system the added mass of the beb is calculated as 27 m a c a ρ w 4 3 π d b 2 3 the values of c d eq 26 and c a eq 27 are determined by referring to 18 and 21 boundary conditions must be imposed to calculate all the unknown variables in the preceding equations the flexible body is assumed to be simply supported the bending moments at the top s l and bottom s 0 ends are set to zero these conditions are written as 28 ω 2 s l t ω 3 s l t 0 ω 2 s 0 t ω 3 s 0 t 0 the top end of the body is fixed and the bottom end is positioned at the same point as the beb as expressed by 29 u s l t 0 v s l t 0 w s l t 0 u s 0 t u b v s 0 t v b w s 0 t w b where u b v b w b are the tangential normal and binormal components of the beb velocity respectively and are calculated via the coordinate system transformation of the velocity in the space fixed coordinate system in the following manner 30 u b v b w b γ x b y b z b where γ denotes the rotation matrix for the coordinate system transformation and is defined as 31 γ cos ϕ cos θ sin ϕ cos θ sin θ sin ϕ cos ϕ 0 cos ϕ sin θ sin ϕ sin θ cos θ 2 4 numerical computation method in time domain this section explains the process of numerically solving the governing equations described earlier the partial differential equations eqs 1 17 of the structural model can be collectively written in matrix form as 32 m y s t t k y s t s f y s t 0 where y s t is a vector containing 10 unknown variables and is defined as 33 y s t t s n s b u v w ω 2 ω 3 θ ϕ t eq 32 is transformed into finite difference form the second order central finite difference approximation is applied to both the spatial and temporal differentiations i e the kellor box method e g hoffman 1992 fig 4 they can be written in the following matrix form 34 m k i 1 m k i y k i 1 y k i δ t m k 1 i 1 m k 1 i y k 1 i 1 y k 1 i δ t k k 1 i 1 k k i 1 y k i 1 y k 1 i 1 δ s k k 1 i k k i y k i y k 1 i δ s f k i 1 f k 1 i 1 f k i f k 1 i o in eq 34 subscripts k 1 and k represent the node locations on the spatial coordinate s coordinate and superscripts i and i 1 represent the discrete times the kellor box method approximates a quantity and its first order spatial and temporal derivatives at the center of the box i 1 2 k 1 2 using the quantities at the four vertices surrounding the center fig 4 the ordinary differential equation in the vortex induced force model eq 19 is solved for all the nodes placed along the long flexible body this equation and the equations in the beb model eqs 24 26 are numerically solved by applying the fourth order runge kutta scheme in the numerical computations shown herein 201 discrete nodes are placed along the s coordinate the maximum of k equals 201 this means that the structure is approximated by the succession of 200 segments several computations were conducted by varying the number of segments to examine the effect of spatial resolution on results confirming that the 200 segments and more yield sufficiently converged results 2 5 linearization and numerical computation method in frequency domain the developed numerical method was evaluated by conducting a numerical computation in the frequency domain to ensure its appropriate performance and determine its structural design the mathematical form of the suspended body model in the time domain was linearized and thereafter transformed into the form in the frequency domain the numerical results of computations in the frequency domain were compared with the analytically determined values the natural frequency is very important when designing a suspended body because it is closely related to the magnitude of the viv numerous studies have shown that the magnitude of the viv corresponds to the dimensionless flow velocity reduced velocity which includes the natural frequency ω n defined as 35 u 2 π v ω n d each vibratory mode has its own natural frequency the design parameters of the suspended body can be specified using the frequency domain calculation yielding the natural frequencies linearization is performed using the mathematical formula by chatjigeorgiou 2010 the vector of unknown variables is decomposed into static y s and dynamic y s t components as 36 y s t y s y s t assuming that the suspended body in its static state is straight and vertical the static component comprising the zeroth order quantities can be written as 37 y s t s 0 0 0 0 0 0 0 0 0 t the dynamic part comprises first order quantities of dynamic variables defined as 38 y s t t s n s b u v w ω 2 ω 3 θ ϕ t the linearized equations are derived by substituting eq 36 into the governing equations of the structural model eqs 1 17 and retaining only the first order terms i e omitting all terms equal to or higher than second order to transform these into equations in the frequency domain the first order dynamic variables are assumed to have sinusoidal temporal variations written as 39 y s t re y s e i ω t where ω is the frequency of the response and y s is the complex amplitude of the dynamic variables the equations that result from substituting eq 39 into the linearized equations are ordinary differential equations with respect to space the equations are solved by applying the central finite difference scheme to the spatial derivatives the boundary conditions that the bottom and top ends are simply supported are imposed for the calculations in the frequency domain c l in eq 10 is assumed to sinusoidally vary with frequency ω 3 results and discussion 3 1 program evaluation solutions in the frequency domain were calculated by assuming the uniformity of the beam material and tension a straight configuration and both the ends simply supported fig 5 whereupon a comparison between the theoretical and numerical results was made to verify the performance of the implemented program the physical properties of the beam used for program evaluation are listed in table 2 the tension is approximately 12 of the submerged weight of the beam and is set to be small for getting neighboring two natural frequencies closer thereby reducing the computing load in the frequency domain the theoretical solution according to these assumptions is 40 ω n j j π l 2 e i m 1 t j 2 π 2 e i l j 1 2 where j is the sequential number of vibratory modes the resulting response amplitudes of the displacement were averaged over the entire longitudinal length for various frequencies of bottom end forced vibrations fig 6 the frequencies associated with the response peaks were regarded as the natural frequencies their mode numbers j were assigned in increasing order from the smallest peak frequency the numerically computed natural frequencies are plotted against the mode sequence number fig 7 the analytical solution eq 40 is also plotted for comparison the numerical results are consistent with the analytical results thus adequate performance of the proposed program is verified 3 2 design of flexible body the parameters of the long flexible body were specified by considering the depth and the current speed of the ocean at the site of the structure installation table 3 the tension is equivalent to the submerged weight of the flexible body in this study the gulf of guinea was selected as the installation site because oil and gas reserves were discovered at this location and resource developments have been in operation in this region the response amplitudes were calculated fig 8 by performing a frequency domain numerical computation with the parameters inputted the response amplitudes showed peaks at ω 0 29 0 57 and 0 86 rad s which are associated with the natural frequencies of the smallest three vibratory modes moreover the natural frequency in eq 35 is 0 30 rad s upon specifying i the reduced velocity u at which the viv of a circular cylinder is generally maximized as 6 0 and ii the flow speed as 0 006 m s which represents the typical flow speed of ocean currents in the deep layer of the installation region the value of 0 30 rad s is slightly larger than the smallest value associated with the peaks in fig 8 these results allow us to deduce that the structure vibrates in the form of the first mode or its neighboring modes even when the flow speed is approximately 0 006 m s which is notably lower than the typical speeds of the surface current this aspect will be examined in more detail by performing time domain simulations 3 3 time domain simulation of suspended body to determine how the suspended body response is related to the vertical distribution of flow speed time domain simulations were performed using two vertical distributions of ocean flow speed that is those of uniform currents and the benguela current the prevailing northward ocean current off the western coast of africa this was followed by a parametric study quantifying how the beb affects the response in the standard design table 3 the weight of the beb equals to the weight of the entire suspended body this parameter setting involved uncertainties thus three ratios of the beb weight to that of the entire pipe weight were used table 4 to see response sensitivity in the following discussion temporal series and spectra at a specified point the three quarter point from the bottom end and middle point s l 0 75 are plotted in several figures because this point clearly exhibits the vibration characteristics and response differences that correspond with changes in beb mass 3 3 1 vertical profile of ocean flow speed numerical computations were performed over three uniform distributions 0 0005 0 0010 and 0 0015 m s as well as over the benguela current distribution using the design parameters listed in table 3 the vertical distribution of the benguela current is sheared throughout the water column fig 9 the presented data is based on observations by richardson and garzoli 2003 the flow speed is nearly 0 005 m s at a 2000 m water depth and gradually increases as the water depth decreases until it reaches 0 017 m s at the surface the uniform distributions provide distinct vibration modal configurations for which the frequencies are approximately constant periodic variations occur at the three quarter point from the bottom end figs 10 12 the amplitudes fluctuate for flow speeds of 0 010 m s and 0 0150 m s figs 11 and 12 respectively whereas for the lowest speed fig 10 the displacement amplitude is almost constant the amplitude fluctuations arise from the nonuniformity of the tension along the suspended body the upper part of the body has greater static tension than the lower parts because the former needs to support the weight of the majority of the vertical structure length the vibration at the same point for 0 005 m s has a single predominant frequency of 0 276 rad s fig 10 which is very close to the natural frequency of the first mode fig 8 showing that the growth of this vibration results from the synchronization of the vortex shedding frequency to the first mode natural frequency the dominance of a single component also occurs at 0 010 m s fig 11 and 0 0150 m s fig 12 the spectral peaks for the two cases are 0 476 rad s and 0 675 rad s respectively and their deviations from the natural frequencies fig 8 are large enough to prohibit the synchronization of vortex shedding frequency with the natural frequencies the benguela current profile yields temporal displacement variations with amplitude fluctuations the time histories of the three quarter point from the bottom end are plotted in fig 13 the time history of the displacement has maxima resp minima consecutively without down crossing resp up crossing the zero point this irregularity in the temporal variation is evidence of the growth of multiple components with different frequencies the suspended body used in this study is flexible thus the vibration frequency at a point is determined through combining the vortex shedding frequency at that point with the frequency of the elastic waves that propagate from other points a similar fluid structure interaction mechanism was noted by for example vandiver et al 2009 for an experimental model and nishi et al 2018 for an actual size riser under normal conditions whereas this study reproduced this result numerically for the suspended body see also the supplementary animation file in contrast to the dynamic transverse displacements the inline displacements are static after a short initial transient see also the supplementary animation file the static state of the inline displacements fig 14 arises primarily from the equilibrium between the hydrodynamic drag r d and gravity r w the benguela current profile gives a static configuration similar to the uniform profile at 0 01 m s upon closer observation the uppermost part recorded for the benguela current profile is displaced farther downstream when compared to the static displacements recorded for the uniform profile of 0 01 m s while the lowermost part is displaced closer to the zero position this spatial distribution of the static configuration can be explained by observing the benguela current profile fig 9 the flow speed of the benguela current is slower than 0 010 m s in the deep layer then increases as depth decreases and exceeds 0 015 m s at the surface layer 3 3 2 influence of beb for the standard case the displacement of the middle point s l 0 5 irregularly evolves fig 15 the standard case has frequency spectrum with multiple peaks and is very similar to that of the three quarter point fig 13 the middle point displacements in cases b3 and b5 have the same irregularities figs 16 and 17 respectively as the standard case displacement the frequency spectra of cases b3 and b5 exhibit several peaks fig 16 17 which is similar to the spectrum in the standard case it is noteworthy that the peak frequencies are higher for cases b3 and b5 the shifts of the spectral peaks are the largest in case b5 fig 17 the natural frequencies of the suspended body vertical lines in fig 15 17 are related to the beb weight via the variation in tension a greater weight leads to higher natural frequencies which accompany the greater shifts of the spectral peaks a greater beb weight corresponds to fewer spectral peaks it comes from the wider intervals between neighboring natural frequencies in cases b3 and b5 these results can be interpreted in terms of the fluid structure interaction mechanics the faster flow speeds in shallow layer fig 9 excite vibrations with higher frequencies and the slower flow speeds in the deeper layer excite lower frequency vibrations the multiple spectral peaks figs 13 and 15 17 are caused by the downward propagation of elastic waves excited in the upper part in addition to the upward propagation of waves excited in the lower part the excitation intensity depends on the differences between the multiple vortex shedding frequencies and the natural frequencies if the vortex shedding frequencies and the natural frequencies are very close the former is entrained into the latter and the vivs of the corresponding modes grow a lighter resp heavier beb causes the suspended body to have relatively lower resp higher natural frequencies with narrower resp wider intervals between the neighboring natural frequencies it follows that more resp fewer modes are excited by a lighter resp heavier beb through the synchronizations of the vortex shedding frequency and the corresponding natural frequencies the amplitudes of the transverse vibrations exhibit modal configurations fig 18 the amplitudes at the bottom end are smaller than those at the upper parts because the beb motion is suppressed by the drag and inertial forces acting on it a heavier beb yielded smaller amplitudes overall with the maximum of the root mean square rms amplitude equating to 25 of the outer diameter of the pipe although the developed model performed well under the assumptions made in this study the following aspects were not considered and must be resolved in future work 1 the inline viv component was omitted in this model because it is generally smaller than the transverse component 2 the method constructed herein can be refined by validating its performance against the results obtained from experiment and computational fluid dynamics 3 the vertical profile data of the benguela current speeds was temporally constant and excluded time varying aspects such as tidal currents 4 the benguela current was assumed to flow in a single direction x direction but in fact it flows in different directions at different depths 4 conclusions a numerical model was developed to simulate the fluid structure interaction mechanics of a long flexible underwater body that is suspended from the free surface the model comprised structural vortex induced force and beb models these characteristics were coupled to represent their mechanical interactions the governing equations of the structural model were solved using the kellor box method the vortex induced force was computed by applying the wake oscillator model and the beb equation was solved considering tensions of the suspended body acting on the beb by using vertical profiles of ocean current speeds numerical simulations were performed and the results were analyzed the following conclusions are drawn from these analyses the proposed numerical model adequately combines the three sets of dynamics structural vortex induced force and beb and simulates the fluid structure interaction of the suspended body the actual vertical profile of the benguela current speed promotes the growth of multiple frequency components figs 13 and 15 17 the numerical model facilitates the simulation of the dynamic motion and static deformation of a suspended body and allows for a more refined design declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this study was supported financially by the japan society for the promotion of science jsps grand in aid for scientific research 18h01636 appendix a the coefficient matrix m is expressed as 41 m 0 0 0 m 0 0 0 0 m w m v cos θ 0 0 0 0 m m a 0 0 0 0 m u cos θ w sin θ 0 0 0 0 0 m m a 0 0 m u m v sin θ 1 e a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 t e a cos θ 0 0 0 0 0 0 0 0 1 t e a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 the coefficient matrix k is expressed as 42 k 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 e i 0 0 0 0 0 0 0 0 0 0 e i 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 cos θ the vector f is expressed as 43 f s b ω 2 s n ω 3 ω 0 sin ϕ cos θ r dt ω 3 t s b tan θ ω 0 cos ϕ r dn s n ω 3 tan θ t ω 2 ω 0 sin ϕ sin θ r db ω 2 w ω 3 v ω 3 u w tan θ ω 3 v tan θ ω 2 u e i ω 3 2 tan θ s b 1 t e a 3 e i ω 2 ω 3 tan θ s b 1 t e a 3 ω 2 ω 3 appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2019 106723 appendix b supplementary data the following is the supplementary material related to this article mmc s1 a transverse displacement and b inline displacement 
22268,this study investigates the dynamic vibration and static deformation of a long flexible underwater body suspended from the ocean surface a numerical model is constructed by considering i the structural mechanics ii hydrodynamic forces induced by vortex shedding iii motion mechanics associated with the free bottom end of the suspended body and iv the interactions among i iii numerical computations are performed by applying uniform vertical distributions of the ocean flow speed and a sheared distribution and by varying the weight of the body at the free bottom end comparing the computed results of these cases elucidates the mechanics of the fluid structure interaction of the suspended body in particular the sheared flow velocity profile allows the growth of multiple frequency components of vibrations in the flexible body the frequency multiplicity at a point in the body arises from the vortex induced vibrations excited at that point and those that are excited in other regions then propagate to that point keywords fluid structure interaction suspended body vortex induced vibration wake oscillator model numerical model 1 introduction very long flexible bodies are used to convey oil and gas from the seabed to floating platforms on the ocean surface these flexible bodies are often subjected to factors that excite motions and deformations thereby complicating the process of resource development or production reliable designs are essential in ensuring operational integrity sometimes these bodies are suspended from the ocean surface bai and bai 2005 with their bottom ends hanging free under the water for example when a drilling riser is used in a harsh environment such as an environment prone to high waves its bottom end is intentionally disconnected from the wellhead when the environmental conditions become too severe while its top end remains connected to the floating platform therefore it is critical to ensure safe operation in both suspended and normal conditions the normal condition means that both ends of the flexible body are connected to other bodies in the vicinity previous studies have noted the contribution of hydrodynamic forces to the excitation of vibrations of a suspended body for example patel and jesudansen 1987 experimentally examined the dynamic motion of a free hanging riser and identified the vortex induced force as a source of motion excitation meanwhile using a perturbation technique triantafyllou and triantafyllou 1991 obtained the natural modes of a free hanging string and regarded them as the configuration of responses of the body to excitation in their model test kajiwara and noridomi 2009 observed the vibratory motion of a riser model during re entry operations wenbo et al 2014 constructed a numerical model to simulate the dynamics of a platform and drilling riser in suspended conditions other previous studies have considered external forces other than the vortex induced force acting on a suspended body for example yanbin et al 2014a b analytically examined the static deformation and dynamic motion of a suspended body induced by wind waves and vessel motion honghai et al 2016 analyzed the process wherein vessel motion causes a suspended body to vibrate and wang et al 2012 numerically studied the vibration of suspended bodies excited by vessel motion because of the wind and waves optimal control theory applications to risers during re entry operation have been extensively studied for example shengwei et al 2016 attempted to optimize the re entry of a free hanging riser suzuki et al 1993 1994 used thrusters to actively control the motion of a vessel and deepwater risers and ohtsubo et al 2005 and koterayama et al 2008 used gain scheduled control to improve the re entry operation of a marine riser the preceding literature review shows that compared to the motion of a floating platform in waves vortex induced vibration viv has attracted less attention among researchers interested in the dynamics of suspended bodies nevertheless because poor weather can extend the flexible body suspension time the severity of damage and fatigue accumulation while the body is suspended should be addressed in equal measures as that during operations in normal conditions this study attempts to develop a numerical simulation method to investigate the mechanics of suspended bodies undergoing viv numerical simulation methods were developed to examine the mechanics of risers in normal conditions e g chatjigeorgiou 2008 2010 srinil 2011 yanbin et al 2014b doan and nishi 2015 tsukada and morooka 2016 honghai et al 2016 however a numerical simulation method that is able to serve as a practical approach for the suspended conditions as well as the normal conditions has not been constructed the establishment of such a numerical simulation method would allow long flexible bodies to be designed in a refined way considering the good performances of the finite difference scheme chatjigeorgiou 2008 and the wake oscillator model violette et al 2007 nishi et al 2009 doan and nishi 2015 nishi and doan 2015 for the normal condition this study attempts to develop a numerical computation program applicable to the suspended conditions based on the scheme and model to simulate the suspended conditions the bottom end must be carefully treated while a riser is suspended it often has a small attachment at its bottom end such as the lower marine riser package for a drilling riser bai and bai 2005 or the body attached to the bottom end of a vertical cold water pipe used in ocean thermal energy conversion wilson 2002 the body connected to the bottom end of the long flexible body may change the natural frequencies of the flexible body through changing the tension therefore the bottom end body beb should be regarded as an important design parameter the beb which behaves like an almost rigid body must be modeled as an independent body from the long flexible body above it accordingly the model built in this study involves three sets of mechanics and the interactions between them namely i structural mechanics expressing the elasticity of the suspended body ii fluid mechanics expressing the vortex formation and shedding and iii motion mechanics of the beb incorporating spatial differences is essential when considering the speed of fluid flow around a body that has a vertical length of a few kilometers the viv of the body in a sheared vertical profile of flow speeds is an unresolved issue of interest despite attempts having been undertaken to elucidate the mechanics in sheared flows e g vandiver et al 1996 trim et al 2005 chen et al 2015 nishi and doan 2015 nishi et al 2018 furthermore these studies devoted little attention to the suspended condition therefore this study investigates the following issues by interpreting the results of numerical simulations how the vertical distributions of ocean flow speed affect the response of the suspended body and to what extent the presence of the beb influences the response 2 model description models for the structure 2 1 the vortex induced force 2 2 and the beb 2 3 are described fig 1 these are commonly represented using nonlinear differential equations that govern the temporal evolution of dynamic quantities accordingly the numerical computational method used in this study is built to solve the equations in the time domain these equations are written in terms of i an s coordinate system fixed to the long flexible body and extending from the bottom end s 0 to the top end s l and ii an x y z coordinate system fixed in space fig 2 the variables and parameters used in the equations are listed and defined in table 1 2 1 structural model the structural model represents the deformation of the long flexible body this body is modeled as an euler bernoulli beam whose dynamics are governed by the equations of segment a small part of the body motion and the compatibility relation that ensures the continuity of the beam howell 1992 the equation of motion of a segment of longitudinal length 1 e d s see the box labeled structural model in fig 1 has tangential normal and binormal components written as 1 m u t w θ t v ϕ t cos θ t s s b ω 2 s n ω 3 ω 0 sin ϕ cos θ 1 e r t 2 m v t ϕ t u cos θ w sin θ m a v r t s n s ω 3 t s b tan θ ω 0 cos ϕ 1 e r n 3 m w t v ϕ t sin θ u θ t m a w r t s b s s n ω 3 tan θ t ω 2 ω 0 sin ϕ sin θ 1 e r b where r t r n r b are the components of the external force vector r which contains the gravity r w drag r d added mass r a and vortex induced r viv components 4 1 e r 1 e r w r a r d r viv where 1 e r w and 1 e r a have tangential normal and binormal components described as follows 5 1 e r w ω 0 sin ϕ cos θ cos ϕ sin ϕ cos θ 6 1 e r a m a 0 v r t w r t the notations u r v r w r are the tangential normal and binormal components of the relative velocity defined as u r v r w r u u c v v c w w c where u c v c w c are the tangential normal and binormal components of the flow velocity the drag force 1 e r d has the following tangential normal and binormal components respectively defined as 7 r dt 1 2 ρ w d π c dt u r u r 1 e 8 r dn 1 2 ρ w d c dn v r v r 2 w r 2 1 e 9 r db 1 2 ρ w d c db w r v r 2 w r 2 1 e the vortex induced component 1 e r viv is related to the lift coefficient c l in the following manner 10 r viv 1 2 ρ w d v 2 c l t v c t v c where the temporal variation in c l is calculated based on the vortex induced force model as described in section 2 2 segment bending is determined by the relationship between the bending stiffness tension induced moment and rotational inertia in this model the torsional moment and the rotational inertia are omitted because they are negligible compared to the other terms therefore the moment relationships can be simplified to 11 e i ω 2 s e i ω 3 2 tan θ s b 1 t e a 3 12 e i ω 3 s e i ω 2 ω 3 tan θ s n 1 t e a 3 and the compatibility relationships can be written as 13 u s ω 2 w ω 3 v 1 e a t t 14 v s ω 3 u w tan θ 1 t e a ϕ t cos θ 15 w s ω 3 v tan θ ω 2 u 1 t e a θ t the curvatures ω 2 ω 3 are related to the euler angles as 16 ω 2 θ s 17 ω 3 ϕ s cos θ the added mass is calculated as 18 m a c a ρ w π d 2 2 2 2 model of vortex induced force a bluff body placed in a flowing fluid exhibits vibratory motion e g blevins 1977 which is induced by the periodic generation and shedding of vortices in the downstream region of the body and through the interaction of vortices with the moving body because the section of the long flexible body addressed in this study is bluff the fluid structure interaction is accounted for in the present modeling the dynamics involved in this interaction is represented using the wake oscillator model although this model expresses the vortex dynamics in a simple fashion the essence of the fluid structure interaction mechanics is retained satisfactory performance of this model has been reported when simulating the viv of riser pipes e g violette et al 2007 nishi et al 2018 the time varying lift coefficient c l is governed by the following nonlinear equation 19 c l 2 ζ ω v 1 p f 2 c l 2 c l ω v 2 c l f coup the term f coup on the right hand side of eq 19 is the force exerted by the interaction between the segment motion and the wake oscillator rotation as expressed by 20 f coup f h d 2 l where ḧ denotes the acceleration of the segment motion in the direction perpendicular to the flow the present model assumes that a wake oscillator is attached to a segment fig 3 and the box labeled vortex induced force model in fig 1 the notation ζ is the coefficient that specifies the self excitation intensity of the wake oscillator defined as 21 ζ f d 2 2 π 2 l the notation ω v in the third term on the left hand side in eq 19 is the natural frequency of the wake oscillator this is equivalent to the frequency of the vortex generation and shedding behind a fixed circular cylinder defined as 22 ω v 2 π v 2 q d 2 l the coefficient p represents the nonlinear damping of the wake oscillator defined as 23 p 2 f c l0 2 2 3 model of beb and boundary condition of structural model the beb is connected to the long flexible body and is assumed to be a sphere of diameter d b moving in a fluid its motion is affected by the tension in the flexible body through the action reaction principle the equations of motion of the beb in the space fixed coordinate system fig 2 are written as 24 m s m a x b t cos θ cos ϕ 1 2 ρ w c d s x b u f x b u f 25 m s m a y b t cos θ sin ϕ ρ w v s m s g 1 2 ρ w c d s y b v f y b v f 26 m s m a z b t sin θ 1 2 ρ w c d s z b w f z b w f where u f v f w f are the components of the flow velocity in the space fixed coordinate system and x b y b z b are the beb coordinates in the space fixed coordinate system the added mass of the beb is calculated as 27 m a c a ρ w 4 3 π d b 2 3 the values of c d eq 26 and c a eq 27 are determined by referring to 18 and 21 boundary conditions must be imposed to calculate all the unknown variables in the preceding equations the flexible body is assumed to be simply supported the bending moments at the top s l and bottom s 0 ends are set to zero these conditions are written as 28 ω 2 s l t ω 3 s l t 0 ω 2 s 0 t ω 3 s 0 t 0 the top end of the body is fixed and the bottom end is positioned at the same point as the beb as expressed by 29 u s l t 0 v s l t 0 w s l t 0 u s 0 t u b v s 0 t v b w s 0 t w b where u b v b w b are the tangential normal and binormal components of the beb velocity respectively and are calculated via the coordinate system transformation of the velocity in the space fixed coordinate system in the following manner 30 u b v b w b γ x b y b z b where γ denotes the rotation matrix for the coordinate system transformation and is defined as 31 γ cos ϕ cos θ sin ϕ cos θ sin θ sin ϕ cos ϕ 0 cos ϕ sin θ sin ϕ sin θ cos θ 2 4 numerical computation method in time domain this section explains the process of numerically solving the governing equations described earlier the partial differential equations eqs 1 17 of the structural model can be collectively written in matrix form as 32 m y s t t k y s t s f y s t 0 where y s t is a vector containing 10 unknown variables and is defined as 33 y s t t s n s b u v w ω 2 ω 3 θ ϕ t eq 32 is transformed into finite difference form the second order central finite difference approximation is applied to both the spatial and temporal differentiations i e the kellor box method e g hoffman 1992 fig 4 they can be written in the following matrix form 34 m k i 1 m k i y k i 1 y k i δ t m k 1 i 1 m k 1 i y k 1 i 1 y k 1 i δ t k k 1 i 1 k k i 1 y k i 1 y k 1 i 1 δ s k k 1 i k k i y k i y k 1 i δ s f k i 1 f k 1 i 1 f k i f k 1 i o in eq 34 subscripts k 1 and k represent the node locations on the spatial coordinate s coordinate and superscripts i and i 1 represent the discrete times the kellor box method approximates a quantity and its first order spatial and temporal derivatives at the center of the box i 1 2 k 1 2 using the quantities at the four vertices surrounding the center fig 4 the ordinary differential equation in the vortex induced force model eq 19 is solved for all the nodes placed along the long flexible body this equation and the equations in the beb model eqs 24 26 are numerically solved by applying the fourth order runge kutta scheme in the numerical computations shown herein 201 discrete nodes are placed along the s coordinate the maximum of k equals 201 this means that the structure is approximated by the succession of 200 segments several computations were conducted by varying the number of segments to examine the effect of spatial resolution on results confirming that the 200 segments and more yield sufficiently converged results 2 5 linearization and numerical computation method in frequency domain the developed numerical method was evaluated by conducting a numerical computation in the frequency domain to ensure its appropriate performance and determine its structural design the mathematical form of the suspended body model in the time domain was linearized and thereafter transformed into the form in the frequency domain the numerical results of computations in the frequency domain were compared with the analytically determined values the natural frequency is very important when designing a suspended body because it is closely related to the magnitude of the viv numerous studies have shown that the magnitude of the viv corresponds to the dimensionless flow velocity reduced velocity which includes the natural frequency ω n defined as 35 u 2 π v ω n d each vibratory mode has its own natural frequency the design parameters of the suspended body can be specified using the frequency domain calculation yielding the natural frequencies linearization is performed using the mathematical formula by chatjigeorgiou 2010 the vector of unknown variables is decomposed into static y s and dynamic y s t components as 36 y s t y s y s t assuming that the suspended body in its static state is straight and vertical the static component comprising the zeroth order quantities can be written as 37 y s t s 0 0 0 0 0 0 0 0 0 t the dynamic part comprises first order quantities of dynamic variables defined as 38 y s t t s n s b u v w ω 2 ω 3 θ ϕ t the linearized equations are derived by substituting eq 36 into the governing equations of the structural model eqs 1 17 and retaining only the first order terms i e omitting all terms equal to or higher than second order to transform these into equations in the frequency domain the first order dynamic variables are assumed to have sinusoidal temporal variations written as 39 y s t re y s e i ω t where ω is the frequency of the response and y s is the complex amplitude of the dynamic variables the equations that result from substituting eq 39 into the linearized equations are ordinary differential equations with respect to space the equations are solved by applying the central finite difference scheme to the spatial derivatives the boundary conditions that the bottom and top ends are simply supported are imposed for the calculations in the frequency domain c l in eq 10 is assumed to sinusoidally vary with frequency ω 3 results and discussion 3 1 program evaluation solutions in the frequency domain were calculated by assuming the uniformity of the beam material and tension a straight configuration and both the ends simply supported fig 5 whereupon a comparison between the theoretical and numerical results was made to verify the performance of the implemented program the physical properties of the beam used for program evaluation are listed in table 2 the tension is approximately 12 of the submerged weight of the beam and is set to be small for getting neighboring two natural frequencies closer thereby reducing the computing load in the frequency domain the theoretical solution according to these assumptions is 40 ω n j j π l 2 e i m 1 t j 2 π 2 e i l j 1 2 where j is the sequential number of vibratory modes the resulting response amplitudes of the displacement were averaged over the entire longitudinal length for various frequencies of bottom end forced vibrations fig 6 the frequencies associated with the response peaks were regarded as the natural frequencies their mode numbers j were assigned in increasing order from the smallest peak frequency the numerically computed natural frequencies are plotted against the mode sequence number fig 7 the analytical solution eq 40 is also plotted for comparison the numerical results are consistent with the analytical results thus adequate performance of the proposed program is verified 3 2 design of flexible body the parameters of the long flexible body were specified by considering the depth and the current speed of the ocean at the site of the structure installation table 3 the tension is equivalent to the submerged weight of the flexible body in this study the gulf of guinea was selected as the installation site because oil and gas reserves were discovered at this location and resource developments have been in operation in this region the response amplitudes were calculated fig 8 by performing a frequency domain numerical computation with the parameters inputted the response amplitudes showed peaks at ω 0 29 0 57 and 0 86 rad s which are associated with the natural frequencies of the smallest three vibratory modes moreover the natural frequency in eq 35 is 0 30 rad s upon specifying i the reduced velocity u at which the viv of a circular cylinder is generally maximized as 6 0 and ii the flow speed as 0 006 m s which represents the typical flow speed of ocean currents in the deep layer of the installation region the value of 0 30 rad s is slightly larger than the smallest value associated with the peaks in fig 8 these results allow us to deduce that the structure vibrates in the form of the first mode or its neighboring modes even when the flow speed is approximately 0 006 m s which is notably lower than the typical speeds of the surface current this aspect will be examined in more detail by performing time domain simulations 3 3 time domain simulation of suspended body to determine how the suspended body response is related to the vertical distribution of flow speed time domain simulations were performed using two vertical distributions of ocean flow speed that is those of uniform currents and the benguela current the prevailing northward ocean current off the western coast of africa this was followed by a parametric study quantifying how the beb affects the response in the standard design table 3 the weight of the beb equals to the weight of the entire suspended body this parameter setting involved uncertainties thus three ratios of the beb weight to that of the entire pipe weight were used table 4 to see response sensitivity in the following discussion temporal series and spectra at a specified point the three quarter point from the bottom end and middle point s l 0 75 are plotted in several figures because this point clearly exhibits the vibration characteristics and response differences that correspond with changes in beb mass 3 3 1 vertical profile of ocean flow speed numerical computations were performed over three uniform distributions 0 0005 0 0010 and 0 0015 m s as well as over the benguela current distribution using the design parameters listed in table 3 the vertical distribution of the benguela current is sheared throughout the water column fig 9 the presented data is based on observations by richardson and garzoli 2003 the flow speed is nearly 0 005 m s at a 2000 m water depth and gradually increases as the water depth decreases until it reaches 0 017 m s at the surface the uniform distributions provide distinct vibration modal configurations for which the frequencies are approximately constant periodic variations occur at the three quarter point from the bottom end figs 10 12 the amplitudes fluctuate for flow speeds of 0 010 m s and 0 0150 m s figs 11 and 12 respectively whereas for the lowest speed fig 10 the displacement amplitude is almost constant the amplitude fluctuations arise from the nonuniformity of the tension along the suspended body the upper part of the body has greater static tension than the lower parts because the former needs to support the weight of the majority of the vertical structure length the vibration at the same point for 0 005 m s has a single predominant frequency of 0 276 rad s fig 10 which is very close to the natural frequency of the first mode fig 8 showing that the growth of this vibration results from the synchronization of the vortex shedding frequency to the first mode natural frequency the dominance of a single component also occurs at 0 010 m s fig 11 and 0 0150 m s fig 12 the spectral peaks for the two cases are 0 476 rad s and 0 675 rad s respectively and their deviations from the natural frequencies fig 8 are large enough to prohibit the synchronization of vortex shedding frequency with the natural frequencies the benguela current profile yields temporal displacement variations with amplitude fluctuations the time histories of the three quarter point from the bottom end are plotted in fig 13 the time history of the displacement has maxima resp minima consecutively without down crossing resp up crossing the zero point this irregularity in the temporal variation is evidence of the growth of multiple components with different frequencies the suspended body used in this study is flexible thus the vibration frequency at a point is determined through combining the vortex shedding frequency at that point with the frequency of the elastic waves that propagate from other points a similar fluid structure interaction mechanism was noted by for example vandiver et al 2009 for an experimental model and nishi et al 2018 for an actual size riser under normal conditions whereas this study reproduced this result numerically for the suspended body see also the supplementary animation file in contrast to the dynamic transverse displacements the inline displacements are static after a short initial transient see also the supplementary animation file the static state of the inline displacements fig 14 arises primarily from the equilibrium between the hydrodynamic drag r d and gravity r w the benguela current profile gives a static configuration similar to the uniform profile at 0 01 m s upon closer observation the uppermost part recorded for the benguela current profile is displaced farther downstream when compared to the static displacements recorded for the uniform profile of 0 01 m s while the lowermost part is displaced closer to the zero position this spatial distribution of the static configuration can be explained by observing the benguela current profile fig 9 the flow speed of the benguela current is slower than 0 010 m s in the deep layer then increases as depth decreases and exceeds 0 015 m s at the surface layer 3 3 2 influence of beb for the standard case the displacement of the middle point s l 0 5 irregularly evolves fig 15 the standard case has frequency spectrum with multiple peaks and is very similar to that of the three quarter point fig 13 the middle point displacements in cases b3 and b5 have the same irregularities figs 16 and 17 respectively as the standard case displacement the frequency spectra of cases b3 and b5 exhibit several peaks fig 16 17 which is similar to the spectrum in the standard case it is noteworthy that the peak frequencies are higher for cases b3 and b5 the shifts of the spectral peaks are the largest in case b5 fig 17 the natural frequencies of the suspended body vertical lines in fig 15 17 are related to the beb weight via the variation in tension a greater weight leads to higher natural frequencies which accompany the greater shifts of the spectral peaks a greater beb weight corresponds to fewer spectral peaks it comes from the wider intervals between neighboring natural frequencies in cases b3 and b5 these results can be interpreted in terms of the fluid structure interaction mechanics the faster flow speeds in shallow layer fig 9 excite vibrations with higher frequencies and the slower flow speeds in the deeper layer excite lower frequency vibrations the multiple spectral peaks figs 13 and 15 17 are caused by the downward propagation of elastic waves excited in the upper part in addition to the upward propagation of waves excited in the lower part the excitation intensity depends on the differences between the multiple vortex shedding frequencies and the natural frequencies if the vortex shedding frequencies and the natural frequencies are very close the former is entrained into the latter and the vivs of the corresponding modes grow a lighter resp heavier beb causes the suspended body to have relatively lower resp higher natural frequencies with narrower resp wider intervals between the neighboring natural frequencies it follows that more resp fewer modes are excited by a lighter resp heavier beb through the synchronizations of the vortex shedding frequency and the corresponding natural frequencies the amplitudes of the transverse vibrations exhibit modal configurations fig 18 the amplitudes at the bottom end are smaller than those at the upper parts because the beb motion is suppressed by the drag and inertial forces acting on it a heavier beb yielded smaller amplitudes overall with the maximum of the root mean square rms amplitude equating to 25 of the outer diameter of the pipe although the developed model performed well under the assumptions made in this study the following aspects were not considered and must be resolved in future work 1 the inline viv component was omitted in this model because it is generally smaller than the transverse component 2 the method constructed herein can be refined by validating its performance against the results obtained from experiment and computational fluid dynamics 3 the vertical profile data of the benguela current speeds was temporally constant and excluded time varying aspects such as tidal currents 4 the benguela current was assumed to flow in a single direction x direction but in fact it flows in different directions at different depths 4 conclusions a numerical model was developed to simulate the fluid structure interaction mechanics of a long flexible underwater body that is suspended from the free surface the model comprised structural vortex induced force and beb models these characteristics were coupled to represent their mechanical interactions the governing equations of the structural model were solved using the kellor box method the vortex induced force was computed by applying the wake oscillator model and the beb equation was solved considering tensions of the suspended body acting on the beb by using vertical profiles of ocean current speeds numerical simulations were performed and the results were analyzed the following conclusions are drawn from these analyses the proposed numerical model adequately combines the three sets of dynamics structural vortex induced force and beb and simulates the fluid structure interaction of the suspended body the actual vertical profile of the benguela current speed promotes the growth of multiple frequency components figs 13 and 15 17 the numerical model facilitates the simulation of the dynamic motion and static deformation of a suspended body and allows for a more refined design declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this study was supported financially by the japan society for the promotion of science jsps grand in aid for scientific research 18h01636 appendix a the coefficient matrix m is expressed as 41 m 0 0 0 m 0 0 0 0 m w m v cos θ 0 0 0 0 m m a 0 0 0 0 m u cos θ w sin θ 0 0 0 0 0 m m a 0 0 m u m v sin θ 1 e a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 t e a cos θ 0 0 0 0 0 0 0 0 1 t e a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 the coefficient matrix k is expressed as 42 k 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 e i 0 0 0 0 0 0 0 0 0 0 e i 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 cos θ the vector f is expressed as 43 f s b ω 2 s n ω 3 ω 0 sin ϕ cos θ r dt ω 3 t s b tan θ ω 0 cos ϕ r dn s n ω 3 tan θ t ω 2 ω 0 sin ϕ sin θ r db ω 2 w ω 3 v ω 3 u w tan θ ω 3 v tan θ ω 2 u e i ω 3 2 tan θ s b 1 t e a 3 e i ω 2 ω 3 tan θ s b 1 t e a 3 ω 2 ω 3 appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2019 106723 appendix b supplementary data the following is the supplementary material related to this article mmc s1 a transverse displacement and b inline displacement 
22269,the thermodynamics of the air inside a conventional oscillating water column owc is commonly modelled using the isentropic relationship between pressure and density the innovative tupperwave device is based on the owc concept but uses non return valves and two extra reservoirs to rectify the flow into a smooth unidirectional air flow harnessed by a unidirectional turbine the air flowing in closed circuit experiences a temperature increase due to viscous losses across the valves and turbine along the repetitive cycles of the device s operation in order to study this temperature increase which represents a potential issue for the device operation a non isentropic wave to wire model of the tupperwave device is developed taking into account the irreversible thermodynamic processes the model is based on the first law of thermodynamics and accounts for viscous losses at the valves and turbine as well as solar radiation and heat transfer across the device walls and inner free surface the results reveal that the temperature increase in the device remains harmless for its operation the difference between the power performance of the tupperwave device based on the non isentropic and isentropic models is found to be relatively small its performance are also compared to the corresponding conventional owc device keywords wave energy oscillating water column non isentropic study tupperwave energy balance valves 1 introduction oscillating water column owc devices are amongst the most promising types of wave energy converters because of their relative simplicity in the most conventional sort of owc devices the owc chamber is open to the atmosphere through a self rectifying turbine the pressure variations in the owc chamber create a bidirectional air flow across the turbine which is able to convert energy regardless the direction of the flow several types of self rectifying turbines have been developed for owcs with various working principles advantages and drawbacks an extensive review of such turbines can be found in falcão and henriques 2016 the best performing self rectifying turbines are the biradial and twin rotor turbines which reach respectively about 79 and 74 efficiency falcão et al 2013 lopes et al 2019 in steady flow conditions self rectifying turbines are not as efficient as conventional unidirectional air turbines which may attain peak efficiencies close to 90 in steady flow conditions the use of a unidirectional turbine in an owc device is possible using non return valves to create a unidirectional flow driven by the motion of the owc various owc devices using a unidirectional turbine have been studied and different methods for rectifying the air flow were considered among those devices there are for example the masuda s navigation buoy falcão and henriques 2016 and the vented owc from wave swell energy fleming et al 2017 these devices are opened to the atmosphere like in a conventional owc whereas other devices such as the tupperwave device work in closed circuit in the tupperwave device a pressure differential is built between two accumulator chambers using the motion of the water column and non return valves in a similar way to a hydraulic circuit air compressibility in the large fixed volume accumulator chambers is used to store pneumatic energy which is then released smoothly across a unidirectional turbine located between the two chambers wave to wire numerical models of the tupperwave device and of the corresponding conventional owc device displayed in fig 1 were developed in benreguig et al 2019a and benreguig et al 2019b to assess and compare their performances the results showed that the performance of the non return valves is of critical importance for the tupperwave device to compete with the conventional owc the thermodynamics in the devices was modelled using the linearised isentropic relationship between pressure and density in the different chambers of the device and the results were validated against model scale experimental tests in a conventional owc converter the air is partly renovated once in a wave cycle a few seconds this prevents the averaged inner air temperature from differing significantly from the outer air temperature as it was shown in falcão and justino 1999 despite non reversible processes such as viscous losses across the turbine the use of the linearised isentropic relationship between pressure and density provides a satisfactory approximation and simplifies the numerical modelling of conventional owc devices this simplifying assumption is therefore commonly used in the numerical modelling of conventional owc devices sheng et al 2013 josset and clément 2007 the situation is different in the tupperwave device where the air flows in closed circuit the energy dissipation at the non return valves and at the imperfectly efficient turbine is likely to increase the entropy and temperature of the inner air the validity of the isentropic assumption for the modelling of the tupperwave device at full scale is therefore questionable moreover the increase of air temperature in the device potentially represents a risk for the device operation this potential issue common to all closed circuit owc devices and associated with others issues related to the use of non return valves such as cost and reliability discouraged many developers from taking this technology further the present study develops for the first time a non isentropic numerical model for a closed circuit owc and investigates the air temperature increase in the tupperwave device in section 1 and 2 the non isentropic models of the tupperwave device and corresponding owc device fig 1 are developed taking into account irreversible thermodynamic processes such as the energy dissipation in the turbine and the valves the heat exchanges between the inner air and the environment and the solar radiations in section 3 the air temperature evolution in the different chambers and the energy flows in the tupperwave device are analysed finally isentropic and non isentropic model results are compared in order to conclude on the reliability of the isentropic simplification 2 tupperwave non isentropic model in this section a non isentropic model of the tupperwave device is developed based on the wave to wire model built in benreguig et al 2019b the thermodynamic component of the model is largely revised to account for the irreversible thermodynamic processes the other components of the model although quasi identical are also briefly described to allow this publication to be read independently from the previous one 2 1 hydrodynamics for the hydrodynamic modelling of the device the two body approach described in sheng et al 2014 is adopted the first rigid body is the spar buoy structure and the second rigid body is an imaginary thin piston at the internal free surface both bodies are considered as rigid bodies moving only in heave due to the action of the waves the model is based on linear wave theory the motion of both bodies in a wave field may be modelled in the time domain applying the cummins equation with subscript 1 for the buoy and subscript 2 for the piston 1 m 1 a 11 x 1 t a 12 x 2 t i 11 i 12 c 1 x 1 t f 1 t f p t f d 1 t a 21 x 1 t m 2 a 22 x 2 t i 21 i 22 c 2 x 2 t f 2 t f p t f d 2 t where m i are the bodies masses c i are the hydrostatic stiffness terms and are calculated as c 1 ρ w g s 1 and c 2 ρ w g s 2 where ρ w is the water density g is the acceleration of gravity s 1 is the cross sectional area of body 1 defined by the undisturbed sea surface and s 2 is the area of the owc free surface a i j are the bodies heaving added masses at infinite frequency including the proper and crossed modes f p is the reciprocating pressure force acting on both bodies and is calculated as f p s 2 p o w c t where p o w c is the excess pressure relatively to atmospheric pressure built in the owc chamber the terms i i j are called memory effect terms and are convolution integrals 2 i i j 0 t k i j t τ x j t d τ where k i j are the impulse functions for heave motions and their interactions f i are the wave excitation forces acting on the two bodies and are calculated as 3 f i t 0 t k e x i t τ η t d t where η is the external wave elevation and k e x i is the excitation force impulse response function for body i the viscous drag forces f d 1 and f d 2 are calculated as f d i c d i x i t x i t where c d i is the equivalent drag coefficient the coefficients c d 1 150 n s 2 m 2 and c d 2 40 n s 2 m 2 were found in benreguig et al 2019a to provide the best fit between the vertical displacement of the bodies predicted numerically and the ones obtained physically for the present study this values are converted to full scale using the froude scaling similarity all the hydrodynamic coefficients a i j k i j k e x i were computed in the frequency domain using wamit lee and newman 2006 a commercial boundary element method software the volume of the owc chamber is calculated as v o w c v 0 s 2 x 1 x 2 the variations of v o w c are related to variations in p o w c system of equation 1 needs to be completed by thermodynamic considerations 2 2 thermodynamics in this section the general thermodynamic equations ruling an open air chamber are derived assuming consecutively non isentropic and isentropic assumptions the non isentropic model is then applied to the modelling of the tupperwave device 2 2 1 general equations we consider the following open thermodynamic system an air chamber of volume v containing a mass m of air with density ρ m v at the temperature t and at pressure p a t m p w i n and w o u t are the air mass flow rates respectively in and out of the chamber and are functions of the air excess pressure p it is assumed that the transformations are slow enough for the thermodynamic state of air in the chamber to be uniform the air is assumed as a perfect and dry gas of constant specific heat capacities c v and c p non isentropic equations the first thermodynamic principle applied to the open system gives josset and clément 2007 4 e u e c e p w q h i n h o u t where e is the energy of the system u is the internal energy e c and e p are the kinetic and potential energy w is the mechanical power provided to the system by the motion of the walls q is the rate of heat transfer provided to the system h i n and h o u t are the enthalpy flow rates due to exchange of matter coming in and out of the system the variations of the system kinetic and potential energy are neglected equation 4 therefore becomes 5 d d t c v m t p a t m p v q c p w i n t f c p w o u t t where ρ f and t f are the density and temperature of the incoming air the mayer s equations are 6 c p c v r a c p c v γ b where r is the specific ideal gas constant the ideal gas law is 7 p a t m p ρ r t and its derivative gives 8 p ρ r t ρ r t the mass balance equation gives 9 m ρ v ρ v w i n w o u t finally equations 5 6 a b 7 8 and 9 lead to the non isentropic model of the system 10 m w i n w o u t a p γ p a t m p m q c p t w i n t f t w o u t ρ v b system of equation 10 a b was obtained from the 1st thermodynamic principle and displays the general equations relating mass density pressure and volume of the air considered as a perfect gas in an open system during non isentropic transformations in this model the specific entropy of the system is likely to change due to the irreversible processes across the valves and turbine and to the heat transferred across the boundaries of the system isentropic equations if the system is considered adiabatic and the transformations are slow enough to be reversible the transformations become isentropic and consequently we may write 11 ρ ρ a t m p a t m p p a t m 1 γ equation 11 once derivated gives 12 ρ ρ a t m p γ p a t m p a t m p p a t m 1 γ 1 equation 12 combined with equations 9 and 11 leads to the isentropic model of the system 13 p γ p a t m p m w i n w o u t ρ v equation 13 displays the equations relating mass density pressure and volume of the air considered as a perfect gas in an open system during isentropic transformations unlike in the non isentropic system 10 the mass of air in the chamber m ρ v and the excess pressure p are directly related by equation 11 hence a single differential equation is necessary we note that equation 13 can be obtained from 10 b by adding the adiabatic assumption q 0 and further assume no temperature difference between inner and outside air t f t linearised isentropic equations moreover in the case where the excess pressure remains small compared to the atmospheric pressure it is possible to linearise the isentropic relationship between density and pressure once linearised equation 11 leads to 14 ρ ρ a t m 1 p γ p a t m and to 15 ρ ρ a t m γ p a t m p finally the linearised isentropic system of equations relating mass density pressure and volume of the system is 16 p γ p a t m ρ a t m v w i n w o u t ρ v depending on the feasible assumptions and on the level of accuracy desired equation 10 a b or 13 or 16 can be directly applied for the modelling of the thermodynamic happening in owc type wave energy devices air chambers in this paper the non isentropic model system of equation 10 will be used to model the thermodynamic happening in the tupperwave device 2 2 2 tupperwave thermodynamics fig 2 displays a schematic of the 3 chambers of the tupperwave device and their thermodynamic variables solid arrows represent mass flow of air and hollow arrows represent heat exchanges through the walls exchanges are counted positive in the direction of the arrows each chamber of the device is modelled as an open thermodynamic system the non isentropic system of equation 10 a b is therefore applied to each of the three chambers in the following paragraphs the heat transfer rates mass flow rates and flow temperatures at the exit of the turbine and valves are mathematically expressed as functions of the temperatures and pressures in the different chambers heat exchanges in the event of air temperature increase in the device thermal exchanges through the walls of the device need to be considered due to the large surface area of the walls exchanges between the hp and lp chambers and the exterior atmosphere and water are considered hp and lp chambers also exchange heat across the separation wall heat transfers through the walls between the owc chamber and the two other chambers are neglected because of the smaller common wall surface heat is also exchanged between the air contained in the owc chamber and the water the device s walls are considered homogeneous and separate either air and water or air and air at different temperatures the heat transfer from a fluid 1 to a fluid 2 across a wall results of a combination in series of convection mechanisms from the fluids to the wall surfaces and conduction mechanism across the wall to evaluate the heat transfer rate a steady one dimensional heat exchange model in the normal direction to the wall s surface is adopted as displayed in fig 3 the precise study of the transient state requires to solve the unsteady heat conduction equation across the wall which would increase the mathematical complexity of the problem and was not considered by the authors the steady state assumption will be verified in section 3 depending on the wall s material the overall heat transfer coefficient between fluid 1 and 2 is therefore defined as rajput 2010 17 k 1 2 1 1 h 1 l k 1 h 2 where h 1 and h 2 are the fluids convective heat transfer coefficients l and k are the thickness and heat conductivity of the wall the heat transfer rate resulting from conduction and convection through the wall of area a between fluid 1 at temperature t 1 and fluid 2 at temperature t 2 takes the form 18 q 1 2 k 1 2 a t 1 t 2 radiative heat transfer from the sun may play an important role in sunny days to account for solar radiation on the device the equivalent sol air temperature method is used t s o l a i r is the outside air temperature for which in the absence of heat radiation the external environment delivers the same heat flux to the wall surface if the wall surface in contact with fluid 1 is exposed to sun radiation t 1 s o l a i r can be calculated as marino et al 2018 19 t 1 s o l a i r t 1 α i t h 1 where α the material absorptivity and i t is the total solar irradiation hence the total heat transfer rate across the wall is simply calculated as 20 q 1 2 k 1 2 a t 1 s o l a i r t 2 the outside wall surface area of the hp chamber and lp chamber are approximately a h p a l p 400 m 2 for each chamber about half of their outside wall surface area is in contact with water and the other half is in contact with air the wall surface area of the device exposed to solar radiation is a function of the sun position and device orientation for simplicity it is assumed that only the outside wall surface of the hp chamber in contact with air is exposed to the solar irradiation i t thus we write 21 q h p k a a a h p 2 t a α i t h a t h p k w a a h p 2 t w t h p 22 q l p k a a a l p 2 t a t l p k w a a l p 2 t w t l p 23 q h p 2 l p k a a a h p 2 l p t h p t l p where the subscribes a and w respectively refer to the atmospheric air and the ocean water atmospheric and ocean temperatures t a and t w are assumed constant a h p 2 l p 135 m 2 is the surface area of the wall separating the hp chamber from the lp chamber the convective heat transfer between the air in the owc chamber and the internal water surface is calculated as 24 q o w c h a w s t w t o w c where h a w is the convective heat transfer coefficient between air and water and s is the internal water surface area turbine to assess the temperature of the flow at the exit of the turbine we consider the real expansion process happening across the turbine from the stagnation pressure p 0 i n at the inlet to the static pressure p o u t at the outlet the entropy enthalpy diagram is shown in fig 4 where perfect dashed arrow and real full arrow expansions are represented between the two isobaric lines the kinetic energy at the entrance of the turbine is neglected and the kinetic energy in the exhaust gases is not contributing to the total useful energy at the turbine the total to static efficiency of the turbine is therefore defined as 25 η t p m p a v a i l h 0 i n h o u t h 0 i n h o u t s where p a v a i l is the available power to the turbine defined as the power output of a perfectly efficient turbine p m is the power converted by the actual turbine into mechanical power h 0 i n is the stagnation specific enthalpy at the entrance of the turbine h o u t is the specific enthalpy at the exit of the turbine and h o u t s is the specific enthalpy at the exit of the turbine if the expansion were perfect i e isentropic the turbine losses are dissipated into heat and are calculated as 26 l t p a v a i l p m p a v a i l 1 η t w i n h o u t h o u t s the air is considered as a perfect gas and so d h c p d t equation 26 can be written as 27 l t w i n c p t o u t t o u t s i e 28 t o u t t o u t s l t c p w i n the temperature of the flow at the exit of the isentropic expansion is calculated using the well known isentropic relationship 29 t o u t s t i n p o u t p 0 i n γ 1 γ applying equations 28 and 29 to the expansion from the hp to the lp chamber across the turbine leads to the expression of the air temperature at the exit of the turbine and entering the lp chamber 30 t f t t h p p a t m p l p p a t m p h p γ 1 γ l t c p w t the mass flow rate across the turbine now needs to be expressed the model of the radial inflow turbine used in this paper is taken from the literature and was obtained with a rotor of 500 mm at rotational speeds between 700 and 1300 rpm the reynolds number ranged between 9 2 10 5 and 2 1 10 6 and the mach number did not exceed 0 1 lopes et al 2019 in this conditions the flow can be considered as incompressible in this paper the tupperwave device is equipped with same turbine diameter see table 1 in section 3 but the rotational speeds considered are 4 times higher changes in reynolds and mach number can modify the turbine performances a higher reynolds number may modify the turbulent behaviour of the flow and compressibility effects may be introduced if the mach number rises above 0 3 in what follows mach and reynolds number effects are ignored and the flow through the turbine is considered as approximately incompressible thus the performance of the turbine can be presented non dimensionally and the results can be applied to a geometrically similar turbine of different size rotating at different speed and with a fluid of different density hall and dixon 2013 if the flow is assumed incompressible the turbine power output p m depends on the turbine geometry on the turbine size rotor diameter on the rotational speed ω and on the pressure head δ p t p 0 i n p o u t between inlet and outlet or on the air flow rate w t the corresponding dimensionless variables are the dimensionless flow coefficient φ dimensionless pressure head ψ and dimensionless turbine power output π which are defined as falcão and henriques 2016 31 φ w t ρ i n ω d 3 ψ δ p t ρ i n ω 2 d 2 π p m ρ i n ω 3 d 5 neglecting the influence of the reynolds and mach numbers we may write 32 ψ f ψ φ π f π φ where the functions f ψ and f π depend only on the turbine geometry but not on size rotational speed or fluid density from equations 31 and 32 the mass flow rate through the turbine w t and the turbine torque t t u r b can be expressed as a functions of the pressure head and the rotational speed 33 w t ρ h p ω d 3 f ψ 1 p 0 i n p o u t ρ i n ω 2 d 2 34 t t u r b p m ω ρ h p ω 2 d 5 f π w t ρ i n ω d 3 for low mach numbers m 0 3 as during the experimental assessment of the turbine performances lopes et al 2019 the flow can be considered as incompressible and the dimensionless power available to the turbine is the product of the volumetric flow rate and the pressure head hence the total to static turbine efficiency η t is obtained by 35 η t p m p a v a i l π φψ f η φ the turbine works at maximum efficiency for the optimal dimensionless flow coefficient φ o p t the turbine functions f ψ and f π of the unidirectional turbine used in the tupperwave model were established at model scale during laboratory tests described in lopes et al 2019 lopes 2017 this unidirectional turbine was tested in the framework of the twin rotor turbine development which is among the most efficient self rectifying turbine being symmetrical only half of the turbine designated single rotor turbine was designed constructed and tested in unidirectional flow at instituto superior tecnico ist lisbon this single rotor turbine is used here in the tupperwave device it reaches 84 maximum efficiency in constant flow condition valves the non return valves are essential for the successful performance of the tupperwave device benreguig et al 2018 2019abib benreguig et al 2019abib benreguig et al 2019abib benreguig et al 2018 valves can either be passive check valves or active on off valves the valves considered in this paper are passive valves that require a pressure head δ p v p i n p o u t larger than their opening pressure p v 0 to open we note that each valve hp or lp is open only about half of the time therefore the average flow rate across them when they are open is about twice as high as the average flow across the turbine in the conditions in which the model is simulated in this paper the mach number of the flow across the valves sometimes rises above 0 3 hence the flow needs to be considered as compressible the mass flow rates of air across the valves are calculated from their pressure head using a steady state subsonic compressible flow model rajput 2010 36 w v i n o u t 0 i f p i n p o u t p v 0 α d a v 2 γ γ 1 ρ i n p i n p v 0 r 2 γ r γ 1 γ i f p i n p o u t p v 0 where r p o u t p i n p v 0 is the pressure ratio over the valve when open a v is the opening area of the valve α d is a correction coefficient called discharge coefficient accounting for the further contraction of the flow cross sectional area downstream of the valve opening also called vena contracta as illustration fig 5 displays the mass flow rate across the valves as function of the pressure head for ρ i n ρ a t m in the present work the equivalent opening area of the valves was set to α d a v 0 286 m 2 and the opening pressure set to p v 0 150 pa further considerations on the valves characteristics although critical for the tupperwave performances are not in the scope of this paper the expansion across the valves corresponds to a throttling process and is fundamentally irreversible as the exit kinetic energy is dissipated no work is done on or by the air and the expansion therefore happens at constant enthalpy sonntag et al 1998 h i n h o u t i e for a perfect gas t i n t o u t thus using the ideal gas law we have 37 t f v h t o w c p a t m p o w c v o w c m o w c r and 38 t f v l t l p p a t m p l p v l p m l p r finally we have obtained the mathematical expressions of the heat transfers across the walls the mass flow rates across the turbines and valves and their exit temperatures as functions of the pressures volumes and masses of air in each chamber equations from system 10 can be directly applied to each of the three chambers of the tupperwave device thus obtaining the non isentropic thermodynamic model of the device 39 m o w c w l p w h p m h p w h p w t m l p w t w l p p o w c γ p a t m p o w c m o w c q o w c c p t o w c w v l t l p t o w c w v h ρ o w c v o w c p h p γ p a t m p h p m h p q h p q h p 2 l p c p t h p w v h t o w c t h p w t p l p γ p a t m p l p m l p q l p q h p 2 l p c p t l p w t t f t t l p w v l 2 3 generator model and control law the last differential equation of the model is given by the newton s law applied on the generator rotor 40 i ω t t u r b t g e n where i is the inertia of the turbine generator system t g e n is the electromagnetic braking torque of the generator and t t u r b is given in equation 34 a maximum power point tracking mppt control strategy is applied to control the generator braking torque and optimise the instantaneous turbine efficiency this control strategy was physically implemented in benreguig et al 2019b on a rotary test rig to simulate the turbine generator interaction the electromagnetic power p e m ω t g e n is finally converted into electricity by the generator with the efficiency η g e n which depends on its load λ p e m p r a t e d where p r a t e d is the generator rated power the realistic generator efficiency is displayed in fig 6 and drops very sharply for partial loads 2 4 global numerical model and numerical integration method the systems of differential equations 1 38 and 39 constitute the model of the tupperwave device computing the solution of these equations to find the nine unknown variable x 1 x 2 m o w c m h p m l p p o w c p h p p l p ω is made difficult by the fact that equations from system 1 are second order differential equations and by the presence of the memory effect convolution integrals i i j in the present work the memory effect terms are approximated using a state space representation each of the four convolution integrals i i j can be approximated by the sum of n additional state variables i i j k using the prony s method sheng et al 2015 duclos et al 2001 41 i i j 1 n i i j k each i i j k is governed by an additional first order differential equation of the form 42 i i j k β i j k i i j k α i j k x j moreover the 2 s order differential equations of system 1 can be reduced to first order differential equations by introducing the matrix variables u x 1 x 2 and v x 1 x 2 finally the system of equations governing the non isentropic wave to wire model of the tupperwave device can be expressed as 43 u v v m 1 f 1 f 2 1 1 s p o w c 1 n i 11 k 1 n i 12 k 1 n i 21 k 1 n i 22 k c d 1 c d 2 v v c 1 c 2 u i 11 k β 11 k i 11 k α 11 k x 1 k 1 n i 12 k β 12 k i 12 k α 12 k x 2 k 1 n i 21 k β 21 k i 21 k α 21 k x 1 k 1 n i 22 k β 22 k i 22 k α 22 k x 2 k 1 n m o w c w l p w h p m h p w h p w t m l p w t w l p p o w c γ p a t m p o w c m o w c q o w c c p t o w c w v l t l p t o w c w v h ρ o w c v o w c p h p γ p a t m p h p m h p q h p q h p 2 l p c p t h p w v h t o w c t h p w t p l p γ p a t m p l p m l p q l p q h p 2 l p c p t l p w t t f t t l p w v l i ω t t u r b t g e n this system is composed of 9 4n first order differential equations which can be solved using a numerical first order differential equation solver in the present work the order of the prony s function is n 4 the system is solved with the variable step ordinary differential equation solver ode 45 from the software matlab 3 conventional owc non isentropic model the wave to wire model of the corresponding owc device is relatively similar to the tupperwave device since both devices use the same floating spar structure the hydrodynamic set of equations is the same fig 7 displays a schematic of the owc thermodynamic system the air in the chamber is thermally isolated from the atmosphere by the buoyancy volume around the chamber heat exchange however occurs by convection between the air and the water column to separate inhalation and exhalation processes we define the two positive quantities w t i n and w t o u t as the absolute values of the air flow rates respectively entering and exiting the turbine such that 44 for p o w c 0 w t i n w t w t o u t 0 and for p o w c 0 w t i n 0 w t o u t w t the system of equation 10 applied on the owc chamber gives 45 m o w c w t i n w t o u t p o w c γ p a t m p o w c m q o w c c p t o w c w t i n t f t o w c w t o u t ρ o w c v o w c with 46 t f t t a t m p a t m p o w c p a t m γ 1 γ l c p w t the turbine used in the owc model is the twin rotor turbine the turbine is based on a pair of conventional radial inflow rotors mounted on the same shaft complemented by the corresponding guide vane rows and by a two position cylindrical valve which orientates the air across one rotor or the other depending on the flow direction inhalation or exhalation the rotor spinning in no flow generates a braking torque and causes windage losses lopes et al 2019 the turbine s characteristic functions f ψ and f π were established by physical testing in lopes 2017 as well as an expression of the windage torque as a function of the rotational speed the maximum efficiency of the twin rotor turbine is 74 in constant flow condition the generator and its control law are the same as in the tupperwave model the only difference is that the aerodynamic friction torque t w i n d created by the passive rotor the one with no flow is added in the shaft rotational speed s differential equation 47 i ω t t u r b t g e n t w i n d using the same method as in section 1 4 the system of equations governing the non isentropic wave to wire model of the conventional owc device is expressed as 5 4n first order differential equations 48 u v v m 1 f 1 f 2 1 1 s p o w c 1 n i 11 k 1 n i 12 k 1 n i 21 k 1 n i 22 k c d 1 c d 2 v v c 1 c 2 u i 11 k β 11 k i 11 k α 11 k x 1 k 1 n i 12 k β 12 k i 12 k α i j k x 2 k 1 n i 21 k β 21 k i 21 k α i j k x 1 k 1 n i 22 k β 22 k i 22 k α i j k x 2 k 1 n m o w c w t i n w t o u t p o w c γ p a t m p o w c m q o w c c p t o w c w t i n t f t o w c w t o u t ρ o w c v o w c i ω t t u r b t g e n t w i n d 4 numerical results in this section the numerical results are obtained assuming an atmosphere and ocean temperature of 15 c at the beginning of each simulation the device is idle and the air in the device is at atmospheric condition the same turbine blade geometry as the one tested in lopes et al 2019 was used in both device the diameters and rotational speeds were optimised in benreguig et al 2019b to maximise the electrical power output from both devices in the wave climate of the emec test site located in the north of scotland information on the turbine and generator parameters used in the tupperwave and the conventional owc model are given in table 1 as shown in table 1 the optimisation results were very different on what concerns the size diameter d and the rotational speed this is due to the very different working conditions of the turbines in the two devices as can be seen in fig 8 which displays the pressure head and the flow rate to which both turbines are subjected in the same sea state the pressure head across the tupperwave turbine is larger with a lower flow rate this is confirmed by the very different sizes of the orifices used to simulate the turbines in model testing of tupperwave and conventional owc in benreguig et al 2019a the higher rotational speed of the tupperwave turbine unfortunately requires the use of a gearbox associated with undesirable cost and maintenance issues it can be found from the well known cordier diagram dick 2015 that the use of different turbine design with a larger diameter could avoid the use of a gearbox and enable the direct driving of the generator 4 1 temperature analysis 4 1 1 in the tupperwave device adiabatic case fig 9 displays the temperature of the air in the hp and lp chambers in the case where the device does not receive any radiation from the sun and no heat exchange is allowed across the walls or with the water adiabatic q o w c q h p q l p q h p 2 l p 0 the simulation is 30 min long in the irregular sea state h s 3 m t p 9 s which represents a relatively common sea state of moderate energy in offshore ocean conditions the black line represents the average air temperature of the system at the end of the simulation given the pressure difference between the two chambers the hp chamber is naturally hotter than the lp chamber the temperature in the owc chamber oscillates successively between the temperatures of the hp and lp chambers and was not represented in the figure for clarity significant temperature elevation occurs in the chambers due to the viscous losses the air temperature in both chambers increases steadily by approximately 20 c in 30 min and would keep rising to infinity in this theoretical case as a result the air expands and the average pressure in the device increases this pushes the water column down and the buoy up and would eventually modify the hydrostatic equilibrium and the hydrodynamics of the device high temperatures are also undesirable because they could damage on board instrumentation or the buoy structure itself diathermal case in reality heat transfers need to be considered due to the large outer wall s surface area of the tupperwave device and the contact between air and water in the owc chamber the total solar irradiation at sea level i t 1000 w m 2 corresponding to a clear summer day in europe is adopted this value is generally used as standard test conditions for photovoltaic devices the absorptivity α of the solar radiation by a surface is complex to assess and can vary from 0 to 1 depending on the material the colour and the roughness of the surface in general it is higher for dark colours and rough surface the value α 0 7 is adopted for this study and corresponds to the absorptivity of concrete according to guide a environmental des 2019 values for the convective heat transfer coefficients between the fluids air or water and device walls strongly depends on the fluid properties the roughness of the surface and on the flow velocity in the vicinity of the wall in the present case the fluid flows around the device depend on the wind and water current as well as on the motion of the device due to the wave excitation the overall air flow velocity around the device is taken of v 1 5 m s and the empirical law suggested in guide a environmental des 2019 leads to a convective heat transfer coefficient h a 4 4 v 1 24 w m 2 k assuming a turbulent flow of water outside the device with 1 m s average overall speed the convective heat transfer coefficient of the water is estimated using the dittus boelter equation to h w 1000 w m 2 k bahrami 2038 considering the motion of the iws in the owc chamber of approximately v 2 1 m s the forced convection model adopted in namèche and vassel 1999 leads to convective heat transfer coefficient between air and water h a w 2 8 3 v 2 5 8 w m 2 k we note that the values of the thermal parameters given in this paragraph can vary largely depending on the adopted assumptions relative to the weather conditions the device construction and the sea state choosing realistic values is made even more difficult by the large variability of information found in the literature the chosen values are meant to represent the heat exchanges in light wind current and wave conditions on a very sunny day around noon in order to avoid the underestimation of the temperature rise in the device the walls are first considered to be made of concrete with a thickness l 20 cm the thermal conductivity of concrete is greatly affected by mix proportioning aggregate types and sources as well as moisture status complex considerations on concrete are beyond the scope of this paper measurements made in guo et al 2011 give an average value of k t h c o n c r e t e 2 w m k fig 10 displays the temperature of the air in the hp and lp chambers in the case of a concrete buoy structure in sea state h s 3 m t p 9 s the black line represents the average air temperature in the chambers at the end of the simulation after a transient state of about 10 min where the temperature increases slowly the system reaches a steady state and the average air temperature settles 10 c higher than the initial temperature in 5 m high waves the same phenomenon is observed and the increase in temperature is found to be of about 16 c another wall material is considered with a higher heat conductivity than that of concrete the walls are assumed made of steel sheets of thickness l 15 mm and with heat conductivity k t h s t e e l 30 w m 1 k 1 rajput 2010 assuming similar walls surface colour and roughness as for the concrete walls the same convective heat transfer and absorptivity coefficients are adopted fig 11 displays the temperature of the air in the hp and lp chambers in the case of a concrete buoy structure in sea state h s 3 m t p 9 s in that case the steady state is reached in about 5 min the average air temperature increase in the device is of 6 3 c and reaches 8 5 c in extreme sea states simulations were also carried out in the absence of solar radiation night conditions the results obtained on temperature increase in the tupperwave device under the assumption of steady state heat transfer across the walls are summarized in table 2 the assumption of steady state conductive heat transfer across the device walls adopted in section 1 2 2 can be checked by the calculation of the characteristic diffusion time τ across the thickness l of the wall hancock 2006 49 τ l 2 d t h l 2 ρ c v k t h where d t h ρ c v and k t h are respectively the thermal diffusivity density heat capacity and heat conductivity of the wall material for the steel wall the characteristic diffusion time is about 30 s in that case the conductive heat transfer across the wall is quickly established and the assumption of steady state conductive heat transfer enabling a resistive thermal model of the walls is reasonable at all times for the concrete wall the characteristic time of diffusion is close to 10 h this means that after the sudden change of excitation force or solar radiation the conduction heat transfer requires a 10 h long transient state to settle back to a steady state hence the resistive thermal model of the concrete wall is not valid during such transient state the results displayed in fig 10 are therefore likely to underestimate the duration of the transient state and higher temperature levels are likely to be reached during this period before the steady state is settled the installation of steel heat exchangers across the concrete walls could be a solution to prevent high temperature increase caused by the sudden increase of the wave excitation force or solar radiation on the device the temperature increase displayed in table 2 are however still valid under the assumption that the conductive heat transfer across the walls has had sufficient time to settle such low air temperature increase does not represent any danger for the device operation the isentropic model does not predict this increase in temperature as it can be seen in fig 12 the average air temperature in the device remains equal to the initial temperature 4 1 2 in the conventional owc in the case of the conventional owc a slight temperature increase in the owc chamber is also observed during the inhalation process the viscous losses at the turbine result in an increase of specific internal energy in the owc chamber but unlike the tupperwave device the owc chamber is open to the atmosphere whose temperature remains constant this prevents large increase in temperatures fig 13 displays the temperature of the owc chamber in the conventional owc device in sea state h s 3 m t p 9 s the average temperature of the chamber towards the end of the simulation represented by the black line is 1 5 c higher than the initial temperature in 5m high waves the increase in temperature is of 3 c 4 2 energy balance analysis the review on wave to wire models of wave energy converters penalba and ringwood 2016 distinguishes four main stages in the power conversion process of a wave energy converter absorption transmission generation and conditioning in a conventional owc the power effectively absorbed from the waves p a b s is the power applied by internal water surface on the air contained in the owc chamber absorption stage this energy is briefly stored by the air contained in the owc chamber under the form of internal energy and released for the most part and with a delay as power available to the turbine p a v a i l this is the spring like compressibility effect of the air falcão and henriques 2018 we note that if the process is assumed adiabatic and isentropic without any dissipative losses the averaged values of the absorbed power and power available to the turbine over a sufficiently long time interval must be equal p a v a i l p a b s this is not the case in the non isentropic model of the conventional owc developed in this study where the internal energy of the air is likely to change due to the heat transfer with the water column besides in the case of the tupperwave device some energy is dissipated in the valves and the power available to the turbine is eventually lower than the power absorbed from the waves p a v a i l p a b s part of the power available to the turbine is then effectively converted by the turbine into mechanical power transmission stage the mechanical power is further converted into electrical power by the generator generation stage finally the raw electrical power created by the generator is adapted to be delivered into the grid by a power electronic converter conditioning stage in the present paper the wave to wire models presented neglect the influence of the conditioning stage on the device efficiency this simplification was shown in penalba and ringwood 2018 to be perfectly reasonable in applications such as control parameters optimisation and power production assessment fig 14 displays a bar diagram of the average powers along the power conversion chain for the tupperwave device in the end 57 of the absorbed power is converted in electrical power and the rest is disspated in the turbine the valves and the generator in section 1 2 1 a general open thermodynamic system has been defined to derive the general equations relating mass density pressure and volume these equations were then applied to each chamber of the tupperwave device to build the numerical model we now consider the thermodynamic system which refers to the total air contained in the tupperwave device which is a closed system according to the first law of thermodynamics the change in the internal energy δ u of a closed system is equal to the amount of heat supplied to the system plus the amount of mechanical work w received by the system the work received by the considered system is the work w a b s done by the internal water surface acting as a piston the system also absorbs the heat q r a d from the solar radiation within the system part of the absorbed energy is dissipated in the turbine and valves w l o s s e s the mechanical work done by the system is the work provided to the turbine w t u r b finally the heat q o u t is transferred to the environment via conduction and convection through the control surface fig 15 displays a schematic of the energy balance of the system exchanges are counted positive in the direction of the arrows the energy balance is written as 50 w a b s q r a d δ u w t u r b q o u t figs 16 and 17 displays the bar diagram illustrating the energy balance of the system after 30 min of simulation in sea state h s 3 m t p 9 s respectively with and without solar radiation this verifies the conservation of energy in the numerical model the solar radiation on the device has little impact on the output power since the average turbine output power is 2 2 higher with the high solar radiation than without solar radiation once the air temperature in the device reaches a steady state the average internal energy of the system does not vary any more over a time period in the order of 10 min the heat q o u t transferred through the control surface is equal to the sum of the heat absorbed from the solar radiations q r a d and the turbine and valves losses w l o s s e s hence the steady state conditions over a time period of about 10 min are 51 δ u 0 q r a d w l o s s e s q o u t we note that the turbine and valve losses do not depend on the material of the device walls thus for the same solar radiation absorption the heat transfer across the walls in steady state is independent from the wall material therefore the steel device does not transfer more heat to the environment than the concrete device in steady state and their power output can be expected to be similar this will be confirmed in the next section 4 3 isentropic non isentropic comparison in this section the non isentropic model results of the tupperwave and corresponding conventional owc devices presented in this paper are compared to the model results using the linearised isentropic thermodynamic assumption given in equation 14 the devices were simulated in the wave climate of the emec wave energy test site for the non isentropic model the yearly average global solar irradiance in the north of scotland is i t 115 w m 2 suri et al 2006 table 3 displays the annual electrical power production of both devices in the emec wave climate assessed with both non isentropic model and linearised isentropic model the non return valves are key components in the power conversion efficiency of the tupperwave device depending on their characteristics opening area and opening pressure the tupperwave device can either be more or less efficient than the conventional owc the influence of the valves characteristics was discussed in benreguig et al 2019b and is not in the scope of this present paper with the valves characteristics opening area and pressure used in this study the tupperwave device produces a similar amount of electrical energy as the conventional owc the easier heat transfer to the environment through the walls of the steel device only reduces the electrical power output by 1 2 relative to the concrete device over a whole year on the emec test site non isentropic and isentropic models give very similar results as can be seen in fig 18 which displays the electrical power output time series in a sea state over the whole year on the emec test site the electrical power generation prediction obtained with both models differ by less than 1 this shows that the isentropic linearised assumption provides satisfactory results for power production assessment in the case of the conventional owc as it was already shown in falcão and justino 1999 and also in the case of the tupperwave device 5 conclusion in this paper non isentropic models of the tupperwave device and corresponding conventional owc were developed the models account for the energy dissipation across the turbine and the valves the heat transfers between the inner air and the environment and the solar radiations on the device the results showed that the energy dissipation by viscous losses and the heat absorbed by the walls from solar radiations results in an increase in inner air temperature the large surface area of the device outside walls allows sufficient heat transfer to the environment to limit the temperature increase to a certain threshold depending on the sea state on the walls thermal conductivity and on the level of solar irradiance eventually the internal air temperature does not reach any problematic value for the operation of the closed circuit owc device this result demonstrate that the air temperature increase in a closed circuit owc device such as the tupperwave device should not be considered as a barrier for the further development of this technology whether steel or concrete walls are considered the average temperature increase in the tupperwave device does not exceed 16 c in very energetic sea states even in very sunny days for low thermal conductivity material such as concrete the heat transfer by convection and conduction through the walls is much longer to settle and the resistive heat transfer model used in this manuscript is not adapted to predict the temperatures increase caused by sudden increase of wave excitation force or solar radiation on the device a more sophisticated heat transfer model would be necessary to correctly assess the transient state similar temperature increase phenomenon was also observed in the corresponding conventional owc device due to the viscous losses occurring in the turbine during the inhalation process the temperature increase in the conventional owc was however lower than in the tupperwave device since the air inhaled in every cycle is always at atmospheric temperature the average temperature increase in the owc chamber was limited to 3 c in very energetic sea states the results also showed that the solar radiation and the heat conductivity of the wall material have relatively small impact on the device electrical power output the difference observed between high and low solar radiations or between high and low heat conductivity of the walls are in the order of 2 the more realistic non isentropic models of the tupperwave and conventional owc devices were finally compared to the simpler models using linearised isentropic relationship between pressure and density within the chambers the isentropic assumption was found to provide a satisfactory approximation of the power output for both open and closed circuit owc devices realistic prediction of the temperatures in the devices can however only be achieved with the non isentropic models declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge funding received through oceanera net european network ocn 00028 bahrami 2038 m bahrami available at forced convection heat transfer 2019 simon fraser university sfu british columbia canada https www sfu ca mbahrami ensc 20388 notes forced 20convection pdf m bahrami forced convection heat transfer simon fraser university sfu british columbia canada available at https www sfu ca mbahrami ensc 20388 notes forced 20convection pdf accessed june 14 2019 2019 benreguig et al 2018 p benreguig j murphy w sheng model scale testing of the tupperwave device with comparison to a conventional owc proceedings of the asme 2018 37th international conference on ocean offshore and arctic engineering omae2018 2018 american society of mechanical engineers asme madrid spain 2018 p benreguig j murphy w sheng model scale testing of the tupperwave device with comparison to a conventional owc in proceedings of the asme 2018 37th international conference on ocean offshore and arctic engineering omae2018 madrid spain american society of mechanical engineers asme 2018 2018 benreguig et al 2019a p benreguig v pakrashi j murphy assessment of primary energy conversion of a closed circuit owc wave energy converter energies 12 10 2019 1962 2019 p benreguig v pakrashi j murphy assessment of primary energy conversion of a closed circuit owc wave energy converter energies 12 10 2019 1962 2019 benreguig et al 2019b p benreguig j kelly v pakrashi j murphy wave to wire model development and validation for two owc type wave energy converters energies 12 20 2019 3977 2019 p benreguig j kelly v pakrashi j murphy wave to wire model development and validation for two owc type wave energy converters energies 12 20 2019 3977 2019 dick 2015 e dick fundamentals of turbomachines vol 109 2015 springer 2015 e dick fundamentals of turbomachines vol 109 springer 2015 2015 duclos et al 2001 g duclos a h clément g chatry absorption of outgoing waves in a numerical wave tank using a self adaptive boundary condition int j offshore polar eng 11 03 2001 g duclos a h clement g chatry et al absorption of outgoing waves in a numerical wave tank using a self adaptive boundary condition international journal of offshore and polar engineering 11 03 2001 falcão and henriques 2016 a f o falcão j c c henriques oscillating water column wave energy converters and air turbines a review renew energy 85 2016 1391 1424 2016 afo falcao jcc henriques oscillating water column wave energy converters and air turbines a review renewable energy 85 2016 1391 1424 2016 falcão and henriques 2018 a f o falcão j c c henriques the spring like air compressibility effect in owc wave energy converters hydro thermo and aerodynamic analyses asme 2018 37th international conference on ocean offshore and arctic engineering 2018 2018 afo falcao jcc henriques the spring like air compressibility effect in owc wave energy converters hydro thermo and aerodynamic analyses in asme 2018 37th international conference on ocean offshore and arctic engineering 2018 2018 falcão and justino 1999 a f o falcão p a p justino owc wave energy devices with air flow control ocean eng 26 12 1999 1275 1295 1999 afo falcao pap justino owc wave energy devices with air flow control ocean engineering 26 12 1999 1275 1295 1999 falcão et al 2013 a falcão l gato e nunes a novel radial self rectifying air turbine for use in wave energy converters part 2 results from model testing renew energy 53 2013 159 164 2013 a falcao l gato e nunes a novel radial self rectifying air turbine for use in wave energy converters part 2 results from model testing renewable energy 53 2013 159 164 2013 fleming et al 2017 a fleming g macfarlane s hunter t denniss power performance prediction for a vented oscillating water column wave energy converter with a unidirectional air turbine power take off in proceedings of the 12th european wave and tidal energy conference ewtec 2017 2017 a fleming g macfarlane s hunter t denniss power performance prediction for a vented oscillating water column wave energy converter with a unidirectional air turbine power take off in proceedings of the 12th european wave and tidal energy conference ewtec 2017 2017 guide a environmental des 2019 available at guide a environmental design 2006 the chartered institution of building services engineers cibse london https www cambeep eng cam ac uk cibse guide a environmental design the chartered institution of building services engineers cibse london available at https www cambeep eng cam ac uk 
22269,the thermodynamics of the air inside a conventional oscillating water column owc is commonly modelled using the isentropic relationship between pressure and density the innovative tupperwave device is based on the owc concept but uses non return valves and two extra reservoirs to rectify the flow into a smooth unidirectional air flow harnessed by a unidirectional turbine the air flowing in closed circuit experiences a temperature increase due to viscous losses across the valves and turbine along the repetitive cycles of the device s operation in order to study this temperature increase which represents a potential issue for the device operation a non isentropic wave to wire model of the tupperwave device is developed taking into account the irreversible thermodynamic processes the model is based on the first law of thermodynamics and accounts for viscous losses at the valves and turbine as well as solar radiation and heat transfer across the device walls and inner free surface the results reveal that the temperature increase in the device remains harmless for its operation the difference between the power performance of the tupperwave device based on the non isentropic and isentropic models is found to be relatively small its performance are also compared to the corresponding conventional owc device keywords wave energy oscillating water column non isentropic study tupperwave energy balance valves 1 introduction oscillating water column owc devices are amongst the most promising types of wave energy converters because of their relative simplicity in the most conventional sort of owc devices the owc chamber is open to the atmosphere through a self rectifying turbine the pressure variations in the owc chamber create a bidirectional air flow across the turbine which is able to convert energy regardless the direction of the flow several types of self rectifying turbines have been developed for owcs with various working principles advantages and drawbacks an extensive review of such turbines can be found in falcão and henriques 2016 the best performing self rectifying turbines are the biradial and twin rotor turbines which reach respectively about 79 and 74 efficiency falcão et al 2013 lopes et al 2019 in steady flow conditions self rectifying turbines are not as efficient as conventional unidirectional air turbines which may attain peak efficiencies close to 90 in steady flow conditions the use of a unidirectional turbine in an owc device is possible using non return valves to create a unidirectional flow driven by the motion of the owc various owc devices using a unidirectional turbine have been studied and different methods for rectifying the air flow were considered among those devices there are for example the masuda s navigation buoy falcão and henriques 2016 and the vented owc from wave swell energy fleming et al 2017 these devices are opened to the atmosphere like in a conventional owc whereas other devices such as the tupperwave device work in closed circuit in the tupperwave device a pressure differential is built between two accumulator chambers using the motion of the water column and non return valves in a similar way to a hydraulic circuit air compressibility in the large fixed volume accumulator chambers is used to store pneumatic energy which is then released smoothly across a unidirectional turbine located between the two chambers wave to wire numerical models of the tupperwave device and of the corresponding conventional owc device displayed in fig 1 were developed in benreguig et al 2019a and benreguig et al 2019b to assess and compare their performances the results showed that the performance of the non return valves is of critical importance for the tupperwave device to compete with the conventional owc the thermodynamics in the devices was modelled using the linearised isentropic relationship between pressure and density in the different chambers of the device and the results were validated against model scale experimental tests in a conventional owc converter the air is partly renovated once in a wave cycle a few seconds this prevents the averaged inner air temperature from differing significantly from the outer air temperature as it was shown in falcão and justino 1999 despite non reversible processes such as viscous losses across the turbine the use of the linearised isentropic relationship between pressure and density provides a satisfactory approximation and simplifies the numerical modelling of conventional owc devices this simplifying assumption is therefore commonly used in the numerical modelling of conventional owc devices sheng et al 2013 josset and clément 2007 the situation is different in the tupperwave device where the air flows in closed circuit the energy dissipation at the non return valves and at the imperfectly efficient turbine is likely to increase the entropy and temperature of the inner air the validity of the isentropic assumption for the modelling of the tupperwave device at full scale is therefore questionable moreover the increase of air temperature in the device potentially represents a risk for the device operation this potential issue common to all closed circuit owc devices and associated with others issues related to the use of non return valves such as cost and reliability discouraged many developers from taking this technology further the present study develops for the first time a non isentropic numerical model for a closed circuit owc and investigates the air temperature increase in the tupperwave device in section 1 and 2 the non isentropic models of the tupperwave device and corresponding owc device fig 1 are developed taking into account irreversible thermodynamic processes such as the energy dissipation in the turbine and the valves the heat exchanges between the inner air and the environment and the solar radiations in section 3 the air temperature evolution in the different chambers and the energy flows in the tupperwave device are analysed finally isentropic and non isentropic model results are compared in order to conclude on the reliability of the isentropic simplification 2 tupperwave non isentropic model in this section a non isentropic model of the tupperwave device is developed based on the wave to wire model built in benreguig et al 2019b the thermodynamic component of the model is largely revised to account for the irreversible thermodynamic processes the other components of the model although quasi identical are also briefly described to allow this publication to be read independently from the previous one 2 1 hydrodynamics for the hydrodynamic modelling of the device the two body approach described in sheng et al 2014 is adopted the first rigid body is the spar buoy structure and the second rigid body is an imaginary thin piston at the internal free surface both bodies are considered as rigid bodies moving only in heave due to the action of the waves the model is based on linear wave theory the motion of both bodies in a wave field may be modelled in the time domain applying the cummins equation with subscript 1 for the buoy and subscript 2 for the piston 1 m 1 a 11 x 1 t a 12 x 2 t i 11 i 12 c 1 x 1 t f 1 t f p t f d 1 t a 21 x 1 t m 2 a 22 x 2 t i 21 i 22 c 2 x 2 t f 2 t f p t f d 2 t where m i are the bodies masses c i are the hydrostatic stiffness terms and are calculated as c 1 ρ w g s 1 and c 2 ρ w g s 2 where ρ w is the water density g is the acceleration of gravity s 1 is the cross sectional area of body 1 defined by the undisturbed sea surface and s 2 is the area of the owc free surface a i j are the bodies heaving added masses at infinite frequency including the proper and crossed modes f p is the reciprocating pressure force acting on both bodies and is calculated as f p s 2 p o w c t where p o w c is the excess pressure relatively to atmospheric pressure built in the owc chamber the terms i i j are called memory effect terms and are convolution integrals 2 i i j 0 t k i j t τ x j t d τ where k i j are the impulse functions for heave motions and their interactions f i are the wave excitation forces acting on the two bodies and are calculated as 3 f i t 0 t k e x i t τ η t d t where η is the external wave elevation and k e x i is the excitation force impulse response function for body i the viscous drag forces f d 1 and f d 2 are calculated as f d i c d i x i t x i t where c d i is the equivalent drag coefficient the coefficients c d 1 150 n s 2 m 2 and c d 2 40 n s 2 m 2 were found in benreguig et al 2019a to provide the best fit between the vertical displacement of the bodies predicted numerically and the ones obtained physically for the present study this values are converted to full scale using the froude scaling similarity all the hydrodynamic coefficients a i j k i j k e x i were computed in the frequency domain using wamit lee and newman 2006 a commercial boundary element method software the volume of the owc chamber is calculated as v o w c v 0 s 2 x 1 x 2 the variations of v o w c are related to variations in p o w c system of equation 1 needs to be completed by thermodynamic considerations 2 2 thermodynamics in this section the general thermodynamic equations ruling an open air chamber are derived assuming consecutively non isentropic and isentropic assumptions the non isentropic model is then applied to the modelling of the tupperwave device 2 2 1 general equations we consider the following open thermodynamic system an air chamber of volume v containing a mass m of air with density ρ m v at the temperature t and at pressure p a t m p w i n and w o u t are the air mass flow rates respectively in and out of the chamber and are functions of the air excess pressure p it is assumed that the transformations are slow enough for the thermodynamic state of air in the chamber to be uniform the air is assumed as a perfect and dry gas of constant specific heat capacities c v and c p non isentropic equations the first thermodynamic principle applied to the open system gives josset and clément 2007 4 e u e c e p w q h i n h o u t where e is the energy of the system u is the internal energy e c and e p are the kinetic and potential energy w is the mechanical power provided to the system by the motion of the walls q is the rate of heat transfer provided to the system h i n and h o u t are the enthalpy flow rates due to exchange of matter coming in and out of the system the variations of the system kinetic and potential energy are neglected equation 4 therefore becomes 5 d d t c v m t p a t m p v q c p w i n t f c p w o u t t where ρ f and t f are the density and temperature of the incoming air the mayer s equations are 6 c p c v r a c p c v γ b where r is the specific ideal gas constant the ideal gas law is 7 p a t m p ρ r t and its derivative gives 8 p ρ r t ρ r t the mass balance equation gives 9 m ρ v ρ v w i n w o u t finally equations 5 6 a b 7 8 and 9 lead to the non isentropic model of the system 10 m w i n w o u t a p γ p a t m p m q c p t w i n t f t w o u t ρ v b system of equation 10 a b was obtained from the 1st thermodynamic principle and displays the general equations relating mass density pressure and volume of the air considered as a perfect gas in an open system during non isentropic transformations in this model the specific entropy of the system is likely to change due to the irreversible processes across the valves and turbine and to the heat transferred across the boundaries of the system isentropic equations if the system is considered adiabatic and the transformations are slow enough to be reversible the transformations become isentropic and consequently we may write 11 ρ ρ a t m p a t m p p a t m 1 γ equation 11 once derivated gives 12 ρ ρ a t m p γ p a t m p a t m p p a t m 1 γ 1 equation 12 combined with equations 9 and 11 leads to the isentropic model of the system 13 p γ p a t m p m w i n w o u t ρ v equation 13 displays the equations relating mass density pressure and volume of the air considered as a perfect gas in an open system during isentropic transformations unlike in the non isentropic system 10 the mass of air in the chamber m ρ v and the excess pressure p are directly related by equation 11 hence a single differential equation is necessary we note that equation 13 can be obtained from 10 b by adding the adiabatic assumption q 0 and further assume no temperature difference between inner and outside air t f t linearised isentropic equations moreover in the case where the excess pressure remains small compared to the atmospheric pressure it is possible to linearise the isentropic relationship between density and pressure once linearised equation 11 leads to 14 ρ ρ a t m 1 p γ p a t m and to 15 ρ ρ a t m γ p a t m p finally the linearised isentropic system of equations relating mass density pressure and volume of the system is 16 p γ p a t m ρ a t m v w i n w o u t ρ v depending on the feasible assumptions and on the level of accuracy desired equation 10 a b or 13 or 16 can be directly applied for the modelling of the thermodynamic happening in owc type wave energy devices air chambers in this paper the non isentropic model system of equation 10 will be used to model the thermodynamic happening in the tupperwave device 2 2 2 tupperwave thermodynamics fig 2 displays a schematic of the 3 chambers of the tupperwave device and their thermodynamic variables solid arrows represent mass flow of air and hollow arrows represent heat exchanges through the walls exchanges are counted positive in the direction of the arrows each chamber of the device is modelled as an open thermodynamic system the non isentropic system of equation 10 a b is therefore applied to each of the three chambers in the following paragraphs the heat transfer rates mass flow rates and flow temperatures at the exit of the turbine and valves are mathematically expressed as functions of the temperatures and pressures in the different chambers heat exchanges in the event of air temperature increase in the device thermal exchanges through the walls of the device need to be considered due to the large surface area of the walls exchanges between the hp and lp chambers and the exterior atmosphere and water are considered hp and lp chambers also exchange heat across the separation wall heat transfers through the walls between the owc chamber and the two other chambers are neglected because of the smaller common wall surface heat is also exchanged between the air contained in the owc chamber and the water the device s walls are considered homogeneous and separate either air and water or air and air at different temperatures the heat transfer from a fluid 1 to a fluid 2 across a wall results of a combination in series of convection mechanisms from the fluids to the wall surfaces and conduction mechanism across the wall to evaluate the heat transfer rate a steady one dimensional heat exchange model in the normal direction to the wall s surface is adopted as displayed in fig 3 the precise study of the transient state requires to solve the unsteady heat conduction equation across the wall which would increase the mathematical complexity of the problem and was not considered by the authors the steady state assumption will be verified in section 3 depending on the wall s material the overall heat transfer coefficient between fluid 1 and 2 is therefore defined as rajput 2010 17 k 1 2 1 1 h 1 l k 1 h 2 where h 1 and h 2 are the fluids convective heat transfer coefficients l and k are the thickness and heat conductivity of the wall the heat transfer rate resulting from conduction and convection through the wall of area a between fluid 1 at temperature t 1 and fluid 2 at temperature t 2 takes the form 18 q 1 2 k 1 2 a t 1 t 2 radiative heat transfer from the sun may play an important role in sunny days to account for solar radiation on the device the equivalent sol air temperature method is used t s o l a i r is the outside air temperature for which in the absence of heat radiation the external environment delivers the same heat flux to the wall surface if the wall surface in contact with fluid 1 is exposed to sun radiation t 1 s o l a i r can be calculated as marino et al 2018 19 t 1 s o l a i r t 1 α i t h 1 where α the material absorptivity and i t is the total solar irradiation hence the total heat transfer rate across the wall is simply calculated as 20 q 1 2 k 1 2 a t 1 s o l a i r t 2 the outside wall surface area of the hp chamber and lp chamber are approximately a h p a l p 400 m 2 for each chamber about half of their outside wall surface area is in contact with water and the other half is in contact with air the wall surface area of the device exposed to solar radiation is a function of the sun position and device orientation for simplicity it is assumed that only the outside wall surface of the hp chamber in contact with air is exposed to the solar irradiation i t thus we write 21 q h p k a a a h p 2 t a α i t h a t h p k w a a h p 2 t w t h p 22 q l p k a a a l p 2 t a t l p k w a a l p 2 t w t l p 23 q h p 2 l p k a a a h p 2 l p t h p t l p where the subscribes a and w respectively refer to the atmospheric air and the ocean water atmospheric and ocean temperatures t a and t w are assumed constant a h p 2 l p 135 m 2 is the surface area of the wall separating the hp chamber from the lp chamber the convective heat transfer between the air in the owc chamber and the internal water surface is calculated as 24 q o w c h a w s t w t o w c where h a w is the convective heat transfer coefficient between air and water and s is the internal water surface area turbine to assess the temperature of the flow at the exit of the turbine we consider the real expansion process happening across the turbine from the stagnation pressure p 0 i n at the inlet to the static pressure p o u t at the outlet the entropy enthalpy diagram is shown in fig 4 where perfect dashed arrow and real full arrow expansions are represented between the two isobaric lines the kinetic energy at the entrance of the turbine is neglected and the kinetic energy in the exhaust gases is not contributing to the total useful energy at the turbine the total to static efficiency of the turbine is therefore defined as 25 η t p m p a v a i l h 0 i n h o u t h 0 i n h o u t s where p a v a i l is the available power to the turbine defined as the power output of a perfectly efficient turbine p m is the power converted by the actual turbine into mechanical power h 0 i n is the stagnation specific enthalpy at the entrance of the turbine h o u t is the specific enthalpy at the exit of the turbine and h o u t s is the specific enthalpy at the exit of the turbine if the expansion were perfect i e isentropic the turbine losses are dissipated into heat and are calculated as 26 l t p a v a i l p m p a v a i l 1 η t w i n h o u t h o u t s the air is considered as a perfect gas and so d h c p d t equation 26 can be written as 27 l t w i n c p t o u t t o u t s i e 28 t o u t t o u t s l t c p w i n the temperature of the flow at the exit of the isentropic expansion is calculated using the well known isentropic relationship 29 t o u t s t i n p o u t p 0 i n γ 1 γ applying equations 28 and 29 to the expansion from the hp to the lp chamber across the turbine leads to the expression of the air temperature at the exit of the turbine and entering the lp chamber 30 t f t t h p p a t m p l p p a t m p h p γ 1 γ l t c p w t the mass flow rate across the turbine now needs to be expressed the model of the radial inflow turbine used in this paper is taken from the literature and was obtained with a rotor of 500 mm at rotational speeds between 700 and 1300 rpm the reynolds number ranged between 9 2 10 5 and 2 1 10 6 and the mach number did not exceed 0 1 lopes et al 2019 in this conditions the flow can be considered as incompressible in this paper the tupperwave device is equipped with same turbine diameter see table 1 in section 3 but the rotational speeds considered are 4 times higher changes in reynolds and mach number can modify the turbine performances a higher reynolds number may modify the turbulent behaviour of the flow and compressibility effects may be introduced if the mach number rises above 0 3 in what follows mach and reynolds number effects are ignored and the flow through the turbine is considered as approximately incompressible thus the performance of the turbine can be presented non dimensionally and the results can be applied to a geometrically similar turbine of different size rotating at different speed and with a fluid of different density hall and dixon 2013 if the flow is assumed incompressible the turbine power output p m depends on the turbine geometry on the turbine size rotor diameter on the rotational speed ω and on the pressure head δ p t p 0 i n p o u t between inlet and outlet or on the air flow rate w t the corresponding dimensionless variables are the dimensionless flow coefficient φ dimensionless pressure head ψ and dimensionless turbine power output π which are defined as falcão and henriques 2016 31 φ w t ρ i n ω d 3 ψ δ p t ρ i n ω 2 d 2 π p m ρ i n ω 3 d 5 neglecting the influence of the reynolds and mach numbers we may write 32 ψ f ψ φ π f π φ where the functions f ψ and f π depend only on the turbine geometry but not on size rotational speed or fluid density from equations 31 and 32 the mass flow rate through the turbine w t and the turbine torque t t u r b can be expressed as a functions of the pressure head and the rotational speed 33 w t ρ h p ω d 3 f ψ 1 p 0 i n p o u t ρ i n ω 2 d 2 34 t t u r b p m ω ρ h p ω 2 d 5 f π w t ρ i n ω d 3 for low mach numbers m 0 3 as during the experimental assessment of the turbine performances lopes et al 2019 the flow can be considered as incompressible and the dimensionless power available to the turbine is the product of the volumetric flow rate and the pressure head hence the total to static turbine efficiency η t is obtained by 35 η t p m p a v a i l π φψ f η φ the turbine works at maximum efficiency for the optimal dimensionless flow coefficient φ o p t the turbine functions f ψ and f π of the unidirectional turbine used in the tupperwave model were established at model scale during laboratory tests described in lopes et al 2019 lopes 2017 this unidirectional turbine was tested in the framework of the twin rotor turbine development which is among the most efficient self rectifying turbine being symmetrical only half of the turbine designated single rotor turbine was designed constructed and tested in unidirectional flow at instituto superior tecnico ist lisbon this single rotor turbine is used here in the tupperwave device it reaches 84 maximum efficiency in constant flow condition valves the non return valves are essential for the successful performance of the tupperwave device benreguig et al 2018 2019abib benreguig et al 2019abib benreguig et al 2019abib benreguig et al 2018 valves can either be passive check valves or active on off valves the valves considered in this paper are passive valves that require a pressure head δ p v p i n p o u t larger than their opening pressure p v 0 to open we note that each valve hp or lp is open only about half of the time therefore the average flow rate across them when they are open is about twice as high as the average flow across the turbine in the conditions in which the model is simulated in this paper the mach number of the flow across the valves sometimes rises above 0 3 hence the flow needs to be considered as compressible the mass flow rates of air across the valves are calculated from their pressure head using a steady state subsonic compressible flow model rajput 2010 36 w v i n o u t 0 i f p i n p o u t p v 0 α d a v 2 γ γ 1 ρ i n p i n p v 0 r 2 γ r γ 1 γ i f p i n p o u t p v 0 where r p o u t p i n p v 0 is the pressure ratio over the valve when open a v is the opening area of the valve α d is a correction coefficient called discharge coefficient accounting for the further contraction of the flow cross sectional area downstream of the valve opening also called vena contracta as illustration fig 5 displays the mass flow rate across the valves as function of the pressure head for ρ i n ρ a t m in the present work the equivalent opening area of the valves was set to α d a v 0 286 m 2 and the opening pressure set to p v 0 150 pa further considerations on the valves characteristics although critical for the tupperwave performances are not in the scope of this paper the expansion across the valves corresponds to a throttling process and is fundamentally irreversible as the exit kinetic energy is dissipated no work is done on or by the air and the expansion therefore happens at constant enthalpy sonntag et al 1998 h i n h o u t i e for a perfect gas t i n t o u t thus using the ideal gas law we have 37 t f v h t o w c p a t m p o w c v o w c m o w c r and 38 t f v l t l p p a t m p l p v l p m l p r finally we have obtained the mathematical expressions of the heat transfers across the walls the mass flow rates across the turbines and valves and their exit temperatures as functions of the pressures volumes and masses of air in each chamber equations from system 10 can be directly applied to each of the three chambers of the tupperwave device thus obtaining the non isentropic thermodynamic model of the device 39 m o w c w l p w h p m h p w h p w t m l p w t w l p p o w c γ p a t m p o w c m o w c q o w c c p t o w c w v l t l p t o w c w v h ρ o w c v o w c p h p γ p a t m p h p m h p q h p q h p 2 l p c p t h p w v h t o w c t h p w t p l p γ p a t m p l p m l p q l p q h p 2 l p c p t l p w t t f t t l p w v l 2 3 generator model and control law the last differential equation of the model is given by the newton s law applied on the generator rotor 40 i ω t t u r b t g e n where i is the inertia of the turbine generator system t g e n is the electromagnetic braking torque of the generator and t t u r b is given in equation 34 a maximum power point tracking mppt control strategy is applied to control the generator braking torque and optimise the instantaneous turbine efficiency this control strategy was physically implemented in benreguig et al 2019b on a rotary test rig to simulate the turbine generator interaction the electromagnetic power p e m ω t g e n is finally converted into electricity by the generator with the efficiency η g e n which depends on its load λ p e m p r a t e d where p r a t e d is the generator rated power the realistic generator efficiency is displayed in fig 6 and drops very sharply for partial loads 2 4 global numerical model and numerical integration method the systems of differential equations 1 38 and 39 constitute the model of the tupperwave device computing the solution of these equations to find the nine unknown variable x 1 x 2 m o w c m h p m l p p o w c p h p p l p ω is made difficult by the fact that equations from system 1 are second order differential equations and by the presence of the memory effect convolution integrals i i j in the present work the memory effect terms are approximated using a state space representation each of the four convolution integrals i i j can be approximated by the sum of n additional state variables i i j k using the prony s method sheng et al 2015 duclos et al 2001 41 i i j 1 n i i j k each i i j k is governed by an additional first order differential equation of the form 42 i i j k β i j k i i j k α i j k x j moreover the 2 s order differential equations of system 1 can be reduced to first order differential equations by introducing the matrix variables u x 1 x 2 and v x 1 x 2 finally the system of equations governing the non isentropic wave to wire model of the tupperwave device can be expressed as 43 u v v m 1 f 1 f 2 1 1 s p o w c 1 n i 11 k 1 n i 12 k 1 n i 21 k 1 n i 22 k c d 1 c d 2 v v c 1 c 2 u i 11 k β 11 k i 11 k α 11 k x 1 k 1 n i 12 k β 12 k i 12 k α 12 k x 2 k 1 n i 21 k β 21 k i 21 k α 21 k x 1 k 1 n i 22 k β 22 k i 22 k α 22 k x 2 k 1 n m o w c w l p w h p m h p w h p w t m l p w t w l p p o w c γ p a t m p o w c m o w c q o w c c p t o w c w v l t l p t o w c w v h ρ o w c v o w c p h p γ p a t m p h p m h p q h p q h p 2 l p c p t h p w v h t o w c t h p w t p l p γ p a t m p l p m l p q l p q h p 2 l p c p t l p w t t f t t l p w v l i ω t t u r b t g e n this system is composed of 9 4n first order differential equations which can be solved using a numerical first order differential equation solver in the present work the order of the prony s function is n 4 the system is solved with the variable step ordinary differential equation solver ode 45 from the software matlab 3 conventional owc non isentropic model the wave to wire model of the corresponding owc device is relatively similar to the tupperwave device since both devices use the same floating spar structure the hydrodynamic set of equations is the same fig 7 displays a schematic of the owc thermodynamic system the air in the chamber is thermally isolated from the atmosphere by the buoyancy volume around the chamber heat exchange however occurs by convection between the air and the water column to separate inhalation and exhalation processes we define the two positive quantities w t i n and w t o u t as the absolute values of the air flow rates respectively entering and exiting the turbine such that 44 for p o w c 0 w t i n w t w t o u t 0 and for p o w c 0 w t i n 0 w t o u t w t the system of equation 10 applied on the owc chamber gives 45 m o w c w t i n w t o u t p o w c γ p a t m p o w c m q o w c c p t o w c w t i n t f t o w c w t o u t ρ o w c v o w c with 46 t f t t a t m p a t m p o w c p a t m γ 1 γ l c p w t the turbine used in the owc model is the twin rotor turbine the turbine is based on a pair of conventional radial inflow rotors mounted on the same shaft complemented by the corresponding guide vane rows and by a two position cylindrical valve which orientates the air across one rotor or the other depending on the flow direction inhalation or exhalation the rotor spinning in no flow generates a braking torque and causes windage losses lopes et al 2019 the turbine s characteristic functions f ψ and f π were established by physical testing in lopes 2017 as well as an expression of the windage torque as a function of the rotational speed the maximum efficiency of the twin rotor turbine is 74 in constant flow condition the generator and its control law are the same as in the tupperwave model the only difference is that the aerodynamic friction torque t w i n d created by the passive rotor the one with no flow is added in the shaft rotational speed s differential equation 47 i ω t t u r b t g e n t w i n d using the same method as in section 1 4 the system of equations governing the non isentropic wave to wire model of the conventional owc device is expressed as 5 4n first order differential equations 48 u v v m 1 f 1 f 2 1 1 s p o w c 1 n i 11 k 1 n i 12 k 1 n i 21 k 1 n i 22 k c d 1 c d 2 v v c 1 c 2 u i 11 k β 11 k i 11 k α 11 k x 1 k 1 n i 12 k β 12 k i 12 k α i j k x 2 k 1 n i 21 k β 21 k i 21 k α i j k x 1 k 1 n i 22 k β 22 k i 22 k α i j k x 2 k 1 n m o w c w t i n w t o u t p o w c γ p a t m p o w c m q o w c c p t o w c w t i n t f t o w c w t o u t ρ o w c v o w c i ω t t u r b t g e n t w i n d 4 numerical results in this section the numerical results are obtained assuming an atmosphere and ocean temperature of 15 c at the beginning of each simulation the device is idle and the air in the device is at atmospheric condition the same turbine blade geometry as the one tested in lopes et al 2019 was used in both device the diameters and rotational speeds were optimised in benreguig et al 2019b to maximise the electrical power output from both devices in the wave climate of the emec test site located in the north of scotland information on the turbine and generator parameters used in the tupperwave and the conventional owc model are given in table 1 as shown in table 1 the optimisation results were very different on what concerns the size diameter d and the rotational speed this is due to the very different working conditions of the turbines in the two devices as can be seen in fig 8 which displays the pressure head and the flow rate to which both turbines are subjected in the same sea state the pressure head across the tupperwave turbine is larger with a lower flow rate this is confirmed by the very different sizes of the orifices used to simulate the turbines in model testing of tupperwave and conventional owc in benreguig et al 2019a the higher rotational speed of the tupperwave turbine unfortunately requires the use of a gearbox associated with undesirable cost and maintenance issues it can be found from the well known cordier diagram dick 2015 that the use of different turbine design with a larger diameter could avoid the use of a gearbox and enable the direct driving of the generator 4 1 temperature analysis 4 1 1 in the tupperwave device adiabatic case fig 9 displays the temperature of the air in the hp and lp chambers in the case where the device does not receive any radiation from the sun and no heat exchange is allowed across the walls or with the water adiabatic q o w c q h p q l p q h p 2 l p 0 the simulation is 30 min long in the irregular sea state h s 3 m t p 9 s which represents a relatively common sea state of moderate energy in offshore ocean conditions the black line represents the average air temperature of the system at the end of the simulation given the pressure difference between the two chambers the hp chamber is naturally hotter than the lp chamber the temperature in the owc chamber oscillates successively between the temperatures of the hp and lp chambers and was not represented in the figure for clarity significant temperature elevation occurs in the chambers due to the viscous losses the air temperature in both chambers increases steadily by approximately 20 c in 30 min and would keep rising to infinity in this theoretical case as a result the air expands and the average pressure in the device increases this pushes the water column down and the buoy up and would eventually modify the hydrostatic equilibrium and the hydrodynamics of the device high temperatures are also undesirable because they could damage on board instrumentation or the buoy structure itself diathermal case in reality heat transfers need to be considered due to the large outer wall s surface area of the tupperwave device and the contact between air and water in the owc chamber the total solar irradiation at sea level i t 1000 w m 2 corresponding to a clear summer day in europe is adopted this value is generally used as standard test conditions for photovoltaic devices the absorptivity α of the solar radiation by a surface is complex to assess and can vary from 0 to 1 depending on the material the colour and the roughness of the surface in general it is higher for dark colours and rough surface the value α 0 7 is adopted for this study and corresponds to the absorptivity of concrete according to guide a environmental des 2019 values for the convective heat transfer coefficients between the fluids air or water and device walls strongly depends on the fluid properties the roughness of the surface and on the flow velocity in the vicinity of the wall in the present case the fluid flows around the device depend on the wind and water current as well as on the motion of the device due to the wave excitation the overall air flow velocity around the device is taken of v 1 5 m s and the empirical law suggested in guide a environmental des 2019 leads to a convective heat transfer coefficient h a 4 4 v 1 24 w m 2 k assuming a turbulent flow of water outside the device with 1 m s average overall speed the convective heat transfer coefficient of the water is estimated using the dittus boelter equation to h w 1000 w m 2 k bahrami 2038 considering the motion of the iws in the owc chamber of approximately v 2 1 m s the forced convection model adopted in namèche and vassel 1999 leads to convective heat transfer coefficient between air and water h a w 2 8 3 v 2 5 8 w m 2 k we note that the values of the thermal parameters given in this paragraph can vary largely depending on the adopted assumptions relative to the weather conditions the device construction and the sea state choosing realistic values is made even more difficult by the large variability of information found in the literature the chosen values are meant to represent the heat exchanges in light wind current and wave conditions on a very sunny day around noon in order to avoid the underestimation of the temperature rise in the device the walls are first considered to be made of concrete with a thickness l 20 cm the thermal conductivity of concrete is greatly affected by mix proportioning aggregate types and sources as well as moisture status complex considerations on concrete are beyond the scope of this paper measurements made in guo et al 2011 give an average value of k t h c o n c r e t e 2 w m k fig 10 displays the temperature of the air in the hp and lp chambers in the case of a concrete buoy structure in sea state h s 3 m t p 9 s the black line represents the average air temperature in the chambers at the end of the simulation after a transient state of about 10 min where the temperature increases slowly the system reaches a steady state and the average air temperature settles 10 c higher than the initial temperature in 5 m high waves the same phenomenon is observed and the increase in temperature is found to be of about 16 c another wall material is considered with a higher heat conductivity than that of concrete the walls are assumed made of steel sheets of thickness l 15 mm and with heat conductivity k t h s t e e l 30 w m 1 k 1 rajput 2010 assuming similar walls surface colour and roughness as for the concrete walls the same convective heat transfer and absorptivity coefficients are adopted fig 11 displays the temperature of the air in the hp and lp chambers in the case of a concrete buoy structure in sea state h s 3 m t p 9 s in that case the steady state is reached in about 5 min the average air temperature increase in the device is of 6 3 c and reaches 8 5 c in extreme sea states simulations were also carried out in the absence of solar radiation night conditions the results obtained on temperature increase in the tupperwave device under the assumption of steady state heat transfer across the walls are summarized in table 2 the assumption of steady state conductive heat transfer across the device walls adopted in section 1 2 2 can be checked by the calculation of the characteristic diffusion time τ across the thickness l of the wall hancock 2006 49 τ l 2 d t h l 2 ρ c v k t h where d t h ρ c v and k t h are respectively the thermal diffusivity density heat capacity and heat conductivity of the wall material for the steel wall the characteristic diffusion time is about 30 s in that case the conductive heat transfer across the wall is quickly established and the assumption of steady state conductive heat transfer enabling a resistive thermal model of the walls is reasonable at all times for the concrete wall the characteristic time of diffusion is close to 10 h this means that after the sudden change of excitation force or solar radiation the conduction heat transfer requires a 10 h long transient state to settle back to a steady state hence the resistive thermal model of the concrete wall is not valid during such transient state the results displayed in fig 10 are therefore likely to underestimate the duration of the transient state and higher temperature levels are likely to be reached during this period before the steady state is settled the installation of steel heat exchangers across the concrete walls could be a solution to prevent high temperature increase caused by the sudden increase of the wave excitation force or solar radiation on the device the temperature increase displayed in table 2 are however still valid under the assumption that the conductive heat transfer across the walls has had sufficient time to settle such low air temperature increase does not represent any danger for the device operation the isentropic model does not predict this increase in temperature as it can be seen in fig 12 the average air temperature in the device remains equal to the initial temperature 4 1 2 in the conventional owc in the case of the conventional owc a slight temperature increase in the owc chamber is also observed during the inhalation process the viscous losses at the turbine result in an increase of specific internal energy in the owc chamber but unlike the tupperwave device the owc chamber is open to the atmosphere whose temperature remains constant this prevents large increase in temperatures fig 13 displays the temperature of the owc chamber in the conventional owc device in sea state h s 3 m t p 9 s the average temperature of the chamber towards the end of the simulation represented by the black line is 1 5 c higher than the initial temperature in 5m high waves the increase in temperature is of 3 c 4 2 energy balance analysis the review on wave to wire models of wave energy converters penalba and ringwood 2016 distinguishes four main stages in the power conversion process of a wave energy converter absorption transmission generation and conditioning in a conventional owc the power effectively absorbed from the waves p a b s is the power applied by internal water surface on the air contained in the owc chamber absorption stage this energy is briefly stored by the air contained in the owc chamber under the form of internal energy and released for the most part and with a delay as power available to the turbine p a v a i l this is the spring like compressibility effect of the air falcão and henriques 2018 we note that if the process is assumed adiabatic and isentropic without any dissipative losses the averaged values of the absorbed power and power available to the turbine over a sufficiently long time interval must be equal p a v a i l p a b s this is not the case in the non isentropic model of the conventional owc developed in this study where the internal energy of the air is likely to change due to the heat transfer with the water column besides in the case of the tupperwave device some energy is dissipated in the valves and the power available to the turbine is eventually lower than the power absorbed from the waves p a v a i l p a b s part of the power available to the turbine is then effectively converted by the turbine into mechanical power transmission stage the mechanical power is further converted into electrical power by the generator generation stage finally the raw electrical power created by the generator is adapted to be delivered into the grid by a power electronic converter conditioning stage in the present paper the wave to wire models presented neglect the influence of the conditioning stage on the device efficiency this simplification was shown in penalba and ringwood 2018 to be perfectly reasonable in applications such as control parameters optimisation and power production assessment fig 14 displays a bar diagram of the average powers along the power conversion chain for the tupperwave device in the end 57 of the absorbed power is converted in electrical power and the rest is disspated in the turbine the valves and the generator in section 1 2 1 a general open thermodynamic system has been defined to derive the general equations relating mass density pressure and volume these equations were then applied to each chamber of the tupperwave device to build the numerical model we now consider the thermodynamic system which refers to the total air contained in the tupperwave device which is a closed system according to the first law of thermodynamics the change in the internal energy δ u of a closed system is equal to the amount of heat supplied to the system plus the amount of mechanical work w received by the system the work received by the considered system is the work w a b s done by the internal water surface acting as a piston the system also absorbs the heat q r a d from the solar radiation within the system part of the absorbed energy is dissipated in the turbine and valves w l o s s e s the mechanical work done by the system is the work provided to the turbine w t u r b finally the heat q o u t is transferred to the environment via conduction and convection through the control surface fig 15 displays a schematic of the energy balance of the system exchanges are counted positive in the direction of the arrows the energy balance is written as 50 w a b s q r a d δ u w t u r b q o u t figs 16 and 17 displays the bar diagram illustrating the energy balance of the system after 30 min of simulation in sea state h s 3 m t p 9 s respectively with and without solar radiation this verifies the conservation of energy in the numerical model the solar radiation on the device has little impact on the output power since the average turbine output power is 2 2 higher with the high solar radiation than without solar radiation once the air temperature in the device reaches a steady state the average internal energy of the system does not vary any more over a time period in the order of 10 min the heat q o u t transferred through the control surface is equal to the sum of the heat absorbed from the solar radiations q r a d and the turbine and valves losses w l o s s e s hence the steady state conditions over a time period of about 10 min are 51 δ u 0 q r a d w l o s s e s q o u t we note that the turbine and valve losses do not depend on the material of the device walls thus for the same solar radiation absorption the heat transfer across the walls in steady state is independent from the wall material therefore the steel device does not transfer more heat to the environment than the concrete device in steady state and their power output can be expected to be similar this will be confirmed in the next section 4 3 isentropic non isentropic comparison in this section the non isentropic model results of the tupperwave and corresponding conventional owc devices presented in this paper are compared to the model results using the linearised isentropic thermodynamic assumption given in equation 14 the devices were simulated in the wave climate of the emec wave energy test site for the non isentropic model the yearly average global solar irradiance in the north of scotland is i t 115 w m 2 suri et al 2006 table 3 displays the annual electrical power production of both devices in the emec wave climate assessed with both non isentropic model and linearised isentropic model the non return valves are key components in the power conversion efficiency of the tupperwave device depending on their characteristics opening area and opening pressure the tupperwave device can either be more or less efficient than the conventional owc the influence of the valves characteristics was discussed in benreguig et al 2019b and is not in the scope of this present paper with the valves characteristics opening area and pressure used in this study the tupperwave device produces a similar amount of electrical energy as the conventional owc the easier heat transfer to the environment through the walls of the steel device only reduces the electrical power output by 1 2 relative to the concrete device over a whole year on the emec test site non isentropic and isentropic models give very similar results as can be seen in fig 18 which displays the electrical power output time series in a sea state over the whole year on the emec test site the electrical power generation prediction obtained with both models differ by less than 1 this shows that the isentropic linearised assumption provides satisfactory results for power production assessment in the case of the conventional owc as it was already shown in falcão and justino 1999 and also in the case of the tupperwave device 5 conclusion in this paper non isentropic models of the tupperwave device and corresponding conventional owc were developed the models account for the energy dissipation across the turbine and the valves the heat transfers between the inner air and the environment and the solar radiations on the device the results showed that the energy dissipation by viscous losses and the heat absorbed by the walls from solar radiations results in an increase in inner air temperature the large surface area of the device outside walls allows sufficient heat transfer to the environment to limit the temperature increase to a certain threshold depending on the sea state on the walls thermal conductivity and on the level of solar irradiance eventually the internal air temperature does not reach any problematic value for the operation of the closed circuit owc device this result demonstrate that the air temperature increase in a closed circuit owc device such as the tupperwave device should not be considered as a barrier for the further development of this technology whether steel or concrete walls are considered the average temperature increase in the tupperwave device does not exceed 16 c in very energetic sea states even in very sunny days for low thermal conductivity material such as concrete the heat transfer by convection and conduction through the walls is much longer to settle and the resistive heat transfer model used in this manuscript is not adapted to predict the temperatures increase caused by sudden increase of wave excitation force or solar radiation on the device a more sophisticated heat transfer model would be necessary to correctly assess the transient state similar temperature increase phenomenon was also observed in the corresponding conventional owc device due to the viscous losses occurring in the turbine during the inhalation process the temperature increase in the conventional owc was however lower than in the tupperwave device since the air inhaled in every cycle is always at atmospheric temperature the average temperature increase in the owc chamber was limited to 3 c in very energetic sea states the results also showed that the solar radiation and the heat conductivity of the wall material have relatively small impact on the device electrical power output the difference observed between high and low solar radiations or between high and low heat conductivity of the walls are in the order of 2 the more realistic non isentropic models of the tupperwave and conventional owc devices were finally compared to the simpler models using linearised isentropic relationship between pressure and density within the chambers the isentropic assumption was found to provide a satisfactory approximation of the power output for both open and closed circuit owc devices realistic prediction of the temperatures in the devices can however only be achieved with the non isentropic models declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge funding received through oceanera net european network ocn 00028 bahrami 2038 m bahrami available at forced convection heat transfer 2019 simon fraser university sfu british columbia canada https www sfu ca mbahrami ensc 20388 notes forced 20convection pdf m bahrami forced convection heat transfer simon fraser university sfu british columbia canada available at https www sfu ca mbahrami ensc 20388 notes forced 20convection pdf accessed june 14 2019 2019 benreguig et al 2018 p benreguig j murphy w sheng model scale testing of the tupperwave device with comparison to a conventional owc proceedings of the asme 2018 37th international conference on ocean offshore and arctic engineering omae2018 2018 american society of mechanical engineers asme madrid spain 2018 p benreguig j murphy w sheng model scale testing of the tupperwave device with comparison to a conventional owc in proceedings of the asme 2018 37th international conference on ocean offshore and arctic engineering omae2018 madrid spain american society of mechanical engineers asme 2018 2018 benreguig et al 2019a p benreguig v pakrashi j murphy assessment of primary energy conversion of a closed circuit owc wave energy converter energies 12 10 2019 1962 2019 p benreguig v pakrashi j murphy assessment of primary energy conversion of a closed circuit owc wave energy converter energies 12 10 2019 1962 2019 benreguig et al 2019b p benreguig j kelly v pakrashi j murphy wave to wire model development and validation for two owc type wave energy converters energies 12 20 2019 3977 2019 p benreguig j kelly v pakrashi j murphy wave to wire model development and validation for two owc type wave energy converters energies 12 20 2019 3977 2019 dick 2015 e dick fundamentals of turbomachines vol 109 2015 springer 2015 e dick fundamentals of turbomachines vol 109 springer 2015 2015 duclos et al 2001 g duclos a h clément g chatry absorption of outgoing waves in a numerical wave tank using a self adaptive boundary condition int j offshore polar eng 11 03 2001 g duclos a h clement g chatry et al absorption of outgoing waves in a numerical wave tank using a self adaptive boundary condition international journal of offshore and polar engineering 11 03 2001 falcão and henriques 2016 a f o falcão j c c henriques oscillating water column wave energy converters and air turbines a review renew energy 85 2016 1391 1424 2016 afo falcao jcc henriques oscillating water column wave energy converters and air turbines a review renewable energy 85 2016 1391 1424 2016 falcão and henriques 2018 a f o falcão j c c henriques the spring like air compressibility effect in owc wave energy converters hydro thermo and aerodynamic analyses asme 2018 37th international conference on ocean offshore and arctic engineering 2018 2018 afo falcao jcc henriques the spring like air compressibility effect in owc wave energy converters hydro thermo and aerodynamic analyses in asme 2018 37th international conference on ocean offshore and arctic engineering 2018 2018 falcão and justino 1999 a f o falcão p a p justino owc wave energy devices with air flow control ocean eng 26 12 1999 1275 1295 1999 afo falcao pap justino owc wave energy devices with air flow control ocean engineering 26 12 1999 1275 1295 1999 falcão et al 2013 a falcão l gato e nunes a novel radial self rectifying air turbine for use in wave energy converters part 2 results from model testing renew energy 53 2013 159 164 2013 a falcao l gato e nunes a novel radial self rectifying air turbine for use in wave energy converters part 2 results from model testing renewable energy 53 2013 159 164 2013 fleming et al 2017 a fleming g macfarlane s hunter t denniss power performance prediction for a vented oscillating water column wave energy converter with a unidirectional air turbine power take off in proceedings of the 12th european wave and tidal energy conference ewtec 2017 2017 a fleming g macfarlane s hunter t denniss power performance prediction for a vented oscillating water column wave energy converter with a unidirectional air turbine power take off in proceedings of the 12th european wave and tidal energy conference ewtec 2017 2017 guide a environmental des 2019 available at guide a environmental design 2006 the chartered institution of building services engineers cibse london https www cambeep eng cam ac uk cibse guide a environmental design the chartered institution of building services engineers cibse london available at https www cambeep eng cam ac uk 
